/mnt/petrelfs/tangzecheng/.bashrc:è¡Œ87: proxy_on: æœªæ‰¾åˆ°å‘½ä»¤
/mnt/petrelfs/tangzecheng/.bashrc:è¡Œ94: svp: æœªæ‰¾åˆ°å‘½ä»¤
/mnt/petrelfs/tangzecheng/.bashrc:è¡Œ98: svp: æœªæ‰¾åˆ°å‘½ä»¤
2025-01-21 01:30:53.351 | INFO     | __main__:__init__:129 - loading from meta-llama/Meta-Llama-3.1-8B-Instruct
2025-01-21 01:30:53.647 | INFO     | __main__:__init__:133 - layer number: 32, head number 32
The model was loaded with use_flash_attention_2=True, which is deprecated and may be removed in a future release. Please use `attn_implementation="flash_attention_2"` instead.
LlamaForCausalLM has generative capabilities, as `prepare_inputs_for_generation` is explicitly overwritten. However, it doesn't directly inherit from `GenerationMixin`. From ðŸ‘‰v4.50ðŸ‘ˆ onwards, `PreTrainedModel` will NOT inherit from `GenerationMixin`, and this model will lose the ability to call `generate` and other related functions.
  - If you're using `trust_remote_code=True`, you can get rid of this warning by loading the model with an auto class. See https://huggingface.co/docs/transformers/en/model_doc/auto#auto-classes
  - If you are the owner of the model architecture code, please modify your model class such that it inherits from `GenerationMixin` (after `PreTrainedModel`, otherwise you'll get an exception).
  - If you are not the owner of the model architecture class, please contact the model code owner to update it.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.34s/it]Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:11<00:11,  5.84s/it]Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:15<00:05,  5.06s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.30s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.99s/it]
  0%|          | 0/1 [00:00<?, ?it/s]
  0%|          | 0/2 [00:00<?, ?it/s][A2025-01-21 01:31:17.707 | INFO     | __main__:start_test:320 - Selected idx: 0
2025-01-21 01:31:17.708 | INFO     | __main__:start_test:321 - Answer: office
2025-01-21 01:31:17.709 | INFO     | __main__:start_test:322 - Tag: 3-hop
2025-01-21 01:31:17.710 | INFO     | __main__:start_test:323 - Needle: [' John went back to the bedroom.', ' John took the milk.', ' Mary journeyed to the office.', ' Sandra journeyed to the bedroom.', ' John journeyed to the office.', ' Mary journeyed to the bathroom.', ' Mary dropped the football.', ' Daniel went back to the kitchen.']
2025-01-21 01:31:17.711 | INFO     | __main__:start_test:324 - Real Needle: [' Mary journeyed to the office.', ' Mary journeyed to the bathroom.', ' Mary dropped the football.']
2025-01-21 01:31:17.712 | INFO     | __main__:start_test:325 - =============================================
2025-01-21 01:31:17.795 | INFO     | __main__:start_test:348 - [(0, 1, 8), (0, 1, 9), (0, 2, 7), (3, 4, 9), (2, 6, 8), (0, 1, 7), (4, 6, 9), (1, 4, 5), (4, 5, 9), (2, 3, 8)]


  0%|          | 0/10 [00:00<?, ?it/s][A[A

Processing length: 3900 | task: 3-hop | depth (0, 1, 8):   0%|          | 0/10 [00:00<?, ?it/s][A[A2025-01-21 01:31:17.925 | INFO     | __main__:evaluate_and_log:275 - length of search pos and attack pos is not equal to the length of evidence and disturb_tok_needles, skip this case
2025-01-21 01:31:17.926 | INFO     | __main__:evaluate_and_log:276 - search_pos length: 2 | evidence length: 3
2025-01-21 01:31:17.927 | INFO     | __main__:evaluate_and_log:277 - attack_pos length: 5 | attack clues length: 5


Processing length: 3900 | task: 3-hop | depth (0, 1, 8):  10%|â–ˆ         | 1/10 [00:00<00:01,  7.75it/s][A[A

Processing length: 3900 | task: 3-hop | depth (0, 1, 9):  10%|â–ˆ         | 1/10 [00:00<00:01,  7.75it/s][A[A2025-01-21 01:31:18.034 | INFO     | __main__:evaluate_and_log:275 - length of search pos and attack pos is not equal to the length of evidence and disturb_tok_needles, skip this case
2025-01-21 01:31:18.036 | INFO     | __main__:evaluate_and_log:276 - search_pos length: 2 | evidence length: 3
2025-01-21 01:31:18.037 | INFO     | __main__:evaluate_and_log:277 - attack_pos length: 5 | attack clues length: 5


Processing length: 3900 | task: 3-hop | depth (0, 1, 9):  20%|â–ˆâ–ˆ        | 2/10 [00:00<00:00,  8.52it/s][A[A

Processing length: 3900 | task: 3-hop | depth (0, 2, 7):  20%|â–ˆâ–ˆ        | 2/10 [00:00<00:00,  8.52it/s][A[A2025-01-21 01:31:18.142 | INFO     | __main__:evaluate_and_log:275 - length of search pos and attack pos is not equal to the length of evidence and disturb_tok_needles, skip this case
2025-01-21 01:31:18.143 | INFO     | __main__:evaluate_and_log:276 - search_pos length: 2 | evidence length: 3
2025-01-21 01:31:18.144 | INFO     | __main__:evaluate_and_log:277 - attack_pos length: 5 | attack clues length: 5


Processing length: 3900 | task: 3-hop | depth (0, 2, 7):  30%|â–ˆâ–ˆâ–ˆ       | 3/10 [00:00<00:00,  8.86it/s][A[A

Processing length: 3900 | task: 3-hop | depth (3, 4, 9):  30%|â–ˆâ–ˆâ–ˆ       | 3/10 [00:00<00:00,  8.86it/s][A[AThe attention layers in this model are transitioning from computing the RoPE embeddings internally through `position_ids` (2D tensor with the indexes of the tokens), to using externally computed `position_embeddings` (Tuple of tensors, containing cos and sin). In v4.46 `position_ids` will be removed and `position_embeddings` will be mandatory.
2025-01-21 01:31:25.553 | INFO     | __main__:evaluate_and_log:295 - model response: The bedroom.
2025-01-21 01:31:25.563 | INFO     | __main__:evaluate_and_log:296 - gloden label: office


Processing length: 3900 | task: 3-hop | depth (3, 4, 9):  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 4/10 [00:07<00:18,  3.00s/it][A[A

Processing length: 3900 | task: 3-hop | depth (2, 6, 8):  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 4/10 [00:07<00:18,  3.00s/it][A[A2025-01-21 01:31:35.919 | INFO     | __main__:evaluate_and_log:295 - model response: kitchen
2025-01-21 01:31:35.927 | INFO     | __main__:evaluate_and_log:296 - gloden label: office


Processing length: 3900 | task: 3-hop | depth (2, 6, 8):  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 5/10 [00:18<00:28,  5.66s/it][A[A

Processing length: 3900 | task: 3-hop | depth (0, 1, 7):  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 5/10 [00:18<00:28,  5.66s/it][A[A2025-01-21 01:31:36.340 | INFO     | __main__:evaluate_and_log:275 - length of search pos and attack pos is not equal to the length of evidence and disturb_tok_needles, skip this case
2025-01-21 01:31:36.371 | INFO     | __main__:evaluate_and_log:276 - search_pos length: 2 | evidence length: 3
2025-01-21 01:31:36.389 | INFO     | __main__:evaluate_and_log:277 - attack_pos length: 5 | attack clues length: 5


Processing length: 3900 | task: 3-hop | depth (0, 1, 7):  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 6/10 [00:18<00:15,  3.89s/it][A[A

Processing length: 3900 | task: 3-hop | depth (4, 6, 9):  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 6/10 [00:18<00:15,  3.89s/it][A[A2025-01-21 01:31:42.944 | INFO     | __main__:evaluate_and_log:295 - model response: The bedroom.
2025-01-21 01:31:42.946 | INFO     | __main__:evaluate_and_log:296 - gloden label: office


Processing length: 3900 | task: 3-hop | depth (4, 6, 9):  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 7/10 [00:25<00:14,  4.76s/it][A[A

Processing length: 3900 | task: 3-hop | depth (1, 4, 5):  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 7/10 [00:27<00:14,  4.76s/it][A[A2025-01-21 01:31:54.358 | INFO     | __main__:evaluate_and_log:295 - model response: The kitchen.
2025-01-21 01:31:54.359 | INFO     | __main__:evaluate_and_log:296 - gloden label: office


Processing length: 3900 | task: 3-hop | depth (1, 4, 5):  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 8/10 [00:36<00:13,  6.88s/it][A[A

Processing length: 3900 | task: 3-hop | depth (4, 5, 9):  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 8/10 [00:36<00:13,  6.88s/it][A[A2025-01-21 01:32:00.729 | INFO     | __main__:evaluate_and_log:295 - model response: The bedroom.
2025-01-21 01:32:00.730 | INFO     | __main__:evaluate_and_log:296 - gloden label: office


Processing length: 3900 | task: 3-hop | depth (4, 5, 9):  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 9/10 [00:42<00:06,  6.72s/it][A[A

Processing length: 3900 | task: 3-hop | depth (2, 3, 8):  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 9/10 [00:42<00:06,  6.72s/it][A[A2025-01-21 01:32:05.661 | INFO     | __main__:evaluate_and_log:295 - model response: kitchen
2025-01-21 01:32:05.663 | INFO     | __main__:evaluate_and_log:296 - gloden label: office


Processing length: 3900 | task: 3-hop | depth (2, 3, 8): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10/10 [00:47<00:00,  6.17s/it][A[AProcessing length: 3900 | task: 3-hop | depth (2, 3, 8): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10/10 [00:47<00:00,  4.79s/it]
2025-01-21 01:32:05.672 | INFO     | __main__:start_test:320 - Selected idx: 2
2025-01-21 01:32:05.674 | INFO     | __main__:start_test:321 - Answer: office
2025-01-21 01:32:05.674 | INFO     | __main__:start_test:322 - Tag: 3-hop
2025-01-21 01:32:05.676 | INFO     | __main__:start_test:323 - Needle: [' Daniel went back to the kitchen.', ' Mary journeyed to the office.', ' Sandra journeyed to the bedroom.', ' John went back to the bedroom.', ' John journeyed to the office.', ' Mary journeyed to the bathroom.', ' John took the milk.', ' John moved to the bedroom.', ' Mary dropped the football.', ' Daniel went back to the hallway.']
2025-01-21 01:32:05.677 | INFO     | __main__:start_test:324 - Real Needle: [' Mary journeyed to the office.', ' Mary journeyed to the bathroom.', ' Mary dropped the football.']
2025-01-21 01:32:05.678 | INFO     | __main__:start_test:325 - =============================================
2025-01-21 01:32:05.701 | INFO     | __main__:start_test:348 - [(2, 3, 6), (4, 6, 8), (2, 3, 4), (0, 4, 9), (3, 4, 8), (1, 5, 7), (1, 4, 5), (4, 5, 9), (1, 3, 5), (1, 3, 6)]


  0%|          | 0/10 [00:00<?, ?it/s][A[A

Processing length: 3900 | task: 3-hop | depth (2, 3, 6):   0%|          | 0/10 [00:00<?, ?it/s][A[A2025-01-21 01:32:11.742 | INFO     | __main__:evaluate_and_log:295 - model response: bedroom
2025-01-21 01:32:11.745 | INFO     | __main__:evaluate_and_log:296 - gloden label: office


Processing length: 3900 | task: 3-hop | depth (2, 3, 6):  10%|â–ˆ         | 1/10 [00:06<00:54,  6.04s/it][A[A

Processing length: 3900 | task: 3-hop | depth (4, 6, 8):  10%|â–ˆ         | 1/10 [00:06<00:54,  6.04s/it][A[A2025-01-21 01:32:19.596 | INFO     | __main__:evaluate_and_log:295 - model response: The bedroom.
2025-01-21 01:32:19.598 | INFO     | __main__:evaluate_and_log:296 - gloden label: office


Processing length: 3900 | task: 3-hop | depth (4, 6, 8):  20%|â–ˆâ–ˆ        | 2/10 [00:13<00:56,  7.11s/it][A[A

Processing length: 3900 | task: 3-hop | depth (2, 3, 4):  20%|â–ˆâ–ˆ        | 2/10 [00:13<00:56,  7.11s/it][A[A2025-01-21 01:32:25.542 | INFO     | __main__:evaluate_and_log:295 - model response: bedroom
2025-01-21 01:32:25.544 | INFO     | __main__:evaluate_and_log:296 - gloden label: office


Processing length: 3900 | task: 3-hop | depth (2, 3, 4):  30%|â–ˆâ–ˆâ–ˆ       | 3/10 [00:19<00:46,  6.58s/it][A[A

Processing length: 3900 | task: 3-hop | depth (0, 4, 9):  30%|â–ˆâ–ˆâ–ˆ       | 3/10 [00:19<00:46,  6.58s/it][A[A2025-01-21 01:32:25.690 | INFO     | __main__:evaluate_and_log:275 - length of search pos and attack pos is not equal to the length of evidence and disturb_tok_needles, skip this case
2025-01-21 01:32:25.692 | INFO     | __main__:evaluate_and_log:276 - search_pos length: 2 | evidence length: 3
2025-01-21 01:32:25.693 | INFO     | __main__:evaluate_and_log:277 - attack_pos length: 7 | attack clues length: 7


Processing length: 3900 | task: 3-hop | depth (0, 4, 9):  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 4/10 [00:19<00:24,  4.04s/it][A[A

Processing length: 3900 | task: 3-hop | depth (3, 4, 8):  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 4/10 [00:19<00:24,  4.04s/it][A[A2025-01-21 01:32:31.610 | INFO     | __main__:evaluate_and_log:295 - model response: bedroom
2025-01-21 01:32:31.611 | INFO     | __main__:evaluate_and_log:296 - gloden label: office


Processing length: 3900 | task: 3-hop | depth (3, 4, 8):  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 5/10 [00:25<00:23,  4.72s/it][A[A

Processing length: 3900 | task: 3-hop | depth (1, 5, 7):  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 5/10 [00:25<00:23,  4.72s/it][A[A2025-01-21 01:32:37.467 | INFO     | __main__:evaluate_and_log:295 - model response: the bedroom
2025-01-21 01:32:37.468 | INFO     | __main__:evaluate_and_log:296 - gloden label: office


Processing length: 3900 | task: 3-hop | depth (1, 5, 7):  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 6/10 [00:31<00:20,  5.10s/it][A[A

Processing length: 3900 | task: 3-hop | depth (1, 4, 5):  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 6/10 [00:31<00:20,  5.10s/it][A[A2025-01-21 01:32:43.423 | INFO     | __main__:evaluate_and_log:295 - model response: the bedroom
2025-01-21 01:32:43.424 | INFO     | __main__:evaluate_and_log:296 - gloden label: office


Processing length: 3900 | task: 3-hop | depth (1, 4, 5):  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 7/10 [00:37<00:16,  5.38s/it][A[A

Processing length: 3900 | task: 3-hop | depth (4, 5, 9):  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 7/10 [00:37<00:16,  5.38s/it][A[A