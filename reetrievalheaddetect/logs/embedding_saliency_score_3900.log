nohup: å¿½ç•¥è¾“å…¥
2025-01-22 16:31:50.255 | INFO     | test_jbb_embedding:<module>:7 - ['/mnt/petrelfs/tangzecheng/MyRLHF/reetrievalheaddetect', '/mnt/petrelfs/tangzecheng/MyRLHF/reetrievalheaddetect/analysis', '/mnt/petrelfs/tangzecheng/anaconda3/envs/zecheng/lib/python310.zip', '/mnt/petrelfs/tangzecheng/anaconda3/envs/zecheng/lib/python3.10', '/mnt/petrelfs/tangzecheng/anaconda3/envs/zecheng/lib/python3.10/lib-dynload', '/mnt/petrelfs/tangzecheng/anaconda3/envs/zecheng/lib/python3.10/site-packages', '/mnt/petrelfs/tangzecheng/DeepSpeed', '/mnt/petrelfs/tangzecheng/modelzipper/src', '/mnt/petrelfs/tangzecheng/anaconda3/envs/zecheng/lib/python3.10/site-packages/setuptools/_vendor']
2025-01-22 16:31:52.563 | INFO     | __main__:<module>:11 - ['/mnt/petrelfs/tangzecheng/MyRLHF/reetrievalheaddetect', '/mnt/petrelfs/tangzecheng/MyRLHF/reetrievalheaddetect/faiss_attn', '/mnt/petrelfs/tangzecheng/MyRLHF/reetrievalheaddetect', '/mnt/petrelfs/tangzecheng/MyRLHF/reetrievalheaddetect/analysis', '/mnt/petrelfs/tangzecheng/anaconda3/envs/zecheng/lib/python310.zip', '/mnt/petrelfs/tangzecheng/anaconda3/envs/zecheng/lib/python3.10', '/mnt/petrelfs/tangzecheng/anaconda3/envs/zecheng/lib/python3.10/lib-dynload', '/mnt/petrelfs/tangzecheng/anaconda3/envs/zecheng/lib/python3.10/site-packages', '/mnt/petrelfs/tangzecheng/DeepSpeed', '/mnt/petrelfs/tangzecheng/modelzipper/src', '/mnt/petrelfs/tangzecheng/anaconda3/envs/zecheng/lib/python3.10/site-packages/setuptools/_vendor']
2025-01-22 16:31:53.396 | INFO     | __main__:<module>:82 - Selected idx: 0
2025-01-22 16:31:53.397 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the football before the bathroom? 
2025-01-22 16:31:53.397 | INFO     | __main__:<module>:84 - Answer: office
2025-01-22 16:31:53.397 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 16:31:53.397 | INFO     | __main__:<module>:86 - Needle: [' John went back to the bedroom.', ' Mary took the football.', ' John took the milk.', ' Sandra journeyed to the bedroom.', ' John journeyed to the office.', ' Mary journeyed to the office.', ' Mary journeyed to the bathroom.', ' Daniel went back to the kitchen.']
2025-01-22 16:31:53.397 | INFO     | __main__:<module>:87 - Real Needle: [' Mary took the football.', ' Mary journeyed to the office.', ' Mary journeyed to the bathroom.', ' Daniel went back to the kitchen.']
2025-01-22 16:31:53.397 | INFO     | __main__:<module>:88 - =============================================
ModelZipper is ready for launchğŸš€ | Current VersionğŸ¦„ >>> 0.2.7 <<< | AOE TimeğŸ•’ 2025-01-22 20:31:45
Process: 42243
begin to read data from ./haystack_for_detect/reasoning_needle_new.jsonl | file size: 246.97 KB | file type: jsonl
begin to testing with [3900]
  0%|          | 0/100 [00:00<?, ?it/s]You are attempting to use Flash Attention 2.0 without specifying a torch dtype. This might lead to unexpected behaviour

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.07s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.08s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.46s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.17s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.56s/it]
Processing depth (0, 3, 6, 8):   0%|          | 0/100 [00:19<?, ?it/s]2025-01-22 16:32:12.720 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary took the football.
2025-01-22 16:32:12.763 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the office.
2025-01-22 16:32:12.775 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2058, 2064) -->  John journeyed to the office
2025-01-22 16:32:12.775 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bathroom.
2025-01-22 16:32:12.791 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2900, 2906) --> . Mary journeyed to the
2025-01-22 16:32:12.791 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went back to the kitchen.
2025-01-22 16:32:12.831 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6527, 6533) --> . Daniel went back to the
2025-01-22 16:32:12.832 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the bedroom.
2025-01-22 16:32:12.854 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3994, 4000) -->  John went back to the bedroom
2025-01-22 16:32:12.854 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John took the milk.
2025-01-22 16:32:12.892 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (7239, 7243) -->  John took the milk
2025-01-22 16:32:12.892 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra journeyed to the bedroom.
2025-01-22 16:32:12.907 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2049, 2055) -->  cable. Sandra journeyed to
2025-01-22 16:32:12.907 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the office.
2025-01-22 16:32:12.919 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2053, 2059) --> ed to the bedroom. John
2025-01-22 16:32:12.919 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 16:32:12.919 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 16:32:12.919 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 16:32:12.919 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['\U0001faf4ğŸ½', 'ğŸ‘¨ğŸ¿\u200dâš•', 'ğŸ§‘\u200dğŸš€', 'ğŸ‘¨\u200dğŸ¤', 'ğŸ–Œï¸', 'ğŸ‘·ğŸ½\u200dâ™‚', 'ğŸ‘³ğŸ»', 'ğŸ‘¨ğŸ¾\u200dğŸš€', 'ğŸ›', 'â›¹ğŸ»\u200dâ™‚']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:05<00:15,  5.07s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.95s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.51s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.15s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.74s/it]
Processing depth (0, 4, 5, 9):   0%|          | 0/100 [00:36<?, ?it/s]2025-01-22 16:32:29.804 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary took the football.
2025-01-22 16:32:29.849 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the office.
2025-01-22 16:32:29.862 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2140, 2146) -->  John journeyed to the office
2025-01-22 16:32:29.862 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bathroom.
2025-01-22 16:32:29.881 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3645, 3651) -->  Hon. Mary journeyed to
2025-01-22 16:32:29.882 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went back to the kitchen.
2025-01-22 16:32:29.922 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7172, 7178) -->  Daniel went back to the kitchen
2025-01-22 16:32:29.922 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the bedroom.
2025-01-22 16:32:29.944 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4069, 4075) --> . John went back to the
2025-01-22 16:32:29.944 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John took the milk.
2025-01-22 16:32:29.979 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (7291, 7295) -->  John took the milk
2025-01-22 16:32:29.979 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra journeyed to the bedroom.
2025-01-22 16:32:29.990 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2132, 2138) --> . Sandra journeyed to the
2025-01-22 16:32:29.990 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the office.
2025-01-22 16:32:30.002 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2135, 2141) --> ed to the bedroom. John
2025-01-22 16:32:30.003 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 16:32:30.003 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 16:32:30.003 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 16:32:30.003 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ‘¨ğŸ»\u200dâ¤ï¸\u200dğŸ‘¨ğŸ¾', 'ğŸ§‘ğŸ½\u200dğŸ¦²', 'ğŸ’‡ğŸ»\u200dâ™€ï¸', 'ğŸ”š', '\U0001faf1ğŸ½\u200d\U0001faf2ğŸ¿', 'ğŸ§‘ğŸ¿\u200dğŸ«', 'ğŸ™ğŸ¾\u200dâ™€', 'ğŸ§‘ğŸ»\u200dğŸ¤\u200dğŸ§‘ğŸ»', 'ğŸ¬', 'ğŸ¤³ğŸ¼']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.72s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:08,  4.48s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.36s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.03s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.56s/it]
Processing depth (1, 2, 5, 9):   0%|          | 0/100 [00:52<?, ?it/s]2025-01-22 16:32:46.118 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary took the football.
2025-01-22 16:32:46.122 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (782, 786) -->  Mary took the football
2025-01-22 16:32:46.122 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the office.
2025-01-22 16:32:46.131 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1798, 1804) --> . Mary journeyed to the
2025-01-22 16:32:46.132 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bathroom.
2025-01-22 16:32:46.141 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1798, 1804) --> . Mary journeyed to the
2025-01-22 16:32:46.141 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went back to the kitchen.
2025-01-22 16:32:46.179 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7166, 7172) -->  Daniel went back to the kitchen
2025-01-22 16:32:46.179 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the bedroom.
2025-01-22 16:32:46.202 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3971, 3977) -->  the ground. John went back
2025-01-22 16:32:46.202 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John took the milk.
2025-01-22 16:32:46.237 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (7285, 7289) -->  John took the milk
2025-01-22 16:32:46.237 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra journeyed to the bedroom.
2025-01-22 16:32:46.248 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2137, 2143) --> . Sandra journeyed to the
2025-01-22 16:32:46.248 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the office.
2025-01-22 16:32:46.257 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1799, 1805) -->  Mary journeyed to the office
/mnt/petrelfs/tangzecheng/anaconda3/envs/zecheng/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:590: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/mnt/petrelfs/tangzecheng/anaconda3/envs/zecheng/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:595: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
The attention mask is not set and cannot be inferred from input because pad token is same as eos token. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
2025-01-22 16:32:49.475 | INFO     | test_jbb_embedding:begin_test:693 - Mary took the football.<|eot_id|>
2025-01-22 16:32:49.475 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8215])
2025-01-22 16:32:51.905 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [489.54971590909093, 37.380396586345384, 229.7002840909091, 35.64556695827726, 15.69490470467033], 'topk_indices': array([   9, 8202, 8143, 8103, 8113, 8214,  781,  784, 8069,  782,    1,
        783,   24,  786,    3,   14, 8213, 8210,  785,    0]), 'topk_tokens': [':', ' football', ' the', '.\n\n', ' location', '\n\n', '.', ' the', ' context', ' Mary', '<|start_header_id|>', ' took', '\n\n', '.', '<|end_header_id|>', '\n', '<|end_header_id|>', '<|eot_id|>', ' football', '<|begin_of_text|>'], 'evidence_proportions': [1490.0, 368.2916666666667, 368.2916666666667, 65.09895833333333]}, 'weight': {'score': [22.551136363636363, 23.297829575879273, 22.9609375, 23.30074635996574, 29.101304945054945], 'topk_indices': array([3342, 3315, 3235, 3187, 7462, 7500, 1496, 1434, 4308, 4324, 5180,
       5119, 7178, 7234, 3498, 3524, 4896, 4973, 4944, 4921]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.498046875, 20.052083333333332, 20.052083333333332, 24.91796875]}, 'saliency': {'score': [3.114382657137784, 0.20624833317645583, 1.3593916459517046, 0.19531622648268307, 0.11244905911959134], 'topk_indices': array([8112, 8103, 2138, 8208, 8184, 8197, 8109,    8, 4170, 8214, 8212,
       8205,   24, 2143, 8113, 8202,  783, 8069,  782,  785]), 'topk_tokens': [' first', '.\n\n', ' Sandra', 'Answer', ' return', 'Question', ' item', ' Date', ' bathroom', '\n\n', 'assistant', ' bathroom', '\n\n', ' bedroom', ' location', ' football', ' took', ' context', ' Mary', ' football'], 'evidence_proportions': [10.51416015625, 1.9855143229166667, 1.9855143229166667, 0.438934326171875]}}, 'pred_res': 'Mary took the football.<|eot_id|>', 'score': 0}
2025-01-22 16:32:51.910 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 16:32:51.910 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-0_pid-0_1-2-5-9.pkl | len: 3 |  size: 2.05 KB
Processing depth (1, 2, 5, 9):   1%|          | 1/100 [00:58<1:36:12, 58.31s/it]is_0k: False
your chose emoji: ['ğŸ’ğŸ¾', 'ğŸ§‘ğŸ»\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ§‘ğŸ¿', 'ğŸ’‚ğŸ¿', 'ğŸ™†ğŸ»', 'â˜ ', 'ğŸ§‘ğŸ½\u200dğŸ¤\u200dğŸ§‘ğŸ¿', 'ğŸ‘¨ğŸ¼\u200dğŸš’', 'ğŸ§‘ğŸ¿\u200dâ¤\u200dğŸ§‘ğŸ½', 'ğŸ¤ŸğŸ½', 'ğŸ‡¨ğŸ‡®']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.62s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.90s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.72s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.24s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.80s/it]
Processing depth (2, 4, 5, 6):   1%|          | 1/100 [01:15<1:36:12, 58.31s/it]2025-01-22 16:33:08.980 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary took the football.
2025-01-22 16:33:08.990 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1786, 1790) -->  Mary took the football
2025-01-22 16:33:08.990 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the office.
2025-01-22 16:33:09.001 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2130, 2136) -->  John journeyed to the office
2025-01-22 16:33:09.001 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bathroom.
2025-01-22 16:33:09.020 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3646, 3652) --> . Mary journeyed to the
2025-01-22 16:33:09.020 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went back to the kitchen.
2025-01-22 16:33:09.047 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4809, 4815) -->  the senate. Daniel went back
2025-01-22 16:33:09.047 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the bedroom.
2025-01-22 16:33:09.068 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4071, 4077) --> . John went back to the
2025-01-22 16:33:09.068 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John took the milk.
2025-01-22 16:33:09.104 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (7259, 7263) -->  John took the milk
2025-01-22 16:33:09.104 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra journeyed to the bedroom.
2025-01-22 16:33:09.115 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2122, 2128) --> . Sandra journeyed to the
2025-01-22 16:33:09.115 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the office.
2025-01-22 16:33:09.126 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2125, 2131) --> ed to the bedroom. John
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 16:33:09.905 | INFO     | test_jbb_embedding:begin_test:693 - the office<|eot_id|>
2025-01-22 16:33:09.906 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8187])
2025-01-22 16:33:12.140 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [485.0759943181818, 38.21303730614239, 450.0582386363636, 35.89362914364641, 31.12015523538961], 'topk_indices': array([  14, 3652, 8180, 2125, 1755, 8041, 2123, 8174, 2135, 8085, 1790,
       8170, 8177, 2128, 8175, 8181, 8183, 1789, 8182,    0]), 'topk_tokens': ['\n', ' office', 'Answer', 'ed', ' The', ' context', ' Sandra', ' football', ' office', ' location', '.', ':', ' bathroom', ' bedroom', ' before', ':', '<|start_header_id|>', ' football', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [989.875, 595.125, 492.6666666666667, 30.903645833333332]}, 'weight': {'score': [23.275568181818183, 23.287901453168885, 21.294389204545453, 23.293319329343156, 29.6286525974026], 'topk_indices': array([3294, 3321, 3166, 3214, 7436, 7474, 1477, 1415, 4330, 4346, 5247,
       5186, 7208, 7152, 3539, 3513, 4937, 4962, 5014, 4985]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.498046875, 22.759114583333332, 20.052083333333332, 24.8671875]}, 'saliency': {'score': [3.0186920166015625, 0.21478558436813103, 2.483978271484375, 0.20108292253563345, 0.23048668403130074], 'topk_indices': array([8181, 8171, 3648, 1787, 2131, 1786, 2124, 3652, 4258, 8085, 8169,
       8041, 2135, 8180, 8174, 8175, 2123, 8177, 2128, 1789]), 'topk_tokens': [':', ' Where', ' journey', ' took', ' journey', ' Mary', ' journey', ' office', ' bathroom', ' location', 'Question', ' context', ' office', 'Answer', ' football', ' before', ' Sandra', ' bathroom', ' bedroom', ' football'], 'evidence_proportions': [6.9638671875, 3.58447265625, 2.6490071614583335, 0.19247945149739584]}}, 'pred_res': 'the office<|eot_id|>', 'score': 100}
2025-01-22 16:33:12.147 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 16:33:12.147 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-0_pid-1_2-4-5-6.pkl | len: 3 |  size: 2.04 KB
Processing depth (2, 4, 5, 6):   2%|â–         | 2/100 [01:18<58:39, 35.91s/it]  is_0k: False
your chose emoji: ['ğŸ§Š', 'ğŸ§ğŸ½\u200dâ™‚ï¸\u200dâ¡', 'ğŸ‘¨ğŸ»\u200dğŸ¦¯\u200dâ¡ï¸', '\U0001fabf', '\U0001fac4ğŸ¿', 'ğŸ™‹ğŸ¿\u200dâ™€', 'ğŸ§‘ğŸ¼\u200dâ¤\u200dğŸ’‹\u200dğŸ§‘ğŸ¾', '5ï¸âƒ£', 'ğŸ’µ', 'ğŸ‡¹ğŸ‡¼']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.03s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.96s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.86s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.40s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.88s/it]
Processing depth (3, 4, 5, 8):   2%|â–         | 2/100 [01:35<58:39, 35.91s/it]2025-01-22 16:33:29.427 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary took the football.
2025-01-22 16:33:29.441 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2922, 2926) -->  Mary took the football
2025-01-22 16:33:29.441 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the office.
2025-01-22 16:33:29.452 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2189, 2195) -->  John journeyed to the office
2025-01-22 16:33:29.453 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bathroom.
2025-01-22 16:33:29.471 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3622, 3628) --> . Mary journeyed to the
2025-01-22 16:33:29.471 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went back to the kitchen.
2025-01-22 16:33:29.508 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6629, 6635) --> . Daniel went back to the
2025-01-22 16:33:29.509 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the bedroom.
2025-01-22 16:33:29.529 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4081, 4087) --> . John went back to the
2025-01-22 16:33:29.529 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John took the milk.
2025-01-22 16:33:29.564 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (7257, 7261) -->  John took the milk
2025-01-22 16:33:29.564 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra journeyed to the bedroom.
2025-01-22 16:33:29.577 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2181, 2187) --> . Sandra journeyed to the
2025-01-22 16:33:29.577 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the office.
2025-01-22 16:33:29.590 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2184, 2190) --> ed to the bedroom. John
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 16:33:30.361 | INFO     | test_jbb_embedding:begin_test:693 - the office<|eot_id|>
2025-01-22 16:33:30.361 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8151])
2025-01-22 16:33:32.588 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [475.41477272727275, 29.082592297313873, 286.4588068181818, 27.173406862745097, 28.464049258474578], 'topk_indices': array([3627, 8141, 8134,   24, 8039, 8138, 8049, 2921, 2926, 2188, 8139,
       2893, 8145,   14, 2923, 2922, 8149, 2925, 8146,    0]), 'topk_tokens': [' the', ' bathroom', ':', '\n\n', '.\n\n', ' football', ' location', '.', '.', '.', ' before', '.', ':', '\n', ' took', ' Mary', '<|end_header_id|>', ' football', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [1106.625, 375.6666666666667, 595.0, 34.770833333333336]}, 'weight': {'score': [22.200994318181817, 23.25351864344413, 21.294389204545453, 23.26168936521149, 29.1875], 'topk_indices': array([3260, 3287, 3180, 3132, 7376, 7414, 1473, 1411, 4276, 4260, 5085,
       5146, 7148, 7092, 3469, 3443, 4896, 4925, 4848, 4873]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.498046875, 22.759114583333332, 20.052083333333332, 20.927083333333332]}, 'saliency': {'score': [2.872994162819602, 0.1609978958330139, 1.5029352361505681, 0.1499994324761646, 0.2056434760659428], 'topk_indices': array([8120, 2892, 2894, 2194, 2928, 3628, 2182, 2920, 8133, 8144, 3624,
       8139, 8049, 4254, 2187, 8138, 8141, 2923, 2922, 2925]), 'topk_tokens': [' return', ' Gov', ' During', ' office', 'ible', ' office', ' Sandra', ' Gov', 'Question', 'Answer', ' journey', ' before', ' location', ' bathroom', ' bedroom', ' football', ' bathroom', ' took', ' Mary', ' football'], 'evidence_proportions': [7.836181640625, 2.1853841145833335, 2.9329427083333335, 0.191864013671875]}}, 'pred_res': 'the office<|eot_id|>', 'score': 100}
2025-01-22 16:33:32.595 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 16:33:32.595 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-0_pid-2_3-4-5-8.pkl | len: 3 |  size: 2.01 KB
Processing depth (3, 4, 5, 8):   3%|â–         | 3/100 [01:38<46:38, 28.85s/it]is_0k: False
your chose emoji: ['âœ´', 'ğŸ‡¬ğŸ‡¦', 'ğŸ‘¨ğŸ»', 'âœ‰', 'ğŸ¤œğŸ»', 'ğŸ‘¨\u200dğŸ¦½', 'ğŸ§Ÿ\u200dâ™€', 'ğŸ“¬', 'ğŸŒï¸\u200dâ™‚', 'ğŸ§‘ğŸ¼\u200dâ¤\u200dğŸ§‘ğŸ¿']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  3.96s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:09,  4.54s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.74s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.28s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.73s/it]
Processing depth (0, 2, 4, 8):   3%|â–         | 3/100 [01:55<46:38, 28.85s/it]2025-01-22 16:33:49.149 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary took the football.
2025-01-22 16:33:49.191 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the office.
2025-01-22 16:33:49.202 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1778, 1784) --> . Mary journeyed to the
2025-01-22 16:33:49.203 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bathroom.
2025-01-22 16:33:49.212 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1778, 1784) --> . Mary journeyed to the
2025-01-22 16:33:49.212 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went back to the kitchen.
2025-01-22 16:33:49.245 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6573, 6579) --> . Daniel went back to the
2025-01-22 16:33:49.245 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the bedroom.
2025-01-22 16:33:49.268 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4054, 4060) --> . John went back to the
2025-01-22 16:33:49.268 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John took the milk.
2025-01-22 16:33:49.306 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (7251, 7255) -->  John took the milk
2025-01-22 16:33:49.306 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra journeyed to the bedroom.
2025-01-22 16:33:49.317 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2117, 2123) --> . Sandra journeyed to the
2025-01-22 16:33:49.317 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the office.
2025-01-22 16:33:49.326 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1779, 1785) -->  Mary journeyed to the office
2025-01-22 16:33:49.326 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 16:33:49.326 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 16:33:49.326 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 16:33:49.327 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ§—ğŸ»\u200dâ™€ï¸', 'â—€ï¸', 'ğŸ˜¥', 'ğŸ™‡ğŸ»\u200dâ™‚ï¸', 'â˜„ï¸', 'ğŸ­', 'ğŸ‘«ğŸ¿', 'ğŸ‡¸ğŸ‡¬', 'ğŸ«’', 'ğŸ§‘ğŸ¾\u200dğŸ¨']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.65s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.63s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.39s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.00s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.56s/it]
Processing depth (1, 2, 5, 7):   3%|â–         | 3/100 [02:11<46:38, 28.85s/it]2025-01-22 16:34:05.376 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary took the football.
2025-01-22 16:34:05.381 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (762, 766) -->  Mary took the football
2025-01-22 16:34:05.381 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the office.
2025-01-22 16:34:05.392 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1778, 1784) --> . Mary journeyed to the
2025-01-22 16:34:05.392 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bathroom.
2025-01-22 16:34:05.403 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1778, 1784) --> . Mary journeyed to the
2025-01-22 16:34:05.404 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went back to the kitchen.
2025-01-22 16:34:05.433 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5729, 5735) --> . Daniel went back to the
2025-01-22 16:34:05.433 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the bedroom.
2025-01-22 16:34:05.454 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4039, 4045) --> . John went back to the
2025-01-22 16:34:05.454 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John took the milk.
2025-01-22 16:34:05.493 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (7279, 7283) -->  John took the milk
2025-01-22 16:34:05.493 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra journeyed to the bedroom.
2025-01-22 16:34:05.506 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2117, 2123) --> . Sandra journeyed to the
2025-01-22 16:34:05.506 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the office.
2025-01-22 16:34:05.517 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1779, 1785) -->  Mary journeyed to the office
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 16:34:06.350 | INFO     | test_jbb_embedding:begin_test:693 - Mary took the football.<|eot_id|>
2025-01-22 16:34:06.350 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8151])
2025-01-22 16:34:08.603 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [449.40767045454544, 41.887296087329815, 177.44460227272728, 40.41390738685411, 25.860566737288135], 'topk_indices': array([4246,  764,   14,   24,    1,  763, 4237,    3, 8078,  762, 8005,
       8049, 4235, 4234,  766, 8149, 8079,  765, 8146,    0]), 'topk_tokens': ['ree', ' the', '\n', '\n\n', '<|start_header_id|>', ' took', 'outs', '<|end_header_id|>', ' to', ' Mary', ' context', ' location', 'ch', 'ree', '.', '<|end_header_id|>', ' the', ' football', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [1538.75, 265.0625, 265.0625, 91.86979166666667]}, 'weight': {'score': [21.462713068181817, 23.257968692505827, 22.224431818181817, 23.265643305278086, 29.494968220338983], 'topk_indices': array([3288, 3261, 3181, 3133, 7436, 7398, 1476, 1414, 4298, 4314, 5184,
       5123, 7114, 7170, 3456, 3482, 4925, 4948, 4900, 4977]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.498046875, 20.052083333333332, 20.052083333333332, 20.927083333333332]}, 'saliency': {'score': [2.8643909801136362, 0.23133352825455353, 1.0317604758522727, 0.2220183652519577, 0.1894820908368644], 'topk_indices': array([8051, 8120, 8148, 8048, 8004, 8133, 4236, 8039,   24, 8138, 8077,
       4246,  763, 4235, 4237, 8005, 8049,  762, 4234,  765]), 'topk_tokens': [' traveled', ' return', 'assistant', ' first', ' you', 'Question', ' Cl', '.\n\n', '\n\n', ' football', ' moved', 'ree', ' took', 'ch', 'outs', ' context', ' location', ' Mary', 'ree', ' football'], 'evidence_proportions': [10.78076171875, 1.3873697916666667, 1.3873697916666667, 0.5408528645833334]}}, 'pred_res': 'Mary took the football.<|eot_id|>', 'score': 0}
2025-01-22 16:34:08.609 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 16:34:08.609 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-0_pid-3_1-2-5-7.pkl | len: 3 |  size: 2.03 KB
Processing depth (1, 2, 5, 7):   4%|â–         | 4/100 [02:15<50:41, 31.68s/it]is_0k: False
your chose emoji: ['ğŸ', 'ğŸ•', 'ğŸ‘©ğŸ»\u200dâ¤ï¸\u200dğŸ‘©ğŸ¾', 'ğŸ¤·\u200dâ™‚ï¸', 'ğŸ”', 'ğŸ‡¨ğŸ‡²', 'ğŸš¶ğŸ»\u200dâ™‚ï¸\u200dâ¡', 'ğŸ’°', 'ğŸ“¤', 'â›²']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.97s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.41s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:15<00:04,  4.98s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  3.44s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  4.06s/it]
Processing depth (0, 4, 5, 6):   4%|â–         | 4/100 [02:32<50:41, 31.68s/it]2025-01-22 16:34:26.547 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary took the football.
2025-01-22 16:34:26.588 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the office.
2025-01-22 16:34:26.601 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2188, 2194) -->  John journeyed to the office
2025-01-22 16:34:26.601 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bathroom.
2025-01-22 16:34:26.620 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3628, 3634) --> . Mary journeyed to the
2025-01-22 16:34:26.620 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went back to the kitchen.
2025-01-22 16:34:26.645 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4889, 4895) --> . Daniel went back to the
2025-01-22 16:34:26.645 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the bedroom.
2025-01-22 16:34:26.665 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4047, 4053) --> . John went back to the
2025-01-22 16:34:26.665 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John took the milk.
2025-01-22 16:34:26.704 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (7299, 7303) -->  John took the milk
2025-01-22 16:34:26.704 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra journeyed to the bedroom.
2025-01-22 16:34:26.715 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2180, 2186) --> . Sandra journeyed to the
2025-01-22 16:34:26.715 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the office.
2025-01-22 16:34:26.726 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2183, 2189) --> ed to the bedroom. John
2025-01-22 16:34:26.726 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 16:34:26.726 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 16:34:26.726 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 16:34:26.726 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸŒ¨ï¸', 'ğŸ‘¨ğŸ¾\u200dâ¤ï¸\u200dğŸ‘¨ğŸ¾', 'ğŸ‘¨ğŸ¾\u200dğŸ¤', 'ğŸ¦¶ğŸ½', 'ğŸ§‘ğŸ½\u200dâœˆ', 'ğŸ‘©ğŸ¾\u200dâ¤ï¸\u200dğŸ‘¨ğŸ½', 'ğŸ§™ğŸ»\u200dâ™€', 'ğŸ“—', 'ğŸ§ğŸ¼\u200dâ™€', 'ğŸ‘©ğŸ»\u200dâ¤ï¸\u200dğŸ‘©ğŸ¿']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.68s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.99s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:15<00:05,  5.18s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  3.53s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  4.07s/it]
Processing depth (1, 2, 4, 6):   4%|â–         | 4/100 [02:51<50:41, 31.68s/it]2025-01-22 16:34:44.718 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary took the football.
2025-01-22 16:34:44.722 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (816, 820) -->  Mary took the football
2025-01-22 16:34:44.722 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the office.
2025-01-22 16:34:44.732 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1794, 1800) --> . Mary journeyed to the
2025-01-22 16:34:44.732 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bathroom.
2025-01-22 16:34:44.741 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1794, 1800) --> . Mary journeyed to the
2025-01-22 16:34:44.741 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went back to the kitchen.
2025-01-22 16:34:44.765 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4783, 4789) --> . Daniel went back to the
2025-01-22 16:34:44.765 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the bedroom.
2025-01-22 16:34:44.786 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4008, 4014) -->  the ground. John went back
2025-01-22 16:34:44.786 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John took the milk.
2025-01-22 16:34:44.822 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (7323, 7327) -->  John took the milk
2025-01-22 16:34:44.822 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra journeyed to the bedroom.
2025-01-22 16:34:44.835 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2056, 2062) -->  Sandra journeyed to the bedroom
2025-01-22 16:34:44.835 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the office.
2025-01-22 16:34:44.846 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1795, 1801) -->  Mary journeyed to the office
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 16:34:45.706 | INFO     | test_jbb_embedding:begin_test:693 - Mary took the football.<|eot_id|>
2025-01-22 16:34:45.706 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8207])
2025-01-22 16:34:48.131 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [588.6264204545455, 39.15890714459739, 241.6345880681818, 37.132850773116964, 26.22375628591954], 'topk_indices': array([8060, 8206, 8135,   23, 8105,  815,    1,   24, 3135, 8061,  816,
       8205,  818,    3,   14,  817,  820, 8202,    0,  819]), 'topk_tokens': [' you', '\n\n', ' the', '4', ' location', '.', '<|start_header_id|>', '\n\n', 'ern', ' context', ' Mary', '<|end_header_id|>', ' the', '<|end_header_id|>', '\n', ' took', '.', '<|eot_id|>', '<|begin_of_text|>', ' football'], 'evidence_proportions': [1806.75, 448.4791666666667, 448.4791666666667, 56.838541666666664]}, 'weight': {'score': [21.462713068181817, 23.304659900718722, 24.19424715909091, 23.307225964482548, 29.69037356321839], 'topk_indices': array([3342, 3315, 3235, 3187, 7480, 7442, 1472, 1410, 4354, 4338, 5249,
       5188, 7214, 7158, 3524, 3498, 5013, 5042, 4990, 4965]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.498046875, 20.052083333333332, 20.052083333333332, 20.927083333333332]}, 'saliency': {'score': [3.746102072975852, 0.2172367980265562, 1.5599115545099431, 0.20411078691920545, 0.19691011275368175], 'topk_indices': array([ 818, 8206,   23,    0, 8204, 3637, 8060, 8195, 1796,   24, 2061,
       8197, 8194, 3134, 8105, 3135, 8061,  816,  817,  819]), 'topk_tokens': [' the', '\n\n', '4', '<|begin_of_text|>', 'assistant', ' bathroom', ' you', ' before', ' journey', '\n\n', ' bedroom', ' bathroom', ' football', ' const', ' location', 'ern', ' context', ' Mary', ' took', ' football'], 'evidence_proportions': [12.6474609375, 2.5009765625, 2.5009765625, 0.3021138509114583]}}, 'pred_res': 'Mary took the football.<|eot_id|>', 'score': 0}
2025-01-22 16:34:48.135 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 16:34:48.136 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-0_pid-4_1-2-4-6.pkl | len: 3 |  size: 2.04 KB
Processing depth (1, 2, 4, 6):   5%|â–Œ         | 5/100 [02:54<54:38, 34.51s/it]Processing depth (1, 2, 4, 6):   5%|â–Œ         | 5/100 [02:54<55:17, 34.92s/it]
2025-01-22 16:34:48.221 | INFO     | __main__:<module>:82 - Selected idx: 2
2025-01-22 16:34:48.221 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the football before the bathroom? 
2025-01-22 16:34:48.221 | INFO     | __main__:<module>:84 - Answer: office
2025-01-22 16:34:48.221 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 16:34:48.221 | INFO     | __main__:<module>:86 - Needle: [' Daniel went back to the kitchen.', ' John went back to the bedroom.', ' Mary took the football.', ' John journeyed to the office.', ' John moved to the bedroom.', ' Mary journeyed to the office.', ' Sandra journeyed to the bedroom.', ' John took the milk.', ' Mary journeyed to the bathroom.', ' Daniel went back to the hallway.']
2025-01-22 16:34:48.221 | INFO     | __main__:<module>:87 - Real Needle: [' Mary took the football.', ' Mary journeyed to the office.', ' Mary journeyed to the bathroom.', ' Daniel went back to the hallway.']
2025-01-22 16:34:48.221 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸš£ğŸ¼\u200dâ™‚ï¸', 'ğŸ‘·ğŸ¼\u200dâ™‚ï¸', 'ğŸšµğŸ¾\u200dâ™‚', 'ğŸ“ª', 'ğŸ§ğŸ¼\u200dâ™‚', 'ğŸ§œ\u200dâ™€ï¸', 'ğŸ§‘ğŸ¼\u200dâ¤\u200dğŸ§‘ğŸ¿', 'ğŸ¤˜ğŸ¿', 'ğŸ‘©ğŸ¾\u200dâ¤ï¸\u200dğŸ‘¨ğŸ¿', 'ğŸ±']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.86s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.12s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.90s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.31s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.92s/it]
Processing depth (0, 6, 7, 9):   0%|          | 0/100 [00:17<?, ?it/s]2025-01-22 16:35:05.659 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary took the football.
2025-01-22 16:35:05.703 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the office.
2025-01-22 16:35:05.727 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4722, 4728) -->  the senate. Mary journeyed
2025-01-22 16:35:05.727 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bathroom.
2025-01-22 16:35:05.751 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4722, 4728) -->  the senate. Mary journeyed
2025-01-22 16:35:05.752 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went back to the hallway.
2025-01-22 16:35:05.787 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6998, 7004) --> . Daniel went back to the
2025-01-22 16:35:05.787 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went back to the kitchen.
2025-01-22 16:35:05.823 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6998, 7004) --> . Daniel went back to the
2025-01-22 16:35:05.823 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the bedroom.
2025-01-22 16:35:05.857 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6885, 6891) --> . John went back to the
2025-01-22 16:35:05.858 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the office.
2025-01-22 16:35:05.881 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4725, 4731) -->  Mary journeyed to the office
2025-01-22 16:35:05.881 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John moved to the bedroom.
2025-01-22 16:35:05.887 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1054, 1059) --> . John moved to the
2025-01-22 16:35:05.887 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra journeyed to the bedroom.
2025-01-22 16:35:05.913 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5167, 5173) --> . Sandra journeyed to the
2025-01-22 16:35:05.913 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John took the milk.
2025-01-22 16:35:05.940 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (5499, 5503) -->  John took the milk
2025-01-22 16:35:05.940 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 16:35:05.940 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 16:35:05.940 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 16:35:05.940 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ¾', 'ğŸ”•', 'âœ”ï¸', 'ğŸ‘ˆğŸ»', 'ğŸšï¸', '\U0001faf1ğŸ¿', 'âœ', 'ğŸ‘©\u200dâš–', 'ğŸ›ŒğŸ»', 'ğŸ‘¨ğŸ½\u200dğŸ“']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.08s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.59s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.95s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.42s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.87s/it]
Processing depth (0, 2, 4, 9):   0%|          | 0/100 [00:34<?, ?it/s]2025-01-22 16:35:23.144 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary took the football.
2025-01-22 16:35:23.187 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the office.
2025-01-22 16:35:23.199 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1858, 1864) --> . Mary journeyed to the
2025-01-22 16:35:23.199 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bathroom.
2025-01-22 16:35:23.210 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1858, 1864) --> . Mary journeyed to the
2025-01-22 16:35:23.211 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went back to the hallway.
2025-01-22 16:35:23.247 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7010, 7016) --> . Daniel went back to the
2025-01-22 16:35:23.247 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went back to the kitchen.
2025-01-22 16:35:23.284 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (7010, 7016) --> . Daniel went back to the
2025-01-22 16:35:23.285 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the bedroom.
2025-01-22 16:35:23.326 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6923, 6929) --> . John went back to the
2025-01-22 16:35:23.326 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the office.
2025-01-22 16:35:23.337 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1859, 1865) -->  Mary journeyed to the office
2025-01-22 16:35:23.337 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John moved to the bedroom.
2025-01-22 16:35:23.343 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1219, 1224) -->  Republican. John moved to
2025-01-22 16:35:23.343 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra journeyed to the bedroom.
2025-01-22 16:35:23.370 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5076, 5082) --> . Sandra journeyed to the
2025-01-22 16:35:23.370 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John took the milk.
2025-01-22 16:35:23.398 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (5266, 5270) -->  John took the milk
2025-01-22 16:35:23.399 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 16:35:23.399 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 16:35:23.399 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 16:35:23.399 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ‘©ğŸ»\u200dâ¤\u200dğŸ‘¨ğŸ¿', 'ğŸ¤¦ğŸ¿\u200dâ™€', 'ğŸ‡²ğŸ‡«', 'ğŸ‡¬ğŸ‡¸', 'ğŸ‘¨ğŸ¾\u200dğŸš€', 'ğŸ§™ğŸ¾\u200dâ™‚ï¸', 'â¤µ', 'ğŸ§–ğŸ½\u200dâ™€', 'ğŸ¤œğŸ»', 'ğŸ‘¨ğŸ½\u200dâš–ï¸']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.58s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.63s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.65s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.27s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.77s/it]
Processing depth (1, 3, 7, 9):   0%|          | 0/100 [00:52<?, ?it/s]2025-01-22 16:35:40.474 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary took the football.
2025-01-22 16:35:40.479 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (808, 812) -->  Mary took the football
2025-01-22 16:35:40.480 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the office.
2025-01-22 16:35:40.498 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2918, 2924) --> . Mary journeyed to the
2025-01-22 16:35:40.498 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bathroom.
2025-01-22 16:35:40.516 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2918, 2924) --> . Mary journeyed to the
2025-01-22 16:35:40.517 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went back to the hallway.
2025-01-22 16:35:40.555 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7078, 7084) --> . Daniel went back to the
2025-01-22 16:35:40.555 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went back to the kitchen.
2025-01-22 16:35:40.599 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (7078, 7084) --> . Daniel went back to the
2025-01-22 16:35:40.599 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the bedroom.
2025-01-22 16:35:40.638 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6965, 6971) --> . John went back to the
2025-01-22 16:35:40.638 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the office.
2025-01-22 16:35:40.654 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2919, 2925) -->  Mary journeyed to the office
2025-01-22 16:35:40.654 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John moved to the bedroom.
2025-01-22 16:35:40.660 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1100, 1105) --> . John moved to the
2025-01-22 16:35:40.660 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra journeyed to the bedroom.
2025-01-22 16:35:40.689 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5217, 5223) --> . Sandra journeyed to the
2025-01-22 16:35:40.690 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John took the milk.
2025-01-22 16:35:40.719 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (5549, 5553) -->  John took the milk
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 16:35:41.618 | INFO     | test_jbb_embedding:begin_test:693 - Mary took the football.<|eot_id|>
2025-01-22 16:35:41.618 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8214])
2025-01-22 16:35:43.861 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [625.21875, 49.84958465189873, 225.79545454545453, 47.58707572601397, 50.71182105654762], 'topk_indices': array([  25, 8208, 8102, 8202,    1,   14, 8201,  807,   24,  808, 8067,
       8112,  809,  810, 8212,  812, 8068, 8209,  811,    0]), 'topk_tokens': ['<|eot_id|>', ':', '.\n\n', ' before', '<|start_header_id|>', '\n', ' football', '.', '\n\n', ' Mary', ' you', ' location', ' took', ' the', '<|end_header_id|>', '.', ' context', '<|eot_id|>', ' football', '<|begin_of_text|>'], 'evidence_proportions': [1969.5, 398.7916666666667, 398.7916666666667, 181.88541666666666]}, 'weight': {'score': [21.462713068181817, 23.29407938777994, 21.482007575757574, 23.30634362363681, 29.437313988095237], 'topk_indices': array([3315, 3342, 3235, 3187, 7449, 7487, 1482, 1544, 4300, 4316, 5123,
       5184, 7157, 7213, 3524, 3498, 4925, 4948, 4900, 4977]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.498046875, 20.052083333333332, 20.052083333333332, 20.927083333333332]}, 'saliency': {'score': [3.8081720525568183, 0.27955310973823944, 1.2553969874526516, 0.26609489815796933, 0.3708557855515253], 'topk_indices': array([ 812, 8102, 8183, 8073, 8196, 8111,   24, 7402, 8207, 8066, 5747,
       8202, 8067, 8204, 8112,  809, 8201,  808, 8068,  811]), 'topk_tokens': ['.', '.\n\n', ' return', ' locations', 'Question', ' first', '\n\n', 'nes', 'Answer', ' provided', ' bathroom', ' before', ' you', ' bathroom', ' location', ' took', ' football', ' Mary', ' context', ' football'], 'evidence_proportions': [13.4169921875, 2.052734375, 2.052734375, 0.9131673177083334]}}, 'pred_res': 'Mary took the football.<|eot_id|>', 'score': 0}
2025-01-22 16:35:43.868 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 16:35:43.868 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-2_pid-0_1-3-7-9.pkl | len: 3 |  size: 2.04 KB
Processing depth (1, 3, 7, 9):   1%|          | 1/100 [00:55<1:31:40, 55.56s/it]is_0k: False
your chose emoji: ['ğŸ–²', 'ğŸ§‘ğŸ¼\u200dğŸ¦¯\u200dâ¡', 'ğŸ—¾', 'ğŸ’‚ğŸ¼', 'ğŸ‘©ğŸ¾\u200dâ¤\u200dğŸ‘¨ğŸ¿', 'ğŸ‘¨ğŸ»\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘¨ğŸ¾', 'ğŸ‘ï¸\u200dğŸ—¨', 'â™', 'ğŸ¤›ğŸ»', 'ğŸ§‘ğŸ»\u200dğŸŒ¾']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:05<00:15,  5.09s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.35s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.80s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.22s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.89s/it]
Processing depth (2, 6, 7, 9):   1%|          | 1/100 [01:12<1:31:40, 55.56s/it]2025-01-22 16:36:01.204 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary took the football.
2025-01-22 16:36:01.213 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1602, 1606) -->  Mary took the football
2025-01-22 16:36:01.213 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the office.
2025-01-22 16:36:01.241 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4611, 4617) -->  Mary journeyed to the office
2025-01-22 16:36:01.241 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bathroom.
2025-01-22 16:36:01.266 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4612, 4618) -->  journeyed to the office.
2025-01-22 16:36:01.267 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went back to the hallway.
2025-01-22 16:36:01.307 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6972, 6978) --> . Daniel went back to the
2025-01-22 16:36:01.307 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went back to the kitchen.
2025-01-22 16:36:01.342 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6972, 6978) --> . Daniel went back to the
2025-01-22 16:36:01.342 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the bedroom.
2025-01-22 16:36:01.376 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6837, 6843) --> . John went back to the
2025-01-22 16:36:01.377 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the office.
2025-01-22 16:36:01.400 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4612, 4618) -->  journeyed to the office.
2025-01-22 16:36:01.400 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John moved to the bedroom.
2025-01-22 16:36:01.405 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (947, 952) --> . John moved to the
2025-01-22 16:36:01.405 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra journeyed to the bedroom.
2025-01-22 16:36:01.432 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5019, 5025) --> . Sandra journeyed to the
2025-01-22 16:36:01.432 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John took the milk.
2025-01-22 16:36:01.457 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (5257, 5261) -->  John took the milk
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 16:36:02.309 | INFO     | test_jbb_embedding:begin_test:693 - Mary's house.<|eot_id|>
2025-01-22 16:36:02.309 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8202])
2025-01-22 16:36:04.552 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [600.3622159090909, 54.49360830082886, 255.22632575757575, 52.20703460547306, 71.35727163461539], 'topk_indices': array([1601, 8090, 8185,    1, 1603, 8100, 2703, 1602, 1606, 2687, 2632,
         24, 8200, 8197, 8189, 2706,   14, 8198, 1605,    0]), 'topk_tokens': ['.', '.\n\n', ':', '<|start_header_id|>', ' took', ' location', 'as', ' Mary', '.', ',', 'ared', '\n\n', '<|end_header_id|>', '<|eot_id|>', ' football', ' ne', '\n', '<|start_header_id|>', ' football', '<|begin_of_text|>'], 'evidence_proportions': [1496.75, 591.5833333333334, 550.4375, 61.473958333333336]}, 'weight': {'score': [22.235795454545453, 23.278671227450026, 20.781013257575758, 23.2916011550497, 29.099559294871796], 'topk_indices': array([3310, 3337, 3230, 3182, 7443, 7481, 1457, 1519, 4301, 4317, 5162,
       5223, 7220, 7164, 3519, 3493, 5009, 4980, 4957, 4932]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.498046875, 23.397135416666668, 19.541666666666668, 20.927083333333332]}, 'saliency': {'score': [3.756863680752841, 0.3067335317566126, 1.340585419625947, 0.29323249168082355, 0.5221980168269231], 'topk_indices': array([2703, 8056, 1561, 8171, 5591, 2688, 2613, 8184, 2631, 1603,  279,
        952, 2614, 8100, 8192, 2632, 1602, 2706, 8189, 1605]), 'topk_tokens': ['as', ' context', 'rich', ' return', ' bathroom', ' mess', ' mess', 'Question', ' ne', ' took', 'hue', ' bedroom', 'engers', ' location', ' bathroom', 'ared', ' Mary', ' ne', ' football', ' football'], 'evidence_proportions': [10.52392578125, 3.46826171875, 2.9352213541666665, 0.3557332356770833]}}, 'pred_res': "Mary's house.<|eot_id|>", 'score': 0}
2025-01-22 16:36:04.559 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 16:36:04.560 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-2_pid-1_2-6-7-9.pkl | len: 3 |  size: 2.02 KB
Processing depth (2, 6, 7, 9):   2%|â–         | 2/100 [01:16<57:14, 35.05s/it]  is_0k: False
your chose emoji: ['ğŸ¤¾\u200dâ™€', 'ğŸ‘¨ğŸ¿\u200dâ¤\u200dğŸ’‹\u200dğŸ‘¨ğŸ½', 'ğŸ‡³ğŸ‡·', 'ğŸ‘©\u200dğŸ‘§\u200dğŸ‘§', 'ğŸ§“ğŸ¾', 'ğŸ‡¬ğŸ‡µ', 'ğŸ§–ğŸ»\u200dâ™€', 'ğŸ¥š', 'ğŸ¤¦ğŸ½', 'ğŸ¤¸ğŸ½\u200dâ™‚']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.63s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.87s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.72s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.03s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.66s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 1, 2, 5):   2%|â–         | 2/100 [01:32<57:14, 35.05s/it]2025-01-22 16:36:21.082 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary took the football.
2025-01-22 16:36:21.126 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the office.
2025-01-22 16:36:21.131 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (782, 788) --> . Mary journeyed to the
2025-01-22 16:36:21.131 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bathroom.
2025-01-22 16:36:21.136 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (782, 788) --> . Mary journeyed to the
2025-01-22 16:36:21.136 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went back to the hallway.
2025-01-22 16:36:21.160 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4148, 4154) --> . Daniel went back to the
2025-01-22 16:36:21.160 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went back to the kitchen.
2025-01-22 16:36:21.183 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4148, 4154) --> . Daniel went back to the
2025-01-22 16:36:21.183 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the bedroom.
2025-01-22 16:36:21.220 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6918, 6924) --> . John went back to the
2025-01-22 16:36:21.220 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the office.
2025-01-22 16:36:21.224 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (783, 789) -->  Mary journeyed to the office
2025-01-22 16:36:21.224 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John moved to the bedroom.
2025-01-22 16:36:21.229 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1077, 1082) --> . John moved to the
2025-01-22 16:36:21.229 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra journeyed to the bedroom.
2025-01-22 16:36:21.255 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5023, 5029) --> . Sandra journeyed to the
2025-01-22 16:36:21.255 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John took the milk.
2025-01-22 16:36:21.281 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (5261, 5265) -->  John took the milk
2025-01-22 16:36:21.281 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 16:36:21.281 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 16:36:21.281 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 16:36:21.281 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ‘¨ğŸ½\u200dğŸ¤', 'ğŸ—ï¸', 'ğŸš²', 'ğŸ€', 'ğŸ‘¨ğŸ¾\u200dğŸ¦¯\u200dâ¡', 'ğŸ‘¨ğŸ»\u200dğŸ¦½', 'ğŸ§‘ğŸ¾\u200dğŸ¤\u200dğŸ§‘ğŸ¼', 'ğŸ”°', 'ğŸ¤³ğŸ¼', 'ğŸ¦¹ğŸ¿\u200dâ™€']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.73s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.61s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.53s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.15s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.68s/it]
Processing depth (0, 1, 5, 9):   2%|â–         | 2/100 [01:49<57:14, 35.05s/it]2025-01-22 16:36:37.752 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary took the football.
2025-01-22 16:36:37.796 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the office.
2025-01-22 16:36:37.801 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (820, 826) --> . Mary journeyed to the
2025-01-22 16:36:37.801 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bathroom.
2025-01-22 16:36:37.806 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (820, 826) --> . Mary journeyed to the
2025-01-22 16:36:37.806 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went back to the hallway.
2025-01-22 16:36:37.851 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7034, 7040) --> . Daniel went back to the
2025-01-22 16:36:37.851 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went back to the kitchen.
2025-01-22 16:36:37.887 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (7034, 7040) --> . Daniel went back to the
2025-01-22 16:36:37.887 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the bedroom.
2025-01-22 16:36:37.922 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6948, 6954) -->  John went back to the bedroom
2025-01-22 16:36:37.922 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the office.
2025-01-22 16:36:37.927 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (821, 827) -->  Mary journeyed to the office
2025-01-22 16:36:37.927 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John moved to the bedroom.
2025-01-22 16:36:37.932 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1069, 1074) --> . John moved to the
2025-01-22 16:36:37.932 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra journeyed to the bedroom.
2025-01-22 16:36:37.960 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5084, 5090) --> . Sandra journeyed to the
2025-01-22 16:36:37.960 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John took the milk.
2025-01-22 16:36:37.988 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (5374, 5378) -->  John took the milk
2025-01-22 16:36:37.988 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 16:36:37.988 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 16:36:37.989 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 16:36:37.989 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸš¶ğŸ»', 'ğŸ‘†', 'ğŸ¥·ğŸ¿', 'ğŸ—“', 'ğŸ‘¨ğŸ¼\u200dğŸ’»', 'ğŸ‘©ğŸ»\u200dğŸ¦¼\u200dâ¡ï¸', 'ğŸ§‘ğŸ¾\u200dâ¤ï¸\u200dğŸ§‘ğŸ¿', 'ğŸ‘¨ğŸ¿\u200dğŸŒ¾', 'ğŸ§‘ğŸ¿\u200dğŸ¦¼\u200dâ¡', 'ğŸ’']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.68s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.53s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.47s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.21s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.70s/it]
Processing depth (3, 5, 6, 9):   2%|â–         | 2/100 [02:06<57:14, 35.05s/it]2025-01-22 16:36:54.573 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary took the football.
2025-01-22 16:36:54.588 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2912, 2916) -->  Mary took the football
2025-01-22 16:36:54.588 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the office.
2025-01-22 16:36:54.610 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4163, 4169) -->  Mary journeyed to the office
2025-01-22 16:36:54.610 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bathroom.
2025-01-22 16:36:54.633 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4164, 4170) -->  journeyed to the office.
2025-01-22 16:36:54.633 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went back to the hallway.
2025-01-22 16:36:54.681 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7010, 7016) --> . Daniel went back to the
2025-01-22 16:36:54.681 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went back to the kitchen.
2025-01-22 16:36:54.719 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (7010, 7016) --> . Daniel went back to the
2025-01-22 16:36:54.719 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the bedroom.
2025-01-22 16:36:54.761 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6875, 6881) --> . John went back to the
2025-01-22 16:36:54.761 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the office.
2025-01-22 16:36:54.783 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4164, 4170) -->  journeyed to the office.
2025-01-22 16:36:54.783 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John moved to the bedroom.
2025-01-22 16:36:54.789 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1119, 1124) --> . John moved to the
2025-01-22 16:36:54.789 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra journeyed to the bedroom.
2025-01-22 16:36:54.818 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5082, 5088) --> . Sandra journeyed to the
2025-01-22 16:36:54.818 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John took the milk.
2025-01-22 16:36:54.848 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (5372, 5376) -->  John took the milk
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 16:36:55.729 | INFO     | test_jbb_embedding:begin_test:693 - Mary took the football.<|eot_id|>
2025-01-22 16:36:55.729 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8234])
2025-01-22 16:36:57.967 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [449.7698863636364, 33.56600215517241, 173.26799242424244, 31.883243185429656, 38.044589428191486], 'topk_indices': array([8122,   23,    9, 8132, 8228,    1, 2913, 8222, 8217, 2914, 2916,
         24,   14, 8088, 8221, 8229, 8232, 2915,    0, 8230]), 'topk_tokens': ['.\n\n', '4', ':', ' location', ':', '<|start_header_id|>', ' took', ' before', ':', ' the', '.', '\n\n', '\n', ' context', ' football', '<|eot_id|>', '<|end_header_id|>', ' football', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [1087.125, 425.7083333333333, 417.7083333333333, 80.98958333333333]}, 'weight': {'score': [22.235795454545453, 23.311357910393394, 20.781013257575758, 23.32445701167339, 29.540724734042552], 'topk_indices': array([3341, 3314, 3234, 3186, 7481, 7519, 1491, 1429, 4334, 4350, 5165,
       5226, 7202, 7258, 3497, 3523, 5012, 4960, 4983, 4935]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.498046875, 23.397135416666668, 19.541666666666668, 20.927083333333332]}, 'saliency': {'score': [2.689303311434659, 0.1863365080705136, 0.9121907552083334, 0.176677730435804, 0.28387029120262636], 'topk_indices': array([   8, 8086,    0, 7812, 8087, 1124, 8218, 8203, 4659,   24, 8227,
       8132, 8216, 2912, 8222, 2913, 8224, 8088, 8221, 2915]), 'topk_tokens': [' Date', ' provided', '<|begin_of_text|>', 'inen', ' you', ' bedroom', ' Where', ' return', ' bathroom', '\n\n', 'Answer', ' location', 'Question', ' Mary', ' before', ' took', ' bathroom', ' context', ' football', ' football'], 'evidence_proportions': [7.4970703125, 2.33642578125, 2.0743815104166665, 0.4519246419270833]}}, 'pred_res': 'Mary took the football.<|eot_id|>', 'score': 0}
2025-01-22 16:36:57.974 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 16:36:57.974 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-2_pid-2_3-5-6-9.pkl | len: 3 |  size: 2.06 KB
Processing depth (3, 5, 6, 9):   3%|â–         | 3/100 [02:09<1:10:13, 43.44s/it]is_0k: False
your chose emoji: ['ğŸ‘¨ğŸ¿\u200dâ¤\u200dğŸ’‹\u200dğŸ‘¨ğŸ¿', 'ğŸ¦®', '\U0001faf5ğŸ¿', 'ğŸƒğŸ»\u200dâ™€\u200dâ¡ï¸', 'ğŸ‘¨\u200dğŸ¦¯\u200dâ¡ï¸', 'â¬†ï¸', 'ğŸ‘©ğŸ½\u200dğŸ¤\u200dğŸ‘¨ğŸ¼', 'ğŸš¶ğŸ»\u200dâ™€\u200dâ¡', '\U0001faf3ğŸ»', 'ğŸ‡¦ğŸ‡¶']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.38s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.56s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.45s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.15s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.63s/it]
Processing depth (0, 1, 2, 7):   3%|â–         | 3/100 [02:25<1:10:13, 43.44s/it]2025-01-22 16:37:14.366 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary took the football.
2025-01-22 16:37:14.410 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the office.
2025-01-22 16:37:14.414 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (788, 794) --> . Mary journeyed to the
2025-01-22 16:37:14.414 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bathroom.
2025-01-22 16:37:14.418 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (788, 794) --> . Mary journeyed to the
2025-01-22 16:37:14.418 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went back to the hallway.
2025-01-22 16:37:14.447 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5604, 5610) --> . Daniel went back to the
2025-01-22 16:37:14.447 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went back to the kitchen.
2025-01-22 16:37:14.480 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5604, 5610) --> . Daniel went back to the
2025-01-22 16:37:14.480 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the bedroom.
2025-01-22 16:37:14.519 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6940, 6946) --> . John went back to the
2025-01-22 16:37:14.519 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the office.
2025-01-22 16:37:14.524 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (789, 795) -->  Mary journeyed to the office
2025-01-22 16:37:14.524 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John moved to the bedroom.
2025-01-22 16:37:14.529 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1083, 1088) --> . John moved to the
2025-01-22 16:37:14.529 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra journeyed to the bedroom.
2025-01-22 16:37:14.557 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5079, 5085) -->  Sandra journeyed to the bedroom
2025-01-22 16:37:14.557 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John took the milk.
2025-01-22 16:37:14.585 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (5368, 5372) -->  John took the milk
2025-01-22 16:37:14.586 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 16:37:14.586 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 16:37:14.586 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 16:37:14.586 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ‘©ğŸ¿\u200dâ¤\u200dğŸ‘©ğŸ¾', 'ğŸ›¤ï¸', 'ğŸƒğŸ½\u200dâ™‚\u200dâ¡', 'ğŸ§ğŸ½\u200dâ™€', 'ğŸ™', 'ğŸš£ğŸ¾\u200dâ™‚ï¸', '0ï¸âƒ£', 'ğŸ‘¨ğŸ¿\u200dğŸ¦½\u200dâ¡ï¸', 'ğŸ‘¨ğŸ¼\u200dğŸ«', 'ğŸ¶']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.77s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.91s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.64s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.29s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.83s/it]
Processing depth (3, 5, 8, 9):   3%|â–         | 3/100 [02:43<1:10:13, 43.44s/it]2025-01-22 16:37:31.782 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary took the football.
2025-01-22 16:37:31.798 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2758, 2762) -->  Mary took the football
2025-01-22 16:37:31.799 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the office.
2025-01-22 16:37:31.823 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4172, 4178) --> . Mary journeyed to the
2025-01-22 16:37:31.823 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bathroom.
2025-01-22 16:37:31.847 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4172, 4178) --> . Mary journeyed to the
2025-01-22 16:37:31.847 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went back to the hallway.
2025-01-22 16:37:31.882 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7038, 7044) --> . Daniel went back to the
2025-01-22 16:37:31.883 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went back to the kitchen.
2025-01-22 16:37:31.918 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (7038, 7044) --> . Daniel went back to the
2025-01-22 16:37:31.918 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the bedroom.
2025-01-22 16:37:31.953 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6951, 6957) --> . John went back to the
2025-01-22 16:37:31.954 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the office.
2025-01-22 16:37:31.975 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4173, 4179) -->  Mary journeyed to the office
2025-01-22 16:37:31.975 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John moved to the bedroom.
2025-01-22 16:37:31.980 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1068, 1073) -->  John moved to the bedroom
2025-01-22 16:37:31.980 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra journeyed to the bedroom.
2025-01-22 16:37:32.007 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5098, 5104) -->  Sandra journeyed to the bedroom
2025-01-22 16:37:32.007 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John took the milk.
2025-01-22 16:37:32.035 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (5387, 5391) -->  John took the milk
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 16:37:32.825 | INFO     | test_jbb_embedding:begin_test:693 - The office.<|eot_id|>
2025-01-22 16:37:32.825 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8254])
2025-01-22 16:37:35.064 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [249.73295454545453, 28.213182079699614, 201.6221590909091, 26.92115290818193, 35.07211538461539], 'topk_indices': array([6127, 5999, 8241, 8253, 8237, 8108, 8242,   23, 6128,    9, 8142,
       8248, 8152,    1,   24,   14, 2761, 8249, 8252,    0]), 'topk_tokens': ['\n', ' office', ' football', '\n\n', ':', ' context', ' before', '4', 'the', ':', '.\n\n', ':', ' location', '<|start_header_id|>', '\n\n', '\n', ' football', '<|eot_id|>', '<|end_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [490.1875, 180.13541666666666, 180.13541666666666, 228.625]}, 'weight': {'score': [21.462713068181817, 23.32749856165213, 23.126420454545453, 23.33331015272528, 29.58233173076923], 'topk_indices': array([3355, 3328, 3200, 3248, 7495, 7457, 1433, 1495, 4344, 4360, 5241,
       5180, 7171, 7227, 3541, 3567, 4932, 4980, 5009, 4957]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.498046875, 20.052083333333332, 20.052083333333332, 20.927083333333332]}, 'saliency': {'score': [1.4546120383522727, 0.1573363459387491, 1.1907367128314394, 0.1496979753326576, 0.2591565939096304], 'topk_indices': array([  23,    8, 6651, 8223,    0,   20, 8142, 5992, 1072, 8236, 8247,
       6128, 8242, 5999, 8244,   24, 8108, 8241, 8152, 2761]), 'topk_tokens': ['4', ' Date', ' bathroom', ' return', '<|begin_of_text|>', ' Jul', '.\n\n', ' way', ' bedroom', 'Question', 'Answer', 'the', ' before', ' office', ' bathroom', '\n\n', ' context', ' football', ' location', ' football'], 'evidence_proportions': [3.4501953125, 0.9237467447916666, 0.9237467447916666, 1.1859537760416667]}}, 'pred_res': 'The office.<|eot_id|>', 'score': 100}
2025-01-22 16:37:35.071 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 16:37:35.071 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-2_pid-3_3-5-8-9.pkl | len: 3 |  size: 2.02 KB
Processing depth (3, 5, 8, 9):   4%|â–         | 4/100 [02:46<1:05:29, 40.93s/it]is_0k: False
your chose emoji: ['ğŸ‘©\u200dğŸ‘©\u200dğŸ‘§\u200dğŸ‘§', 'ğŸ‘©\u200dâ¤\u200dğŸ‘¨', 'ğŸ’ğŸ»', 'ğŸ§‘ğŸ»\u200dâ¤\u200dğŸ’‹\u200dğŸ§‘ğŸ¾', 'ğŸ›‹', 'ğŸ§‘ğŸ¿\u200dğŸ¦¯\u200dâ¡ï¸', 'ğŸ‘ğŸ¼', 'ğŸšµğŸ¼\u200dâ™€ï¸', 'ğŸ‘¨ğŸ¿\u200dâ¤\u200dğŸ‘¨ğŸ¾', 'ğŸ§‘ğŸ»\u200dğŸ¦¼']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.61s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.82s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.92s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.37s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.90s/it]
Processing depth (2, 5, 6, 9):   4%|â–         | 4/100 [03:04<1:05:29, 40.93s/it]2025-01-22 16:37:52.677 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary took the football.
2025-01-22 16:37:52.687 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1827, 1831) -->  took the football.
2025-01-22 16:37:52.687 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the office.
2025-01-22 16:37:52.712 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4243, 4249) -->  Mary journeyed to the office
2025-01-22 16:37:52.713 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bathroom.
2025-01-22 16:37:52.736 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4244, 4250) -->  journeyed to the office.
2025-01-22 16:37:52.736 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went back to the hallway.
2025-01-22 16:37:52.772 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7084, 7090) --> . Daniel went back to the
2025-01-22 16:37:52.772 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went back to the kitchen.
2025-01-22 16:37:52.813 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (7084, 7090) --> . Daniel went back to the
2025-01-22 16:37:52.813 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the bedroom.
2025-01-22 16:37:52.848 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6971, 6977) --> . John went back to the
2025-01-22 16:37:52.848 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the office.
2025-01-22 16:37:52.871 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4244, 4250) -->  journeyed to the office.
2025-01-22 16:37:52.871 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John moved to the bedroom.
2025-01-22 16:37:52.878 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1214, 1219) -->  Republican. John moved to
2025-01-22 16:37:52.878 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra journeyed to the bedroom.
2025-01-22 16:37:52.909 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5340, 5346) --> . Sandra journeyed to the
2025-01-22 16:37:52.910 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John took the milk.
2025-01-22 16:37:52.939 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (5610, 5614) -->  John took the milk
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 16:37:53.815 | INFO     | test_jbb_embedding:begin_test:693 - Mary took the football.<|eot_id|>
2025-01-22 16:37:53.815 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8256])
2025-01-22 16:37:56.260 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [407.84090909090907, 33.20945598207798, 151.3409090909091, 31.729481592100452, 62.95799851190476], 'topk_indices': array([1792, 1828, 8250, 8243, 1827, 8239, 8154,    9,    1, 8144, 1830,
       1826,   24, 8252, 2429,   14, 8254, 8251, 1829,    0]), 'topk_tokens': ['ï¿½', ' the', ':', ' football', ' took', ':', ' location', ':', '<|start_header_id|>', '.\n\n', '.', ' Mary', '\n\n', '<|start_header_id|>', 'little', '\n', '<|end_header_id|>', '<|eot_id|>', ' football', '<|begin_of_text|>'], 'evidence_proportions': [1119.125, 350.4166666666667, 339.9375, 58.979166666666664]}, 'weight': {'score': [21.184303977272727, 23.32711083192056, 21.515151515151516, 23.340147087955625, 29.507589285714285], 'topk_indices': array([3319, 3292, 3164, 3212, 7519, 7481, 1489, 1427, 4296, 4312, 5195,
       5134, 7163, 7219, 3501, 3475, 4968, 4939, 4884, 4909]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.71484375, 23.397135416666668, 19.541666666666668, 20.927083333333332]}, 'saliency': {'score': [2.3697454279119317, 0.18746801160616977, 0.8346946022727273, 0.17901152243748475, 0.4595517113095238], 'topk_indices': array([1801, 8144, 2330,   24, 8249, 8244, 8225, 2427, 1220, 1384, 8110,
       8238, 1827, 8154, 8246, 8243, 1792, 1826, 2429, 1829]), 'topk_tokens': ['ï¿½', '.\n\n', 'little', '\n\n', 'Answer', ' before', ' return', ' some', ' bedroom', 'ï¿½', ' context', 'Question', ' took', ' location', ' bathroom', ' football', 'ï¿½', ' Mary', 'little', ' football'], 'evidence_proportions': [6.58447265625, 2.1259765625, 1.8584798177083333, 0.3149617513020833]}}, 'pred_res': 'Mary took the football.<|eot_id|>', 'score': 0}
2025-01-22 16:37:56.268 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 16:37:56.268 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-2_pid-4_2-5-6-9.pkl | len: 3 |  size: 2.03 KB
Processing depth (2, 5, 6, 9):   5%|â–Œ         | 5/100 [03:07<53:32, 33.82s/it]  Processing depth (2, 5, 6, 9):   5%|â–Œ         | 5/100 [03:08<59:32, 37.61s/it]
2025-01-22 16:37:56.356 | INFO     | __main__:<module>:82 - Selected idx: 4
2025-01-22 16:37:56.356 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the apple before the garden? 
2025-01-22 16:37:56.356 | INFO     | __main__:<module>:84 - Answer: bathroom
2025-01-22 16:37:56.356 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 16:37:56.356 | INFO     | __main__:<module>:86 - Needle: [' Daniel picked up the apple.', ' John went back to the bedroom.', ' Sandra journeyed to the bedroom.', ' Daniel journeyed to the bathroom.', ' Mary got the football there.', ' Mary moved to the bathroom.', ' Daniel went to the garden.', ' Mary journeyed to the office.']
2025-01-22 16:37:56.356 | INFO     | __main__:<module>:87 - Real Needle: [' Daniel picked up the apple.', ' Daniel journeyed to the bathroom.', ' Daniel went to the garden.', ' Mary journeyed to the office.']
2025-01-22 16:37:56.356 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ‘¨ğŸ¼\u200dâš•', 'ğŸ¦', 'ğŸ‘©ğŸ¾\u200dâ¤ï¸\u200dğŸ‘¨ğŸ»', 'ğŸ§‘ğŸ»\u200dâš•ï¸', 'ğŸ§‘ğŸ¿\u200dğŸ¤\u200dğŸ§‘ğŸ¿', 'ğŸ§‘ğŸ¿\u200dâ¤ï¸\u200dğŸ§‘ğŸ½', 'ğŸ§ğŸ¼\u200dâ™€ï¸', 'ğŸ™‡ğŸ¿', '\U0001fad9', 'ğŸš¶ğŸ»\u200dâ™‚ï¸\u200dâ¡ï¸']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.30s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.57s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.71s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.35s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.80s/it]
Processing depth (0, 2, 4, 6):   0%|          | 0/100 [00:16<?, ?it/s]2025-01-22 16:38:13.380 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the apple.
2025-01-22 16:38:13.380 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the apple.
2025-01-22 16:38:13.381 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the bathroom.
2025-01-22 16:38:13.391 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1791, 1797) --> . Daniel journeyed to the
2025-01-22 16:38:13.391 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the garden.
2025-01-22 16:38:13.409 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3620, 3625) --> . Daniel went to the
2025-01-22 16:38:13.410 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary journeyed to the office.
2025-01-22 16:38:13.434 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4740, 4746) --> . Mary journeyed to the
2025-01-22 16:38:13.434 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the bedroom.
2025-01-22 16:38:13.470 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6199, 6205) --> . John went back to the
2025-01-22 16:38:13.470 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra journeyed to the bedroom.
2025-01-22 16:38:13.506 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6913, 6919) -->  Sandra journeyed to the bedroom
2025-01-22 16:38:13.506 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary got the football there.
2025-01-22 16:38:13.530 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4316, 4321) --> . Mary got the football
2025-01-22 16:38:13.530 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the bathroom.
2025-01-22 16:38:13.553 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4104, 4109) --> . Mary moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 16:38:14.376 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's hand.<|eot_id|>
2025-01-22 16:38:14.376 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8187])
2025-01-22 16:38:16.639 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [755.9914772727273, 80.25451770451771, 148.26988636363637, 78.2458568622637, 65.22017045454545], 'topk_indices': array([1217, 8171, 8168, 1577, 1176, 1584,  204, 8172, 8183, 1236, 8174,
       3625, 8176, 8169, 8170, 3626, 8178, 8177, 8175,    0]), 'topk_tokens': ['ot', ' Where', '.\n\n', ' part', 'nes', 'ern', ' INCIDENT', ' was', '<|start_header_id|>', 'nes', ' apple', ' garden', ' the', 'Question', ':', '.', '?', ' garden', ' before', '<|begin_of_text|>'], 'evidence_proportions': [1310.0, 610.375, 1158.2, 104.76041666666667]}, 'weight': {'score': [20.485085227272727, 23.299105235042735, 22.234730113636363, 23.309579663331697, 30.106128246753247], 'topk_indices': array([3331, 3304, 3224, 3176, 7448, 7410, 1427, 1489, 4343, 4327, 5145,
       5206, 7131, 7187, 3513, 3487, 4970, 4947, 4922, 4999]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.08125, 20.270833333333332, 19.665625, 20.052083333333332]}, 'saliency': {'score': [3.80450439453125, 0.4537049755799756, 0.8418357155539773, 0.4436072020105727, 0.4784018776633523], 'topk_indices': array([1235,   34, 1217, 8041, 1216, 8172, 1797, 8085, 1577, 8171, 1584,
       1176, 1236,  204, 8174, 3625, 8169, 8178, 8175, 8177]), 'topk_tokens': ['Min', ' apple', 'ot', ' context', 'nes', ' was', ' bathroom', ' location', ' part', ' Where', 'ern', 'nes', 'nes', ' INCIDENT', ' apple', ' garden', 'Question', '?', ' before', ' garden'], 'evidence_proportions': [6.8953125, 3.2444661458333335, 5.3234375, 0.5230916341145834]}}, 'pred_res': "Daniel's hand.<|eot_id|>", 'score': 0}
2025-01-22 16:38:16.657 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 16:38:16.657 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-4_pid-0_0-2-4-6.pkl | len: 3 |  size: 1.99 KB
Processing depth (0, 2, 4, 6):   1%|          | 1/100 [00:20<33:17, 20.18s/it]is_0k: False
your chose emoji: ['ğŸ™‹ğŸ¾\u200dâ™€', 'â¹ï¸', 'ğŸ™‹ğŸ¼\u200dâ™‚ï¸', 'ğŸœ', 'ğŸ’‚ğŸ»\u200dâ™‚ï¸', 'ğŸ§œğŸ¾\u200dâ™€ï¸', 'ğŸ…¿', 'ğŸ‘©ğŸ¼\u200dâ¤\u200dğŸ‘©ğŸ¼', 'ğŸƒğŸ½\u200dâ™‚\u200dâ¡ï¸', 'ğŸª‘']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.11s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.22s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.23s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.01s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.45s/it]
Processing depth (5, 7, 8, 9):   1%|          | 1/100 [00:36<33:17, 20.18s/it]2025-01-22 16:38:32.833 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the apple.
2025-01-22 16:38:32.856 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4212, 4217) -->  Daniel picked up the apple
2025-01-22 16:38:32.856 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the bathroom.
2025-01-22 16:38:32.889 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5717, 5723) --> . Daniel journeyed to the
2025-01-22 16:38:32.889 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the garden.
2025-01-22 16:38:32.923 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6623, 6628) --> . Daniel went to the
2025-01-22 16:38:32.923 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary journeyed to the office.
2025-01-22 16:38:32.962 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7271, 7277) -->  cold. Mary journeyed to
2025-01-22 16:38:32.962 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the bedroom.
2025-01-22 16:38:32.997 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6204, 6210) --> . John went back to the
2025-01-22 16:38:32.997 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra journeyed to the bedroom.
2025-01-22 16:38:33.032 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6895, 6901) --> . Sandra journeyed to the
2025-01-22 16:38:33.033 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary got the football there.
2025-01-22 16:38:33.056 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4365, 4370) --> . Mary got the football
2025-01-22 16:38:33.056 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the bathroom.
2025-01-22 16:38:33.080 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4139, 4144) --> . Mary moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 16:38:33.983 | INFO     | test_jbb_embedding:begin_test:693 - Daniel picked up the apple.<|eot_id|>
2025-01-22 16:38:33.983 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8191])
2025-01-22 16:38:36.220 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [206.51296164772728, 20.27526810776178, 133.9190340909091, 19.46577214340491, 16.03527986550633], 'topk_indices': array([8172,    1, 8173, 8175, 4217, 4212,   24, 4216, 8079, 8176,   14,
       8174, 8178, 8182, 8181, 8179,    0, 8189, 8186, 8187]), 'topk_tokens': ['.\n\n', '<|start_header_id|>', 'Question', ' Where', '.', ' Daniel', '\n\n', ' apple', '.\n\n', ' was', '\n', ':', ' apple', '?', ' garden', ' before', '<|begin_of_text|>', '<|end_header_id|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [418.2, 214.83333333333334, 197.175, 29.568359375]}, 'weight': {'score': [22.509943181818183, 23.293311035513792, 21.001420454545453, 23.301612346625767, 29.643987341772153], 'topk_indices': array([3306, 3279, 3151, 3199, 7432, 7394, 1435, 1497, 4304, 4288, 5105,
       5166, 7164, 7108, 3462, 3488, 4930, 4882, 4907, 4959]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.9703125, 20.270833333333332, 19.665625, 23.40234375]}, 'saliency': {'score': [1.2699737548828125, 0.10986475610488619, 0.7142666903409091, 0.10510165910779333, 0.11990414390081092], 'topk_indices': array([7916, 8184, 4213, 8174, 8172,   24, 8079, 6210, 8045, 8089, 8176,
       8182, 8175, 4144, 8173, 4212, 4216, 8178, 8181, 8179]), 'topk_tokens': [' Square', 'Answer', ' picked', ':', '.\n\n', '\n\n', '.\n\n', ' bedroom', ' context', ' location', ' was', '?', ' Where', ' bathroom', 'Question', ' Daniel', ' apple', ' apple', ' garden', ' before'], 'evidence_proportions': [2.9859375, 1.1834716796875, 0.985302734375, 0.16373189290364584]}}, 'pred_res': 'Daniel picked up the apple.<|eot_id|>', 'score': 0}
2025-01-22 16:38:36.228 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 16:38:36.228 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-4_pid-1_5-7-8-9.pkl | len: 3 |  size: 2.03 KB
Processing depth (5, 7, 8, 9):   2%|â–         | 2/100 [00:39<32:22, 19.82s/it]is_0k: False
your chose emoji: ['ğŸª²', 'ğŸ§šğŸ¿\u200dâ™‚', 'ğŸ§–ğŸ»\u200dâ™‚', 'ğŸ§ğŸ¿', 'ğŸ¤ŒğŸ»', 'ğŸ§ğŸ»\u200dâ™€\u200dâ¡ï¸', 'ğŸ”³', 'ğŸ‹ğŸ¿\u200dâ™‚', 'â›“\u200dğŸ’¥', 'ğŸ‘¨ğŸ»\u200dâ¤ï¸\u200dğŸ‘¨ğŸ½']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.31s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.72s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.28s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.76s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.38s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 3, 5, 7):   2%|â–         | 2/100 [00:55<32:22, 19.82s/it]2025-01-22 16:38:51.681 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the apple.
2025-01-22 16:38:51.682 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the apple.
2025-01-22 16:38:51.682 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the bathroom.
2025-01-22 16:38:51.699 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2923, 2929) --> . Daniel journeyed to the
2025-01-22 16:38:51.699 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the garden.
2025-01-22 16:38:51.722 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4168, 4173) --> . Daniel went to the
2025-01-22 16:38:51.722 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary journeyed to the office.
2025-01-22 16:38:51.753 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5578, 5584) --> . Mary journeyed to the
2025-01-22 16:38:51.753 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the bedroom.
2025-01-22 16:38:51.784 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5855, 5861) --> . John went back to the
2025-01-22 16:38:51.784 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra journeyed to the bedroom.
2025-01-22 16:38:51.819 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6814, 6820) --> . Sandra journeyed to the
2025-01-22 16:38:51.819 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary got the football there.
2025-01-22 16:38:51.844 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4338, 4343) --> . Mary got the football
2025-01-22 16:38:51.844 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the bathroom.
2025-01-22 16:38:51.865 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4134, 4139) --> . Mary moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 16:38:55.711 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's house.<|eot_id|>
2025-01-22 16:38:55.711 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8173])
2025-01-22 16:38:58.783 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [431.4119318181818, 50.89819670376713, 166.1434659090909, 49.55698936301033, 28.589676339285713], 'topk_indices': array([  67, 2929, 3365,    1, 8164, 4293, 3423, 8163, 8168,   24, 8161,
         68,  105,   35,   28, 8027, 3425, 3426, 8169,    0]), 'topk_tokens': ['ION', ' bathroom', ' could', '<|start_header_id|>', '?', 'nes', 'that', ' garden', '<|eot_id|>', '\n\n', ' before', 'E', 'ION', '.', '<|end_header_id|>', ' context', ' that', ' could', '<|start_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [846.4, 492.0, 363.35, 81.71875]}, 'weight': {'score': [20.485085227272727, 23.27645509723581, 21.001420454545453, 23.29016155312346, 29.4640625], 'topk_indices': array([3264, 3291, 3184, 3136, 7406, 7444, 1487, 1425, 4327, 4311, 5160,
       5221, 7127, 7183, 3447, 3473, 4911, 4975, 5004, 4936]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.08125, 20.270833333333332, 19.665625, 20.052083333333332]}, 'saliency': {'score': [2.2701582475142046, 0.2873534260430681, 0.9025795676491477, 0.28032481300965706, 0.21321650913783483], 'topk_indices': array([8166, 8071,    0, 1479,   67, 4139,   68, 3423, 8155, 3425, 8160,
       3365,   34, 4293, 8161,  105, 8163, 2929, 8027, 3426]), 'topk_tokens': ['Answer', ' location', '<|begin_of_text|>', 'nes', 'ION', ' bathroom', 'E', 'that', 'Question', ' that', ' apple', ' could', ' apple', 'nes', ' before', 'ION', ' garden', ' bathroom', ' context', ' could'], 'evidence_proportions': [4.5396484375, 2.6536458333333335, 1.74580078125, 0.4323933919270833]}}, 'pred_res': "Daniel's house.<|eot_id|>", 'score': 0}
2025-01-22 16:38:58.788 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 16:38:58.788 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-4_pid-2_0-3-5-7.pkl | len: 3 |  size: 2.04 KB
Processing depth (0, 3, 5, 7):   3%|â–         | 3/100 [01:02<34:04, 21.07s/it]is_0k: False
your chose emoji: ['ğŸª€', 'â¯', 'ğŸ’ğŸ½', 'ğŸ‹ğŸ¼\u200dâ™‚', 'ğŸ’†ğŸ¿\u200dâ™‚', 'ğŸ‘¨ğŸ½\u200dğŸ’»', 'ğŸ§Š', 'ğŸ§œğŸ¾\u200dâ™‚ï¸', 'ğŸ§›ğŸ½\u200dâ™‚ï¸', 'ğŸ‘©ğŸ½\u200dğŸ¦±']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:05<00:16,  5.50s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.48s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:15<00:04,  4.98s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  3.44s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  4.11s/it]
Processing depth (0, 1, 5, 8):   3%|â–         | 3/100 [01:20<34:04, 21.07s/it]2025-01-22 16:39:17.006 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the apple.
2025-01-22 16:39:17.006 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the apple.
2025-01-22 16:39:17.007 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the bathroom.
2025-01-22 16:39:17.011 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (807, 813) --> . Daniel journeyed to the
2025-01-22 16:39:17.011 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the garden.
2025-01-22 16:39:17.032 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4124, 4129) --> . Daniel went to the
2025-01-22 16:39:17.032 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary journeyed to the office.
2025-01-22 16:39:17.069 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6625, 6631) --> . Mary journeyed to the
2025-01-22 16:39:17.069 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the bedroom.
2025-01-22 16:39:17.100 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6121, 6127) -->  John went back to the bedroom
2025-01-22 16:39:17.100 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra journeyed to the bedroom.
2025-01-22 16:39:17.137 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6766, 6772) --> . Sandra journeyed to the
2025-01-22 16:39:17.137 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary got the football there.
2025-01-22 16:39:17.160 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4295, 4300) -->  Mary got the football there
2025-01-22 16:39:17.160 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the bathroom.
2025-01-22 16:39:17.188 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4084, 4089) --> . Mary moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 16:39:18.026 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's bathroom.<|eot_id|>
2025-01-22 16:39:18.026 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8203])
2025-01-22 16:39:20.265 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [121.84410511363636, 14.37282742810139, 27.30184659090909, 14.048298326084293, 10.964809283088234], 'topk_indices': array([  24,  589,   14,   65,    1, 3169, 8191, 3189,  104,   28,  813,
         69,   66, 3170,   67,  105, 8198,   68, 8199,    0]), 'topk_tokens': ['\n\n', ',', '\n', ' OF', '<|start_header_id|>', ' const', ' before', 'ern', ' P', '<|end_header_id|>', ' bathroom', 'ER', ' P', 'ern', 'ION', 'ION', '<|eot_id|>', 'E', '<|start_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [247.5, 157.36458333333334, 69.71875, 25.048177083333332]}, 'weight': {'score': [20.485085227272727, 23.298343056909577, 22.92684659090909, 23.306927300294046, 29.428676470588236], 'topk_indices': array([3377, 3350, 3270, 3222, 7448, 7486, 1536, 1474, 4363, 4347, 5158,
       5219, 7169, 7225, 3559, 3533, 4960, 5012, 4935, 4983]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.08125, 20.270833333333332, 19.665625, 20.052083333333332]}, 'saliency': {'score': [0.6640361439098011, 0.08080085533117917, 0.15847847678444602, 0.07901941891599887, 0.07979471543255974], 'topk_indices': array([8185,  104,  809,   31, 8190, 8193, 8101,   64,   69,   34, 8191,
          0, 3189, 3169,   66,  813, 3170,   67,   68,  105]), 'topk_tokens': ['Question', ' P', ' journey', ' picked', ' apple', ' garden', ' location', 'ENCES', 'ER', ' apple', ' before', '<|begin_of_text|>', 'ern', ' const', ' P', ' bathroom', 'ern', 'ION', 'E', 'ION'], 'evidence_proportions': [1.36220703125, 0.8616943359375, 0.35048828125, 0.1458587646484375]}}, 'pred_res': "Daniel's bathroom.<|eot_id|>", 'score': 100}
2025-01-22 16:39:20.273 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 16:39:20.273 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-4_pid-3_0-1-5-8.pkl | len: 3 |  size: 2.01 KB
Processing depth (0, 1, 5, 8):   4%|â–         | 4/100 [01:23<33:58, 21.24s/it]is_0k: False
your chose emoji: ['ğŸ‘†ğŸ½', 'ğŸ‘¨ğŸ¿\u200dğŸ”¬', 'ğŸ°', 'ğŸ‘©ğŸ¼\u200dâ¤ï¸\u200dğŸ‘©ğŸ¼', 'ğŸ‘²ğŸ¼', 'ğŸ‘ŒğŸ¼', 'ğŸ§‘ğŸ½\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ§‘ğŸ»', 'ğŸ§š\u200dâ™€ï¸', 'ğŸš¶\u200dâ¡', 'ğŸ§‘\u200dğŸ”§']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.64s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.47s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.35s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.81s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.41s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 6, 7, 8):   4%|â–         | 4/100 [01:39<33:58, 21.24s/it]2025-01-22 16:39:36.124 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the apple.
2025-01-22 16:39:36.124 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the apple.
2025-01-22 16:39:36.124 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the bathroom.
2025-01-22 16:39:36.152 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4813, 4819) --> . Daniel journeyed to the
2025-01-22 16:39:36.153 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the garden.
2025-01-22 16:39:36.181 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5682, 5687) --> . Daniel went to the
2025-01-22 16:39:36.182 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary journeyed to the office.
2025-01-22 16:39:36.220 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6599, 6605) --> . Mary journeyed to the
2025-01-22 16:39:36.220 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the bedroom.
2025-01-22 16:39:36.251 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6168, 6174) --> . John went back to the
2025-01-22 16:39:36.251 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra journeyed to the bedroom.
2025-01-22 16:39:36.290 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6882, 6888) --> . Sandra journeyed to the
2025-01-22 16:39:36.290 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary got the football there.
2025-01-22 16:39:36.312 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4317, 4322) --> . Mary got the football
2025-01-22 16:39:36.312 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the bathroom.
2025-01-22 16:39:36.334 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4097, 4102) --> . Mary moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 16:39:40.726 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's hand.<|eot_id|>
2025-01-22 16:39:40.726 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8151])
2025-01-22 16:39:43.925 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [568.6392045454545, 70.34929175864606, 340.4375, 68.26491214549938, 39.294557733050844], 'topk_indices': array([8136, 8133,   35, 7263, 8134, 7634, 7292, 8049, 8079, 7498, 7340,
       8005, 8142, 8141, 8139, 7341, 7543, 7499, 7544,    0]), 'topk_tokens': [' was', 'Question', '.', 'nes', ':', 'nes', 'nes', ' location', ' the', ' Min', ' Min', ' context', '?', ' garden', ' before', 'nes', ' Min', 'nes', 'nes', '<|begin_of_text|>'], 'evidence_proportions': [861.7, 629.25, 712.2, 144.17708333333334]}, 'weight': {'score': [20.485085227272727, 23.258211077385333, 21.001420454545453, 23.271855733662147, 29.35699152542373], 'topk_indices': array([3251, 3278, 3171, 3123, 7426, 7388, 1475, 1413, 4256, 4240, 5064,
       5125, 7109, 7165, 3434, 3460, 4889, 4866, 4841, 4918]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.08125, 20.270833333333332, 19.665625, 20.052083333333332]}, 'saliency': {'score': [3.0869140625, 0.4006436581643212, 1.8983931107954546, 0.3892936659506011, 0.2929547843286547], 'topk_indices': array([8045,   38, 5687, 4321, 7263, 8138, 8133, 7634, 8142, 8049, 7292,
       7498, 8005, 7340, 8139, 8141, 7341, 7543, 7499, 7544]), 'topk_tokens': [' item', '***', ' garden', ' football', 'nes', ' apple', 'Question', 'nes', '?', ' location', 'nes', ' Min', ' context', ' Min', ' before', ' garden', 'nes', ' Min', 'nes', 'nes'], 'evidence_proportions': [4.52578125, 3.6575520833333335, 3.7642578125, 0.7527669270833334]}}, 'pred_res': "Daniel's hand.<|eot_id|>", 'score': 0}
2025-01-22 16:39:43.941 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 16:39:43.941 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-4_pid-4_0-6-7-8.pkl | len: 3 |  size: 1.96 KB
Processing depth (0, 6, 7, 8):   5%|â–Œ         | 5/100 [01:47<35:00, 22.11s/it]Processing depth (0, 6, 7, 8):   5%|â–Œ         | 5/100 [01:47<34:03, 21.51s/it]
2025-01-22 16:39:44.050 | INFO     | __main__:<module>:82 - Selected idx: 6
2025-01-22 16:39:44.050 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the apple before the garden? 
2025-01-22 16:39:44.050 | INFO     | __main__:<module>:84 - Answer: bathroom
2025-01-22 16:39:44.051 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 16:39:44.051 | INFO     | __main__:<module>:86 - Needle: [' Daniel got the apple.', ' John went back to the bedroom.', ' Mary got the football there.', ' Daniel journeyed to the bathroom.', ' Mary journeyed to the office.', ' Mary moved to the bathroom.', ' John journeyed to the office.', ' Sandra journeyed to the bedroom.', ' Daniel went to the garden.', ' John moved to the bedroom.']
2025-01-22 16:39:44.051 | INFO     | __main__:<module>:87 - Real Needle: [' Daniel got the apple.', ' Daniel journeyed to the bathroom.', ' Daniel went to the garden.', ' John moved to the bedroom.']
2025-01-22 16:39:44.051 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ§‘ğŸ½\u200dâ¤\u200dğŸ§‘ğŸ¾', 'ğŸŒ†', 'ğŸ‘ƒğŸ¿', 'ğŸ‡·ğŸ‡´', 'ğŸ–±ï¸', 'ğŸ§€', 'ğŸ‘©ğŸ»', 'ğŸ˜½', 'ğŸ¦¹ğŸ¼\u200dâ™‚', 'ğŸ‘ŒğŸ¾']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.37s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.58s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.55s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.22s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.70s/it]
Processing depth (1, 2, 3, 5):   0%|          | 0/100 [00:16<?, ?it/s]2025-01-22 16:40:01.099 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the apple.
2025-01-22 16:40:01.103 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (896, 900) -->  Daniel got the apple
2025-01-22 16:40:01.104 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the bathroom.
2025-01-22 16:40:01.113 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1602, 1608) --> . Daniel journeyed to the
2025-01-22 16:40:01.113 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the garden.
2025-01-22 16:40:01.129 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2846, 2851) --> . Daniel went to the
2025-01-22 16:40:01.129 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John moved to the bedroom.
2025-01-22 16:40:01.153 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4145, 4150) --> . John moved to the
2025-01-22 16:40:01.153 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the bedroom.
2025-01-22 16:40:01.164 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1767, 1773) --> . John went back to the
2025-01-22 16:40:01.164 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary got the football there.
2025-01-22 16:40:01.183 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3389, 3394) -->  Mary got the football there
2025-01-22 16:40:01.183 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the office.
2025-01-22 16:40:01.205 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3713, 3719) -->  John journeyed to the office
2025-01-22 16:40:01.205 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the bathroom.
2025-01-22 16:40:01.211 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1312, 1317) --> . Mary moved to the
2025-01-22 16:40:01.211 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John journeyed to the office.
2025-01-22 16:40:01.230 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3712, 3718) --> . John journeyed to the
2025-01-22 16:40:01.230 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra journeyed to the bedroom.
2025-01-22 16:40:01.259 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (5122, 5128) -->  Sandra journeyed to the bedroom
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 16:40:02.126 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's house.<|eot_id|>
2025-01-22 16:40:02.126 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8197])
2025-01-22 16:40:04.436 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [236.40625, 26.555080030487805, 85.34053308823529, 25.794494613920943, 17.92053865131579], 'topk_indices': array([8181, 8182, 7537, 8179,  899,   24,  900,   14, 8180, 8125, 8188,
       8095, 8184, 8085, 8187, 8185, 8195, 8192,    0, 8193]), 'topk_tokens': [' Where', ' was', 'nes', 'Question', ' apple', '\n\n', '.', '\n', ':', ' the', '?', ' location', ' apple', '.\n\n', ' garden', ' before', '<|end_header_id|>', '<|eot_id|>', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [557.3125, 212.45833333333334, 165.725, 79.1]}, 'weight': {'score': [21.054296875, 23.281385289634148, 22.27734375, 23.291043917260005, 29.450246710526315], 'topk_indices': array([3324, 3351, 3244, 3196, 7436, 7474, 1520, 1458, 4382, 4398, 5265,
       5204, 7213, 7157, 3559, 3533, 5018, 4995, 5047, 4970]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.681640625, 20.270833333333332, 19.665625, 18.88125]}, 'saliency': {'score': [1.41527099609375, 0.14520260694550305, 0.4528036678538603, 0.14080047045472854, 0.1345325269197163], 'topk_indices': array([8089, 1317, 8051, 8094, 8091, 8188, 7582, 8123, 8085, 8181, 7537,
       7581,  896,  257, 8179,  899, 8095, 8184, 8187, 8185]), 'topk_tokens': [' obtained', ' bathroom', ' context', ' first', ' item', '?', 'nes', ' moved', '.\n\n', ' Where', 'nes', ' Min', ' Daniel', 'hue', 'Question', ' apple', ' location', ' apple', ' garden', ' before'], 'evidence_proportions': [3.9140625, 1.0800374348958333, 0.83154296875, 0.40224609375]}}, 'pred_res': "Daniel's house.<|eot_id|>", 'score': 0}
2025-01-22 16:40:04.442 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 16:40:04.443 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-6_pid-0_1-2-3-5.pkl | len: 3 |  size: 2.01 KB
Processing depth (1, 2, 3, 5):   1%|          | 1/100 [00:20<33:22, 20.23s/it]is_0k: False
your chose emoji: ['ğŸ˜¯', 'ğŸ§™ğŸ¾\u200dâ™‚ï¸', 'ğŸ™ğŸ¿\u200dâ™‚ï¸', 'ğŸ¥Š', 'ğŸ§œğŸ¼\u200dâ™‚', 'ğŸ‘¨ğŸ¼\u200dğŸ”¬', 'ğŸ‘¨ğŸ¼\u200dğŸ¤', 'ğŸ¥', 'ğŸ§šğŸ¾\u200dâ™€ï¸', 'ğŸ‘©ğŸ½\u200dğŸ¦°']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.84s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.73s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.20s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.70s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.37s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (2, 3, 6, 9):   1%|          | 1/100 [00:35<33:22, 20.23s/it]2025-01-22 16:40:19.918 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the apple.
2025-01-22 16:40:19.929 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1802, 1806) -->  Daniel got the apple
2025-01-22 16:40:19.930 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the bathroom.
2025-01-22 16:40:19.945 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2941, 2947) --> . Daniel journeyed to the
2025-01-22 16:40:19.945 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the garden.
2025-01-22 16:40:19.970 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4875, 4880) --> . Daniel went to the
2025-01-22 16:40:19.970 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John moved to the bedroom.
2025-01-22 16:40:20.007 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7130, 7135) -->  John moved to the bedroom
2025-01-22 16:40:20.007 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the bedroom.
2025-01-22 16:40:20.017 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1878, 1884) --> . John went back to the
2025-01-22 16:40:20.017 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary got the football there.
2025-01-22 16:40:20.035 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3598, 3603) --> . Mary got the football
2025-01-22 16:40:20.035 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the office.
2025-01-22 16:40:20.055 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3859, 3865) -->  John journeyed to the office
2025-01-22 16:40:20.056 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the bathroom.
2025-01-22 16:40:20.063 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1534, 1539) -->  Mary moved to the bathroom
2025-01-22 16:40:20.064 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John journeyed to the office.
2025-01-22 16:40:20.083 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3858, 3864) --> . John journeyed to the
2025-01-22 16:40:20.083 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra journeyed to the bedroom.
2025-01-22 16:40:20.111 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (5438, 5444) -->  Sandra journeyed to the bedroom
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 16:40:23.717 | INFO     | test_jbb_embedding:begin_test:693 - the capitol<|eot_id|>
2025-01-22 16:40:23.718 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8193])
2025-01-22 16:40:26.615 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [375.01875, 26.028420876037092, 134.43612132352942, 24.718464059813314, 34.07564400337838], 'topk_indices': array([2967, 8180, 2994, 2944, 2966, 2945, 1804, 1539, 8181, 1803, 1802,
         24,   14, 8191, 2946, 2995, 1805, 8188, 8189,    0]), 'topk_tokens': ['ching', ' apple', '\n', 'ed', 'lyn', ' to', ' the', '.', ' before', ' got', ' Daniel', '\n\n', '\n', '<|end_header_id|>', ' the', 'lyn', ' apple', '<|eot_id|>', '<|start_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [746.625, 544.2083333333334, 162.925, 86.8]}, 'weight': {'score': [22.4109375, 23.27648395558809, 22.666130514705884, 23.281158844571358, 29.34227195945946], 'topk_indices': array([3282, 3309, 3154, 3202, 7420, 7458, 1473, 1411, 4274, 4290, 5186,
       5125, 7141, 7197, 3465, 3491, 4950, 4979, 4927, 4902]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.681640625, 20.270833333333332, 19.665625, 24.3078125]}, 'saliency': {'score': [2.148773193359375, 0.14649547094714646, 0.8236604578354779, 0.1387493196326724, 0.25124833390519424], 'topk_indices': array([2902, 1541, 2947,   24, 2280, 1514, 8091, 1800, 1535, 8183, 8181,
       2943, 2967, 8180, 1803, 2966, 1538, 1802, 1805, 2995]), 'topk_tokens': [' lyn', 'rich', ' bathroom', '\n\n', ' Bench', 'ï¿½', ' location', ' Mr', ' moved', ' garden', ' before', ' journey', 'ching', ' apple', ' got', 'lyn', ' bathroom', ' Daniel', ' apple', 'lyn'], 'evidence_proportions': [5.13818359375, 2.5878092447916665, 0.859619140625, 0.5195556640625]}}, 'pred_res': 'the capitol<|eot_id|>', 'score': 0}
2025-01-22 16:40:26.639 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 16:40:26.639 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-6_pid-1_2-3-6-9.pkl | len: 3 |  size: 1.99 KB
Processing depth (2, 3, 6, 9):   2%|â–         | 2/100 [00:42<34:55, 21.39s/it]is_0k: False
your chose emoji: ['ğŸ§“ğŸ¾', 'ğŸ›€', 'ğŸ‘', 'ğŸš´ğŸ¾\u200dâ™€', 'ğŸ¤ğŸ½', 'ğŸ§‘\u200dğŸ¦¼\u200dâ¡', 'âœŒğŸ¼', 'ğŸµ', 'ğŸ‘¨ğŸ»\u200dğŸ¦¯\u200dâ¡ï¸', 'ğŸ‘©ğŸ¾\u200dâ¤ï¸\u200dğŸ‘¨ğŸ¾']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:05<00:16,  5.65s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.09s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:15<00:05,  5.02s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  3.50s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  4.11s/it]
Processing depth (2, 3, 8, 9):   2%|â–         | 2/100 [01:00<34:55, 21.39s/it]2025-01-22 16:40:45.068 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the apple.
2025-01-22 16:40:45.079 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1846, 1850) -->  Daniel got the apple
2025-01-22 16:40:45.079 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the bathroom.
2025-01-22 16:40:45.096 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2897, 2903) --> . Daniel journeyed to the
2025-01-22 16:40:45.097 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the garden.
2025-01-22 16:40:45.130 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6655, 6660) --> . Daniel went to the
2025-01-22 16:40:45.131 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John moved to the bedroom.
2025-01-22 16:40:45.169 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7259, 7264) --> . John moved to the
2025-01-22 16:40:45.169 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the bedroom.
2025-01-22 16:40:45.181 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2013, 2019) -->  cable. John went back to
2025-01-22 16:40:45.181 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary got the football there.
2025-01-22 16:40:45.199 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3546, 3551) --> . Mary got the football
2025-01-22 16:40:45.199 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the office.
2025-01-22 16:40:45.219 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3742, 3748) -->  journeyed to the office.
2025-01-22 16:40:45.219 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the bathroom.
2025-01-22 16:40:45.227 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1701, 1706) --> . Mary moved to the
2025-01-22 16:40:45.228 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John journeyed to the office.
2025-01-22 16:40:45.247 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3741, 3747) -->  John journeyed to the office
2025-01-22 16:40:45.247 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra journeyed to the bedroom.
2025-01-22 16:40:45.277 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (5275, 5281) --> . Sandra journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 16:40:46.123 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's house.<|eot_id|>
2025-01-22 16:40:46.123 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8201])
2025-01-22 16:40:48.374 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [196.334375, 22.73898784129693, 83.59145220588235, 22.05912384969325, 18.207557091346153], 'topk_indices': array([1850, 8183, 8089, 1849, 8186, 8099,   24, 7599, 8184, 7555, 7600,
       8192, 8188,   14, 8191, 8199, 8189,    0, 8196, 8197]), 'topk_tokens': ['.', 'Question', '.\n\n', ' apple', ' was', ' location', '\n\n', ' Min', ':', 'nes', 'nes', '?', ' apple', '\n', ' garden', '<|end_header_id|>', ' before', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [471.75, 140.71875, 187.8375, 51.2375]}, 'weight': {'score': [21.054296875, 23.28362688932228, 21.704963235294116, 23.29568347392638, 29.41005608974359], 'topk_indices': array([3328, 3355, 3200, 3248, 7492, 7454, 1399, 1461, 4380, 4364, 5242,
       5181, 7209, 7153, 3537, 3511, 5000, 5029, 4952, 4977]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.681640625, 20.270833333333332, 19.665625, 18.88125]}, 'saliency': {'score': [1.201837158203125, 0.12527224774595472, 0.455963134765625, 0.12125080132045629, 0.13327417618189102], 'topk_indices': array([8170,   24, 2903, 1770, 8186, 7407, 8055, 8192, 8185, 1846, 8099,
       1706, 8183, 1849, 7599, 7555, 7600, 8188, 8191, 8189]), 'topk_tokens': [' return', '\n\n', ' bathroom', 'ï¿½', ' was', 'nes', ' context', '?', ' Where', ' Daniel', ' location', ' bathroom', 'Question', ' apple', ' Min', 'nes', 'nes', ' apple', ' garden', ' before'], 'evidence_proportions': [3.241943359375, 0.8008015950520834, 1.00439453125, 0.2484375]}}, 'pred_res': "Daniel's house.<|eot_id|>", 'score': 0}
2025-01-22 16:40:48.381 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 16:40:48.381 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-6_pid-2_2-3-8-9.pkl | len: 3 |  size: 2.01 KB
Processing depth (2, 3, 8, 9):   3%|â–         | 3/100 [01:04<34:50, 21.55s/it]is_0k: False
your chose emoji: ['âœ³', 'ğŸ§‘ğŸ½\u200dâ¤\u200dğŸ§‘ğŸ»', 'ğŸš£ğŸ»\u200dâ™‚', 'ğŸ‡¿ğŸ‡¼', 'ğŸ¦’', 'ğŸ”', 'ğŸ§‘ğŸ½\u200dğŸ¤\u200dğŸ§‘ğŸ»', 'ğŸ§‘ğŸ¾\u200dğŸ¦¯\u200dâ¡', 'ğŸ’‚ğŸ¾\u200dâ™€ï¸', '\U0001fae7']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.30s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.80s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.71s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.05s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.64s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 2, 3, 9):   3%|â–         | 3/100 [01:20<34:50, 21.55s/it]2025-01-22 16:41:04.766 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the apple.
2025-01-22 16:41:04.813 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the bathroom.
2025-01-22 16:41:04.825 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1864, 1870) --> . Daniel journeyed to the
2025-01-22 16:41:04.825 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the garden.
2025-01-22 16:41:04.843 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2952, 2957) --> . Daniel went to the
2025-01-22 16:41:04.843 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John moved to the bedroom.
2025-01-22 16:41:04.883 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7126, 7131) -->  John moved to the bedroom
2025-01-22 16:41:04.883 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the bedroom.
2025-01-22 16:41:04.894 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2034, 2040) -->  cable. John went back to
2025-01-22 16:41:04.894 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary got the football there.
2025-01-22 16:41:04.915 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3608, 3613) --> . Mary got the football
2025-01-22 16:41:04.915 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the office.
2025-01-22 16:41:04.937 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3869, 3875) -->  John journeyed to the office
2025-01-22 16:41:04.937 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the bathroom.
2025-01-22 16:41:04.947 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1706, 1711) --> . Mary moved to the
2025-01-22 16:41:04.947 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John journeyed to the office.
2025-01-22 16:41:04.968 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3868, 3874) --> . John journeyed to the
2025-01-22 16:41:04.968 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra journeyed to the bedroom.
2025-01-22 16:41:04.997 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (5253, 5259) --> . Sandra journeyed to the
2025-01-22 16:41:04.998 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 16:41:04.998 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 16:41:04.998 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 16:41:04.998 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ‘©ğŸ¿\u200dğŸ¤\u200dğŸ‘¨ğŸ»', 'ğŸŒ', 'ğŸ™†ğŸ¾\u200dâ™‚', 'ğŸ¤¾ğŸ¼\u200dâ™€ï¸', 'â—', 'ğŸªƒ', 'ğŸ›', 'ğŸ—ƒï¸', 'ğŸ§\u200dâ™‚', 'ğŸ§ğŸ»\u200dâ¡ï¸']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.92s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:08,  4.47s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.53s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.16s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.68s/it]
Processing depth (0, 2, 3, 6):   3%|â–         | 3/100 [01:37<34:50, 21.55s/it]2025-01-22 16:41:21.504 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the apple.
2025-01-22 16:41:21.547 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the bathroom.
2025-01-22 16:41:21.559 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2009, 2015) -->  cable. Daniel journeyed to
2025-01-22 16:41:21.559 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the garden.
2025-01-22 16:41:21.576 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2977, 2982) -->  tragedy. Daniel went to
2025-01-22 16:41:21.577 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John moved to the bedroom.
2025-01-22 16:41:21.603 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4891, 4896) --> . John moved to the
2025-01-22 16:41:21.603 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the bedroom.
2025-01-22 16:41:21.615 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2113, 2119) --> . John went back to the
2025-01-22 16:41:21.615 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary got the football there.
2025-01-22 16:41:21.635 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3582, 3587) --> . Mary got the football
2025-01-22 16:41:21.635 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the office.
2025-01-22 16:41:21.654 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3843, 3849) -->  John journeyed to the office
2025-01-22 16:41:21.655 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the bathroom.
2025-01-22 16:41:21.663 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1706, 1711) --> . Mary moved to the
2025-01-22 16:41:21.663 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John journeyed to the office.
2025-01-22 16:41:21.683 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3842, 3848) --> . John journeyed to the
2025-01-22 16:41:21.683 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra journeyed to the bedroom.
2025-01-22 16:41:21.712 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (5559, 5565) --> . Sandra journeyed to the
2025-01-22 16:41:21.713 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 16:41:21.713 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 16:41:21.713 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 16:41:21.713 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ™‡ğŸ¼\u200dâ™€', 'ğŸ§·', 'ğŸ›ŒğŸ¾', 'ğŸ‘¨ğŸ¾\u200dğŸ³', 'ğŸ’«', 'ğŸ§‘ğŸ»\u200dğŸ¼', 'ğŸ‘¨ğŸ¾\u200dğŸš’', 'ğŸ§‘ğŸ¾\u200dğŸ¦¼\u200dâ¡ï¸', 'ğŸ„ğŸ»\u200dâ™€', 'ğŸ‘¨\u200dğŸ¼']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.79s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.70s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.91s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.44s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.94s/it]
Processing depth (1, 5, 6, 8):   3%|â–         | 3/100 [01:55<34:50, 21.55s/it]2025-01-22 16:41:39.316 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the apple.
2025-01-22 16:41:39.321 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (830, 834) -->  Daniel got the apple
2025-01-22 16:41:39.321 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the bathroom.
2025-01-22 16:41:39.344 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4178, 4184) --> . Daniel journeyed to the
2025-01-22 16:41:39.345 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the garden.
2025-01-22 16:41:39.370 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4741, 4746) --> . Daniel went to the
2025-01-22 16:41:39.370 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John moved to the bedroom.
2025-01-22 16:41:39.409 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6631, 6636) --> . John moved to the
2025-01-22 16:41:39.409 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the bedroom.
2025-01-22 16:41:39.419 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1878, 1884) --> . John went back to the
2025-01-22 16:41:39.419 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary got the football there.
2025-01-22 16:41:39.437 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3571, 3576) --> . Mary got the football
2025-01-22 16:41:39.438 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the office.
2025-01-22 16:41:39.461 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3796, 3802) -->  John journeyed to the office
2025-01-22 16:41:39.461 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the bathroom.
2025-01-22 16:41:39.469 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1568, 1573) --> . Mary moved to the
2025-01-22 16:41:39.469 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John journeyed to the office.
2025-01-22 16:41:39.491 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3795, 3801) --> . John journeyed to the
2025-01-22 16:41:39.491 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra journeyed to the bedroom.
2025-01-22 16:41:39.521 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (5351, 5357) --> . Sandra journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 16:41:40.329 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's house.<|eot_id|>
2025-01-22 16:41:40.329 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8181])
2025-01-22 16:41:42.545 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [168.9828125, 16.79632132820137, 59.619944852941174, 16.242848631611317, 11.760498046875], 'topk_indices': array([8163, 8165, 8162, 8166,    1, 8069, 8079,  834,   14, 8164, 8168,
       8172, 8171,  833,   24, 8169, 8179, 8176,    0, 8177]), 'topk_tokens': ['Question', ' Where', '.\n\n', ' was', '<|start_header_id|>', '.\n\n', ' location', '.', '\n', ':', ' apple', '?', ' garden', ' apple', '\n\n', ' before', '<|end_header_id|>', '<|eot_id|>', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [437.8125, 58.213541666666664, 120.5125, 135.3125]}, 'weight': {'score': [21.054296875, 23.271913947947215, 21.031479779411764, 23.2867389298893, 29.606158088235293], 'topk_indices': array([3307, 3334, 3195, 3147, 7434, 7472, 1424, 1486, 4338, 4322, 5206,
       5145, 7155, 7211, 3490, 3516, 4999, 4970, 4922, 4947]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.681640625, 20.270833333333332, 19.665625, 18.88125]}, 'saliency': {'score': [1.038165283203125, 0.09082832970344193, 0.32342349781709556, 0.08752513477283211, 0.08866310119628906], 'topk_indices': array([ 831, 1573, 8078, 8162, 8166, 8069, 8035, 8107, 8174,   24, 8172,
        830,  277, 8165, 8163, 8079, 8168, 8171,  833, 8169]), 'topk_tokens': [' got', ' bathroom', ' first', '.\n\n', ' was', '.\n\n', ' context', ' moved', 'Answer', '\n\n', '?', ' Daniel', 'hue', ' Where', 'Question', ' location', ' apple', ' garden', ' apple', ' before'], 'evidence_proportions': [3.072021484375, 0.3145345052083333, 0.6001953125, 0.7174072265625]}}, 'pred_res': "Daniel's house.<|eot_id|>", 'score': 0}
2025-01-22 16:41:42.552 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 16:41:42.552 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-6_pid-3_1-5-6-8.pkl | len: 3 |  size: 2.02 KB
Processing depth (1, 5, 6, 8):   4%|â–         | 4/100 [01:58<55:05, 34.43s/it]is_0k: False
your chose emoji: ['ğŸŒ´', 'ğŸ‘¨ğŸ½\u200dâ¤ï¸\u200dğŸ‘¨ğŸ»', 'ğŸ™ğŸ½', 'ğŸ¤¸ğŸ»\u200dâ™‚ï¸', '5ï¸âƒ£', 'ğŸ¦‡', 'ğŸ‘®ğŸ¼\u200dâ™‚ï¸', 'ğŸ‘©\u200dğŸ’¼', 'ğŸ¤¹\u200dâ™‚', 'ğŸ³']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  3.88s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.26s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.39s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.10s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.52s/it]
Processing depth (2, 3, 5, 7):   4%|â–         | 4/100 [02:14<55:05, 34.43s/it]2025-01-22 16:41:58.348 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the apple.
2025-01-22 16:41:58.357 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1738, 1742) -->  Daniel got the apple
2025-01-22 16:41:58.357 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the bathroom.
2025-01-22 16:41:58.372 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2883, 2889) --> . Daniel journeyed to the
2025-01-22 16:41:58.372 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the garden.
2025-01-22 16:41:58.396 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4214, 4219) -->  Daniel went to the garden
2025-01-22 16:41:58.396 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John moved to the bedroom.
2025-01-22 16:41:58.427 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5618, 5623) --> . John moved to the
2025-01-22 16:41:58.427 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the bedroom.
2025-01-22 16:41:58.437 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1804, 1810) --> . John went back to the
2025-01-22 16:41:58.437 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary got the football there.
2025-01-22 16:41:58.458 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3510, 3515) --> . Mary got the football
2025-01-22 16:41:58.458 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the office.
2025-01-22 16:41:58.477 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3809, 3815) -->  John journeyed to the office
2025-01-22 16:41:58.478 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the bathroom.
2025-01-22 16:41:58.485 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1407, 1412) --> . Mary moved to the
2025-01-22 16:41:58.485 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John journeyed to the office.
2025-01-22 16:41:58.504 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3808, 3814) --> . John journeyed to the
2025-01-22 16:41:58.504 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra journeyed to the bedroom.
2025-01-22 16:41:58.530 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (5237, 5243) --> . Sandra journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 16:41:59.308 | INFO     | test_jbb_embedding:begin_test:693 - The bedroom.<|eot_id|>
2025-01-22 16:41:59.308 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8165])
2025-01-22 16:42:01.531 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [387.4515625, 28.25727304725759, 155.76470588235293, 26.83761091939857, 21.701106770833334], 'topk_indices': array([8063, 8163, 8149, 1737, 1742, 8147, 1412, 8150, 8148, 8154, 1738,
       8152, 4219, 1741, 8160, 8156, 8155, 8153, 8161,    0]), 'topk_tokens': [' location', '<|end_header_id|>', ' Where', '.', '.', 'Question', ' bathroom', ' was', ':', ' the', ' Daniel', ' apple', '.', ' apple', '<|eot_id|>', '?', ' garden', ' before', '<|start_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [810.0, 354.6041666666667, 433.675, 42.60625]}, 'weight': {'score': [22.1828125, 23.25349305215475, 21.031479779411764, 23.26544302286172, 29.196875], 'topk_indices': array([3319, 3292, 3152, 3200, 7400, 7438, 1435, 1497, 4290, 4306, 5143,
       5204, 7121, 7177, 3475, 3501, 4962, 4939, 4914, 4991]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.681640625, 20.270833333333332, 24.1796875, 18.88125]}, 'saliency': {'score': [2.4312347412109374, 0.1574661000818744, 0.8280747357536765, 0.14905149983102123, 0.16826629638671875], 'topk_indices': array([8158, 8053, 2884, 2885, 1409, 1739, 4218, 8150, 2889, 8019, 8063,
       8149, 8147, 8156, 1412, 8152, 1738, 1741, 8153, 8155]), 'topk_tokens': ['Answer', '.\n\n', ' Daniel', ' journey', ' moved', ' got', ' garden', ' was', ' bathroom', ' context', ' location', ' Where', 'Question', '?', ' bathroom', ' apple', ' Daniel', ' apple', ' before', ' garden'], 'evidence_proportions': [5.68310546875, 2.0443522135416665, 2.511328125, 0.21390380859375]}}, 'pred_res': 'The bedroom.<|eot_id|>', 'score': 0}
2025-01-22 16:42:01.549 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 16:42:01.549 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-6_pid-4_2-3-5-7.pkl | len: 3 |  size: 2.03 KB
Processing depth (2, 3, 5, 7):   5%|â–Œ         | 5/100 [02:17<45:41, 28.86s/it]Processing depth (2, 3, 5, 7):   5%|â–Œ         | 5/100 [02:17<43:30, 27.48s/it]
2025-01-22 16:42:01.637 | INFO     | __main__:<module>:82 - Selected idx: 8
2025-01-22 16:42:01.637 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the milk before the kitchen? 
2025-01-22 16:42:01.637 | INFO     | __main__:<module>:84 - Answer: hallway
2025-01-22 16:42:01.637 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 16:42:01.637 | INFO     | __main__:<module>:86 - Needle: [' Mary journeyed to the office.', ' Daniel went back to the kitchen.', ' John moved to the bedroom.', ' Sandra picked up the milk.', ' Mary moved to the bathroom.', ' John went back to the bedroom.', ' John journeyed to the office.', ' Sandra travelled to the hallway.', ' Mary got the football there.', ' Sandra went to the kitchen.', ' Daniel went back to the hallway.']
2025-01-22 16:42:01.637 | INFO     | __main__:<module>:87 - Real Needle: [' Sandra picked up the milk.', ' Sandra travelled to the hallway.', ' Sandra went to the kitchen.', ' Daniel went back to the hallway.']
2025-01-22 16:42:01.637 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ‘·ğŸ¼\u200dâ™‚', 'ğŸ‡²ğŸ‡¿', 'ğŸ™ğŸ¼\u200dâ™‚', 'ğŸ‘³ğŸ¾', 'ğŸ•', 'ãŠ™', 'ğŸ†˜', '\U0001fae5', 'ğŸƒğŸ¼\u200dâ™‚', 'ğŸ™†ğŸ¾\u200dâ™€ï¸']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.57s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.80s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.50s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.14s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.68s/it]
Processing depth (2, 3, 4, 6):   0%|          | 0/100 [00:16<?, ?it/s]2025-01-22 16:42:18.688 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra picked up the milk.
2025-01-22 16:42:18.699 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1752, 1757) --> . Sandra picked up the
2025-01-22 16:42:18.700 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra travelled to the hallway.
2025-01-22 16:42:18.724 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2836, 2841) --> . Sandra travelled to the
2025-01-22 16:42:18.724 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went to the kitchen.
2025-01-22 16:42:18.743 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3610, 3615) --> . Sandra went to the
2025-01-22 16:42:18.743 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went back to the hallway.
2025-01-22 16:42:18.770 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4776, 4782) -->  the senate. Daniel went back
2025-01-22 16:42:18.770 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the office.
2025-01-22 16:42:18.772 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (316, 322) -->  John journeyed to the office
2025-01-22 16:42:18.772 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went back to the kitchen.
2025-01-22 16:42:18.799 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4776, 4782) -->  the senate. Daniel went back
2025-01-22 16:42:18.799 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the bedroom.
2025-01-22 16:42:18.836 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6468, 6473) --> . John moved to the
2025-01-22 16:42:18.836 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the bathroom.
2025-01-22 16:42:18.862 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4933, 4938) --> . Mary moved to the
2025-01-22 16:42:18.862 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went back to the bedroom.
2025-01-22 16:42:18.884 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4497, 4503) --> . John went back to the
2025-01-22 16:42:18.884 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John journeyed to the office.
2025-01-22 16:42:18.886 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (315, 321) --> . John journeyed to the
2025-01-22 16:42:18.886 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Mary got the football there.
2025-01-22 16:42:18.906 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (3810, 3815) --> . Mary got the football
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 16:42:19.724 | INFO     | test_jbb_embedding:begin_test:693 - The hallway.<|eot_id|>
2025-01-22 16:42:19.725 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8176])
2025-01-22 16:42:21.931 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [65.57831101190476, 7.58182015298325, 22.498497596153847, 7.360157789598473, 6.654832409274194], 'topk_indices': array([8064, 8074, 8030,    4,    3, 8163,   23,    9, 8170, 8166,    1,
       2841,   24, 8175, 8164,   14, 8172, 8174,    0, 8171]), 'topk_tokens': ['.\n\n', ' location', ' context', '\n\n', '<|end_header_id|>', ' milk', '4', ':', ':', ' kitchen', '<|start_header_id|>', ' hallway', '\n\n', '\n\n', ' before', '\n', '<|start_header_id|>', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [102.05, 73.7875, 68.09375, 26.248046875]}, 'weight': {'score': [22.924107142857142, 23.27137715490891, 21.317908653846153, 23.281658955844314, 29.910534274193548], 'topk_indices': array([3321, 3294, 3214, 3166, 7457, 7419, 1512, 1450, 4295, 4311, 5206,
       5145, 7196, 7140, 3477, 3503, 4987, 4929, 4958, 4904]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [23.49375, 22.15, 20.796875, 24.8671875]}, 'saliency': {'score': [0.3926050095331101, 0.041354713761758394, 0.1261741442558093, 0.0400387617971733, 0.050736027379189766], 'topk_indices': array([8064,   23,   16, 3615,    8, 8160, 1753, 8173, 8145, 8158, 8175,
         24,   20, 8074, 8169, 8030, 8163, 8164, 8166, 2841]), 'topk_tokens': ['.\n\n', '4', ' Date', ' kitchen', ' Date', ' Where', ' Sandra', 'assistant', ' return', 'Question', '\n\n', '\n\n', ' Jul', ' location', 'Answer', ' context', ' milk', ' before', ' kitchen', ' hallway'], 'evidence_proportions': [0.659521484375, 0.425, 0.3600341796875, 0.1703211466471354]}}, 'pred_res': 'The hallway.<|eot_id|>', 'score': 100}
2025-01-22 16:42:21.943 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 16:42:21.943 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-8_pid-0_2-3-4-6.pkl | len: 3 |  size: 2.03 KB
Processing depth (2, 3, 4, 6):   1%|          | 1/100 [00:20<33:18, 20.18s/it]is_0k: False
your chose emoji: ['ğŸ‘©\u200dğŸ¦¯', 'ğŸ§ğŸ½\u200dâ™€', 'ğŸ’ğŸ¿', 'ğŸ¤¾ğŸ»\u200dâ™‚ï¸', 'ğŸ§”ğŸ»\u200dâ™€ï¸', 'ğŸ¤¾\u200dâ™‚', 'ğŸ¤µğŸ¼', 'â™»ï¸', 'â¤\u200dğŸ”¥', 'ğŸŒ']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.33s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.62s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.42s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.04s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.57s/it]
Processing depth (2, 3, 4, 7):   1%|          | 1/100 [00:36<33:18, 20.18s/it]2025-01-22 16:42:38.011 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra picked up the milk.
2025-01-22 16:42:38.020 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1584, 1589) --> . Sandra picked up the
2025-01-22 16:42:38.021 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra travelled to the hallway.
2025-01-22 16:42:38.035 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2748, 2753) --> . Sandra travelled to the
2025-01-22 16:42:38.036 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went to the kitchen.
2025-01-22 16:42:38.053 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3584, 3589) --> . Sandra went to the
2025-01-22 16:42:38.053 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went back to the hallway.
2025-01-22 16:42:38.082 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5660, 5666) --> . Daniel went back to the
2025-01-22 16:42:38.082 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the office.
2025-01-22 16:42:38.084 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (286, 292) -->  John journeyed to the office
2025-01-22 16:42:38.084 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went back to the kitchen.
2025-01-22 16:42:38.115 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5660, 5666) --> . Daniel went back to the
2025-01-22 16:42:38.115 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the bedroom.
2025-01-22 16:42:38.148 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6510, 6515) --> . John moved to the
2025-01-22 16:42:38.148 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the bathroom.
2025-01-22 16:42:38.172 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4842, 4847) -->  the senate. Mary moved
2025-01-22 16:42:38.172 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went back to the bedroom.
2025-01-22 16:42:38.195 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4486, 4492) -->  execution. John went back to
2025-01-22 16:42:38.195 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John journeyed to the office.
2025-01-22 16:42:38.196 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (285, 291) --> . John journeyed to the
2025-01-22 16:42:38.196 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Mary got the football there.
2025-01-22 16:42:38.215 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (3792, 3797) --> . Mary got the football
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 16:42:39.022 | INFO     | test_jbb_embedding:begin_test:693 - The hallway.<|eot_id|>
2025-01-22 16:42:39.022 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8220])
2025-01-22 16:42:41.247 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [149.97916666666666, 15.785403745591633, 61.064503205128204, 15.223851142349627, 15.57421875], 'topk_indices': array([8073,   24,   14, 8201, 8204, 8118, 8202, 8205, 2753, 8203, 8074,
       1671, 8209, 8207, 8211, 8210, 8208,    0, 8215, 8216]), 'topk_tokens': [' you', '\n\n', '\n', '.\n\n', ' Where', ' location', 'Question', ' was', ' hallway', ':', ' context', ' time', ' the', ' milk', '?', ' kitchen', ' before', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [254.95, 214.025, 128.0125, 27.4375]}, 'weight': {'score': [21.798363095238095, 23.297674966557217, 21.889423076923077, 23.308260213769447, 29.455915178571427], 'topk_indices': array([3347, 3320, 3240, 3192, 7473, 7511, 1482, 1544, 4347, 4331, 5192,
       5253, 7194, 7250, 3503, 3529, 4969, 5017, 4994, 5046]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [23.49375, 22.15, 20.796875, 20.927083333333332]}, 'saliency': {'score': [0.88360595703125, 0.0873829413544707, 0.3425285143729968, 0.08411559348274034, 0.11594209216889881], 'topk_indices': array([8072, 1644, 1645, 3589, 2750, 1589, 8205, 1749, 1670, 1585, 8118,
       8204, 1671, 8211, 8202, 8074, 8207, 2753, 8208, 8210]), 'topk_tokens': [' provided', ' const', 'ern', ' kitchen', ' travelled', ' milk', ' was', ' some', ' some', ' Sandra', ' location', ' Where', ' time', '?', 'Question', ' context', ' milk', ' hallway', ' before', ' kitchen'], 'evidence_proportions': [1.597265625, 1.300732421875, 0.634033203125, 0.149261474609375]}}, 'pred_res': 'The hallway.<|eot_id|>', 'score': 100}
2025-01-22 16:42:41.254 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 16:42:41.254 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-8_pid-1_2-3-4-7.pkl | len: 3 |  size: 2.02 KB
Processing depth (2, 3, 4, 7):   2%|â–         | 2/100 [00:39<32:07, 19.67s/it]is_0k: False
your chose emoji: ['ğŸ¨', 'ğŸ§œğŸ»\u200dâ™€', 'ğŸ‘¨\u200dğŸ”§', 'ğŸ‘¨ğŸ¿\u200dâ¤\u200dğŸ‘¨ğŸ¾', 'ğŸ§‘ğŸ¾\u200dğŸ­', 'ğŸ‘¨ğŸ¼\u200dâ¤\u200dğŸ‘¨ğŸ¼', 'ğŸ¤ğŸ¼', 'ğŸƒğŸ¾\u200dâ™€\u200dâ¡ï¸', 'ğŸƒğŸ¼', 'âš“']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.70s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:10,  5.04s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.68s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.03s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.68s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (1, 3, 4, 9):   2%|â–         | 2/100 [00:55<32:07, 19.67s/it]2025-01-22 16:42:57.738 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra picked up the milk.
2025-01-22 16:42:57.742 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (771, 776) -->  Sandra picked up the milk
2025-01-22 16:42:57.743 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra travelled to the hallway.
2025-01-22 16:42:57.760 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2876, 2881) --> . Sandra travelled to the
2025-01-22 16:42:57.760 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went to the kitchen.
2025-01-22 16:42:57.780 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3618, 3623) --> . Sandra went to the
2025-01-22 16:42:57.780 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went back to the hallway.
2025-01-22 16:42:57.815 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6126, 6132) -->  went back to the kitchen.
2025-01-22 16:42:57.815 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the office.
2025-01-22 16:42:57.817 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (304, 310) -->  John journeyed to the office
2025-01-22 16:42:57.817 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went back to the kitchen.
2025-01-22 16:42:57.853 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6125, 6131) -->  Daniel went back to the kitchen
2025-01-22 16:42:57.853 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the bedroom.
2025-01-22 16:42:57.890 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6473, 6478) --> . John moved to the
2025-01-22 16:42:57.891 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the bathroom.
2025-01-22 16:42:57.919 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4982, 4987) --> . Mary moved to the
2025-01-22 16:42:57.919 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went back to the bedroom.
2025-01-22 16:42:57.945 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4548, 4554) -->  John went back to the bedroom
2025-01-22 16:42:57.945 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John journeyed to the office.
2025-01-22 16:42:57.947 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (303, 309) --> . John journeyed to the
2025-01-22 16:42:57.947 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Mary got the football there.
2025-01-22 16:42:57.996 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (3818, 3823) --> . Mary got the football
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 16:43:04.729 | INFO     | test_jbb_embedding:begin_test:693 - The milk was picked up by Sandra.<|eot_id|>
2025-01-22 16:43:04.729 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8206])
2025-01-22 16:43:07.668 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [345.75, 28.563076729808746, 142.1386217948718, 27.202127945146643, 42.197722199675326], 'topk_indices': array([8189, 8094, 8193,  775,  766, 8196, 8059,  771,   14, 8204,   24,
        765,  776, 2881, 8060,  767, 8194, 8201,    0, 8202]), 'topk_tokens': [':', '.\n\n', ' milk', ' milk', 'ï¿½', ' kitchen', ' you', ' Sandra', '\n', '<|end_header_id|>', '\n\n', 'ï¿½', '.', ' hallway', ' context', 'ï¿½', ' before', '<|eot_id|>', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [671.0, 379.35, 175.3, 188.75]}, 'weight': {'score': [22.858258928571427, 23.29043960896577, 22.021434294871796, 23.297626625966377, 29.630073051948052], 'topk_indices': array([3302, 3329, 3192, 3144, 7437, 7475, 1440, 1502, 4293, 4309, 5124,
       5185, 7158, 7214, 3511, 3485, 4920, 4943, 4972, 4895]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.0453125, 22.15, 20.796875, 20.84375]}, 'saliency': {'score': [2.171200706845238, 0.15920111560577568, 0.8125766851963141, 0.15088921983573522, 0.31227052366578734], 'topk_indices': array([8175, 8190, 2878, 2877,   24, 8059,  766, 8188, 8104, 8058,  772,
       8193,  775, 8196,  767, 8194,  771,  765, 8060, 2881]), 'topk_tokens': [' return', ' Where', ' travelled', ' Sandra', '\n\n', ' you', 'ï¿½', 'Question', ' location', ' provided', ' picked', ' milk', ' milk', ' kitchen', 'ï¿½', ' before', ' Sandra', 'ï¿½', ' context', ' hallway'], 'evidence_proportions': [4.8109375, 2.2435546875, 0.90986328125, 0.9622395833333334]}}, 'pred_res': 'The milk was picked up by Sandra.<|eot_id|>', 'score': 0}
2025-01-22 16:43:07.672 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 16:43:07.672 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-8_pid-2_1-3-4-9.pkl | len: 3 |  size: 2.04 KB
Processing depth (1, 3, 4, 9):   3%|â–         | 3/100 [01:05<36:46, 22.75s/it]is_0k: False
your chose emoji: ['ğŸ‘³\u200dâ™‚', 'ğŸ«', 'ğŸš“', 'ğŸ‘¨ğŸ¼\u200dğŸ”¬', 'ğŸ‘©ğŸ¼\u200dâ¤\u200dğŸ‘©ğŸ¼', 'ğŸ”‰', 'ğŸƒğŸ¼\u200dâ™€\u200dâ¡ï¸', 'ğŸ’‡ğŸ¿\u200dâ™‚', 'ğŸ', 'ğŸ‘©ğŸ¿\u200dğŸ¦¯\u200dâ¡ï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:05<00:15,  5.19s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.13s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.65s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.23s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.85s/it]
Processing depth (1, 3, 5, 6):   3%|â–         | 3/100 [01:23<36:46, 22.75s/it]2025-01-22 16:43:24.944 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra picked up the milk.
2025-01-22 16:43:24.948 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (822, 827) --> . Sandra picked up the
2025-01-22 16:43:24.948 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra travelled to the hallway.
2025-01-22 16:43:24.964 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2926, 2931) --> . Sandra travelled to the
2025-01-22 16:43:24.965 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went to the kitchen.
2025-01-22 16:43:24.988 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4180, 4185) --> . Sandra went to the
2025-01-22 16:43:24.988 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went back to the hallway.
2025-01-22 16:43:25.011 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4762, 4768) --> . Daniel went back to the
2025-01-22 16:43:25.012 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the office.
2025-01-22 16:43:25.013 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (356, 362) -->  John journeyed to the office
2025-01-22 16:43:25.014 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went back to the kitchen.
2025-01-22 16:43:25.039 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4762, 4768) --> . Daniel went back to the
2025-01-22 16:43:25.039 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the bedroom.
2025-01-22 16:43:25.075 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6481, 6486) -->  John moved to the bedroom
2025-01-22 16:43:25.075 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the bathroom.
2025-01-22 16:43:25.099 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4923, 4928) --> . Mary moved to the
2025-01-22 16:43:25.099 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went back to the bedroom.
2025-01-22 16:43:25.124 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4525, 4531) --> . John went back to the
2025-01-22 16:43:25.124 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John journeyed to the office.
2025-01-22 16:43:25.127 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (355, 361) --> . John journeyed to the
2025-01-22 16:43:25.127 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Mary got the football there.
2025-01-22 16:43:25.149 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (3798, 3803) --> . Mary got the football
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 16:43:25.926 | INFO     | test_jbb_embedding:begin_test:693 - The hallway.<|eot_id|>
2025-01-22 16:43:25.926 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8192])
2025-01-22 16:43:28.170 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [274.92559523809524, 25.78001639719341, 108.9014423076923, 24.7383700829748, 24.42862723214286], 'topk_indices': array([8177, 8080, 2927,  828, 8182,  827,    1, 8179, 8045,  823,   14,
       8090, 2931, 8190,   24, 8180, 8046, 8187,    0, 8188]), 'topk_tokens': [' was', '.\n\n', ' Sandra', '.', ' kitchen', ' milk', '<|start_header_id|>', ' milk', ' you', ' Sandra', '\n', ' location', ' hallway', '<|end_header_id|>', '\n\n', ' before', ' context', '<|eot_id|>', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [450.85, 449.3, 162.2, 76.94791666666667]}, 'weight': {'score': [21.798363095238095, 23.276090604026844, 21.407451923076923, 23.288863706207746, 29.427678571428572], 'topk_indices': array([3302, 3329, 3138, 3186, 7477, 7439, 1480, 1418, 4323, 4339, 5240,
       5179, 7216, 7160, 3503, 3529, 4998, 4975, 4950, 5027]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [23.49375, 22.15, 20.796875, 20.927083333333332]}, 'saliency': {'score': [1.6669456845238095, 0.14339610781154669, 0.6109572190504807, 0.13722162416689074, 0.177294921875], 'topk_indices': array([  32,  824, 8161,   20, 8185, 8176, 8045,   24, 8174, 8044, 2928,
        827, 8182, 8179, 8090, 2927, 8180,  823, 2931, 8046]), 'topk_tokens': ['***', ' picked', ' return', ' Jul', 'Answer', ' Where', ' you', '\n\n', 'Question', ' provided', ' travelled', ' milk', ' kitchen', ' milk', ' location', ' Sandra', ' before', ' Sandra', ' hallway', ' context'], 'evidence_proportions': [2.90556640625, 2.7375, 0.851611328125, 0.4220784505208333]}}, 'pred_res': 'The hallway.<|eot_id|>', 'score': 100}
2025-01-22 16:43:28.178 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 16:43:28.178 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-8_pid-3_1-3-5-6.pkl | len: 3 |  size: 2.05 KB
Processing depth (1, 3, 5, 6):   4%|â–         | 4/100 [01:26<34:59, 21.86s/it]is_0k: False
your chose emoji: ['âš’', 'ğŸ–¥ï¸', 'ğŸ§‘ğŸ¾\u200dâ¤\u200dğŸ’‹\u200dğŸ§‘ğŸ»', 'ğŸ‡¦ğŸ‡±', 'ğŸš£ğŸ¿\u200dâ™€', 'ğŸ™†\u200dâ™‚ï¸', 'ğŸš»', '\U0001faf1ğŸ½', 'ğŸ‘³ğŸ¼\u200dâ™‚', 'ğŸ‡²ğŸ‡­']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.91s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.68s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.73s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.30s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.83s/it]
Processing depth (0, 2, 6, 7):   4%|â–         | 4/100 [01:43<34:59, 21.86s/it]2025-01-22 16:43:45.333 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra picked up the milk.
2025-01-22 16:43:45.333 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (32, 37) -->  picked up the milk.
2025-01-22 16:43:45.334 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra travelled to the hallway.
2025-01-22 16:43:45.343 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1777, 1782) --> . Sandra travelled to the
2025-01-22 16:43:45.344 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went to the kitchen.
2025-01-22 16:43:45.372 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4759, 4764) --> . Sandra went to the
2025-01-22 16:43:45.372 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went back to the hallway.
2025-01-22 16:43:45.405 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5685, 5691) --> . Daniel went back to the
2025-01-22 16:43:45.405 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the office.
2025-01-22 16:43:45.407 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (301, 307) -->  John journeyed to the office
2025-01-22 16:43:45.407 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went back to the kitchen.
2025-01-22 16:43:45.437 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5685, 5691) --> . Daniel went back to the
2025-01-22 16:43:45.437 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the bedroom.
2025-01-22 16:43:45.472 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6505, 6510) --> . John moved to the
2025-01-22 16:43:45.472 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the bathroom.
2025-01-22 16:43:45.500 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4919, 4924) --> . Mary moved to the
2025-01-22 16:43:45.500 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went back to the bedroom.
2025-01-22 16:43:45.524 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4487, 4493) -->  execution. John went back to
2025-01-22 16:43:45.524 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John journeyed to the office.
2025-01-22 16:43:45.526 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (300, 306) --> . John journeyed to the
2025-01-22 16:43:45.526 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Mary got the football there.
2025-01-22 16:43:45.547 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (3795, 3800) --> . Mary got the football
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 16:43:46.347 | INFO     | test_jbb_embedding:begin_test:693 - The office.<|eot_id|>
2025-01-22 16:43:46.347 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8197])
2025-01-22 16:43:48.580 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [299.39285714285717, 36.97837652439024, 125.85476762820512, 35.875565302518424, 23.10073513454861], 'topk_indices': array([8184,  103, 8182, 8095, 8186,  104, 1782, 8187,   65, 8185, 8192,
         66,  105,   67, 8193,   70,   68,  106,    0,   69]), 'topk_tokens': [' milk', 'ENCES', ' was', ' location', ' the', ' OF', ' hallway', ' kitchen', 'ENCES', ' before', '<|eot_id|>', ' OF', ' P', ' P', '<|start_header_id|>', 'ER', 'ION', 'ION', '<|begin_of_text|>', 'E'], 'evidence_proportions': [565.2, 396.95, 170.6, 103.91666666666667]}, 'weight': {'score': [21.448660714285715, 23.288302210365853, 21.283253205128204, 23.302654714373464, 30.000868055555557], 'topk_indices': array([3307, 3334, 3227, 3179, 7482, 7444, 1455, 1517, 4332, 4348, 5230,
       5169, 7221, 7165, 3508, 3534, 5023, 4971, 4946, 4994]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.025, 22.15, 20.796875, 20.927083333333332]}, 'saliency': {'score': [1.6702357700892858, 0.2086480712890625, 0.6819348457532052, 0.2026098002965679, 0.16942066616482204], 'topk_indices': array([  58,   61,   64,   42,   53,  103, 8095, 8184,   66,    0,  105,
         65, 8187, 8185, 1782,   67,   70,   69,  106,   68]), 'topk_tokens': [' Proof', '\n\n\n\n', 'ISC', '-text', ' Gutenberg', 'ENCES', ' location', ' milk', ' OF', '<|begin_of_text|>', ' P', 'ENCES', ' kitchen', ' before', ' hallway', ' P', 'ER', 'E', 'ION', 'ION'], 'evidence_proportions': [2.9603515625, 2.39658203125, 0.932568359375, 0.6045735677083334]}}, 'pred_res': 'The office.<|eot_id|>', 'score': 0}
2025-01-22 16:43:48.586 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 16:43:48.587 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-8_pid-4_0-2-6-7.pkl | len: 3 |  size: 1.99 KB
Processing depth (0, 2, 6, 7):   5%|â–Œ         | 5/100 [01:46<33:47, 21.34s/it]Processing depth (0, 2, 6, 7):   5%|â–Œ         | 5/100 [01:46<33:51, 21.38s/it]
2025-01-22 16:43:48.675 | INFO     | __main__:<module>:82 - Selected idx: 10
2025-01-22 16:43:48.675 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the apple before the bedroom? 
2025-01-22 16:43:48.675 | INFO     | __main__:<module>:84 - Answer: bathroom
2025-01-22 16:43:48.676 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 16:43:48.676 | INFO     | __main__:<module>:86 - Needle: [' Daniel picked up the apple.', ' Sandra moved to the kitchen.', ' Mary picked up the apple.', ' John went back to the office.', ' Daniel took the football.', ' Daniel left the apple.', ' Mary moved to the bathroom.', ' John moved to the garden.', ' Sandra journeyed to the office.', ' Mary journeyed to the bedroom.', ' Daniel dropped the football.']
2025-01-22 16:43:48.676 | INFO     | __main__:<module>:87 - Real Needle: [' Mary picked up the apple.', ' Mary moved to the bathroom.', ' Mary journeyed to the bedroom.', ' Daniel dropped the football.']
2025-01-22 16:43:48.676 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ·', 'ğŸ‘¨ğŸ¿\u200dğŸ¦³', 'â™»', 'ğŸ‘©ğŸ»\u200dâ¤\u200dğŸ’‹\u200dğŸ‘©ğŸ½', 'ğŸ‘°ğŸ»\u200dâ™€ï¸', 'ğŸ™ğŸ¾\u200dâ™‚ï¸', 'ğŸ¥²', 'ğŸš£ğŸ¿\u200dâ™€ï¸', 'ğŸ¥—', 'ğŸ‘¨\u200dâœˆ']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.33s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.75s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.90s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.45s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.92s/it]
Processing depth (3, 5, 7, 8):   0%|          | 0/100 [00:17<?, ?it/s]2025-01-22 16:44:06.182 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 16:44:06.197 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2943, 2948) --> . Mary picked up the
2025-01-22 16:44:06.198 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary moved to the bathroom.
2025-01-22 16:44:06.219 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4188, 4193) --> . Mary moved to the
2025-01-22 16:44:06.220 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bedroom.
2025-01-22 16:44:06.253 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5645, 5651) -->  Mary journeyed to the bedroom
2025-01-22 16:44:06.253 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel dropped the football.
2025-01-22 16:44:06.285 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6649, 6653) -->  Daniel dropped the football
2025-01-22 16:44:06.285 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the apple.
2025-01-22 16:44:06.302 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2944, 2949) -->  Mary picked up the apple
2025-01-22 16:44:06.302 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the kitchen.
2025-01-22 16:44:06.306 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (657, 662) --> . Sandra moved to the
2025-01-22 16:44:06.306 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the office.
2025-01-22 16:44:06.315 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1546, 1552) --> . John went back to the
2025-01-22 16:44:06.315 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel took the football.
2025-01-22 16:44:06.352 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6270, 6274) -->  Daniel took the football
2025-01-22 16:44:06.352 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel left the apple.
2025-01-22 16:44:06.368 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3274, 3278) -->  Daniel left the apple
2025-01-22 16:44:06.368 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John moved to the garden.
2025-01-22 16:44:06.403 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (6933, 6938) --> . John moved to the
2025-01-22 16:44:06.403 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Sandra journeyed to the office.
2025-01-22 16:44:06.410 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (1133, 1139) --> . Sandra journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 16:44:07.222 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 16:44:07.222 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8189])
2025-01-22 16:44:09.434 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [221.1125, 24.194108963012695, 191.91785714285714, 22.988664818114785, 22.293546434859156], 'topk_indices': array([8077, 8177, 8170, 8087,  663, 8179,  657,   23, 8183, 3274, 5650,
       8185, 2137,   14,   24,    1, 4193, 8187, 8184,    0]), 'topk_tokens': ['.\n\n', ' before', '.\n\n', ' location', '.', ' bedroom', '.', '4', ':', ' Daniel', ' bedroom', '<|start_header_id|>', ' the', '\n', '\n\n', '<|start_header_id|>', ' bathroom', '<|end_header_id|>', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [229.35, 272.525, 201.41666666666666, 176.09375]}, 'weight': {'score': [23.27734375, 23.282163619995117, 22.693973214285716, 23.28470547345459, 29.709286971830984], 'topk_indices': array([3288, 3315, 3203, 3155, 7468, 7430, 1506, 1444, 4331, 4347, 5170,
       5231, 7151, 7207, 3471, 3497, 4989, 5018, 4966, 4941]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.1, 19.646875, 24.57421875, 27.341796875]}, 'saliency': {'score': [1.32247314453125, 0.1358853131532669, 1.2218000139508929, 0.1282979011887251, 0.16893822038677378], 'topk_indices': array([8182, 8176,   20, 8158,  662, 2090, 6273, 7761, 8177,    0,  659,
       8087, 2948,   24,  670,  658, 8179, 3274, 5650, 4193]), 'topk_tokens': ['Answer', ' apple', ' Jul', ' return', ' kitchen', ' river', ' football', 'inen', ' before', '<|begin_of_text|>', ' moved', ' location', ' apple', '\n\n', ' presses', ' Sandra', ' bedroom', ' Daniel', ' bedroom', ' bathroom'], 'evidence_proportions': [1.2943359375, 1.33076171875, 1.3884684244791667, 1.248291015625]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 0}
2025-01-22 16:44:09.441 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 16:44:09.441 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-10_pid-0_3-5-7-8.pkl | len: 3 |  size: 2.05 KB
Processing depth (3, 5, 7, 8):   1%|          | 1/100 [00:20<34:06, 20.67s/it]is_0k: False
your chose emoji: ['ğŸ”¸', 'ğŸ‘¨ğŸ½\u200dâœˆï¸', 'ğŸ¤¸ğŸ¿\u200dâ™€', 'ğŸ“•', 'ğŸ‘©\u200dğŸ‘§\u200dğŸ‘¦', 'ğŸ§\u200dâ™€ï¸\u200dâ¡ï¸', 'ğŸ™…ğŸ½\u200dâ™€', 'ğŸš', 'ğŸŒğŸ»\u200dâ™‚', 'ğŸ¤ŒğŸ¾']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  3.74s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.37s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.70s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.32s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.71s/it]
Processing depth (3, 5, 6, 7):   1%|          | 1/100 [00:37<34:06, 20.67s/it]2025-01-22 16:44:26.095 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 16:44:26.109 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2642, 2647) -->  Mary picked up the apple
2025-01-22 16:44:26.109 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary moved to the bathroom.
2025-01-22 16:44:26.130 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4182, 4187) --> . Mary moved to the
2025-01-22 16:44:26.130 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bedroom.
2025-01-22 16:44:26.160 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4766, 4772) --> . Mary journeyed to the
2025-01-22 16:44:26.161 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel dropped the football.
2025-01-22 16:44:26.189 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5662, 5666) -->  Daniel dropped the football
2025-01-22 16:44:26.189 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the apple.
2025-01-22 16:44:26.204 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2643, 2648) -->  picked up the apple.
2025-01-22 16:44:26.204 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the kitchen.
2025-01-22 16:44:26.208 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (767, 772) --> . Sandra moved to the
2025-01-22 16:44:26.208 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the office.
2025-01-22 16:44:26.215 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1442, 1448) --> . John went back to the
2025-01-22 16:44:26.215 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel took the football.
2025-01-22 16:44:26.251 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6210, 6214) -->  took the football.
2025-01-22 16:44:26.251 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel left the apple.
2025-01-22 16:44:26.267 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3088, 3092) -->  Daniel left the apple
2025-01-22 16:44:26.267 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John moved to the garden.
2025-01-22 16:44:26.301 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (6801, 6806) --> . John moved to the
2025-01-22 16:44:26.301 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Sandra journeyed to the office.
2025-01-22 16:44:26.306 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (1098, 1104) -->  Sandra journeyed to the office
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 16:44:27.143 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 16:44:27.143 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8259])
2025-01-22 16:44:29.378 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [231.5953125, 21.11612843439845, 174.92098214285716, 19.947278238089435, 25.522553066037737], 'topk_indices': array([8242, 2647,    1, 8240,   14, 4772,   24, 8248, 8246, 8244, 8243,
       4773, 8250, 8257, 8249, 8247, 4187, 8255,    0, 8254]), 'topk_tokens': [':', '.', '<|start_header_id|>', '.\n\n', '\n', ' bedroom', '\n\n', ' the', ' apple', ' was', ' Where', '.', '?', '<|end_header_id|>', ' bedroom', ' before', ' bathroom', '<|start_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [250.0, 306.8, 241.96875, 99.0234375]}, 'weight': {'score': [23.07265625, 23.34673807794723, 21.908035714285713, 23.35354156512733, 30.1061320754717], 'topk_indices': array([3368, 3395, 3288, 3240, 7520, 7482, 1533, 1471, 4369, 4353, 5254,
       5193, 7259, 7203, 3577, 3551, 5047, 4989, 4964, 5018]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.7078125, 19.646875, 20.052083333333332, 27.341796875]}, 'saliency': {'score': [1.2874267578125, 0.11880080205307432, 1.0263357979910714, 0.11208260490758651, 0.19741173510281546], 'topk_indices': array([8228, 3088,    0, 4184,   24, 8240, 8252,  772,  769, 2646, 8244,
       8241, 8250,  768, 8246, 8243, 4772, 8247, 8249, 4187]), 'topk_tokens': [' return', ' Daniel', '<|begin_of_text|>', ' moved', '\n\n', '.\n\n', 'Answer', ' kitchen', ' moved', ' apple', ' was', 'Question', '?', ' Sandra', ' apple', ' Where', ' bedroom', ' before', ' bedroom', ' bathroom'], 'evidence_proportions': [1.7462890625, 1.554443359375, 1.0687662760416667, 0.70806884765625]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 0}
2025-01-22 16:44:29.394 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 16:44:29.395 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-10_pid-1_3-5-6-7.pkl | len: 3 |  size: 2.04 KB
Processing depth (3, 5, 6, 7):   2%|â–         | 2/100 [00:40<33:04, 20.25s/it]is_0k: False
your chose emoji: ['ğŸ§‘ğŸ¼\u200dâš•ï¸', 'ğŸ’ğŸ¿\u200dâ™‚', 'ğŸ¤½ğŸ¾\u200dâ™‚', 'ğŸ’ğŸ¿\u200dâ™€ï¸', 'ğŸ‡²ğŸ‡´', 'ğŸ‘©ğŸ¼\u200dğŸ«', 'ğŸ§‘ğŸ»\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ§‘ğŸ¼', 'ğŸ’‡ğŸ½\u200dâ™‚ï¸', 'ğŸŠğŸ»\u200dâ™‚', 'ğŸ‘©ğŸ¾\u200dâ¤\u200dğŸ’‹\u200dğŸ‘©ğŸ¿']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  3.97s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.33s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.08s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:12<00:00,  2.65s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:12<00:00,  3.20s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 4, 6, 9):   2%|â–         | 2/100 [00:55<33:04, 20.25s/it]2025-01-22 16:44:43.984 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 16:44:43.985 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the apple.
2025-01-22 16:44:43.985 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary moved to the bathroom.
2025-01-22 16:44:44.003 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3635, 3640) -->  Hon. Mary moved to
2025-01-22 16:44:44.004 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bedroom.
2025-01-22 16:44:44.028 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4768, 4774) -->  the senate. Mary journeyed
2025-01-22 16:44:44.028 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel dropped the football.
2025-01-22 16:44:44.066 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7271, 7275) -->  Daniel dropped the football
2025-01-22 16:44:44.066 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the apple.
2025-01-22 16:44:44.066 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the apple.
2025-01-22 16:44:44.066 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the kitchen.
2025-01-22 16:44:44.070 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (815, 820) --> . Sandra moved to the
2025-01-22 16:44:44.070 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the office.
2025-01-22 16:44:44.078 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1574, 1580) --> . John went back to the
2025-01-22 16:44:44.079 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel took the football.
2025-01-22 16:44:44.110 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6292, 6296) -->  Daniel took the football
2025-01-22 16:44:44.110 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel left the apple.
2025-01-22 16:44:44.126 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3234, 3238) -->  Daniel left the apple
2025-01-22 16:44:44.126 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John moved to the garden.
2025-01-22 16:44:44.168 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (6910, 6915) --> . John moved to the
2025-01-22 16:44:44.169 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Sandra journeyed to the office.
2025-01-22 16:44:44.175 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (1271, 1277) --> . Sandra journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 16:44:47.978 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 16:44:47.978 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8181])
2025-01-22 16:44:51.114 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [320.375, 45.37433559384164, 215.4857142857143, 43.96531707467093, 14.409252565298507], 'topk_indices': array([  35,  111, 2094, 2093,   24, 1698,  112, 4376, 1505,   73, 2131,
         67, 2140, 8176,  105,   68,   74, 2141,   75,    0]), 'topk_tokens': ['.', '.', ' river', ' the', '\n\n', 'ot', ' PA', 'ot', 'ot', '.', ' du', 'ION', ' up', '<|eot_id|>', 'ION', 'E', ' PA', ' the', 'UL', '<|begin_of_text|>'], 'evidence_proportions': [746.3, 338.925, 140.97916666666666, 33.875]}, 'weight': {'score': [24.3, 23.2674292063783, 22.033035714285713, 23.27020351519252, 29.190065298507463], 'topk_indices': array([3298, 3325, 3213, 3165, 7390, 7428, 1480, 1418, 4317, 4301, 5186,
       5125, 7162, 7106, 3481, 3507, 4944, 4921, 4973, 4896]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.08125, 24.4546875, 23.9921875, 27.341796875]}, 'saliency': {'score': [1.855389404296875, 0.25809661477425466, 1.2449916294642858, 0.24991760366531093, 0.1059297020755597], 'topk_indices': array([  34, 1698, 4376,   72, 1505, 2051,   38, 2082, 8171, 3641,   31,
       2094,   68,   67,  112, 2140, 2131,  105,   74,   75]), 'topk_tokens': [' apple', 'ot', 'ot', ' ST', 'ot', ' laying', '***', 'irie', ' bedroom', ' bathroom', ' picked', ' river', 'E', 'ION', ' PA', ' up', ' du', 'ION', ' PA', 'UL'], 'evidence_proportions': [4.2126953125, 2.083203125, 0.7818806966145834, 0.2342529296875]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 0}
2025-01-22 16:44:51.121 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 16:44:51.121 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-10_pid-2_0-4-6-9.pkl | len: 3 |  size: 1.91 KB
Processing depth (0, 4, 6, 9):   3%|â–         | 3/100 [01:02<33:49, 20.92s/it]is_0k: False
your chose emoji: ['ğŸ§™ğŸ¼\u200dâ™€ï¸', 'ğŸ†š', 'ğŸª…', 'ğŸ§\u200dâ™‚', 'ğŸ‘ğŸ½', 'ğŸ‘°ğŸ¿', 'ğŸ‡¨ğŸ‡¾', 'ğŸ¤œğŸ¼', 'ğŸ¤£', 'ğŸ§‘ğŸ¾\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ§‘ğŸ½']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:05<00:15,  5.06s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.69s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.37s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.03s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.61s/it]
Processing depth (2, 3, 5, 6):   3%|â–         | 3/100 [01:18<33:49, 20.92s/it]2025-01-22 16:45:07.361 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 16:45:07.371 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2018, 2023) -->  cable. Mary picked up
2025-01-22 16:45:07.371 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary moved to the bathroom.
2025-01-22 16:45:07.386 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3057, 3062) --> . Mary moved to the
2025-01-22 16:45:07.386 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bedroom.
2025-01-22 16:45:07.412 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4248, 4254) --> . Mary journeyed to the
2025-01-22 16:45:07.412 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel dropped the football.
2025-01-22 16:45:07.438 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4772, 4776) -->  Daniel dropped the football
2025-01-22 16:45:07.438 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the apple.
2025-01-22 16:45:07.449 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2020, 2025) -->  Mary picked up the apple
2025-01-22 16:45:07.450 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the kitchen.
2025-01-22 16:45:07.454 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (809, 814) --> . Sandra moved to the
2025-01-22 16:45:07.454 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the office.
2025-01-22 16:45:07.463 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1714, 1720) --> . John went back to the
2025-01-22 16:45:07.463 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel took the football.
2025-01-22 16:45:07.497 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6293, 6297) -->  Daniel took the football
2025-01-22 16:45:07.497 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel left the apple.
2025-01-22 16:45:07.513 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3308, 3312) -->  Daniel left the apple
2025-01-22 16:45:07.513 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John moved to the garden.
2025-01-22 16:45:07.551 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (6921, 6926) --> . John moved to the
2025-01-22 16:45:07.551 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Sandra journeyed to the office.
2025-01-22 16:45:07.558 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (1265, 1271) --> . Sandra journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 16:45:08.356 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 16:45:08.357 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8203])
2025-01-22 16:45:10.600 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [182.5375, 19.757298394467462, 153.14419642857143, 18.785129892037787, 6.248860677083333], 'topk_indices': array([8190, 4255, 2024,    9, 8194, 8187, 8197,   23, 4254, 8184, 3308,
          1, 8193,   14, 8191,   24, 3062, 8201,    0, 8198]), 'topk_tokens': [' apple', '.', ' apple', ':', '?', ' Where', ':', '4', ' bedroom', '.\n\n', ' Daniel', '<|start_header_id|>', ' bedroom', '\n', ' before', '\n\n', ' bathroom', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [174.0125, 249.025, 195.73958333333334, 90.28125]}, 'weight': {'score': [23.02734375, 23.28945855166951, 22.693973214285716, 23.29265868451724, 29.51943108974359], 'topk_indices': array([3290, 3263, 3183, 3135, 7450, 7412, 1412, 1474, 4260, 4276, 5185,
       5124, 7189, 7133, 3451, 3477, 4972, 4895, 4920, 4943]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.5265625, 19.646875, 20.052083333333332, 27.341796875]}, 'saliency': {'score': [0.959149169921875, 0.10946188175239535, 0.9678667340959821, 0.10369106644195306, 0.04600603152544071], 'topk_indices': array([3311, 8200,  814, 8194,    8,   23,   20, 8172, 8184, 8196, 8185,
       8190,   24, 8187, 2024, 4254, 8191, 3308, 8193, 3062]), 'topk_tokens': [' apple', 'assistant', ' kitchen', '?', ' Date', '4', ' Jul', ' return', '.\n\n', 'Answer', 'Question', ' apple', '\n\n', ' Where', ' apple', ' bedroom', ' before', ' Daniel', ' bedroom', ' bathroom'], 'evidence_proportions': [1.08876953125, 1.19609375, 0.8744303385416666, 0.628021240234375]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 0}
2025-01-22 16:45:10.606 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 16:45:10.606 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-10_pid-3_2-3-5-6.pkl | len: 3 |  size: 2.01 KB
Processing depth (2, 3, 5, 6):   4%|â–         | 4/100 [01:21<32:34, 20.36s/it]is_0k: False
your chose emoji: ['ğŸ’‚ğŸ¿\u200dâ™€', 'ğŸ§‘ğŸ¿\u200dğŸ¦¯\u200dâ¡ï¸', 'ğŸ¦¹ğŸ¼\u200dâ™€', 'ğŸ·', 'ğŸ‘¨ğŸ¿\u200dğŸ”¬', 'ğŸš´ğŸ¼\u200dâ™€', 'ğŸ¥œ', '\U0001fada', 'ğŸ‘©ğŸ¿\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘¨ğŸ½', 'ğŸ•³']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:05<00:15,  5.33s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.33s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.58s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  2.92s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.68s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 2, 4, 9):   4%|â–         | 4/100 [01:38<32:34, 20.36s/it]2025-01-22 16:45:27.158 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 16:45:27.159 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the apple.
2025-01-22 16:45:27.159 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary moved to the bathroom.
2025-01-22 16:45:27.170 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2024, 2029) -->  cable. Mary moved to
2025-01-22 16:45:27.170 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bedroom.
2025-01-22 16:45:27.189 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3658, 3664) --> . Mary journeyed to the
2025-01-22 16:45:27.189 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel dropped the football.
2025-01-22 16:45:27.229 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7249, 7253) -->  Daniel dropped the football
2025-01-22 16:45:27.230 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the apple.
2025-01-22 16:45:27.230 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the apple.
2025-01-22 16:45:27.230 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the kitchen.
2025-01-22 16:45:27.234 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (815, 820) --> . Sandra moved to the
2025-01-22 16:45:27.234 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the office.
2025-01-22 16:45:27.243 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1720, 1726) --> . John went back to the
2025-01-22 16:45:27.243 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel took the football.
2025-01-22 16:45:27.277 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6314, 6318) -->  Daniel took the football
2025-01-22 16:45:27.277 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel left the apple.
2025-01-22 16:45:27.295 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3282, 3286) -->  Daniel left the apple
2025-01-22 16:45:27.295 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John moved to the garden.
2025-01-22 16:45:27.331 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (6932, 6937) --> . John moved to the
2025-01-22 16:45:27.331 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Sandra journeyed to the office.
2025-01-22 16:45:27.339 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (1271, 1277) --> . Sandra journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 16:45:31.266 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 16:45:31.266 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8193])
2025-01-22 16:45:34.537 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [213.3421875, 27.85597776354319, 181.49285714285713, 26.739773983540104, 16.09150256849315], 'topk_indices': array([   9, 8178, 8174,  508,  539, 7930,   35, 8121,  105, 8183,    1,
       2030, 8181,  185,   24, 8191,   14, 8189, 8188,    0]), 'topk_tokens': [':', ' was', '.\n\n', ',', ',', ' Square', '.', ' the', 'ION', ' bedroom', '<|start_header_id|>', ' bathroom', ' before', 'ION', '\n\n', '<|end_header_id|>', '\n', '<|start_header_id|>', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [407.25, 201.525, 175.10416666666666, 43.0859375]}, 'weight': {'score': [23.02265625, 23.281983970839434, 22.033035714285713, 23.287990572411253, 29.520333904109588], 'topk_indices': array([3323, 3296, 3191, 3143, 7464, 7426, 1418, 1480, 4308, 4324, 5186,
       5125, 7142, 7198, 3505, 3479, 4944, 4921, 4896, 4973]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.08125, 24.0734375, 20.052083333333332, 27.341796875]}, 'saliency': {'score': [1.14364013671875, 0.1559751034946544, 1.0539010184151785, 0.14968831959996085, 0.11650796132544948], 'topk_indices': array([ 165,    8,  816,   38, 8175, 8177,    0,   30, 8180,   31, 3282,
       3664,   34,  105,   24, 7930,  185, 8181, 8183, 2030]), 'topk_tokens': ['ION', ' Date', ' Sandra', '***', 'Question', ' Where', '<|begin_of_text|>', 'Mary', ' apple', ' picked', ' Daniel', ' bedroom', ' apple', 'ION', '\n\n', ' Square', 'ION', ' before', ' bedroom', ' bathroom'], 'evidence_proportions': [2.23994140625, 1.084619140625, 0.8520914713541666, 0.28436279296875]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 0}
2025-01-22 16:45:34.542 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 16:45:34.543 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-10_pid-4_0-2-4-9.pkl | len: 3 |  size: 2.02 KB
Processing depth (0, 2, 4, 9):   5%|â–Œ         | 5/100 [01:45<34:16, 21.65s/it]Processing depth (0, 2, 4, 9):   5%|â–Œ         | 5/100 [01:45<33:31, 21.17s/it]
2025-01-22 16:45:34.625 | INFO     | __main__:<module>:82 - Selected idx: 12
2025-01-22 16:45:34.625 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the apple before the bedroom? 
2025-01-22 16:45:34.625 | INFO     | __main__:<module>:84 - Answer: bathroom
2025-01-22 16:45:34.625 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 16:45:34.625 | INFO     | __main__:<module>:86 - Needle: [' John moved to the garden.', ' Sandra moved to the kitchen.', ' John went back to the office.', ' Daniel left the apple.', ' Mary picked up the apple.', ' Mary moved to the bathroom.', ' Sandra journeyed to the office.', ' Daniel picked up the apple.', ' Mary journeyed to the bedroom.', ' Daniel journeyed to the kitchen.']
2025-01-22 16:45:34.625 | INFO     | __main__:<module>:87 - Real Needle: [' Mary picked up the apple.', ' Mary moved to the bathroom.', ' Mary journeyed to the bedroom.', ' Daniel journeyed to the kitchen.']
2025-01-22 16:45:34.625 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ§ğŸ¼\u200dâ™€', 'ğŸƒ\u200dâ™€ï¸\u200dâ¡', 'ğŸ¤¸ğŸ½\u200dâ™‚ï¸', 'ğŸ“‹', 'ğŸ‘©\u200dğŸ‘§', 'ğŸ¤¹ğŸ¾\u200dâ™‚ï¸', 'ğŸª‘', 'ğŸ§‘ğŸ½\u200dğŸ”§', 'ğŸŒ™', 'ğŸ‘©ğŸ½\u200dğŸ¦¼']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:05<00:15,  5.31s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.87s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.70s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.35s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.91s/it]
Processing depth (3, 5, 6, 7):   0%|          | 0/100 [00:17<?, ?it/s]2025-01-22 16:45:52.070 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 16:45:52.085 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2926, 2931) --> . Mary picked up the
2025-01-22 16:45:52.085 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary moved to the bathroom.
2025-01-22 16:45:52.106 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4174, 4179) --> . Mary moved to the
2025-01-22 16:45:52.106 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bedroom.
2025-01-22 16:45:52.132 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4676, 4682) -->  Mary journeyed to the bedroom
2025-01-22 16:45:52.132 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the kitchen.
2025-01-22 16:45:52.167 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5638, 5644) --> . Daniel journeyed to the
2025-01-22 16:45:52.167 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John moved to the garden.
2025-01-22 16:45:52.176 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1848, 1853) --> . John moved to the
2025-01-22 16:45:52.176 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the kitchen.
2025-01-22 16:45:52.204 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5695, 5700) --> . Sandra moved to the
2025-01-22 16:45:52.204 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the office.
2025-01-22 16:45:52.241 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6725, 6731) --> . John went back to the
2025-01-22 16:45:52.241 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the apple.
2025-01-22 16:45:52.247 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1176, 1180) -->  Daniel left the apple
2025-01-22 16:45:52.247 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra journeyed to the office.
2025-01-22 16:45:52.269 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4390, 4396) --> . Sandra journeyed to the
2025-01-22 16:45:52.269 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel picked up the apple.
2025-01-22 16:45:52.284 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (2927, 2932) -->  Mary picked up the apple
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 16:45:53.094 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 16:45:53.094 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8248])
2025-01-22 16:45:55.337 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [160.03196022727272, 15.636109448854684, 115.69203629032258, 14.870258942729935, 16.224322150735293], 'topk_indices': array([1180, 8247, 4682, 8239, 4681,   23, 8244, 8230, 8231, 8242, 8238,
       8229, 8236,   24,    1,   14, 4179,    0, 8246, 8243]), 'topk_tokens': ['.', '\n\n', '.', '?', ' bedroom', '4', '<|start_header_id|>', 'Question', ':', ':', ' bedroom', '.\n\n', ' before', '\n\n', '<|start_header_id|>', '\n', ' bathroom', '<|begin_of_text|>', '<|end_header_id|>', '<|eot_id|>'], 'evidence_proportions': [182.875, 210.15, 222.30208333333334, 36.9609375]}, 'weight': {'score': [21.718394886363637, 23.327409177675435, 22.16078629032258, 23.336138578006832, 29.641850490196077], 'topk_indices': array([3375, 3348, 3242, 3194, 7465, 7503, 1546, 1484, 4402, 4418, 5281,
       5220, 7242, 7186, 3557, 3531, 5022, 5045, 5074, 4997]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.1, 19.646875, 24.57421875, 20.270833333333332]}, 'saliency': {'score': [0.9068104137073864, 0.08666089716398012, 0.7335411810105846, 0.08201383956905457, 0.1201025270948223], 'topk_indices': array([   8, 8146, 8245, 8217,   23, 2931,   20, 8239, 8232, 8235, 1176,
       1179,   24, 8229, 8241, 8230, 4681, 8236, 8238, 4179]), 'topk_tokens': [' Date', ' location', 'assistant', ' return', '4', ' apple', ' Jul', '?', ' Where', ' apple', ' Daniel', ' apple', '\n\n', '.\n\n', 'Answer', 'Question', ' bedroom', ' before', ' bedroom', ' bathroom'], 'evidence_proportions': [1.06552734375, 1.05068359375, 1.358642578125, 0.20281982421875]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 0}
2025-01-22 16:45:55.345 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 16:45:55.345 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-12_pid-0_3-5-6-7.pkl | len: 3 |  size: 2.01 KB
Processing depth (3, 5, 6, 7):   1%|          | 1/100 [00:20<34:02, 20.63s/it]is_0k: False
your chose emoji: ['ğŸ’†ğŸ¿\u200dâ™€', 'ğŸ§”ğŸ»', 'ğŸš£ğŸ»', 'ğŸ‹ğŸ¿\u200dâ™‚ï¸', 'ğŸƒğŸ¿\u200dâ™‚ï¸\u200dâ¡', 'ğŸ‘©ğŸ¿\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘©ğŸ¼', 'ğŸ§¼', 'ğŸ‡²ğŸ‡³', 'ğŸ‘¨ğŸ¿\u200dğŸ¤\u200dğŸ‘¨ğŸ¼', 'ğŸ‘©ğŸ¼\u200dâ¤\u200dğŸ‘¨ğŸ¿']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.73s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.62s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.43s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  2.89s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.50s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (2, 5, 6, 8):   1%|          | 1/100 [00:36<34:02, 20.63s/it]2025-01-22 16:46:11.678 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 16:46:11.687 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1792, 1797) --> . Mary picked up the
2025-01-22 16:46:11.687 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary moved to the bathroom.
2025-01-22 16:46:11.708 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4199, 4204) -->  Mary moved to the bathroom
2025-01-22 16:46:11.708 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bedroom.
2025-01-22 16:46:11.733 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4855, 4861) --> . Mary journeyed to the
2025-01-22 16:46:11.734 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the kitchen.
2025-01-22 16:46:11.768 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6636, 6642) --> . Daniel journeyed to the
2025-01-22 16:46:11.768 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John moved to the garden.
2025-01-22 16:46:11.777 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1870, 1875) --> . John moved to the
2025-01-22 16:46:11.777 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the kitchen.
2025-01-22 16:46:11.812 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6069, 6074) -->  Sandra moved to the kitchen
2025-01-22 16:46:11.812 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the office.
2025-01-22 16:46:11.847 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6714, 6720) -->  John went back to the office
2025-01-22 16:46:11.847 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the apple.
2025-01-22 16:46:11.857 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1240, 1244) -->  Daniel left the apple
2025-01-22 16:46:11.857 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra journeyed to the office.
2025-01-22 16:46:11.892 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4476, 4482) --> . Sandra journeyed to the
2025-01-22 16:46:11.892 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel picked up the apple.
2025-01-22 16:46:11.903 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (1793, 1798) -->  Mary picked up the apple
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 16:46:15.543 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 16:46:15.543 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8208])
2025-01-22 16:46:18.658 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [158.3018465909091, 17.95968251431007, 130.81854838709677, 17.152358114734003, 15.584877572408537], 'topk_indices': array([   4, 8191, 8124,    9,   23, 1243, 8196, 8202, 8096,    1, 8061,
       8189,   24, 8204,   14, 8062, 4203, 8206,    0, 8203]), 'topk_tokens': ['\n\n', ':', ' a', ':', '4', ' apple', ' before', ':', '.\n\n', '<|start_header_id|>', ' you', '.\n\n', '\n\n', '<|start_header_id|>', '\n', ' context', ' bathroom', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [170.7875, 360.55, 111.92708333333333, 25.731770833333332]}, 'weight': {'score': [21.778053977272727, 23.302743651808548, 23.580645161290324, 23.305799330411865, 29.94702743902439], 'topk_indices': array([3297, 3270, 3190, 3142, 7467, 7429, 1490, 1428, 4297, 4281, 5167,
       5106, 7150, 7206, 3479, 3453, 4908, 4883, 4960, 4931]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.1, 25.3359375, 20.052083333333332, 20.270833333333332]}, 'saliency': {'score': [0.9974309747869318, 0.10024349838440812, 0.8221573368195565, 0.0950807803809336, 0.11465398276724466], 'topk_indices': array([8205, 1794,   23, 8195,    8, 8096, 8106, 8189,   24, 8060, 8061,
       8201, 4861, 1240, 8196, 8190, 8198, 1243, 8062, 4203]), 'topk_tokens': ['assistant', ' picked', '4', ' apple', ' Date', '.\n\n', ' location', '.\n\n', '\n\n', ' provided', ' you', 'Answer', ' bedroom', ' Daniel', ' before', 'Question', ' bedroom', ' apple', ' context', ' bathroom'], 'evidence_proportions': [1.0396484375, 2.56767578125, 0.5207316080729166, 0.13041178385416666]}}, 'pred_res': 'The garden.<|eot_id|>', 'score': 0}
2025-01-22 16:46:18.662 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 16:46:18.662 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-12_pid-1_2-5-6-8.pkl | len: 3 |  size: 2.01 KB
Processing depth (2, 5, 6, 8):   2%|â–         | 2/100 [00:43<36:16, 22.21s/it]is_0k: False
your chose emoji: ['ğŸ‘®ğŸ¼\u200dâ™€ï¸', 'ğŸ§–ğŸ»\u200dâ™‚', 'ğŸ‡¦ğŸ‡¼', 'ğŸ‘©ğŸ½\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘©ğŸ¾', 'ğŸš¶ğŸ¾\u200dâ™€ï¸\u200dâ¡', 'ğŸ˜', 'âš¾', 'ğŸ§–ğŸ¼\u200dâ™‚ï¸', 'ğŸ¦¼', 'ğŸ‘©ğŸ¾\u200dğŸŒ¾']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.74s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.98s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.63s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.17s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.76s/it]
Processing depth (0, 1, 5, 7):   2%|â–         | 2/100 [01:01<36:16, 22.21s/it]2025-01-22 16:46:35.832 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 16:46:35.833 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the apple.
2025-01-22 16:46:35.834 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary moved to the bathroom.
2025-01-22 16:46:35.839 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (806, 811) -->  Mary moved to the bathroom
2025-01-22 16:46:35.839 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bedroom.
2025-01-22 16:46:35.861 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4172, 4178) --> . Mary journeyed to the
2025-01-22 16:46:35.861 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the kitchen.
2025-01-22 16:46:35.888 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4175, 4181) --> ed to the bedroom. Daniel
2025-01-22 16:46:35.888 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John moved to the garden.
2025-01-22 16:46:35.899 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1797, 1802) -->  John moved to the garden
2025-01-22 16:46:35.899 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the kitchen.
2025-01-22 16:46:35.934 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5697, 5702) --> . Sandra moved to the
2025-01-22 16:46:35.934 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the office.
2025-01-22 16:46:35.967 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6685, 6691) --> . John went back to the
2025-01-22 16:46:35.968 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the apple.
2025-01-22 16:46:35.974 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1276, 1280) -->  Daniel left the apple
2025-01-22 16:46:35.974 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra journeyed to the office.
2025-01-22 16:46:35.998 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4383, 4389) --> . Sandra journeyed to the
2025-01-22 16:46:35.999 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel picked up the apple.
2025-01-22 16:46:35.999 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (31, 36) -->  picked up the apple.
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 16:46:36.821 | INFO     | test_jbb_embedding:begin_test:693 - The bathroom.<|eot_id|>
2025-01-22 16:46:36.821 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8204])
2025-01-22 16:46:39.065 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [442.1988636363636, 47.28327570975996, 240.3578629032258, 45.48373497669855, 30.16435546875], 'topk_indices': array([6038, 5766, 6128, 5902, 8200,  810, 5910,   68, 5992, 6045, 5993,
       6122,  185,  105, 6046, 6123, 5994, 6129, 6130,    0]), 'topk_tokens': ['this', 'ot', ' on', ' time', '<|start_header_id|>', ' bathroom', '-day', 'E', '\n', ' true', 'the', ' by', 'ION', 'ION', ' to', ' the', ' way', '\n', 'the', '<|begin_of_text|>'], 'evidence_proportions': [605.85, 584.85, 262.4375, 366.7083333333333]}, 'weight': {'score': [21.930042613636363, 23.2966655751188, 22.14264112903226, 23.30474019652931, 29.795703125], 'topk_indices': array([3371, 3344, 3216, 3264, 7483, 7445, 1532, 1470, 4372, 4356, 5174,
       5235, 7222, 7166, 3553, 3527, 4976, 4999, 5028, 4951]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.08125, 25.3359375, 20.052083333333332, 20.84375]}, 'saliency': {'score': [2.5186212713068183, 0.26652722261674483, 1.4205794795866935, 0.25606343931563497, 0.21946754455566406], 'topk_indices': array([8194, 5987, 6120, 5168,   67,   68, 5902, 5766, 5765, 1276, 6121,
       6038, 5993,  185, 5910,  105, 6045,  810, 5994, 6130]), 'topk_tokens': [' bedroom', ' people', ' question', 'graph', 'ION', 'E', ' time', 'ot', 'nes', ' Daniel', ' asked', 'this', 'the', 'ION', '-day', 'ION', ' true', ' bathroom', ' way', 'the'], 'evidence_proportions': [3.2853515625, 4.060546875, 1.2483723958333333, 1.864990234375]}}, 'pred_res': 'The bathroom.<|eot_id|>', 'score': 100}
2025-01-22 16:46:39.082 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 16:46:39.082 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-12_pid-2_0-1-5-7.pkl | len: 3 |  size: 1.95 KB
Processing depth (0, 1, 5, 7):   3%|â–         | 3/100 [01:04<34:35, 21.39s/it]is_0k: False
your chose emoji: ['ğŸš¶ğŸ¼\u200dâ™€\u200dâ¡ï¸', 'ğŸ¦¦', 'ğŸ„\u200dğŸŸ«', 'ğŸ”«', 'ğŸ‡¦ğŸ‡º', 'â¬œ', 'ğŸŒğŸ¾\u200dâ™‚ï¸', 'ğŸ§‘ğŸ»\u200dâ¤\u200dğŸ’‹\u200dğŸ§‘ğŸ½', 'ğŸ‘®ğŸ¼\u200dâ™€ï¸', 'ğŸ¤½ğŸ»\u200dâ™€ï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.99s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.20s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.68s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.04s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.73s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (3, 6, 7, 9):   3%|â–         | 3/100 [01:21<34:35, 21.39s/it]2025-01-22 16:46:55.837 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 16:46:55.852 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2918, 2923) --> . Mary picked up the
2025-01-22 16:46:55.852 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary moved to the bathroom.
2025-01-22 16:46:55.877 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4841, 4846) --> . Mary moved to the
2025-01-22 16:46:55.877 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bedroom.
2025-01-22 16:46:55.906 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5635, 5641) --> . Mary journeyed to the
2025-01-22 16:46:55.906 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the kitchen.
2025-01-22 16:46:55.943 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7254, 7260) -->  cold. Daniel journeyed to
2025-01-22 16:46:55.943 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John moved to the garden.
2025-01-22 16:46:55.953 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1857, 1862) -->  John moved to the garden
2025-01-22 16:46:55.953 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the kitchen.
2025-01-22 16:46:55.986 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5732, 5737) --> . Sandra moved to the
2025-01-22 16:46:55.986 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the office.
2025-01-22 16:46:56.027 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6682, 6688) --> . John went back to the
2025-01-22 16:46:56.027 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the apple.
2025-01-22 16:46:56.034 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1268, 1272) -->  Daniel left the apple
2025-01-22 16:46:56.034 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra journeyed to the office.
2025-01-22 16:46:56.073 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4509, 4515) -->  Sandra journeyed to the office
2025-01-22 16:46:56.073 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel picked up the apple.
2025-01-22 16:46:56.095 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (2919, 2924) -->  Mary picked up the apple
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 16:46:59.717 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 16:46:59.717 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8162])
2025-01-22 16:47:02.654 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [130.392578125, 16.381058634415187, 162.36189516129033, 15.51399017273792, 24.906150688559322], 'topk_indices': array([1858, 8152, 8153, 1849,    9, 1268, 8150, 8161, 8016, 8156, 8143,
         23, 1271,    1,   24,   14, 4846,    0, 8160, 8157]), 'topk_tokens': [' moved', ' bedroom', '?', 'ï¿½', ':', ' Daniel', ' before', '\n\n', ' context', ':', '.\n\n', '4', ' apple', '<|start_header_id|>', '\n\n', '\n', ' bathroom', '<|begin_of_text|>', '<|end_header_id|>', '<|eot_id|>'], 'evidence_proportions': [193.9, 207.55, 127.64583333333333, 15.918619791666666]}, 'weight': {'score': [21.398792613636363, 23.266941595223514, 23.536290322580644, 23.270978758321007, 30.059851694915253], 'topk_indices': array([3258, 3285, 3130, 3178, 7421, 7383, 1474, 1412, 4277, 4261, 5164,
       5103, 7147, 7091, 3441, 3467, 4945, 4893, 4916, 4868]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.1, 19.646875, 20.052083333333332, 23.62109375]}, 'saliency': {'score': [0.6999657370827415, 0.0918938584803659, 1.0911766790574597, 0.08642599004260182, 0.19574336682335805], 'topk_indices': array([8144, 2919, 2920, 1856,   23, 8159, 8155,   20, 8150,   24, 5641,
       1858, 1861, 8016, 4509, 8152, 1268, 1849, 1271, 4846]), 'topk_tokens': ['Question', ' Mary', ' picked', 'â™€', '4', 'assistant', 'Answer', ' Jul', ' before', '\n\n', ' bedroom', ' moved', ' garden', ' context', ' Sandra', ' bedroom', ' Daniel', 'ï¿½', ' apple', ' bathroom'], 'evidence_proportions': [1.191650390625, 1.01982421875, 0.6302490234375, 0.09339650472005208]}}, 'pred_res': 'The garden.<|eot_id|>', 'score': 0}
2025-01-22 16:47:02.664 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 16:47:02.665 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-12_pid-3_3-6-7-9.pkl | len: 3 |  size: 2.01 KB
Processing depth (3, 6, 7, 9):   4%|â–         | 4/100 [01:27<35:36, 22.26s/it]is_0k: False
your chose emoji: ['ğŸ›»', 'ğŸ‘³ğŸ¾\u200dâ™€ï¸', 'ğŸµ', 'ğŸ—ºï¸', 'ğŸš´ğŸ»\u200dâ™€', 'ğŸ’†\u200dâ™€', 'ğŸ‘ğŸ½', 'â–ªï¸', 'ğŸ‡³ğŸ‡´', 'ğŸ§‘ğŸ½\u200dğŸ¦¼\u200dâ¡ï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.87s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.08s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.99s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  3.45s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  4.02s/it]
Processing depth (0, 3, 4, 6):   4%|â–         | 4/100 [01:45<35:36, 22.26s/it]2025-01-22 16:47:20.636 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 16:47:20.636 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the apple.
2025-01-22 16:47:20.636 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary moved to the bathroom.
2025-01-22 16:47:20.651 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2884, 2889) --> . Mary moved to the
2025-01-22 16:47:20.651 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bedroom.
2025-01-22 16:47:20.671 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3617, 3623) -->  Hon. Mary journeyed to
2025-01-22 16:47:20.671 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the kitchen.
2025-01-22 16:47:20.700 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4742, 4748) --> . Daniel journeyed to the
2025-01-22 16:47:20.700 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John moved to the garden.
2025-01-22 16:47:20.710 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1866, 1871) --> . John moved to the
2025-01-22 16:47:20.711 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the kitchen.
2025-01-22 16:47:20.741 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5753, 5758) --> . Sandra moved to the
2025-01-22 16:47:20.741 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the office.
2025-01-22 16:47:20.781 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6677, 6683) --> . John went back to the
2025-01-22 16:47:20.781 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the apple.
2025-01-22 16:47:20.788 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1242, 1246) -->  Daniel left the apple
2025-01-22 16:47:20.788 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra journeyed to the office.
2025-01-22 16:47:20.815 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4483, 4489) --> . Sandra journeyed to the
2025-01-22 16:47:20.816 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel picked up the apple.
2025-01-22 16:47:20.816 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (31, 36) -->  picked up the apple.
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 16:47:21.619 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 16:47:21.619 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8196])
2025-01-22 16:47:23.847 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [214.72301136363637, 25.49571975240883, 173.2701612903226, 24.422308494966856, 18.59461091694079], 'topk_indices': array([8192,    1, 8050,   39,   31, 8190, 8185,  185,   14,   29, 8186,
         38,   35, 1580,   24, 8194, 8191, 8184, 2889,    0]), 'topk_tokens': ['<|start_header_id|>', '<|start_header_id|>', ' context', '\n\n\n', ' picked', ':', ' the', 'ION', '\n', '\n\n', ' bedroom', '***', '.', ' part', '\n\n', '<|end_header_id|>', '<|eot_id|>', ' before', ' bathroom', '<|begin_of_text|>'], 'evidence_proportions': [471.35, 220.75, 169.75, 40.817708333333336]}, 'weight': {'score': [21.573508522727273, 23.279464340163436, 21.414566532258064, 23.291168595015957, 29.209909539473685], 'topk_indices': array([3307, 3280, 3152, 3200, 7473, 7435, 1492, 1430, 4288, 4304, 5147,
       5208, 7212, 7156, 3463, 3489, 4924, 4972, 5001, 4949]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.08125, 19.646875, 24.05859375, 20.270833333333332]}, 'saliency': {'score': [1.1478687633167615, 0.14364212730306286, 0.9795295961441532, 0.13774898987041187, 0.13787851835552015], 'topk_indices': array([8094,   37, 8180, 8189, 1672, 7933,   24,   30,   39,   34,  185,
       8050, 8183, 3624,   31, 1580,   38, 8186, 8184, 2889]), 'topk_tokens': [' location', 'UL', ' Where', 'Answer', 'nes', ' Square', '\n\n', 'Mary', '\n\n\n', ' apple', 'ION', ' context', ' apple', ' bedroom', ' picked', ' part', '***', ' bedroom', ' before', ' bathroom'], 'evidence_proportions': [2.59931640625, 1.087109375, 0.9211018880208334, 0.215728759765625]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 0}
2025-01-22 16:47:23.855 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 16:47:23.855 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-12_pid-4_0-3-4-6.pkl | len: 3 |  size: 2.02 KB
Processing depth (0, 3, 4, 6):   5%|â–Œ         | 5/100 [01:49<34:37, 21.87s/it]Processing depth (0, 3, 4, 6):   5%|â–Œ         | 5/100 [01:49<34:34, 21.84s/it]
2025-01-22 16:47:23.911 | INFO     | __main__:<module>:82 - Selected idx: 14
2025-01-22 16:47:23.911 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the apple before the bedroom? 
2025-01-22 16:47:23.911 | INFO     | __main__:<module>:84 - Answer: bathroom
2025-01-22 16:47:23.911 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 16:47:23.911 | INFO     | __main__:<module>:86 - Needle: [' Daniel picked up the apple.', ' Sandra moved to the kitchen.', ' Mary took the apple.', ' John moved to the garden.', ' Sandra journeyed to the office.', ' John went back to the office.', ' Mary moved to the bathroom.', ' Daniel took the football.', ' Mary journeyed to the bedroom.', ' Daniel left the apple.']
2025-01-22 16:47:23.911 | INFO     | __main__:<module>:87 - Real Needle: [' Mary took the apple.', ' Mary moved to the bathroom.', ' Mary journeyed to the bedroom.', ' Daniel left the apple.']
2025-01-22 16:47:23.911 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ§‘ğŸ»\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ§‘ğŸ½', 'ğŸ‘ˆğŸ»', 'ğŸ‘©\u200dğŸ¦°', 'ğŸ‘©ğŸ¼\u200dâš•', 'ğŸ§—', 'ğŸ‘¨\u200dâš•ï¸', 'ğŸ’µ', 'ğŸ§‹', 'ğŸ’†ğŸ¾\u200dâ™‚', 'ğŸ§‘ğŸ¿\u200dğŸ”¬']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.38s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.69s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.75s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.07s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.65s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 2, 6, 9):   0%|          | 0/100 [00:16<?, ?it/s]2025-01-22 16:47:40.537 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary took the apple.
2025-01-22 16:47:40.583 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary moved to the bathroom.
2025-01-22 16:47:40.592 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1802, 1807) --> . Mary moved to the
2025-01-22 16:47:40.592 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bedroom.
2025-01-22 16:47:40.616 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4722, 4728) --> . Mary journeyed to the
2025-01-22 16:47:40.617 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the apple.
2025-01-22 16:47:40.654 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7104, 7108) -->  left the apple.
2025-01-22 16:47:40.655 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the apple.
2025-01-22 16:47:40.666 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1886, 1891) --> . Daniel picked up the
2025-01-22 16:47:40.666 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the kitchen.
2025-01-22 16:47:40.683 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2892, 2897) --> . Sandra moved to the
2025-01-22 16:47:40.683 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the garden.
2025-01-22 16:47:40.692 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1805, 1810) -->  to the bathroom. John
2025-01-22 16:47:40.692 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra journeyed to the office.
2025-01-22 16:47:40.699 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1271, 1277) --> . Sandra journeyed to the
2025-01-22 16:47:40.699 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went back to the office.
2025-01-22 16:47:40.704 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (964, 970) --> . John went back to the
2025-01-22 16:47:40.704 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel took the football.
2025-01-22 16:47:40.731 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (5558, 5562) -->  Daniel took the football
2025-01-22 16:47:40.731 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 16:47:40.731 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 16:47:40.731 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 16:47:40.731 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ™ğŸ¼', 'ğŸ’‚ğŸ»', 'ğŸ„', 'ğŸ…¿ï¸', 'ğŸ§¨', 'ğŸ—', 'ğŸ§”\u200dâ™‚', 'ğŸ¤¶ğŸ»', 'ğŸ‘©ğŸ»\u200dğŸ¦²', 'ğŸ§ğŸ»\u200dâ¡']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:05<00:15,  5.03s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.63s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.30s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.03s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.59s/it]
Processing depth (1, 2, 4, 8):   0%|          | 0/100 [00:32<?, ?it/s]2025-01-22 16:47:57.077 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary took the apple.
2025-01-22 16:47:57.081 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (822, 826) -->  Mary took the apple
2025-01-22 16:47:57.081 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary moved to the bathroom.
2025-01-22 16:47:57.091 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1866, 1871) --> . Mary moved to the
2025-01-22 16:47:57.092 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bedroom.
2025-01-22 16:47:57.112 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3648, 3654) --> . Mary journeyed to the
2025-01-22 16:47:57.112 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the apple.
2025-01-22 16:47:57.146 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6645, 6649) -->  Daniel left the apple
2025-01-22 16:47:57.146 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the apple.
2025-01-22 16:47:57.158 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2041, 2046) -->  cable. Daniel picked up
2025-01-22 16:47:57.158 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the kitchen.
2025-01-22 16:47:57.176 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2890, 2895) --> . Sandra moved to the
2025-01-22 16:47:57.176 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the garden.
2025-01-22 16:47:57.185 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1869, 1874) -->  to the bathroom. John
2025-01-22 16:47:57.185 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra journeyed to the office.
2025-01-22 16:47:57.192 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1238, 1244) -->  Republican. Sandra journeyed to
2025-01-22 16:47:57.192 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went back to the office.
2025-01-22 16:47:57.196 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (912, 918) --> . John went back to the
2025-01-22 16:47:57.196 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel took the football.
2025-01-22 16:47:57.224 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (5732, 5736) -->  Daniel took the football
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 16:47:58.075 | INFO     | test_jbb_embedding:begin_test:693 - Mary took the apple.<|eot_id|>
2025-01-22 16:47:58.075 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8205])
2025-01-22 16:48:00.316 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [372.76973684210526, 41.78967927631579, 242.23185483870967, 40.25715555283158, 15.618807164634147], 'topk_indices': array([2762, 6064,   24, 1871, 5930, 6071, 5934, 5935, 3990, 6065, 5936,
       8203, 2765, 8200, 6066, 6072, 5937, 6073,    0, 2766]), 'topk_tokens': ['\n', ' asked', '\n\n', ' bathroom', ' people', ' on', ' on', '\n', ' papers', ' by', 'the', '<|end_header_id|>', 'urous', '<|eot_id|>', ' the', '\n', ' way', 'the', '<|begin_of_text|>', ' kids'], 'evidence_proportions': [393.375, 321.975, 448.2916666666667, 302.375]}, 'weight': {'score': [22.61266447368421, 23.290636802509745, 23.232610887096776, 23.29243629719294, 29.322408536585368], 'topk_indices': array([3313, 3286, 3158, 3206, 7420, 7458, 1492, 1430, 4300, 4284, 5095,
       5156, 7141, 7197, 3495, 3469, 4920, 4949, 4897, 4872]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.240234375, 19.646875, 20.052083333333332, 26.533203125]}, 'saliency': {'score': [2.0802066200657894, 0.23198701438383285, 1.4626582976310485, 0.22300601630971897, 0.11317341502119856], 'topk_indices': array([ 825, 6066, 5934, 6070, 6071, 8103, 8195, 6065, 6063, 3989, 2764,
       6064, 5930, 5936, 1871, 3990, 5937, 2765, 6073, 2766]), 'topk_tokens': [' apple', ' the', ' on', ' meet', ' on', ' location', ' bedroom', ' by', ' question', ' morning', 'vent', ' asked', ' people', 'the', ' bathroom', ' papers', ' way', 'urous', 'the', ' kids'], 'evidence_proportions': [2.741943359375, 1.548046875, 2.1194661458333335, 2.0247802734375]}}, 'pred_res': 'Mary took the apple.<|eot_id|>', 'score': 0}
2025-01-22 16:48:00.331 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 16:48:00.331 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-14_pid-0_1-2-4-8.pkl | len: 3 |  size: 1.99 KB
Processing depth (1, 2, 4, 8):   1%|          | 1/100 [00:36<59:54, 36.31s/it]is_0k: False
your chose emoji: ['ğŸ§—ğŸ»', 'ğŸ‡', 'ğŸ‘¨ğŸ¾\u200dâ¤ï¸\u200dğŸ‘¨ğŸ»', 'ğŸ§‘ğŸ¼\u200dğŸ¼', 'ğŸ§‘ğŸ¿\u200dâ¤\u200dğŸ§‘ğŸ½', '\U0001faf3ğŸ¿', 'ğŸ‘©ğŸ¼\u200dâ¤\u200dğŸ‘©ğŸ¾', 'ğŸ¥', 'ğŸš³', 'ğŸ¤˜ğŸ¿']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.98s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.76s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.55s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  2.94s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.59s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (1, 2, 3, 7):   1%|          | 1/100 [00:52<59:54, 36.31s/it]2025-01-22 16:48:16.848 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary took the apple.
2025-01-22 16:48:16.852 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (896, 900) -->  Mary took the apple
2025-01-22 16:48:16.852 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary moved to the bathroom.
2025-01-22 16:48:16.862 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1872, 1877) --> . Mary moved to the
2025-01-22 16:48:16.862 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bedroom.
2025-01-22 16:48:16.879 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2920, 2926) --> . Mary journeyed to the
2025-01-22 16:48:16.880 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the apple.
2025-01-22 16:48:16.909 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5677, 5681) -->  Daniel left the apple
2025-01-22 16:48:16.910 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the apple.
2025-01-22 16:48:16.920 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2047, 2052) -->  cable. Daniel picked up
2025-01-22 16:48:16.920 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the kitchen.
2025-01-22 16:48:16.935 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2852, 2857) --> . Sandra moved to the
2025-01-22 16:48:16.935 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the garden.
2025-01-22 16:48:16.945 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1875, 1880) -->  to the bathroom. John
2025-01-22 16:48:16.945 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra journeyed to the office.
2025-01-22 16:48:16.953 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1244, 1250) -->  Republican. Sandra journeyed to
2025-01-22 16:48:16.953 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went back to the office.
2025-01-22 16:48:16.959 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (964, 970) --> . John went back to the
2025-01-22 16:48:16.959 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel took the football.
2025-01-22 16:48:16.988 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (5624, 5628) -->  Daniel took the football
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 16:48:20.659 | INFO     | test_jbb_embedding:begin_test:693 - Mary took the apple.<|eot_id|>
2025-01-22 16:48:20.659 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8173])
2025-01-22 16:48:23.480 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [286.6282894736842, 23.5865834454501, 183.8326612903226, 22.36022104971696, 22.900331439393938], 'topk_indices': array([  23, 8154, 8156, 8166, 8163,    9, 8061,    1,   14,  900,   24,
       8161, 8167, 8071,  899, 8169, 8171, 1877, 8168,    0]), 'topk_tokens': ['4', '.\n\n', ':', 'Answer', ' bedroom', ':', '.\n\n', '<|start_header_id|>', '\n', '.', '\n\n', ' before', ':', ' location', ' apple', '<|start_header_id|>', '<|end_header_id|>', ' bathroom', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [549.6875, 348.275, 136.17708333333334, 172.1875]}, 'weight': {'score': [22.61266447368421, 23.268172471257337, 23.232610887096776, 23.269840827282795, 29.393229166666668], 'topk_indices': array([3364, 3337, 3209, 3257, 7452, 7414, 1436, 1498, 4336, 4320, 5216,
       5155, 7129, 7185, 3524, 3550, 4957, 5009, 4980, 4932]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.240234375, 19.646875, 20.052083333333332, 26.533203125]}, 'saliency': {'score': [1.6868318256578947, 0.1316008147894753, 1.1615856539818548, 0.12403510974130107, 0.17678694291548294], 'topk_indices': array([8061,   20, 8067,  897, 8070, 8160, 1874, 2926, 2049, 7757, 8155,
       8027,   24,  896, 8166, 8163, 8161, 8071,  899, 1877]), 'topk_tokens': ['.\n\n', ' Jul', ' item', ' took', ' first', ' apple', ' moved', ' bedroom', ' Daniel', 'inen', 'Question', ' context', '\n\n', ' Mary', 'Answer', ' bedroom', ' before', ' location', ' apple', ' bathroom'], 'evidence_proportions': [3.735107421875, 1.71416015625, 0.6627604166666666, 1.1405029296875]}}, 'pred_res': 'Mary took the apple.<|eot_id|>', 'score': 0}
2025-01-22 16:48:23.487 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 16:48:23.488 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-14_pid-1_1-2-3-7.pkl | len: 3 |  size: 2.03 KB
Processing depth (1, 2, 3, 7):   2%|â–         | 2/100 [00:59<46:40, 28.57s/it]is_0k: False
your chose emoji: ['ğŸ”¸', 'ğŸ•´ğŸ¾', 'â™', 'ğŸ‘¨ğŸ½\u200dâš–', 'ğŸš¶ğŸ¿\u200dâ™‚\u200dâ¡', 'â›ˆ', 'ğŸ§˜ğŸ¾\u200dâ™‚', 'ğŸ™ğŸ½\u200dâ™€ï¸', 'ğŸ‘¨ğŸ¼\u200dğŸŒ¾', 'ğŸ¼']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.38s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.86s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.76s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.31s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.83s/it]
Processing depth (1, 2, 3, 5):   2%|â–         | 2/100 [01:16<46:40, 28.57s/it]2025-01-22 16:48:40.709 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary took the apple.
2025-01-22 16:48:40.714 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (783, 787) -->  took the apple.
2025-01-22 16:48:40.714 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary moved to the bathroom.
2025-01-22 16:48:40.725 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1772, 1777) --> . Mary moved to the
2025-01-22 16:48:40.725 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bedroom.
2025-01-22 16:48:40.742 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2872, 2878) --> . Mary journeyed to the
2025-01-22 16:48:40.743 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the apple.
2025-01-22 16:48:40.767 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4102, 4106) -->  Daniel left the apple
2025-01-22 16:48:40.767 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the apple.
2025-01-22 16:48:40.779 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1846, 1851) --> . Daniel picked up the
2025-01-22 16:48:40.779 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the kitchen.
2025-01-22 16:48:40.795 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2752, 2757) --> . Sandra moved to the
2025-01-22 16:48:40.795 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the garden.
2025-01-22 16:48:40.804 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1775, 1780) -->  to the bathroom. John
2025-01-22 16:48:40.804 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra journeyed to the office.
2025-01-22 16:48:40.810 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1103, 1109) --> . Sandra journeyed to the
2025-01-22 16:48:40.810 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went back to the office.
2025-01-22 16:48:40.815 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (844, 850) --> . John went back to the
2025-01-22 16:48:40.815 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel took the football.
2025-01-22 16:48:40.844 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (5395, 5399) -->  Daniel took the football
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 16:48:41.648 | INFO     | test_jbb_embedding:begin_test:693 - The bathroom.<|eot_id|>
2025-01-22 16:48:41.648 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8171])
2025-01-22 16:48:43.876 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [195.41447368421052, 14.420369655309518, 116.10282258064517, 13.609064384847366, 21.1357421875], 'topk_indices': array([ 785, 1653,    1, 8158, 8154,   24, 8160, 8152, 8156, 8155,   14,
       2879, 8162, 1777, 8161, 8169, 8159,    0, 8167, 8166]), 'topk_tokens': [' apple', ' time', '<|start_header_id|>', ' apple', ':', '\n\n', ' the', '.\n\n', ' was', ' Where', '\n', '.', '?', ' bathroom', ' bedroom', '<|end_header_id|>', ' before', '<|begin_of_text|>', '<|start_header_id|>', '<|eot_id|>'], 'evidence_proportions': [307.5625, 186.525, 193.82291666666666, 96.765625]}, 'weight': {'score': [21.39514802631579, 23.267358774773673, 21.737147177419356, 23.277576470950272, 29.436298076923077], 'topk_indices': array([3349, 3376, 3215, 3263, 7418, 7456, 1470, 1532, 4351, 4367, 5249,
       5188, 7195, 7139, 3558, 3532, 4990, 5042, 5013, 4965]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.45703125, 19.646875, 20.052083333333332, 26.533203125]}, 'saliency': {'score': [0.9810341282894737, 0.07881583822132295, 0.7156332692792339, 0.07427577324420698, 0.16049816425030047], 'topk_indices': array([1731,   23, 1652,   24, 8069, 8164, 8152,   20, 1653, 8025, 8156,
       8153, 8162,  785, 8158, 2878, 8155, 8159, 1777, 8161]), 'topk_tokens': [' some', '4', ' some', '\n\n', ' location', 'Answer', '.\n\n', ' Jul', ' time', ' context', ' was', 'Question', '?', ' apple', ' apple', ' bedroom', ' Where', ' before', ' bathroom', ' bedroom'], 'evidence_proportions': [1.648681640625, 0.912158203125, 0.8284505208333334, 0.62835693359375]}}, 'pred_res': 'The bathroom.<|eot_id|>', 'score': 100}
2025-01-22 16:48:43.899 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 16:48:43.900 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-14_pid-2_1-2-3-5.pkl | len: 3 |  size: 2.02 KB
Processing depth (1, 2, 3, 5):   3%|â–         | 3/100 [01:19<40:10, 24.85s/it]is_0k: False
your chose emoji: ['ğŸ§ğŸ¾\u200dâ™‚ï¸\u200dâ¡', 'ğŸ™ğŸ»', 'ğŸ‡¨ğŸ‡±', 'ğŸ‘¨\u200dğŸ¦½\u200dâ¡ï¸', 'ğŸœ', 'ğŸ˜Œ', 'ğŸ™…ğŸ½\u200dâ™‚', 'ğŸ‡¸ğŸ‡±', 'ğŸ–¨', 'ğŸ––ğŸ»']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.47s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.74s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.45s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.05s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.60s/it]
Processing depth (2, 5, 7, 8):   3%|â–         | 3/100 [01:36<40:10, 24.85s/it]2025-01-22 16:49:00.181 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary took the apple.
2025-01-22 16:49:00.191 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1750, 1754) -->  Mary took the apple
2025-01-22 16:49:00.191 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary moved to the bathroom.
2025-01-22 16:49:00.213 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4211, 4216) -->  Mary moved to the bathroom
2025-01-22 16:49:00.214 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bedroom.
2025-01-22 16:49:00.244 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5644, 5650) -->  Mary journeyed to the bedroom
2025-01-22 16:49:00.244 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the apple.
2025-01-22 16:49:00.276 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6605, 6609) -->  Daniel left the apple
2025-01-22 16:49:00.276 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the apple.
2025-01-22 16:49:00.286 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1822, 1827) --> . Daniel picked up the
2025-01-22 16:49:00.286 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the kitchen.
2025-01-22 16:49:00.301 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2730, 2735) --> . Sandra moved to the
2025-01-22 16:49:00.301 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the garden.
2025-01-22 16:49:00.315 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1753, 1758) -->  apple. John moved to
2025-01-22 16:49:00.315 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra journeyed to the office.
2025-01-22 16:49:00.321 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1119, 1125) -->  Sandra journeyed to the office
2025-01-22 16:49:00.321 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went back to the office.
2025-01-22 16:49:00.326 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (901, 907) --> . John went back to the
2025-01-22 16:49:00.326 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel took the football.
2025-01-22 16:49:00.354 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (5619, 5623) -->  Daniel took the football
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 16:49:01.146 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 16:49:01.146 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8175])
2025-01-22 16:49:03.360 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [278.4375, 19.61483744497432, 161.21370967741936, 18.46975924274114, 27.910214552238806], 'topk_indices': array([5649, 8160, 8166, 8162, 5650, 8156, 8063,    4, 8171, 8165,    9,
       8163, 4215,    1,   23,   14,   24,    0, 8170, 8173]), 'topk_tokens': [' bedroom', ' was', '?', ' apple', '.', '.\n\n', '.\n\n', '\n\n', '<|start_header_id|>', ' bedroom', ':', ' before', ' bathroom', '<|start_header_id|>', '4', '\n', '\n\n', '<|begin_of_text|>', '<|eot_id|>', '<|end_header_id|>'], 'evidence_proportions': [244.125, 325.325, 221.05208333333334, 340.21875]}, 'weight': {'score': [25.53782894736842, 23.28664366287601, 22.834929435483872, 23.28310412309301, 30.425373134328357], 'topk_indices': array([3302, 3329, 3222, 3174, 7400, 7438, 1509, 1447, 4291, 4307, 5163,
       5102, 7151, 7095, 3485, 3511, 4904, 4956, 4879, 4927]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.240234375, 25.3359375, 24.57421875, 26.533203125]}, 'saliency': {'score': [1.8826583059210527, 0.11004528214512259, 0.9737666960685484, 0.10260741166242464, 0.21634662685109607], 'topk_indices': array([8172,   19,   22,   16, 6606, 8144, 8159, 6608, 8157,    8,   20,
       1753,   23, 6605, 8162, 5649,   24, 8163, 8165, 4215]), 'topk_tokens': ['assistant', '26', '202', ' Date', ' left', ' return', ' Where', ' apple', 'Question', ' Date', ' Jul', ' apple', '4', ' Daniel', ' apple', ' bedroom', '\n\n', ' before', ' bedroom', ' bathroom'], 'evidence_proportions': [1.667724609375, 2.27119140625, 1.3802083333333333, 2.3656005859375]}}, 'pred_res': 'The garden.<|eot_id|>', 'score': 0}
2025-01-22 16:49:03.369 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 16:49:03.369 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-14_pid-3_2-5-7-8.pkl | len: 3 |  size: 2.01 KB
Processing depth (2, 5, 7, 8):   4%|â–         | 4/100 [01:39<36:21, 22.72s/it]is_0k: False
your chose emoji: ['ğŸ¤·ğŸ¾\u200dâ™‚ï¸', 'ğŸ¤¹\u200dâ™€', 'â©', 'ğŸ§ğŸ»\u200dâ™‚ï¸\u200dâ¡', 'â™', 'ğŸŒ\u200dâ™€', 'ğŸ™†ğŸ½\u200dâ™€ï¸', 'ğŸ§”\u200dâ™‚ï¸', 'â›°ï¸', 'ğŸ‘¨ğŸ¿\u200dğŸ¦¯']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.93s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.89s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.66s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.16s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.76s/it]
Processing depth (1, 2, 5, 7):   4%|â–         | 4/100 [01:56<36:21, 22.72s/it]2025-01-22 16:49:21.031 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary took the apple.
2025-01-22 16:49:21.035 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (830, 834) -->  Mary took the apple
2025-01-22 16:49:21.036 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary moved to the bathroom.
2025-01-22 16:49:21.045 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1822, 1827) --> . Mary moved to the
2025-01-22 16:49:21.045 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bedroom.
2025-01-22 16:49:21.067 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4162, 4168) --> . Mary journeyed to the
2025-01-22 16:49:21.067 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the apple.
2025-01-22 16:49:21.095 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5633, 5637) -->  Daniel left the apple
2025-01-22 16:49:21.095 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the apple.
2025-01-22 16:49:21.105 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1906, 1911) --> . Daniel picked up the
2025-01-22 16:49:21.105 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the kitchen.
2025-01-22 16:49:21.119 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2754, 2759) --> . Sandra moved to the
2025-01-22 16:49:21.119 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the garden.
2025-01-22 16:49:21.129 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1825, 1830) -->  to the bathroom. John
2025-01-22 16:49:21.129 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra journeyed to the office.
2025-01-22 16:49:21.135 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1246, 1252) -->  Republican. Sandra journeyed to
2025-01-22 16:49:21.135 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went back to the office.
2025-01-22 16:49:21.140 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (920, 926) --> . John went back to the
2025-01-22 16:49:21.140 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel took the football.
2025-01-22 16:49:21.168 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (5506, 5510) -->  Daniel took the football
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 16:49:21.976 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 16:49:21.976 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8209])
2025-01-22 16:49:24.211 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [364.20394736842104, 24.142468719556746, 215.46774193548387, 22.624182568610635, 22.902157738095237], 'topk_indices': array([6162, 8097,  834,    9, 5636, 8190, 8199, 8196, 8203, 4168, 8197,
       8205,    1,   24,   14,  833, 1827, 8204, 8207,    0]), 'topk_tokens': ['the', '.\n\n', '.', ':', ' apple', '.\n\n', ' bedroom', ' apple', ':', ' bedroom', ' before', '<|start_header_id|>', '<|start_header_id|>', '\n\n', '\n', ' apple', ' bathroom', '<|eot_id|>', '<|end_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [500.625, 439.65, 221.64583333333334, 347.3125]}, 'weight': {'score': [22.61266447368421, 23.302988385898686, 22.518649193548388, 23.307574353712326, 29.779575892857142], 'topk_indices': array([3338, 3365, 3210, 3258, 7462, 7500, 1500, 1438, 4414, 4398, 5209,
       5270, 7239, 7183, 3521, 3547, 5011, 5034, 5063, 4986]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.240234375, 19.646875, 20.052083333333332, 26.533203125]}, 'saliency': {'score': [2.1664011101973686, 0.13408927341466756, 1.3310113722278225, 0.12481231801622611, 0.16935348510742188], 'topk_indices': array([6162, 8190, 8193,    8,  830, 8107,  831, 8202, 1823, 8191, 1824,
         24, 1248, 8197, 5636, 8196, 8199, 4168,  833, 1827]), 'topk_tokens': ['the', '.\n\n', ' Where', ' Date', ' Mary', ' location', ' took', 'Answer', ' Mary', 'Question', ' moved', '\n\n', ' Sandra', ' before', ' apple', ' apple', ' bedroom', ' bedroom', ' apple', ' bathroom'], 'evidence_proportions': [3.4970703125, 2.258984375, 1.056884765625, 2.38427734375]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 0}
2025-01-22 16:49:24.218 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 16:49:24.218 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-14_pid-4_1-2-5-7.pkl | len: 3 |  size: 2.03 KB
Processing depth (1, 2, 5, 7):   5%|â–Œ         | 5/100 [02:00<34:54, 22.05s/it]Processing depth (1, 2, 5, 7):   5%|â–Œ         | 5/100 [02:00<38:04, 24.05s/it]
2025-01-22 16:49:24.274 | INFO     | __main__:<module>:82 - Selected idx: 16
2025-01-22 16:49:24.274 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the apple before the garden? 
2025-01-22 16:49:24.274 | INFO     | __main__:<module>:84 - Answer: hallway
2025-01-22 16:49:24.274 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 16:49:24.274 | INFO     | __main__:<module>:86 - Needle: [' John went back to the office.', ' John journeyed to the bedroom.', ' Daniel grabbed the apple.', ' John moved to the garden.', ' Sandra journeyed to the office.', ' Sandra moved to the kitchen.', ' Sandra went back to the hallway.', ' Daniel travelled to the hallway.', ' Daniel went back to the garden.', ' Mary travelled to the bedroom.']
2025-01-22 16:49:24.274 | INFO     | __main__:<module>:87 - Real Needle: [' Daniel grabbed the apple.', ' Daniel travelled to the hallway.', ' Daniel went back to the garden.', ' Mary travelled to the bedroom.']
2025-01-22 16:49:24.274 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ†', 'ğŸ’‡ğŸ¿\u200dâ™‚ï¸', 'ğŸ‘¨ğŸ¾\u200dğŸ“', 'ğŸ§ğŸ¿\u200dâ™‚ï¸', 'ğŸ§\u200dâ™‚', 'ğŸ§‘ğŸ»\u200dğŸš€', 'ğŸ‹ğŸ¼\u200dâ™€ï¸', 'ğŸ‘©ğŸ¿', 'ğŸ‘©ğŸ¾\u200dâ¤\u200dğŸ’‹\u200dğŸ‘©ğŸ»', 'ğŸ”´']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.18s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.98s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:15<00:05,  5.21s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.36s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.93s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 2, 3, 7):   0%|          | 0/100 [00:17<?, ?it/s]2025-01-22 16:49:42.186 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel grabbed the apple.
2025-01-22 16:49:42.233 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel travelled to the hallway.
2025-01-22 16:49:42.243 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1807, 1812) --> . Daniel travelled to the
2025-01-22 16:49:42.243 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the garden.
2025-01-22 16:49:42.260 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2941, 2947) --> . Daniel went back to the
2025-01-22 16:49:42.260 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary travelled to the bedroom.
2025-01-22 16:49:42.295 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5800, 5805) --> . Mary travelled to the
2025-01-22 16:49:42.295 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the office.
2025-01-22 16:49:42.317 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4138, 4144) --> . John went back to the
2025-01-22 16:49:42.317 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bedroom.
2025-01-22 16:49:42.354 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6454, 6460) --> . John journeyed to the
2025-01-22 16:49:42.354 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the garden.
2025-01-22 16:49:42.375 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3500, 3505) --> . John moved to the
2025-01-22 16:49:42.375 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra journeyed to the office.
2025-01-22 16:49:42.400 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4595, 4601) --> . Sandra journeyed to the
2025-01-22 16:49:42.400 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra moved to the kitchen.
2025-01-22 16:49:42.434 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4600, 4605) -->  the office. Sandra moved
2025-01-22 16:49:42.434 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra went back to the hallway.
2025-01-22 16:49:42.441 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (1112, 1118) --> . Sandra went back to the
2025-01-22 16:49:42.441 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 16:49:42.441 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 16:49:42.441 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 16:49:42.441 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ§ğŸ¼\u200dâ™€ï¸', 'ğŸ±', 'ğŸ‡·ğŸ‡¸', 'ğŸ§–ğŸ»\u200dâ™‚ï¸', 'ğŸ©´', 'ğŸ›‹ï¸', 'ğŸ‘±', 'ğŸš´ğŸ¾\u200dâ™‚', 'ğŸ§—ğŸ¼', 'ğŸ‘µğŸ¿']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.57s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.55s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.30s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  2.97s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.51s/it]
Processing depth (1, 2, 4, 7):   0%|          | 0/100 [00:33<?, ?it/s]2025-01-22 16:49:58.228 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel grabbed the apple.
2025-01-22 16:49:58.232 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (826, 830) -->  Daniel grabbed the apple
2025-01-22 16:49:58.232 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel travelled to the hallway.
2025-01-22 16:49:58.241 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1621, 1626) --> . Daniel travelled to the
2025-01-22 16:49:58.241 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the garden.
2025-01-22 16:49:58.259 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3631, 3637) --> . Daniel went back to the
2025-01-22 16:49:58.259 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary travelled to the bedroom.
2025-01-22 16:49:58.287 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5698, 5703) --> . Mary travelled to the
2025-01-22 16:49:58.287 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the office.
2025-01-22 16:49:58.308 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4136, 4142) --> . John went back to the
2025-01-22 16:49:58.308 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bedroom.
2025-01-22 16:49:58.340 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6444, 6450) --> . John journeyed to the
2025-01-22 16:49:58.340 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the garden.
2025-01-22 16:49:58.357 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3353, 3358) --> . John moved to the
2025-01-22 16:49:58.357 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra journeyed to the office.
2025-01-22 16:49:58.380 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4568, 4574) -->  Sandra journeyed to the office
2025-01-22 16:49:58.380 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra moved to the kitchen.
2025-01-22 16:49:58.402 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4572, 4577) -->  the office. Sandra moved
2025-01-22 16:49:58.402 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra went back to the hallway.
2025-01-22 16:49:58.408 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (1090, 1096) --> . Sandra went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 16:49:59.269 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's house.<|eot_id|>
2025-01-22 16:49:59.269 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8243])
2025-01-22 16:50:01.524 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [292.1984375, 30.55359037715256, 112.72748161764706, 29.573755264282227, 18.576112689393938], 'topk_indices': array([8225, 1096, 8241,   14,  257, 8228,   24,  826, 8226,  830, 8141,
        827, 8230,  829, 8234, 8233, 8231, 8238,    0, 8239]), 'topk_tokens': ['Question', ' hallway', '<|end_header_id|>', '\n', 'hue', ' was', '\n\n', ' Daniel', ':', '.', ' location', ' grabbed', ' apple', ' apple', '?', ' garden', ' before', '<|eot_id|>', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [867.8125, 164.0, 222.91666666666666, 43.04375]}, 'weight': {'score': [22.388671875, 23.32639499454281, 21.499310661764707, 23.336267471313477, 29.718276515151516], 'topk_indices': array([3309, 3336, 3229, 3181, 7490, 7528, 1473, 1535, 4324, 4308, 5243,
       5182, 7211, 7267, 3524, 3498, 5036, 5007, 4984, 4959]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.333984375, 21.01875, 20.927083333333332, 20.75625]}, 'saliency': {'score': [1.9456939697265625, 0.170149346795037, 0.6111916934742647, 0.1639840230345726, 0.13811793471827652], 'topk_indices': array([1262, 8137, 8131, 8097, 8140,   24, 8228, 1222, 8227, 8234, 8225,
       8141,  257,  826, 1096, 8230,  827,  829, 8231, 8233]), 'topk_tokens': ['nes', ' item', '.\n\n', ' context', ' first', '\n\n', ' was', 'nes', ' Where', '?', 'Question', ' location', 'hue', ' Daniel', ' hallway', ' apple', ' grabbed', ' apple', ' before', ' garden'], 'evidence_proportions': [6.508544921875, 0.954296875, 1.1448567708333333, 0.24781494140625]}}, 'pred_res': "Daniel's house.<|eot_id|>", 'score': 0}
2025-01-22 16:50:01.531 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 16:50:01.532 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-16_pid-0_1-2-4-7.pkl | len: 3 |  size: 2.02 KB
Processing depth (1, 2, 4, 7):   1%|          | 1/100 [00:37<1:01:17, 37.15s/it]is_0k: False
your chose emoji: ['ğŸ˜º', 'ğŸ™ğŸ½\u200dâ™€', 'ğŸ‘©ğŸ½\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘¨ğŸ¼', 'ğŸ‘©ğŸ¾\u200dâ¤ï¸\u200dğŸ‘©ğŸ½', 'ğŸ’ğŸ¾\u200dâ™‚', 'ğŸ™‚', 'ğŸ‘¨ğŸ¾\u200dğŸ¤\u200dğŸ‘¨ğŸ»', 'ğŸ‡ºğŸ‡¾', 'ğŸ‘©ğŸ¿\u200dâ¤\u200dğŸ‘¨ğŸ¿', 'ğŸ‡¬ğŸ‡¾']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.97s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.29s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.63s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  2.99s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.70s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (1, 3, 6, 9):   1%|          | 1/100 [00:53<1:01:17, 37.15s/it]2025-01-22 16:50:18.397 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel grabbed the apple.
2025-01-22 16:50:18.402 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (896, 900) -->  Daniel grabbed the apple
2025-01-22 16:50:18.402 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel travelled to the hallway.
2025-01-22 16:50:18.418 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2992, 2997) -->  tragedy. Daniel travelled to
2025-01-22 16:50:18.419 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the garden.
2025-01-22 16:50:18.446 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4809, 4815) -->  the senate. Daniel went back
2025-01-22 16:50:18.446 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary travelled to the bedroom.
2025-01-22 16:50:18.486 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7316, 7321) -->  cold. Mary travelled to
2025-01-22 16:50:18.486 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the office.
2025-01-22 16:50:18.507 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4139, 4145) --> . John went back to the
2025-01-22 16:50:18.507 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bedroom.
2025-01-22 16:50:18.544 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6462, 6468) --> . John journeyed to the
2025-01-22 16:50:18.544 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the garden.
2025-01-22 16:50:18.562 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3479, 3484) --> . John moved to the
2025-01-22 16:50:18.563 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra journeyed to the office.
2025-01-22 16:50:18.586 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4577, 4583) -->  Sandra journeyed to the office
2025-01-22 16:50:18.586 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra moved to the kitchen.
2025-01-22 16:50:18.610 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4581, 4586) -->  the office. Sandra moved
2025-01-22 16:50:18.610 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra went back to the hallway.
2025-01-22 16:50:18.617 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (1132, 1138) --> . Sandra went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 16:50:22.127 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's hand.<|eot_id|>
2025-01-22 16:50:22.127 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8259])
2025-01-22 16:50:24.893 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [268.65078125, 31.882984598160252, 149.88143382352942, 30.81728001644737, 21.322411653037385], 'topk_indices': array([ 257, 8245, 8248,   14, 8147, 8241,  897,  896, 8243, 8157, 8244,
        900, 8242, 8246, 8250, 8249, 8247,    0, 8254, 8255]), 'topk_tokens': ['hue', ' the', ' the', '\n', '.\n\n', 'Question', ' grabbed', ' Daniel', ' Where', ' location', ' was', '.', ':', ' apple', '?', ' garden', ' before', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [910.9375, 199.29375, 85.89322916666667, 43.4875]}, 'weight': {'score': [26.027734375, 23.327429042604695, 21.499310661764707, 23.32842196637427, 29.2803738317757], 'topk_indices': array([3340, 3313, 3147, 3195, 7488, 7450, 1443, 1505, 4311, 4327, 5160,
       5221, 7209, 7153, 3528, 3502, 4937, 4985, 4962, 5014]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.333984375, 26.8265625, 24.8671875, 24.7765625]}, 'saliency': {'score': [1.9066131591796875, 0.17351882701865468, 0.7881667193244485, 0.16674983152869152, 0.1564121424594772], 'topk_indices': array([8113, 8252, 8240, 8156, 8242, 8147, 2998, 8244,  899, 1138,  257,
       8243, 8157, 8241, 8250,  896,  897, 8246, 8249, 8247]), 'topk_tokens': [' context', 'Answer', '.\n\n', ' first', ':', '.\n\n', ' hallway', ' was', ' apple', ' hallway', 'hue', ' Where', ' location', 'Question', '?', ' Daniel', ' grabbed', ' apple', ' garden', ' before'], 'evidence_proportions': [6.895263671875, 1.2359375, 0.5010986328125, 0.27298583984375]}}, 'pred_res': "Daniel's hand.<|eot_id|>", 'score': 0}
2025-01-22 16:50:24.899 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 16:50:24.899 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-16_pid-1_1-3-6-9.pkl | len: 3 |  size: 2.0 KB
Processing depth (1, 3, 6, 9):   2%|â–         | 2/100 [01:00<47:26, 29.04s/it]  is_0k: False
your chose emoji: ['ğŸ§‘ğŸ½\u200dâš•ï¸', 'ğŸ‡²ğŸ‡¨', 'ğŸª¨', 'ğŸ‘©ğŸ¼\u200dâ¤ï¸\u200dğŸ‘©ğŸ¾', 'ğŸ•µğŸ»\u200dâ™€ï¸', 'ğŸ§‘ğŸ½\u200dğŸ­', 'ğŸ‘®ğŸ»\u200dâ™‚', 'ğŸ§‘ğŸ»\u200dğŸ¤\u200dğŸ§‘ğŸ¼', 'ğŸ§ğŸ»\u200dâ™€ï¸', 'ğŸ‘©ğŸ½\u200dğŸ¤\u200dğŸ‘©ğŸ¿']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:05<00:16,  5.54s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.29s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.79s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.29s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.96s/it]
Processing depth (0, 1, 2, 5):   2%|â–         | 2/100 [01:18<47:26, 29.04s/it]2025-01-22 16:50:42.692 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel grabbed the apple.
2025-01-22 16:50:42.735 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel travelled to the hallway.
2025-01-22 16:50:42.738 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (670, 675) --> . Daniel travelled to the
2025-01-22 16:50:42.738 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the garden.
2025-01-22 16:50:42.747 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1639, 1645) --> . Daniel went back to the
2025-01-22 16:50:42.747 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary travelled to the bedroom.
2025-01-22 16:50:42.772 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4221, 4226) --> . Mary travelled to the
2025-01-22 16:50:42.772 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the office.
2025-01-22 16:50:42.796 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4140, 4146) --> . John went back to the
2025-01-22 16:50:42.796 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bedroom.
2025-01-22 16:50:42.832 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6480, 6486) --> . John journeyed to the
2025-01-22 16:50:42.832 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the garden.
2025-01-22 16:50:42.850 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3356, 3361) --> . John moved to the
2025-01-22 16:50:42.850 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra journeyed to the office.
2025-01-22 16:50:42.878 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4612, 4618) -->  Sandra journeyed to the office
2025-01-22 16:50:42.878 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra moved to the kitchen.
2025-01-22 16:50:42.902 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4616, 4621) -->  the office. Sandra moved
2025-01-22 16:50:42.902 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra went back to the hallway.
2025-01-22 16:50:42.907 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (985, 991) -->  Sandra went back to the hallway
2025-01-22 16:50:42.907 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 16:50:42.907 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 16:50:42.907 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 16:50:42.907 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸƒğŸ½\u200dâ™‚ï¸', 'ğŸ¤ğŸ»', 'ğŸ•µï¸', 'ğŸ§‘ğŸ¼\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ§‘ğŸ¿', 'ğŸ§ğŸ¿', '\U0001faf1ğŸ¼\u200d\U0001faf2ğŸ»', 'ğŸ§‘ğŸ¼\u200dâš•ï¸', 'ğŸ‘©ğŸ½\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘¨ğŸ½', 'ğŸ¤µğŸ¿', 'ğŸ‘©ğŸ½\u200dğŸš€']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.69s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.54s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.55s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.13s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.66s/it]
Processing depth (0, 3, 5, 8):   2%|â–         | 2/100 [01:34<47:26, 29.04s/it]2025-01-22 16:50:59.370 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel grabbed the apple.
2025-01-22 16:50:59.419 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel travelled to the hallway.
2025-01-22 16:50:59.437 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2841, 2846) --> . Daniel travelled to the
2025-01-22 16:50:59.438 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the garden.
2025-01-22 16:50:59.461 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4176, 4182) --> . Daniel went back to the
2025-01-22 16:50:59.461 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary travelled to the bedroom.
2025-01-22 16:50:59.497 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6535, 6540) --> . Mary travelled to the
2025-01-22 16:50:59.497 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the office.
2025-01-22 16:50:59.518 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4090, 4096) -->  John went back to the office
2025-01-22 16:50:59.518 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bedroom.
2025-01-22 16:50:59.552 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6296, 6302) --> . John journeyed to the
2025-01-22 16:50:59.552 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the garden.
2025-01-22 16:50:59.569 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3343, 3348) --> . John moved to the
2025-01-22 16:50:59.569 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra journeyed to the office.
2025-01-22 16:50:59.594 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4516, 4522) -->  execution. Sandra journeyed to
2025-01-22 16:50:59.594 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra moved to the kitchen.
2025-01-22 16:50:59.621 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4522, 4527) -->  the office. Sandra moved
2025-01-22 16:50:59.621 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra went back to the hallway.
2025-01-22 16:50:59.628 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (1110, 1116) --> . Sandra went back to the
2025-01-22 16:50:59.628 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 16:50:59.628 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 16:50:59.628 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 16:50:59.628 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ…±ï¸', 'ğŸ‘¨ğŸ¿\u200dğŸ¨', 'ğŸ¦¶ğŸ¿', 'ğŸ‡°ğŸ‡µ', 'ğŸ„\u200dâ™€', 'ğŸ‘©ğŸ¿\u200dâ¤\u200dğŸ‘¨ğŸ½', 'ğŸ‘©ğŸ¼\u200dğŸ¦¯\u200dâ¡', 'ğŸ‘¨ğŸ¾\u200dğŸ¦³', 'ğŸ“', 'ğŸ‘¨ğŸ½\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘¨ğŸ¿']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.80s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.68s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.59s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.15s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.70s/it]
Processing depth (4, 5, 6, 9):   2%|â–         | 2/100 [01:51<47:26, 29.04s/it]2025-01-22 16:51:16.307 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel grabbed the apple.
2025-01-22 16:51:16.326 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3575, 3579) -->  Daniel grabbed the apple
2025-01-22 16:51:16.326 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel travelled to the hallway.
2025-01-22 16:51:16.348 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4150, 4155) --> . Daniel travelled to the
2025-01-22 16:51:16.348 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the garden.
2025-01-22 16:51:16.374 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4653, 4659) --> . Daniel went back to the
2025-01-22 16:51:16.374 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary travelled to the bedroom.
2025-01-22 16:51:16.414 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7130, 7135) -->  Mary travelled to the bedroom
2025-01-22 16:51:16.415 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the office.
2025-01-22 16:51:16.438 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4063, 4069) --> . John went back to the
2025-01-22 16:51:16.438 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bedroom.
2025-01-22 16:51:16.472 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6268, 6274) --> . John journeyed to the
2025-01-22 16:51:16.472 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the garden.
2025-01-22 16:51:16.489 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3294, 3299) --> . John moved to the
2025-01-22 16:51:16.489 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra journeyed to the office.
2025-01-22 16:51:16.515 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4475, 4481) -->  execution. Sandra journeyed to
2025-01-22 16:51:16.515 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra moved to the kitchen.
2025-01-22 16:51:16.542 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4481, 4486) -->  the office. Sandra moved
2025-01-22 16:51:16.542 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra went back to the hallway.
2025-01-22 16:51:16.548 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (1069, 1075) --> . Sandra went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 16:51:17.383 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's hand.<|eot_id|>
2025-01-22 16:51:17.384 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8197])
2025-01-22 16:51:19.613 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [361.30546875, 32.55111280487805, 147.83823529411765, 31.262768920328995, 31.94556949013158], 'topk_indices': array([8186, 3576, 8195, 8085, 8178,   14, 8183, 8181, 3579, 8179, 8182,
       8180, 8187, 8188, 8184, 3578, 8185,    0, 8192, 8193]), 'topk_tokens': [' the', ' grabbed', '<|end_header_id|>', '.\n\n', '.\n\n', '\n', ' the', ' Where', '.', 'Question', ' was', ':', ' garden', '?', ' apple', ' apple', ' before', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [1010.0, 360.775, 192.83333333333334, 45.046875]}, 'weight': {'score': [23.7453125, 23.286135670731706, 21.564568014705884, 23.292193829793764, 29.480879934210527], 'topk_indices': array([3310, 3337, 3224, 3176, 7420, 7458, 1450, 1512, 4343, 4327, 5223,
       5162, 7141, 7197, 3519, 3493, 4987, 4964, 4939, 5016]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.333984375, 21.01875, 20.927083333333332, 26.1828125]}, 'saliency': {'score': [2.387957763671875, 0.17764987852515243, 0.7955824908088235, 0.16964400244847933, 0.24308294998972038], 'topk_indices': array([7566, 8189, 8085, 8180, 3530, 8178, 8190, 1075, 8051, 8182, 3575,
       8188, 8181, 3576, 4155, 8179, 8187, 8184, 3578, 8185]), 'topk_tokens': ['nes', ' \n', '.\n\n', ':', ' Ramsey', '.\n\n', 'Answer', ' hallway', ' context', ' was', ' Daniel', '?', ' Where', ' grabbed', ' hallway', 'Question', ' garden', ' apple', ' apple', ' before'], 'evidence_proportions': [7.49658203125, 2.08076171875, 0.9795735677083334, 0.2983154296875]}}, 'pred_res': "Daniel's hand.<|eot_id|>", 'score': 0}
2025-01-22 16:51:19.620 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 16:51:19.621 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-16_pid-2_4-5-6-9.pkl | len: 3 |  size: 2.0 KB
Processing depth (4, 5, 6, 9):   3%|â–         | 3/100 [01:55<1:05:54, 40.77s/it]is_0k: False
your chose emoji: ['ğŸ‘¨\u200dğŸš€', 'ğŸš”', 'ğŸ¢', 'ğŸ‘¨ğŸ½\u200dğŸš’', 'ğŸ‘¨ğŸ»\u200dâš•ï¸', 'â™', 'ğŸ‡®ğŸ‡©', 'ğŸ™‹\u200dâ™‚ï¸', 'ğŸ’ğŸ½\u200dâ™‚ï¸', 'ğŸ§‘ğŸ¾\u200dâ¤\u200dğŸ’‹\u200dğŸ§‘ğŸ½']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.17s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.56s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.67s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.29s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.75s/it]
Processing depth (2, 4, 8, 9):   3%|â–         | 3/100 [02:11<1:05:54, 40.77s/it]2025-01-22 16:51:36.295 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel grabbed the apple.
2025-01-22 16:51:36.306 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1793, 1797) -->  Daniel grabbed the apple
2025-01-22 16:51:36.306 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel travelled to the hallway.
2025-01-22 16:51:36.324 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3529, 3534) --> . Daniel travelled to the
2025-01-22 16:51:36.324 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the garden.
2025-01-22 16:51:36.357 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6476, 6482) --> . Daniel went back to the
2025-01-22 16:51:36.358 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary travelled to the bedroom.
2025-01-22 16:51:36.398 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7106, 7111) -->  Mary travelled to the bedroom
2025-01-22 16:51:36.398 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the office.
2025-01-22 16:51:36.418 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3932, 3938) -->  John went back to the office
2025-01-22 16:51:36.418 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bedroom.
2025-01-22 16:51:36.452 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6299, 6305) --> . John journeyed to the
2025-01-22 16:51:36.452 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the garden.
2025-01-22 16:51:36.468 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3279, 3284) --> . John moved to the
2025-01-22 16:51:36.468 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra journeyed to the office.
2025-01-22 16:51:36.503 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4398, 4404) --> . Sandra journeyed to the
2025-01-22 16:51:36.503 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra moved to the kitchen.
2025-01-22 16:51:36.525 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4403, 4408) -->  the office. Sandra moved
2025-01-22 16:51:36.525 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra went back to the hallway.
2025-01-22 16:51:36.531 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (1101, 1107) --> . Sandra went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 16:51:37.316 | INFO     | test_jbb_embedding:begin_test:693 - The hallway.<|eot_id|>
2025-01-22 16:51:37.316 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8155])
2025-01-22 16:51:39.523 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [130.6703125, 16.59914347879382, 89.06341911764706, 16.0136043928924, 15.726740056818182], 'topk_indices': array([8146, 8137, 8142, 1102,    9, 1796, 8149,    1, 8053, 1107, 8009,
       8138, 8043,   24, 8143, 8153,   14,    0, 8150, 8151]), 'topk_tokens': ['?', 'Question', ' apple', ' Sandra', ':', ' apple', ':', '<|start_header_id|>', ' location', ' hallway', ' context', ':', '.\n\n', '\n\n', ' before', '<|end_header_id|>', '\n', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [339.53125, 106.075, 100.83333333333333, 23.98125]}, 'weight': {'score': [23.7453125, 23.252826979651875, 21.499310661764707, 23.2589683721002, 29.375852272727272], 'topk_indices': array([3322, 3295, 3209, 3161, 7434, 7396, 1490, 1428, 4337, 4321, 5206,
       5145, 7117, 7173, 3520, 3494, 4999, 4970, 4922, 4947]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.333984375, 21.01875, 20.927083333333332, 26.1828125]}, 'saliency': {'score': [0.85081787109375, 0.09044416595481429, 0.5102700626148897, 0.08680626435199824, 0.11769062389026988], 'topk_indices': array([  20, 8146, 8124, 8139, 3534,   24,    8, 8043, 8145, 8148, 1793,
       1794, 8137, 8142, 8053, 8143, 8009, 1796, 1102, 1107]), 'topk_tokens': [' Jul', '?', ' return', ' Where', ' hallway', '\n\n', ' Date', '.\n\n', ' garden', 'Answer', ' Daniel', ' grabbed', 'Question', ' apple', ' location', ' before', ' context', ' apple', ' Sandra', ' hallway'], 'evidence_proportions': [2.5751953125, 0.57509765625, 0.5091959635416666, 0.156982421875]}}, 'pred_res': 'The hallway.<|eot_id|>', 'score': 100}
2025-01-22 16:51:39.543 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 16:51:39.544 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-16_pid-3_2-4-8-9.pkl | len: 3 |  size: 2.03 KB
Processing depth (2, 4, 8, 9):   4%|â–         | 4/100 [02:15<52:03, 32.54s/it]  is_0k: False
your chose emoji: ['ğŸ“”', 'ğŸ™ğŸ½\u200dâ™€', 'ğŸ—½', 'ğŸ§˜ğŸ¾\u200dâ™€', 'ğŸ‡·ğŸ‡¸', 'ğŸ§', 'ğŸ¢', 'ğŸ§—ğŸ¿\u200dâ™€ï¸', 'â™£ï¸', 'ğŸ¦¹ğŸ½\u200dâ™‚']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.32s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.50s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.56s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.18s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.66s/it]
Processing depth (0, 1, 4, 8):   4%|â–         | 4/100 [02:31<52:03, 32.54s/it]2025-01-22 16:51:55.961 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel grabbed the apple.
2025-01-22 16:51:56.011 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel travelled to the hallway.
2025-01-22 16:51:56.016 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (820, 825) --> . Daniel travelled to the
2025-01-22 16:51:56.016 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the garden.
2025-01-22 16:51:56.047 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3563, 3569) --> . Daniel went back to the
2025-01-22 16:51:56.048 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary travelled to the bedroom.
2025-01-22 16:51:56.096 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6633, 6638) --> . Mary travelled to the
2025-01-22 16:51:56.096 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the office.
2025-01-22 16:51:56.122 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4058, 4064) --> . John went back to the
2025-01-22 16:51:56.122 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bedroom.
2025-01-22 16:51:56.157 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6414, 6420) --> . John journeyed to the
2025-01-22 16:51:56.158 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the garden.
2025-01-22 16:51:56.177 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3283, 3288) --> . John moved to the
2025-01-22 16:51:56.177 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra journeyed to the office.
2025-01-22 16:51:56.201 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4505, 4511) --> . Sandra journeyed to the
2025-01-22 16:51:56.201 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra moved to the kitchen.
2025-01-22 16:51:56.228 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4510, 4515) -->  the office. Sandra moved
2025-01-22 16:51:56.228 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra went back to the hallway.
2025-01-22 16:51:56.235 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (1112, 1118) --> . Sandra went back to the
2025-01-22 16:51:56.235 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 16:51:56.235 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 16:51:56.235 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 16:51:56.235 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['\U0001fab8', 'ğŸ’¯', 'ğŸš¶ğŸ»\u200dâ¡', 'ğŸšµğŸ»\u200dâ™‚ï¸', 'ğŸ—‚ï¸', 'ğŸ§‘ğŸ½\u200dğŸ„', 'ğŸ§™ğŸ¿\u200dâ™‚', 'ğŸ‡ªğŸ‡¸', 'ğŸ¤¦ğŸ½\u200dâ™€', 'ğŸ¥±']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:05<00:15,  5.01s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.91s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.83s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.35s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.91s/it]
Processing depth (0, 1, 3, 9):   4%|â–         | 4/100 [02:49<52:03, 32.54s/it]2025-01-22 16:52:13.806 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel grabbed the apple.
2025-01-22 16:52:13.851 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel travelled to the hallway.
2025-01-22 16:52:13.855 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (684, 689) --> . Daniel travelled to the
2025-01-22 16:52:13.856 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the garden.
2025-01-22 16:52:13.881 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2777, 2783) --> . Daniel went back to the
2025-01-22 16:52:13.882 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary travelled to the bedroom.
2025-01-22 16:52:13.921 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7172, 7177) -->  Mary travelled to the bedroom
2025-01-22 16:52:13.921 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the office.
2025-01-22 16:52:13.944 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4124, 4130) --> . John went back to the
2025-01-22 16:52:13.944 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bedroom.
2025-01-22 16:52:13.980 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6460, 6466) --> . John journeyed to the
2025-01-22 16:52:13.980 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the garden.
2025-01-22 16:52:14.000 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3340, 3345) --> . John moved to the
2025-01-22 16:52:14.000 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra journeyed to the office.
2025-01-22 16:52:14.026 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4573, 4579) --> . Sandra journeyed to the
2025-01-22 16:52:14.026 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra moved to the kitchen.
2025-01-22 16:52:14.048 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4578, 4583) -->  the office. Sandra moved
2025-01-22 16:52:14.048 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra went back to the hallway.
2025-01-22 16:52:14.053 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (1024, 1030) --> . Sandra went back to the
2025-01-22 16:52:14.054 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 16:52:14.054 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 16:52:14.054 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 16:52:14.054 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸš£\u200dâ™‚', 'ğŸ¤£', 'ğŸ›°', 'ğŸ‘©ğŸ¾\u200dğŸ¦¼', 'ğŸ™ğŸ½\u200dâ™‚ï¸', 'ğŸ¤¦\u200dâ™‚', 'ğŸ‘°\u200dâ™‚ï¸', 'ğŸ‘©ğŸ¼\u200dâ¤\u200dğŸ’‹\u200dğŸ‘¨ğŸ¾', 'ğŸ‘¨ğŸ¾\u200dğŸ¤\u200dğŸ‘¨ğŸ¿', 'ğŸ¤·ğŸ¾']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.54s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.62s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.61s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.21s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.72s/it]
Processing depth (0, 3, 5, 9):   4%|â–         | 4/100 [03:06<52:03, 32.54s/it]2025-01-22 16:52:30.841 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel grabbed the apple.
2025-01-22 16:52:30.881 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel travelled to the hallway.
2025-01-22 16:52:30.895 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2809, 2814) --> . Daniel travelled to the
2025-01-22 16:52:30.895 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the garden.
2025-01-22 16:52:30.917 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4132, 4138) --> . Daniel went back to the
2025-01-22 16:52:30.917 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary travelled to the bedroom.
2025-01-22 16:52:30.952 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7136, 7141) -->  Mary travelled to the bedroom
2025-01-22 16:52:30.952 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the office.
2025-01-22 16:52:30.976 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4046, 4052) -->  John went back to the office
2025-01-22 16:52:30.976 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bedroom.
2025-01-22 16:52:31.007 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6330, 6336) --> . John journeyed to the
2025-01-22 16:52:31.007 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the garden.
2025-01-22 16:52:31.024 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3311, 3316) --> . John moved to the
2025-01-22 16:52:31.024 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra journeyed to the office.
2025-01-22 16:52:31.047 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4499, 4505) --> . Sandra journeyed to the
2025-01-22 16:52:31.047 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra moved to the kitchen.
2025-01-22 16:52:31.069 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4504, 4509) -->  the office. Sandra moved
2025-01-22 16:52:31.069 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra went back to the hallway.
2025-01-22 16:52:31.074 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (1106, 1112) --> . Sandra went back to the
2025-01-22 16:52:31.075 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 16:52:31.075 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 16:52:31.075 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 16:52:31.075 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸŒ°', 'ğŸ¤¼\u200dâ™‚', 'ğŸ•°', 'ğŸ™†ğŸ¿\u200dâ™€', 'ğŸ“‹', 'ğŸ¦‘', 'ğŸ‘©ğŸ¾\u200dâ¤ï¸\u200dğŸ‘¨ğŸ¾', 'ğŸ‘®ğŸ»\u200dâ™‚ï¸', 'ğŸ§–ğŸ¼\u200dâ™‚', 'ğŸ¦¸ğŸ»\u200dâ™€']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.09s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.64s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.78s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.37s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.82s/it]
Processing depth (1, 2, 7, 8):   4%|â–         | 4/100 [03:23<52:03, 32.54s/it]2025-01-22 16:52:48.179 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel grabbed the apple.
2025-01-22 16:52:48.184 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (780, 784) -->  Daniel grabbed the apple
2025-01-22 16:52:48.184 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel travelled to the hallway.
2025-01-22 16:52:48.193 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1803, 1808) --> . Daniel travelled to the
2025-01-22 16:52:48.193 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the garden.
2025-01-22 16:52:48.225 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5661, 5667) --> . Daniel went back to the
2025-01-22 16:52:48.226 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary travelled to the bedroom.
2025-01-22 16:52:48.260 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6637, 6642) --> . Mary travelled to the
2025-01-22 16:52:48.266 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the office.
2025-01-22 16:52:48.289 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4127, 4133) --> . John went back to the
2025-01-22 16:52:48.289 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bedroom.
2025-01-22 16:52:48.327 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6432, 6438) --> . John journeyed to the
2025-01-22 16:52:48.327 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the garden.
2025-01-22 16:52:48.346 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3455, 3460) --> . John moved to the
2025-01-22 16:52:48.346 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra journeyed to the office.
2025-01-22 16:52:48.373 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4565, 4571) -->  Sandra journeyed to the office
2025-01-22 16:52:48.373 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra moved to the kitchen.
2025-01-22 16:52:48.396 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4569, 4574) -->  the office. Sandra moved
2025-01-22 16:52:48.396 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra went back to the hallway.
2025-01-22 16:52:48.403 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (1072, 1078) --> . Sandra went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 16:52:49.236 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's hand.<|eot_id|>
2025-01-22 16:52:49.236 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8179])
2025-01-22 16:52:51.460 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [228.1578125, 26.667990711317525, 105.65992647058823, 25.841769961860237, 16.254897388059703], 'topk_indices': array([ 781, 8067, 1526,  783, 8160, 8165, 8168, 8163, 8161,  784, 8077,
       8164, 8162, 8166, 8169, 8170, 8167,    0, 8174, 8175]), 'topk_tokens': [' grabbed', '.\n\n', 'ot', ' apple', '.\n\n', ' the', ' the', ' Where', 'Question', '.', ' location', ' was', ':', ' apple', ' garden', '?', ' before', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [659.125, 153.825, 152.16666666666666, 48.90625]}, 'weight': {'score': [22.388671875, 23.2853710889758, 21.499310661764707, 23.295048751230315, 30.26632462686567], 'topk_indices': array([3316, 3289, 3161, 3209, 7466, 7428, 1439, 1501, 4333, 4317, 5202,
       5141, 7149, 7205, 3478, 3504, 4966, 4995, 4943, 4918]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.333984375, 21.01875, 20.927083333333332, 20.75625]}, 'saliency': {'score': [1.4950531005859375, 0.14474695429945306, 0.5754484288832721, 0.13962269580270362, 0.12459450337424208], 'topk_indices': array([8073, 8160, 1525, 8033, 8076,  285, 8162, 1526, 1078, 8164,  780,
        781,  783, 8077, 8163, 8161, 8170, 8166, 8169, 8167]), 'topk_tokens': [' item', '.\n\n', 'nes', ' context', ' first', 'hue', ':', 'ot', ' hallway', ' was', ' Daniel', ' grabbed', ' apple', ' location', ' Where', 'Question', '?', ' apple', ' garden', ' before'], 'evidence_proportions': [4.8515625, 0.85751953125, 0.7932332356770834, 0.28956298828125]}}, 'pred_res': "Daniel's hand.<|eot_id|>", 'score': 0}
2025-01-22 16:52:51.479 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 16:52:51.480 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-16_pid-4_1-2-7-8.pkl | len: 3 |  size: 2.0 KB
Processing depth (1, 2, 7, 8):   5%|â–Œ         | 5/100 [03:27<1:14:00, 46.75s/it]Processing depth (1, 2, 7, 8):   5%|â–Œ         | 5/100 [03:27<1:05:36, 41.44s/it]
2025-01-22 16:52:51.556 | INFO     | __main__:<module>:82 - Selected idx: 18
2025-01-22 16:52:51.556 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the apple before the bathroom? 
2025-01-22 16:52:51.556 | INFO     | __main__:<module>:84 - Answer: hallway
2025-01-22 16:52:51.556 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 16:52:51.556 | INFO     | __main__:<module>:86 - Needle: [' Sandra moved to the kitchen.', ' Sandra went back to the hallway.', ' Sandra journeyed to the office.', ' Daniel took the apple.', ' John moved to the garden.', ' John journeyed to the bedroom.', ' Daniel went to the hallway.', ' John went back to the office.', ' Daniel travelled to the bathroom.', ' Mary travelled to the bedroom.']
2025-01-22 16:52:51.556 | INFO     | __main__:<module>:87 - Real Needle: [' Daniel took the apple.', ' Daniel went to the hallway.', ' Daniel travelled to the bathroom.', ' Mary travelled to the bedroom.']
2025-01-22 16:52:51.556 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ™…ğŸ¼\u200dâ™€ï¸', '\U0001faf0ğŸ½', 'ğŸ•µğŸ¾\u200dâ™€ï¸', 'â˜˜', 'ğŸ¤·\u200dâ™€', 'ğŸ„ğŸ½\u200dâ™€ï¸', 'â˜ğŸ½', 'ğŸ‘°ğŸ½\u200dâ™€ï¸', 'ğŸš¶\u200dâ™€\u200dâ¡', 'â¤\u200dğŸ”¥']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.16s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.62s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.59s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.20s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.68s/it]
Processing depth (1, 2, 3, 6):   0%|          | 0/100 [00:16<?, ?it/s]2025-01-22 16:53:08.495 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel took the apple.
2025-01-22 16:53:08.500 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (828, 832) -->  Daniel took the apple
2025-01-22 16:53:08.500 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the hallway.
2025-01-22 16:53:08.509 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1805, 1810) --> . Daniel went to the
2025-01-22 16:53:08.509 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel travelled to the bathroom.
2025-01-22 16:53:08.524 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2901, 2906) --> . Daniel travelled to the
2025-01-22 16:53:08.524 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary travelled to the bedroom.
2025-01-22 16:53:08.551 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4780, 4785) -->  the senate. Mary travelled
2025-01-22 16:53:08.551 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the kitchen.
2025-01-22 16:53:08.573 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4050, 4055) --> . Sandra moved to the
2025-01-22 16:53:08.573 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the hallway.
2025-01-22 16:53:08.604 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5108, 5114) --> . Sandra went back to the
2025-01-22 16:53:08.604 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra journeyed to the office.
2025-01-22 16:53:08.623 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3625, 3631) --> . Sandra journeyed to the
2025-01-22 16:53:08.623 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John moved to the garden.
2025-01-22 16:53:08.647 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4936, 4941) --> . John moved to the
2025-01-22 16:53:08.647 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John journeyed to the bedroom.
2025-01-22 16:53:08.685 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6933, 6939) --> . John journeyed to the
2025-01-22 16:53:08.685 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John went back to the office.
2025-01-22 16:53:08.690 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (831, 837) -->  apple. John went back to
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 16:53:09.506 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's office.<|eot_id|>
2025-01-22 16:53:09.507 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8164])
2025-01-22 16:53:11.756 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [203.4140625, 18.668685716909515, 108.9466911764706, 17.857789199223564, 13.214778645833333], 'topk_indices': array([ 827, 8052,    4,    1, 8163,    9, 1810,  832, 2906,  828,  829,
         14,  831,   24, 8062, 8162,    3, 8159,    0, 8160]), 'topk_tokens': ['.', '.\n\n', '\n\n', '<|start_header_id|>', '\n\n', ':', ' hallway', '.', ' bathroom', ' Daniel', ' took', '\n', ' apple', '\n\n', ' location', '<|end_header_id|>', '<|end_header_id|>', '<|eot_id|>', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [573.875, 129.0125, 157.2, 27.6609375]}, 'weight': {'score': [23.006167763157894, 23.261190232031346, 21.070542279411764, 23.270966847424205, 29.42890625], 'topk_indices': array([3309, 3336, 3229, 3181, 7435, 7397, 1429, 1491, 4301, 4317, 5143,
       5204, 7118, 7174, 3518, 3492, 4932, 4990, 4961, 4907]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.568359375, 19.665625, 21.01875, 25.484375]}, 'saliency': {'score': [1.2693465383429277, 0.10254928609419003, 0.6033711152918199, 0.09771848870875185, 0.09927151997884115], 'topk_indices': array([8157,    8, 8163, 8148,   32, 8161, 8018,  275, 8061, 8152, 8146,
         24, 8151, 8154,  829, 8062,  828, 2906, 1810,  831]), 'topk_tokens': ['Answer', ' Date', '\n\n', ' Where', '***', 'assistant', ' context', 'hue', ' first', ' before', 'Question', '\n\n', ' apple', ' bathroom', ' took', ' location', ' Daniel', ' bathroom', ' hallway', ' apple'], 'evidence_proportions': [3.909423828125, 0.6732421875, 0.84296875, 0.179766845703125]}}, 'pred_res': "Daniel's office.<|eot_id|>", 'score': 0}
2025-01-22 16:53:11.761 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 16:53:11.761 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-18_pid-0_1-2-3-6.pkl | len: 3 |  size: 2.04 KB
Processing depth (1, 2, 3, 6):   1%|          | 1/100 [00:20<33:11, 20.11s/it]is_0k: False
your chose emoji: ['ğŸ§ğŸ½\u200dâ¡', 'ğŸ§”ğŸ»', 'ğŸ—', 'ğŸ‘¬ğŸ½', 'ğŸ™‡ğŸ¿\u200dâ™‚', 'ğŸšµğŸ¿\u200dâ™€ï¸', 'ğŸ¤¶ğŸ½', 'ğŸ‹ğŸ¾\u200dâ™€', 'ğŸ˜¹', 'â—']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.74s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.07s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.82s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.27s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.87s/it]
Processing depth (1, 2, 6, 9):   1%|          | 1/100 [00:37<33:11, 20.11s/it]2025-01-22 16:53:29.038 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel took the apple.
2025-01-22 16:53:29.043 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (778, 782) -->  Daniel took the apple
2025-01-22 16:53:29.043 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the hallway.
2025-01-22 16:53:29.055 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1801, 1806) --> . Daniel went to the
2025-01-22 16:53:29.055 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel travelled to the bathroom.
2025-01-22 16:53:29.081 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4642, 4647) --> . Daniel travelled to the
2025-01-22 16:53:29.081 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary travelled to the bedroom.
2025-01-22 16:53:29.120 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7224, 7229) --> . Mary travelled to the
2025-01-22 16:53:29.120 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the kitchen.
2025-01-22 16:53:29.143 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3982, 3987) -->  the ground. Sandra moved
2025-01-22 16:53:29.143 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the hallway.
2025-01-22 16:53:29.168 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4964, 4970) --> . Sandra went back to the
2025-01-22 16:53:29.168 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra journeyed to the office.
2025-01-22 16:53:29.187 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3617, 3623) --> . Sandra journeyed to the
2025-01-22 16:53:29.187 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John moved to the garden.
2025-01-22 16:53:29.213 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4802, 4807) -->  the senate. John moved
2025-01-22 16:53:29.213 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John journeyed to the bedroom.
2025-01-22 16:53:29.250 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6905, 6911) --> . John journeyed to the
2025-01-22 16:53:29.251 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John went back to the office.
2025-01-22 16:53:29.255 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (781, 787) -->  apple. John went back to
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 16:53:30.105 | INFO     | test_jbb_embedding:begin_test:693 - Daniel took the apple.<|eot_id|>
2025-01-22 16:53:30.105 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8170])
2025-01-22 16:53:32.323 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [200.78536184210526, 22.358642787226234, 118.75, 21.537532712438423, 30.779668898809526], 'topk_indices': array([ 779, 8169,  780, 8067,    1,  778, 8158, 8024, 8058,  782, 8168,
         14,   24, 8098,    3, 8068,  781, 8165,    0, 8166]), 'topk_tokens': [' took', '\n\n', ' the', ' first', '<|start_header_id|>', ' Daniel', ' before', ' context', '.\n\n', '.', '<|end_header_id|>', '\n', '\n\n', ' the', '<|end_header_id|>', ' location', ' apple', '<|eot_id|>', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [601.5, 104.3875, 140.3375, 37.059375]}, 'weight': {'score': [21.761924342105264, 23.266951777193196, 22.242417279411764, 23.274763315886698, 29.508928571428573], 'topk_indices': array([3328, 3301, 3173, 3221, 7407, 7445, 1499, 1437, 4323, 4339, 5226,
       5165, 7118, 7174, 3484, 3510, 4990, 5019, 4960, 4935]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.568359375, 19.665625, 21.01875, 20.75625]}, 'saliency': {'score': [1.259376927425987, 0.12387690234327206, 0.6902322208180147, 0.118848505630869, 0.22251383463541666], 'topk_indices': array([8163, 8167, 8023, 8154, 1806, 8096, 8152, 8058,   24,  779, 4647,
       8157, 8067, 8158,  257, 8160, 8024,  778, 8068,  781]), 'topk_tokens': ['Answer', 'assistant', ' you', ' Where', ' hallway', ' moved', 'Question', '.\n\n', '\n\n', ' took', ' bathroom', ' apple', ' first', ' before', 'hue', ' bathroom', ' context', ' Daniel', ' location', ' apple'], 'evidence_proportions': [4.07666015625, 0.547509765625, 0.76904296875, 0.20775146484375]}}, 'pred_res': 'Daniel took the apple.<|eot_id|>', 'score': 0}
2025-01-22 16:53:32.328 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 16:53:32.328 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-18_pid-1_1-2-6-9.pkl | len: 3 |  size: 2.06 KB
Processing depth (1, 2, 6, 9):   2%|â–         | 2/100 [00:40<33:17, 20.38s/it]is_0k: False
your chose emoji: ['ğŸ', '\U0001faf5', 'ğŸ§‘ğŸ¼\u200dâœˆï¸', '\U0001fa7c', 'ğŸ§”ğŸ¿', 'ğŸ§‘ğŸ¿\u200dğŸš’', 'Â®ï¸', 'ğŸ§˜ğŸ¾\u200dâ™€ï¸', 'ğŸ¤šğŸ¿', 'ğŸƒğŸ¼\u200dâ™€\u200dâ¡']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.64s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.80s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.73s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.28s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.81s/it]
Processing depth (3, 4, 5, 9):   2%|â–         | 2/100 [00:57<33:17, 20.38s/it]2025-01-22 16:53:49.438 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel took the apple.
2025-01-22 16:53:49.452 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2811, 2815) -->  Daniel took the apple
2025-01-22 16:53:49.452 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the hallway.
2025-01-22 16:53:49.474 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3543, 3548) --> . Daniel went to the
2025-01-22 16:53:49.474 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel travelled to the bathroom.
2025-01-22 16:53:49.499 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4146, 4151) --> . Daniel travelled to the
2025-01-22 16:53:49.499 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary travelled to the bedroom.
2025-01-22 16:53:49.545 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7226, 7231) --> . Mary travelled to the
2025-01-22 16:53:49.545 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the kitchen.
2025-01-22 16:53:49.568 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3922, 3927) --> . Sandra moved to the
2025-01-22 16:53:49.569 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the hallway.
2025-01-22 16:53:49.597 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3545, 3551) -->  went to the hallway. Sandra
2025-01-22 16:53:49.598 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra journeyed to the office.
2025-01-22 16:53:49.618 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3547, 3553) -->  the hallway. Sandra journeyed
2025-01-22 16:53:49.618 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John moved to the garden.
2025-01-22 16:53:49.648 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4884, 4889) --> . John moved to the
2025-01-22 16:53:49.648 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John journeyed to the bedroom.
2025-01-22 16:53:49.690 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6907, 6913) --> . John journeyed to the
2025-01-22 16:53:49.690 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John went back to the office.
2025-01-22 16:53:49.694 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (815, 821) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 16:53:50.477 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's hand<|eot_id|>
2025-01-22 16:53:50.477 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8156])
2025-01-22 16:53:52.708 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [291.4029605263158, 24.95910574212526, 201.94301470588235, 23.59223106340982, 29.255266462053573], 'topk_indices': array([8146, 2817,    1, 8143, 8139,   24, 8010,   14, 8054, 8150, 8144,
       2811, 2818, 2815, 3548, 8154, 2814,    0, 8151, 8152]), 'topk_tokens': [' bathroom', 'ï¿½', '<|start_header_id|>', ' apple', ':', '\n\n', ' context', '\n', ' location', ':', ' before', ' Daniel', 'ï¿½', '.', ' hallway', '<|end_header_id|>', ' apple', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [674.625, 364.9, 156.6125, 46.11875]}, 'weight': {'score': [21.761924342105264, 23.24490018691016, 21.59420955882353, 23.255299893597336, 28.682756696428573], 'topk_indices': array([3279, 3306, 3151, 3199, 7443, 7405, 1474, 1412, 4333, 4317, 5161,
       5222, 7176, 7120, 3462, 3488, 5008, 4936, 4911, 4979]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.568359375, 19.665625, 21.01875, 20.75625]}, 'saliency': {'score': [1.8294870476973684, 0.13905701214724536, 1.2960671817555147, 0.13024174981784326, 0.20939649854387557], 'topk_indices': array([  24, 8140, 2812, 8125, 2816, 2817, 3544, 3545, 8138, 8149, 8143,
       4151, 8010, 2818, 8054, 8144, 8146, 2811, 2814, 3548]), 'topk_tokens': ['\n\n', ' Where', ' took', ' return', 'ï¿½', 'ï¿½', ' Daniel', ' went', 'Question', 'Answer', ' apple', ' bathroom', ' context', 'ï¿½', ' location', ' before', ' bathroom', ' Daniel', ' apple', ' hallway'], 'evidence_proportions': [4.737548828125, 2.0265625, 0.8677734375, 0.26767578125]}}, 'pred_res': "Daniel's hand<|eot_id|>", 'score': 0}
2025-01-22 16:53:52.716 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 16:53:52.717 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-18_pid-2_3-4-5-9.pkl | len: 3 |  size: 2.04 KB
Processing depth (3, 4, 5, 9):   3%|â–         | 3/100 [01:01<32:57, 20.38s/it]is_0k: False
your chose emoji: ['ğŸ•µğŸ½\u200dâ™‚ï¸', 'ğŸ™‡ğŸ½', 'ğŸˆ‚', 'ğŸ‘©ğŸ¿\u200dğŸ¤\u200dğŸ‘©ğŸ¾', 'ğŸš¯', 'ğŸ‘ğŸ¼', 'ğŸ§¨', 'ğŸª™', 'ğŸ§°', 'ğŸ’¦']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.30s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.59s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.77s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.40s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.84s/it]
Processing depth (2, 4, 5, 8):   3%|â–         | 3/100 [01:18<32:57, 20.38s/it]2025-01-22 16:54:09.912 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel took the apple.
2025-01-22 16:54:09.923 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1849, 1853) -->  Daniel took the apple
2025-01-22 16:54:09.924 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the hallway.
2025-01-22 16:54:09.943 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3600, 3605) -->  Daniel went to the hallway
2025-01-22 16:54:09.943 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel travelled to the bathroom.
2025-01-22 16:54:09.966 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4157, 4162) -->  Daniel travelled to the bathroom
2025-01-22 16:54:09.966 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary travelled to the bedroom.
2025-01-22 16:54:09.999 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6649, 6654) --> . Mary travelled to the
2025-01-22 16:54:09.999 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the kitchen.
2025-01-22 16:54:10.023 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4030, 4035) --> . Sandra moved to the
2025-01-22 16:54:10.023 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the hallway.
2025-01-22 16:54:10.044 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3601, 3607) -->  went to the hallway. Sandra
2025-01-22 16:54:10.044 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra journeyed to the office.
2025-01-22 16:54:10.067 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3603, 3609) -->  the hallway. Sandra journeyed
2025-01-22 16:54:10.067 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John moved to the garden.
2025-01-22 16:54:10.095 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4916, 4921) --> . John moved to the
2025-01-22 16:54:10.095 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John journeyed to the bedroom.
2025-01-22 16:54:10.137 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6983, 6989) --> . John journeyed to the
2025-01-22 16:54:10.137 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John went back to the office.
2025-01-22 16:54:10.142 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (815, 821) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 16:54:10.985 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's office.<|eot_id|>
2025-01-22 16:54:10.985 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8226])
2025-01-22 16:54:13.224 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [401.9893092105263, 28.9930637835703, 268.20036764705884, 27.131520609099805, 37.357185782967036], 'topk_indices': array([3603, 4147, 8224,   14, 1855, 8209, 8124,   24, 1848, 8216, 8214,
       1853, 1856, 1852, 1857, 1849, 3604, 8221, 8222,    0]), 'topk_tokens': [' the', 'ï¿½', '<|end_header_id|>', '\n', '      ', ':', ' location', '\n\n', '.', ' bathroom', ' before', '.', ' *', ' apple', '      ', ' Daniel', ' hallway', '<|eot_id|>', '<|start_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [741.4375, 654.2, 240.075, 40.134375]}, 'weight': {'score': [24.863075657894736, 23.299742146676387, 21.59420955882353, 23.303201634356654, 29.07091346153846], 'topk_indices': array([3267, 3294, 3139, 3187, 7395, 7433, 1474, 1412, 4299, 4315, 5184,
       5123, 7172, 7116, 3476, 3450, 4912, 4887, 4941, 4970]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.568359375, 25.7609375, 26.7078125, 20.75625]}, 'saliency': {'score': [2.8637920178865133, 0.16474527193746963, 1.696420108570772, 0.15210353604968047, 0.27827688363882214], 'topk_indices': array([1795,  257, 3600, 1850, 4147, 3584, 3601, 3599, 8208, 1855, 4161,
       8213, 8124, 8214, 1856, 8216, 1857, 1852, 1849, 3604]), 'topk_tokens': ['itol', 'hue', ' Daniel', ' took', 'ï¿½', 'ï¿½', ' went', 'â™€', 'Question', '      ', ' bathroom', ' apple', ' location', ' before', ' *', ' bathroom', '      ', ' apple', ' Daniel', ' hallway'], 'evidence_proportions': [5.272705078125, 4.6509765625, 1.79453125, 0.21873779296875]}}, 'pred_res': "Daniel's office.<|eot_id|>", 'score': 0}
2025-01-22 16:54:13.239 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 16:54:13.239 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-18_pid-3_2-4-5-8.pkl | len: 3 |  size: 2.02 KB
Processing depth (2, 4, 5, 8):   4%|â–         | 4/100 [01:21<32:42, 20.44s/it]is_0k: False
your chose emoji: ['ğŸ§–ğŸ¼\u200dâ™€', 'ğŸ‘©\u200dğŸ‘©\u200dğŸ‘¦\u200dğŸ‘¦', 'ğŸ™ŒğŸ¿', 'ğŸ‡µğŸ‡¬', 'ğŸ‘¨ğŸ»\u200dğŸ¤\u200dğŸ‘¨ğŸ¾', '\U0001faf8ğŸ»', 'ğŸ‘³ğŸ¼', 'ğŸ‘—', 'ğŸ‘ƒğŸ»', 'ğŸ‘©ğŸ½\u200dâ¤\u200dğŸ’‹\u200dğŸ‘¨ğŸ¾']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.26s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.74s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.61s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  2.97s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.56s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 1, 3, 6):   4%|â–         | 4/100 [01:37<32:42, 20.44s/it]2025-01-22 16:54:29.293 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel took the apple.
2025-01-22 16:54:29.334 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the hallway.
2025-01-22 16:54:29.338 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (900, 905) --> . Daniel went to the
2025-01-22 16:54:29.339 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel travelled to the bathroom.
2025-01-22 16:54:29.356 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3049, 3054) --> . Daniel travelled to the
2025-01-22 16:54:29.357 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary travelled to the bedroom.
2025-01-22 16:54:29.387 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4802, 4807) -->  the senate. Mary travelled
2025-01-22 16:54:29.387 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the kitchen.
2025-01-22 16:54:29.412 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4100, 4105) --> . Sandra moved to the
2025-01-22 16:54:29.412 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the hallway.
2025-01-22 16:54:29.417 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (904, 910) -->  the hallway. John went back
2025-01-22 16:54:29.417 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra journeyed to the office.
2025-01-22 16:54:29.437 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3753, 3759) --> . Sandra journeyed to the
2025-01-22 16:54:29.437 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John moved to the garden.
2025-01-22 16:54:29.465 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4958, 4963) --> . John moved to the
2025-01-22 16:54:29.466 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John journeyed to the bedroom.
2025-01-22 16:54:29.504 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6967, 6973) --> . John journeyed to the
2025-01-22 16:54:29.504 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John went back to the office.
2025-01-22 16:54:29.509 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (904, 910) -->  the hallway. John went back
2025-01-22 16:54:29.509 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 16:54:29.509 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 16:54:29.509 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 16:54:29.509 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸŒ', 'ğŸ§ğŸ¿\u200dâ™€ï¸\u200dâ¡ï¸', 'ğŸ§‘ğŸ¿\u200dğŸ¦¼\u200dâ¡ï¸', 'ğŸ‘¨ğŸ½\u200dâ¤\u200dğŸ’‹\u200dğŸ‘¨ğŸ»', 'ğŸ‘¨ğŸ¾', 'ğŸ¥‰', 'ğŸ‘¨ğŸ»\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘¨ğŸ»', 'ğŸ³\u200dğŸŒˆ', 'â˜', 'ğŸ§œğŸ¿\u200dâ™‚']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:05<00:15,  5.17s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.58s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.49s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.09s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.67s/it]
Processing depth (3, 4, 7, 8):   4%|â–         | 4/100 [01:54<32:42, 20.44s/it]2025-01-22 16:54:45.940 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel took the apple.
2025-01-22 16:54:45.954 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2873, 2877) -->  Daniel took the apple
2025-01-22 16:54:45.954 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the hallway.
2025-01-22 16:54:45.972 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3603, 3608) --> . Daniel went to the
2025-01-22 16:54:45.972 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel travelled to the bathroom.
2025-01-22 16:54:46.001 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5671, 5676) --> . Daniel travelled to the
2025-01-22 16:54:46.001 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary travelled to the bedroom.
2025-01-22 16:54:46.036 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6545, 6550) --> . Mary travelled to the
2025-01-22 16:54:46.036 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the kitchen.
2025-01-22 16:54:46.059 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4034, 4039) --> . Sandra moved to the
2025-01-22 16:54:46.059 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the hallway.
2025-01-22 16:54:46.079 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3605, 3611) -->  went to the hallway. Sandra
2025-01-22 16:54:46.079 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra journeyed to the office.
2025-01-22 16:54:46.097 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3607, 3613) -->  the hallway. Sandra journeyed
2025-01-22 16:54:46.098 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John moved to the garden.
2025-01-22 16:54:46.128 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4960, 4965) --> . John moved to the
2025-01-22 16:54:46.128 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John journeyed to the bedroom.
2025-01-22 16:54:46.167 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6849, 6855) --> . John journeyed to the
2025-01-22 16:54:46.167 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John went back to the office.
2025-01-22 16:54:46.171 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (821, 827) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 16:54:46.948 | INFO     | test_jbb_embedding:begin_test:693 - The hallway.<|eot_id|>
2025-01-22 16:54:46.948 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8188])
2025-01-22 16:54:49.184 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [185.5296052631579, 18.030967677939202, 169.85753676470588, 17.005583374293437, 8.498942057291666], 'topk_indices': array([8076, 2877, 2873, 8169, 8171, 8176,    3, 8042, 8178,    1,    9,
       8184, 8086,   24, 2876,   14, 3608, 8186,    0, 8183]), 'topk_tokens': ['.\n\n', '.', ' Daniel', '.\n\n', ':', ' before', '<|end_header_id|>', ' context', ' bathroom', '<|start_header_id|>', ':', '<|start_header_id|>', ' location', '\n\n', ' apple', '\n', ' hallway', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [385.625, 240.15, 130.475, 25.8875]}, 'weight': {'score': [21.761924342105264, 23.281324395678183, 21.59420955882353, 23.291920427316295, 29.546223958333332], 'topk_indices': array([3314, 3287, 3207, 3159, 7441, 7479, 1430, 1492, 4285, 4301, 5102,
       5163, 7162, 7218, 3470, 3496, 4950, 4873, 4921, 4898]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.568359375, 19.665625, 21.01875, 20.75625]}, 'saliency': {'score': [1.136278654399671, 0.10021562079139833, 1.0574502383961397, 0.09379743762144031, 0.06271478864881727], 'topk_indices': array([8169,   20, 2874, 5202, 4036, 5676,    8,   24, 8157, 3604, 8181,
       8175, 8176, 8170, 2873, 8042, 8086, 8178, 2876, 3608]), 'topk_tokens': ['.\n\n', ' Jul', ' took', ' hallway', ' moved', ' bathroom', ' Date', '\n\n', ' return', ' Daniel', 'Answer', ' apple', ' before', 'Question', ' Daniel', ' context', ' location', ' bathroom', ' apple', ' hallway'], 'evidence_proportions': [2.682373046875, 1.2587890625, 0.771435546875, 0.14173583984375]}}, 'pred_res': 'The hallway.<|eot_id|>', 'score': 100}
2025-01-22 16:54:49.192 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 16:54:49.192 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-18_pid-4_3-4-7-8.pkl | len: 3 |  size: 2.06 KB
Processing depth (3, 4, 7, 8):   5%|â–Œ         | 5/100 [01:57<41:13, 26.03s/it]Processing depth (3, 4, 7, 8):   5%|â–Œ         | 5/100 [01:57<37:14, 23.52s/it]
2025-01-22 16:54:49.269 | INFO     | __main__:<module>:82 - Selected idx: 20
2025-01-22 16:54:49.269 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the apple before the garden? 
2025-01-22 16:54:49.269 | INFO     | __main__:<module>:84 - Answer: kitchen
2025-01-22 16:54:49.269 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 16:54:49.269 | INFO     | __main__:<module>:86 - Needle: [' John grabbed the football.', ' Sandra grabbed the apple.', ' Daniel went back to the bathroom.', ' Sandra moved to the kitchen.', ' John went to the kitchen.', ' John went back to the bedroom.', ' Sandra went back to the garden.', ' Daniel journeyed to the hallway.']
2025-01-22 16:54:49.269 | INFO     | __main__:<module>:87 - Real Needle: [' Sandra grabbed the apple.', ' Sandra moved to the kitchen.', ' Sandra went back to the garden.', ' Daniel journeyed to the hallway.']
2025-01-22 16:54:49.269 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ‘¨ğŸ»\u200dâ¤\u200dğŸ’‹\u200dğŸ‘¨ğŸ¾', 'ğŸšŒ', 'ğŸ‘·ğŸ»\u200dâ™‚ï¸', 'ğŸ›¢', 'ğŸ’‚ğŸ½', 'ğŸ¤µğŸ¿\u200dâ™€ï¸', 'ğŸ‡«ğŸ‡°', '\U0001faf7ğŸ»', 'ğŸ‘¨ğŸ¿\u200dâš–', 'ğŸ ']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.86s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.30s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.77s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.26s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.89s/it]
Processing depth (0, 1, 5, 6):   0%|          | 0/100 [00:17<?, ?it/s]2025-01-22 16:55:06.820 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra grabbed the apple.
2025-01-22 16:55:06.861 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the kitchen.
2025-01-22 16:55:06.865 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (671, 676) --> . Sandra moved to the
2025-01-22 16:55:06.865 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the garden.
2025-01-22 16:55:06.886 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4134, 4140) -->  Sandra went back to the garden
2025-01-22 16:55:06.886 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the hallway.
2025-01-22 16:55:06.918 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4664, 4670) --> . Daniel journeyed to the
2025-01-22 16:55:06.918 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John grabbed the football.
2025-01-22 16:55:06.936 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3680, 3684) -->  John grabbed the football
2025-01-22 16:55:06.936 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went back to the bathroom.
2025-01-22 16:55:06.956 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3942, 3948) --> . Daniel went back to the
2025-01-22 16:55:06.956 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went to the kitchen.
2025-01-22 16:55:06.987 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5638, 5643) -->  John went back to the
2025-01-22 16:55:06.988 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the bedroom.
2025-01-22 16:55:07.017 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5637, 5643) --> . John went back to the
2025-01-22 16:55:07.018 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 16:55:07.018 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 16:55:07.018 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 16:55:07.018 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ¼', 'ğŸ§¢', 'ğŸ§‘ğŸ¾\u200dğŸ¦°', 'ğŸ‘©ğŸ¼\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘©ğŸ¿', 'ğŸ‡±ğŸ‡·', 'ğŸ™‡ğŸ¿\u200dâ™€', 'ğŸ¤¦ğŸ¿\u200dâ™€ï¸', 'ğŸŒ¤', 'ğŸ§—ğŸ½', 'ğŸ‘©ğŸ»\u200dğŸ“']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.25s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.45s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.63s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.25s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.70s/it]
Processing depth (2, 4, 6, 9):   0%|          | 0/100 [00:34<?, ?it/s]2025-01-22 16:55:24.309 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra grabbed the apple.
2025-01-22 16:55:24.318 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1774, 1778) -->  Sandra grabbed the apple
2025-01-22 16:55:24.318 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the kitchen.
2025-01-22 16:55:24.337 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3583, 3588) -->  Hon. Sandra moved to
2025-01-22 16:55:24.337 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the garden.
2025-01-22 16:55:24.361 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4614, 4620) --> . Sandra went back to the
2025-01-22 16:55:24.361 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the hallway.
2025-01-22 16:55:24.403 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7204, 7210) --> . Daniel journeyed to the
2025-01-22 16:55:24.403 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John grabbed the football.
2025-01-22 16:55:24.423 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3763, 3767) -->  John grabbed the football
2025-01-22 16:55:24.423 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went back to the bathroom.
2025-01-22 16:55:24.444 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3937, 3943) -->  the ground. Daniel went back
2025-01-22 16:55:24.444 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went to the kitchen.
2025-01-22 16:55:24.477 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5588, 5593) -->  John went back to the
2025-01-22 16:55:24.477 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the bedroom.
2025-01-22 16:55:24.506 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5587, 5593) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 16:55:25.311 | INFO     | test_jbb_embedding:begin_test:693 - the capitol<|eot_id|>
2025-01-22 16:55:25.311 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8151])
2025-01-22 16:55:27.520 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [234.953125, 22.13810131530537, 54.457589285714285, 21.503507535133135, 21.60361328125], 'topk_indices': array([  24, 8150, 8138, 8132, 8134, 8133,    3, 8140, 8136, 1775,   14,
       1774, 8142, 8147, 1777, 8141, 8139, 8149, 8146,    0]), 'topk_tokens': ['\n\n', '\n\n', ' apple', '.\n\n', ':', 'Question', '<|end_header_id|>', ' the', ' was', ' grabbed', '\n', ' Sandra', '?', '<|start_header_id|>', ' apple', ' garden', ' before', '<|end_header_id|>', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [648.9375, 187.625, 200.70833333333334, 32.6484375]}, 'weight': {'score': [23.860863095238095, 23.258722712779004, 22.961309523809526, 23.25793384800296, 29.125520833333333], 'topk_indices': array([3246, 3273, 3118, 3166, 7422, 7384, 1471, 1409, 4317, 4301, 5180,
       5119, 7098, 7154, 3429, 3455, 4973, 4921, 4896, 4944]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [29.748046875, 25.8484375, 21.869791666666668, 20.270833333333332]}, 'saliency': {'score': [1.6162167503720237, 0.12420487374630167, 0.3504522414434524, 0.11975671741854274, 0.16097819010416667], 'topk_indices': array([8150,    8, 1796, 1772, 8049, 4620, 8132, 8144, 8148, 1797, 8136,
       8135, 8142, 8138, 8133, 1775, 8139, 8141, 1777, 1774]), 'topk_tokens': ['\n\n', ' Date', ' cap', ' Mr', ' location', ' garden', '.\n\n', 'Answer', 'assistant', 'itol', ' was', ' Where', '?', ' apple', 'Question', ' grabbed', ' before', ' garden', ' apple', ' Sandra'], 'evidence_proportions': [5.124755859375, 1.18466796875, 1.0835774739583333, 0.16945393880208334]}}, 'pred_res': 'the capitol<|eot_id|>', 'score': 0}
2025-01-22 16:55:27.528 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 16:55:27.529 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-20_pid-0_2-4-6-9.pkl | len: 3 |  size: 2.02 KB
Processing depth (2, 4, 6, 9):   1%|          | 1/100 [00:38<1:02:53, 38.12s/it]is_0k: False
your chose emoji: ['ğŸªŸ', 'ğŸ§‘ğŸ¿\u200dğŸ“', 'ğŸ‡¨ğŸ‡µ', 'ğŸš°', 'ğŸ¥¶', 'ğŸ‘¨ğŸ¾\u200dâš–ï¸', 'ğŸ•Œ', 'ğŸ‘°ğŸ½\u200dâ™‚', 'ğŸª¨', 'ğŸŒğŸ¼\u200dâ™‚ï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.59s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.84s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.72s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.23s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.78s/it]
Processing depth (3, 4, 5, 8):   1%|          | 1/100 [00:54<1:02:53, 38.12s/it]2025-01-22 16:55:44.487 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra grabbed the apple.
2025-01-22 16:55:44.508 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2908, 2912) -->  Sandra grabbed the apple
2025-01-22 16:55:44.508 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the kitchen.
2025-01-22 16:55:44.526 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3589, 3594) -->  Hon. Sandra moved to
2025-01-22 16:55:44.527 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the garden.
2025-01-22 16:55:44.548 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4158, 4164) --> . Sandra went back to the
2025-01-22 16:55:44.548 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the hallway.
2025-01-22 16:55:44.583 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6576, 6582) --> . Daniel journeyed to the
2025-01-22 16:55:44.583 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John grabbed the football.
2025-01-22 16:55:44.605 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3769, 3773) -->  John grabbed the football
2025-01-22 16:55:44.605 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went back to the bathroom.
2025-01-22 16:55:44.625 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4009, 4015) --> . Daniel went back to the
2025-01-22 16:55:44.625 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went to the kitchen.
2025-01-22 16:55:44.658 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5644, 5649) -->  John went back to the
2025-01-22 16:55:44.658 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the bedroom.
2025-01-22 16:55:44.687 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5643, 5649) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 16:55:45.464 | INFO     | test_jbb_embedding:begin_test:693 - the kitchen<|eot_id|>
2025-01-22 16:55:45.464 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8215])
2025-01-22 16:55:47.689 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [248.7983630952381, 17.165144347773182, 35.656622023809526, 16.52270077819227, 10.028288468070652], 'topk_indices': array([2909,   14, 8202, 8069, 8209, 8197, 2879, 3590, 8198, 8205, 2908,
       3595, 3594, 3592, 8203, 2911, 8213,    0, 8211, 8210]), 'topk_tokens': [' grabbed', '\n', ' apple', ' context', ':', 'Question', '.', '.', ':', ' garden', ' Sandra', ' kitchen', ' the', ' moved', ' before', ' apple', '<|end_header_id|>', '<|begin_of_text|>', '<|start_header_id|>', '<|eot_id|>'], 'evidence_proportions': [511.3125, 436.125, 141.8125, 24.669270833333332]}, 'weight': {'score': [23.860863095238095, 23.310541646385982, 22.189732142857142, 23.312006941046967, 29.402004076086957], 'topk_indices': array([3252, 3279, 3124, 3172, 7454, 7492, 1473, 1411, 4302, 4318, 5145,
       5206, 7175, 7231, 3435, 3461, 4970, 4999, 4947, 4922]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [29.748046875, 25.8484375, 21.869791666666668, 20.270833333333332]}, 'saliency': {'score': [1.6578340076264881, 0.09588099442772344, 0.21416437058221727, 0.09156531877013802, 0.07406483525815218], 'topk_indices': array([8103, 2914, 2880, 8206, 8200, 2878, 8199, 4164, 8208, 3591, 8069,
       8202, 8197, 2909, 8205, 8203, 3595, 3592, 2911, 2908]), 'topk_tokens': ['.\n\n', 'ible', ' During', '?', ' was', ' Gov', ' Where', ' garden', 'Answer', ' Sandra', ' context', ' apple', 'Question', ' grabbed', ' garden', ' before', ' kitchen', ' moved', ' apple', ' Sandra'], 'evidence_proportions': [3.9959716796875, 2.653515625, 0.8006591796875, 0.12651570638020834]}}, 'pred_res': 'the kitchen<|eot_id|>', 'score': 100}
2025-01-22 16:55:47.696 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 16:55:47.697 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-20_pid-1_3-4-5-8.pkl | len: 3 |  size: 2.02 KB
Processing depth (3, 4, 5, 8):   2%|â–         | 2/100 [00:58<45:00, 27.56s/it]  is_0k: False
your chose emoji: ['âš±ï¸', 'ğŸ‘‡ğŸ¾', 'â˜„', 'ğŸ§‘ğŸ¿\u200dğŸ¦½\u200dâ¡', 'ğŸ‘©ğŸ¾\u200dâ¤ï¸\u200dğŸ‘¨ğŸ¼', 'ğŸ‡°ğŸ‡®', 'ğŸ‘©ğŸ¿\u200dâ¤\u200dğŸ‘¨ğŸ¾', 'ğŸƒ', 'ğŸ‘©ğŸ»\u200dğŸ¤\u200dğŸ‘©ğŸ¼', 'ğŸ§ğŸ½\u200dâ¡ï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.43s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.11s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.88s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.36s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.91s/it]
Processing depth (0, 1, 7, 9):   2%|â–         | 2/100 [01:15<45:00, 27.56s/it]2025-01-22 16:56:05.184 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra grabbed the apple.
2025-01-22 16:56:05.225 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the kitchen.
2025-01-22 16:56:05.230 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (827, 832) --> . Sandra moved to the
2025-01-22 16:56:05.230 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the garden.
2025-01-22 16:56:05.262 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5599, 5605) --> . Sandra went back to the
2025-01-22 16:56:05.263 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the hallway.
2025-01-22 16:56:05.299 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7253, 7259) --> . Daniel journeyed to the
2025-01-22 16:56:05.299 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John grabbed the football.
2025-01-22 16:56:05.317 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3670, 3674) -->  John grabbed the football
2025-01-22 16:56:05.317 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went back to the bathroom.
2025-01-22 16:56:05.340 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3968, 3974) -->  the ground. Daniel went back
2025-01-22 16:56:05.341 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went to the kitchen.
2025-01-22 16:56:05.372 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5604, 5609) -->  the garden. John went
2025-01-22 16:56:05.372 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the bedroom.
2025-01-22 16:56:05.404 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5602, 5608) -->  back to the garden. John
2025-01-22 16:56:05.404 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 16:56:05.404 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 16:56:05.404 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 16:56:05.404 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ‡°ğŸ‡¿', 'ğŸ““', 'ğŸ‘¨ğŸ¿\u200dâ¤ï¸\u200dğŸ‘¨ğŸ¼', 'ğŸ§‘\u200dğŸ’¼', 'ğŸ‘©ğŸ½\u200dğŸ¤\u200dğŸ‘¨ğŸ»', 'ğŸƒğŸ¿\u200dâ™‚ï¸', 'ğŸ˜', 'ğŸ¤¹ğŸ¿\u200dâ™‚ï¸', 'ğŸ¤°', 'ğŸ§ğŸ¿\u200dâ™€ï¸']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.10s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.32s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.56s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.18s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.62s/it]
Processing depth (1, 2, 4, 6):   2%|â–         | 2/100 [01:32<45:00, 27.56s/it]2025-01-22 16:56:21.630 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra grabbed the apple.
2025-01-22 16:56:21.634 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (822, 826) -->  Sandra grabbed the apple
2025-01-22 16:56:21.635 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the kitchen.
2025-01-22 16:56:21.645 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1852, 1857) --> . Sandra moved to the
2025-01-22 16:56:21.646 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the garden.
2025-01-22 16:56:21.665 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3605, 3611) -->  Hon. Sandra went back to
2025-01-22 16:56:21.665 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the hallway.
2025-01-22 16:56:21.692 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4853, 4859) --> . Daniel journeyed to the
2025-01-22 16:56:21.692 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John grabbed the football.
2025-01-22 16:56:21.711 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3786, 3790) -->  John grabbed the football
2025-01-22 16:56:21.711 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went back to the bathroom.
2025-01-22 16:56:21.735 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4034, 4040) --> . Daniel went back to the
2025-01-22 16:56:21.735 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went to the kitchen.
2025-01-22 16:56:21.764 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5645, 5650) -->  John went back to the
2025-01-22 16:56:21.764 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the bedroom.
2025-01-22 16:56:21.793 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5644, 5650) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 16:56:22.686 | INFO     | test_jbb_embedding:begin_test:693 - Sandra's hand.<|eot_id|>
2025-01-22 16:56:22.687 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8159])
2025-01-22 16:56:24.903 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [353.6577380952381, 36.25287153883852, 72.98065476190476, 35.33701123768473, 28.63677978515625], 'topk_indices': array([8140, 8057, 8145, 3613, 8013, 8047, 8143,  826, 8157, 8148, 8144,
       8141, 8142, 8146, 8150, 8149, 8154, 8147,    0, 8155]), 'topk_tokens': ['.\n\n', ' location', ' the', '.', ' context', '.\n\n', ' Where', '.', '<|end_header_id|>', ' the', ' was', 'Question', ':', ' apple', '?', ' garden', '<|eot_id|>', ' before', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [635.4375, 451.65, 350.8541666666667, 86.94791666666667]}, 'weight': {'score': [23.860863095238095, 23.27522742587601, 22.189732142857142, 23.27652016625616, 29.815185546875], 'topk_indices': array([3268, 3295, 3140, 3188, 7420, 7382, 1478, 1416, 4286, 4302, 5165,
       5104, 7091, 7147, 3477, 3451, 4929, 4906, 4881, 4958]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [29.748046875, 21.040625, 25.876302083333332, 20.270833333333332]}, 'saliency': {'score': [2.2855398995535716, 0.1989146061780201, 0.45377022879464285, 0.1928590520849369, 0.2135334014892578], 'topk_indices': array([1853,    0, 8053, 1854, 8140,  823, 8047, 8142,  822, 3612, 8144,
        825, 8057, 8013, 8143, 8150, 8141, 8146, 8149, 8147]), 'topk_tokens': [' Sandra', '<|begin_of_text|>', ' item', ' moved', '.\n\n', ' grabbed', '.\n\n', ':', ' Sandra', ' garden', ' was', ' apple', ' location', ' context', ' Where', '?', 'Question', ' apple', ' garden', ' before'], 'evidence_proportions': [4.929931640625, 2.58759765625, 2.09228515625, 0.4641520182291667]}}, 'pred_res': "Sandra's hand.<|eot_id|>", 'score': 0}
2025-01-22 16:56:24.916 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 16:56:24.917 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-20_pid-2_1-2-4-6.pkl | len: 3 |  size: 2.02 KB
Processing depth (1, 2, 4, 6):   3%|â–         | 3/100 [01:35<51:41, 31.97s/it]is_0k: False
your chose emoji: ['ğŸ‘±ğŸ¼\u200dâ™‚ï¸', 'ğŸ™ğŸ¿\u200dâ™€ï¸', 'ğŸ‡²ğŸ‡µ', 'ğŸ›', 'ğŸ‡§ğŸ‡¹', 'ğŸšµ\u200dâ™‚', 'ğŸ§\u200dâ™‚', 'ğŸ˜“', 'ğŸ’‡ğŸ¿\u200dâ™€', 'ğŸ§‘ğŸ¾\u200dğŸ¼']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:05<00:15,  5.05s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.85s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.72s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.24s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.83s/it]
Processing depth (0, 1, 3, 9):   3%|â–         | 3/100 [01:52<51:41, 31.97s/it]2025-01-22 16:56:42.012 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra grabbed the apple.
2025-01-22 16:56:42.052 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the kitchen.
2025-01-22 16:56:42.057 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (821, 826) --> . Sandra moved to the
2025-01-22 16:56:42.057 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the garden.
2025-01-22 16:56:42.072 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2883, 2889) --> . Sandra went back to the
2025-01-22 16:56:42.072 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the hallway.
2025-01-22 16:56:42.115 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7195, 7201) --> . Daniel journeyed to the
2025-01-22 16:56:42.115 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John grabbed the football.
2025-01-22 16:56:42.134 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3753, 3757) -->  John grabbed the football
2025-01-22 16:56:42.134 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went back to the bathroom.
2025-01-22 16:56:42.155 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4025, 4031) --> . Daniel went back to the
2025-01-22 16:56:42.155 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went to the kitchen.
2025-01-22 16:56:42.187 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6279, 6284) --> . John went to the
2025-01-22 16:56:42.187 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the bedroom.
2025-01-22 16:56:42.217 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5623, 5629) -->  John went back to the bedroom
2025-01-22 16:56:42.217 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 16:56:42.218 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 16:56:42.218 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 16:56:42.218 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ“™', 'âœŒğŸ»', 'ğŸ‘©ğŸ¼\u200dâ¤\u200dğŸ‘¨ğŸ¿', 'â†™ï¸', 'ğŸ³ï¸\u200dğŸŒˆ', 'ğŸ¦¸ğŸ¼', 'ğŸ•ï¸', 'ğŸ¦¹\u200dâ™‚ï¸', 'ğŸ––ğŸ»', 'ğŸ‘¨ğŸ¼\u200dâš–ï¸']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.72s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.71s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.61s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.15s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.71s/it]
Processing depth (2, 6, 7, 9):   3%|â–         | 3/100 [02:09<51:41, 31.97s/it]2025-01-22 16:56:58.858 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra grabbed the apple.
2025-01-22 16:56:58.868 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2000, 2004) -->  Sandra grabbed the apple
2025-01-22 16:56:58.868 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the kitchen.
2025-01-22 16:56:58.892 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4730, 4735) -->  the senate. Sandra moved
2025-01-22 16:56:58.892 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the garden.
2025-01-22 16:56:58.922 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5686, 5692) --> . Sandra went back to the
2025-01-22 16:56:58.922 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the hallway.
2025-01-22 16:56:58.959 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7103, 7109) -->  Daniel journeyed to the hallway
2025-01-22 16:56:58.959 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John grabbed the football.
2025-01-22 16:56:58.978 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3733, 3737) -->  John grabbed the football
2025-01-22 16:56:58.978 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went back to the bathroom.
2025-01-22 16:56:58.998 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3936, 3942) -->  Daniel went back to the bathroom
2025-01-22 16:56:58.998 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went to the kitchen.
2025-01-22 16:56:59.028 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5691, 5696) -->  the garden. John went
2025-01-22 16:56:59.028 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the bedroom.
2025-01-22 16:56:59.062 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5689, 5695) -->  back to the garden. John
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 16:56:59.867 | INFO     | test_jbb_embedding:begin_test:693 - The boat.<|eot_id|>
2025-01-22 16:56:59.867 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8169])
2025-01-22 16:57:02.097 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [155.17559523809524, 20.734761227361723, 122.55505952380952, 20.124492619926198, 18.864045516304348], 'topk_indices': array([8150, 8160, 2175, 8159,   23, 2003,    1, 8157, 2004, 8156,    9,
         24,    3,   14, 2176, 8165, 8167, 2177,    0, 8164]), 'topk_tokens': ['.\n\n', '?', 'ï¿½', ' garden', '4', ' apple', '<|start_header_id|>', ' before', '.', ' apple', ':', '\n\n', '<|end_header_id|>', '\n', 'ï¿½', '<|start_header_id|>', '<|end_header_id|>', 'ï¿½', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [401.34375, 102.190625, 147.64583333333334, 42.747395833333336]}, 'weight': {'score': [25.293154761904763, 23.27539922907489, 23.714285714285715, 23.269053659286595, 29.35144927536232], 'topk_indices': array([3240, 3267, 3112, 3160, 7432, 7394, 1461, 1399, 4279, 4263, 5080,
       5141, 7171, 7115, 3443, 3469, 4857, 4934, 4882, 4905]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [29.748046875, 25.76875, 21.869791666666668, 25.350260416666668]}, 'saliency': {'score': [1.09747314453125, 0.11596985908915351, 0.7105945405505952, 0.11189867983884917, 0.13820493394050046], 'topk_indices': array([2652, 8153,    8, 8162, 8067,   20, 8160,   23, 8023,   24, 8151,
       2001, 8157, 8159, 2000, 2003, 2176, 2175, 8156, 2177]), 'topk_tokens': ['pl', ' Where', ' Date', 'Answer', ' location', ' Jul', '?', '4', ' context', '\n\n', 'Question', ' grabbed', ' before', ' garden', ' Sandra', ' apple', 'ï¿½', 'ï¿½', ' apple', 'ï¿½'], 'evidence_proportions': [3.1507568359375, 0.705712890625, 0.8694254557291666, 0.2831319173177083]}}, 'pred_res': 'The boat.<|eot_id|>', 'score': 0}
2025-01-22 16:57:02.124 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 16:57:02.125 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-20_pid-3_2-6-7-9.pkl | len: 3 |  size: 2.0 KB
Processing depth (2, 6, 7, 9):   4%|â–         | 4/100 [02:12<54:27, 34.04s/it]is_0k: False
your chose emoji: ['ğŸ‘³ğŸ¾\u200dâ™‚ï¸', 'ğŸ‘¨ğŸ»\u200dğŸ¦±', 'ğŸ¥ª', 'â–¶', 'ğŸ‘¨ğŸ¿\u200dğŸ¦³', 'ğŸ•µï¸\u200dâ™‚ï¸', 'ğŸ–‡', 'ğŸ', 'ğŸŒ¤', 'ğŸ‘©ğŸ¾\u200dğŸ¤\u200dğŸ‘©ğŸ»']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.31s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.74s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.61s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.21s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.71s/it]
Processing depth (1, 3, 4, 8):   4%|â–         | 4/100 [02:29<54:27, 34.04s/it]2025-01-22 16:57:18.826 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra grabbed the apple.
2025-01-22 16:57:18.841 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (896, 900) -->  Sandra grabbed the apple
2025-01-22 16:57:18.841 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the kitchen.
2025-01-22 16:57:18.857 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2916, 2921) --> . Sandra moved to the
2025-01-22 16:57:18.858 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the garden.
2025-01-22 16:57:18.888 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3599, 3605) -->  Hon. Sandra went back to
2025-01-22 16:57:18.889 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the hallway.
2025-01-22 16:57:18.928 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6620, 6626) --> . Daniel journeyed to the
2025-01-22 16:57:18.929 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John grabbed the football.
2025-01-22 16:57:18.948 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3756, 3760) -->  John grabbed the football
2025-01-22 16:57:18.948 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went back to the bathroom.
2025-01-22 16:57:18.974 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3964, 3970) -->  the ground. Daniel went back
2025-01-22 16:57:18.974 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went to the kitchen.
2025-01-22 16:57:19.019 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6308, 6313) --> . John went to the
2025-01-22 16:57:19.019 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the bedroom.
2025-01-22 16:57:19.064 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5628, 5634) -->  John went back to the bedroom
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 16:57:19.951 | INFO     | test_jbb_embedding:begin_test:693 - Sandra's hand.<|eot_id|>
2025-01-22 16:57:19.951 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8205])
2025-01-22 16:57:22.176 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [322.8675595238095, 32.23886376096491, 77.49144345238095, 31.375098541207446, 23.910246048850574], 'topk_indices': array([3607, 8186, 8194,    9, 8191, 8093, 8189, 8190, 8187,  900,   14,
       8188, 8203, 8196, 8195, 8192, 8193,    0, 8200, 8201]), 'topk_tokens': ['.', '.\n\n', ' the', ':', ' the', '.\n\n', ' Where', ' was', 'Question', '.', '\n', ':', '<|end_header_id|>', '?', ' garden', ' apple', ' before', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [743.4375, 269.125, 328.7291666666667, 81.41145833333333]}, 'weight': {'score': [23.860863095238095, 23.31210594846491, 23.41592261904762, 23.310427764511388, 29.825969827586206], 'topk_indices': array([3283, 3256, 3128, 3176, 7464, 7426, 1486, 1424, 4294, 4310, 5166,
       5105, 7203, 7147, 3445, 3471, 4882, 4907, 4930, 4959]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [29.748046875, 21.040625, 25.876302083333332, 20.270833333333332]}, 'saliency': {'score': [2.1735403878348216, 0.17372293453699897, 0.47064935593377977, 0.16781653956166384, 0.17897858016792384], 'topk_indices': array([  32,    8, 8198, 8186, 3606, 8188, 8093, 8099, 8190, 8059, 8103,
        897,  899,  896, 8196, 8189, 8187, 8195, 8192, 8193]), 'topk_tokens': ['***', ' Date', 'Answer', '.\n\n', ' garden', ':', '.\n\n', ' item', ' was', ' context', ' location', ' grabbed', ' apple', ' Sandra', '?', ' Where', 'Question', ' garden', ' apple', ' before'], 'evidence_proportions': [5.895751953125, 1.488671875, 1.9710286458333333, 0.465301513671875]}}, 'pred_res': "Sandra's hand.<|eot_id|>", 'score': 0}
2025-01-22 16:57:22.194 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 16:57:22.195 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-20_pid-4_1-3-4-8.pkl | len: 3 |  size: 1.99 KB
Processing depth (1, 3, 4, 8):   5%|â–Œ         | 5/100 [02:32<45:55, 29.00s/it]Processing depth (1, 3, 4, 8):   5%|â–Œ         | 5/100 [02:32<48:24, 30.57s/it]
2025-01-22 16:57:22.266 | INFO     | __main__:<module>:82 - Selected idx: 22
2025-01-22 16:57:22.266 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the apple before the garden? 
2025-01-22 16:57:22.266 | INFO     | __main__:<module>:84 - Answer: kitchen
2025-01-22 16:57:22.266 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 16:57:22.266 | INFO     | __main__:<module>:86 - Needle: [' John went to the kitchen.', ' Sandra got the apple.', ' John grabbed the apple.', ' Daniel went back to the kitchen.', ' Sandra moved to the kitchen.', ' John went back to the bedroom.', ' Daniel journeyed to the hallway.', ' Daniel went back to the bathroom.', ' Mary took the milk.', ' Sandra went back to the garden.', ' Mary journeyed to the garden.']
2025-01-22 16:57:22.266 | INFO     | __main__:<module>:87 - Real Needle: [' Sandra got the apple.', ' Sandra moved to the kitchen.', ' Sandra went back to the garden.', ' Mary journeyed to the garden.']
2025-01-22 16:57:22.266 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ‘‹', 'ğŸ‹ğŸ½\u200dâ™€', 'ğŸ‘¨ğŸ¼\u200dğŸš’', 'ğŸ³', 'ğŸ³\u200dğŸŒˆ', 'ğŸš´\u200dâ™‚ï¸', 'ğŸ‘©ğŸ¿\u200dğŸ¦°', 'ğŸ‘¨ğŸ»\u200dâ¤\u200dğŸ’‹\u200dğŸ‘¨ğŸ¼', 'ğŸ’§', 'ğŸ‘©ğŸ»\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘¨ğŸ»']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:05<00:15,  5.08s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.07s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.86s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.32s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.93s/it]
Processing depth (0, 1, 6, 9):   0%|          | 0/100 [00:17<?, ?it/s]2025-01-22 16:57:40.015 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra got the apple.
2025-01-22 16:57:40.056 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the kitchen.
2025-01-22 16:57:40.061 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (794, 799) -->  Sandra moved to the kitchen
2025-01-22 16:57:40.061 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the garden.
2025-01-22 16:57:40.087 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4763, 4769) -->  the senate. Sandra went back
2025-01-22 16:57:40.088 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary journeyed to the garden.
2025-01-22 16:57:40.125 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7103, 7109) -->  Mary journeyed to the garden
2025-01-22 16:57:40.126 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went to the kitchen.
2025-01-22 16:57:40.147 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3664, 3669) --> . John went to the
2025-01-22 16:57:40.148 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John grabbed the apple.
2025-01-22 16:57:40.155 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1277, 1281) -->  John grabbed the apple
2025-01-22 16:57:40.155 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the kitchen.
2025-01-22 16:57:40.178 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2165, 2171) --> . Daniel went back to the
2025-01-22 16:57:40.178 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the bedroom.
2025-01-22 16:57:40.215 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7029, 7035) --> . John went back to the
2025-01-22 16:57:40.215 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel journeyed to the hallway.
2025-01-22 16:57:40.219 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (857, 863) --> . Daniel journeyed to the
2025-01-22 16:57:40.219 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel went back to the bathroom.
2025-01-22 16:57:40.230 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (2165, 2171) --> . Daniel went back to the
2025-01-22 16:57:40.231 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Mary took the milk.
2025-01-22 16:57:40.273 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (4705, 4709) -->  Mary took the milk
2025-01-22 16:57:40.274 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 16:57:40.274 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 16:57:40.274 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 16:57:40.274 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ’³', 'ğŸ†', 'ğŸ› ', 'ğŸ‘©ğŸ¾\u200dâ¤\u200dğŸ‘©ğŸ¼', 'ğŸšœ', 'ğŸ©¹', 'â–«', 'â›”', 'ğŸ’‚ğŸ»\u200dâ™‚', 'ğŸŒ\u200dâ™‚ï¸']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.89s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.74s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.57s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.16s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.72s/it]
Processing depth (1, 4, 5, 9):   0%|          | 0/100 [00:34<?, ?it/s]2025-01-22 16:57:57.155 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra got the apple.
2025-01-22 16:57:57.159 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (814, 818) -->  Sandra got the apple
2025-01-22 16:57:57.159 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the kitchen.
2025-01-22 16:57:57.180 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3635, 3640) --> . Sandra moved to the
2025-01-22 16:57:57.180 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the garden.
2025-01-22 16:57:57.203 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4216, 4222) -->  Sandra went back to the garden
2025-01-22 16:57:57.203 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary journeyed to the garden.
2025-01-22 16:57:57.240 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7124, 7130) -->  Mary journeyed to the garden
2025-01-22 16:57:57.240 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went to the kitchen.
2025-01-22 16:57:57.262 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3789, 3794) --> . John went to the
2025-01-22 16:57:57.262 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John grabbed the apple.
2025-01-22 16:57:57.270 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1394, 1398) -->  John grabbed the apple
2025-01-22 16:57:57.270 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the kitchen.
2025-01-22 16:57:57.283 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2474, 2480) --> . Daniel went back to the
2025-01-22 16:57:57.283 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the bedroom.
2025-01-22 16:57:57.319 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7078, 7084) --> . John went back to the
2025-01-22 16:57:57.319 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel journeyed to the hallway.
2025-01-22 16:57:57.324 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (904, 910) --> . Daniel journeyed to the
2025-01-22 16:57:57.324 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel went back to the bathroom.
2025-01-22 16:57:57.343 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (2474, 2480) --> . Daniel went back to the
2025-01-22 16:57:57.343 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Mary took the milk.
2025-01-22 16:57:57.368 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (4723, 4727) -->  Mary took the milk
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 16:57:58.266 | INFO     | test_jbb_embedding:begin_test:693 - Sandra got the apple.<|eot_id|>
2025-01-22 16:57:58.267 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8166])
2025-01-22 16:58:00.536 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [553.9107142857143, 43.79978807075529, 212.6875, 41.7086556836395, 24.18329067887931], 'topk_indices': array([8054, 4222,  814,   14, 8152, 8148, 8150,  817, 8149, 8151, 8155,
        818, 8153, 8064, 8161, 8157, 8156, 8154,    0, 8162]), 'topk_tokens': ['.\n\n', '.', ' Sandra', '\n', ' the', 'Question', ' Where', ' apple', ':', ' was', ' the', '.', ' apple', ' location', '<|eot_id|>', '?', ' garden', ' before', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [1067.75, 561.65, 445.8333333333333, 312.9791666666667]}, 'weight': {'score': [24.488467261904763, 23.26522906720529, 21.600929054054053, 23.269654057761066, 29.993265086206897], 'topk_indices': array([3253, 3280, 3173, 3125, 7415, 7453, 1420, 1482, 4293, 4309, 5186,
       5125, 7136, 7192, 3456, 3482, 4950, 4902, 4979, 4927]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.095703125, 21.040625, 25.631510416666668, 23.813802083333332]}, 'saliency': {'score': [3.5051385788690474, 0.24311612498469826, 1.2256898622255068, 0.23018828627067023, 0.1844740242793642], 'topk_indices': array([2480, 8147, 8054, 4221, 8060,  815, 8063, 3637,  910, 8020, 8151,
       8150, 8148,  814,  817, 8157, 8064, 8153, 8154, 8156]), 'topk_tokens': [' bathroom', '.\n\n', '.\n\n', ' garden', ' item', ' got', ' first', ' moved', ' hallway', ' context', ' was', ' Where', 'Question', ' Sandra', ' apple', '?', ' location', ' apple', ' before', ' garden'], 'evidence_proportions': [7.783203125, 3.1044921875, 2.7237955729166665, 1.768310546875]}}, 'pred_res': 'Sandra got the apple.<|eot_id|>', 'score': 0}
2025-01-22 16:58:00.543 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 16:58:00.544 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-22_pid-0_1-4-5-9.pkl | len: 3 |  size: 2.01 KB
Processing depth (1, 4, 5, 9):   1%|          | 1/100 [00:38<1:02:56, 38.15s/it]is_0k: False
your chose emoji: ['ğŸ‘®ğŸ¾\u200dâ™€', 'ğŸ§ğŸ¾\u200dâ™‚ï¸', 'ğŸ’‡', 'â†—ï¸', 'ğŸ„\u200dâ™‚ï¸', 'ğŸ™‡ğŸ¼', 'ğŸ‘©ğŸ»\u200dğŸ¦³', 'ğŸ¤Œ', 'â›©ï¸', 'ğŸ‘ğŸ¿']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.68s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.07s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.89s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.42s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.97s/it]
Processing depth (1, 5, 6, 7):   1%|          | 1/100 [00:55<1:02:56, 38.15s/it]2025-01-22 16:58:18.253 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra got the apple.
2025-01-22 16:58:18.257 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (814, 818) -->  Sandra got the apple
2025-01-22 16:58:18.258 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the kitchen.
2025-01-22 16:58:18.281 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4149, 4154) --> . Sandra moved to the
2025-01-22 16:58:18.281 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the garden.
2025-01-22 16:58:18.319 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4722, 4728) --> . Sandra went back to the
2025-01-22 16:58:18.319 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary journeyed to the garden.
2025-01-22 16:58:18.354 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5615, 5621) --> . Mary journeyed to the
2025-01-22 16:58:18.354 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went to the kitchen.
2025-01-22 16:58:18.376 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3640, 3645) -->  John went to the kitchen
2025-01-22 16:58:18.376 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John grabbed the apple.
2025-01-22 16:58:18.385 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1394, 1398) -->  John grabbed the apple
2025-01-22 16:58:18.385 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the kitchen.
2025-01-22 16:58:18.399 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2474, 2480) --> . Daniel went back to the
2025-01-22 16:58:18.399 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the bedroom.
2025-01-22 16:58:18.442 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7113, 7119) --> . John went back to the
2025-01-22 16:58:18.442 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel journeyed to the hallway.
2025-01-22 16:58:18.447 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (904, 910) --> . Daniel journeyed to the
2025-01-22 16:58:18.447 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel went back to the bathroom.
2025-01-22 16:58:18.461 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (2474, 2480) --> . Daniel went back to the
2025-01-22 16:58:18.461 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Mary took the milk.
2025-01-22 16:58:18.495 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (4619, 4623) -->  took the milk.
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 16:58:19.284 | INFO     | test_jbb_embedding:begin_test:693 - Sandra's<|eot_id|>
2025-01-22 16:58:19.284 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8218])
2025-01-22 16:58:21.528 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [332.0208333333333, 33.502710284636905, 173.99788851351352, 32.09793236248928, 19.039132254464285], 'topk_indices': array([5622,   14, 8106, 8199, 8204, 8202,  817,  818, 8200, 8201, 8213,
       8203, 8205, 8116, 8207, 8214, 8209, 8208, 8206,    0]), 'topk_tokens': ['.', '\n', '.\n\n', '.\n\n', ' the', ' Where', ' apple', '.', 'Question', ':', '<|eot_id|>', ' was', ' apple', ' location', ' the', '<|start_header_id|>', '?', ' garden', ' before', '<|begin_of_text|>'], 'evidence_proportions': [769.0, 130.8375, 217.16666666666666, 323.2083333333333]}, 'weight': {'score': [22.33891369047619, 23.303340910473178, 21.622888513513512, 23.31343887816979, 29.775669642857142], 'topk_indices': array([3285, 3312, 3205, 3157, 7509, 7471, 1482, 1420, 4308, 4292, 5197,
       5258, 7248, 7192, 3478, 3504, 4963, 5015, 4986, 4938]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.095703125, 21.040625, 21.869791666666668, 20.052083333333332]}, 'saliency': {'score': [1.9979771205357142, 0.18650719313533937, 1.0274245803420607, 0.1780354533580447, 0.14032545543852307], 'topk_indices': array([2480, 8201,  815, 8115,  910, 8106, 8112, 8199,  145, 8072, 8203,
       8202,  814,  817, 8116, 8200, 8209, 8205, 8206, 8208]), 'topk_tokens': [' bathroom', ':', ' got', ' first', ' hallway', '.\n\n', ' item', '.\n\n', 'ï¿½ï¿½', ' context', ' was', ' Where', ' Sandra', ' apple', ' location', 'Question', '?', ' apple', ' before', ' garden'], 'evidence_proportions': [5.60498046875, 0.761083984375, 1.0642496744791667, 1.5577799479166667]}}, 'pred_res': "Sandra's<|eot_id|>", 'score': 0}
2025-01-22 16:58:21.538 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 16:58:21.538 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-22_pid-1_1-5-6-7.pkl | len: 3 |  size: 1.99 KB
Processing depth (1, 5, 6, 7):   2%|â–         | 2/100 [00:59<45:49, 28.06s/it]  is_0k: False
your chose emoji: ['ğŸ‘¨ğŸ¿\u200dğŸ¤\u200dğŸ‘¨ğŸ½', 'ğŸ’‚ğŸ½', 'ğŸ¼', 'ğŸ§ğŸ¾', 'ğŸ§ğŸ¿\u200dâ™‚\u200dâ¡ï¸', 'ğŸ‘©ğŸ»\u200dâ¤\u200dğŸ’‹\u200dğŸ‘©ğŸ¿', 'ğŸ¥©', 'ğŸª', 'ğŸ§ğŸ¼\u200dâ™‚ï¸\u200dâ¡ï¸', 'ğŸš ']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.67s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.16s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:15<00:05,  5.13s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  3.54s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  4.09s/it]
Processing depth (3, 4, 6, 7):   2%|â–         | 2/100 [01:17<45:49, 28.06s/it]2025-01-22 16:58:39.696 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra got the apple.
2025-01-22 16:58:39.726 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2841, 2845) -->  Sandra got the apple
2025-01-22 16:58:39.736 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the kitchen.
2025-01-22 16:58:39.759 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3567, 3572) --> . Sandra moved to the
2025-01-22 16:58:39.759 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the garden.
2025-01-22 16:58:39.785 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4766, 4772) -->  the senate. Sandra went back
2025-01-22 16:58:39.785 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary journeyed to the garden.
2025-01-22 16:58:39.824 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5723, 5729) --> . Mary journeyed to the
2025-01-22 16:58:39.824 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went to the kitchen.
2025-01-22 16:58:39.855 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3646, 3651) -->  Hon. John went to
2025-01-22 16:58:39.856 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John grabbed the apple.
2025-01-22 16:58:39.865 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1391, 1395) -->  John grabbed the apple
2025-01-22 16:58:39.865 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the kitchen.
2025-01-22 16:58:39.882 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2157, 2163) -->  went back to the bathroom.
2025-01-22 16:58:39.882 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the bedroom.
2025-01-22 16:58:39.921 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7096, 7102) -->  John went back to the bedroom
2025-01-22 16:58:39.922 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel journeyed to the hallway.
2025-01-22 16:58:39.926 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (959, 965) --> . Daniel journeyed to the
2025-01-22 16:58:39.927 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel went back to the bathroom.
2025-01-22 16:58:39.937 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (2156, 2162) -->  Daniel went back to the bathroom
2025-01-22 16:58:39.937 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Mary took the milk.
2025-01-22 16:58:39.966 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (4708, 4712) -->  Mary took the milk
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 16:58:40.758 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 16:58:40.758 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8190])
2025-01-22 16:58:42.990 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [54.802455357142854, 11.235016744476992, 66.27164273648648, 10.87222985172096, 18.178362165178573], 'topk_indices': array([3572, 8163,    1, 8043,    9, 8173, 8088, 8189, 8178,   24, 8078,
         23, 8184, 8044,   28,   14, 8188, 8185, 8186,    0]), 'topk_tokens': [' kitchen', '.', '<|start_header_id|>', ' you', ':', ':', ' location', '\n\n', ' before', '\n\n', '.\n\n', '4', ':', ' context', '<|end_header_id|>', '\n', '<|end_header_id|>', '<|eot_id|>', '<|start_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [96.9296875, 67.29375, 19.91015625, 51.200520833333336]}, 'weight': {'score': [23.464657738095237, 23.270123886244356, 23.86085304054054, 23.266934926244623, 29.126339285714284], 'topk_indices': array([3330, 3303, 3175, 3223, 7423, 7461, 1497, 1435, 4294, 4310, 5178,
       5117, 7108, 7164, 3486, 3512, 4919, 4894, 4971, 4942]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.095703125, 21.040625, 25.809895833333332, 20.052083333333332]}, 'saliency': {'score': [0.3437245686848958, 0.06261262412940162, 0.41922244510135137, 0.06026500099336874, 0.13496300833565847], 'topk_indices': array([8189, 8187, 1403, 8042,    8, 8043,   24, 8162, 8177, 8159,   20,
       8078,   23, 8183, 8172, 8180, 8088, 3572, 8178, 8044]), 'topk_tokens': ['\n\n', 'assistant', 'ï¿½', ' provided', ' Date', ' you', '\n\n', ' directly', ' apple', ' return', ' Jul', '.\n\n', '4', 'Answer', 'Question', ' garden', ' location', ' kitchen', ' before', ' context'], 'evidence_proportions': [0.7379150390625, 0.3634765625, 0.1316858927408854, 0.2765096028645833]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 100}
2025-01-22 16:58:43.002 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 16:58:43.002 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-22_pid-2_3-4-6-7.pkl | len: 3 |  size: 2.02 KB
Processing depth (3, 4, 6, 7):   3%|â–         | 3/100 [01:20<40:29, 25.05s/it]is_0k: False
your chose emoji: ['ğŸ„', 'ğŸ¤ğŸ¼', 'ğŸ‘¨\u200dğŸ’»', 'ğŸ‡§ğŸ‡¹', 'ğŸ°', 'ğŸ¤ŒğŸ¼', 'ğŸ•µğŸ¾\u200dâ™‚', 'ğŸ‘©ğŸ¾\u200dâ¤\u200dğŸ’‹\u200dğŸ‘©ğŸ½', 'ğŸ¤©', 'ğŸ§‘ğŸ¿\u200dğŸ“']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.08s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.39s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.35s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.03s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.50s/it]
Processing depth (0, 2, 8, 9):   3%|â–         | 3/100 [01:36<40:29, 25.05s/it]2025-01-22 16:58:58.784 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra got the apple.
2025-01-22 16:58:58.830 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the kitchen.
2025-01-22 16:58:58.841 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1865, 1870) --> . Sandra moved to the
2025-01-22 16:58:58.842 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the garden.
2025-01-22 16:58:58.875 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6650, 6656) --> . Sandra went back to the
2025-01-22 16:58:58.875 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary journeyed to the garden.
2025-01-22 16:58:58.918 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7236, 7242) --> . Mary journeyed to the
2025-01-22 16:58:58.918 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went to the kitchen.
2025-01-22 16:58:58.938 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3790, 3795) --> . John went to the
2025-01-22 16:58:58.938 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John grabbed the apple.
2025-01-22 16:58:58.945 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1403, 1407) -->  John grabbed the apple
2025-01-22 16:58:58.945 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the kitchen.
2025-01-22 16:58:58.958 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2489, 2495) --> . Daniel went back to the
2025-01-22 16:58:58.958 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the bedroom.
2025-01-22 16:58:58.997 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7086, 7092) -->  John went back to the bedroom
2025-01-22 16:58:58.997 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel journeyed to the hallway.
2025-01-22 16:58:59.002 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (913, 919) --> . Daniel journeyed to the
2025-01-22 16:58:59.003 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel went back to the bathroom.
2025-01-22 16:58:59.015 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (2489, 2495) --> . Daniel went back to the
2025-01-22 16:58:59.015 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Mary took the milk.
2025-01-22 16:58:59.038 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (4787, 4791) -->  Mary took the milk
2025-01-22 16:58:59.038 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 16:58:59.039 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 16:58:59.039 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 16:58:59.039 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['â™¨ï¸', 'ğŸ‘§ğŸ½', 'ğŸ¤²ğŸ¿', 'ğŸ§‘\u200dğŸ¦½\u200dâ¡', 'ğŸ§½', '\U0001fac5ğŸ¿', 'ğŸ‘©ğŸ½\u200dğŸ“', 'ğŸ‘©ğŸ¼\u200dâ¤ï¸\u200dğŸ‘¨ğŸ»', 'âœ‚ï¸', 'âš½']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.70s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.78s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.75s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.28s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.82s/it]
Processing depth (2, 3, 4, 8):   3%|â–         | 3/100 [01:53<40:29, 25.05s/it]2025-01-22 16:59:16.133 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra got the apple.
2025-01-22 16:59:16.142 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1790, 1794) -->  Sandra got the apple
2025-01-22 16:59:16.142 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the kitchen.
2025-01-22 16:59:16.156 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2893, 2898) --> . Sandra moved to the
2025-01-22 16:59:16.156 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the garden.
2025-01-22 16:59:16.174 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3626, 3632) -->  Hon. Sandra went back to
2025-01-22 16:59:16.175 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary journeyed to the garden.
2025-01-22 16:59:16.208 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6518, 6524) --> . Mary journeyed to the
2025-01-22 16:59:16.208 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went to the kitchen.
2025-01-22 16:59:16.226 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3671, 3676) -->  John went to the kitchen
2025-01-22 16:59:16.226 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John grabbed the apple.
2025-01-22 16:59:16.233 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1281, 1285) -->  John grabbed the apple
2025-01-22 16:59:16.233 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the kitchen.
2025-01-22 16:59:16.245 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2398, 2404) --> . Daniel went back to the
2025-01-22 16:59:16.245 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the bedroom.
2025-01-22 16:59:16.286 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7081, 7087) --> . John went back to the
2025-01-22 16:59:16.286 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel journeyed to the hallway.
2025-01-22 16:59:16.290 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (823, 829) --> . Daniel journeyed to the
2025-01-22 16:59:16.290 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel went back to the bathroom.
2025-01-22 16:59:16.302 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (2398, 2404) --> . Daniel went back to the
2025-01-22 16:59:16.303 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Mary took the milk.
2025-01-22 16:59:16.325 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (4723, 4727) -->  Mary took the milk
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 16:59:17.116 | INFO     | test_jbb_embedding:begin_test:693 - The hallway.<|eot_id|>
2025-01-22 16:59:17.116 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8192])
2025-01-22 16:59:19.342 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [156.98809523809524, 25.575684487492374, 148.33065878378378, 24.678351972471425, 22.558552486795776], 'topk_indices': array([  24, 8180, 1252, 1285,   23, 1244, 1265, 8080, 8090, 1251, 1266,
       8188, 8046, 1575, 1264, 8186,   14, 8190, 8187,    0]), 'topk_tokens': ['\n\n', ' before', ' which', '.', '4', 'pend', 'ex', '.\n\n', ' location', ' with', 'pend', '<|start_header_id|>', ' context', ' part', '\n', ':', '\n', '<|end_header_id|>', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [276.1875, 155.775, 153.11458333333334, 82.40625]}, 'weight': {'score': [23.483630952380953, 23.262309334960342, 22.24809966216216, 23.266349890930318, 28.59286971830986], 'topk_indices': array([3289, 3316, 3161, 3209, 7439, 7477, 1487, 1425, 4293, 4309, 5214,
       5153, 7160, 7216, 3472, 3498, 4978, 4943, 4918, 5007]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.095703125, 21.040625, 25.876302083333332, 20.052083333333332]}, 'saliency': {'score': [0.9981398809523809, 0.1426393463525778, 0.8798621925147804, 0.13707921896722725, 0.15934345084176937], 'topk_indices': array([ 825, 1251, 1169, 1252, 8182, 8180, 1282,  257, 8174, 1245, 1265,
       8185, 1790, 1284, 8090, 1575,  829, 1244, 8046, 1266]), 'topk_tokens': [' journey', ' with', 'nes', ' which', ' garden', ' before', ' grabbed', 'hue', 'Question', 'iture', 'ex', 'Answer', ' Sandra', ' apple', ' location', ' part', ' hallway', 'pend', ' context', 'pend'], 'evidence_proportions': [2.1094970703125, 0.8744140625, 0.9295247395833334, 0.428955078125]}}, 'pred_res': 'The hallway.<|eot_id|>', 'score': 0}
2025-01-22 16:59:19.357 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 16:59:19.357 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-22_pid-3_2-3-4-8.pkl | len: 3 |  size: 2.0 KB
Processing depth (2, 3, 4, 8):   4%|â–         | 4/100 [01:56<47:13, 29.51s/it]is_0k: False
your chose emoji: ['ğŸ£', 'ğŸ‘·ğŸ¼\u200dâ™€', 'ğŸ§œğŸ¼\u200dâ™€', '8âƒ£', 'ğŸ‘©ğŸ¾\u200dğŸ¦¯', 'ğŸ‘¨ğŸ»\u200dğŸ¤\u200dğŸ‘¨ğŸ¿', 'ğŸ‡­ğŸ‡³', 'ğŸ‘©ğŸ¼', 'ğŸ©²', 'ğŸ§”ğŸ½']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:05<00:15,  5.16s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.11s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.68s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.27s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.88s/it]
Processing depth (3, 6, 8, 9):   4%|â–         | 4/100 [02:14<47:13, 29.51s/it]2025-01-22 16:59:36.855 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra got the apple.
2025-01-22 16:59:36.871 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2989, 2993) -->  Sandra got the apple
2025-01-22 16:59:36.871 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the kitchen.
2025-01-22 16:59:36.899 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4753, 4758) -->  Sandra moved to the kitchen
2025-01-22 16:59:36.899 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the garden.
2025-01-22 16:59:36.938 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6627, 6633) --> . Sandra went back to the
2025-01-22 16:59:36.939 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary journeyed to the garden.
2025-01-22 16:59:36.979 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7237, 7243) --> . Mary journeyed to the
2025-01-22 16:59:36.979 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went to the kitchen.
2025-01-22 16:59:37.001 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3783, 3788) --> . John went to the
2025-01-22 16:59:37.001 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John grabbed the apple.
2025-01-22 16:59:37.008 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1405, 1409) -->  John grabbed the apple
2025-01-22 16:59:37.008 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the kitchen.
2025-01-22 16:59:37.021 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2485, 2491) --> . Daniel went back to the
2025-01-22 16:59:37.021 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the bedroom.
2025-01-22 16:59:37.063 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7086, 7092) --> . John went back to the
2025-01-22 16:59:37.063 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel journeyed to the hallway.
2025-01-22 16:59:37.069 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (959, 965) --> . Daniel journeyed to the
2025-01-22 16:59:37.069 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel went back to the bathroom.
2025-01-22 16:59:37.084 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (2485, 2491) --> . Daniel went back to the
2025-01-22 16:59:37.084 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Mary took the milk.
2025-01-22 16:59:37.109 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (4742, 4746) -->  Mary took the milk
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 16:59:37.960 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 16:59:37.961 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8190])
2025-01-22 16:59:41.614 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [72.58705357142857, 16.881356417063348, 123.47107263513513, 16.25275910417947, 9.764997209821429], 'topk_indices': array([2142, 8177,    1, 8078, 8173, 8184, 8088, 8044, 8181,   24,   23,
       8180,   28, 3784,   14, 8178, 8186, 8188,    0, 8185]), 'topk_tokens': ['ast', ' apple', '<|start_header_id|>', '.\n\n', ':', ':', ' location', ' context', '?', '\n\n', '4', ' garden', '<|end_header_id|>', ' John', '\n', ' before', '<|start_header_id|>', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [119.40625, 51.0875, 63.020833333333336, 68.85677083333333]}, 'weight': {'score': [23.479166666666668, 23.282007124984744, 21.600929054054053, 23.289144130301167, 29.821651785714284], 'topk_indices': array([3269, 3296, 3189, 3141, 7417, 7455, 1493, 1431, 4292, 4276, 5156,
       5217, 7187, 7131, 3478, 3452, 5010, 4958, 4981, 4933]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.095703125, 25.8296875, 21.869791666666668, 20.052083333333332]}, 'saliency': {'score': [0.4411737351190476, 0.09360828490451072, 0.7118579761402027, 0.08989911305076444, 0.07267930167061942], 'topk_indices': array([3760, 8159, 2141, 8078, 8181,   23, 1408,   20, 8183, 8174, 2142,
       3788, 8172,  965, 8088, 8177, 8044, 3784, 8180, 8178]), 'topk_tokens': [' St', ' return', 're', '.\n\n', '?', '4', ' apple', ' Jul', 'Answer', ' Where', 'ast', ' kitchen', 'Question', ' hallway', ' location', ' apple', ' context', ' John', ' garden', ' before'], 'evidence_proportions': [0.88140869140625, 0.3417724609375, 0.3593343098958333, 0.3123575846354167]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 100}
2025-01-22 16:59:41.626 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 16:59:41.626 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-22_pid-4_3-6-8-9.pkl | len: 3 |  size: 2.02 KB
Processing depth (3, 6, 8, 9):   5%|â–Œ         | 5/100 [02:19<42:35, 26.90s/it]Processing depth (3, 6, 8, 9):   5%|â–Œ         | 5/100 [02:19<44:07, 27.87s/it]
2025-01-22 16:59:41.735 | INFO     | __main__:<module>:82 - Selected idx: 24
2025-01-22 16:59:41.735 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the football before the office? 
2025-01-22 16:59:41.735 | INFO     | __main__:<module>:84 - Answer: kitchen
2025-01-22 16:59:41.735 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 16:59:41.735 | INFO     | __main__:<module>:86 - Needle: [' John went to the kitchen.', ' Mary grabbed the football.', ' Daniel went back to the bathroom.', ' John went back to the bedroom.', ' Mary went to the kitchen.', ' John grabbed the football.', ' Daniel journeyed to the hallway.', ' Mary travelled to the office.', ' John left the football.']
2025-01-22 16:59:41.735 | INFO     | __main__:<module>:87 - Real Needle: [' Mary grabbed the football.', ' Mary went to the kitchen.', ' Mary travelled to the office.', ' John left the football.']
2025-01-22 16:59:41.735 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['â—', 'ğŸ¦', 'ğŸ§‘ğŸ¼\u200dğŸ«', 'ğŸ¦¹ğŸ¿\u200dâ™‚', 'ğŸ‘·ğŸ¿\u200dâ™‚ï¸', 'ğŸ¤¦\u200dâ™‚ï¸', 'â˜¦', 'â™', 'ğŸ‘¨ğŸ¾\u200dâ¤ï¸\u200dğŸ‘¨ğŸ¿', 'ğŸ§ğŸ¾\u200dâ™‚']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.72s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.14s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.72s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.05s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.72s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (4, 7, 8, 9):   0%|          | 0/100 [00:16<?, ?it/s]2025-01-22 16:59:58.536 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the football.
2025-01-22 16:59:58.558 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3718, 3722) -->  Mary grabbed the football
2025-01-22 16:59:58.559 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went to the kitchen.
2025-01-22 16:59:58.572 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2454, 2459) -->  John went to the kitchen
2025-01-22 16:59:58.572 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary travelled to the office.
2025-01-22 16:59:58.610 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6648, 6653) --> . Mary travelled to the
2025-01-22 16:59:58.610 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John left the football.
2025-01-22 16:59:58.651 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7277, 7281) -->  John left the football
2025-01-22 16:59:58.651 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went to the kitchen.
2025-01-22 16:59:58.664 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2453, 2458) --> . John went to the
2025-01-22 16:59:58.664 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went back to the bathroom.
2025-01-22 16:59:58.685 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3411, 3417) -->  Daniel went back to the bathroom
2025-01-22 16:59:58.685 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the bedroom.
2025-01-22 16:59:58.716 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4938, 4944) -->  John went back to the bedroom
2025-01-22 16:59:58.716 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John grabbed the football.
2025-01-22 16:59:58.729 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2460, 2464) -->  John grabbed the football
2025-01-22 16:59:58.729 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel journeyed to the hallway.
2025-01-22 16:59:58.755 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4272, 4278) --> . Daniel journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:00:01.643 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 17:00:01.644 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8193])
2025-01-22 17:00:04.530 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [170.07638888888889, 15.049499184053197, 131.50115740740742, 14.321407074285364, 14.91453223892405], 'topk_indices': array([8081,   23, 5667, 8180, 8176,   24, 4274, 8192, 8187, 8174, 6650,
         14, 8189, 8184, 8181, 5671, 8191, 8183,    0, 8188]), 'topk_tokens': ['.\n\n', '4', ' Mary', ' football', ':', '\n\n', ' journey', '\n\n', ':', '.\n\n', ' travelled', '\n', '<|start_header_id|>', '?', ' before', ' kitchen', '<|end_header_id|>', ' office', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [120.84375, 118.5625, 306.675, 112.953125]}, 'weight': {'score': [24.221788194444443, 23.297589906661788, 23.17042824074074, 23.29597020304257, 29.904074367088608], 'topk_indices': array([3263, 3236, 3156, 3108, 7462, 7424, 1399, 1461, 4300, 4284, 5211,
       5150, 7168, 7112, 3434, 3460, 4872, 4897, 4963, 4992]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.263671875, 23.4265625, 20.75625, 25.505859375]}, 'saliency': {'score': [1.1034884982638888, 0.08357673671083837, 0.7958848741319444, 0.0789649428918806, 0.11107065707822389], 'topk_indices': array([6649,   20,   23, 8081, 4278, 8192, 8162, 8177, 8174, 8091, 8186,
       8184, 8175, 5667, 8180, 4274, 8181, 6650, 8183, 5671]), 'topk_tokens': [' Mary', ' Jul', '4', '.\n\n', ' hallway', '\n\n', ' return', ' Where', '.\n\n', ' location', 'Answer', '?', 'Question', ' Mary', ' football', ' journey', ' before', ' travelled', ' office', ' kitchen'], 'evidence_proportions': [0.8948974609375, 0.77841796875, 1.86943359375, 0.760986328125]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 100}
2025-01-22 17:00:04.537 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:00:04.538 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-24_pid-0_4-7-8-9.pkl | len: 3 |  size: 2.01 KB
Processing depth (4, 7, 8, 9):   1%|          | 1/100 [00:22<37:27, 22.70s/it]is_0k: False
your chose emoji: ['ğŸ™ï¸', 'ğŸ™…ğŸ»\u200dâ™€ï¸', 'ğŸš¶ğŸ¾\u200dâ™€', 'ğŸ§‘ğŸ»\u200dğŸ¦¯\u200dâ¡ï¸', 'ğŸ§™\u200dâ™€ï¸', 'ğŸ›’', 'ğŸ’¦', 'ğŸ‘©ğŸ¿\u200dâ¤\u200dğŸ’‹\u200dğŸ‘©ğŸ»', 'ğŸš£ğŸ¾\u200dâ™‚', 'ğŸ§•ğŸ¼']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.75s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:10,  5.02s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.90s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.38s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.94s/it]
Processing depth (0, 2, 3, 8):   1%|          | 1/100 [00:41<37:27, 22.70s/it]2025-01-22 17:00:22.954 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the football.
2025-01-22 17:00:22.993 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went to the kitchen.
2025-01-22 17:00:23.002 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1776, 1781) --> . Mary went to the
2025-01-22 17:00:23.002 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary travelled to the office.
2025-01-22 17:00:23.019 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2927, 2932) --> . Mary travelled to the
2025-01-22 17:00:23.019 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John left the football.
2025-01-22 17:00:23.056 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6583, 6587) -->  John left the football
2025-01-22 17:00:23.056 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went to the kitchen.
2025-01-22 17:00:23.066 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1777, 1782) -->  Mary went to the kitchen
2025-01-22 17:00:23.066 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went back to the bathroom.
2025-01-22 17:00:23.083 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3313, 3319) --> . Daniel went back to the
2025-01-22 17:00:23.083 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the bedroom.
2025-01-22 17:00:23.107 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4889, 4895) -->  the senate. John went back
2025-01-22 17:00:23.108 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John grabbed the football.
2025-01-22 17:00:23.118 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2183, 2187) -->  John grabbed the football
2025-01-22 17:00:23.118 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel journeyed to the hallway.
2025-01-22 17:00:23.142 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4250, 4256) --> . Daniel journeyed to the
2025-01-22 17:00:23.142 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 17:00:23.142 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 17:00:23.142 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 17:00:23.142 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ‘©ğŸ»\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘©ğŸ½', 'ğŸš¶ğŸ¼\u200dâ™‚ï¸', 'ğŸ‘©ğŸ¾\u200dâ¤ï¸\u200dğŸ‘¨ğŸ»', 'ğŸ‘©ğŸ»\u200dğŸš€', 'ğŸ•µğŸ»\u200dâ™€ï¸', 'ğŸ‘©ğŸ¼\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘¨ğŸ¼', 'ğŸ‹ğŸ¾\u200dâ™€ï¸', 'ğŸ‡±ğŸ‡®', 'ğŸ˜º', 'ğŸ‘¦']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.86s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.09s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.79s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.24s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.85s/it]
Processing depth (0, 1, 5, 8):   1%|          | 1/100 [00:58<37:27, 22.70s/it]2025-01-22 17:00:40.478 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the football.
2025-01-22 17:00:40.520 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went to the kitchen.
2025-01-22 17:00:40.524 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (900, 905) --> . Mary went to the
2025-01-22 17:00:40.524 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary travelled to the office.
2025-01-22 17:00:40.545 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4168, 4173) --> . Mary travelled to the
2025-01-22 17:00:40.545 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John left the football.
2025-01-22 17:00:40.577 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6647, 6651) -->  John left the football
2025-01-22 17:00:40.577 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went to the kitchen.
2025-01-22 17:00:40.582 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (901, 906) -->  Mary went to the kitchen
2025-01-22 17:00:40.582 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went back to the bathroom.
2025-01-22 17:00:40.599 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3315, 3321) --> . Daniel went back to the
2025-01-22 17:00:40.599 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the bedroom.
2025-01-22 17:00:40.624 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4935, 4941) --> . John went back to the
2025-01-22 17:00:40.624 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John grabbed the football.
2025-01-22 17:00:40.635 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2211, 2215) -->  John grabbed the football
2025-01-22 17:00:40.635 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel journeyed to the hallway.
2025-01-22 17:00:40.657 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4241, 4247) -->  Daniel journeyed to the hallway
2025-01-22 17:00:40.657 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 17:00:40.657 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 17:00:40.657 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 17:00:40.657 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ‘±ğŸ»\u200dâ™‚', 'ğŸ¦¢', 'ğŸ§ğŸ»\u200dâ™€ï¸', 'ğŸ‡²ğŸ‡°', 'ğŸ¥©', 'â˜„', 'ğŸ§ˆ', 'ğŸ‘©ğŸ½\u200dâ¤\u200dğŸ’‹\u200dğŸ‘¨ğŸ¾', 'ğŸ‡¸ğŸ‡®', 'ğŸ§‘ğŸ»\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ§‘ğŸ¿']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.33s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.59s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.58s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.23s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.71s/it]
Processing depth (2, 3, 5, 9):   1%|          | 1/100 [01:15<37:27, 22.70s/it]2025-01-22 17:00:57.260 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the football.
2025-01-22 17:00:57.270 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1842, 1846) -->  Mary grabbed the football
2025-01-22 17:00:57.270 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went to the kitchen.
2025-01-22 17:00:57.282 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2379, 2384) -->  John went to the kitchen
2025-01-22 17:00:57.282 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary travelled to the office.
2025-01-22 17:00:57.303 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4191, 4196) -->  Mary travelled to the office
2025-01-22 17:00:57.303 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John left the football.
2025-01-22 17:00:57.337 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7212, 7216) -->  John left the football
2025-01-22 17:00:57.337 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went to the kitchen.
2025-01-22 17:00:57.349 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2378, 2383) --> . John went to the
2025-01-22 17:00:57.349 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went back to the bathroom.
2025-01-22 17:00:57.366 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3261, 3267) --> . Daniel went back to the
2025-01-22 17:00:57.366 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the bedroom.
2025-01-22 17:00:57.390 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4887, 4893) --> . John went back to the
2025-01-22 17:00:57.390 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John grabbed the football.
2025-01-22 17:00:57.402 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2385, 2389) -->  John grabbed the football
2025-01-22 17:00:57.402 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel journeyed to the hallway.
2025-01-22 17:00:57.424 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4233, 4239) -->  Daniel journeyed to the hallway
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:00:58.223 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 17:00:58.224 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8166])
2025-01-22 17:01:00.433 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [130.02951388888889, 14.60598279318154, 49.152199074074076, 14.235429937530773, 16.00192353219697], 'topk_indices': array([7533, 8165, 7294, 7488,   24, 8054,   23,    9, 7264, 7489, 7293,
       7341,   14, 8164, 8161,    0, 7534, 7535, 7490, 7342]), 'topk_tokens': [' the', '\n\n', 'ot', ' the', '\n\n', '.\n\n', '4', ':', 'nes', ' Min', 'nes', ' Min', '\n', '<|end_header_id|>', '<|eot_id|>', '<|begin_of_text|>', ' Min', 'nes', 'nes', 'nes'], 'evidence_proportions': [197.859375, 130.625, 86.95625, 115.296875]}, 'weight': {'score': [25.336805555555557, 23.270399146162323, 22.24074074074074, 23.26924275295421, 28.74313446969697], 'topk_indices': array([3305, 3278, 3191, 3143, 7427, 7389, 1467, 1405, 4320, 4336, 5199,
       5138, 7105, 7161, 3487, 3461, 4992, 4963, 4940, 4915]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.263671875, 23.4265625, 24.7703125, 25.505859375]}, 'saliency': {'score': [0.9000990125868056, 0.08247385014517536, 0.29112978334780093, 0.07996880790977158, 0.10379351991595644], 'topk_indices': array([   8, 8054,   23, 2924, 8153,   20, 8159, 7294, 7421, 8064, 2383,
       1845, 7264, 7293, 7489, 7341, 7534, 7535, 7342, 7490]), 'topk_tokens': [' Date', '.\n\n', '4', ' kitchen', ' football', ' Jul', 'Answer', 'ot', 'nes', ' location', ' kitchen', ' football', 'nes', 'nes', ' Min', ' Min', ' Min', 'nes', 'nes', 'nes'], 'evidence_proportions': [1.45709228515625, 0.87666015625, 0.5632568359375, 0.79345703125]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 100}
2025-01-22 17:01:00.442 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:01:00.442 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-24_pid-1_2-3-5-9.pkl | len: 3 |  size: 1.95 KB
Processing depth (2, 3, 5, 9):   2%|â–         | 2/100 [01:18<1:08:58, 42.23s/it]is_0k: False
your chose emoji: ['ğŸ‘¸', 'ğŸ', 'âœ‹ğŸ¾', 'ğŸ‘¨ğŸ¾\u200dâ¤\u200dğŸ’‹\u200dğŸ‘¨ğŸ»', 'ğŸ‘©ğŸ½\u200dâ¤\u200dğŸ‘©ğŸ¿', '*ï¸âƒ£', 'ğŸ¤˜ğŸ½', 'ğŸ¦º', 'ğŸ„ğŸ¿', 'ğŸ†—']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.63s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.70s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.60s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.21s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.73s/it]
Processing depth (0, 2, 5, 8):   2%|â–         | 2/100 [01:35<1:08:58, 42.23s/it]2025-01-22 17:01:17.147 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the football.
2025-01-22 17:01:17.196 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went to the kitchen.
2025-01-22 17:01:17.208 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2003, 2008) -->  cable. Mary went to
2025-01-22 17:01:17.208 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary travelled to the office.
2025-01-22 17:01:17.229 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4249, 4254) -->  Mary travelled to the office
2025-01-22 17:01:17.230 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John left the football.
2025-01-22 17:01:17.265 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6699, 6703) -->  John left the football
2025-01-22 17:01:17.265 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went to the kitchen.
2025-01-22 17:01:17.276 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2005, 2010) -->  Mary went to the kitchen
2025-01-22 17:01:17.276 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went back to the bathroom.
2025-01-22 17:01:17.296 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3433, 3439) --> . Daniel went back to the
2025-01-22 17:01:17.296 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the bedroom.
2025-01-22 17:01:17.323 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4983, 4989) --> . John went back to the
2025-01-22 17:01:17.323 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John grabbed the football.
2025-01-22 17:01:17.337 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2405, 2409) -->  John grabbed the football
2025-01-22 17:01:17.337 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel journeyed to the hallway.
2025-01-22 17:01:17.362 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4279, 4285) -->  Daniel journeyed to the hallway
2025-01-22 17:01:17.362 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 17:01:17.362 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 17:01:17.362 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 17:01:17.362 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ§‘ğŸ»\u200dğŸ¤\u200dğŸ§‘ğŸ»', 'ğŸ¤¾ğŸ¼\u200dâ™€', 'ğŸ‘¨\u200dğŸ¤', '\U0001faf7ğŸ¾', 'ğŸš¶ğŸ½\u200dâ™€\u200dâ¡', 'ğŸ‘¨ğŸ½\u200dâ¤\u200dğŸ‘¨ğŸ½', 'ğŸ‘¨ğŸ½\u200dğŸŒ¾', 'ğŸšµğŸ¿\u200dâ™‚ï¸', 'ğŸ‘©ğŸ¼\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘©ğŸ»', 'ğŸƒğŸ»\u200dâ™‚']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.56s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.30s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.45s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.17s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.63s/it]
Processing depth (3, 4, 7, 8):   2%|â–         | 2/100 [01:52<1:08:58, 42.23s/it]2025-01-22 17:01:34.141 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the football.
2025-01-22 17:01:34.161 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2843, 2847) -->  Mary grabbed the football
2025-01-22 17:01:34.161 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went to the kitchen.
2025-01-22 17:01:34.174 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2148, 2153) -->  John went to the kitchen
2025-01-22 17:01:34.174 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary travelled to the office.
2025-01-22 17:01:34.207 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5606, 5611) --> . Mary travelled to the
2025-01-22 17:01:34.208 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John left the football.
2025-01-22 17:01:34.245 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6557, 6561) -->  John left the football
2025-01-22 17:01:34.245 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went to the kitchen.
2025-01-22 17:01:34.261 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2147, 2152) --> . John went to the
2025-01-22 17:01:34.261 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went back to the bathroom.
2025-01-22 17:01:34.279 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3239, 3245) --> . Daniel went back to the
2025-01-22 17:01:34.279 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the bedroom.
2025-01-22 17:01:34.305 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4905, 4911) --> . John went back to the
2025-01-22 17:01:34.305 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John grabbed the football.
2025-01-22 17:01:34.316 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2154, 2158) -->  John grabbed the football
2025-01-22 17:01:34.316 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel journeyed to the hallway.
2025-01-22 17:01:34.341 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4233, 4239) -->  Daniel journeyed to the hallway
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:01:35.156 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 17:01:35.156 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8183])
2025-01-22 17:01:37.365 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [239.42013888888889, 22.159441424383093, 171.06828703703704, 21.185208358923965, 29.77248733108108], 'topk_indices': array([   3, 8035, 5608, 8071,   23, 8164, 2152, 2157, 8081, 8177, 3627,
       8036,   14, 8179,  994,   24, 8181, 8037, 8178,    0]), 'topk_tokens': ['<|end_header_id|>', ' provided', ' travelled', '.\n\n', '4', '.\n\n', ' kitchen', ' football', ' location', ':', ' kitchen', ' you', '\n', '<|start_header_id|>', 'ï¿½', '\n\n', '<|end_header_id|>', ' context', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [203.296875, 264.775, 301.65, 166.0625]}, 'weight': {'score': [24.221788194444443, 23.28708122098705, 22.24074074074074, 23.288484791487534, 29.76583614864865], 'topk_indices': array([3306, 3333, 3219, 3171, 7436, 7474, 1451, 1513, 4338, 4354, 5168,
       5229, 7157, 7213, 3515, 3489, 4958, 4981, 5010, 4933]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.263671875, 23.4265625, 20.75625, 25.505859375]}, 'saliency': {'score': [1.56494140625, 0.12526719470551856, 1.0289623119212963, 0.11908688467325881, 0.22118934425147804], 'topk_indices': array([  20, 8164,   23, 8171, 8165, 8152,   24, 4234, 2846, 8036, 8170,
       8176, 8035,  994, 8081, 2152, 2157, 5608, 3627, 8037]), 'topk_tokens': [' Jul', '.\n\n', '4', ' before', 'Question', ' return', '\n\n', ' journey', ' football', ' you', ' football', 'Answer', ' provided', 'ï¿½', ' location', ' kitchen', ' football', ' travelled', ' kitchen', ' context'], 'evidence_proportions': [1.50537109375, 1.76494140625, 1.78173828125, 1.103515625]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 100}
2025-01-22 17:01:37.374 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:01:37.375 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-24_pid-2_3-4-7-8.pkl | len: 3 |  size: 2.05 KB
Processing depth (3, 4, 7, 8):   3%|â–         | 3/100 [01:55<1:04:21, 39.81s/it]is_0k: False
your chose emoji: ['ğŸŸ', 'â¡ï¸', 'ğŸ§ğŸ½\u200dâ™€ï¸\u200dâ¡ï¸', 'ğŸ¤ŒğŸ»', 'ğŸ‘³ğŸ¾\u200dâ™‚ï¸', 'ğŸ¤¾ğŸ»\u200dâ™‚ï¸', 'ğŸ‘©ğŸ¾\u200dğŸ¦¯\u200dâ¡ï¸', 'ğŸ‡®ğŸ‡¶', 'ğŸ‘¬ğŸ¾', 'â›µ']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.18s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.57s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.78s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.27s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.76s/it]
Processing depth (0, 2, 7, 8):   3%|â–         | 3/100 [02:12<1:04:21, 39.81s/it]2025-01-22 17:01:54.411 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the football.
2025-01-22 17:01:54.454 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went to the kitchen.
2025-01-22 17:01:54.463 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1780, 1785) --> . Mary went to the
2025-01-22 17:01:54.463 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary travelled to the office.
2025-01-22 17:01:54.493 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5626, 5631) --> . Mary travelled to the
2025-01-22 17:01:54.494 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John left the football.
2025-01-22 17:01:54.528 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6625, 6629) -->  John left the football
2025-01-22 17:01:54.528 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went to the kitchen.
2025-01-22 17:01:54.538 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1781, 1786) -->  Mary went to the kitchen
2025-01-22 17:01:54.538 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went back to the bathroom.
2025-01-22 17:01:54.554 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3285, 3291) --> . Daniel went back to the
2025-01-22 17:01:54.555 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the bedroom.
2025-01-22 17:01:54.587 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4807, 4813) -->  the senate. John went back
2025-01-22 17:01:54.587 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John grabbed the football.
2025-01-22 17:01:54.600 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2161, 2165) -->  John grabbed the football
2025-01-22 17:01:54.600 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel journeyed to the hallway.
2025-01-22 17:01:54.624 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4180, 4186) --> . Daniel journeyed to the
2025-01-22 17:01:54.625 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 17:01:54.625 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 17:01:54.625 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 17:01:54.625 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸš¶\u200dâ™€\u200dâ¡', 'ğŸ‡µğŸ‡³', 'ğŸš†', 'ğŸ‘¨ğŸ½\u200dğŸ“', '\U0001fa7c', 'ğŸ¥Ÿ', 'ğŸšµğŸ½\u200dâ™€', 'â›¹\u200dâ™‚ï¸', 'ğŸ§‘ğŸ»\u200dâ¤\u200dğŸ’‹\u200dğŸ§‘ğŸ½', 'ğŸ§‘ğŸ¾\u200dğŸŒ¾']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.52s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.68s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.45s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.05s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.60s/it]
Processing depth (0, 6, 7, 8):   3%|â–         | 3/100 [02:29<1:04:21, 39.81s/it]2025-01-22 17:02:11.199 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the football.
2025-01-22 17:02:11.244 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went to the kitchen.
2025-01-22 17:02:11.258 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2199, 2204) -->  John went to the kitchen
2025-01-22 17:02:11.259 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary travelled to the office.
2025-01-22 17:02:11.294 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5634, 5639) --> . Mary travelled to the
2025-01-22 17:02:11.294 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John left the football.
2025-01-22 17:02:11.329 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6617, 6621) -->  John left the football
2025-01-22 17:02:11.329 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went to the kitchen.
2025-01-22 17:02:11.342 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2198, 2203) --> . John went to the
2025-01-22 17:02:11.343 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went back to the bathroom.
2025-01-22 17:02:11.360 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3217, 3223) --> . Daniel went back to the
2025-01-22 17:02:11.360 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the bedroom.
2025-01-22 17:02:11.384 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4905, 4911) --> . John went back to the
2025-01-22 17:02:11.384 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John grabbed the football.
2025-01-22 17:02:11.395 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2205, 2209) -->  John grabbed the football
2025-01-22 17:02:11.395 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel journeyed to the hallway.
2025-01-22 17:02:11.416 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4217, 4223) -->  Daniel journeyed to the hallway
2025-01-22 17:02:11.417 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 17:02:11.417 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 17:02:11.417 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 17:02:11.417 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ‘®ğŸ¿\u200dâ™€ï¸', 'ğŸ”‚', 'ğŸ‘¬ğŸ¿', 'ğŸ‡®ğŸ‡©', '\U0001faf3ğŸ¼', 'ğŸ˜', 'ğŸ‡¬ğŸ‡«', 'ğŸ‡§ğŸ‡©', 'ğŸ«“', 'ğŸŒğŸ»\u200dâ™‚']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.12s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.64s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.86s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.41s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.86s/it]
Processing depth (1, 2, 5, 8):   3%|â–         | 3/100 [02:46<1:04:21, 39.81s/it]2025-01-22 17:02:28.553 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the football.
2025-01-22 17:02:28.558 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (782, 786) -->  Mary grabbed the football
2025-01-22 17:02:28.558 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went to the kitchen.
2025-01-22 17:02:28.569 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1748, 1753) --> . Mary went to the
2025-01-22 17:02:28.569 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary travelled to the office.
2025-01-22 17:02:28.591 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4152, 4157) --> . Mary travelled to the
2025-01-22 17:02:28.591 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John left the football.
2025-01-22 17:02:28.630 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6527, 6531) -->  John left the football
2025-01-22 17:02:28.631 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went to the kitchen.
2025-01-22 17:02:28.640 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1749, 1754) -->  Mary went to the kitchen
2025-01-22 17:02:28.640 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went back to the bathroom.
2025-01-22 17:02:28.670 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3162, 3168) -->  ranks. Daniel went back to
2025-01-22 17:02:28.671 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the bedroom.
2025-01-22 17:02:28.700 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4703, 4709) --> . John went back to the
2025-01-22 17:02:28.700 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John grabbed the football.
2025-01-22 17:02:28.712 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2077, 2081) -->  John grabbed the football
2025-01-22 17:02:28.713 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel journeyed to the hallway.
2025-01-22 17:02:28.739 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4186, 4192) --> . Daniel journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:02:29.611 | INFO     | test_jbb_embedding:begin_test:693 - Mary grabbed the football.<|eot_id|>
2025-01-22 17:02:29.611 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8185])
2025-01-22 17:02:31.819 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [441.6041666666667, 40.31112603810454, 216.18402777777777, 38.84092548814933, 55.404010416666665], 'topk_indices': array([8073, 8176,  790, 8168, 8179, 8166, 1753,  791, 8175,  785,  786,
       8173,  787, 8183, 8180, 8172,  789,  788,  792,    0]), 'topk_tokens': ['.\n\n', '?', 'ï¿½', ':', ':', '.\n\n', ' kitchen', 'ï¿½', ' office', ' football', '.', ' before', 'ï¿½', '<|end_header_id|>', '<|eot_id|>', ' football', 'ï¿½', 'ï¿½', 'ï¿½', '<|begin_of_text|>'], 'evidence_proportions': [706.8125, 317.3, 300.925, 507.625]}, 'weight': {'score': [23.104166666666668, 23.278878007449926, 23.032118055555557, 23.28008239438782, 29.235], 'topk_indices': array([3338, 3365, 3246, 3198, 7438, 7476, 1508, 1446, 4330, 4346, 5208,
       5269, 7159, 7215, 3521, 3547, 4985, 5010, 5033, 5062]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.263671875, 19.403125, 20.75625, 25.505859375]}, 'saliency': {'score': [2.7950846354166665, 0.2282487340944828, 1.380077220775463, 0.21875562156050443, 0.4146885172526042], 'topk_indices': array([8169, 8166,  783, 8178, 8083, 8039, 2080, 8167, 6530,  791, 8173,
       8175, 1753,  789,  790,  785,  788,  787, 8172,  792]), 'topk_tokens': [' Where', '.\n\n', ' grabbed', 'Answer', ' location', ' context', ' football', 'Question', ' football', 'ï¿½', ' before', ' office', ' kitchen', 'ï¿½', 'ï¿½', ' football', 'ï¿½', 'ï¿½', ' football', 'ï¿½'], 'evidence_proportions': [5.13427734375, 1.55859375, 1.6490234375, 3.43408203125]}}, 'pred_res': 'Mary grabbed the football.<|eot_id|>', 'score': 0}
2025-01-22 17:02:31.827 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:02:31.828 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-24_pid-3_1-2-5-8.pkl | len: 3 |  size: 2.01 KB
Processing depth (1, 2, 5, 8):   4%|â–         | 4/100 [02:49<1:12:56, 45.59s/it]is_0k: False
your chose emoji: ['ğŸ‡²ğŸ‡¦', 'ğŸ‡¨ğŸ‡º', 'ğŸ§‘\u200dâš–ï¸', 'ğŸ‡±ğŸ‡®', 'ğŸ™ŒğŸ½', 'ğŸ¦¹ğŸ¼\u200dâ™‚', 'ğŸƒğŸ½\u200dâ™‚', 'ğŸ‘¨ğŸ¾\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘¨ğŸ¾', 'ğŸ‘›', 'ğŸ“²']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.60s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.23s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:15<00:05,  5.02s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  3.52s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  4.06s/it]
Processing depth (0, 5, 6, 7):   4%|â–         | 4/100 [03:08<1:12:56, 45.59s/it]2025-01-22 17:02:50.083 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the football.
2025-01-22 17:02:50.123 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went to the kitchen.
2025-01-22 17:02:50.133 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1898, 1903) -->  went to the kitchen.
2025-01-22 17:02:50.133 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary travelled to the office.
2025-01-22 17:02:50.156 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4610, 4615) -->  Mary travelled to the office
2025-01-22 17:02:50.157 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John left the football.
2025-01-22 17:02:50.184 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5470, 5474) -->  left the football.
2025-01-22 17:02:50.184 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went to the kitchen.
2025-01-22 17:02:50.194 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1897, 1902) -->  John went to the kitchen
2025-01-22 17:02:50.194 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went back to the bathroom.
2025-01-22 17:02:50.210 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3108, 3114) -->  Daniel went back to the bathroom
2025-01-22 17:02:50.210 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the bedroom.
2025-01-22 17:02:50.239 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4755, 4761) --> . John went back to the
2025-01-22 17:02:50.239 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John grabbed the football.
2025-01-22 17:02:50.248 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1903, 1907) -->  John grabbed the football
2025-01-22 17:02:50.248 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel journeyed to the hallway.
2025-01-22 17:02:50.269 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4118, 4124) --> . Daniel journeyed to the
2025-01-22 17:02:50.270 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 17:02:50.270 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 17:02:50.270 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 17:02:50.270 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸš', 'ğŸ§’ğŸ¾', 'âœŒğŸ½', 'ğŸ‡§ğŸ‡³', 'ğŸ’¸', 'ğŸ§‘ğŸ½\u200dğŸ¦¼', 'ğŸï¸', 'Â®ï¸', 'ğŸ‘¨ğŸ¼\u200dâ¤ï¸\u200dğŸ‘¨ğŸ»', 'ğŸ¥']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.58s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.61s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.69s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.23s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.75s/it]
Processing depth (4, 5, 6, 7):   4%|â–         | 4/100 [03:25<1:12:56, 45.59s/it]2025-01-22 17:03:07.069 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the football.
2025-01-22 17:03:07.097 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3608, 3612) -->  Mary grabbed the football
2025-01-22 17:03:07.097 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went to the kitchen.
2025-01-22 17:03:07.110 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2118, 2123) -->  John went to the kitchen
2025-01-22 17:03:07.110 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary travelled to the office.
2025-01-22 17:03:07.136 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4742, 4747) -->  Mary travelled to the office
2025-01-22 17:03:07.136 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John left the football.
2025-01-22 17:03:07.165 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5593, 5597) -->  John left the football
2025-01-22 17:03:07.166 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went to the kitchen.
2025-01-22 17:03:07.181 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2117, 2122) --> . John went to the
2025-01-22 17:03:07.181 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went back to the bathroom.
2025-01-22 17:03:07.199 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3224, 3230) --> . Daniel went back to the
2025-01-22 17:03:07.200 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the bedroom.
2025-01-22 17:03:07.227 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4901, 4907) --> . John went back to the
2025-01-22 17:03:07.228 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John grabbed the football.
2025-01-22 17:03:07.238 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2124, 2128) -->  John grabbed the football
2025-01-22 17:03:07.238 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel journeyed to the hallway.
2025-01-22 17:03:07.266 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4235, 4241) -->  Daniel journeyed to the hallway
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:03:08.064 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 17:03:08.065 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8161])
2025-01-22 17:03:10.315 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [206.66319444444446, 15.691681850195982, 120.47106481481481, 14.919846579012194, 16.889012896825395], 'topk_indices': array([8134, 5596,    4, 8144, 8142, 8154, 8049, 8059,    9,   23, 2127,
       8148, 3611,   24, 8155,   14, 4209, 8159,    0, 8156]), 'topk_tokens': ['.', ' football', '\n\n', ':', '.\n\n', 'Answer', '.\n\n', ' location', ':', '4', ' football', ' football', ' football', '\n\n', ':', '\n', ' kitchen', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [247.75, 175.0875, 129.9, 301.0]}, 'weight': {'score': [25.336805555555557, 23.261829755634494, 22.24074074074074, 23.260625153959847, 29.264880952380953], 'topk_indices': array([3318, 3291, 3156, 3204, 7452, 7414, 1477, 1415, 4308, 4324, 5235,
       5174, 7181, 7125, 3474, 3500, 5028, 4929, 4954, 4999]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.263671875, 23.4265625, 24.7703125, 25.505859375]}, 'saliency': {'score': [1.3893229166666667, 0.08702695212020761, 0.7328197337962963, 0.08199212856224597, 0.12428973969959077], 'topk_indices': array([8153, 8049,   20,    8,   23, 8149, 2122, 8151, 5594, 8015, 8130,
         24, 8143, 8059, 8154, 5596, 2127, 8148, 3611, 4209]), 'topk_tokens': [' \n', '.\n\n', ' Jul', ' Date', '4', ' before', ' kitchen', ' office', ' left', ' context', ' return', '\n\n', 'Question', ' location', 'Answer', ' football', ' football', ' football', ' football', ' kitchen'], 'evidence_proportions': [1.84747314453125, 1.119189453125, 0.82314453125, 1.9765625]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 100}
2025-01-22 17:03:10.323 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:03:10.323 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-24_pid-4_4-5-6-7.pkl | len: 3 |  size: 2.0 KB
Processing depth (4, 5, 6, 7):   5%|â–Œ         | 5/100 [03:28<1:08:08, 43.03s/it]Processing depth (4, 5, 6, 7):   5%|â–Œ         | 5/100 [03:28<1:06:03, 41.72s/it]
2025-01-22 17:03:10.432 | INFO     | __main__:<module>:82 - Selected idx: 26
2025-01-22 17:03:10.432 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the football before the office? 
2025-01-22 17:03:10.432 | INFO     | __main__:<module>:84 - Answer: kitchen
2025-01-22 17:03:10.432 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 17:03:10.432 | INFO     | __main__:<module>:86 - Needle: [' Daniel journeyed to the hallway.', ' John grabbed the football.', ' Mary picked up the football.', ' John went to the kitchen.', ' John left the football.', ' Mary went to the kitchen.', ' Daniel went back to the bathroom.', ' John went back to the bedroom.', ' Mary travelled to the office.', ' John got the football there.']
2025-01-22 17:03:10.432 | INFO     | __main__:<module>:87 - Real Needle: [' Mary picked up the football.', ' Mary went to the kitchen.', ' Mary travelled to the office.', ' John got the football there.']
2025-01-22 17:03:10.432 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ™‹ğŸ¿\u200dâ™€', 'ğŸŒ', 'ğŸš¶ğŸ¼\u200dâ™‚ï¸', 'ğŸ‘¨ğŸ½\u200dğŸ¦¯\u200dâ¡', 'ğŸ’ğŸ¼', 'ğŸ¦­', 'â˜ğŸ»', 'ğŸ§¨', 'ğŸ‘©ğŸ»\u200dğŸ¦±', 'ğŸ¿']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.73s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.78s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.63s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.24s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.78s/it]
Processing depth (0, 5, 8, 9):   0%|          | 0/100 [00:16<?, ?it/s]2025-01-22 17:03:27.316 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the football.
2025-01-22 17:03:27.317 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the football.
2025-01-22 17:03:27.317 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went to the kitchen.
2025-01-22 17:03:27.342 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4204, 4209) -->  Mary went to the kitchen
2025-01-22 17:03:27.343 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary travelled to the office.
2025-01-22 17:03:27.379 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6523, 6528) --> . Mary travelled to the
2025-01-22 17:03:27.380 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John got the football there.
2025-01-22 17:03:27.419 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7224, 7229) --> . John got the football
2025-01-22 17:03:27.419 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel journeyed to the hallway.
2025-01-22 17:03:27.432 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2175, 2181) --> . Daniel journeyed to the
2025-01-22 17:03:27.432 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John grabbed the football.
2025-01-22 17:03:27.450 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3496, 3500) -->  John grabbed the football
2025-01-22 17:03:27.451 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went to the kitchen.
2025-01-22 17:03:27.478 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3651, 3656) -->  John went back to the
2025-01-22 17:03:27.478 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John left the football.
2025-01-22 17:03:27.513 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6530, 6534) -->  John left the football
2025-01-22 17:03:27.513 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel went back to the bathroom.
2025-01-22 17:03:27.530 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3070, 3076) --> . Daniel went back to the
2025-01-22 17:03:27.531 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John went back to the bedroom.
2025-01-22 17:03:27.551 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (3650, 3656) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:03:28.428 | INFO     | test_jbb_embedding:begin_test:693 - Mary picked up the football.<|eot_id|>
2025-01-22 17:03:28.428 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8176])
2025-01-22 17:03:30.658 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [446.28125, 48.1795833842768, 200.4334677419355, 46.61930979330709, 21.59698577425373], 'topk_indices': array([7279,  355,  423,   67, 8164, 7308,   68,  327, 8166,  105,  544,
        356, 7307,   34, 7278,  328, 7355,  539,    0, 7356]), 'topk_tokens': ['ot', ' latter', '000', 'ION', ' before', 'ot', 'E', ' half', ' office', 'ION', ',', ' half', 'nes', ' football', 'nes', ' of', ' Min', ',', '<|begin_of_text|>', 'nes'], 'evidence_proportions': [961.6, 290.3, 276.35, 256.875]}, 'weight': {'score': [22.422265625, 23.273732653747402, 22.246219758064516, 23.27974670890748, 29.65741604477612], 'topk_indices': array([3304, 3277, 3197, 3149, 7441, 7403, 1405, 1467, 4296, 4280, 5097,
       5158, 7174, 7118, 3460, 3486, 4916, 4893, 4945, 4868]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.2875, 24.1921875, 20.75625, 22.453125]}, 'saliency': {'score': [2.7201171875, 0.27041880072059543, 1.208433089717742, 0.26081343523160677, 0.16184154909048507], 'topk_indices': array([  38,  539, 7277,   67,   68,  328,  326, 7308,  423, 8164,  355,
        105, 8166,  327,  356, 7307,   34, 7278, 7355, 7356]), 'topk_tokens': ['***', ',', 'Min', 'ION', 'E', ' of', ' latter', 'ot', '000', ' before', ' latter', 'ION', ' office', ' half', ' half', 'nes', ' football', 'nes', ' Min', 'nes'], 'evidence_proportions': [5.810546875, 2.04013671875, 1.5205078125, 1.50927734375]}}, 'pred_res': 'Mary picked up the football.<|eot_id|>', 'score': 0}
2025-01-22 17:03:30.662 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:03:30.663 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-26_pid-0_0-5-8-9.pkl | len: 3 |  size: 1.95 KB
Processing depth (0, 5, 8, 9):   1%|          | 1/100 [00:20<33:12, 20.12s/it]is_0k: False
your chose emoji: ['ğŸ”', 'ğŸ¦€', 'ğŸ©', 'ğŸ‘©ğŸ¼\u200dâ¤\u200dğŸ’‹\u200dğŸ‘¨ğŸ¼', 'ğŸ‘©ğŸ¾\u200dğŸ”¬', 'ğŸ¥‚', 'ğŸ’ğŸ½\u200dâ™€ï¸', 'ğŸ˜ƒ', 'ğŸ§ğŸ¿\u200dâ™‚', 'ğŸ™ğŸ¾\u200dâ™€']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.72s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.89s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.83s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.33s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.88s/it]
Processing depth (1, 3, 5, 7):   1%|          | 1/100 [00:37<33:12, 20.12s/it]2025-01-22 17:03:48.047 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the football.
2025-01-22 17:03:48.051 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (845, 850) --> . Mary picked up the
2025-01-22 17:03:48.052 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went to the kitchen.
2025-01-22 17:03:48.066 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2903, 2908) -->  Mary went to the kitchen
2025-01-22 17:03:48.066 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary travelled to the office.
2025-01-22 17:03:48.087 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4230, 4235) -->  Mary travelled to the office
2025-01-22 17:03:48.088 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John got the football there.
2025-01-22 17:03:48.121 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5741, 5746) --> . John got the football
2025-01-22 17:03:48.121 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel journeyed to the hallway.
2025-01-22 17:03:48.133 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2044, 2050) -->  cable. Daniel journeyed to
2025-01-22 17:03:48.133 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John grabbed the football.
2025-01-22 17:03:48.157 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3524, 3528) -->  John grabbed the football
2025-01-22 17:03:48.157 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went to the kitchen.
2025-01-22 17:03:48.173 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2904, 2909) -->  went to the kitchen.
2025-01-22 17:03:48.173 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John left the football.
2025-01-22 17:03:48.213 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6648, 6652) -->  John left the football
2025-01-22 17:03:48.213 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel went back to the bathroom.
2025-01-22 17:03:48.231 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3021, 3027) -->  tragedy. Daniel went back to
2025-01-22 17:03:48.231 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John went back to the bedroom.
2025-01-22 17:03:48.250 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (3776, 3782) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:03:49.026 | INFO     | test_jbb_embedding:begin_test:693 - The bedroom.<|eot_id|>
2025-01-22 17:03:49.026 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8188])
2025-01-22 17:03:51.263 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [183.934375, 18.084765291173238, 121.10030241935483, 17.28495277948403, 17.13187607020548], 'topk_indices': array([8161, 8187,    4, 8175, 8086, 8171,    1,  850, 8169, 8181, 8076,
          9, 2907,   23, 8182,   24,   14, 8186, 8183,    0]), 'topk_tokens': ['.', '\n\n', '\n\n', ' football', ' location', ':', '<|start_header_id|>', ' football', '.\n\n', 'Answer', '.\n\n', ':', ' kitchen', '4', ':', '\n\n', '\n', '<|end_header_id|>', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [181.375, 216.8, 117.3625, 220.2]}, 'weight': {'score': [23.37890625, 23.288786854474424, 23.479334677419356, 23.287839757371007, 29.983518835616437], 'topk_indices': array([3305, 3332, 3177, 3225, 7423, 7385, 1441, 1503, 4322, 4306, 5196,
       5135, 7106, 7162, 3514, 3488, 4960, 4989, 4937, 4912]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.1, 24.1921875, 24.7703125, 22.453125]}, 'saliency': {'score': [1.15831298828125, 0.10102626841054588, 0.7605728641633065, 0.09591672555234566, 0.1301660407079409], 'topk_indices': array([8082,   16, 8080, 8169,   19, 8160, 3527, 8076, 3782, 8157,    8,
       8170,   23,   20,   24, 8086, 8175,  850, 8181, 2907]), 'topk_tokens': [' item', ' Date', ' obtained', '.\n\n', '26', ' directly', ' football', '.\n\n', ' bedroom', ' return', ' Date', 'Question', '4', ' Jul', '\n\n', ' location', ' football', ' football', 'Answer', ' kitchen'], 'evidence_proportions': [1.01513671875, 1.5177734375, 0.77939453125, 1.320947265625]}}, 'pred_res': 'The bedroom.<|eot_id|>', 'score': 0}
2025-01-22 17:03:51.270 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:03:51.270 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-26_pid-1_1-3-5-7.pkl | len: 3 |  size: 2.0 KB
Processing depth (1, 3, 5, 7):   2%|â–         | 2/100 [00:40<33:19, 20.41s/it]is_0k: False
your chose emoji: ['ğŸª¦', 'ğŸ‘©ğŸ»\u200dâ¤\u200dğŸ’‹\u200dğŸ‘©ğŸ½', 'ğŸ•Œ', 'ğŸ¤·\u200dâ™‚ï¸', 'ğŸ©', 'ğŸ•¯ï¸', 'ğŸ‘©ğŸ½\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘¨ğŸ¿', 'â”', 'ğŸ‘®ğŸ¾\u200dâ™‚', 'ğŸ¦¸ğŸ»']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.29s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.75s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.83s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.38s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.86s/it]
Processing depth (1, 2, 4, 9):   2%|â–         | 2/100 [00:57<33:19, 20.41s/it]2025-01-22 17:04:08.534 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the football.
2025-01-22 17:04:08.554 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (895, 900) --> . Mary picked up the
2025-01-22 17:04:08.554 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went to the kitchen.
2025-01-22 17:04:08.566 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1847, 1852) --> . Mary went to the
2025-01-22 17:04:08.567 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary travelled to the office.
2025-01-22 17:04:08.589 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3598, 3603) --> . Mary travelled to the
2025-01-22 17:04:08.589 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John got the football there.
2025-01-22 17:04:08.629 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7224, 7229) --> . John got the football
2025-01-22 17:04:08.629 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel journeyed to the hallway.
2025-01-22 17:04:08.642 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2113, 2119) --> . Daniel journeyed to the
2025-01-22 17:04:08.643 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John grabbed the football.
2025-01-22 17:04:08.660 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3445, 3449) -->  grabbed the football.
2025-01-22 17:04:08.660 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went to the kitchen.
2025-01-22 17:04:08.673 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1848, 1853) -->  Mary went to the kitchen
2025-01-22 17:04:08.673 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John left the football.
2025-01-22 17:04:08.709 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6530, 6534) -->  John left the football
2025-01-22 17:04:08.709 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel went back to the bathroom.
2025-01-22 17:04:08.726 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3064, 3070) --> . Daniel went back to the
2025-01-22 17:04:08.726 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John went back to the bedroom.
2025-01-22 17:04:08.747 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (3650, 3656) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:04:09.547 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 17:04:09.548 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8170])
2025-01-22 17:04:11.770 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [143.34375, 17.007620365838736, 131.04637096774192, 16.261261850529426, 13.046951293945312], 'topk_indices': array([8143, 7549, 8157, 8068,    3, 8169, 8153,    9, 8058,   23, 8163,
       8151,   24, 8164,   14, 8166, 1852, 8168, 8165,    0]), 'topk_tokens': ['.', 'nes', ' football', ' location', '<|end_header_id|>', '\n\n', ':', ':', '.\n\n', '4', 'Answer', '.\n\n', '\n\n', ':', '\n', '<|start_header_id|>', ' kitchen', '<|end_header_id|>', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [201.65, 150.2375, 115.425, 106.0625]}, 'weight': {'score': [21.178125, 23.261059662914473, 21.952116935483872, 23.271184745136665, 29.154541015625], 'topk_indices': array([3271, 3298, 3185, 3137, 7441, 7403, 1473, 1411, 4320, 4336, 5161,
       5222, 7174, 7118, 3491, 3465, 4997, 4908, 4968, 4933]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.1, 19.403125, 20.75625, 22.453125]}, 'saliency': {'score': [0.774774169921875, 0.09438827404496895, 0.8062822895665323, 0.0899957066479354, 0.09535682201385498], 'topk_indices': array([8139,    8, 8058, 5682, 8158,   23, 8160, 7504,   20, 8024, 8151,
       7548,   24, 7549, 8152, 8068,  900, 8157, 8163, 1852]), 'topk_tokens': [' return', ' Date', '.\n\n', ' kitchen', ' before', '4', ' office', 'nes', ' Jul', ' context', '.\n\n', ' Min', '\n\n', 'nes', 'Question', ' location', ' football', ' football', 'Answer', ' kitchen'], 'evidence_proportions': [1.0890625, 0.72236328125, 0.6609130859375, 0.6267578125]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 100}
2025-01-22 17:04:11.793 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:04:11.794 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-26_pid-2_1-2-4-9.pkl | len: 3 |  size: 2.0 KB
Processing depth (1, 2, 4, 9):   3%|â–         | 3/100 [01:01<33:04, 20.46s/it]is_0k: False
your chose emoji: ['ğŸ‘©ğŸ»\u200dğŸ¤\u200dğŸ‘©ğŸ¼', 'ğŸ¤˜ğŸ»', 'ğŸ‘', 'ğŸ¦', 'ğŸš»', 'ğŸŒ©ï¸', 'ğŸ¤¹ğŸ½\u200dâ™€ï¸', 'â›¹\u200dâ™‚', 'ğŸš', 'ğŸ‘¨ğŸ»\u200dğŸ¤']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.54s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.59s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.39s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.01s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.55s/it]
Processing depth (1, 3, 4, 7):   3%|â–         | 3/100 [01:17<33:04, 20.46s/it]2025-01-22 17:04:28.337 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the football.
2025-01-22 17:04:28.342 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (895, 900) --> . Mary picked up the
2025-01-22 17:04:28.342 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went to the kitchen.
2025-01-22 17:04:28.357 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2832, 2837) --> . Mary went to the
2025-01-22 17:04:28.357 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary travelled to the office.
2025-01-22 17:04:28.376 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3618, 3623) --> . Mary travelled to the
2025-01-22 17:04:28.376 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John got the football there.
2025-01-22 17:04:28.408 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5655, 5660) --> . John got the football
2025-01-22 17:04:28.408 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel journeyed to the hallway.
2025-01-22 17:04:28.419 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2123, 2129) --> . Daniel journeyed to the
2025-01-22 17:04:28.419 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John grabbed the football.
2025-01-22 17:04:28.436 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3464, 3468) -->  John grabbed the football
2025-01-22 17:04:28.436 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went to the kitchen.
2025-01-22 17:04:28.457 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2833, 2838) -->  Mary went to the kitchen
2025-01-22 17:04:28.457 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John left the football.
2025-01-22 17:04:28.496 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6537, 6541) -->  left the football.
2025-01-22 17:04:28.496 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel went back to the bathroom.
2025-01-22 17:04:28.514 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (2956, 2962) --> . Daniel went back to the
2025-01-22 17:04:28.514 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John went back to the bedroom.
2025-01-22 17:04:28.537 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (3670, 3676) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:04:29.337 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 17:04:29.337 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8172])
2025-01-22 17:04:31.555 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [127.98125, 16.08690749235474, 97.59072580645162, 15.500434668882324, 11.433263221153846], 'topk_indices': array([ 984,    1, 8165, 8171, 8153, 8060,    9, 2016,   23, 1935, 8166,
         24,   14, 2837,  900, 1936, 2017, 8170, 8167,    0]), 'topk_tokens': [' election', '<|start_header_id|>', 'Answer', '\n\n', '.\n\n', '.\n\n', ':', ' bring', '4', ' the', ':', '\n\n', '\n', ' kitchen', ' football', ' news', ' the', '<|end_header_id|>', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [226.825, 102.1625, 81.54375, 101.39375]}, 'weight': {'score': [21.178125, 23.264462920489297, 21.952116935483872, 23.27460687469227, 29.277884615384615], 'topk_indices': array([3324, 3297, 3169, 3217, 7457, 7419, 1489, 1427, 4328, 4344, 5200,
       5139, 7196, 7140, 3485, 3511, 4993, 4916, 4941, 4964]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.1, 19.403125, 20.75625, 22.453125]}, 'saliency': {'score': [0.698089599609375, 0.08896317134938837, 0.6117888419858871, 0.08546857209348843, 0.08320142305814303], 'topk_indices': array([8144, 8162, 8153, 8060,    8, 8141,   23, 8159, 8154,   20,   24,
       8070, 1934, 2017,  984, 8165, 2016, 2837,  900, 1936]), 'topk_tokens': [' directly', ' office', '.\n\n', '.\n\n', ' Date', ' return', '4', ' football', 'Question', ' Jul', '\n\n', ' location', ' bring', ' the', ' election', 'Answer', ' bring', ' kitchen', ' football', ' news'], 'evidence_proportions': [1.23037109375, 0.4910888671875, 0.45888671875, 0.61201171875]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 100}
2025-01-22 17:04:31.564 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:04:31.564 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-26_pid-3_1-3-4-7.pkl | len: 3 |  size: 2.01 KB
Processing depth (1, 3, 4, 7):   4%|â–         | 4/100 [01:21<32:18, 20.19s/it]is_0k: False
your chose emoji: ['ğŸ¤¶', 'ğŸ‘©ğŸ¼\u200dâš•ï¸', 'ğŸ˜‹', 'ğŸ’ğŸ¿\u200dâ™€ï¸', 'ğŸ§¥', 'ğŸ¥£', 'ğŸ‡²ğŸ‡±', 'ğŸ§‘ğŸ½\u200dğŸ¦¯\u200dâ¡ï¸', 'ğŸ‘°ğŸ»\u200dâ™‚', 'ğŸ¤ğŸ¿']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:05<00:15,  5.01s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.95s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.63s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.20s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.80s/it]
Processing depth (0, 2, 4, 7):   4%|â–         | 4/100 [01:38<32:18, 20.19s/it]2025-01-22 17:04:49.009 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the football.
2025-01-22 17:04:49.009 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the football.
2025-01-22 17:04:49.009 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went to the kitchen.
2025-01-22 17:04:49.018 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1853, 1858) --> . Mary went to the
2025-01-22 17:04:49.019 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary travelled to the office.
2025-01-22 17:04:49.041 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3638, 3643) --> . Mary travelled to the
2025-01-22 17:04:49.041 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John got the football there.
2025-01-22 17:04:49.071 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6056, 6061) -->  John got the football there
2025-01-22 17:04:49.071 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel journeyed to the hallway.
2025-01-22 17:04:49.082 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2032, 2038) -->  Daniel journeyed to the hallway
2025-01-22 17:04:49.082 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John grabbed the football.
2025-01-22 17:04:49.099 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3536, 3540) -->  John grabbed the football
2025-01-22 17:04:49.099 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went to the kitchen.
2025-01-22 17:04:49.109 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1854, 1859) -->  Mary went to the kitchen
2025-01-22 17:04:49.109 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John left the football.
2025-01-22 17:04:49.145 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6662, 6666) -->  John left the football
2025-01-22 17:04:49.145 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel went back to the bathroom.
2025-01-22 17:04:49.164 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3070, 3076) --> . Daniel went back to the
2025-01-22 17:04:49.164 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John went back to the bedroom.
2025-01-22 17:04:49.186 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (3792, 3798) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:04:50.060 | INFO     | test_jbb_embedding:begin_test:693 - Mary picked up the football.<|eot_id|>
2025-01-22 17:04:50.061 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8188])
2025-01-22 17:04:52.272 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [417.675, 49.371222988646075, 213.25201612903226, 47.842183660933664, 67.27006635273973], 'topk_indices': array([1206,  263, 1212,  544,  328, 1225, 1211, 1167, 1224,   34, 1151,
       1166, 1014, 1015, 1054, 1226,  539, 1016, 1055,    0]), 'topk_tokens': ['nes', 'hue', 'P', ',', ' of', 'Min', '\n', 'ot', '\n', ' football', '\n', 'nes', ' galaxy', ' of', ' galaxy', 'nes', ',', ' states', ' of', '<|begin_of_text|>'], 'evidence_proportions': [799.9, 213.55, 273.45, 383.8]}, 'weight': {'score': [21.986328125, 23.27739859296789, 23.55796370967742, 23.27950226504914, 29.33839897260274], 'topk_indices': array([3298, 3271, 3191, 3143, 7435, 7397, 1417, 1479, 4282, 4298, 5093,
       5154, 7100, 7156, 3454, 3480, 4947, 4870, 4918, 4895]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.2875, 19.403125, 20.75625, 25.4984375]}, 'saliency': {'score': [2.43575439453125, 0.27814800424055364, 1.376496345766129, 0.2686638609490172, 0.5004167948683648], 'topk_indices': array([ 105,  423, 8176, 1207, 1015, 1212,  327,  356, 1167, 1206, 1153,
       1055, 1225,  263,   34, 1166, 1014, 1016, 1226, 1054]), 'topk_tokens': ['ION', '000', ' before', 'ot', ' of', 'P', ' half', ' half', 'ot', 'nes', 'ioneer', ' of', 'Min', 'hue', ' football', 'nes', ' galaxy', ' states', 'nes', ' galaxy'], 'evidence_proportions': [4.6943359375, 1.106884765625, 1.471484375, 2.4703125]}}, 'pred_res': 'Mary picked up the football.<|eot_id|>', 'score': 0}
2025-01-22 17:04:52.279 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:04:52.280 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-26_pid-4_0-2-4-7.pkl | len: 3 |  size: 1.94 KB
Processing depth (0, 2, 4, 7):   5%|â–Œ         | 5/100 [01:41<32:15, 20.38s/it]Processing depth (0, 2, 4, 7):   5%|â–Œ         | 5/100 [01:41<32:14, 20.36s/it]
2025-01-22 17:04:52.333 | INFO     | __main__:<module>:82 - Selected idx: 28
2025-01-22 17:04:52.333 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the milk before the bathroom? 
2025-01-22 17:04:52.333 | INFO     | __main__:<module>:84 - Answer: office
2025-01-22 17:04:52.333 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 17:04:52.333 | INFO     | __main__:<module>:86 - Needle: [' Mary dropped the milk.', ' Mary took the milk.', ' John picked up the milk.', ' John travelled to the office.', ' Daniel went back to the bathroom.', ' Daniel journeyed to the hallway.', ' Mary journeyed to the garden.', ' Daniel went back to the kitchen.', ' John went to the bathroom.', ' Sandra travelled to the garden.']
2025-01-22 17:04:52.333 | INFO     | __main__:<module>:87 - Real Needle: [' John picked up the milk.', ' John travelled to the office.', ' John went to the bathroom.', ' Sandra travelled to the garden.']
2025-01-22 17:04:52.333 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['â›‘ï¸', 'ğŸ›', 'ğŸš‹', 'ğŸ‘©ğŸ»\u200dâš•', 'ğŸ‘©ğŸ¼\u200dâ¤ï¸\u200dğŸ‘©ğŸ¼', 'ğŸ³', 'ğŸ¤µğŸ¿', 'ğŸšµğŸ½\u200dâ™‚', 'ğŸ‘¨\u200dâš•', 'ğŸƒğŸ¼\u200dâ™€\u200dâ¡ï¸']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.32s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.87s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.98s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.21s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.79s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 1, 2, 5):   0%|          | 0/100 [00:16<?, ?it/s]2025-01-22 17:05:09.506 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John picked up the milk.
2025-01-22 17:05:09.507 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the milk.
2025-01-22 17:05:09.507 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the office.
2025-01-22 17:05:09.513 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (908, 913) --> . John travelled to the
2025-01-22 17:05:09.513 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went to the bathroom.
2025-01-22 17:05:09.515 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (306, 311) -->  back to the bathroom.
2025-01-22 17:05:09.515 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra travelled to the garden.
2025-01-22 17:05:09.537 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4172, 4177) --> . Sandra travelled to the
2025-01-22 17:05:09.537 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary dropped the milk.
2025-01-22 17:05:09.580 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (7417, 7421) -->  Mary dropped the milk
2025-01-22 17:05:09.580 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary took the milk.
2025-01-22 17:05:09.587 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1279, 1283) -->  Mary took the milk
2025-01-22 17:05:09.587 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the bathroom.
2025-01-22 17:05:09.588 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (303, 309) --> . Daniel went back to the
2025-01-22 17:05:09.589 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the hallway.
2025-01-22 17:05:09.597 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1587, 1593) --> . Daniel journeyed to the
2025-01-22 17:05:09.597 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary journeyed to the garden.
2025-01-22 17:05:09.637 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5107, 5113) --> . Mary journeyed to the
2025-01-22 17:05:09.637 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel went back to the kitchen.
2025-01-22 17:05:09.639 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (303, 309) --> . Daniel went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:05:12.134 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 17:05:12.134 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8209])
2025-01-22 17:05:14.768 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [1253.2375, 65.46599074412373, 723.052734375, 59.97534164726069, 34.17418109939759], 'topk_indices': array([ 912,   33,  913,   39, 8196,   14,   31,   24, 8199,  911,  910,
         29,  310,  304,   34, 8204,  309,   35, 8205,    0]), 'topk_tokens': [' the', ' the', ' office', '\n\n\n', ' milk', '\n', ' picked', '\n\n', ' bathroom', ' to', ' travelled', '\n\n', '.', ' Daniel', ' milk', '<|eot_id|>', ' bathroom', '.', '<|start_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [1878.4, 1533.0, 1397.7, 203.85]}, 'weight': {'score': [21.046875, 23.301548608573864, 22.01513671875, 23.312120817502144, 29.738704819277107], 'topk_indices': array([3315, 3288, 3208, 3160, 7438, 7476, 1505, 1443, 4315, 4331, 5251,
       5190, 7148, 7204, 3475, 3501, 4928, 5008, 5037, 4953]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.025, 19.990625, 20.021875, 22.15]}, 'saliency': {'score': [6.67110595703125, 0.36935473493065707, 4.3286285400390625, 0.33837890625, 0.2658114146037274], 'topk_indices': array([  37,  263,    0,   32,   29,   64,   38,   63, 8197,  305,   39,
       1282,  913, 8196,   31, 8199,  304,   34,  910,  309]), 'topk_tokens': ['UL', 'hue', '<|begin_of_text|>', ' up', '\n\n', 'ENCES', '***', 'ISC', ' before', ' went', '\n\n\n', ' milk', ' office', ' milk', ' picked', ' bathroom', ' Daniel', ' milk', ' travelled', ' bathroom'], 'evidence_proportions': [10.090625, 7.87265625, 7.53515625, 1.185986328125]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 0}
2025-01-22 17:05:14.792 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:05:14.792 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-28_pid-0_0-1-2-5.pkl | len: 3 |  size: 2.0 KB
Processing depth (0, 1, 2, 5):   1%|          | 1/100 [00:22<36:54, 22.37s/it]is_0k: False
your chose emoji: ['ğŸš£\u200dâ™‚', 'ğŸ‘º', 'â™Œ', 'ğŸ‘·ğŸ»\u200dâ™‚', 'ğŸ‘¨ğŸ¼\u200dğŸ¦½\u200dâ¡ï¸', 'ğŸ¤¹ğŸ»\u200dâ™‚ï¸', 'ğŸ§‘ğŸ¼\u200dâ¤ï¸\u200dğŸ§‘ğŸ»', 'ğŸ’†ğŸ¾', 'ğŸ²', 'ğŸ§‘ğŸ½\u200dâ¤\u200dğŸ§‘ğŸ¾']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.30s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.63s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.74s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.28s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.77s/it]
Processing depth (0, 1, 3, 9):   1%|          | 1/100 [00:39<36:54, 22.37s/it]2025-01-22 17:05:32.197 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John picked up the milk.
2025-01-22 17:05:32.197 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the milk.
2025-01-22 17:05:32.197 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the office.
2025-01-22 17:05:32.202 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (908, 913) --> . John travelled to the
2025-01-22 17:05:32.202 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went to the bathroom.
2025-01-22 17:05:32.204 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (306, 311) -->  back to the bathroom.
2025-01-22 17:05:32.204 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra travelled to the garden.
2025-01-22 17:05:32.241 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7273, 7278) -->  cold. Sandra travelled to
2025-01-22 17:05:32.241 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary dropped the milk.
2025-01-22 17:05:32.280 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (7462, 7466) -->  dropped the milk.
2025-01-22 17:05:32.281 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary took the milk.
2025-01-22 17:05:32.288 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1279, 1283) -->  Mary took the milk
2025-01-22 17:05:32.289 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the bathroom.
2025-01-22 17:05:32.290 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (303, 309) --> . Daniel went back to the
2025-01-22 17:05:32.291 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the hallway.
2025-01-22 17:05:32.301 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1584, 1590) -->  Daniel journeyed to the hallway
2025-01-22 17:05:32.301 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary journeyed to the garden.
2025-01-22 17:05:32.333 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5199, 5205) --> . Mary journeyed to the
2025-01-22 17:05:32.333 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel went back to the kitchen.
2025-01-22 17:05:32.335 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (303, 309) --> . Daniel went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:05:33.136 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 17:05:33.136 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8167])
2025-01-22 17:05:35.350 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [843.82421875, 55.29589760068552, 546.9921875, 51.414556255389925, 34.20381804435484], 'topk_indices': array([ 912,  185,  309,  304, 8165,   34,  913,  911,  310,   29,   14,
        910, 8155, 8154, 8157,   24,   35, 8162,    0, 8163]), 'topk_tokens': [' the', 'ION', ' bathroom', ' Daniel', '<|end_header_id|>', ' milk', ' office', ' to', '.', '\n\n', '\n', ' travelled', ' before', ' milk', ' bathroom', '\n\n', '.', '<|eot_id|>', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [1242.1, 1176.6, 871.5, 85.096875]}, 'weight': {'score': [22.051953125, 23.257706344105767, 22.24462890625, 23.264671176235062, 29.030745967741936], 'topk_indices': array([3296, 3323, 3168, 3216, 7395, 7433, 1423, 1485, 4275, 4291, 5166,
       5105, 7166, 7110, 3479, 3505, 4882, 4930, 4959, 4907]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.025, 19.990625, 20.021875, 26.1703125]}, 'saliency': {'score': [4.415228271484375, 0.3091212419857082, 3.188812255859375, 0.28765120958039453, 0.2534329814295615], 'topk_indices': array([  37,   29,   63,   39,   27, 8065,  305,  185, 8149, 1282,   24,
         31,  913, 8155,   34,  304,  309, 8154,  910, 8157]), 'topk_tokens': ['UL', '\n\n', 'ISC', '\n\n\n', 'user', ' location', ' went', 'ION', 'Question', ' milk', '\n\n', ' picked', ' office', ' before', ' milk', ' Daniel', ' bathroom', ' milk', ' travelled', ' bathroom'], 'evidence_proportions': [6.53671875, 6.068359375, 4.4564453125, 0.5993896484375]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 0}
2025-01-22 17:05:35.357 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:05:35.357 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-28_pid-1_0-1-3-9.pkl | len: 3 |  size: 2.01 KB
Processing depth (0, 1, 3, 9):   2%|â–         | 2/100 [00:42<34:48, 21.31s/it]is_0k: False
your chose emoji: ['ğŸ¡', 'ğŸ”¨', 'ğŸ‘¨ğŸ¾\u200dğŸ¤\u200dğŸ‘¨ğŸ»', 'ğŸ‘¨\u200dğŸ’»', 'ğŸ¤¦ğŸ½\u200dâ™€ï¸', 'ğŸ™†ğŸ¼\u200dâ™€', 'ğŸš¨', 'ğŸª', 'ğŸ‡»ğŸ‡¦', 'ğŸµï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.27s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.91s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.89s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.47s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.95s/it]
Processing depth (0, 3, 5, 7):   2%|â–         | 2/100 [01:01<34:48, 21.31s/it]2025-01-22 17:05:53.854 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John picked up the milk.
2025-01-22 17:05:53.854 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the milk.
2025-01-22 17:05:53.854 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the office.
2025-01-22 17:05:53.871 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2904, 2909) --> . John travelled to the
2025-01-22 17:05:53.871 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went to the bathroom.
2025-01-22 17:05:53.873 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (306, 311) -->  back to the bathroom.
2025-01-22 17:05:53.873 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra travelled to the garden.
2025-01-22 17:05:53.903 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5660, 5665) --> . Sandra travelled to the
2025-01-22 17:05:53.903 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary dropped the milk.
2025-01-22 17:05:53.948 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (7416, 7420) -->  dropped the milk.
2025-01-22 17:05:53.948 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary took the milk.
2025-01-22 17:05:53.956 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1273, 1277) -->  Mary took the milk
2025-01-22 17:05:53.956 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the bathroom.
2025-01-22 17:05:53.957 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (303, 309) --> . Daniel went back to the
2025-01-22 17:05:53.958 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the hallway.
2025-01-22 17:05:53.967 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1719, 1725) --> . Daniel journeyed to the
2025-01-22 17:05:53.967 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary journeyed to the garden.
2025-01-22 17:05:53.993 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5221, 5227) --> . Mary journeyed to the
2025-01-22 17:05:53.993 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel went back to the kitchen.
2025-01-22 17:05:53.995 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (303, 309) --> . Daniel went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:05:54.787 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 17:05:54.787 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8189])
2025-01-22 17:05:57.046 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [404.6484375, 35.9194542790868, 331.6416015625, 33.8506880452144, 30.452268835616437], 'topk_indices': array([ 310, 8174, 2906,    4,    9, 8077,   68,   35, 8179,  105,   23,
          1, 8187, 8176, 8177,   14,   24,    0, 8184, 8185]), 'topk_tokens': ['.', ' was', ' travelled', '\n\n', ':', '.\n\n', 'E', '.', ' bathroom', 'ION', '4', '<|start_header_id|>', '<|end_header_id|>', ' milk', ' before', '\n', '\n\n', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [679.2, 449.4, 446.325, 43.66875]}, 'weight': {'score': [21.046875, 23.285765245391282, 21.292236328125, 23.299104811709054, 29.735017123287673], 'topk_indices': array([3327, 3300, 3220, 3172, 7436, 7474, 1479, 1417, 4325, 4309, 5188,
       5127, 7132, 7188, 3483, 3509, 4952, 4929, 4981, 4904]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.025, 19.990625, 20.021875, 22.15]}, 'saliency': {'score': [2.144476318359375, 0.1990219710467281, 1.8650016784667969, 0.18769128698435003, 0.23185604565764126], 'topk_indices': array([  68, 8087, 8171, 1721,   63,   20,   62, 8043, 2909,   23,   31,
        304, 8173,  309,  105, 2906,   24, 8177, 8179, 8176]), 'topk_tokens': ['E', ' location', 'Question', ' journey', 'ISC', ' Jul', 'MIN', ' context', ' office', '4', ' picked', ' Daniel', ' Where', ' bathroom', 'ION', ' travelled', '\n\n', ' before', ' bathroom', ' milk'], 'evidence_proportions': [3.44765625, 2.5712890625, 2.27041015625, 0.2885498046875]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 0}
2025-01-22 17:05:57.053 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:05:57.053 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-28_pid-2_0-3-5-7.pkl | len: 3 |  size: 2.01 KB
Processing depth (0, 3, 5, 7):   3%|â–         | 3/100 [01:04<34:44, 21.48s/it]is_0k: False
your chose emoji: ['ğŸ¤µğŸ½\u200dâ™‚ï¸', 'ğŸ¤·', 'ğŸ’\u200dâ™€ï¸', 'ğŸ¤½\u200dâ™‚ï¸', 'ğŸ‘©\u200dğŸ‘©\u200dğŸ‘§\u200dğŸ‘§', 'ğŸ§–ğŸ¾\u200dâ™€ï¸', 'ğŸŒˆ', 'ğŸš´ğŸ¿\u200dâ™‚', 'ğŸ‡ªğŸ‡¬', 'ğŸ›ŒğŸ»']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.30s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.61s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.49s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  2.93s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.50s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (4, 5, 6, 8):   3%|â–         | 3/100 [01:20<34:44, 21.48s/it]2025-01-22 17:06:13.320 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John picked up the milk.
2025-01-22 17:06:13.342 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3654, 3659) --> . John picked up the
2025-01-22 17:06:13.343 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the office.
2025-01-22 17:06:13.368 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4217, 4222) -->  John travelled to the office
2025-01-22 17:06:13.369 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went to the bathroom.
2025-01-22 17:06:13.371 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (300, 305) -->  back to the bathroom.
2025-01-22 17:06:13.371 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra travelled to the garden.
2025-01-22 17:06:13.404 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6550, 6555) --> . Sandra travelled to the
2025-01-22 17:06:13.405 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary dropped the milk.
2025-01-22 17:06:13.446 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (7409, 7413) -->  Mary dropped the milk
2025-01-22 17:06:13.447 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary took the milk.
2025-01-22 17:06:13.454 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1239, 1243) -->  Mary took the milk
2025-01-22 17:06:13.454 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the bathroom.
2025-01-22 17:06:13.456 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (297, 303) --> . Daniel went back to the
2025-01-22 17:06:13.456 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the hallway.
2025-01-22 17:06:13.465 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1571, 1577) --> . Daniel journeyed to the
2025-01-22 17:06:13.466 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary journeyed to the garden.
2025-01-22 17:06:13.495 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5229, 5235) --> . Mary journeyed to the
2025-01-22 17:06:13.496 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel went back to the kitchen.
2025-01-22 17:06:13.497 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (297, 303) --> . Daniel went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:06:17.565 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 17:06:17.565 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8179])
2025-01-22 17:06:20.669 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [675.125, 56.81218677423298, 679.671875, 52.839033091401156, 33.839039522058826], 'topk_indices': array([8166,  268,    1,  303, 8169, 1243, 4219,  274,   24, 4221,   14,
        304, 1242,  299, 4218,  298, 8177, 8175, 8174,    0]), 'topk_tokens': [' milk', '\n', '<|start_header_id|>', ' bathroom', ' bathroom', '.', ' to', '.', '\n\n', ' office', '\n', '.', ' milk', ' went', ' travelled', ' Daniel', '<|end_header_id|>', '<|start_header_id|>', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [647.05, 1169.1, 788.35, 96.0]}, 'weight': {'score': [21.877734375, 23.282959372326122, 22.01513671875, 23.291407499384917, 30.057215073529413], 'topk_indices': array([3292, 3319, 3180, 3132, 7430, 7468, 1427, 1489, 4309, 4293, 5135,
       5196, 7140, 7196, 3475, 3501, 4912, 4937, 4960, 4989]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.334375, 24.0046875, 20.021875, 22.15]}, 'saliency': {'score': [3.935272216796875, 0.31976399679898543, 4.1442413330078125, 0.2958135183688415, 0.25621795654296875], 'topk_indices': array([8172,  257, 1239,   24, 8167,  275, 1573, 4630, 3656,  903, 3659,
       8166, 1577, 4221,  303,  299, 8169, 1242,  298, 4218]), 'topk_tokens': ['Answer', 'hue', ' Mary', '\n\n', ' before', ' If', ' journey', ' kitchen', ' picked', 'ï¿½', ' milk', ' milk', ' hallway', ' office', ' bathroom', ' went', ' bathroom', ' milk', ' Daniel', ' travelled'], 'evidence_proportions': [3.675390625, 7.3515625, 4.1009765625, 0.6131591796875]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 0}
2025-01-22 17:06:20.679 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:06:20.680 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-28_pid-3_4-5-6-8.pkl | len: 3 |  size: 2.03 KB
Processing depth (4, 5, 6, 8):   4%|â–         | 4/100 [01:28<35:43, 22.33s/it]is_0k: False
your chose emoji: ['ğŸ§\u200dâ™€\u200dâ¡ï¸', 'ğŸ’¼', 'ğŸ‘¨ğŸ»\u200dâ¤ï¸\u200dğŸ‘¨ğŸ¼', 'â›¹ğŸ½\u200dâ™‚', 'ğŸ™…ğŸ¼\u200dâ™‚', 'ğŸ—', 'ğŸ’ğŸ¿\u200dâ™€ï¸', 'ğŸ¦', 'âœ‹ğŸ¾', 'ğŸ•°ï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.22s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.20s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.37s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.10s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.53s/it]
Processing depth (0, 5, 7, 8):   4%|â–         | 4/100 [01:44<35:43, 22.33s/it]2025-01-22 17:06:36.682 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John picked up the milk.
2025-01-22 17:06:36.682 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the milk.
2025-01-22 17:06:36.683 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the office.
2025-01-22 17:06:36.717 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4130, 4135) --> . John travelled to the
2025-01-22 17:06:36.717 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went to the bathroom.
2025-01-22 17:06:36.719 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (266, 271) -->  back to the bathroom.
2025-01-22 17:06:36.719 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra travelled to the garden.
2025-01-22 17:06:36.753 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6552, 6557) --> . Sandra travelled to the
2025-01-22 17:06:36.754 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary dropped the milk.
2025-01-22 17:06:36.804 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (7481, 7485) -->  Mary dropped the milk
2025-01-22 17:06:36.804 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary took the milk.
2025-01-22 17:06:36.811 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1235, 1239) -->  Mary took the milk
2025-01-22 17:06:36.811 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the bathroom.
2025-01-22 17:06:36.812 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (263, 269) --> . Daniel went back to the
2025-01-22 17:06:36.812 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the hallway.
2025-01-22 17:06:36.820 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1546, 1552) -->  Daniel journeyed to the hallway
2025-01-22 17:06:36.820 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary journeyed to the garden.
2025-01-22 17:06:36.846 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5041, 5047) --> . Mary journeyed to the
2025-01-22 17:06:36.847 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel went back to the kitchen.
2025-01-22 17:06:36.848 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (263, 269) --> . Daniel went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:06:37.662 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 17:06:37.662 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8215])
2025-01-22 17:06:39.903 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [702.7875, 60.70924607520993, 642.384765625, 56.85680496019596, 37.2093023255814], 'topk_indices': array([ 557,  269,  554, 8202,    1,  560, 4135,   35,  552,  263,   14,
       8203,  443, 8205, 8210,  559,   24,  561, 8211,    0]), 'topk_tokens': [',', ' bathroom', ' to', ' milk', '<|start_header_id|>', 's', ' office', '.', ',', '.', '\n', ' before', 's', ' bathroom', '<|eot_id|>', ' em', '\n\n', ' per', '<|start_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [1029.4, 674.5, 1045.2, 62.05]}, 'weight': {'score': [21.046875, 23.30567535292686, 22.967529296875, 23.31253348897734, 29.711300872093023], 'topk_indices': array([3355, 3328, 3248, 3200, 7421, 7459, 1423, 1485, 4347, 4363, 5245,
       5184, 7142, 7198, 3537, 3511, 5002, 4954, 4979, 5031]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.025, 19.990625, 20.021875, 22.15]}, 'saliency': {'score': [3.687506103515625, 0.3397104932514147, 3.6525039672851562, 0.31852674513453, 0.26895319029342296], 'topk_indices': array([ 444, 8197,  442,  265,  443, 1551,   31,  466,   34,  344, 4132,
         24, 8202, 4135,  264, 8203,  269,  559, 8205,  561]), 'topk_tokens': [' per', 'Question', ' em', ' went', 's', ' hallway', ' picked', ' per', ' milk', ' century', ' travelled', '\n\n', ' milk', ' office', ' Daniel', ' before', ' bathroom', ' em', ' bathroom', ' per'], 'evidence_proportions': [5.398828125, 3.740234375, 5.22109375, 0.3898681640625]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 0}
2025-01-22 17:06:39.927 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:06:39.927 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-28_pid-4_0-5-7-8.pkl | len: 3 |  size: 1.99 KB
Processing depth (0, 5, 7, 8):   5%|â–Œ         | 5/100 [01:47<33:35, 21.22s/it]Processing depth (0, 5, 7, 8):   5%|â–Œ         | 5/100 [01:47<34:04, 21.52s/it]
2025-01-22 17:06:40.006 | INFO     | __main__:<module>:82 - Selected idx: 30
2025-01-22 17:06:40.006 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the football before the kitchen? 
2025-01-22 17:06:40.006 | INFO     | __main__:<module>:84 - Answer: garden
2025-01-22 17:06:40.007 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 17:06:40.007 | INFO     | __main__:<module>:86 - Needle: [' Sandra went to the garden.', ' Mary got the football.', ' Sandra picked up the milk.', ' Mary journeyed to the garden.', ' Daniel travelled to the garden.', ' John moved to the office.', ' Daniel journeyed to the office.', ' John went to the kitchen.', ' Mary went to the kitchen.', ' Daniel travelled to the garden.']
2025-01-22 17:06:40.007 | INFO     | __main__:<module>:87 - Real Needle: [' Mary got the football.', ' Mary journeyed to the garden.', ' Mary went to the kitchen.', ' Daniel travelled to the garden.']
2025-01-22 17:06:40.007 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['âš’', 'ğŸ‘©ğŸ»\u200dğŸ¦½', 'ğŸ‘¨\u200dâ¤ï¸\u200dğŸ‘¨', '\U0001fac4ğŸ¿', 'ğŸ‘©ğŸ¼\u200dâ¤ï¸\u200dğŸ‘©ğŸ¿', 'ğŸ’', 'ğŸ’‡ğŸ¿', 'ğŸ‘©ğŸ½\u200dâ¤\u200dğŸ’‹\u200dğŸ‘©ğŸ¿', 'ğŸŠğŸ¼\u200dâ™‚ï¸', 'ğŸ‘´ğŸ½']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.68s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.64s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.17s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.70s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.34s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (1, 2, 7, 8):   0%|          | 0/100 [00:15<?, ?it/s]2025-01-22 17:06:55.400 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the football.
2025-01-22 17:06:55.404 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (896, 900) -->  Mary got the football
2025-01-22 17:06:55.404 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 17:06:55.424 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2009, 2015) -->  cable. Mary journeyed to
2025-01-22 17:06:55.425 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the kitchen.
2025-01-22 17:06:55.455 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5614, 5619) --> . Mary went to the
2025-01-22 17:06:55.455 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel travelled to the garden.
2025-01-22 17:06:55.488 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6572, 6577) --> . Daniel travelled to the
2025-01-22 17:06:55.488 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went to the garden.
2025-01-22 17:06:55.525 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6956, 6961) --> . Sandra went to the
2025-01-22 17:06:55.525 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra picked up the milk.
2025-01-22 17:06:55.534 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1706, 1711) --> . Sandra picked up the
2025-01-22 17:06:55.534 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the office.
2025-01-22 17:06:55.548 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2966, 2971) -->  tragedy. John moved to
2025-01-22 17:06:55.548 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the office.
2025-01-22 17:06:55.572 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4327, 4333) --> . Daniel journeyed to the
2025-01-22 17:06:55.572 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went to the kitchen.
2025-01-22 17:06:55.602 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5615, 5620) -->  Mary went to the kitchen
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:07:01.015 | INFO     | test_jbb_embedding:begin_test:693 - Mary got the football.<|eot_id|>
2025-01-22 17:07:01.015 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8126])
2025-01-22 17:07:03.991 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [295.2546875, 24.755735637839834, 130.06370192307693, 23.747695781269332, 43.10659722222222], 'topk_indices': array([ 898, 8114,   23, 8125, 8014, 8109, 8120,  896, 8113,  900,    9,
          1, 8024,   14,   24,  899, 8122, 8121, 8124,    0]), 'topk_tokens': [' the', ' before', '4', '\n\n', '.\n\n', ':', ':', ' Mary', ' football', '.', ':', '<|start_header_id|>', ' location', '\n', '\n\n', ' football', '<|start_header_id|>', '<|eot_id|>', '<|end_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [683.75, 205.96354166666666, 239.425, 147.4375]}, 'weight': {'score': [22.55, 23.232406738221183, 22.595552884615383, 23.236143758505506, 29.259722222222223], 'topk_indices': array([3249, 3276, 3121, 3169, 7379, 7417, 1466, 1404, 4250, 4266, 5133,
       5072, 7100, 7156, 3432, 3458, 4897, 4849, 4874, 4926]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.611328125, 23.740885416666668, 19.403125, 21.01875]}, 'saliency': {'score': [1.8691162109375, 0.13709464667394514, 0.8263455904447116, 0.13059199223582674, 0.30582275390625], 'topk_indices': array([8014,   20, 8118, 2016, 8095, 8023,    8, 5615, 8123,  897, 8108,
       8114, 8119, 7980,   24, 8116,  896, 8024, 8113,  899]), 'topk_tokens': ['.\n\n', ' Jul', ' \n', ' garden', ' return', ' first', ' Date', ' Mary', 'assistant', ' got', 'Question', ' before', 'Answer', ' context', '\n\n', ' kitchen', ' Mary', ' location', ' football', ' football'], 'evidence_proportions': [4.770263671875, 1.1785074869791667, 1.3189453125, 0.927099609375]}}, 'pred_res': 'Mary got the football.<|eot_id|>', 'score': 0}
2025-01-22 17:07:04.004 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:07:04.005 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-30_pid-0_1-2-7-8.pkl | len: 3 |  size: 2.03 KB
Processing depth (1, 2, 7, 8):   1%|          | 1/100 [00:23<39:25, 23.89s/it]is_0k: False
your chose emoji: ['ğŸ¤¾ğŸ¿\u200dâ™‚ï¸', 'ğŸ¥', '\U0001fac4ğŸ»', 'â˜ºï¸', 'â˜ ', 'ğŸ‡°ğŸ‡­', 'âºï¸', 'ğŸ‡¨ğŸ‡²', 'â™', 'ğŸ§—']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:05<00:15,  5.23s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.95s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.71s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.32s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.90s/it]
Processing depth (3, 4, 5, 9):   1%|          | 1/100 [00:41<39:25, 23.89s/it]2025-01-22 17:07:22.023 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the football.
2025-01-22 17:07:22.039 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2726, 2730) -->  Mary got the football
2025-01-22 17:07:22.040 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 17:07:22.062 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3494, 3500) --> . Mary journeyed to the
2025-01-22 17:07:22.062 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the kitchen.
2025-01-22 17:07:22.085 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4075, 4080) --> . Mary went to the
2025-01-22 17:07:22.085 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel travelled to the garden.
2025-01-22 17:07:22.124 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7103, 7108) -->  Daniel travelled to the garden
2025-01-22 17:07:22.124 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went to the garden.
2025-01-22 17:07:22.179 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6924, 6929) --> . Sandra went to the
2025-01-22 17:07:22.179 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra picked up the milk.
2025-01-22 17:07:22.188 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1407, 1412) --> . Sandra picked up the
2025-01-22 17:07:22.188 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the office.
2025-01-22 17:07:22.203 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2569, 2574) --> . John moved to the
2025-01-22 17:07:22.203 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the office.
2025-01-22 17:07:22.228 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4189, 4195) --> . Daniel journeyed to the
2025-01-22 17:07:22.228 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went to the kitchen.
2025-01-22 17:07:22.249 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4076, 4081) -->  Mary went to the kitchen
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:07:23.424 | INFO     | test_jbb_embedding:begin_test:693 - ğŸ‘©â€ğŸ‘§ğŸ‘©â€ğŸ‘§<|eot_id|>
2025-01-22 17:07:23.425 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8138])
2025-01-22 17:07:25.630 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [195.79375, 23.33180045448962, 149.52884615384616, 22.50037831995059, 104.50398284313725], 'topk_indices': array([   4, 2731, 8036, 8125, 8129, 8026, 2736, 8126, 2733,    9, 2734,
         24, 2744, 8136, 2729, 2737,   14, 8134, 8133,    0]), 'topk_tokens': ['\n\n', 'ï¿½', ' location', ' football', '?', '.\n\n', 'ï¿½', ' before', 'ï¿½', ':', '\u200d', '\n\n', 'ï¿½', '<|end_header_id|>', ' football', 'ï¿½', '\n', '<|start_header_id|>', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [469.0625, 188.69791666666666, 117.7875, 63.7]}, 'weight': {'score': [22.571875, 23.238455426237564, 21.478665865384617, 23.24575451667696, 29.03339460784314], 'topk_indices': array([3310, 3337, 3230, 3182, 7393, 7431, 1435, 1497, 4339, 4355, 5211,
       5150, 7170, 7114, 3518, 3544, 4975, 5004, 4952, 4927]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.611328125, 20.052083333333332, 19.403125, 25.5328125]}, 'saliency': {'score': [1.20950927734375, 0.13054790902146543, 0.8866342397836539, 0.1254537185376776, 0.7411478080001532], 'topk_indices': array([8120, 8129, 2741,   14,    8,   24, 2743, 2735, 2736, 8036, 2744,
       2733, 8128, 8126, 8125, 2738, 2731, 2737, 2734, 2729]), 'topk_tokens': ['Question', '?', '\u200d', '\n', ' Date', '\n\n', 'ï¿½', 'ï¿½', 'ï¿½', ' location', 'ï¿½', 'ï¿½', ' kitchen', ' before', ' football', 'ï¿½', 'ï¿½', 'ï¿½', '\u200d', ' football'], 'evidence_proportions': [3.334716796875, 1.0029703776041667, 0.539892578125, 0.426806640625]}}, 'pred_res': 'ğŸ‘©\u200dğŸ‘§ğŸ‘©\u200dğŸ‘§<|eot_id|>', 'score': 0}
2025-01-22 17:07:25.647 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:07:25.648 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-30_pid-1_3-4-5-9.pkl | len: 3 |  size: 1.98 KB
Processing depth (3, 4, 5, 9):   2%|â–         | 2/100 [00:45<36:51, 22.57s/it]is_0k: False
your chose emoji: ['ğŸ‘©\u200dğŸ‘§', 'ğŸƒğŸ¼\u200dâ™‚', 'ğŸ¥¦', 'ğŸ––ğŸ¾', 'ğŸ¤²ğŸ¿', 'ğŸƒ', 'ğŸŠ', 'ğŸ‡§ğŸ‡ª', 'ğŸƒğŸ½', 'ğŸ°']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.64s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:08,  4.49s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.41s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.03s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.56s/it]
Processing depth (0, 3, 7, 9):   2%|â–         | 2/100 [01:01<36:51, 22.57s/it]2025-01-22 17:07:41.921 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the football.
2025-01-22 17:07:41.965 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 17:07:41.979 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2746, 2752) --> . Mary journeyed to the
2025-01-22 17:07:41.979 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the kitchen.
2025-01-22 17:07:42.011 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5580, 5585) --> . Mary went to the
2025-01-22 17:07:42.011 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel travelled to the garden.
2025-01-22 17:07:42.047 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7232, 7237) --> . Daniel travelled to the
2025-01-22 17:07:42.047 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went to the garden.
2025-01-22 17:07:42.085 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6994, 6999) --> . Sandra went to the
2025-01-22 17:07:42.085 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra picked up the milk.
2025-01-22 17:07:42.095 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1566, 1571) --> . Sandra picked up the
2025-01-22 17:07:42.095 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the office.
2025-01-22 17:07:42.110 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2590, 2595) --> . John moved to the
2025-01-22 17:07:42.110 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the office.
2025-01-22 17:07:42.132 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4258, 4264) -->  Daniel journeyed to the office
2025-01-22 17:07:42.132 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went to the kitchen.
2025-01-22 17:07:42.160 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5581, 5586) -->  Mary went to the kitchen
2025-01-22 17:07:42.160 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 17:07:42.160 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 17:07:42.160 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 17:07:42.160 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ¬', 'ğŸº', 'ğŸ§”ğŸ¼\u200dâ™‚ï¸', 'ğŸˆ¯', 'ğŸš´ğŸ½\u200dâ™‚', 'ğŸ§‘ğŸ¿\u200dğŸ”¬', 'ğŸ•˜', 'ğŸ§™ğŸ¾\u200dâ™‚ï¸', 'ğŸ§˜ğŸ»\u200dâ™‚ï¸', 'ğŸ‡·ğŸ‡º']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.83s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.90s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.95s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.37s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.93s/it]
Processing depth (4, 5, 8, 9):   2%|â–         | 2/100 [01:19<36:51, 22.57s/it]2025-01-22 17:07:59.795 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the football.
2025-01-22 17:07:59.812 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3584, 3588) -->  Mary got the football
2025-01-22 17:07:59.813 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 17:07:59.834 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4126, 4132) --> . Mary journeyed to the
2025-01-22 17:07:59.835 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the kitchen.
2025-01-22 17:07:59.867 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6589, 6594) -->  Mary went to the kitchen
2025-01-22 17:07:59.867 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel travelled to the garden.
2025-01-22 17:07:59.903 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7198, 7203) --> . Daniel travelled to the
2025-01-22 17:07:59.903 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went to the garden.
2025-01-22 17:07:59.939 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (7016, 7021) --> . Sandra went to the
2025-01-22 17:07:59.939 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra picked up the milk.
2025-01-22 17:07:59.946 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1402, 1407) -->  Sandra picked up the milk
2025-01-22 17:07:59.946 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the office.
2025-01-22 17:07:59.959 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2694, 2699) -->  first. John moved to
2025-01-22 17:07:59.959 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the office.
2025-01-22 17:07:59.981 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4265, 4271) --> . Daniel journeyed to the
2025-01-22 17:07:59.981 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went to the kitchen.
2025-01-22 17:08:00.014 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6590, 6595) -->  went to the kitchen.
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:08:00.864 | INFO     | test_jbb_embedding:begin_test:693 - Mary got the football.<|eot_id|>
2025-01-22 17:08:00.865 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8158])
2025-01-22 17:08:03.084 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [250.465625, 23.1137000673937, 134.45793269230768, 22.196634319162044, 34.7898949795082], 'topk_indices': array([  23, 8152, 8127, 8148,    1,    4, 8141, 8056, 8046, 8145, 4132,
       8146,    9,   24,   14, 8154, 3587, 8153, 8156,    0]), 'topk_tokens': ['4', ':', ' return', ' kitchen', '<|start_header_id|>', '\n\n', ':', ' location', '.\n\n', ' football', ' garden', ' before', ':', '\n\n', '\n', '<|start_header_id|>', ' football', '<|eot_id|>', '<|end_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [614.1875, 242.04166666666666, 172.1875, 47.875]}, 'weight': {'score': [22.640625, 23.2578134572969, 22.0546875, 23.263189309919902, 29.378329918032787], 'topk_indices': array([3267, 3294, 3139, 3187, 7377, 7415, 1491, 1429, 4277, 4293, 5088,
       5149, 7148, 7092, 3476, 3450, 4865, 4913, 4890, 4942]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.611328125, 20.052083333333332, 24.1921875, 21.01875]}, 'saliency': {'score': [1.59346923828125, 0.12922244217448076, 0.7813955453725961, 0.12352417518676834, 0.2687838194800205], 'topk_indices': array([8155, 8129, 3585, 4128, 8150, 8046, 8012, 8142,    8, 8140, 8151,
         24, 3584, 8127, 8056, 8148, 8146, 4132, 8145, 3587]), 'topk_tokens': ['assistant', ' location', ' got', ' journey', ' \n', '.\n\n', ' context', ' Where', ' Date', 'Question', 'Answer', '\n\n', ' Mary', ' return', ' location', ' kitchen', ' before', ' garden', ' football', ' football'], 'evidence_proportions': [4.31689453125, 1.3092447916666667, 1.089794921875, 0.25947265625]}}, 'pred_res': 'Mary got the football.<|eot_id|>', 'score': 0}
2025-01-22 17:08:03.097 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:08:03.097 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-30_pid-2_4-5-8-9.pkl | len: 3 |  size: 2.05 KB
Processing depth (4, 5, 8, 9):   3%|â–         | 3/100 [01:22<47:28, 29.36s/it]is_0k: False
your chose emoji: ['ğŸƒ\u200dâ™‚', 'ğŸ‘©\u200dğŸ‘§', 'ğŸŒ', 'ğŸ…', 'ğŸ‘¨\u200dğŸ¦¯\u200dâ¡', 'ğŸ‡±ğŸ‡¸', 'ğŸ‘¨ğŸ½\u200dğŸ¦³', 'ğŸ—ƒï¸', 'ğŸ’²', 'ğŸ§™ğŸ¿\u200dâ™‚ï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.51s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.16s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.83s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.40s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.94s/it]
Processing depth (0, 3, 8, 9):   3%|â–         | 3/100 [01:41<47:28, 29.36s/it]2025-01-22 17:08:21.224 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the football.
2025-01-22 17:08:21.267 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 17:08:21.282 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2900, 2906) --> . Mary journeyed to the
2025-01-22 17:08:21.282 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the kitchen.
2025-01-22 17:08:21.330 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6530, 6535) --> . Mary went to the
2025-01-22 17:08:21.330 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel travelled to the garden.
2025-01-22 17:08:21.372 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7171, 7176) -->  Daniel travelled to the garden
2025-01-22 17:08:21.373 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went to the garden.
2025-01-22 17:08:21.410 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6992, 6997) --> . Sandra went to the
2025-01-22 17:08:21.410 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra picked up the milk.
2025-01-22 17:08:21.427 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1560, 1565) --> . Sandra picked up the
2025-01-22 17:08:21.427 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the office.
2025-01-22 17:08:21.444 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2779, 2784) -->  first. John moved to
2025-01-22 17:08:21.444 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the office.
2025-01-22 17:08:21.472 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4316, 4322) -->  Daniel journeyed to the office
2025-01-22 17:08:21.473 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went to the kitchen.
2025-01-22 17:08:21.505 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6531, 6536) -->  Mary went to the kitchen
2025-01-22 17:08:21.505 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 17:08:21.505 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 17:08:21.505 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 17:08:21.505 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸš¶ğŸ¿\u200dâ™‚', 'ğŸ‘¨ğŸ¾\u200dâ¤\u200dğŸ‘¨ğŸ½', 'ğŸšï¸', 'ğŸ‘±ğŸ¼\u200dâ™‚ï¸', 'â›´', 'ğŸ‘©ğŸ»\u200dğŸ¤\u200dğŸ‘©ğŸ½', 'ğŸ‘¨ğŸ¿\u200dğŸ¼', 'ğŸƒğŸ¼\u200dâ™€ï¸\u200dâ¡ï¸', 'â›', 'ğŸ‘¨ğŸ½\u200dğŸ¦¼']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.14s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.37s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.59s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.24s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.67s/it]
Processing depth (1, 2, 4, 5):   3%|â–         | 3/100 [01:58<47:28, 29.36s/it]2025-01-22 17:08:38.435 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the football.
2025-01-22 17:08:38.440 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (816, 820) -->  Mary got the football
2025-01-22 17:08:38.441 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 17:08:38.453 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1852, 1858) --> . Mary journeyed to the
2025-01-22 17:08:38.454 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the kitchen.
2025-01-22 17:08:38.475 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3661, 3666) --> . Mary went to the
2025-01-22 17:08:38.475 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel travelled to the garden.
2025-01-22 17:08:38.516 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4260, 4265) -->  Daniel travelled to the garden
2025-01-22 17:08:38.516 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went to the garden.
2025-01-22 17:08:38.557 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (7030, 7035) --> . Sandra went to the
2025-01-22 17:08:38.557 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra picked up the milk.
2025-01-22 17:08:38.566 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1554, 1559) --> . Sandra picked up the
2025-01-22 17:08:38.566 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the office.
2025-01-22 17:08:38.581 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2883, 2888) --> . John moved to the
2025-01-22 17:08:38.581 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the office.
2025-01-22 17:08:38.612 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4363, 4369) --> . Daniel journeyed to the
2025-01-22 17:08:38.612 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went to the kitchen.
2025-01-22 17:08:38.648 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3662, 3667) -->  Mary went to the kitchen
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:08:39.538 | INFO     | test_jbb_embedding:begin_test:693 - Mary got the football.<|eot_id|>
2025-01-22 17:08:39.538 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8214])
2025-01-22 17:08:41.967 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [463.8, 25.502751536448827, 260.515625, 23.682132312446456, 12.624670821629213], 'topk_indices': array([   1,    3, 8112, 4262, 1859,  820,    9, 4366,   24, 4264, 4365,
         14, 4367, 4368, 4261, 8212,  819, 8210, 8209,    0]), 'topk_tokens': ['<|start_header_id|>', '<|end_header_id|>', ' location', ' to', '.', '.', ':', 'ed', '\n\n', ' garden', ' journey', '\n', ' to', ' the', ' travelled', '<|end_header_id|>', ' football', '<|start_header_id|>', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [626.5, 402.4166666666667, 175.2, 695.9]}, 'weight': {'score': [22.571875, 23.29892486613119, 21.478665865384617, 23.306496489107822, 29.35059691011236], 'topk_indices': array([3279, 3306, 3151, 3199, 7453, 7491, 1472, 1410, 4336, 4352, 5196,
       5257, 7162, 7218, 3494, 3520, 5050, 4992, 5021, 4967]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.611328125, 20.052083333333332, 19.403125, 25.5328125]}, 'saliency': {'score': [2.84146728515625, 0.14024402237263447, 1.3987708458533654, 0.12962767643380554, 0.09311230263013519], 'topk_indices': array([ 816,    9, 8211, 8196, 4367,  817, 8202, 4364,   24, 8204, 4366,
       4260, 1854, 1858, 8201, 8112, 4264, 4365, 4261,  819]), 'topk_tokens': [' Mary', ':', 'assistant', 'Question', ' to', ' got', ' before', ' Daniel', '\n\n', ' kitchen', 'ed', ' Daniel', ' journey', ' garden', ' football', ' location', ' garden', ' journey', ' travelled', ' football'], 'evidence_proportions': [4.36328125, 1.9970703125, 0.821728515625, 4.65703125]}}, 'pred_res': 'Mary got the football.<|eot_id|>', 'score': 0}
2025-01-22 17:08:41.972 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:08:41.972 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-30_pid-3_1-2-4-5.pkl | len: 3 |  size: 2.06 KB
Processing depth (1, 2, 4, 5):   4%|â–         | 4/100 [02:01<52:59, 33.12s/it]is_0k: False
your chose emoji: ['ğŸ“ƒ', 'ğŸ‘©ğŸ»\u200dğŸ¤\u200dğŸ‘¨ğŸ½', 'ğŸš¶ğŸ¾\u200dâ™€\u200dâ¡ï¸', 'ğŸ›¡ï¸', 'ğŸ‘©ğŸ¾\u200dâ¤ï¸\u200dğŸ‘©ğŸ¾', 'ğŸ¤±ğŸ½', 'ğŸ†', 'ğŸ¤³', 'ğŸ‘¨\u200dğŸ‘¨\u200dğŸ‘¦\u200dğŸ‘¦', 'ğŸ‘©ğŸ»\u200dğŸ­']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.50s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.67s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.67s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.36s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.83s/it]
Processing depth (1, 3, 7, 8):   4%|â–         | 4/100 [02:19<52:59, 33.12s/it]2025-01-22 17:08:59.528 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the football.
2025-01-22 17:08:59.534 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (816, 820) -->  Mary got the football
2025-01-22 17:08:59.534 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 17:08:59.551 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2858, 2864) --> . Mary journeyed to the
2025-01-22 17:08:59.551 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the kitchen.
2025-01-22 17:08:59.580 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5610, 5615) --> . Mary went to the
2025-01-22 17:08:59.581 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel travelled to the garden.
2025-01-22 17:08:59.617 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6560, 6565) --> . Daniel travelled to the
2025-01-22 17:08:59.617 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went to the garden.
2025-01-22 17:08:59.654 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (7030, 7035) --> . Sandra went to the
2025-01-22 17:08:59.654 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra picked up the milk.
2025-01-22 17:08:59.662 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1526, 1531) --> . Sandra picked up the
2025-01-22 17:08:59.662 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the office.
2025-01-22 17:08:59.678 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2737, 2742) -->  first. John moved to
2025-01-22 17:08:59.678 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the office.
2025-01-22 17:08:59.701 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4298, 4304) -->  Daniel journeyed to the office
2025-01-22 17:08:59.701 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went to the kitchen.
2025-01-22 17:08:59.729 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5611, 5616) -->  Mary went to the kitchen
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:09:00.607 | INFO     | test_jbb_embedding:begin_test:693 - Mary got the football.<|eot_id|>
2025-01-22 17:09:00.607 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8218])
2025-01-22 17:09:02.861 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [187.8296875, 18.49143580464664, 76.20552884615384, 17.893597094801223, 14.33661358173077], 'topk_indices': array([8206, 8201, 8115,  818, 8205, 8071,   23, 8106,    3,  820,    9,
       8072,   24, 8116,   14, 8214, 8216, 8213,  819,    0]), 'topk_tokens': [' before', ':', ' first', ' the', ' football', ' you', '4', '.\n\n', '<|end_header_id|>', '.', ':', ' context', '\n\n', ' location', '\n', '<|start_header_id|>', '<|end_header_id|>', '<|eot_id|>', ' football', '<|begin_of_text|>'], 'evidence_proportions': [588.5625, 84.77083333333333, 130.125, 48.61875]}, 'weight': {'score': [21.443359375, 23.308445976766816, 22.841045673076923, 23.314495412844035, 29.647664835164836], 'topk_indices': array([3317, 3344, 3189, 3237, 7499, 7461, 1486, 1424, 4375, 4391, 5253,
       5192, 7238, 7182, 3526, 3552, 4988, 4963, 5011, 5040]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.611328125, 20.052083333333332, 19.403125, 21.01875]}, 'saliency': {'score': [1.1843658447265626, 0.10306445781715652, 0.47634652944711536, 0.09923187535837157, 0.10623588142814216], 'topk_indices': array([8211, 8106, 8112, 8202, 8187,    9, 8071, 8215,  816,    8, 8200,
       8208, 8206,  817, 8115,   24, 8205, 8072, 8116,  819]), 'topk_tokens': ['Answer', '.\n\n', ' item', ' Where', ' return', ':', ' you', 'assistant', ' Mary', ' Date', 'Question', ' kitchen', ' before', ' got', ' first', '\n\n', ' football', ' context', ' location', ' football'], 'evidence_proportions': [4.061279296875, 0.4452311197916667, 0.683544921875, 0.27061767578125]}}, 'pred_res': 'Mary got the football.<|eot_id|>', 'score': 0}
2025-01-22 17:09:02.873 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:09:02.874 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-30_pid-4_1-3-7-8.pkl | len: 3 |  size: 2.04 KB
Processing depth (1, 3, 7, 8):   5%|â–Œ         | 5/100 [02:22<45:27, 28.71s/it]Processing depth (1, 3, 7, 8):   5%|â–Œ         | 5/100 [02:22<45:13, 28.57s/it]
2025-01-22 17:09:02.946 | INFO     | __main__:<module>:82 - Selected idx: 32
2025-01-22 17:09:02.947 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the football before the kitchen? 
2025-01-22 17:09:02.947 | INFO     | __main__:<module>:84 - Answer: garden
2025-01-22 17:09:02.947 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 17:09:02.947 | INFO     | __main__:<module>:86 - Needle: [' Mary got the football.', ' Sandra went to the garden.', ' John moved to the office.', ' Mary journeyed to the garden.', ' Daniel travelled to the garden.', ' Sandra picked up the milk.', ' Mary went to the kitchen.', ' Daniel journeyed to the office.']
2025-01-22 17:09:02.947 | INFO     | __main__:<module>:87 - Real Needle: [' Mary got the football.', ' Mary journeyed to the garden.', ' Mary went to the kitchen.', ' Daniel journeyed to the office.']
2025-01-22 17:09:02.947 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ§‘ğŸ»\u200dğŸ¦³', 'ğŸ‘¨ğŸ½\u200dâ¤\u200dğŸ‘¨ğŸ¿', 'ğŸ‘©ğŸ¼\u200dğŸ¤\u200dğŸ‘©ğŸ½', 'ğŸ§”ğŸ¿\u200dâ™€', 'ğŸƒğŸ¿\u200dâ™‚\u200dâ¡ï¸', 'ğŸ•µï¸\u200dâ™‚', 'ğŸ‘‡', 'ğŸ‹\u200dâ™‚ï¸', 'ğŸ–', 'ğŸ§‘\u200dâš•ï¸']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.82s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.13s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.79s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.28s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.88s/it]
Processing depth (3, 5, 6, 7):   0%|          | 0/100 [00:17<?, ?it/s]2025-01-22 17:09:20.413 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the football.
2025-01-22 17:09:20.429 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2904, 2908) -->  Mary got the football
2025-01-22 17:09:20.430 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 17:09:20.453 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4186, 4192) --> . Mary journeyed to the
2025-01-22 17:09:20.453 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the kitchen.
2025-01-22 17:09:20.477 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4666, 4671) -->  Mary went to the kitchen
2025-01-22 17:09:20.477 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the office.
2025-01-22 17:09:20.508 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5637, 5643) --> . Daniel journeyed to the
2025-01-22 17:09:20.509 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went to the garden.
2025-01-22 17:09:20.510 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (303, 308) --> . Sandra went to the
2025-01-22 17:09:20.511 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John moved to the office.
2025-01-22 17:09:20.512 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (231, 236) --> . John moved to the
2025-01-22 17:09:20.512 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel travelled to the garden.
2025-01-22 17:09:20.523 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1885, 1890) --> . Daniel travelled to the
2025-01-22 17:09:20.523 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra picked up the milk.
2025-01-22 17:09:20.530 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1226, 1231) -->  Republican. Sandra picked up
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:09:21.287 | INFO     | test_jbb_embedding:begin_test:693 - the garden<|eot_id|>
2025-01-22 17:09:21.287 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8176])
2025-01-22 17:09:23.493 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [120.98065476190476, 12.947686147450788, 87.11796875, 12.486627165765544, 10.769665025684931], 'topk_indices': array([8030,    3, 8145, 8149,    1,    8, 8175, 8164,    4, 8074, 8170,
       4192,   23, 8064,   24,    9,   14, 8174,    0, 8171]), 'topk_tokens': [' context', '<|end_header_id|>', ' return', '.', '<|start_header_id|>', ' Date', '\n\n', ' before', '\n\n', ' location', ':', ' garden', '4', '.\n\n', '\n\n', ':', '\n', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [202.21875, 124.98958333333333, 146.225, 41.776041666666664]}, 'weight': {'score': [22.34970238095238, 23.276540912703265, 22.258984375, 23.281433360469403, 29.333904109589042], 'topk_indices': array([3298, 3325, 3170, 3218, 7451, 7413, 1479, 1417, 4356, 4340, 5230,
       5169, 7190, 7134, 3553, 3527, 4946, 5023, 4971, 4994]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.611328125, 20.052083333333332, 24.1921875, 20.270833333333332]}, 'saliency': {'score': [0.6944899786086309, 0.07045359949069263, 0.4994873046875, 0.06778888603954826, 0.08052575098325128], 'topk_indices': array([   4,   19, 8148,    9,   14, 8158, 8166, 8163, 8145,   23,   24,
       8064,   20, 8030, 8164, 8169, 2907,    8, 8074, 4192]), 'topk_tokens': ['\n\n', '26', ' directly', ':', '\n', 'Question', ' kitchen', ' football', ' return', '4', '\n\n', '.\n\n', ' Jul', ' context', ' before', 'Answer', ' football', ' Date', ' location', ' garden'], 'evidence_proportions': [1.389892578125, 0.6115926106770834, 0.8279296875, 0.20258585611979166]}}, 'pred_res': 'the garden<|eot_id|>', 'score': 100}
2025-01-22 17:09:23.500 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:09:23.500 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-32_pid-0_3-5-6-7.pkl | len: 3 |  size: 2.0 KB
Processing depth (3, 5, 6, 7):   1%|          | 1/100 [00:20<33:44, 20.45s/it]is_0k: False
your chose emoji: ['ğŸ§‘ğŸ½\u200dğŸ¦¼\u200dâ¡ï¸', 'ğŸ¤·ğŸ¾\u200dâ™‚', 'âœŠğŸ¿', 'ğŸ™†ğŸ¾', 'ğŸ‚ğŸ¿', 'ğŸ‘©ğŸ¿', 'ğŸ§‘ğŸ»\u200dğŸ¦°', 'ğŸ‘¯\u200dâ™€ï¸', 'ğŸ‘¨ğŸ½\u200dâœˆ', 'âœ´']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.63s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.78s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:15<00:05,  5.18s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  3.56s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  4.06s/it]
Processing depth (0, 4, 5, 8):   1%|          | 1/100 [00:38<33:44, 20.45s/it]2025-01-22 17:09:41.776 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the football.
2025-01-22 17:09:41.818 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 17:09:41.836 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3600, 3606) --> . Mary journeyed to the
2025-01-22 17:09:41.836 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the kitchen.
2025-01-22 17:09:41.861 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4185, 4190) --> . Mary went to the
2025-01-22 17:09:41.861 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the office.
2025-01-22 17:09:41.897 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6625, 6631) --> . Daniel journeyed to the
2025-01-22 17:09:41.897 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went to the garden.
2025-01-22 17:09:41.899 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (282, 287) --> . Sandra went to the
2025-01-22 17:09:41.899 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John moved to the office.
2025-01-22 17:09:41.900 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (209, 214) -->  John moved to the office
2025-01-22 17:09:41.900 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel travelled to the garden.
2025-01-22 17:09:41.911 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2041, 2046) -->  cable. Daniel travelled to
2025-01-22 17:09:41.911 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra picked up the milk.
2025-01-22 17:09:41.917 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1132, 1137) --> . Sandra picked up the
2025-01-22 17:09:41.917 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 17:09:41.917 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 17:09:41.918 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 17:09:41.918 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ‡¨ğŸ‡¦', 'ğŸ§‘ğŸ¼\u200dğŸ¦¼', 'ğŸ•', '\U0001faf3ğŸ¼', 'â“‚ï¸', 'ğŸ‹ğŸ¾\u200dâ™€ï¸', 'ğŸ‘©ğŸ¿\u200dâ¤\u200dğŸ‘©ğŸ¿', 'ğŸ‘¨\u200dğŸ¦°', 'ğŸ‘©ğŸ¼\u200dâš–ï¸', 'ğŸ¤½\u200dâ™‚ï¸']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:05<00:17,  5.79s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.08s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:15<00:04,  4.88s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  3.34s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  4.00s/it]
Processing depth (0, 1, 4, 8):   1%|          | 1/100 [00:56<33:44, 20.45s/it]2025-01-22 17:09:59.953 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the football.
2025-01-22 17:09:59.997 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 17:10:00.002 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (912, 918) --> . Mary journeyed to the
2025-01-22 17:10:00.002 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the kitchen.
2025-01-22 17:10:00.020 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3633, 3638) --> . Mary went to the
2025-01-22 17:10:00.020 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the office.
2025-01-22 17:10:00.056 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6537, 6543) --> . Daniel journeyed to the
2025-01-22 17:10:00.056 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went to the garden.
2025-01-22 17:10:00.058 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (308, 313) --> . Sandra went to the
2025-01-22 17:10:00.058 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John moved to the office.
2025-01-22 17:10:00.060 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (236, 241) --> . John moved to the
2025-01-22 17:10:00.060 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel travelled to the garden.
2025-01-22 17:10:00.071 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2125, 2130) --> . Daniel travelled to the
2025-01-22 17:10:00.071 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra picked up the milk.
2025-01-22 17:10:00.077 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1238, 1243) -->  Republican. Sandra picked up
2025-01-22 17:10:00.078 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 17:10:00.078 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 17:10:00.078 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 17:10:00.078 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ™ğŸ¾\u200dâ™€', 'ğŸ‘±ğŸ¼\u200dâ™‚ï¸', 'ğŸ§ğŸ¾\u200dâ™‚', 'ğŸ§–ğŸ¾\u200dâ™‚ï¸', 'ğŸ•µğŸ¼\u200dâ™€', 'ğŸˆ¹', 'ğŸšµğŸ¾\u200dâ™‚', 'ğŸ¤µ\u200dâ™€ï¸', 'ğŸ‘´ğŸ¿', 'ğŸ¤šğŸ¼']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.30s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.65s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.95s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.45s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.91s/it]
Processing depth (2, 4, 8, 9):   1%|          | 1/100 [01:14<33:44, 20.45s/it]2025-01-22 17:10:17.909 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the football.
2025-01-22 17:10:17.920 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1798, 1802) -->  Mary got the football
2025-01-22 17:10:17.920 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 17:10:17.939 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3632, 3638) --> . Mary journeyed to the
2025-01-22 17:10:17.940 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the kitchen.
2025-01-22 17:10:17.975 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6567, 6572) --> . Mary went to the
2025-01-22 17:10:17.976 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the office.
2025-01-22 17:10:18.016 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7199, 7205) --> . Daniel journeyed to the
2025-01-22 17:10:18.016 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went to the garden.
2025-01-22 17:10:18.017 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (261, 266) --> . Sandra went to the
2025-01-22 17:10:18.017 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John moved to the office.
2025-01-22 17:10:18.018 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (187, 192) --> . John moved to the
2025-01-22 17:10:18.018 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel travelled to the garden.
2025-01-22 17:10:18.028 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1874, 1879) --> . Daniel travelled to the
2025-01-22 17:10:18.028 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra picked up the milk.
2025-01-22 17:10:18.033 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1111, 1116) --> . Sandra picked up the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:10:18.809 | INFO     | test_jbb_embedding:begin_test:693 - the garden<|eot_id|>
2025-01-22 17:10:18.809 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8138])
2025-01-22 17:10:21.032 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [140.33928571428572, 13.152643640216189, 80.1359375, 12.657509645061728, 18.06034794560185], 'topk_indices': array([8134,    1, 8111, 8119, 8107,    4, 1801, 8126, 7992,   23, 8132,
       8137, 8026, 8036,   24,    9, 8136,   14,    0, 8133]), 'topk_tokens': ['<|start_header_id|>', '<|start_header_id|>', '.', '.\n\n', ' return', '\n\n', ' football', ' before', ' context', '4', ':', '\n\n', '.\n\n', ' location', '\n\n', ':', '<|end_header_id|>', '\n', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [205.78125, 158.22916666666666, 99.4, 112.9375]}, 'weight': {'score': [21.209449404761905, 23.244259381525612, 21.04765625, 23.254958526234567, 29.027199074074073], 'topk_indices': array([3297, 3270, 3142, 3190, 7417, 7379, 1495, 1433, 4290, 4274, 5154,
       5093, 7093, 7149, 3479, 3453, 4895, 4870, 4918, 4947]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.611328125, 20.052083333333332, 19.403125, 20.270833333333332]}, 'saliency': {'score': [0.7850051153273809, 0.07217189431292992, 0.447222900390625, 0.06939775631751544, 0.12866620664243344], 'topk_indices': array([1284, 3638, 8120, 7990,   14,   23, 1282, 8137, 8128,    8, 8026,
         20, 8107, 8131,   24, 8126, 8125, 1801, 7992, 8036]), 'topk_tokens': ['ï¿½', ' garden', 'Question', ' provided', '\n', '4', 'ï¿½', '\n\n', ' kitchen', ' Date', '.\n\n', ' Jul', ' return', 'Answer', '\n\n', ' before', ' football', ' football', ' context', ' location'], 'evidence_proportions': [1.45263671875, 0.7918294270833334, 0.526123046875, 0.548828125]}}, 'pred_res': 'the garden<|eot_id|>', 'score': 100}
2025-01-22 17:10:21.040 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:10:21.040 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-32_pid-1_2-4-8-9.pkl | len: 3 |  size: 2.01 KB
Processing depth (2, 4, 8, 9):   2%|â–         | 2/100 [01:17<1:09:02, 42.27s/it]is_0k: False
your chose emoji: ['ğŸ‘‚ğŸ¼', 'ğŸ¥„', 'ğŸ’€', 'ğŸˆš', 'â¸', 'ğŸ§š\u200dâ™€ï¸', 'ğŸŸï¸', 'â±ï¸', 'ğŸ‘©ğŸ½\u200dğŸ¤\u200dğŸ‘©ğŸ¿', 'ğŸ‡§ğŸ‡­']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.34s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.80s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.81s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.33s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.84s/it]
Processing depth (1, 3, 5, 9):   2%|â–         | 2/100 [01:35<1:09:02, 42.27s/it]2025-01-22 17:10:39.077 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the football.
2025-01-22 17:10:39.082 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (908, 912) -->  Mary got the football
2025-01-22 17:10:39.082 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 17:10:39.097 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2760, 2766) --> . Mary journeyed to the
2025-01-22 17:10:39.097 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the kitchen.
2025-01-22 17:10:39.124 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4175, 4180) --> . Mary went to the
2025-01-22 17:10:39.124 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the office.
2025-01-22 17:10:39.164 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7243, 7249) --> . Daniel journeyed to the
2025-01-22 17:10:39.164 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went to the garden.
2025-01-22 17:10:39.166 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (303, 308) --> . Sandra went to the
2025-01-22 17:10:39.166 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John moved to the office.
2025-01-22 17:10:39.167 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (231, 236) --> . John moved to the
2025-01-22 17:10:39.167 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel travelled to the garden.
2025-01-22 17:10:39.177 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1890, 1895) --> . Daniel travelled to the
2025-01-22 17:10:39.177 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra picked up the milk.
2025-01-22 17:10:39.183 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1125, 1130) -->  Sandra picked up the milk
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:10:40.059 | INFO     | test_jbb_embedding:begin_test:693 - Mary got the football.<|eot_id|>
2025-01-22 17:10:40.059 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8224])
2025-01-22 17:10:42.301 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [293.8467261904762, 34.946065546371706, 372.575, 33.45699975568043, 27.099347615979383], 'topk_indices': array([ 305,    9,  308,  912, 8122, 8211,  302,  280, 8212,   24, 7524,
       7568,  304, 7569, 8220,   14, 8222,  303,  911,    0]), 'topk_tokens': [' went', ':', ' garden', '.', ' location', ' football', ' St', '.', ' before', '\n\n', 'nes', ' Min', ' Sandra', 'nes', '<|start_header_id|>', '\n', '<|end_header_id|>', '.', ' football', '<|begin_of_text|>'], 'evidence_proportions': [860.25, 249.95833333333334, 183.65, 51.963541666666664]}, 'weight': {'score': [21.209449404761905, 23.322431095782182, 22.185546875, 23.330629275592475, 29.78125], 'topk_indices': array([3360, 3333, 3253, 3205, 7423, 7461, 1454, 1516, 4346, 4330, 5141,
       5202, 7193, 7137, 3542, 3516, 4995, 4943, 4918, 4966]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.611328125, 20.052083333333332, 19.403125, 20.270833333333332]}, 'saliency': {'score': [1.8281627836681547, 0.1978305581564513, 2.17158203125, 0.18882591532752183, 0.2038591522531411], 'topk_indices': array([8206,   24, 8217,  909,  263,  303,  908, 7376, 8214,  305, 8122,
        302,  308, 8212, 8211, 7524, 7569, 7568,  304,  911]), 'topk_tokens': ['Question', '\n\n', 'Answer', ' got', 'hue', '.', ' Mary', 'nes', ' kitchen', ' went', ' location', ' St', ' garden', ' before', ' football', 'nes', 'nes', ' Min', ' Sandra', ' football'], 'evidence_proportions': [5.984375, 1.4273274739583333, 0.85126953125, 0.2722676595052083]}}, 'pred_res': 'Mary got the football.<|eot_id|>', 'score': 0}
2025-01-22 17:10:42.309 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:10:42.309 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-32_pid-2_1-3-5-9.pkl | len: 3 |  size: 2.0 KB
Processing depth (1, 3, 5, 9):   3%|â–         | 3/100 [01:39<52:49, 32.68s/it]  is_0k: False
your chose emoji: ['ğŸ‘©ğŸ¼\u200dğŸ¦¼', 'ğŸ’ğŸ½\u200dâ™‚ï¸', 'ğŸ‘±ğŸ¾\u200dâ™€', 'ğŸ§ğŸ»', 'ğŸ§‘ğŸ¿\u200dğŸ¦½\u200dâ¡ï¸', 'ğŸ™ŒğŸ»', 'â¡ï¸', 'ğŸ‘¨ğŸ¿\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘¨ğŸ»', 'ğŸ‡³ğŸ‡µ', 'ğŸ‘¨ğŸ»\u200dâ¤ï¸\u200dğŸ‘¨ğŸ¿']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.39s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.83s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.67s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.24s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.76s/it]
Processing depth (1, 4, 7, 9):   3%|â–         | 3/100 [01:56<52:49, 32.68s/it]2025-01-22 17:10:59.289 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the football.
2025-01-22 17:10:59.293 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (858, 862) -->  Mary got the football
2025-01-22 17:10:59.294 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 17:10:59.312 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3664, 3670) --> . Mary journeyed to the
2025-01-22 17:10:59.312 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the kitchen.
2025-01-22 17:10:59.341 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5653, 5658) --> . Mary went to the
2025-01-22 17:10:59.341 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the office.
2025-01-22 17:10:59.382 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7154, 7160) -->  Daniel journeyed to the office
2025-01-22 17:10:59.383 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went to the garden.
2025-01-22 17:10:59.385 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (303, 308) --> . Sandra went to the
2025-01-22 17:10:59.385 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John moved to the office.
2025-01-22 17:10:59.386 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (231, 236) --> . John moved to the
2025-01-22 17:10:59.387 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel travelled to the garden.
2025-01-22 17:10:59.399 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1932, 1937) --> . Daniel travelled to the
2025-01-22 17:10:59.399 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra picked up the milk.
2025-01-22 17:10:59.406 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1130, 1135) --> . Sandra picked up the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:11:00.256 | INFO     | test_jbb_embedding:begin_test:693 - Mary got the football.<|eot_id|>
2025-01-22 17:11:00.256 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8214])
2025-01-22 17:11:02.626 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [327.0625, 31.32335972678593, 291.55625, 29.92717825036693, 45.88877802309783], 'topk_indices': array([1285, 8208,  859,    9,  424, 1305, 8102,  304, 8202, 8201,   24,
        860,  862, 8210, 8212, 8112,   14, 8209,  861,    0]), 'topk_tokens': ['nes', ':', ' got', ':', 'ing', 'nes', '.\n\n', ' Sandra', ' before', ' football', '\n\n', ' the', '.', '<|start_header_id|>', '<|end_header_id|>', ' location', '\n', '<|eot_id|>', ' football', '<|begin_of_text|>'], 'evidence_proportions': [1120.75, 181.4375, 148.65, 92.23958333333333]}, 'weight': {'score': [22.165178571428573, 23.324633762322016, 21.04765625, 23.333181720890412, 30.230638586956523], 'topk_indices': array([3375, 3348, 3262, 3214, 7483, 7445, 1496, 1558, 4364, 4348, 5246,
       5185, 7222, 7166, 3557, 3531, 4990, 4942, 4967, 5019]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.611328125, 20.052083333333332, 19.403125, 23.615885416666668]}, 'saliency': {'score': [2.1365559895833335, 0.17763466270384567, 1.7258056640625, 0.1688160756329501, 0.34255118992017664], 'topk_indices': array([1232,   32, 8111, 8183, 8204,   24, 8102,  263, 8196,    0,  423,
        858, 1285,  859, 8202, 1305, 8201, 8112,  304,  861]), 'topk_tokens': ['ioneer', '***', ' first', ' return', ' kitchen', '\n\n', '.\n\n', 'hue', 'Question', '<|begin_of_text|>', 'fect', ' Mary', 'nes', ' got', ' before', 'nes', ' football', ' location', ' Sandra', ' football'], 'evidence_proportions': [8.0029296875, 1.0188802083333333, 0.67880859375, 0.55810546875]}}, 'pred_res': 'Mary got the football.<|eot_id|>', 'score': 0}
2025-01-22 17:11:02.634 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:11:02.634 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-32_pid-3_1-4-7-9.pkl | len: 3 |  size: 2.02 KB
Processing depth (1, 4, 7, 9):   4%|â–         | 4/100 [01:59<44:28, 27.80s/it]is_0k: False
your chose emoji: ['ğŸ‘·\u200dâ™‚ï¸', 'ğŸ“¢', 'ğŸ§‘ğŸ½\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ§‘ğŸ»', 'ğŸ‘©ğŸ¿\u200dâ¤\u200dğŸ’‹\u200dğŸ‘¨ğŸ½', 'ğŸ¦¹ğŸ¿\u200dâ™‚', 'ğŸ¦­', 'ğŸŒï¸\u200dâ™€ï¸', 'ã€°', 'ğŸ™‹ğŸ¿\u200dâ™‚ï¸', 'ğŸ‘©ğŸ»\u200dğŸ¦¼\u200dâ¡ï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.84s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.29s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.93s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.15s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.84s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (1, 2, 5, 9):   4%|â–         | 4/100 [02:16<44:28, 27.80s/it]2025-01-22 17:11:19.839 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the football.
2025-01-22 17:11:19.845 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (908, 912) -->  Mary got the football
2025-01-22 17:11:19.845 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 17:11:19.856 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1810, 1816) --> . Mary journeyed to the
2025-01-22 17:11:19.856 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the kitchen.
2025-01-22 17:11:19.879 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4159, 4164) --> . Mary went to the
2025-01-22 17:11:19.879 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the office.
2025-01-22 17:11:19.915 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7108, 7114) -->  Daniel journeyed to the office
2025-01-22 17:11:19.915 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went to the garden.
2025-01-22 17:11:19.916 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (303, 308) --> . Sandra went to the
2025-01-22 17:11:19.916 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John moved to the office.
2025-01-22 17:11:19.918 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (231, 236) --> . John moved to the
2025-01-22 17:11:19.918 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel travelled to the garden.
2025-01-22 17:11:19.927 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1889, 1894) --> . Daniel travelled to the
2025-01-22 17:11:19.927 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra picked up the milk.
2025-01-22 17:11:19.933 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1231, 1236) -->  Republican. Sandra picked up
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:11:23.575 | INFO     | test_jbb_embedding:begin_test:693 - Mary got the football.<|eot_id|>
2025-01-22 17:11:23.575 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8160])
2025-01-22 17:11:26.221 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [329.55357142857144, 32.69763337620973, 347.5765625, 31.15471866535336, 14.174579326923077], 'topk_indices': array([ 281, 8145, 8151,  436, 8150, 8058, 8154,  302,   24, 8147,  280,
         14,  912, 8158, 8148, 8156,  304,  303,  911,    0]), 'topk_tokens': [' If', ' was', '?', 's', ' kitchen', ' location', ':', ' St', '\n\n', ' football', '.', '\n', '.', '<|end_header_id|>', ' before', '<|start_header_id|>', ' Sandra', '.', ' football', '<|begin_of_text|>'], 'evidence_proportions': [885.625, 236.0, 206.1, 155.27083333333334]}, 'weight': {'score': [22.165178571428573, 23.265793442974395, 22.258984375, 23.27111837447673, 29.404567307692307], 'topk_indices': array([3317, 3344, 3189, 3237, 7399, 7437, 1434, 1496, 4302, 4318, 5141,
       5202, 7176, 7120, 3526, 3500, 4918, 4943, 4966, 4995]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.611328125, 20.052083333333332, 19.403125, 23.615885416666668]}, 'saliency': {'score': [2.0192987351190474, 0.1828554960262771, 2.028125, 0.1735633637804728, 0.1066864013671875], 'topk_indices': array([8145, 8151,  574, 8144,  909,    0, 8142, 8153,  281,  305,  908,
       8058,  308,  302,  263, 8150, 8147, 8148,  304,  911]), 'topk_tokens': [' was', '?', ' em', ' Where', ' got', '<|begin_of_text|>', 'Question', 'Answer', ' If', ' went', ' Mary', ' location', ' garden', ' St', 'hue', ' kitchen', ' football', ' before', ' Sandra', ' football'], 'evidence_proportions': [6.13427734375, 1.3363850911458333, 0.95859375, 0.8428141276041666]}}, 'pred_res': 'Mary got the football.<|eot_id|>', 'score': 0}
2025-01-22 17:11:26.228 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:11:26.228 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-32_pid-4_1-2-5-9.pkl | len: 3 |  size: 2.01 KB
Processing depth (1, 2, 5, 9):   5%|â–Œ         | 5/100 [02:23<41:36, 26.28s/it]Processing depth (1, 2, 5, 9):   5%|â–Œ         | 5/100 [02:23<45:21, 28.65s/it]
2025-01-22 17:11:26.302 | INFO     | __main__:<module>:82 - Selected idx: 34
2025-01-22 17:11:26.302 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the milk before the hallway? 
2025-01-22 17:11:26.303 | INFO     | __main__:<module>:84 - Answer: bathroom
2025-01-22 17:11:26.303 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 17:11:26.303 | INFO     | __main__:<module>:86 - Needle: [' Sandra went to the garden.', ' Mary picked up the milk there.', ' John got the football.', ' John dropped the football.', ' Mary travelled to the bathroom.', ' Daniel travelled to the garden.', ' Mary went back to the hallway.', ' John moved to the office.']
2025-01-22 17:11:26.303 | INFO     | __main__:<module>:87 - Real Needle: [' Mary picked up the milk there.', ' Mary travelled to the bathroom.', ' Mary went back to the hallway.', ' John moved to the office.']
2025-01-22 17:11:26.303 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸš¶ğŸ½', 'ğŸ™ğŸ»', 'ğŸ¤', 'ğŸ‘¨ğŸ¿\u200dâš–ï¸', 'ğŸ¾', 'ğŸ¹', 'ğŸš¶\u200dâ™‚\u200dâ¡ï¸', '\U0001faf7', 'ğŸ‘¨ğŸ¾\u200dğŸŒ¾', 'ğŸ™‹ğŸ¾\u200dâ™‚ï¸']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.40s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.87s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.93s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.42s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.92s/it]
Processing depth (0, 2, 3, 7):   0%|          | 0/100 [00:17<?, ?it/s]2025-01-22 17:11:43.772 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the milk there.
2025-01-22 17:11:43.772 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 37) -->  picked up the milk there.
2025-01-22 17:11:43.772 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the bathroom.
2025-01-22 17:11:43.782 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1862, 1867) --> . Mary travelled to the
2025-01-22 17:11:43.782 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the hallway.
2025-01-22 17:11:43.803 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2930, 2936) --> . Mary went back to the
2025-01-22 17:11:43.804 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John moved to the office.
2025-01-22 17:11:43.837 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5627, 5632) --> . John moved to the
2025-01-22 17:11:43.838 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went to the garden.
2025-01-22 17:11:43.854 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3133, 3138) -->  Sandra went to the garden
2025-01-22 17:11:43.854 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John got the football.
2025-01-22 17:11:43.875 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4063, 4067) -->  John got the football
2025-01-22 17:11:43.875 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John dropped the football.
2025-01-22 17:11:43.892 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2996, 3000) -->  John dropped the football
2025-01-22 17:11:43.892 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel travelled to the garden.
2025-01-22 17:11:43.929 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6397, 6402) --> . Daniel travelled to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:11:44.655 | INFO     | test_jbb_embedding:begin_test:693 - there<|eot_id|>
2025-01-22 17:11:44.655 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8151])
2025-01-22 17:11:46.873 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [469.32102272727275, 30.500356420161882, 70.19010416666667, 29.22250700948977, 22.165183145491802], 'topk_indices': array([8141, 8005,   65,   14,   24,   29,   66,   31,  105, 2936, 1867,
         34, 8146,   70,   67,   35,   68,  106,   69,    0]), 'topk_tokens': [' hallway', ' context', 'ENCES', '\n', '\n\n', '\n\n', ' OF', ' picked', ' P', ' hallway', ' bathroom', ' milk', '<|eot_id|>', 'ER', ' P', ' there', 'ION', 'ION', 'E', '<|begin_of_text|>'], 'evidence_proportions': [1051.5, 378.95, 311.125, 50.9125]}, 'weight': {'score': [20.792613636363637, 23.26628418567574, 24.360677083333332, 23.270563416625585, 29.579149590163933], 'topk_indices': array([3321, 3294, 3166, 3214, 7410, 7372, 1426, 1488, 4294, 4278, 5099,
       5160, 7093, 7149, 3503, 3477, 4953, 4901, 4876, 4924]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.5, 20.75625, 20.708333333333332, 18.88125]}, 'saliency': {'score': [2.674283114346591, 0.17418158098211, 0.4685414632161458, 0.16674989357587003, 0.1697482750064037], 'topk_indices': array([  39, 8139,  105,   64,    0,   30, 7890, 8005,   65,   70, 8141,
         31,   67,   34, 1867, 2936,   35,   69,   68,  106]), 'topk_tokens': ['***', ' before', ' P', 'ISC', '<|begin_of_text|>', 'Mary', ' Square', ' context', 'ENCES', 'ER', ' hallway', ' picked', ' P', ' milk', ' bathroom', ' hallway', ' there', 'E', 'ION', 'ION'], 'evidence_proportions': [6.280598958333333, 2.06572265625, 1.5819498697916667, 0.266064453125]}}, 'pred_res': 'there<|eot_id|>', 'score': 0}
2025-01-22 17:11:46.879 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:11:46.879 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-34_pid-0_0-2-3-7.pkl | len: 3 |  size: 1.97 KB
Processing depth (0, 2, 3, 7):   1%|          | 1/100 [00:20<33:48, 20.49s/it]is_0k: False
your chose emoji: ['ğŸ§ğŸ»\u200dâ¡ï¸', 'ğŸ§œğŸ¼\u200dâ™‚', 'ğŸ‘°ğŸ»\u200dâ™‚ï¸', 'ğŸ“£', 'ğŸŒ', 'ğŸ‡©ğŸ‡´', 'ğŸ¤«', 'ğŸ¯', 'ğŸ™ğŸ¼', 'ğŸšµğŸ¾\u200dâ™‚']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.02s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.60s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.58s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.17s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.65s/it]
Processing depth (1, 4, 7, 8):   1%|          | 1/100 [00:36<33:48, 20.49s/it]2025-01-22 17:12:03.304 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the milk there.
2025-01-22 17:12:03.309 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (895, 901) --> . Mary picked up the milk
2025-01-22 17:12:03.309 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the bathroom.
2025-01-22 17:12:03.329 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3725, 3730) --> . Mary travelled to the
2025-01-22 17:12:03.329 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the hallway.
2025-01-22 17:12:03.362 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5750, 5756) --> . Mary went back to the
2025-01-22 17:12:03.362 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John moved to the office.
2025-01-22 17:12:03.396 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6572, 6577) -->  John moved to the office
2025-01-22 17:12:03.396 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went to the garden.
2025-01-22 17:12:03.412 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3243, 3248) --> . Sandra went to the
2025-01-22 17:12:03.412 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John got the football.
2025-01-22 17:12:03.432 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4096, 4100) -->  John got the football
2025-01-22 17:12:03.432 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John dropped the football.
2025-01-22 17:12:03.447 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3055, 3059) -->  John dropped the football
2025-01-22 17:12:03.448 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel travelled to the garden.
2025-01-22 17:12:03.480 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6444, 6449) -->  Daniel travelled to the garden
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:12:04.260 | INFO     | test_jbb_embedding:begin_test:693 - the garden<|eot_id|>
2025-01-22 17:12:04.261 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8205])
2025-01-22 17:12:06.505 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [165.75426136363637, 16.26276193957115, 52.4765625, 15.780310740083252, 11.5579833984375], 'topk_indices': array([8195, 3730,    4,  902, 8188, 8054,    9, 8203, 8093, 8059,  900,
       8192, 8193,   24,  901,   14, 7944, 8200,    0, 8201]), 'topk_tokens': [' hallway', ' bathroom', '\n\n', '.', ':', '\n', ':', '<|end_header_id|>', '.\n\n', ' context', ' milk', ' milk', ' before', '\n\n', ' there', '\n', ' Square', '<|eot_id|>', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [326.3333333333333, 116.7625, 132.13541666666666, 62.39375]}, 'weight': {'score': [22.064275568181817, 23.310268944931774, 24.360677083333332, 23.31131014324192, 29.698686079545453], 'topk_indices': array([3259, 3286, 3125, 3173, 7484, 7446, 1406, 1468, 4265, 4281, 5126,
       5187, 7223, 7167, 3442, 3468, 4951, 4903, 4980, 4928]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [23.817708333333332, 20.75625, 20.708333333333332, 22.8953125]}, 'saliency': {'score': [0.9635065252130682, 0.09106874372991669, 0.3336147732204861, 0.08818438284310724, 0.08850444446910512], 'topk_indices': array([8196, 8174, 8189, 8093, 8187,    8,  896, 8103, 5756,   24,  897,
       7943, 8193, 3730, 8059, 8195,  901,  900, 8192, 7944]), 'topk_tokens': ['?', ' return', ' Where', '.\n\n', 'Question', ' Date', ' Mary', ' location', ' hallway', '\n\n', ' picked', 'Bridge', ' before', ' bathroom', ' context', ' hallway', ' there', ' milk', ' milk', ' Square'], 'evidence_proportions': [2.020751953125, 0.605615234375, 0.7152913411458334, 0.3505615234375]}}, 'pred_res': 'the garden<|eot_id|>', 'score': 0}
2025-01-22 17:12:06.551 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:12:06.554 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-34_pid-1_1-4-7-8.pkl | len: 3 |  size: 2.01 KB
Processing depth (1, 4, 7, 8):   2%|â–         | 2/100 [00:40<32:40, 20.01s/it]is_0k: False
your chose emoji: ['ğŸ‘¨ğŸ¼\u200dğŸ¼', 'ğŸ¤¹ğŸ¿\u200dâ™€', 'ğŸ§‘ğŸ¿\u200dğŸ¦¯', 'ğŸ‘©ğŸ¾\u200dâ¤\u200dğŸ‘¨ğŸ¿', 'â¸', 'ğŸ§›ğŸ¾\u200dâ™‚ï¸', 'ğŸ™ğŸ¼\u200dâ™‚ï¸', 'ğŸ¦¸ğŸ¾', 'ğŸ™…ğŸ»\u200dâ™€', 'â›¹ğŸ¿\u200dâ™€ï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.66s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:10,  5.03s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.51s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  2.90s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.57s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 2, 3, 9):   2%|â–         | 2/100 [00:56<32:40, 20.01s/it]2025-01-22 17:12:23.042 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the milk there.
2025-01-22 17:12:23.042 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 37) -->  picked up the milk there.
2025-01-22 17:12:23.042 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the bathroom.
2025-01-22 17:12:23.054 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1798, 1803) --> . Mary travelled to the
2025-01-22 17:12:23.055 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the hallway.
2025-01-22 17:12:23.069 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2932, 2938) --> . Mary went back to the
2025-01-22 17:12:23.070 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John moved to the office.
2025-01-22 17:12:23.105 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7170, 7175) -->  John moved to the office
2025-01-22 17:12:23.105 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went to the garden.
2025-01-22 17:12:23.121 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3218, 3223) --> . Sandra went to the
2025-01-22 17:12:23.121 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John got the football.
2025-01-22 17:12:23.140 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4051, 4055) -->  John got the football
2025-01-22 17:12:23.140 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John dropped the football.
2025-01-22 17:12:23.155 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2998, 3002) -->  John dropped the football
2025-01-22 17:12:23.155 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel travelled to the garden.
2025-01-22 17:12:23.189 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6443, 6448) --> . Daniel travelled to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:12:25.113 | INFO     | test_jbb_embedding:begin_test:693 - there<|eot_id|>
2025-01-22 17:12:25.113 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8219])
2025-01-22 17:12:28.043 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [428.2379261363636, 34.07448385429336, 57.599826388888886, 32.962891102419945, 12.891056743421053], 'topk_indices': array([7958,   29,  105, 8073,   31,   24,   34, 2938,   70, 8214, 1803,
       7605, 7606,   67, 7561,   35,   68,  106,   69,    0]), 'topk_tokens': [' Square', '\n\n', ' P', ' context', ' picked', '\n\n', ' milk', ' hallway', 'ER', '<|eot_id|>', ' bathroom', ' Min', 'nes', ' P', 'nes', ' there', 'ION', 'ION', 'E', '<|begin_of_text|>'], 'evidence_proportions': [914.9166666666666, 393.5, 292.8958333333333, 41.371875]}, 'weight': {'score': [21.704900568181817, 23.321986742884942, 23.106770833333332, 23.326808275788316, 29.730263157894736], 'topk_indices': array([3311, 3284, 3198, 3150, 7460, 7498, 1496, 1434, 4316, 4300, 5172,
       5111, 7237, 7181, 3479, 3505, 4913, 4936, 4965, 4888]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.5, 20.75625, 20.708333333333332, 22.8953125]}, 'saliency': {'score': [2.463356711647727, 0.1934858251157337, 0.360015869140625, 0.18701617218293587, 0.09894224468030427], 'topk_indices': array([   0,   30,   65,   70, 7413, 7958, 8073,   67,   31, 8209,   34,
       7606, 7605, 2938, 7561,   35, 1803,   69,   68,  106]), 'topk_tokens': ['<|begin_of_text|>', 'Mary', 'ENCES', 'ER', 'nes', ' Square', ' context', ' P', ' picked', ' hallway', ' milk', 'nes', ' Min', ' hallway', 'nes', ' there', ' bathroom', 'E', 'ION', 'ION'], 'evidence_proportions': [5.520670572916667, 2.19208984375, 1.4881998697916667, 0.23603515625]}}, 'pred_res': 'there<|eot_id|>', 'score': 0}
2025-01-22 17:12:28.047 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:12:28.049 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-34_pid-2_0-2-3-9.pkl | len: 3 |  size: 1.97 KB
Processing depth (0, 2, 3, 9):   3%|â–         | 3/100 [01:01<33:26, 20.69s/it]is_0k: False
your chose emoji: ['\U0001faf8ğŸ¾', 'ğŸ‘¬ğŸ½', 'ğŸ‘©ğŸ½\u200dâ¤\u200dğŸ‘¨ğŸ»', 'ğŸ‘³ğŸ¾\u200dâ™‚ï¸', 'ğŸŒğŸ»\u200dâ™‚ï¸', 'ğŸ§‘\u200dğŸ¦¼\u200dâ¡ï¸', 'ğŸ¦µ', 'ğŸ‘¨ğŸ¾\u200dğŸ¼', 'ğŸ‘¨ğŸ»\u200dâ¤ï¸\u200dğŸ‘¨ğŸ¼', 'ğŸ‘¨ğŸ¿\u200dğŸ’»']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.99s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.29s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:15<00:05,  5.04s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  3.47s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  4.07s/it]
Processing depth (0, 4, 5, 8):   3%|â–         | 3/100 [01:19<33:26, 20.69s/it]2025-01-22 17:12:46.066 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the milk there.
2025-01-22 17:12:46.066 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 37) -->  picked up the milk there.
2025-01-22 17:12:46.067 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the bathroom.
2025-01-22 17:12:46.086 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3569, 3574) --> . Mary travelled to the
2025-01-22 17:12:46.086 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the hallway.
2025-01-22 17:12:46.109 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4158, 4164) --> . Mary went back to the
2025-01-22 17:12:46.109 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John moved to the office.
2025-01-22 17:12:46.147 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6605, 6610) --> . John moved to the
2025-01-22 17:12:46.147 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went to the garden.
2025-01-22 17:12:46.162 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3093, 3098) --> . Sandra went to the
2025-01-22 17:12:46.162 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John got the football.
2025-01-22 17:12:46.182 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3970, 3974) -->  John got the football
2025-01-22 17:12:46.182 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John dropped the football.
2025-01-22 17:12:46.196 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2893, 2897) -->  John dropped the football
2025-01-22 17:12:46.196 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel travelled to the garden.
2025-01-22 17:12:46.228 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6391, 6396) --> . Daniel travelled to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:12:47.387 | INFO     | test_jbb_embedding:begin_test:693 - There is no information about the milk before the hallway in the given text.<|eot_id|>
2025-01-22 17:12:47.387 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8173])
2025-01-22 17:12:49.601 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [192.99076704545453, 20.785198293786692, 32.35503472222222, 20.293952034169124, 8.386433919270834], 'topk_indices': array([1679,   68, 2074,   34, 7912, 2088,   24, 1607, 2124,   69, 1600,
       2078, 8168, 2079,   35, 2125, 2135, 2136, 2126,    0]), 'topk_tokens': [' part', 'ION', '\n', ' milk', ' Square', ' the', '\n\n', 'ern', 'ra', 'E', ' part', ' du', '<|eot_id|>', ' Ch', ' there', 'irie', ' up', ' the', ' du', '<|begin_of_text|>'], 'evidence_proportions': [504.9583333333333, 70.975, 105.9375, 45.109375]}, 'weight': {'score': [20.792613636363637, 23.27710677592955, 23.106770833333332, 23.284201772984268, 29.229166666666668], 'topk_indices': array([3320, 3293, 3213, 3165, 7414, 7452, 1512, 1450, 4302, 4318, 5139,
       5200, 7101, 7157, 3502, 3476, 4910, 4964, 4935, 4993]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.5, 20.75625, 20.708333333333332, 18.88125]}, 'saliency': {'score': [1.0922074751420454, 0.11807141238695955, 0.2026282416449653, 0.1152502451908858, 0.06403048833211263], 'topk_indices': array([1679, 1686, 2124, 2136,   31, 2089, 2134, 1607, 7912, 1600, 2077,
       1021,   34, 8163, 2078,   35, 2135, 2079, 2125, 2126]), 'topk_tokens': [' part', 'ern', 'ra', ' the', ' picked', ' river', ' farther', 'ern', ' Square', ' part', 'irie', ' Minnesota', ' milk', ' hallway', ' du', ' there', ' up', ' Ch', 'irie', ' du'], 'evidence_proportions': [2.9955240885416665, 0.3829345703125, 0.4881184895833333, 0.2424072265625]}}, 'pred_res': 'There is no information about the milk before the hallway in the given text.<|eot_id|>', 'score': 0}
2025-01-22 17:12:49.607 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:12:49.608 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-34_pid-3_0-4-5-8.pkl | len: 3 |  size: 2.02 KB
Processing depth (0, 4, 5, 8):   4%|â–         | 4/100 [01:23<33:39, 21.03s/it]is_0k: False
your chose emoji: ['ğŸ˜ ', 'ğŸ”', 'ğŸ‘©ğŸ¼\u200dğŸ“', 'ğŸ‘¨ğŸ½\u200dğŸ’¼', 'ğŸ•¤', 'ğŸ§‘ğŸ¿\u200dğŸ¤\u200dğŸ§‘ğŸ¿', 'ğŸ§›ğŸ½\u200dâ™‚ï¸', 'ğŸ§”\u200dâ™‚', 'ğŸ†', 'ğŸ•µğŸ»\u200dâ™€ï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.25s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.55s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.72s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.39s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.82s/it]
Processing depth (2, 6, 7, 9):   4%|â–         | 4/100 [01:40<33:39, 21.03s/it]2025-01-22 17:13:06.940 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the milk there.
2025-01-22 17:13:06.948 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1579, 1585) --> . Mary picked up the milk
2025-01-22 17:13:06.948 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the bathroom.
2025-01-22 17:13:06.972 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4622, 4627) --> . Mary travelled to the
2025-01-22 17:13:06.972 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the hallway.
2025-01-22 17:13:07.002 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5562, 5568) --> . Mary went back to the
2025-01-22 17:13:07.002 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John moved to the office.
2025-01-22 17:13:07.041 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7118, 7123) -->  John moved to the office
2025-01-22 17:13:07.041 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went to the garden.
2025-01-22 17:13:07.056 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3002, 3007) -->  tragedy. Sandra went to
2025-01-22 17:13:07.056 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John got the football.
2025-01-22 17:13:07.077 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3918, 3922) -->  John got the football
2025-01-22 17:13:07.077 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John dropped the football.
2025-01-22 17:13:07.091 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2823, 2827) -->  John dropped the football
2025-01-22 17:13:07.091 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel travelled to the garden.
2025-01-22 17:13:07.126 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6305, 6310) --> . Daniel travelled to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:13:08.051 | INFO     | test_jbb_embedding:begin_test:693 - Mary picked up the milk there.<|eot_id|>
2025-01-22 17:13:08.051 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8165])
2025-01-22 17:13:10.267 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [216.8984375, 16.167869276444662, 62.767795138888886, 15.521354615218996, 17.44919002757353], 'topk_indices': array([5568, 4627,   23,    4, 8053, 5569,    1, 8063, 1584, 8152, 8155,
          9, 8153, 8163, 1585,   24,   14, 8160,    0, 8161]), 'topk_tokens': [' hallway', ' bathroom', '4', '\n\n', '.\n\n', '.', '<|start_header_id|>', ' location', ' milk', ' milk', ' hallway', ':', ' before', '<|end_header_id|>', ' there', '\n\n', '\n', '<|eot_id|>', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [351.9166666666667, 169.55, 272.6458333333333, 35.328125]}, 'weight': {'score': [22.064275568181817, 23.27728253550441, 24.720052083333332, 23.277370663139763, 29.596507352941178], 'topk_indices': array([3312, 3285, 3157, 3205, 7408, 7446, 1479, 1417, 4309, 4325, 5205,
       5144, 7185, 7129, 3494, 3468, 4980, 4951, 4928, 4903]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [23.817708333333332, 20.75625, 20.708333333333332, 22.8953125]}, 'saliency': {'score': [1.2510015314275569, 0.08980232261186949, 0.4092237684461806, 0.08595193277193805, 0.13163151460535386], 'topk_indices': array([  16,   20, 7906,   23,   14, 8053, 8147, 1580,    8, 1581, 5563,
       8063,   24, 1584, 8153, 8152, 5568, 4627, 1585, 8155]), 'topk_tokens': [' Date', ' Jul', ' Square', '4', '\n', '.\n\n', 'Question', ' Mary', ' Date', ' picked', ' Mary', ' location', '\n\n', ' milk', ' before', ' milk', ' hallway', ' bathroom', ' there', ' hallway'], 'evidence_proportions': [2.2018229166666665, 0.92421875, 1.4476725260416667, 0.20079345703125]}}, 'pred_res': 'Mary picked up the milk there.<|eot_id|>', 'score': 0}
2025-01-22 17:13:10.277 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:13:10.278 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-34_pid-4_2-6-7-9.pkl | len: 3 |  size: 2.04 KB
Processing depth (2, 6, 7, 9):   5%|â–Œ         | 5/100 [01:43<33:05, 20.90s/it]Processing depth (2, 6, 7, 9):   5%|â–Œ         | 5/100 [01:43<32:55, 20.79s/it]
2025-01-22 17:13:10.361 | INFO     | __main__:<module>:82 - Selected idx: 36
2025-01-22 17:13:10.361 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the football before the garden? 
2025-01-22 17:13:10.361 | INFO     | __main__:<module>:84 - Answer: bathroom
2025-01-22 17:13:10.361 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 17:13:10.361 | INFO     | __main__:<module>:86 - Needle: [' Daniel travelled to the garden.', ' Mary picked up the football.', ' Mary moved to the bathroom.', ' Sandra went to the garden.', ' John got the football.', ' Mary went to the garden.', ' John dropped the football.']
2025-01-22 17:13:10.361 | INFO     | __main__:<module>:87 - Real Needle: [' Mary picked up the football.', ' Mary moved to the bathroom.', ' Mary went to the garden.', ' John dropped the football.']
2025-01-22 17:13:10.361 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['\U0001fae6', 'ğŸ¤¾ğŸ½\u200dâ™‚', 'ğŸ‘¨ğŸ½\u200dâ¤\u200dğŸ’‹\u200dğŸ‘¨ğŸ¾', 'ğŸ•µğŸ½\u200dâ™‚', 'ğŸ’ª', 'ğŸ•', 'ğŸ‘³ğŸ½\u200dâ™‚ï¸', 'ğŸ', 'ğŸ¼', 'ğŸ™‹ğŸ¾\u200dâ™€']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.77s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.89s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.69s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.27s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.82s/it]
Processing depth (3, 4, 7, 9):   0%|          | 0/100 [00:17<?, ?it/s]2025-01-22 17:13:27.547 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the football.
2025-01-22 17:13:27.562 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2853, 2858) --> . Mary picked up the
2025-01-22 17:13:27.562 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary moved to the bathroom.
2025-01-22 17:13:27.585 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3627, 3632) --> . Mary moved to the
2025-01-22 17:13:27.585 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the garden.
2025-01-22 17:13:27.598 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2584, 2589) -->  Sandra went to the garden
2025-01-22 17:13:27.598 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John dropped the football.
2025-01-22 17:13:27.632 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7144, 7148) -->  dropped the football.
2025-01-22 17:13:27.632 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel travelled to the garden.
2025-01-22 17:13:27.655 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4599, 4604) -->  Daniel travelled to the garden
2025-01-22 17:13:27.655 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went to the garden.
2025-01-22 17:13:27.668 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2583, 2588) --> . Sandra went to the
2025-01-22 17:13:27.668 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John got the football.
2025-01-22 17:13:27.688 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4184, 4188) -->  John got the football
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:13:28.543 | INFO     | test_jbb_embedding:begin_test:693 - Mary picked up the football.<|eot_id|>
2025-01-22 17:13:28.544 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8179])
2025-01-22 17:13:30.755 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [147.8190789473684, 19.892718009044245, 151.62053571428572, 19.368139495643636, 13.95070213607595], 'topk_indices': array([7532, 8166, 8067,    4,   23,    9, 8167,    1, 2858, 7385, 7930,
       7577,   14, 7578,   24, 7533, 8177, 8175, 8174,    0]), 'topk_tokens': [' Min', ' football', '.\n\n', '\n\n', '4', ':', ' before', '<|start_header_id|>', ' football', 'nes', ' Square', ' Min', '\n', 'nes', '\n\n', 'nes', '<|end_header_id|>', '<|start_header_id|>', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [175.0, 132.2625, 149.5, 131.1875]}, 'weight': {'score': [22.11636513157895, 23.29868537643608, 23.876116071428573, 23.300450016873235, 29.88034018987342], 'topk_indices': array([3338, 3311, 3231, 3183, 7432, 7470, 1419, 1481, 4325, 4341, 5251,
       5190, 7209, 7153, 3520, 3494, 4919, 4996, 4967, 4944]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.1, 19.646875, 25.3109375, 21.23046875]}, 'saliency': {'score': [0.8772743626644737, 0.11100431492147397, 0.9823172433035714, 0.10772078173894035, 0.10407981389685522], 'topk_indices': array([  23, 4187, 7336,   16, 7929, 8169,    8, 4771, 3632, 7384, 7532,
       8167, 8166,   24, 7385, 2858, 7930, 7578, 7577, 7533]), 'topk_tokens': ['4', ' football', 'nes', ' Date', 'Bridge', ' garden', ' Date', ' senate', ' bathroom', ' Min', ' Min', ' before', ' football', '\n\n', 'nes', ' football', ' Square', 'nes', ' Min', 'nes'], 'evidence_proportions': [0.97548828125, 0.684521484375, 1.056494140625, 0.77142333984375]}}, 'pred_res': 'Mary picked up the football.<|eot_id|>', 'score': 0}
2025-01-22 17:13:30.762 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:13:30.762 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-36_pid-0_3-4-7-9.pkl | len: 3 |  size: 2.03 KB
Processing depth (3, 4, 7, 9):   1%|          | 1/100 [00:20<33:28, 20.28s/it]is_0k: False
your chose emoji: ['ğŸ‘µ', 'ğŸ‘©ğŸ¼\u200dğŸ’»', 'ğŸ§\u200dâ™‚', 'ğŸ§œğŸ»\u200dâ™€ï¸', 'ğŸŒğŸ¼\u200dâ™‚', 'ğŸ‘©ğŸ¿\u200dâ¤\u200dğŸ‘¨ğŸ»', 'ğŸ‘°ğŸ½\u200dâ™‚ï¸', 'ğŸ¦¸ğŸ¿\u200dâ™€ï¸', 'ğŸ‡»ğŸ‡¬', 'â–«ï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.67s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.18s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.74s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.05s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.72s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 1, 2, 9):   1%|          | 1/100 [00:37<33:28, 20.28s/it]2025-01-22 17:13:47.646 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the football.
2025-01-22 17:13:47.646 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the football.
2025-01-22 17:13:47.647 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary moved to the bathroom.
2025-01-22 17:13:47.652 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (827, 832) --> . Mary moved to the
2025-01-22 17:13:47.652 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the garden.
2025-01-22 17:13:47.664 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1819, 1824) --> . Mary went to the
2025-01-22 17:13:47.664 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John dropped the football.
2025-01-22 17:13:47.700 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7205, 7209) -->  John dropped the football
2025-01-22 17:13:47.700 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel travelled to the garden.
2025-01-22 17:13:47.724 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4587, 4592) -->  Daniel travelled to the garden
2025-01-22 17:13:47.724 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went to the garden.
2025-01-22 17:13:47.736 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1820, 1825) -->  Mary went to the garden
2025-01-22 17:13:47.736 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John got the football.
2025-01-22 17:13:47.761 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4227, 4231) -->  got the football.
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:13:53.082 | INFO     | test_jbb_embedding:begin_test:693 - Mary picked up the football.<|eot_id|>
2025-01-22 17:13:53.082 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8149])
2025-01-22 17:13:56.078 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [165.5641447368421, 18.168099086113838, 101.72544642857143, 17.67908224535041, 14.33221435546875], 'topk_indices': array([  16,    3, 8037, 8145,    9,    4, 8060,   23,  551,  105,   67,
       8003, 7886,    1,   68,   14, 8144, 8147,   24,    0]), 'topk_tokens': [' Date', '<|end_header_id|>', '.\n\n', '<|start_header_id|>', ':', '\n\n', ' the', '4', ',', 'ION', 'ION', ' context', ' Square', '<|start_header_id|>', 'E', '\n', '<|eot_id|>', '<|end_header_id|>', '\n\n', '<|begin_of_text|>'], 'evidence_proportions': [304.1, 173.0125, 68.86875, 103.953125]}, 'weight': {'score': [21.62705592105263, 23.263232948969577, 23.611607142857142, 23.266461194420494, 29.157958984375], 'topk_indices': array([3338, 3311, 3183, 3231, 7382, 7420, 1455, 1517, 4317, 4301, 5130,
       5191, 7098, 7154, 3494, 3520, 4932, 4955, 4907, 4984]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.2875, 19.646875, 19.403125, 26.056640625]}, 'saliency': {'score': [0.8720124897203947, 0.10115295350259139, 0.604217529296875, 0.0984815364254565, 0.10518527030944824], 'topk_indices': array([8118,   15, 7885, 8136,   31,   38,   20, 8047,   23,    8,   34,
          0,   16,   68,  105,   67,  832, 8003, 7886,   24]), 'topk_tokens': [' return', 'Today', 'Bridge', ' football', ' picked', '***', ' Jul', ' location', '4', ' Date', ' football', '<|begin_of_text|>', ' Date', 'E', 'ION', 'ION', ' bathroom', ' context', ' Square', '\n\n'], 'evidence_proportions': [1.6060546875, 0.839697265625, 0.3245361328125, 0.67919921875]}}, 'pred_res': 'Mary picked up the football.<|eot_id|>', 'score': 0}
2025-01-22 17:13:56.088 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:13:56.088 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-36_pid-1_0-1-2-9.pkl | len: 3 |  size: 2.04 KB
Processing depth (0, 1, 2, 9):   2%|â–         | 2/100 [00:45<37:58, 23.25s/it]is_0k: False
your chose emoji: ['ğŸ‘©ğŸ»\u200dâ¤ï¸\u200dğŸ‘¨ğŸ¿', 'ğŸ‡¹ğŸ‡¨', 'ğŸ‡°ğŸ‡¾', 'ğŸ¤›', 'ğŸ§ğŸ½', 'â«', 'ğŸ–Š', 'ğŸ’‘ğŸ¿', 'ğŸ‡­ğŸ‡º', 'ğŸ§›ğŸ»\u200dâ™‚ï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.78s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.12s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.93s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  3.47s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  4.02s/it]
Processing depth (1, 4, 6, 9):   2%|â–         | 2/100 [01:03<37:58, 23.25s/it]2025-01-22 17:14:14.004 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the football.
2025-01-22 17:14:14.008 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (821, 826) --> . Mary picked up the
2025-01-22 17:14:14.008 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary moved to the bathroom.
2025-01-22 17:14:14.026 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3598, 3603) -->  Hon. Mary moved to
2025-01-22 17:14:14.027 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the garden.
2025-01-22 17:14:14.042 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2798, 2803) -->  Sandra went to the garden
2025-01-22 17:14:14.042 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John dropped the football.
2025-01-22 17:14:14.081 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7269, 7273) -->  John dropped the football
2025-01-22 17:14:14.081 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel travelled to the garden.
2025-01-22 17:14:14.107 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4592, 4597) --> . Daniel travelled to the
2025-01-22 17:14:14.107 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went to the garden.
2025-01-22 17:14:14.123 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2797, 2802) --> . Sandra went to the
2025-01-22 17:14:14.124 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John got the football.
2025-01-22 17:14:14.144 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4217, 4221) -->  got the football.
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:14:15.037 | INFO     | test_jbb_embedding:begin_test:693 - Mary picked up the football.<|eot_id|>
2025-01-22 17:14:15.037 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8155])
2025-01-22 17:14:17.251 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [180.65131578947367, 23.741270072321647, 169.32589285714286, 23.12348846153846, 29.498863106343283], 'topk_indices': array([ 827, 3024,    1,   14, 2974, 8143,  269, 3063, 3082, 8151,  830,
         24, 3064, 3099, 8150, 8153, 3100, 3080,    0, 3081]), 'topk_tokens': ['.', ' July', '<|start_header_id|>', '\n', 'lyn', ' before', 'hue', ' Fourth', 'ation', '<|start_header_id|>', 'ï¿½', '\n\n', ' of', ' const', '<|eot_id|>', '<|end_header_id|>', 'ern', ' const', '<|begin_of_text|>', 'ern'], 'evidence_proportions': [235.65, 153.2375, 216.575, 101.265625]}, 'weight': {'score': [24.39761513157895, 23.27010679700907, 20.885044642857142, 23.27157980769231, 29.31553171641791], 'topk_indices': array([3288, 3261, 3133, 3181, 7426, 7388, 1423, 1485, 4267, 4283, 5102,
       5163, 7104, 7160, 3470, 3444, 4879, 4956, 4927, 4904]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.1, 24.4546875, 25.3109375, 26.056640625]}, 'saliency': {'score': [1.1052888569078947, 0.13491637989071312, 0.9351545061383929, 0.1312683293269231, 0.20986004729769123], 'topk_indices': array([8137, 8142, 3022, 1232,   24,  830,    0, 3082, 3024, 8145, 8143,
        826,  828, 2974,  269, 3063, 3099, 3100, 3080, 3081]), 'topk_tokens': ['Question', ' football', ' Fourth', 'nes', '\n\n', 'ï¿½', '<|begin_of_text|>', 'ation', ' July', ' garden', ' before', ' football', 'ï¿½', 'lyn', 'hue', ' Fourth', ' const', 'ern', ' const', 'ern'], 'evidence_proportions': [1.297265625, 0.872900390625, 1.493896484375, 0.6700439453125]}}, 'pred_res': 'Mary picked up the football.<|eot_id|>', 'score': 0}
2025-01-22 17:14:17.258 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:14:17.258 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-36_pid-2_1-4-6-9.pkl | len: 3 |  size: 2.04 KB
Processing depth (1, 4, 6, 9):   3%|â–         | 3/100 [01:06<36:03, 22.30s/it]is_0k: False
your chose emoji: ['ğŸ‘©ğŸ½\u200dâ¤\u200dğŸ’‹\u200dğŸ‘©ğŸ¼', 'ğŸ‘±ğŸ½\u200dâ™‚ï¸', 'ğŸš¶\u200dâ¡', 'ğŸ•', 'ğŸªš', 'ğŸ‘¨ğŸ½', 'ğŸ’ğŸ¼\u200dâ™€ï¸', '3âƒ£', 'ğŸŒ', 'ğŸ§–ğŸ¿']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.35s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.58s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.73s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.31s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.78s/it]
Processing depth (1, 3, 4, 9):   3%|â–         | 3/100 [01:23<36:03, 22.30s/it]2025-01-22 17:14:34.223 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the football.
2025-01-22 17:14:34.227 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (682, 687) -->  Mary picked up the football
2025-01-22 17:14:34.228 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary moved to the bathroom.
2025-01-22 17:14:34.244 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2737, 2742) --> . Mary moved to the
2025-01-22 17:14:34.245 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the garden.
2025-01-22 17:14:34.257 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2554, 2559) -->  Sandra went to the garden
2025-01-22 17:14:34.258 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John dropped the football.
2025-01-22 17:14:34.300 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7150, 7154) -->  dropped the football.
2025-01-22 17:14:34.300 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel travelled to the garden.
2025-01-22 17:14:34.326 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4597, 4602) -->  Daniel travelled to the garden
2025-01-22 17:14:34.326 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went to the garden.
2025-01-22 17:14:34.339 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2553, 2558) --> . Sandra went to the
2025-01-22 17:14:34.339 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John got the football.
2025-01-22 17:14:34.362 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4196, 4200) -->  John got the football
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:14:35.282 | INFO     | test_jbb_embedding:begin_test:693 - Mary picked up the football.<|eot_id|>
2025-01-22 17:14:35.282 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8185])
2025-01-22 17:14:37.518 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [161.45723684210526, 18.839925806057646, 168.0625, 18.251471489883507, 16.581435785060975], 'topk_indices': array([8175, 8099, 7936,    4, 8172, 8111, 8112,   23,    1,    9, 8083,
       8113, 8173, 8073,   14,   24, 8183, 8181, 8180,    0]), 'topk_tokens': [' garden', '.\n', ' Square', '\n\n', ' football', ' moved', ' to', '4', '<|start_header_id|>', ':', ' location', ' the', ' before', '.\n\n', '\n', '\n\n', '<|end_header_id|>', '<|start_header_id|>', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [183.875, 155.35, 182.7625, 114.4375]}, 'weight': {'score': [23.383223684210527, 23.295733848314608, 23.876116071428573, 23.294533645003067, 29.4921875], 'topk_indices': array([3309, 3336, 3181, 3229, 7438, 7476, 1465, 1527, 4337, 4353, 5192,
       5253, 7215, 7159, 3530, 3556, 4991, 4968, 4943, 5020]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.9140625, 19.646875, 25.3109375, 21.23046875]}, 'saliency': {'score': [1.0386063425164473, 0.10462423155933226, 1.1025390625, 0.10073502644083385, 0.12075163678425115], 'topk_indices': array([7583, 7584,   23, 8169,    8, 8167, 2742,   16, 4199, 7539,  686,
       8175, 2554, 8073, 7936, 8111, 8172, 8083,   24, 8173]), 'topk_tokens': [' Min', 'nes', '4', ' Where', ' Date', 'Question', ' bathroom', ' Date', ' football', 'nes', ' football', ' garden', ' Sandra', '.\n\n', ' Square', ' moved', ' football', ' location', '\n\n', ' before'], 'evidence_proportions': [1.295703125, 0.798828125, 1.327197265625, 0.656219482421875]}}, 'pred_res': 'Mary picked up the football.<|eot_id|>', 'score': 0}
2025-01-22 17:14:37.525 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:14:37.526 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-36_pid-3_1-3-4-9.pkl | len: 3 |  size: 2.04 KB
Processing depth (1, 3, 4, 9):   4%|â–         | 4/100 [01:27<34:23, 21.50s/it]is_0k: False
your chose emoji: ['ğŸ‘©ğŸ¼\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘¨ğŸ»', 'ğŸ‘©\u200dâš–ï¸', 'ğŸ§‘\u200dğŸ«', 'ğŸ§™ğŸ»', 'ğŸ‘©ğŸ»\u200dâ¤\u200dğŸ‘©ğŸ½', 'ğŸ§‘ğŸ¿\u200dğŸ¦½\u200dâ¡', 'ğŸ‡­ğŸ‡º', 'ğŸ„', 'ğŸ˜š', 'ğŸˆ']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.79s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.90s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.26s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.78s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.44s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (1, 4, 5, 8):   4%|â–         | 4/100 [01:43<34:23, 21.50s/it]2025-01-22 17:14:54.201 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the football.
2025-01-22 17:14:54.206 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (895, 900) --> . Mary picked up the
2025-01-22 17:14:54.206 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary moved to the bathroom.
2025-01-22 17:14:54.224 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3595, 3600) --> . Mary moved to the
2025-01-22 17:14:54.224 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the garden.
2025-01-22 17:14:54.238 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2612, 2617) -->  Sandra went to the garden
2025-01-22 17:14:54.238 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John dropped the football.
2025-01-22 17:14:54.273 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6667, 6671) -->  John dropped the football
2025-01-22 17:14:54.273 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel travelled to the garden.
2025-01-22 17:14:54.298 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4647, 4652) -->  Daniel travelled to the garden
2025-01-22 17:14:54.298 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went to the garden.
2025-01-22 17:14:54.314 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2611, 2616) --> . Sandra went to the
2025-01-22 17:14:54.314 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John got the football.
2025-01-22 17:14:54.337 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4232, 4236) -->  John got the football
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:15:02.339 | INFO     | test_jbb_embedding:begin_test:693 - Mary picked up the football.<|eot_id|>
2025-01-22 17:15:02.339 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8213])
2025-01-22 17:15:05.863 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [127.42434210526316, 14.528294638510223, 91.18080357142857, 14.135020774776976, 10.920328776041666], 'topk_indices': array([  16, 8198, 8196,    8, 8200, 8101,    3,   23,    4,    1, 8067,
       8201, 7954,    9,   14,   24, 8208, 8209,    0, 8211]), 'topk_tokens': [' Date', ' was', ':', ' Date', ' football', '.\n\n', '<|end_header_id|>', '4', '\n\n', '<|start_header_id|>', ' context', ' before', ' Square', ':', '\n', '\n\n', '<|eot_id|>', '<|start_header_id|>', '<|begin_of_text|>', '<|end_header_id|>'], 'evidence_proportions': [160.575, 107.1375, 102.7875, 142.140625]}, 'weight': {'score': [23.132401315789473, 23.325605145447906, 23.876116071428573, 23.325111893559818, 29.86669921875], 'topk_indices': array([3377, 3404, 3297, 3249, 7442, 7480, 1563, 1501, 4373, 4389, 5251,
       5190, 7219, 7163, 3560, 3586, 5015, 4992, 4967, 5044]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.1, 19.646875, 25.3109375, 26.056640625]}, 'saliency': {'score': [0.7613075657894737, 0.08045743294096504, 0.5771397181919643, 0.07802682014399136, 0.08268467585245769], 'topk_indices': array([8182, 8206, 7787,   23, 8111,   14, 7953, 8210,    9, 8203,  900,
         16, 3600,    8, 8195, 8200, 8201, 8067,   24, 7954]), 'topk_tokens': [' return', 'Answer', 'inen', '4', ' location', '\n', 'Bridge', 'assistant', ':', ' garden', ' football', ' Date', ' bathroom', ' Date', 'Question', ' football', ' before', ' context', '\n\n', ' Square'], 'evidence_proportions': [0.905322265625, 0.53076171875, 0.67275390625, 0.98016357421875]}}, 'pred_res': 'Mary picked up the football.<|eot_id|>', 'score': 0}
2025-01-22 17:15:05.869 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:15:05.870 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-36_pid-4_1-4-5-8.pkl | len: 3 |  size: 2.05 KB
Processing depth (1, 4, 5, 8):   5%|â–Œ         | 5/100 [01:55<37:56, 23.97s/it]Processing depth (1, 4, 5, 8):   5%|â–Œ         | 5/100 [01:55<36:33, 23.09s/it]
2025-01-22 17:15:05.944 | INFO     | __main__:<module>:82 - Selected idx: 38
2025-01-22 17:15:05.944 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the football before the hallway? 
2025-01-22 17:15:05.944 | INFO     | __main__:<module>:84 - Answer: office
2025-01-22 17:15:05.944 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 17:15:05.944 | INFO     | __main__:<module>:86 - Needle: [' Daniel travelled to the garden.', ' John moved to the office.', ' Mary got the football.', ' Sandra went to the garden.', ' Mary travelled to the office.', ' Sandra picked up the milk.', ' Daniel journeyed to the office.', ' Mary journeyed to the hallway.', ' John went to the kitchen.']
2025-01-22 17:15:05.944 | INFO     | __main__:<module>:87 - Real Needle: [' Mary got the football.', ' Mary travelled to the office.', ' Mary journeyed to the hallway.', ' John went to the kitchen.']
2025-01-22 17:15:05.944 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ’‡ğŸ¾\u200dâ™‚', 'ğŸ‘¨ğŸ»\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘¨ğŸ¿', 'ğŸš³', 'ğŸ‘¨ğŸ¾\u200dğŸ¦¯\u200dâ¡ï¸', 'ğŸ‡¨ğŸ‡¿', 'ğŸ’†ğŸ¿\u200dâ™€', 'ğŸ§ğŸ½\u200dâ™‚', 'ğŸ§‘ğŸ¿\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ§‘ğŸ¾', 'âš›', 'ğŸ§ğŸ¿\u200dâ™€']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:05<00:15,  5.03s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.89s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.59s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.20s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.78s/it]
Processing depth (0, 1, 4, 7):   0%|          | 0/100 [00:16<?, ?it/s]2025-01-22 17:15:23.084 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the football.
2025-01-22 17:15:23.124 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the office.
2025-01-22 17:15:23.129 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (900, 905) --> . Mary travelled to the
2025-01-22 17:15:23.129 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the hallway.
2025-01-22 17:15:23.148 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3635, 3641) -->  Hon. Mary journeyed to
2025-01-22 17:15:23.148 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the kitchen.
2025-01-22 17:15:23.176 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5659, 5664) --> . John went to the
2025-01-22 17:15:23.176 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel travelled to the garden.
2025-01-22 17:15:23.210 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6688, 6693) --> . Daniel travelled to the
2025-01-22 17:15:23.210 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John moved to the office.
2025-01-22 17:15:23.235 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4893, 4898) --> . John moved to the
2025-01-22 17:15:23.235 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went to the garden.
2025-01-22 17:15:23.272 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6752, 6757) --> . Sandra went to the
2025-01-22 17:15:23.272 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra picked up the milk.
2025-01-22 17:15:23.296 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3771, 3776) --> . Sandra picked up the
2025-01-22 17:15:23.296 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel journeyed to the office.
2025-01-22 17:15:23.329 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6451, 6457) --> . Daniel journeyed to the
2025-01-22 17:15:23.330 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 17:15:23.330 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 17:15:23.330 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 17:15:23.330 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸŠğŸ¾\u200dâ™€', 'ğŸ¤›ğŸ½', 'ğŸ‘¨ğŸ¾\u200dğŸ¤\u200dğŸ‘¨ğŸ¼', 'ğŸ—¼', 'ğŸ§‘ğŸ½\u200dâœˆ', 'ğŸ‘‘', 'ğŸ§ğŸ½\u200dâ™€\u200dâ¡', 'ğŸ¦¸ğŸ»\u200dâ™€ï¸', 'ğŸ§ğŸ¾', '\U0001faab']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.09s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.32s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.57s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.21s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.64s/it]
Processing depth (3, 4, 7, 9):   0%|          | 0/100 [00:33<?, ?it/s]2025-01-22 17:15:39.829 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the football.
2025-01-22 17:15:39.843 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2958, 2962) -->  Mary got the football
2025-01-22 17:15:39.844 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the office.
2025-01-22 17:15:39.862 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3607, 3612) -->  Mary travelled to the office
2025-01-22 17:15:39.862 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the hallway.
2025-01-22 17:15:39.895 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5688, 5694) --> . Mary journeyed to the
2025-01-22 17:15:39.895 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the kitchen.
2025-01-22 17:15:39.932 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7257, 7262) -->  cold. John went to
2025-01-22 17:15:39.933 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel travelled to the garden.
2025-01-22 17:15:39.968 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6654, 6659) --> . Daniel travelled to the
2025-01-22 17:15:39.968 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John moved to the office.
2025-01-22 17:15:39.994 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4882, 4887) --> . John moved to the
2025-01-22 17:15:39.994 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went to the garden.
2025-01-22 17:15:40.029 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6782, 6787) --> . Sandra went to the
2025-01-22 17:15:40.029 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra picked up the milk.
2025-01-22 17:15:40.050 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3760, 3765) --> . Sandra picked up the
2025-01-22 17:15:40.050 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel journeyed to the office.
2025-01-22 17:15:40.089 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6423, 6429) --> . Daniel journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:15:40.948 | INFO     | test_jbb_embedding:begin_test:693 - Mary got the football.<|eot_id|>
2025-01-22 17:15:40.948 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8184])
2025-01-22 17:15:43.175 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [548.8140625, 49.75819234058148, 157.87019230769232, 48.18668995700246, 33.32326858108108], 'topk_indices': array([2992, 8166, 8072,    3, 8180, 8174,   14, 8177, 8167, 8179, 8172,
       8037, 2962, 8171, 8182, 8082, 8178, 2961, 8038,    0]), 'topk_tokens': ['ball', 'Question', '.\n\n', '<|end_header_id|>', '<|start_header_id|>', ' hallway', '\n', 'Answer', ':', '<|eot_id|>', ' before', ' you', '.', ' football', '<|end_header_id|>', ' location', ':', ' football', ' context', '<|begin_of_text|>'], 'evidence_proportions': [1251.0, 584.8, 454.5416666666667, 64.20625]}, 'weight': {'score': [23.194921875, 23.283090031761542, 20.868389423076923, 23.291019464066338, 29.57474662162162], 'topk_indices': array([3265, 3238, 3158, 3110, 7379, 7417, 1399, 1461, 4235, 4251, 5082,
       5143, 7150, 7094, 3447, 3421, 4907, 4878, 4853, 4936]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.611328125, 24.7703125, 20.052083333333332, 22.6578125]}, 'saliency': {'score': [3.436651611328125, 0.2802321608538969, 0.9035409780649039, 0.27048591782478504, 0.24217141641152873], 'topk_indices': array([8081, 3033, 2958, 2982, 8168, 3608, 2959, 8036, 2993, 8037, 2992,
       5694, 8166, 8172, 8177, 8082, 8174, 8171, 8038, 2961]), 'topk_tokens': [' first', 'ball', ' Mary', ' its', ' Where', ' travelled', ' got', ' provided', 'room', ' you', 'ball', ' hallway', 'Question', ' before', 'Answer', ' location', ' hallway', ' football', ' context', ' football'], 'evidence_proportions': [8.45458984375, 3.7431640625, 2.4111328125, 0.3464111328125]}}, 'pred_res': 'Mary got the football.<|eot_id|>', 'score': 0}
2025-01-22 17:15:43.181 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:15:43.182 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-38_pid-0_3-4-7-9.pkl | len: 3 |  size: 2.06 KB
Processing depth (3, 4, 7, 9):   1%|          | 1/100 [00:37<1:01:16, 37.13s/it]is_0k: False
your chose emoji: ['ğŸšï¸', 'ğŸ¶', 'ğŸ§ğŸ¿\u200dâ™€ï¸', 'ğŸ‡§ğŸ‡¬', 'ğŸƒğŸ½\u200dâ™€ï¸\u200dâ¡', 'ğŸ‘©ğŸ¼\u200dğŸ¤\u200dğŸ‘©ğŸ½', 'ğŸ’‡ğŸ»\u200dâ™€ï¸', 'ğŸ‡¨ğŸ‡»', '\U0001fa75', 'ğŸ‡²ğŸ‡µ']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.31s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.54s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.37s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.13s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.61s/it]
Processing depth (1, 4, 5, 8):   1%|          | 1/100 [00:53<1:01:16, 37.13s/it]2025-01-22 17:16:00.048 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the football.
2025-01-22 17:16:00.052 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (768, 772) -->  Mary got the football
2025-01-22 17:16:00.052 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the office.
2025-01-22 17:16:00.074 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3601, 3606) -->  Hon. Mary travelled to
2025-01-22 17:16:00.074 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the hallway.
2025-01-22 17:16:00.098 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4197, 4203) -->  Mary journeyed to the hallway
2025-01-22 17:16:00.099 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the kitchen.
2025-01-22 17:16:00.150 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6528, 6533) --> . John went to the
2025-01-22 17:16:00.150 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel travelled to the garden.
2025-01-22 17:16:00.190 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6664, 6669) --> . Daniel travelled to the
2025-01-22 17:16:00.190 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John moved to the office.
2025-01-22 17:16:00.217 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4921, 4926) --> . John moved to the
2025-01-22 17:16:00.217 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went to the garden.
2025-01-22 17:16:00.253 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6728, 6733) --> . Sandra went to the
2025-01-22 17:16:00.253 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra picked up the milk.
2025-01-22 17:16:00.274 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3736, 3741) --> . Sandra picked up the
2025-01-22 17:16:00.275 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel journeyed to the office.
2025-01-22 17:16:00.310 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6411, 6417) --> . Daniel journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:16:01.153 | INFO     | test_jbb_embedding:begin_test:693 - Mary's house.<|eot_id|>
2025-01-22 17:16:01.153 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8198])
2025-01-22 17:16:03.454 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [438.5328125, 43.23995807926829, 158.359375, 41.903318156732894, 39.38437982253087], 'topk_indices': array([   3, 8181, 8112,   24, 8051,   14, 8124, 8191, 8194, 8086, 8096,
       8192,  772, 8052, 8196, 8125,  771, 8126, 8193,    0]), 'topk_tokens': ['<|end_header_id|>', ':', '.\n', '\n\n', ' you', '\n', ' moved', 'Answer', '<|start_header_id|>', '.\n\n', ' location', ':', '.', ' context', '<|end_header_id|>', ' to', ' football', ' the', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [1202.0, 367.175, 304.9583333333333, 59.40625]}, 'weight': {'score': [23.912109375, 23.29355945121951, 20.868389423076923, 23.29977522534952, 29.560956790123456], 'topk_indices': array([3273, 3246, 3166, 3118, 7475, 7437, 1482, 1420, 4304, 4320, 5182,
       5121, 7186, 7130, 3429, 3455, 4975, 4946, 4917, 4892]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.611328125, 25.5640625, 25.131510416666668, 18.6375]}, 'saliency': {'score': [2.913397216796875, 0.2402547101276677, 0.8378671499399039, 0.23179251076925436, 0.29181737075617287], 'topk_indices': array([   0, 8050,   24, 8095, 8098, 8186, 8126, 8125,  769, 8086,  768,
       8051, 8180, 8185, 8188, 8124, 8096, 8191, 8052,  771]), 'topk_tokens': ['<|begin_of_text|>', ' provided', '\n\n', ' first', ' traveled', ' before', ' the', ' to', ' got', '.\n\n', ' Mary', ' you', 'Question', ' football', ' hallway', ' moved', ' location', 'Answer', ' context', ' football'], 'evidence_proportions': [8.322265625, 2.298828125, 2.0146484375, 0.2793701171875]}}, 'pred_res': "Mary's house.<|eot_id|>", 'score': 0}
2025-01-22 17:16:03.460 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:16:03.461 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-38_pid-1_1-4-5-8.pkl | len: 3 |  size: 2.04 KB
Processing depth (1, 4, 5, 8):   2%|â–         | 2/100 [00:57<44:27, 27.22s/it]  is_0k: False
your chose emoji: ['â›¹\u200dâ™€', 'ğŸ§ğŸ»\u200dâ™‚', 'ğŸ‡©ğŸ‡ª', 'ğŸ§‘ğŸ¿\u200dğŸ¦½\u200dâ¡ï¸', 'ğŸš¶ğŸ»\u200dâ¡', 'ğŸ˜§', 'ğŸ‘¨ğŸ»\u200dâ¤\u200dğŸ‘¨ğŸ½', 'ğŸ‘¦ğŸ»', 'ğŸ˜®\u200dğŸ’¨', 'ğŸ¤¦ğŸ¼\u200dâ™‚ï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:05<00:15,  5.02s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.92s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.71s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.26s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.84s/it]
Processing depth (2, 4, 6, 8):   2%|â–         | 2/100 [01:14<44:27, 27.22s/it]2025-01-22 17:16:20.751 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the football.
2025-01-22 17:16:20.762 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1741, 1745) -->  got the football.
2025-01-22 17:16:20.763 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the office.
2025-01-22 17:16:20.784 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3562, 3567) --> . Mary travelled to the
2025-01-22 17:16:20.784 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the hallway.
2025-01-22 17:16:20.812 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4674, 4680) --> . Mary journeyed to the
2025-01-22 17:16:20.813 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the kitchen.
2025-01-22 17:16:20.845 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6560, 6565) --> . John went to the
2025-01-22 17:16:20.845 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel travelled to the garden.
2025-01-22 17:16:20.892 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6696, 6701) --> . Daniel travelled to the
2025-01-22 17:16:20.892 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John moved to the office.
2025-01-22 17:16:20.923 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4835, 4840) -->  the senate. John moved
2025-01-22 17:16:20.923 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went to the garden.
2025-01-22 17:16:20.957 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6760, 6765) --> . Sandra went to the
2025-01-22 17:16:20.957 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra picked up the milk.
2025-01-22 17:16:20.975 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3641, 3646) -->  Hon. Sandra picked up
2025-01-22 17:16:20.975 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel journeyed to the office.
2025-01-22 17:16:21.032 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6443, 6449) --> . Daniel journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:16:21.880 | INFO     | test_jbb_embedding:begin_test:693 - Mary got the football.<|eot_id|>
2025-01-22 17:16:21.881 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8222])
2025-01-22 17:16:24.118 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [727.834375, 63.63945464494164, 133.08173076923077, 61.79433388359012, 88.32211861559139], 'topk_indices': array([  14, 8110, 1741, 8075, 1722, 8205,   24, 8215, 8210, 8212, 8120,
       1724, 8216, 8218, 8209, 1744, 1743, 8076, 8217,    0]), 'topk_tokens': ['\n', '.\n\n', ' got', ' you', 'ï¿½', ':', '\n\n', 'Answer', ' before', ' hallway', ' location', 'ï¿½', ':', '<|start_header_id|>', ' football', '.', ' football', ' context', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [1868.5, 751.3, 512.875, 49.7875]}, 'weight': {'score': [20.0296875, 23.312211211089494, 22.702223557692307, 23.322178214416727, 29.576948924731184], 'topk_indices': array([3325, 3298, 3170, 3218, 7441, 7479, 1419, 1481, 4339, 4323, 5246,
       5185, 7162, 7218, 3481, 3507, 5010, 4962, 5039, 4987]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.828125, 20.75625, 20.052083333333332, 18.6375]}, 'saliency': {'score': [3.869232177734375, 0.36216352885799186, 0.7888418344350961, 0.35223016997776047, 0.662528089297715], 'topk_indices': array([8074,   24, 1729, 8075, 8206, 1723, 8204, 3564, 1740, 1741, 8210,
       4680, 1724, 8120, 8215, 1722, 8212, 8209, 8076, 1743]), 'topk_tokens': [' provided', '\n\n', 'â™€', ' you', ' Where', 'ï¿½', 'Question', ' travelled', ' Mary', ' got', ' before', ' hallway', 'ï¿½', ' location', 'Answer', 'ï¿½', ' hallway', ' football', ' context', ' football'], 'evidence_proportions': [10.0703125, 4.1353515625, 2.5411783854166665, 0.2359130859375]}}, 'pred_res': 'Mary got the football.<|eot_id|>', 'score': 0}
2025-01-22 17:16:24.125 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:16:24.125 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-38_pid-2_2-4-6-8.pkl | len: 3 |  size: 2.02 KB
Processing depth (2, 4, 6, 8):   3%|â–         | 3/100 [01:18<39:09, 24.23s/it]is_0k: False
your chose emoji: ['ğŸ‡µğŸ‡²', 'ğŸ§‘ğŸ¾\u200dğŸ¤\u200dğŸ§‘ğŸ¿', 'ğŸ‘©\u200dğŸ¦¯', 'ğŸ§', 'ğŸ¤¸ğŸ¼\u200dâ™€ï¸', 'ğŸ§\u200dâ™‚ï¸\u200dâ¡', 'ğŸ‹ğŸ½\u200dâ™€ï¸', 'ğŸ‘©ğŸ½\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘¨ğŸ¼', 'ğŸ‘ƒ', 'ğŸ‘¨ğŸ¿\u200dâš•']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.75s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.05s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.63s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  2.98s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.65s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 1, 7, 9):   3%|â–         | 3/100 [01:34<39:09, 24.23s/it]2025-01-22 17:16:40.904 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the football.
2025-01-22 17:16:40.945 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the office.
2025-01-22 17:16:40.948 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (664, 669) --> . Mary travelled to the
2025-01-22 17:16:40.948 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the hallway.
2025-01-22 17:16:40.978 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5616, 5622) --> . Mary journeyed to the
2025-01-22 17:16:40.978 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the kitchen.
2025-01-22 17:16:41.015 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7111, 7116) -->  John went to the kitchen
2025-01-22 17:16:41.018 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel travelled to the garden.
2025-01-22 17:16:41.054 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6630, 6635) --> . Daniel travelled to the
2025-01-22 17:16:41.055 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John moved to the office.
2025-01-22 17:16:41.079 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4890, 4895) --> . John moved to the
2025-01-22 17:16:41.079 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went to the garden.
2025-01-22 17:16:41.116 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6682, 6687) --> . Sandra went to the
2025-01-22 17:16:41.116 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra picked up the milk.
2025-01-22 17:16:41.134 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3625, 3630) -->  Hon. Sandra picked up
2025-01-22 17:16:41.134 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel journeyed to the office.
2025-01-22 17:16:41.167 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6384, 6390) -->  Daniel journeyed to the office
2025-01-22 17:16:41.167 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 17:16:41.167 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 17:16:41.167 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 17:16:41.167 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ‡¹ğŸ‡¯', 'ğŸ§ğŸ¿\u200dâ™‚', 'ğŸ…ğŸ¼', 'ğŸ¤˜ğŸ¾', 'ğŸ’ğŸ¾', 'ğŸ‘°ğŸ¼\u200dâ™‚ï¸', 'ğŸ’˜', '\U0001faac', 'ğŸ–ğŸ¼', 'ğŸ’‚ğŸ»\u200dâ™‚ï¸']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.65s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:10,  5.02s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:15<00:05,  5.11s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  3.46s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  4.02s/it]
Processing depth (0, 2, 3, 5):   3%|â–         | 3/100 [01:52<39:09, 24.23s/it]2025-01-22 17:16:59.002 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the football.
2025-01-22 17:16:59.043 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the office.
2025-01-22 17:16:59.052 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1796, 1801) --> . Mary travelled to the
2025-01-22 17:16:59.052 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the hallway.
2025-01-22 17:16:59.067 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2936, 2942) --> . Mary journeyed to the
2025-01-22 17:16:59.067 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the kitchen.
2025-01-22 17:16:59.089 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4272, 4277) -->  John went to the kitchen
2025-01-22 17:16:59.089 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel travelled to the garden.
2025-01-22 17:16:59.124 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6698, 6703) --> . Daniel travelled to the
2025-01-22 17:16:59.124 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John moved to the office.
2025-01-22 17:16:59.153 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5005, 5010) --> . John moved to the
2025-01-22 17:16:59.153 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went to the garden.
2025-01-22 17:16:59.187 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6762, 6767) --> . Sandra went to the
2025-01-22 17:16:59.188 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra picked up the milk.
2025-01-22 17:16:59.210 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3799, 3804) --> . Sandra picked up the
2025-01-22 17:16:59.210 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel journeyed to the office.
2025-01-22 17:16:59.245 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6451, 6457) --> . Daniel journeyed to the
2025-01-22 17:16:59.246 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 17:16:59.246 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 17:16:59.246 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 17:16:59.246 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ‘©ğŸ¾\u200dâ¤\u200dğŸ’‹\u200dğŸ‘©ğŸ¼', 'ğŸŒ¦', 'ğŸ•”', 'ğŸ‘©ğŸ¾\u200dğŸ¤\u200dğŸ‘©ğŸ¼', 'ğŸŠğŸ»\u200dâ™€', 'ğŸ§‘ğŸ¼\u200dğŸ„', 'ğŸ¦¸ğŸ¾\u200dâ™‚ï¸', 'ğŸ§‘ğŸ¾\u200dğŸ«', 'ğŸ­', 'ğŸš¶ğŸ¿\u200dâ™€ï¸']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.15s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.29s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.43s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.06s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.52s/it]
Processing depth (0, 4, 5, 8):   3%|â–         | 3/100 [02:09<39:09, 24.23s/it]2025-01-22 17:17:15.327 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the football.
2025-01-22 17:17:15.376 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the office.
2025-01-22 17:17:15.396 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3594, 3599) --> . Mary travelled to the
2025-01-22 17:17:15.396 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the hallway.
2025-01-22 17:17:15.425 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4199, 4205) -->  Mary journeyed to the hallway
2025-01-22 17:17:15.425 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the kitchen.
2025-01-22 17:17:15.476 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6610, 6615) --> . John went to the
2025-01-22 17:17:15.476 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel travelled to the garden.
2025-01-22 17:17:15.516 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6665, 6670) -->  Daniel travelled to the garden
2025-01-22 17:17:15.517 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John moved to the office.
2025-01-22 17:17:15.541 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4899, 4904) --> . John moved to the
2025-01-22 17:17:15.541 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went to the garden.
2025-01-22 17:17:15.579 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6792, 6797) --> . Sandra went to the
2025-01-22 17:17:15.579 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra picked up the milk.
2025-01-22 17:17:15.597 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3646, 3651) --> . Sandra picked up the
2025-01-22 17:17:15.597 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel journeyed to the office.
2025-01-22 17:17:15.630 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6429, 6435) --> . Daniel journeyed to the
2025-01-22 17:17:15.630 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 17:17:15.630 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 17:17:15.630 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 17:17:15.630 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ‘¨ğŸ»\u200dğŸ’¼', 'ğŸ¦¤', 'ğŸ§‘ğŸ½\u200dğŸ¦½\u200dâ¡ï¸', 'ğŸ‘·ğŸ»', 'ğŸ‘ğŸ¾', 'ğŸ‘¤', 'ğŸ™‹ğŸ½', 'ğŸ‡¬ğŸ‡¬', 'ğŸ‘©\u200dğŸ¦¼\u200dâ¡ï¸', 'ğŸ‘©ğŸ¾\u200dğŸ¦³']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.85s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.13s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.67s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.19s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.81s/it]
Processing depth (1, 4, 5, 9):   3%|â–         | 3/100 [02:26<39:09, 24.23s/it]2025-01-22 17:17:32.932 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the football.
2025-01-22 17:17:32.936 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (806, 810) -->  Mary got the football
2025-01-22 17:17:32.936 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the office.
2025-01-22 17:17:32.954 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3566, 3571) --> . Mary travelled to the
2025-01-22 17:17:32.955 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the hallway.
2025-01-22 17:17:32.979 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4174, 4180) --> . Mary journeyed to the
2025-01-22 17:17:32.979 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the kitchen.
2025-01-22 17:17:33.015 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7187, 7192) -->  John went to the kitchen
2025-01-22 17:17:33.015 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel travelled to the garden.
2025-01-22 17:17:33.051 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6706, 6711) --> . Daniel travelled to the
2025-01-22 17:17:33.051 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John moved to the office.
2025-01-22 17:17:33.081 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4913, 4918) --> . John moved to the
2025-01-22 17:17:33.081 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went to the garden.
2025-01-22 17:17:33.118 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6834, 6839) --> . Sandra went to the
2025-01-22 17:17:33.119 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra picked up the milk.
2025-01-22 17:17:33.139 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3670, 3675) --> . Sandra picked up the
2025-01-22 17:17:33.139 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel journeyed to the office.
2025-01-22 17:17:33.177 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6461, 6467) --> . Daniel journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:17:34.027 | INFO     | test_jbb_embedding:begin_test:693 - Mary's house.<|eot_id|>
2025-01-22 17:17:34.027 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8234])
2025-01-22 17:17:36.276 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [397.2765625, 69.66577373725109, 156.71514423076923, 68.58940018315019, 31.025252525252526], 'topk_indices': array([6115, 8088, 8232,  809, 8227, 5985, 8229, 2806, 5986, 2808, 8228,
       6116, 5987, 6117, 6123, 5988, 2809, 6124,    0, 2810]), 'topk_tokens': [' asked', ' context', '<|end_header_id|>', ' football', 'Answer', ' on', '<|eot_id|>', '\n', '\n', 'vent', ':', ' by', 'the', ' the', '\n', ' way', 'urous', 'the', '<|begin_of_text|>', ' kids'], 'evidence_proportions': [1015.0, 388.0, 280.4375, 52.58125]}, 'weight': {'score': [22.38359375, 23.327161243322, 20.868389423076923, 23.33727106227106, 29.81912878787879], 'topk_indices': array([3348, 3375, 3268, 3220, 7515, 7477, 1540, 1478, 4362, 4346, 5163,
       5224, 7254, 7198, 3557, 3531, 4940, 4965, 5017, 4988]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.611328125, 20.75625, 20.052083333333332, 23.4265625]}, 'saliency': {'score': [2.4504638671875, 0.38972230812135744, 0.8499309833233173, 0.38322899228050594, 0.23313826744002525], 'topk_indices': array([6121, 7622, 7623, 8221, 7578, 8216, 2803, 6116, 6114, 8088, 6115,
       8224, 8227,  809, 5987, 2808, 5988, 6124, 2809, 2810]), 'topk_tokens': [' meet', ' Min', 'nes', ' football', 'nes', 'Question', ' competition', ' by', ' question', ' context', ' asked', ' hallway', 'Answer', ' football', 'the', 'vent', ' way', 'the', 'urous', ' kids'], 'evidence_proportions': [7.046875, 2.116796875, 1.4393717447916667, 0.3203125]}}, 'pred_res': "Mary's house.<|eot_id|>", 'score': 0}
2025-01-22 17:17:36.280 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:17:36.280 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-38_pid-3_1-4-5-9.pkl | len: 3 |  size: 1.99 KB
Processing depth (1, 4, 5, 9):   4%|â–         | 4/100 [02:30<1:09:02, 43.15s/it]is_0k: False
your chose emoji: ['ğŸ§‘ğŸ¿\u200dğŸš€', 'ğŸš£ğŸ»\u200dâ™‚ï¸', 'ğŸ‘©ğŸ¼\u200dğŸ¤\u200dğŸ‘©ğŸ¾', 'ğŸ•µğŸ¼\u200dâ™€ï¸', 'â›ˆï¸', 'ğŸƒğŸ¾\u200dâ™€ï¸\u200dâ¡ï¸', 'ğŸ‘©ğŸ½\u200dğŸ“', 'ğŸš£ğŸ»\u200dâ™‚', 'ğŸ‘¨ğŸ¿\u200dğŸ”§', 'ğŸƒğŸ¾\u200dâ™€']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.79s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.24s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:15<00:05,  5.09s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  3.44s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  4.04s/it]
Processing depth (1, 3, 5, 6):   4%|â–         | 4/100 [02:48<1:09:02, 43.15s/it]2025-01-22 17:17:54.730 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the football.
2025-01-22 17:17:54.735 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (844, 848) -->  Mary got the football
2025-01-22 17:17:54.735 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the office.
2025-01-22 17:17:54.750 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2987, 2992) -->  tragedy. Mary travelled to
2025-01-22 17:17:54.750 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the hallway.
2025-01-22 17:17:54.772 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4247, 4253) -->  Mary journeyed to the hallway
2025-01-22 17:17:54.772 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the kitchen.
2025-01-22 17:17:54.796 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4891, 4896) --> . John went to the
2025-01-22 17:17:54.796 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel travelled to the garden.
2025-01-22 17:17:54.829 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6704, 6709) --> . Daniel travelled to the
2025-01-22 17:17:54.830 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John moved to the office.
2025-01-22 17:17:54.854 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5005, 5010) --> . John moved to the
2025-01-22 17:17:54.854 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went to the garden.
2025-01-22 17:17:54.889 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6744, 6749) --> . Sandra went to the
2025-01-22 17:17:54.889 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra picked up the milk.
2025-01-22 17:17:54.908 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3695, 3700) -->  Sandra picked up the milk
2025-01-22 17:17:54.908 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel journeyed to the office.
2025-01-22 17:17:54.941 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6457, 6463) --> . Daniel journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:17:55.763 | INFO     | test_jbb_embedding:begin_test:693 - Mary's house.<|eot_id|>
2025-01-22 17:17:55.763 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8210])
2025-01-22 17:17:58.015 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [484.275, 49.438546486848516, 255.98798076923077, 47.715914309331374, 42.15809087643678], 'topk_indices': array([8106,   24, 8107, 8206,  848, 8063,   14, 8105, 8098, 8124, 8208,
       8126, 8136, 8064, 8108, 8137,  847, 8138,    0, 8205]), 'topk_tokens': [' the', '\n\n', ' first', '<|start_header_id|>', '.', ' you', '\n', ' in', '.\n\n', '.\n', '<|end_header_id|>', ' a', ' moved', ' context', ' location', ' to', ' football', ' the', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [1484.25, 238.175, 316.5, 131.725]}, 'weight': {'score': [24.162109375, 23.294340599123235, 21.743689903846153, 23.29715244611805, 29.16271551724138], 'topk_indices': array([3321, 3294, 3190, 3142, 7457, 7495, 1438, 1500, 4340, 4324, 5224,
       5163, 7234, 7178, 3503, 3477, 4943, 4918, 4966, 4995]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.611328125, 26.5640625, 25.131510416666668, 18.6375]}, 'saliency': {'score': [3.2391357421875, 0.27388662718240075, 1.3700138972355769, 0.2631342035574333, 0.3050951025951868], 'topk_indices': array([8113, 8128, 8126, 8125,  844, 8101, 8110, 8098, 2401, 8063,  845,
       8200, 8138, 8107, 8137, 5007, 8108, 8064, 8136,  847]), 'topk_tokens': [' second', ' left', ' a', 'If', ' Mary', ' person', ' traveled', '.\n\n', 'little', ' you', ' got', ' hallway', ' the', ' first', ' to', ' moved', ' location', ' context', ' moved', ' football'], 'evidence_proportions': [10.369140625, 1.451513671875, 2.1256510416666665, 0.658935546875]}}, 'pred_res': "Mary's house.<|eot_id|>", 'score': 0}
2025-01-22 17:17:58.022 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:17:58.022 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-38_pid-4_1-3-5-6.pkl | len: 3 |  size: 2.01 KB
Processing depth (1, 3, 5, 6):   5%|â–Œ         | 5/100 [02:51<56:05, 35.43s/it]  Processing depth (1, 3, 5, 6):   5%|â–Œ         | 5/100 [02:52<54:28, 34.41s/it]
2025-01-22 17:17:58.093 | INFO     | __main__:<module>:82 - Selected idx: 40
2025-01-22 17:17:58.093 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the football before the office? 
2025-01-22 17:17:58.093 | INFO     | __main__:<module>:84 - Answer: kitchen
2025-01-22 17:17:58.093 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 17:17:58.093 | INFO     | __main__:<module>:86 - Needle: [' John travelled to the kitchen.', ' Mary travelled to the bedroom.', ' Daniel picked up the football.', ' John went back to the garden.', ' Sandra went to the bathroom.', ' Daniel moved to the kitchen.', ' John travelled to the bathroom.', ' Daniel moved to the office.', ' Sandra journeyed to the bedroom.']
2025-01-22 17:17:58.093 | INFO     | __main__:<module>:87 - Real Needle: [' Daniel picked up the football.', ' Daniel moved to the kitchen.', ' Daniel moved to the office.', ' Sandra journeyed to the bedroom.']
2025-01-22 17:17:58.093 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ§˜ğŸ¿\u200dâ™€ï¸', 'ğŸ‡¨ğŸ‡°', 'ğŸ™†ğŸ»\u200dâ™€', 'ğŸ¦µğŸ»', 'ğŸ‘¨ğŸ¿\u200dğŸ¤\u200dğŸ‘¨ğŸ½', 'ğŸ—„ï¸', 'ğŸ¤ğŸ»', 'ğŸ¤ŸğŸ»', 'ğŸ‘¨ğŸ¼\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘¨ğŸ¼', 'ğŸ‘¶ğŸ½']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.41s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.79s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.71s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.31s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.81s/it]
Processing depth (0, 2, 3, 4):   0%|          | 0/100 [00:17<?, ?it/s]2025-01-22 17:18:15.275 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the football.
2025-01-22 17:18:15.275 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the football.
2025-01-22 17:18:15.276 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the kitchen.
2025-01-22 17:18:15.285 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1814, 1819) --> . Daniel moved to the
2025-01-22 17:18:15.285 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 17:18:15.294 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1814, 1819) --> . Daniel moved to the
2025-01-22 17:18:15.294 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra journeyed to the bedroom.
2025-01-22 17:18:15.313 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3649, 3655) -->  Hon. Sandra journeyed to
2025-01-22 17:18:15.313 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the kitchen.
2025-01-22 17:18:15.334 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3957, 3962) -->  travelled to the bathroom.
2025-01-22 17:18:15.334 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the bedroom.
2025-01-22 17:18:15.343 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1588, 1593) --> . Mary travelled to the
2025-01-22 17:18:15.343 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the garden.
2025-01-22 17:18:15.343 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (149, 155) --> . John went back to the
2025-01-22 17:18:15.344 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the bathroom.
2025-01-22 17:18:15.356 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2510, 2515) --> . Sandra went to the
2025-01-22 17:18:15.357 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John travelled to the bathroom.
2025-01-22 17:18:15.379 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3956, 3961) -->  John travelled to the bathroom
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:18:16.179 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 17:18:16.179 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8193])
2025-01-22 17:18:18.397 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [225.94345238095238, 19.54507724804783, 101.20733173076923, 18.752638360535034, 8.622233072916666], 'topk_indices': array([  14,   65, 8181, 8191,   28,   64, 8183,   35,   69,  173,  188,
        105,  191,  172,   66,   67,   68, 8188,  192,    0]), 'topk_tokens': ['\n', ' OF', ' before', '<|end_header_id|>', '<|end_header_id|>', 'ENCES', ' office', '.', 'ER', 'E', 'G', 'ION', ' P', 'ION', ' P', 'ION', 'E', '<|eot_id|>', 'ION', '<|begin_of_text|>'], 'evidence_proportions': [436.85, 239.825, 239.825, 27.052083333333332]}, 'weight': {'score': [21.992931547619047, 23.30340257442655, 21.756911057692307, 23.31171386059639, 30.247796474358974], 'topk_indices': array([3294, 3321, 3214, 3166, 7432, 7470, 1444, 1506, 4384, 4368, 5240,
       5179, 7209, 7153, 3495, 3521, 4956, 4981, 5004, 5033]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.2875, 19.909375, 19.909375, 25.220052083333332]}, 'saliency': {'score': [1.1853579566592263, 0.11003755464269918, 0.5313579852764423, 0.10592219574727343, 0.06663268651717748], 'topk_indices': array([8091,   69,  173, 1819,   63, 8180,  188, 8047, 8181,   34,  191,
          0, 8183,   64,  105,   66,   68,  172,   67,  192]), 'topk_tokens': [' location', 'ER', 'E', ' kitchen', 'ISC', ' football', 'G', ' context', ' before', ' football', ' P', '<|begin_of_text|>', ' office', 'ENCES', 'ION', ' P', 'E', 'ION', 'ION', 'ION'], 'evidence_proportions': [2.30859375, 1.23994140625, 1.23994140625, 0.158355712890625]}}, 'pred_res': 'The garden.<|eot_id|>', 'score': 0}
2025-01-22 17:18:18.408 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:18:18.408 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-40_pid-0_0-2-3-4.pkl | len: 3 |  size: 1.96 KB
Processing depth (0, 2, 3, 4):   1%|          | 1/100 [00:20<33:21, 20.22s/it]is_0k: False
your chose emoji: ['ğŸš¶ğŸ¾\u200dâ™‚\u200dâ¡', 'ğŸ™‹ğŸ¼\u200dâ™€ï¸', '\U0001faf3ğŸ¿', 'ğŸ‘³\u200dâ™€ï¸', 'ğŸ™‚\u200dâ†•', 'ğŸ‹ğŸ»\u200dâ™€', 'ğŸ•¢', 'ğŸŠğŸ»\u200dâ™‚', 'ğŸ‘©ğŸ½\u200dâœˆï¸', 'ğŸ§–ğŸ¿\u200dâ™‚ï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.38s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.60s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.52s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  2.93s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.51s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (1, 2, 5, 6):   1%|          | 1/100 [00:36<33:21, 20.22s/it]2025-01-22 17:18:34.570 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the football.
2025-01-22 17:18:34.574 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (768, 773) --> . Daniel picked up the
2025-01-22 17:18:34.574 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the kitchen.
2025-01-22 17:18:34.584 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1736, 1741) --> . Daniel moved to the
2025-01-22 17:18:34.584 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 17:18:34.593 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1736, 1741) --> . Daniel moved to the
2025-01-22 17:18:34.593 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra journeyed to the bedroom.
2025-01-22 17:18:34.623 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4880, 4886) --> . Sandra journeyed to the
2025-01-22 17:18:34.623 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the kitchen.
2025-01-22 17:18:34.646 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4040, 4045) --> . John travelled to the
2025-01-22 17:18:34.646 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the bedroom.
2025-01-22 17:18:34.656 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1531, 1536) -->  Mary travelled to the bedroom
2025-01-22 17:18:34.656 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the garden.
2025-01-22 17:18:34.657 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (109, 115) --> . John went back to the
2025-01-22 17:18:34.657 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the bathroom.
2025-01-22 17:18:34.669 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2408, 2413) --> . Sandra went to the
2025-01-22 17:18:34.670 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John travelled to the bathroom.
2025-01-22 17:18:34.691 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4040, 4045) --> . John travelled to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:18:37.889 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's location.<|eot_id|>
2025-01-22 17:18:37.889 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8183])
2025-01-22 17:18:40.717 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [354.2886904761905, 31.463533395431224, 234.0721153846154, 29.983357522422903, 29.091903895547944], 'topk_indices': array([   1, 8078, 8171,   28,  268, 8079,   14,   31, 8071,  774, 8080,
       8170, 8179,  769,  110,  773, 8181, 8178, 8081,    0]), 'topk_tokens': ['<|start_header_id|>', ' in', ' before', '<|end_header_id|>', 'hue', ' the', '\n', 'ï¿½', '.\n\n', '.', ' first', ' football', '<|start_header_id|>', ' Daniel', ' John', ' football', '<|end_header_id|>', '<|eot_id|>', ' location', '<|begin_of_text|>'], 'evidence_proportions': [596.45, 414.2, 414.2, 52.635416666666664]}, 'weight': {'score': [20.866071428571427, 23.275037029684828, 21.35486778846154, 23.28738654165131, 29.141267123287673], 'topk_indices': array([3299, 3272, 3144, 3192, 7412, 7450, 1484, 1422, 4279, 4263, 5142,
       5081, 7133, 7189, 3481, 3455, 4935, 4876, 4906, 4851]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.3625, 19.909375, 19.909375, 21.213541666666668]}, 'saliency': {'score': [1.9186488560267858, 0.17619547784517775, 1.3979116586538463, 0.16779688567871515, 0.21132544948630136], 'topk_indices': array([8176, 8173, 8165, 8077, 8071, 1535,   31,  115,  770, 8171, 8109,
       1741,   30, 8080,  268,  110, 8170,  769,  773, 8081]), 'topk_tokens': ['Answer', ' office', 'Question', ' item', '.\n\n', ' bedroom', 'ï¿½', ' garden', ' picked', ' before', ' moved', ' kitchen', 'ï¿½', ' first', 'hue', ' John', ' football', ' Daniel', ' football', ' location'], 'evidence_proportions': [3.5701171875, 2.0685546875, 2.0685546875, 0.2925821940104167]}}, 'pred_res': "Daniel's location.<|eot_id|>", 'score': 0}
2025-01-22 17:18:40.722 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:18:40.723 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-40_pid-1_1-2-5-6.pkl | len: 3 |  size: 2.06 KB
Processing depth (1, 2, 5, 6):   2%|â–         | 2/100 [00:42<35:02, 21.45s/it]is_0k: False
your chose emoji: ['ğŸ¤—', '\U0001f9cc', 'ğŸ¤·ğŸ¾\u200dâ™‚ï¸', 'ğŸ‘¨ğŸ¿\u200dğŸ¦±', 'ğŸ‘©ğŸ¿\u200dğŸ¦¯\u200dâ¡', 'ğŸ¤¦ğŸ¼', 'â¬…ï¸', 'â™Ÿ', 'ğŸ‘©\u200dğŸš’', 'ğŸ‘©ğŸ¿\u200dâ¤\u200dğŸ‘¨ğŸ½']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.63s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.87s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.89s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.39s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.92s/it]
Processing depth (0, 3, 6, 9):   2%|â–         | 2/100 [01:00<35:02, 21.45s/it]2025-01-22 17:18:58.288 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the football.
2025-01-22 17:18:58.289 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the football.
2025-01-22 17:18:58.289 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the kitchen.
2025-01-22 17:18:58.307 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2938, 2943) --> . Daniel moved to the
2025-01-22 17:18:58.307 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 17:18:58.322 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2938, 2943) --> . Daniel moved to the
2025-01-22 17:18:58.322 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra journeyed to the bedroom.
2025-01-22 17:18:58.359 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7319, 7325) -->  cold. Sandra journeyed to
2025-01-22 17:18:58.359 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the kitchen.
2025-01-22 17:18:58.379 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4064, 4069) --> . John travelled to the
2025-01-22 17:18:58.379 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the bedroom.
2025-01-22 17:18:58.388 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1776, 1781) --> . Mary travelled to the
2025-01-22 17:18:58.388 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the garden.
2025-01-22 17:18:58.389 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (149, 155) --> . John went back to the
2025-01-22 17:18:58.389 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the bathroom.
2025-01-22 17:18:58.401 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2494, 2499) --> . Sandra went to the
2025-01-22 17:18:58.401 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John travelled to the bathroom.
2025-01-22 17:18:58.421 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4064, 4069) --> . John travelled to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:18:59.259 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 17:18:59.259 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8219])
2025-01-22 17:19:01.497 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [301.59393601190476, 23.29766746229628, 130.46153846153845, 22.241950974770642, 6.323649982829671], 'topk_indices': array([  66,   31,  191, 8208,  172, 8217,   24, 8206, 8210,  105,   28,
         35, 4889,   67,   68,  192, 8207, 8209, 8214,    0]), 'topk_tokens': [' P', ' picked', ' P', ' the', 'ION', '<|end_header_id|>', '\n\n', ' football', '?', 'ION', '<|end_header_id|>', '.', ' office', 'ION', 'E', 'ION', ' before', ' office', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [547.6, 348.15, 348.15, 18.995442708333332]}, 'weight': {'score': [21.805431547619047, 23.32760809413768, 20.311298076923077, 23.34111142966361, 30.349416208791208], 'topk_indices': array([3296, 3323, 3198, 3150, 7480, 7442, 1474, 1412, 4281, 4297, 5195,
       5134, 7156, 7212, 3505, 3479, 4911, 4936, 4959, 4988]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.2875, 19.909375, 19.909375, 24.563802083333332]}, 'saliency': {'score': [1.6398547944568453, 0.13055065083579118, 0.6807861328125, 0.12492355486668578, 0.04754978221851391], 'topk_indices': array([  39,   38, 8203, 8201, 8210, 2943,  172, 1221,    0, 2939,  105,
         34,   31,   68,   67, 8206, 4889,  192, 8207, 8209]), 'topk_tokens': ['\n\n\n', '***', ' Where', 'Question', '?', ' kitchen', 'ION', 'nes', '<|begin_of_text|>', ' Daniel', 'ION', ' football', ' picked', 'E', 'ION', ' football', ' office', 'ION', ' before', ' office'], 'evidence_proportions': [2.996484375, 1.876953125, 1.876953125, 0.114166259765625]}}, 'pred_res': 'The garden.<|eot_id|>', 'score': 0}
2025-01-22 17:19:01.525 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:19:01.526 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-40_pid-2_0-3-6-9.pkl | len: 3 |  size: 2.0 KB
Processing depth (0, 3, 6, 9):   3%|â–         | 3/100 [01:03<34:12, 21.16s/it]is_0k: False
your chose emoji: ['ğŸ‘¨ğŸ¿\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘¨ğŸ½', 'ğŸ§ğŸ¾\u200dâ™€ï¸', 'ğŸ„ğŸ¼\u200dâ™€', 'ğŸ’±', 'ğŸ§ğŸ¼\u200dâ™€ï¸', 'ğŸ‹ğŸ»\u200dâ™€', 'ğŸ‘¨ğŸ¼\u200dâ¤\u200dğŸ’‹\u200dğŸ‘¨ğŸ¿', 'ğŸ§ğŸ¿\u200dâ™€ï¸', 'â›¹\u200dâ™€ï¸', '\U0001fada']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:05<00:15,  5.05s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.85s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.30s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.79s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.47s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (1, 2, 5, 7):   3%|â–         | 3/100 [01:19<34:12, 21.16s/it]2025-01-22 17:19:17.945 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the football.
2025-01-22 17:19:17.950 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (850, 855) --> . Daniel picked up the
2025-01-22 17:19:17.950 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the kitchen.
2025-01-22 17:19:17.960 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1888, 1893) --> . Daniel moved to the
2025-01-22 17:19:17.960 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 17:19:17.969 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1888, 1893) --> . Daniel moved to the
2025-01-22 17:19:17.970 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra journeyed to the bedroom.
2025-01-22 17:19:17.999 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5690, 5696) --> . Sandra journeyed to the
2025-01-22 17:19:17.999 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the kitchen.
2025-01-22 17:19:18.020 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4132, 4137) --> . John travelled to the
2025-01-22 17:19:18.020 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the bedroom.
2025-01-22 17:19:18.029 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1748, 1753) --> . Mary travelled to the
2025-01-22 17:19:18.029 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the garden.
2025-01-22 17:19:18.030 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (143, 149) --> . John went back to the
2025-01-22 17:19:18.030 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the bathroom.
2025-01-22 17:19:18.043 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2540, 2545) --> . Sandra went to the
2025-01-22 17:19:18.043 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John travelled to the bathroom.
2025-01-22 17:19:18.064 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4132, 4137) --> . John travelled to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:19:21.511 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 17:19:21.511 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8215])
2025-01-22 17:19:24.453 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [359.8177083333333, 39.77532550498905, 355.07211538461536, 37.949526144290786, 38.02541257022472], 'topk_indices': array([ 856, 8206,   24,  144, 2394,  150,  148, 1629,  264,  147, 8213,
        146, 8202, 8203, 8205,  855, 8210,  145,  149,    0]), 'topk_tokens': ['.', '?', '\n\n', ' John', 'nes', '.', ' the', ' time', 'hue', ' to', '<|end_header_id|>', ' back', ' football', ' before', ' office', ' football', '<|eot_id|>', ' went', ' garden', '<|begin_of_text|>'], 'evidence_proportions': [634.2, 407.25, 407.25, 52.111979166666664]}, 'weight': {'score': [20.866071428571427, 23.3000292802385, 20.311298076923077, 23.315794807857056, 29.243328651685392], 'topk_indices': array([3317, 3290, 3162, 3210, 7448, 7486, 1508, 1446, 4291, 4275, 5160,
       5221, 7169, 7225, 3473, 3499, 5014, 4985, 4962, 4937]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.3625, 19.909375, 19.909375, 21.213541666666668]}, 'saliency': {'score': [1.9751761300223214, 0.22570772558617516, 1.9279972956730769, 0.21579481831467615, 0.2734452151180653], 'topk_indices': array([7594, 1893, 1596, 2380, 8113,  852, 1629, 2408, 8197,  144, 2394,
        851,  146, 8203,  264, 8205, 8202,  145,  855,  149]), 'topk_tokens': ['nes', ' kitchen', ' part', 'nes', ' location', ' picked', ' time', 'nes', 'Question', ' John', 'nes', ' Daniel', ' back', ' before', 'hue', ' office', ' football', ' went', ' football', ' garden'], 'evidence_proportions': [3.790234375, 2.066015625, 2.066015625, 0.3112284342447917]}}, 'pred_res': 'The garden.<|eot_id|>', 'score': 0}
2025-01-22 17:19:24.473 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:19:24.473 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-40_pid-3_1-2-5-7.pkl | len: 3 |  size: 2.0 KB
Processing depth (1, 2, 5, 7):   4%|â–         | 4/100 [01:26<34:58, 21.86s/it]is_0k: False
your chose emoji: ['ğŸ§‘ğŸ»\u200dâ¤\u200dğŸ’‹\u200dğŸ§‘ğŸ¼', 'ğŸ¤¦\u200dâ™‚', 'ğŸ‡ºğŸ‡¦', 'ğŸ‘©ğŸ¼\u200dâ¤\u200dğŸ‘¨ğŸ¾', 'âºï¸', 'ğŸ‘©ğŸ¿\u200dğŸ¤\u200dğŸ‘©ğŸ¾', 'ğŸ—¡ï¸', 'ğŸš£ğŸ½', 'ğŸ‘©ğŸ»\u200dğŸ¦²', 'ğŸ¦¤']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:05<00:15,  5.31s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.03s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:15<00:05,  5.18s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  3.71s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  4.24s/it]
Processing depth (0, 3, 5, 7):   4%|â–         | 4/100 [01:45<34:58, 21.86s/it]2025-01-22 17:19:43.780 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the football.
2025-01-22 17:19:43.781 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the football.
2025-01-22 17:19:43.781 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the kitchen.
2025-01-22 17:19:43.798 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2979, 2984) -->  tragedy. Daniel moved to
2025-01-22 17:19:43.798 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 17:19:43.814 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2979, 2984) -->  tragedy. Daniel moved to
2025-01-22 17:19:43.814 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra journeyed to the bedroom.
2025-01-22 17:19:43.849 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5754, 5760) --> . Sandra journeyed to the
2025-01-22 17:19:43.849 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the kitchen.
2025-01-22 17:19:43.872 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4056, 4061) -->  travelled to the bathroom.
2025-01-22 17:19:43.872 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the bedroom.
2025-01-22 17:19:43.880 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1720, 1725) --> . Mary travelled to the
2025-01-22 17:19:43.880 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the garden.
2025-01-22 17:19:43.881 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (149, 155) --> . John went back to the
2025-01-22 17:19:43.881 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the bathroom.
2025-01-22 17:19:43.894 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2506, 2511) --> . Sandra went to the
2025-01-22 17:19:43.894 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John travelled to the bathroom.
2025-01-22 17:19:43.918 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4055, 4060) -->  John travelled to the bathroom
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:19:44.716 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 17:19:44.716 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8191])
2025-01-22 17:19:47.054 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [213.80208333333334, 25.91550028984623, 130.72596153846155, 25.096709294832454, 12.40430955762987], 'topk_indices': array([8189, 8181, 1207,   34,   28,   69, 1226, 1212, 1213,   66, 1168,
        192,  105, 1152, 1167,   67, 8186, 1227,   68,    0]), 'topk_tokens': ['<|end_header_id|>', ' office', 'nes', ' football', '<|end_header_id|>', 'ER', 'Min', '\n', 'P', ' P', 'ot', 'ION', 'ION', '\n', 'nes', 'ION', '<|eot_id|>', 'nes', 'E', '<|begin_of_text|>'], 'evidence_proportions': [525.0, 159.865625, 159.865625, 44.364583333333336]}, 'weight': {'score': [23.613839285714285, 23.29346930680986, 21.756911057692307, 23.297547218301215, 29.80945616883117], 'topk_indices': array([3289, 3262, 3182, 3134, 7418, 7456, 1480, 1418, 4311, 4327, 5142,
       5203, 7139, 7195, 3471, 3445, 4996, 4919, 4944, 4967]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.2875, 25.7171875, 25.7171875, 21.213541666666668]}, 'saliency': {'score': [1.2537943522135417, 0.14713512864786735, 0.6949650691105769, 0.1425342421685609, 0.09595380510602679], 'topk_indices': array([8089,   64, 2985,   69, 1147,    0, 8181, 1213, 1207,   66, 1154,
       1168,   34, 1226,  192,  105,   68,   67, 1167, 1227]), 'topk_tokens': [' location', 'ENCES', ' kitchen', 'ER', 'nes', '<|begin_of_text|>', ' office', 'P', 'nes', ' P', 'ioneer', 'ot', ' football', 'Min', 'ION', 'ION', 'E', 'ION', 'nes', 'nes'], 'evidence_proportions': [3.03359375, 0.961572265625, 0.961572265625, 0.2576649983723958]}}, 'pred_res': 'The garden.<|eot_id|>', 'score': 0}
2025-01-22 17:19:47.060 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:19:47.061 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-40_pid-4_0-3-5-7.pkl | len: 3 |  size: 1.96 KB
Processing depth (0, 3, 5, 7):   5%|â–Œ         | 5/100 [01:48<35:01, 22.12s/it]Processing depth (0, 3, 5, 7):   5%|â–Œ         | 5/100 [01:49<34:40, 21.90s/it]
2025-01-22 17:19:47.700 | INFO     | __main__:<module>:82 - Selected idx: 42
2025-01-22 17:19:47.700 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the football before the office? 
2025-01-22 17:19:47.700 | INFO     | __main__:<module>:84 - Answer: kitchen
2025-01-22 17:19:47.700 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 17:19:47.700 | INFO     | __main__:<module>:86 - Needle: [' Mary travelled to the bedroom.', ' Sandra went to the bathroom.', ' Daniel took the football.', ' John travelled to the bathroom.', ' Sandra went to the kitchen.', ' John travelled to the kitchen.', ' Daniel moved to the kitchen.', ' John went back to the garden.', ' Sandra journeyed to the bedroom.', ' Daniel moved to the office.', ' John went back to the office.']
2025-01-22 17:19:47.700 | INFO     | __main__:<module>:87 - Real Needle: [' Daniel took the football.', ' Daniel moved to the kitchen.', ' Daniel moved to the office.', ' John went back to the office.']
2025-01-22 17:19:47.700 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ§šğŸ¿\u200dâ™‚ï¸', 'ğŸŒ‰', 'ğŸ‘³ğŸ»', 'ğŸ‘®ğŸ¼\u200dâ™‚ï¸', 'ğŸ™ğŸ¾\u200dâ™‚ï¸', 'ğŸŒ¦ï¸', 'ğŸ‘¼', 'ğŸ‘©ğŸ¼\u200dğŸ¦¯\u200dâ¡', 'â•', 'ğŸ§‘ğŸ¿\u200dâ¤ï¸\u200dğŸ§‘ğŸ»']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.52s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.63s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.41s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.86s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.47s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (1, 2, 8, 9):   0%|          | 0/100 [00:15<?, ?it/s]2025-01-22 17:20:03.844 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel took the football.
2025-01-22 17:20:03.848 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (902, 906) -->  Daniel took the football
2025-01-22 17:20:03.849 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the kitchen.
2025-01-22 17:20:03.859 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2016, 2021) -->  cable. Daniel moved to
2025-01-22 17:20:03.859 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 17:20:03.869 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2016, 2021) -->  cable. Daniel moved to
2025-01-22 17:20:03.869 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the office.
2025-01-22 17:20:03.881 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2021, 2027) -->  the kitchen. John went back
2025-01-22 17:20:03.882 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the bedroom.
2025-01-22 17:20:03.908 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4616, 4621) --> . Mary travelled to the
2025-01-22 17:20:03.908 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went to the bathroom.
2025-01-22 17:20:03.919 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2126, 2131) --> . Sandra went to the
2025-01-22 17:20:03.919 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the bathroom.
2025-01-22 17:20:03.923 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (751, 756) --> . John travelled to the
2025-01-22 17:20:03.923 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the kitchen.
2025-01-22 17:20:03.933 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2021, 2026) -->  the kitchen. John went
2025-01-22 17:20:03.933 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John travelled to the kitchen.
2025-01-22 17:20:03.937 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (751, 756) --> . John travelled to the
2025-01-22 17:20:03.937 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John went back to the garden.
2025-01-22 17:20:03.947 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (2021, 2027) -->  the kitchen. John went back
2025-01-22 17:20:03.947 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Sandra journeyed to the bedroom.
2025-01-22 17:20:03.956 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (1388, 1394) --> . Sandra journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:20:07.454 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 17:20:07.454 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8181])
2025-01-22 17:20:10.395 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [287.94375, 17.339902935606062, 158.5122466216216, 16.031246154792665, 11.528616240530303], 'topk_indices': array([ 902, 8170, 2022,   28,  903,    1, 8035, 8168,   24, 8175, 8079,
        901,   14, 8171, 8169,  906, 8179,  905, 8176,    0]), 'topk_tokens': [' Daniel', ' the', ' kitchen', '<|end_header_id|>', ' took', '<|start_header_id|>', ' context', ' football', '\n\n', ':', ' location', '.', '\n', ' office', ' before', '.', '<|end_header_id|>', ' football', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [565.5, 241.33125, 241.33125, 180.59375]}, 'weight': {'score': [24.542578125, 23.26853845918866, 21.29983108108108, 23.27436611757106, 29.517045454545453], 'topk_indices': array([3325, 3298, 3218, 3170, 7448, 7410, 1479, 1417, 4319, 4303, 5120,
       5181, 7176, 7120, 3481, 3507, 4974, 4945, 4922, 4897]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.826171875, 24.3359375, 24.3359375, 23.364583333333332]}, 'saliency': {'score': [1.81402587890625, 0.09622107363166697, 0.896549534153294, 0.0883499958483777, 0.08587091619318182], 'topk_indices': array([8165, 8034, 8069, 1394, 8033, 2019,   24, 8163,  753,  756, 8174,
        903,  902, 8035, 2022, 8079, 8169, 8168, 8171,  905]), 'topk_tokens': [' Where', ' you', '.\n\n', ' bedroom', ' provided', ' moved', '\n\n', 'Question', ' travelled', ' kitchen', 'Answer', ' took', ' Daniel', ' context', ' kitchen', ' location', ' before', ' football', ' office', ' football'], 'evidence_proportions': [3.9931640625, 1.377197265625, 1.377197265625, 1.0893147786458333]}}, 'pred_res': 'The garden.<|eot_id|>', 'score': 0}
2025-01-22 17:20:10.403 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:20:10.403 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-42_pid-0_1-2-8-9.pkl | len: 3 |  size: 2.06 KB
Processing depth (1, 2, 8, 9):   1%|          | 1/100 [00:22<37:14, 22.57s/it]is_0k: False
your chose emoji: ['ğŸ§™ğŸ¿\u200dâ™‚', 'â¤ï¸', 'ğŸ‘·ğŸ¾\u200dâ™‚', 'ğŸ§¡', 'ğŸ‘©ğŸ»\u200dğŸ³', 'ğŸªƒ', 'ğŸ§‘ğŸ¼\u200dğŸ¦°', 'âœ”ï¸', 'ğŸ§ƒ', 'ğŸ‘¨ğŸ½\u200dâ¤\u200dğŸ‘¨ğŸ¾']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.82s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.90s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.54s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.14s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.72s/it]
Processing depth (1, 4, 5, 9):   1%|          | 1/100 [00:39<37:14, 22.57s/it]2025-01-22 17:20:27.323 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel took the football.
2025-01-22 17:20:27.328 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (822, 826) -->  Daniel took the football
2025-01-22 17:20:27.328 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the kitchen.
2025-01-22 17:20:27.348 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3621, 3626) -->  Hon. Daniel moved to
2025-01-22 17:20:27.348 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 17:20:27.366 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3621, 3626) -->  Hon. Daniel moved to
2025-01-22 17:20:27.367 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the office.
2025-01-22 17:20:27.376 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1805, 1811) --> . John went back to the
2025-01-22 17:20:27.376 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the bedroom.
2025-01-22 17:20:27.400 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4842, 4847) --> . Mary travelled to the
2025-01-22 17:20:27.400 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went to the bathroom.
2025-01-22 17:20:27.410 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1884, 1889) --> . Sandra went to the
2025-01-22 17:20:27.410 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the bathroom.
2025-01-22 17:20:27.413 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (631, 636) --> . John travelled to the
2025-01-22 17:20:27.413 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the kitchen.
2025-01-22 17:20:27.423 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1884, 1889) --> . Sandra went to the
2025-01-22 17:20:27.423 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John travelled to the kitchen.
2025-01-22 17:20:27.426 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (631, 636) --> . John travelled to the
2025-01-22 17:20:27.426 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John went back to the garden.
2025-01-22 17:20:27.436 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (1805, 1811) --> . John went back to the
2025-01-22 17:20:27.436 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Sandra journeyed to the bedroom.
2025-01-22 17:20:27.443 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (1276, 1282) --> . Sandra journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:20:28.230 | INFO     | test_jbb_embedding:begin_test:693 - The bedroom.<|eot_id|>
2025-01-22 17:20:28.230 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8153])
2025-01-22 17:20:30.459 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [249.790625, 15.415334569641981, 111.37162162162163, 14.39818573280652, 17.471905048076923], 'topk_indices': array([8134,   24, 8146,  637,  821, 8140,   14,  823,  826,  824, 8051,
         28,  822, 8143, 8141, 8147, 8148, 8151,  825,    0]), 'topk_tokens': ['.\n\n', '\n\n', 'Answer', '.', '.', ' football', '\n', ' took', '.', ' the', ' location', '<|end_header_id|>', ' Daniel', ' office', ' before', ':', '<|eot_id|>', '<|end_header_id|>', ' football', '<|begin_of_text|>'], 'evidence_proportions': [641.9375, 212.2125, 212.2125, 50.989583333333336]}, 'weight': {'score': [23.744921875, 23.24679683668465, 20.52322635135135, 23.258009283553527, 29.494290865384617], 'topk_indices': array([3284, 3311, 3156, 3204, 7426, 7388, 1441, 1503, 4275, 4291, 5092,
       5153, 7076, 7132, 3467, 3493, 4946, 4894, 4917, 4869]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.826171875, 24.7171875, 24.7171875, 20.0703125]}, 'saliency': {'score': [1.6110198974609375, 0.0859582142364517, 0.6092904580605997, 0.0798013397228101, 0.1301293006310096], 'topk_indices': array([8041, 3624,   24, 8144, 8134, 8147, 8122, 8007,  636, 8137, 8135,
        633,  823, 8051, 8146, 8140, 8141, 8143,  822,  825]), 'topk_tokens': ['.\n\n', ' moved', '\n\n', '?', '.\n\n', ':', ' return', ' context', ' kitchen', ' Where', 'Question', ' travelled', ' took', ' location', 'Answer', ' football', ' before', ' office', ' Daniel', ' football'], 'evidence_proportions': [4.549560546875, 1.244140625, 1.244140625, 0.263458251953125]}}, 'pred_res': 'The bedroom.<|eot_id|>', 'score': 0}
2025-01-22 17:20:30.465 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:20:30.465 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-42_pid-1_1-4-5-9.pkl | len: 3 |  size: 2.01 KB
Processing depth (1, 4, 5, 9):   2%|â–         | 2/100 [00:42<34:27, 21.10s/it]is_0k: False
your chose emoji: ['ğŸš', 'âš ', 'ğŸŒª', 'â˜', 'ğŸ§\u200dâ™‚ï¸', 'ğŸ”´', 'ğŸš£\u200dâ™‚ï¸', 'ğŸ§šğŸ¼\u200dâ™‚', 'ğŸ¦µğŸ¼', 'ğŸ¤¦ğŸ¾\u200dâ™€ï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:05<00:15,  5.13s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.33s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.75s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.26s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.91s/it]
Processing depth (5, 6, 8, 9):   2%|â–         | 2/100 [01:00<34:27, 21.10s/it]2025-01-22 17:20:48.071 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel took the football.
2025-01-22 17:20:48.094 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4229, 4233) -->  took the football.
2025-01-22 17:20:48.094 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the kitchen.
2025-01-22 17:20:48.120 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4782, 4787) -->  the senate. Daniel moved
2025-01-22 17:20:48.120 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 17:20:48.144 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4782, 4787) -->  the senate. Daniel moved
2025-01-22 17:20:48.145 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the office.
2025-01-22 17:20:48.154 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1862, 1868) -->  went back to the garden.
2025-01-22 17:20:48.155 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the bedroom.
2025-01-22 17:20:48.186 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4722, 4727) --> . Mary travelled to the
2025-01-22 17:20:48.186 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went to the bathroom.
2025-01-22 17:20:48.197 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2030, 2035) -->  cable. Sandra went to
2025-01-22 17:20:48.197 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the bathroom.
2025-01-22 17:20:48.201 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (751, 756) --> . John travelled to the
2025-01-22 17:20:48.201 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the kitchen.
2025-01-22 17:20:48.213 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2030, 2035) -->  cable. Sandra went to
2025-01-22 17:20:48.213 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John travelled to the kitchen.
2025-01-22 17:20:48.218 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (751, 756) --> . John travelled to the
2025-01-22 17:20:48.218 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John went back to the garden.
2025-01-22 17:20:48.230 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (1861, 1867) -->  John went back to the garden
2025-01-22 17:20:48.230 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Sandra journeyed to the bedroom.
2025-01-22 17:20:48.238 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (1383, 1389) --> . Sandra journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:20:49.027 | INFO     | test_jbb_embedding:begin_test:693 - The bedroom.<|eot_id|>
2025-01-22 17:20:49.028 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8205])
2025-01-22 17:20:51.270 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [197.034375, 18.27625106603314, 106.60388513513513, 17.43668721629248, 16.305814302884617], 'topk_indices': array([4789,   24, 8189, 8187, 8093, 8190, 4232, 8199, 8059, 8188,   14,
       8103, 4228, 8195, 8193, 4231, 8192, 8200, 8203,    0]), 'topk_tokens': [' kitchen', '\n\n', ' Where', 'Question', '.\n\n', ' was', '.', ':', ' context', ':', '\n', ' location', ' Daniel', ' office', ' before', ' football', ' football', '<|eot_id|>', '<|end_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [462.0, 152.025, 152.025, 95.40625]}, 'weight': {'score': [22.64609375, 23.274682474415204, 22.32960304054054, 23.280514852472088, 28.87900641025641], 'topk_indices': array([3326, 3299, 3219, 3171, 7462, 7424, 1474, 1412, 4303, 4319, 5150,
       5211, 7138, 7194, 3482, 3508, 4952, 5004, 4927, 4975]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.71484375, 24.6375, 24.6375, 20.614583333333332]}, 'saliency': {'score': [1.155120849609375, 0.10253448932491548, 0.61181640625, 0.0976399784511678, 0.11498769124348958], 'topk_indices': array([ 756, 4786, 8093, 8174, 8102, 6547, 8190, 8057, 4229, 8198, 8189,
       4789, 8187, 8059, 8103, 8193, 8195, 4228, 4231, 8192]), 'topk_tokens': [' kitchen', ' moved', '.\n\n', ' return', ' first', ' office', ' was', ' provided', ' took', 'Answer', ' Where', ' kitchen', 'Question', ' context', ' location', ' before', ' office', ' Daniel', ' football', ' football'], 'evidence_proportions': [2.585205078125, 0.984375, 0.984375, 0.4863077799479167]}}, 'pred_res': 'The bedroom.<|eot_id|>', 'score': 0}
2025-01-22 17:20:51.299 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:20:51.300 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-42_pid-2_5-6-8-9.pkl | len: 3 |  size: 2.04 KB
Processing depth (5, 6, 8, 9):   3%|â–         | 3/100 [01:03<33:54, 20.98s/it]is_0k: False
your chose emoji: ['ğŸ‘¨ğŸ»\u200dğŸ¦±', 'ğŸ‡²ğŸ‡¿', 'ğŸ‡¸ğŸ‡§', 'ğŸ¥', 'ğŸ‘¨ğŸ¼\u200dâ¤\u200dğŸ‘¨ğŸ¾', 'ğŸ§¦', 'ğŸ™ğŸ¿', 'ğŸš‰', 'ğŸ§›ğŸ¼\u200dâ™€ï¸', 'ğŸ§‘ğŸ¾\u200dğŸ¤\u200dğŸ§‘ğŸ¿']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.88s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.92s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.22s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.75s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.43s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (3, 5, 7, 9):   3%|â–         | 3/100 [01:18<33:54, 20.98s/it]2025-01-22 17:21:06.873 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel took the football.
2025-01-22 17:21:06.888 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2930, 2934) -->  Daniel took the football
2025-01-22 17:21:06.888 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the kitchen.
2025-01-22 17:21:06.909 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4200, 4205) --> . Daniel moved to the
2025-01-22 17:21:06.909 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 17:21:06.931 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4200, 4205) --> . Daniel moved to the
2025-01-22 17:21:06.932 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the office.
2025-01-22 17:21:06.941 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1820, 1826) --> . John went back to the
2025-01-22 17:21:06.942 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the bedroom.
2025-01-22 17:21:06.968 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4684, 4689) --> . Mary travelled to the
2025-01-22 17:21:06.968 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went to the bathroom.
2025-01-22 17:21:06.978 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1899, 1904) --> . Sandra went to the
2025-01-22 17:21:06.978 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the bathroom.
2025-01-22 17:21:06.982 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (631, 636) --> . John travelled to the
2025-01-22 17:21:06.982 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the kitchen.
2025-01-22 17:21:06.994 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1899, 1904) --> . Sandra went to the
2025-01-22 17:21:06.994 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John travelled to the kitchen.
2025-01-22 17:21:06.998 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (631, 636) --> . John travelled to the
2025-01-22 17:21:06.998 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John went back to the garden.
2025-01-22 17:21:07.008 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (1820, 1826) --> . John went back to the
2025-01-22 17:21:07.008 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Sandra journeyed to the bedroom.
2025-01-22 17:21:07.014 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (1271, 1277) --> . Sandra journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:21:11.787 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 17:21:11.787 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8235])
2025-01-22 17:21:15.252 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [129.70390625, 9.367864621267298, 48.462204391891895, 8.896869461251681, 13.286962365591398], 'topk_indices': array([2930,    8, 8133, 8229,    3,   23,    4, 8231, 8234,    9,   28,
       8123,   24,    1, 4205, 2933,   14,    0, 8233, 8230]), 'topk_tokens': [' Daniel', ' Date', ' location', ':', '<|end_header_id|>', '4', '\n\n', '<|start_header_id|>', '\n\n', ':', '<|end_header_id|>', '.\n\n', '\n\n', '<|start_header_id|>', ' kitchen', ' football', '\n', '<|begin_of_text|>', '<|end_header_id|>', '<|eot_id|>'], 'evidence_proportions': [272.625, 129.7875, 129.7875, 34.283854166666664]}, 'weight': {'score': [21.341015625, 23.311855122602573, 20.52322635135135, 23.32928527227723, 29.621471774193548], 'topk_indices': array([3336, 3363, 3208, 3256, 7512, 7474, 1480, 1418, 4387, 4371, 5200,
       5261, 7195, 7251, 3545, 3519, 5054, 5002, 4977, 5025]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.826171875, 19.909375, 19.909375, 20.0703125]}, 'saliency': {'score': [0.7991119384765625, 0.05126744191835852, 0.27790502599767736, 0.04841418674880726, 0.09682866578461022], 'topk_indices': array([8207, 8223, 8232,    4, 8217,   20, 8204, 8234, 4202,   23,   14,
       8222, 8133,   24,    8, 8123, 8228, 2930, 4205, 2933]), 'topk_tokens': [' directly', ' before', 'assistant', '\n\n', 'Question', ' Jul', ' return', '\n\n', ' moved', '4', '\n', ' football', ' location', '\n\n', ' Date', '.\n\n', 'Answer', ' Daniel', ' kitchen', ' football'], 'evidence_proportions': [1.95660400390625, 0.7083251953125, 0.7083251953125, 0.17876180013020834]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 100}
2025-01-22 17:21:15.258 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:21:15.258 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-42_pid-3_3-5-7-9.pkl | len: 3 |  size: 2.04 KB
Processing depth (3, 5, 7, 9):   4%|â–         | 4/100 [01:27<35:26, 22.15s/it]is_0k: False
your chose emoji: ['ğŸ‘¨\u200dğŸ‘§', 'ğŸ‡¯ğŸ‡´', 'ğŸ‚ğŸ¼', 'ğŸ‘©ğŸ½\u200dâ¤\u200dğŸ‘¨ğŸ¼', 'ğŸ¤·ğŸ½', 'ğŸ‘©ğŸ¿\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘¨ğŸ»', 'ğŸ‘¨ğŸ¼\u200dğŸ“', 'ğŸš¶ğŸ½\u200dâ™€\u200dâ¡ï¸', 'ğŸ—', 'ğŸ¤¸ğŸ½\u200dâ™‚ï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.46s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.88s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.80s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.30s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.84s/it]
Processing depth (2, 3, 4, 7):   4%|â–         | 4/100 [01:44<35:26, 22.15s/it]2025-01-22 17:21:32.407 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel took the football.
2025-01-22 17:21:32.416 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1861, 1865) -->  Daniel took the football
2025-01-22 17:21:32.416 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the kitchen.
2025-01-22 17:21:32.431 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2991, 2996) -->  tragedy. Daniel moved to
2025-01-22 17:21:32.432 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 17:21:32.447 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2991, 2996) -->  tragedy. Daniel moved to
2025-01-22 17:21:32.447 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the office.
2025-01-22 17:21:32.457 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1864, 1870) -->  football. John went back to
2025-01-22 17:21:32.457 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the bedroom.
2025-01-22 17:21:32.484 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4729, 4734) -->  Mary travelled to the bedroom
2025-01-22 17:21:32.485 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went to the bathroom.
2025-01-22 17:21:32.495 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2035, 2040) -->  cable. Sandra went to
2025-01-22 17:21:32.495 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the bathroom.
2025-01-22 17:21:32.499 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (751, 756) --> . John travelled to the
2025-01-22 17:21:32.499 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the kitchen.
2025-01-22 17:21:32.509 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2035, 2040) -->  cable. Sandra went to
2025-01-22 17:21:32.509 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John travelled to the kitchen.
2025-01-22 17:21:32.513 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (751, 756) --> . John travelled to the
2025-01-22 17:21:32.513 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John went back to the garden.
2025-01-22 17:21:32.522 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (1864, 1870) -->  football. John went back to
2025-01-22 17:21:32.523 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Sandra journeyed to the bedroom.
2025-01-22 17:21:32.529 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (1277, 1283) --> . Sandra journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:21:33.273 | INFO     | test_jbb_embedding:begin_test:693 - the garden<|eot_id|>
2025-01-22 17:21:33.273 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8191])
2025-01-22 17:21:35.498 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [146.9109375, 10.627646753722235, 89.34332770270271, 9.934744454344353, 6.312575649207746], 'topk_indices': array([2997,    3, 8181, 8179, 8178, 8079, 1861,   23,    1, 8190, 8185,
       8045, 8089,   28, 1864,   24,   14, 8186, 8189,    0]), 'topk_tokens': [' kitchen', '<|end_header_id|>', ' office', ' before', ' football', '.\n\n', ' Daniel', '4', '<|start_header_id|>', '\n\n', ':', ' context', ' location', '<|end_header_id|>', ' football', '\n\n', '\n', '<|eot_id|>', '<|end_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [231.6875, 101.596875, 101.596875, 165.91666666666666]}, 'weight': {'score': [25.365625, 23.270176729924334, 23.058699324324323, 23.265987925525376, 29.171434859154928], 'topk_indices': array([3301, 3274, 3146, 3194, 7476, 7438, 1486, 1424, 4297, 4313, 5132,
       5193, 7147, 7203, 3489, 3463, 4986, 4934, 4957, 4909]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.826171875, 25.7171875, 25.7171875, 23.805989583333332]}, 'saliency': {'score': [0.94891357421875, 0.05881793539146403, 0.5259795317778716, 0.05450591722225636, 0.04552051383005062], 'topk_indices': array([8188, 8079, 8190, 8160,   23, 8173,   20, 1871,  753, 8179,   24,
       8181, 8184, 2997, 2981, 8178, 8089, 1861, 8045, 1864]), 'topk_tokens': ['assistant', '.\n\n', '\n\n', ' return', '4', 'Question', ' Jul', ' garden', ' travelled', ' before', '\n\n', ' office', 'Answer', ' kitchen', 'lyn', ' football', ' location', ' Daniel', ' context', ' football'], 'evidence_proportions': [1.66986083984375, 0.6096435546875, 0.6096435546875, 1.0337320963541667]}}, 'pred_res': 'the garden<|eot_id|>', 'score': 0}
2025-01-22 17:21:35.504 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:21:35.504 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-42_pid-4_2-3-4-7.pkl | len: 3 |  size: 2.06 KB
Processing depth (2, 3, 4, 7):   5%|â–Œ         | 5/100 [01:47<33:59, 21.47s/it]Processing depth (2, 3, 4, 7):   5%|â–Œ         | 5/100 [01:47<34:08, 21.56s/it]
2025-01-22 17:21:35.622 | INFO     | __main__:<module>:82 - Selected idx: 44
2025-01-22 17:21:35.622 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the apple before the garden? 
2025-01-22 17:21:35.622 | INFO     | __main__:<module>:84 - Answer: bathroom
2025-01-22 17:21:35.622 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 17:21:35.622 | INFO     | __main__:<module>:86 - Needle: [' Daniel grabbed the apple.', ' Daniel travelled to the bathroom.', ' Mary travelled to the bedroom.', ' John went back to the garden.', ' John travelled to the bathroom.', ' Sandra went to the bathroom.', ' Daniel went to the garden.', ' John travelled to the kitchen.']
2025-01-22 17:21:35.622 | INFO     | __main__:<module>:87 - Real Needle: [' Daniel grabbed the apple.', ' Daniel travelled to the bathroom.', ' Daniel went to the garden.', ' John travelled to the kitchen.']
2025-01-22 17:21:35.622 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ‘©ğŸ¼\u200dâ¤ï¸\u200dğŸ‘©ğŸ¿', 'ğŸ™‹ğŸ¿', 'ğŸ‹ğŸ¾\u200dâ™€ï¸', 'ğŸŸ ', 'ğŸ‘©ğŸ¿\u200dğŸ«', 'ğŸ‡µğŸ‡³', 'ğŸ¦¶ğŸ»', 'ğŸ‘®ğŸ¾', 'ğŸ‘¯', 'ğŸ‘‹ğŸ¾']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.16s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.70s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.47s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.88s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.47s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 1, 6, 7):   0%|          | 0/100 [00:15<?, ?it/s]2025-01-22 17:21:51.339 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel grabbed the apple.
2025-01-22 17:21:51.388 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel travelled to the bathroom.
2025-01-22 17:21:51.392 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (672, 677) --> . Daniel travelled to the
2025-01-22 17:21:51.392 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the garden.
2025-01-22 17:21:51.417 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4706, 4711) --> . Daniel went to the
2025-01-22 17:21:51.417 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John travelled to the kitchen.
2025-01-22 17:21:51.445 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5626, 5631) --> . John travelled to the
2025-01-22 17:21:51.445 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the bedroom.
2025-01-22 17:21:51.447 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (236, 241) --> . Mary travelled to the
2025-01-22 17:21:51.447 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the garden.
2025-01-22 17:21:51.486 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6642, 6648) --> . John went back to the
2025-01-22 17:21:51.486 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the bathroom.
2025-01-22 17:21:51.490 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (673, 678) -->  Daniel travelled to the bathroom
2025-01-22 17:21:51.490 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the bathroom.
2025-01-22 17:21:51.508 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3475, 3480) -->  Sandra went to the bathroom
2025-01-22 17:21:51.508 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 17:21:51.508 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 17:21:51.508 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 17:21:51.508 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ‘©ğŸ½\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘¨ğŸ¿', 'ğŸ³ï¸\u200dâš§', 'â†˜ï¸', 'ğŸ‘ ', '\U0001faf5ğŸ¾', 'ğŸ‘¨ğŸ¿\u200dâœˆ', 'ğŸ¦‹', 'ğŸ§™ğŸ½\u200dâ™‚', 'ğŸ™†ğŸ½\u200dâ™€ï¸', 'ğŸ‘¨ğŸ¾\u200dâœˆ']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.37s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.75s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.79s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.37s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.85s/it]
Processing depth (1, 3, 4, 7):   0%|          | 0/100 [00:32<?, ?it/s]2025-01-22 17:22:08.591 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel grabbed the apple.
2025-01-22 17:22:08.595 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (824, 828) -->  Daniel grabbed the apple
2025-01-22 17:22:08.595 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel travelled to the bathroom.
2025-01-22 17:22:08.610 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2818, 2823) --> . Daniel travelled to the
2025-01-22 17:22:08.610 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the garden.
2025-01-22 17:22:08.632 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3552, 3557) --> . Daniel went to the
2025-01-22 17:22:08.632 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John travelled to the kitchen.
2025-01-22 17:22:08.674 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5570, 5575) --> . John travelled to the
2025-01-22 17:22:08.675 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the bedroom.
2025-01-22 17:22:08.676 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (231, 236) --> . Mary travelled to the
2025-01-22 17:22:08.676 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the garden.
2025-01-22 17:22:08.714 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6612, 6618) --> . John went back to the
2025-01-22 17:22:08.714 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the bathroom.
2025-01-22 17:22:08.728 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2819, 2824) -->  Daniel travelled to the bathroom
2025-01-22 17:22:08.729 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the bathroom.
2025-01-22 17:22:08.749 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3500, 3505) --> . Sandra went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:22:09.508 | INFO     | test_jbb_embedding:begin_test:693 - bedroom<|eot_id|>
2025-01-22 17:22:09.508 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8127])
2025-01-22 17:22:11.738 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [161.13075657894737, 17.28493811500615, 229.20238095238096, 16.39701019777503, 17.048409598214285], 'topk_indices': array([ 828,  825,  230,  226,  827,   14,    1, 8123,  234,  824, 2823,
         24,  233,  237,  232, 8122,  231, 8125,  236,    0]), 'topk_tokens': ['.', ' grabbed', ' ST', '\n', ' apple', '\n', '<|start_header_id|>', '<|start_header_id|>', ' to', ' Daniel', ' bathroom', '\n\n', ' travelled', '.', ' Mary', '<|eot_id|>', '.', '<|end_header_id|>', ' bedroom', '<|begin_of_text|>'], 'evidence_proportions': [385.21875, 143.475, 124.3625, 36.284375]}, 'weight': {'score': [21.932154605263158, 23.241720479704796, 21.986979166666668, 23.248053152039557, 29.115433673469386], 'topk_indices': array([3309, 3282, 3202, 3154, 7376, 7414, 1424, 1486, 4307, 4291, 5163,
       5102, 7091, 7147, 3465, 3491, 4904, 4879, 4927, 4956]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.333984375, 21.01875, 19.665625, 19.990625]}, 'saliency': {'score': [1.02862548828125, 0.09789828855319803, 1.3631475539434523, 0.09242807206765682, 0.12735390176578443], 'topk_indices': array([7981,   54, 3505,  231, 8115,   32,  263, 7612, 8025,   24, 8114,
       8117,  230,  825,  827,  824, 2823,  233,  232,  236]), 'topk_tokens': [' context', '\n\n\n\n', ' bathroom', '.', ' before', '***', 'hue', 'nes', ' location', '\n\n', ' apple', ' garden', ' ST', ' grabbed', ' apple', ' Daniel', ' bathroom', ' travelled', ' Mary', ' bedroom'], 'evidence_proportions': [2.8861083984375, 0.784814453125, 0.613525390625, 0.20155029296875]}}, 'pred_res': 'bedroom<|eot_id|>', 'score': 0}
2025-01-22 17:22:11.752 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:22:11.752 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-44_pid-0_1-3-4-7.pkl | len: 3 |  size: 2.02 KB
Processing depth (1, 3, 4, 7):   1%|          | 1/100 [00:36<59:25, 36.01s/it]is_0k: False
your chose emoji: ['ğŸ§’ğŸ½', 'ğŸ‘ˆğŸ¼', 'ğŸ’†ğŸ½\u200dâ™€', 'â›‘', 'ğŸ¦µ', 'ğŸ«', 'ğŸš›', 'ğŸ‹ï¸', 'ğŸ‘©ğŸ¿\u200dğŸ’¼', 'ğŸ‡¼ğŸ‡«']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.25s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.74s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.84s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.41s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.88s/it]
Processing depth (3, 4, 8, 9):   1%|          | 1/100 [00:53<59:25, 36.01s/it]2025-01-22 17:22:29.215 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel grabbed the apple.
2025-01-22 17:22:29.231 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2884, 2888) -->  Daniel grabbed the apple
2025-01-22 17:22:29.232 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel travelled to the bathroom.
2025-01-22 17:22:29.250 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3606, 3611) --> . Daniel travelled to the
2025-01-22 17:22:29.250 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the garden.
2025-01-22 17:22:29.283 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6494, 6499) --> . Daniel went to the
2025-01-22 17:22:29.283 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John travelled to the kitchen.
2025-01-22 17:22:29.319 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7197, 7202) --> . John travelled to the
2025-01-22 17:22:29.319 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the bedroom.
2025-01-22 17:22:29.320 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (231, 236) --> . Mary travelled to the
2025-01-22 17:22:29.321 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the garden.
2025-01-22 17:22:29.355 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6630, 6636) --> . John went back to the
2025-01-22 17:22:29.355 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the bathroom.
2025-01-22 17:22:29.374 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3607, 3612) -->  Daniel travelled to the bathroom
2025-01-22 17:22:29.374 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the bathroom.
2025-01-22 17:22:29.392 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3548, 3553) --> . Sandra went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:22:30.167 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's hand<|eot_id|>
2025-01-22 17:22:30.167 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8151])
2025-01-22 17:22:32.394 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [106.20065789473684, 15.759128955114054, 112.32291666666667, 15.297429596992853, 13.30977843237705], 'topk_indices': array([8046,    3, 8142,   23, 8061, 7888,    9, 8138, 3553, 8139,    1,
       8049, 8039, 8062,   24,   14, 8149,    0, 8146, 8147]), 'topk_tokens': [' in', '<|end_header_id|>', '?', '4', ' in', ' Square', ':', ' apple', ' bathroom', ' before', '<|start_header_id|>', ' location', '.\n\n', ' the', '\n\n', '\n', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [240.1875, 97.375, 67.7125, 46.325]}, 'weight': {'score': [21.932154605263158, 23.25632741599215, 21.986979166666668, 23.262713365787526, 28.936219262295083], 'topk_indices': array([3311, 3284, 3150, 3198, 7382, 7420, 1479, 1417, 4291, 4275, 5104,
       5165, 7147, 7091, 3493, 3467, 4958, 4875, 4929, 4900]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.333984375, 21.01875, 19.665625, 19.990625]}, 'saliency': {'score': [0.6717689915707237, 0.08692443712920805, 0.6536661783854166, 0.0840881513144719, 0.09947179575435451], 'topk_indices': array([  23, 8135, 8142,  236,    8, 2885, 8141, 8045, 8005, 8048, 8133,
       2887, 2884, 8039,   24, 8139, 7888, 8138, 8049, 3553]), 'topk_tokens': ['4', ' Where', '?', ' bedroom', ' Date', ' grabbed', ' garden', ' item', ' context', ' first', 'Question', ' apple', ' Daniel', '.\n\n', '\n\n', ' before', ' Square', ' apple', ' location', ' bathroom'], 'evidence_proportions': [1.81353759765625, 0.525732421875, 0.3323974609375, 0.24376220703125]}}, 'pred_res': "Daniel's hand<|eot_id|>", 'score': 0}
2025-01-22 17:22:32.410 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:22:32.413 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-44_pid-1_3-4-8-9.pkl | len: 3 |  size: 2.04 KB
Processing depth (3, 4, 8, 9):   2%|â–         | 2/100 [00:56<44:04, 26.98s/it]is_0k: False
your chose emoji: ['ğŸ§‘ğŸ¿\u200dâš–', 'ğŸ‘©ğŸ¾\u200dâš•ï¸', 'ğŸ–²ï¸', 'ğŸ•“', 'ğŸ¦†', 'ğŸ‡²ğŸ‡»', 'â†˜ï¸', 'ğŸ‡¸ğŸ‡²', 'ğŸ’ğŸ¼', 'ğŸ‘¨ğŸ½\u200dâœˆï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.21s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.64s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.58s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.14s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.65s/it]
Processing depth (0, 4, 8, 9):   2%|â–         | 2/100 [01:12<44:04, 26.98s/it]2025-01-22 17:22:48.779 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel grabbed the apple.
2025-01-22 17:22:48.820 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel travelled to the bathroom.
2025-01-22 17:22:48.838 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3607, 3612) -->  Hon. Daniel travelled to
2025-01-22 17:22:48.838 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the garden.
2025-01-22 17:22:48.871 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6605, 6610) -->  Daniel went to the garden
2025-01-22 17:22:48.871 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John travelled to the kitchen.
2025-01-22 17:22:48.907 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7225, 7230) --> . John travelled to the
2025-01-22 17:22:48.907 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the bedroom.
2025-01-22 17:22:48.908 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (236, 241) --> . Mary travelled to the
2025-01-22 17:22:48.908 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the garden.
2025-01-22 17:22:48.941 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6607, 6613) -->  to the garden. Senator John
2025-01-22 17:22:48.941 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the bathroom.
2025-01-22 17:22:48.960 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3609, 3614) -->  Daniel travelled to the bathroom
2025-01-22 17:22:48.960 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the bathroom.
2025-01-22 17:22:48.979 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3580, 3585) --> . Sandra went to the
2025-01-22 17:22:48.979 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 17:22:48.979 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 17:22:48.979 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 17:22:48.979 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ™†ğŸ»\u200dâ™€', 'ğŸ¤·ğŸ½\u200dâ™‚', 'ğŸ¨', 'ğŸ§”ğŸ¼\u200dâ™‚ï¸', 'ğŸš¶ğŸ¿\u200dâ™‚ï¸\u200dâ¡', 'ğŸ§ğŸ½\u200dâ™‚\u200dâ¡ï¸', 'ğŸ¥·ğŸ¼', 'ğŸŒ\u200dâ™€', 'ğŸŒŒ', 'ğŸ‘¨ğŸ¾\u200dğŸš€']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.72s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.18s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.91s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.39s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.97s/it]
Processing depth (0, 1, 7, 8):   2%|â–         | 2/100 [01:30<44:04, 26.98s/it]2025-01-22 17:23:06.548 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel grabbed the apple.
2025-01-22 17:23:06.588 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel travelled to the bathroom.
2025-01-22 17:23:06.592 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (906, 911) --> . Daniel travelled to the
2025-01-22 17:23:06.593 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the garden.
2025-01-22 17:23:06.621 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5630, 5635) --> . Daniel went to the
2025-01-22 17:23:06.621 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John travelled to the kitchen.
2025-01-22 17:23:06.654 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6598, 6603) --> . John travelled to the
2025-01-22 17:23:06.654 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the bedroom.
2025-01-22 17:23:06.655 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (236, 241) --> . Mary travelled to the
2025-01-22 17:23:06.655 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the garden.
2025-01-22 17:23:06.689 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6647, 6653) -->  John went back to the garden
2025-01-22 17:23:06.689 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the bathroom.
2025-01-22 17:23:06.694 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (907, 912) -->  Daniel travelled to the bathroom
2025-01-22 17:23:06.694 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the bathroom.
2025-01-22 17:23:06.712 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3610, 3615) --> . Sandra went to the
2025-01-22 17:23:06.712 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 17:23:06.712 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 17:23:06.712 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 17:23:06.712 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ§œ\u200dâ™€', 'ğŸ§›\u200dâ™€', 'ğŸ’‚ğŸ¿\u200dâ™‚ï¸', 'ğŸ‡¦ğŸ‡¨', 'ğŸ’‡ğŸ½\u200dâ™€ï¸', 'ğŸ‘¨ğŸ½\u200dğŸ³', 'ğŸ§˜ğŸ»\u200dâ™€', 'ğŸ‡³ğŸ‡±', 'ğŸµ', 'ğŸ†']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.12s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.04s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.33s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.11s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.51s/it]
Processing depth (0, 2, 3, 6):   2%|â–         | 2/100 [01:46<44:04, 26.98s/it]2025-01-22 17:23:22.486 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel grabbed the apple.
2025-01-22 17:23:22.530 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel travelled to the bathroom.
2025-01-22 17:23:22.540 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1799, 1804) -->  Daniel travelled to the bathroom
2025-01-22 17:23:22.540 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the garden.
2025-01-22 17:23:22.557 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2912, 2917) --> . Daniel went to the
2025-01-22 17:23:22.557 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John travelled to the kitchen.
2025-01-22 17:23:22.581 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4776, 4781) -->  the senate. John travelled
2025-01-22 17:23:22.581 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the bedroom.
2025-01-22 17:23:22.583 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (236, 241) --> . Mary travelled to the
2025-01-22 17:23:22.583 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the garden.
2025-01-22 17:23:22.631 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6676, 6682) --> . John went back to the
2025-01-22 17:23:22.631 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the bathroom.
2025-01-22 17:23:22.642 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1800, 1805) -->  travelled to the bathroom.
2025-01-22 17:23:22.642 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the bathroom.
2025-01-22 17:23:22.664 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3579, 3584) -->  Sandra went to the bathroom
2025-01-22 17:23:22.664 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 17:23:22.665 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 17:23:22.665 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 17:23:22.665 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ‡²ğŸ‡¬', 'ğŸ§\u200dâ™€', 'â™¥ï¸', 'ğŸ‘©ğŸ½\u200dâ¤\u200dğŸ‘©ğŸ¾', 'ğŸ‘¨ğŸ»\u200dâ¤\u200dğŸ’‹\u200dğŸ‘¨ğŸ»', 'ğŸ‡²ğŸ‡¹', 'ğŸ‘¨ğŸ¾\u200dğŸ¦¼', 'ğŸ‘©ğŸ½\u200dğŸ¤\u200dğŸ‘¨ğŸ¼', 'âš¡', 'ğŸ§›ğŸ½\u200dâ™‚ï¸']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.86s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.93s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.58s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.15s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.74s/it]
Processing depth (3, 4, 7, 9):   2%|â–         | 2/100 [02:04<44:04, 26.98s/it]2025-01-22 17:23:39.845 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel grabbed the apple.
2025-01-22 17:23:39.861 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2878, 2882) -->  Daniel grabbed the apple
2025-01-22 17:23:39.861 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel travelled to the bathroom.
2025-01-22 17:23:39.880 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3529, 3534) -->  Daniel travelled to the bathroom
2025-01-22 17:23:39.880 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the garden.
2025-01-22 17:23:39.908 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5556, 5561) --> . Daniel went to the
2025-01-22 17:23:39.908 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John travelled to the kitchen.
2025-01-22 17:23:39.947 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7104, 7109) -->  John travelled to the kitchen
2025-01-22 17:23:39.947 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the bedroom.
2025-01-22 17:23:39.948 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (231, 236) --> . Mary travelled to the
2025-01-22 17:23:39.948 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the garden.
2025-01-22 17:23:39.982 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6636, 6642) --> . John went back to the
2025-01-22 17:23:39.982 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the bathroom.
2025-01-22 17:23:39.999 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3530, 3535) -->  travelled to the bathroom.
2025-01-22 17:23:39.999 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the bathroom.
2025-01-22 17:23:40.016 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3502, 3507) --> . Sandra went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:23:40.818 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's hand.<|eot_id|>
2025-01-22 17:23:40.818 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8147])
2025-01-22 17:23:43.036 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [126.9967105263158, 15.465515720858896, 108.55505952380952, 14.963176248458693, 12.674854343220339], 'topk_indices': array([8133, 8035, 8130, 3507,    9, 8132,   23,    3, 8138,    1, 7898,
       2882, 8135,   14,   24, 8134, 8145,    0, 8142, 8143]), 'topk_tokens': [' the', '.\n\n', ':', ' bathroom', ':', ' was', '4', '<|end_header_id|>', '?', '<|start_header_id|>', ' Square', '.', ' before', '\n', '\n\n', ' apple', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [264.9375, 133.35, 79.975, 57.3125]}, 'weight': {'score': [24.68955592105263, 23.251092791411043, 20.822916666666668, 23.254010288224414, 28.767213983050848], 'topk_indices': array([3311, 3284, 3204, 3156, 7438, 7400, 1483, 1421, 4343, 4327, 5199,
       5138, 7171, 7115, 3493, 3467, 4940, 4992, 4963, 4915]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.333984375, 26.7078125, 19.665625, 24.7796875]}, 'saliency': {'score': [0.856066252055921, 0.08460521112921779, 0.6162429082961309, 0.08142122205176865, 0.0938608201883607], 'topk_indices': array([   8,   20,   23, 8132, 7897, 2879, 8138, 8045, 8137,  236, 8001,
       8131, 2878, 2881, 8129,   24, 3507, 8135, 7898, 8134]), 'topk_tokens': [' Date', ' Jul', '4', ' was', 'Bridge', ' grabbed', '?', ' location', ' garden', ' bedroom', ' context', ' Where', ' Daniel', ' apple', 'Question', '\n\n', ' bathroom', ' before', ' Square', ' apple'], 'evidence_proportions': [1.9656982421875, 0.910205078125, 0.4226318359375, 0.34765625]}}, 'pred_res': "Daniel's hand.<|eot_id|>", 'score': 0}
2025-01-22 17:23:43.047 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:23:43.048 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-44_pid-2_3-4-7-9.pkl | len: 3 |  size: 2.03 KB
Processing depth (3, 4, 7, 9):   3%|â–         | 3/100 [02:07<1:15:50, 46.91s/it]is_0k: False
your chose emoji: ['ğŸ‘‰ğŸ¼', 'ğŸ™†ğŸ»\u200dâ™‚ï¸', 'ğŸ—£', 'ğŸª£', 'ğŸ‡¸ğŸ‡¯', 'ğŸ‘¨ğŸ»\u200dğŸ¦¼', 'ğŸ‘¨ğŸ¿\u200dğŸ¤', 'ğŸ§˜\u200dâ™€', 'ğŸ“—', 'ğŸ“›']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.29s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:10,  5.08s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.99s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.39s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.94s/it]
Processing depth (1, 4, 6, 8):   3%|â–         | 3/100 [02:25<1:15:50, 46.91s/it]2025-01-22 17:24:01.048 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel grabbed the apple.
2025-01-22 17:24:01.052 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (822, 826) -->  Daniel grabbed the apple
2025-01-22 17:24:01.052 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel travelled to the bathroom.
2025-01-22 17:24:01.071 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3624, 3629) --> . Daniel travelled to the
2025-01-22 17:24:01.071 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the garden.
2025-01-22 17:24:01.097 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4626, 4631) --> . Daniel went to the
2025-01-22 17:24:01.097 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John travelled to the kitchen.
2025-01-22 17:24:01.133 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6504, 6509) --> . John travelled to the
2025-01-22 17:24:01.133 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the bedroom.
2025-01-22 17:24:01.134 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (231, 236) --> . Mary travelled to the
2025-01-22 17:24:01.134 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the garden.
2025-01-22 17:24:01.168 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6640, 6646) --> . John went back to the
2025-01-22 17:24:01.168 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the bathroom.
2025-01-22 17:24:01.186 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3625, 3630) -->  Daniel travelled to the bathroom
2025-01-22 17:24:01.186 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the bathroom.
2025-01-22 17:24:01.204 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3593, 3598) -->  Hon. Sandra went to
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:24:02.030 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's bedroom.<|eot_id|>
2025-01-22 17:24:02.030 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8177])
2025-01-22 17:24:04.245 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [74.63322368421052, 12.187977536674817, 107.13988095238095, 11.797258906633907, 6.0830671980574325], 'topk_indices': array([   4,  235,   22,   20,  436,  237,   28, 3599,    9, 7487, 7531,
       7532,   14,   23,   24,    1, 8172,  236, 8175,    0]), 'topk_tokens': ['\n\n', ' the', '202', ' Jul', 's', '.', '<|end_header_id|>', ' bathroom', ':', 'nes', ' Min', 'nes', '\n', '4', '\n\n', '<|start_header_id|>', '<|eot_id|>', ' bedroom', '<|end_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [165.15625, 66.30625, 57.5625, 27.6125]}, 'weight': {'score': [21.932154605263158, 23.27775443154034, 23.131696428571427, 23.28127207463145, 29.122677364864863], 'topk_indices': array([3283, 3256, 3128, 3176, 7424, 7386, 1416, 1478, 4301, 4317, 5191,
       5130, 7101, 7157, 3439, 3465, 4955, 4984, 4907, 4932]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.333984375, 21.01875, 19.665625, 19.990625]}, 'saliency': {'score': [0.4683998509457237, 0.06846768628705685, 0.6238955543154762, 0.06610126167316109, 0.04450081490181588], 'topk_indices': array([8164,  823,   16,    8, 8075,  574,   19,  232,   32,   22,  822,
         20,  233,   23,   24, 7487, 7531, 3599, 7532,  236]), 'topk_tokens': [' apple', ' grabbed', ' Date', ' Date', ' location', ' em', '26', ' Mary', '***', '202', ' Daniel', ' Jul', ' travelled', '4', '\n\n', 'nes', ' Min', ' bathroom', 'nes', ' bedroom'], 'evidence_proportions': [1.2308349609375, 0.3596923828125, 0.2885986328125, 0.14696044921875]}}, 'pred_res': "Daniel's bedroom.<|eot_id|>", 'score': 0}
2025-01-22 17:24:04.257 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:24:04.257 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-44_pid-3_1-4-6-8.pkl | len: 3 |  size: 1.99 KB
Processing depth (1, 4, 6, 8):   4%|â–         | 4/100 [02:28<58:49, 36.77s/it]  is_0k: False
your chose emoji: ['ğŸ›¥', 'ğŸ§ğŸ¼\u200dâ™€', 'ğŸ‡ºğŸ‡³', 'ğŸ™ğŸ¿', 'ğŸ‘ƒğŸ¾', 'ğŸ‘©ğŸ»\u200dğŸ¨', 'ğŸ‘©\u200dğŸ³', 'ğŸ‘©ğŸ¿\u200dâ¤\u200dğŸ‘©ğŸ½', 'ğŸ¥±', 'ğŸ‘¨ğŸ»\u200dğŸ«']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.21s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.63s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.71s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.25s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.74s/it]
Processing depth (3, 6, 7, 9):   4%|â–         | 4/100 [02:45<58:49, 36.77s/it]2025-01-22 17:24:20.928 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel grabbed the apple.
2025-01-22 17:24:20.943 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2862, 2866) -->  Daniel grabbed the apple
2025-01-22 17:24:20.943 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel travelled to the bathroom.
2025-01-22 17:24:20.966 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4591, 4596) -->  Daniel travelled to the bathroom
2025-01-22 17:24:20.966 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the garden.
2025-01-22 17:24:20.997 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5552, 5557) --> . Daniel went to the
2025-01-22 17:24:20.997 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John travelled to the kitchen.
2025-01-22 17:24:21.034 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7098, 7103) -->  John travelled to the kitchen
2025-01-22 17:24:21.034 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the bedroom.
2025-01-22 17:24:21.035 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (189, 194) --> . Mary travelled to the
2025-01-22 17:24:21.035 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the garden.
2025-01-22 17:24:21.071 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6610, 6616) --> . John went back to the
2025-01-22 17:24:21.074 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the bathroom.
2025-01-22 17:24:21.098 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4592, 4597) -->  travelled to the bathroom.
2025-01-22 17:24:21.099 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the bathroom.
2025-01-22 17:24:21.116 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3516, 3521) --> . Sandra went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:24:21.949 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's hand.<|eot_id|>
2025-01-22 17:24:21.949 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8147])
2025-01-22 17:24:24.162 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [225.4440789473684, 21.286088957055213, 177.97321428571428, 20.402065351418003, 16.894001588983052], 'topk_indices': array([3521, 4595, 8045, 8138,    1, 8035, 7539, 2866, 7347, 7495, 8001,
         24, 7540, 8134, 8135,   14, 8145,    0, 8142, 8143]), 'topk_tokens': [' bathroom', ' bathroom', ' location', '?', '<|start_header_id|>', '.\n\n', ' Min', '.', 'nes', 'nes', ' context', '\n\n', 'nes', ' apple', ' before', '\n', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [341.40625, 292.3, 119.3125, 171.95]}, 'weight': {'score': [24.68955592105263, 23.26386119631902, 20.822916666666668, 23.26684166923551, 29.649099576271187], 'topk_indices': array([3325, 3298, 3200, 3152, 7394, 7432, 1419, 1481, 4321, 4305, 5195,
       5134, 7109, 7165, 3507, 3481, 4911, 4936, 4959, 4988]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.333984375, 26.7078125, 19.665625, 24.7796875]}, 'saliency': {'score': [1.4922388980263157, 0.11754482901169479, 1.029267810639881, 0.11196340238709926, 0.12898849228681145], 'topk_indices': array([8131, 7892,   24, 2863, 2862, 8137, 8129,  194, 2865, 8045,  565,
       7347, 7539, 7495, 8135, 8001, 7540, 3521, 4595, 8134]), 'topk_tokens': [' Where', ' Square', '\n\n', ' grabbed', ' Daniel', ' garden', 'Question', ' bedroom', ' apple', ' location', ' instead', 'nes', ' Min', 'nes', ' before', ' context', 'nes', ' bathroom', ' bathroom', ' apple'], 'evidence_proportions': [2.533447265625, 2.0390625, 0.662109375, 0.942578125]}}, 'pred_res': "Daniel's hand.<|eot_id|>", 'score': 0}
2025-01-22 17:24:24.173 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:24:24.173 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-44_pid-4_3-6-7-9.pkl | len: 3 |  size: 2.04 KB
Processing depth (3, 6, 7, 9):   5%|â–Œ         | 5/100 [02:48<48:35, 30.69s/it]Processing depth (3, 6, 7, 9):   5%|â–Œ         | 5/100 [02:48<53:21, 33.70s/it]
2025-01-22 17:24:24.241 | INFO     | __main__:<module>:82 - Selected idx: 46
2025-01-22 17:24:24.241 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the apple before the office? 
2025-01-22 17:24:24.241 | INFO     | __main__:<module>:84 - Answer: kitchen
2025-01-22 17:24:24.241 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 17:24:24.241 | INFO     | __main__:<module>:86 - Needle: [' John went back to the garden.', ' Daniel picked up the apple.', ' Daniel moved to the kitchen.', ' John travelled to the bathroom.', ' Mary travelled to the bedroom.', ' Daniel moved to the office.', ' Sandra went to the bathroom.']
2025-01-22 17:24:24.241 | INFO     | __main__:<module>:87 - Real Needle: [' Daniel picked up the apple.', ' Daniel moved to the kitchen.', ' Daniel moved to the office.', ' Sandra went to the bathroom.']
2025-01-22 17:24:24.241 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ™ğŸ½\u200dâ™‚', 'ğŸ§ğŸ¼\u200dâ™€\u200dâ¡ï¸', 'ğŸ‡®ğŸ‡©', 'ğŸ“½ï¸', 'ğŸŠ\u200dâ™€', 'ğŸ‘³ğŸ½\u200dâ™‚', 'ğŸ§¦', 'â˜£', 'ğŸ¦', 'ğŸ§—ğŸ¿']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.66s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.81s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:15<00:05,  5.14s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  3.55s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  4.05s/it]
Processing depth (0, 3, 4, 5):   0%|          | 0/100 [00:17<?, ?it/s]2025-01-22 17:24:42.310 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the apple.
2025-01-22 17:24:42.310 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the apple.
2025-01-22 17:24:42.310 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the kitchen.
2025-01-22 17:24:42.325 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2945, 2950) --> . Daniel moved to the
2025-01-22 17:24:42.325 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 17:24:42.340 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2945, 2950) --> . Daniel moved to the
2025-01-22 17:24:42.340 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the bathroom.
2025-01-22 17:24:42.362 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4212, 4217) -->  Sandra went to the bathroom
2025-01-22 17:24:42.362 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the garden.
2025-01-22 17:24:42.396 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6675, 6681) --> . John went back to the
2025-01-22 17:24:42.396 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the bathroom.
2025-01-22 17:24:42.409 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2677, 2682) --> . John travelled to the
2025-01-22 17:24:42.409 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary travelled to the bedroom.
2025-01-22 17:24:42.443 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6680, 6685) -->  the garden. Mary travelled
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:24:43.298 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's hand.<|eot_id|>
2025-01-22 17:24:43.298 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8206])
2025-01-22 17:24:45.529 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [446.0578125, 32.44073958460226, 158.0234375, 31.182735837513764, 17.421681833791208], 'topk_indices': array([  14, 8196,   31, 8104, 2682,    1,   66, 8204,   35,   24,   69,
       8194, 8201, 8060,   28, 8202,   67,  105,   68,    0]), 'topk_tokens': ['\n', ' office', ' picked', ' location', ' bathroom', '<|start_header_id|>', ' P', '<|end_header_id|>', '.', '\n\n', 'ER', ' before', '<|eot_id|>', ' context', '<|end_header_id|>', '<|start_header_id|>', 'ION', 'ION', 'E', '<|begin_of_text|>'], 'evidence_proportions': [655.45, 529.25, 529.25, 70.28125]}, 'weight': {'score': [22.096484375, 23.312298239736876, 21.4091796875, 23.318999105285698, 29.63907967032967], 'topk_indices': array([3285, 3312, 3205, 3157, 7469, 7431, 1467, 1405, 4304, 4288, 5129,
       5190, 7152, 7208, 3494, 3468, 4931, 4983, 4954, 4906]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.08125, 19.909375, 19.909375, 26.4859375]}, 'saliency': {'score': [2.404345703125, 0.18150152819123827, 0.8512420654296875, 0.17475091861158693, 0.12685486510559751], 'topk_indices': array([  24,   30,   66, 8199, 2950, 8188, 8100,   69, 8193,   38, 8196,
       8104, 2946, 8194,   31, 2682,   68, 8060,   67,  105]), 'topk_tokens': ['\n\n', 'Daniel', ' P', 'Answer', ' kitchen', 'Question', ' item', 'ER', ' apple', '***', ' office', ' location', ' Daniel', ' before', ' picked', ' bathroom', 'E', ' context', 'ION', 'ION'], 'evidence_proportions': [3.549609375, 2.7783203125, 2.7783203125, 0.5111328125]}}, 'pred_res': "Daniel's hand.<|eot_id|>", 'score': 0}
2025-01-22 17:24:45.536 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:24:45.536 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-46_pid-0_0-3-4-5.pkl | len: 3 |  size: 2.03 KB
Processing depth (0, 3, 4, 5):   1%|          | 1/100 [00:21<34:58, 21.20s/it]is_0k: False
your chose emoji: ['ğŸ‘©ğŸ¼\u200dâ¤\u200dğŸ‘©ğŸ½', 'ğŸ§›ğŸ¾\u200dâ™€ï¸', 'ğŸ‡­ğŸ‡¹', 'ğŸŒ\u200dâ™‚', 'ğŸš¶ğŸ¾\u200dâ™€\u200dâ¡ï¸', 'ğŸ‘©ğŸ»\u200dâ¤\u200dğŸ‘¨ğŸ¼', 'ğŸŸ ', 'ğŸƒ\u200dâ™€', '\U0001fab8', 'ğŸ‘©ğŸ»\u200dğŸ¤\u200dğŸ‘©ğŸ¼']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.54s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.65s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.50s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  2.92s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.52s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (1, 3, 4, 7):   1%|          | 1/100 [00:37<34:58, 21.20s/it]2025-01-22 17:25:01.529 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the apple.
2025-01-22 17:25:01.534 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (895, 900) --> . Daniel picked up the
2025-01-22 17:25:01.534 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the kitchen.
2025-01-22 17:25:01.550 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2849, 2854) --> . Daniel moved to the
2025-01-22 17:25:01.550 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 17:25:01.565 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2849, 2854) --> . Daniel moved to the
2025-01-22 17:25:01.565 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the bathroom.
2025-01-22 17:25:01.596 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5485, 5490) --> . Sandra went to the
2025-01-22 17:25:01.596 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the garden.
2025-01-22 17:25:01.642 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6655, 6661) --> . John went back to the
2025-01-22 17:25:01.642 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the bathroom.
2025-01-22 17:25:01.656 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2531, 2536) --> . John travelled to the
2025-01-22 17:25:01.656 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary travelled to the bedroom.
2025-01-22 17:25:01.692 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6660, 6665) -->  the garden. Mary travelled
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:25:05.109 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's hand.<|eot_id|>
2025-01-22 17:25:05.109 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8180])
2025-01-22 17:25:07.875 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [267.79609375, 26.05786959244776, 107.1513671875, 25.30516792991285, 19.470953525641026], 'topk_indices': array([8074, 8163, 2615, 8068,  895, 8077, 8161, 8174, 2689, 8178,  896,
       8171,  901, 8176, 8168, 8170,  900, 8078, 8175,    0]), 'topk_tokens': [' item', ':', ' shore', '.\n\n', '.', ' first', '.\n\n', ':', ' the', '<|end_header_id|>', ' Daniel', '?', '.', '<|start_header_id|>', ' before', ' office', ' apple', ' location', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [613.25, 210.925, 210.925, 36.084375]}, 'weight': {'score': [20.74453125, 23.28623747403153, 21.4091796875, 23.29616346507917, 29.337339743589745], 'topk_indices': array([3319, 3346, 3239, 3191, 7471, 7433, 1411, 1473, 4378, 4394, 5189,
       5250, 7154, 7210, 3502, 3528, 4991, 4966, 5043, 5014]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.3625, 19.909375, 19.909375, 20.796875]}, 'saliency': {'score': [1.4716339111328125, 0.14549267118664458, 0.6179161071777344, 0.14130933992669847, 0.14193187615810296], 'topk_indices': array([8161, 8164, 8072, 8167, 2688, 2536, 8034, 8173,  897, 8074, 8171,
        257, 8077, 8162, 2615, 8168,  896, 8170, 8078,  900]), 'topk_tokens': ['.\n\n', ' Where', ' obtained', ' apple', 'ared', ' bathroom', ' context', 'Answer', ' picked', ' item', '?', 'hue', ' first', 'Question', ' shore', ' before', ' Daniel', ' office', ' location', ' apple'], 'evidence_proportions': [3.5494140625, 1.067041015625, 1.067041015625, 0.20303955078125]}}, 'pred_res': "Daniel's hand.<|eot_id|>", 'score': 0}
2025-01-22 17:25:07.883 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:25:07.883 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-46_pid-1_1-3-4-7.pkl | len: 3 |  size: 2.01 KB
Processing depth (1, 3, 4, 7):   2%|â–         | 2/100 [00:43<35:43, 21.87s/it]is_0k: False
your chose emoji: ['\U0001faf1ğŸ¼\u200d\U0001faf2ğŸ»', 'ğŸ–•ğŸ¼', 'ğŸ§‘ğŸ»\u200dğŸ¤', 'ğŸš¶\u200dâ™‚\u200dâ¡ï¸', 'ğŸ‘±ğŸ½\u200dâ™‚ï¸', 'ğŸ‡³ğŸ‡ª', 'ğŸ‘·ğŸ½\u200dâ™€', 'â›“', 'ğŸ™…ğŸ½\u200dâ™‚', 'ğŸ¿']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.26s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.60s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.66s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.24s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.72s/it]
Processing depth (0, 1, 3, 4):   2%|â–         | 2/100 [01:00<35:43, 21.87s/it]2025-01-22 17:25:25.015 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the apple.
2025-01-22 17:25:25.016 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the apple.
2025-01-22 17:25:25.016 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the kitchen.
2025-01-22 17:25:25.022 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (901, 906) --> . Daniel moved to the
2025-01-22 17:25:25.022 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 17:25:25.027 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (901, 906) --> . Daniel moved to the
2025-01-22 17:25:25.028 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the bathroom.
2025-01-22 17:25:25.048 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3605, 3610) --> . Sandra went to the
2025-01-22 17:25:25.048 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the garden.
2025-01-22 17:25:25.081 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6649, 6655) --> . John went back to the
2025-01-22 17:25:25.081 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the bathroom.
2025-01-22 17:25:25.095 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2547, 2552) --> . John travelled to the
2025-01-22 17:25:25.095 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary travelled to the bedroom.
2025-01-22 17:25:25.132 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6654, 6659) -->  the garden. Mary travelled
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:25:25.941 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 17:25:25.941 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8164])
2025-01-22 17:25:28.140 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [125.9810546875, 9.09361703348843, 15.958251953125, 8.7925983504489, 4.665339006696429], 'topk_indices': array([   1,  905, 8154,   34,   24, 1485,  105,   67, 8162,   28,   68,
         14, 1486, 1515, 8160,  906, 1517, 8159,    0, 1518]), 'topk_tokens': ['<|start_header_id|>', ' the', ' office', ' apple', '\n\n', 'nes', 'ION', 'ION', '<|end_header_id|>', '<|end_header_id|>', 'E', '\n', 'ot', '\n', '<|start_header_id|>', ' kitchen', 'nes', '<|eot_id|>', '<|begin_of_text|>', 'ot'], 'evidence_proportions': [184.675, 156.5, 156.5, 6.24921875]}, 'weight': {'score': [20.67421875, 23.272541171788905, 21.4091796875, 23.282599003812567, 29.21785714285714], 'topk_indices': array([3289, 3316, 3203, 3155, 7449, 7411, 1431, 1493, 4328, 4344, 5212,
       5151, 7132, 7188, 3498, 3472, 5005, 4976, 4928, 4953]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.08125, 19.909375, 19.909375, 20.796875]}, 'saliency': {'score': [0.6356266021728516, 0.050199342150575484, 0.08730697631835938, 0.04868633423677275, 0.034707886832101006], 'topk_indices': array([  38, 8151,  903,   24,   20, 1515, 8018,   31, 1516, 8152, 8154,
         68,  105,   67,   34, 1485, 1486, 1517,  906, 1518]), 'topk_tokens': ['***', ' apple', ' moved', '\n\n', ' Jul', '\n', ' context', ' picked', 'Min', ' before', ' office', 'E', 'ION', 'ION', ' apple', 'nes', 'ot', 'nes', ' kitchen', 'ot'], 'evidence_proportions': [1.06591796875, 0.7207763671875, 0.7207763671875, 0.03503570556640625]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 100}
2025-01-22 17:25:28.148 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:25:28.148 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-46_pid-2_0-1-3-4.pkl | len: 3 |  size: 1.99 KB
Processing depth (0, 1, 3, 4):   3%|â–         | 3/100 [01:03<34:10, 21.14s/it]is_0k: False
your chose emoji: ['ğŸŒ«', 'âš±ï¸', 'ğŸ§œğŸ¼\u200dâ™‚ï¸', 'ğŸ¦¹ğŸ¾\u200dâ™‚ï¸', 'ğŸ”±', 'ğŸ‘©ğŸ¼\u200dğŸ¤\u200dğŸ‘©ğŸ¾', 'ğŸ‡µğŸ‡¾', 'ğŸ‘·ğŸ¿\u200dâ™€', '\U0001faae', 'ğŸ‡¨ğŸ‡µ']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.37s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.40s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.35s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.00s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.50s/it]
Processing depth (0, 3, 6, 9):   3%|â–         | 3/100 [01:19<34:10, 21.14s/it]2025-01-22 17:25:44.334 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the apple.
2025-01-22 17:25:44.334 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the apple.
2025-01-22 17:25:44.334 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the kitchen.
2025-01-22 17:25:44.350 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2925, 2930) --> . Daniel moved to the
2025-01-22 17:25:44.351 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 17:25:44.365 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2925, 2930) --> . Daniel moved to the
2025-01-22 17:25:44.365 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the bathroom.
2025-01-22 17:25:44.404 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7141, 7146) -->  Sandra went to the bathroom
2025-01-22 17:25:44.405 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the garden.
2025-01-22 17:25:44.438 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6648, 6654) -->  John went back to the garden
2025-01-22 17:25:44.438 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the bathroom.
2025-01-22 17:25:44.451 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2537, 2542) --> . John travelled to the
2025-01-22 17:25:44.451 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary travelled to the bedroom.
2025-01-22 17:25:44.484 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6652, 6657) -->  the garden. Mary travelled
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:25:45.726 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's location is not specified before the office, but Daniel picked up the apple.<|eot_id|>
2025-01-22 17:25:45.726 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8178])
2025-01-22 17:25:47.940 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [468.078125, 35.93507059039237, 154.380859375, 34.641271485573974, 17.953581574675326], 'topk_indices': array([ 439,  463,  462,   24, 8168,   28,  557, 8032, 8166,   35,  549,
       8173,  440, 8174,  556,  551,  434,  435,  558,    0]), 'topk_tokens': [' em', ' per', 's', '\n\n', ' office', '<|end_header_id|>', 's', ' context', ' before', '.', ',', '<|eot_id|>', 's', '<|start_header_id|>', ' em', ' to', ' to', ' ', ' per', '<|begin_of_text|>'], 'evidence_proportions': [682.6, 574.5, 574.5, 40.7125]}, 'weight': {'score': [22.096484375, 23.287953795379536, 22.81982421875, 23.29179903314917, 29.49614448051948], 'topk_indices': array([3283, 3310, 3185, 3137, 7469, 7431, 1489, 1427, 4286, 4302, 5170,
       5109, 7208, 7152, 3472, 3498, 4934, 4963, 4886, 4911]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.08125, 19.909375, 19.909375, 26.4859375]}, 'saliency': {'score': [2.4371307373046873, 0.20031572655963514, 0.9136199951171875, 0.19342202876812845, 0.12838864016842533], 'topk_indices': array([2930,  557, 2927, 2926, 8076, 8160, 8165,  461,  441,  551,   31,
        439,  463,  434,  440, 8168, 8166, 8032,  556,  558]), 'topk_tokens': [' kitchen', 's', ' moved', ' Daniel', ' location', 'Question', ' apple', ' em', ' per', ' to', ' picked', ' em', ' per', ' to', 's', ' office', ' before', ' context', ' em', ' per'], 'evidence_proportions': [3.6298828125, 2.91328125, 2.91328125, 0.29207763671875]}}, 'pred_res': "Daniel's location is not specified before the office, but Daniel picked up the apple.<|eot_id|>", 'score': 0}
2025-01-22 17:25:47.945 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:25:47.945 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-46_pid-3_0-3-6-9.pkl | len: 3 |  size: 2.04 KB
Processing depth (0, 3, 6, 9):   4%|â–         | 4/100 [01:23<32:58, 20.61s/it]is_0k: False
your chose emoji: ['ğŸ‘©ğŸ¼\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘©ğŸ¿', 'ğŸ§‘ğŸ»\u200dâœˆï¸', 'ğŸ§·', 'ğŸ”¦', 'ğŸ‡¼ğŸ‡¸', 'ğŸ‘©ğŸ¾\u200dâš•', 'ğŸ§ğŸ¼', 'ğŸ’‚ğŸ½\u200dâ™‚ï¸', 'ğŸ‘°ğŸ¾\u200dâ™‚', 'â¤´']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.58s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.92s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.56s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.22s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.76s/it]
Processing depth (3, 4, 5, 9):   4%|â–         | 4/100 [01:40<32:58, 20.61s/it]2025-01-22 17:26:05.030 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the apple.
2025-01-22 17:26:05.046 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2966, 2971) -->  tragedy. Daniel picked up
2025-01-22 17:26:05.046 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the kitchen.
2025-01-22 17:26:05.067 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3649, 3654) --> . Daniel moved to the
2025-01-22 17:26:05.067 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 17:26:05.088 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3649, 3654) --> . Daniel moved to the
2025-01-22 17:26:05.088 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the bathroom.
2025-01-22 17:26:05.126 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7181, 7186) -->  Sandra went to the bathroom
2025-01-22 17:26:05.126 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the garden.
2025-01-22 17:26:05.163 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6713, 6719) --> . John went back to the
2025-01-22 17:26:05.163 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the bathroom.
2025-01-22 17:26:05.177 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2671, 2676) --> . John travelled to the
2025-01-22 17:26:05.177 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary travelled to the bedroom.
2025-01-22 17:26:05.213 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6718, 6723) -->  the garden. Mary travelled
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:26:05.995 | INFO     | test_jbb_embedding:begin_test:693 - the kitchen<|eot_id|>
2025-01-22 17:26:05.995 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8232])
2025-01-22 17:26:08.232 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [194.140625, 11.589540642076503, 66.6259765625, 11.036838524515185, 10.23199932391827], 'topk_indices': array([  23,   28, 8213,    1, 8225, 8120, 8130, 8223, 8220,   24, 8222,
       8226, 3652, 8231,   14, 3651, 3654, 8230,    0, 8227]), 'topk_tokens': ['4', '<|end_header_id|>', '.\n\n', '<|start_header_id|>', 'Answer', '.\n\n', ' location', '?', ' before', '\n\n', ' office', ':', ' to', '\n\n', '\n', ' moved', ' kitchen', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [122.13125, 320.55, 320.55, 13.33125]}, 'weight': {'score': [23.61875, 23.33317015786278, 21.4091796875, 23.336228122331992, 29.682692307692307], 'topk_indices': array([3314, 3287, 3169, 3121, 7509, 7471, 1473, 1411, 4354, 4370, 5215,
       5276, 7192, 7248, 3470, 3496, 5051, 4999, 4974, 5022]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.1703125, 19.909375, 19.909375, 26.4859375]}, 'saliency': {'score': [1.045893096923828, 0.06400872828675243, 0.36626434326171875, 0.061023757288784265, 0.07547088769766], 'topk_indices': array([8213, 8224,   20, 8120,   24, 8229, 8216, 2972, 8223, 8231, 8219,
       8086, 8214, 2676, 8220, 8130, 8225, 8222, 3651, 3654]), 'topk_tokens': ['.\n\n', ' \n', ' Jul', '.\n\n', '\n\n', 'assistant', ' Where', ' apple', '?', '\n\n', ' apple', ' context', 'Question', ' bathroom', ' before', ' location', 'Answer', ' office', ' moved', ' kitchen'], 'evidence_proportions': [0.810546875, 1.637255859375, 1.637255859375, 0.0985137939453125]}}, 'pred_res': 'the kitchen<|eot_id|>', 'score': 100}
2025-01-22 17:26:08.241 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:26:08.242 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-46_pid-4_3-4-5-9.pkl | len: 3 |  size: 2.01 KB
Processing depth (3, 4, 5, 9):   5%|â–Œ         | 5/100 [01:43<32:27, 20.50s/it]Processing depth (3, 4, 5, 9):   5%|â–Œ         | 5/100 [01:43<32:55, 20.79s/it]
2025-01-22 17:26:08.291 | INFO     | __main__:<module>:82 - Selected idx: 48
2025-01-22 17:26:08.291 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the apple before the office? 
2025-01-22 17:26:08.291 | INFO     | __main__:<module>:84 - Answer: kitchen
2025-01-22 17:26:08.291 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 17:26:08.291 | INFO     | __main__:<module>:86 - Needle: [' Mary travelled to the bedroom.', ' Daniel got the apple.', ' John travelled to the bathroom.', ' John went back to the garden.', ' Daniel moved to the kitchen.', ' Daniel moved to the office.', ' Sandra went to the bathroom.']
2025-01-22 17:26:08.291 | INFO     | __main__:<module>:87 - Real Needle: [' Daniel got the apple.', ' Daniel moved to the kitchen.', ' Daniel moved to the office.', ' Sandra went to the bathroom.']
2025-01-22 17:26:08.291 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ‘¨ğŸ½\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘¨ğŸ»', 'ğŸŒ', 'ğŸ¤ğŸ½', 'ğŸ‘©ğŸ¿\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘¨ğŸ½', 'ğŸ‘©ğŸ¿\u200dâ¤ï¸\u200dğŸ‘¨ğŸ¼', 'ğŸ¤µğŸ»\u200dâ™‚', 'ğŸ™€', 'ğŸ‘¨ğŸ½\u200dâ¤ï¸\u200dğŸ‘¨ğŸ¼', 'ğŸ“¤', 'ğŸ‘¨ğŸ¼\u200dğŸ¨']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.73s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.07s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.30s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.77s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.46s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 2, 5, 6):   0%|          | 0/100 [00:15<?, ?it/s]2025-01-22 17:26:24.360 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the apple.
2025-01-22 17:26:24.400 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the kitchen.
2025-01-22 17:26:24.409 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1802, 1807) -->  Daniel moved to the kitchen
2025-01-22 17:26:24.409 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 17:26:24.418 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1803, 1808) -->  moved to the kitchen.
2025-01-22 17:26:24.418 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the bathroom.
2025-01-22 17:26:24.441 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4647, 4652) --> . Sandra went to the
2025-01-22 17:26:24.441 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the bedroom.
2025-01-22 17:26:24.475 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6949, 6954) --> . Mary travelled to the
2025-01-22 17:26:24.475 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the bathroom.
2025-01-22 17:26:24.506 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5619, 5624) --> . John travelled to the
2025-01-22 17:26:24.506 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the garden.
2025-01-22 17:26:24.510 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (638, 644) --> . John went back to the
2025-01-22 17:26:24.510 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 17:26:24.510 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 17:26:24.510 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 17:26:24.510 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ‘¨ğŸ½\u200dğŸ¤\u200dğŸ‘¨ğŸ¼', 'ğŸš´ğŸ¼\u200dâ™€ï¸', 'ğŸ‘¨ğŸ½\u200dğŸ«', 'ğŸŒ€', 'â˜¹ï¸', 'ğŸ€', 'ğŸ™…ğŸ½\u200dâ™€', 'ğŸš¶\u200dâ™€\u200dâ¡ï¸', 'â¬…ï¸', 'ğŸ¥º']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.58s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.67s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.70s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.24s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.76s/it]
Processing depth (0, 1, 3, 8):   0%|          | 0/100 [00:32<?, ?it/s]2025-01-22 17:26:41.303 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the apple.
2025-01-22 17:26:41.345 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the kitchen.
2025-01-22 17:26:41.350 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (907, 912) --> . Daniel moved to the
2025-01-22 17:26:41.350 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 17:26:41.355 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (907, 912) --> . Daniel moved to the
2025-01-22 17:26:41.355 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the bathroom.
2025-01-22 17:26:41.393 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6609, 6614) --> . Sandra went to the
2025-01-22 17:26:41.394 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the bedroom.
2025-01-22 17:26:41.429 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (7029, 7034) --> . Mary travelled to the
2025-01-22 17:26:41.429 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the bathroom.
2025-01-22 17:26:41.463 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5629, 5634) --> . John travelled to the
2025-01-22 17:26:41.463 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the garden.
2025-01-22 17:26:41.467 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (756, 762) --> . John went back to the
2025-01-22 17:26:41.467 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 17:26:41.467 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 17:26:41.467 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 17:26:41.467 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ„ğŸ½\u200dâ™‚ï¸', 'ğŸ‘¨ğŸ¾\u200dâ¤\u200dğŸ‘¨ğŸ¾', 'ğŸ‘ˆğŸ¿', 'ğŸŠğŸ¾', 'Â®ï¸', 'ğŸ‘¨ğŸ¾\u200dğŸ¤\u200dğŸ‘¨ğŸ¼', 'ğŸ¨', 'ğŸ“´', 'ğŸ¤¹ğŸ¾\u200dâ™‚ï¸', 'ğŸš¶ğŸ»\u200dâ™‚']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.39s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.60s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.76s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.33s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.81s/it]
Processing depth (1, 4, 7, 9):   0%|          | 0/100 [00:50<?, ?it/s]2025-01-22 17:26:58.609 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the apple.
2025-01-22 17:26:58.614 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (903, 907) -->  Daniel got the apple
2025-01-22 17:26:58.614 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the kitchen.
2025-01-22 17:26:58.632 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3627, 3632) --> . Daniel moved to the
2025-01-22 17:26:58.632 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 17:26:58.653 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3627, 3632) --> . Daniel moved to the
2025-01-22 17:26:58.653 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the bathroom.
2025-01-22 17:26:58.690 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7110, 7115) -->  Sandra went to the bathroom
2025-01-22 17:26:58.690 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the bedroom.
2025-01-22 17:26:58.725 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6963, 6968) --> . Mary travelled to the
2025-01-22 17:26:58.725 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the bathroom.
2025-01-22 17:26:58.758 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5641, 5646) -->  the office. John travelled
2025-01-22 17:26:58.758 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the garden.
2025-01-22 17:26:58.763 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (751, 757) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:26:59.565 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 17:26:59.566 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8157])
2025-01-22 17:27:01.781 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [225.66077302631578, 31.14744561887255, 171.6328125, 30.415935576923076, 12.225017490671641], 'topk_indices': array([7624, 7588,  757, 7590, 7575, 7576, 7632, 7606, 7634, 7620, 7592,
       7633, 7546, 7577, 4325, 7591,    0, 7621, 7635, 7636]), 'topk_tokens': ['\n', ' of', ' garden', ' Min', ' two', ' or', ' use', ' or', ' the', ' two', 'ot', ' of', 'nes', ' three', ' composing', 'nes', '<|begin_of_text|>', ' or', ' Min', 'nes'], 'evidence_proportions': [381.625, 253.8, 253.8, 44.6109375]}, 'weight': {'score': [23.06578947368421, 23.277002910539217, 21.2529296875, 23.28148269230769, 29.80457089552239], 'topk_indices': array([3292, 3265, 3125, 3173, 7438, 7400, 1427, 1489, 4282, 4298, 5158,
       5097, 7177, 7121, 3448, 3474, 4922, 4951, 4899, 4874]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.681640625, 19.909375, 19.909375, 26.4859375]}, 'saliency': {'score': [1.275830720600329, 0.1778038174498315, 0.9094734191894531, 0.17379529747596154, 0.093764233945021], 'topk_indices': array([7567, 7607, 7631, 7576, 7575, 7606, 7568, 7592, 7632, 7620,  757,
       7590, 7612, 7546, 7577, 7621, 7591, 4325, 7635, 7636]), 'topk_tokens': [' tele', ' five', ' especial', ' or', ' two', ' or', 'graph', 'ot', ' use', ' two', ' garden', ' Min', ' tele', 'nes', ' three', ' or', 'nes', ' composing', ' Min', 'nes'], 'evidence_proportions': [2.6912841796875, 1.1724609375, 1.1724609375, 0.35020751953125]}}, 'pred_res': 'The garden.<|eot_id|>', 'score': 0}
2025-01-22 17:27:01.788 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:27:01.788 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-48_pid-0_1-4-7-9.pkl | len: 3 |  size: 1.95 KB
Processing depth (1, 4, 7, 9):   1%|          | 1/100 [00:53<1:28:05, 53.39s/it]is_0k: False
your chose emoji: ['â–ª', 'ğŸ‡¯ğŸ‡ª', 'ğŸ’—', 'ğŸ’‡\u200dâ™‚ï¸', 'ğŸ‘¨ğŸ»\u200dğŸ³', 'ğŸ‘©ğŸ¿\u200dâ¤ï¸\u200dğŸ‘¨ğŸ¾', 'ğŸ¿', 'ğŸ™‹ğŸ¿\u200dâ™€', 'ğŸ¤šğŸ»', 'ğŸ’ğŸ½\u200dâ™€ï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.51s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.59s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.26s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  2.99s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.51s/it]
Processing depth (1, 2, 3, 7):   1%|          | 1/100 [01:10<1:28:05, 53.39s/it]2025-01-22 17:27:18.896 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the apple.
2025-01-22 17:27:18.900 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (903, 907) -->  Daniel got the apple
2025-01-22 17:27:18.901 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the kitchen.
2025-01-22 17:27:18.910 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1787, 1792) --> . Daniel moved to the
2025-01-22 17:27:18.911 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 17:27:18.921 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1787, 1792) --> . Daniel moved to the
2025-01-22 17:27:18.922 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the bathroom.
2025-01-22 17:27:18.950 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5623, 5628) --> . Sandra went to the
2025-01-22 17:27:18.950 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the bedroom.
2025-01-22 17:27:18.986 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (7037, 7042) --> . Mary travelled to the
2025-01-22 17:27:18.986 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the bathroom.
2025-01-22 17:27:19.018 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5626, 5631) -->  to the bathroom. John
2025-01-22 17:27:19.018 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the garden.
2025-01-22 17:27:19.022 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (751, 757) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:27:19.806 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 17:27:19.806 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8221])
2025-01-22 17:27:22.042 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [179.69161184210526, 17.726891187378406, 166.30859375, 17.060798021736474, 11.598800505050505], 'topk_indices': array([   9,  754,  755,   23, 8109, 8215, 1605, 8220,    1, 1684, 8119,
       8217,   24,   14,    3, 1606, 8219,  757, 8216,    0]), 'topk_tokens': [':', ' back', ' to', '4', '.\n\n', ':', ' some', '\n\n', '<|start_header_id|>', ' some', ' location', '<|start_header_id|>', '\n\n', '\n', '<|end_header_id|>', ' time', '<|end_header_id|>', ' garden', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [341.96875, 185.55, 185.55, 38.153125]}, 'weight': {'score': [21.568667763157894, 23.329500547178988, 20.376953125, 23.339354812858712, 29.875157828282827], 'topk_indices': array([3373, 3400, 3245, 3293, 7514, 7476, 1423, 1485, 4352, 4368, 5266,
       5205, 7225, 7169, 3556, 3582, 4952, 4977, 5030, 5059]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.681640625, 19.909375, 19.909375, 20.796875]}, 'saliency': {'score': [1.074170564350329, 0.09810027630876475, 0.8778762817382812, 0.09431205411317774, 0.08553622467349274], 'topk_indices': array([   8,   23, 8220, 8109,   20, 8218, 8208,  753, 8075, 1792,  754,
         24, 8214,  903,  906, 1605, 1684, 8119, 1606,  757]), 'topk_tokens': [' Date', '4', '\n\n', '.\n\n', ' Jul', 'assistant', ' apple', ' went', ' context', ' kitchen', ' back', '\n\n', 'Answer', ' Daniel', ' apple', ' some', ' some', ' location', ' time', ' garden'], 'evidence_proportions': [2.4075927734375, 0.961279296875, 0.961279296875, 0.23321533203125]}}, 'pred_res': 'The garden.<|eot_id|>', 'score': 0}
2025-01-22 17:27:22.058 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:27:22.058 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-48_pid-1_1-2-3-7.pkl | len: 3 |  size: 2.02 KB
Processing depth (1, 2, 3, 7):   2%|â–         | 2/100 [01:13<55:22, 33.91s/it]  is_0k: False
your chose emoji: ['ğŸ“¤', 'ğŸ‘©ğŸ¾\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘¨ğŸ¼', 'ğŸ§¯', 'ğŸ“»', 'ğŸ‘©ğŸ½\u200dâ¤\u200dğŸ’‹\u200dğŸ‘©ğŸ¾', 'ğŸ§‘ğŸ»\u200dâ¤\u200dğŸ§‘ğŸ¾', 'ğŸ‚', 'ğŸ§‘ğŸ¾\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ§‘ğŸ½', 'ğŸ§‘ğŸ¿\u200dğŸ¦¼\u200dâ¡ï¸', 'ğŸ””']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:05<00:15,  5.01s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.93s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.63s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.19s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.79s/it]
Processing depth (1, 3, 4, 5):   2%|â–         | 2/100 [01:30<55:22, 33.91s/it]2025-01-22 17:27:39.028 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the apple.
2025-01-22 17:27:39.033 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (903, 907) -->  Daniel got the apple
2025-01-22 17:27:39.033 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the kitchen.
2025-01-22 17:27:39.047 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2871, 2876) --> . Daniel moved to the
2025-01-22 17:27:39.047 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 17:27:39.062 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2871, 2876) --> . Daniel moved to the
2025-01-22 17:27:39.062 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the bathroom.
2025-01-22 17:27:39.083 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4189, 4194) --> . Sandra went to the
2025-01-22 17:27:39.083 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the bedroom.
2025-01-22 17:27:39.119 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (7069, 7074) --> . Mary travelled to the
2025-01-22 17:27:39.119 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the bathroom.
2025-01-22 17:27:39.153 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5749, 5754) --> . John travelled to the
2025-01-22 17:27:39.153 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the garden.
2025-01-22 17:27:39.158 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (751, 757) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:27:39.962 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 17:27:39.962 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8231])
2025-01-22 17:27:42.189 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [154.50740131578948, 18.239857223099346, 226.66796875, 17.517338242468593, 11.392296424278847], 'topk_indices': array([8225, 8119,  903, 8129, 7693,  756,   23,  753, 8230,    1, 8227,
         14,  755,   24,    3,  754, 8229, 8226,    0,  757]), 'topk_tokens': [':', '.\n\n', ' Daniel', ' location', ' or', ' the', '4', ' went', '\n\n', '<|start_header_id|>', '<|start_header_id|>', '\n', ' to', '\n\n', '<|end_header_id|>', ' back', '<|end_header_id|>', '<|eot_id|>', '<|begin_of_text|>', ' garden'], 'evidence_proportions': [353.78125, 137.4375, 137.4375, 29.228125]}, 'weight': {'score': [21.568667763157894, 23.331658367743504, 20.259765625, 23.341738512318575, 29.64588341346154], 'topk_indices': array([3330, 3303, 3223, 3175, 7460, 7498, 1473, 1411, 4332, 4348, 5143,
       5204, 7205, 7149, 3486, 3512, 4968, 4920, 4997, 4945]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.681640625, 19.909375, 19.909375, 20.796875]}, 'saliency': {'score': [0.9373072574013158, 0.1018591513180866, 1.1890869140625, 0.09780144205848273, 0.08386589930607723], 'topk_indices': array([   0, 7803, 8230,   20, 7684, 8228, 7693,   23,  257, 7640, 8218,
       2876, 8224,   24, 8129,  906,  903,  753,  754,  757]), 'topk_tokens': ['<|begin_of_text|>', 'inen', '\n\n', ' Jul', ' tele', 'assistant', ' or', '4', 'hue', 'graph', ' apple', ' kitchen', 'Answer', '\n\n', ' location', ' apple', ' Daniel', ' went', ' back', ' garden'], 'evidence_proportions': [2.528076171875, 0.68125, 0.68125, 0.176806640625]}}, 'pred_res': 'The garden.<|eot_id|>', 'score': 0}
2025-01-22 17:27:42.209 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:27:42.209 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-48_pid-2_1-3-4-5.pkl | len: 3 |  size: 2.03 KB
Processing depth (1, 3, 4, 5):   3%|â–         | 3/100 [01:33<44:39, 27.63s/it]is_0k: False
your chose emoji: ['ğŸ‡©ğŸ‡²', 'ğŸŸ¢', 'ğŸ•µ\u200dâ™‚', 'ğŸ‘¨ğŸ»\u200dâ¤\u200dğŸ’‹\u200dğŸ‘¨ğŸ¾', 'âšª', 'ğŸ‘©ğŸ»\u200dâ¤ï¸\u200dğŸ‘¨ğŸ»', 'ğŸ‘©ğŸ»\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘©ğŸ»', 'ğŸ‡²ğŸ‡¹', 'ğŸ‘¨ğŸ»\u200dâ¤\u200dğŸ’‹\u200dğŸ‘¨ğŸ¿', 'â›¹ğŸ»\u200dâ™‚']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.78s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.19s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.79s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.26s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.87s/it]
Processing depth (2, 4, 6, 7):   3%|â–         | 3/100 [01:51<44:39, 27.63s/it]2025-01-22 17:27:59.599 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the apple.
2025-01-22 17:27:59.609 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1795, 1799) -->  Daniel got the apple
2025-01-22 17:27:59.609 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the kitchen.
2025-01-22 17:27:59.631 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3610, 3615) -->  Hon. Daniel moved to
2025-01-22 17:27:59.631 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 17:27:59.651 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3610, 3615) -->  Hon. Daniel moved to
2025-01-22 17:27:59.651 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the bathroom.
2025-01-22 17:27:59.681 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5645, 5650) --> . Sandra went to the
2025-01-22 17:27:59.681 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the bedroom.
2025-01-22 17:27:59.717 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (7038, 7043) -->  Mary travelled to the bedroom
2025-01-22 17:27:59.717 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the bathroom.
2025-01-22 17:27:59.748 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5648, 5653) -->  to the bathroom. John
2025-01-22 17:27:59.748 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the garden.
2025-01-22 17:27:59.752 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (637, 643) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:28:00.564 | INFO     | test_jbb_embedding:begin_test:693 - the capitol<|eot_id|>
2025-01-22 17:28:00.564 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8167])
2025-01-22 17:28:02.771 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [261.95723684210526, 23.53420096389229, 191.7734375, 22.64644860172096, 22.836710611979168], 'topk_indices': array([8149, 1796, 8154,    9,    3, 8150, 1795,  643, 1799,   28, 8163,
         14, 8158, 8157, 8165, 8155, 1798, 1817, 8162,    0]), 'topk_tokens': ['Question', ' got', ' apple', ':', '<|end_header_id|>', ':', ' Daniel', ' garden', '.', '<|end_header_id|>', '<|start_header_id|>', '\n', '?', ' office', '<|end_header_id|>', ' before', ' apple', ' cap', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [583.0, 175.2125, 175.2125, 178.6125]}, 'weight': {'score': [24.099095394736842, 23.281498623011014, 22.07275390625, 23.28196642593731, 29.606336805555557], 'topk_indices': array([3300, 3273, 3145, 3193, 7458, 7420, 1492, 1430, 4276, 4292, 5190,
       5129, 7171, 7115, 3482, 3456, 4906, 4931, 4983, 4954]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.681640625, 24.7171875, 24.7171875, 20.796875]}, 'saliency': {'score': [1.685045744243421, 0.13120843334034576, 1.0154571533203125, 0.12584016186808544, 0.1684629652235243], 'topk_indices': array([1793, 5656, 5646, 1812, 8151, 1818, 5670, 1810, 8160, 1796, 1814,
       8149, 8158, 8154, 1795,  643, 8155, 8157, 1798, 1817]), 'topk_tokens': [' Mr', ' bathroom', ' Sandra', ' bag', ' Where', 'itol', ' proprietor', ' down', 'Answer', ' got', ' gold', 'Question', '?', ' apple', ' Daniel', ' garden', ' before', ' office', ' apple', ' cap'], 'evidence_proportions': [4.05126953125, 1.053173828125, 1.053173828125, 1.055810546875]}}, 'pred_res': 'the capitol<|eot_id|>', 'score': 0}
2025-01-22 17:28:02.779 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:28:02.781 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-48_pid-3_2-4-6-7.pkl | len: 3 |  size: 2.03 KB
Processing depth (2, 4, 6, 7):   4%|â–         | 4/100 [01:54<39:44, 24.84s/it]is_0k: False
your chose emoji: ['ğŸ™ğŸ¼\u200dâ™‚ï¸', 'ğŸ§¼', 'ğŸŠğŸ¿\u200dâ™€ï¸', 'ğŸ§‘ğŸ¾\u200dâ¤\u200dğŸ§‘ğŸ¼', 'ğŸ‡¦ğŸ‡½', 'ğŸš¶ğŸ¿\u200dâ™€\u200dâ¡', 'âœŒï¸', 'ğŸ¦µğŸ½', 'ğŸ‘³ğŸ½', 'ğŸ§®']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.12s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.77s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.74s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.33s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.81s/it]
Processing depth (5, 6, 8, 9):   4%|â–         | 4/100 [02:11<39:44, 24.84s/it]2025-01-22 17:28:19.846 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the apple.
2025-01-22 17:28:19.873 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4202, 4206) -->  got the apple.
2025-01-22 17:28:19.874 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the kitchen.
2025-01-22 17:28:19.900 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4749, 4754) -->  the senate. Daniel moved
2025-01-22 17:28:19.901 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 17:28:19.928 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4749, 4754) -->  the senate. Daniel moved
2025-01-22 17:28:19.928 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the bathroom.
2025-01-22 17:28:19.967 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7110, 7115) -->  Sandra went to the bathroom
2025-01-22 17:28:19.967 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the bedroom.
2025-01-22 17:28:20.006 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6971, 6976) --> . Mary travelled to the
2025-01-22 17:28:20.006 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the bathroom.
2025-01-22 17:28:20.036 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5705, 5710) --> . John travelled to the
2025-01-22 17:28:20.036 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the garden.
2025-01-22 17:28:20.040 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (751, 757) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:28:20.873 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's kitchen.<|eot_id|>
2025-01-22 17:28:20.873 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8153])
2025-01-22 17:28:23.089 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [675.5805921052631, 41.29792867214321, 191.73046875, 39.51757018840044, 21.454537259615385], 'topk_indices': array([4669, 4756,   14, 8051, 8140, 4200, 8143, 8141, 8151, 8149, 4202,
       4205, 4754, 4753, 4706, 4705, 4204, 4201, 8148,    0]), 'topk_tokens': [' representatives', ' kitchen', '\n', ' location', ' apple', '!', ' office', ' before', '<|end_header_id|>', '<|start_header_id|>', ' got', '.', ' to', ' moved', ' of', ' house', ' apple', ' Daniel', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [1269.0, 747.475, 747.475, 57.05625]}, 'weight': {'score': [24.26768092105263, 23.266916227317314, 20.259765625, 23.270499515145918, 29.372596153846153], 'topk_indices': array([3288, 3315, 3160, 3208, 7438, 7400, 1468, 1406, 4292, 4276, 5160,
       5099, 7177, 7121, 3497, 3471, 4924, 4876, 4953, 4901]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.5703125, 24.6375, 24.6375, 26.4859375]}, 'saliency': {'score': [4.175212659333882, 0.23178299646157738, 1.0423965454101562, 0.22095982439191217, 0.1583813007061298], 'topk_indices': array([4617,    0, 4667, 8135, 4200, 4706, 4619, 8007, 4752, 8051, 8141,
       4756, 4669, 8143, 4202, 8140, 4705, 4753, 4204, 4201]), 'topk_tokens': [' house', '<|begin_of_text|>', ' house', 'Question', '!', ' of', ' representatives', ' context', ' Daniel', ' location', ' before', ' kitchen', ' representatives', ' office', ' got', ' apple', ' house', ' moved', ' apple', ' Daniel'], 'evidence_proportions': [7.33203125, 4.79375, 4.79375, 0.41268310546875]}}, 'pred_res': "Daniel's kitchen.<|eot_id|>", 'score': 100}
2025-01-22 17:28:23.095 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:28:23.096 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-48_pid-4_5-6-8-9.pkl | len: 3 |  size: 2.07 KB
Processing depth (5, 6, 8, 9):   5%|â–Œ         | 5/100 [02:14<36:44, 23.21s/it]Processing depth (5, 6, 8, 9):   5%|â–Œ         | 5/100 [02:14<42:40, 26.95s/it]
2025-01-22 17:28:23.158 | INFO     | __main__:<module>:82 - Selected idx: 50
2025-01-22 17:28:23.158 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the apple before the kitchen? 
2025-01-22 17:28:23.158 | INFO     | __main__:<module>:84 - Answer: hallway
2025-01-22 17:28:23.158 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 17:28:23.158 | INFO     | __main__:<module>:86 - Needle: [' Daniel took the football.', ' Sandra moved to the hallway.', ' Mary picked up the apple.', ' Sandra picked up the apple.', ' Mary travelled to the hallway.', ' Sandra went back to the garden.', ' Daniel put down the football there.', ' Daniel journeyed to the kitchen.', ' Sandra left the apple.', ' Mary went to the kitchen.', ' Daniel went to the garden.']
2025-01-22 17:28:23.158 | INFO     | __main__:<module>:87 - Real Needle: [' Mary picked up the apple.', ' Mary travelled to the hallway.', ' Mary went to the kitchen.', ' Daniel went to the garden.']
2025-01-22 17:28:23.158 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ¦¹ğŸ¼', 'ğŸ¤‘', 'ğŸ€', 'ğŸ›¡ï¸', 'ğŸ§‘ğŸ¼\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ§‘ğŸ¾', 'ğŸ‡¹ğŸ‡©', 'ğŸ¤¸\u200dâ™€', 'ğŸ–•ğŸ¼', 'ğŸšµğŸ»\u200dâ™€', 'ğŸ¤¶ğŸ¼']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.32s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.67s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.64s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.24s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.73s/it]
Processing depth (3, 4, 6, 9):   0%|          | 0/100 [00:16<?, ?it/s]2025-01-22 17:28:39.915 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 17:28:39.929 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2823, 2828) --> . Mary picked up the
2025-01-22 17:28:39.929 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the hallway.
2025-01-22 17:28:39.948 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3562, 3567) --> . Mary travelled to the
2025-01-22 17:28:39.949 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the kitchen.
2025-01-22 17:28:39.972 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4728, 4733) --> . Mary went to the
2025-01-22 17:28:39.973 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went to the garden.
2025-01-22 17:28:39.999 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5107, 5112) -->  back to the garden.
2025-01-22 17:28:39.999 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel took the football.
2025-01-22 17:28:40.020 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3448, 3452) -->  Daniel took the football
2025-01-22 17:28:40.020 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the hallway.
2025-01-22 17:28:40.043 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4504, 4509) --> . Sandra moved to the
2025-01-22 17:28:40.043 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra picked up the apple.
2025-01-22 17:28:40.057 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2824, 2829) -->  Mary picked up the apple
2025-01-22 17:28:40.057 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the garden.
2025-01-22 17:28:40.085 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5104, 5110) --> . Sandra went back to the
2025-01-22 17:28:40.085 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel put down the football there.
2025-01-22 17:28:40.107 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4329, 4335) --> . Daniel put down the football
2025-01-22 17:28:40.108 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel journeyed to the kitchen.
2025-01-22 17:28:40.143 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (6975, 6981) --> . Daniel journeyed to the
2025-01-22 17:28:40.144 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Sandra left the apple.
2025-01-22 17:28:40.162 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (3771, 3775) -->  Sandra left the apple
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:28:40.965 | INFO     | test_jbb_embedding:begin_test:693 - The hallway.<|eot_id|>
2025-01-22 17:28:40.965 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8160])
2025-01-22 17:28:43.210 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [133.0609375, 14.254404400955531, 124.78125, 13.470501958184284, 11.099609375], 'topk_indices': array([8154, 8129, 8141, 8151, 8159, 8150,    4, 8148,    9, 2828,   23,
          1,    3, 8156, 3567,   14,   24, 8158,    0, 8155]), 'topk_tokens': [':', ' return', '.\n\n', '?', '\n\n', ' kitchen', '\n\n', ' before', ':', ' apple', '4', '<|start_header_id|>', '<|end_header_id|>', '<|start_header_id|>', ' hallway', '\n', '\n\n', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [142.5625, 150.0, 61.71875, 177.9625]}, 'weight': {'score': [20.2765625, 23.262841862673035, 23.73806423611111, 23.268098749537437, 29.662109375], 'topk_indices': array([3281, 3308, 3153, 3201, 7431, 7393, 1417, 1479, 4302, 4318, 5139,
       5200, 7164, 7108, 3469, 3495, 4909, 4934, 4957, 4986]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.1, 20.75625, 19.403125, 18.846875]}, 'saliency': {'score': [0.729705810546875, 0.07869149118928397, 0.7851579454210069, 0.07394829657481575, 0.08286230904715401], 'topk_indices': array([8058, 8151, 8144,   23,   16, 8147, 8142, 8153,    8, 3771, 5110,
         20, 1597, 8129, 8148,   24, 4509, 8150, 2828, 3567]), 'topk_tokens': [' location', '?', ' Where', '4', ' Date', ' apple', 'Question', 'Answer', ' Date', ' Sandra', ' garden', ' Jul', 'pay', ' return', ' before', '\n\n', ' hallway', ' kitchen', ' apple', ' hallway'], 'evidence_proportions': [0.782421875, 0.821630859375, 0.2873291015625, 1.02744140625]}}, 'pred_res': 'The hallway.<|eot_id|>', 'score': 100}
2025-01-22 17:28:43.242 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:28:43.242 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-50_pid-0_3-4-6-9.pkl | len: 3 |  size: 2.02 KB
Processing depth (3, 4, 6, 9):   1%|          | 1/100 [00:19<32:59, 19.99s/it]is_0k: False
your chose emoji: ['ğŸ¤·\u200dâ™€ï¸', 'ğŸ¦¦', 'ğŸ§ğŸ¿\u200dâ™‚ï¸', 'ğŸ§‘ğŸ¿\u200dğŸ”¬', 'ğŸ‡µğŸ‡¦', 'ğŸ“‚', 'ğŸœï¸', 'ğŸ˜›', 'ğŸ„ğŸ¿\u200dâ™€ï¸', 'ğŸ¼']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.29s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.75s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.51s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.13s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.65s/it]
Processing depth (0, 2, 3, 8):   1%|          | 1/100 [00:36<32:59, 19.99s/it]2025-01-22 17:28:59.705 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 17:28:59.706 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the apple.
2025-01-22 17:28:59.706 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the hallway.
2025-01-22 17:28:59.717 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1847, 1852) --> . Mary travelled to the
2025-01-22 17:28:59.717 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the kitchen.
2025-01-22 17:28:59.731 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2927, 2932) --> . Mary went to the
2025-01-22 17:28:59.732 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went to the garden.
2025-01-22 17:28:59.763 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5247, 5252) -->  back to the garden.
2025-01-22 17:28:59.763 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel took the football.
2025-01-22 17:28:59.780 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3500, 3504) -->  Daniel took the football
2025-01-22 17:28:59.780 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the hallway.
2025-01-22 17:28:59.811 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4581, 4586) -->  Sandra moved to the hallway
2025-01-22 17:28:59.811 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra picked up the apple.
2025-01-22 17:28:59.812 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (31, 36) -->  picked up the apple.
2025-01-22 17:28:59.812 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the garden.
2025-01-22 17:28:59.842 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5244, 5250) --> . Sandra went back to the
2025-01-22 17:28:59.843 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel put down the football there.
2025-01-22 17:28:59.866 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4403, 4409) --> . Daniel put down the football
2025-01-22 17:28:59.866 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel journeyed to the kitchen.
2025-01-22 17:28:59.903 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (7027, 7033) --> . Daniel journeyed to the
2025-01-22 17:28:59.903 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Sandra left the apple.
2025-01-22 17:28:59.925 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (3827, 3831) -->  Sandra left the apple
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:29:00.737 | INFO     | test_jbb_embedding:begin_test:693 - The hallway.<|eot_id|>
2025-01-22 17:29:00.737 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8218])
2025-01-22 17:29:02.974 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [275.771875, 22.180796511981512, 185.8515625, 20.837995636864665, 11.483536305147059], 'topk_indices': array([   1,   31,   74,   29,   24,  111,   14, 8214,  106,   67, 8213,
       2358,   35,  112, 1852,  105, 2385, 2357, 2371,    0]), 'topk_tokens': ['<|start_header_id|>', ' picked', ' PA', '\n\n', '\n\n', '.', '\n', '<|start_header_id|>', 'E', 'ION', '<|eot_id|>', 'ot', '.', ' PA', ' hallway', 'ION', 'nes', 'nes', 'nes', '<|begin_of_text|>'], 'evidence_proportions': [521.3, 240.75, 150.975, 190.0625]}, 'weight': {'score': [20.271875, 23.307237182216276, 23.942057291666668, 23.311873277709736, 29.620404411764707], 'topk_indices': array([3308, 3281, 3153, 3201, 7439, 7477, 1411, 1473, 4326, 4342, 5211,
       5150, 7160, 7216, 3464, 3490, 4927, 4975, 5004, 4952]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.08125, 20.75625, 19.403125, 18.846875]}, 'saliency': {'score': [1.49609375, 0.1264093099987836, 1.1199730767144098, 0.11867361074565601, 0.08848239674287683], 'topk_indices': array([ 110,   24, 2384, 2356, 8206, 8208, 2370,   34,  106,   30,   74,
       2358,   31,   67,  105,  112, 2385, 2357, 1852, 2371]), 'topk_tokens': [' ST', '\n\n', ' Min', ' Min', ' before', ' kitchen', ' Min', ' apple', 'E', 'Mary', ' PA', 'ot', ' picked', 'ION', 'ION', ' PA', 'nes', 'nes', ' hallway', 'nes'], 'evidence_proportions': [2.85302734375, 1.34306640625, 0.711083984375, 1.077197265625]}}, 'pred_res': 'The hallway.<|eot_id|>', 'score': 100}
2025-01-22 17:29:02.980 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:29:02.981 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-50_pid-1_0-2-3-8.pkl | len: 3 |  size: 1.95 KB
Processing depth (0, 2, 3, 8):   2%|â–         | 2/100 [00:39<32:24, 19.84s/it]is_0k: False
your chose emoji: ['ğŸ§‘ğŸ¿\u200dâ¤\u200dğŸ§‘ğŸ¾', 'ğŸŠ', 'â›¹ğŸ¼\u200dâ™‚', 'ğŸ‘¨ğŸ¿\u200dğŸ¦°', 'ğŸ‘©ğŸ¼\u200dâš–ï¸', 'ğŸ¦¸\u200dâ™‚ï¸', 'ğŸ‘°ğŸ¿\u200dâ™‚ï¸', 'ğŸ¦¹ğŸ»\u200dâ™€ï¸', '\U0001fa7b', 'ğŸ§‘\u200dâš•ï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.50s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.88s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.71s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.03s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.65s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (1, 7, 8, 9):   2%|â–         | 2/100 [00:56<32:24, 19.84s/it]2025-01-22 17:29:20.050 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 17:29:20.054 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (821, 826) --> . Mary picked up the
2025-01-22 17:29:20.054 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the hallway.
2025-01-22 17:29:20.086 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5655, 5660) --> . Mary travelled to the
2025-01-22 17:29:20.087 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the kitchen.
2025-01-22 17:29:20.122 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6572, 6577) -->  Mary went to the kitchen
2025-01-22 17:29:20.122 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went to the garden.
2025-01-22 17:29:20.148 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5107, 5112) -->  back to the garden.
2025-01-22 17:29:20.148 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel took the football.
2025-01-22 17:29:20.168 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3472, 3476) -->  Daniel took the football
2025-01-22 17:29:20.168 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the hallway.
2025-01-22 17:29:20.192 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4540, 4545) --> . Sandra moved to the
2025-01-22 17:29:20.192 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra picked up the apple.
2025-01-22 17:29:20.196 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (822, 827) -->  Mary picked up the apple
2025-01-22 17:29:20.196 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the garden.
2025-01-22 17:29:20.223 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5104, 5110) --> . Sandra went back to the
2025-01-22 17:29:20.223 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel put down the football there.
2025-01-22 17:29:20.248 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4365, 4371) --> . Daniel put down the football
2025-01-22 17:29:20.248 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel journeyed to the kitchen.
2025-01-22 17:29:20.288 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (6998, 7004) -->  Daniel journeyed to the kitchen
2025-01-22 17:29:20.288 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Sandra left the apple.
2025-01-22 17:29:20.309 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (3821, 3825) -->  Sandra left the apple
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:29:23.584 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 17:29:23.584 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8214])
2025-01-22 17:29:26.404 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [246.1125, 23.452075346841912, 208.578125, 22.08977338867786, 29.16778049698795], 'topk_indices': array([   1, 8197, 8198, 5660, 8199, 8204, 8102, 8201, 8112, 8068, 4545,
          3,   14, 8212, 5110, 8202,   24, 8210,    0, 8209]), 'topk_tokens': ['<|start_header_id|>', ':', ' Where', ' hallway', ' was', ' kitchen', '.\n\n', ' apple', ' location', ' context', ' hallway', '<|end_header_id|>', '\n', '<|end_header_id|>', ' garden', ' before', '\n\n', '<|start_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [255.325, 223.0, 142.5, 363.625]}, 'weight': {'score': [21.473828125, 23.308533375927954, 24.403211805555557, 23.308200779622595, 29.842055722891565], 'topk_indices': array([3332, 3305, 3213, 3165, 7467, 7505, 1491, 1429, 4354, 4338, 5187,
       5248, 7188, 7244, 3493, 3519, 5034, 4982, 5005, 4957]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.1, 20.75625, 24.1921875, 18.846875]}, 'saliency': {'score': [1.40997314453125, 0.13121670215426098, 1.3061964246961806, 0.12289978034822632, 0.219412010836314], 'topk_indices': array([7965, 3824, 6136, 8102, 8183, 7798, 8196, 8207, 8198,   24,  826,
       8112, 3821, 8201, 8204, 8068, 8202, 5660, 5110, 4545]), 'topk_tokens': [' Square', ' apple', 'the', '.\n\n', ' return', 'inen', 'Question', 'Answer', ' Where', '\n\n', ' apple', ' location', ' Sandra', ' apple', ' kitchen', ' context', ' before', ' hallway', ' garden', ' hallway'], 'evidence_proportions': [1.45126953125, 1.248046875, 0.883935546875, 2.056640625]}}, 'pred_res': 'The garden.<|eot_id|>', 'score': 0}
2025-01-22 17:29:26.411 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:29:26.411 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-50_pid-2_1-7-8-9.pkl | len: 3 |  size: 2.06 KB
Processing depth (1, 7, 8, 9):   3%|â–         | 3/100 [01:03<34:43, 21.48s/it]is_0k: False
your chose emoji: ['ğŸ‘³ğŸ¼\u200dâ™‚ï¸', 'ğŸ¤¸ğŸ½\u200dâ™‚', 'ğŸƒğŸ»\u200dâ™€', '\U0001faf4ğŸ½', 'ğŸ‘±ğŸ½', 'ğŸ‘¨ğŸ»\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘¨ğŸ¼', 'ğŸƒğŸ¾\u200dâ™€ï¸', 'ğŸ‡ºğŸ‡¿', 'ğŸ¤½\u200dâ™‚ï¸', 'â›¹']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.44s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.67s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.41s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.08s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.60s/it]
Processing depth (1, 2, 5, 7):   3%|â–         | 3/100 [01:19<34:43, 21.48s/it]2025-01-22 17:29:43.242 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 17:29:43.247 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (821, 826) --> . Mary picked up the
2025-01-22 17:29:43.248 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the hallway.
2025-01-22 17:29:43.260 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1799, 1804) --> . Mary travelled to the
2025-01-22 17:29:43.260 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the kitchen.
2025-01-22 17:29:43.283 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4210, 4215) -->  Mary went to the kitchen
2025-01-22 17:29:43.283 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went to the garden.
2025-01-22 17:29:43.313 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5125, 5130) -->  back to the garden.
2025-01-22 17:29:43.313 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel took the football.
2025-01-22 17:29:43.336 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3458, 3462) -->  Daniel took the football
2025-01-22 17:29:43.337 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the hallway.
2025-01-22 17:29:43.359 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4559, 4564) -->  Sandra moved to the hallway
2025-01-22 17:29:43.359 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra picked up the apple.
2025-01-22 17:29:43.364 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (822, 827) -->  Mary picked up the apple
2025-01-22 17:29:43.364 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the garden.
2025-01-22 17:29:43.391 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5122, 5128) --> . Sandra went back to the
2025-01-22 17:29:43.392 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel put down the football there.
2025-01-22 17:29:43.422 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4381, 4387) --> . Daniel put down the football
2025-01-22 17:29:43.422 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel journeyed to the kitchen.
2025-01-22 17:29:43.458 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (7039, 7045) --> . Daniel journeyed to the
2025-01-22 17:29:43.458 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Sandra left the apple.
2025-01-22 17:29:43.476 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (3807, 3811) -->  Sandra left the apple
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:29:44.300 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 17:29:44.300 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8216])
2025-01-22 17:29:46.714 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [208.8, 20.174844491422313, 165.65885416666666, 19.07109250581894, 19.813174293154763], 'topk_indices': array([ 827,    4, 8104,   23,    1,    9, 8199, 8207, 8200, 8206, 8201,
       8203,   24, 1804,   14, 8214, 8204, 8212,    0, 8211]), 'topk_tokens': ['.', '\n\n', '.\n\n', '4', '<|start_header_id|>', ':', ':', '?', ' Where', ' kitchen', ' was', ' apple', '\n\n', ' hallway', '\n', '<|end_header_id|>', ' before', '<|start_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [251.15, 249.575, 152.0375, 182.4375]}, 'weight': {'score': [21.473828125, 23.295281892566006, 24.584635416666668, 23.294058365490628, 29.116071428571427], 'topk_indices': array([3318, 3291, 3163, 3211, 7463, 7501, 1479, 1417, 4302, 4286, 5218,
       5157, 7184, 7240, 3505, 3479, 4975, 5004, 4927, 4952]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.1, 20.75625, 24.1921875, 18.846875]}, 'saliency': {'score': [1.1969879150390625, 0.111844506630977, 1.0720757378472223, 0.10495106151374724, 0.1412516094389416], 'topk_indices': array([8185, 5128,   23, 1801,  826, 4563, 3807, 8209, 8207,    8, 8114,
       7961, 8201, 8198,   24, 8200, 8206, 8203, 8204, 1804]), 'topk_tokens': [' return', ' garden', '4', ' travelled', ' apple', ' hallway', ' Sandra', 'Answer', '?', ' Date', ' location', ' Square', ' was', 'Question', '\n\n', ' Where', ' kitchen', ' apple', ' before', ' hallway'], 'evidence_proportions': [1.4134765625, 1.36328125, 0.971142578125, 1.04005126953125]}}, 'pred_res': 'The garden.<|eot_id|>', 'score': 0}
2025-01-22 17:29:46.720 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:29:46.721 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-50_pid-3_1-2-5-7.pkl | len: 3 |  size: 2.01 KB
Processing depth (1, 2, 5, 7):   4%|â–         | 4/100 [01:23<33:37, 21.02s/it]is_0k: False
your chose emoji: ['ğŸš¶\u200dâ™‚ï¸\u200dâ¡ï¸', 'â›¹ğŸ¼\u200dâ™‚', 'ğŸ‡®ğŸ‡³', 'ğŸ‡¹ğŸ‡¬', 'ğŸ‡§ğŸ‡±', 'ğŸ‘©ğŸ»\u200dğŸ¤\u200dğŸ‘©ğŸ¼', 'ğŸ¤¶ğŸ½', 'ğŸ‘©ğŸ¾\u200dâš–ï¸', 'ğŸ‘ˆğŸ½', 'ğŸ‚ğŸ»']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.66s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.80s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.28s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.76s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.41s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (1, 5, 8, 9):   4%|â–         | 4/100 [01:39<33:37, 21.02s/it]2025-01-22 17:30:02.449 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 17:30:02.454 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (789, 794) --> . Mary picked up the
2025-01-22 17:30:02.454 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the hallway.
2025-01-22 17:30:02.475 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4187, 4192) --> . Mary travelled to the
2025-01-22 17:30:02.475 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the kitchen.
2025-01-22 17:30:02.512 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6687, 6692) --> . Mary went to the
2025-01-22 17:30:02.513 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went to the garden.
2025-01-22 17:30:02.542 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5163, 5168) -->  back to the garden.
2025-01-22 17:30:02.542 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel took the football.
2025-01-22 17:30:02.560 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3354, 3358) -->  Daniel took the football
2025-01-22 17:30:02.560 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the hallway.
2025-01-22 17:30:02.582 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4566, 4571) --> . Sandra moved to the
2025-01-22 17:30:02.582 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra picked up the apple.
2025-01-22 17:30:02.586 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (790, 795) -->  Mary picked up the apple
2025-01-22 17:30:02.586 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the garden.
2025-01-22 17:30:02.616 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5160, 5166) --> . Sandra went back to the
2025-01-22 17:30:02.616 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel put down the football there.
2025-01-22 17:30:02.638 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4391, 4397) --> . Daniel put down the football
2025-01-22 17:30:02.638 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel journeyed to the kitchen.
2025-01-22 17:30:02.677 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (7085, 7091) --> . Daniel journeyed to the
2025-01-22 17:30:02.677 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Sandra left the apple.
2025-01-22 17:30:02.697 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (3731, 3735) -->  Sandra left the apple
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:30:08.280 | INFO     | test_jbb_embedding:begin_test:693 - Mary picked up the apple.<|eot_id|>
2025-01-22 17:30:08.281 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8208])
2025-01-22 17:30:11.431 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [272.359375, 24.969686244062842, 211.51475694444446, 23.539469650521152, 29.039990234375], 'topk_indices': array([8190, 8060, 8191,    3, 8096,  795, 8189, 8106, 8061,   24,   14,
       8198, 8199,  794, 8206, 8196, 4192, 8062, 8203,    0]), 'topk_tokens': ['Question', ' provided', ':', '<|end_header_id|>', '.\n\n', '.', '.\n\n', ' location', ' you', '\n\n', '\n', ' kitchen', '?', ' apple', '<|end_header_id|>', ' before', ' hallway', ' context', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [346.2, 317.2, 224.925, 201.1125]}, 'weight': {'score': [20.2765625, 23.297560056631347, 23.73806423611111, 23.303024409871245, 29.5208984375], 'topk_indices': array([3395, 3368, 3235, 3283, 7455, 7493, 1549, 1487, 4380, 4364, 5256,
       5195, 7220, 7164, 3551, 3577, 4965, 5042, 4990, 5013]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.1, 20.75625, 19.403125, 18.846875]}, 'saliency': {'score': [1.464324951171875, 0.14016915784656253, 1.3407762315538194, 0.13162164460070508, 0.20844669342041017], 'topk_indices': array([4571,  791,   24, 8177, 3734, 8192, 8189, 8061, 8060, 8199, 4189,
       8195, 3731, 8190, 8106, 8196, 8198,  794, 8062, 4192]), 'topk_tokens': [' hallway', ' picked', '\n\n', ' return', ' apple', ' Where', '.\n\n', ' you', ' provided', '?', ' travelled', ' apple', ' Sandra', 'Question', ' location', ' before', ' kitchen', ' apple', ' context', ' hallway'], 'evidence_proportions': [1.887890625, 1.784765625, 1.08330078125, 1.1013427734375]}}, 'pred_res': 'Mary picked up the apple.<|eot_id|>', 'score': 0}
2025-01-22 17:30:11.448 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:30:11.449 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-50_pid-4_1-5-8-9.pkl | len: 3 |  size: 2.04 KB
Processing depth (1, 5, 8, 9):   5%|â–Œ         | 5/100 [01:48<35:24, 22.36s/it]Processing depth (1, 5, 8, 9):   5%|â–Œ         | 5/100 [01:48<34:17, 21.66s/it]
2025-01-22 17:30:11.564 | INFO     | __main__:<module>:82 - Selected idx: 52
2025-01-22 17:30:11.565 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the apple before the kitchen? 
2025-01-22 17:30:11.565 | INFO     | __main__:<module>:84 - Answer: hallway
2025-01-22 17:30:11.565 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 17:30:11.565 | INFO     | __main__:<module>:86 - Needle: [' Sandra went back to the garden.', ' Daniel put down the football there.', ' Mary grabbed the apple.', ' Daniel took the football.', ' Daniel journeyed to the kitchen.', ' Mary travelled to the hallway.', ' Sandra moved to the hallway.', ' Sandra left the apple.', ' Sandra picked up the apple.', ' Mary went to the kitchen.', ' Daniel went to the garden.']
2025-01-22 17:30:11.565 | INFO     | __main__:<module>:87 - Real Needle: [' Mary grabbed the apple.', ' Mary travelled to the hallway.', ' Mary went to the kitchen.', ' Daniel went to the garden.']
2025-01-22 17:30:11.565 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ‘ŒğŸ¼', 'ğŸ‘¨ğŸ½\u200dğŸ¦¼\u200dâ¡', 'ğŸ³', 'ğŸ‘¨ğŸ»\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘¨ğŸ½', 'ğŸ¦µğŸ¼', 'ğŸ¤·\u200dâ™€', 'â†—ï¸', 'ğŸ¤™ğŸ¼', 'ğŸ‘©ğŸ¼\u200dâ¤ï¸\u200dğŸ‘¨ğŸ¼', 'ğŸ±']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:05<00:17,  5.85s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.37s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.68s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.19s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.92s/it]
Processing depth (0, 2, 5, 6):   0%|          | 0/100 [00:17<?, ?it/s]2025-01-22 17:30:29.192 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the apple.
2025-01-22 17:30:29.237 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the hallway.
2025-01-22 17:30:29.245 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1611, 1616) --> . Mary travelled to the
2025-01-22 17:30:29.246 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the kitchen.
2025-01-22 17:30:29.267 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4221, 4226) -->  Mary went to the kitchen
2025-01-22 17:30:29.267 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went to the garden.
2025-01-22 17:30:29.284 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3292, 3297) -->  back to the garden.
2025-01-22 17:30:29.284 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went back to the garden.
2025-01-22 17:30:29.303 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3289, 3295) --> . Sandra went back to the
2025-01-22 17:30:29.303 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel put down the football there.
2025-01-22 17:30:29.330 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4892, 4898) --> . Daniel put down the football
2025-01-22 17:30:29.330 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel took the football.
2025-01-22 17:30:29.331 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (177, 181) -->  Daniel took the football
2025-01-22 17:30:29.331 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the kitchen.
2025-01-22 17:30:29.358 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4445, 4451) -->  execution. Daniel journeyed to
2025-01-22 17:30:29.358 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra moved to the hallway.
2025-01-22 17:30:29.382 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4786, 4791) -->  the garden. Sandra moved
2025-01-22 17:30:29.382 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra left the apple.
2025-01-22 17:30:29.405 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (4454, 4458) -->  Sandra left the apple
2025-01-22 17:30:29.405 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Sandra picked up the apple.
2025-01-22 17:30:29.428 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (4040, 4045) --> . Sandra picked up the
2025-01-22 17:30:29.428 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 17:30:29.428 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 17:30:29.428 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 17:30:29.428 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ§‘ğŸ»\u200dğŸ“', '\U0001faf3ğŸ¼', 'ğŸ‘¨ğŸ»\u200dğŸ¦¯\u200dâ¡ï¸', 'ğŸ‘¨ğŸ¿\u200dğŸ¤\u200dğŸ‘¨ğŸ»', 'ğŸ™ğŸ¿\u200dâ™‚', 'ğŸ’ˆ', 'ğŸ¥', 'ğŸ¤', 'ğŸ––', 'ğŸ‘š']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.36s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.71s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.67s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.26s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.76s/it]
Processing depth (1, 4, 5, 7):   0%|          | 0/100 [00:34<?, ?it/s]2025-01-22 17:30:46.213 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the apple.
2025-01-22 17:30:46.217 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (847, 851) -->  Mary grabbed the apple
2025-01-22 17:30:46.217 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the hallway.
2025-01-22 17:30:46.238 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3538, 3543) --> . Mary travelled to the
2025-01-22 17:30:46.238 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the kitchen.
2025-01-22 17:30:46.264 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4156, 4161) --> . Mary went to the
2025-01-22 17:30:46.264 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went to the garden.
2025-01-22 17:30:46.284 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3190, 3195) -->  back to the garden.
2025-01-22 17:30:46.284 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went back to the garden.
2025-01-22 17:30:46.305 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3186, 3192) -->  ranks. Sandra went back to
2025-01-22 17:30:46.305 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel put down the football there.
2025-01-22 17:30:46.334 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4703, 4709) -->  Daniel put down the football there
2025-01-22 17:30:46.335 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel took the football.
2025-01-22 17:30:46.336 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (184, 188) -->  Daniel took the football
2025-01-22 17:30:46.336 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the kitchen.
2025-01-22 17:30:46.364 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4341, 4347) -->  Daniel journeyed to the kitchen
2025-01-22 17:30:46.364 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra moved to the hallway.
2025-01-22 17:30:46.390 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4671, 4676) -->  Sandra moved to the hallway
2025-01-22 17:30:46.390 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra left the apple.
2025-01-22 17:30:46.411 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (4348, 4352) -->  Sandra left the apple
2025-01-22 17:30:46.411 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Sandra picked up the apple.
2025-01-22 17:30:46.431 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (3948, 3953) --> . Sandra picked up the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:30:47.281 | INFO     | test_jbb_embedding:begin_test:693 - Mary's garden.<|eot_id|>
2025-01-22 17:30:47.281 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8231])
2025-01-22 17:30:49.516 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [269.8157894736842, 29.73179803254797, 205.28819444444446, 28.40136324734075, 26.681492017663043], 'topk_indices': array([8129, 8216, 8214, 8215, 8212, 8218,    3,   24, 8221, 8222,   14,
       3543, 7623, 7579, 7624, 8229, 8219, 8226, 8227,    0]), 'topk_tokens': [' location', ' was', ':', ' Where', '.\n\n', ' apple', '<|end_header_id|>', '\n\n', ' kitchen', '?', '\n', ' hallway', ' Min', 'nes', 'nes', '<|end_header_id|>', ' before', '<|eot_id|>', '<|start_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [385.3125, 321.875, 177.25, 217.925]}, 'weight': {'score': [21.42393092105263, 23.32571692069468, 25.89496527777778, 23.31882622417166, 29.962296195652176], 'topk_indices': array([3399, 3372, 3222, 3270, 7478, 7516, 1503, 1441, 4423, 4439, 5247,
       5308, 7255, 7199, 3561, 3587, 5024, 5049, 5072, 5101]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.005859375, 20.75625, 19.403125, 18.846875]}, 'saliency': {'score': [1.5889956825657894, 0.16766400414819652, 1.3749745686848958, 0.1590482219971688, 0.198955370032269], 'topk_indices': array([3953, 8200, 8085, 8216, 3540,   24, 8212, 8129,  187, 8213, 8222,
        850, 8215, 8218, 7579, 7623, 8221, 7624, 8219, 3543]), 'topk_tokens': [' apple', ' return', ' context', ' was', ' travelled', '\n\n', '.\n\n', ' location', ' football', 'Question', '?', ' apple', ' Where', ' apple', 'nes', ' Min', ' kitchen', 'nes', ' before', ' hallway'], 'evidence_proportions': [2.86865234375, 1.724609375, 0.84228515625, 1.1763671875]}}, 'pred_res': "Mary's garden.<|eot_id|>", 'score': 0}
2025-01-22 17:30:49.524 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:30:49.524 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-52_pid-0_1-4-5-7.pkl | len: 3 |  size: 2.03 KB
Processing depth (1, 4, 5, 7):   1%|          | 1/100 [00:37<1:02:24, 37.83s/it]is_0k: False
your chose emoji: ['ğŸ‘¨ğŸ¿\u200dâ¤ï¸\u200dğŸ‘¨ğŸ¿', 'ğŸ‘©\u200dğŸ‘¦\u200dğŸ‘¦', 'ğŸ‘©\u200dğŸ¦¼\u200dâ¡', 'ğŸ§‘ğŸ½\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ§‘ğŸ»', 'ğŸ‹ğŸ»\u200dâ™€', 'ğŸ‘¨ğŸ¼\u200dâœˆï¸', 'â›„', 'ğŸï¸', 'ğŸ‘¨\u200dğŸ’»', 'ğŸ‡¹ğŸ‡³']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.35s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.87s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.60s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.20s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.73s/it]
Processing depth (2, 7, 8, 9):   1%|          | 1/100 [00:54<1:02:24, 37.83s/it]2025-01-22 17:31:06.316 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the apple.
2025-01-22 17:31:06.326 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1808, 1812) -->  grabbed the apple.
2025-01-22 17:31:06.326 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the hallway.
2025-01-22 17:31:06.360 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5683, 5688) --> . Mary travelled to the
2025-01-22 17:31:06.361 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the kitchen.
2025-01-22 17:31:06.400 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6604, 6609) -->  Mary went to the kitchen
2025-01-22 17:31:06.400 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went to the garden.
2025-01-22 17:31:06.421 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3320, 3325) -->  back to the garden.
2025-01-22 17:31:06.421 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went back to the garden.
2025-01-22 17:31:06.441 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3317, 3323) --> . Sandra went back to the
2025-01-22 17:31:06.441 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel put down the football there.
2025-01-22 17:31:06.476 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4862, 4868) --> . Daniel put down the football
2025-01-22 17:31:06.477 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel took the football.
2025-01-22 17:31:06.478 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (184, 188) -->  Daniel took the football
2025-01-22 17:31:06.478 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the kitchen.
2025-01-22 17:31:06.502 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4402, 4408) --> . Daniel journeyed to the
2025-01-22 17:31:06.502 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra moved to the hallway.
2025-01-22 17:31:06.532 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4800, 4805) --> . Sandra moved to the
2025-01-22 17:31:06.533 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra left the apple.
2025-01-22 17:31:06.555 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (4410, 4414) -->  Sandra left the apple
2025-01-22 17:31:06.556 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Sandra picked up the apple.
2025-01-22 17:31:06.580 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (3986, 3991) --> . Sandra picked up the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:31:07.382 | INFO     | test_jbb_embedding:begin_test:693 - The hallway.<|eot_id|>
2025-01-22 17:31:07.382 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8251])
2025-01-22 17:31:09.621 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [125.87335526315789, 14.596341546522899, 93.12738715277777, 13.993660621722162, 18.388078278186274], 'topk_indices': array([   3, 8139, 8234,    1,    9,   23,    4, 4805, 8241, 8242, 8235,
       8236, 8238,   24,   14, 8249, 8239, 8247,    0, 8246]), 'topk_tokens': ['<|end_header_id|>', '.\n\n', ':', '<|start_header_id|>', ':', '4', '\n\n', ' hallway', ' kitchen', '?', ' Where', ' was', ' apple', '\n\n', '\n', '<|end_header_id|>', ' before', '<|start_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [231.46875, 77.6375, 110.80625, 104.7]}, 'weight': {'score': [21.46669407894737, 23.340104040465228, 23.291666666666668, 23.344658075679963, 29.893688725490197], 'topk_indices': array([3354, 3381, 3247, 3199, 7490, 7528, 1484, 1422, 4391, 4375, 5276,
       5215, 7267, 7211, 3563, 3537, 5069, 5040, 5013, 4988]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.22265625, 20.75625, 24.1921875, 18.846875]}, 'saliency': {'score': [0.6902369449013158, 0.08033451850286603, 0.5505710177951388, 0.07685645287582708, 0.1364159677542892], 'topk_indices': array([1810,    4, 8220, 8149,   14, 8244,   16, 8139,   23,   20,    8,
       8236, 8242,   24, 8233, 8235, 8241, 8238, 4805, 8239]), 'topk_tokens': [' apple', '\n\n', ' return', ' location', '\n', 'Answer', ' Date', '.\n\n', '4', ' Jul', ' Date', ' was', '?', '\n\n', 'Question', ' Where', ' kitchen', ' apple', ' hallway', ' before'], 'evidence_proportions': [1.2877197265625, 0.431494140625, 0.6369140625, 0.52431640625]}}, 'pred_res': 'The hallway.<|eot_id|>', 'score': 100}
2025-01-22 17:31:09.632 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:31:09.632 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-52_pid-1_2-7-8-9.pkl | len: 3 |  size: 2.0 KB
Processing depth (2, 7, 8, 9):   2%|â–         | 2/100 [00:57<44:45, 27.40s/it]  is_0k: False
your chose emoji: ['ğŸš´ğŸ¼\u200dâ™€ï¸', 'ğŸ™‹ğŸ¾\u200dâ™‚ï¸', 'ğŸ§‘ğŸ»\u200dğŸ¦±', 'ğŸ™‹\u200dâ™€ï¸', 'ğŸ§œğŸ»\u200dâ™€', 'ğŸ§‘ğŸ¾\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ§‘ğŸ¼', 'ğŸ˜', 'ğŸ‘¨ğŸ¼\u200dâ¤\u200dğŸ’‹\u200dğŸ‘¨ğŸ¾', 'ğŸ‘©ğŸ½\u200dğŸ¤', 'ğŸ§‘ğŸ¿\u200dğŸ¦°']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.83s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.12s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.69s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.04s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.71s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 2, 7, 8):   2%|â–         | 2/100 [01:14<44:45, 27.40s/it]2025-01-22 17:31:26.405 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the apple.
2025-01-22 17:31:26.445 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the hallway.
2025-01-22 17:31:26.454 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1630, 1635) -->  Mary travelled to the hallway
2025-01-22 17:31:26.454 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the kitchen.
2025-01-22 17:31:26.485 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5733, 5738) --> . Mary went to the
2025-01-22 17:31:26.485 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went to the garden.
2025-01-22 17:31:26.503 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3296, 3301) -->  back to the garden.
2025-01-22 17:31:26.503 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went back to the garden.
2025-01-22 17:31:26.523 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3293, 3299) --> . Sandra went back to the
2025-01-22 17:31:26.523 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel put down the football there.
2025-01-22 17:31:26.548 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4930, 4936) --> . Daniel put down the football
2025-01-22 17:31:26.548 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel took the football.
2025-01-22 17:31:26.549 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (161, 165) -->  Daniel took the football
2025-01-22 17:31:26.549 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the kitchen.
2025-01-22 17:31:26.572 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4422, 4428) --> . Daniel journeyed to the
2025-01-22 17:31:26.572 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra moved to the hallway.
2025-01-22 17:31:26.600 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4824, 4829) -->  the senate. Sandra moved
2025-01-22 17:31:26.600 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra left the apple.
2025-01-22 17:31:26.621 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (4430, 4434) -->  Sandra left the apple
2025-01-22 17:31:26.621 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Sandra picked up the apple.
2025-01-22 17:31:26.641 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (4017, 4022) -->  ground. Sandra picked up
2025-01-22 17:31:26.641 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 17:31:26.641 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 17:31:26.641 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 17:31:26.641 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ‡©ğŸ‡¯', 'ğŸ§‘ğŸ¼\u200dâš–ï¸', 'ğŸ•µğŸ¾\u200dâ™€', 'ğŸ‘§ğŸ½', 'ğŸ‘¨ğŸ¼\u200dğŸ³', 'ğŸ‘¨ğŸ¼\u200dâ¤ï¸\u200dğŸ‘¨ğŸ¿', 'ğŸ‘©ğŸ¿\u200dâ¤\u200dğŸ’‹\u200dğŸ‘¨ğŸ»', 'ğŸ¤µğŸ¾\u200dâ™‚', 'ğŸ‘©ğŸ¾\u200dâ¤\u200dğŸ’‹\u200dğŸ‘¨ğŸ»', 'ğŸ§‘ğŸ½\u200dâ¤\u200dğŸ§‘ğŸ¿']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.81s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.67s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.54s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.12s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.68s/it]
Processing depth (3, 5, 6, 7):   2%|â–         | 2/100 [01:31<44:45, 27.40s/it]2025-01-22 17:31:43.309 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the apple.
2025-01-22 17:31:43.326 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2917, 2921) -->  Mary grabbed the apple
2025-01-22 17:31:43.327 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the hallway.
2025-01-22 17:31:43.351 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4214, 4219) --> . Mary travelled to the
2025-01-22 17:31:43.351 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the kitchen.
2025-01-22 17:31:43.393 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4836, 4841) -->  the senate. Mary went
2025-01-22 17:31:43.393 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went to the garden.
2025-01-22 17:31:43.410 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3340, 3345) -->  back to the garden.
2025-01-22 17:31:43.410 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went back to the garden.
2025-01-22 17:31:43.427 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3337, 3343) --> . Sandra went back to the
2025-01-22 17:31:43.427 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel put down the football there.
2025-01-22 17:31:43.459 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4948, 4954) --> . Daniel put down the football
2025-01-22 17:31:43.459 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel took the football.
2025-01-22 17:31:43.460 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (184, 188) -->  Daniel took the football
2025-01-22 17:31:43.460 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the kitchen.
2025-01-22 17:31:43.486 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4434, 4440) --> . Daniel journeyed to the
2025-01-22 17:31:43.487 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra moved to the hallway.
2025-01-22 17:31:43.511 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4842, 4847) -->  the kitchen. Sandra moved
2025-01-22 17:31:43.511 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra left the apple.
2025-01-22 17:31:43.533 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (4442, 4446) -->  Sandra left the apple
2025-01-22 17:31:43.533 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Sandra picked up the apple.
2025-01-22 17:31:43.555 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (4088, 4093) --> . Sandra picked up the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:31:44.368 | INFO     | test_jbb_embedding:begin_test:693 - The hallway.<|eot_id|>
2025-01-22 17:31:44.368 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8223])
2025-01-22 17:31:46.621 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [150.9152960526316, 16.501322027716995, 132.15538194444446, 15.679218042467262, 21.988791725852273], 'topk_indices': array([   4, 8222, 4441, 8206, 8204,    3, 8210, 8208, 4219,    1, 8207,
         14, 8214,   24, 8221, 8213, 8211,    0, 8219, 8218]), 'topk_tokens': ['\n\n', '\n\n', '.', ':', '.\n\n', '<|end_header_id|>', ' apple', ' was', ' hallway', '<|start_header_id|>', ' Where', '\n', '?', '\n\n', '<|end_header_id|>', ' kitchen', ' before', '<|begin_of_text|>', '<|start_header_id|>', '<|eot_id|>'], 'evidence_proportions': [163.5, 174.875, 81.453125, 186.35]}, 'weight': {'score': [22.668174342105264, 23.30520985290542, 23.840711805555557, 23.304331821380494, 29.305397727272727], 'topk_indices': array([3381, 3354, 3267, 3219, 7464, 7502, 1480, 1542, 4357, 4373, 5199,
       5260, 7225, 7169, 3537, 3563, 5001, 5053, 4976, 5024]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.005859375, 20.75625, 24.13125, 18.846875]}, 'saliency': {'score': [0.900255705180921, 0.0910895468398599, 0.7787831624348959, 0.08617813732206507, 0.15986997430974786], 'topk_indices': array([8077,    8, 8121, 8204, 4440, 4849, 8216, 3343, 8192, 8208, 7795,
       3338, 8205,   24, 8214, 8210, 8207, 4219, 8211, 8213]), 'topk_tokens': [' context', ' Date', ' location', '.\n\n', ' kitchen', ' hallway', 'Answer', ' garden', ' return', ' was', 'inen', ' Sandra', 'Question', '\n\n', '?', ' apple', ' Where', ' hallway', ' before', ' kitchen'], 'evidence_proportions': [1.2076416015625, 0.970703125, 0.4765869140625, 1.007568359375]}}, 'pred_res': 'The hallway.<|eot_id|>', 'score': 100}
2025-01-22 17:31:46.642 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:31:46.643 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-52_pid-2_3-5-6-7.pkl | len: 3 |  size: 2.03 KB
Processing depth (3, 5, 6, 7):   3%|â–         | 3/100 [01:34<51:23, 31.79s/it]is_0k: False
your chose emoji: ['ğŸ¤˜ğŸ¾', 'ğŸ‹ğŸ¾\u200dâ™€', 'ğŸ¥®', 'ğŸ‘®ğŸ¾', 'ğŸ‘©ğŸ½\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘©ğŸ¼', 'ğŸ¤´ğŸ½', '\U0001faf1ğŸ¾\u200d\U0001faf2ğŸ¼', 'ğŸ¤šğŸ¼', 'ğŸ‘©ğŸ¿\u200dâ¤\u200dğŸ’‹\u200dğŸ‘©ğŸ½', 'ğŸ•']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.94s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:10,  5.00s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.84s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.33s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.91s/it]
Processing depth (1, 4, 7, 8):   3%|â–         | 3/100 [01:52<51:23, 31.79s/it]2025-01-22 17:32:04.330 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the apple.
2025-01-22 17:32:04.334 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (785, 789) -->  Mary grabbed the apple
2025-01-22 17:32:04.335 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the hallway.
2025-01-22 17:32:04.356 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3506, 3511) --> . Mary travelled to the
2025-01-22 17:32:04.357 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the kitchen.
2025-01-22 17:32:04.390 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5603, 5608) --> . Mary went to the
2025-01-22 17:32:04.390 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went to the garden.
2025-01-22 17:32:04.409 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3142, 3147) -->  back to the garden.
2025-01-22 17:32:04.410 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went back to the garden.
2025-01-22 17:32:04.426 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3139, 3145) --> . Sandra went back to the
2025-01-22 17:32:04.426 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel put down the football there.
2025-01-22 17:32:04.453 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4680, 4686) --> . Daniel put down the football
2025-01-22 17:32:04.454 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel took the football.
2025-01-22 17:32:04.454 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (166, 170) -->  Daniel took the football
2025-01-22 17:32:04.455 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the kitchen.
2025-01-22 17:32:04.477 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4303, 4309) -->  Daniel journeyed to the kitchen
2025-01-22 17:32:04.477 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra moved to the hallway.
2025-01-22 17:32:04.501 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4635, 4640) -->  Sandra moved to the hallway
2025-01-22 17:32:04.501 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra left the apple.
2025-01-22 17:32:04.527 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (4310, 4314) -->  Sandra left the apple
2025-01-22 17:32:04.527 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Sandra picked up the apple.
2025-01-22 17:32:04.547 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (3898, 3903) --> . Sandra picked up the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:32:05.327 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 17:32:05.328 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8187])
2025-01-22 17:32:07.538 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [236.70394736842104, 23.70177045177045, 160.49175347222223, 22.59894552858021, 46.37265625], 'topk_indices': array([   1, 8085, 8168,    4,    3, 8170, 8041, 8172, 8171, 8174, 8178,
       8177,   24, 3511,   14, 8185, 8175, 8183, 8182,    0]), 'topk_tokens': ['<|start_header_id|>', ' location', '.\n\n', '\n\n', '<|end_header_id|>', ':', ' context', ' was', ' Where', ' apple', '?', ' kitchen', '\n\n', ' hallway', '\n', '<|end_header_id|>', ' before', '<|start_header_id|>', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [254.46875, 271.075, 211.35, 213.475]}, 'weight': {'score': [21.42393092105263, 23.286851343101343, 24.803385416666668, 23.284491203134603, 29.77075892857143], 'topk_indices': array([3340, 3367, 3212, 3260, 7422, 7460, 1437, 1499, 4361, 4377, 5246,
       5185, 7143, 7199, 3573, 3547, 4987, 4962, 5039, 5010]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.005859375, 20.75625, 19.403125, 18.846875]}, 'saliency': {'score': [1.3693333675986843, 0.13418673747042886, 1.0293655395507812, 0.1273404900399028, 0.343511962890625], 'topk_indices': array([   8,  169,  788, 8168, 3515, 3145, 8156, 3160, 3508, 8172, 8085,
       8178, 8169,   24, 8041, 8171, 8174, 8175, 8177, 3511]), 'topk_tokens': [' Date', ' football', ' apple', '.\n\n', 'ï¿½', ' garden', ' return', 'ern', ' travelled', ' was', ' location', '?', 'Question', '\n\n', ' context', ' Where', ' apple', ' before', ' kitchen', ' hallway'], 'evidence_proportions': [1.8343505859375, 1.46572265625, 1.11083984375, 1.159423828125]}}, 'pred_res': 'The garden.<|eot_id|>', 'score': 0}
2025-01-22 17:32:07.544 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:32:07.545 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-52_pid-3_1-4-7-8.pkl | len: 3 |  size: 2.04 KB
Processing depth (1, 4, 7, 8):   4%|â–         | 4/100 [01:55<43:59, 27.49s/it]is_0k: False
your chose emoji: ['ğŸ‘³ğŸ¾\u200dâ™‚', 'ğŸ˜‰', 'ğŸ…', 'â˜ƒï¸', 'ğŸ‘©ğŸ¼\u200dâš•ï¸', 'ğŸ‘©ğŸ»\u200dâ¤\u200dğŸ‘©ğŸ½', 'ğŸ‹\u200dâ™‚', 'ğŸ‘¨ğŸ¿\u200dâœˆ', 'ğŸ‘©ğŸ¾\u200dğŸ«', 'â—']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.43s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.88s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.82s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.33s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.86s/it]
Processing depth (1, 4, 6, 8):   4%|â–         | 4/100 [02:13<43:59, 27.49s/it]2025-01-22 17:32:24.917 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the apple.
2025-01-22 17:32:24.921 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (767, 771) -->  Mary grabbed the apple
2025-01-22 17:32:24.921 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the hallway.
2025-01-22 17:32:24.942 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3522, 3527) --> . Mary travelled to the
2025-01-22 17:32:24.942 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the kitchen.
2025-01-22 17:32:24.968 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4720, 4725) --> . Mary went to the
2025-01-22 17:32:24.968 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went to the garden.
2025-01-22 17:32:24.986 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3232, 3237) -->  back to the garden.
2025-01-22 17:32:24.986 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went back to the garden.
2025-01-22 17:32:25.006 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3229, 3235) --> . Sandra went back to the
2025-01-22 17:32:25.006 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel put down the football there.
2025-01-22 17:32:25.035 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4788, 4794) --> . Daniel put down the football
2025-01-22 17:32:25.035 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel took the football.
2025-01-22 17:32:25.036 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (148, 152) -->  Daniel took the football
2025-01-22 17:32:25.036 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the kitchen.
2025-01-22 17:32:25.058 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4322, 4328) --> . Daniel journeyed to the
2025-01-22 17:32:25.058 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra moved to the hallway.
2025-01-22 17:32:25.086 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4724, 4729) -->  the kitchen. Sandra moved
2025-01-22 17:32:25.086 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra left the apple.
2025-01-22 17:32:25.108 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (4330, 4334) -->  Sandra left the apple
2025-01-22 17:32:25.108 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Sandra picked up the apple.
2025-01-22 17:32:25.128 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (3906, 3911) --> . Sandra picked up the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:32:25.948 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 17:32:25.948 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8181])
2025-01-22 17:32:28.189 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [181.30263157894737, 19.045362903225808, 145.43576388888889, 18.10638608684955, 12.619228078358208], 'topk_indices': array([8170,    1, 8167, 8164, 8162, 8069,    3, 3527,   14,   24, 8166,
       8165, 8168, 8172, 8171, 8179, 8169,    0, 8176, 8177]), 'topk_tokens': [' the', '<|start_header_id|>', ' the', ':', '.\n\n', '.\n\n', '<|end_header_id|>', ' hallway', '\n', '\n\n', ' was', ' Where', ' apple', '?', ' kitchen', '<|end_header_id|>', ' before', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [215.75, 190.625, 113.05, 212.675]}, 'weight': {'score': [21.42393092105263, 23.285805382453567, 23.840711805555557, 23.287699709373847, 30.000932835820894], 'topk_indices': array([3323, 3296, 3161, 3209, 7474, 7436, 1489, 1427, 4311, 4295, 5141,
       5202, 7175, 7119, 3487, 3513, 4991, 4914, 4939, 4962]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.005859375, 20.75625, 19.403125, 18.846875]}, 'saliency': {'score': [1.0443564967105263, 0.1038780249691662, 0.8631108601888021, 0.09831750423709673, 0.09455507193038713], 'topk_indices': array([  27, 3230,    8, 8035, 8079, 8150,  151, 3235, 8162, 8174, 8069,
         24, 8163, 8166, 8172, 8165, 8168, 3527, 8171, 8169]), 'topk_tokens': ['user', ' Sandra', ' Date', ' context', ' location', ' return', ' football', ' garden', '.\n\n', 'Answer', '.\n\n', '\n\n', 'Question', ' was', '?', ' Where', ' apple', ' hallway', ' kitchen', ' before'], 'evidence_proportions': [1.58587646484375, 1.040087890625, 0.5232421875, 1.1365234375]}}, 'pred_res': 'The garden.<|eot_id|>', 'score': 0}
2025-01-22 17:32:28.211 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:32:28.212 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-52_pid-4_1-4-6-8.pkl | len: 3 |  size: 2.04 KB
Processing depth (1, 4, 6, 8):   5%|â–Œ         | 5/100 [02:16<39:37, 25.03s/it]Processing depth (1, 4, 6, 8):   5%|â–Œ         | 5/100 [02:16<43:15, 27.32s/it]
2025-01-22 17:32:28.312 | INFO     | __main__:<module>:82 - Selected idx: 54
2025-01-22 17:32:28.312 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the apple before the bedroom? 
2025-01-22 17:32:28.312 | INFO     | __main__:<module>:84 - Answer: office
2025-01-22 17:32:28.312 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 17:32:28.312 | INFO     | __main__:<module>:86 - Needle: [' Sandra went back to the garden.', ' Daniel picked up the apple.', ' Sandra went back to the bathroom.', ' Daniel moved to the office.', ' Sandra moved to the hallway.', ' Mary went back to the hallway.', ' John went back to the hallway.', ' Daniel went back to the bedroom.', ' John went to the garden.']
2025-01-22 17:32:28.312 | INFO     | __main__:<module>:87 - Real Needle: [' Daniel picked up the apple.', ' Daniel moved to the office.', ' Daniel went back to the bedroom.', ' John went to the garden.']
2025-01-22 17:32:28.312 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ‘©ğŸ¾\u200dğŸ¦¼\u200dâ¡', 'ğŸ¦¥', 'âš™ï¸', 'ğŸï¸', 'ğŸ¤½ğŸ¿\u200dâ™‚', 'âœ…', 'ğŸ‘°ğŸ¼\u200dâ™€ï¸', 'â˜¢', 'ğŸ‘©ğŸ»\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘©ğŸ¾', 'â™‹']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.66s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.93s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.75s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.27s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.83s/it]
Processing depth (2, 4, 5, 7):   0%|          | 0/100 [00:17<?, ?it/s]2025-01-22 17:32:45.660 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the apple.
2025-01-22 17:32:45.669 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1809, 1814) --> . Daniel picked up the
2025-01-22 17:32:45.670 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the office.
2025-01-22 17:32:45.688 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3610, 3615) --> . Daniel moved to the
2025-01-22 17:32:45.689 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the bedroom.
2025-01-22 17:32:45.710 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4169, 4175) --> . Daniel went back to the
2025-01-22 17:32:45.711 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the garden.
2025-01-22 17:32:45.731 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4135, 4140) -->  John went back to the
2025-01-22 17:32:45.731 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went back to the garden.
2025-01-22 17:32:45.752 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4172, 4178) -->  back to the bedroom. Sandra
2025-01-22 17:32:45.752 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the bathroom.
2025-01-22 17:32:45.773 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4172, 4178) -->  back to the bedroom. Sandra
2025-01-22 17:32:45.773 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the hallway.
2025-01-22 17:32:45.794 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4174, 4179) -->  the bedroom. Sandra moved
2025-01-22 17:32:45.794 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary went back to the hallway.
2025-01-22 17:32:45.810 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3089, 3095) --> . Mary went back to the
2025-01-22 17:32:45.810 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went back to the hallway.
2025-01-22 17:32:45.825 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3090, 3096) -->  Mary went back to the hallway
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:32:46.592 | INFO     | test_jbb_embedding:begin_test:693 - The capitol<|eot_id|>
2025-01-22 17:32:46.592 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8192])
2025-01-22 17:32:48.830 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [346.6458333333333, 35.62603734439834, 263.63793103448273, 34.01211781679764, 34.01151315789474], 'topk_indices': array([8175, 1814, 8191,    1, 8080, 8182,    3, 8120, 8045, 8180, 8186,
         24,   23, 8090,   14, 8046, 8188, 8190, 8187,    0]), 'topk_tokens': [':', ' apple', '\n\n', '<|start_header_id|>', '.\n\n', ' bedroom', '<|end_header_id|>', ' the', ' you', ' before', ':', '\n\n', '4', ' location', '\n', ' context', '<|start_header_id|>', '<|end_header_id|>', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [583.5, 539.45, 199.75, 93.2625]}, 'weight': {'score': [21.318824404761905, 23.290019755308762, 23.594019396551722, 23.29402013752456, 29.576480263157894], 'topk_indices': array([3321, 3294, 3162, 3210, 7417, 7455, 1445, 1507, 4319, 4335, 5136,
       5197, 7138, 7194, 3503, 3477, 4907, 4984, 4932, 4955]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.3625, 19.909375, 20.927083333333332, 22.1546875]}, 'saliency': {'score': [1.9081333705357142, 0.19808770017505187, 1.5796150996767242, 0.18875871519677062, 0.24309680336400083], 'topk_indices': array([8189, 8080,   20,   24, 8118, 8044, 3612,   23, 8045, 8174, 8179,
       3615, 1811, 8185, 8180, 1810, 1814, 8090, 8182, 8046]), 'topk_tokens': ['assistant', '.\n\n', ' Jul', '\n\n', ' moved', ' provided', ' moved', '4', ' you', 'Question', ' apple', ' office', ' picked', 'Answer', ' before', ' Daniel', ' apple', ' location', ' bedroom', ' context'], 'evidence_proportions': [3.5798828125, 2.7251953125, 1.00390625, 0.50439453125]}}, 'pred_res': 'The capitol<|eot_id|>', 'score': 0}
2025-01-22 17:32:48.834 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:32:48.835 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-54_pid-0_2-4-5-7.pkl | len: 3 |  size: 2.04 KB
Processing depth (2, 4, 5, 7):   1%|          | 1/100 [00:20<33:42, 20.43s/it]is_0k: False
your chose emoji: ['â˜¸', 'âœ’', 'ğŸ‘©ğŸ¼\u200dğŸ¦¯', 'ğŸ¥‘', 'ğŸ¤¢', '\U0001faf1ğŸ½\u200d\U0001faf2ğŸ»', 'ğŸµ', 'ğŸš¶ğŸ¼\u200dâ™€ï¸\u200dâ¡ï¸', 'ğŸš¶\u200dâ™€ï¸\u200dâ¡ï¸', 'ğŸ‘©ğŸ»\u200dğŸ¤\u200dğŸ‘©ğŸ¾']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.54s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.17s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.78s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.07s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.73s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 4, 5, 7):   1%|          | 1/100 [00:37<33:42, 20.43s/it]2025-01-22 17:33:05.602 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the apple.
2025-01-22 17:33:05.602 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the apple.
2025-01-22 17:33:05.603 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the office.
2025-01-22 17:33:05.621 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3650, 3655) --> . Daniel moved to the
2025-01-22 17:33:05.621 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the bedroom.
2025-01-22 17:33:05.644 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4186, 4192) -->  Daniel went back to the bedroom
2025-01-22 17:33:05.644 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the garden.
2025-01-22 17:33:05.674 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5624, 5629) --> . John went to the
2025-01-22 17:33:05.674 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went back to the garden.
2025-01-22 17:33:05.697 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4188, 4194) -->  back to the bedroom. Sandra
2025-01-22 17:33:05.697 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the bathroom.
2025-01-22 17:33:05.720 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4188, 4194) -->  back to the bedroom. Sandra
2025-01-22 17:33:05.721 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the hallway.
2025-01-22 17:33:05.742 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4190, 4195) -->  the bedroom. Sandra moved
2025-01-22 17:33:05.742 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary went back to the hallway.
2025-01-22 17:33:05.758 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3124, 3130) -->  ranks. Mary went back to
2025-01-22 17:33:05.758 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went back to the hallway.
2025-01-22 17:33:05.774 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3126, 3132) -->  Mary went back to the hallway
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:33:09.057 | INFO     | test_jbb_embedding:begin_test:693 - The hallway.<|eot_id|>
2025-01-22 17:33:09.058 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8234])
2025-01-22 17:33:12.056 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [928.1666666666666, 59.33465502064109, 272.55818965517244, 56.35041916076228, 37.44607764175258], 'topk_indices': array([  25, 6019,   23, 6017, 6154,   31,   29, 3632, 3644, 3651,   14,
       7420, 6155, 8229,   24, 3650, 3653, 8230, 3652,    0]), 'topk_tokens': ['<|eot_id|>', ' way', '4', '\n', '\n', ' picked', '\n\n', '.', '.', ' Daniel', '\n', 'nes', 'the', '<|eot_id|>', '\n\n', '.', ' to', '<|start_header_id|>', ' moved', '<|begin_of_text|>'], 'evidence_proportions': [1114.8, 2326.2, 298.1458333333333, 99.525]}, 'weight': {'score': [21.706473214285715, 23.33006958778533, 24.424030172413794, 23.33035918794283, 29.90721649484536], 'topk_indices': array([3315, 3288, 3208, 3160, 7505, 7467, 1499, 1437, 4379, 4363, 5235,
       5174, 7244, 7188, 3471, 3497, 4976, 4999, 4951, 5028]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.08125, 19.909375, 25.44921875, 18.6375]}, 'saliency': {'score': [5.064534505208333, 0.33153828513917555, 1.6868180899784482, 0.3145952073280601, 0.27827217652625647], 'topk_indices': array([8088, 8221,   29, 7419,   38, 8224, 8222, 1246, 6019,   63,   24,
         30, 3655, 3653, 6155, 3607,   31, 7420, 3651, 3652]), 'topk_tokens': [' context', ' apple', '\n\n', ' Min', '***', ' bedroom', ' before', 'nes', ' way', 'ISC', '\n\n', 'Daniel', ' office', ' to', 'the', ' speakers', ' picked', 'nes', ' Daniel', ' moved'], 'evidence_proportions': [6.165234375, 12.219921875, 1.9829508463541667, 0.50634765625]}}, 'pred_res': 'The hallway.<|eot_id|>', 'score': 0}
2025-01-22 17:33:12.063 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:33:12.063 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-54_pid-1_0-4-5-7.pkl | len: 3 |  size: 1.96 KB
Processing depth (0, 4, 5, 7):   2%|â–         | 2/100 [00:43<36:03, 22.08s/it]is_0k: False
your chose emoji: ['ğŸšµğŸ¾\u200dâ™‚ï¸', 'ğŸ™ğŸ¾\u200dâ™€', 'ğŸ¦¾', 'ğŸ‘©ğŸ¼\u200dğŸ¦²', 'ğŸ’‚ğŸ½\u200dâ™€ï¸', 'ğŸ§‘ğŸ¼\u200dğŸ¦¼\u200dâ¡ï¸', 'ğŸ‘°\u200dâ™€ï¸', 'ğŸ‘¨ğŸ½\u200dâ¤ï¸\u200dğŸ‘¨ğŸ»', 'ğŸ‘·ğŸ¼\u200dâ™€ï¸', '\U0001faf1ğŸ»\u200d\U0001faf2ğŸ½']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.03s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.70s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.61s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.26s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.72s/it]
Processing depth (3, 6, 8, 9):   2%|â–         | 2/100 [01:00<36:03, 22.08s/it]2025-01-22 17:33:28.799 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the apple.
2025-01-22 17:33:28.815 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2921, 2926) --> . Daniel picked up the
2025-01-22 17:33:28.816 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the office.
2025-01-22 17:33:28.843 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4777, 4782) -->  the senate. Daniel moved
2025-01-22 17:33:28.843 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the bedroom.
2025-01-22 17:33:28.880 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6605, 6611) --> . Daniel went back to the
2025-01-22 17:33:28.880 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the garden.
2025-01-22 17:33:28.903 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4135, 4140) -->  John went back to the
2025-01-22 17:33:28.903 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went back to the garden.
2025-01-22 17:33:28.937 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6792, 6798) --> . Sandra went back to the
2025-01-22 17:33:28.937 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the bathroom.
2025-01-22 17:33:28.975 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6792, 6798) --> . Sandra went back to the
2025-01-22 17:33:28.975 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the hallway.
2025-01-22 17:33:28.999 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4208, 4213) -->  Sandra moved to the hallway
2025-01-22 17:33:28.999 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary went back to the hallway.
2025-01-22 17:33:29.018 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3104, 3110) -->  ranks. Mary went back to
2025-01-22 17:33:29.018 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went back to the hallway.
2025-01-22 17:33:29.034 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3106, 3112) -->  Mary went back to the hallway
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:33:29.816 | INFO     | test_jbb_embedding:begin_test:693 - the hallway<|eot_id|>
2025-01-22 17:33:29.816 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8188])
2025-01-22 17:33:32.110 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [152.109375, 24.01344246031746, 143.3739224137931, 23.25773379914005, 17.452465160472972], 'topk_indices': array([8179, 2927, 2926,    9, 3111,   23, 8115, 8076,    1,    3, 8104,
       8175,   14,   24, 8176, 8116, 8186,    0, 8183, 8184]), 'topk_tokens': ['?', '.', ' apple', ':', ' hallway', '4', ' to', '.\n\n', '<|start_header_id|>', '<|end_header_id|>', ' a', ' apple', '\n', '\n\n', ' before', ' the', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [294.7, 102.734375, 136.14583333333334, 78.05]}, 'weight': {'score': [22.444568452380953, 23.286317155067156, 24.178071120689655, 23.28531173218673, 29.541596283783782], 'topk_indices': array([3295, 3268, 3140, 3188, 7435, 7397, 1429, 1491, 4300, 4284, 5127,
       5188, 7168, 7112, 3463, 3489, 4981, 4929, 4904, 4952]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.3625, 24.6375, 20.927083333333332, 22.1546875]}, 'saliency': {'score': [0.8760957263764881, 0.13192925645318224, 0.9690699084051724, 0.12702697453979192, 0.13047604947476774], 'topk_indices': array([   8, 8104, 8180,   20, 8086, 8103, 8179, 8079,   23, 8076, 8170,
       8114,   24, 8172, 8178, 8181, 2926, 8176, 8175, 3111]), 'topk_tokens': [' Date', ' a', ' \n', ' Jul', ' location', 'If', '?', ' person', '4', '.\n\n', 'Question', ' moved', '\n\n', ' Where', ' bedroom', 'Answer', ' apple', ' before', ' apple', ' hallway'], 'evidence_proportions': [1.62734375, 0.67423095703125, 0.7819010416666666, 0.43974609375]}}, 'pred_res': 'the hallway<|eot_id|>', 'score': 0}
2025-01-22 17:33:32.117 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:33:32.117 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-54_pid-2_3-6-8-9.pkl | len: 3 |  size: 2.0 KB
Processing depth (3, 6, 8, 9):   3%|â–         | 3/100 [01:03<34:11, 21.15s/it]is_0k: False
your chose emoji: ['ğŸ’†ğŸ¿\u200dâ™‚ï¸', 'ğŸ“¯', '\U0001fac5ğŸ»', 'ğŸ™\u200dâ™‚ï¸', 'ğŸ‘¬ğŸ¿', 'ğŸƒğŸ¾\u200dâ™‚\u200dâ¡ï¸', 'ğŸ‘©\u200dğŸ‘§\u200dğŸ‘§', 'â˜ƒ', 'ğŸ¤œğŸ¼', 'ğŸ‘¨\u200dğŸ‘¨\u200dğŸ‘§']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.26s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.60s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.67s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.27s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.74s/it]
Processing depth (4, 5, 8, 9):   3%|â–         | 3/100 [01:20<34:11, 21.15s/it]2025-01-22 17:33:48.940 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the apple.
2025-01-22 17:33:48.960 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3611, 3616) -->  Hon. Daniel picked up
2025-01-22 17:33:48.960 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the office.
2025-01-22 17:33:48.984 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4220, 4225) -->  Daniel moved to the office
2025-01-22 17:33:48.984 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the bedroom.
2025-01-22 17:33:49.019 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6609, 6615) --> . Daniel went back to the
2025-01-22 17:33:49.019 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the garden.
2025-01-22 17:33:49.055 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6799, 6804) -->  back to the garden.
2025-01-22 17:33:49.056 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went back to the garden.
2025-01-22 17:33:49.091 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6796, 6802) --> . Sandra went back to the
2025-01-22 17:33:49.091 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the bathroom.
2025-01-22 17:33:49.127 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6796, 6802) --> . Sandra went back to the
2025-01-22 17:33:49.127 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the hallway.
2025-01-22 17:33:49.153 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4222, 4227) -->  to the office. Sandra
2025-01-22 17:33:49.154 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary went back to the hallway.
2025-01-22 17:33:49.179 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3094, 3100) -->  ranks. Mary went back to
2025-01-22 17:33:49.180 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went back to the hallway.
2025-01-22 17:33:49.197 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3096, 3102) -->  Mary went back to the hallway
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:33:50.099 | INFO     | test_jbb_embedding:begin_test:693 - Daniel picked up the apple.<|eot_id|>
2025-01-22 17:33:50.099 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8170])
2025-01-22 17:33:52.358 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [785.9196428571429, 44.96270802741067, 306.88793103448273, 42.11169508741689, 25.4328125], 'topk_indices': array([   1, 4193, 8158,   24, 4194,    3, 8166, 8165,   14, 6610, 4224,
       3614, 3617, 3613, 6612, 6611, 6613, 8168, 6614,    0]), 'topk_tokens': ['<|start_header_id|>', ' the', ' before', '\n\n', ' hallway', '<|end_header_id|>', '<|start_header_id|>', '<|eot_id|>', '\n', ' Daniel', ' office', ' picked', ' apple', ' Daniel', ' back', ' went', ' to', '<|end_header_id|>', ' the', '<|begin_of_text|>'], 'evidence_proportions': [888.7, 707.0, 1295.8333333333333, 150.1625]}, 'weight': {'score': [22.631696428571427, 23.270248256240823, 23.09428879310345, 23.27252754863334, 29.397596153846155], 'topk_indices': array([3258, 3285, 3178, 3130, 7439, 7401, 1481, 1419, 4294, 4278, 5210,
       5149, 7172, 7116, 3467, 3441, 4926, 5003, 4974, 4951]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [27.1703125, 23.9234375, 20.927083333333332, 18.846875]}, 'saliency': {'score': [4.590053013392857, 0.25263792571050536, 1.8192433324353448, 0.2358295935710878, 0.19164029634915866], 'topk_indices': array([3494, 8157, 8152, 4191, 6613, 6615, 8068, 6614, 8158,    0, 8160,
       3101, 6612, 4224, 3617, 3614, 6610, 6611, 3613, 4194]), 'topk_tokens': [' Ramsey', ' apple', 'Question', ' back', ' to', ' bedroom', ' location', ' the', ' before', '<|begin_of_text|>', ' bedroom', ' hallway', ' back', ' office', ' apple', ' picked', ' Daniel', ' went', ' Daniel', ' hallway'], 'evidence_proportions': [6.0546875, 4.298046875, 6.819010416666667, 0.74267578125]}}, 'pred_res': 'Daniel picked up the apple.<|eot_id|>', 'score': 0}
2025-01-22 17:33:52.367 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:33:52.367 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-54_pid-3_4-5-8-9.pkl | len: 3 |  size: 2.09 KB
Processing depth (4, 5, 8, 9):   4%|â–         | 4/100 [01:23<33:16, 20.80s/it]is_0k: False
your chose emoji: ['ğŸ§ğŸ¿\u200dâ™‚', 'ğŸ‡¹ğŸ‡·', 'ğŸš£ğŸ¿\u200dâ™€ï¸', 'ğŸ§‘ğŸ»\u200dğŸ¦²', 'ğŸ¦»ğŸ½', 'ğŸ™…ğŸ¿\u200dâ™€', 'ğŸ¤', 'ğŸ‡', 'ğŸš¶\u200dâ™‚\u200dâ¡', 'â™¦']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.94s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.83s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.94s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.40s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.95s/it]
Processing depth (1, 3, 6, 9):   4%|â–         | 4/100 [01:41<33:16, 20.80s/it]2025-01-22 17:34:10.273 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the apple.
2025-01-22 17:34:10.279 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (827, 832) --> . Daniel picked up the
2025-01-22 17:34:10.279 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the office.
2025-01-22 17:34:10.295 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2877, 2882) --> . Daniel moved to the
2025-01-22 17:34:10.295 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the bedroom.
2025-01-22 17:34:10.319 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4715, 4721) --> . Daniel went back to the
2025-01-22 17:34:10.319 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the garden.
2025-01-22 17:34:10.340 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4113, 4118) -->  John went back to the
2025-01-22 17:34:10.340 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went back to the garden.
2025-01-22 17:34:10.374 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6732, 6738) --> . Sandra went back to the
2025-01-22 17:34:10.374 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the bathroom.
2025-01-22 17:34:10.410 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6732, 6738) --> . Sandra went back to the
2025-01-22 17:34:10.410 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the hallway.
2025-01-22 17:34:10.430 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4147, 4152) --> . Sandra moved to the
2025-01-22 17:34:10.430 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary went back to the hallway.
2025-01-22 17:34:10.446 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3079, 3085) --> . Mary went back to the
2025-01-22 17:34:10.446 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went back to the hallway.
2025-01-22 17:34:10.461 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3080, 3086) -->  Mary went back to the hallway
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:34:11.358 | INFO     | test_jbb_embedding:begin_test:693 - Daniel picked up the apple.<|eot_id|>
2025-01-22 17:34:11.359 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8192])
2025-01-22 17:34:13.592 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [329.42410714285717, 34.62966804979253, 118.89439655172414, 33.569456808693516, 20.938065378289473], 'topk_indices': array([ 829, 8180, 8108, 8080,  828, 8089, 8118,   24,   14, 8119,    1,
       8046,  833,  832, 8090, 8190, 8120, 8188,    0, 8187]), 'topk_tokens': [' picked', ' before', ' a', '.\n\n', ' Daniel', ' first', ' moved', '\n\n', '\n', ' to', '<|start_header_id|>', ' context', '.', ' apple', ' location', '<|end_header_id|>', ' the', '<|start_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [712.7, 409.25, 154.47916666666666, 76.25625]}, 'weight': {'score': [21.318824404761905, 23.287599920673664, 22.297144396551722, 23.29620349336935, 29.44613486842105], 'topk_indices': array([3292, 3319, 3200, 3152, 7427, 7465, 1491, 1429, 4302, 4318, 5156,
       5217, 7198, 7142, 3475, 3501, 5010, 4958, 4981, 4933]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.3625, 19.909375, 20.927083333333332, 22.1546875]}, 'saliency': {'score': [1.785400390625, 0.19173491917676044, 0.6967857623922413, 0.18582707912842278, 0.15297698974609375], 'topk_indices': array([8086, 7528, 8179, 8176, 8092, 8083, 8080, 8045,   24, 8120, 8180,
       8089, 8182,  829,  257, 8118,  828, 8046,  832, 8090]), 'topk_tokens': [' item', 'nes', ' apple', ' Where', ' traveled', ' person', '.\n\n', ' you', '\n\n', ' the', ' before', ' first', ' bedroom', ' picked', 'hue', ' moved', ' Daniel', ' context', ' apple', ' location'], 'evidence_proportions': [4.2330078125, 1.90478515625, 0.7690836588541666, 0.43798828125]}}, 'pred_res': 'Daniel picked up the apple.<|eot_id|>', 'score': 0}
2025-01-22 17:34:13.599 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:34:13.599 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-54_pid-4_1-3-6-9.pkl | len: 3 |  size: 2.05 KB
Processing depth (1, 3, 6, 9):   5%|â–Œ         | 5/100 [01:45<33:10, 20.95s/it]Processing depth (1, 3, 6, 9):   5%|â–Œ         | 5/100 [01:45<33:19, 21.05s/it]
2025-01-22 17:34:13.666 | INFO     | __main__:<module>:82 - Selected idx: 56
2025-01-22 17:34:13.666 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the football before the office? 
2025-01-22 17:34:13.666 | INFO     | __main__:<module>:84 - Answer: hallway
2025-01-22 17:34:13.666 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 17:34:13.666 | INFO     | __main__:<module>:86 - Needle: [' Sandra moved to the hallway.', ' Daniel grabbed the football.', ' Sandra went back to the garden.', ' Sandra picked up the apple.', ' Sandra left the apple.', ' Daniel went to the hallway.', ' Mary went back to the hallway.', ' Daniel moved to the office.', ' Sandra picked up the apple.']
2025-01-22 17:34:13.666 | INFO     | __main__:<module>:87 - Real Needle: [' Daniel grabbed the football.', ' Daniel went to the hallway.', ' Daniel moved to the office.', ' Sandra picked up the apple.']
2025-01-22 17:34:13.666 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ¦»ğŸ»', '\U0001fac4ğŸ¼', 'ğŸ‘©ğŸ¾\u200dâ¤\u200dğŸ’‹\u200dğŸ‘©ğŸ»', 'ğŸš', 'ğŸ§–ğŸ¼\u200dâ™€ï¸', 'ğŸ‘©ğŸ¾\u200dğŸ¦¼\u200dâ¡', 'ğŸ§£', 'ğŸ§ğŸ¾\u200dâ™€ï¸', 'ğŸ‘¨ğŸ½', '\U0001fae8']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.12s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.60s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.22s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.84s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.38s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 2, 4, 5):   0%|          | 0/100 [00:15<?, ?it/s]2025-01-22 17:34:29.170 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel grabbed the football.
2025-01-22 17:34:29.214 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the hallway.
2025-01-22 17:34:29.226 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1864, 1869) --> . Daniel went to the
2025-01-22 17:34:29.226 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 17:34:29.250 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3623, 3628) -->  Hon. Daniel moved to
2025-01-22 17:34:29.250 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra picked up the apple.
2025-01-22 17:34:29.272 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4215, 4220) -->  Sandra picked up the apple
2025-01-22 17:34:29.272 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the hallway.
2025-01-22 17:34:29.277 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (975, 980) --> . Sandra moved to the
2025-01-22 17:34:29.277 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the garden.
2025-01-22 17:34:29.303 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1785, 1791) --> . Sandra went back to the
2025-01-22 17:34:29.303 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra left the apple.
2025-01-22 17:34:29.309 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (907, 911) -->  Sandra left the apple
2025-01-22 17:34:29.309 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary went back to the hallway.
2025-01-22 17:34:29.339 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4477, 4483) -->  Mary went back to the hallway
2025-01-22 17:34:29.339 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 17:34:29.339 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 17:34:29.339 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 17:34:29.339 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ§\u200dâ™€ï¸', 'ğŸ§‘\u200dğŸ¦³', 'ğŸ ', 'ğŸ§ğŸ¾\u200dâ¡', 'ğŸ‘¨ğŸ¿\u200dâ¤\u200dğŸ’‹\u200dğŸ‘¨ğŸ»', 'ğŸ', 'ğŸ“€', 'ğŸ‘©ğŸ¿\u200dğŸ¦½', 'ğŸš¼', 'ğŸ¥¿']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:05<00:15,  5.23s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.77s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.82s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.28s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.87s/it]
Processing depth (0, 5, 6, 9):   0%|          | 0/100 [00:32<?, ?it/s]2025-01-22 17:34:46.804 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel grabbed the football.
2025-01-22 17:34:46.845 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the hallway.
2025-01-22 17:34:46.869 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4229, 4234) -->  Daniel went to the hallway
2025-01-22 17:34:46.869 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 17:34:46.898 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4787, 4792) -->  the senate. Daniel moved
2025-01-22 17:34:46.898 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra picked up the apple.
2025-01-22 17:34:46.933 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7150, 7155) -->  Sandra picked up the apple
2025-01-22 17:34:46.933 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the hallway.
2025-01-22 17:34:46.939 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1049, 1054) --> . Sandra moved to the
2025-01-22 17:34:46.939 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the garden.
2025-01-22 17:34:46.948 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1851, 1857) --> . Sandra went back to the
2025-01-22 17:34:46.948 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra left the apple.
2025-01-22 17:34:46.953 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (965, 969) -->  Sandra left the apple
2025-01-22 17:34:46.953 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary went back to the hallway.
2025-01-22 17:34:46.980 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4461, 4467) -->  execution. Mary went back to
2025-01-22 17:34:46.980 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 17:34:46.980 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 17:34:46.980 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 17:34:46.980 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ§˜ğŸ¼\u200dâ™‚ï¸', 'ğŸ‘¨ğŸ»\u200dâš•', 'ğŸ”', 'ğŸ¤¦ğŸ¼\u200dâ™€ï¸', 'ğŸ¤Œ', 'ğŸ‘¨ğŸ¾', 'â›¹\u200dâ™‚ï¸', 'ğŸ‘¨ğŸ¼\u200dâ¤\u200dğŸ‘¨ğŸ½', '\U0001faf1ğŸ½\u200d\U0001faf2ğŸ¿', 'ğŸ‘·ğŸ¿\u200dâ™‚ï¸']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.65s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.56s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.72s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.29s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.79s/it]
Processing depth (0, 5, 6, 7):   0%|          | 0/100 [00:50<?, ?it/s]2025-01-22 17:35:03.960 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel grabbed the football.
2025-01-22 17:35:04.003 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the hallway.
2025-01-22 17:35:04.024 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4235, 4240) -->  Daniel went to the hallway
2025-01-22 17:35:04.024 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 17:35:04.049 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4791, 4796) -->  the senate. Daniel moved
2025-01-22 17:35:04.049 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra picked up the apple.
2025-01-22 17:35:04.078 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5669, 5674) --> . Sandra picked up the
2025-01-22 17:35:04.078 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the hallway.
2025-01-22 17:35:04.083 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (975, 980) --> . Sandra moved to the
2025-01-22 17:35:04.083 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the garden.
2025-01-22 17:35:04.092 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1785, 1791) --> . Sandra went back to the
2025-01-22 17:35:04.092 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra left the apple.
2025-01-22 17:35:04.097 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (907, 911) -->  Sandra left the apple
2025-01-22 17:35:04.097 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary went back to the hallway.
2025-01-22 17:35:04.123 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4506, 4512) --> . Mary went back to the
2025-01-22 17:35:04.124 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 17:35:04.124 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 17:35:04.124 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 17:35:04.124 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ¤ğŸ¼', 'ğŸ¤¾ğŸ½\u200dâ™‚ï¸', 'ğŸ‘¨ğŸ¿\u200dğŸ¦½\u200dâ¡ï¸', 'ğŸ™ğŸ¾\u200dâ™€ï¸', 'ğŸ›‘', 'ğŸ§‘ğŸ¾\u200dğŸ¤\u200dğŸ§‘ğŸ»', 'ğŸ‘±ğŸ¿\u200dâ™‚ï¸', 'ğŸ‘¦', 'ğŸ¦¹ğŸ¼\u200dâ™‚ï¸', 'ğŸ§ğŸ½']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:05<00:16,  5.35s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.75s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.50s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.18s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.76s/it]
Processing depth (0, 3, 5, 6):   0%|          | 0/100 [01:07<?, ?it/s]2025-01-22 17:35:21.247 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel grabbed the football.
2025-01-22 17:35:21.289 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the hallway.
2025-01-22 17:35:21.307 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2977, 2982) -->  Daniel went to the hallway
2025-01-22 17:35:21.307 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 17:35:21.330 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4215, 4220) -->  Daniel moved to the office
2025-01-22 17:35:21.331 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra picked up the apple.
2025-01-22 17:35:21.357 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4782, 4787) -->  senate. Sandra picked up
2025-01-22 17:35:21.358 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the hallway.
2025-01-22 17:35:21.363 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1049, 1054) --> . Sandra moved to the
2025-01-22 17:35:21.363 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the garden.
2025-01-22 17:35:21.373 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1851, 1857) --> . Sandra went back to the
2025-01-22 17:35:21.373 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra left the apple.
2025-01-22 17:35:21.378 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (965, 969) -->  Sandra left the apple
2025-01-22 17:35:21.378 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary went back to the hallway.
2025-01-22 17:35:21.405 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4515, 4521) -->  Mary went back to the hallway
2025-01-22 17:35:21.405 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 17:35:21.405 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 17:35:21.405 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 17:35:21.405 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ•´ï¸', 'ğŸ‘©ğŸ¼\u200dâ¤ï¸\u200dğŸ‘©ğŸ¿', 'ğŸ›¬', 'ğŸ’', 'ğŸ‡µğŸ‡±', 'ğŸ¤´', 'ğŸ„ğŸ¾\u200dâ™‚', 'ğŸ‘©ğŸ¾\u200dğŸ¤\u200dğŸ‘¨ğŸ¼', 'ğŸ’ğŸ»\u200dâ™‚ï¸', 'ğŸ‘±ğŸ¼\u200dâ™‚']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:05<00:15,  5.16s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.88s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.56s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.14s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.75s/it]
Processing depth (1, 5, 7, 8):   0%|          | 0/100 [01:24<?, ?it/s]2025-01-22 17:35:38.719 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel grabbed the football.
2025-01-22 17:35:38.724 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (826, 830) -->  Daniel grabbed the football
2025-01-22 17:35:38.724 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the hallway.
2025-01-22 17:35:38.748 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4120, 4125) --> . Daniel went to the
2025-01-22 17:35:38.749 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 17:35:38.781 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5487, 5492) --> . Daniel moved to the
2025-01-22 17:35:38.781 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra picked up the apple.
2025-01-22 17:35:38.820 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6515, 6520) --> . Sandra picked up the
2025-01-22 17:35:38.820 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the hallway.
2025-01-22 17:35:38.825 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (985, 990) --> . Sandra moved to the
2025-01-22 17:35:38.826 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the garden.
2025-01-22 17:35:38.834 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1611, 1617) --> . Sandra went back to the
2025-01-22 17:35:38.834 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra left the apple.
2025-01-22 17:35:38.839 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (917, 921) -->  Sandra left the apple
2025-01-22 17:35:38.839 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary went back to the hallway.
2025-01-22 17:35:38.863 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4327, 4333) -->  Mary went back to the hallway
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:35:39.696 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's house.<|eot_id|>
2025-01-22 17:35:39.696 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8189])
2025-01-22 17:35:41.908 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [173.54934210526315, 20.511058807373047, 97.61011904761905, 19.95575855618253, 15.792578125], 'topk_indices': array([   9, 8188,  827,    1, 8176,  826, 8179, 8087,  273, 8177,  830,
          3, 7759,   14,   24,  829, 8187, 8185, 8184,    0]), 'topk_tokens': [':', '\n\n', ' grabbed', '<|start_header_id|>', ' football', ' Daniel', ' office', ' location', 'hue', ' before', '.', '<|end_header_id|>', 'inen', '\n', '\n\n', ' football', '<|end_header_id|>', '<|start_header_id|>', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [547.1875, 83.0375, 111.4875, 27.2125]}, 'weight': {'score': [22.61636513157895, 23.306304931640625, 23.949404761904763, 23.306256325134935, 29.9296875], 'topk_indices': array([3316, 3343, 3230, 3182, 7466, 7428, 1513, 1451, 4380, 4396, 5191,
       5252, 7149, 7205, 3519, 3545, 5016, 4968, 4993, 5045]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.591796875, 19.665625, 19.909375, 23.49375]}, 'saliency': {'score': [1.1950265984786184, 0.1143883764743805, 0.5893438430059523, 0.11064620387682854, 0.12096662521362304], 'topk_indices': array([8086, 7573, 8186, 8173, 8158,   99,  990, 8171, 8182,   24, 7758,
       8177, 8087, 8179,  827, 8176,  826, 7759,  273,  829]), 'topk_tokens': [' first', ' Min', 'assistant', ' Where', ' return', 'ION', ' hallway', 'Question', 'Answer', '\n\n', ' genu', ' before', ' location', ' office', ' grabbed', ' football', ' Daniel', 'inen', 'hue', ' football'], 'evidence_proportions': [4.2158203125, 0.4676025390625, 0.5408447265625, 0.15999755859375]}}, 'pred_res': "Daniel's house.<|eot_id|>", 'score': 0}
2025-01-22 17:35:41.926 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:35:41.927 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-56_pid-0_1-5-7-8.pkl | len: 3 |  size: 2.06 KB
Processing depth (1, 5, 7, 8):   1%|          | 1/100 [01:28<2:25:24, 88.12s/it]is_0k: False
your chose emoji: ['ğŸ§‘ğŸ¿\u200dâœˆï¸', 'ğŸŒ½', 'ğŸ’‡ğŸ¼\u200dâ™‚', 'ğŸ§œğŸ½\u200dâ™€', 'ğŸ¤µğŸ½\u200dâ™€ï¸', 'ğŸ§”\u200dâ™€', 'ğŸ§‘\u200dâš•ï¸', 'ğŸ§™ğŸ»\u200dâ™‚', 'ğŸ§”ğŸ¿\u200dâ™‚ï¸', 'ğŸ§ğŸ¼\u200dâ™‚ï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.36s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.82s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.93s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.43s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.93s/it]
Processing depth (0, 3, 7, 9):   1%|          | 1/100 [01:45<2:25:24, 88.12s/it]2025-01-22 17:35:59.461 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel grabbed the football.
2025-01-22 17:35:59.505 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the hallway.
2025-01-22 17:35:59.520 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2977, 2982) -->  tragedy. Daniel went to
2025-01-22 17:35:59.520 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 17:35:59.552 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5790, 5795) -->  Daniel moved to the office
2025-01-22 17:35:59.553 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra picked up the apple.
2025-01-22 17:35:59.588 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7150, 7155) -->  Sandra picked up the apple
2025-01-22 17:35:59.588 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the hallway.
2025-01-22 17:35:59.594 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1049, 1054) --> . Sandra moved to the
2025-01-22 17:35:59.594 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the garden.
2025-01-22 17:35:59.603 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1785, 1791) --> . Sandra went back to the
2025-01-22 17:35:59.603 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra left the apple.
2025-01-22 17:35:59.607 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (965, 969) -->  Sandra left the apple
2025-01-22 17:35:59.607 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary went back to the hallway.
2025-01-22 17:35:59.632 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4527, 4533) -->  Mary went back to the hallway
2025-01-22 17:35:59.633 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 17:35:59.633 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 17:35:59.633 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 17:35:59.633 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ§šğŸ¿\u200dâ™€', 'ğŸ‘©ğŸ¿\u200dâ¤\u200dğŸ’‹\u200dğŸ‘¨ğŸ¾', 'ğŸ¤', 'ğŸ’‚\u200dâ™€ï¸', 'ğŸ•µ\u200dâ™€ï¸', 'ğŸ§—ğŸ¾\u200dâ™‚ï¸', 'ğŸ™‹ğŸ¾\u200dâ™‚', 'ğŸ’‡ğŸ¾\u200dâ™€', 'ğŸ‘©ğŸ½\u200dğŸ³', 'ğŸ‘°ğŸ¾\u200dâ™€']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.21s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.00s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.26s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.99s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.42s/it]
Processing depth (1, 2, 4, 9):   1%|          | 1/100 [02:01<2:25:24, 88.12s/it]2025-01-22 17:36:15.417 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel grabbed the football.
2025-01-22 17:36:15.423 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (896, 900) -->  Daniel grabbed the football
2025-01-22 17:36:15.423 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the hallway.
2025-01-22 17:36:15.438 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1770, 1775) --> . Daniel went to the
2025-01-22 17:36:15.438 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 17:36:15.468 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3584, 3589) --> . Daniel moved to the
2025-01-22 17:36:15.469 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra picked up the apple.
2025-01-22 17:36:15.510 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7220, 7225) -->  Sandra picked up the apple
2025-01-22 17:36:15.510 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the hallway.
2025-01-22 17:36:15.516 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (989, 994) --> . Sandra moved to the
2025-01-22 17:36:15.516 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the garden.
2025-01-22 17:36:15.526 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1605, 1611) --> . Sandra went back to the
2025-01-22 17:36:15.526 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra left the apple.
2025-01-22 17:36:15.531 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (922, 926) -->  left the apple.
2025-01-22 17:36:15.531 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary went back to the hallway.
2025-01-22 17:36:15.562 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4453, 4459) -->  execution. Mary went back to
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:36:16.389 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's house.<|eot_id|>
2025-01-22 17:36:16.389 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8157])
2025-01-22 17:36:18.607 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [239.0, 21.06686963848039, 136.7217261904762, 20.257820197044335, 39.03871154785156], 'topk_indices': array([   3,  901,    9, 8045,  895,  903, 8144, 8145, 8153,   24, 8055,
         14,  897,  900, 8155,  896,  257,  899, 8152,    0]), 'topk_tokens': ['<|end_header_id|>', 'ï¿½', ':', '.\n\n', '.', 'ï¿½', ' football', ' before', '<|start_header_id|>', '\n\n', ' location', '\n', ' grabbed', '.', '<|end_header_id|>', ' Daniel', 'hue', ' football', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [703.6875, 122.3375, 187.575, 35.3375]}, 'weight': {'score': [23.82894736842105, 23.269343596813727, 22.126116071428573, 23.27099080203202, 29.229248046875], 'topk_indices': array([3304, 3331, 3172, 3220, 7404, 7442, 1449, 1511, 4321, 4305, 5204,
       5143, 7157, 7101, 3529, 3503, 4948, 4925, 4900, 4977]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.591796875, 19.665625, 19.909375, 28.1015625]}, 'saliency': {'score': [1.6374929327713816, 0.11852802201813342, 0.7236458914620536, 0.11340883377150361, 0.29939138889312744], 'topk_indices': array([8045, 1775, 8126, 8011,    8, 8150,  902, 8054,  908,  903,   24,
       8145,  994, 8144,  901, 8055,  897,  896,  899,  257]), 'topk_tokens': ['.\n\n', ' hallway', ' return', ' context', ' Date', 'Answer', 'ï¿½', ' first', 'ï¿½', 'ï¿½', '\n\n', ' before', ' hallway', ' football', 'ï¿½', ' location', ' grabbed', ' Daniel', ' football', 'hue'], 'evidence_proportions': [5.5009765625, 0.63076171875, 0.9330078125, 0.25792236328125]}}, 'pred_res': "Daniel's house.<|eot_id|>", 'score': 0}
2025-01-22 17:36:18.631 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:36:18.631 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-56_pid-1_1-2-4-9.pkl | len: 3 |  size: 2.03 KB
Processing depth (1, 2, 4, 9):   2%|â–         | 2/100 [02:04<1:34:31, 57.88s/it]is_0k: False
your chose emoji: ['ğŸš£ğŸ¾', 'ğŸ•µğŸ¼\u200dâ™‚ï¸', '\U0001fac3ğŸ¿', 'ğŸªŸ', 'ğŸ’†ğŸ¼\u200dâ™‚', 'ğŸ‘©ğŸ¿\u200dğŸš’', 'ğŸ§‘\u200dğŸ§’', 'ğŸ’³', 'ğŸ‡²ğŸ‡³', 'ğŸ™…\u200dâ™€ï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.81s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:10,  5.03s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.74s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.28s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.86s/it]
Processing depth (0, 4, 7, 8):   2%|â–         | 2/100 [02:22<1:34:31, 57.88s/it]2025-01-22 17:36:35.968 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel grabbed the football.
2025-01-22 17:36:36.010 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the hallway.
2025-01-22 17:36:36.031 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3570, 3575) --> . Daniel went to the
2025-01-22 17:36:36.031 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 17:36:36.066 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5597, 5602) --> . Daniel moved to the
2025-01-22 17:36:36.066 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra picked up the apple.
2025-01-22 17:36:36.103 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6511, 6516) --> . Sandra picked up the
2025-01-22 17:36:36.103 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the hallway.
2025-01-22 17:36:36.108 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (999, 1004) --> . Sandra moved to the
2025-01-22 17:36:36.108 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the garden.
2025-01-22 17:36:36.119 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1809, 1815) --> . Sandra went back to the
2025-01-22 17:36:36.119 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra left the apple.
2025-01-22 17:36:36.124 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (931, 935) -->  Sandra left the apple
2025-01-22 17:36:36.125 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary went back to the hallway.
2025-01-22 17:36:36.150 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4382, 4388) --> . Mary went back to the
2025-01-22 17:36:36.151 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 17:36:36.151 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 17:36:36.151 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 17:36:36.151 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ‘¨ğŸ»\u200dâ¤\u200dğŸ‘¨ğŸ»', 'â™€ï¸', 'ğŸ‘’', 'ğŸ§‘ğŸ¼\u200dâ¤\u200dğŸ’‹\u200dğŸ§‘ğŸ½', 'ğŸŒ…', 'ğŸ§—ğŸ½\u200dâ™€', 'ğŸ§Ÿ\u200dâ™‚', 'ğŸ—ƒï¸', 'ğŸ‘©ğŸ¼\u200dâœˆ', 'ğŸ§‘ğŸ½\u200dğŸ¦²']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.28s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:09,  4.53s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.59s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.24s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.70s/it]
Processing depth (0, 1, 3, 7):   2%|â–         | 2/100 [02:39<1:34:31, 57.88s/it]2025-01-22 17:36:53.400 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel grabbed the football.
2025-01-22 17:36:53.444 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the hallway.
2025-01-22 17:36:53.448 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (778, 783) --> . Daniel went to the
2025-01-22 17:36:53.449 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 17:36:53.465 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2898, 2903) --> . Daniel moved to the
2025-01-22 17:36:53.465 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra picked up the apple.
2025-01-22 17:36:53.495 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5630, 5635) -->  Sandra picked up the apple
2025-01-22 17:36:53.495 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the hallway.
2025-01-22 17:36:53.499 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (933, 938) --> . Sandra moved to the
2025-01-22 17:36:53.500 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the garden.
2025-01-22 17:36:53.509 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1599, 1605) --> . Sandra went back to the
2025-01-22 17:36:53.509 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra left the apple.
2025-01-22 17:36:53.513 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (843, 847) -->  Sandra left the apple
2025-01-22 17:36:53.513 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary went back to the hallway.
2025-01-22 17:36:53.540 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4521, 4527) -->  Mary went back to the hallway
2025-01-22 17:36:53.540 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 17:36:53.540 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 17:36:53.540 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 17:36:53.540 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ‡¿ğŸ‡²', 'ğŸ§ğŸ¾\u200dâ™‚\u200dâ¡ï¸', 'ğŸš¶ğŸ»\u200dâ™€\u200dâ¡', 'ğŸ™…ğŸ¿\u200dâ™€', '\U0001faf4', 'ğŸ˜‹', 'ğŸš¶ğŸ¿\u200dâ™‚', 'ğŸ§‘\u200dğŸ¦¯', 'ğŸ‰', 'ğŸŸ ']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.29s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.48s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.45s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.10s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.59s/it]
Processing depth (2, 3, 4, 9):   2%|â–         | 2/100 [02:56<1:34:31, 57.88s/it]2025-01-22 17:37:09.980 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel grabbed the football.
2025-01-22 17:37:09.991 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1802, 1806) -->  Daniel grabbed the football
2025-01-22 17:37:09.991 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the hallway.
2025-01-22 17:37:10.006 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2934, 2939) --> . Daniel went to the
2025-01-22 17:37:10.006 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 17:37:10.024 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3636, 3641) --> . Daniel moved to the
2025-01-22 17:37:10.025 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra picked up the apple.
2025-01-22 17:37:10.063 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7313, 7318) --> . Sandra picked up the
2025-01-22 17:37:10.063 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the hallway.
2025-01-22 17:37:10.068 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (920, 925) --> . Sandra moved to the
2025-01-22 17:37:10.068 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the garden.
2025-01-22 17:37:10.078 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1732, 1738) --> . Sandra went back to the
2025-01-22 17:37:10.078 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra left the apple.
2025-01-22 17:37:10.082 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (830, 834) -->  Sandra left the apple
2025-01-22 17:37:10.082 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary went back to the hallway.
2025-01-22 17:37:10.110 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4466, 4472) --> . Mary went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:37:10.886 | INFO     | test_jbb_embedding:begin_test:693 - The hallway.<|eot_id|>
2025-01-22 17:37:10.886 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8155])
2025-01-22 17:37:13.095 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [108.88322368421052, 12.69900902488355, 66.01822916666667, 12.335963483924612, 7.695172991071429], 'topk_indices': array([8043, 8124, 8143,    3,    9, 8053, 8149, 2671, 2655, 8154,   23,
          1, 2600, 8009,   24, 2674,   14, 8153,    0, 8150]), 'topk_tokens': ['.\n\n', ' return', ' before', '<|end_header_id|>', ':', ' location', ':', 'as', ',', '\n\n', '4', '<|start_header_id|>', 'ared', ' context', '\n\n', ' ne', '\n', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [192.40625, 104.175, 142.8625, 12.79375]}, 'weight': {'score': [22.61636513157895, 23.265360688894337, 22.49813988095238, 23.268864329268293, 29.06597222222222], 'topk_indices': array([3274, 3301, 3146, 3194, 7374, 7336, 1492, 1430, 4271, 4287, 5156,
       5095, 7051, 7107, 3483, 3457, 4943, 4891, 4914, 4866]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.591796875, 19.665625, 19.909375, 23.49375]}, 'saliency': {'score': [0.650286222759046, 0.07026522356553766, 0.39204552060081843, 0.06807530175937634, 0.05608367919921875], 'topk_indices': array([8127,    8,   23,   24,   20, 2581, 8143, 2656, 8124, 8142, 8148,
       2599, 1805,  925, 8053, 2582, 2939, 2600, 8009, 2674]), 'topk_tokens': [' directly', ' Date', '4', '\n\n', ' Jul', ' mess', ' before', ' mess', ' return', ' football', 'Answer', ' ne', ' football', ' hallway', ' location', 'engers', ' hallway', 'ared', ' context', ' ne'], 'evidence_proportions': [1.476806640625, 0.501904296875, 0.70947265625, 0.078265380859375]}}, 'pred_res': 'The hallway.<|eot_id|>', 'score': 100}
2025-01-22 17:37:13.101 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:37:13.101 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-56_pid-2_2-3-4-9.pkl | len: 3 |  size: 2.01 KB
Processing depth (2, 3, 4, 9):   3%|â–         | 3/100 [02:59<1:31:03, 56.32s/it]is_0k: False
your chose emoji: ['ğŸ§œ\u200dâ™‚ï¸', 'ğŸ‘¨ğŸ¼\u200dğŸ­', 'ğŸ¦¹\u200dâ™€ï¸', 'ğŸ›’', 'ğŸ‘©ğŸ»\u200dğŸ¤\u200dğŸ‘¨ğŸ¿', 'ğŸ©²', 'âš™', 'ğŸ§š\u200dâ™€', 'ğŸ¤Ÿ', 'ğŸ‘‡ğŸ¾']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.16s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:10,  5.05s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.92s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.45s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.95s/it]
Processing depth (1, 5, 6, 7):   3%|â–         | 3/100 [03:16<1:31:03, 56.32s/it]2025-01-22 17:37:30.666 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel grabbed the football.
2025-01-22 17:37:30.670 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (896, 900) -->  Daniel grabbed the football
2025-01-22 17:37:30.671 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the hallway.
2025-01-22 17:37:30.697 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4227, 4232) -->  Daniel went to the hallway
2025-01-22 17:37:30.697 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 17:37:30.723 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4808, 4813) -->  Daniel moved to the office
2025-01-22 17:37:30.723 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra picked up the apple.
2025-01-22 17:37:30.753 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5703, 5708) --> . Sandra picked up the
2025-01-22 17:37:30.753 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the hallway.
2025-01-22 17:37:30.759 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1049, 1054) --> . Sandra moved to the
2025-01-22 17:37:30.760 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the garden.
2025-01-22 17:37:30.771 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1851, 1857) --> . Sandra went back to the
2025-01-22 17:37:30.771 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra left the apple.
2025-01-22 17:37:30.777 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (965, 969) -->  Sandra left the apple
2025-01-22 17:37:30.777 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary went back to the hallway.
2025-01-22 17:37:30.807 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4527, 4533) -->  Mary went back to the hallway
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:37:31.652 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's house.<|eot_id|>
2025-01-22 17:37:31.652 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8207])
2025-01-22 17:37:33.897 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [322.30592105263156, 25.46523104445798, 151.70684523809524, 24.450415009179927, 16.01847787921348], 'topk_indices': array([8060, 8095,    3, 8197,  928,  897, 8195,  900,   14, 8194, 8105,
       8205, 8061,   24, 8203,  257,  896,  899, 8202,    0]), 'topk_tokens': [' you', '.\n\n', '<|end_header_id|>', ' office', 'de', ' grabbed', ' before', '.', '\n', ' football', ' location', '<|end_header_id|>', ' context', '\n\n', '<|start_header_id|>', 'hue', ' Daniel', ' football', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [706.125, 232.925, 372.3, 54.6375]}, 'weight': {'score': [25.27672697368421, 23.32049330085262, 23.949404761904763, 23.314327379130965, 29.91432584269663], 'topk_indices': array([3275, 3248, 3168, 3120, 7498, 7460, 1477, 1415, 4295, 4279, 5248,
       5187, 7181, 7237, 3431, 3457, 5041, 5012, 4989, 4964]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.591796875, 25.7609375, 23.9234375, 23.49375]}, 'saliency': {'score': [2.2995541221217106, 0.142984733628007, 0.8980945405505952, 0.13602853725998318, 0.1187629271089361], 'topk_indices': array([8095, 8176, 8200, 8060, 8104, 8189,   24,  928, 4812, 4231, 8197,
       8195, 1054, 8105,  897, 8061, 8194,  257,  896,  899]), 'topk_tokens': ['.\n\n', ' return', 'Answer', ' you', ' first', 'Question', '\n\n', 'de', ' office', ' hallway', ' office', ' before', ' hallway', ' location', ' grabbed', ' context', ' football', 'hue', ' Daniel', ' football'], 'evidence_proportions': [5.5, 1.71455078125, 2.28076171875, 0.3429931640625]}}, 'pred_res': "Daniel's house.<|eot_id|>", 'score': 0}
2025-01-22 17:37:33.902 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:37:33.902 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-56_pid-3_1-5-6-7.pkl | len: 3 |  size: 2.05 KB
Processing depth (1, 5, 6, 7):   4%|â–         | 4/100 [03:20<1:07:40, 42.30s/it]is_0k: False
your chose emoji: ['ğŸŒˆ', 'ğŸ‘·ğŸ¾\u200dâ™€', 'ğŸš£ğŸ¿\u200dâ™€ï¸', 'â›±ï¸', 'ğŸ‘©ğŸ¿\u200dğŸ¦¼\u200dâ¡', 'ğŸš¶ğŸ»\u200dâ™€ï¸\u200dâ¡ï¸', 'ğŸ‘¨ğŸ¿\u200dâ¤ï¸\u200dğŸ‘¨ğŸ½', '\U0001faf1ğŸ½\u200d\U0001faf2ğŸ¼', 'â›¹ï¸\u200dâ™‚', 'ğŸŒ¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.25s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.76s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.88s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.35s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.85s/it]
Processing depth (3, 4, 5, 8):   4%|â–         | 4/100 [03:37<1:07:40, 42.30s/it]2025-01-22 17:37:51.499 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel grabbed the football.
2025-01-22 17:37:51.516 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2880, 2884) -->  Daniel grabbed the football
2025-01-22 17:37:51.516 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the hallway.
2025-01-22 17:37:51.534 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3608, 3613) --> . Daniel went to the
2025-01-22 17:37:51.534 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 17:37:51.566 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4207, 4212) -->  Daniel moved to the office
2025-01-22 17:37:51.566 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra picked up the apple.
2025-01-22 17:37:51.604 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6543, 6548) --> . Sandra picked up the
2025-01-22 17:37:51.605 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the hallway.
2025-01-22 17:37:51.610 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (976, 981) --> . Sandra moved to the
2025-01-22 17:37:51.610 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the garden.
2025-01-22 17:37:51.619 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1732, 1738) --> . Sandra went back to the
2025-01-22 17:37:51.619 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra left the apple.
2025-01-22 17:37:51.624 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (908, 912) -->  Sandra left the apple
2025-01-22 17:37:51.624 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary went back to the hallway.
2025-01-22 17:37:51.651 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4478, 4484) --> . Mary went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:37:52.469 | INFO     | test_jbb_embedding:begin_test:693 - The hallway.<|eot_id|>
2025-01-22 17:37:52.469 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8177])
2025-01-22 17:37:54.687 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [110.77097039473684, 13.634423708740831, 87.32068452380952, 13.217592521498771, 12.47633815456081], 'topk_indices': array([8065,    4, 8030, 8146, 8167, 8150,  981,   23, 8171, 8165, 8176,
          1, 8031, 3613,   24,   14,    3, 8175,    0, 8172]), 'topk_tokens': ['.\n\n', '\n\n', ' you', ' return', ' office', '.', ' hallway', '4', ':', ' before', '\n\n', '<|start_header_id|>', ' context', ' hallway', '\n\n', '\n', '<|end_header_id|>', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [176.765625, 148.25, 116.0875, 15.1796875]}, 'weight': {'score': [23.67269736842105, 23.2906211797066, 22.49813988095238, 23.291773840601966, 29.59987331081081], 'topk_indices': array([3292, 3319, 3194, 3146, 7432, 7470, 1492, 1430, 4299, 4283, 5101,
       5162, 7209, 7153, 3475, 3501, 4926, 4955, 4878, 4903]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.591796875, 19.665625, 23.9234375, 23.49375]}, 'saliency': {'score': [0.685071443256579, 0.07541606875095508, 0.5066513788132441, 0.07288051670833653, 0.09350761207374367], 'topk_indices': array([8174, 8161, 8030,   20, 8176,   23, 8159, 8149,    8, 2883, 8075,
       8146, 8170,   24, 8164, 8167, 8165, 8031,  981, 3613]), 'topk_tokens': ['assistant', ' Where', ' you', ' Jul', '\n\n', '4', 'Question', ' directly', ' Date', ' football', ' location', ' return', 'Answer', '\n\n', ' football', ' office', ' before', ' context', ' hallway', ' hallway'], 'evidence_proportions': [1.35003662109375, 0.728173828125, 0.7019287109375, 0.0931396484375]}}, 'pred_res': 'The hallway.<|eot_id|>', 'score': 100}
2025-01-22 17:37:54.712 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:37:54.714 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-56_pid-4_3-4-5-8.pkl | len: 3 |  size: 2.03 KB
Processing depth (3, 4, 5, 8):   5%|â–Œ         | 5/100 [03:40<54:42, 34.55s/it]  Processing depth (3, 4, 5, 8):   5%|â–Œ         | 5/100 [03:40<1:09:58, 44.20s/it]
2025-01-22 17:37:54.804 | INFO     | __main__:<module>:82 - Selected idx: 58
2025-01-22 17:37:54.804 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the apple before the bedroom? 
2025-01-22 17:37:54.804 | INFO     | __main__:<module>:84 - Answer: office
2025-01-22 17:37:54.804 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 17:37:54.804 | INFO     | __main__:<module>:86 - Needle: [' Daniel picked up the apple.', ' Sandra moved to the hallway.', ' Mary went back to the hallway.', ' Sandra went back to the garden.', ' John went back to the hallway.', ' Daniel moved to the office.', ' Sandra left the apple.', ' Sandra picked up the apple.', ' Sandra picked up the apple.', ' Daniel went back to the bedroom.', ' Sandra dropped the apple.']
2025-01-22 17:37:54.804 | INFO     | __main__:<module>:87 - Real Needle: [' Daniel picked up the apple.', ' Daniel moved to the office.', ' Daniel went back to the bedroom.', ' Sandra dropped the apple.']
2025-01-22 17:37:54.804 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ§‘ğŸ½\u200dğŸ¦°', 'â›‘ï¸', 'ğŸ§‘ğŸ½\u200dâ¤\u200dğŸ§‘ğŸ¿', 'âœŒğŸ¾', 'ğŸ„ğŸ»\u200dâ™€ï¸', 'ğŸ¤µğŸ½\u200dâ™‚ï¸', 'ğŸ‘©ğŸ¼', 'ğŸ§‘ğŸ»\u200dâš–', '\U0001fae7', 'â™ ï¸']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.34s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:09,  4.51s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.38s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.10s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.58s/it]
Processing depth (1, 2, 4, 9):   0%|          | 0/100 [00:16<?, ?it/s]2025-01-22 17:38:11.131 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the apple.
2025-01-22 17:38:11.135 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (822, 827) --> . Daniel picked up the
2025-01-22 17:38:11.136 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the office.
2025-01-22 17:38:11.145 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1786, 1791) --> . Daniel moved to the
2025-01-22 17:38:11.145 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the bedroom.
2025-01-22 17:38:11.163 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3630, 3636) -->  Daniel went back to the bedroom
2025-01-22 17:38:11.163 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra dropped the apple.
2025-01-22 17:38:11.200 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7148, 7152) -->  dropped the apple.
2025-01-22 17:38:11.200 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the hallway.
2025-01-22 17:38:11.228 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5213, 5218) --> . Sandra moved to the
2025-01-22 17:38:11.228 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went back to the hallway.
2025-01-22 17:38:11.229 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (106, 112) -->  John went back to the hallway
2025-01-22 17:38:11.229 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the garden.
2025-01-22 17:38:11.251 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3832, 3838) --> . Sandra went back to the
2025-01-22 17:38:11.251 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the hallway.
2025-01-22 17:38:11.252 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (105, 111) --> . John went back to the
2025-01-22 17:38:11.252 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra left the apple.
2025-01-22 17:38:11.286 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6746, 6750) -->  Sandra left the apple
2025-01-22 17:38:11.286 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra picked up the apple.
2025-01-22 17:38:11.291 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (823, 828) -->  Daniel picked up the apple
2025-01-22 17:38:11.291 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Sandra picked up the apple.
2025-01-22 17:38:11.296 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (823, 828) -->  Daniel picked up the apple
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:38:12.103 | INFO     | test_jbb_embedding:begin_test:693 - The hallway.<|eot_id|>
2025-01-22 17:38:12.103 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8185])
2025-01-22 17:38:14.358 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [440.7875, 39.09257435568584, 383.61655405405406, 36.53645064575646, 42.107795266544116], 'topk_indices': array([ 824, 3636, 1605, 8168, 8184, 3104,  111,    3, 1790, 8175, 8173,
       1788,    1,   23,   14,   24, 8183, 8181,    0, 8180]), 'topk_tokens': [' picked', '.', ' time', ':', '\n\n', ' hallway', ' hallway', '<|end_header_id|>', ' the', ' bedroom', ' before', ' moved', '<|start_header_id|>', '4', '\n', '\n\n', '<|end_header_id|>', '<|start_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [518.55, 749.9, 337.0, 112.875]}, 'weight': {'score': [22.397265625, 23.279007496641015, 24.033361486486488, 23.27774350399754, 29.351332720588236], 'topk_indices': array([3288, 3261, 3181, 3133, 7436, 7474, 1484, 1422, 4300, 4284, 5180,
       5119, 7213, 7157, 3470, 3444, 4973, 4921, 4896, 4944]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.3625, 19.909375, 25.44921875, 20.97265625]}, 'saliency': {'score': [2.5484619140625, 0.2166171168850006, 2.523331925675676, 0.2003827572455412, 0.3096899144789752], 'topk_indices': array([  16, 8167,   20, 8178, 1791, 1787, 8172,   23, 8169, 7260,  823,
       8173,  827,  824,   24, 3635, 1788, 3104, 8175,  111]), 'topk_tokens': [' Date', 'Question', ' Jul', 'Answer', ' office', ' Daniel', ' apple', '4', ' Where', ' adher', ' Daniel', ' before', ' apple', ' picked', '\n\n', ' bedroom', ' moved', ' hallway', ' bedroom', ' hallway'], 'evidence_proportions': [3.15927734375, 3.8197265625, 2.3126627604166665, 0.549560546875]}}, 'pred_res': 'The hallway.<|eot_id|>', 'score': 0}
2025-01-22 17:38:14.365 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:38:14.366 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-58_pid-0_1-2-4-9.pkl | len: 3 |  size: 2.04 KB
Processing depth (1, 2, 4, 9):   1%|          | 1/100 [00:19<32:04, 19.44s/it]is_0k: False
your chose emoji: ['ğŸ¿', 'ğŸ¦²', 'ğŸ‘»', 'ğŸ›¬', 'â™', 'ğŸ§ğŸ½\u200dâ™‚\u200dâ¡', 'ğŸ‘¨\u200dğŸ’¼', 'ğŸ‘©ğŸ¼\u200dâ¤\u200dğŸ‘©ğŸ»', 'ğŸ‘©ğŸ»\u200dğŸ¤\u200dğŸ‘¨ğŸ¾', 'ğŸˆ·ï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.93s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.99s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.66s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.21s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.81s/it]
Processing depth (3, 4, 6, 8):   1%|          | 1/100 [00:37<32:04, 19.44s/it]2025-01-22 17:38:32.045 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the apple.
2025-01-22 17:38:32.060 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2967, 2972) -->  tragedy. Daniel picked up
2025-01-22 17:38:32.060 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the office.
2025-01-22 17:38:32.079 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3723, 3728) --> . Daniel moved to the
2025-01-22 17:38:32.079 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the bedroom.
2025-01-22 17:38:32.104 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4739, 4745) -->  Daniel went back to the bedroom
2025-01-22 17:38:32.104 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra dropped the apple.
2025-01-22 17:38:32.142 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6556, 6560) -->  Sandra dropped the apple
2025-01-22 17:38:32.142 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the hallway.
2025-01-22 17:38:32.168 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5237, 5242) --> . Sandra moved to the
2025-01-22 17:38:32.168 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went back to the hallway.
2025-01-22 17:38:32.168 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (106, 112) -->  John went back to the hallway
2025-01-22 17:38:32.169 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the garden.
2025-01-22 17:38:32.188 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3853, 3859) --> . Sandra went back to the
2025-01-22 17:38:32.188 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the hallway.
2025-01-22 17:38:32.189 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (105, 111) --> . John went back to the
2025-01-22 17:38:32.189 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra left the apple.
2025-01-22 17:38:32.224 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6839, 6843) -->  Sandra left the apple
2025-01-22 17:38:32.224 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra picked up the apple.
2025-01-22 17:38:32.242 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (2969, 2974) -->  Daniel picked up the apple
2025-01-22 17:38:32.242 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Sandra picked up the apple.
2025-01-22 17:38:32.257 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (2969, 2974) -->  Daniel picked up the apple
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:38:33.065 | INFO     | test_jbb_embedding:begin_test:693 - The hallway.<|eot_id|>
2025-01-22 17:38:33.065 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8219])
2025-01-22 17:38:35.312 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [471.125, 45.622388547621945, 501.4256756756757, 42.51425848236159, 45.50542279411765], 'topk_indices': array([3728, 8215, 3727, 8207,  105, 8107,    1, 3853, 5242, 8213, 8218,
          9, 8209,   23,   24,   14, 3854, 8217,    0, 8214]), 'topk_tokens': [' office', '<|start_header_id|>', ' the', ' before', '.', '.\n\n', '<|start_header_id|>', '.', ' hallway', ':', '\n\n', ':', ' bedroom', '4', '\n\n', '\n', ' Sandra', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [472.7, 696.15, 449.5833333333333, 220.1875]}, 'weight': {'score': [25.354296875, 23.322879287799537, 24.033361486486488, 23.314682791829984, 30.25845588235294], 'topk_indices': array([3284, 3257, 3122, 3170, 7446, 7484, 1468, 1406, 4301, 4285, 5204,
       5143, 7223, 7167, 3440, 3466, 4920, 4968, 4997, 4945]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.1703125, 19.909375, 25.44921875, 28.498046875]}, 'saliency': {'score': [2.897119140625, 0.2571184172013745, 3.2886402027027026, 0.23691186152621263, 0.3452963436351103], 'topk_indices': array([8188,  111, 8216,   20, 8201, 8212,  107, 8207, 3725,   23, 2969,
         24, 3728, 3196, 5238,    0, 4744, 5242, 8209, 3854]), 'topk_tokens': [' return', ' hallway', 'assistant', ' Jul', 'Question', 'Answer', ' went', ' before', ' moved', '4', ' Daniel', '\n\n', ' office', ' hallway', ' Sandra', '<|begin_of_text|>', ' bedroom', ' hallway', ' bedroom', ' Sandra'], 'evidence_proportions': [3.147265625, 3.4775390625, 3.1142578125, 1.533203125]}}, 'pred_res': 'The hallway.<|eot_id|>', 'score': 0}
2025-01-22 17:38:35.318 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:38:35.319 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-58_pid-1_3-4-6-8.pkl | len: 3 |  size: 2.03 KB
Processing depth (3, 4, 6, 8):   2%|â–         | 2/100 [00:40<33:12, 20.33s/it]is_0k: False
your chose emoji: ['ğŸ§™\u200dâ™€ï¸', 'ğŸ¥', 'ğŸ‘©\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘©', 'ğŸ™‚\u200dâ†”', 'ğŸ¤ŒğŸ¼', 'ğŸ’‚ğŸ¾\u200dâ™€', 'ğŸ‘©ğŸ»\u200dğŸ¤\u200dğŸ‘©ğŸ½', 'ğŸ˜£', 'ğŸ™…ğŸ»\u200dâ™‚ï¸', 'ğŸ‘©ğŸ½\u200dâ¤ï¸\u200dğŸ‘¨ğŸ¾']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.66s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.77s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.25s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.76s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.41s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (3, 5, 8, 9):   2%|â–         | 2/100 [00:55<33:12, 20.33s/it]2025-01-22 17:38:50.828 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the apple.
2025-01-22 17:38:50.848 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2973, 2978) -->  tragedy. Daniel picked up
2025-01-22 17:38:50.849 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the office.
2025-01-22 17:38:50.871 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4227, 4232) -->  Daniel moved to the office
2025-01-22 17:38:50.872 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the bedroom.
2025-01-22 17:38:50.910 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6620, 6626) --> . Daniel went back to the
2025-01-22 17:38:50.910 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra dropped the apple.
2025-01-22 17:38:50.950 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7263, 7267) -->  Sandra dropped the apple
2025-01-22 17:38:50.950 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the hallway.
2025-01-22 17:38:50.976 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5319, 5324) -->  Sandra moved to the hallway
2025-01-22 17:38:50.977 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went back to the hallway.
2025-01-22 17:38:50.977 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (106, 112) -->  John went back to the hallway
2025-01-22 17:38:50.977 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the garden.
2025-01-22 17:38:51.000 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3847, 3853) --> . Sandra went back to the
2025-01-22 17:38:51.000 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the hallway.
2025-01-22 17:38:51.001 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (105, 111) --> . John went back to the
2025-01-22 17:38:51.001 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra left the apple.
2025-01-22 17:38:51.034 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6904, 6908) -->  Sandra left the apple
2025-01-22 17:38:51.035 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra picked up the apple.
2025-01-22 17:38:51.049 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (2975, 2980) -->  Daniel picked up the apple
2025-01-22 17:38:51.049 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Sandra picked up the apple.
2025-01-22 17:38:51.065 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (2975, 2980) -->  Daniel picked up the apple
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:38:55.546 | INFO     | test_jbb_embedding:begin_test:693 - The hallway.<|eot_id|>
2025-01-22 17:38:55.546 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8191])
2025-01-22 17:38:58.658 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [894.271875, 62.543447912852436, 831.1824324324324, 57.00335315265487, 78.45048415492958], 'topk_indices': array([8175,   24, 4226, 8178, 8173, 8189, 8174,   14, 8179, 5319, 4230,
       4228, 4229, 4231, 5320, 5321,    0, 5322, 8187, 8186]), 'topk_tokens': [' Where', '\n\n', '!"', ' apple', 'Question', '<|end_header_id|>', ':', '\n', ' before', ' Sandra', ' the', ' moved', ' to', ' office', ' moved', ' to', '<|begin_of_text|>', ' the', '<|start_header_id|>', '<|eot_id|>'], 'evidence_proportions': [552.4125, 2456.6, 375.125, 147.40625]}, 'weight': {'score': [25.001171875, 23.290263029415353, 24.857052364864863, 23.278931984390365, 29.744058098591548], 'topk_indices': array([3290, 3263, 3176, 3128, 7420, 7382, 1424, 1486, 4279, 4295, 5169,
       5108, 7092, 7148, 3472, 3446, 4962, 4885, 4933, 4910]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.1703125, 23.9234375, 20.927083333333332, 28.498046875]}, 'saliency': {'score': [5.241845703125, 0.34828476386091783, 5.149730785472973, 0.314419876743793, 0.6013114821742958], 'topk_indices': array([6626, 5317, 5315, 2979, 3848,    0, 4229, 8175, 4226, 4227, 8181,
       8178, 8179, 8173, 5322, 5321, 5319, 4228, 4231, 5320]), 'topk_tokens': [' bedroom', 'ï¿½', 'ï¿½', ' apple', ' Sandra', '<|begin_of_text|>', ' to', ' Where', '!"', ' Daniel', ' bedroom', ' apple', ' before', 'Question', ' the', ' to', ' Sandra', ' moved', ' office', ' moved'], 'evidence_proportions': [3.6970703125, 14.06171875, 2.0245768229166665, 0.973876953125]}}, 'pred_res': 'The hallway.<|eot_id|>', 'score': 0}
2025-01-22 17:38:58.664 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:38:58.665 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-58_pid-2_3-5-8-9.pkl | len: 3 |  size: 2.02 KB
Processing depth (3, 5, 8, 9):   3%|â–         | 3/100 [01:03<35:05, 21.71s/it]is_0k: False
your chose emoji: ['ğŸ¦³', 'âœ´', 'âœŒğŸ½', 'ğŸ§‘ğŸ»\u200dğŸ’»', '\U0001fae9', 'ğŸ™†\u200dâ™‚ï¸', 'ğŸ•µğŸ¾\u200dâ™‚', 'ğŸ’‰', 'ğŸ§‘ğŸ¿\u200dâ¤ï¸\u200dğŸ§‘ğŸ¼', 'ğŸ§‘ğŸ»\u200dâ¤\u200dğŸ§‘ğŸ½']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.63s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.37s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.28s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.07s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.55s/it]
Processing depth (2, 7, 8, 9):   3%|â–         | 3/100 [01:19<35:05, 21.71s/it]2025-01-22 17:39:14.782 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the apple.
2025-01-22 17:39:14.793 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1860, 1865) --> . Daniel picked up the
2025-01-22 17:39:14.794 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the office.
2025-01-22 17:39:14.824 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5752, 5757) --> . Daniel moved to the
2025-01-22 17:39:14.824 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the bedroom.
2025-01-22 17:39:14.863 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6638, 6644) --> . Daniel went back to the
2025-01-22 17:39:14.863 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra dropped the apple.
2025-01-22 17:39:14.907 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7287, 7291) -->  Sandra dropped the apple
2025-01-22 17:39:14.908 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the hallway.
2025-01-22 17:39:14.939 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5410, 5415) --> . Sandra moved to the
2025-01-22 17:39:14.939 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went back to the hallway.
2025-01-22 17:39:14.939 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (106, 112) -->  John went back to the hallway
2025-01-22 17:39:14.940 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the garden.
2025-01-22 17:39:14.960 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3859, 3865) --> . Sandra went back to the
2025-01-22 17:39:14.960 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the hallway.
2025-01-22 17:39:14.961 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (105, 111) --> . John went back to the
2025-01-22 17:39:14.961 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra left the apple.
2025-01-22 17:39:14.995 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6926, 6930) -->  Sandra left the apple
2025-01-22 17:39:14.996 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra picked up the apple.
2025-01-22 17:39:15.005 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (1861, 1866) -->  Daniel picked up the apple
2025-01-22 17:39:15.007 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Sandra picked up the apple.
2025-01-22 17:39:15.019 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (1861, 1866) -->  Daniel picked up the apple
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:39:15.830 | INFO     | test_jbb_embedding:begin_test:693 - The hallway.<|eot_id|>
2025-01-22 17:39:15.830 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8223])
2025-01-22 17:39:18.067 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [369.078125, 45.44914133738602, 385.7905405405405, 43.11500673359451, 29.707749640804597], 'topk_indices': array([8077, 8121, 5757, 8210,    1, 8213,    4, 8072,   23, 8111, 8205,
       8206, 8211,    9,   24, 8221,   14,    0, 8219, 8218]), 'topk_tokens': [' context', ' location', ' office', ' apple', '<|start_header_id|>', ' bedroom', '\n\n', '\n', '4', '.\n\n', 'Question', ':', ' before', ':', '\n\n', '<|end_header_id|>', '\n', '<|begin_of_text|>', '<|start_header_id|>', '<|eot_id|>'], 'evidence_proportions': [490.2, 499.95, 302.1875, 154.421875]}, 'weight': {'score': [22.545703125, 23.31432940729483, 24.033361486486488, 23.312954326334477, 29.694863505747126], 'topk_indices': array([3263, 3290, 3176, 3128, 7464, 7502, 1486, 1424, 4249, 4265, 5114,
       5175, 7236, 7180, 3472, 3446, 4939, 4916, 4891, 4968]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.3625, 19.909375, 20.927083333333332, 28.498046875]}, 'saliency': {'score': [2.13614501953125, 0.25154575892857145, 2.5443676097972974, 0.23654497615504103, 0.21825996486619972], 'topk_indices': array([1865,   23, 8192, 8207,    9, 5753,    8, 8111, 3860, 8121, 8077,
       1861, 5757, 6644, 5415,   24, 8210, 8211, 8213, 8205]), 'topk_tokens': [' apple', '4', ' return', ' Where', ':', ' Daniel', ' Date', '.\n\n', ' Sandra', ' location', ' context', ' Daniel', ' office', ' bedroom', ' hallway', '\n\n', ' apple', ' before', ' bedroom', 'Question'], 'evidence_proportions': [3.0146484375, 2.7197265625, 1.6451822916666667, 1.04498291015625]}}, 'pred_res': 'The hallway.<|eot_id|>', 'score': 0}
2025-01-22 17:39:18.073 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:39:18.074 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-58_pid-3_2-7-8-9.pkl | len: 3 |  size: 2.02 KB
Processing depth (2, 7, 8, 9):   4%|â–         | 4/100 [01:23<33:16, 20.80s/it]is_0k: False
your chose emoji: ['ğŸ§', 'ğŸ’‚ğŸ½\u200dâ™‚ï¸', 'ğŸ§œğŸ¾\u200dâ™€ï¸', 'ğŸ‘©ğŸ¿\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘©ğŸ¼', 'ğŸ˜š', 'ğŸ‘¨ğŸ¾\u200dğŸ”¬', 'ğŸ¦¸ğŸ¾', 'ğŸ§‘ğŸ»\u200dğŸ”¬', 'ğŸ§‘ğŸ½\u200dâ¤ï¸\u200dğŸ§‘ğŸ¿', 'ğŸ”º']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.36s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.80s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.32s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.79s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.42s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (3, 5, 6, 7):   4%|â–         | 4/100 [01:38<33:16, 20.80s/it]2025-01-22 17:39:33.788 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the apple.
2025-01-22 17:39:33.812 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2973, 2978) -->  tragedy. Daniel picked up
2025-01-22 17:39:33.812 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the office.
2025-01-22 17:39:33.834 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4251, 4256) -->  Daniel moved to the office
2025-01-22 17:39:33.834 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the bedroom.
2025-01-22 17:39:33.859 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4872, 4878) --> . Daniel went back to the
2025-01-22 17:39:33.859 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra dropped the apple.
2025-01-22 17:39:33.890 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5668, 5672) -->  Sandra dropped the apple
2025-01-22 17:39:33.890 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the hallway.
2025-01-22 17:39:33.916 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5233, 5238) --> . Sandra moved to the
2025-01-22 17:39:33.916 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went back to the hallway.
2025-01-22 17:39:33.917 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (106, 112) -->  John went back to the hallway
2025-01-22 17:39:33.917 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the garden.
2025-01-22 17:39:33.938 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3869, 3875) --> . Sandra went back to the
2025-01-22 17:39:33.939 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the hallway.
2025-01-22 17:39:33.939 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (105, 111) --> . John went back to the
2025-01-22 17:39:33.939 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra left the apple.
2025-01-22 17:39:33.976 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6909, 6913) -->  Sandra left the apple
2025-01-22 17:39:33.976 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra picked up the apple.
2025-01-22 17:39:33.991 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (2975, 2980) -->  Daniel picked up the apple
2025-01-22 17:39:33.991 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Sandra picked up the apple.
2025-01-22 17:39:34.005 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (2975, 2980) -->  Daniel picked up the apple
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:39:37.589 | INFO     | test_jbb_embedding:begin_test:693 - The hallway.<|eot_id|>
2025-01-22 17:39:37.589 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8223])
2025-01-22 17:39:42.096 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [374.196875, 40.734399696048634, 369.3716216216216, 38.42920543584721, 22.692708333333332], 'topk_indices': array([8206, 8217, 8213,   25, 8222, 4255, 3870,    4, 8077, 8111,    1,
       8211,    9,   23,   24,   14, 8219, 8221,    0, 8218]), 'topk_tokens': [':', ':', ' bedroom', '<|eot_id|>', '\n\n', ' office', ' Sandra', '\n\n', ' context', '.\n\n', '<|start_header_id|>', ' before', ':', '4', '\n\n', '\n', '<|start_header_id|>', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [363.8875, 728.05, 224.20833333333334, 169.75]}, 'weight': {'score': [25.001171875, 23.311362082066868, 24.033361486486488, 23.303953882529385, 29.554597701149426], 'topk_indices': array([3263, 3290, 3128, 3176, 7438, 7476, 1406, 1468, 4303, 4319, 5200,
       5139, 7215, 7159, 3472, 3446, 4983, 4954, 4900, 4925]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.1703125, 23.9234375, 20.927083333333332, 28.498046875]}, 'saliency': {'score': [2.2287841796875, 0.226597110087386, 2.406513935810811, 0.21181984956537708, 0.16913104879445043], 'topk_indices': array([8192,    0, 8111, 3202, 4252, 8216,    8,   20, 4878, 5238, 8210,
       8207,   23, 8205, 4255,   24, 8211, 8077, 8213, 3870]), 'topk_tokens': [' return', '<|begin_of_text|>', '.\n\n', ' hallway', ' moved', 'Answer', ' Date', ' Jul', ' bedroom', ' hallway', ' apple', ' Where', '4', 'Question', ' office', '\n\n', ' before', ' context', ' bedroom', ' Sandra'], 'evidence_proportions': [2.42333984375, 4.151171875, 1.1421712239583333, 1.2125244140625]}}, 'pred_res': 'The hallway.<|eot_id|>', 'score': 0}
2025-01-22 17:39:42.104 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:39:42.105 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-58_pid-4_3-5-6-7.pkl | len: 3 |  size: 2.03 KB
Processing depth (3, 5, 6, 7):   5%|â–Œ         | 5/100 [01:47<34:46, 21.96s/it]Processing depth (3, 5, 6, 7):   5%|â–Œ         | 5/100 [01:48<34:20, 21.69s/it]
2025-01-22 17:39:43.384 | INFO     | __main__:<module>:82 - Selected idx: 60
2025-01-22 17:39:43.385 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the football before the garden? 
2025-01-22 17:39:43.385 | INFO     | __main__:<module>:84 - Answer: hallway
2025-01-22 17:39:43.385 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 17:39:43.385 | INFO     | __main__:<module>:86 - Needle: [' John travelled to the kitchen.', ' John went back to the office.', ' Mary moved to the bedroom.', ' Sandra grabbed the football there.', ' Daniel went to the office.', ' Sandra journeyed to the hallway.', ' John went to the kitchen.', ' Sandra moved to the garden.', ' John travelled to the bedroom.']
2025-01-22 17:39:43.385 | INFO     | __main__:<module>:87 - Real Needle: [' Sandra grabbed the football there.', ' Sandra journeyed to the hallway.', ' Sandra moved to the garden.', ' John travelled to the bedroom.']
2025-01-22 17:39:43.385 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ‘©ğŸ»\u200dâ¤\u200dğŸ’‹\u200dğŸ‘¨ğŸ¿', 'ğŸ‘©ğŸ¼\u200dâ¤\u200dğŸ’‹\u200dğŸ‘©ğŸ»', 'ğŸ‘©ğŸ¾\u200dğŸ¤\u200dğŸ‘¨ğŸ»', 'Â®', 'ğŸ™†ğŸ½\u200dâ™‚', 'ğŸ‡±ğŸ‡§', 'ğŸ›¹', 'ğŸ‡®ğŸ‡¨', 'ğŸ‡´ğŸ‡²', 'ğŸ•Šï¸']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:05<00:15,  5.10s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.19s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.58s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.15s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.79s/it]
Processing depth (1, 5, 7, 8):   0%|          | 0/100 [00:17<?, ?it/s]2025-01-22 17:40:00.688 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra grabbed the football there.
2025-01-22 17:40:00.693 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (829, 834) --> . Sandra grabbed the football
2025-01-22 17:40:00.693 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra journeyed to the hallway.
2025-01-22 17:40:00.714 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4202, 4208) -->  Sandra journeyed to the hallway
2025-01-22 17:40:00.714 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the garden.
2025-01-22 17:40:00.742 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5727, 5732) --> . Sandra moved to the
2025-01-22 17:40:00.743 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John travelled to the bedroom.
2025-01-22 17:40:00.762 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3843, 3848) --> . John travelled to the
2025-01-22 17:40:00.762 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the kitchen.
2025-01-22 17:40:00.781 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3843, 3848) --> . John travelled to the
2025-01-22 17:40:00.781 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the office.
2025-01-22 17:40:00.807 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4306, 4312) --> . John went back to the
2025-01-22 17:40:00.807 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary moved to the bedroom.
2025-01-22 17:40:00.825 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3629, 3634) --> . Mary moved to the
2025-01-22 17:40:00.825 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went to the office.
2025-01-22 17:40:00.831 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1121, 1126) --> . Daniel went to the
2025-01-22 17:40:00.831 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went to the kitchen.
2025-01-22 17:40:00.850 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3844, 3849) -->  John travelled to the kitchen
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:40:01.989 | INFO     | test_jbb_embedding:begin_test:693 - There is no information about a football in the text before the garden.<|eot_id|>
2025-01-22 17:40:01.989 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8155])
2025-01-22 17:40:04.251 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [652.4077380952381, 58.15914593037509, 190.90745192307693, 56.195063031685365, 59.998609639830505], 'topk_indices': array([2368, 2384,   14, 8053, 8142, 2385, 8151, 2372, 2383, 2386, 8150,
        834,  833, 2359, 2374, 2373, 2360,    0, 2387, 2388]), 'topk_tokens': ['\n', 'and', '\n', ' location', ' football', ' the', '<|start_header_id|>', ' Min', ',\n', ' Min', '<|eot_id|>', ' there', ' football', 'nes', 'ot', 'nes', 'ot', '<|begin_of_text|>', 'nes', 'ot'], 'evidence_proportions': [1307.2, 678.7916666666666, 389.425, 228.9375]}, 'weight': {'score': [23.456473214285715, 23.251767819931356, 20.80138221153846, 23.259092590309457, 28.947033898305083], 'topk_indices': array([3294, 3267, 3139, 3187, 7446, 7408, 1431, 1493, 4295, 4279, 5097,
       5158, 7129, 7185, 3450, 3476, 4951, 4922, 4899, 4874]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [25.934375, 26.29296875, 21.040625, 19.990625]}, 'saliency': {'score': [4.265427362351191, 0.3305849008450294, 1.0515089768629808, 0.3180863534811907, 0.4394639871888242], 'topk_indices': array([8143, 2384, 2358, 8145, 4207, 2383,  830, 8053,  831, 8142,  834,
       2372, 2386, 2374,  833, 2359, 2360, 2373, 2388, 2387]), 'topk_tokens': [' before', 'and', ' Min', ' garden', ' hallway', ',\n', ' Sandra', ' location', ' grabbed', ' football', ' there', ' Min', ' Min', 'ot', ' football', 'nes', 'ot', 'nes', 'ot', 'nes'], 'evidence_proportions': [9.094921875, 4.465494791666667, 2.1583984375, 1.302880859375]}}, 'pred_res': 'There is no information about a football in the text before the garden.<|eot_id|>', 'score': 0}
2025-01-22 17:40:04.263 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:40:04.263 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-60_pid-0_1-5-7-8.pkl | len: 3 |  size: 2.04 KB
Processing depth (1, 5, 7, 8):   1%|          | 1/100 [00:20<34:14, 20.75s/it]is_0k: False
your chose emoji: ['ğŸ¤·ğŸ¼\u200dâ™‚ï¸', 'ğŸ§‘\u200dğŸ”§', 'ğŸ–ğŸ¿', 'â—€', 'ğŸ', 'ğŸ§‘ğŸ¿\u200dâš–', 'ğŸ‘‹ğŸ¾', 'ğŸ§›ğŸ»\u200dâ™‚', 'ğŸ™', 'ğŸ¦Ÿ']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.98s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:10,  5.00s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.86s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.37s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.94s/it]
Processing depth (2, 3, 6, 8):   1%|          | 1/100 [00:38<34:14, 20.75s/it]2025-01-22 17:40:22.255 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra grabbed the football there.
2025-01-22 17:40:22.268 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2005, 2010) --> . Sandra grabbed the football
2025-01-22 17:40:22.269 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra journeyed to the hallway.
2025-01-22 17:40:22.286 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2966, 2972) -->  tragedy. Sandra journeyed to
2025-01-22 17:40:22.286 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the garden.
2025-01-22 17:40:22.310 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4861, 4866) --> . Sandra moved to the
2025-01-22 17:40:22.311 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John travelled to the bedroom.
2025-01-22 17:40:22.330 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3912, 3917) -->  the ground. John travelled
2025-01-22 17:40:22.331 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the kitchen.
2025-01-22 17:40:22.352 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3912, 3917) -->  the ground. John travelled
2025-01-22 17:40:22.353 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the office.
2025-01-22 17:40:22.377 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4401, 4407) -->  execution. John went back to
2025-01-22 17:40:22.377 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary moved to the bedroom.
2025-01-22 17:40:22.404 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3760, 3765) --> . Mary moved to the
2025-01-22 17:40:22.404 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went to the office.
2025-01-22 17:40:22.412 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1214, 1219) -->  Republican. Daniel went to
2025-01-22 17:40:22.412 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went to the kitchen.
2025-01-22 17:40:22.432 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3915, 3920) -->  John travelled to the kitchen
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:40:23.210 | INFO     | test_jbb_embedding:begin_test:693 - the hallway<|eot_id|>
2025-01-22 17:40:23.210 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8221])
2025-01-22 17:40:25.457 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [311.95089285714283, 24.25459782344358, 122.41526442307692, 23.20362564204476, 26.71504543138587], 'topk_indices': array([1053, 8219, 8209, 2970,    4, 8208, 8109, 2006, 8217, 2969, 2007,
          9,   24, 8119, 8216, 2009, 2973,   14, 2010,    0]), 'topk_tokens': [' there', '<|end_header_id|>', ' before', 'ed', '\n\n', ' football', '.\n\n', ' Sandra', '<|start_header_id|>', ' journey', ' grabbed', ':', '\n\n', ' location', '<|eot_id|>', ' football', ' hallway', '\n', ' there', '<|begin_of_text|>'], 'evidence_proportions': [641.65, 371.203125, 163.15, 59.95]}, 'weight': {'score': [24.159598214285715, 23.316731137524318, 23.213641826923077, 23.31489429191635, 29.80774456521739], 'topk_indices': array([3277, 3250, 3122, 3170, 7482, 7444, 1467, 1405, 4257, 4241, 5172,
       5111, 7221, 7165, 3459, 3433, 4936, 4913, 4965, 4888]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [25.934375, 26.053385416666668, 21.040625, 23.23125]}, 'saliency': {'score': [2.0377110072544644, 0.13665903588677195, 0.7053281343900241, 0.1299686252276297, 0.1978064827297045], 'topk_indices': array([8203, 8109, 1053,   14, 8075,    8, 8209,   24, 8211, 2968, 3761,
       3765, 8208, 2969, 8119, 2007, 2006, 2009, 2010, 2973]), 'topk_tokens': ['Question', '.\n\n', ' there', '\n', ' context', ' Date', ' before', '\n\n', ' garden', ' Sandra', ' Mary', ' bedroom', ' football', ' journey', ' location', ' grabbed', ' Sandra', ' football', ' there', ' hallway'], 'evidence_proportions': [4.5423828125, 2.2836100260416665, 0.88740234375, 0.38826904296875]}}, 'pred_res': 'the hallway<|eot_id|>', 'score': 100}
2025-01-22 17:40:25.465 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:40:25.466 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-60_pid-1_2-3-6-8.pkl | len: 3 |  size: 2.04 KB
Processing depth (2, 3, 6, 8):   2%|â–         | 2/100 [00:41<34:19, 21.02s/it]is_0k: False
your chose emoji: ['ğŸ’ğŸ»\u200dâ™€ï¸', 'ğŸš´\u200dâ™‚ï¸', 'ğŸˆš', 'ğŸ‘©ğŸ»\u200dâ¤ï¸\u200dğŸ‘©ğŸ»', 'ğŸ‡¸ğŸ‡©', 'ğŸ‘©ğŸ¿\u200dâ¤ï¸\u200dğŸ‘©ğŸ¾', 'ğŸ‘¨ğŸ½\u200dğŸš’', 'ğŸ‘', 'ğŸ´\U000e0067\U000e0062\U000e0065\U000e006e\U000e0067\U000e007f', 'â˜¢']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.17s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.67s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.64s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.03s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.59s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (2, 3, 8, 9):   2%|â–         | 2/100 [00:58<34:19, 21.02s/it]2025-01-22 17:40:42.060 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra grabbed the football there.
2025-01-22 17:40:42.072 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1751, 1756) --> . Sandra grabbed the football
2025-01-22 17:40:42.073 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra journeyed to the hallway.
2025-01-22 17:40:42.091 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2891, 2897) --> . Sandra journeyed to the
2025-01-22 17:40:42.091 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the garden.
2025-01-22 17:40:42.125 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6643, 6648) --> . Sandra moved to the
2025-01-22 17:40:42.125 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John travelled to the bedroom.
2025-01-22 17:40:42.145 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3848, 3853) --> . John travelled to the
2025-01-22 17:40:42.146 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the kitchen.
2025-01-22 17:40:42.169 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3848, 3853) --> . John travelled to the
2025-01-22 17:40:42.169 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the office.
2025-01-22 17:40:42.191 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4304, 4310) --> . John went back to the
2025-01-22 17:40:42.191 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary moved to the bedroom.
2025-01-22 17:40:42.209 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3645, 3650) -->  Hon. Mary moved to
2025-01-22 17:40:42.210 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went to the office.
2025-01-22 17:40:42.215 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1004, 1009) -->  Daniel went to the office
2025-01-22 17:40:42.215 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went to the kitchen.
2025-01-22 17:40:42.234 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3849, 3854) -->  John travelled to the kitchen
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:40:46.752 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's office.<|eot_id|>
2025-01-22 17:40:46.752 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8177])
2025-01-22 17:40:49.751 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [289.6889880952381, 24.954851772616138, 117.89423076923077, 23.97417542727161, 25.413560267857143], 'topk_indices': array([8159, 8160, 1690, 1599, 1689, 1709, 1755, 8167, 8173, 8164, 6649,
       8168, 8172, 2897, 1630, 8165, 1710, 1631, 1632,    0]), 'topk_tokens': ['Question', ':', 'Min', ' part', '\n', ' for', ' football', ' garden', '<|start_header_id|>', ' football', '.', '?', '<|eot_id|>', ' hallway', ' for', ' before', ' some', ' some', ' time', '<|begin_of_text|>'], 'evidence_proportions': [441.9, 344.6666666666667, 299.7, 61.49375]}, 'weight': {'score': [22.005208333333332, 23.281263371026895, 22.497896634615383, 23.287062546108448, 29.775446428571428], 'topk_indices': array([3308, 3335, 3160, 3208, 7426, 7464, 1511, 1449, 4332, 4316, 5206,
       5145, 7197, 7141, 3491, 3517, 4922, 4970, 4947, 4999]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [25.934375, 21.213541666666668, 21.040625, 19.990625]}, 'saliency': {'score': [1.7640438988095237, 0.14110981910910758, 0.7187288724459134, 0.1350727219665445, 0.19010968889508928], 'topk_indices': array([1708, 1008, 1684, 1753, 2893, 8168, 8031, 1599, 6648, 8159, 1690,
       1752, 8167, 1755, 8164, 8165, 2897, 1631, 1710, 1632]), 'topk_tokens': ['pay', ' office', ' const', ' grabbed', ' journey', '?', ' context', ' part', ' garden', 'Question', 'Min', ' Sandra', ' garden', ' football', ' football', ' before', ' hallway', ' some', ' some', ' time'], 'evidence_proportions': [3.23134765625, 1.9580891927083333, 1.48291015625, 0.34501953125]}}, 'pred_res': "Daniel's office.<|eot_id|>", 'score': 0}
2025-01-22 17:40:49.755 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:40:49.756 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-60_pid-2_2-3-8-9.pkl | len: 3 |  size: 2.02 KB
Processing depth (2, 3, 8, 9):   3%|â–         | 3/100 [01:06<36:23, 22.51s/it]is_0k: False
your chose emoji: ['ğŸ¤¦\u200dâ™€', 'ğŸ•µï¸\u200dâ™‚ï¸', 'ã€½', 'ğŸ§‘ğŸ¾\u200dğŸ¦¼\u200dâ¡ï¸', 'ğŸ‘¸ğŸ¾', 'ğŸ§‘ğŸ¿\u200dâš–ï¸', 'ğŸ§›ğŸ¾\u200dâ™‚', 'ğŸ¦«', 'ğŸ¤¾ğŸ¾\u200dâ™‚ï¸', 'ğŸ”•']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.37s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.80s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.65s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.24s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.76s/it]
Processing depth (3, 4, 5, 9):   3%|â–         | 3/100 [01:23<36:23, 22.51s/it]2025-01-22 17:41:06.591 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra grabbed the football there.
2025-01-22 17:41:06.606 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2927, 2932) --> . Sandra grabbed the football
2025-01-22 17:41:06.606 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra journeyed to the hallway.
2025-01-22 17:41:06.626 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3593, 3599) --> . Sandra journeyed to the
2025-01-22 17:41:06.627 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the garden.
2025-01-22 17:41:06.650 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4156, 4161) --> . Sandra moved to the
2025-01-22 17:41:06.650 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John travelled to the bedroom.
2025-01-22 17:41:06.670 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3824, 3829) --> . John travelled to the
2025-01-22 17:41:06.670 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the kitchen.
2025-01-22 17:41:06.689 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3824, 3829) --> . John travelled to the
2025-01-22 17:41:06.689 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the office.
2025-01-22 17:41:06.712 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4294, 4300) --> . John went back to the
2025-01-22 17:41:06.712 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary moved to the bedroom.
2025-01-22 17:41:06.733 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3621, 3626) -->  Hon. Mary moved to
2025-01-22 17:41:06.733 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went to the office.
2025-01-22 17:41:06.738 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1119, 1124) --> . Daniel went to the
2025-01-22 17:41:06.739 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went to the kitchen.
2025-01-22 17:41:06.759 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3825, 3830) -->  John travelled to the kitchen
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:41:07.517 | INFO     | test_jbb_embedding:begin_test:693 - the hallway<|eot_id|>
2025-01-22 17:41:07.517 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8155])
2025-01-22 17:41:09.724 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [174.1063988095238, 10.179259430926697, 29.83653846153846, 9.691827649180127, 8.454995365466102], 'topk_indices': array([2899, 8137, 2932, 2930, 8143, 8142, 8138,    9, 2927, 8154, 2928,
       8153,   24, 8149, 2929,   14, 3599, 2931,    0, 8150]), 'topk_tokens': ['.', 'Question', ' there', ' the', ' before', ' football', ':', ':', '.', '\n\n', ' Sandra', '<|end_header_id|>', '\n\n', ':', ' grabbed', '\n', ' hallway', ' football', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [445.0, 160.22916666666666, 70.2625, 23.709375]}, 'weight': {'score': [22.005208333333332, 23.25886591382692, 21.72596153846154, 23.267025490075206, 29.437764830508474], 'topk_indices': array([3267, 3294, 3139, 3187, 7392, 7430, 1497, 1435, 4306, 4322, 5137,
       5198, 7107, 7163, 3450, 3476, 4991, 4894, 4962, 4919]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [25.934375, 21.213541666666668, 21.040625, 19.990625]}, 'saliency': {'score': [1.1171598888578869, 0.056539233919159104, 0.16856853778545672, 0.053434093288628096, 0.06228269156763109], 'topk_indices': array([2898, 3594, 2935, 3595, 2926, 8154,    8, 8009, 8145, 8053,   24,
       2932, 8143, 8148, 8137, 8142, 2928, 2929, 3599, 2931]), 'topk_tokens': [' Gov', ' Sandra', 'ible', ' journey', ' Gov', '\n\n', ' Date', ' context', ' garden', ' location', '\n\n', ' there', ' before', 'Answer', 'Question', ' football', ' Sandra', ' grabbed', ' hallway', ' football'], 'evidence_proportions': [3.1421875, 0.9043375651041666, 0.336865234375, 0.127813720703125]}}, 'pred_res': 'the hallway<|eot_id|>', 'score': 100}
2025-01-22 17:41:09.730 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:41:09.730 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-60_pid-3_3-4-5-9.pkl | len: 3 |  size: 2.0 KB
Processing depth (3, 4, 5, 9):   4%|â–         | 4/100 [01:26<34:24, 21.51s/it]is_0k: False
your chose emoji: ['ğŸ©´', 'ğŸ‘®ğŸ¿\u200dâ™‚', 'ğŸ’', 'ğŸ‡¯ğŸ‡ª', 'ğŸ§‘ğŸ»\u200dğŸ¤', 'ğŸ‘ğŸ¾', '\U0001f9cc', 'ğŸ”', 'ğŸƒğŸ»\u200dâ™€\u200dâ¡ï¸', 'ğŸ¦¶ğŸ¼']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.51s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.92s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.61s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.23s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.77s/it]
Processing depth (0, 2, 3, 7):   4%|â–         | 4/100 [01:42<34:24, 21.51s/it]2025-01-22 17:41:26.527 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra grabbed the football there.
2025-01-22 17:41:26.527 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (32, 37) -->  grabbed the football there.
2025-01-22 17:41:26.528 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra journeyed to the hallway.
2025-01-22 17:41:26.538 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1864, 1870) --> . Sandra journeyed to the
2025-01-22 17:41:26.539 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the garden.
2025-01-22 17:41:26.553 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2939, 2944) --> . Sandra moved to the
2025-01-22 17:41:26.553 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John travelled to the bedroom.
2025-01-22 17:41:26.574 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3865, 3870) --> . John travelled to the
2025-01-22 17:41:26.574 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the kitchen.
2025-01-22 17:41:26.596 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3865, 3870) --> . John travelled to the
2025-01-22 17:41:26.596 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the office.
2025-01-22 17:41:26.622 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4313, 4319) --> . John went back to the
2025-01-22 17:41:26.622 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary moved to the bedroom.
2025-01-22 17:41:26.640 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3651, 3656) --> . Mary moved to the
2025-01-22 17:41:26.640 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went to the office.
2025-01-22 17:41:26.646 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1118, 1123) --> . Daniel went to the
2025-01-22 17:41:26.646 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went to the kitchen.
2025-01-22 17:41:26.665 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3866, 3871) -->  John travelled to the kitchen
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:41:27.799 | INFO     | test_jbb_embedding:begin_test:693 - There is no information about a football in the text before the garden.<|eot_id|>
2025-01-22 17:41:27.799 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8154])
2025-01-22 17:41:30.011 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [733.9970238095239, 48.21396499938703, 107.82451923076923, 46.24709463625154, 35.38436153017241], 'topk_indices': array([  14,   29, 1870, 8149, 1058, 1018, 8052,   24,   33,  540,   32,
       8150,   34, 1019,   35, 1020, 1059,    0, 1021, 1060]), 'topk_tokens': ['\n', '\n\n', ' hallway', '<|eot_id|>', ' the', ' the', ' location', '\n\n', ' the', ',', ' grabbed', '<|start_header_id|>', ' football', ' galaxy', ' there', ' of', ' galaxy', '<|begin_of_text|>', ' states', ' of'], 'evidence_proportions': [1919.3, 449.875, 562.1, 61.5375]}, 'weight': {'score': [21.296875, 23.251440480568835, 20.80138221153846, 23.264356311652282, 29.082435344827587], 'topk_indices': array([3306, 3279, 3151, 3199, 7385, 7423, 1490, 1428, 4302, 4286, 5183,
       5122, 7100, 7156, 3488, 3462, 4947, 4899, 4976, 4924]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.959375, 21.213541666666668, 21.040625, 19.990625]}, 'saliency': {'score': [4.467694963727679, 0.27011279374693514, 0.5709439791165866, 0.258279151775393, 0.2614864480906519], 'topk_indices': array([  75,   24, 8142, 8008,  113, 1057, 8141,    0,   31, 2944, 8052,
       1020, 1870, 1060,   32,   34,   35, 1019, 1021, 1059]), 'topk_tokens': [' PA', '\n\n', ' before', ' context', ' PA', 'into', ' football', '<|begin_of_text|>', 'andra', ' garden', ' location', ' of', ' hallway', ' of', ' grabbed', ' football', ' there', ' galaxy', ' states', ' galaxy'], 'evidence_proportions': [12.3595703125, 2.5951334635416665, 2.9458984375, 0.34468994140625]}}, 'pred_res': 'There is no information about a football in the text before the garden.<|eot_id|>', 'score': 0}
2025-01-22 17:41:30.019 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:41:30.020 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-60_pid-4_0-2-3-7.pkl | len: 3 |  size: 2.08 KB
Processing depth (0, 2, 3, 7):   5%|â–Œ         | 5/100 [01:46<33:21, 21.07s/it]Processing depth (0, 2, 3, 7):   5%|â–Œ         | 5/100 [01:46<33:44, 21.31s/it]
2025-01-22 17:41:30.081 | INFO     | __main__:<module>:82 - Selected idx: 62
2025-01-22 17:41:30.081 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the football before the garden? 
2025-01-22 17:41:30.081 | INFO     | __main__:<module>:84 - Answer: hallway
2025-01-22 17:41:30.081 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 17:41:30.081 | INFO     | __main__:<module>:86 - Needle: [' Daniel went to the office.', ' Mary grabbed the football there.', ' John travelled to the kitchen.', ' Mary grabbed the football.', ' Mary discarded the football.', ' Sandra picked up the football.', ' Mary moved to the bedroom.', ' Sandra journeyed to the hallway.', ' John went back to the office.', ' Sandra moved to the garden.', ' Mary left the football.']
2025-01-22 17:41:30.081 | INFO     | __main__:<module>:87 - Real Needle: [' Sandra picked up the football.', ' Sandra journeyed to the hallway.', ' Sandra moved to the garden.', ' Mary left the football.']
2025-01-22 17:41:30.081 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ', 'ğŸ§™ğŸ¾\u200dâ™€', 'ğŸ’†ğŸ¾', 'ğŸ§‘ğŸ½', 'ğŸš–', 'ğŸš¶ğŸ¼\u200dâ¡ï¸', 'ğŸ–¨', 'ğŸ›€ğŸ»', 'ğŸ‘³ğŸ»', 'ğŸ™‡ğŸ¼\u200dâ™€']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.44s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.65s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.83s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.35s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.84s/it]
Processing depth (3, 4, 5, 9):   0%|          | 0/100 [00:17<?, ?it/s]2025-01-22 17:41:47.443 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra picked up the football.
2025-01-22 17:41:47.461 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2854, 2859) -->  Sandra picked up the football
2025-01-22 17:41:47.462 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra journeyed to the hallway.
2025-01-22 17:41:47.482 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3545, 3551) --> . Sandra journeyed to the
2025-01-22 17:41:47.484 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the garden.
2025-01-22 17:41:47.509 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4154, 4159) --> . Sandra moved to the
2025-01-22 17:41:47.509 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary left the football.
2025-01-22 17:41:47.544 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7254, 7258) -->  Mary left the football
2025-01-22 17:41:47.544 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went to the office.
2025-01-22 17:41:47.547 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (652, 657) --> . Daniel went to the
2025-01-22 17:41:47.547 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary grabbed the football there.
2025-01-22 17:41:47.560 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2412, 2417) --> . Mary grabbed the football
2025-01-22 17:41:47.560 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the kitchen.
2025-01-22 17:41:47.581 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3800, 3805) --> . John travelled to the
2025-01-22 17:41:47.581 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary grabbed the football.
2025-01-22 17:41:47.594 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2413, 2417) -->  Mary grabbed the football
2025-01-22 17:41:47.594 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary discarded the football.
2025-01-22 17:41:47.595 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (232, 236) -->  Mary discarded the football
2025-01-22 17:41:47.595 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary moved to the bedroom.
2025-01-22 17:41:47.600 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (934, 939) --> . Mary moved to the
2025-01-22 17:41:47.600 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  John went back to the office.
2025-01-22 17:41:47.640 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (7068, 7074) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:41:48.426 | INFO     | test_jbb_embedding:begin_test:693 - the hallway<|eot_id|>
2025-01-22 17:41:48.426 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8214])
2025-01-22 17:41:50.673 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [251.115625, 78.3614153584033, 296.0615808823529, 77.03140312997672, 44.801385788690474], 'topk_indices': array([7635, 7679, 7642, 7699, 7674, 7691, 7693, 7657, 7643, 7700, 7701,
       7687, 7659, 7673, 7644,    0, 7658, 7702, 7688, 7703]), 'topk_tokens': ['graph', ' tele', ' two', ' use', ' five', '\n', ' the', ' Min', ' or', ' of', ' the', ' two', 'ot', ' or', ' three', '<|begin_of_text|>', 'nes', ' Min', ' or', 'nes'], 'evidence_proportions': [172.55, 337.4583333333333, 225.65, 251.640625]}, 'weight': {'score': [23.99375, 23.30160794693927, 22.624080882352942, 23.30273413573441, 29.4765625], 'topk_indices': array([3348, 3321, 3241, 3193, 7469, 7431, 1444, 1506, 4341, 4325, 5255,
       5194, 7147, 7203, 3510, 3536, 4971, 4996, 5019, 5048]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.3078125, 21.213541666666668, 21.040625, 26.462890625]}, 'saliency': {'score': [1.53868408203125, 0.4533141146498874, 1.8146685431985294, 0.4449846463271775, 0.3321958269391741], 'topk_indices': array([7678, 7698, 7634, 7690, 7643, 7699, 7642, 7674, 7635,  414, 7659,
       7679, 7687, 7673, 7657, 7644, 7688, 7658, 7702, 7703]), 'topk_tokens': [' bogus', ' especial', ' tele', ' copies', ' or', ' use', ' two', ' five', 'graph', ' impressions', 'ot', ' tele', ' two', ' or', ' Min', ' three', ' or', 'nes', ' Min', 'nes'], 'evidence_proportions': [1.32666015625, 1.8827311197916667, 1.208447265625, 1.700439453125]}}, 'pred_res': 'the hallway<|eot_id|>', 'score': 100}
2025-01-22 17:41:50.679 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:41:50.680 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-62_pid-0_3-4-5-9.pkl | len: 3 |  size: 1.95 KB
Processing depth (3, 4, 5, 9):   1%|          | 1/100 [00:20<33:49, 20.50s/it]is_0k: False
your chose emoji: ['ğŸ’‡ğŸ¾\u200dâ™‚ï¸', 'ğŸ‘¨ğŸ¾\u200dğŸ¤', 'ğŸ‘©ğŸ¿\u200dâ¤ï¸\u200dğŸ‘¨ğŸ¼', 'ğŸ’‚ğŸ¼', 'ğŸš»', 'ğŸ‡®ğŸ‡³', 'ğŸ‘©ğŸ¿\u200dâ¤\u200dğŸ’‹\u200dğŸ‘¨ğŸ¼', 'ğŸ¬', 'ğŸ‘¨\u200dğŸ‘©\u200dğŸ‘¦', '\U0001fae0']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.28s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.50s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.09s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.67s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.26s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (3, 4, 6, 8):   1%|          | 1/100 [00:35<33:49, 20.50s/it]2025-01-22 17:42:05.685 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra picked up the football.
2025-01-22 17:42:05.700 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2990, 2995) -->  tragedy. Sandra picked up
2025-01-22 17:42:05.700 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra journeyed to the hallway.
2025-01-22 17:42:05.719 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3739, 3745) --> . Sandra journeyed to the
2025-01-22 17:42:05.720 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the garden.
2025-01-22 17:42:05.748 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4930, 4935) --> . Sandra moved to the
2025-01-22 17:42:05.748 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary left the football.
2025-01-22 17:42:05.782 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6675, 6679) -->  Mary left the football
2025-01-22 17:42:05.783 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went to the office.
2025-01-22 17:42:05.787 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (756, 761) --> . Daniel went to the
2025-01-22 17:42:05.787 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary grabbed the football there.
2025-01-22 17:42:05.802 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2490, 2495) --> . Mary grabbed the football
2025-01-22 17:42:05.803 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the kitchen.
2025-01-22 17:42:05.826 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3936, 3941) -->  the ground. John travelled
2025-01-22 17:42:05.827 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary grabbed the football.
2025-01-22 17:42:05.842 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2491, 2495) -->  Mary grabbed the football
2025-01-22 17:42:05.842 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary discarded the football.
2025-01-22 17:42:05.843 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (232, 236) -->  Mary discarded the football
2025-01-22 17:42:05.843 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary moved to the bedroom.
2025-01-22 17:42:05.850 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (1050, 1055) --> . Mary moved to the
2025-01-22 17:42:05.850 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  John went back to the office.
2025-01-22 17:42:05.894 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (7096, 7102) -->  John went back to the office
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:42:08.791 | INFO     | test_jbb_embedding:begin_test:693 - the hallway<|eot_id|>
2025-01-22 17:42:08.791 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8194])
2025-01-22 17:42:11.866 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [156.590625, 17.750924499817007, 121.80675551470588, 16.975449580928405, 10.205025337837839], 'topk_indices': array([8178,    8, 8179, 1055, 8176, 8082, 8177,    4, 1056, 8092,    9,
       8181,   24, 3745, 8182,   14, 8192, 8190,    0, 8189]), 'topk_tokens': [' Where', ' Date', ' was', ' bedroom', 'Question', '.\n\n', ':', '\n\n', '.', ' location', ':', ' football', '\n\n', ' hallway', ' before', '\n', '<|end_header_id|>', '<|start_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [92.58125, 223.27083333333334, 179.975, 107.3515625]}, 'weight': {'score': [24.2421875, 23.289244540685615, 23.69094669117647, 23.28522676685497, 29.62626689189189], 'topk_indices': array([3273, 3300, 3193, 3145, 7437, 7475, 1416, 1478, 4293, 4277, 5136,
       5197, 7214, 7158, 3482, 3456, 4984, 4901, 4955, 4926]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [29.3015625, 21.213541666666668, 21.040625, 26.462890625]}, 'saliency': {'score': [0.93946533203125, 0.0987236690300186, 0.761784273035386, 0.09389020546668726, 0.07568472784918708], 'topk_indices': array([4352,   20, 4935, 7582, 8163,  233, 7583, 3072,  235,   24, 8178,
          8, 3741, 8184, 8176, 8092, 1055, 8182, 8181, 3745]), 'topk_tokens': ['ot', ' Jul', ' garden', ' Min', ' return', ' discarded', 'nes', ' participate', ' football', '\n\n', ' Where', ' Date', ' journey', ' garden', 'Question', ' location', ' bedroom', ' before', ' football', ' hallway'], 'evidence_proportions': [0.663427734375, 1.2854817708333333, 0.9876953125, 0.7052001953125]}}, 'pred_res': 'the hallway<|eot_id|>', 'score': 100}
2025-01-22 17:42:11.876 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:42:11.876 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-62_pid-1_3-4-6-8.pkl | len: 3 |  size: 2.03 KB
Processing depth (3, 4, 6, 8):   2%|â–         | 2/100 [00:41<34:09, 20.91s/it]is_0k: False
your chose emoji: ['â', 'ğŸ¤½ğŸ¼', 'ğŸ§™ğŸ¾\u200dâ™€ï¸', 'ğŸ–•ğŸ¾', 'ğŸ’—', 'ğŸ¦¹ğŸ¾\u200dâ™‚ï¸', 'ğŸ¤¾ğŸ¾\u200dâ™€', 'ğŸ‘©ğŸ»\u200dğŸ¦°', 'ğŸ‘©ğŸ»\u200dâ¤\u200dğŸ’‹\u200dğŸ‘¨ğŸ»', 'â™£']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:05<00:16,  5.36s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.08s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:15<00:04,  4.96s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  3.45s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  4.05s/it]
Processing depth (1, 3, 7, 8):   2%|â–         | 2/100 [01:00<34:09, 20.91s/it]2025-01-22 17:42:30.713 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra picked up the football.
2025-01-22 17:42:30.716 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (706, 711) --> . Sandra picked up the
2025-01-22 17:42:30.717 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra journeyed to the hallway.
2025-01-22 17:42:30.733 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2877, 2883) --> . Sandra journeyed to the
2025-01-22 17:42:30.733 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the garden.
2025-01-22 17:42:30.766 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5686, 5691) --> . Sandra moved to the
2025-01-22 17:42:30.766 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary left the football.
2025-01-22 17:42:30.805 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6537, 6541) -->  Mary left the football
2025-01-22 17:42:30.805 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went to the office.
2025-01-22 17:42:30.807 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (430, 435) --> . Daniel went to the
2025-01-22 17:42:30.808 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary grabbed the football there.
2025-01-22 17:42:30.819 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2194, 2199) --> . Mary grabbed the football
2025-01-22 17:42:30.819 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the kitchen.
2025-01-22 17:42:30.839 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3870, 3875) --> . John travelled to the
2025-01-22 17:42:30.839 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary grabbed the football.
2025-01-22 17:42:30.852 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2195, 2199) -->  Mary grabbed the football
2025-01-22 17:42:30.852 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary discarded the football.
2025-01-22 17:42:30.853 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (198, 202) -->  Mary discarded the football
2025-01-22 17:42:30.853 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary moved to the bedroom.
2025-01-22 17:42:30.859 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (896, 901) --> . Mary moved to the
2025-01-22 17:42:30.859 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  John went back to the office.
2025-01-22 17:42:30.900 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (7043, 7049) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:42:31.737 | INFO     | test_jbb_embedding:begin_test:693 - Mary's bedroom.<|eot_id|>
2025-01-22 17:42:31.737 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8214])
2025-01-22 17:42:33.967 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [205.63125, 21.08502570889619, 131.78952205882354, 20.17177355139042, 25.321544828869047], 'topk_indices': array([8112, 8200, 8203, 8198, 2735, 8205,  214, 2879, 8199,   24,   14,
       5692, 8204, 2883, 8201, 8212, 8202, 8210, 8209,    0]), 'topk_tokens': [' location', ' the', ' the', ' Where', ' ne', '?', 'G', ' journey', ' was', '\n\n', '\n', '.', ' garden', ' hallway', ' football', '<|end_header_id|>', ' before', '<|start_header_id|>', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [171.15, 286.6666666666667, 231.525, 94.8125]}, 'weight': {'score': [22.790234375, 23.30617165632226, 22.624080882352942, 23.310276744150435, 29.696800595238095], 'topk_indices': array([3336, 3363, 3256, 3208, 7493, 7455, 1560, 1498, 4321, 4337, 5231,
       5170, 7176, 7232, 3519, 3545, 4909, 4934, 5012, 4983]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [23.49375, 21.213541666666668, 21.040625, 26.462890625]}, 'saliency': {'score': [1.21893310546875, 0.11805802905038716, 0.8131848503561581, 0.11246550014523421, 0.18691507975260416], 'topk_indices': array([2643, 2878,  214, 8068,  213,  707, 8196,  199, 8112, 2661, 5691,
       8198,  626, 2735,  901, 2879, 8204, 8202, 8201, 2883]), 'topk_tokens': ['engers', ' Sandra', 'G', ' context', 'UG', ' Sandra', 'Question', ' discarded', ' location', 'ared', ' garden', ' Where', ' instead', ' ne', ' bedroom', ' journey', ' garden', ' before', ' football', ' hallway'], 'evidence_proportions': [1.13505859375, 1.6897786458333333, 1.20439453125, 0.63568115234375]}}, 'pred_res': "Mary's bedroom.<|eot_id|>", 'score': 0}
2025-01-22 17:42:34.005 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:42:34.006 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-62_pid-2_1-3-7-8.pkl | len: 3 |  size: 2.04 KB
Processing depth (1, 3, 7, 8):   3%|â–         | 3/100 [01:03<34:42, 21.47s/it]is_0k: False
your chose emoji: ['ğŸ•µï¸\u200dâ™‚ï¸', 'ğŸ‘¨ğŸ½\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘¨ğŸ¿', 'ğŸ‡¨ğŸ‡«', 'ğŸ™‹ğŸ¼\u200dâ™€', 'ğŸ”œ', 'ğŸ¦¹ğŸ¼\u200dâ™€', 'ğŸ§‘ğŸ¼\u200dğŸ¨', 'ğŸ§—ğŸ¿\u200dâ™‚ï¸', 'ğŸ‘’', 'ğŸ¤·ğŸ»\u200dâ™‚']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.27s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.62s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.57s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  2.96s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.53s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (1, 4, 5, 6):   3%|â–         | 3/100 [01:19<34:42, 21.47s/it]2025-01-22 17:42:50.195 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra picked up the football.
2025-01-22 17:42:50.200 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (834, 839) --> . Sandra picked up the
2025-01-22 17:42:50.200 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra journeyed to the hallway.
2025-01-22 17:42:50.224 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3635, 3641) --> . Sandra journeyed to the
2025-01-22 17:42:50.225 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the garden.
2025-01-22 17:42:50.247 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4192, 4197) --> . Sandra moved to the
2025-01-22 17:42:50.247 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary left the football.
2025-01-22 17:42:50.275 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4805, 4809) -->  Mary left the football
2025-01-22 17:42:50.275 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went to the office.
2025-01-22 17:42:50.279 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (756, 761) --> . Daniel went to the
2025-01-22 17:42:50.280 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary grabbed the football there.
2025-01-22 17:42:50.291 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2246, 2251) --> . Mary grabbed the football
2025-01-22 17:42:50.291 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the kitchen.
2025-01-22 17:42:50.311 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3854, 3859) --> . John travelled to the
2025-01-22 17:42:50.311 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary grabbed the football.
2025-01-22 17:42:50.322 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2247, 2251) -->  Mary grabbed the football
2025-01-22 17:42:50.323 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary discarded the football.
2025-01-22 17:42:50.324 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (232, 236) -->  Mary discarded the football
2025-01-22 17:42:50.324 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary moved to the bedroom.
2025-01-22 17:42:50.329 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (990, 995) --> . Mary moved to the
2025-01-22 17:42:50.330 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  John went back to the office.
2025-01-22 17:42:50.371 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (7073, 7079) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:42:52.910 | INFO     | test_jbb_embedding:begin_test:693 - the hallway<|eot_id|>
2025-01-22 17:42:52.910 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8190])
2025-01-22 17:42:55.640 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [176.1640625, 17.763956273648237, 135.9368106617647, 16.881061670659786, 13.700330946180555], 'topk_indices': array([8078,  231,  207, 8174, 8175, 8181, 8180,  236, 8088,   24,  995,
        232, 8177,   14, 8188, 3641, 8178, 8185,    0, 8186]), 'topk_tokens': ['.\n\n', '.', '.', ' Where', ' was', '?', ' garden', '.', ' location', '\n\n', ' bedroom', ' Mary', ' football', '\n', '<|end_header_id|>', ' hallway', ' before', '<|eot_id|>', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [172.9, 241.14583333333334, 154.0875, 110.3671875]}, 'weight': {'score': [22.790234375, 23.27631247711461, 22.624080882352942, 23.280231562538397, 29.06640625], 'topk_indices': array([3319, 3346, 3239, 3191, 7437, 7475, 1436, 1498, 4351, 4335, 5157,
       5218, 7158, 7214, 3502, 3528, 4928, 4953, 4982, 5011]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [23.49375, 21.213541666666668, 21.040625, 26.462890625]}, 'saliency': {'score': [1.03096923828125, 0.09910433943944144, 0.8660596959731158, 0.0936105711510791, 0.09848827785915798], 'topk_indices': array([  24, 8175, 3636, 3637, 8181,  230,  835,  839, 8172, 8044,  235,
       8174, 8088, 8180,  233,  232, 8178,  995, 8177, 3641]), 'topk_tokens': ['\n\n', ' was', ' Sandra', ' journey', '?', ' ST', ' Sandra', ' football', 'Question', ' context', ' football', ' Where', ' location', ' garden', ' discarded', ' Mary', ' before', ' bedroom', ' football', ' hallway'], 'evidence_proportions': [1.11201171875, 1.3650716145833333, 0.8134765625, 0.70037841796875]}}, 'pred_res': 'the hallway<|eot_id|>', 'score': 100}
2025-01-22 17:42:55.648 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:42:55.648 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-62_pid-3_1-4-5-6.pkl | len: 3 |  size: 2.03 KB
Processing depth (1, 4, 5, 6):   4%|â–         | 4/100 [01:25<34:27, 21.54s/it]is_0k: False
your chose emoji: ['ğŸ‘¨ğŸ¾\u200dğŸ¦¯\u200dâ¡ï¸', 'ğŸ¤µğŸ¿', 'ğŸ‘¨\u200dğŸ¦½', 'ğŸ‘·ğŸ½', 'ğŸ§˜ğŸ½', 'â¤µ', 'ğŸŒğŸ¿\u200dâ™€ï¸', 'ğŸ§˜ğŸ½\u200dâ™€ï¸', 'ğŸ¤›ğŸ½', 'ğŸ‡¹ğŸ‡²']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.37s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.61s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.66s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.25s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.74s/it]
Processing depth (3, 6, 7, 9):   4%|â–         | 4/100 [01:42<34:27, 21.54s/it]2025-01-22 17:43:12.434 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra picked up the football.
2025-01-22 17:43:12.448 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2901, 2906) --> . Sandra picked up the
2025-01-22 17:43:12.448 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra journeyed to the hallway.
2025-01-22 17:43:12.477 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4727, 4733) --> . Sandra journeyed to the
2025-01-22 17:43:12.478 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the garden.
2025-01-22 17:43:12.521 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5654, 5659) --> . Sandra moved to the
2025-01-22 17:43:12.522 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary left the football.
2025-01-22 17:43:12.557 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7266, 7270) -->  Mary left the football
2025-01-22 17:43:12.557 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went to the office.
2025-01-22 17:43:12.561 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (756, 761) --> . Daniel went to the
2025-01-22 17:43:12.561 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary grabbed the football there.
2025-01-22 17:43:12.574 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2406, 2411) --> . Mary grabbed the football
2025-01-22 17:43:12.574 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the kitchen.
2025-01-22 17:43:12.596 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3835, 3840) --> . John travelled to the
2025-01-22 17:43:12.596 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary grabbed the football.
2025-01-22 17:43:12.608 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2407, 2411) -->  Mary grabbed the football
2025-01-22 17:43:12.609 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary discarded the football.
2025-01-22 17:43:12.610 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (232, 236) -->  Mary discarded the football
2025-01-22 17:43:12.610 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary moved to the bedroom.
2025-01-22 17:43:12.615 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (986, 991) --> . Mary moved to the
2025-01-22 17:43:12.615 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  John went back to the office.
2025-01-22 17:43:12.653 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (7056, 7062) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:43:13.430 | INFO     | test_jbb_embedding:begin_test:693 - the bedroom<|eot_id|>
2025-01-22 17:43:13.430 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8168])
2025-01-22 17:43:15.651 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [224.8, 28.172907615346958, 228.50965073529412, 26.849266970555625, 23.50845286885246], 'topk_indices': array([8151,    3,  233,  232, 8164, 8155, 5660,  236,   24,  231,   14,
        235, 8159, 4733, 8158, 8166, 1714, 8156, 8163,    0]), 'topk_tokens': [':', '<|end_header_id|>', ' discarded', ' Mary', '<|start_header_id|>', ' football', '.', '.', '\n\n', '.', '\n', ' football', '?', ' hallway', ' garden', '<|end_header_id|>', 'in', ' before', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [128.9, 328.6041666666667, 303.925, 90.0625]}, 'weight': {'score': [22.790234375, 23.26919134744829, 22.624080882352942, 23.273073680239005, 29.633709016393443], 'topk_indices': array([3352, 3325, 3185, 3233, 7385, 7423, 1500, 1438, 4330, 4314, 5199,
       5138, 7157, 7101, 3508, 3534, 4963, 4992, 4940, 4915]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [23.49375, 21.213541666666668, 21.040625, 26.462890625]}, 'saliency': {'score': [1.31773681640625, 0.1592881778450465, 1.4676441865808822, 0.1509534387704817, 0.1757602378970287], 'topk_indices': array([3837, 2410, 7530, 7531, 8152, 8022, 8150, 5659, 1714, 1636,  991,
       8159, 4729,  232, 8155,  233, 8156,  235, 8158, 4733]), 'topk_tokens': [' travelled', ' football', ' Min', 'nes', ' Where', ' context', 'Question', ' garden', 'in', ' sight', ' bedroom', '?', ' journey', ' Mary', ' football', ' discarded', ' before', ' football', ' garden', ' hallway'], 'evidence_proportions': [0.872998046875, 1.9165852864583333, 1.624755859375, 0.59161376953125]}}, 'pred_res': 'the bedroom<|eot_id|>', 'score': 0}
2025-01-22 17:43:15.655 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:43:15.655 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-62_pid-4_3-6-7-9.pkl | len: 3 |  size: 2.04 KB
Processing depth (3, 6, 7, 9):   5%|â–Œ         | 5/100 [01:45<33:13, 20.98s/it]Processing depth (3, 6, 7, 9):   5%|â–Œ         | 5/100 [01:45<33:25, 21.11s/it]
2025-01-22 17:43:15.723 | INFO     | __main__:<module>:82 - Selected idx: 64
2025-01-22 17:43:15.723 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the football before the garden? 
2025-01-22 17:43:15.723 | INFO     | __main__:<module>:84 - Answer: hallway
2025-01-22 17:43:15.724 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 17:43:15.724 | INFO     | __main__:<module>:86 - Needle: [' John went back to the office.', ' Sandra picked up the football.', ' John travelled to the kitchen.', ' Mary grabbed the football.', ' Sandra journeyed to the hallway.', ' Mary moved to the bedroom.', ' Sandra moved to the garden.', ' Daniel went to the office.']
2025-01-22 17:43:15.724 | INFO     | __main__:<module>:87 - Real Needle: [' Sandra picked up the football.', ' Sandra journeyed to the hallway.', ' Sandra moved to the garden.', ' Daniel went to the office.']
2025-01-22 17:43:15.724 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ’¶', 'ğŸ†’', 'ğŸ¤¾\u200dâ™‚', 'ğŸŒŠ', 'ğŸ™ğŸ¼', 'ğŸ•µğŸ»\u200dâ™€', 'ğŸ§ğŸ½\u200dâ™€\u200dâ¡', 'ğŸ§šğŸ¼\u200dâ™€', 'ğŸ‘°ğŸ¿\u200dâ™€', 'ğŸ•\u200dğŸ¦º']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.63s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.84s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.72s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.24s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.79s/it]
Processing depth (2, 6, 7, 8):   0%|          | 0/100 [00:16<?, ?it/s]2025-01-22 17:43:32.637 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra picked up the football.
2025-01-22 17:43:32.649 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1865, 1870) --> . Sandra picked up the
2025-01-22 17:43:32.649 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra journeyed to the hallway.
2025-01-22 17:43:32.675 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4788, 4794) -->  the senate. Sandra journeyed
2025-01-22 17:43:32.676 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the garden.
2025-01-22 17:43:32.718 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5745, 5750) --> . Sandra moved to the
2025-01-22 17:43:32.720 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went to the office.
2025-01-22 17:43:32.745 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3660, 3665) -->  back to the office.
2025-01-22 17:43:32.745 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the office.
2025-01-22 17:43:32.765 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3657, 3663) --> . John went back to the
2025-01-22 17:43:32.765 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the kitchen.
2025-01-22 17:43:32.774 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1725, 1730) --> . John travelled to the
2025-01-22 17:43:32.774 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary grabbed the football.
2025-01-22 17:43:32.813 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (7050, 7054) -->  Mary grabbed the football
2025-01-22 17:43:32.814 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the bedroom.
2025-01-22 17:43:32.820 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1232, 1237) -->  Republican. Mary moved to
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:43:33.602 | INFO     | test_jbb_embedding:begin_test:693 - the hallway<|eot_id|>
2025-01-22 17:43:33.602 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8222])
2025-01-22 17:43:35.875 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [270.29761904761904, 23.004395896656536, 224.965625, 21.876294446480937, 16.566548665364582], 'topk_indices': array([   1, 8204, 8216, 8209, 5750, 6088,    3, 8205, 5751, 1866,   24,
         14, 8213, 8210, 4796, 8212, 1870, 8220,    0, 8217]), 'topk_tokens': ['<|start_header_id|>', 'Question', ':', ' football', ' garden', 'the', '<|end_header_id|>', ':', '.', ' Sandra', '\n\n', '\n', '?', ' before', ' hallway', ' garden', ' football', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [386.6, 208.72916666666666, 287.25, 210.925]}, 'weight': {'score': [22.158482142857142, 23.323153495440728, 22.79453125, 23.32743386485826, 29.713216145833332], 'topk_indices': array([3295, 3322, 3215, 3167, 7463, 7425, 1485, 1423, 4281, 4297, 5139,
       5200, 7146, 7202, 3478, 3504, 4964, 4916, 4941, 4993]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [23.49375, 25.153645833333332, 21.040625, 18.346875]}, 'saliency': {'score': [1.6295921688988095, 0.12890374180756078, 1.3443603515625, 0.12208267763795974, 0.12604673703511557], 'topk_indices': array([1235, 8206,   24, 5746, 8215, 1727, 6088, 1867, 4791, 8213, 1238,
       7053, 5750, 8204, 8209, 8210, 1866, 8212, 4796, 1870]), 'topk_tokens': [' moved', ' Where', '\n\n', ' Sandra', 'Answer', ' travelled', 'the', ' picked', ' Sandra', '?', ' bedroom', ' football', ' garden', 'Question', ' football', ' before', ' Sandra', ' garden', ' hallway', ' football'], 'evidence_proportions': [2.4724609375, 1.3950602213541667, 1.58740234375, 1.1103515625]}}, 'pred_res': 'the hallway<|eot_id|>', 'score': 100}
2025-01-22 17:43:35.884 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:43:35.884 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-64_pid-0_2-6-7-8.pkl | len: 3 |  size: 2.04 KB
Processing depth (2, 6, 7, 8):   1%|          | 1/100 [00:20<33:06, 20.06s/it]is_0k: False
your chose emoji: ['ğŸƒğŸ¾\u200dâ™€ï¸', 'ğŸ§‘ğŸ¼\u200dğŸ¦³', 'ğŸƒğŸ»\u200dâ™‚\u200dâ¡', 'ğŸ', 'ğŸ‘°ğŸ¼\u200dâ™‚ï¸', 'ğŸ ', 'ğŸ§”ğŸ½\u200dâ™‚ï¸', 'ğŸ‘¨ğŸ½\u200dğŸ¦¯\u200dâ¡ï¸', 'ğŸ§‘ğŸ»\u200dğŸ”¬', 'ğŸ‘©ğŸ¿\u200dâ¤\u200dğŸ‘¨ğŸ¼']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.86s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.78s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.35s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.81s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.47s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (2, 3, 4, 9):   1%|          | 1/100 [00:35<33:06, 20.06s/it]2025-01-22 17:43:51.769 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra picked up the football.
2025-01-22 17:43:51.778 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1603, 1608) --> . Sandra picked up the
2025-01-22 17:43:51.778 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra journeyed to the hallway.
2025-01-22 17:43:51.793 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2839, 2845) --> . Sandra journeyed to the
2025-01-22 17:43:51.793 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the garden.
2025-01-22 17:43:51.811 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3568, 3573) --> . Sandra moved to the
2025-01-22 17:43:51.811 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went to the office.
2025-01-22 17:43:51.830 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3629, 3634) -->  back to the office.
2025-01-22 17:43:51.831 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the office.
2025-01-22 17:43:51.850 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3626, 3632) --> . John went back to the
2025-01-22 17:43:51.850 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the kitchen.
2025-01-22 17:43:51.858 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1431, 1436) --> . John travelled to the
2025-01-22 17:43:51.858 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary grabbed the football.
2025-01-22 17:43:51.893 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6918, 6922) -->  Mary grabbed the football
2025-01-22 17:43:51.893 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the bedroom.
2025-01-22 17:43:51.898 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1081, 1086) --> . Mary moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:43:54.869 | INFO     | test_jbb_embedding:begin_test:693 - the hallway<|eot_id|>
2025-01-22 17:43:54.869 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8144])
2025-01-22 17:43:57.830 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [255.95386904761904, 25.47477982693016, 261.0484375, 24.296450931408835, 25.30626370614035], 'topk_indices': array([1604, 8126, 8127,    3, 8131,  300, 1608, 1086, 8142, 3574,   14,
       6921, 2845, 8135, 8134,  759, 8132,  760, 8139,    0]), 'topk_tokens': [' Sandra', 'Question', ':', '<|end_header_id|>', ' football', 'ï¿½', ' football', ' bedroom', '<|end_header_id|>', '.', '\n', ' football', ' hallway', '?', ' garden', 'ï¿½', ' before', 'ï¿½', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [353.95, 327.7291666666667, 262.6, 65.18125]}, 'weight': {'score': [21.032738095238095, 23.25434976064809, 21.583203125, 23.264228465025905, 29.16831140350877], 'topk_indices': array([3298, 3325, 3170, 3218, 7435, 7397, 1521, 1459, 4330, 4314, 5149,
       5210, 7118, 7174, 3487, 3513, 4933, 4956, 4908, 4985]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [23.49375, 21.213541666666668, 21.040625, 18.346875]}, 'saliency': {'score': [1.4875139508928572, 0.1440997261261814, 1.574468994140625, 0.13709021661712775, 0.18689634088884322], 'topk_indices': array([1082,  300, 2840, 3573, 1083, 2841, 1433, 8135, 8126,  758,  759,
       8131, 1604, 8132, 1608, 1086, 6921,  760, 8134, 2845]), 'topk_tokens': [' Mary', 'ï¿½', ' Sandra', ' garden', ' moved', ' journey', ' travelled', '?', 'Question', 'ï¿½', 'ï¿½', ' football', ' Sandra', ' before', ' football', ' bedroom', ' football', 'ï¿½', ' garden', ' hallway'], 'evidence_proportions': [2.26640625, 1.962890625, 1.29501953125, 0.3306640625]}}, 'pred_res': 'the hallway<|eot_id|>', 'score': 100}
2025-01-22 17:43:57.849 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:43:57.849 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-64_pid-1_2-3-4-9.pkl | len: 3 |  size: 2.03 KB
Processing depth (2, 3, 4, 9):   2%|â–         | 2/100 [00:42<34:35, 21.18s/it]is_0k: False
your chose emoji: ['ğŸš´ğŸ»\u200dâ™‚', 'ğŸ§', 'ğŸ§˜ğŸ¾\u200dâ™€ï¸', 'ğŸ¦¹ğŸ¿\u200dâ™‚', 'ğŸ¤›ğŸ½', 'ğŸ”¼', 'ğŸ—¡', 'ğŸ¤’', 'ğŸ§œğŸ¿\u200dâ™€ï¸', '\U0001fa75']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.88s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.77s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.55s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.20s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.74s/it]
Processing depth (0, 2, 6, 9):   2%|â–         | 2/100 [00:59<34:35, 21.18s/it]2025-01-22 17:44:14.915 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra picked up the football.
2025-01-22 17:44:14.915 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (32, 37) -->  picked up the football.
2025-01-22 17:44:14.915 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra journeyed to the hallway.
2025-01-22 17:44:14.927 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1800, 1806) --> . Sandra journeyed to the
2025-01-22 17:44:14.927 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the garden.
2025-01-22 17:44:14.952 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4776, 4781) -->  the senate. Sandra moved
2025-01-22 17:44:14.952 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went to the office.
2025-01-22 17:44:14.970 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3646, 3651) -->  back to the office.
2025-01-22 17:44:14.970 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the office.
2025-01-22 17:44:14.989 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3642, 3648) -->  Hon. John went back to
2025-01-22 17:44:14.989 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the kitchen.
2025-01-22 17:44:14.999 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1574, 1579) --> . John travelled to the
2025-01-22 17:44:14.999 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary grabbed the football.
2025-01-22 17:44:15.034 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (7023, 7027) -->  Mary grabbed the football
2025-01-22 17:44:15.034 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the bedroom.
2025-01-22 17:44:15.040 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1120, 1125) --> . Mary moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:44:15.805 | INFO     | test_jbb_embedding:begin_test:693 - the bedroom<|eot_id|>
2025-01-22 17:44:15.805 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8187])
2025-01-22 17:44:18.020 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [358.82440476190476, 37.03130341880342, 387.659375, 35.34149895692723, 38.49489182692308], 'topk_indices': array([8177,   75,   24,  192, 1926, 8041, 8175,   39, 1125,   31, 1801,
       8182, 8183,   14, 1927, 1806, 2008, 1123, 1122,    0]), 'topk_tokens': [' garden', 'E', '\n\n', 'ION', ' arrival', ' context', ' before', 'ï¿½', ' bedroom', 'andra', ' Sandra', '<|eot_id|>', '<|start_header_id|>', '\n', ' of', ' hallway', ' arrival', ' to', ' moved', '<|begin_of_text|>'], 'evidence_proportions': [515.35, 556.7916666666666, 178.3625, 145.2]}, 'weight': {'score': [21.871279761904763, 23.292725503663004, 22.78515625, 23.297634295619094, 29.635616987179485], 'topk_indices': array([3273, 3300, 3193, 3145, 7400, 7438, 1430, 1492, 4309, 4325, 5209,
       5148, 7155, 7099, 3488, 3514, 4903, 4928, 4951, 4980]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.2875, 21.213541666666668, 25.76875, 18.346875]}, 'saliency': {'score': [2.1345738002232144, 0.21058199070894384, 2.1828125, 0.2007834340534498, 0.26444224822215545], 'topk_indices': array([7026, 2006,   37, 8169,  192, 8174,   35,   32, 8175, 1121, 1802,
       8177, 8041, 1926,   31, 1125, 1801, 1122, 2008, 1806]), 'topk_tokens': [' football', ' greet', 'ï¿½', 'Question', 'ION', ' football', ' football', ' picked', ' before', ' Mary', ' journey', ' garden', ' context', ' arrival', 'andra', ' bedroom', ' Sandra', ' moved', ' arrival', ' hallway'], 'evidence_proportions': [2.921875, 3.4051106770833335, 1.172021484375, 0.7851806640625]}}, 'pred_res': 'the bedroom<|eot_id|>', 'score': 0}
2025-01-22 17:44:18.024 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:44:18.025 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-64_pid-2_0-2-6-9.pkl | len: 3 |  size: 2.04 KB
Processing depth (0, 2, 6, 9):   3%|â–         | 3/100 [01:02<33:30, 20.72s/it]is_0k: False
your chose emoji: ['ğŸŒï¸\u200dâ™‚ï¸', 'ğŸ‘¨\u200dğŸ‘¦\u200dğŸ‘¦', 'âœ‚', 'ğŸ‘®\u200dâ™‚', 'ğŸ¦¸ğŸ½\u200dâ™‚', 'ğŸ›€', 'ğŸ§‘ğŸ¿\u200dâ¤ï¸\u200dğŸ§‘ğŸ¾', 'ğŸ§‘ğŸ¿\u200dğŸ³', 'ğŸ‘©\u200dğŸ¨', 'ğŸ‡³ğŸ‡·']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:05<00:15,  5.00s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.17s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.70s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.01s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.71s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 3, 4, 6):   3%|â–         | 3/100 [01:19<33:30, 20.72s/it]2025-01-22 17:44:34.994 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra picked up the football.
2025-01-22 17:44:34.994 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (32, 37) -->  picked up the football.
2025-01-22 17:44:34.995 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra journeyed to the hallway.
2025-01-22 17:44:35.012 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2973, 2979) -->  tragedy. Sandra journeyed to
2025-01-22 17:44:35.012 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the garden.
2025-01-22 17:44:35.030 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3598, 3603) -->  Sandra moved to the garden
2025-01-22 17:44:35.030 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went to the office.
2025-01-22 17:44:35.048 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3628, 3633) -->  back to the office.
2025-01-22 17:44:35.048 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the office.
2025-01-22 17:44:35.069 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3624, 3630) -->  Hon. John went back to
2025-01-22 17:44:35.069 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the kitchen.
2025-01-22 17:44:35.078 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1776, 1781) --> . John travelled to the
2025-01-22 17:44:35.078 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary grabbed the football.
2025-01-22 17:44:35.112 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6966, 6970) -->  grabbed the football.
2025-01-22 17:44:35.112 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the bedroom.
2025-01-22 17:44:35.118 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1266, 1271) --> . Mary moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:44:37.478 | INFO     | test_jbb_embedding:begin_test:693 - The hallway.<|eot_id|>
2025-01-22 17:44:37.478 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8159])
2025-01-22 17:44:41.776 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [231.42113095238096, 21.541763660867435, 161.20859375, 20.65507442125354, 22.362106323242188], 'topk_indices': array([  24, 8144, 2980, 1155, 1005, 8013, 1044,   29,   14,   39,   35,
         36, 8146, 8147, 1215,  540,   40, 8155,    0, 8154]), 'topk_tokens': ['\n\n', ' was', ' hallway', 'nes', ' states', ' context', ' of', '\n\n', '\n', '***', ' football', '.', ' football', ' before', 'nes', ',', '\n\n\n', '<|start_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [457.8, 252.14583333333334, 173.225, 38.36875]}, 'weight': {'score': [23.203125, 23.260090587478558, 21.628515625, 23.26425605682798, 28.942138671875], 'topk_indices': array([3290, 3263, 3129, 3177, 7412, 7374, 1412, 1474, 4285, 4301, 5140,
       5201, 7095, 7151, 3472, 3446, 4994, 4942, 4965, 4917]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.2875, 26.053385416666668, 25.5546875, 18.346875]}, 'saliency': {'score': [1.4001348586309523, 0.11994359400365259, 0.8855438232421875, 0.11474767956676749, 0.15669536590576172], 'topk_indices': array([8143,   32, 1003, 2976, 1214, 6968,   31, 8149, 1005, 1155, 2975,
       8013, 1043,   39,   35, 8147, 2980, 8146, 1215,   40]), 'topk_tokens': [' Where', ' picked', ' galaxy', ' journey', 'Min', ' football', 'andra', ' garden', ' states', 'nes', ' Sandra', ' context', ' galaxy', '***', ' football', ' before', ' hallway', ' football', 'nes', '\n\n\n'], 'evidence_proportions': [2.53232421875, 1.7176920572916667, 1.08515625, 0.20185546875]}}, 'pred_res': 'The hallway.<|eot_id|>', 'score': 100}
2025-01-22 17:44:41.783 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:44:41.783 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-64_pid-3_0-3-4-6.pkl | len: 3 |  size: 2.01 KB
Processing depth (0, 3, 4, 6):   4%|â–         | 4/100 [01:25<35:04, 21.92s/it]is_0k: False
your chose emoji: ['ğŸ‘¨ğŸ¼\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘¨ğŸ»', 'ğŸ‘©ğŸ»', 'ğŸ•µğŸ»', 'âš—', 'ğŸ‡­ğŸ‡²', 'ğŸ’±', '\U0001faf2', 'â›', 'ğŸ‘´ğŸ¾', 'ğŸ‘¨ğŸ½\u200dğŸ¦³']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.84s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:10,  5.03s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.97s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.42s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.99s/it]
Processing depth (3, 4, 5, 7):   4%|â–         | 4/100 [01:43<35:04, 21.92s/it]2025-01-22 17:44:59.756 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra picked up the football.
2025-01-22 17:44:59.770 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2843, 2848) --> . Sandra picked up the
2025-01-22 17:44:59.770 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra journeyed to the hallway.
2025-01-22 17:44:59.789 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3617, 3623) --> . Sandra journeyed to the
2025-01-22 17:44:59.789 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the garden.
2025-01-22 17:44:59.809 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4175, 4180) --> . Sandra moved to the
2025-01-22 17:44:59.810 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went to the office.
2025-01-22 17:44:59.828 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3649, 3654) -->  back to the office.
2025-01-22 17:44:59.828 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the office.
2025-01-22 17:44:59.846 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3645, 3651) -->  Hon. John went back to
2025-01-22 17:44:59.846 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the kitchen.
2025-01-22 17:44:59.854 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1567, 1572) --> . John travelled to the
2025-01-22 17:44:59.854 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary grabbed the football.
2025-01-22 17:44:59.894 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6968, 6972) -->  Mary grabbed the football
2025-01-22 17:44:59.894 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the bedroom.
2025-01-22 17:44:59.901 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1226, 1231) -->  Republican. Mary moved to
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:45:00.664 | INFO     | test_jbb_embedding:begin_test:693 - the office<|eot_id|>
2025-01-22 17:45:00.664 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8136])
2025-01-22 17:45:02.870 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [297.57142857142856, 23.541060019658435, 272.25625, 22.21617220301309, 18.01739386792453], 'topk_indices': array([4178, 8121, 8123, 2848,   14, 8117,   24, 4180, 8119,    3, 8125,
       8118, 3623, 8134, 4181, 8127, 8126, 8124, 8131,    0]), 'topk_tokens': [' to', ' was', ' football', ' football', '\n', '.\n\n', '\n\n', ' garden', ':', '<|end_header_id|>', ' the', 'Question', ' hallway', '<|end_header_id|>', '.', '?', ' garden', ' before', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [281.5, 321.1458333333333, 399.075, 183.85]}, 'weight': {'score': [21.032738095238095, 23.25643890527092, 23.996484375, 23.260377755309953, 29.77505896226415], 'topk_indices': array([3301, 3328, 3173, 3221, 7423, 7385, 1485, 1423, 4318, 4334, 5190,
       5129, 7098, 7154, 3510, 3484, 4931, 4954, 4983, 4906]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [23.49375, 21.213541666666668, 21.040625, 18.346875]}, 'saliency': {'score': [1.6519135974702381, 0.132015285920798, 1.67474365234375, 0.12426368899921277, 0.1311141679871757], 'topk_indices': array([  24, 4177, 8117, 3618, 8121, 6971, 3648, 3619, 8120, 2844, 1569,
       1232, 8123, 2848, 4180, 8127, 8118, 8124, 3623, 8126]), 'topk_tokens': ['\n\n', ' moved', '.\n\n', ' Sandra', ' was', ' football', ' went', ' journey', ' Where', ' Sandra', ' travelled', ' bedroom', ' football', ' football', ' garden', '?', 'Question', ' before', ' hallway', ' garden'], 'evidence_proportions': [1.8041015625, 1.8521728515625, 1.9146484375, 0.9966796875]}}, 'pred_res': 'the office<|eot_id|>', 'score': 0}
2025-01-22 17:45:02.878 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:45:02.878 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-64_pid-4_3-4-5-7.pkl | len: 3 |  size: 2.03 KB
Processing depth (3, 4, 5, 7):   5%|â–Œ         | 5/100 [01:47<34:14, 21.62s/it]Processing depth (3, 4, 5, 7):   5%|â–Œ         | 5/100 [01:47<33:56, 21.43s/it]
2025-01-22 17:45:02.984 | INFO     | __main__:<module>:82 - Selected idx: 66
2025-01-22 17:45:02.984 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the milk before the garden? 
2025-01-22 17:45:02.984 | INFO     | __main__:<module>:84 - Answer: bathroom
2025-01-22 17:45:02.984 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 17:45:02.984 | INFO     | __main__:<module>:86 - Needle: [' John picked up the milk.', ' Sandra went to the garden.', ' Sandra went to the bathroom.', ' John journeyed to the bathroom.', ' Mary moved to the bedroom.', ' John travelled to the garden.', ' Mary grabbed the football.']
2025-01-22 17:45:02.984 | INFO     | __main__:<module>:87 - Real Needle: [' John picked up the milk.', ' John journeyed to the bathroom.', ' John travelled to the garden.', ' Mary grabbed the football.']
2025-01-22 17:45:02.984 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ’‡ğŸ¿\u200dâ™‚ï¸', 'ğŸ˜„', 'ğŸ¥š', 'ğŸš¶\u200dâ™€ï¸', 'ğŸ”®', 'ğŸ‘©ğŸ¼\u200dğŸ¦¼', 'ğŸ—œï¸', 'ğŸ¦»', 'ğŸ‘³ğŸ¿\u200dâ™‚ï¸', 'ğŸŒ”']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  3.97s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.49s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.72s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.28s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.73s/it]
Processing depth (0, 2, 4, 6):   0%|          | 0/100 [00:16<?, ?it/s]2025-01-22 17:45:20.153 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John picked up the milk.
2025-01-22 17:45:20.153 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the milk.
2025-01-22 17:45:20.154 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bathroom.
2025-01-22 17:45:20.165 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1793, 1799) --> . John journeyed to the
2025-01-22 17:45:20.165 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the garden.
2025-01-22 17:45:20.190 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3622, 3627) --> . John travelled to the
2025-01-22 17:45:20.191 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary grabbed the football.
2025-01-22 17:45:20.221 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4729, 4733) -->  Mary grabbed the football
2025-01-22 17:45:20.221 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went to the garden.
2025-01-22 17:45:20.241 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3512, 3517) --> . Sandra went to the
2025-01-22 17:45:20.241 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went to the bathroom.
2025-01-22 17:45:20.261 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3512, 3517) --> . Sandra went to the
2025-01-22 17:45:20.261 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary moved to the bedroom.
2025-01-22 17:45:20.299 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6401, 6406) --> . Mary moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:45:21.188 | INFO     | test_jbb_embedding:begin_test:693 - John picked up the milk.<|eot_id|>
2025-01-22 17:45:21.188 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8145])
2025-01-22 17:45:23.400 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [433.6828125, 52.13460358370152, 302.025, 50.73200033896216, 28.00281762295082], 'topk_indices': array([ 184, 8043,   35,   74, 1799,  105, 8135, 7032, 7290,   14, 7531,
         24, 7338, 7487, 7532, 7261, 8140,  185, 7339,    0]), 'topk_tokens': [' P', ' location', '.', ' PA', ' bathroom', 'ION', ' garden', ' to', 'nes', '\n', ' Min', '\n\n', ' Min', 'nes', 'nes', 'nes', '<|eot_id|>', 'ION', 'nes', '<|begin_of_text|>'], 'evidence_proportions': [810.4, 479.5416666666667, 282.05, 83.5390625]}, 'weight': {'score': [21.980859375, 23.252644437285223, 20.413541666666667, 23.2610287886725, 28.692110655737704], 'topk_indices': array([3321, 3294, 3214, 3166, 7386, 7424, 1479, 1417, 4325, 4309, 5137,
       5198, 7107, 7163, 3477, 3503, 4908, 4991, 4933, 4962]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.025, 19.4140625, 19.990625, 28.263671875]}, 'saliency': {'score': [2.3867919921875, 0.29476570650006134, 1.52333984375, 0.2873369948308271, 0.20083343005571208], 'topk_indices': array([8133,   67, 7999,  105,   38,   63, 8043, 8132,   31,   74, 7290,
       8135, 7532, 7531, 7487, 7338, 1799, 7261,  185, 7339]), 'topk_tokens': [' before', 'ION', ' context', 'ION', '***', 'ISC', ' location', ' milk', ' picked', ' PA', 'nes', ' garden', 'nes', ' Min', 'nes', ' Min', ' bathroom', 'nes', 'ION', 'nes'], 'evidence_proportions': [4.5078125, 2.5693359375, 1.45712890625, 0.623779296875]}}, 'pred_res': 'John picked up the milk.<|eot_id|>', 'score': 0}
2025-01-22 17:45:23.408 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:45:23.410 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-66_pid-0_0-2-4-6.pkl | len: 3 |  size: 1.96 KB
Processing depth (0, 2, 4, 6):   1%|          | 1/100 [00:20<33:31, 20.32s/it]is_0k: False
your chose emoji: ['ğŸ§˜ğŸ¾\u200dâ™‚', 'ğŸ§ğŸ¾', 'ğŸš€', 'ğŸ–•ğŸ»', 'ğŸ§—', 'ğŸ¤˜ğŸ¿', 'ğŸ‘©ğŸ¼\u200dâ¤ï¸\u200dğŸ‘©ğŸ¾', 'ğŸ§„', 'ğŸ“™', 'ğŸ¤±ğŸ½']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.64s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.88s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.66s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.19s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.76s/it]
Processing depth (1, 3, 5, 8):   1%|          | 1/100 [00:37<33:31, 20.32s/it]2025-01-22 17:45:40.306 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John picked up the milk.
2025-01-22 17:45:40.311 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (895, 900) --> . John picked up the
2025-01-22 17:45:40.311 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bathroom.
2025-01-22 17:45:40.327 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2917, 2923) --> . John journeyed to the
2025-01-22 17:45:40.327 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the garden.
2025-01-22 17:45:40.348 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4213, 4218) -->  John travelled to the garden
2025-01-22 17:45:40.348 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary grabbed the football.
2025-01-22 17:45:40.384 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6569, 6573) -->  Mary grabbed the football
2025-01-22 17:45:40.384 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went to the garden.
2025-01-22 17:45:40.402 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3522, 3527) --> . Sandra went to the
2025-01-22 17:45:40.402 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went to the bathroom.
2025-01-22 17:45:40.420 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3522, 3527) --> . Sandra went to the
2025-01-22 17:45:40.420 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary moved to the bedroom.
2025-01-22 17:45:40.454 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6382, 6387) --> . Mary moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:45:41.344 | INFO     | test_jbb_embedding:begin_test:693 - John picked up the milk.<|eot_id|>
2025-01-22 17:45:41.344 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8113])
2025-01-22 17:45:43.615 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [156.07734375, 15.835148164120257, 95.93541666666667, 15.339374381264696, 36.12007378472222], 'topk_indices': array([   4, 8001, 7866,    3,  895, 8103, 8112,   23,  900, 8011,    9,
       8101,    1,  901,   14,   24, 8108,    0, 8109, 8111]), 'topk_tokens': ['\n\n', '.\n\n', ' Square', '<|end_header_id|>', '.', ' garden', '\n\n', '4', ' milk', ' location', ':', ' before', '<|start_header_id|>', '.', '\n', '\n\n', '<|eot_id|>', '<|begin_of_text|>', '<|start_header_id|>', '<|end_header_id|>'], 'evidence_proportions': [309.95, 148.82291666666666, 103.475, 40.37109375]}, 'weight': {'score': [22.93671875, 23.23738410239034, 20.413541666666667, 23.24336986449697, 29.275347222222223], 'topk_indices': array([3258, 3285, 3178, 3130, 7368, 7406, 1411, 1473, 4265, 4281, 5082,
       5143, 7089, 7145, 3467, 3441, 4907, 4859, 4884, 4936]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.334375, 19.4140625, 24.5046875, 28.263671875]}, 'saliency': {'score': [0.8915176391601562, 0.08714414759185174, 0.4847493489583333, 0.0844153333545218, 0.2663236829969618], 'topk_indices': array([8085, 8095, 6684,   16,    0, 6685,    8, 8082, 8110, 2923,  257,
        897, 6682, 8100, 7866, 8011,   24, 8103,  900, 8101]), 'topk_tokens': [' directly', 'Question', 'ï¿½', ' Date', '<|begin_of_text|>', 'ï¿½', ' Date', ' return', 'assistant', ' bathroom', 'hue', ' picked', 'ï¿½', ' milk', ' Square', ' location', '\n\n', ' garden', ' milk', ' before'], 'evidence_proportions': [1.66357421875, 0.8155924479166666, 0.678076171875, 0.30713653564453125]}}, 'pred_res': 'John picked up the milk.<|eot_id|>', 'score': 0}
2025-01-22 17:45:43.622 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:45:43.623 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-66_pid-1_1-3-5-8.pkl | len: 3 |  size: 2.05 KB
Processing depth (1, 3, 5, 8):   2%|â–         | 2/100 [00:40<33:05, 20.26s/it]is_0k: False
your chose emoji: ['ğŸ§”ğŸ»\u200dâ™€', 'ğŸ§‘\u200dğŸ³', 'ğŸ›', 'ğŸš', 'ğŸŸ¢', 'â›¸ï¸', 'ğŸ¤¹\u200dâ™€ï¸', 'ğŸ¦Š', 'ğŸ‡¹ğŸ‡¹', 'â‡']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.78s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.78s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.77s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.31s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.85s/it]
Processing depth (2, 4, 6, 7):   2%|â–         | 2/100 [00:57<33:05, 20.26s/it]2025-01-22 17:46:00.850 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John picked up the milk.
2025-01-22 17:46:00.860 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1871, 1876) --> . John picked up the
2025-01-22 17:46:00.860 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bathroom.
2025-01-22 17:46:00.879 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3654, 3660) -->  Hon. John journeyed to
2025-01-22 17:46:00.880 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the garden.
2025-01-22 17:46:00.904 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4664, 4669) --> . John travelled to the
2025-01-22 17:46:00.904 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary grabbed the football.
2025-01-22 17:46:00.937 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5591, 5595) -->  Mary grabbed the football
2025-01-22 17:46:00.937 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went to the garden.
2025-01-22 17:46:00.955 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3557, 3562) --> . Sandra went to the
2025-01-22 17:46:00.955 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went to the bathroom.
2025-01-22 17:46:00.973 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3557, 3562) --> . Sandra went to the
2025-01-22 17:46:00.973 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary moved to the bedroom.
2025-01-22 17:46:01.009 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6429, 6434) --> . Mary moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:46:01.890 | INFO     | test_jbb_embedding:begin_test:693 - John picked up the milk.<|eot_id|>
2025-01-22 17:46:01.890 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8173])
2025-01-22 17:46:04.125 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [179.6828125, 18.88530837206458, 155.72083333333333, 18.238154096548335, 26.42971354166667], 'topk_indices': array([3563, 8061, 8154, 8172,    1,    9, 8156, 8071, 8158, 8162, 8164,
       8160,   24,   14, 8163, 8161, 8171, 8168,    0, 8169]), 'topk_tokens': ['.', '.\n\n', '.\n\n', '\n\n', '<|start_header_id|>', ':', ':', ' location', ' was', ' the', '?', ' milk', '\n\n', '\n', ' garden', ' before', '<|end_header_id|>', '<|eot_id|>', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [277.775, 201.85416666666666, 165.9625, 40.9609375]}, 'weight': {'score': [23.01015625, 23.280988181873777, 20.413541666666667, 23.286936878147646, 29.236875], 'topk_indices': array([3320, 3293, 3213, 3165, 7464, 7426, 1497, 1435, 4355, 4339, 5172,
       5233, 7203, 7147, 3502, 3476, 4970, 4945, 5022, 4993]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.334375, 23.420572916666668, 19.990625, 28.263671875]}, 'saliency': {'score': [1.0195999145507812, 0.10408893443367019, 0.8060017903645833, 0.10054650568519877, 0.19475189208984375], 'topk_indices': array([8154, 7757, 8170,    0, 8142,    8, 8158, 1873, 7924, 3661, 3562,
       8157,   24, 8164, 1876, 8071, 8155, 8160, 8163, 8161]), 'topk_tokens': ['.\n\n', 'inen', 'assistant', '<|begin_of_text|>', ' return', ' Date', ' was', ' picked', ' Square', ' bathroom', ' garden', ' Where', '\n\n', '?', ' milk', ' location', 'Question', ' milk', ' garden', ' before'], 'evidence_proportions': [1.5685546875, 1.1289876302083333, 0.9017578125, 0.31662750244140625]}}, 'pred_res': 'John picked up the milk.<|eot_id|>', 'score': 0}
2025-01-22 17:46:04.134 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:46:04.134 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-66_pid-2_2-4-6-7.pkl | len: 3 |  size: 2.03 KB
Processing depth (2, 4, 6, 7):   3%|â–         | 3/100 [01:01<32:56, 20.37s/it]is_0k: False
your chose emoji: ['ğŸ’ğŸ¿', 'ğŸ‡¨ğŸ‡²', '\U0001fac5ğŸ¾', 'ğŸ‘©ğŸ¿\u200dâ¤\u200dğŸ’‹\u200dğŸ‘¨ğŸ»', 'ğŸš£ğŸ¼\u200dâ™‚', 'ğŸ§‘ğŸ¼\u200dğŸ­', 'ğŸ“', 'ğŸ‘¨ğŸ½\u200dğŸ¦¯\u200dâ¡', 'ğŸ¸', 'ğŸ‘¨']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.49s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.54s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.46s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.90s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.48s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 1, 5, 8):   3%|â–         | 3/100 [01:16<32:56, 20.37s/it]2025-01-22 17:46:20.038 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John picked up the milk.
2025-01-22 17:46:20.039 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the milk.
2025-01-22 17:46:20.039 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bathroom.
2025-01-22 17:46:20.044 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (901, 907) --> . John journeyed to the
2025-01-22 17:46:20.045 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the garden.
2025-01-22 17:46:20.065 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4206, 4211) --> . John travelled to the
2025-01-22 17:46:20.066 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary grabbed the football.
2025-01-22 17:46:20.108 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6639, 6643) -->  Mary grabbed the football
2025-01-22 17:46:20.111 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went to the garden.
2025-01-22 17:46:20.144 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3490, 3495) --> . Sandra went to the
2025-01-22 17:46:20.144 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went to the bathroom.
2025-01-22 17:46:20.165 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3490, 3495) --> . Sandra went to the
2025-01-22 17:46:20.165 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary moved to the bedroom.
2025-01-22 17:46:20.202 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6452, 6457) --> . Mary moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:46:23.890 | INFO     | test_jbb_embedding:begin_test:693 - John's house.<|eot_id|>
2025-01-22 17:46:23.890 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8191])
2025-01-22 17:46:26.671 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [506.4625, 31.636159079814497, 177.64583333333334, 30.20379335702905, 9.859956287202381], 'topk_indices': array([   1, 8178,  903, 7309, 7386,   24,   69,   35,   66,  905,  904,
        907,  906, 8187,   67, 8186, 7387,   68,  105,    0]), 'topk_tokens': ['<|start_header_id|>', ' milk', ' journey', 'nes', ' Min', '\n\n', 'ER', '.', ' P', ' to', 'ed', ' bathroom', ' the', '<|start_header_id|>', 'ION', '<|eot_id|>', 'nes', 'E', 'ION', '<|begin_of_text|>'], 'evidence_proportions': [757.0, 853.9583333333334, 212.575, 39.40625]}, 'weight': {'score': [21.980859375, 23.292651253966316, 20.413541666666667, 23.301159953732075, 29.154017857142858], 'topk_indices': array([3324, 3351, 3244, 3196, 7434, 7472, 1472, 1534, 4365, 4349, 5221,
       5160, 7155, 7211, 3539, 3513, 5014, 4962, 4937, 4985]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.025, 19.4140625, 19.990625, 28.263671875]}, 'saliency': {'score': [2.5574798583984375, 0.17805823227647516, 0.9126668294270833, 0.17087505278392726, 0.07279950096493676], 'topk_indices': array([ 185, 8179,  904,   41, 8181,   63,   38,   66, 7338,   31,   34,
       7309, 8178,  903, 7386,   68,   67,  105,  907, 7387]), 'topk_tokens': ['ION', ' before', 'ed', '-text', ' garden', 'ISC', '***', ' P', 'nes', ' picked', ' milk', 'nes', ' milk', ' journey', ' Min', 'E', 'ION', 'ION', ' bathroom', 'nes'], 'evidence_proportions': [4.13359375, 3.9431966145833335, 1.13017578125, 0.2928924560546875]}}, 'pred_res': "John's house.<|eot_id|>", 'score': 0}
2025-01-22 17:46:26.685 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:46:26.686 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-66_pid-3_0-1-5-8.pkl | len: 3 |  size: 1.97 KB
Processing depth (0, 1, 5, 8):   4%|â–         | 4/100 [01:23<33:58, 21.23s/it]is_0k: False
your chose emoji: ['â†˜', 'ğŸ§‘ğŸ»\u200dğŸ¤\u200dğŸ§‘ğŸ¾', 'ğŸ§‘ğŸ»\u200dğŸ¦¼', 'ğŸ¤¸ğŸ½\u200dâ™‚ï¸', 'ğŸ¦“', 'ğŸ§‘ğŸ¼\u200dğŸ¤\u200dğŸ§‘ğŸ¿', 'ğŸš½', 'ğŸ¤’', 'ğŸ‘©\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘¨', 'ğŸ‘´ğŸ»']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:05<00:15,  5.03s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.95s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.81s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.33s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.90s/it]
Processing depth (2, 3, 4, 6):   4%|â–         | 4/100 [01:40<33:58, 21.23s/it]2025-01-22 17:46:44.042 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John picked up the milk.
2025-01-22 17:46:44.052 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1841, 1846) --> . John picked up the
2025-01-22 17:46:44.052 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bathroom.
2025-01-22 17:46:44.067 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2879, 2885) --> . John journeyed to the
2025-01-22 17:46:44.067 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the garden.
2025-01-22 17:46:44.085 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3619, 3624) -->  Hon. John travelled to
2025-01-22 17:46:44.085 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary grabbed the football.
2025-01-22 17:46:44.111 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4855, 4859) -->  Mary grabbed the football
2025-01-22 17:46:44.111 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went to the garden.
2025-01-22 17:46:44.130 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3494, 3499) --> . Sandra went to the
2025-01-22 17:46:44.130 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went to the bathroom.
2025-01-22 17:46:44.147 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3494, 3499) --> . Sandra went to the
2025-01-22 17:46:44.147 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary moved to the bedroom.
2025-01-22 17:46:44.179 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6413, 6418) --> . Mary moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:46:45.009 | INFO     | test_jbb_embedding:begin_test:693 - John's house.<|eot_id|>
2025-01-22 17:46:45.009 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8147])
2025-01-22 17:46:47.235 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [154.8984375, 15.85793615797546, 143.5125, 15.27930048521257, 12.896689138104838], 'topk_indices': array([8146, 2885,    9, 8035, 8130,   25, 8132, 8136,    3, 8138,    1,
       8134, 8137,   14,   24, 8135, 8142,    0, 8145, 8143]), 'topk_tokens': ['\n\n', ' bathroom', ':', '.\n\n', ':', '<|eot_id|>', ' was', ' the', '<|end_header_id|>', '?', '<|start_header_id|>', ' milk', ' garden', '\n', '\n\n', ' before', '<|eot_id|>', '<|begin_of_text|>', '<|end_header_id|>', '<|start_header_id|>'], 'evidence_proportions': [294.525, 149.97916666666666, 107.84375, 46.5625]}, 'weight': {'score': [23.01015625, 23.275024923312884, 20.413541666666667, 23.280966959334567, 30.09375], 'topk_indices': array([3276, 3303, 3196, 3148, 7388, 7426, 1399, 1461, 4287, 4303, 5180,
       5119, 7159, 7103, 3459, 3485, 4880, 4961, 4932, 4905]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.334375, 19.4140625, 24.7984375, 28.263671875]}, 'saliency': {'score': [0.88414306640625, 0.08738800236052531, 0.712548828125, 0.08426877701642406, 0.09692530478200605], 'topk_indices': array([8119, 1544,   16, 1844, 3499, 8132, 8116, 8144, 8138, 8131, 8045,
       7886, 1846, 1843, 8129,   24, 2885, 8134, 8137, 8135]), 'topk_tokens': [' directly', 'ï¿½', ' Date', ' up', ' garden', ' was', ' return', 'assistant', '?', ' Where', ' location', ' Square', ' milk', ' picked', 'Question', '\n\n', ' bathroom', ' milk', ' garden', ' before'], 'evidence_proportions': [1.676953125, 0.7617594401041666, 0.667138671875, 0.34796142578125]}}, 'pred_res': "John's house.<|eot_id|>", 'score': 0}
2025-01-22 17:46:47.242 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:46:47.242 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-66_pid-4_2-3-4-6.pkl | len: 3 |  size: 2.04 KB
Processing depth (2, 3, 4, 6):   5%|â–Œ         | 5/100 [01:44<33:13, 20.99s/it]Processing depth (2, 3, 4, 6):   5%|â–Œ         | 5/100 [01:44<33:00, 20.85s/it]
2025-01-22 17:46:47.327 | INFO     | __main__:<module>:82 - Selected idx: 68
2025-01-22 17:46:47.327 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the milk before the kitchen? 
2025-01-22 17:46:47.327 | INFO     | __main__:<module>:84 - Answer: garden
2025-01-22 17:46:47.327 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 17:46:47.327 | INFO     | __main__:<module>:86 - Needle: [' Sandra went to the garden.', ' Sandra moved to the office.', ' Mary moved to the bedroom.', ' John got the milk.', ' Daniel went to the office.', ' John travelled to the garden.', ' Sandra went to the bathroom.', ' Sandra moved to the garden.', ' Sandra picked up the apple there.', ' John went back to the kitchen.', ' Sandra dropped the apple.']
2025-01-22 17:46:47.327 | INFO     | __main__:<module>:87 - Real Needle: [' John got the milk.', ' John travelled to the garden.', ' John went back to the kitchen.', ' Sandra dropped the apple.']
2025-01-22 17:46:47.327 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ§ğŸ½\u200dâ™€ï¸\u200dâ¡ï¸', 'ğŸ‘´ğŸ¼', 'ğŸŒğŸ»\u200dâ™‚ï¸', 'ğŸ˜Œ', 'ğŸ’†ğŸ¾\u200dâ™€', 'ğŸ“¡', 'ğŸ‘‡ğŸ¼', 'â†ªï¸', 'ğŸŒ¯', 'ğŸ¤¸ğŸ»\u200dâ™‚']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.64s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.71s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.43s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.10s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.64s/it]
Processing depth (2, 3, 8, 9):   0%|          | 0/100 [00:16<?, ?it/s]2025-01-22 17:47:03.783 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John got the milk.
2025-01-22 17:47:03.792 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1799, 1803) -->  John got the milk
2025-01-22 17:47:03.793 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the garden.
2025-01-22 17:47:03.807 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2887, 2892) --> . John travelled to the
2025-01-22 17:47:03.807 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the kitchen.
2025-01-22 17:47:03.840 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6511, 6517) --> . John went back to the
2025-01-22 17:47:03.841 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra dropped the apple.
2025-01-22 17:47:03.876 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7148, 7152) -->  dropped the apple.
2025-01-22 17:47:03.876 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went to the garden.
2025-01-22 17:47:03.883 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1281, 1286) --> . Sandra went to the
2025-01-22 17:47:03.883 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the office.
2025-01-22 17:47:03.897 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2704, 2709) -->  first. Sandra moved to
2025-01-22 17:47:03.897 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary moved to the bedroom.
2025-01-22 17:47:03.916 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3694, 3699) -->  Mary moved to the bedroom
2025-01-22 17:47:03.916 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went to the office.
2025-01-22 17:47:03.949 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6562, 6567) --> . Daniel went to the
2025-01-22 17:47:03.949 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra went to the bathroom.
2025-01-22 17:47:03.956 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1281, 1286) --> . Sandra went to the
2025-01-22 17:47:03.956 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra moved to the garden.
2025-01-22 17:47:03.962 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (1282, 1287) -->  Sandra went to the garden
2025-01-22 17:47:03.962 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Sandra picked up the apple there.
2025-01-22 17:47:03.970 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (1571, 1577) --> . Sandra picked up the apple
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:47:04.756 | INFO     | test_jbb_embedding:begin_test:693 - the kitchen<|eot_id|>
2025-01-22 17:47:04.756 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8199])
2025-01-22 17:47:06.989 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [175.30756578947367, 16.344077663984393, 126.96006944444444, 15.484561034736712, 11.699848375822368], 'topk_indices': array([1799,    1, 8198, 6518, 1802, 8048, 8188,    4, 8190, 8097,   24,
       8197, 8195,    9, 8189, 8087, 8187,   14, 8194,    0]), 'topk_tokens': [' John', '<|start_header_id|>', '\n\n', '.', ' milk', '\n', ' the', '\n\n', '?', ' location', '\n\n', '<|end_header_id|>', '<|start_header_id|>', ':', ' kitchen', '.\n\n', ' before', '\n', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [381.4375, 108.35, 184.22916666666666, 39.4921875]}, 'weight': {'score': [21.34580592105263, 23.28536294501341, 23.02582465277778, 23.29103312569044, 29.476151315789473], 'topk_indices': array([3310, 3283, 3155, 3203, 7436, 7474, 1427, 1489, 4330, 4346, 5159,
       5220, 7213, 7157, 3512, 3486, 4961, 4936, 4984, 5013]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [25.326171875, 19.990625, 20.0703125, 20.97265625]}, 'saliency': {'score': [1.0261872944078947, 0.08945421741172123, 0.7864608764648438, 0.08418968222222328, 0.08764297083804481], 'topk_indices': array([1286,    9, 1576, 1800, 8192, 8190, 8053,   24, 8181, 8183,    8,
       1799, 6517,   14, 8186, 8087, 1802, 8097, 8187, 8189]), 'topk_tokens': [' garden', ':', ' apple', ' got', 'Answer', '?', ' context', '\n\n', 'Question', ' Where', ' Date', ' John', ' kitchen', '\n', ' milk', '.\n\n', ' milk', ' location', ' before', ' kitchen'], 'evidence_proportions': [2.56103515625, 0.6042236328125, 0.8897705078125, 0.223419189453125]}}, 'pred_res': 'the kitchen<|eot_id|>', 'score': 0}
2025-01-22 17:47:07.006 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:47:07.006 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-68_pid-0_2-3-8-9.pkl | len: 3 |  size: 1.99 KB
Processing depth (2, 3, 8, 9):   1%|          | 1/100 [00:19<32:18, 19.58s/it]is_0k: False
your chose emoji: ['ğŸ’‚ğŸ»\u200dâ™‚', 'ğŸ‘¨ğŸ»\u200dğŸ¤\u200dğŸ‘¨ğŸ½', 'ğŸ’ğŸ½\u200dâ™‚', 'âœˆï¸', 'ğŸ§”ğŸ»\u200dâ™‚', 'ğŸ•µğŸ½\u200dâ™‚ï¸', 'ğŸ¦º', 'âš›ï¸', 'âš”', 'ğŸ§‘\u200dğŸ§‘\u200dğŸ§’']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:05<00:15,  5.07s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.10s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.19s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.72s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.44s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 4, 6, 8):   1%|          | 1/100 [00:35<32:18, 19.58s/it]2025-01-22 17:47:22.687 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John got the milk.
2025-01-22 17:47:22.728 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the garden.
2025-01-22 17:47:22.748 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3614, 3619) -->  John travelled to the garden
2025-01-22 17:47:22.749 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the kitchen.
2025-01-22 17:47:22.773 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4773, 4779) -->  the senate. John went back
2025-01-22 17:47:22.773 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra dropped the apple.
2025-01-22 17:47:22.806 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6521, 6525) -->  Sandra dropped the apple
2025-01-22 17:47:22.806 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went to the garden.
2025-01-22 17:47:22.814 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1506, 1511) --> . Sandra went to the
2025-01-22 17:47:22.814 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the office.
2025-01-22 17:47:22.828 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2811, 2816) -->  moved to the garden.
2025-01-22 17:47:22.828 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary moved to the bedroom.
2025-01-22 17:47:22.847 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3781, 3786) --> . Mary moved to the
2025-01-22 17:47:22.847 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went to the office.
2025-01-22 17:47:22.880 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6623, 6628) --> . Daniel went to the
2025-01-22 17:47:22.881 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra went to the bathroom.
2025-01-22 17:47:22.888 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1506, 1511) --> . Sandra went to the
2025-01-22 17:47:22.888 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra moved to the garden.
2025-01-22 17:47:22.897 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (1507, 1512) -->  Sandra went to the garden
2025-01-22 17:47:22.897 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Sandra picked up the apple there.
2025-01-22 17:47:22.906 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (1716, 1722) --> . Sandra picked up the apple
2025-01-22 17:47:22.906 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 17:47:22.906 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 17:47:22.906 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 17:47:22.906 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ§‘\u200dâœˆï¸', 'ğŸ¤µ\u200dâ™‚', 'ğŸ‡µğŸ‡¼', 'ğŸ’†ğŸ¿\u200dâ™‚', 'ğŸ‘¨ğŸ¿\u200dğŸ¦¼', 'ğŸ‘©ğŸ½\u200dğŸš’', 'âœ‰ï¸', 'ğŸ˜³', 'ğŸ›…', 'ğŸ§‘ğŸ»\u200dğŸ¼']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.72s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.58s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.45s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.15s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.66s/it]
Processing depth (0, 3, 4, 8):   1%|          | 1/100 [00:51<32:18, 19.58s/it]2025-01-22 17:47:39.318 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John got the milk.
2025-01-22 17:47:39.367 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the garden.
2025-01-22 17:47:39.382 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3055, 3060) --> . John travelled to the
2025-01-22 17:47:39.383 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the kitchen.
2025-01-22 17:47:39.409 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3731, 3737) --> . John went back to the
2025-01-22 17:47:39.409 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra dropped the apple.
2025-01-22 17:47:39.447 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6665, 6669) -->  Sandra dropped the apple
2025-01-22 17:47:39.447 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went to the garden.
2025-01-22 17:47:39.456 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1506, 1511) --> . Sandra went to the
2025-01-22 17:47:39.456 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the office.
2025-01-22 17:47:39.471 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2909, 2914) --> . Sandra moved to the
2025-01-22 17:47:39.471 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary moved to the bedroom.
2025-01-22 17:47:39.492 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3874, 3879) --> . Mary moved to the
2025-01-22 17:47:39.492 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went to the office.
2025-01-22 17:47:39.539 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6701, 6706) --> . Daniel went to the
2025-01-22 17:47:39.540 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra went to the bathroom.
2025-01-22 17:47:39.547 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1506, 1511) --> . Sandra went to the
2025-01-22 17:47:39.547 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra moved to the garden.
2025-01-22 17:47:39.555 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (1507, 1512) -->  Sandra went to the garden
2025-01-22 17:47:39.555 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Sandra picked up the apple there.
2025-01-22 17:47:39.564 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (1774, 1780) --> . Sandra picked up the apple
2025-01-22 17:47:39.564 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 17:47:39.564 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 17:47:39.564 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 17:47:39.564 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ', 'ğŸª—', 'ğŸ’ƒğŸ¾', 'ğŸ—“', 'ğŸ‡°ğŸ‡¼', 'ğŸ§', 'ğŸ‘©ğŸ¿\u200dâ¤\u200dğŸ’‹\u200dğŸ‘¨ğŸ¿', 'ğŸ‘©ğŸ¼\u200dâ¤ï¸\u200dğŸ‘©ğŸ¾', 'ğŸ§‘ğŸ¾\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ§‘ğŸ¿', 'ğŸ•µğŸ¼\u200dâ™‚ï¸']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.72s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.44s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.26s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.93s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.48s/it]
Processing depth (2, 3, 4, 6):   1%|          | 1/100 [01:07<32:18, 19.58s/it]2025-01-22 17:47:55.380 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John got the milk.
2025-01-22 17:47:55.390 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1877, 1881) -->  John got the milk
2025-01-22 17:47:55.390 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the garden.
2025-01-22 17:47:55.405 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3000, 3005) -->  tragedy. John travelled to
2025-01-22 17:47:55.405 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the kitchen.
2025-01-22 17:47:55.424 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3670, 3676) -->  Hon. John went back to
2025-01-22 17:47:55.424 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra dropped the apple.
2025-01-22 17:47:55.447 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4797, 4801) -->  Sandra dropped the apple
2025-01-22 17:47:55.447 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went to the garden.
2025-01-22 17:47:55.454 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1405, 1410) --> . Sandra went to the
2025-01-22 17:47:55.454 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the office.
2025-01-22 17:47:55.469 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2881, 2886) --> . Sandra moved to the
2025-01-22 17:47:55.469 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary moved to the bedroom.
2025-01-22 17:47:55.488 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3866, 3871) --> . Mary moved to the
2025-01-22 17:47:55.488 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went to the office.
2025-01-22 17:47:55.523 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6697, 6702) --> . Daniel went to the
2025-01-22 17:47:55.524 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra went to the bathroom.
2025-01-22 17:47:55.532 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1405, 1410) --> . Sandra went to the
2025-01-22 17:47:55.533 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra moved to the garden.
2025-01-22 17:47:55.543 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (1406, 1411) -->  Sandra went to the garden
2025-01-22 17:47:55.543 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Sandra picked up the apple there.
2025-01-22 17:47:55.554 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (1735, 1741) --> . Sandra picked up the apple
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:47:56.367 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 17:47:56.367 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8217])
2025-01-22 17:47:58.656 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [305.61513157894734, 27.00008553832117, 185.63107638888889, 25.652332746478873, 18.31001838235294], 'topk_indices': array([8202, 8211, 8115, 8208, 8200, 1878, 8203,   24, 8207, 8215, 1880,
       8105, 8071, 1879, 8204,   14, 8205, 8212,    0, 8213]), 'topk_tokens': [' was', ':', ' location', '?', ':', ' got', ' the', '\n\n', ' kitchen', '<|end_header_id|>', ' milk', '.\n\n', ' context', ' the', ' milk', '\n', ' before', '<|eot_id|>', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [713.875, 271.2375, 216.16666666666666, 74.5]}, 'weight': {'score': [25.723684210526315, 23.304084930048663, 21.845703125, 23.304884606552356, 29.72591911764706], 'topk_indices': array([3322, 3295, 3215, 3167, 7498, 7460, 1433, 1495, 4363, 4347, 5199,
       5260, 7181, 7237, 3542, 3516, 5001, 5053, 4976, 5024]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [25.326171875, 25.7984375, 24.076822916666668, 28.498046875]}, 'saliency': {'score': [1.855186060855263, 0.1484197983196472, 1.108811272515191, 0.14021371723462378, 0.13658590877757354], 'topk_indices': array([8202, 3006, 8189,   24, 8208, 8111, 1877, 8186, 3003, 8105, 8201,
       8115, 8210, 1878, 8199, 1880, 8207, 8071, 8204, 8205]), 'topk_tokens': [' was', ' garden', ' directly', '\n\n', '?', ' item', ' John', ' return', ' travelled', '.\n\n', ' Where', ' location', 'Answer', ' got', 'Question', ' milk', ' kitchen', ' context', ' milk', ' before'], 'evidence_proportions': [4.34423828125, 1.680126953125, 1.2379150390625, 0.5108642578125]}}, 'pred_res': 'The garden.<|eot_id|>', 'score': 100}
2025-01-22 17:47:58.663 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:47:58.663 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-68_pid-1_2-3-4-6.pkl | len: 3 |  size: 2.01 KB
Processing depth (2, 3, 4, 6):   2%|â–         | 2/100 [01:11<1:02:48, 38.45s/it]is_0k: False
your chose emoji: ['ğŸ‘©ğŸ»\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘¨ğŸ¿', 'ğŸ‘¨ğŸ½\u200dâ¤\u200dğŸ‘¨ğŸ¼', 'ğŸ‡¨ğŸ‡«', 'ğŸ“‹', 'ğŸŒ', 'ğŸ‘ğŸ½', 'ğŸ‘©ğŸ¾\u200dğŸ¦¯\u200dâ¡ï¸', 'ğŸ', 'ğŸ‘·ğŸ½\u200dâ™‚', 'ğŸ¤µğŸ¾\u200dâ™€']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:05<00:15,  5.21s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:11<00:11,  5.55s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:15<00:04,  4.88s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  3.42s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  4.07s/it]
Processing depth (2, 5, 6, 8):   2%|â–         | 2/100 [01:29<1:02:48, 38.45s/it]2025-01-22 17:48:16.759 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John got the milk.
2025-01-22 17:48:16.769 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1871, 1875) -->  John got the milk
2025-01-22 17:48:16.769 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the garden.
2025-01-22 17:48:16.791 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4240, 4245) -->  John travelled to the garden
2025-01-22 17:48:16.791 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the kitchen.
2025-01-22 17:48:16.820 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4883, 4889) --> . John went back to the
2025-01-22 17:48:16.820 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra dropped the apple.
2025-01-22 17:48:16.856 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6647, 6651) -->  Sandra dropped the apple
2025-01-22 17:48:16.856 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went to the garden.
2025-01-22 17:48:16.864 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1399, 1404) --> . Sandra went to the
2025-01-22 17:48:16.864 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the office.
2025-01-22 17:48:16.879 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2833, 2838) --> . Sandra moved to the
2025-01-22 17:48:16.879 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary moved to the bedroom.
2025-01-22 17:48:16.900 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3847, 3852) --> . Mary moved to the
2025-01-22 17:48:16.900 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went to the office.
2025-01-22 17:48:16.938 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6683, 6688) --> . Daniel went to the
2025-01-22 17:48:16.938 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra went to the bathroom.
2025-01-22 17:48:16.946 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1399, 1404) --> . Sandra went to the
2025-01-22 17:48:16.946 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra moved to the garden.
2025-01-22 17:48:16.953 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (1400, 1405) -->  Sandra went to the garden
2025-01-22 17:48:16.954 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Sandra picked up the apple there.
2025-01-22 17:48:16.962 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (1729, 1735) --> . Sandra picked up the apple
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:48:17.760 | INFO     | test_jbb_embedding:begin_test:693 - the garden<|eot_id|>
2025-01-22 17:48:17.760 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8195])
2025-01-22 17:48:20.017 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [208.74506578947367, 19.756842370090265, 132.49782986111111, 18.8174524898686, 29.399282094594593], 'topk_indices': array([   3, 8178, 8194, 1880, 8083, 1883, 1881, 8048, 8093, 8193, 8185,
       1877,   24, 8183,   14, 8049, 8191, 1878, 8190,    0]), 'topk_tokens': ['<|end_header_id|>', ':', '\n\n', 'ï¿½', '.\n\n', 'ï¿½', 'ï¿½', ' you', ' location', '<|end_header_id|>', ' kitchen', 'ï¿½', '\n\n', ' before', '\n', ' context', '<|start_header_id|>', 'ï¿½', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [313.875, 299.875, 160.33333333333334, 62.3203125]}, 'weight': {'score': [24.11800986842105, 23.29348431019761, 21.845703125, 23.2979610555078, 30.0933277027027], 'topk_indices': array([3291, 3318, 3163, 3211, 7444, 7482, 1427, 1489, 4316, 4332, 5170,
       5231, 7165, 7221, 3474, 3500, 4988, 4911, 4936, 4959]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [25.326171875, 24.5046875, 20.0703125, 28.498046875]}, 'saliency': {'score': [1.2906686883223684, 0.11093488824923, 0.8089582655164931, 0.10509628039180507, 0.22755040349187078], 'topk_indices': array([8047,   24, 8048, 8182, 8188, 1881, 8164, 1882, 1877, 1879, 1874,
       4241, 1876, 8093, 8183, 1880, 1883, 8185, 8049, 1878]), 'topk_tokens': [' provided', '\n\n', ' you', ' milk', 'Answer', 'ï¿½', ' return', '\u200d', 'ï¿½', '\u200d', ' milk', ' travelled', 'ï¿½', ' location', ' before', 'ï¿½', 'ï¿½', ' kitchen', ' context', 'ï¿½'], 'evidence_proportions': [2.0406494140625, 1.95166015625, 0.7994791666666666, 0.45123291015625]}}, 'pred_res': 'the garden<|eot_id|>', 'score': 100}
2025-01-22 17:48:20.025 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:48:20.026 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-68_pid-2_2-5-6-8.pkl | len: 3 |  size: 2.01 KB
Processing depth (2, 5, 6, 8):   3%|â–         | 3/100 [01:32<49:32, 30.65s/it]  is_0k: False
your chose emoji: ['ğŸ¦¸ğŸ¼\u200dâ™€ï¸', 'ğŸ‘©ğŸ½\u200dâš–ï¸', 'ğŸ‘©\u200dğŸ‘§\u200dğŸ‘§', 'ğŸ¤¦ğŸ½\u200dâ™€', 'ğŸ§ğŸ¼\u200dâ™€', 'ğŸ§\u200dâ™‚\u200dâ¡ï¸', 'ğŸ¼', 'ğŸµ', 'ğŸ§\u200dâ™‚ï¸', 'ğŸ‡¯ğŸ‡´']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.93s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.07s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.75s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.04s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.72s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 2, 5, 9):   3%|â–         | 3/100 [01:49<49:32, 30.65s/it]2025-01-22 17:48:37.034 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John got the milk.
2025-01-22 17:48:37.074 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the garden.
2025-01-22 17:48:37.083 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2016, 2021) -->  cable. John travelled to
2025-01-22 17:48:37.084 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the kitchen.
2025-01-22 17:48:37.105 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4252, 4258) -->  John went back to the kitchen
2025-01-22 17:48:37.105 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra dropped the apple.
2025-01-22 17:48:37.141 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7397, 7401) -->  Sandra dropped the apple
2025-01-22 17:48:37.141 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went to the garden.
2025-01-22 17:48:37.148 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1506, 1511) --> . Sandra went to the
2025-01-22 17:48:37.148 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the office.
2025-01-22 17:48:37.163 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2877, 2882) --> . Sandra moved to the
2025-01-22 17:48:37.163 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary moved to the bedroom.
2025-01-22 17:48:37.184 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3843, 3848) --> . Mary moved to the
2025-01-22 17:48:37.184 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went to the office.
2025-01-22 17:48:37.217 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6700, 6705) --> . Daniel went to the
2025-01-22 17:48:37.217 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra went to the bathroom.
2025-01-22 17:48:37.226 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1506, 1511) --> . Sandra went to the
2025-01-22 17:48:37.226 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra moved to the garden.
2025-01-22 17:48:37.234 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (1507, 1512) -->  Sandra went to the garden
2025-01-22 17:48:37.234 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Sandra picked up the apple there.
2025-01-22 17:48:37.244 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (1774, 1780) --> . Sandra picked up the apple
2025-01-22 17:48:37.245 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 17:48:37.245 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 17:48:37.245 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 17:48:37.245 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ‘±ğŸ¼\u200dâ™€ï¸', 'ğŸ§‘ğŸ»\u200dâš•ï¸', 'ğŸ‘¼', 'ğŸ¬', 'ğŸ¦¸ğŸ»', 'ğŸ‡±ğŸ‡®', 'ğŸ‘©ğŸ¿\u200dâ¤\u200dğŸ’‹\u200dğŸ‘¨ğŸ¼', 'ğŸ§‘\u200dğŸ’»', 'ğŸ‘·ğŸ½\u200dâ™‚', 'ğŸ‘¨ğŸ»\u200dâ¤ï¸\u200dğŸ‘¨ğŸ¼']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.12s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.37s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.58s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.23s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.66s/it]
Processing depth (3, 4, 6, 9):   3%|â–         | 3/100 [02:06<49:32, 30.65s/it]2025-01-22 17:48:53.631 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John got the milk.
2025-01-22 17:48:53.647 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2943, 2947) -->  John got the milk
2025-01-22 17:48:53.647 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the garden.
2025-01-22 17:48:53.666 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3626, 3631) -->  John travelled to the garden
2025-01-22 17:48:53.666 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the kitchen.
2025-01-22 17:48:53.696 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4907, 4913) --> . John went back to the
2025-01-22 17:48:53.696 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra dropped the apple.
2025-01-22 17:48:53.734 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7261, 7265) -->  Sandra dropped the apple
2025-01-22 17:48:53.735 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went to the garden.
2025-01-22 17:48:53.741 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1397, 1402) --> . Sandra went to the
2025-01-22 17:48:53.741 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the office.
2025-01-22 17:48:53.755 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2818, 2823) --> . Sandra moved to the
2025-01-22 17:48:53.755 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary moved to the bedroom.
2025-01-22 17:48:53.774 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3833, 3838) --> . Mary moved to the
2025-01-22 17:48:53.775 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went to the office.
2025-01-22 17:48:53.807 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6664, 6669) --> . Daniel went to the
2025-01-22 17:48:53.807 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra went to the bathroom.
2025-01-22 17:48:53.814 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1397, 1402) --> . Sandra went to the
2025-01-22 17:48:53.814 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra moved to the garden.
2025-01-22 17:48:53.821 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (1398, 1403) -->  Sandra went to the garden
2025-01-22 17:48:53.821 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Sandra picked up the apple there.
2025-01-22 17:48:53.829 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (1581, 1587) --> . Sandra picked up the apple
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:48:54.619 | INFO     | test_jbb_embedding:begin_test:693 - the garden<|eot_id|>
2025-01-22 17:48:54.619 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8211])
2025-01-22 17:48:56.850 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [265.9967105263158, 22.658943571950328, 131.39105902777777, 21.61251953364383, 20.470298208841463], 'topk_indices': array([  24, 2942, 8065, 8198, 2947, 8194,    9, 2944, 8193, 8099, 2914,
       2943, 2946, 8109, 8201, 8199,   14, 8207,    0, 8206]), 'topk_tokens': ['\n\n', '.', ' context', ' milk', '.', ':', ':', ' got', 'Question', '.\n\n', '.', ' John', ' milk', ' location', ' kitchen', ' before', '\n', '<|start_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [612.0625, 286.1, 163.04166666666666, 49.234375]}, 'weight': {'score': [24.11800986842105, 23.28479957998539, 21.845703125, 23.289209002328718, 28.99485518292683], 'topk_indices': array([3308, 3281, 3153, 3201, 7450, 7488, 1487, 1425, 4290, 4306, 5160,
       5221, 7154, 7210, 3490, 3464, 4985, 5014, 4878, 4903]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [25.326171875, 24.5046875, 20.0703125, 28.498046875]}, 'saliency': {'score': [1.6663721988075657, 0.12537297280652696, 0.7925618489583334, 0.11884058098945566, 0.14678973686404345], 'topk_indices': array([  24, 8063,   14, 2915, 3627, 8180, 8195, 8099, 2913, 2941, 8204,
       2944, 8065, 8198, 2943, 8109, 8193, 2946, 8199, 8201]), 'topk_tokens': ['\n\n', ' provided', '\n', ' During', ' travelled', ' return', ' Where', '.\n\n', ' Gov', ' Gov', 'Answer', ' got', ' context', ' milk', ' John', ' location', 'Question', ' milk', ' before', ' kitchen'], 'evidence_proportions': [4.1015625, 1.82783203125, 0.78759765625, 0.3475189208984375]}}, 'pred_res': 'the garden<|eot_id|>', 'score': 100}
2025-01-22 17:48:56.859 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:48:56.860 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-68_pid-3_3-4-6-9.pkl | len: 3 |  size: 1.99 KB
Processing depth (3, 4, 6, 9):   4%|â–         | 4/100 [02:09<52:56, 33.09s/it]is_0k: False
your chose emoji: ['ğŸ•´ğŸ¼', 'ğŸ¤˜ğŸ¼', 'ğŸ‘©ğŸ¾\u200dâ¤\u200dğŸ‘©ğŸ»', 'ğŸ™‹ğŸ¿\u200dâ™‚ï¸', 'ğŸ‘©ğŸ½\u200dğŸ¦¯\u200dâ¡', 'ğŸ¦–', '\U0001faf8ğŸ¿', 'ğŸ‘©ğŸ¾\u200dğŸ¦¯', 'ğŸ§', 'ğŸ‘¨ğŸ»\u200dğŸ¦½']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.54s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.57s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.43s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.14s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.64s/it]
Processing depth (3, 6, 7, 9):   4%|â–         | 4/100 [02:25<52:56, 33.09s/it]2025-01-22 17:49:13.261 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John got the milk.
2025-01-22 17:49:13.275 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2895, 2899) -->  John got the milk
2025-01-22 17:49:13.276 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the garden.
2025-01-22 17:49:13.299 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4650, 4655) -->  John travelled to the garden
2025-01-22 17:49:13.299 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the kitchen.
2025-01-22 17:49:13.330 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5495, 5501) --> . John went back to the
2025-01-22 17:49:13.330 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra dropped the apple.
2025-01-22 17:49:13.369 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7154, 7158) -->  dropped the apple.
2025-01-22 17:49:13.370 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went to the garden.
2025-01-22 17:49:13.377 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1256, 1261) -->  Sandra went to the garden
2025-01-22 17:49:13.377 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the office.
2025-01-22 17:49:13.394 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2711, 2716) -->  first. Sandra moved to
2025-01-22 17:49:13.394 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary moved to the bedroom.
2025-01-22 17:49:13.414 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3817, 3822) --> . Mary moved to the
2025-01-22 17:49:13.414 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went to the office.
2025-01-22 17:49:13.447 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6568, 6573) --> . Daniel went to the
2025-01-22 17:49:13.447 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra went to the bathroom.
2025-01-22 17:49:13.453 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1257, 1262) -->  went to the garden.
2025-01-22 17:49:13.453 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra moved to the garden.
2025-01-22 17:49:13.460 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (1257, 1262) -->  went to the garden.
2025-01-22 17:49:13.460 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Sandra picked up the apple there.
2025-01-22 17:49:13.469 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (1547, 1553) --> . Sandra picked up the apple
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:49:14.276 | INFO     | test_jbb_embedding:begin_test:693 - The bedroom.<|eot_id|>
2025-01-22 17:49:14.277 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8201])
2025-01-22 17:49:16.534 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [213.23026315789474, 25.07237323256948, 184.49913194444446, 23.92936633329243, 32.95890827922078], 'topk_indices': array([8170, 8188, 8184, 8174, 2896, 3667,    1, 2895, 8195, 8055, 8099,
       8089, 2898, 8189,   24, 8199,   14, 8196,    0, 8197]), 'topk_tokens': [' return', ' milk', ':', '.', ' got', ' the', '<|start_header_id|>', ' John', ':', ' context', ' location', '.\n\n', ' milk', ' before', '\n\n', '<|end_header_id|>', '\n', '<|eot_id|>', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [483.5, 268.55, 100.46875, 42.953125]}, 'weight': {'score': [22.533717105263158, 23.29293637250122, 21.85373263888889, 23.301064547797274, 29.799107142857142], 'topk_indices': array([3301, 3328, 3221, 3173, 7442, 7480, 1445, 1507, 4340, 4356, 5199,
       5260, 7219, 7163, 3484, 3510, 4976, 5053, 5024, 5001]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [25.326171875, 24.5046875, 20.0703125, 20.97265625]}, 'saliency': {'score': [1.3260915655838816, 0.1397478762979568, 1.03924560546875, 0.13300809861399787, 0.2446824110947646], 'topk_indices': array([2684, 8194, 1260, 2717, 8173, 3665, 8185, 8183, 8089, 8170,   24,
       4651, 2896, 8188, 8191, 2895, 8099, 8055, 8189, 2898]), 'topk_tokens': [' ne', 'Answer', ' garden', ' garden', ' directly', ' moved', ' Where', 'Question', '.\n\n', ' return', '\n\n', ' travelled', ' got', ' milk', ' kitchen', ' John', ' location', ' context', ' before', ' milk'], 'evidence_proportions': [3.224365234375, 1.69970703125, 0.4700113932291667, 0.2449188232421875]}}, 'pred_res': 'The bedroom.<|eot_id|>', 'score': 0}
2025-01-22 17:49:16.551 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:49:16.556 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-68_pid-4_3-6-7-9.pkl | len: 3 |  size: 2.03 KB
Processing depth (3, 6, 7, 9):   5%|â–Œ         | 5/100 [02:29<44:44, 28.26s/it]Processing depth (3, 6, 7, 9):   5%|â–Œ         | 5/100 [02:29<47:15, 29.85s/it]
2025-01-22 17:49:16.650 | INFO     | __main__:<module>:82 - Selected idx: 70
2025-01-22 17:49:16.650 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the milk before the bedroom? 
2025-01-22 17:49:16.650 | INFO     | __main__:<module>:84 - Answer: garden
2025-01-22 17:49:16.650 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 17:49:16.650 | INFO     | __main__:<module>:86 - Needle: [' Sandra moved to the garden.', ' John travelled to the bedroom.', ' Mary grabbed the milk.', ' Mary moved to the garden.', ' Daniel moved to the office.', ' John went to the hallway.', ' Sandra travelled to the kitchen.', ' Mary journeyed to the bedroom.', ' Daniel travelled to the bathroom.']
2025-01-22 17:49:16.650 | INFO     | __main__:<module>:87 - Real Needle: [' Mary grabbed the milk.', ' Mary moved to the garden.', ' Mary journeyed to the bedroom.', ' Daniel travelled to the bathroom.']
2025-01-22 17:49:16.651 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ‘°\u200dâ™€ï¸', 'ğŸ‡¹ğŸ‡´', 'ğŸŒ¤', 'ğŸ¦¶', 'ğŸ™‡ğŸ»\u200dâ™‚', 'ğŸ§˜ğŸ»\u200dâ™€', 'ğŸ‘©ğŸ½\u200dâ¤\u200dğŸ’‹\u200dğŸ‘¨ğŸ½', 'ğŸ§›ğŸ¼', 'ğŸ‘¨ğŸ»\u200dğŸŒ¾', 'ğŸ™…ğŸ¿\u200dâ™€ï¸']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:05<00:15,  5.11s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.02s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.72s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.27s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.87s/it]
Processing depth (0, 3, 6, 8):   0%|          | 0/100 [00:17<?, ?it/s]2025-01-22 17:49:34.093 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the milk.
2025-01-22 17:49:34.144 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary moved to the garden.
2025-01-22 17:49:34.159 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2904, 2909) --> . Mary moved to the
2025-01-22 17:49:34.160 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bedroom.
2025-01-22 17:49:34.185 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4870, 4876) --> . Mary journeyed to the
2025-01-22 17:49:34.186 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel travelled to the bathroom.
2025-01-22 17:49:34.224 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6639, 6644) --> . Daniel travelled to the
2025-01-22 17:49:34.224 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the garden.
2025-01-22 17:49:34.238 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2905, 2910) -->  Mary moved to the garden
2025-01-22 17:49:34.239 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the bedroom.
2025-01-22 17:49:34.272 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6301, 6306) --> . John travelled to the
2025-01-22 17:49:34.273 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 17:49:34.315 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (7300, 7305) -->  cold. Daniel moved to
2025-01-22 17:49:34.315 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the hallway.
2025-01-22 17:49:34.332 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3362, 3367) --> . John went to the
2025-01-22 17:49:34.332 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra travelled to the kitchen.
2025-01-22 17:49:34.334 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (360, 365) --> . Sandra travelled to the
2025-01-22 17:49:34.334 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 17:49:34.334 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 17:49:34.334 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 17:49:34.334 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ¦Š', 'ğŸ‡±ğŸ‡·', 'ğŸ§‘ğŸ¿\u200dâš–', 'ğŸ‘', 'ğŸ§‘ğŸ¿\u200dğŸ¦¼\u200dâ¡', 'ğŸ¤¾ğŸ¼\u200dâ™€ï¸', 'ğŸ›¢ï¸', 'ğŸ§›ğŸ¾\u200dâ™‚ï¸', 'ğŸ§‘ğŸ¼\u200dâœˆ', 'ğŸ¦¹ğŸ¼\u200dâ™€']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:06<00:19,  6.58s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:13<00:13,  6.77s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:18<00:05,  5.85s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:19<00:00,  3.97s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:19<00:00,  4.83s/it]
Processing depth (0, 6, 7, 9):   0%|          | 0/100 [00:38<?, ?it/s]2025-01-22 17:49:55.603 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the milk.
2025-01-22 17:49:55.650 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary moved to the garden.
2025-01-22 17:49:55.674 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4886, 4891) --> . Mary moved to the
2025-01-22 17:49:55.674 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bedroom.
2025-01-22 17:49:55.706 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6049, 6055) -->  Mary journeyed to the bedroom
2025-01-22 17:49:55.707 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel travelled to the bathroom.
2025-01-22 17:49:55.743 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7254, 7259) -->  cold. Daniel travelled to
2025-01-22 17:49:55.743 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the garden.
2025-01-22 17:49:55.770 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4887, 4892) -->  Mary moved to the garden
2025-01-22 17:49:55.770 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the bedroom.
2025-01-22 17:49:55.803 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6386, 6391) -->  John travelled to the bedroom
2025-01-22 17:49:55.803 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 17:49:55.841 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (7359, 7364) --> . Daniel moved to the
2025-01-22 17:49:55.841 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the hallway.
2025-01-22 17:49:55.860 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3450, 3455) --> . John went to the
2025-01-22 17:49:55.861 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra travelled to the kitchen.
2025-01-22 17:49:55.862 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (360, 365) --> . Sandra travelled to the
2025-01-22 17:49:55.863 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 17:49:55.863 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 17:49:55.863 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 17:49:55.863 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ‡²ğŸ‡¿', 'ğŸ‘©ğŸ¿\u200dğŸ³', 'ğŸ‘·ğŸ½', 'ğŸ§‘ğŸ¾\u200dâ¤\u200dğŸ§‘ğŸ½', 'ğŸ‘¨ğŸ¼', 'ğŸ‘¶', 'ğŸ', 'ğŸš´ğŸ¾\u200dâ™‚ï¸', 'ğŸ§\u200dâ™€', 'ğŸ™†ğŸ½\u200dâ™‚ï¸']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.26s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.71s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.65s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.26s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.75s/it]
Processing depth (1, 2, 6, 9):   0%|          | 0/100 [00:56<?, ?it/s]2025-01-22 17:50:13.071 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the milk.
2025-01-22 17:50:13.076 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (902, 906) -->  Mary grabbed the milk
2025-01-22 17:50:13.076 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary moved to the garden.
2025-01-22 17:50:13.088 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1858, 1863) --> . Mary moved to the
2025-01-22 17:50:13.088 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bedroom.
2025-01-22 17:50:13.113 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4626, 4632) --> . Mary journeyed to the
2025-01-22 17:50:13.114 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel travelled to the bathroom.
2025-01-22 17:50:13.152 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7096, 7101) -->  Daniel travelled to the bathroom
2025-01-22 17:50:13.152 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the garden.
2025-01-22 17:50:13.162 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1859, 1864) -->  Mary moved to the garden
2025-01-22 17:50:13.162 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the bedroom.
2025-01-22 17:50:13.193 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6191, 6196) --> . John travelled to the
2025-01-22 17:50:13.193 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 17:50:13.230 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (7213, 7218) --> . Daniel moved to the
2025-01-22 17:50:13.230 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the hallway.
2025-01-22 17:50:13.248 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3348, 3353) --> . John went to the
2025-01-22 17:50:13.248 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra travelled to the kitchen.
2025-01-22 17:50:13.250 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (355, 360) --> . Sandra travelled to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:50:14.049 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 17:50:14.049 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8149])
2025-01-22 17:50:16.254 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [184.784375, 20.0114504109421, 167.655, 19.149658474158134, 15.966865405701755], 'topk_indices': array([   9,  906,  905, 8134,    1, 8138, 8130, 8140, 8037, 8047, 8139,
       8136,  360,   24, 8137, 8147, 8144,   14, 8145,    0]), 'topk_tokens': [':', '.', ' milk', ' was', '<|start_header_id|>', ' the', '.\n\n', '?', '.\n\n', ' location', ' bedroom', ' milk', ' kitchen', '\n\n', ' before', '<|end_header_id|>', '<|eot_id|>', '\n', '<|start_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [366.78125, 214.175, 134.21875, 70.475]}, 'weight': {'score': [23.19140625, 23.25010350220805, 20.9696875, 23.257280552300482, 28.96299342105263], 'topk_indices': array([3331, 3304, 3176, 3224, 7392, 7430, 1410, 1472, 4329, 4313, 5131,
       5192, 7163, 7107, 3493, 3519, 4933, 4908, 4956, 4985]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [27.935546875, 19.646875, 20.052083333333332, 26.7078125]}, 'saliency': {'score': [1.11744384765625, 0.11048262486630965, 0.98082763671875, 0.10531451708881985, 0.11872435452645286], 'topk_indices': array([8127,    8,   14, 8140, 8003,  903, 8037, 1863, 8131, 8133,  357,
        257,   24,  905,  356, 8047, 8136, 8137,  360, 8139]), 'topk_tokens': [' else', ' Date', '\n', '?', ' context', ' grabbed', '.\n\n', ' garden', 'Question', ' Where', ' travelled', 'hue', '\n\n', ' milk', ' Sandra', ' location', ' milk', ' before', ' kitchen', ' bedroom'], 'evidence_proportions': [2.673828125, 1.05, 0.647216796875, 0.504052734375]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 0}
2025-01-22 17:50:16.261 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:50:16.261 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-70_pid-0_1-2-6-9.pkl | len: 3 |  size: 2.02 KB
Processing depth (1, 2, 6, 9):   1%|          | 1/100 [00:59<1:38:06, 59.46s/it]is_0k: False
your chose emoji: ['âŒš', 'ğŸ‡³ğŸ‡¿', 'ğŸšµğŸ½\u200dâ™‚ï¸', 'ğŸ§‘ğŸ»\u200dğŸ’»', 'ğŸª›', 'ğŸ¿', 'ğŸ§—ğŸ¾', 'ğŸ¤µğŸ»', 'ğŸ”', 'ğŸ§šğŸ¾\u200dâ™€']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.46s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:10,  5.03s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.95s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.35s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.91s/it]
Processing depth (0, 6, 8, 9):   1%|          | 1/100 [01:16<1:38:06, 59.46s/it]2025-01-22 17:50:33.825 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the milk.
2025-01-22 17:50:33.865 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary moved to the garden.
2025-01-22 17:50:33.890 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4793, 4798) -->  Mary moved to the garden
2025-01-22 17:50:33.891 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bedroom.
2025-01-22 17:50:33.926 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6662, 6668) --> . Mary journeyed to the
2025-01-22 17:50:33.926 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel travelled to the bathroom.
2025-01-22 17:50:33.964 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7245, 7250) --> . Daniel travelled to the
2025-01-22 17:50:33.964 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the garden.
2025-01-22 17:50:33.988 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4794, 4799) -->  moved to the garden.
2025-01-22 17:50:33.988 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the bedroom.
2025-01-22 17:50:34.022 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6392, 6397) --> . John travelled to the
2025-01-22 17:50:34.022 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 17:50:34.061 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (7308, 7313) -->  cold. Daniel moved to
2025-01-22 17:50:34.061 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the hallway.
2025-01-22 17:50:34.078 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3478, 3483) --> . John went to the
2025-01-22 17:50:34.078 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra travelled to the kitchen.
2025-01-22 17:50:34.080 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (323, 328) -->  Sandra travelled to the kitchen
2025-01-22 17:50:34.080 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 17:50:34.080 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 17:50:34.080 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 17:50:34.080 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ§‘ğŸ½\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ§‘ğŸ¾', 'ğŸ§ğŸ¿\u200dâ™‚', 'ğŸ“®', 'ğŸ•‘', 'ğŸ‘©ğŸ¾\u200dğŸ’»', 'ğŸ§‘ğŸ½\u200dâš•', 'ğŸ¤¹ğŸ»\u200dâ™‚', 'ğŸ‘¨ğŸ¿\u200dğŸ¦½', 'ğŸ‡¬ğŸ‡¼', 'ğŸ§‘ğŸ¿\u200dğŸ¤\u200dğŸ§‘ğŸ»']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.31s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.26s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.52s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.22s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.65s/it]
Processing depth (3, 4, 5, 8):   1%|          | 1/100 [01:33<1:38:06, 59.46s/it]2025-01-22 17:50:50.461 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the milk.
2025-01-22 17:50:50.478 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2916, 2920) -->  Mary grabbed the milk
2025-01-22 17:50:50.478 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary moved to the garden.
2025-01-22 17:50:50.499 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3616, 3621) --> . Mary moved to the
2025-01-22 17:50:50.499 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bedroom.
2025-01-22 17:50:50.522 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4215, 4221) -->  Mary journeyed to the bedroom
2025-01-22 17:50:50.523 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel travelled to the bathroom.
2025-01-22 17:50:50.559 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6605, 6610) --> . Daniel travelled to the
2025-01-22 17:50:50.559 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the garden.
2025-01-22 17:50:50.579 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3617, 3622) -->  Mary moved to the garden
2025-01-22 17:50:50.579 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the bedroom.
2025-01-22 17:50:50.613 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6219, 6224) --> . John travelled to the
2025-01-22 17:50:50.613 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 17:50:50.652 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (7227, 7232) --> . Daniel moved to the
2025-01-22 17:50:50.652 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the hallway.
2025-01-22 17:50:50.671 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3426, 3431) --> . John went to the
2025-01-22 17:50:50.671 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra travelled to the kitchen.
2025-01-22 17:50:50.674 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (355, 360) --> . Sandra travelled to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:50:51.476 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 17:50:51.476 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8153])
2025-01-22 17:50:53.688 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [83.42265625, 11.145393345389897, 75.069375, 10.7701443256072, 10.899546477754237], 'topk_indices': array([8122, 8146, 8051,    1,    4, 8141, 3621, 8006,   23, 8002, 8147,
       8152,    9,   24, 8041, 8007,   14, 8151,    0, 8148]), 'topk_tokens': [' return', 'Answer', ' location', '<|start_header_id|>', '\n\n', ' before', ' garden', ' you', '4', '\n', ':', '\n\n', ':', '\n\n', '.\n\n', ' context', '\n', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [156.890625, 97.8, 73.88541666666667, 21.715625]}, 'weight': {'score': [23.12578125, 23.24587726826876, 20.9696875, 23.25318914899519, 28.477224576271187], 'topk_indices': array([3287, 3260, 3132, 3180, 7406, 7444, 1417, 1479, 4320, 4304, 5176,
       5115, 7177, 7121, 3475, 3449, 4917, 4892, 4940, 4969]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [27.935546875, 19.646875, 24.57421875, 21.01875]}, 'saliency': {'score': [0.519012451171875, 0.06119908159301818, 0.4449395751953125, 0.05888743324735987, 0.07667011325642215], 'topk_indices': array([  20, 8125, 8150,   23, 8135,   14,   24, 8152,    8, 8006, 8005,
       8122, 8140, 8041, 8051, 8141, 8146, 8143, 3621, 8007]), 'topk_tokens': [' Jul', ' directly', 'assistant', '4', 'Question', '\n', '\n\n', '\n\n', ' Date', ' you', ' provided', ' return', ' milk', '.\n\n', ' location', ' before', 'Answer', ' bedroom', ' garden', ' context'], 'evidence_proportions': [1.14404296875, 0.4573974609375, 0.4792887369791667, 0.128271484375]}}, 'pred_res': 'The garden.<|eot_id|>', 'score': 100}
2025-01-22 17:50:53.695 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:50:53.695 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-70_pid-1_3-4-5-8.pkl | len: 3 |  size: 1.99 KB
Processing depth (3, 4, 5, 8):   2%|â–         | 2/100 [01:36<1:15:57, 46.50s/it]is_0k: False
your chose emoji: ['\U0001faf2ğŸ¼', 'ğŸ™‹ğŸ¼', 'ğŸŸ', 'ğŸ–', 'ğŸ¤½ğŸ¾', 'ğŸ§’ğŸ¿', 'ğŸ‘©ğŸ»\u200dğŸ¤\u200dğŸ‘¨ğŸ½', 'ğŸ‡ºğŸ‡¬', 'â™¨ï¸', 'â›²']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.47s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.57s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.28s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  2.97s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.50s/it]
Processing depth (0, 2, 4, 6):   2%|â–         | 2/100 [01:52<1:15:57, 46.50s/it]2025-01-22 17:51:09.741 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the milk.
2025-01-22 17:51:09.782 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary moved to the garden.
2025-01-22 17:51:09.791 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1756, 1761) --> . Mary moved to the
2025-01-22 17:51:09.791 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bedroom.
2025-01-22 17:51:09.811 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3629, 3635) -->  Hon. Mary journeyed to
2025-01-22 17:51:09.811 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel travelled to the bathroom.
2025-01-22 17:51:09.838 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4761, 4766) --> . Daniel travelled to the
2025-01-22 17:51:09.838 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the garden.
2025-01-22 17:51:09.846 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1757, 1762) -->  Mary moved to the garden
2025-01-22 17:51:09.846 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the bedroom.
2025-01-22 17:51:09.879 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6255, 6260) --> . John travelled to the
2025-01-22 17:51:09.879 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 17:51:09.914 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (7277, 7282) --> . Daniel moved to the
2025-01-22 17:51:09.915 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the hallway.
2025-01-22 17:51:09.931 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3452, 3457) --> . John went to the
2025-01-22 17:51:09.932 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra travelled to the kitchen.
2025-01-22 17:51:09.933 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (360, 365) --> . Sandra travelled to the
2025-01-22 17:51:09.934 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 17:51:09.934 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 17:51:09.934 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 17:51:09.934 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ§‘ğŸ¿\u200dâœˆï¸', '\U0001fac5', 'ğŸšµğŸ¿\u200dâ™‚', 'ğŸ§šğŸ¾', 'ğŸ§ğŸ½\u200dâ™‚', 'ğŸ‘¨\u200dâ¤\u200dğŸ‘¨', '\U0001faf1ğŸ¼\u200d\U0001faf2ğŸ¿', 'ğŸš¶ğŸ¿\u200dâ™‚\u200dâ¡ï¸', 'ğŸ§ğŸ¿\u200dâ™‚', 'ğŸ‘©ğŸ¾\u200dâ¤ï¸\u200dğŸ‘¨ğŸ¼']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.77s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.11s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.91s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.36s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.95s/it]
Processing depth (0, 2, 5, 9):   2%|â–         | 2/100 [02:11<1:15:57, 46.50s/it]2025-01-22 17:51:28.203 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the milk.
2025-01-22 17:51:28.244 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary moved to the garden.
2025-01-22 17:51:28.253 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1852, 1857) --> . Mary moved to the
2025-01-22 17:51:28.253 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bedroom.
2025-01-22 17:51:28.275 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4232, 4238) --> . Mary journeyed to the
2025-01-22 17:51:28.275 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel travelled to the bathroom.
2025-01-22 17:51:28.310 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7098, 7103) -->  Daniel travelled to the bathroom
2025-01-22 17:51:28.311 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the garden.
2025-01-22 17:51:28.320 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1853, 1858) -->  Mary moved to the garden
2025-01-22 17:51:28.320 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the bedroom.
2025-01-22 17:51:28.351 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6265, 6270) --> . John travelled to the
2025-01-22 17:51:28.351 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 17:51:28.387 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (7215, 7220) --> . Daniel moved to the
2025-01-22 17:51:28.387 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the hallway.
2025-01-22 17:51:28.404 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3512, 3517) --> . John went to the
2025-01-22 17:51:28.404 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra travelled to the kitchen.
2025-01-22 17:51:28.406 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (308, 313) --> . Sandra travelled to the
2025-01-22 17:51:28.406 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 17:51:28.406 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 17:51:28.406 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 17:51:28.406 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ‘©ğŸ¾\u200dğŸ¼', 'â™¦', 'ğŸ¤ŸğŸ¾', 'ğŸ§ğŸ½\u200dâ™€ï¸', 'ğŸ¨', 'ğŸ™ğŸ¼', 'â™‰', 'ğŸ‘©ğŸ¼\u200dâš•ï¸', 'ğŸŒ', 'ğŸ’†\u200dâ™‚']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  3.92s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.21s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.35s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.08s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.49s/it]
Processing depth (1, 3, 5, 9):   2%|â–         | 2/100 [02:27<1:15:57, 46.50s/it]2025-01-22 17:51:44.197 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the milk.
2025-01-22 17:51:44.201 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (828, 832) -->  Mary grabbed the milk
2025-01-22 17:51:44.201 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary moved to the garden.
2025-01-22 17:51:44.216 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2884, 2889) --> . Mary moved to the
2025-01-22 17:51:44.216 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bedroom.
2025-01-22 17:51:44.239 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4142, 4148) --> . Mary journeyed to the
2025-01-22 17:51:44.239 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel travelled to the bathroom.
2025-01-22 17:51:44.278 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7225, 7230) --> . Daniel travelled to the
2025-01-22 17:51:44.278 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the garden.
2025-01-22 17:51:44.296 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2885, 2890) -->  Mary moved to the garden
2025-01-22 17:51:44.296 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the bedroom.
2025-01-22 17:51:44.329 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6216, 6221) -->  John travelled to the bedroom
2025-01-22 17:51:44.329 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 17:51:44.372 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (7288, 7293) -->  cold. Daniel moved to
2025-01-22 17:51:44.372 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the hallway.
2025-01-22 17:51:44.389 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3334, 3339) --> . John went to the
2025-01-22 17:51:44.389 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra travelled to the kitchen.
2025-01-22 17:51:44.393 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (309, 314) --> . Sandra travelled to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:51:45.174 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 17:51:45.174 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8183])
2025-01-22 17:51:47.383 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [196.44140625, 23.703510566821404, 220.22609375, 22.675648818480532, 29.20433910472973], 'topk_indices': array([   4, 8172, 8174,    1, 8181, 8168,  309,  311, 8071,   24,  310,
        832,  314, 8173, 8170, 8171,   14, 8178, 8179,    0]), 'topk_tokens': ['\n\n', ' the', '?', '<|start_header_id|>', '<|end_header_id|>', ' was', '.', ' travelled', '.\n\n', '\n\n', ' Sandra', '.', ' kitchen', ' bedroom', ' milk', ' before', '\n', '<|eot_id|>', '<|start_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [441.125, 200.85, 161.47916666666666, 38.240625]}, 'weight': {'score': [21.769140625, 23.287102217200097, 22.8590625, 23.292145851246776, 29.69700168918919], 'topk_indices': array([3317, 3290, 3210, 3162, 7422, 7460, 1492, 1430, 4302, 4286, 5149,
       5210, 7119, 7175, 3479, 3505, 5003, 4974, 4951, 4926]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [27.935546875, 19.646875, 20.052083333333332, 21.01875]}, 'saliency': {'score': [1.1942230224609376, 0.1327303493340383, 1.332354736328125, 0.12643868207726516, 0.21554957209406672], 'topk_indices': array([   8, 4148, 8174,    0, 8168,  828,   24, 8165, 8071, 8167,  831,
       8081,  269,  829,  311, 8171,  314, 8173, 8170,  310]), 'topk_tokens': [' Date', ' bedroom', '?', '<|begin_of_text|>', ' was', ' Mary', '\n\n', 'Question', '.\n\n', ' Where', ' milk', ' location', 'hue', ' grabbed', ' travelled', ' before', ' kitchen', ' bedroom', ' milk', ' Sandra'], 'evidence_proportions': [3.2806396484375, 0.9708984375, 0.8067220052083334, 0.21341552734375]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 0}
2025-01-22 17:51:47.395 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:51:47.396 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-70_pid-2_1-3-5-9.pkl | len: 3 |  size: 2.03 KB
Processing depth (1, 3, 5, 9):   3%|â–         | 3/100 [02:30<1:20:29, 49.79s/it]is_0k: False
your chose emoji: ['ğŸ‘±\u200dâ™‚', 'ğŸš¶ğŸ½', 'ğŸ‘©ğŸ¾\u200dâ¤ï¸\u200dğŸ‘©ğŸ¾', 'ğŸ‹\u200dâ™€', 'ğŸ—ï¸', 'ğŸ¦¹ğŸ¾\u200dâ™‚ï¸', 'ğŸ’‡', 'â›¹ğŸ»\u200dâ™‚', 'ğŸ––ğŸ¼', 'ğŸ§‘ğŸ¼\u200dâš•']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.57s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.56s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.38s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.10s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.61s/it]
Processing depth (2, 4, 5, 7):   3%|â–         | 3/100 [02:47<1:20:29, 49.79s/it]2025-01-22 17:52:04.412 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the milk.
2025-01-22 17:52:04.421 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1734, 1738) -->  Mary grabbed the milk
2025-01-22 17:52:04.422 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary moved to the garden.
2025-01-22 17:52:04.440 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3605, 3610) -->  Hon. Mary moved to
2025-01-22 17:52:04.440 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bedroom.
2025-01-22 17:52:04.461 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4207, 4213) -->  Mary journeyed to the bedroom
2025-01-22 17:52:04.461 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel travelled to the bathroom.
2025-01-22 17:52:04.494 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5695, 5700) --> . Daniel travelled to the
2025-01-22 17:52:04.494 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the garden.
2025-01-22 17:52:04.512 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3607, 3612) -->  Mary moved to the garden
2025-01-22 17:52:04.512 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the bedroom.
2025-01-22 17:52:04.543 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6267, 6272) --> . John travelled to the
2025-01-22 17:52:04.543 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 17:52:04.579 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (7236, 7241) -->  Daniel moved to the office
2025-01-22 17:52:04.579 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the hallway.
2025-01-22 17:52:04.598 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3428, 3433) --> . John went to the
2025-01-22 17:52:04.598 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra travelled to the kitchen.
2025-01-22 17:52:04.599 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (304, 309) -->  Sandra travelled to the kitchen
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:52:05.388 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 17:52:05.388 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8175])
2025-01-22 17:52:07.595 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [245.565625, 26.207880517852775, 247.9375, 24.986880225624002, 32.23482142857143], 'topk_indices': array([8159, 8166, 8160, 6019, 5964, 5972, 8063, 3611,   24, 8173, 5836,
        308, 8162, 5828, 8165, 8163,   14, 8171, 8170,    0]), 'topk_tokens': [' Where', '?', ' was', ' in', 'this', ' to', '.\n\n', ' garden', '\n\n', '<|end_header_id|>', '-day', ' kitchen', ' milk', ' time', ' bedroom', ' before', '\n', '<|start_header_id|>', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [318.3125, 332.875, 227.58333333333334, 121.6375]}, 'weight': {'score': [24.327734375, 23.28349688187821, 22.7303125, 23.282629411041437, 29.852678571428573], 'topk_indices': array([3289, 3262, 3134, 3182, 7452, 7414, 1419, 1481, 4260, 4276, 5144,
       5083, 7121, 7177, 3477, 3451, 4885, 4937, 4860, 4908]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [27.935546875, 24.4546875, 24.57421875, 21.01875]}, 'saliency': {'score': [1.560211181640625, 0.1471393871610571, 1.5542578125, 0.13933914167684894, 0.23960680280412947], 'topk_indices': array([8166, 4212,  257, 1737, 8073, 3608, 8157,  304, 5971, 5828, 8159,
        298, 5964,  305, 5836, 3611,  308, 8162, 8163, 8165]), 'topk_tokens': ['?', ' bedroom', 'hue', ' milk', ' location', ' moved', 'Question', ' Sandra', ' true', ' time', ' Where', 'ï¿½', 'this', ' travelled', '-day', ' garden', ' kitchen', ' milk', ' before', ' bedroom'], 'evidence_proportions': [2.3438720703125, 1.90048828125, 1.4413248697916667, 0.7356689453125]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 0}
2025-01-22 17:52:07.602 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:52:07.603 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-70_pid-3_2-4-5-7.pkl | len: 3 |  size: 2.01 KB
Processing depth (2, 4, 5, 7):   4%|â–         | 4/100 [02:50<1:00:58, 38.11s/it]is_0k: False
your chose emoji: ['ğŸ–', 'ğŸ›¢ï¸', 'â›¹ï¸', 'ğŸ‡ğŸ¼', 'ğŸ§‘ğŸ»\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ§‘ğŸ½', 'ğŸ–¥', 'ğŸšµğŸ¾', 'ğŸ‹ğŸ¿\u200dâ™€ï¸', 'ğŸ¤¶ğŸ¾', 'ğŸ§ğŸ»\u200dâ™‚ï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.63s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.63s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.37s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.00s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.56s/it]
Processing depth (2, 4, 7, 8):   4%|â–         | 4/100 [03:06<1:00:58, 38.11s/it]2025-01-22 17:52:23.700 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the milk.
2025-01-22 17:52:23.709 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1794, 1798) -->  Mary grabbed the milk
2025-01-22 17:52:23.709 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary moved to the garden.
2025-01-22 17:52:23.727 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3615, 3620) -->  Hon. Mary moved to
2025-01-22 17:52:23.727 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bedroom.
2025-01-22 17:52:23.756 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5637, 5643) -->  Mary journeyed to the bedroom
2025-01-22 17:52:23.756 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel travelled to the bathroom.
2025-01-22 17:52:23.788 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6513, 6518) --> . Daniel travelled to the
2025-01-22 17:52:23.788 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the garden.
2025-01-22 17:52:23.806 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3617, 3622) -->  Mary moved to the garden
2025-01-22 17:52:23.806 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the bedroom.
2025-01-22 17:52:23.837 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6220, 6225) -->  John travelled to the bedroom
2025-01-22 17:52:23.837 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 17:52:23.875 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (7266, 7271) -->  cold. Daniel moved to
2025-01-22 17:52:23.876 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the hallway.
2025-01-22 17:52:23.893 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3438, 3443) --> . John went to the
2025-01-22 17:52:23.893 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra travelled to the kitchen.
2025-01-22 17:52:23.894 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (316, 321) -->  Sandra travelled to the kitchen
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:52:24.663 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 17:52:24.663 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8145])
2025-01-22 17:52:26.884 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [355.06875, 26.66856513868434, 292.0215625, 25.039313178760953, 62.273366477272724], 'topk_indices': array([3616,    9, 3619,  316, 8136,  317, 8130, 8135, 3621,   24,  320,
       1797, 1798, 8132, 3618, 8133,   14, 8140, 8141,    0]), 'topk_tokens': ['.', ':', ' to', ' Sandra', '?', ' travelled', ' was', ' bedroom', ' garden', '\n\n', ' kitchen', ' milk', '.', ' milk', ' moved', ' before', '\n', '<|eot_id|>', '<|start_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [519.375, 517.0, 308.7916666666667, 117.225]}, 'weight': {'score': [24.327734375, 23.247702657093765, 23.816875, 23.243280845057384, 28.992897727272727], 'topk_indices': array([3272, 3299, 3144, 3192, 7388, 7426, 1429, 1491, 4275, 4291, 5102,
       5163, 7103, 7159, 3461, 3487, 4956, 4904, 4927, 4879]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [27.935546875, 24.4546875, 24.57421875, 21.01875]}, 'saliency': {'score': [2.223858642578125, 0.15152536353821489, 1.94247802734375, 0.14088480051514485, 0.47279774058948865], 'topk_indices': array([1794,  257, 8127, 6224, 8129, 8043,  305,  314, 5642, 1795,  298,
       3621,  317, 8135, 8133,  320,  316, 1797, 3618, 8132]), 'topk_tokens': [' Mary', 'hue', 'Question', ' bedroom', ' Where', ' location', 'ï¿½', 'ï¿½', ' bedroom', ' grabbed', 'ï¿½', ' garden', ' travelled', ' bedroom', ' before', ' kitchen', ' Sandra', ' milk', ' moved', ' milk'], 'evidence_proportions': [3.751708984375, 2.918359375, 2.0055338541666665, 0.5690673828125]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 0}
2025-01-22 17:52:26.907 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:52:26.907 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-70_pid-4_2-4-7-8.pkl | len: 3 |  size: 2.01 KB
Processing depth (2, 4, 7, 8):   5%|â–Œ         | 5/100 [03:10<49:36, 31.33s/it]  Processing depth (2, 4, 7, 8):   5%|â–Œ         | 5/100 [03:10<1:00:13, 38.03s/it]
2025-01-22 17:52:26.966 | INFO     | __main__:<module>:82 - Selected idx: 72
2025-01-22 17:52:26.966 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the football before the kitchen? 
2025-01-22 17:52:26.966 | INFO     | __main__:<module>:84 - Answer: bedroom
2025-01-22 17:52:26.966 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 17:52:26.967 | INFO     | __main__:<module>:86 - Needle: [' Mary got the football.', ' Daniel moved to the office.', ' Sandra moved to the garden.', ' John travelled to the bedroom.', ' Daniel took the milk there.', ' Mary journeyed to the bedroom.', ' Mary went back to the kitchen.', ' Daniel left the milk.']
2025-01-22 17:52:26.967 | INFO     | __main__:<module>:87 - Real Needle: [' Mary got the football.', ' Mary journeyed to the bedroom.', ' Mary went back to the kitchen.', ' Daniel left the milk.']
2025-01-22 17:52:26.967 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ‘ŠğŸ¿', 'ğŸ©¸', 'ğŸš´ğŸ½\u200dâ™€', 'â–¶ï¸', 'ğŸ§œğŸ½\u200dâ™‚', 'ğŸ‡¦ğŸ‡·', 'ğŸ“¡', 'ğŸ§œğŸ¼\u200dâ™‚', 'ğŸ‡­ğŸ‡·', 'ğŸ˜¼']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.66s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.26s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:15<00:05,  5.03s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  3.41s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  4.01s/it]
Processing depth (4, 5, 8, 9):   0%|          | 0/100 [00:17<?, ?it/s]2025-01-22 17:52:44.876 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the football.
2025-01-22 17:52:44.899 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3614, 3618) -->  Mary got the football
2025-01-22 17:52:44.899 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the bedroom.
2025-01-22 17:52:44.921 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4149, 4155) -->  Mary journeyed to the bedroom
2025-01-22 17:52:44.921 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the kitchen.
2025-01-22 17:52:44.954 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6524, 6530) -->  Mary went back to the kitchen
2025-01-22 17:52:44.954 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the milk.
2025-01-22 17:52:44.991 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7221, 7225) -->  Daniel left the milk
2025-01-22 17:52:44.991 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the office.
2025-01-22 17:52:45.005 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2873, 2878) --> . Daniel moved to the
2025-01-22 17:52:45.005 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the garden.
2025-01-22 17:52:45.024 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3864, 3869) --> . Sandra moved to the
2025-01-22 17:52:45.024 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the bedroom.
2025-01-22 17:52:45.040 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3259, 3264) --> . John travelled to the
2025-01-22 17:52:45.040 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel took the milk there.
2025-01-22 17:52:45.060 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4080, 4085) --> . Daniel took the milk
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:52:45.898 | INFO     | test_jbb_embedding:begin_test:693 - Mary got the football.<|eot_id|>
2025-01-22 17:52:45.898 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8165])
2025-01-22 17:52:48.115 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [363.303125, 26.24063226922135, 217.871875, 24.939712644562007, 41.650534237132355], 'topk_indices': array([3264, 8148,   24, 3618, 8053,    3, 4154, 3613, 3616, 8153, 8159,
       8063, 8161, 8152, 8160, 3615,   14, 8163, 3617,    0]), 'topk_tokens': [' bedroom', ':', '\n\n', '.', '.\n\n', '<|end_header_id|>', ' bedroom', '.', ' the', ' before', ':', ' location', '<|start_header_id|>', ' football', '<|eot_id|>', ' got', '\n', '<|end_header_id|>', ' football', '<|begin_of_text|>'], 'evidence_proportions': [795.125, 426.0416666666667, 209.8125, 67.609375]}, 'weight': {'score': [25.396875, 23.281843015426052, 21.0171875, 23.282211183562993, 29.94577205882353], 'topk_indices': array([3302, 3275, 3141, 3189, 7454, 7416, 1437, 1499, 4336, 4320, 5155,
       5216, 7114, 7170, 3484, 3458, 4980, 4957, 5009, 4932]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.611328125, 24.57421875, 24.69921875, 26.462890625]}, 'saliency': {'score': [2.365545654296875, 0.14836930621499295, 1.214129638671875, 0.1402912139892578, 0.3124513065113741], 'topk_indices': array([8062, 8053, 8149, 3625, 8134, 3261, 3865, 8147, 4150, 8019, 8155,
       8158, 8153, 3614, 8063, 3264, 4154, 3615, 8152, 3617]), 'topk_tokens': [' first', '.\n\n', ' Where', ' Grow', ' return', ' travelled', ' Sandra', 'Question', ' journey', ' context', ' kitchen', 'Answer', ' before', ' Mary', ' location', ' bedroom', ' bedroom', ' got', ' football', ' football'], 'evidence_proportions': [5.47607421875, 2.6941731770833335, 1.2488606770833333, 0.437103271484375]}}, 'pred_res': 'Mary got the football.<|eot_id|>', 'score': 0}
2025-01-22 17:52:48.122 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:52:48.122 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-72_pid-0_4-5-8-9.pkl | len: 3 |  size: 2.06 KB
Processing depth (4, 5, 8, 9):   1%|          | 1/100 [00:21<34:44, 21.05s/it]is_0k: False
your chose emoji: ['ğŸ•˜', 'ğŸ§–ğŸ¼', 'ğŸ§–ğŸ»\u200dâ™‚ï¸', 'ğŸ‘°\u200dâ™‚ï¸', 'ğŸ§œğŸ½\u200dâ™€ï¸', 'ğŸŒµ', 'ğŸŠğŸ¼\u200dâ™€', 'ğŸ‘¬ğŸ½', 'ğŸƒğŸ½\u200dâ™€\u200dâ¡ï¸', 'ğŸï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.06s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.84s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.77s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.30s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.80s/it]
Processing depth (3, 5, 6, 7):   1%|          | 1/100 [00:38<34:44, 21.05s/it]2025-01-22 17:53:05.185 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the football.
2025-01-22 17:53:05.200 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2988, 2992) -->  Mary got the football
2025-01-22 17:53:05.200 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the bedroom.
2025-01-22 17:53:05.222 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4267, 4273) -->  Mary journeyed to the bedroom
2025-01-22 17:53:05.222 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the kitchen.
2025-01-22 17:53:05.246 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4817, 4823) -->  the senate. Mary went back
2025-01-22 17:53:05.246 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the milk.
2025-01-22 17:53:05.274 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5697, 5701) -->  Daniel left the milk
2025-01-22 17:53:05.274 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the office.
2025-01-22 17:53:05.289 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2991, 2996) -->  football. Daniel moved to
2025-01-22 17:53:05.289 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the garden.
2025-01-22 17:53:05.309 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3917, 3922) -->  Sandra moved to the garden
2025-01-22 17:53:05.309 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the bedroom.
2025-01-22 17:53:05.329 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3324, 3329) --> . John travelled to the
2025-01-22 17:53:05.330 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel took the milk there.
2025-01-22 17:53:05.355 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4166, 4171) --> . Daniel took the milk
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:53:06.211 | INFO     | test_jbb_embedding:begin_test:693 - Mary got the football.<|eot_id|>
2025-01-22 17:53:06.211 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8257])
2025-01-22 17:53:08.464 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [257.9203125, 23.801810305690072, 233.9578125, 22.720850440997566, 16.044253700657894], 'topk_indices': array([  24, 8240, 3017, 2987, 2990, 8251, 8244, 8245, 3018, 2989,   14,
       3329, 8145, 8111, 8255, 2992, 8253, 2991, 8252,    0]), 'topk_tokens': ['\n\n', ':', ' of', '.', ' the', ':', ' football', ' before', ' its', ' got', '\n', ' bedroom', '.\n\n', ' context', '<|end_header_id|>', '.', '<|start_header_id|>', ' football', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [717.1875, 251.47916666666666, 97.734375, 48.59375]}, 'weight': {'score': [25.381640625, 23.342497730024213, 23.26640625, 23.337721449209244, 29.45422149122807], 'topk_indices': array([3307, 3280, 3194, 3146, 7520, 7482, 1437, 1499, 4360, 4344, 5241,
       5180, 7259, 7203, 3523, 3497, 4970, 4945, 4993, 5022]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.611328125, 24.57421875, 24.6484375, 26.462890625]}, 'saliency': {'score': [1.7327178955078124, 0.13375566311667675, 1.4085205078125, 0.12676362643276687, 0.11731847127278645], 'topk_indices': array([3057, 8241, 3016, 3029, 3326, 8155, 8145, 4272, 8250, 8239, 2988,
       3028, 8247, 8245, 3018, 2989, 8244, 8111, 3329, 2991]), 'topk_tokens': [' any', ' Where', ' any', 'room', ' travelled', ' location', '.\n\n', ' bedroom', 'Answer', 'Question', ' Mary', 'ball', ' kitchen', ' before', ' its', ' got', ' football', ' context', ' bedroom', ' football'], 'evidence_proportions': [4.84765625, 1.7025553385416667, 0.61798095703125, 0.3351287841796875]}}, 'pred_res': 'Mary got the football.<|eot_id|>', 'score': 0}
2025-01-22 17:53:08.471 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:53:08.471 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-72_pid-1_3-5-6-7.pkl | len: 3 |  size: 2.03 KB
Processing depth (3, 5, 6, 7):   2%|â–         | 2/100 [00:41<33:42, 20.64s/it]is_0k: False
your chose emoji: ['ğŸ‘¨ğŸ¿\u200dğŸ¦½\u200dâ¡ï¸', 'ğŸ§‘ğŸ»\u200dâ¤ï¸\u200dğŸ§‘ğŸ¿', 'ğŸ‘ˆğŸ¾', 'ğŸ§Š', 'ğŸˆ´', 'ğŸ‘¨ğŸ»\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘¨ğŸ½', 'ğŸ§‘ğŸ»\u200dâ¤\u200dğŸ§‘ğŸ½', 'ğŸ§‘ğŸ¿\u200dâ¤\u200dğŸ§‘ğŸ¾', 'ğŸ‡¹ğŸ‡»', 'ğŸ§‘ğŸ¿\u200dğŸ¤\u200dğŸ§‘ğŸ»']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.00s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.44s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.05s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:12<00:00,  2.63s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:12<00:00,  3.20s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 1, 6, 9):   2%|â–         | 2/100 [00:56<33:42, 20.64s/it]2025-01-22 17:53:23.366 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the football.
2025-01-22 17:53:23.406 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the bedroom.
2025-01-22 17:53:23.412 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (826, 832) --> . Mary journeyed to the
2025-01-22 17:53:23.412 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the kitchen.
2025-01-22 17:53:23.440 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4773, 4779) -->  the senate. Mary went back
2025-01-22 17:53:23.440 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the milk.
2025-01-22 17:53:23.475 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7265, 7269) -->  Daniel left the milk
2025-01-22 17:53:23.476 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the office.
2025-01-22 17:53:23.498 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2927, 2932) --> . Daniel moved to the
2025-01-22 17:53:23.498 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the garden.
2025-01-22 17:53:23.518 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3875, 3880) --> . Sandra moved to the
2025-01-22 17:53:23.518 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the bedroom.
2025-01-22 17:53:23.535 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3311, 3316) --> . John travelled to the
2025-01-22 17:53:23.535 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel took the milk there.
2025-01-22 17:53:23.555 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4089, 4094) --> . Daniel took the milk
2025-01-22 17:53:23.555 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 17:53:23.555 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 17:53:23.555 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 17:53:23.555 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ‘ˆğŸ¼', 'ğŸ§—ğŸ¼', 'ğŸ¤½ğŸ»\u200dâ™‚ï¸', 'ğŸ‘¨ğŸ¿\u200dâœˆï¸', 'ğŸ•ºğŸ»', 'ğŸ§‘ğŸ¼\u200dğŸ¦¼\u200dâ¡ï¸', 'âœ‹ğŸ¾', 'ğŸ§ğŸ¼\u200dâ¡', 'ğŸš£ğŸ¿', 'ğŸ’‡ğŸ¼\u200dâ™‚']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:05<00:16,  5.52s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.15s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.66s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.17s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.84s/it]
Processing depth (0, 1, 5, 6):   2%|â–         | 2/100 [01:13<33:42, 20.64s/it]2025-01-22 17:53:40.791 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the football.
2025-01-22 17:53:40.830 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the bedroom.
2025-01-22 17:53:40.835 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (801, 807) -->  Mary journeyed to the bedroom
2025-01-22 17:53:40.835 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the kitchen.
2025-01-22 17:53:40.855 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4116, 4122) -->  Mary went back to the kitchen
2025-01-22 17:53:40.855 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the milk.
2025-01-22 17:53:40.878 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4647, 4651) -->  Daniel left the milk
2025-01-22 17:53:40.878 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the office.
2025-01-22 17:53:40.892 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2847, 2852) --> . Daniel moved to the
2025-01-22 17:53:40.892 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the garden.
2025-01-22 17:53:40.911 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3833, 3838) --> . Sandra moved to the
2025-01-22 17:53:40.911 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the bedroom.
2025-01-22 17:53:40.926 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3123, 3128) --> . John travelled to the
2025-01-22 17:53:40.926 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel took the milk there.
2025-01-22 17:53:40.946 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4063, 4068) --> . Daniel took the milk
2025-01-22 17:53:40.946 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 17:53:40.946 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 17:53:40.946 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 17:53:40.946 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ‘ŠğŸ¾', 'ğŸ†', '\U0001faf4', 'ğŸ‘¨ğŸ¿\u200dğŸŒ¾', 'ğŸ¤©', 'ğŸ‡µğŸ‡ª', 'ğŸ¼', 'ğŸ‘©ğŸ¿\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘©ğŸ»', '\U0001face', 'ğŸ’']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.68s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.73s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.86s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.28s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.83s/it]
Processing depth (3, 5, 7, 8):   2%|â–         | 2/100 [01:31<33:42, 20.64s/it]2025-01-22 17:53:58.150 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the football.
2025-01-22 17:53:58.164 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2934, 2938) -->  Mary got the football
2025-01-22 17:53:58.165 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the bedroom.
2025-01-22 17:53:58.186 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4217, 4223) -->  Mary journeyed to the bedroom
2025-01-22 17:53:58.186 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the kitchen.
2025-01-22 17:53:58.214 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5564, 5570) -->  Mary went back to the kitchen
2025-01-22 17:53:58.214 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the milk.
2025-01-22 17:53:58.246 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6483, 6487) -->  Daniel left the milk
2025-01-22 17:53:58.246 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the office.
2025-01-22 17:53:58.260 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2937, 2942) -->  football. Daniel moved to
2025-01-22 17:53:58.260 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the garden.
2025-01-22 17:53:58.279 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3886, 3891) --> . Sandra moved to the
2025-01-22 17:53:58.280 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the bedroom.
2025-01-22 17:53:58.296 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3274, 3279) --> . John travelled to the
2025-01-22 17:53:58.296 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel took the milk there.
2025-01-22 17:53:58.316 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4138, 4143) --> . Daniel took the milk
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:53:59.071 | INFO     | test_jbb_embedding:begin_test:693 - the bedroom<|eot_id|>
2025-01-22 17:53:59.071 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8147])
2025-01-22 17:54:01.303 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [216.546875, 22.800636503067484, 204.0171875, 21.87594405055487, 22.2217624470339], 'topk_indices': array([  24, 8140, 8130, 7540, 7495, 2938, 3279, 2933, 8135,    3, 8134,
       8001,   14, 8141, 2905, 8145, 2937,    0, 8143, 8142]), 'topk_tokens': ['\n\n', 'Answer', ':', 'nes', 'nes', '.', ' bedroom', '.', ' before', '<|end_header_id|>', ' football', ' context', '\n', ':', '.', '<|end_header_id|>', ' football', '<|begin_of_text|>', '<|start_header_id|>', '<|eot_id|>'], 'evidence_proportions': [560.1875, 213.20833333333334, 114.54166666666667, 30.921875]}, 'weight': {'score': [25.396875, 23.253991564417177, 22.137890625, 23.251459425092477, 29.038665254237287], 'topk_indices': array([3290, 3317, 3198, 3150, 7432, 7394, 1487, 1425, 4294, 4310, 5113,
       5174, 7115, 7171, 3499, 3473, 4967, 4938, 4915, 4890]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.611328125, 24.57421875, 24.69921875, 26.462890625]}, 'saliency': {'score': [1.449127197265625, 0.12674040811924847, 1.198419189453125, 0.12083642397503083, 0.1603290105270127], 'topk_indices': array([2841, 2934, 7347, 4222, 2932, 8045, 2935, 2906, 8137, 2904, 7539,
       8129, 7540, 8135, 7495, 8140, 8001, 3279, 8134, 2937]), 'topk_tokens': ['illustr', ' Mary', 'nes', ' bedroom', ' Gov', ' location', ' got', ' During', ' kitchen', ' Gov', ' Min', 'Question', 'nes', ' before', 'nes', 'Answer', ' context', ' bedroom', ' football', ' football'], 'evidence_proportions': [3.817138671875, 1.3994954427083333, 0.7470296223958334, 0.208709716796875]}}, 'pred_res': 'the bedroom<|eot_id|>', 'score': 100}
2025-01-22 17:54:01.310 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:54:01.310 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-72_pid-2_3-5-7-8.pkl | len: 3 |  size: 2.02 KB
Processing depth (3, 5, 7, 8):   3%|â–         | 3/100 [01:34<57:08, 35.34s/it]is_0k: False
your chose emoji: ['ğŸ‘©ğŸ¼\u200dğŸ¦¯\u200dâ¡', 'ğŸ—¡ï¸', 'ğŸ”¤', 'ğŸ', 'ğŸ¦¿', 'ğŸ‡°ğŸ‡¾', '\U0001fa7b', 'ğŸ’†ğŸ¼\u200dâ™€ï¸', 'ğŸ‘¨ğŸ½\u200dğŸ¦½', 'ğŸ§›ğŸ¼']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.55s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.87s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.54s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.19s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.73s/it]
Processing depth (1, 4, 6, 7):   3%|â–         | 3/100 [01:51<57:08, 35.34s/it]2025-01-22 17:54:18.921 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the football.
2025-01-22 17:54:18.926 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (896, 900) -->  Mary got the football
2025-01-22 17:54:18.927 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the bedroom.
2025-01-22 17:54:18.946 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3590, 3596) --> . Mary journeyed to the
2025-01-22 17:54:18.946 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the kitchen.
2025-01-22 17:54:18.975 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4743, 4749) --> . Mary went back to the
2025-01-22 17:54:18.975 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the milk.
2025-01-22 17:54:19.003 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5623, 5627) -->  Daniel left the milk
2025-01-22 17:54:19.004 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the office.
2025-01-22 17:54:19.019 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2936, 2941) --> . Daniel moved to the
2025-01-22 17:54:19.019 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the garden.
2025-01-22 17:54:19.038 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3867, 3872) --> . Sandra moved to the
2025-01-22 17:54:19.038 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the bedroom.
2025-01-22 17:54:19.057 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3248, 3253) --> . John travelled to the
2025-01-22 17:54:19.058 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel took the milk there.
2025-01-22 17:54:19.081 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4080, 4085) -->  Daniel took the milk there
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:54:19.925 | INFO     | test_jbb_embedding:begin_test:693 - Mary's bedroom.<|eot_id|>
2025-01-22 17:54:19.925 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8179])
2025-01-22 17:54:22.139 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [229.80390625, 20.788713028599364, 124.83125, 20.019718358511422, 19.182734375], 'topk_indices': array([ 898, 8162, 8173, 8067,    1, 8178,  896, 8169, 8166, 8167,  900,
       8077,    3,   24,   14, 8177, 8175, 8174,  899,    0]), 'topk_tokens': [' the', ':', ':', '.\n\n', '<|start_header_id|>', '\n\n', ' Mary', ' kitchen', ' football', ' before', '.', ' location', '<|end_header_id|>', '\n\n', '\n', '<|end_header_id|>', '<|start_header_id|>', '<|eot_id|>', ' football', '<|begin_of_text|>'], 'evidence_proportions': [617.5625, 181.20833333333334, 145.38541666666666, 41.56640625]}, 'weight': {'score': [22.84296875, 23.28232324003911, 21.778515625, 23.287096421333825, 29.35], 'topk_indices': array([3326, 3353, 3180, 3228, 7396, 7434, 1466, 1404, 4330, 4346, 5154,
       5215, 7173, 7117, 3509, 3535, 4979, 4956, 5008, 4931]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.611328125, 20.052083333333332, 20.708333333333332, 26.462890625]}, 'saliency': {'score': [1.4407806396484375, 0.11586182416432413, 0.6792724609375, 0.11122333373873511, 0.14122172037760417], 'topk_indices': array([4749, 8067, 3596, 8178, 8076, 8148, 8163, 8161,   24,  897, 8176,
       3250, 8172, 3253, 8167, 8077,  896, 8169, 8166,  899]), 'topk_tokens': [' kitchen', '.\n\n', ' bedroom', '\n\n', ' first', ' return', ' Where', 'Question', '\n\n', ' got', 'assistant', ' travelled', 'Answer', ' bedroom', ' before', ' location', ' Mary', ' kitchen', ' football', ' football'], 'evidence_proportions': [4.33203125, 0.9739583333333334, 0.7488606770833334, 0.2876434326171875]}}, 'pred_res': "Mary's bedroom.<|eot_id|>", 'score': 100}
2025-01-22 17:54:22.182 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:54:22.183 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-72_pid-3_1-4-6-7.pkl | len: 3 |  size: 2.06 KB
Processing depth (1, 4, 6, 7):   4%|â–         | 4/100 [01:55<47:24, 29.63s/it]is_0k: False
your chose emoji: ['\U0001faf1ğŸ»\u200d\U0001faf2ğŸ½', 'ğŸ‡°ğŸ‡µ', 'ğŸ„ğŸ»\u200dâ™‚ï¸', 'ğŸ‡µğŸ‡¹', 'ğŸ‘©ğŸ¾\u200dğŸ¦¯', 'â›³', 'ğŸŒ', '\U0001fac4ğŸ½', 'ğŸ‘³ğŸ¿\u200dâ™‚ï¸', 'ğŸ™ğŸ»\u200dâ™€']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.53s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.78s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:15<00:05,  5.13s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  3.78s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  4.18s/it]
Processing depth (3, 4, 7, 9):   4%|â–         | 4/100 [02:13<47:24, 29.63s/it]2025-01-22 17:54:40.679 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the football.
2025-01-22 17:54:40.696 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2872, 2876) -->  Mary got the football
2025-01-22 17:54:40.697 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the bedroom.
2025-01-22 17:54:40.715 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3612, 3618) --> . Mary journeyed to the
2025-01-22 17:54:40.716 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the kitchen.
2025-01-22 17:54:40.748 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5607, 5613) --> . Mary went back to the
2025-01-22 17:54:40.748 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the milk.
2025-01-22 17:54:40.783 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7106, 7110) -->  left the milk.
2025-01-22 17:54:40.783 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the office.
2025-01-22 17:54:40.797 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2875, 2880) -->  football. Daniel moved to
2025-01-22 17:54:40.797 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the garden.
2025-01-22 17:54:40.818 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3840, 3845) -->  Sandra moved to the garden
2025-01-22 17:54:40.819 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the bedroom.
2025-01-22 17:54:40.837 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3262, 3267) --> . John travelled to the
2025-01-22 17:54:40.837 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel took the milk there.
2025-01-22 17:54:40.860 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4079, 4084) --> . Daniel took the milk
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:54:41.731 | INFO     | test_jbb_embedding:begin_test:693 - Mary got the football.<|eot_id|>
2025-01-22 17:54:41.731 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8157])
2025-01-22 17:54:43.968 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [200.653125, 22.679541973039214, 221.0703125, 21.752536176108375, 25.79833984375], 'topk_indices': array([7495, 7540, 8144, 8053, 8059, 8054, 8145,   24, 7347, 8051, 8151,
       2876, 8045,   14, 8155, 2875, 8055, 8153, 8152,    0]), 'topk_tokens': ['nes', 'nes', ' football', ' the', ' the', ' first', ' before', '\n\n', 'nes', ' item', ':', '.', '.\n\n', '\n', '<|end_header_id|>', ' football', ' location', '<|start_header_id|>', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [472.8125, 200.0, 98.79166666666667, 82.265625]}, 'weight': {'score': [21.620703125, 23.258880974264706, 23.26640625, 23.262897359913794, 28.8984375], 'topk_indices': array([3305, 3278, 3192, 3144, 7432, 7394, 1429, 1491, 4296, 4312, 5139,
       5200, 7171, 7115, 3487, 3461, 4973, 4921, 4944, 4896]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.611328125, 20.052083333333332, 20.708333333333332, 20.3515625]}, 'saliency': {'score': [1.23021240234375, 0.12746763042375153, 1.3126434326171874, 0.12183235807371844, 0.19280767440795898], 'topk_indices': array([2852, 7892, 8049, 8139, 8011, 8045, 7539, 3267, 8150, 7495, 7540,
       3618, 8145, 8054, 8147, 8144, 7347, 8051, 8055, 2875]), 'topk_tokens': ['nes', ' Square', ' obtained', 'Question', ' context', '.\n\n', ' Min', ' bedroom', 'Answer', 'nes', 'nes', ' bedroom', ' before', ' first', ' kitchen', ' football', 'nes', ' item', ' location', ' football'], 'evidence_proportions': [3.291259765625, 1.1180419921875, 0.501708984375, 0.43017578125]}}, 'pred_res': 'Mary got the football.<|eot_id|>', 'score': 0}
2025-01-22 17:54:43.980 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:54:43.981 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-72_pid-4_3-4-7-9.pkl | len: 3 |  size: 2.03 KB
Processing depth (3, 4, 7, 9):   5%|â–Œ         | 5/100 [02:16<42:26, 26.81s/it]Processing depth (3, 4, 7, 9):   5%|â–Œ         | 5/100 [02:16<43:22, 27.40s/it]
2025-01-22 17:54:44.057 | INFO     | __main__:<module>:82 - Selected idx: 74
2025-01-22 17:54:44.057 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the football before the kitchen? 
2025-01-22 17:54:44.057 | INFO     | __main__:<module>:84 - Answer: bedroom
2025-01-22 17:54:44.057 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 17:54:44.057 | INFO     | __main__:<module>:86 - Needle: [' Mary took the football.', ' Daniel moved to the office.', ' Sandra moved to the garden.', ' Mary journeyed to the bedroom.', ' John travelled to the bedroom.', ' John went to the hallway.', ' Mary went back to the kitchen.', ' Sandra travelled to the kitchen.']
2025-01-22 17:54:44.057 | INFO     | __main__:<module>:87 - Real Needle: [' Mary took the football.', ' Mary journeyed to the bedroom.', ' Mary went back to the kitchen.', ' Sandra travelled to the kitchen.']
2025-01-22 17:54:44.057 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸš£ğŸ¾\u200dâ™‚', 'ğŸ‚', 'ğŸ§”ğŸ¼', 'ğŸ‡±ğŸ‡º', 'ğŸ¦¸ğŸ¼\u200dâ™‚', 'ğŸ‘©ğŸ½\u200dğŸ¨', 'â„¢', '\U0001faf3ğŸ»', 'ğŸ§¤', 'ğŸ‘¨ğŸ»\u200dâš•ï¸']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  3.93s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.44s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.68s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.29s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.71s/it]
Processing depth (2, 5, 6, 7):   0%|          | 0/100 [00:16<?, ?it/s]2025-01-22 17:55:00.948 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary took the football.
2025-01-22 17:55:00.958 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1753, 1757) -->  took the football.
2025-01-22 17:55:00.958 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the bedroom.
2025-01-22 17:55:00.982 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4158, 4164) --> . Mary journeyed to the
2025-01-22 17:55:00.982 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the kitchen.
2025-01-22 17:55:01.008 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4749, 4755) --> . Mary went back to the
2025-01-22 17:55:01.009 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra travelled to the kitchen.
2025-01-22 17:55:01.041 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5670, 5675) --> . Sandra travelled to the
2025-01-22 17:55:01.041 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the office.
2025-01-22 17:55:01.060 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3354, 3359) --> . Daniel moved to the
2025-01-22 17:55:01.060 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the garden.
2025-01-22 17:55:01.073 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2520, 2525) --> . Sandra moved to the
2025-01-22 17:55:01.073 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the bedroom.
2025-01-22 17:55:01.104 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5766, 5771) --> . John travelled to the
2025-01-22 17:55:01.104 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the hallway.
2025-01-22 17:55:01.118 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2554, 2559) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:55:01.973 | INFO     | test_jbb_embedding:begin_test:693 - Mary took the football.<|eot_id|>
2025-01-22 17:55:01.973 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8190])
2025-01-22 17:55:04.341 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [381.4583333333333, 30.53969089466618, 186.4375, 29.253227735525023, 48.6161376953125], 'topk_indices': array([8171, 8181, 1753, 8189, 8088, 8044,   14,   24, 8173, 4164, 1756,
       8188, 8177, 1522, 8178, 8180, 1755, 8185, 8186,    0]), 'topk_tokens': ['.\n\n', '?', ' took', '\n\n', ' location', ' context', '\n', '\n\n', ':', ' bedroom', '.', '<|end_header_id|>', ' football', 'ï¿½', ' before', ' kitchen', ' football', '<|eot_id|>', '<|start_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [792.9375, 273.8333333333333, 255.66666666666666, 332.375]}, 'weight': {'score': [20.86532738095238, 23.280975375320395, 19.89453125, 23.29550647080471, 28.91484375], 'topk_indices': array([3310, 3337, 3182, 3230, 7425, 7463, 1417, 1479, 4302, 4318, 5215,
       5154, 7146, 7202, 3525, 3499, 4956, 5008, 4979, 4931]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.71484375, 20.052083333333332, 20.708333333333332, 22.15]}, 'saliency': {'score': [2.1131417410714284, 0.17225091040941962, 1.006689453125, 0.16520386940129722, 0.3693401336669922], 'topk_indices': array([2521, 8181, 8174, 8187, 4755, 1520, 5675, 1750, 1753, 8172, 8088,
       1752, 5671, 8044, 1522, 8178, 4164, 8177, 8180, 1755]), 'topk_tokens': [' Sandra', '?', ' Where', 'assistant', ' kitchen', 'ï¿½', ' kitchen', 'ï¿½', ' took', 'Question', ' location', ' Mary', ' Sandra', ' context', 'ï¿½', ' before', ' bedroom', ' football', ' kitchen', ' football'], 'evidence_proportions': [4.443115234375, 1.4441731770833333, 1.2044270833333333, 2.1423828125]}}, 'pred_res': 'Mary took the football.<|eot_id|>', 'score': 0}
2025-01-22 17:55:04.364 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:55:04.365 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-74_pid-0_2-5-6-7.pkl | len: 3 |  size: 2.04 KB
Processing depth (2, 5, 6, 7):   1%|          | 1/100 [00:20<33:19, 20.20s/it]is_0k: False
your chose emoji: ['ğŸ‡±ğŸ‡¦', 'ğŸ‘¨ğŸ½\u200dğŸ’»', 'ğŸš¶ğŸ¼\u200dâ™‚', 'ğŸ‘¨ğŸ¼\u200dğŸ¤\u200dğŸ‘¨ğŸ¾', 'âš ï¸', 'ğŸ“•', 'ğŸ¤¾\u200dâ™‚ï¸', 'ğŸ‡²ğŸ‡¹', '\U0001faf1ğŸ»\u200d\U0001faf2ğŸ¼', 'ğŸ‘·ğŸ¾']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.09s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.41s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.50s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.18s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.62s/it]
Processing depth (2, 3, 4, 6):   1%|          | 1/100 [00:36<33:19, 20.20s/it]2025-01-22 17:55:20.713 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary took the football.
2025-01-22 17:55:20.721 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1772, 1776) -->  Mary took the football
2025-01-22 17:55:20.722 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the bedroom.
2025-01-22 17:55:20.736 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2864, 2870) --> . Mary journeyed to the
2025-01-22 17:55:20.736 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the kitchen.
2025-01-22 17:55:20.756 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3645, 3651) --> . Mary went back to the
2025-01-22 17:55:20.756 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra travelled to the kitchen.
2025-01-22 17:55:20.783 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4882, 4887) --> . Sandra travelled to the
2025-01-22 17:55:20.783 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the office.
2025-01-22 17:55:20.801 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3489, 3494) --> . Daniel moved to the
2025-01-22 17:55:20.801 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the garden.
2025-01-22 17:55:20.813 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2532, 2537) --> . Sandra moved to the
2025-01-22 17:55:20.814 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the bedroom.
2025-01-22 17:55:20.855 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5826, 5831) --> . John travelled to the
2025-01-22 17:55:20.855 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the hallway.
2025-01-22 17:55:20.870 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2566, 2571) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:55:21.729 | INFO     | test_jbb_embedding:begin_test:693 - Mary took the football.<|eot_id|>
2025-01-22 17:55:21.729 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8188])
2025-01-22 17:55:23.939 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [315.9315476190476, 27.42261514161885, 147.0859375, 26.38556556748466, 16.979677610759495], 'topk_indices': array([8169, 8179, 2870, 1776,   24, 8076, 8171,   14, 8176, 8183, 1730,
       8178, 8086, 1651, 8186, 8175, 8184, 1652, 1775,    0]), 'topk_tokens': ['.\n\n', '?', ' bedroom', '.', '\n\n', '.\n\n', ':', '\n', ' before', '<|eot_id|>', ' some', ' kitchen', ' location', ' some', '<|end_header_id|>', ' football', '<|start_header_id|>', ' time', ' football', '<|begin_of_text|>'], 'evidence_proportions': [718.375, 277.9583333333333, 211.79166666666666, 164.5125]}, 'weight': {'score': [21.96688988095238, 23.28458445244781, 19.89453125, 23.29629888803681, 29.173259493670887], 'topk_indices': array([3350, 3323, 3243, 3195, 7467, 7429, 1531, 1469, 4315, 4331, 5132,
       5193, 7206, 7150, 3512, 3538, 4934, 4909, 4957, 4986]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.498046875, 20.052083333333332, 20.708333333333332, 22.15]}, 'saliency': {'score': [1.9061453683035714, 0.15349077278987608, 0.805352783203125, 0.1473750688985813, 0.1241823993151701], 'topk_indices': array([  24, 8085, 1773, 1710, 8042, 3651, 8076, 1772, 8181, 2533, 8170,
       8176, 2870, 1730, 1651, 8086, 8178, 1652, 8175, 1775]), 'topk_tokens': ['\n\n', ' first', ' took', 'Min', ' context', ' kitchen', '.\n\n', ' Mary', 'Answer', ' Sandra', 'Question', ' before', ' bedroom', ' some', ' some', ' location', ' kitchen', ' time', ' football', ' football'], 'evidence_proportions': [5.05859375, 1.48828125, 1.0172932942708333, 0.95224609375]}}, 'pred_res': 'Mary took the football.<|eot_id|>', 'score': 0}
2025-01-22 17:55:23.947 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:55:23.947 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-74_pid-1_2-3-4-6.pkl | len: 3 |  size: 2.04 KB
Processing depth (2, 3, 4, 6):   2%|â–         | 2/100 [00:39<32:23, 19.83s/it]is_0k: False
your chose emoji: ['ğŸ‘¨ğŸ¼\u200dğŸ«', 'ğŸ‘¨ğŸ¾\u200dâ¤ï¸\u200dğŸ‘¨ğŸ½', 'ğŸ‘¨ğŸ½\u200dâ¤\u200dğŸ‘¨ğŸ»', 'ğŸ‘©ğŸ¾\u200dâœˆ', 'ğŸš¶ğŸ½', 'â˜', 'ğŸ‘¨ğŸ½\u200dâœˆ', 'ğŸ¤ğŸ»', 'ğŸ¤³', 'ğŸ¤£']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.48s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.71s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.47s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.10s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.64s/it]
Processing depth (4, 5, 7, 9):   2%|â–         | 2/100 [00:56<32:23, 19.83s/it]2025-01-22 17:55:41.096 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary took the football.
2025-01-22 17:55:41.113 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3620, 3624) -->  Mary took the football
2025-01-22 17:55:41.114 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the bedroom.
2025-01-22 17:55:41.135 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4172, 4178) --> . Mary journeyed to the
2025-01-22 17:55:41.135 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the kitchen.
2025-01-22 17:55:41.163 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5606, 5612) -->  Mary went back to the kitchen
2025-01-22 17:55:41.164 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra travelled to the kitchen.
2025-01-22 17:55:41.199 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7252, 7257) --> . Sandra travelled to the
2025-01-22 17:55:41.199 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the office.
2025-01-22 17:55:41.217 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3493, 3498) --> . Daniel moved to the
2025-01-22 17:55:41.217 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the garden.
2025-01-22 17:55:41.230 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2667, 2672) --> . Sandra moved to the
2025-01-22 17:55:41.230 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the bedroom.
2025-01-22 17:55:41.259 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5662, 5667) --> . John travelled to the
2025-01-22 17:55:41.259 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the hallway.
2025-01-22 17:55:41.274 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2787, 2792) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:55:42.063 | INFO     | test_jbb_embedding:begin_test:693 - the bedroom<|eot_id|>
2025-01-22 17:55:42.063 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8200])
2025-01-22 17:55:44.289 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [172.2529761904762, 15.359641670730221, 83.3640625, 14.789334339010047, 15.086500459558824], 'topk_indices': array([8196,    4, 8183, 8193, 8088, 8187, 8181, 8098, 3623, 8188,   24,
          3,    9, 4178, 8194, 8199,   14, 8198,    0, 8195]), 'topk_tokens': ['<|start_header_id|>', '\n\n', ':', 'Answer', '.\n\n', ' football', '.\n\n', ' location', ' football', ' before', '\n\n', '<|end_header_id|>', ':', ' bedroom', ':', '\n\n', '\n', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [328.65625, 179.83333333333334, 124.52083333333333, 95.3125]}, 'weight': {'score': [23.107142857142858, 23.30836279409972, 19.89453125, 23.317245696520462, 29.90496323529412], 'topk_indices': array([3257, 3284, 3117, 3165, 7469, 7431, 1461, 1399, 4316, 4332, 5228,
       5167, 7202, 7146, 3458, 3484, 5001, 4972, 4949, 4924]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.498046875, 20.052083333333332, 24.69921875, 22.15]}, 'saliency': {'score': [1.0067022414434523, 0.08451433843277611, 0.465997314453125, 0.0812068641025101, 0.11346947165096508], 'topk_indices': array([8194, 8184, 8169, 8192, 8181, 8088,   24,    8, 8197,   14, 8199,
       8054, 8190, 8182, 8188, 8098, 8193, 8187, 3623, 4178]), 'topk_tokens': [':', ' Where', ' return', ' \n', '.\n\n', '.\n\n', '\n\n', ' Date', 'assistant', '\n', '\n\n', ' context', ' kitchen', 'Question', ' before', ' location', 'Answer', ' football', ' football', ' bedroom'], 'evidence_proportions': [2.2252197265625, 0.8964436848958334, 0.71240234375, 0.5173583984375]}}, 'pred_res': 'the bedroom<|eot_id|>', 'score': 100}
2025-01-22 17:55:44.293 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:55:44.294 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-74_pid-2_4-5-7-9.pkl | len: 3 |  size: 2.01 KB
Processing depth (4, 5, 7, 9):   3%|â–         | 3/100 [01:00<32:26, 20.07s/it]is_0k: False
your chose emoji: ['â¯ï¸', 'ğŸ‘©ğŸ¼\u200dğŸ¦²', '\U0001fac3ğŸ¿', 'ğŸ¤½\u200dâ™€', 'ğŸ™', 'ğŸ‘©ğŸ¿\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘¨ğŸ¾', 'ğŸ‘±ğŸ½\u200dâ™‚ï¸', 'ğŸ§–ğŸ¿\u200dâ™€ï¸', 'ğŸ‘·ğŸ½\u200dâ™‚ï¸', 'ğŸš´ğŸ½\u200dâ™‚']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.58s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.82s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.27s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.79s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.42s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (2, 3, 4, 9):   3%|â–         | 3/100 [01:16<32:26, 20.07s/it]2025-01-22 17:56:00.269 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary took the football.
2025-01-22 17:56:00.280 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1866, 1870) -->  Mary took the football
2025-01-22 17:56:00.280 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the bedroom.
2025-01-22 17:56:00.296 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2995, 3001) -->  tragedy. Mary journeyed to
2025-01-22 17:56:00.297 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the kitchen.
2025-01-22 17:56:00.320 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3665, 3671) --> . Mary went back to the
2025-01-22 17:56:00.320 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra travelled to the kitchen.
2025-01-22 17:56:00.357 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7121, 7126) -->  Sandra travelled to the kitchen
2025-01-22 17:56:00.357 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the office.
2025-01-22 17:56:00.377 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3595, 3600) --> . Daniel moved to the
2025-01-22 17:56:00.378 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the garden.
2025-01-22 17:56:00.393 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2694, 2699) --> . Sandra moved to the
2025-01-22 17:56:00.393 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the bedroom.
2025-01-22 17:56:00.425 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5752, 5757) --> . John travelled to the
2025-01-22 17:56:00.425 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the hallway.
2025-01-22 17:56:00.439 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2814, 2819) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:56:06.429 | INFO     | test_jbb_embedding:begin_test:693 - Mary took the football.<|eot_id|>
2025-01-22 17:56:06.429 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8172])
2025-01-22 17:56:09.587 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [364.55059523809524, 25.109797400611622, 114.409375, 24.01387309441849, 21.834754621478872], 'topk_indices': array([8070, 8155,   14, 1865, 3672, 1866,   24, 8162, 8026, 1870, 8159,
       8160, 1867, 8168, 3002, 1868, 8170, 8167,    0, 1869]), 'topk_tokens': [' location', ':', '\n', '.', '.', ' Mary', '\n\n', ' kitchen', ' context', '.', ' football', ' before', ' took', '<|start_header_id|>', ' bedroom', ' the', '<|end_header_id|>', '<|eot_id|>', '<|begin_of_text|>', ' football'], 'evidence_proportions': [952.375, 266.6770833333333, 242.16666666666666, 158.6]}, 'weight': {'score': [24.489955357142858, 23.27427752293578, 19.89453125, 23.279449110216376, 29.243397887323944], 'topk_indices': array([3306, 3279, 3151, 3199, 7411, 7449, 1429, 1491, 4321, 4305, 5146,
       5207, 7188, 7132, 3488, 3462, 4971, 4948, 5000, 4923]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.498046875, 24.891927083333332, 20.708333333333332, 26.9390625]}, 'saliency': {'score': [2.3178827194940474, 0.14168379384078747, 0.644134521484375, 0.13482994678010513, 0.16238865382234816], 'topk_indices': array([1868, 8165, 1104,   24, 2695, 8156, 3671, 8154, 1096, 8070, 2998,
       1103, 8160, 1866, 8026, 8162, 1867, 8159, 3002, 1869]), 'topk_tokens': [' the', 'Answer', '\u200d', '\n\n', ' Sandra', ' Where', ' kitchen', 'Question', 'ï¿½', ' location', ' journey', 'â¤', ' before', ' Mary', ' context', ' kitchen', ' took', ' football', ' bedroom', ' football'], 'evidence_proportions': [6.64453125, 1.5862223307291667, 1.1923828125, 1.08515625]}}, 'pred_res': 'Mary took the football.<|eot_id|>', 'score': 0}
2025-01-22 17:56:09.594 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:56:09.594 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-74_pid-3_2-3-4-9.pkl | len: 3 |  size: 2.04 KB
Processing depth (2, 3, 4, 9):   4%|â–         | 4/100 [01:25<35:24, 22.13s/it]is_0k: False
your chose emoji: ['ğŸ¶', 'ğŸª²', 'ğŸ§šğŸ¾\u200dâ™‚', 'ğŸ¤¹ğŸ¼\u200dâ™‚', 'ğŸ¦', 'ğŸ§²', 'ğŸŠğŸ»\u200dâ™€', 'ğŸ‘©ğŸ»\u200dâ¤\u200dğŸ‘©ğŸ¼', 'ğŸ„ğŸ¼\u200dâ™€', 'ğŸ§‘ğŸ½\u200dğŸš’']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.49s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.43s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.54s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.20s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.68s/it]
Processing depth (0, 1, 5, 6):   4%|â–         | 4/100 [01:41<35:24, 22.13s/it]2025-01-22 17:56:26.146 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary took the football.
2025-01-22 17:56:26.187 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the bedroom.
2025-01-22 17:56:26.192 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (900, 906) --> . Mary journeyed to the
2025-01-22 17:56:26.192 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the kitchen.
2025-01-22 17:56:26.213 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4165, 4171) --> . Mary went back to the
2025-01-22 17:56:26.213 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra travelled to the kitchen.
2025-01-22 17:56:26.241 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4752, 4757) --> . Sandra travelled to the
2025-01-22 17:56:26.241 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the office.
2025-01-22 17:56:26.261 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3503, 3508) --> . Daniel moved to the
2025-01-22 17:56:26.261 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the garden.
2025-01-22 17:56:26.274 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2681, 2686) --> . Sandra moved to the
2025-01-22 17:56:26.274 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the bedroom.
2025-01-22 17:56:26.303 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5762, 5767) --> . John travelled to the
2025-01-22 17:56:26.303 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the hallway.
2025-01-22 17:56:26.318 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2801, 2806) --> . John went to the
2025-01-22 17:56:26.319 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 17:56:26.319 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 17:56:26.319 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 17:56:26.319 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ ', 'ğŸ’‚ğŸ¼', 'â˜„', 'ğŸ•µğŸ¾\u200dâ™‚', 'ğŸ§‘ğŸ»\u200dğŸ­', 'ğŸ§‘ğŸ½\u200dâ¤\u200dğŸ§‘ğŸ»', 'ğŸ“©', 'ğŸ–•ğŸ½', 'ğŸ§‘\u200dğŸ¤', 'ğŸ§‘ğŸ½\u200dğŸ”§']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.75s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.52s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.47s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.07s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.61s/it]
Processing depth (3, 6, 8, 9):   4%|â–         | 4/100 [01:58<35:24, 22.13s/it]2025-01-22 17:56:42.727 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary took the football.
2025-01-22 17:56:42.741 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2968, 2972) -->  Mary took the football
2025-01-22 17:56:42.742 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the bedroom.
2025-01-22 17:56:42.765 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4752, 4758) -->  the senate. Mary journeyed
2025-01-22 17:56:42.766 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the kitchen.
2025-01-22 17:56:42.811 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6549, 6555) --> . Mary went back to the
2025-01-22 17:56:42.812 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra travelled to the kitchen.
2025-01-22 17:56:42.849 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7246, 7251) --> . Sandra travelled to the
2025-01-22 17:56:42.849 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the office.
2025-01-22 17:56:42.866 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3499, 3504) -->  Daniel moved to the office
2025-01-22 17:56:42.866 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the garden.
2025-01-22 17:56:42.880 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2773, 2778) --> . Sandra moved to the
2025-01-22 17:56:42.880 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the bedroom.
2025-01-22 17:56:42.911 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5649, 5654) --> . John travelled to the
2025-01-22 17:56:42.911 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the hallway.
2025-01-22 17:56:42.926 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2841, 2846) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:56:43.708 | INFO     | test_jbb_embedding:begin_test:693 - the bedroom<|eot_id|>
2025-01-22 17:56:43.708 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8188])
2025-01-22 17:56:45.940 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [143.10565476190476, 16.029582773776095, 105.2296875, 15.483251533742331, 16.018270371835442], 'topk_indices': array([8169,    9, 8171,    4, 8042, 8076, 8181, 8086, 8175, 8187, 8176,
          3, 2971,   24, 8182, 4760,   14, 8186,    0, 8183]), 'topk_tokens': ['.\n\n', ':', ':', '\n\n', ' context', '.\n\n', 'Answer', ' location', ' football', '\n\n', ' before', '<|end_header_id|>', ' football', '\n\n', ':', ' bedroom', '\n', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [307.9375, 180.5625, 71.875, 51.76875]}, 'weight': {'score': [23.092633928571427, 23.29376373458674, 20.898046875, 23.300161042944787, 29.649129746835442], 'topk_indices': array([3248, 3275, 3120, 3168, 7431, 7469, 1461, 1399, 4285, 4269, 5206,
       5145, 7196, 7140, 3443, 3469, 4928, 4880, 4957, 4905]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.498046875, 23.9921875, 20.708333333333332, 22.15]}, 'saliency': {'score': [0.8952287946428571, 0.08891821530490783, 0.569024658203125, 0.08566242990318251, 0.11962871310077136], 'topk_indices': array([2846,    8, 8180, 8182, 8076, 8185, 8172, 8187,   14, 8178, 8170,
       4756,   24, 8042, 8086, 8176, 8181, 8175, 2971, 4760]), 'topk_tokens': [' hallway', ' Date', ' \n', ':', '.\n\n', 'assistant', ' Where', '\n\n', '\n', ' kitchen', 'Question', ' journey', '\n\n', ' context', ' location', ' before', 'Answer', ' football', ' football', ' bedroom'], 'evidence_proportions': [2.146240234375, 1.10791015625, 0.3563232421875, 0.285888671875]}}, 'pred_res': 'the bedroom<|eot_id|>', 'score': 100}
2025-01-22 17:56:45.945 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:56:45.945 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-74_pid-4_3-6-8-9.pkl | len: 3 |  size: 2.01 KB
Processing depth (3, 6, 8, 9):   5%|â–Œ         | 5/100 [02:01<43:09, 27.26s/it]Processing depth (3, 6, 8, 9):   5%|â–Œ         | 5/100 [02:01<38:37, 24.39s/it]
2025-01-22 17:56:46.120 | INFO     | __main__:<module>:82 - Selected idx: 76
2025-01-22 17:56:46.121 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the football before the office? 
2025-01-22 17:56:46.121 | INFO     | __main__:<module>:84 - Answer: kitchen
2025-01-22 17:56:46.121 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 17:56:46.121 | INFO     | __main__:<module>:86 - Needle: [' John travelled to the bedroom.', ' Sandra moved to the garden.', ' Mary grabbed the football.', ' Mary went back to the kitchen.', ' Daniel moved to the office.', ' Mary went back to the office.', ' John went to the hallway.']
2025-01-22 17:56:46.121 | INFO     | __main__:<module>:87 - Real Needle: [' Mary grabbed the football.', ' Mary went back to the kitchen.', ' Mary went back to the office.', ' John went to the hallway.']
2025-01-22 17:56:46.121 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ§‘ğŸ½\u200dâ¤\u200dğŸ’‹\u200dğŸ§‘ğŸ»', 'ğŸ‘¨ğŸ¿\u200dğŸ¦¼', 'ğŸ˜·', 'ğŸŒ‚', 'ğŸ§ğŸ¾\u200dâ™€', 'ğŸ§‘ğŸ¿\u200dâš•ï¸', 'ğŸ™…ğŸ¿\u200dâ™‚ï¸', 'ğŸ‘©', 'ğŸ‡¸ğŸ‡­', 'ğŸ’‚ğŸ½\u200dâ™€ï¸']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.86s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.15s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:15<00:05,  5.14s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  3.49s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  4.08s/it]
Processing depth (0, 1, 4, 5):   0%|          | 0/100 [00:18<?, ?it/s]2025-01-22 17:57:04.283 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the football.
2025-01-22 17:57:04.324 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went back to the kitchen.
2025-01-22 17:57:04.328 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (690, 696) --> . Mary went back to the
2025-01-22 17:57:04.328 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the office.
2025-01-22 17:57:04.332 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (690, 696) --> . Mary went back to the
2025-01-22 17:57:04.332 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the hallway.
2025-01-22 17:57:04.353 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4164, 4169) --> . John went to the
2025-01-22 17:57:04.353 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the bedroom.
2025-01-22 17:57:04.381 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5160, 5165) --> . John travelled to the
2025-01-22 17:57:04.381 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the garden.
2025-01-22 17:57:04.406 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4838, 4843) -->  the senate. Sandra moved
2025-01-22 17:57:04.406 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 17:57:04.412 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1167, 1172) --> . Daniel moved to the
2025-01-22 17:57:04.412 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 17:57:04.412 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 17:57:04.412 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 17:57:04.412 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ™‡ğŸ¼\u200dâ™‚', 'ğŸ§ğŸ½\u200dâ™€\u200dâ¡', 'ğŸ‘¤', 'ğŸ™‹ğŸ¼\u200dâ™‚', 'ğŸ‘¶', 'ğŸ‘¨ğŸ¼\u200dğŸ³', 'ğŸ¤µğŸ»\u200dâ™‚', 'ğŸ§‘ğŸ¿\u200dğŸš€', 'ğŸ‘©\u200dğŸ¦°', 'ğŸ§˜\u200dâ™€']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.08s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:07<00:07,  3.98s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.32s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.04s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.45s/it]
Processing depth (0, 5, 7, 8):   0%|          | 0/100 [00:33<?, ?it/s]2025-01-22 17:57:19.985 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the football.
2025-01-22 17:57:20.044 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went back to the kitchen.
2025-01-22 17:57:20.067 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4205, 4211) -->  Mary went back to the kitchen
2025-01-22 17:57:20.068 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the office.
2025-01-22 17:57:20.098 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4206, 4212) -->  went back to the kitchen.
2025-01-22 17:57:20.098 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the hallway.
2025-01-22 17:57:20.135 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6598, 6603) --> . John went to the
2025-01-22 17:57:20.135 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the bedroom.
2025-01-22 17:57:20.163 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5295, 5300) --> . John travelled to the
2025-01-22 17:57:20.163 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the garden.
2025-01-22 17:57:20.187 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4945, 4950) --> . Sandra moved to the
2025-01-22 17:57:20.187 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 17:57:20.194 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1382, 1387) --> . Daniel moved to the
2025-01-22 17:57:20.194 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 17:57:20.194 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 17:57:20.194 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 17:57:20.194 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ™', 'âš–', 'ğŸš´ğŸ»\u200dâ™‚', 'ğŸ§‘ğŸ¼\u200dâ¤\u200dğŸ’‹\u200dğŸ§‘ğŸ½', 'ğŸ“„', 'ğŸ–‹', 'ğŸŠğŸ¼\u200dâ™€ï¸', '\U0001fac3ğŸ»', 'â™ ', 'â­ï¸']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:05<00:15,  5.05s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.83s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.61s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.17s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.76s/it]
Processing depth (0, 2, 3, 8):   0%|          | 0/100 [00:50<?, ?it/s]2025-01-22 17:57:37.121 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the football.
2025-01-22 17:57:37.160 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went back to the kitchen.
2025-01-22 17:57:37.170 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1852, 1858) --> . Mary went back to the
2025-01-22 17:57:37.170 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the office.
2025-01-22 17:57:37.179 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1852, 1858) --> . Mary went back to the
2025-01-22 17:57:37.179 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the hallway.
2025-01-22 17:57:37.212 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6546, 6551) --> . John went to the
2025-01-22 17:57:37.212 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the bedroom.
2025-01-22 17:57:37.237 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5150, 5155) --> . John travelled to the
2025-01-22 17:57:37.237 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the garden.
2025-01-22 17:57:37.261 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4828, 4833) -->  the senate. Sandra moved
2025-01-22 17:57:37.261 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 17:57:37.267 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1270, 1275) --> . Daniel moved to the
2025-01-22 17:57:37.268 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 17:57:37.268 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 17:57:37.268 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 17:57:37.268 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ¤¸ğŸ¿\u200dâ™€ï¸', 'â™£ï¸', 'ğŸ§‘ğŸ¿\u200dğŸ¼', 'ğŸ§‘ğŸ¾\u200dâš–ï¸', 'ğŸ§', 'ğŸ‡µğŸ‡·', 'ğŸ§ğŸ¼\u200dâ™‚ï¸', 'ğŸ‘©\u200dğŸ‘©\u200dğŸ‘§\u200dğŸ‘§', 'âœ…', 'ğŸ‘¨ğŸ¾\u200dâ¤ï¸\u200dğŸ‘¨ğŸ¿']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.41s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.55s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.69s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.27s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.75s/it]
Processing depth (4, 5, 7, 8):   0%|          | 0/100 [01:07<?, ?it/s]2025-01-22 17:57:54.125 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the football.
2025-01-22 17:57:54.142 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3608, 3612) -->  Mary grabbed the football
2025-01-22 17:57:54.143 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went back to the kitchen.
2025-01-22 17:57:54.164 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4138, 4144) --> . Mary went back to the
2025-01-22 17:57:54.164 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the office.
2025-01-22 17:57:54.185 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4138, 4144) --> . Mary went back to the
2025-01-22 17:57:54.185 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the hallway.
2025-01-22 17:57:54.218 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6604, 6609) --> . John went to the
2025-01-22 17:57:54.219 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the bedroom.
2025-01-22 17:57:54.244 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5225, 5230) --> . John travelled to the
2025-01-22 17:57:54.245 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the garden.
2025-01-22 17:57:54.269 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4927, 4932) --> . Sandra moved to the
2025-01-22 17:57:54.270 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 17:57:54.276 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1260, 1265) -->  Republican. Daniel moved to
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:57:55.088 | INFO     | test_jbb_embedding:begin_test:693 - Mary's kitchen.<|eot_id|>
2025-01-22 17:57:55.089 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8188])
2025-01-22 17:57:57.308 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [374.8199404761905, 29.766515840556707, 155.04166666666666, 28.64753985285101, 20.32641006097561], 'topk_indices': array([8179,   24, 8181, 8173,    3, 8172, 8169, 8177, 8170, 3609, 4144,
       8182, 8171, 8175, 8178, 8176, 8186, 8183, 3611,    0]), 'topk_tokens': ['?', '\n\n', 'Answer', ' was', '<|end_header_id|>', ' Where', '.\n\n', ' the', 'Question', ' grabbed', ' kitchen', ':', ':', ' football', ' office', ' before', '<|end_header_id|>', '<|eot_id|>', ' football', '<|begin_of_text|>'], 'evidence_proportions': [989.75, 299.875, 299.875, 62.74375]}, 'weight': {'score': [21.65438988095238, 23.303288288975704, 21.928645833333334, 23.31006284488044, 29.942263719512194], 'topk_indices': array([3318, 3291, 3211, 3163, 7467, 7429, 1451, 1513, 4326, 4310, 5192,
       5131, 7150, 7206, 3474, 3500, 4981, 4952, 4923, 4898]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.263671875, 20.708333333333332, 20.708333333333332, 18.6375]}, 'saliency': {'score': [2.4010416666666665, 0.16729662558371994, 0.863623046875, 0.16026369582503067, 0.15297587324933307], 'topk_indices': array([   0, 8182, 8171,   24, 5611, 8173, 8086, 8179, 8169, 8042, 3608,
       8172, 8181, 8170, 3609, 4144, 8176, 8175, 8178, 3611]), 'topk_tokens': ['<|begin_of_text|>', ':', ':', '\n\n', ' office', ' was', ' location', '?', '.\n\n', ' context', ' Mary', ' Where', 'Answer', 'Question', ' grabbed', ' kitchen', ' before', ' football', ' office', ' football'], 'evidence_proportions': [7.34521484375, 1.6092936197916667, 1.6092936197916667, 0.3458984375]}}, 'pred_res': "Mary's kitchen.<|eot_id|>", 'score': 100}
2025-01-22 17:57:57.315 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:57:57.315 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-76_pid-0_4-5-7-8.pkl | len: 3 |  size: 2.03 KB
Processing depth (4, 5, 7, 8):   1%|          | 1/100 [01:11<1:57:19, 71.11s/it]is_0k: False
your chose emoji: ['ğŸ‘©ğŸ¾\u200dğŸ¤\u200dğŸ‘¨ğŸ¿', 'ğŸ§‘ğŸ½\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ§‘ğŸ¼', 'ğŸ’†ğŸ½\u200dâ™€ï¸', 'ğŸŒªï¸', 'â›…', '\U0001faf3ğŸ½', 'ğŸ’«', 'â›¹ï¸\u200dâ™‚ï¸', 'ğŸ¦¶ğŸ¼', 'ğŸ¦¸ğŸ½\u200dâ™€ï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.46s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.65s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.39s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.02s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.56s/it]
Processing depth (3, 4, 8, 9):   1%|          | 1/100 [01:27<1:57:19, 71.11s/it]2025-01-22 17:58:13.357 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the football.
2025-01-22 17:58:13.374 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2908, 2912) -->  Mary grabbed the football
2025-01-22 17:58:13.374 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went back to the kitchen.
2025-01-22 17:58:13.395 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3616, 3622) --> . Mary went back to the
2025-01-22 17:58:13.395 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the office.
2025-01-22 17:58:13.415 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3616, 3622) --> . Mary went back to the
2025-01-22 17:58:13.416 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the hallway.
2025-01-22 17:58:13.454 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7165, 7170) -->  John went to the hallway
2025-01-22 17:58:13.454 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the bedroom.
2025-01-22 17:58:13.484 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5267, 5272) --> . John travelled to the
2025-01-22 17:58:13.484 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the garden.
2025-01-22 17:58:13.511 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4924, 4929) -->  Sandra moved to the garden
2025-01-22 17:58:13.511 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 17:58:13.521 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1289, 1294) --> . Daniel moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:58:14.358 | INFO     | test_jbb_embedding:begin_test:693 - Mary's kitchen.<|eot_id|>
2025-01-22 17:58:14.358 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8212])
2025-01-22 17:58:16.591 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [302.9456845238095, 25.708792985392574, 223.51875, 24.63419657048539, 35.767765126329785], 'topk_indices': array([8203, 8197, 8206, 8195, 8110, 1295, 8201,   14, 8198, 2909, 3622,
       8066, 8210, 2912, 8200, 8199, 8207, 8202, 2911,    0]), 'topk_tokens': ['?', ' was', ':', ':', ' location', '.', ' the', '\n', ' the', ' grabbed', ' kitchen', ' context', '<|end_header_id|>', '.', ' before', ' football', '<|eot_id|>', ' office', ' football', '<|begin_of_text|>'], 'evidence_proportions': [770.375, 263.75, 263.75, 23.071875]}, 'weight': {'score': [23.105654761904763, 23.31397025258673, 21.818229166666665, 23.317248250091698, 29.56150265957447], 'topk_indices': array([3379, 3352, 3224, 3272, 7493, 7455, 1497, 1435, 4354, 4338, 5173,
       5234, 7232, 7176, 3535, 3561, 5027, 4950, 4998, 4975]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.263671875, 20.708333333333332, 20.708333333333332, 24.7328125]}, 'saliency': {'score': [1.9168584914434523, 0.14605082107330342, 1.1873291015625, 0.13959451403269807, 0.26851118371841753], 'topk_indices': array([2908, 8203, 8197, 8065, 8205, 2233, 8196, 8064, 1291, 8194, 6541,
       1294, 8110, 8066, 3622, 2909, 8200, 8202, 8199, 2911]), 'topk_tokens': [' Mary', '?', ' was', ' you', 'Answer', 'â™€', ' Where', ' provided', ' moved', 'Question', ' office', ' office', ' location', ' context', ' kitchen', ' grabbed', ' before', ' office', ' football', ' football'], 'evidence_proportions': [5.776611328125, 1.3663736979166667, 1.3663736979166667, 0.1502197265625]}}, 'pred_res': "Mary's kitchen.<|eot_id|>", 'score': 100}
2025-01-22 17:58:16.598 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:58:16.598 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-76_pid-1_3-4-8-9.pkl | len: 3 |  size: 2.02 KB
Processing depth (3, 4, 8, 9):   2%|â–         | 2/100 [01:30<1:06:21, 40.62s/it]is_0k: False
your chose emoji: ['ğŸ‘¨\u200dğŸ‘©\u200dğŸ‘¦\u200dğŸ‘¦', 'ğŸ™‡ğŸ¼\u200dâ™‚ï¸', 'ğŸ§—ğŸ¾\u200dâ™€', 'ğŸ¦£', 'ğŸ‘¨\u200dğŸ‘¨\u200dğŸ‘§\u200dğŸ‘§', 'ğŸ‘©ğŸ½\u200dğŸ“', 'ğŸ§˜\u200dâ™€ï¸', 'ğŸ§‘ğŸ½\u200dğŸ’¼', 'ğŸ™ğŸ¼\u200dâ™‚ï¸', 'ğŸ’†ğŸ»\u200dâ™‚']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.42s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.73s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.66s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.23s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.75s/it]
Processing depth (1, 2, 5, 8):   2%|â–         | 2/100 [01:47<1:06:21, 40.62s/it]2025-01-22 17:58:33.560 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the football.
2025-01-22 17:58:33.564 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (820, 824) -->  Mary grabbed the football
2025-01-22 17:58:33.564 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went back to the kitchen.
2025-01-22 17:58:33.574 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1856, 1862) --> . Mary went back to the
2025-01-22 17:58:33.574 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the office.
2025-01-22 17:58:33.584 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1856, 1862) --> . Mary went back to the
2025-01-22 17:58:33.584 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the hallway.
2025-01-22 17:58:33.621 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6680, 6685) --> . John went to the
2025-01-22 17:58:33.622 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the bedroom.
2025-01-22 17:58:33.648 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5452, 5457) --> . John travelled to the
2025-01-22 17:58:33.649 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the garden.
2025-01-22 17:58:33.677 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5014, 5019) --> . Sandra moved to the
2025-01-22 17:58:33.677 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 17:58:33.684 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1274, 1279) --> . Daniel moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:58:34.515 | INFO     | test_jbb_embedding:begin_test:693 - Mary's kitchen.<|eot_id|>
2025-01-22 17:58:34.516 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8236])
2025-01-22 17:58:36.758 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [171.83928571428572, 15.189630681818182, 72.24270833333334, 14.684274236559796, 9.368246978183961], 'topk_indices': array([   9,    3, 8124, 8229, 8223, 8224, 8219,   24, 8089, 8134,  146,
         14, 8232, 8230,  823, 1862, 8090, 8234,    0, 8231]), 'topk_tokens': [':', '<|end_header_id|>', '.\n\n', 'Answer', ' football', ' before', ':', '\n\n', ' you', ' location', 'ï¿½', '\n', '<|start_header_id|>', ':', ' football', ' kitchen', ' context', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [376.34375, 169.4375, 169.4375, 14.0]}, 'weight': {'score': [21.65438988095238, 23.337159773637577, 20.313541666666666, 23.346996716140435, 29.75545400943396], 'topk_indices': array([3300, 3273, 3145, 3193, 7467, 7429, 1420, 1482, 4331, 4347, 5156,
       5217, 7146, 7202, 3456, 3482, 4975, 5004, 4952, 4927]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.263671875, 20.708333333333332, 20.708333333333332, 18.6375]}, 'saliency': {'score': [1.0756152925037203, 0.08483190359399655, 0.40486043294270835, 0.0817102555253223, 0.06818184762630823], 'topk_indices': array([  24, 8124, 8205,   20,  148,  820, 8089, 8218, 8088, 8226, 8224,
        146,  144,  821, 8229, 8134, 8223,  823, 8090, 1862]), 'topk_tokens': ['\n\n', '.\n\n', ' return', ' Jul', 'â™€', ' Mary', ' you', 'Question', ' provided', ' office', ' before', 'ï¿½', 'ï¿½', ' grabbed', 'Answer', ' location', ' football', ' football', ' context', ' kitchen'], 'evidence_proportions': [2.8629150390625, 0.9021809895833334, 0.9021809895833334, 0.062017822265625]}}, 'pred_res': "Mary's kitchen.<|eot_id|>", 'score': 100}
2025-01-22 17:58:36.765 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:58:36.765 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-76_pid-2_1-2-5-8.pkl | len: 3 |  size: 2.04 KB
Processing depth (1, 2, 5, 8):   3%|â–         | 3/100 [01:50<50:34, 31.28s/it]  is_0k: False
your chose emoji: ['ğŸ‘¨ğŸ»\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘¨ğŸ¾', 'ğŸ‘©ğŸ½\u200dğŸ¦²', 'â˜ ', 'ğŸ‘©ğŸ»\u200dğŸ¤\u200dğŸ‘©ğŸ¼', 'ğŸ—ï¸', 'ğŸ§‘ğŸ»\u200dâ¤ï¸\u200dğŸ§‘ğŸ¼', 'ğŸ…°ï¸', 'ğŸ‘©ğŸ»\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘©ğŸ¿', 'ğŸ¤½\u200dâ™€', 'ğŸ‘¨ğŸ¿\u200dğŸš€']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.26s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.46s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.34s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.79s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.37s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 5, 7, 9):   3%|â–         | 3/100 [02:05<50:34, 31.28s/it]2025-01-22 17:58:52.050 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the football.
2025-01-22 17:58:52.092 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went back to the kitchen.
2025-01-22 17:58:52.117 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4221, 4227) -->  Mary went back to the kitchen
2025-01-22 17:58:52.118 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the office.
2025-01-22 17:58:52.141 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4222, 4228) -->  went back to the kitchen.
2025-01-22 17:58:52.141 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the hallway.
2025-01-22 17:58:52.179 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7216, 7221) --> . John went to the
2025-01-22 17:58:52.179 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the bedroom.
2025-01-22 17:58:52.206 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5527, 5532) --> . John travelled to the
2025-01-22 17:58:52.207 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the garden.
2025-01-22 17:58:52.240 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5057, 5062) --> . Sandra moved to the
2025-01-22 17:58:52.240 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 17:58:52.248 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1290, 1295) --> . Daniel moved to the
2025-01-22 17:58:52.248 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 17:58:52.248 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 17:58:52.248 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 17:58:52.248 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ§‘ğŸ¾\u200dâ¤ï¸\u200dğŸ§‘ğŸ»', 'ğŸ§˜ğŸ»', 'ğŸ§ğŸ¾\u200dâ™‚\u200dâ¡ï¸', 'â™¾', 'ğŸ§˜', 'ğŸ‘©ğŸ¾\u200dğŸ¦¼', 'ğŸ‘©ğŸ¼\u200dğŸ¦¼', 'ğŸ‘±ğŸ¾\u200dâ™‚', 'ğŸ›¤', 'ğŸ’ğŸ¿\u200dâ™‚']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:05<00:16,  5.36s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.86s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.64s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.17s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.79s/it]
Processing depth (0, 1, 2, 7):   3%|â–         | 3/100 [02:22<50:34, 31.28s/it]2025-01-22 17:59:09.263 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the football.
2025-01-22 17:59:09.303 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went back to the kitchen.
2025-01-22 17:59:09.307 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (832, 838) --> . Mary went back to the
2025-01-22 17:59:09.307 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the office.
2025-01-22 17:59:09.311 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (832, 838) --> . Mary went back to the
2025-01-22 17:59:09.312 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the hallway.
2025-01-22 17:59:09.341 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5680, 5685) --> . John went to the
2025-01-22 17:59:09.341 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the bedroom.
2025-01-22 17:59:09.367 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5364, 5369) --> . John travelled to the
2025-01-22 17:59:09.367 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the garden.
2025-01-22 17:59:09.394 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4958, 4963) --> . Sandra moved to the
2025-01-22 17:59:09.394 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 17:59:09.400 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1289, 1294) --> . Daniel moved to the
2025-01-22 17:59:09.401 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 17:59:09.401 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 17:59:09.401 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 17:59:09.401 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ•µ\u200dâ™‚', 'ğŸƒğŸ¼\u200dâ¡ï¸', '\U0001faae', 'ğŸ§‘ğŸ¾\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ§‘ğŸ½', 'ğŸŒ«', 'ğŸ‘¨ğŸ¿\u200dğŸ¦³', 'ğŸ‡', 'ğŸ™‡ğŸ½\u200dâ™‚', 'ğŸ’ğŸ¿', 'ğŸ‘±ğŸ¾\u200dâ™€']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.26s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:09,  4.51s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.79s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.36s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.81s/it]
Processing depth (0, 1, 3, 8):   3%|â–         | 3/100 [02:40<50:34, 31.28s/it]2025-01-22 17:59:26.506 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the football.
2025-01-22 17:59:26.558 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went back to the kitchen.
2025-01-22 17:59:26.564 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (900, 906) --> . Mary went back to the
2025-01-22 17:59:26.564 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the office.
2025-01-22 17:59:26.569 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (900, 906) --> . Mary went back to the
2025-01-22 17:59:26.569 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the hallway.
2025-01-22 17:59:26.613 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6568, 6573) --> . John went to the
2025-01-22 17:59:26.613 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the bedroom.
2025-01-22 17:59:26.651 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5288, 5293) --> . John travelled to the
2025-01-22 17:59:26.651 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the garden.
2025-01-22 17:59:26.677 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4945, 4950) -->  Sandra moved to the garden
2025-01-22 17:59:26.677 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 17:59:26.683 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1283, 1288) --> . Daniel moved to the
2025-01-22 17:59:26.683 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 17:59:26.683 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 17:59:26.683 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 17:59:26.683 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ«’', 'ğŸ‘¨ğŸ¾\u200dğŸš’', 'ğŸ‘©ğŸ¼\u200dğŸ¤\u200dğŸ‘©ğŸ¾', 'ğŸ‘©ğŸ¿\u200dğŸ¤\u200dğŸ‘©ğŸ¾', 'ğŸ”', 'ğŸ‡¨ğŸ‡®', 'ğŸ¤šğŸ½', 'ğŸ‘©ğŸ¾\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘©ğŸ½', 'ğŸƒ\u200dâ™‚', 'ğŸ’‚ğŸ»\u200dâ™€ï¸']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.37s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.25s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:16<00:05,  5.83s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:17<00:00,  3.97s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:17<00:00,  4.34s/it]
Processing depth (1, 3, 4, 7):   3%|â–         | 3/100 [02:59<50:34, 31.28s/it]2025-01-22 17:59:45.899 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the football.
2025-01-22 17:59:45.904 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (896, 900) -->  Mary grabbed the football
2025-01-22 17:59:45.904 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went back to the kitchen.
2025-01-22 17:59:45.922 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2836, 2842) --> . Mary went back to the
2025-01-22 17:59:45.922 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the office.
2025-01-22 17:59:45.937 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2836, 2842) --> . Mary went back to the
2025-01-22 17:59:45.938 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the hallway.
2025-01-22 17:59:45.967 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5730, 5735) --> . John went to the
2025-01-22 17:59:45.967 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the bedroom.
2025-01-22 17:59:45.997 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5414, 5419) --> . John travelled to the
2025-01-22 17:59:45.997 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the garden.
2025-01-22 17:59:46.025 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4976, 4981) --> . Sandra moved to the
2025-01-22 17:59:46.025 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 17:59:46.032 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1237, 1242) -->  Republican. Daniel moved to
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 17:59:46.878 | INFO     | test_jbb_embedding:begin_test:693 - Mary's kitchen.<|eot_id|>
2025-01-22 17:59:46.878 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8174])
2025-01-22 17:59:49.769 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [411.98065476190476, 32.03495895499572, 242.18541666666667, 30.66766790013512, 18.875234375], 'topk_indices': array([8157, 8168, 8164, 8062, 2842, 8102,   24,   14, 8162, 8161, 8170,
       8072,  896,  897,  895,  900, 8172, 8169,  899,    0]), 'topk_tokens': [':', ':', ' office', '.\n\n', ' kitchen', ' the', '\n\n', '\n', ' before', ' football', '<|start_header_id|>', ' location', ' Mary', ' grabbed', '.', '.', '<|end_header_id|>', '<|eot_id|>', ' football', '<|begin_of_text|>'], 'evidence_proportions': [1138.5, 321.875, 321.875, 47.01875]}, 'weight': {'score': [21.65438988095238, 23.279218769108475, 21.928645833333334, 23.285898538263112, 29.249791666666667], 'topk_indices': array([3322, 3295, 3215, 3167, 7377, 7415, 1490, 1428, 4281, 4297, 5118,
       5179, 7154, 7098, 3504, 3478, 4937, 4914, 4889, 4966]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.263671875, 20.708333333333332, 20.708333333333332, 18.6375]}, 'saliency': {'score': [2.6686197916666665, 0.17857344605104256, 1.3424112955729166, 0.17000588174681014, 0.13795654296875], 'topk_indices': array([8143, 8026, 8158,  257,   24, 8071, 8062, 8156, 8100, 8167, 1240,
       8028, 8164, 8162, 2842, 8072, 8161,  896,  897,  899]), 'topk_tokens': [' return', ' provided', ' Where', 'hue', '\n\n', ' first', '.\n\n', 'Question', ' moved', 'Answer', ' moved', ' context', ' office', ' before', ' kitchen', ' location', ' football', ' Mary', ' grabbed', ' football'], 'evidence_proportions': [8.576904296875, 1.7102864583333333, 1.7102864583333333, 0.2419921875]}}, 'pred_res': "Mary's kitchen.<|eot_id|>", 'score': 100}
2025-01-22 17:59:49.776 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 17:59:49.776 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-76_pid-3_1-3-4-7.pkl | len: 3 |  size: 2.03 KB
Processing depth (1, 3, 4, 7):   4%|â–         | 4/100 [03:03<1:16:24, 47.76s/it]is_0k: False
your chose emoji: ['ğŸ’˜', 'ğŸ–•ğŸ½', 'ğŸ™ğŸ¿', '\U0001faf1ğŸ¾', 'ğŸ‘¨ğŸ¿\u200dğŸš€', 'âš“', 'ğŸ™ğŸ½\u200dâ™€ï¸', 'ğŸ¦¹ğŸ¼', 'ğŸ§‘\u200dğŸ¦¯\u200dâ¡ï¸', 'ğŸ‘©ğŸ¼\u200dâ¤ï¸\u200dğŸ‘¨ğŸ»']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.46s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.97s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.79s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.28s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.83s/it]
Processing depth (0, 3, 7, 9):   4%|â–         | 4/100 [03:20<1:16:24, 47.76s/it]2025-01-22 18:00:06.904 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the football.
2025-01-22 18:00:06.946 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went back to the kitchen.
2025-01-22 18:00:06.961 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2890, 2896) --> . Mary went back to the
2025-01-22 18:00:06.961 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the office.
2025-01-22 18:00:06.976 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2890, 2896) --> . Mary went back to the
2025-01-22 18:00:06.976 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the hallway.
2025-01-22 18:00:07.012 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7121, 7126) -->  John went to the hallway
2025-01-22 18:00:07.012 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the bedroom.
2025-01-22 18:00:07.037 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5091, 5096) --> . John travelled to the
2025-01-22 18:00:07.037 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the garden.
2025-01-22 18:00:07.061 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4763, 4768) --> . Sandra moved to the
2025-01-22 18:00:07.061 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 18:00:07.068 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1251, 1256) -->  Republican. Daniel moved to
2025-01-22 18:00:07.068 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 18:00:07.068 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 18:00:07.068 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 18:00:07.068 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ‡²ğŸ‡·', 'ğŸ‡¦ğŸ‡²', 'ğŸ§›ğŸ¼\u200dâ™€', 'ğŸ‘©ğŸ¿\u200dğŸ­', 'ğŸƒğŸ¼\u200dâ¡ï¸', 'ğŸ‘®ğŸ»\u200dâ™‚ï¸', '\U0001fa87', 'ğŸ§˜ğŸ¿\u200dâ™€ï¸', 'âœ‰', 'â„ï¸']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  3.86s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:09,  4.52s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.72s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.34s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.76s/it]
Processing depth (3, 5, 7, 8):   4%|â–         | 4/100 [03:37<1:16:24, 47.76s/it]2025-01-22 18:00:24.012 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the football.
2025-01-22 18:00:24.026 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2818, 2822) -->  Mary grabbed the football
2025-01-22 18:00:24.026 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went back to the kitchen.
2025-01-22 18:00:24.047 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4114, 4120) --> . Mary went back to the
2025-01-22 18:00:24.047 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the office.
2025-01-22 18:00:24.068 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4114, 4120) --> . Mary went back to the
2025-01-22 18:00:24.068 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the hallway.
2025-01-22 18:00:24.101 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6588, 6593) --> . John went to the
2025-01-22 18:00:24.101 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the bedroom.
2025-01-22 18:00:24.127 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5309, 5314) --> . John travelled to the
2025-01-22 18:00:24.127 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the garden.
2025-01-22 18:00:24.152 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4903, 4908) --> . Sandra moved to the
2025-01-22 18:00:24.152 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 18:00:24.158 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1272, 1277) -->  Daniel moved to the office
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:00:24.997 | INFO     | test_jbb_embedding:begin_test:693 - Mary's garden.<|eot_id|>
2025-01-22 18:00:24.997 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8154])
2025-01-22 18:00:27.219 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [288.3794642857143, 24.68521285399044, 202.35416666666666, 23.675163157246644, 39.929507211538464], 'topk_indices': array([8082, 2820, 8144, 8148, 8142,   24, 8006, 8042, 2819, 8141, 8052,
       2822,   14, 4120, 8007, 8152, 8149, 8008, 2821,    0]), 'topk_tokens': [' the', ' the', ' office', ':', ' before', '\n\n', ' provided', '.\n\n', ' grabbed', ' football', ' location', '.', '\n', ' kitchen', ' you', '<|end_header_id|>', '<|eot_id|>', ' context', ' football', '<|begin_of_text|>'], 'evidence_proportions': [811.4375, 211.04166666666666, 211.04166666666666, 55.54375]}, 'weight': {'score': [21.65438988095238, 23.270226109476525, 21.6515625, 23.277394255633542, 29.604086538461537], 'topk_indices': array([3300, 3327, 3214, 3166, 7395, 7433, 1417, 1479, 4286, 4302, 5164,
       5103, 7098, 7154, 3509, 3483, 4957, 4874, 4899, 4928]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.263671875, 20.708333333333332, 20.708333333333332, 18.6375]}, 'saliency': {'score': [1.8524053664434523, 0.13845491099477442, 1.1354736328125, 0.132181269769348, 0.2975914588341346], 'topk_indices': array([4905, 2825, 1262, 8136, 8051, 8147, 1260, 2818, 8042, 2823, 8142,
       8144, 8007, 8006, 8052, 8141, 2819, 4120, 8008, 2821]), 'topk_tokens': [' moved', 'ï¿½', 'ï¿½', 'Question', ' first', 'Answer', 'ï¿½', ' Mary', '.\n\n', 'ï¿½', ' before', ' office', ' you', ' provided', ' location', ' football', ' grabbed', ' kitchen', ' context', ' football'], 'evidence_proportions': [6.017578125, 1.111328125, 1.111328125, 0.2988525390625]}}, 'pred_res': "Mary's garden.<|eot_id|>", 'score': 0}
2025-01-22 18:00:27.226 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:00:27.226 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-76_pid-4_3-5-7-8.pkl | len: 3 |  size: 2.03 KB
Processing depth (3, 5, 7, 8):   5%|â–Œ         | 5/100 [03:41<1:09:43, 44.04s/it]Processing depth (3, 5, 7, 8):   5%|â–Œ         | 5/100 [03:41<1:10:01, 44.23s/it]
2025-01-22 18:00:27.336 | INFO     | __main__:<module>:82 - Selected idx: 78
2025-01-22 18:00:27.336 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the milk before the hallway? 
2025-01-22 18:00:27.336 | INFO     | __main__:<module>:84 - Answer: office
2025-01-22 18:00:27.336 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 18:00:27.336 | INFO     | __main__:<module>:86 - Needle: [' Sandra moved to the garden.', ' Mary travelled to the office.', ' John took the milk.', ' Daniel moved to the office.', ' Mary moved to the garden.', ' Mary went back to the hallway.', ' John moved to the office.', ' Daniel took the milk there.', ' John went back to the hallway.', ' Daniel left the milk.']
2025-01-22 18:00:27.336 | INFO     | __main__:<module>:87 - Real Needle: [' John took the milk.', ' John moved to the office.', ' John went back to the hallway.', ' Daniel left the milk.']
2025-01-22 18:00:27.336 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ‡±ğŸ‡¦', 'ğŸ™…ğŸ¾\u200dâ™‚ï¸', 'ğŸ•Ÿ', 'ğŸ§œ\u200dâ™‚', 'ğŸ¤½ğŸ¼', 'ğŸ„ğŸ»\u200dâ™‚', 'ğŸŒ¤ï¸', 'ğŸ…', 'ğŸŒğŸ¿\u200dâ™‚', 'ğŸ¤µğŸ¼\u200dâ™€ï¸']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:10,  3.61s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.41s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.54s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.18s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.59s/it]
Processing depth (0, 2, 5, 8):   0%|          | 0/100 [00:16<?, ?it/s]2025-01-22 18:00:43.564 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John took the milk.
2025-01-22 18:00:43.604 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John moved to the office.
2025-01-22 18:00:43.613 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1628, 1633) --> . John moved to the
2025-01-22 18:00:43.613 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the hallway.
2025-01-22 18:00:43.634 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4130, 4136) --> . John went back to the
2025-01-22 18:00:43.634 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the milk.
2025-01-22 18:00:43.667 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6561, 6565) -->  Daniel left the milk
2025-01-22 18:00:43.667 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the garden.
2025-01-22 18:00:43.691 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4603, 4608) -->  Sandra moved to the garden
2025-01-22 18:00:43.691 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the office.
2025-01-22 18:00:43.698 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1297, 1302) -->  Mary travelled to the office
2025-01-22 18:00:43.698 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 18:00:43.706 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1629, 1634) -->  John moved to the office
2025-01-22 18:00:43.706 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the garden.
2025-01-22 18:00:43.729 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4604, 4609) -->  moved to the garden.
2025-01-22 18:00:43.729 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary went back to the hallway.
2025-01-22 18:00:43.751 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4131, 4137) -->  John went back to the hallway
2025-01-22 18:00:43.751 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel took the milk there.
2025-01-22 18:00:43.766 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (2572, 2577) --> . Daniel took the milk
2025-01-22 18:00:43.766 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 18:00:43.766 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 18:00:43.766 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 18:00:43.766 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ™‹ğŸ¾\u200dâ™‚ï¸', 'ğŸ‡²ğŸ‡¶', 'ğŸ§’', 'Â©ï¸', 'ğŸ‹ğŸ¼\u200dâ™‚', 'ğŸ‘¨ğŸ½\u200dğŸ¦¯', 'ğŸ§œ\u200dâ™€ï¸', 'ğŸ‘©\u200dğŸ‘©\u200dğŸ‘¦\u200dğŸ‘¦', 'ğŸ¤½ğŸ¾', 'ğŸŒ']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.48s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.62s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.56s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.18s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.69s/it]
Processing depth (1, 2, 3, 9):   0%|          | 0/100 [00:33<?, ?it/s]2025-01-22 18:01:00.547 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John took the milk.
2025-01-22 18:01:00.552 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (896, 900) -->  John took the milk
2025-01-22 18:01:00.552 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John moved to the office.
2025-01-22 18:01:00.563 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2009, 2014) -->  cable. John moved to
2025-01-22 18:01:00.563 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the hallway.
2025-01-22 18:01:00.580 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2991, 2997) -->  tragedy. John went back to
2025-01-22 18:01:00.580 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the milk.
2025-01-22 18:01:00.617 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7211, 7215) -->  Daniel left the milk
2025-01-22 18:01:00.618 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the garden.
2025-01-22 18:01:00.641 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4706, 4711) --> . Sandra moved to the
2025-01-22 18:01:00.641 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the office.
2025-01-22 18:01:00.648 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1506, 1511) --> . Mary travelled to the
2025-01-22 18:01:00.648 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 18:01:00.658 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2011, 2016) -->  John moved to the office
2025-01-22 18:01:00.658 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the garden.
2025-01-22 18:01:00.681 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4707, 4712) -->  Sandra moved to the garden
2025-01-22 18:01:00.681 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary went back to the hallway.
2025-01-22 18:01:00.696 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (2993, 2999) -->  John went back to the hallway
2025-01-22 18:01:00.696 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel took the milk there.
2025-01-22 18:01:00.710 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (2852, 2857) --> . Daniel took the milk
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:01:01.563 | INFO     | test_jbb_embedding:begin_test:693 - John took the milk.<|eot_id|>
2025-01-22 18:01:01.563 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8143])
2025-01-22 18:01:03.789 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [949.546052631579, 74.56764119091467, 578.4556451612904, 70.5843035824583, 39.763480392156865], 'topk_indices': array([8126,   14, 7212, 8133, 2857, 8128,  895,  897,   24, 2856, 8141,
       7214, 8131, 8130, 7215,  900, 8138,  899, 8139,    0]), 'topk_tokens': [':', '\n', ' left', ' hallway', ' there', ' was', '.', ' took', '\n\n', ' milk', '<|end_header_id|>', ' milk', ' before', ' milk', '.', '.', '<|eot_id|>', ' milk', '<|start_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [1873.5, 604.45, 337.1041666666667, 1375.625]}, 'weight': {'score': [24.879111842105264, 23.24308241252302, 23.153981854838708, 23.23958365503397, 29.287990196078432], 'topk_indices': array([3275, 3302, 3147, 3195, 7426, 7388, 1404, 1466, 4294, 4278, 5116,
       5177, 7160, 7104, 3502, 3476, 4912, 4935, 4964, 4887]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [25.212890625, 23.3078125, 24.91015625, 26.462890625]}, 'saliency': {'score': [6.0288342927631575, 0.4152909364928637, 3.570399130544355, 0.3900326686998147, 0.2924218271292892], 'topk_indices': array([8128, 1508, 4441, 8041, 2857, 7997,  896, 8125, 8127, 7212, 2853,
       2998,  897,  257, 2856, 8131, 7214, 8133, 8130,  899]), 'topk_tokens': [' was', ' travelled', ' hallway', ' location', ' there', ' context', ' John', 'Question', ' Where', ' left', ' Daniel', ' hallway', ' took', 'hue', ' milk', ' before', ' milk', ' hallway', ' milk', ' milk'], 'evidence_proportions': [12.45703125, 3.3037109375, 1.8248697916666667, 9.31298828125]}}, 'pred_res': 'John took the milk.<|eot_id|>', 'score': 0}
2025-01-22 18:01:03.795 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:01:03.796 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-78_pid-0_1-2-3-9.pkl | len: 3 |  size: 2.02 KB
Processing depth (1, 2, 3, 9):   1%|          | 1/100 [00:36<1:00:01, 36.37s/it]is_0k: False
your chose emoji: ['ğŸ‹ğŸ½', 'ğŸŒ©ï¸', 'ğŸ¤£', 'âš ', 'ğŸ›–', 'ğŸ‘®ğŸ»\u200dâ™‚', 'ğŸ™ï¸', 'ğŸ‡ºğŸ‡³', 'ğŸ‘°ğŸ¼\u200dâ™‚ï¸', 'ğŸ›¢']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.31s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.84s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.85s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.36s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.87s/it]
Processing depth (0, 3, 4, 5):   1%|          | 1/100 [00:53<1:00:01, 36.37s/it]2025-01-22 18:01:21.082 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John took the milk.
2025-01-22 18:01:21.128 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John moved to the office.
2025-01-22 18:01:21.143 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2844, 2849) --> . John moved to the
2025-01-22 18:01:21.143 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the hallway.
2025-01-22 18:01:21.161 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3572, 3578) --> . John went back to the
2025-01-22 18:01:21.161 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the milk.
2025-01-22 18:01:21.181 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4164, 4168) -->  Daniel left the milk
2025-01-22 18:01:21.181 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the garden.
2025-01-22 18:01:21.205 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4625, 4630) --> . Sandra moved to the
2025-01-22 18:01:21.205 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the office.
2025-01-22 18:01:21.212 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1154, 1159) --> . Mary travelled to the
2025-01-22 18:01:21.212 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 18:01:21.229 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2845, 2850) -->  John moved to the office
2025-01-22 18:01:21.229 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the garden.
2025-01-22 18:01:21.252 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4626, 4631) -->  Sandra moved to the garden
2025-01-22 18:01:21.252 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary went back to the hallway.
2025-01-22 18:01:21.269 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3573, 3579) -->  John went back to the hallway
2025-01-22 18:01:21.270 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel took the milk there.
2025-01-22 18:01:21.282 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (2546, 2551) --> . Daniel took the milk
2025-01-22 18:01:21.282 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 18:01:21.282 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 18:01:21.282 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 18:01:21.282 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ’¯', '2ï¸âƒ£', 'ğŸ‘¨ğŸ¼\u200dâ¤\u200dğŸ‘¨ğŸ¼', 'ğŸ‘¨ğŸ½\u200dğŸ”¬', 'ğŸ·', 'ğŸ‘±ğŸ¼\u200dâ™€ï¸', 'ğŸˆ', 'ğŸ›©', 'ğŸƒğŸ¿\u200dâ™€ï¸\u200dâ¡ï¸', '\U0001fab8']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.79s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.74s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.50s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.08s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.65s/it]
Processing depth (2, 5, 6, 8):   1%|          | 1/100 [01:10<1:00:01, 36.37s/it]2025-01-22 18:01:37.790 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John took the milk.
2025-01-22 18:01:37.799 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1822, 1826) -->  John took the milk
2025-01-22 18:01:37.799 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John moved to the office.
2025-01-22 18:01:37.820 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3806, 3811) -->  moved to the office.
2025-01-22 18:01:37.820 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the hallway.
2025-01-22 18:01:37.843 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4370, 4376) -->  went back to the hallway.
2025-01-22 18:01:37.843 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the milk.
2025-01-22 18:01:37.878 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6525, 6529) -->  Daniel left the milk
2025-01-22 18:01:37.878 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the garden.
2025-01-22 18:01:37.901 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4602, 4607) -->  Sandra moved to the garden
2025-01-22 18:01:37.901 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the office.
2025-01-22 18:01:37.908 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1413, 1418) --> . Mary travelled to the
2025-01-22 18:01:37.908 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 18:01:37.927 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3805, 3810) -->  Daniel moved to the office
2025-01-22 18:01:37.927 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the garden.
2025-01-22 18:01:37.949 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4603, 4608) -->  moved to the garden.
2025-01-22 18:01:37.950 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary went back to the hallway.
2025-01-22 18:01:37.971 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4369, 4375) -->  Mary went back to the hallway
2025-01-22 18:01:37.971 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel took the milk there.
2025-01-22 18:01:37.985 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (2722, 2727) --> . Daniel took the milk
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:01:38.760 | INFO     | test_jbb_embedding:begin_test:693 - the office<|eot_id|>
2025-01-22 18:01:38.760 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8189])
2025-01-22 18:01:40.995 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [1123.5526315789473, 83.26176596264193, 691.7258064516129, 78.51690517135486, 121.32041807432432], 'topk_indices': array([8170, 2726, 6506, 6525, 8179, 6524, 1825, 6505, 8180, 1826, 8175,
       8173, 8171, 8172, 8174, 8176, 8177,    0, 8184, 8185]), 'topk_tokens': ['.\n\n', ' milk', ' This', ' Daniel', ' hallway', '.', ' milk', '.', '?', '.', ' the', ' Where', 'Question', ':', ' was', ' milk', ' before', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [1346.75, 1030.6, 769.9166666666666, 1547.0]}, 'weight': {'score': [22.814144736842106, 23.274966426565744, 23.200352822580644, 23.27632604256234, 29.17377533783784], 'topk_indices': array([3298, 3325, 3214, 3166, 7474, 7436, 1441, 1503, 4329, 4345, 5245,
       5184, 7157, 7213, 3507, 3481, 4961, 4986, 5038, 5009]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [25.212890625, 19.034375, 21.932291666666668, 26.462890625]}, 'saliency': {'score': [6.9858655427631575, 0.45406692797353804, 4.311649445564516, 0.4241333532620378, 0.8757052034945101], 'topk_indices': array([8181, 2727, 6504, 3806, 6523, 8172, 4374, 6506, 6528, 8180, 8043,
       2726, 8174, 6525, 1825, 8179, 8173, 8171, 8177, 8176]), 'topk_tokens': [' \n', ' there', ' Gov', ' moved', ' Gov', ':', ' hallway', ' This', ' milk', '?', ' context', ' milk', ' was', ' Daniel', ' milk', ' hallway', ' Where', 'Question', ' before', ' milk'], 'evidence_proportions': [8.92529296875, 5.455078125, 4.426595052083333, 10.798828125]}}, 'pred_res': 'the office<|eot_id|>', 'score': 100}
2025-01-22 18:01:41.001 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:01:41.002 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-78_pid-1_2-5-6-8.pkl | len: 3 |  size: 1.98 KB
Processing depth (2, 5, 6, 8):   2%|â–         | 2/100 [01:13<1:00:12, 36.86s/it]is_0k: False
your chose emoji: ['ğŸ’š', 'ğŸ’ğŸ½\u200dâ™‚', 'ğŸ“‘', 'ğŸ‡¦ğŸ‡²', 'ğŸ‹ğŸ¾\u200dâ™€', 'ğŸ‘©ğŸ½\u200dâ¤\u200dğŸ’‹\u200dğŸ‘¨ğŸ½', 'â›´', 'ğŸ‘¨ğŸ¿\u200dğŸ¤\u200dğŸ‘¨ğŸ¼', '\U0001faf0', 'ğŸ¤¹ğŸ¼']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.86s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.19s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:15<00:04,  5.00s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  3.42s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  4.01s/it]
Processing depth (0, 6, 8, 9):   2%|â–         | 2/100 [01:31<1:00:12, 36.86s/it]2025-01-22 18:01:58.794 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John took the milk.
2025-01-22 18:01:58.833 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John moved to the office.
2025-01-22 18:01:58.853 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3798, 3803) -->  moved to the office.
2025-01-22 18:01:58.853 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the hallway.
2025-01-22 18:01:58.875 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4410, 4416) -->  went back to the hallway.
2025-01-22 18:01:58.875 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the milk.
2025-01-22 18:01:58.910 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7130, 7134) -->  left the milk.
2025-01-22 18:01:58.910 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the garden.
2025-01-22 18:01:58.933 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4679, 4684) --> . Sandra moved to the
2025-01-22 18:01:58.933 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the office.
2025-01-22 18:01:58.941 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1506, 1511) --> . Mary travelled to the
2025-01-22 18:01:58.941 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 18:01:58.960 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3797, 3802) -->  Daniel moved to the office
2025-01-22 18:01:58.960 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the garden.
2025-01-22 18:01:58.983 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4680, 4685) -->  Sandra moved to the garden
2025-01-22 18:01:58.983 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary went back to the hallway.
2025-01-22 18:01:59.006 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4409, 4415) -->  Mary went back to the hallway
2025-01-22 18:01:59.006 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel took the milk there.
2025-01-22 18:01:59.020 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (2788, 2793) --> . Daniel took the milk
2025-01-22 18:01:59.020 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 18:01:59.020 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 18:01:59.020 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 18:01:59.020 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸŒ¨', 'ğŸ‘©ğŸ»\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘©ğŸ»', 'ğŸ™‹ğŸ½', 'âŒ¨', 'ğŸˆ', 'ğŸ˜­', 'ğŸ‘©ğŸ»\u200dğŸš€', 'ğŸ‘®ğŸ½\u200dâ™€ï¸', 'ğŸ‡¬ğŸ‡¾', 'ğŸ—‘']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.32s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.62s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.54s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.19s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.68s/it]
Processing depth (0, 2, 7, 9):   2%|â–         | 2/100 [01:47<1:00:12, 36.86s/it]2025-01-22 18:02:15.456 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John took the milk.
2025-01-22 18:02:15.498 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John moved to the office.
2025-01-22 18:02:15.507 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1754, 1759) --> . John moved to the
2025-01-22 18:02:15.507 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the hallway.
2025-01-22 18:02:15.531 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4308, 4314) -->  went back to the hallway.
2025-01-22 18:02:15.531 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the milk.
2025-01-22 18:02:15.568 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7138, 7142) -->  left the milk.
2025-01-22 18:02:15.568 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the garden.
2025-01-22 18:02:15.595 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4555, 4560) --> . Sandra moved to the
2025-01-22 18:02:15.595 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the office.
2025-01-22 18:02:15.602 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1300, 1305) --> . Mary travelled to the
2025-01-22 18:02:15.602 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 18:02:15.611 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1755, 1760) -->  John moved to the office
2025-01-22 18:02:15.611 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the garden.
2025-01-22 18:02:15.634 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4556, 4561) -->  Sandra moved to the garden
2025-01-22 18:02:15.634 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary went back to the hallway.
2025-01-22 18:02:15.656 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4307, 4313) -->  Mary went back to the hallway
2025-01-22 18:02:15.656 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel took the milk there.
2025-01-22 18:02:15.671 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (2556, 2561) --> . Daniel took the milk
2025-01-22 18:02:15.672 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 18:02:15.672 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 18:02:15.672 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 18:02:15.672 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ§›', 'ğŸ‹ğŸ¾\u200dâ™€', 'ğŸ‘¨ğŸ¼\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘¨ğŸ¿', 'ğŸ•µ', 'ğŸ‘¨\u200dğŸ‘¨\u200dğŸ‘§\u200dğŸ‘§', 'ğŸ‘ƒğŸ¼', 'ğŸ¤¾', 'ğŸ¦Ÿ', 'ğŸ›¤', 'ğŸ“½']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.34s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.78s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.58s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.20s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.72s/it]
Processing depth (1, 3, 4, 6):   2%|â–         | 2/100 [02:04<1:00:12, 36.86s/it]2025-01-22 18:02:32.402 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John took the milk.
2025-01-22 18:02:32.407 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (768, 772) -->  John took the milk
2025-01-22 18:02:32.407 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John moved to the office.
2025-01-22 18:02:32.422 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2880, 2885) --> . John moved to the
2025-01-22 18:02:32.424 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the hallway.
2025-01-22 18:02:32.444 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3610, 3616) --> . John went back to the
2025-01-22 18:02:32.444 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the milk.
2025-01-22 18:02:32.471 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4753, 4757) -->  Daniel left the milk
2025-01-22 18:02:32.471 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the garden.
2025-01-22 18:02:32.494 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4607, 4612) -->  Sandra moved to the garden
2025-01-22 18:02:32.494 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the office.
2025-01-22 18:02:32.500 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1247, 1252) -->  Republican. Mary travelled to
2025-01-22 18:02:32.500 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 18:02:32.515 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2881, 2886) -->  John moved to the office
2025-01-22 18:02:32.515 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the garden.
2025-01-22 18:02:32.538 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4608, 4613) -->  moved to the garden.
2025-01-22 18:02:32.539 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary went back to the hallway.
2025-01-22 18:02:32.561 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3611, 3617) -->  John went back to the hallway
2025-01-22 18:02:32.561 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel took the milk there.
2025-01-22 18:02:32.574 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (2548, 2553) --> . Daniel took the milk
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:02:33.417 | INFO     | test_jbb_embedding:begin_test:693 - John took the milk.<|eot_id|>
2025-01-22 18:02:33.417 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8201])
2025-01-22 18:02:35.646 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [742.0131578947369, 70.09513287821528, 579.6572580645161, 66.59177603336195, 52.987841796875], 'topk_indices': array([8050, 8187,   24, 8055, 8099, 8089, 8192,    9, 2552, 8184, 8185,
       8186,  771,  772,   14, 8188, 8196, 8189,    0, 8197]), 'topk_tokens': ['\n', ' the', '\n\n', ' context', ' location', '.\n\n', '?', ':', ' milk', ':', ' Where', ' was', ' milk', '.', '\n', ' milk', '<|eot_id|>', ' before', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [1254.0, 758.5, 392.4583333333333, 733.75]}, 'weight': {'score': [22.185855263157894, 23.299894093624285, 23.692540322580644, 23.30099733227033, 30.009375], 'topk_indices': array([3276, 3303, 3148, 3196, 7486, 7448, 1438, 1500, 4326, 4342, 5161,
       5222, 7169, 7225, 3503, 3477, 4986, 4957, 4932, 5015]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [25.212890625, 18.88125, 20.0703125, 26.462890625]}, 'saliency': {'score': [4.273386101973684, 0.38721982906406194, 3.5756757182459675, 0.3660399821672237, 0.3930652618408203], 'topk_indices': array([4756, 8194, 8193,    8, 8089,  769, 2553, 8192, 8186, 2549, 3616,
       8099, 8183, 8055, 2552, 8191, 8185,  771, 8189, 8188]), 'topk_tokens': [' milk', 'Answer', ' \n', ' Date', '.\n\n', ' took', ' there', '?', ' was', ' Daniel', ' hallway', ' location', 'Question', ' context', ' milk', ' hallway', ' Where', ' milk', ' before', ' milk'], 'evidence_proportions': [8.18310546875, 3.565234375, 1.9122721354166667, 4.79052734375]}}, 'pred_res': 'John took the milk.<|eot_id|>', 'score': 0}
2025-01-22 18:02:35.653 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:02:35.653 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-78_pid-2_1-3-4-6.pkl | len: 3 |  size: 1.99 KB
Processing depth (1, 3, 4, 6):   3%|â–         | 3/100 [02:08<1:12:43, 44.99s/it]is_0k: False
your chose emoji: ['ğŸ‘¨ğŸ»\u200dâ¤\u200dğŸ’‹\u200dğŸ‘¨ğŸ»', 'ğŸƒğŸ¾\u200dâ™€ï¸\u200dâ¡', 'ğŸ§›ğŸ¼\u200dâ™€ï¸', 'ğŸ§šğŸ¿', 'ğŸŒ‚', 'ğŸ¤¶ğŸ»', 'ğŸ’‹', 'ğŸ§–ğŸ¾\u200dâ™‚ï¸', 'ğŸ’†ğŸ¿\u200dâ™‚', 'ğŸ•µ\u200dâ™‚']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  3.93s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:09,  4.53s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.68s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.27s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.71s/it]
Processing depth (0, 2, 4, 6):   3%|â–         | 3/100 [02:24<1:12:43, 44.99s/it]2025-01-22 18:02:52.153 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John took the milk.
2025-01-22 18:02:52.196 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John moved to the office.
2025-01-22 18:02:52.205 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1765, 1770) -->  John moved to the office
2025-01-22 18:02:52.206 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the hallway.
2025-01-22 18:02:52.225 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3570, 3576) --> . John went back to the
2025-01-22 18:02:52.225 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the milk.
2025-01-22 18:02:52.251 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4689, 4693) -->  Daniel left the milk
2025-01-22 18:02:52.251 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the garden.
2025-01-22 18:02:52.276 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4617, 4622) -->  Sandra moved to the garden
2025-01-22 18:02:52.276 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the office.
2025-01-22 18:02:52.284 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1304, 1309) --> . Mary travelled to the
2025-01-22 18:02:52.284 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 18:02:52.294 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1766, 1771) -->  moved to the office.
2025-01-22 18:02:52.294 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the garden.
2025-01-22 18:02:52.321 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4618, 4623) -->  moved to the garden.
2025-01-22 18:02:52.321 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary went back to the hallway.
2025-01-22 18:02:52.342 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3571, 3577) -->  John went back to the hallway
2025-01-22 18:02:52.342 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel took the milk there.
2025-01-22 18:02:52.357 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (2576, 2581) --> . Daniel took the milk
2025-01-22 18:02:52.358 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 18:02:52.358 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 18:02:52.358 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 18:02:52.358 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ§ğŸ¼\u200dâ™‚', 'ğŸ¤¹ğŸ»\u200dâ™‚', 'ğŸ´\u200dâ˜ ', 'ğŸ§‘ğŸ¿\u200dğŸ¦½', '\U0001faf7ğŸ¾', 'ğŸ‘¨\u200dğŸ¨', 'ğŸ§‘ğŸ»\u200dğŸ”¬', 'ğŸ‘¨ğŸ¿\u200dğŸ“', 'ğŸ‘¨ğŸ»\u200dğŸ¦½\u200dâ¡', '\U0001faf2ğŸ¾']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.40s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.32s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.24s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.96s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.45s/it]
Processing depth (0, 4, 6, 8):   3%|â–         | 3/100 [02:40<1:12:43, 44.99s/it]2025-01-22 18:03:07.865 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John took the milk.
2025-01-22 18:03:07.907 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John moved to the office.
2025-01-22 18:03:07.928 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3724, 3729) --> . John moved to the
2025-01-22 18:03:07.928 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the hallway.
2025-01-22 18:03:07.951 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4475, 4481) -->  Mary went back to the hallway
2025-01-22 18:03:07.951 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the milk.
2025-01-22 18:03:07.990 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6615, 6619) -->  Daniel left the milk
2025-01-22 18:03:07.991 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the garden.
2025-01-22 18:03:08.017 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4753, 4758) -->  the senate. Sandra moved
2025-01-22 18:03:08.017 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the office.
2025-01-22 18:03:08.025 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1506, 1511) --> . Mary travelled to the
2025-01-22 18:03:08.026 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 18:03:08.048 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3725, 3730) -->  John moved to the office
2025-01-22 18:03:08.048 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the garden.
2025-01-22 18:03:08.072 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4756, 4761) -->  Sandra moved to the garden
2025-01-22 18:03:08.072 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary went back to the hallway.
2025-01-22 18:03:08.095 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4474, 4480) --> . Mary went back to the
2025-01-22 18:03:08.095 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel took the milk there.
2025-01-22 18:03:08.112 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (2800, 2805) --> . Daniel took the milk
2025-01-22 18:03:08.112 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 18:03:08.113 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 18:03:08.113 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 18:03:08.113 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ’', 'â†—ï¸', 'ğŸ¤¦\u200dâ™€ï¸', 'ğŸ¤¸', 'ğŸ¤¾ğŸ¿\u200dâ™‚', 'ğŸ§ğŸ¿\u200dâ™€', 'ğŸ¤™ğŸ¾', 'ğŸ§ğŸ¾\u200dâ™€', 'ğŸ§‘ğŸ»\u200dğŸ¦¯\u200dâ¡ï¸', 'ğŸ”„']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.41s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.68s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.91s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.46s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.92s/it]
Processing depth (3, 5, 6, 9):   3%|â–         | 3/100 [02:58<1:12:43, 44.99s/it]2025-01-22 18:03:25.615 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John took the milk.
2025-01-22 18:03:25.629 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2878, 2882) -->  John took the milk
2025-01-22 18:03:25.630 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John moved to the office.
2025-01-22 18:03:25.649 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3763, 3768) -->  Daniel moved to the office
2025-01-22 18:03:25.649 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the hallway.
2025-01-22 18:03:25.673 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4325, 4331) -->  Mary went back to the hallway
2025-01-22 18:03:25.673 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the milk.
2025-01-22 18:03:25.712 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7213, 7217) -->  Daniel left the milk
2025-01-22 18:03:25.712 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the garden.
2025-01-22 18:03:25.735 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4560, 4565) -->  Sandra moved to the garden
2025-01-22 18:03:25.735 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the office.
2025-01-22 18:03:25.742 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1395, 1400) --> . Mary travelled to the
2025-01-22 18:03:25.742 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 18:03:25.760 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3762, 3767) --> . Daniel moved to the
2025-01-22 18:03:25.760 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the garden.
2025-01-22 18:03:25.786 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4561, 4566) -->  moved to the garden.
2025-01-22 18:03:25.787 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary went back to the hallway.
2025-01-22 18:03:25.810 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4324, 4330) --> . Mary went back to the
2025-01-22 18:03:25.810 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel took the milk there.
2025-01-22 18:03:25.822 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (2546, 2551) -->  Daniel took the milk there
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:03:26.579 | INFO     | test_jbb_embedding:begin_test:693 - the office<|eot_id|>
2025-01-22 18:03:26.579 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8169])
2025-01-22 18:03:28.801 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [162.11513157894737, 17.582314741157752, 135.47177419354838, 16.794148657800765, 19.0653076171875], 'topk_indices': array([   9, 3092, 8150, 8023, 8162, 8154,   23, 8057,    1,    3, 8163,
         24, 8168, 8156, 8157, 8167,   14, 8165,    0, 8164]), 'topk_tokens': [':', 'ern', '.\n\n', ' context', 'Answer', ' was', '4', '.\n\n', '<|start_header_id|>', '<|end_header_id|>', ':', '\n\n', '\n\n', ' milk', ' before', '<|end_header_id|>', '\n', '<|start_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [104.75, 216.575, 153.19791666666666, 164.78125]}, 'weight': {'score': [25.31825657894737, 23.266097325908703, 22.060987903225808, 23.26589628740303, 29.529296875], 'topk_indices': array([3284, 3311, 3192, 3144, 7448, 7410, 1423, 1485, 4297, 4313, 5142,
       5203, 7106, 7162, 3467, 3493, 4996, 4944, 4919, 4967]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [25.212890625, 23.9234375, 25.787760416666668, 26.462890625]}, 'saliency': {'score': [1.043958162006579, 0.09594117032607698, 0.7783242502520161, 0.0911183408322174, 0.14243578910827637], 'topk_indices': array([  20,   14, 8161, 3091,   23, 8154, 4330, 8166, 8067, 8057,   24,
       8168, 8153, 3092, 8151, 8023, 8162, 8159, 8157, 8156]), 'topk_tokens': [' Jul', '\n', ' \n', ' const', '4', ' was', ' hallway', 'assistant', ' location', '.\n\n', '\n\n', '\n\n', ' Where', 'ern', 'Question', ' context', 'Answer', ' hallway', ' before', ' milk'], 'evidence_proportions': [0.67864990234375, 1.2943359375, 1.0384521484375, 1.10455322265625]}}, 'pred_res': 'the office<|eot_id|>', 'score': 100}
2025-01-22 18:03:28.806 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:03:28.807 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-78_pid-3_3-5-6-9.pkl | len: 3 |  size: 2.0 KB
Processing depth (3, 5, 6, 9):   4%|â–         | 4/100 [03:01<1:17:08, 48.21s/it]is_0k: False
your chose emoji: ['ğŸ™ğŸ»\u200dâ™€ï¸', 'ğŸ›µ', 'âœŒğŸ½', 'âš”ï¸', 'ğŸª¡', 'ğŸ¤½ğŸ¾\u200dâ™‚', 'ğŸ§”ğŸ¿', 'ğŸ§›ğŸ½\u200dâ™‚ï¸', 'ğŸ‘ŒğŸ¾', 'ğŸ•µğŸ»\u200dâ™‚']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.15s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.72s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.89s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.37s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.85s/it]
Processing depth (2, 3, 6, 8):   4%|â–         | 4/100 [03:18<1:17:08, 48.21s/it]2025-01-22 18:03:45.949 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John took the milk.
2025-01-22 18:03:45.960 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1738, 1742) -->  John took the milk
2025-01-22 18:03:45.960 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John moved to the office.
2025-01-22 18:03:45.975 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2882, 2887) --> . John moved to the
2025-01-22 18:03:45.975 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the hallway.
2025-01-22 18:03:46.011 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4319, 4325) -->  Mary went back to the hallway
2025-01-22 18:03:46.011 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the milk.
2025-01-22 18:03:46.055 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6621, 6625) -->  Daniel left the milk
2025-01-22 18:03:46.056 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the garden.
2025-01-22 18:03:46.080 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4578, 4583) -->  Sandra moved to the garden
2025-01-22 18:03:46.080 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the office.
2025-01-22 18:03:46.088 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1269, 1274) --> . Mary travelled to the
2025-01-22 18:03:46.088 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 18:03:46.104 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2883, 2888) -->  John moved to the office
2025-01-22 18:03:46.104 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the garden.
2025-01-22 18:03:46.127 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4579, 4584) -->  moved to the garden.
2025-01-22 18:03:46.127 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary went back to the hallway.
2025-01-22 18:03:46.149 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4318, 4324) --> . Mary went back to the
2025-01-22 18:03:46.149 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel took the milk there.
2025-01-22 18:03:46.164 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (2550, 2555) --> . Daniel took the milk
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:03:46.928 | INFO     | test_jbb_embedding:begin_test:693 - the office<|eot_id|>
2025-01-22 18:03:46.928 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8177])
2025-01-22 18:03:49.144 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [567.7434210526316, 43.3271717202592, 334.46774193548384, 40.991181264608194, 35.10116038602941], 'topk_indices': array([6625, 8170,    1, 8065, 8171, 8169, 8158,   14, 8167, 8159, 8168,
       8163, 8160, 8161, 8162,    0, 8164, 8165, 8173, 8172]), 'topk_tokens': ['.', 'Answer', '<|start_header_id|>', '.\n\n', ':', ' \n', '.\n\n', '\n', ' hallway', 'Question', '?', ' the', ':', ' Where', ' was', '<|begin_of_text|>', ' milk', ' before', '<|start_header_id|>', '<|eot_id|>'], 'evidence_proportions': [645.9375, 357.275, 424.5, 967.5]}, 'weight': {'score': [23.99136513157895, 23.266031910991565, 22.05141129032258, 23.26896854625415, 29.156939338235293], 'topk_indices': array([3305, 3278, 3150, 3198, 7402, 7440, 1497, 1435, 4330, 4346, 5221,
       5160, 7111, 7167, 3503, 3477, 4962, 4937, 5014, 4985]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [25.212890625, 18.88125, 25.787760416666668, 26.462890625]}, 'saliency': {'score': [3.6392629523026314, 0.23201015820813975, 1.9234107232862903, 0.21759618101473122, 0.2581338321461397], 'topk_indices': array([8065, 2555, 8163, 8158, 2554, 8031, 4324,   27, 1741, 8169, 8160,
       6624, 8170, 8168, 8162, 8159, 8161, 8167, 8165, 8164]), 'topk_tokens': ['.\n\n', ' there', ' the', '.\n\n', ' milk', ' context', ' hallway', 'user', ' milk', ' \n', ':', ' milk', 'Answer', '?', ' was', 'Question', ' Where', ' hallway', ' before', ' milk'], 'evidence_proportions': [4.28759765625, 1.69072265625, 2.99169921875, 6.39794921875]}}, 'pred_res': 'the office<|eot_id|>', 'score': 100}
2025-01-22 18:03:49.150 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:03:49.150 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-78_pid-4_2-3-6-8.pkl | len: 3 |  size: 1.98 KB
Processing depth (2, 3, 6, 8):   5%|â–Œ         | 5/100 [03:21<1:00:25, 38.16s/it]Processing depth (2, 3, 6, 8):   5%|â–Œ         | 5/100 [03:21<1:03:54, 40.36s/it]
2025-01-22 18:03:49.231 | INFO     | __main__:<module>:82 - Selected idx: 80
2025-01-22 18:03:49.231 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the apple before the hallway? 
2025-01-22 18:03:49.231 | INFO     | __main__:<module>:84 - Answer: office
2025-01-22 18:03:49.231 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 18:03:49.231 | INFO     | __main__:<module>:86 - Needle: [' John journeyed to the bedroom.', ' John went back to the garden.', ' Sandra picked up the apple.', ' Mary journeyed to the kitchen.', ' Mary travelled to the bathroom.', ' Sandra journeyed to the office.', ' John journeyed to the hallway.', ' Sandra went back to the hallway.', ' John went to the office.']
2025-01-22 18:03:49.231 | INFO     | __main__:<module>:87 - Real Needle: [' Sandra picked up the apple.', ' Sandra journeyed to the office.', ' Sandra went back to the hallway.', ' John went to the office.']
2025-01-22 18:03:49.231 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['â™', 'â›¹ğŸ½\u200dâ™€', 'â›¹ğŸ¼\u200dâ™‚ï¸', 'â˜¢', 'ğŸ§‘', 'ğŸ‘©ğŸ¾\u200dğŸ«', 'ğŸ‘¨ğŸ½\u200dğŸ¦³', 'ğŸ‘ğŸ¾', 'ğŸ‘¨ğŸ¿\u200dğŸ¦¯', 'ğŸ¦\u200dâ¬›']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.57s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.86s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.65s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.21s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.76s/it]
Processing depth (2, 3, 6, 7):   0%|          | 0/100 [00:16<?, ?it/s]2025-01-22 18:04:05.975 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra picked up the apple.
2025-01-22 18:04:05.986 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1780, 1785) --> . Sandra picked up the
2025-01-22 18:04:05.986 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra journeyed to the office.
2025-01-22 18:04:06.009 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2830, 2836) --> . Sandra journeyed to the
2025-01-22 18:04:06.010 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the hallway.
2025-01-22 18:04:06.033 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4710, 4716) --> . Sandra went back to the
2025-01-22 18:04:06.034 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 18:04:06.063 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5611, 5616) --> . John went to the
2025-01-22 18:04:06.064 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John journeyed to the bedroom.
2025-01-22 18:04:06.091 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4103, 4109) --> . John journeyed to the
2025-01-22 18:04:06.091 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the garden.
2025-01-22 18:04:06.126 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6986, 6992) --> . John went back to the
2025-01-22 18:04:06.126 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the kitchen.
2025-01-22 18:04:06.132 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1045, 1051) --> . Mary journeyed to the
2025-01-22 18:04:06.132 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary travelled to the bathroom.
2025-01-22 18:04:06.144 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1881, 1886) -->  Mary travelled to the bathroom
2025-01-22 18:04:06.144 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John journeyed to the hallway.
2025-01-22 18:04:06.167 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4103, 4109) --> . John journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:04:06.990 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 18:04:06.990 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8157])
2025-01-22 18:04:09.203 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [392.86079545454544, 58.27517541978184, 344.2198275862069, 56.34457865688209, 57.326980064655174], 'topk_indices': array([8151, 1047, 1051,   14, 8139, 8083, 1785, 1786, 1781, 8155, 8142,
       8143, 8140, 8145, 8144, 8084, 8085,    0, 8153, 8152]), 'topk_tokens': [':', ' journey', ' kitchen', '\n', 'Question', ' moved', ' apple', '.', ' Sandra', '<|end_header_id|>', ' was', ' the', ':', ' before', ' apple', ' to', ' the', '<|begin_of_text|>', '<|start_header_id|>', '<|eot_id|>'], 'evidence_proportions': [851.3, 429.875, 251.27083333333334, 59.9125]}, 'weight': {'score': [21.32528409090909, 23.251298412795684, 20.894127155172413, 23.26495532961273, 29.017510775862068], 'topk_indices': array([3316, 3289, 3161, 3209, 7410, 7448, 1416, 1478, 4313, 4297, 5143,
       5204, 7187, 7131, 3472, 3498, 4969, 4940, 4917, 4892]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [23.49375, 21.213541666666668, 21.869791666666668, 18.6375]}, 'saliency': {'score': [2.440024636008523, 0.32109588050772153, 1.9933492726293103, 0.30936527111051587, 0.41552444984172954], 'topk_indices': array([8011, 1782, 8049, 1885, 8084, 8150, 8075, 8055, 8142, 1053, 8141,
       8147, 8083, 1047, 1051, 8139, 1785, 8145, 1781, 8144]), 'topk_tokens': [' context', ' picked', ' obtained', ' bathroom', ' to', 'Answer', ' left', ' location', ' was', 'ï¿½', ' Where', ' hallway', ' moved', ' journey', ' kitchen', 'Question', ' apple', ' before', ' Sandra', ' apple'], 'evidence_proportions': [5.7857421875, 2.4845377604166665, 1.4134114583333333, 0.2728271484375]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 0}
2025-01-22 18:04:09.209 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:04:09.210 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-80_pid-0_2-3-6-7.pkl | len: 3 |  size: 2.03 KB
Processing depth (2, 3, 6, 7):   1%|          | 1/100 [00:19<32:47, 19.87s/it]is_0k: False
your chose emoji: ['ğŸ‘­ğŸ»', 'ğŸ§‘ğŸ¿\u200dğŸ¦¼\u200dâ¡ï¸', 'ğŸ¤°ğŸ¿', 'â˜®', 'ğŸ—‘', 'ğŸ‡¦ğŸ‡¼', 'ğŸ‘¨ğŸ½\u200dâš–ï¸', 'ğŸ³', 'ğŸ§˜\u200dâ™€', 'ğŸš‘']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:05<00:15,  5.12s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.17s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.63s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.15s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.80s/it]
Processing depth (0, 1, 3, 4):   1%|          | 1/100 [00:36<32:47, 19.87s/it]2025-01-22 18:04:26.194 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra picked up the apple.
2025-01-22 18:04:26.195 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (32, 37) -->  picked up the apple.
2025-01-22 18:04:26.195 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra journeyed to the office.
2025-01-22 18:04:26.199 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (902, 908) --> . Sandra journeyed to the
2025-01-22 18:04:26.200 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the hallway.
2025-01-22 18:04:26.216 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2931, 2937) --> . Sandra went back to the
2025-01-22 18:04:26.216 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 18:04:26.235 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3620, 3625) --> . John went to the
2025-01-22 18:04:26.235 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John journeyed to the bedroom.
2025-01-22 18:04:26.255 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4084, 4090) --> . John journeyed to the
2025-01-22 18:04:26.256 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the garden.
2025-01-22 18:04:26.291 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6972, 6978) --> . John went back to the
2025-01-22 18:04:26.291 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the kitchen.
2025-01-22 18:04:26.297 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1109, 1115) --> . Mary journeyed to the
2025-01-22 18:04:26.297 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary travelled to the bathroom.
2025-01-22 18:04:26.307 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2032, 2037) -->  cable. Mary travelled to
2025-01-22 18:04:26.307 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John journeyed to the hallway.
2025-01-22 18:04:26.328 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4084, 4090) --> . John journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:04:27.139 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 18:04:27.139 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8151])
2025-01-22 18:04:29.358 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [497.73295454545456, 47.02866659511836, 118.62068965517241, 45.54857982596889, 50.31299715909091], 'topk_indices': array([  66,   74, 7259, 8005,   14,  186,   40,   65,   36,  107,   67,
         68,   24,   75,  112, 7337,  106,  113, 8146,    0]), 'topk_tokens': [' OF', '.', 'nes', ' context', '\n', 'ION', '\n\n\n', 'ENCES', '.', 'E', ' P', 'ION', '\n\n', ' PA', '.', 'nes', 'ION', ' PA', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [816.9, 710.75, 194.29166666666666, 287.075]}, 'weight': {'score': [21.004261363636363, 23.250291303814546, 20.67645474137931, 23.265602821834115, 29.30653409090909], 'topk_indices': array([3290, 3317, 3144, 3192, 7384, 7422, 1495, 1433, 4318, 4302, 5113,
       5174, 7105, 7161, 3487, 3513, 4890, 4967, 4938, 4915]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.08125, 21.213541666666668, 21.869791666666668, 18.6375]}, 'saliency': {'score': [2.6583806818181817, 0.2676566404812646, 0.6301732556573276, 0.2598673402159575, 0.34839449795809657], 'topk_indices': array([ 908, 8141,   39,   67, 7288,  903,  904,   32,   42,  186, 7336,
       7259,   40,   68, 8005,   65,   75,  106, 7337,  113]), 'topk_tokens': [' office', ' hallway', '***', ' P', 'nes', ' Sandra', ' journey', ' picked', '-text', 'ION', ' Min', 'nes', '\n\n\n', 'ION', ' context', 'ENCES', ' PA', 'ION', 'nes', ' PA'], 'evidence_proportions': [4.3154296875, 3.87939453125, 1.1368408203125, 1.361962890625]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 0}
2025-01-22 18:04:29.372 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:04:29.372 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-80_pid-1_0-1-3-4.pkl | len: 3 |  size: 1.93 KB
Processing depth (0, 1, 3, 4):   2%|â–         | 2/100 [00:40<32:44, 20.04s/it]is_0k: False
your chose emoji: ['ğŸ', 'Â©', 'ğŸš´ğŸ¾\u200dâ™‚ï¸', 'ğŸ¤¸ğŸ¼\u200dâ™‚ï¸', 'ğŸ’‡ğŸ½\u200dâ™‚ï¸', 'ğŸ±', '\U0001faf8ğŸ½', 'ğŸ‘¨\u200dğŸ¦¼', 'ğŸµ', 'ğŸ§˜']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.56s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.75s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.79s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.33s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.84s/it]
Processing depth (0, 1, 2, 9):   2%|â–         | 2/100 [00:57<32:44, 20.04s/it]2025-01-22 18:04:46.473 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra picked up the apple.
2025-01-22 18:04:46.474 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (32, 37) -->  picked up the apple.
2025-01-22 18:04:46.474 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra journeyed to the office.
2025-01-22 18:04:46.478 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (776, 782) --> . Sandra journeyed to the
2025-01-22 18:04:46.478 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the hallway.
2025-01-22 18:04:46.487 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1752, 1758) --> . Sandra went back to the
2025-01-22 18:04:46.487 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 18:04:46.524 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7216, 7221) --> . John went to the
2025-01-22 18:04:46.524 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John journeyed to the bedroom.
2025-01-22 18:04:46.547 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4085, 4091) --> . John journeyed to the
2025-01-22 18:04:46.547 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the garden.
2025-01-22 18:04:46.588 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (7020, 7026) -->  John went back to the garden
2025-01-22 18:04:46.588 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the kitchen.
2025-01-22 18:04:46.593 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (991, 997) --> . Mary journeyed to the
2025-01-22 18:04:46.593 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary travelled to the bathroom.
2025-01-22 18:04:46.603 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1834, 1839) -->  Mary travelled to the bathroom
2025-01-22 18:04:46.603 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John journeyed to the hallway.
2025-01-22 18:04:46.626 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4085, 4091) --> . John journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:04:47.404 | INFO     | test_jbb_embedding:begin_test:693 - The office.<|eot_id|>
2025-01-22 18:04:47.405 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8174])
2025-01-22 18:04:49.640 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [428.49857954545456, 38.43285607265166, 113.875, 37.10740769230769, 31.940666429924242], 'topk_indices': array([ 113,   66,  778, 8164,   40, 8162,   36, 8028,    1,  106,   65,
         24, 4378,   67,  782,   14,  552, 8170, 8169,    0]), 'topk_tokens': [' PA', ' OF', ' journey', ' hallway', '\n\n\n', ' before', '.', ' context', '<|start_header_id|>', 'ION', 'ENCES', '\n\n', 'ot', ' P', ' office', '\n', ',', '<|start_header_id|>', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [670.65, 754.625, 229.25, 34.09375]}, 'weight': {'score': [21.004261363636363, 23.268592909124266, 21.67241379310345, 23.280421153846152, 29.442708333333332], 'topk_indices': array([3317, 3344, 3237, 3189, 7395, 7433, 1500, 1438, 4319, 4303, 5126,
       5187, 7166, 7110, 3500, 3526, 4891, 4968, 4916, 4939]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.08125, 21.213541666666668, 21.869791666666668, 18.6375]}, 'saliency': {'score': [2.349404074928977, 0.21675756346222938, 0.6313350282866379, 0.20950329026442308, 0.2366081006599195], 'topk_indices': array([  43,   75,   31,   68, 4377,   39,   67,   37,   42, 8162, 4378,
        106,   40,  113, 8028,  777,  778,   65,  782, 8164]), 'topk_tokens': [' prepared', ' PA', 'andra', 'ION', 'nes', '***', ' P', ' PA', '-text', ' before', 'ot', 'ION', '\n\n\n', ' PA', ' context', ' Sandra', ' journey', 'ENCES', ' office', ' hallway'], 'evidence_proportions': [3.4990234375, 4.34423828125, 1.227294921875, 0.1525146484375]}}, 'pred_res': 'The office.<|eot_id|>', 'score': 100}
2025-01-22 18:04:49.646 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:04:49.647 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-80_pid-2_0-1-2-9.pkl | len: 3 |  size: 1.99 KB
Processing depth (0, 1, 2, 9):   3%|â–         | 3/100 [01:00<32:34, 20.15s/it]is_0k: False
your chose emoji: ['ğŸš¶\u200dâ¡', 'ğŸ‘±ğŸ½\u200dâ™€', 'ğŸ›ŒğŸ¿', 'ğŸ‡¦ğŸ‡¹', '\U0001faf7ğŸ¾', 'ğŸ§–', 'ğŸ™‹ğŸ½\u200dâ™€ï¸', 'ğŸ––ğŸ¿', 'ğŸ¤¹\u200dâ™‚', 'ğŸ‘©ğŸ½\u200dâœˆï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.40s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.43s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.50s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.13s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.61s/it]
Processing depth (2, 5, 6, 8):   3%|â–         | 3/100 [01:16<32:34, 20.15s/it]2025-01-22 18:05:05.926 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra picked up the apple.
2025-01-22 18:05:05.935 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1802, 1807) --> . Sandra picked up the
2025-01-22 18:05:05.935 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra journeyed to the office.
2025-01-22 18:05:05.956 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4161, 4167) --> . Sandra journeyed to the
2025-01-22 18:05:05.957 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the hallway.
2025-01-22 18:05:05.984 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4664, 4670) --> . Sandra went back to the
2025-01-22 18:05:05.985 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 18:05:06.018 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6546, 6551) -->  John went to the office
2025-01-22 18:05:06.018 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John journeyed to the bedroom.
2025-01-22 18:05:06.038 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4074, 4080) --> . John journeyed to the
2025-01-22 18:05:06.038 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the garden.
2025-01-22 18:05:06.076 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (7016, 7022) --> . John went back to the
2025-01-22 18:05:06.076 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the kitchen.
2025-01-22 18:05:06.082 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (991, 997) --> . Mary journeyed to the
2025-01-22 18:05:06.083 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary travelled to the bathroom.
2025-01-22 18:05:06.094 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2043, 2048) -->  cable. Mary travelled to
2025-01-22 18:05:06.094 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John journeyed to the hallway.
2025-01-22 18:05:06.118 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4074, 4080) --> . John journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:05:06.906 | INFO     | test_jbb_embedding:begin_test:693 - kitchen<|eot_id|>
2025-01-22 18:05:06.906 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8195])
2025-01-22 18:05:09.188 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [401.17329545454544, 44.98160150054898, 304.39008620689657, 43.09612846795974, 30.47661323051948], 'topk_indices': array([  28,  998, 8049,  994,   24,  993, 3148, 1698,   14,  997, 1803,
       1807, 1619, 8183, 8190, 8185, 1620, 1699, 1621,    0]), 'topk_tokens': ['<|end_header_id|>', '.', ' context', 'ed', '\n\n', ' journey', 'ern', ' for', '\n', ' kitchen', ' Sandra', ' apple', ' for', ' before', '<|eot_id|>', ' hallway', ' some', ' some', ' time', '<|begin_of_text|>'], 'evidence_proportions': [654.8, 555.1666666666666, 312.8541666666667, 68.7375]}, 'weight': {'score': [22.237571022727273, 23.2910992588752, 20.67645474137931, 23.30325274674687, 29.709821428571427], 'topk_indices': array([3328, 3355, 3200, 3248, 7448, 7486, 1500, 1438, 4333, 4349, 5169,
       5230, 7149, 7205, 3537, 3511, 4994, 4971, 5023, 4946]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [23.49375, 21.213541666666668, 21.869791666666668, 22.6515625]}, 'saliency': {'score': [2.461581143465909, 0.2538457286202269, 1.615716342268319, 0.24303497157107398, 0.226881151075487], 'topk_indices': array([1804, 6935, 2049, 8179, 1679, 4167, 8182, 8049, 3148, 4670, 4162,
        993, 8183,  997, 1807, 1803, 1620, 1699, 8185, 1621]), 'topk_tokens': [' picked', ' hallway', ' bathroom', ' Where', 'Min', ' office', ' apple', ' context', 'ern', ' hallway', ' Sandra', ' journey', ' before', ' kitchen', ' apple', ' Sandra', ' some', ' some', ' hallway', ' time'], 'evidence_proportions': [4.4375, 3.2716471354166665, 1.7103678385416667, 0.4150390625]}}, 'pred_res': 'kitchen<|eot_id|>', 'score': 0}
2025-01-22 18:05:09.195 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:05:09.196 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-80_pid-3_2-5-6-8.pkl | len: 3 |  size: 2.02 KB
Processing depth (2, 5, 6, 8):   4%|â–         | 4/100 [01:19<31:51, 19.91s/it]is_0k: False
your chose emoji: ['ğŸ™‡\u200dâ™‚ï¸', 'â˜¯', 'ğŸ§‘ğŸ»\u200dâ¤\u200dğŸ’‹\u200dğŸ§‘ğŸ¼', 'ğŸ„ğŸ¿\u200dâ™€ï¸', 'ğŸ¤ğŸ»', 'ğŸ¤¹ğŸ½\u200dâ™‚ï¸', 'ğŸ‘©ğŸ¿\u200dğŸ¦³', 'ğŸƒğŸ¾', 'ğŸ‡²ğŸ‡½', 'ğŸ—']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.32s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.70s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.43s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.87s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.47s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 1, 2, 8):   4%|â–         | 4/100 [01:36<31:51, 19.91s/it]2025-01-22 18:05:25.517 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra picked up the apple.
2025-01-22 18:05:25.518 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (32, 37) -->  picked up the apple.
2025-01-22 18:05:25.518 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra journeyed to the office.
2025-01-22 18:05:25.522 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (780, 786) --> . Sandra journeyed to the
2025-01-22 18:05:25.522 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the hallway.
2025-01-22 18:05:25.531 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1806, 1812) --> . Sandra went back to the
2025-01-22 18:05:25.531 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 18:05:25.567 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6602, 6607) --> . John went to the
2025-01-22 18:05:25.567 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John journeyed to the bedroom.
2025-01-22 18:05:25.596 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4000, 4006) -->  to the ground. John journey
2025-01-22 18:05:25.596 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the garden.
2025-01-22 18:05:25.633 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6979, 6985) --> . John went back to the
2025-01-22 18:05:25.634 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the kitchen.
2025-01-22 18:05:25.640 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (995, 1001) --> . Mary journeyed to the
2025-01-22 18:05:25.640 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary travelled to the bathroom.
2025-01-22 18:05:25.651 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1911, 1916) --> . Mary travelled to the
2025-01-22 18:05:25.651 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John journeyed to the hallway.
2025-01-22 18:05:25.674 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4000, 4006) -->  to the ground. John journey
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:05:32.220 | INFO     | test_jbb_embedding:begin_test:693 - Sandra picked up the apple.<|eot_id|>
2025-01-22 18:05:32.220 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8158])
2025-01-22 18:05:35.020 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [368.2755681818182, 31.90334329044118, 64.29310344827586, 30.874919071402147, 33.76235856681034], 'topk_indices': array([  39,   23,   40,    1,   14,   29,   67, 8154,   36,   24,  106,
        188,  173,   68,  191,  172,   69, 8153,  192,    0]), 'topk_tokens': ['***', '4', '\n\n\n', '<|start_header_id|>', '\n', '\n\n', ' P', '<|start_header_id|>', '.', '\n\n', 'ION', 'G', 'E', 'ION', ' P', 'ION', 'E', '<|eot_id|>', 'ION', '<|begin_of_text|>'], 'evidence_proportions': [726.7, 486.9166666666667, 173.13541666666666, 101.65]}, 'weight': {'score': [21.004261363636363, 23.25638595281863, 20.646012931034484, 23.27183145270687, 29.435614224137932], 'topk_indices': array([3339, 3366, 3259, 3211, 7435, 7397, 1504, 1442, 4331, 4347, 5203,
       5142, 7112, 7168, 3548, 3522, 4996, 4967, 4944, 4919]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.08125, 21.213541666666668, 21.869791666666668, 18.6375]}, 'saliency': {'score': [2.044821999289773, 0.18055219463273592, 0.3416516534213362, 0.1749182299012864, 0.2542372078731142], 'topk_indices': array([  67,  187,   31,   43,   42,  786,   37,   40, 8148,  781,  173,
         32,  188,   39,  106,  191,   69,   68,  172,  192]), 'topk_tokens': [' P', 'UG', 'andra', ' prepared', '-text', ' office', ' PA', '\n\n\n', ' hallway', ' Sandra', 'E', ' picked', 'G', '***', 'ION', ' P', 'E', 'ION', 'ION', 'ION'], 'evidence_proportions': [3.842578125, 2.9099934895833335, 0.9656575520833334, 0.503857421875]}}, 'pred_res': 'Sandra picked up the apple.<|eot_id|>', 'score': 0}
2025-01-22 18:05:35.024 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:05:35.024 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-80_pid-4_0-1-2-8.pkl | len: 3 |  size: 1.95 KB
Processing depth (0, 1, 2, 8):   5%|â–Œ         | 5/100 [01:45<34:54, 22.05s/it]Processing depth (0, 1, 2, 8):   5%|â–Œ         | 5/100 [01:45<33:29, 21.15s/it]
2025-01-22 18:05:35.101 | INFO     | __main__:<module>:82 - Selected idx: 82
2025-01-22 18:05:35.101 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the milk before the bathroom? 
2025-01-22 18:05:35.101 | INFO     | __main__:<module>:84 - Answer: kitchen
2025-01-22 18:05:35.101 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 18:05:35.101 | INFO     | __main__:<module>:86 - Needle: [' Mary journeyed to the kitchen.', ' Sandra took the milk.', ' John journeyed to the hallway.', ' Sandra journeyed to the kitchen.', ' John journeyed to the bedroom.', ' Sandra moved to the bathroom.', ' John went back to the garden.']
2025-01-22 18:05:35.101 | INFO     | __main__:<module>:87 - Real Needle: [' Sandra took the milk.', ' Sandra journeyed to the kitchen.', ' Sandra moved to the bathroom.', ' John went back to the garden.']
2025-01-22 18:05:35.101 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ§ğŸ¾\u200dâ™‚\u200dâ¡ï¸', 'ğŸ›µ', 'ğŸ™ğŸ»\u200dâ™€', 'ğŸ˜¬', 'ğŸ“²', 'ğŸ ', 'ğŸ‘¬', 'ğŸ§‘ğŸ¼\u200dğŸ”¬', 'ğŸ¤œ', 'ğŸ‘³ğŸ¿\u200dâ™‚ï¸']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:05<00:16,  5.43s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:11<00:11,  5.54s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:15<00:05,  5.01s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  3.39s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  4.08s/it]
Processing depth (0, 2, 3, 4):   0%|          | 0/100 [00:17<?, ?it/s]2025-01-22 18:05:53.136 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra took the milk.
2025-01-22 18:05:53.177 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra journeyed to the kitchen.
2025-01-22 18:05:53.190 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1879, 1885) --> . Sandra journeyed to the
2025-01-22 18:05:53.190 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the bathroom.
2025-01-22 18:05:53.206 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2954, 2959) --> . Sandra moved to the
2025-01-22 18:05:53.206 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the garden.
2025-01-22 18:05:53.224 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3656, 3662) --> . John went back to the
2025-01-22 18:05:53.224 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the kitchen.
2025-01-22 18:05:53.234 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1880, 1886) -->  Sandra journeyed to the kitchen
2025-01-22 18:05:53.234 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the hallway.
2025-01-22 18:05:53.255 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3839, 3845) --> . John journeyed to the
2025-01-22 18:05:53.255 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the bedroom.
2025-01-22 18:05:53.276 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3839, 3845) --> . John journeyed to the
2025-01-22 18:05:53.277 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 18:05:53.277 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 18:05:53.277 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 18:05:53.277 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸƒ\u200dâ™‚', 'ğŸ¤ğŸ¿', 'ğŸ‘©ğŸ¿\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘¨ğŸ¼', 'âŒ', 'ğŸ‘©ğŸ¿\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘¨ğŸ¾', 'ğŸ¤¹ğŸ¾\u200dâ™‚ï¸', 'ğŸ‘¨ğŸ½\u200dâ¤ï¸\u200dğŸ‘¨ğŸ¼', 'ğŸš£\u200dâ™€ï¸', 'â›¹ğŸ¿\u200dâ™‚', 'ğŸ¥­']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.51s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.69s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.71s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.26s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.78s/it]
Processing depth (3, 4, 5, 9):   0%|          | 0/100 [00:34<?, ?it/s]2025-01-22 18:06:10.252 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra took the milk.
2025-01-22 18:06:10.272 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2842, 2846) -->  Sandra took the milk
2025-01-22 18:06:10.272 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra journeyed to the kitchen.
2025-01-22 18:06:10.292 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3614, 3620) --> . Sandra journeyed to the
2025-01-22 18:06:10.292 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the bathroom.
2025-01-22 18:06:10.313 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4158, 4163) --> . Sandra moved to the
2025-01-22 18:06:10.313 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the garden.
2025-01-22 18:06:10.350 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7227, 7233) --> . John went back to the
2025-01-22 18:06:10.350 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the kitchen.
2025-01-22 18:06:10.369 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3615, 3621) -->  Sandra journeyed to the kitchen
2025-01-22 18:06:10.369 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the hallway.
2025-01-22 18:06:10.394 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3815, 3821) --> . John journeyed to the
2025-01-22 18:06:10.394 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the bedroom.
2025-01-22 18:06:10.413 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3815, 3821) --> . John journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:06:11.189 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 18:06:11.189 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8171])
2025-01-22 18:06:13.396 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [74.45870535714286, 7.822183906288231, 82.30729166666667, 7.485355523970497, 10.243842230902779], 'topk_indices': array([8154,    4, 8152, 8069,   28, 8144, 8164,    3, 8059,   23,    9,
          1,   24, 8165, 8170,   14, 3620, 8169,    0, 8166]), 'topk_tokens': [':', '\n\n', '.\n\n', ' location', '<|end_header_id|>', '.', 'Answer', '<|end_header_id|>', '.\n\n', '4', ':', '<|start_header_id|>', '\n\n', ':', '\n\n', '\n', ' kitchen', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [150.578125, 98.16666666666667, 52.1375, 18.60546875]}, 'weight': {'score': [22.121651785714285, 23.28414790800098, 21.34418402777778, 23.291441303011677, 29.723741319444443], 'topk_indices': array([3325, 3298, 3170, 3218, 7414, 7452, 1429, 1491, 4329, 4345, 5236,
       5175, 7177, 7121, 3481, 3507, 4936, 4961, 5013, 4984]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [27.912109375, 21.213541666666668, 21.040625, 20.0703125]}, 'saliency': {'score': [0.4410923549107143, 0.0423980929433264, 0.5239461263020834, 0.04030338561674093, 0.0750791761610243], 'topk_indices': array([  20, 8163, 2842,   14, 8142, 8165, 8143,   23, 8059,    8, 8140,
       8161, 8153, 2845, 8168,   24, 8069, 8170, 8164, 3620]), 'topk_tokens': [' Jul', ' \n', ' Sandra', '\n', ' location', ':', ' directly', '4', '.\n\n', ' Date', ' return', ' bathroom', 'Question', ' milk', 'assistant', '\n\n', ' location', '\n\n', 'Answer', ' kitchen'], 'evidence_proportions': [1.10791015625, 0.48992919921875, 0.26842041015625, 0.09160359700520833]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 100}
2025-01-22 18:06:13.403 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:06:13.404 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-82_pid-0_3-4-5-9.pkl | len: 3 |  size: 2.0 KB
Processing depth (3, 4, 5, 9):   1%|          | 1/100 [00:38<1:03:03, 38.21s/it]is_0k: False
your chose emoji: ['ğŸ‘±ğŸ½', 'ğŸš£ğŸ¿\u200dâ™€ï¸', 'ğŸ‡§ğŸ‡¦', 'ğŸšµğŸ½', 'ğŸ¤¹ğŸ»\u200dâ™‚', 'ğŸš£ğŸ¼\u200dâ™‚ï¸', 'ğŸ˜Š', 'ğŸŒğŸ»\u200dâ™€', 'ğŸ§‘ğŸ¿\u200dğŸ¦¼', 'ğŸŒ\u200dâ™€ï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.42s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:10,  5.02s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.92s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.39s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.93s/it]
Processing depth (2, 4, 5, 7):   1%|          | 1/100 [00:55<1:03:03, 38.21s/it]2025-01-22 18:06:30.918 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra took the milk.
2025-01-22 18:06:30.927 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1730, 1734) -->  Sandra took the milk
2025-01-22 18:06:30.927 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra journeyed to the kitchen.
2025-01-22 18:06:30.945 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3513, 3519) -->  Sandra journeyed to the kitchen
2025-01-22 18:06:30.946 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the bathroom.
2025-01-22 18:06:30.966 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4122, 4127) --> . Sandra moved to the
2025-01-22 18:06:30.966 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the garden.
2025-01-22 18:06:30.997 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5565, 5571) --> . John went back to the
2025-01-22 18:06:30.997 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the kitchen.
2025-01-22 18:06:31.017 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3514, 3520) -->  journeyed to the kitchen.
2025-01-22 18:06:31.017 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the hallway.
2025-01-22 18:06:31.036 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3663, 3669) --> . John journeyed to the
2025-01-22 18:06:31.036 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the bedroom.
2025-01-22 18:06:31.057 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3663, 3669) --> . John journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:06:31.842 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 18:06:31.843 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8165])
2025-01-22 18:06:34.051 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [84.3452380952381, 8.384890923420667, 73.44965277777777, 8.044586703469061, 12.318713201992754], 'topk_indices': array([   3, 8063, 8148, 8138,    4, 8053, 8158, 8146,   23,    9, 3518,
          1,   28, 8159,   24, 8164,   14,    0, 8163, 8160]), 'topk_tokens': ['<|end_header_id|>', ' location', ':', '.', '\n\n', '.\n\n', 'Answer', '.\n\n', '4', ':', ' kitchen', '<|start_header_id|>', '<|end_header_id|>', ':', '\n\n', '\n\n', '\n', '<|begin_of_text|>', '<|end_header_id|>', '<|eot_id|>'], 'evidence_proportions': [146.890625, 140.21875, 51.6125, 14.052083333333334]}, 'weight': {'score': [23.261904761904763, 23.276980288932418, 19.671875, 23.28500199901587, 29.579483695652176], 'topk_indices': array([3276, 3303, 3196, 3148, 7420, 7458, 1489, 1427, 4325, 4309, 5208,
       5147, 7190, 7134, 3485, 3459, 4972, 4924, 5001, 4949]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [27.912109375, 25.204427083333332, 21.040625, 20.0703125]}, 'saliency': {'score': [0.5716741652715773, 0.04552920021109436, 0.4194776746961806, 0.043341954940212125, 0.093565014825351], 'topk_indices': array([8157, 8137, 8153,   16, 8019,   23,    8, 8134, 1733,   14, 8147,
         20, 1730, 8155, 8063, 8162,   24, 8164, 8158, 3518]), 'topk_tokens': [' \n', ' directly', ' before', ' Date', ' context', '4', ' Date', ' return', ' milk', '\n', 'Question', ' Jul', ' Sandra', ' bathroom', ' location', 'assistant', '\n\n', '\n\n', 'Answer', ' kitchen'], 'evidence_proportions': [1.11395263671875, 0.9597574869791666, 0.269921875, 0.0735321044921875]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 100}
2025-01-22 18:06:34.058 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:06:34.058 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-82_pid-1_2-4-5-7.pkl | len: 3 |  size: 2.01 KB
Processing depth (2, 4, 5, 7):   2%|â–         | 2/100 [00:58<45:32, 27.88s/it]  is_0k: False
your chose emoji: ['ğŸŒº', 'ğŸ›‚', 'ğŸ‘©ğŸ¼\u200dğŸ³', 'ğŸ¤¾ğŸ»\u200dâ™€ï¸', 'ğŸŠ\u200dâ™‚', 'ğŸ§‘ğŸ»\u200dğŸ¤\u200dğŸ§‘ğŸ½', 'ğŸ¤·ğŸ¼\u200dâ™€', 'â›¹ğŸ½\u200dâ™€', 'ğŸ®', 'ğŸ””']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.20s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:09,  4.52s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.46s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.15s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.62s/it]
Processing depth (1, 3, 8, 9):   2%|â–         | 2/100 [01:15<45:32, 27.88s/it]2025-01-22 18:06:50.301 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra took the milk.
2025-01-22 18:06:50.308 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (896, 900) -->  Sandra took the milk
2025-01-22 18:06:50.308 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra journeyed to the kitchen.
2025-01-22 18:06:50.325 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2898, 2904) --> . Sandra journeyed to the
2025-01-22 18:06:50.325 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the bathroom.
2025-01-22 18:06:50.367 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6621, 6626) --> . Sandra moved to the
2025-01-22 18:06:50.367 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the garden.
2025-01-22 18:06:50.406 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7239, 7245) --> . John went back to the
2025-01-22 18:06:50.406 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the kitchen.
2025-01-22 18:06:50.421 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2899, 2905) -->  Sandra journeyed to the kitchen
2025-01-22 18:06:50.421 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the hallway.
2025-01-22 18:06:50.440 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3823, 3829) --> . John journeyed to the
2025-01-22 18:06:50.440 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the bedroom.
2025-01-22 18:06:50.462 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3823, 3829) --> . John journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:06:51.289 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 18:06:51.289 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8195])
2025-01-22 18:06:53.507 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [53.975260416666664, 5.839355349627958, 43.192708333333336, 5.63305379795318, 3.5196475074404763], 'topk_indices': array([8183, 8191, 8178, 8049,  899, 8083, 8188, 8093, 8176,    9,   28,
          1,   24,   23, 8189, 8194,   14, 8193,    0, 8190]), 'topk_tokens': [' before', '<|start_header_id|>', ':', ' context', ' milk', '.\n\n', 'Answer', ' location', '.\n\n', ':', '<|end_header_id|>', '<|start_header_id|>', '\n\n', '4', ':', '\n\n', '\n', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [139.953125, 44.098958333333336, 50.35625, 9.548828125]}, 'weight': {'score': [22.121651785714285, 23.310651225908757, 21.34418402777778, 23.318049852923153, 30.097098214285715], 'topk_indices': array([3340, 3313, 3233, 3185, 7464, 7426, 1506, 1444, 4329, 4313, 5145,
       5206, 7133, 7189, 3496, 3522, 4908, 4933, 4999, 4970]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [27.912109375, 21.213541666666668, 21.040625, 20.0703125]}, 'saliency': {'score': [0.34578741164434523, 0.03157487558893938, 0.2683512369791667, 0.030243776463778495, 0.02726759229387556], 'topk_indices': array([8176, 8083,   19,   14,   16,    8, 8192, 8183,   24,  896, 8194,
         20,   23, 8177, 8049, 8093, 2904,  899, 8185, 8188]), 'topk_tokens': ['.\n\n', '.\n\n', '26', '\n', ' Date', ' Date', 'assistant', ' before', '\n\n', ' Sandra', '\n\n', ' Jul', '4', 'Question', ' context', ' location', ' kitchen', ' milk', ' bathroom', 'Answer'], 'evidence_proportions': [1.02288818359375, 0.24704996744791666, 0.28145751953125, 0.046732584635416664]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 100}
2025-01-22 18:06:53.524 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:06:53.524 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-82_pid-2_1-3-8-9.pkl | len: 3 |  size: 2.01 KB
Processing depth (1, 3, 8, 9):   3%|â–         | 3/100 [01:18<38:51, 24.04s/it]is_0k: False
your chose emoji: ['ğŸ‘³ğŸ½\u200dâ™‚', 'ğŸ‘±ğŸ¾\u200dâ™€ï¸', 'ğŸ’ğŸ¼\u200dâ™€', 'ğŸ™…ğŸ¾\u200dâ™€ï¸', 'ğŸš£ğŸ¿\u200dâ™€', 'ğŸƒğŸ¾\u200dâ™‚ï¸\u200dâ¡ï¸', 'ğŸ§—ğŸ¿', 'ğŸ‘©\u200dğŸ«', 'ğŸ‘©ğŸ¼\u200dğŸ¦±', 'ğŸ’\u200dâ™‚']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.58s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:10,  5.03s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.80s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.33s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.88s/it]
Processing depth (1, 3, 4, 5):   3%|â–         | 3/100 [01:35<38:51, 24.04s/it]2025-01-22 18:07:10.931 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra took the milk.
2025-01-22 18:07:10.935 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (896, 900) -->  Sandra took the milk
2025-01-22 18:07:10.936 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra journeyed to the kitchen.
2025-01-22 18:07:10.951 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2936, 2942) --> . Sandra journeyed to the
2025-01-22 18:07:10.951 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the bathroom.
2025-01-22 18:07:10.973 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3639, 3644) --> . Sandra moved to the
2025-01-22 18:07:10.973 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the garden.
2025-01-22 18:07:10.999 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4264, 4270) --> . John went back to the
2025-01-22 18:07:10.999 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the kitchen.
2025-01-22 18:07:11.014 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2937, 2943) -->  Sandra journeyed to the kitchen
2025-01-22 18:07:11.015 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the hallway.
2025-01-22 18:07:11.034 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3853, 3859) --> . John journeyed to the
2025-01-22 18:07:11.034 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the bedroom.
2025-01-22 18:07:11.054 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3853, 3859) --> . John journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:07:11.864 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 18:07:11.864 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8165])
2025-01-22 18:07:14.069 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [86.50520833333333, 10.001096122061703, 62.057291666666664, 9.688191967031615, 4.611448426177536], 'topk_indices': array([   4, 8063, 8158, 8148, 8146,    3, 8053, 2942, 8019,    9,   23,
       8159,    1,   28, 8164,   24,   14, 8163,    0, 8160]), 'topk_tokens': ['\n\n', ' location', 'Answer', ':', '.\n\n', '<|end_header_id|>', '.\n\n', ' kitchen', ' context', ':', '4', ':', '<|start_header_id|>', '<|end_header_id|>', '\n\n', '\n\n', '\n', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [197.28125, 84.09375, 67.81875, 30.638020833333332]}, 'weight': {'score': [22.121651785714285, 23.283480503183153, 21.34418402777778, 23.290776079468568, 29.964221014492754], 'topk_indices': array([3277, 3304, 3197, 3149, 7430, 7392, 1466, 1404, 4276, 4292, 5165,
       5104, 7106, 7162, 3460, 3486, 4906, 4958, 4881, 4929]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [27.912109375, 21.213541666666668, 21.040625, 20.0703125]}, 'saliency': {'score': [0.5391322544642857, 0.054522929999550454, 0.4044392903645833, 0.052496199737485004, 0.03510306538015172], 'topk_indices': array([8157, 8152, 8134, 8053,   16,   14, 8162,    8,  896,   20,   23,
       8147, 8164, 8063,  899,   24, 8155, 8158, 8019, 2942]), 'topk_tokens': [' \n', ' milk', ' return', '.\n\n', ' Date', '\n', 'assistant', ' Date', ' Sandra', ' Jul', '4', 'Question', '\n\n', ' location', ' milk', '\n\n', ' bathroom', 'Answer', ' context', ' kitchen'], 'evidence_proportions': [1.4324951171875, 0.4740193684895833, 0.36552734375, 0.15334065755208334]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 100}
2025-01-22 18:07:14.076 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:07:14.077 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-82_pid-3_1-3-4-5.pkl | len: 3 |  size: 2.01 KB
Processing depth (1, 3, 4, 5):   4%|â–         | 4/100 [01:38<36:15, 22.66s/it]is_0k: False
your chose emoji: ['ğŸšº', 'ğŸ¤¦ğŸ½\u200dâ™€ï¸', 'ğŸ§‘ğŸ¾\u200dâ¤\u200dğŸ§‘ğŸ»', 'â˜ğŸ¿', 'ğŸ’‡\u200dâ™‚', 'ğŸ‘·ğŸ½\u200dâ™€', 'ğŸ©', 'ğŸš¶ğŸ¾\u200dâ™€ï¸\u200dâ¡ï¸', 'ğŸ¤¶ğŸ»', 'ğŸ’']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.31s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.71s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.90s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.44s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.91s/it]
Processing depth (1, 4, 6, 9):   4%|â–         | 4/100 [01:56<36:15, 22.66s/it]2025-01-22 18:07:31.398 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra took the milk.
2025-01-22 18:07:31.403 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (896, 900) -->  Sandra took the milk
2025-01-22 18:07:31.404 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra journeyed to the kitchen.
2025-01-22 18:07:31.424 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3609, 3615) -->  Hon. Sandra journeyed to
2025-01-22 18:07:31.425 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the bathroom.
2025-01-22 18:07:31.449 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4747, 4752) --> . Sandra moved to the
2025-01-22 18:07:31.450 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the garden.
2025-01-22 18:07:31.487 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7251, 7257) --> . John went back to the
2025-01-22 18:07:31.488 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the kitchen.
2025-01-22 18:07:31.509 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3611, 3617) -->  Sandra journeyed to the kitchen
2025-01-22 18:07:31.510 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the hallway.
2025-01-22 18:07:31.530 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3813, 3819) --> . John journeyed to the
2025-01-22 18:07:31.530 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the bedroom.
2025-01-22 18:07:31.550 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3813, 3819) --> . John journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:07:32.376 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 18:07:32.377 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8205])
2025-01-22 18:07:34.619 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [86.6382068452381, 8.684667397660819, 70.74652777777777, 8.347522359682948, 4.915944303019663], 'topk_indices': array([8178, 3616,  899, 8188,    4, 8198, 8201, 8186, 8093,    1,   23,
          9,   24, 8199,   28, 8204,   14, 8203,    0, 8200]), 'topk_tokens': ['.', ' kitchen', ' milk', ':', '\n\n', 'Answer', '<|start_header_id|>', '.\n\n', '.\n\n', '<|start_header_id|>', '4', ':', '\n\n', ':', '<|end_header_id|>', '\n\n', '\n', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [202.5, 114.92708333333333, 50.3625, 11.337890625]}, 'weight': {'score': [23.266369047619047, 23.31030321028265, 21.34418402777778, 23.31474840096707, 29.699789325842698], 'topk_indices': array([3299, 3272, 3192, 3144, 7438, 7476, 1404, 1466, 4313, 4297, 5212,
       5151, 7145, 7201, 3455, 3481, 4953, 4928, 5005, 4976]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [27.912109375, 25.220052083333332, 21.040625, 20.0703125]}, 'saliency': {'score': [0.5721246628534227, 0.046978736713848154, 0.4415961371527778, 0.0447592266567014, 0.03596938058231654], 'topk_indices': array([8186, 8174, 8193, 8093,   14, 3612,   16,    8, 8103, 8202,   20,
       8187,   24,   23,  896, 8195, 8204, 3616,  899, 8198]), 'topk_tokens': ['.\n\n', ' return', ' before', '.\n\n', '\n', ' journey', ' Date', ' Date', ' location', 'assistant', ' Jul', 'Question', '\n\n', '4', ' Sandra', ' bathroom', '\n\n', ' kitchen', ' milk', 'Answer'], 'evidence_proportions': [1.49560546875, 0.72479248046875, 0.2701171875, 0.055475870768229164]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 100}
2025-01-22 18:07:34.626 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:07:34.627 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-82_pid-4_1-4-6-9.pkl | len: 3 |  size: 2.0 KB
Processing depth (1, 4, 6, 9):   5%|â–Œ         | 5/100 [01:59<34:40, 21.90s/it]Processing depth (1, 4, 6, 9):   5%|â–Œ         | 5/100 [01:59<37:50, 23.90s/it]
2025-01-22 18:07:34.692 | INFO     | __main__:<module>:82 - Selected idx: 84
2025-01-22 18:07:34.692 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the milk before the hallway? 
2025-01-22 18:07:34.692 | INFO     | __main__:<module>:84 - Answer: bathroom
2025-01-22 18:07:34.692 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 18:07:34.692 | INFO     | __main__:<module>:86 - Needle: [' John journeyed to the hallway.', ' Daniel got the milk.', ' Sandra went back to the bathroom.', ' Daniel went to the bathroom.', ' Mary journeyed to the kitchen.', ' John journeyed to the bedroom.', ' Daniel went to the hallway.', ' John went back to the garden.']
2025-01-22 18:07:34.692 | INFO     | __main__:<module>:87 - Real Needle: [' Daniel got the milk.', ' Daniel went to the bathroom.', ' Daniel went to the hallway.', ' John went back to the garden.']
2025-01-22 18:07:34.692 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ‘³ğŸ¼\u200dâ™€ï¸', 'ğŸ¤ŒğŸ¿', 'ğŸ•’', 'ğŸ‘©ğŸ»\u200dâ¤\u200dğŸ’‹\u200dğŸ‘¨ğŸ»', 'ğŸ‘¨ğŸ¼\u200dâ¤ï¸\u200dğŸ‘¨ğŸ¾', 'ğŸ§ğŸ»\u200dâ™€ï¸', 'ğŸ—', 'ğŸ¤·ğŸ¾', 'ğŸ¤¹ğŸ¿\u200dâ™€ï¸', 'ğŸ§‘ğŸ¿\u200dğŸ¨']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.36s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.60s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.04s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.69s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.28s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (1, 2, 3, 6):   0%|          | 0/100 [00:14<?, ?it/s]2025-01-22 18:07:49.687 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the milk.
2025-01-22 18:07:49.692 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (826, 830) -->  Daniel got the milk
2025-01-22 18:07:49.692 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the bathroom.
2025-01-22 18:07:49.703 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1856, 1861) --> . Daniel went to the
2025-01-22 18:07:49.703 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the hallway.
2025-01-22 18:07:49.714 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1856, 1861) --> . Daniel went to the
2025-01-22 18:07:49.714 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the garden.
2025-01-22 18:07:49.753 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4961, 4967) --> . John went back to the
2025-01-22 18:07:49.753 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John journeyed to the hallway.
2025-01-22 18:07:49.773 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3092, 3098) --> . John journeyed to the
2025-01-22 18:07:49.773 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the bathroom.
2025-01-22 18:07:49.810 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (7309, 7315) -->  cold. Sandra went back to
2025-01-22 18:07:49.810 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the kitchen.
2025-01-22 18:07:49.837 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4592, 4598) --> . Mary journeyed to the
2025-01-22 18:07:49.838 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the bedroom.
2025-01-22 18:07:49.854 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3092, 3098) --> . John journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:07:56.358 | INFO     | test_jbb_embedding:begin_test:693 - Daniel got the milk.<|eot_id|>
2025-01-22 18:07:56.359 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8191])
2025-01-22 18:07:59.810 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [333.4546875, 30.32736033988284, 119.14127604166667, 29.321951687116563, 26.840684335443036], 'topk_indices': array([ 100, 8178, 2951,   14, 8174, 8088, 8079, 8185,  829,  826,  830,
        273, 8045, 8179, 8181, 8089, 8187, 1861, 8186,    0]), 'topk_tokens': ['E', ' milk', ' hallway', '\n', ':', ' first', '.\n\n', ':', ' milk', ' Daniel', '.', 'hue', ' context', ' before', ' hallway', ' location', '<|start_header_id|>', ' bathroom', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [731.4375, 351.55, 351.55, 37.973958333333336]}, 'weight': {'score': [21.176171875, 23.28052157066146, 21.025065104166668, 23.29232745398773, 28.97448575949367], 'topk_indices': array([3320, 3293, 3213, 3165, 7470, 7432, 1420, 1482, 4295, 4279, 5165,
       5104, 7176, 7120, 3502, 3476, 4874, 4899, 4951, 4922]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.611328125, 19.665625, 19.665625, 20.0703125]}, 'saliency': {'score': [1.9705413818359374, 0.1710224295931093, 0.6138636271158854, 0.16530235992618866, 0.19936515711530856], 'topk_indices': array([8079, 8050, 8160,   99, 8175,  827, 8085, 8184, 8088, 8173, 8178,
       8179,  829, 8045,  826, 2951,  273, 8089, 8181, 1861]), 'topk_tokens': ['.\n\n', ' locations', ' return', 'ION', ' Where', ' got', ' item', 'Answer', ' first', 'Question', ' milk', ' before', ' milk', ' context', ' Daniel', ' hallway', 'hue', ' location', ' hallway', ' bathroom'], 'evidence_proportions': [5.150390625, 1.76474609375, 1.76474609375, 0.193634033203125]}}, 'pred_res': 'Daniel got the milk.<|eot_id|>', 'score': 0}
2025-01-22 18:07:59.831 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:07:59.832 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-84_pid-0_1-2-3-6.pkl | len: 3 |  size: 2.03 KB
Processing depth (1, 2, 3, 6):   1%|          | 1/100 [00:25<41:17, 25.03s/it]is_0k: False
your chose emoji: ['ğŸ‘©ğŸ»\u200dğŸ¦½\u200dâ¡', 'ğŸ§™ğŸ½\u200dâ™€', 'ğŸ‘¨', '\U0001fac5ğŸ¼', 'ğŸ§‘ğŸ¼\u200dğŸ¦½\u200dâ¡ï¸', 'ğŸ‘¨ğŸ¾\u200dğŸ¦½\u200dâ¡ï¸', 'ğŸ‡¨ğŸ‡°', 'ğŸš´ğŸ»', 'ğŸ“œ', 'ğŸ•´ğŸ½']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.75s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.85s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.82s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.42s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.93s/it]
Processing depth (0, 3, 4, 5):   1%|          | 1/100 [00:42<41:17, 25.03s/it]2025-01-22 18:08:17.811 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the milk.
2025-01-22 18:08:17.855 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the bathroom.
2025-01-22 18:08:17.876 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2946, 2951) --> . Daniel went to the
2025-01-22 18:08:17.877 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the hallway.
2025-01-22 18:08:17.895 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2946, 2951) --> . Daniel went to the
2025-01-22 18:08:17.895 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the garden.
2025-01-22 18:08:17.920 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4241, 4247) -->  John went back to the garden
2025-01-22 18:08:17.920 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John journeyed to the hallway.
2025-01-22 18:08:17.936 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3092, 3098) --> . John journeyed to the
2025-01-22 18:08:17.936 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the bathroom.
2025-01-22 18:08:17.975 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (7256, 7262) --> . Sandra went back to the
2025-01-22 18:08:17.976 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the kitchen.
2025-01-22 18:08:18.002 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4533, 4539) --> . Mary journeyed to the
2025-01-22 18:08:18.002 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the bedroom.
2025-01-22 18:08:18.021 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3092, 3098) --> . John journeyed to the
2025-01-22 18:08:18.021 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 18:08:18.021 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 18:08:18.021 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 18:08:18.021 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['\U0001fabf', 'â˜‘ï¸', 'ğŸ§ğŸ¼\u200dâ™‚', 'ğŸ• ', 'ğŸ§›ğŸ½\u200dâ™‚ï¸', 'ğŸ•µğŸ»\u200dâ™€ï¸', 'ğŸ‘©ğŸ¼\u200dâ¤ï¸\u200dğŸ‘©ğŸ»', 'ğŸƒ\u200dâ™‚ï¸\u200dâ¡', 'ğŸ™‹ğŸ½\u200dâ™€ï¸', 'ğŸš¶ğŸ¿\u200dâ™‚\u200dâ¡']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.24s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.49s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.63s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.29s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.74s/it]
Processing depth (0, 5, 8, 9):   1%|          | 1/100 [00:59<41:17, 25.03s/it]2025-01-22 18:08:34.803 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the milk.
2025-01-22 18:08:34.847 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the bathroom.
2025-01-22 18:08:34.870 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4207, 4212) -->  Daniel went to the bathroom
2025-01-22 18:08:34.871 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the hallway.
2025-01-22 18:08:34.896 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4208, 4213) -->  went to the bathroom.
2025-01-22 18:08:34.896 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the garden.
2025-01-22 18:08:34.939 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7223, 7229) --> . John went back to the
2025-01-22 18:08:34.939 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John journeyed to the hallway.
2025-01-22 18:08:34.956 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3046, 3052) --> . John journeyed to the
2025-01-22 18:08:34.956 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the bathroom.
2025-01-22 18:08:34.994 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (7287, 7293) -->  cold. Sandra went back to
2025-01-22 18:08:34.995 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the kitchen.
2025-01-22 18:08:35.021 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4531, 4537) -->  Mary journeyed to the kitchen
2025-01-22 18:08:35.021 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the bedroom.
2025-01-22 18:08:35.039 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3046, 3052) --> . John journeyed to the
2025-01-22 18:08:35.039 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 18:08:35.039 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 18:08:35.039 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 18:08:35.039 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ”š', 'ğŸ‘¨ğŸ¼\u200dâ¤\u200dğŸ‘¨ğŸ¾', 'ğŸ§‘ğŸ¿\u200dâ¤ï¸\u200dğŸ§‘ğŸ»', 'â›¹ğŸ¼\u200dâ™€ï¸', 'ğŸ¥–', 'ğŸ‡¦ğŸ‡¶', 'âœ', 'ğŸ•µğŸ¾\u200dâ™‚ï¸', 'ğŸšµğŸ¿\u200dâ™‚ï¸', 'ğŸ†']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.74s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.67s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.44s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.05s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.61s/it]
Processing depth (3, 4, 8, 9):   1%|          | 1/100 [01:16<41:17, 25.03s/it]2025-01-22 18:08:51.308 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the milk.
2025-01-22 18:08:51.322 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2848, 2852) -->  Daniel got the milk
2025-01-22 18:08:51.323 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the bathroom.
2025-01-22 18:08:51.343 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3585, 3590) --> . Daniel went to the
2025-01-22 18:08:51.343 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the hallway.
2025-01-22 18:08:51.362 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3585, 3590) --> . Daniel went to the
2025-01-22 18:08:51.363 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the garden.
2025-01-22 18:08:51.407 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7357, 7363) --> . John went back to the
2025-01-22 18:08:51.407 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John journeyed to the hallway.
2025-01-22 18:08:51.423 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2970, 2976) --> . John journeyed to the
2025-01-22 18:08:51.423 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the bathroom.
2025-01-22 18:08:51.460 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (7440, 7446) --> . Sandra went back to the
2025-01-22 18:08:51.460 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the kitchen.
2025-01-22 18:08:51.483 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4508, 4514) --> . Mary journeyed to the
2025-01-22 18:08:51.483 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the bedroom.
2025-01-22 18:08:51.499 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2970, 2976) --> . John journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:08:52.364 | INFO     | test_jbb_embedding:begin_test:693 - Daniel got the milk.<|eot_id|>
2025-01-22 18:08:52.364 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8167])
2025-01-22 18:08:54.580 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [308.9234375, 23.704635862913097, 177.23958333333334, 22.549182408318977, 18.83430503731343], 'topk_indices': array([8161, 8149, 8154, 2850,   24, 2848, 8150,   14, 2849, 8021, 8065,
       8157, 8165, 8155, 2852, 8162, 2851, 3590,    0, 8163]), 'topk_tokens': [':', 'Question', ' milk', ' the', '\n\n', ' Daniel', ':', '\n', ' got', ' context', ' location', ' hallway', '<|end_header_id|>', ' before', '.', '<|eot_id|>', ' milk', ' bathroom', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [750.625, 293.975, 293.975, 39.369791666666664]}, 'weight': {'score': [21.176171875, 23.273403075275397, 20.1875, 23.287679016428747, 29.560401119402986], 'topk_indices': array([3338, 3311, 3183, 3231, 7419, 7381, 1461, 1523, 4329, 4313, 5192,
       5131, 7151, 7095, 3520, 3494, 4908, 4956, 4985, 4933]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.611328125, 19.665625, 19.665625, 20.0703125]}, 'saliency': {'score': [1.822601318359375, 0.13172788211444308, 0.8826878865559896, 0.12534829697642982, 0.14273253483558768], 'topk_indices': array([  24, 4067, 2785, 8136, 8151, 8064, 8061, 8160, 8154, 8149, 2849,
       8021, 2848, 8065, 8155, 6654, 2976, 8157, 2851, 3590]), 'topk_tokens': ['\n\n', ' bedroom', ' kids', ' return', ' Where', ' first', ' item', 'Answer', ' milk', 'Question', ' got', ' context', ' Daniel', ' location', ' before', ' hallway', ' hallway', ' hallway', ' milk', ' bathroom'], 'evidence_proportions': [5.177734375, 1.45517578125, 1.45517578125, 0.19822184244791666]}}, 'pred_res': 'Daniel got the milk.<|eot_id|>', 'score': 0}
2025-01-22 18:08:54.585 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:08:54.585 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-84_pid-1_3-4-8-9.pkl | len: 3 |  size: 2.04 KB
Processing depth (3, 4, 8, 9):   2%|â–         | 2/100 [01:19<1:09:26, 42.51s/it]is_0k: False
your chose emoji: ['ğŸ§”ğŸ¾', 'ğŸ¤½ğŸ¿\u200dâ™‚', 'ğŸ‡©ğŸ‡´', 'ğŸ§šğŸ¿\u200dâ™‚ï¸', 'ğŸƒ', 'ğŸ’‚ğŸ¿', '\U0001fac4ğŸ»', 'ğŸ¤¦\u200dâ™‚', 'ğŸ‘¨ğŸ½\u200dâ¤\u200dğŸ‘¨ğŸ¾', 'ğŸ›°']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.97s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.15s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.90s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.35s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.95s/it]
Processing depth (0, 4, 6, 8):   2%|â–         | 2/100 [01:37<1:09:26, 42.51s/it]2025-01-22 18:09:12.146 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the milk.
2025-01-22 18:09:12.186 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the bathroom.
2025-01-22 18:09:12.204 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3626, 3631) -->  Hon. Daniel went to
2025-01-22 18:09:12.204 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the hallway.
2025-01-22 18:09:12.222 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3626, 3631) -->  Hon. Daniel went to
2025-01-22 18:09:12.222 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the garden.
2025-01-22 18:09:12.255 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6619, 6625) --> . John went back to the
2025-01-22 18:09:12.256 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John journeyed to the hallway.
2025-01-22 18:09:12.271 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3005, 3011) -->  tragedy. John journeyed to
2025-01-22 18:09:12.271 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the bathroom.
2025-01-22 18:09:12.308 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (7293, 7299) -->  cold. Sandra went back to
2025-01-22 18:09:12.308 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the kitchen.
2025-01-22 18:09:12.331 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4467, 4473) -->  execution. Mary journeyed to
2025-01-22 18:09:12.331 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the bedroom.
2025-01-22 18:09:12.346 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3005, 3011) -->  tragedy. John journeyed to
2025-01-22 18:09:12.347 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 18:09:12.347 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 18:09:12.347 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 18:09:12.347 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ§‘ğŸ¿\u200dğŸ¤\u200dğŸ§‘ğŸ¾', 'âœ–', '\U0001faf4ğŸ»', 'ğŸ†”', 'ğŸ¦¹ğŸ»\u200dâ™€', 'ğŸ§™ğŸ¼\u200dâ™‚', 'ğŸ™ğŸ¾', 'ğŸ™†ğŸ¿\u200dâ™€', 'ğŸ‘¨ğŸ½\u200dâš•ï¸', 'ğŸ¦Œ']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  3.92s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.15s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.60s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.26s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.64s/it]
Processing depth (0, 2, 6, 8):   2%|â–         | 2/100 [01:53<1:09:26, 42.51s/it]2025-01-22 18:09:28.572 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the milk.
2025-01-22 18:09:28.613 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the bathroom.
2025-01-22 18:09:28.624 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1856, 1861) --> . Daniel went to the
2025-01-22 18:09:28.624 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the hallway.
2025-01-22 18:09:28.636 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1856, 1861) --> . Daniel went to the
2025-01-22 18:09:28.636 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the garden.
2025-01-22 18:09:28.673 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6663, 6669) --> . John went back to the
2025-01-22 18:09:28.673 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John journeyed to the hallway.
2025-01-22 18:09:28.689 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3078, 3084) --> . John journeyed to the
2025-01-22 18:09:28.689 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the bathroom.
2025-01-22 18:09:28.733 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (7348, 7354) --> . Sandra went back to the
2025-01-22 18:09:28.733 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the kitchen.
2025-01-22 18:09:28.759 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4578, 4584) --> . Mary journeyed to the
2025-01-22 18:09:28.759 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the bedroom.
2025-01-22 18:09:28.777 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3078, 3084) --> . John journeyed to the
2025-01-22 18:09:28.777 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 18:09:28.777 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 18:09:28.777 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 18:09:28.777 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['\U0001faf0ğŸ¼', 'ğŸ‡¬ğŸ‡¶', 'ğŸ‹ğŸ¼\u200dâ™€', 'ğŸ’­', 'ğŸ¤¹\u200dâ™€ï¸', 'ğŸ§‘ğŸ½\u200dğŸ¼', 'â˜•', 'ğŸ§‘ğŸ»\u200dğŸ¦³', 'ğŸ§œğŸ¿\u200dâ™‚ï¸', 'ğŸ‡µğŸ‡¾']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:05<00:15,  5.03s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:11<00:11,  5.70s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:17<00:06,  6.19s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:19<00:00,  4.17s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:19<00:00,  4.76s/it]
Processing depth (1, 3, 4, 6):   2%|â–         | 2/100 [02:14<1:09:26, 42.51s/it]2025-01-22 18:09:49.622 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the milk.
2025-01-22 18:09:49.627 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (896, 900) -->  Daniel got the milk
2025-01-22 18:09:49.628 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the bathroom.
2025-01-22 18:09:49.644 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2922, 2927) --> . Daniel went to the
2025-01-22 18:09:49.644 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the hallway.
2025-01-22 18:09:49.658 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2922, 2927) --> . Daniel went to the
2025-01-22 18:09:49.658 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the garden.
2025-01-22 18:09:49.682 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4739, 4745) --> . John went back to the
2025-01-22 18:09:49.682 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John journeyed to the hallway.
2025-01-22 18:09:49.702 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2995, 3001) -->  tragedy. John journeyed to
2025-01-22 18:09:49.702 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the bathroom.
2025-01-22 18:09:49.743 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (7368, 7374) --> . Sandra went back to the
2025-01-22 18:09:49.743 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the kitchen.
2025-01-22 18:09:49.766 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4467, 4473) -->  execution. Mary journeyed to
2025-01-22 18:09:49.766 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the bedroom.
2025-01-22 18:09:49.781 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2995, 3001) -->  tragedy. John journeyed to
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:09:50.624 | INFO     | test_jbb_embedding:begin_test:693 - Daniel got the milk.<|eot_id|>
2025-01-22 18:09:50.625 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8183])
2025-01-22 18:09:52.836 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [245.871484375, 20.72599178475446, 92.64322916666667, 19.96095573108573, 30.666822916666668], 'topk_indices': array([ 898,  897, 8170, 8081,    1,   24, 8173,   14, 8171,  903,  896,
       3002,  257,  899,  900, 8181, 8179, 2927, 8178,    0]), 'topk_tokens': [' the', ' got', ' milk', ' location', '<|start_header_id|>', '\n\n', ' hallway', '\n', ' before', 'ï¿½', ' Daniel', ' hallway', 'hue', ' milk', '.', '<|end_header_id|>', '<|start_header_id|>', ' bathroom', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [553.9375, 258.95, 258.95, 18.696614583333332]}, 'weight': {'score': [21.176171875, 23.281858890178352, 23.5361328125, 23.286281779661017, 29.35125], 'topk_indices': array([3348, 3321, 3241, 3193, 7392, 7430, 1430, 1492, 4335, 4319, 5221,
       5160, 7162, 7106, 3504, 3530, 4921, 5014, 4985, 4946]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.611328125, 19.665625, 19.665625, 20.0703125]}, 'saliency': {'score': [1.4333984375, 0.11745559688654791, 0.49438730875651044, 0.113112042735584, 0.2250096638997396], 'topk_indices': array([8152, 6340,   24, 8167, 8165,  901, 8037,  897, 3590,  908,  903,
       8081, 8170, 8171,  896, 8173,  257,  899, 3002, 2927]), 'topk_tokens': [' return', ' goods', '\n\n', ' Where', 'Question', 'ï¿½', ' context', ' got', ' hallway', 'ï¿½', 'ï¿½', ' location', ' milk', ' before', ' Daniel', ' hallway', 'hue', ' milk', ' hallway', ' bathroom'], 'evidence_proportions': [3.85107421875, 1.27109375, 1.27109375, 0.09212239583333333]}}, 'pred_res': 'Daniel got the milk.<|eot_id|>', 'score': 0}
2025-01-22 18:09:52.843 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:09:52.843 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-84_pid-2_1-3-4-6.pkl | len: 3 |  size: 2.05 KB
Processing depth (1, 3, 4, 6):   3%|â–         | 3/100 [02:18<1:20:21, 49.70s/it]is_0k: False
your chose emoji: ['ğŸšµğŸ¿', 'ğŸ§‘ğŸ½\u200dâ¤\u200dğŸ§‘ğŸ¾', 'ğŸ’‡ğŸ»\u200dâ™‚', 'ğŸ‘¸ğŸ¼', 'ğŸ”¤', 'ğŸ§‘ğŸ¿\u200dâ¤ï¸\u200dğŸ§‘ğŸ»', 'ğŸ§—ğŸ¼\u200dâ™‚ï¸', 'ğŸ‡¨ğŸ‡¶', 'ğŸ•Š', 'ğŸ«•']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.42s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.93s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.72s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.28s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.81s/it]
Processing depth (1, 2, 5, 8):   3%|â–         | 3/100 [02:35<1:20:21, 49.70s/it]2025-01-22 18:10:09.913 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the milk.
2025-01-22 18:10:09.918 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (814, 818) -->  Daniel got the milk
2025-01-22 18:10:09.918 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the bathroom.
2025-01-22 18:10:09.929 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1788, 1793) --> . Daniel went to the
2025-01-22 18:10:09.929 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the hallway.
2025-01-22 18:10:09.943 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1788, 1793) --> . Daniel went to the
2025-01-22 18:10:09.943 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the garden.
2025-01-22 18:10:09.978 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6597, 6603) --> . John went back to the
2025-01-22 18:10:09.978 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John journeyed to the hallway.
2025-01-22 18:10:09.995 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2999, 3005) -->  tragedy. John journeyed to
2025-01-22 18:10:09.995 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the bathroom.
2025-01-22 18:10:10.034 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (7352, 7358) --> . Sandra went back to the
2025-01-22 18:10:10.034 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the kitchen.
2025-01-22 18:10:10.059 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4529, 4535) -->  Mary journeyed to the kitchen
2025-01-22 18:10:10.059 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the bedroom.
2025-01-22 18:10:10.077 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2999, 3005) -->  tragedy. John journeyed to
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:10:10.940 | INFO     | test_jbb_embedding:begin_test:693 - Daniel got the milk.<|eot_id|>
2025-01-22 18:10:10.940 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8165])
2025-01-22 18:10:13.170 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [214.0421875, 20.25197416748286, 80.65104166666667, 19.596461872230428, 14.799952651515152], 'topk_indices': array([ 814, 8093, 8156,    1, 8152,  815, 8154, 1793, 8053,  817,   24,
       8163,   14, 8063,  818, 8153, 8155, 8161, 8160,    0]), 'topk_tokens': [' Daniel', ' the', '?', '<|start_header_id|>', ' milk', ' got', ' the', ' bathroom', '.\n\n', ' milk', '\n\n', '<|end_header_id|>', '\n', ' location', '.', ' before', ' hallway', '<|start_header_id|>', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [490.25, 197.4, 197.4, 57.640625]}, 'weight': {'score': [21.176171875, 23.268113751836434, 23.605143229166668, 23.27226812530773, 29.328361742424242], 'topk_indices': array([3310, 3283, 3203, 3155, 7414, 7376, 1470, 1408, 4297, 4281, 5160,
       5099, 7090, 7146, 3492, 3466, 4924, 4901, 4876, 4953]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.611328125, 19.665625, 19.665625, 20.0703125]}, 'saliency': {'score': [1.27857666015625, 0.1129936345293753, 0.4254964192708333, 0.10920095514159435, 0.1094983418782552], 'topk_indices': array([3006, 8053,   24, 7477, 1574, 8147, 8019, 7322, 7521, 8149, 7522,
        815,  261, 8152,  814,  817, 8063, 1793, 8153, 8155]), 'topk_tokens': [' hallway', '.\n\n', '\n\n', 'nes', ' part', 'Question', ' context', 'nes', ' Min', ' Where', 'nes', ' got', 'hue', ' milk', ' Daniel', ' milk', ' location', ' bathroom', ' before', ' hallway'], 'evidence_proportions': [3.370361328125, 1.0220703125, 1.0220703125, 0.3115641276041667]}}, 'pred_res': 'Daniel got the milk.<|eot_id|>', 'score': 0}
2025-01-22 18:10:13.175 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:10:13.175 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-84_pid-3_1-2-5-8.pkl | len: 3 |  size: 2.03 KB
Processing depth (1, 2, 5, 8):   4%|â–         | 4/100 [02:38<1:00:58, 38.11s/it]is_0k: False
your chose emoji: ['ğŸ˜¡', 'ğŸ§˜ğŸ¼\u200dâ™€', 'ğŸ’', '\U0001fad7', 'ğŸ§™ğŸ»\u200dâ™‚ï¸', 'ğŸ’°', 'ğŸ‡±ğŸ‡¹', 'ğŸ‘¨ğŸ¿\u200dğŸ”§', 'ğŸš´ğŸ¿\u200dâ™€ï¸', 'ğŸ§‘ğŸ»\u200dğŸ¦¯\u200dâ¡']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:05<00:15,  5.10s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.95s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.61s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.19s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.79s/it]
Processing depth (2, 3, 5, 6):   4%|â–         | 4/100 [02:55<1:00:58, 38.11s/it]2025-01-22 18:10:30.102 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the milk.
2025-01-22 18:10:30.111 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1856, 1860) -->  Daniel got the milk
2025-01-22 18:10:30.111 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the bathroom.
2025-01-22 18:10:30.128 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2973, 2978) -->  tragedy. Daniel went to
2025-01-22 18:10:30.128 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the hallway.
2025-01-22 18:10:30.144 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2973, 2978) -->  tragedy. Daniel went to
2025-01-22 18:10:30.145 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the garden.
2025-01-22 18:10:30.170 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4867, 4873) --> . John went back to the
2025-01-22 18:10:30.170 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John journeyed to the hallway.
2025-01-22 18:10:30.186 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3099, 3105) -->  ranks. John journeyed to
2025-01-22 18:10:30.186 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the bathroom.
2025-01-22 18:10:30.222 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (7249, 7255) -->  cold. Sandra went back to
2025-01-22 18:10:30.222 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the kitchen.
2025-01-22 18:10:30.245 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4541, 4547) -->  Mary journeyed to the kitchen
2025-01-22 18:10:30.245 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the bedroom.
2025-01-22 18:10:30.261 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3099, 3105) -->  ranks. John journeyed to
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:10:31.085 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's house.<|eot_id|>
2025-01-22 18:10:31.085 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8169])
2025-01-22 18:10:33.301 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [480.225, 38.073761778022515, 152.24641927083334, 36.64866722287155, 27.94692095588235], 'topk_indices': array([8154, 8164, 1860, 8156, 8158, 1858, 1855, 8163, 8152, 8160, 1862,
       1859, 8165, 8157, 1863, 8159, 1856, 1864, 2979,    0]), 'topk_tokens': [' was', '<|eot_id|>', '.', ' milk', ' the', ' the', '.', ':', ':', '?', '      ', ' milk', '<|start_header_id|>', ' before', ' *', ' hallway', ' Daniel', '      ', ' bathroom', '<|begin_of_text|>'], 'evidence_proportions': [1184.0, 461.0875, 461.0875, 42.9375]}, 'weight': {'score': [24.080078125, 23.266735881669113, 24.028645833333332, 23.262484813299704, 29.067325367647058], 'topk_indices': array([3290, 3263, 3135, 3183, 7372, 7410, 1419, 1481, 4293, 4309, 5179,
       5118, 7142, 7086, 3478, 3504, 4972, 4895, 4943, 4920]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.611328125, 25.4734375, 25.4734375, 20.0703125]}, 'saliency': {'score': [2.9981048583984373, 0.21589969106591103, 0.8379389444986979, 0.20721698370505506, 0.20784624885110295], 'topk_indices': array([8154, 1861, 8153, 1857, 4221, 8023, 8160, 8067, 3106, 8162, 8151,
       1862, 8156, 8157, 1863, 1859, 1864, 1856, 8159, 2979]), 'topk_tokens': [' was', ' *', ' Where', ' got', ' hallway', ' context', '?', ' location', ' hallway', 'Answer', 'Question', '      ', ' milk', ' before', ' *', ' milk', '      ', ' Daniel', ' hallway', ' bathroom'], 'evidence_proportions': [8.4208984375, 2.49560546875, 2.49560546875, 0.22040812174479166]}}, 'pred_res': "Daniel's house.<|eot_id|>", 'score': 0}
2025-01-22 18:10:33.310 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:10:33.310 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-84_pid-4_2-3-5-6.pkl | len: 3 |  size: 2.0 KB
Processing depth (2, 3, 5, 6):   5%|â–Œ         | 5/100 [02:58<50:04, 31.63s/it]  Processing depth (2, 3, 5, 6):   5%|â–Œ         | 5/100 [02:58<56:33, 35.72s/it]
2025-01-22 18:10:33.389 | INFO     | __main__:<module>:82 - Selected idx: 86
2025-01-22 18:10:33.389 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the milk before the hallway? 
2025-01-22 18:10:33.389 | INFO     | __main__:<module>:84 - Answer: bathroom
2025-01-22 18:10:33.389 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 18:10:33.389 | INFO     | __main__:<module>:86 - Needle: [' Daniel got the milk.', ' John journeyed to the bedroom.', ' Mary journeyed to the kitchen.', ' John journeyed to the hallway.', ' Daniel went to the bathroom.', ' Daniel went to the hallway.', ' Sandra went back to the bathroom.']
2025-01-22 18:10:33.389 | INFO     | __main__:<module>:87 - Real Needle: [' Daniel got the milk.', ' Daniel went to the bathroom.', ' Daniel went to the hallway.', ' Sandra went back to the bathroom.']
2025-01-22 18:10:33.390 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ’', 'âœğŸ¼', 'ğŸ‘©ğŸ»\u200dâš•', 'ğŸ‡³ğŸ‡¿', 'ğŸ§‘ğŸ¼\u200dâš–', 'ğŸ˜Ÿ', 'ğŸ“ª', 'â™’', 'ğŸ§‘ğŸ¾\u200dğŸ¤', 'ğŸ§‘ğŸ¿\u200dâ¤\u200dğŸ’‹\u200dğŸ§‘ğŸ»']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  5.00s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.87s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.49s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.09s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.69s/it]
Processing depth (0, 2, 4, 8):   0%|          | 0/100 [00:16<?, ?it/s]2025-01-22 18:10:50.484 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the milk.
2025-01-22 18:10:50.528 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the bathroom.
2025-01-22 18:10:50.536 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1583, 1588) --> . Daniel went to the
2025-01-22 18:10:50.536 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the hallway.
2025-01-22 18:10:50.544 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1583, 1588) --> . Daniel went to the
2025-01-22 18:10:50.544 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the bathroom.
2025-01-22 18:10:50.579 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6487, 6493) --> . Sandra went back to the
2025-01-22 18:10:50.580 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John journeyed to the bedroom.
2025-01-22 18:10:50.580 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (33, 39) -->  milk. John journeyed to
2025-01-22 18:10:50.580 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the kitchen.
2025-01-22 18:10:50.591 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1881, 1887) --> . Mary journeyed to the
2025-01-22 18:10:50.591 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the hallway.
2025-01-22 18:10:50.591 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (33, 39) -->  milk. John journeyed to
2025-01-22 18:10:50.592 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 18:10:50.592 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 18:10:50.592 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 18:10:50.592 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ’ğŸ¾', 'ğŸ•³ï¸', 'ğŸ¦¼', 'ğŸ¤¾ğŸ¾\u200dâ™‚', 'â›©ï¸', 'ğŸ”', 'ğŸ†”', 'ğŸª¥', 'ğŸƒğŸ»', 'ğŸ‘‚ğŸ»']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.55s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.71s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.77s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.30s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.81s/it]
Processing depth (0, 4, 7, 8):   0%|          | 0/100 [00:33<?, ?it/s]2025-01-22 18:11:07.571 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the milk.
2025-01-22 18:11:07.613 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the bathroom.
2025-01-22 18:11:07.631 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3637, 3642) --> . Daniel went to the
2025-01-22 18:11:07.631 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the hallway.
2025-01-22 18:11:07.657 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3637, 3642) --> . Daniel went to the
2025-01-22 18:11:07.657 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the bathroom.
2025-01-22 18:11:07.692 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6541, 6547) --> . Sandra went back to the
2025-01-22 18:11:07.692 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John journeyed to the bedroom.
2025-01-22 18:11:07.692 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (33, 39) -->  milk. John journeyed to
2025-01-22 18:11:07.692 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the kitchen.
2025-01-22 18:11:07.704 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2131, 2137) --> . Mary journeyed to the
2025-01-22 18:11:07.704 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the hallway.
2025-01-22 18:11:07.704 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (33, 39) -->  milk. John journeyed to
2025-01-22 18:11:07.704 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 18:11:07.704 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 18:11:07.704 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 18:11:07.704 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ‡¸ğŸ‡½', 'ğŸ––ğŸ¼', 'ğŸ›¡', 'ğŸ‘¨ğŸ½\u200dâœˆ', 'ğŸ‘©ğŸ¿\u200dğŸ¤\u200dğŸ‘¨ğŸ¼', 'ğŸ“', 'ğŸš¶ğŸ¼\u200dâ™‚ï¸\u200dâ¡', 'ğŸ¤·ğŸ¿', 'ğŸŸ¨', 'âœ’ï¸']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.29s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.09s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.34s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.00s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.46s/it]
Processing depth (5, 6, 8, 9):   0%|          | 0/100 [00:49<?, ?it/s]2025-01-22 18:11:23.265 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the milk.
2025-01-22 18:11:23.288 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4228, 4232) -->  got the milk.
2025-01-22 18:11:23.289 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the bathroom.
2025-01-22 18:11:23.314 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4791, 4796) -->  the senate. Daniel went
2025-01-22 18:11:23.314 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the hallway.
2025-01-22 18:11:23.338 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4791, 4796) -->  the senate. Daniel went
2025-01-22 18:11:23.338 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the bathroom.
2025-01-22 18:11:23.383 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7225, 7231) --> . Sandra went back to the
2025-01-22 18:11:23.383 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John journeyed to the bedroom.
2025-01-22 18:11:23.383 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 37) -->  journeyed to the bedroom.
2025-01-22 18:11:23.383 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the kitchen.
2025-01-22 18:11:23.396 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2130, 2136) --> . Mary journeyed to the
2025-01-22 18:11:23.397 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the hallway.
2025-01-22 18:11:23.413 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3207, 3213) --> . John journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:11:24.195 | INFO     | test_jbb_embedding:begin_test:693 - the bathroom<|eot_id|>
2025-01-22 18:11:24.195 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8180])
2025-01-22 18:11:26.447 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [515.1375, 38.479981363803006, 330.1388888888889, 36.66500153468385, 22.782898741883116], 'topk_indices': array([8176, 8168, 8162, 4229,   14, 4226, 4796, 8173, 4797,   24, 8163,
       4231, 4228, 8175, 8174, 4798, 8178, 4230, 4227,    0]), 'topk_tokens': ['<|start_header_id|>', ' before', 'Question', ' the', '\n', '!"', ' to', 'Answer', ' the', '\n\n', ':', '.', ' got', '<|eot_id|>', ':', ' bathroom', '<|end_header_id|>', ' milk', ' Daniel', '<|begin_of_text|>'], 'evidence_proportions': [1117.125, 486.1, 486.1, 162.20833333333334]}, 'weight': {'score': [22.8578125, 23.277824453134546, 20.061631944444443, 23.285963397790056, 28.897321428571427], 'topk_indices': array([3301, 3274, 3139, 3187, 7405, 7443, 1496, 1434, 4278, 4294, 5141,
       5202, 7119, 7175, 3483, 3457, 4995, 4918, 4943, 4966]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.5, 24.39375, 24.39375, 21.869791666666668]}, 'saliency': {'score': [3.08602294921875, 0.21664758015856042, 1.6810167100694444, 0.2063656708007213, 0.1625221549690544], 'topk_indices': array([8149, 8164, 1924,   24, 8078, 4795, 4214, 6534, 8167, 8168, 3213,
       4226, 4794, 8170, 8162, 8173, 4228, 4798, 4230, 4227]), 'topk_tokens': [' return', ' Where', 'asca', '\n\n', ' location', ' went', '!"', ' hallway', ' milk', ' before', ' hallway', '!"', ' Daniel', ' hallway', 'Question', 'Answer', ' got', ' bathroom', ' milk', ' Daniel'], 'evidence_proportions': [6.23779296875, 3.1041015625, 3.1041015625, 0.9547119140625]}}, 'pred_res': 'the bathroom<|eot_id|>', 'score': 100}
2025-01-22 18:11:26.454 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:11:26.454 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-86_pid-0_5-6-8-9.pkl | len: 3 |  size: 2.01 KB
Processing depth (5, 6, 8, 9):   1%|          | 1/100 [00:52<1:27:21, 52.94s/it]is_0k: False
your chose emoji: ['ğŸ’¿', 'ğŸ§‘ğŸ¼\u200dğŸ¦²', 'ğŸ¤¦ğŸ»', 'ğŸ˜Ÿ', 'ğŸ¼', 'ğŸ™…ğŸ¿\u200dâ™€ï¸', 'ğŸ‘¨ğŸ¿\u200dâš•ï¸', 'ğŸ§‘ğŸ¿\u200dğŸ¤\u200dğŸ§‘ğŸ¼', 'ğŸ§‘\u200dğŸ§’\u200dğŸ§’', 'ğŸ§“ğŸ½']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.97s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.09s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.65s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.25s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.85s/it]
Processing depth (3, 6, 7, 9):   1%|          | 1/100 [01:10<1:27:21, 52.94s/it]2025-01-22 18:11:43.779 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the milk.
2025-01-22 18:11:43.795 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2878, 2882) -->  Daniel got the milk
2025-01-22 18:11:43.795 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the bathroom.
2025-01-22 18:11:43.819 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4672, 4677) -->  Daniel went to the bathroom
2025-01-22 18:11:43.819 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the hallway.
2025-01-22 18:11:43.842 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4673, 4678) -->  went to the bathroom.
2025-01-22 18:11:43.842 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the bathroom.
2025-01-22 18:11:43.883 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7180, 7186) -->  Sandra went back to the bathroom
2025-01-22 18:11:43.883 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John journeyed to the bedroom.
2025-01-22 18:11:43.883 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 37) -->  journeyed to the bedroom.
2025-01-22 18:11:43.883 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the kitchen.
2025-01-22 18:11:43.893 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1933, 1939) -->  Mary journeyed to the kitchen
2025-01-22 18:11:43.893 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the hallway.
2025-01-22 18:11:43.909 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3140, 3146) --> . John journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:11:44.716 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 18:11:44.716 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8218])
2025-01-22 18:11:46.974 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [412.8234375, 30.784319501885417, 340.1388888888889, 29.170099214835634, 32.96380615234375], 'topk_indices': array([8106, 8200,  186, 8205, 8207, 8212, 8201, 8209, 2881, 2878, 8216,
         24, 1942, 1943,   14, 8208, 8206, 4676, 8213,    0]), 'topk_tokens': ['.\n\n', 'Question', 'ION', ' milk', ' the', ':', ':', '?', ' milk', ' Daniel', '<|end_header_id|>', '\n\n', ' *', '      ', '\n', ' hallway', ' before', ' bathroom', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [581.3125, 589.25, 505.025, 76.640625]}, 'weight': {'score': [24.760546875, 23.32762133560394, 21.391927083333332, 23.328377046926555, 29.917317708333332], 'topk_indices': array([3341, 3368, 3261, 3213, 7471, 7509, 1442, 1504, 4362, 4346, 5215,
       5276, 7192, 7248, 3524, 3550, 4992, 5069, 5017, 5040]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.611328125, 25.3546875, 20.465625, 26.610677083333332]}, 'saliency': {'score': [2.96290283203125, 0.17537228995294063, 1.9077962239583333, 0.16474852829417697, 0.24550946553548178], 'topk_indices': array([  24,   31, 1941, 8209, 3146, 1938, 8211,  186,   35, 4672, 8072,
       8200, 8205, 1942, 2881, 1943, 2878, 8206, 8208, 4676]), 'topk_tokens': ['\n\n', ' journey', '      ', '?', ' hallway', ' kitchen', 'Answer', 'ION', ' bedroom', ' Daniel', ' context', 'Question', ' milk', ' *', ' milk', '      ', ' Daniel', ' before', ' hallway', ' bathroom'], 'evidence_proportions': [4.134765625, 4.3564453125, 3.500537109375, 0.5723470052083334]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 0}
2025-01-22 18:11:46.982 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:11:46.982 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-86_pid-1_3-6-7-9.pkl | len: 3 |  size: 2.0 KB
Processing depth (3, 6, 7, 9):   2%|â–         | 2/100 [01:13<55:19, 33.87s/it]  is_0k: False
your chose emoji: ['ğŸ‘©ğŸ¾\u200dâ¤\u200dğŸ’‹\u200dğŸ‘¨ğŸ½', 'ğŸ¤¾ğŸ»\u200dâ™€ï¸', 'ğŸ¿ï¸', 'ğŸ‘‚ğŸ»', 'ğŸ§‘\u200dğŸ”§', 'ğŸ’†ğŸ¿\u200dâ™€', 'ğŸš¶ğŸ¾\u200dâ™€ï¸', 'ğŸ‘¨ğŸ¼\u200dğŸ¦¯\u200dâ¡ï¸', 'ğŸ‘©ğŸ¼\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘©ğŸ½', 'ğŸ›€']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.80s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:10,  5.03s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.46s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.08s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.68s/it]
Processing depth (4, 5, 6, 9):   2%|â–         | 2/100 [01:29<55:19, 33.87s/it]2025-01-22 18:12:03.428 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the milk.
2025-01-22 18:12:03.450 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3579, 3583) -->  Daniel got the milk
2025-01-22 18:12:03.451 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the bathroom.
2025-01-22 18:12:03.476 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4161, 4166) --> . Daniel went to the
2025-01-22 18:12:03.476 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the hallway.
2025-01-22 18:12:03.500 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4161, 4166) --> . Daniel went to the
2025-01-22 18:12:03.501 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the bathroom.
2025-01-22 18:12:03.539 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7227, 7233) --> . Sandra went back to the
2025-01-22 18:12:03.540 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John journeyed to the bedroom.
2025-01-22 18:12:03.540 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 37) -->  journeyed to the bedroom.
2025-01-22 18:12:03.540 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the kitchen.
2025-01-22 18:12:03.550 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2029, 2035) -->  cable. Mary journeyed to
2025-01-22 18:12:03.551 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the hallway.
2025-01-22 18:12:03.567 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3106, 3112) -->  ranks. John journeyed to
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:12:04.395 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's house.<|eot_id|>
2025-01-22 18:12:04.396 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8162])
2025-01-22 18:12:06.601 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [697.29375, 46.3469266687079, 392.2170138888889, 43.97894364464132, 49.329963235294116], 'topk_indices': array([  24, 8149, 3578, 7046, 7020, 3581,   14, 8157, 8144, 8152, 3583,
       8150, 3579, 8145, 3580, 8155, 8156, 4166, 3582,    0]), 'topk_tokens': ['\n\n', ' milk', '.', ' to', ' be', ' the', '\n', '<|eot_id|>', 'Question', ' hallway', '.', ' before', ' Daniel', ':', ' got', 'Answer', ':', ' bathroom', ' milk', '<|begin_of_text|>'], 'evidence_proportions': [1522.5, 718.5, 718.5, 111.8125]}, 'weight': {'score': [21.716015625, 23.269817819963258, 22.62847222222222, 23.275062100098438, 29.160386029411764], 'topk_indices': array([3297, 3270, 3190, 3142, 7407, 7445, 1430, 1492, 4304, 4320, 5127,
       5188, 7177, 7121, 3479, 3453, 4952, 4904, 4981, 4929]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.611328125, 19.665625, 19.665625, 21.869791666666668]}, 'saliency': {'score': [4.242755126953125, 0.2629400212415799, 2.1726888020833335, 0.24891617724387075, 0.35418566535500917], 'topk_indices': array([  35, 7508, 8154, 7020, 7552, 7553, 8146, 3534, 8156, 3113, 4162,
       8149, 8150, 8144, 3580, 8152, 3579, 8155, 3582, 4166]), 'topk_tokens': [' bedroom', 'nes', ' \n', ' be', ' Min', 'nes', ' Where', ' Ramsey', ':', ' hallway', ' Daniel', ' milk', ' before', 'Question', ' got', ' hallway', ' Daniel', 'Answer', ' milk', ' bathroom'], 'evidence_proportions': [10.6962890625, 3.8052734375, 3.8052734375, 0.6695353190104166]}}, 'pred_res': "Daniel's house.<|eot_id|>", 'score': 0}
2025-01-22 18:12:06.606 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:12:06.607 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-86_pid-2_4-5-6-9.pkl | len: 3 |  size: 1.98 KB
Processing depth (4, 5, 6, 9):   3%|â–         | 3/100 [01:33<44:14, 27.37s/it]is_0k: False
your chose emoji: ['ğŸª³', 'ğŸ¤', 'ğŸ‘©ğŸ½\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘¨ğŸ¼', 'ğŸ“¬', 'ğŸ›', 'ğŸ‘¨ğŸ¿\u200dğŸ¤\u200dğŸ‘¨ğŸ½', 'ğŸ‡©ğŸ‡´', 'ğŸ‡¦ğŸ‡¸', 'ğŸ‘©\u200dğŸ¦³', 'â†˜']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.67s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:10,  5.05s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:05,  5.01s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.45s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  4.00s/it]
Processing depth (2, 3, 5, 8):   3%|â–         | 3/100 [01:50<44:14, 27.37s/it]2025-01-22 18:12:24.406 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the milk.
2025-01-22 18:12:24.417 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1861, 1865) -->  Daniel got the milk
2025-01-22 18:12:24.417 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the bathroom.
2025-01-22 18:12:24.431 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2898, 2903) --> . Daniel went to the
2025-01-22 18:12:24.431 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the hallway.
2025-01-22 18:12:24.449 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2898, 2903) --> . Daniel went to the
2025-01-22 18:12:24.449 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the bathroom.
2025-01-22 18:12:24.484 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6573, 6579) --> . Sandra went back to the
2025-01-22 18:12:24.484 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John journeyed to the bedroom.
2025-01-22 18:12:24.484 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 37) -->  journeyed to the bedroom.
2025-01-22 18:12:24.484 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the kitchen.
2025-01-22 18:12:24.495 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2131, 2137) --> . Mary journeyed to the
2025-01-22 18:12:24.496 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the hallway.
2025-01-22 18:12:24.512 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3137, 3143) -->  ranks. John journeyed to
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:12:25.355 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's house.<|eot_id|>
2025-01-22 18:12:25.355 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8194])
2025-01-22 18:12:27.605 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [481.290625, 39.50976729291204, 303.6875, 37.84402193896311, 31.916968936011905], 'topk_indices': array([  14, 8181, 8082, 1863, 3144, 1864, 8179, 8176, 8187, 8048, 8183,
       8092, 8185, 8177, 1861, 2903, 8188, 8182, 8184,    0]), 'topk_tokens': ['\n', ' milk', '.\n\n', ' the', ' hallway', ' milk', ' was', 'Question', 'Answer', ' context', ' the', ' location', '?', ':', ' Daniel', ' bathroom', ':', ' before', ' hallway', '<|begin_of_text|>'], 'evidence_proportions': [1004.625, 475.0, 475.0, 142.88541666666666]}, 'weight': {'score': [21.716015625, 23.304251936684153, 21.39887152777778, 23.31234871001348, 29.718377976190474], 'topk_indices': array([3337, 3364, 3221, 3173, 7447, 7485, 1486, 1424, 4332, 4348, 5224,
       5163, 7224, 7168, 3546, 3520, 4965, 5017, 4988, 4940]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.611328125, 19.665625, 19.665625, 21.869791666666668]}, 'saliency': {'score': [2.80167236328125, 0.2246353318811379, 1.5868326822916667, 0.21531307511739337, 0.23084131876627603], 'topk_indices': array([8082, 1862, 8091, 8053, 8163, 8179, 8178, 8185, 4194, 8181, 8092,
       8048, 1864, 8176, 8187, 3144, 1861, 8182, 2903, 8184]), 'topk_tokens': ['.\n\n', ' got', ' first', ' locations', ' return', ' was', ' Where', '?', ' hallway', ' milk', ' location', ' context', ' milk', 'Question', 'Answer', ' hallway', ' Daniel', ' before', ' bathroom', ' hallway'], 'evidence_proportions': [6.73388671875, 2.391015625, 2.391015625, 0.8646240234375]}}, 'pred_res': "Daniel's house.<|eot_id|>", 'score': 0}
2025-01-22 18:12:27.612 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:12:27.612 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-86_pid-3_2-3-5-8.pkl | len: 3 |  size: 2.01 KB
Processing depth (2, 3, 5, 8):   4%|â–         | 4/100 [01:54<39:46, 24.86s/it]is_0k: False
your chose emoji: ['ğŸ§‘ğŸ¼\u200dğŸ¦¼', 'ğŸ‘–', 'ğŸ‘©ğŸ½\u200dâ¤\u200dğŸ’‹\u200dğŸ‘¨ğŸ¼', 'ğŸ–•ğŸ¿', 'ğŸ‘±ğŸ»\u200dâ™€ï¸', 'ğŸ™†ğŸ»\u200dâ™‚ï¸', 'ğŸ‘©ğŸ¾\u200dâ¤\u200dğŸ’‹\u200dğŸ‘©ğŸ¿', 'ğŸ˜„', 'ğŸ’ğŸ»', 'ğŸ”ƒ']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.11s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.61s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.52s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.92s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.49s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (2, 3, 4, 7):   4%|â–         | 4/100 [02:09<39:46, 24.86s/it]2025-01-22 18:12:43.336 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the milk.
2025-01-22 18:12:43.347 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1809, 1813) -->  Daniel got the milk
2025-01-22 18:12:43.347 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the bathroom.
2025-01-22 18:12:43.361 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2846, 2851) --> . Daniel went to the
2025-01-22 18:12:43.361 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the hallway.
2025-01-22 18:12:43.377 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2846, 2851) --> . Daniel went to the
2025-01-22 18:12:43.377 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the bathroom.
2025-01-22 18:12:43.412 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5615, 5621) --> . Sandra went back to the
2025-01-22 18:12:43.412 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John journeyed to the bedroom.
2025-01-22 18:12:43.412 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 37) -->  journeyed to the bedroom.
2025-01-22 18:12:43.412 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the kitchen.
2025-01-22 18:12:43.425 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2054, 2060) -->  cable. Mary journeyed to
2025-01-22 18:12:43.425 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the hallway.
2025-01-22 18:12:43.444 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3047, 3053) -->  tragedy. John journeyed to
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:12:46.910 | INFO     | test_jbb_embedding:begin_test:693 - the capitol<|eot_id|>
2025-01-22 18:12:46.910 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8156])
2025-01-22 18:12:49.839 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [215.484375, 25.427819355925973, 145.71180555555554, 24.693150858884373, 21.622806490384615], 'topk_indices': array([1809, 8138, 8154, 2851,   14, 1812, 1743,   24, 8149, 8139, 8054,
       1665, 8152, 8151, 8150, 8144, 1744, 8146, 1666,    0]), 'topk_tokens': [' Daniel', 'Question', '<|end_header_id|>', ' bathroom', '\n', ' milk', ' summer', '\n\n', 'Answer', ':', ' location', "'s", '<|start_header_id|>', '<|eot_id|>', ':', ' before', "'s", ' hallway', ' work', '<|begin_of_text|>'], 'evidence_proportions': [493.5, 201.325, 201.325, 53.739583333333336]}, 'weight': {'score': [21.716015625, 23.270387761980636, 22.90451388888889, 23.275026743935477, 29.468028846153846], 'topk_indices': array([3331, 3358, 3203, 3251, 7395, 7433, 1506, 1444, 4352, 4336, 5147,
       5208, 7116, 7172, 3514, 3540, 4949, 5001, 4972, 4924]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.611328125, 19.665625, 19.665625, 21.869791666666668]}, 'saliency': {'score': [1.3318817138671875, 0.14233889172424624, 0.7976888020833334, 0.1379567768579339, 0.1609126164362981], 'topk_indices': array([8147, 8053,   24, 3054, 8140, 1810, 1664, 1665, 8143, 8138, 1809,
       8054, 1812, 1744, 1743, 8149, 2851, 8144, 1666, 8146]), 'topk_tokens': ['?', ' first', '\n\n', ' hallway', ' Where', ' got', ' summer', "'s", ' milk', 'Question', ' Daniel', ' location', ' milk', "'s", ' summer', 'Answer', ' bathroom', ' before', ' work', ' hallway'], 'evidence_proportions': [3.439208984375, 1.095166015625, 1.095166015625, 0.3215230305989583]}}, 'pred_res': 'the capitol<|eot_id|>', 'score': 0}
2025-01-22 18:12:49.846 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:12:49.846 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-86_pid-4_2-3-4-7.pkl | len: 3 |  size: 2.02 KB
Processing depth (2, 3, 4, 7):   5%|â–Œ         | 5/100 [02:16<37:51, 23.91s/it]Processing depth (2, 3, 4, 7):   5%|â–Œ         | 5/100 [02:16<43:12, 27.29s/it]
2025-01-22 18:12:49.939 | INFO     | __main__:<module>:82 - Selected idx: 88
2025-01-22 18:12:49.939 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the milk before the hallway? 
2025-01-22 18:12:49.939 | INFO     | __main__:<module>:84 - Answer: bathroom
2025-01-22 18:12:49.939 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 18:12:49.939 | INFO     | __main__:<module>:86 - Needle: [' Mary journeyed to the kitchen.', ' John journeyed to the hallway.', ' Daniel picked up the milk.', ' John journeyed to the bedroom.', ' Daniel went to the bathroom.', ' Daniel went to the hallway.', ' Sandra went back to the bathroom.']
2025-01-22 18:12:49.939 | INFO     | __main__:<module>:87 - Real Needle: [' Daniel picked up the milk.', ' Daniel went to the bathroom.', ' Daniel went to the hallway.', ' Sandra went back to the bathroom.']
2025-01-22 18:12:49.939 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ‘©ğŸ¾\u200dğŸ¤', 'ğŸš´\u200dâ™‚ï¸', 'ğŸ§œğŸ¼', 'â˜”', 'ğŸ‡¦ğŸ‡¼', 'ğŸ§', 'ğŸ‘³ğŸ¿\u200dâ™€ï¸', 'ğŸ• ', 'ğŸ‘©ğŸ»\u200dğŸ­', 'ğŸ‘®ğŸ¾\u200dâ™‚ï¸']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.40s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.67s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.63s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.20s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.71s/it]
Processing depth (0, 4, 5, 9):   0%|          | 0/100 [00:16<?, ?it/s]2025-01-22 18:13:06.506 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the milk.
2025-01-22 18:13:06.506 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the milk.
2025-01-22 18:13:06.506 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the bathroom.
2025-01-22 18:13:06.524 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3622, 3627) -->  Hon. Daniel went to
2025-01-22 18:13:06.525 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the hallway.
2025-01-22 18:13:06.543 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3622, 3627) -->  Hon. Daniel went to
2025-01-22 18:13:06.543 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the bathroom.
2025-01-22 18:13:06.581 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7248, 7254) --> . Sandra went back to the
2025-01-22 18:13:06.581 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the kitchen.
2025-01-22 18:13:06.615 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6655, 6661) --> . Mary journeyed to the
2025-01-22 18:13:06.615 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the hallway.
2025-01-22 18:13:06.647 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6113, 6119) -->  journeyed to the bedroom.
2025-01-22 18:13:06.647 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the bedroom.
2025-01-22 18:13:06.680 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6112, 6118) -->  John journeyed to the bedroom
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:13:07.541 | INFO     | test_jbb_embedding:begin_test:693 - Daniel picked up the milk.<|eot_id|>
2025-01-22 18:13:07.542 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8183])
2025-01-22 18:13:09.770 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [662.9047619047619, 60.01592658196922, 270.84375, 57.996095188412916, 17.70527844551282], 'topk_indices': array([ 102,  101,   74, 8173,  111, 7303,   64,  106,  103,  185,  112,
         65, 7381,   69,  104,   66,    0,   67,   68,  105]), 'topk_tokens': ['ENCES', 'ISC', ' PA', ' hallway', '.', 'nes', 'ENCES', 'E', ' OF', 'ION', ' PA', ' OF', 'nes', 'ER', ' P', ' P', '<|begin_of_text|>', 'ION', 'E', 'ION'], 'evidence_proportions': [858.4, 758.85, 758.85, 340.0833333333333]}, 'weight': {'score': [23.14657738095238, 23.297310194234058, 21.569010416666668, 23.301517237940345, 29.82051282051282], 'topk_indices': array([3298, 3271, 3191, 3143, 7466, 7428, 1405, 1467, 4276, 4292, 5182,
       5121, 7198, 7142, 3494, 3468, 4946, 4898, 4975, 4923]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.025, 24.4734375, 24.4734375, 21.869791666666668]}, 'saliency': {'score': [3.8192196800595237, 0.3447872845025043, 1.5404188368055556, 0.3331898316673315, 0.13273229354467148], 'topk_indices': array([8171,  103,  106,   65, 7380,   74,  102, 7303,  185,  101,   64,
         69,  104,  112, 8173, 7381,   66,   67,   68,  105]), 'topk_tokens': [' before', ' OF', 'E', ' OF', ' Min', ' PA', 'ENCES', 'nes', 'ION', 'ISC', 'ENCES', 'ER', ' P', ' PA', ' hallway', 'nes', ' P', 'ION', 'E', 'ION'], 'evidence_proportions': [4.4779296875, 4.5212890625, 4.5212890625, 2.1001790364583335]}}, 'pred_res': 'Daniel picked up the milk.<|eot_id|>', 'score': 0}
2025-01-22 18:13:09.789 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:13:09.789 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-88_pid-0_0-4-5-9.pkl | len: 3 |  size: 1.92 KB
Processing depth (0, 4, 5, 9):   1%|          | 1/100 [00:19<32:34, 19.74s/it]is_0k: False
your chose emoji: ['ğŸ‘¨\u200dâ¤ï¸\u200dğŸ‘¨', 'ğŸ‘©ğŸ¾\u200dğŸ¤\u200dğŸ‘¨ğŸ¼', 'ğŸ§‘\u200dğŸ„', 'ğŸ‘¨\u200dğŸ‘¦\u200dğŸ‘¦', 'ğŸ‘©\u200dâ¤\u200dğŸ’‹\u200dğŸ‘¨', 'ğŸ˜°', 'ğŸšŒ', 'ğŸ™ğŸ¼\u200dâ™‚ï¸', 'â¤µï¸', 'ğŸ¤']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.44s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  5.00s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.61s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.20s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.75s/it]
Processing depth (0, 1, 3, 4):   1%|          | 1/100 [00:36<32:34, 19.74s/it]2025-01-22 18:13:26.560 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the milk.
2025-01-22 18:13:26.561 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the milk.
2025-01-22 18:13:26.561 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the bathroom.
2025-01-22 18:13:26.565 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (821, 826) --> . Daniel went to the
2025-01-22 18:13:26.565 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the hallway.
2025-01-22 18:13:26.569 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (821, 826) --> . Daniel went to the
2025-01-22 18:13:26.570 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the bathroom.
2025-01-22 18:13:26.588 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3627, 3633) --> . Sandra went back to the
2025-01-22 18:13:26.588 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the kitchen.
2025-01-22 18:13:26.622 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6562, 6568) --> . Mary journeyed to the
2025-01-22 18:13:26.622 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the hallway.
2025-01-22 18:13:26.655 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5848, 5854) --> . John journeyed to the
2025-01-22 18:13:26.655 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the bedroom.
2025-01-22 18:13:26.689 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5848, 5854) --> . John journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:13:27.491 | INFO     | test_jbb_embedding:begin_test:693 - The bathroom.<|eot_id|>
2025-01-22 18:13:27.491 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8183])
2025-01-22 18:13:29.705 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [180.88392857142858, 15.078139315599804, 27.743055555555557, 14.62277045998527, 4.9430401141826925], 'topk_indices': array([  42,  100,  826,   52,   57,   60,   63,  101,  102, 8178,   64,
        103,   65,  104,   69,   66,    0,   67,  105,   68]), 'topk_tokens': [' prepared', 'MIN', ' bathroom', ' Gutenberg', ' Proof', '\n\n\n\n', 'ISC', 'ISC', 'ENCES', '<|eot_id|>', 'ENCES', ' OF', ' OF', ' P', 'ER', ' P', '<|begin_of_text|>', 'ION', 'ION', 'E'], 'evidence_proportions': [347.7, 184.15, 184.15, 36.427083333333336]}, 'weight': {'score': [20.857142857142858, 23.29262612997801, 19.62673611111111, 23.307003344789493, 29.57471955128205], 'topk_indices': array([3338, 3311, 3183, 3231, 7474, 7436, 1479, 1417, 4333, 4317, 5140,
       5201, 7157, 7213, 3520, 3494, 4994, 4942, 4917, 4965]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.025, 19.665625, 19.665625, 21.869791666666668]}, 'saliency': {'score': [0.9119960239955357, 0.08627211223334809, 0.1374265882703993, 0.08403067578856194, 0.0372321300017528], 'topk_indices': array([ 56,  42, 100,  60,  57,  63, 103, 826,  52,   0, 101, 102,  65,
        64, 104,  69,  66,  68,  67, 105]), 'topk_tokens': ['istributed', ' prepared', 'MIN', '\n\n\n\n', ' Proof', 'ISC', ' OF', ' bathroom', ' Gutenberg', '<|begin_of_text|>', 'ISC', 'ENCES', ' OF', 'ENCES', ' P', 'ER', ' P', 'E', 'ION', 'ION'], 'evidence_proportions': [1.83017578125, 0.87421875, 0.87421875, 0.209808349609375]}}, 'pred_res': 'The bathroom.<|eot_id|>', 'score': 100}
2025-01-22 18:13:29.726 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:13:29.727 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-88_pid-1_0-1-3-4.pkl | len: 3 |  size: 1.97 KB
Processing depth (0, 1, 3, 4):   2%|â–         | 2/100 [00:39<32:25, 19.86s/it]is_0k: False
your chose emoji: ['ğŸ‡¹ğŸ‡¨', 'ğŸ‘°ğŸ½\u200dâ™‚ï¸', 'ğŸ¿', 'ğŸ‘©ğŸ»\u200dâš•ï¸', 'ğŸ¤¦ğŸ»', 'ğŸ‘©ğŸ¿\u200dğŸ¦½\u200dâ¡ï¸', 'âœŒ', 'ğŸš¶ğŸ¼\u200dâ™‚\u200dâ¡ï¸', 'ğŸšµğŸ»\u200dâ™‚ï¸', 'ğŸ‘©']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.40s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.63s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.56s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  2.92s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.52s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (3, 5, 6, 7):   2%|â–         | 2/100 [00:55<32:25, 19.86s/it]2025-01-22 18:13:45.558 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the milk.
2025-01-22 18:13:45.574 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2907, 2912) --> . Daniel picked up the
2025-01-22 18:13:45.575 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the bathroom.
2025-01-22 18:13:45.599 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4198, 4203) -->  Daniel went to the bathroom
2025-01-22 18:13:45.599 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the hallway.
2025-01-22 18:13:45.622 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4199, 4204) -->  went to the bathroom.
2025-01-22 18:13:45.623 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the bathroom.
2025-01-22 18:13:45.652 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5699, 5705) --> . Sandra went back to the
2025-01-22 18:13:45.652 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the kitchen.
2025-01-22 18:13:45.690 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6626, 6632) --> . Mary journeyed to the
2025-01-22 18:13:45.691 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the hallway.
2025-01-22 18:13:45.721 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6084, 6090) -->  journeyed to the bedroom.
2025-01-22 18:13:45.721 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the bedroom.
2025-01-22 18:13:45.755 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6083, 6089) -->  John journeyed to the bedroom
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:13:49.595 | INFO     | test_jbb_embedding:begin_test:693 - the doctor's office<|eot_id|>
2025-01-22 18:13:49.595 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8159])
2025-01-22 18:13:52.299 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [471.58035714285717, 26.183185034305318, 125.91666666666667, 24.81071879231811, 16.583629261363637], 'topk_indices': array([4200, 4198, 4108, 8142, 2909, 4201, 2908, 8146,   14, 2907, 2913,
       8147, 8153, 2912, 8155, 2916, 2915, 8154,    0, 4202]), 'topk_tokens': [' to', ' Daniel', ' Foster', ':', ' picked', ' the', ' Daniel', ' milk', '\n', '.', '.', ' before', ':', ' milk', '<|start_header_id|>', 'y', 'ible', '<|eot_id|>', '<|begin_of_text|>', ' bathroom'], 'evidence_proportions': [494.3, 684.2, 641.2, 134.11458333333334]}, 'weight': {'score': [22.48251488095238, 23.269606867189413, 21.569010416666668, 23.275410100947926, 29.306344696969695], 'topk_indices': array([3247, 3274, 3167, 3119, 7406, 7444, 1473, 1411, 4266, 4250, 5142,
       5081, 7163, 7107, 3430, 3456, 4906, 4858, 4883, 4935]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.3625, 25.3546875, 20.465625, 21.869791666666668]}, 'saliency': {'score': [3.104556129092262, 0.1495514925540998, 0.7428724500868056, 0.14059730387960884, 0.12168306292909564], 'topk_indices': array([6385, 2878, 4183, 2868, 8013, 4199, 8152, 8141, 4108, 3467, 4198,
       8147, 2909, 2916, 8149, 8146, 2908, 2912, 2915, 4202]), 'topk_tokens': [' hallway', ' Gov', 'outs', ' lyn', ' context', ' went', 'Answer', 'Question', ' Foster', ' Ramsey', ' Daniel', ' before', ' picked', 'y', ' hallway', ' milk', ' Daniel', ' milk', 'ible', ' bathroom'], 'evidence_proportions': [2.7916015625, 4.9498046875, 4.27333984375, 0.8536580403645834]}}, 'pred_res': "the doctor's office<|eot_id|>", 'score': 0}
2025-01-22 18:13:52.329 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:13:52.329 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-88_pid-2_3-5-6-7.pkl | len: 3 |  size: 2.0 KB
Processing depth (3, 5, 6, 7):   3%|â–         | 3/100 [01:02<34:07, 21.11s/it]is_0k: False
your chose emoji: ['ğŸ™…ğŸ¼\u200dâ™€ï¸', 'â–ª', 'ğŸ¦¹\u200dâ™€ï¸', 'ğŸ‘©ğŸ½\u200dğŸš’', 'ğŸ‘¨ğŸ¼\u200dğŸ¨', 'ğŸ§‘\u200dğŸš’', 'ğŸ¦ ', 'ğŸ‘®ğŸ»\u200dâ™‚ï¸', 'ğŸ¤šğŸ¾', 'ğŸ€']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.79s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.04s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.96s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.41s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.97s/it]
Processing depth (2, 3, 4, 7):   3%|â–         | 3/100 [01:19<34:07, 21.11s/it]2025-01-22 18:14:09.961 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the milk.
2025-01-22 18:14:09.970 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1857, 1862) --> . Daniel picked up the
2025-01-22 18:14:09.970 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the bathroom.
2025-01-22 18:14:09.986 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2929, 2934) --> . Daniel went to the
2025-01-22 18:14:09.986 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the hallway.
2025-01-22 18:14:10.004 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2929, 2934) --> . Daniel went to the
2025-01-22 18:14:10.004 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the bathroom.
2025-01-22 18:14:10.032 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5635, 5641) --> . Sandra went back to the
2025-01-22 18:14:10.032 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the kitchen.
2025-01-22 18:14:10.066 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6610, 6616) --> . Mary journeyed to the
2025-01-22 18:14:10.066 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the hallway.
2025-01-22 18:14:10.100 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6090, 6096) -->  journeyed to the bedroom.
2025-01-22 18:14:10.100 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the bedroom.
2025-01-22 18:14:10.134 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6089, 6095) -->  John journeyed to the bedroom
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:14:11.016 | INFO     | test_jbb_embedding:begin_test:693 - Daniel picked up the milk.<|eot_id|>
2025-01-22 18:14:11.016 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8183])
2025-01-22 18:14:13.238 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [411.94642857142856, 26.775214543122406, 144.48090277777777, 25.522324168405547, 23.682742387820515], 'topk_indices': array([2902, 1857, 8071, 1860,   14, 2929,   24, 8166, 1863, 8176, 8081,
       2901, 1862, 8171, 8177, 1858, 8178, 8179, 2934,    0]), 'topk_tokens': [' During', '.', '.\n\n', ' up', '\n', '.', '\n\n', ':', '.', 'Answer', ' location', '.', ' milk', ' before', ':', ' Daniel', '<|eot_id|>', '<|start_header_id|>', ' bathroom', '<|begin_of_text|>'], 'evidence_proportions': [618.35, 445.15, 445.15, 184.60416666666666]}, 'weight': {'score': [20.9375, 23.280509406303445, 21.569010416666668, 23.290330221247086, 28.94971955128205], 'topk_indices': array([3296, 3269, 3189, 3141, 7454, 7416, 1421, 1483, 4298, 4282, 5107,
       5168, 7137, 7193, 3478, 3452, 4932, 4909, 4884, 4961]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.3625, 19.665625, 19.665625, 21.869791666666668]}, 'saliency': {'score': [2.2460704985119047, 0.15094626412949702, 0.8717888726128472, 0.14395316533549543, 0.17676935440454727], 'topk_indices': array([3636, 2900, 6391, 2928, 1860, 8170, 2930, 8165, 8037, 2390, 2902,
       1859, 5641, 8081, 8171, 8173, 8176, 1862, 1858, 2934]), 'topk_tokens': [' hallway', ' Gov', ' hallway', ' Gov', ' up', ' milk', ' Daniel', 'Question', ' context', 'little', ' During', ' picked', ' bathroom', ' location', ' before', ' hallway', 'Answer', ' milk', ' Daniel', ' bathroom'], 'evidence_proportions': [3.709765625, 2.1916015625, 2.1916015625, 1.1171061197916667]}}, 'pred_res': 'Daniel picked up the milk.<|eot_id|>', 'score': 0}
2025-01-22 18:14:13.245 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:14:13.245 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-88_pid-3_2-3-4-7.pkl | len: 3 |  size: 2.02 KB
Processing depth (2, 3, 4, 7):   4%|â–         | 4/100 [01:23<33:39, 21.03s/it]is_0k: False
your chose emoji: ['6ï¸âƒ£', 'ğŸ‡²ğŸ‡·', 'ğŸ‘¨\u200dğŸ“', 'ğŸ¤¾ğŸ½\u200dâ™€', 'ğŸ§‘ğŸ¾\u200dğŸ¤\u200dğŸ§‘ğŸ¾', 'ğŸ‘¨\u200dğŸ‘§\u200dğŸ‘§', 'ğŸ‡§ğŸ‡ª', 'ğŸŒ\u200dâ™€', 'ğŸƒ', 'ğŸ§‘ğŸ¼\u200dğŸ„']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  3.92s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.49s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.61s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.27s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.70s/it]
Processing depth (3, 4, 8, 9):   4%|â–         | 4/100 [01:39<33:39, 21.03s/it]2025-01-22 18:14:29.734 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the milk.
2025-01-22 18:14:29.750 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2883, 2888) --> . Daniel picked up the
2025-01-22 18:14:29.750 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the bathroom.
2025-01-22 18:14:29.782 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3561, 3566) --> . Daniel went to the
2025-01-22 18:14:29.782 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the hallway.
2025-01-22 18:14:29.802 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3561, 3566) --> . Daniel went to the
2025-01-22 18:14:29.802 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the bathroom.
2025-01-22 18:14:29.856 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7220, 7226) --> . Sandra went back to the
2025-01-22 18:14:29.856 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the kitchen.
2025-01-22 18:14:29.907 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6589, 6595) -->  the hallway. Mary journeyed
2025-01-22 18:14:29.908 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the hallway.
2025-01-22 18:14:29.937 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5799, 5805) --> . John journeyed to the
2025-01-22 18:14:29.937 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the bedroom.
2025-01-22 18:14:29.968 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5799, 5805) --> . John journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:14:30.728 | INFO     | test_jbb_embedding:begin_test:693 - the bathroom<|eot_id|>
2025-01-22 18:14:30.728 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8167])
2025-01-22 18:14:32.945 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [245.88169642857142, 17.544170746634027, 84.35763888888889, 16.806533252367483, 16.379659598214285], 'topk_indices': array([8150, 2851, 2884,   14, 2885, 2855, 2856,    1, 2864, 8160, 2854,
       8165, 2888, 2853,   24, 8161, 2889, 3566, 8162,    0]), 'topk_tokens': [':', ' feature', ' Daniel', '\n', ' picked', ' *', '      ', '<|start_header_id|>', 'nes', 'Answer', '      ', '<|end_header_id|>', ' milk', ' *', '\n\n', ':', '.', ' bathroom', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [408.35, 291.125, 291.125, 35.0859375]}, 'weight': {'score': [20.9375, 23.27703105875153, 21.08767361111111, 23.287920074406593, 29.39107142857143], 'topk_indices': array([3312, 3285, 3151, 3199, 7400, 7438, 1489, 1427, 4298, 4282, 5093,
       5154, 7170, 7114, 3468, 3494, 4947, 4918, 4870, 4895]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.3625, 19.665625, 19.665625, 21.869791666666668]}, 'saliency': {'score': [1.3137904575892858, 0.09914882477815178, 0.4565294053819444, 0.09522060872355799, 0.12166846139090402], 'topk_indices': array([2863,   24, 2833, 8065, 2861, 2847, 8149, 8155, 2855, 2856, 2851,
       8157, 2854, 2864, 2853, 2885, 2884, 8160, 2888, 3566]), 'topk_tokens': [' Min', '\n\n', 'nes', ' location', ' *\n\n', 'illustr', 'Question', ' before', ' *', '      ', ' feature', ' hallway', '      ', 'nes', ' *', ' picked', ' Daniel', 'Answer', ' milk', ' bathroom'], 'evidence_proportions': [2.3890625, 1.4392578125, 1.4392578125, 0.2086181640625]}}, 'pred_res': 'the bathroom<|eot_id|>', 'score': 100}
2025-01-22 18:14:32.953 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:14:32.953 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-88_pid-4_3-4-8-9.pkl | len: 3 |  size: 2.0 KB
Processing depth (3, 4, 8, 9):   5%|â–Œ         | 5/100 [01:42<32:32, 20.56s/it]Processing depth (3, 4, 8, 9):   5%|â–Œ         | 5/100 [01:42<32:36, 20.59s/it]
2025-01-22 18:14:33.013 | INFO     | __main__:<module>:82 - Selected idx: 90
2025-01-22 18:14:33.013 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the milk before the garden? 
2025-01-22 18:14:33.013 | INFO     | __main__:<module>:84 - Answer: bathroom
2025-01-22 18:14:33.013 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 18:14:33.013 | INFO     | __main__:<module>:86 - Needle: [' John took the milk there.', ' Daniel journeyed to the bedroom.', ' Mary journeyed to the office.', ' John went back to the bathroom.', ' Sandra went back to the kitchen.', ' John moved to the garden.', ' Daniel moved to the bathroom.']
2025-01-22 18:14:33.013 | INFO     | __main__:<module>:87 - Real Needle: [' John took the milk there.', ' John went back to the bathroom.', ' John moved to the garden.', ' Daniel moved to the bathroom.']
2025-01-22 18:14:33.013 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ’ª', 'ğŸ‘©ğŸ¿\u200dğŸ“', 'ğŸ‡ºğŸ‡²', 'ğŸ—‚', 'ğŸ‘¨ğŸ¾\u200dâ¤\u200dğŸ‘¨ğŸ»', 'ğŸ§‘\u200dğŸ¤', 'ğŸ§‘\u200dğŸ­', 'ğŸšµ\u200dâ™‚', 'ğŸ™‡ğŸ½\u200dâ™€', 'ğŸ¤·\u200dâ™€ï¸']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.12s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:10,  5.03s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.56s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  2.93s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.55s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 3, 4, 7):   0%|          | 0/100 [00:15<?, ?it/s]2025-01-22 18:14:49.104 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John took the milk there.
2025-01-22 18:14:49.104 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  took the milk there.
2025-01-22 18:14:49.104 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the bathroom.
2025-01-22 18:14:49.120 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2833, 2839) --> . John went back to the
2025-01-22 18:14:49.120 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the garden.
2025-01-22 18:14:49.139 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3615, 3620) --> . John moved to the
2025-01-22 18:14:49.140 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel moved to the bathroom.
2025-01-22 18:14:49.172 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5629, 5634) --> . Daniel moved to the
2025-01-22 18:14:49.172 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel journeyed to the bedroom.
2025-01-22 18:14:49.190 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3458, 3464) --> . Daniel journeyed to the
2025-01-22 18:14:49.190 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the office.
2025-01-22 18:14:49.196 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1121, 1127) --> . Mary journeyed to the
2025-01-22 18:14:49.196 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the kitchen.
2025-01-22 18:14:49.204 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1540, 1546) --> . Sandra went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:14:50.834 | INFO     | test_jbb_embedding:begin_test:693 - there<|eot_id|>
2025-01-22 18:14:50.834 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8123])
2025-01-22 18:14:53.693 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [422.58035714285717, 38.8262406165395, 206.15625, 37.45728097563992, 37.3621826171875], 'topk_indices': array([7977, 4359,   65, 2839, 4333,  104, 8111, 1187,   24, 8119,   33,
       8118,   31,   34,   66,   69,  105,   67,   68,    0]), 'topk_tokens': [' context', 'ot', ' OF', ' bathroom', 'nes', ' P', ' before', 'nes', '\n\n', '<|start_header_id|>', ' milk', '<|eot_id|>', ' took', ' there', ' P', 'ER', 'ION', 'ION', 'E', '<|begin_of_text|>'], 'evidence_proportions': [966.4, 377.8333333333333, 224.225, 130.8125]}, 'weight': {'score': [20.037946428571427, 23.243066238001475, 20.73090277777778, 23.256980725238037, 29.5986328125], 'topk_indices': array([3292, 3319, 3212, 3164, 7350, 7388, 1500, 1438, 4300, 4284, 5174,
       5113, 7065, 7121, 3508, 3482, 4909, 4961, 4932, 4884]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.284375, 20.0703125, 18.88125, 19.909375]}, 'saliency': {'score': [2.3064022972470237, 0.22057145550836052, 1.1292928059895833, 0.21313242595658927, 0.28440221150716144], 'topk_indices': array([4357, 8113, 4266, 8021, 4358, 1167, 7977, 8110, 8111, 4333, 1187,
         66,   31,   69,   34,   33, 2839,   68,  105,   67]), 'topk_tokens': [' Min', ' garden', 'nes', ' location', 'nes', 'nes', ' context', ' milk', ' before', 'nes', 'nes', ' P', ' took', 'ER', ' there', ' milk', ' bathroom', 'E', 'ION', 'ION'], 'evidence_proportions': [5.5390625, 1.9540201822916667, 1.09326171875, 0.7097412109375]}}, 'pred_res': 'there<|eot_id|>', 'score': 0}
2025-01-22 18:14:53.699 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:14:53.699 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-90_pid-0_0-3-4-7.pkl | len: 3 |  size: 1.96 KB
Processing depth (0, 3, 4, 7):   1%|          | 1/100 [00:20<33:57, 20.58s/it]is_0k: False
your chose emoji: ['ğŸ€„', 'âœŠğŸ¿', 'ğŸ™\u200dâ™‚ï¸', 'ğŸ', 'ğŸ³\u200dâš§ï¸', 'ğŸ”‡', 'ğŸšµ\u200dâ™‚ï¸', 'ğŸ§°', 'ğŸ‘ğŸ»', 'ğŸ']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:05<00:15,  5.27s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.22s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.82s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  3.49s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  4.06s/it]
Processing depth (2, 4, 5, 8):   1%|          | 1/100 [00:38<33:57, 20.58s/it]2025-01-22 18:15:11.713 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John took the milk there.
2025-01-22 18:15:11.724 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1879, 1884) --> . John took the milk
2025-01-22 18:15:11.724 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the bathroom.
2025-01-22 18:15:11.747 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3641, 3647) -->  Hon. John went back to
2025-01-22 18:15:11.747 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the garden.
2025-01-22 18:15:11.768 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4165, 4170) --> . John moved to the
2025-01-22 18:15:11.768 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel moved to the bathroom.
2025-01-22 18:15:11.802 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6611, 6616) --> . Daniel moved to the
2025-01-22 18:15:11.802 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel journeyed to the bedroom.
2025-01-22 18:15:11.822 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3516, 3522) -->  Daniel journeyed to the bedroom
2025-01-22 18:15:11.823 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the office.
2025-01-22 18:15:11.829 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1244, 1250) -->  Republican. Mary journeyed to
2025-01-22 18:15:11.830 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the kitchen.
2025-01-22 18:15:11.839 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1738, 1744) --> . Sandra went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:15:12.628 | INFO     | test_jbb_embedding:begin_test:693 - the bathroom<|eot_id|>
2025-01-22 18:15:12.628 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8163])
2025-01-22 18:15:14.885 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [341.7797619047619, 22.29019141868724, 222.86111111111111, 21.02040459271564, 23.694508272058822], 'topk_indices': array([8152, 8017, 8061, 8150, 8146, 3644,   14, 8153, 1884,   24, 1619,
       1883, 8154, 3631, 8161, 3642, 8151, 3648, 8158,    0]), 'topk_tokens': [' the', ' context', ' location', ' milk', ':', ' went', '\n', ' garden', ' there', '\n\n', ' time', ' milk', '?', '.', '<|end_header_id|>', '.', ' before', ' bathroom', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [410.95, 512.6666666666666, 307.475, 101.85]}, 'weight': {'score': [21.37686011904762, 23.271231325006124, 23.58420138888889, 23.275433162606127, 29.437270220588236], 'topk_indices': array([3275, 3302, 3147, 3195, 7394, 7432, 1436, 1498, 4324, 4308, 5119,
       5180, 7171, 7115, 3490, 3464, 4896, 4921, 4944, 4973]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.1, 24.076822916666668, 18.88125, 19.909375]}, 'saliency': {'score': [1.897676013764881, 0.12547926724088446, 1.3858235677083333, 0.11810848723775685, 0.18069861916934743], 'topk_indices': array([1697, 1618, 4170, 3643, 8147, 1739, 8061, 8017, 8154, 1619, 8145,
       1884, 3641, 3644, 8150, 3521, 8153, 1883, 8151, 3648]), 'topk_tokens': [' some', ' some', ' garden', ' John', ' Where', ' Sandra', ' location', ' context', '?', ' time', 'Question', ' there', ' Hon', ' went', ' milk', ' bedroom', ' garden', ' milk', ' before', ' bathroom'], 'evidence_proportions': [2.47705078125, 2.8976236979166665, 1.464453125, 0.5515869140625]}}, 'pred_res': 'the bathroom<|eot_id|>', 'score': 100}
2025-01-22 18:15:14.904 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:15:14.907 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-90_pid-1_2-4-5-8.pkl | len: 3 |  size: 2.0 KB
Processing depth (2, 4, 5, 8):   2%|â–         | 2/100 [00:41<34:12, 20.95s/it]is_0k: False
your chose emoji: ['ğŸ•¹ï¸', 'ğŸ”±', 'ğŸ–', 'ğŸ¤¸ğŸ¼\u200dâ™‚', 'ğŸŒ¤', 'â›¹ğŸ¼\u200dâ™€', 'ğŸ‘¨\u200dğŸ‘©\u200dğŸ‘§\u200dğŸ‘§', 'ğŸ‘·ğŸ¼', 'ğŸ§”\u200dâ™‚ï¸', 'ğŸ¤·ğŸ»\u200dâ™‚ï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.81s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.79s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.59s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  2.95s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.59s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (2, 5, 6, 9):   2%|â–         | 2/100 [00:57<34:12, 20.95s/it]2025-01-22 18:15:31.099 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John took the milk there.
2025-01-22 18:15:31.109 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1855, 1860) --> . John took the milk
2025-01-22 18:15:31.109 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the bathroom.
2025-01-22 18:15:31.130 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4229, 4235) -->  John went back to the bathroom
2025-01-22 18:15:31.130 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the garden.
2025-01-22 18:15:31.158 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4780, 4785) -->  John moved to the garden
2025-01-22 18:15:31.158 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel moved to the bathroom.
2025-01-22 18:15:31.194 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7251, 7256) --> . Daniel moved to the
2025-01-22 18:15:31.195 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel journeyed to the bedroom.
2025-01-22 18:15:31.215 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3567, 3573) --> . Daniel journeyed to the
2025-01-22 18:15:31.215 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the office.
2025-01-22 18:15:31.221 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1220, 1226) -->  Republican. Mary journeyed to
2025-01-22 18:15:31.221 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the kitchen.
2025-01-22 18:15:31.231 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1714, 1720) --> . Sandra went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:15:33.553 | INFO     | test_jbb_embedding:begin_test:693 - the bedroom<|eot_id|>
2025-01-22 18:15:33.554 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8187])
2025-01-22 18:15:36.269 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [192.51339285714286, 15.516887973137973, 141.52256944444446, 14.782618697092381, 22.00294189453125], 'topk_indices': array([8178, 8036, 8168,    9,    4, 8175, 8181, 8186, 8041,    1, 3573,
       8075, 1860, 1859,   24, 4234,   14, 8185,    0, 8182]), 'topk_tokens': ['?', '\n', '.\n\n', ':', '\n\n', ' before', ':', '\n\n', ' context', '<|start_header_id|>', ' bedroom', '.\n\n', ' there', ' milk', '\n\n', ' bathroom', '\n', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [275.825, 279.75, 146.95, 50.08125]}, 'weight': {'score': [22.661458333333332, 23.290655525030527, 22.076822916666668, 23.29495709882223, 29.506640625], 'topk_indices': array([3278, 3251, 3123, 3171, 7430, 7468, 1412, 1474, 4314, 4298, 5218,
       5157, 7201, 7145, 3460, 3434, 4959, 5011, 4982, 4934]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.1, 24.811197916666668, 23.3953125, 19.909375]}, 'saliency': {'score': [1.2389439174107142, 0.08686105357858287, 0.8092854817708334, 0.08229751783475571, 0.16015052795410156], 'topk_indices': array([8178, 8186, 8171, 8184,    8, 8174,   14, 8169, 8177, 8085, 8075,
       8180, 1715,   24, 8175, 1860, 8041, 1859, 3573, 4234]), 'topk_tokens': ['?', '\n\n', ' Where', 'assistant', ' Date', ' milk', '\n', 'Question', ' garden', ' location', '.\n\n', 'Answer', ' Sandra', '\n\n', ' before', ' there', ' context', ' milk', ' bedroom', ' bathroom'], 'evidence_proportions': [1.67744140625, 1.95654296875, 0.913623046875, 0.2646484375]}}, 'pred_res': 'the bedroom<|eot_id|>', 'score': 0}
2025-01-22 18:15:36.284 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:15:36.284 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-90_pid-2_2-5-6-9.pkl | len: 3 |  size: 1.99 KB
Processing depth (2, 5, 6, 9):   3%|â–         | 3/100 [01:03<34:10, 21.14s/it]is_0k: False
your chose emoji: ['ğŸ§™ğŸ¾\u200dâ™€', 'ğŸ§‘ğŸ½\u200dâœˆï¸', 'ğŸš¶ğŸ¾', 'ğŸ‘©ğŸ¾\u200dâ¤ï¸\u200dğŸ‘¨ğŸ½', 'ğŸ‘©ğŸ¾\u200dâ¤\u200dğŸ‘¨ğŸ¿', 'ğŸ¦¸ğŸ¿', 'ğŸ’‡ğŸ¾', 'ğŸ§ğŸ¿\u200dâ™‚', 'ğŸŒ«', 'ğŸ’¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:05<00:15,  5.26s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.92s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.45s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.09s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.71s/it]
Processing depth (0, 3, 6, 9):   3%|â–         | 3/100 [01:19<34:10, 21.14s/it]2025-01-22 18:15:52.904 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John took the milk there.
2025-01-22 18:15:52.905 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  took the milk there.
2025-01-22 18:15:52.905 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the bathroom.
2025-01-22 18:15:52.920 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2889, 2895) --> . John went back to the
2025-01-22 18:15:52.920 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the garden.
2025-01-22 18:15:52.947 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4765, 4770) -->  the senate. John moved
2025-01-22 18:15:52.947 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel moved to the bathroom.
2025-01-22 18:15:52.990 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7192, 7197) --> . Daniel moved to the
2025-01-22 18:15:52.991 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel journeyed to the bedroom.
2025-01-22 18:15:53.011 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3472, 3478) --> . Daniel journeyed to the
2025-01-22 18:15:53.011 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the office.
2025-01-22 18:15:53.016 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1079, 1085) --> . Mary journeyed to the
2025-01-22 18:15:53.016 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the kitchen.
2025-01-22 18:15:53.025 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1548, 1554) --> . Sandra went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:15:54.186 | INFO     | test_jbb_embedding:begin_test:693 - There is no information about the milk before the garden in the given text.<|eot_id|>
2025-01-22 18:15:54.187 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8134])
2025-01-22 18:15:56.398 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [377.0952380952381, 39.14290432591864, 191.15625, 37.928624351691774, 37.611653645833336], 'topk_indices': array([2895,   33, 8121,   14, 1175,   69, 8128,   66, 8122, 8032, 1195,
         24, 8129, 7988,   34,   67, 8130,  105,   68,    0]), 'topk_tokens': [' bathroom', ' milk', ' milk', '\n', 'nes', 'ER', ':', ' P', ' before', ' location', 'nes', '\n\n', '<|eot_id|>', ' context', ' there', 'ION', '<|start_header_id|>', 'ION', 'E', '<|begin_of_text|>'], 'evidence_proportions': [806.8, 307.875, 223.275, 184.275]}, 'weight': {'score': [21.163690476190474, 23.25449144340666, 20.73090277777778, 23.26552273709558, 28.87008101851852], 'topk_indices': array([3306, 3333, 3178, 3226, 7371, 7409, 1508, 1446, 4292, 4308, 5194,
       5133, 7086, 7142, 3522, 3496, 4981, 4952, 4929, 4904]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.284375, 20.0703125, 23.609375, 19.909375]}, 'saliency': {'score': [2.0599888392857144, 0.22124394284018986, 1.0707058376736112, 0.21458748977370956, 0.2400430749963831], 'topk_indices': array([  69,   24,   66, 8127, 1235, 7879, 8116, 8124,   33, 8122, 1175,
       8121, 8032,   34, 2895, 1195, 7988,   68,   67,  105]), 'topk_tokens': ['ER', '\n\n', ' P', 'Answer', 'nes', ' Square', 'Question', ' garden', ' milk', ' before', 'nes', ' milk', ' location', ' there', ' bathroom', 'nes', ' context', 'E', 'ION', 'ION'], 'evidence_proportions': [4.5015625, 1.5892740885416667, 1.315185546875, 0.928076171875]}}, 'pred_res': 'There is no information about the milk before the garden in the given text.<|eot_id|>', 'score': 0}
2025-01-22 18:15:56.430 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:15:56.431 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-90_pid-3_0-3-6-9.pkl | len: 3 |  size: 2.04 KB
Processing depth (0, 3, 6, 9):   4%|â–         | 4/100 [01:23<33:12, 20.75s/it]is_0k: False
your chose emoji: ['ğŸ‘¦ğŸ½', 'ğŸ™ğŸ»\u200dâ™‚ï¸', 'âœ‹ğŸ¿', 'ğŸ’¥', 'ğŸ“µ', 'ğŸ¤µğŸ¾\u200dâ™‚', '#âƒ£', 'ğŸ‘³\u200dâ™€ï¸', 'ğŸ¢', 'ğŸ‘°\u200dâ™‚']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:05<00:15,  5.01s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.94s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.79s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.37s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.92s/it]
Processing depth (0, 2, 5, 8):   4%|â–         | 4/100 [01:40<33:12, 20.75s/it]2025-01-22 18:16:13.872 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John took the milk there.
2025-01-22 18:16:13.873 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  took the milk there.
2025-01-22 18:16:13.873 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the bathroom.
2025-01-22 18:16:13.882 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1746, 1752) -->  John went back to the bathroom
2025-01-22 18:16:13.882 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the garden.
2025-01-22 18:16:13.903 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4200, 4205) -->  John moved to the garden
2025-01-22 18:16:13.903 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel moved to the bathroom.
2025-01-22 18:16:13.936 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6499, 6504) --> . Daniel moved to the
2025-01-22 18:16:13.936 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel journeyed to the bedroom.
2025-01-22 18:16:13.954 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3494, 3500) --> . Daniel journeyed to the
2025-01-22 18:16:13.954 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the office.
2025-01-22 18:16:13.960 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1119, 1125) --> . Mary journeyed to the
2025-01-22 18:16:13.960 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the kitchen.
2025-01-22 18:16:13.968 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1574, 1580) --> . Sandra went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:16:15.135 | INFO     | test_jbb_embedding:begin_test:693 - There is no information about the milk before the garden in the given text.<|eot_id|>
2025-01-22 18:16:15.135 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8133])
2025-01-22 18:16:17.408 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [399.6845238095238, 36.08412456981318, 236.78472222222223, 34.69494102754106, 22.819833431603772], 'topk_indices': array([8031,   65, 5942,   24, 8121, 7987,   69, 7325, 1580, 5944, 6073,
         34, 8128, 6079,   66,   67, 6080,  105,   68,    0]), 'topk_tokens': [' location', ' OF', '\n', '\n\n', ' before', ' context', 'ER', 'nes', ' kitchen', ' way', ' the', ' there', '<|eot_id|>', '\n', ' P', 'ION', 'the', 'ION', 'E', '<|begin_of_text|>'], 'evidence_proportions': [748.35, 411.125, 313.375, 123.6]}, 'weight': {'score': [22.467261904761905, 23.251267514749262, 20.73090277777778, 23.258903760652093, 29.628537735849058], 'topk_indices': array([3303, 3276, 3148, 3196, 7410, 7372, 1492, 1430, 4292, 4276, 5119,
       5180, 7093, 7149, 3459, 3485, 4944, 4921, 4896, 4973]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.284375, 24.811197916666668, 23.3953125, 19.909375]}, 'saliency': {'score': [2.4237293061755953, 0.2038086597663932, 1.2763536241319444, 0.19566686120727583, 0.17131244011645047], 'topk_indices': array([  31, 8123, 5937, 8120,   63, 8121, 8031,   64,   33, 7987, 5944,
         34, 7325, 1751,   66, 1580, 6080,   68,   67,  105]), 'topk_tokens': [' took', ' garden', ' people', ' milk', 'ISC', ' before', ' location', 'ENCES', ' milk', ' context', ' way', ' there', 'nes', ' bathroom', ' P', ' kitchen', 'the', 'E', 'ION', 'ION'], 'evidence_proportions': [4.2232421875, 2.7952473958333335, 1.9591796875, 0.6429443359375]}}, 'pred_res': 'There is no information about the milk before the garden in the given text.<|eot_id|>', 'score': 0}
2025-01-22 18:16:17.415 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:16:17.416 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-90_pid-4_0-2-5-8.pkl | len: 3 |  size: 2.02 KB
Processing depth (0, 2, 5, 8):   5%|â–Œ         | 5/100 [01:44<32:59, 20.83s/it]Processing depth (0, 2, 5, 8):   5%|â–Œ         | 5/100 [01:44<33:02, 20.87s/it]
2025-01-22 18:16:17.484 | INFO     | __main__:<module>:82 - Selected idx: 92
2025-01-22 18:16:17.484 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the milk before the bedroom? 
2025-01-22 18:16:17.484 | INFO     | __main__:<module>:84 - Answer: office
2025-01-22 18:16:17.485 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 18:16:17.485 | INFO     | __main__:<module>:86 - Needle: [' Sandra got the milk there.', ' Sandra went back to the kitchen.', ' John picked up the milk.', ' Daniel journeyed to the bedroom.', ' John went back to the office.', ' Sandra took the milk.', ' Sandra put down the milk there.', ' John travelled to the bedroom.', ' Mary journeyed to the office.']
2025-01-22 18:16:17.485 | INFO     | __main__:<module>:87 - Real Needle: [' John picked up the milk.', ' John went back to the office.', ' John travelled to the bedroom.', ' Mary journeyed to the office.']
2025-01-22 18:16:17.485 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ‘', 'ğŸ¦', 'ğŸŠğŸ¼\u200dâ™‚', 'ğŸ”', 'ğŸ‘¨ğŸ¿\u200dğŸš’', 'ğŸ”²', 'ğŸ’½', 'ğŸï¸', 'ğŸ¤¼\u200dâ™€ï¸', 'ğŸ‹ğŸ»\u200dâ™‚ï¸']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  3.94s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.61s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.83s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.40s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.83s/it]
Processing depth (1, 4, 5, 7):   0%|          | 0/100 [00:16<?, ?it/s]2025-01-22 18:16:34.670 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John picked up the milk.
2025-01-22 18:16:34.675 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (895, 900) --> . John picked up the
2025-01-22 18:16:34.675 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the office.
2025-01-22 18:16:34.697 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3626, 3632) -->  Hon. John went back to
2025-01-22 18:16:34.697 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the bedroom.
2025-01-22 18:16:34.728 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4218, 4223) -->  John travelled to the bedroom
2025-01-22 18:16:34.728 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary journeyed to the office.
2025-01-22 18:16:34.759 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5719, 5725) --> . Mary journeyed to the
2025-01-22 18:16:34.759 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra got the milk there.
2025-01-22 18:16:34.798 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6631, 6636) --> . Sandra got the milk
2025-01-22 18:16:34.798 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the kitchen.
2025-01-22 18:16:34.819 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4144, 4150) --> . Sandra went back to the
2025-01-22 18:16:34.820 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel journeyed to the bedroom.
2025-01-22 18:16:34.852 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6450, 6456) --> . Daniel journeyed to the
2025-01-22 18:16:34.852 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra took the milk.
2025-01-22 18:16:34.872 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3549, 3553) -->  Sandra took the milk
2025-01-22 18:16:34.872 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra put down the milk there.
2025-01-22 18:16:34.883 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1811, 1817) --> . Sandra put down the milk
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:16:35.679 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 18:16:35.679 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8155])
2025-01-22 18:16:37.900 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [487.8806818181818, 49.53052592865024, 445.5462962962963, 47.02236988159842, 33.97986260775862], 'topk_indices': array([3629,    1, 8154, 4343, 8140, 8145, 1817, 8043, 4369, 8009,   24,
       8142,  901, 3633,   14, 8143, 8153, 8151,    0, 8150]), 'topk_tokens': [' went', '<|start_header_id|>', '\n\n', 'nes', ' was', ' bedroom', ' there', '.\n\n', 'ot', ' context', '\n\n', ' milk', '.', ' office', '\n', ' before', '<|end_header_id|>', '<|start_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [599.4, 747.25, 323.575, 272.5]}, 'weight': {'score': [22.660511363636363, 23.26121735932328, 23.499131944444443, 23.262055030525406, 29.513200431034484], 'topk_indices': array([3284, 3311, 3204, 3156, 7434, 7396, 1435, 1497, 4310, 4294, 5113,
       5174, 7151, 7095, 3467, 3493, 4959, 4882, 4907, 4930]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.334375, 24.076822916666668, 25.4171875, 20.052083333333332]}, 'saliency': {'score': [2.803555575284091, 0.2769299350825978, 2.7867296006944446, 0.26171652178018623, 0.25149273050242454], 'topk_indices': array([4367, 1816, 8043, 4150, 8053, 8140, 8137, 4369, 8139, 1817, 4368,
       3629, 4343,  900, 8009, 1812, 8145, 8142, 8143, 3633]), 'topk_tokens': [' Min', ' milk', '.\n\n', ' kitchen', ' location', ' was', 'Question', 'ot', ' Where', ' there', 'nes', ' went', 'nes', ' milk', ' context', ' Sandra', ' bedroom', ' milk', ' before', ' office'], 'evidence_proportions': [3.1630859375, 4.2119140625, 2.25693359375, 1.5511067708333333]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 0}
2025-01-22 18:16:37.906 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:16:37.907 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-92_pid-0_1-4-5-7.pkl | len: 3 |  size: 2.02 KB
Processing depth (1, 4, 5, 7):   1%|          | 1/100 [00:20<33:29, 20.30s/it]is_0k: False
your chose emoji: ['ğŸ‡¨ğŸ‡¦', '9âƒ£', 'ğŸ‘©ğŸ¾\u200dâ¤\u200dğŸ‘©ğŸ¿', 'ğŸ’ƒ', 'ğŸš¶ğŸ»\u200dâ™€\u200dâ¡', 'âŒ', 'ğŸ‘±ğŸ½', 'ğŸ¥»', 'ğŸ‹\u200dâ™€ï¸', 'ğŸ‘†']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  3.75s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.22s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.38s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.08s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.49s/it]
Processing depth (2, 5, 6, 7):   1%|          | 1/100 [00:35<33:29, 20.30s/it]2025-01-22 18:16:53.534 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John picked up the milk.
2025-01-22 18:16:53.544 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1841, 1846) --> . John picked up the
2025-01-22 18:16:53.544 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the office.
2025-01-22 18:16:53.570 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4258, 4264) --> . John went back to the
2025-01-22 18:16:53.570 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the bedroom.
2025-01-22 18:16:53.594 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4899, 4904) --> . John travelled to the
2025-01-22 18:16:53.594 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary journeyed to the office.
2025-01-22 18:16:53.625 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5717, 5723) --> . Mary journeyed to the
2025-01-22 18:16:53.625 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra got the milk there.
2025-01-22 18:16:53.660 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6609, 6614) --> . Sandra got the milk
2025-01-22 18:16:53.660 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the kitchen.
2025-01-22 18:16:53.682 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4210, 4216) -->  Sandra went back to the kitchen
2025-01-22 18:16:53.682 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel journeyed to the bedroom.
2025-01-22 18:16:53.719 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6422, 6428) --> . Daniel journeyed to the
2025-01-22 18:16:53.719 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra took the milk.
2025-01-22 18:16:53.736 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3589, 3593) -->  Sandra took the milk
2025-01-22 18:16:53.737 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra put down the milk there.
2025-01-22 18:16:53.746 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1845, 1851) -->  the milk. Sandra put down
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:16:54.493 | INFO     | test_jbb_embedding:begin_test:693 - the kitchen<|eot_id|>
2025-01-22 18:16:54.493 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8159])
2025-01-22 18:16:56.711 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [532.7443181818181, 48.6137230425193, 441.27314814814815, 45.993817030325445, 26.059375], 'topk_indices': array([8146, 7612, 7617, 1847, 8047,    9, 8158, 8153, 8057, 5720, 8147,
         24, 5719, 5718,   14, 8157, 7621, 8155,    0, 8154]), 'topk_tokens': [' milk', ' tele', ' set', '.', '.\n\n', ':', '\n\n', ':', ' location', 'ed', ' before', '\n\n', ' journey', ' Mary', '\n', '<|end_header_id|>', ' or', '<|start_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [422.5, 388.9166666666667, 360.45, 912.0208333333334]}, 'weight': {'score': [20.334517045454547, 23.250984101213085, 24.38599537037037, 23.255115877712033, 28.608854166666667], 'topk_indices': array([3299, 3272, 3144, 3192, 7438, 7400, 1405, 1467, 4270, 4286, 5099,
       5160, 7101, 7157, 3455, 3481, 4870, 4953, 4895, 4924]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.334375, 20.0703125, 19.990625, 20.052083333333332]}, 'saliency': {'score': [2.986794211647727, 0.27185155819216394, 2.792842158564815, 0.25609767695620683, 0.19030914306640626], 'topk_indices': array([8156, 7611, 7620, 7567,    0, 7572,   24, 7617, 4215, 8152, 7568,
       8146, 8057, 1848, 8149, 7612, 8147, 7621, 5719, 5718]), 'topk_tokens': ['assistant', ' bogus', ' two', ' tele', '<|begin_of_text|>', ' set', '\n\n', ' set', ' kitchen', 'Answer', 'graph', ' milk', ' location', ' Sandra', ' bedroom', ' tele', ' before', ' or', ' journey', ' Mary'], 'evidence_proportions': [2.2064453125, 1.8612467447916667, 2.04013671875, 5.551513671875]}}, 'pred_res': 'the kitchen<|eot_id|>', 'score': 0}
2025-01-22 18:16:56.718 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:16:56.719 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-92_pid-1_2-5-6-7.pkl | len: 3 |  size: 2.01 KB
Processing depth (2, 5, 6, 7):   2%|â–         | 2/100 [00:39<31:43, 19.43s/it]is_0k: False
your chose emoji: ['ğŸš‡', 'ğŸ‘¨ğŸ½\u200dğŸ¦¯\u200dâ¡ï¸', 'ğŸ¤™ğŸ»', 'ğŸ‘¨ğŸ¿\u200dâš•', 'ğŸ‘£', 'ğŸ¤²ğŸ½', 'ğŸš³', 'ğŸ§‘ğŸ¾\u200dğŸ’»', 'ğŸ“¡', 'ğŸ—']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.68s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.81s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.40s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.81s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.47s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 4, 5, 8):   2%|â–         | 2/100 [00:54<31:43, 19.43s/it]2025-01-22 18:17:12.447 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John picked up the milk.
2025-01-22 18:17:12.448 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the milk.
2025-01-22 18:17:12.448 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the office.
2025-01-22 18:17:12.470 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3603, 3609) --> . John went back to the
2025-01-22 18:17:12.470 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the bedroom.
2025-01-22 18:17:12.493 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4177, 4182) --> . John travelled to the
2025-01-22 18:17:12.493 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary journeyed to the office.
2025-01-22 18:17:12.533 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6552, 6558) --> . Mary journeyed to the
2025-01-22 18:17:12.533 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra got the milk there.
2025-01-22 18:17:12.574 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6559, 6564) --> . Sandra got the milk
2025-01-22 18:17:12.575 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the kitchen.
2025-01-22 18:17:12.600 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4124, 4130) --> . Sandra went back to the
2025-01-22 18:17:12.600 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel journeyed to the bedroom.
2025-01-22 18:17:12.635 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6435, 6441) --> . Daniel journeyed to the
2025-01-22 18:17:12.635 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra took the milk.
2025-01-22 18:17:12.656 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3501, 3505) -->  Sandra took the milk
2025-01-22 18:17:12.657 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra put down the milk there.
2025-01-22 18:17:12.667 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1603, 1609) --> . Sandra put down the milk
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:17:14.963 | INFO     | test_jbb_embedding:begin_test:693 - the office<|eot_id|>
2025-01-22 18:17:14.963 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8237])
2025-01-22 18:17:17.655 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [197.9431818181818, 23.540660274305136, 175.80324074074073, 22.570215201465203, 28.595604482323232], 'topk_indices': array([ 293,   25,    4, 8231, 8218,    9,   23, 8125,   97, 8225, 8236,
          1,   98,  135,   24, 8233,   14, 8235,    0, 8232]), 'topk_tokens': ['hue', '<|eot_id|>', '\n\n', ':', '.\n\n', ':', '4', '.\n\n', 'ION', ' before', '\n\n', '<|start_header_id|>', 'E', 'ION', '\n\n', '<|start_header_id|>', '\n', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [209.025, 173.23958333333334, 147.8625, 255.14583333333334]}, 'weight': {'score': [20.491477272727273, 23.31742892037869, 23.499131944444443, 23.32442097832723, 29.251420454545453], 'topk_indices': array([3334, 3361, 3254, 3206, 7500, 7462, 1501, 1563, 4348, 4364, 5163,
       5224, 7149, 7205, 3522, 3548, 4965, 4940, 5017, 4988]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.025, 20.0703125, 19.990625, 20.052083333333332]}, 'saliency': {'score': [0.9709694602272727, 0.12972525749294514, 1.0116102430555556, 0.12455819191659036, 0.211378463590988], 'topk_indices': array([  20, 8206, 8221,   23,    8,    0, 8125,   14, 8219, 8236, 8234,
         24, 8224, 8230,   98,  293, 8227,   97, 8225,  135]), 'topk_tokens': [' Jul', ' return', ' Where', '4', ' Date', '<|begin_of_text|>', '.\n\n', '\n', 'Question', '\n\n', 'assistant', '\n\n', ' milk', 'Answer', 'E', 'hue', ' bedroom', 'ION', ' before', 'ION'], 'evidence_proportions': [1.0630859375, 0.861572265625, 0.7390625, 1.1968587239583333]}}, 'pred_res': 'the office<|eot_id|>', 'score': 100}
2025-01-22 18:17:17.675 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:17:17.675 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-92_pid-2_0-4-5-8.pkl | len: 3 |  size: 1.98 KB
Processing depth (0, 4, 5, 8):   3%|â–         | 3/100 [01:00<32:32, 20.12s/it]is_0k: False
your chose emoji: ['ğŸ‘©ğŸ¼\u200dâ¤\u200dğŸ‘©ğŸ¿', 'ğŸ‡¦ğŸ‡¼', 'ğŸ§¶', 'ğŸ§‘ğŸ¼\u200dğŸ¤\u200dğŸ§‘ğŸ¿', 'ğŸ‘¨ğŸ½\u200dâœˆï¸', 'ğŸ¦¶ğŸ¿', 'ğŸ‘·ğŸ¼\u200dâ™‚ï¸', 'â†•', 'ğŸ‘©ğŸ¼\u200dğŸ¦½\u200dâ¡ï¸', 'ğŸ§‘ğŸ»\u200dğŸ¤\u200dğŸ§‘ğŸ¾']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:05<00:16,  5.37s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.11s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.86s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.39s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  4.00s/it]
Processing depth (4, 7, 8, 9):   3%|â–         | 3/100 [01:17<32:32, 20.12s/it]2025-01-22 18:17:35.426 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John picked up the milk.
2025-01-22 18:17:35.446 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3563, 3568) --> . John picked up the
2025-01-22 18:17:35.447 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the office.
2025-01-22 18:17:35.480 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5562, 5568) --> . John went back to the
2025-01-22 18:17:35.481 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the bedroom.
2025-01-22 18:17:35.515 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6482, 6487) --> . John travelled to the
2025-01-22 18:17:35.515 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary journeyed to the office.
2025-01-22 18:17:35.565 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7117, 7123) -->  Mary journeyed to the office
2025-01-22 18:17:35.565 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra got the milk there.
2025-01-22 18:17:35.601 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6488, 6493) --> . Sandra got the milk
2025-01-22 18:17:35.602 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the kitchen.
2025-01-22 18:17:35.632 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4061, 4067) --> . Sandra went back to the
2025-01-22 18:17:35.632 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel journeyed to the bedroom.
2025-01-22 18:17:35.669 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6311, 6317) --> . Daniel journeyed to the
2025-01-22 18:17:35.670 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra took the milk.
2025-01-22 18:17:35.689 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3461, 3465) -->  Sandra took the milk
2025-01-22 18:17:35.689 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra put down the milk there.
2025-01-22 18:17:35.702 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1781, 1787) --> . Sandra put down the milk
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:17:36.504 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 18:17:36.504 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8177])
2025-01-22 18:17:38.733 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [429.1136363636364, 58.116559940090475, 594.925925925926, 55.3298700799508, 63.987828351449274], 'topk_indices': array([1751, 5925, 5907,    1, 1786, 1782, 5926, 6317, 8167, 6062, 5927,
       8175, 1787, 8165,   24,   14, 6063, 8172,    0, 8173]), 'topk_tokens': [' The', ',', 'ayers', '<|start_header_id|>', ' milk', ' Sandra', ' in', ' bedroom', ' bedroom', ',', ' which', '<|end_header_id|>', ' there', ' before', '\n\n', '\n', ' in', '<|eot_id|>', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [413.6, 305.0833333333333, 428.5, 566.5833333333334]}, 'weight': {'score': [21.246803977272727, 23.284004768309085, 23.499131944444443, 23.288803044280442, 29.86707427536232], 'topk_indices': array([3321, 3294, 3160, 3208, 7446, 7408, 1409, 1471, 4329, 4313, 5144,
       5205, 7129, 7185, 3482, 3508, 4969, 4946, 4921, 4998]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.334375, 20.0703125, 19.990625, 23.397135416666668]}, 'saliency': {'score': [2.4284556995738638, 0.3254755414017606, 3.7244466145833335, 0.3084967243715406, 0.4658172165138134], 'topk_indices': array([  35,   24, 8170, 8075, 1784, 1783, 4067, 7122, 3461, 3464, 8164,
       5927, 1787, 5907, 6487, 8165, 1786, 8167, 6317, 1782]), 'topk_tokens': ['-text', '\n\n', 'Answer', ' location', ' down', ' put', ' kitchen', ' office', ' Sandra', ' milk', ' milk', ' which', ' there', 'ayers', ' bedroom', ' before', ' milk', ' bedroom', ' bedroom', ' Sandra'], 'evidence_proportions': [2.2732421875, 1.6923421223958333, 2.22763671875, 3.4612630208333335]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 0}
2025-01-22 18:17:38.741 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:17:38.741 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-92_pid-3_4-7-8-9.pkl | len: 3 |  size: 2.03 KB
Processing depth (4, 7, 8, 9):   4%|â–         | 4/100 [01:21<32:47, 20.50s/it]is_0k: False
your chose emoji: ['ğŸƒ', 'ğŸ˜®\u200dğŸ’¨', 'ğŸ§‡', 'ğŸ§ğŸ»\u200dâ™€', 'ğŸ‘©ğŸ½\u200dğŸŒ¾', '\U0001fa87', 'ğŸšï¸', 'ğŸ§‘ğŸ¿\u200dâ¤ï¸\u200dğŸ§‘ğŸ¼', 'ğŸ’', 'ğŸƒğŸ¼\u200dâ™‚ï¸\u200dâ¡ï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.90s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.91s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.99s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.39s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.96s/it]
Processing depth (2, 4, 5, 8):   4%|â–         | 4/100 [01:39<32:47, 20.50s/it]2025-01-22 18:17:56.771 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John picked up the milk.
2025-01-22 18:17:56.780 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1775, 1780) --> . John picked up the
2025-01-22 18:17:56.780 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the office.
2025-01-22 18:17:56.798 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3598, 3604) -->  Hon. John went back to
2025-01-22 18:17:56.799 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the bedroom.
2025-01-22 18:17:56.827 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4208, 4213) -->  John travelled to the bedroom
2025-01-22 18:17:56.828 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary journeyed to the office.
2025-01-22 18:17:56.866 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6646, 6652) --> . Mary journeyed to the
2025-01-22 18:17:56.866 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra got the milk there.
2025-01-22 18:17:56.905 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6653, 6658) --> . Sandra got the milk
2025-01-22 18:17:56.905 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the kitchen.
2025-01-22 18:17:56.929 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4177, 4183) -->  Sandra went back to the kitchen
2025-01-22 18:17:56.929 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel journeyed to the bedroom.
2025-01-22 18:17:56.966 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6549, 6555) --> . Daniel journeyed to the
2025-01-22 18:17:56.966 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra took the milk.
2025-01-22 18:17:56.985 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3521, 3525) -->  Sandra took the milk
2025-01-22 18:17:56.985 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra put down the milk there.
2025-01-22 18:17:56.994 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1779, 1785) -->  the milk. Sandra put down
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:17:57.793 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 18:17:57.794 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8143])
2025-01-22 18:18:00.014 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [232.94886363636363, 27.687306246163292, 324.625, 26.13924893465909, 23.325045072115383], 'topk_indices': array([1781, 8124, 8134,    9, 8137, 4193,    1,   23, 8031, 4191, 8130,
       4190, 8142,   24, 8131,   14, 8141,    0, 8139, 8138]), 'topk_tokens': ['.', '.\n\n', '?', ':', ':', 'outs', '<|start_header_id|>', '4', '.\n\n', 'ch', ' milk', 'ree', '\n\n', '\n\n', ' before', '\n', '<|end_header_id|>', '<|begin_of_text|>', '<|start_header_id|>', '<|eot_id|>'], 'evidence_proportions': [271.2, 242.11458333333334, 187.8625, 229.47916666666666]}, 'weight': {'score': [22.660511363636363, 23.245035297728666, 24.38599537037037, 23.24281859869071, 28.967247596153847], 'topk_indices': array([3283, 3256, 3176, 3128, 7350, 7388, 1411, 1473, 4276, 4260, 5132,
       5071, 7127, 7071, 3465, 3439, 4925, 4896, 4873, 4848]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.334375, 24.076822916666668, 25.4171875, 20.052083333333332]}, 'saliency': {'score': [1.3439719460227273, 0.151934660834868, 2.021990740740741, 0.1424588290127841, 0.16979833749624398], 'topk_indices': array([8134,    8,   23, 8031, 8041, 8127, 6657, 8125, 8142, 1782, 4202,
       8140, 4191,   24, 8136, 8133, 4193, 8131, 8130, 4190]), 'topk_tokens': ['?', ' Date', '4', '.\n\n', ' location', ' Where', ' milk', 'Question', '\n\n', ' Sandra', 'ree', 'assistant', 'ch', '\n\n', 'Answer', ' bedroom', 'outs', ' before', ' milk', 'ree'], 'evidence_proportions': [1.483203125, 1.4110514322916667, 1.300390625, 1.1971842447916667]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 0}
2025-01-22 18:18:00.023 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:18:00.023 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-92_pid-4_2-4-5-8.pkl | len: 3 |  size: 1.97 KB
Processing depth (2, 4, 5, 8):   5%|â–Œ         | 5/100 [01:42<32:54, 20.78s/it]Processing depth (2, 4, 5, 8):   5%|â–Œ         | 5/100 [01:42<32:27, 20.49s/it]
2025-01-22 18:18:00.079 | INFO     | __main__:<module>:82 - Selected idx: 94
2025-01-22 18:18:00.079 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the football before the hallway? 
2025-01-22 18:18:00.079 | INFO     | __main__:<module>:84 - Answer: garden
2025-01-22 18:18:00.080 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 18:18:00.080 | INFO     | __main__:<module>:86 - Needle: [' Daniel got the football.', ' Mary journeyed to the kitchen.', ' Sandra went back to the kitchen.', ' Mary journeyed to the office.', ' Daniel went back to the garden.', ' John went back to the hallway.', ' Daniel went to the hallway.', ' Mary journeyed to the office.']
2025-01-22 18:18:00.080 | INFO     | __main__:<module>:87 - Real Needle: [' Daniel got the football.', ' Daniel went back to the garden.', ' Daniel went to the hallway.', ' Mary journeyed to the office.']
2025-01-22 18:18:00.080 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸšµğŸ»\u200dâ™‚', 'ğŸš‡', 'ğŸ¦¥', 'ğŸ§‘ğŸ½\u200dğŸ³', 'ğŸ¦£', 'ğŸ§\u200dâ™€', 'ğŸ“¥', 'ğŸ§‡', 'ğŸ', 'ğŸ‘©ğŸ½\u200dğŸ¦±']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.12s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.20s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.18s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.72s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.26s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (3, 6, 8, 9):   0%|          | 0/100 [00:14<?, ?it/s]2025-01-22 18:18:14.970 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the football.
2025-01-22 18:18:14.984 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2841, 2845) -->  Daniel got the football
2025-01-22 18:18:14.984 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went back to the garden.
2025-01-22 18:18:15.011 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4779, 4785) -->  the senate. Daniel went back
2025-01-22 18:18:15.012 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the hallway.
2025-01-22 18:18:15.040 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4779, 4784) -->  the senate. Daniel went
2025-01-22 18:18:15.040 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary journeyed to the office.
2025-01-22 18:18:15.053 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2483, 2489) --> . Mary journeyed to the
2025-01-22 18:18:15.053 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the kitchen.
2025-01-22 18:18:15.067 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2483, 2489) --> . Mary journeyed to the
2025-01-22 18:18:15.067 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the kitchen.
2025-01-22 18:18:15.110 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6914, 6920) --> . Sandra went back to the
2025-01-22 18:18:15.110 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the hallway.
2025-01-22 18:18:15.150 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6631, 6637) -->  to the hallway. Senator John
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:18:18.575 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's house.<|eot_id|>
2025-01-22 18:18:18.575 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8227])
2025-01-22 18:18:21.324 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [305.13392857142856, 22.005716509720536, 172.703125, 20.94867270479795, 23.7258203125], 'topk_indices': array([  23, 2842, 2843, 8226, 2490, 2841,    9, 8115, 2848, 2849, 8125,
         24, 2844, 4787, 2845,   14, 8223, 8225, 8222,    0]), 'topk_tokens': ['4', ' got', ' the', '\n\n', '.', ' Daniel', ':', '.\n\n', ' *', '      ', ' location', '\n\n', ' football', ' garden', '.', '\n', '<|start_header_id|>', '<|end_header_id|>', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [618.75, 199.640625, 170.66875, 313.6041666666667]}, 'weight': {'score': [23.7734375, 23.32802247873633, 21.77690972222222, 23.33028915120254, 29.7109375], 'topk_indices': array([3333, 3360, 3253, 3205, 7420, 7458, 1413, 1475, 4312, 4328, 5211,
       5150, 7134, 7190, 3542, 3516, 5004, 4975, 4932, 4907]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.939453125, 24.8671875, 24.39375, 20.052083333333332]}, 'saliency': {'score': [1.916352771577381, 0.12301195962750608, 0.9592352973090278, 0.1165765821242446, 0.17911453247070314], 'topk_indices': array([   8, 2485, 2847, 8209, 6633, 8115, 2489,   24, 8215, 8081, 8196,
       2842, 8214, 2848, 2849, 8217, 8125, 2841, 4787, 2844]), 'topk_tokens': [' Date', ' journey', '      ', 'Question', ' hallway', '.\n\n', ' kitchen', '\n\n', ' before', ' context', ' return', ' got', ' football', ' *', '      ', ' hallway', ' location', ' Daniel', ' garden', ' football'], 'evidence_proportions': [4.301513671875, 1.3069254557291667, 1.085498046875, 1.6280517578125]}}, 'pred_res': "Daniel's house.<|eot_id|>", 'score': 0}
2025-01-22 18:18:21.347 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:18:21.347 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-94_pid-0_3-6-8-9.pkl | len: 3 |  size: 2.02 KB
Processing depth (3, 6, 8, 9):   1%|          | 1/100 [00:21<34:56, 21.17s/it]is_0k: False
your chose emoji: ['ğŸ•µï¸\u200dâ™‚ï¸', 'ğŸ§‘ğŸ¼\u200dğŸ¦²', 'ğŸ§‘ğŸ½\u200dâ¤\u200dğŸ’‹\u200dğŸ§‘ğŸ¾', 'ğŸ§™ğŸ¼\u200dâ™‚ï¸', 'ğŸ“¹', 'ğŸ»\u200dâ„ï¸', 'ğŸ‘©\u200dâ¤\u200dğŸ’‹\u200dğŸ‘©', 'ğŸ‘‚ğŸ¼', 'ğŸ‘©ğŸ¿\u200dğŸ’»', 'ğŸ‘©ğŸ¼\u200dğŸ¤\u200dğŸ‘¨ğŸ½']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.43s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.51s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.39s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.04s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.55s/it]
Processing depth (0, 1, 3, 8):   1%|          | 1/100 [00:37<34:56, 21.17s/it]2025-01-22 18:18:37.331 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the football.
2025-01-22 18:18:37.374 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went back to the garden.
2025-01-22 18:18:37.379 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (777, 783) -->  Daniel went back to the garden
2025-01-22 18:18:37.380 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the hallway.
2025-01-22 18:18:37.396 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2880, 2885) --> . Daniel went to the
2025-01-22 18:18:37.397 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary journeyed to the office.
2025-01-22 18:18:37.410 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2405, 2411) --> . Mary journeyed to the
2025-01-22 18:18:37.410 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the kitchen.
2025-01-22 18:18:37.427 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2405, 2411) --> . Mary journeyed to the
2025-01-22 18:18:37.427 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the kitchen.
2025-01-22 18:18:37.465 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6813, 6819) --> . Sandra went back to the
2025-01-22 18:18:37.465 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the hallway.
2025-01-22 18:18:37.506 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (7000, 7006) --> . John went back to the
2025-01-22 18:18:37.506 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 18:18:37.506 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 18:18:37.506 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 18:18:37.506 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ•‹', 'ğŸ§‘ğŸ½\u200dâ¤\u200dğŸ’‹\u200dğŸ§‘ğŸ»', 'ğŸ§‘ğŸ»\u200dâ¤\u200dğŸ§‘ğŸ¼', 'ğŸ§‘ğŸ¾\u200dâ¤\u200dğŸ’‹\u200dğŸ§‘ğŸ½', 'ğŸ‘©ğŸ¼\u200dâœˆ', 'ğŸ’“', 'â›¹\u200dâ™€ï¸', 'ğŸ–ï¸', 'ğŸ’‚\u200dâ™‚ï¸', 'âœğŸ»']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.72s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.87s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.87s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.34s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.89s/it]
Processing depth (6, 7, 8, 9):   1%|          | 1/100 [00:54<34:56, 21.17s/it]2025-01-22 18:18:54.896 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the football.
2025-01-22 18:18:54.920 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4837, 4841) -->  Daniel got the football
2025-01-22 18:18:54.920 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went back to the garden.
2025-01-22 18:18:54.948 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5623, 5629) --> . Daniel went back to the
2025-01-22 18:18:54.949 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the hallway.
2025-01-22 18:18:54.980 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5624, 5629) -->  Daniel went back to the
2025-01-22 18:18:54.981 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary journeyed to the office.
2025-01-22 18:18:54.994 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2493, 2499) --> . Mary journeyed to the
2025-01-22 18:18:54.994 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the kitchen.
2025-01-22 18:18:55.009 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2493, 2499) --> . Mary journeyed to the
2025-01-22 18:18:55.009 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the kitchen.
2025-01-22 18:18:55.047 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6888, 6894) --> . Sandra went back to the
2025-01-22 18:18:55.048 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the hallway.
2025-01-22 18:18:55.085 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (7035, 7041) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:18:55.817 | INFO     | test_jbb_embedding:begin_test:693 - Daniel<|eot_id|>
2025-01-22 18:18:55.818 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8139])
2025-01-22 18:18:58.051 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [557.8095238095239, 26.55156902480963, 190.73784722222223, 24.81002020856473, 37.910853794642854], 'topk_indices': array([8138, 6611, 8135, 8037,   24, 8134, 2496, 4838,   14, 4843, 8137,
       6608, 4841, 5629, 5624, 6609, 6610, 4837, 4840,    0]), 'topk_tokens': ['\n\n', ' hallway', '<|start_header_id|>', ' location', '\n\n', '<|eot_id|>', 'ed', ' got', '\n', 'ï¿½', '<|end_header_id|>', ' went', '.', ' garden', ' Daniel', ' to', ' the', ' Daniel', ' football', '<|begin_of_text|>'], 'evidence_proportions': [915.75, 522.7083333333334, 513.85, 390.9166666666667]}, 'weight': {'score': [22.359375, 23.253298866985997, 20.6640625, 23.261367317660127, 29.293805803571427], 'topk_indices': array([3244, 3271, 3116, 3164, 7410, 7372, 1473, 1411, 4229, 4245, 5107,
       5168, 7086, 7142, 3427, 3453, 4961, 4884, 4932, 4909]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.939453125, 20.927083333333332, 23.1828125, 20.052083333333332]}, 'saliency': {'score': [3.5968075706845237, 0.1492444804188544, 1.08538818359375, 0.13823011394313833, 0.28093392508370535], 'topk_indices': array([2496, 2494, 5625, 6609, 3583, 7993, 8126, 8037, 6607, 4843, 2495,
       4838, 4842, 8129, 6608, 6611, 5629, 5624, 4837, 4840]), 'topk_tokens': ['ed', ' Mary', ' went', ' to', 'ï¿½', ' context', ' football', ' location', ' Daniel', 'ï¿½', ' journey', ' got', 'ï¿½', ' hallway', ' went', ' hallway', ' garden', ' Daniel', ' Daniel', ' football'], 'evidence_proportions': [6.67138671875, 3.1007486979166665, 3.373828125, 2.2289632161458335]}}, 'pred_res': 'Daniel<|eot_id|>', 'score': 0}
2025-01-22 18:18:58.058 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:18:58.059 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-94_pid-1_6-7-8-9.pkl | len: 3 |  size: 2.01 KB
Processing depth (6, 7, 8, 9):   2%|â–         | 2/100 [00:57<49:30, 30.31s/it]is_0k: False
your chose emoji: ['ğŸ¤˜ğŸ»', 'ğŸ‘¨ğŸ¿\u200dğŸ¦½\u200dâ¡', '\U0001fae7', 'â†©ï¸', 'ğŸ¦\u200dğŸ”¥', 'ğŸ’‚ğŸ½\u200dâ™€ï¸', 'ğŸˆ¯', 'ğŸ›Œ', 'â¤µï¸', 'ğŸ‡µğŸ‡°']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.29s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.31s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.45s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.15s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.60s/it]
Processing depth (0, 1, 3, 9):   2%|â–         | 2/100 [01:14<49:30, 30.31s/it]2025-01-22 18:19:14.418 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the football.
2025-01-22 18:19:14.459 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went back to the garden.
2025-01-22 18:19:14.463 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (900, 906) --> . Daniel went back to the
2025-01-22 18:19:14.464 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the hallway.
2025-01-22 18:19:14.468 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (901, 906) -->  Daniel went back to the
2025-01-22 18:19:14.468 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary journeyed to the office.
2025-01-22 18:19:14.481 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2521, 2527) --> . Mary journeyed to the
2025-01-22 18:19:14.482 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the kitchen.
2025-01-22 18:19:14.496 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2521, 2527) --> . Mary journeyed to the
2025-01-22 18:19:14.496 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the kitchen.
2025-01-22 18:19:14.530 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6776, 6782) --> . Sandra went back to the
2025-01-22 18:19:14.531 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the hallway.
2025-01-22 18:19:14.570 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6963, 6969) --> . John went back to the
2025-01-22 18:19:14.570 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 18:19:14.570 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 18:19:14.570 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 18:19:14.570 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ§‘\u200dğŸ’»', 'ğŸ§\u200dâ™‚', 'ğŸ‘©ğŸ¼\u200dâ¤\u200dğŸ’‹\u200dğŸ‘¨ğŸ¼', 'ğŸ˜', 'ğŸš±', 'ğŸ‘', 'ğŸ¦ƒ', 'ğŸ¥ˆ', 'ğŸ‘†ğŸ»', 'ğŸ‘·ğŸ»']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.68s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.60s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.68s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.27s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.77s/it]
Processing depth (3, 6, 7, 9):   2%|â–         | 2/100 [01:31<49:30, 30.31s/it]2025-01-22 18:19:31.509 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the football.
2025-01-22 18:19:31.524 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2927, 2931) -->  Daniel got the football
2025-01-22 18:19:31.524 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went back to the garden.
2025-01-22 18:19:31.548 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4731, 4737) --> . Daniel went back to the
2025-01-22 18:19:31.548 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the hallway.
2025-01-22 18:19:31.575 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4732, 4737) -->  Daniel went back to the
2025-01-22 18:19:31.575 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary journeyed to the office.
2025-01-22 18:19:31.589 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2497, 2503) --> . Mary journeyed to the
2025-01-22 18:19:31.589 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the kitchen.
2025-01-22 18:19:31.602 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2497, 2503) --> . Mary journeyed to the
2025-01-22 18:19:31.602 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the kitchen.
2025-01-22 18:19:31.638 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6744, 6750) --> . Sandra went back to the
2025-01-22 18:19:31.638 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the hallway.
2025-01-22 18:19:31.676 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6969, 6975) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:19:32.457 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 18:19:32.457 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8187])
2025-01-22 18:19:34.737 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [679.6607142857143, 29.85987103174603, 198.02777777777777, 27.814374769966875, 18.8980224609375], 'topk_indices': array([4732, 4734, 2925, 2897,   23, 4735, 8174, 8041, 2928, 2899,   14,
       8182, 2926, 2929, 2933, 2898, 2931,    0, 4737, 2930]), 'topk_tokens': [' Daniel', ' back', ' Gov', ' Gov', '4', ' to', ' football', ' context', ' got', ' During', '\n', '<|eot_id|>', '.', ' the', 'ible', '.', '.', '<|begin_of_text|>', ' garden', ' football'], 'evidence_proportions': [1183.125, 632.7083333333334, 661.3, 406.2708333333333]}, 'weight': {'score': [22.359375, 23.2948240995116, 20.6640625, 23.303043721629248, 29.6072265625], 'topk_indices': array([3298, 3271, 3191, 3143, 7440, 7478, 1415, 1477, 4334, 4318, 5197,
       5136, 7161, 7217, 3480, 3454, 4990, 4913, 4961, 4938]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.939453125, 20.927083333333332, 23.1828125, 20.052083333333332]}, 'saliency': {'score': [4.068452380952381, 0.16894426916399571, 1.0680745442708333, 0.15691212399168813, 0.14024009704589843], 'topk_indices': array([  23, 2499, 2931, 8085, 8175, 8169, 8177, 2503, 4734, 2927, 4732,
       2928, 2925, 8041, 2899, 8174, 2897, 2933, 4737, 2930]), 'topk_tokens': ['4', ' journey', '.', ' location', ' before', 'Question', ' hallway', ' kitchen', ' back', ' Daniel', ' Daniel', ' got', ' Gov', ' context', ' During', ' football', ' Gov', 'ible', ' garden', ' football'], 'evidence_proportions': [8.20458984375, 3.3758138020833335, 3.793359375, 2.23291015625]}}, 'pred_res': 'The garden.<|eot_id|>', 'score': 100}
2025-01-22 18:19:34.742 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:19:34.742 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-94_pid-2_3-6-7-9.pkl | len: 3 |  size: 1.99 KB
Processing depth (3, 6, 7, 9):   3%|â–         | 3/100 [01:34<53:42, 33.22s/it]is_0k: False
your chose emoji: ['ğŸ­', 'ğŸ§™ğŸ¿\u200dâ™‚', 'ğŸš¶ğŸ¾\u200dâ¡ï¸', 'ğŸ‘¨ğŸ»', 'ğŸ§ğŸ¿\u200dâ™‚ï¸', 'ğŸ‘©ğŸ¿\u200dâ¤\u200dğŸ‘©ğŸ½', 'ğŸ§œğŸ½\u200dâ™‚ï¸', 'ğŸ¤¸ğŸ½\u200dâ™€', 'ğŸ™‡\u200dâ™‚', '\U0001fab9']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.94s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:12<00:12,  6.24s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:16<00:05,  5.50s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:17<00:00,  3.69s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:17<00:00,  4.41s/it]
Processing depth (0, 2, 3, 5):   3%|â–         | 3/100 [01:54<53:42, 33.22s/it]2025-01-22 18:19:54.415 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the football.
2025-01-22 18:19:54.455 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went back to the garden.
2025-01-22 18:19:54.464 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1730, 1736) --> . Daniel went back to the
2025-01-22 18:19:54.464 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the hallway.
2025-01-22 18:19:54.473 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1731, 1736) -->  Daniel went back to the
2025-01-22 18:19:54.473 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary journeyed to the office.
2025-01-22 18:19:54.486 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2211, 2217) --> . Mary journeyed to the
2025-01-22 18:19:54.487 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the kitchen.
2025-01-22 18:19:54.500 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2211, 2217) --> . Mary journeyed to the
2025-01-22 18:19:54.500 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the kitchen.
2025-01-22 18:19:54.537 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6779, 6785) --> . Sandra went back to the
2025-01-22 18:19:54.537 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the hallway.
2025-01-22 18:19:54.573 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6920, 6926) --> . John went back to the
2025-01-22 18:19:54.573 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 18:19:54.573 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 18:19:54.573 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 18:19:54.573 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ“œ', '\U0001faf3ğŸ»', 'ğŸ‘©ğŸ½\u200dğŸ¦½', 'ğŸ‘±\u200dâ™€', 'ğŸ–', 'ğŸ‘¨\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘¨', 'ğŸ†—', 'ğŸƒ', 'ğŸ•‘', 'ğŸ‘·ğŸ»\u200dâ™‚ï¸']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.61s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:10,  5.03s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.88s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.33s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.90s/it]
Processing depth (0, 4, 5, 9):   3%|â–         | 3/100 [02:11<53:42, 33.22s/it]2025-01-22 18:20:11.926 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the football.
2025-01-22 18:20:11.970 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went back to the garden.
2025-01-22 18:20:11.988 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3561, 3567) --> . Daniel went back to the
2025-01-22 18:20:11.989 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the hallway.
2025-01-22 18:20:12.006 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3562, 3567) -->  Daniel went back to the
2025-01-22 18:20:12.007 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary journeyed to the office.
2025-01-22 18:20:12.018 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2216, 2222) --> . Mary journeyed to the
2025-01-22 18:20:12.018 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the kitchen.
2025-01-22 18:20:12.031 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2216, 2222) --> . Mary journeyed to the
2025-01-22 18:20:12.032 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the kitchen.
2025-01-22 18:20:12.072 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6864, 6870) --> . Sandra went back to the
2025-01-22 18:20:12.072 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the hallway.
2025-01-22 18:20:12.108 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6957, 6963) --> . John went back to the
2025-01-22 18:20:12.108 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 18:20:12.108 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 18:20:12.108 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 18:20:12.108 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ§ğŸ¼', 'ğŸ’‘ğŸ»', '\U0001faad', 'ğŸš•', 'ğŸ‘ğŸ¼', 'ğŸ™ğŸ½\u200dâ™‚', 'ğŸŠğŸ¼\u200dâ™‚ï¸', 'ğŸ”¬', 'ğŸ°', 'ğŸ¤¾ğŸ½']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.32s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.68s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.91s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.41s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.88s/it]
Processing depth (4, 6, 7, 8):   3%|â–         | 3/100 [02:29<53:42, 33.22s/it]2025-01-22 18:20:29.427 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the football.
2025-01-22 18:20:29.445 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3609, 3613) -->  Daniel got the football
2025-01-22 18:20:29.446 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went back to the garden.
2025-01-22 18:20:29.469 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4695, 4701) --> . Daniel went back to the
2025-01-22 18:20:29.469 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the hallway.
2025-01-22 18:20:29.497 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4696, 4701) -->  Daniel went back to the
2025-01-22 18:20:29.498 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary journeyed to the office.
2025-01-22 18:20:29.510 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2507, 2513) --> . Mary journeyed to the
2025-01-22 18:20:29.510 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the kitchen.
2025-01-22 18:20:29.525 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2507, 2513) --> . Mary journeyed to the
2025-01-22 18:20:29.525 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the kitchen.
2025-01-22 18:20:29.565 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6775, 6781) --> . Sandra went back to the
2025-01-22 18:20:29.565 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the hallway.
2025-01-22 18:20:29.603 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6941, 6947) -->  John went back to the hallway
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:20:30.443 | INFO     | test_jbb_embedding:begin_test:693 - Daniel got the football.<|eot_id|>
2025-01-22 18:20:30.443 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8149])
2025-01-22 18:20:32.666 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [198.58333333333334, 14.732981553606477, 115.46006944444444, 14.033616957352397, 28.091956967213115], 'topk_indices': array([2510,    8,   25, 8148,    4, 8037, 8136,   23, 3609, 3610,    1,
          3,    9, 3612,   24,   14, 8145, 8144,    0, 8147]), 'topk_tokens': ['ed', ' Date', '<|eot_id|>', '\n\n', '\n\n', '.\n\n', ' football', '4', ' Daniel', ' got', '<|start_header_id|>', '<|end_header_id|>', ':', ' football', '\n\n', '\n', '<|start_header_id|>', '<|eot_id|>', '<|begin_of_text|>', '<|end_header_id|>'], 'evidence_proportions': [377.375, 121.22916666666667, 126.0875, 217.15625]}, 'weight': {'score': [22.359375, 23.257358240309127, 22.35720486111111, 23.261679750092444, 29.069928278688526], 'topk_indices': array([3285, 3258, 3178, 3130, 7442, 7404, 1461, 1399, 4266, 4282, 5177,
       5116, 7125, 7181, 3473, 3447, 4877, 4970, 4902, 4941]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.939453125, 20.927083333333332, 23.1828125, 20.052083333333332]}, 'saliency': {'score': [1.248779296875, 0.08249351344234927, 0.6990797254774306, 0.0781066586082907, 0.1997919551661757], 'topk_indices': array([  14, 8037,   16, 5589,   20, 8137, 8146,   23, 4701, 8142, 8131,
       2509, 2508,    8, 8139,   24, 3610, 8136, 3609, 3612]), 'topk_tokens': ['\n', '.\n\n', ' Date', ' hallway', ' Jul', ' before', 'assistant', '4', ' garden', 'Answer', 'Question', ' journey', ' Mary', ' Date', ' hallway', '\n\n', ' got', ' football', ' Daniel', ' football'], 'evidence_proportions': [2.6697998046875, 0.6998087565104166, 0.7922119140625, 1.2308756510416667]}}, 'pred_res': 'Daniel got the football.<|eot_id|>', 'score': 0}
2025-01-22 18:20:32.671 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:20:32.672 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-94_pid-3_4-6-7-8.pkl | len: 3 |  size: 2.04 KB
Processing depth (4, 6, 7, 8):   4%|â–         | 4/100 [02:32<1:08:45, 42.98s/it]is_0k: False
your chose emoji: ['ğŸ‘“', 'ğŸ‘·ğŸ»\u200dâ™€', 'ğŸ‘¨ğŸ¼\u200dâ¤\u200dğŸ‘¨ğŸ¼', 'ğŸ§‘ğŸ½\u200dğŸ¦¯\u200dâ¡', 'ğŸ¤¶ğŸ¼', 'ğŸ›‹ï¸', 'ğŸ¦²', 'âš”ï¸', 'ğŸ•´', 'ğŸ’']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.33s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.80s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.79s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.26s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.79s/it]
Processing depth (2, 3, 5, 7):   4%|â–         | 4/100 [02:49<1:08:45, 42.98s/it]2025-01-22 18:20:49.760 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the football.
2025-01-22 18:20:49.768 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1592, 1596) -->  Daniel got the football
2025-01-22 18:20:49.768 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went back to the garden.
2025-01-22 18:20:49.782 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2735, 2741) --> . Daniel went back to the
2025-01-22 18:20:49.782 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the hallway.
2025-01-22 18:20:49.796 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2736, 2741) -->  Daniel went back to the
2025-01-22 18:20:49.796 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary journeyed to the office.
2025-01-22 18:20:49.807 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2222, 2228) --> . Mary journeyed to the
2025-01-22 18:20:49.807 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the kitchen.
2025-01-22 18:20:49.819 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2222, 2228) --> . Mary journeyed to the
2025-01-22 18:20:49.819 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the kitchen.
2025-01-22 18:20:49.857 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6774, 6780) -->  Sandra went back to the kitchen
2025-01-22 18:20:49.857 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the hallway.
2025-01-22 18:20:49.893 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6960, 6966) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:20:50.721 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's garden.<|eot_id|>
2025-01-22 18:20:50.721 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8139])
2025-01-22 18:20:52.946 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [655.3214285714286, 55.24833425448293, 297.05555555555554, 53.15601474762434, 67.99400111607143], 'topk_indices': array([8033, 8133, 8123, 7993,    9, 8129, 1591, 8122, 8124, 1596, 8036,
       8035, 8127, 8027, 8126,   14, 1592, 8037, 1595,    0]), 'topk_tokens': [' item', ':', ' Where', ' context', ':', ' hallway', '.', ':', ' was', '.', ' first', ' the', ' before', '.\n\n', ' football', '\n', ' Daniel', ' location', ' football', '<|begin_of_text|>'], 'evidence_proportions': [1730.5, 416.5, 426.3, 368.2083333333333]}, 'weight': {'score': [22.359375, 23.261074904814542, 21.99435763888889, 23.266225664877204, 29.854631696428573], 'topk_indices': array([3308, 3335, 3228, 3180, 7392, 7430, 1509, 1447, 4299, 4315, 5110,
       5171, 7093, 7149, 3491, 3517, 4964, 4912, 4935, 4887]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.939453125, 20.927083333333332, 23.1828125, 20.052083333333332]}, 'saliency': {'score': [4.189290364583333, 0.31128487414793665, 1.6581759982638888, 0.2982425249521782, 0.4993585859026228], 'topk_indices': array([8108, 7996, 8132, 7998, 1593, 8124, 8031, 8123, 8033, 8027, 8121,
       7993, 4133, 8036, 8127, 8129, 8126, 8037, 1592, 1595]), 'topk_tokens': [' return', ' facts', 'Answer', ' locations', ' got', ' was', ' obtained', ' Where', ' item', '.\n\n', 'Question', ' context', ' hallway', ' first', ' before', ' hallway', ' football', ' location', ' Daniel', ' football'], 'evidence_proportions': [12.55078125, 2.2709147135416665, 2.52890625, 1.9169921875]}}, 'pred_res': "Daniel's garden.<|eot_id|>", 'score': 100}
2025-01-22 18:20:52.952 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:20:52.953 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-94_pid-4_2-3-5-7.pkl | len: 3 |  size: 2.01 KB
Processing depth (2, 3, 5, 7):   5%|â–Œ         | 5/100 [02:52<55:05, 34.79s/it]  Processing depth (2, 3, 5, 7):   5%|â–Œ         | 5/100 [02:52<54:43, 34.57s/it]
2025-01-22 18:20:53.020 | INFO     | __main__:<module>:82 - Selected idx: 96
2025-01-22 18:20:53.020 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the football before the bathroom? 
2025-01-22 18:20:53.020 | INFO     | __main__:<module>:84 - Answer: hallway
2025-01-22 18:20:53.020 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 18:20:53.020 | INFO     | __main__:<module>:86 - Needle: [' Mary journeyed to the office.', ' Daniel got the football.', ' Daniel went to the hallway.', ' John went back to the hallway.', ' Sandra went back to the kitchen.', ' Daniel moved to the bathroom.', ' Mary journeyed to the kitchen.']
2025-01-22 18:20:53.020 | INFO     | __main__:<module>:87 - Real Needle: [' Daniel got the football.', ' Daniel went to the hallway.', ' Daniel moved to the bathroom.', ' Mary journeyed to the kitchen.']
2025-01-22 18:20:53.020 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ”', 'ğŸ’†\u200dâ™€ï¸', 'ğŸ™ğŸ¼\u200dâ™‚ï¸', 'â˜€ï¸', 'ğŸ§', 'ğŸ¤¾ğŸ¿\u200dâ™€', 'ğŸ¤™ğŸ½', 'ğŸ‘¨ğŸ¾\u200dâœˆï¸', 'âœ‹ğŸ¿', 'ğŸ“…']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:05<00:15,  5.12s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.22s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.83s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.35s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.97s/it]
Processing depth (1, 3, 4, 8):   0%|          | 0/100 [00:17<?, ?it/s]2025-01-22 18:21:10.656 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the football.
2025-01-22 18:21:10.660 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (830, 834) -->  Daniel got the football
2025-01-22 18:21:10.660 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the hallway.
2025-01-22 18:21:10.675 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2890, 2895) -->  back to the hallway.
2025-01-22 18:21:10.675 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the bathroom.
2025-01-22 18:21:10.693 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3661, 3666) -->  Hon. Daniel moved to
2025-01-22 18:21:10.693 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary journeyed to the kitchen.
2025-01-22 18:21:10.725 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5370, 5376) --> . Mary journeyed to the
2025-01-22 18:21:10.725 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the office.
2025-01-22 18:21:10.752 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5370, 5376) --> . Mary journeyed to the
2025-01-22 18:21:10.753 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the hallway.
2025-01-22 18:21:10.767 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2887, 2893) --> . John went back to the
2025-01-22 18:21:10.767 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the kitchen.
2025-01-22 18:21:10.772 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (984, 990) --> . Sandra went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:21:11.604 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's house.<|eot_id|>
2025-01-22 18:21:11.604 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8210])
2025-01-22 18:21:13.888 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [279.64140625, 23.621351059296238, 93.0078125, 22.8422247706422, 16.63733440896739], 'topk_indices': array([ 831,  909, 8183,    3, 8193,    1, 8198,  277, 8209, 3667,  867,
       8208, 8197,  830,   14,   24,  834,  833,    0, 8205]), 'topk_tokens': [' got', ' com', '.', '<|end_header_id|>', ':', '<|start_header_id|>', ' before', 'hue', '\n\n', ' bathroom', 'posit', '<|end_header_id|>', ' football', ' Daniel', '\n', '\n\n', '.', ' football', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [729.75, 170.05, 303.925, 50.658854166666664]}, 'weight': {'score': [22.68984375, 23.31332567271399, 20.6640625, 23.320684250764526, 29.57133152173913], 'topk_indices': array([3317, 3290, 3162, 3210, 7475, 7437, 1431, 1493, 4335, 4351, 5225,
       5164, 7206, 7150, 3499, 3473, 4989, 4966, 4941, 5018]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.939453125, 20.428125, 24.7171875, 20.052083333333332]}, 'saliency': {'score': [1.822125244140625, 0.1318363982548627, 0.5011461046006944, 0.12688797603688837, 0.12442986861519191], 'topk_indices': array([8207, 8064,  866, 2893, 3664,   24, 8179, 8203,  831, 8198, 8108,
        909, 8192, 8200,  277, 8197,  867,  830, 3667,  833]), 'topk_tokens': ['assistant', ' context', ' com', ' hallway', ' moved', '\n\n', ' return', 'Answer', ' got', ' before', ' location', ' com', 'Question', ' bathroom', 'hue', ' football', 'posit', ' Daniel', ' bathroom', ' football'], 'evidence_proportions': [5.179443359375, 1.037255859375, 1.7826171875, 0.2708943684895833]}}, 'pred_res': "Daniel's house.<|eot_id|>", 'score': 0}
2025-01-22 18:21:13.895 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:21:13.895 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-96_pid-0_1-3-4-8.pkl | len: 3 |  size: 2.04 KB
Processing depth (1, 3, 4, 8):   1%|          | 1/100 [00:20<34:17, 20.78s/it]is_0k: False
your chose emoji: ['ğŸ™ğŸ»\u200dâ™‚ï¸', 'ğŸ§‘ğŸ»\u200dğŸš€', 'ğŸŒ', 'ğŸ•µğŸ¾\u200dâ™€ï¸', 'ğŸ¦§', 'ğŸ›ï¸', 'ğŸƒğŸ½\u200dâ™‚ï¸\u200dâ¡', 'ğŸ‘©ğŸ¾\u200dğŸ¦¯\u200dâ¡', 'ğŸ‘¨ğŸ¿\u200dğŸ¤\u200dğŸ‘¨ğŸ½', 'ğŸ‘¨ğŸ¿\u200dğŸ“']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.29s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.59s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.46s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.15s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.63s/it]
Processing depth (0, 1, 3, 8):   1%|          | 1/100 [00:36<34:17, 20.78s/it]2025-01-22 18:21:30.151 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the football.
2025-01-22 18:21:30.193 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the hallway.
2025-01-22 18:21:30.197 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (834, 839) --> . Daniel went to the
2025-01-22 18:21:30.197 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the bathroom.
2025-01-22 18:21:30.212 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2956, 2961) --> . Daniel moved to the
2025-01-22 18:21:30.212 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary journeyed to the kitchen.
2025-01-22 18:21:30.243 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5322, 5328) --> . Mary journeyed to the
2025-01-22 18:21:30.243 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the office.
2025-01-22 18:21:30.270 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5322, 5328) --> . Mary journeyed to the
2025-01-22 18:21:30.270 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the hallway.
2025-01-22 18:21:30.285 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2893, 2899) --> . John went back to the
2025-01-22 18:21:30.285 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the kitchen.
2025-01-22 18:21:30.291 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (990, 996) --> . Sandra went back to the
2025-01-22 18:21:30.291 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 18:21:30.291 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 18:21:30.291 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 18:21:30.291 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ§™ğŸ½\u200dâ™€', 'ğŸ™†\u200dâ™‚', 'ğŸ‘«ğŸ¼', 'ğŸ§“', 'ğŸ”¦', 'ğŸˆ·', 'ğŸ§›ğŸ¾\u200dâ™‚ï¸', 'ğŸ‘¨ğŸ¼\u200dğŸš€', 'ğŸ‡¬ğŸ‡®', 'ğŸ‘©ğŸ»\u200dâ¤\u200dğŸ’‹\u200dğŸ‘¨ğŸ¿']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.65s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.51s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.58s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.19s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.69s/it]
Processing depth (2, 5, 6, 9):   1%|          | 1/100 [00:53<34:17, 20.78s/it]2025-01-22 18:21:46.833 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the football.
2025-01-22 18:21:46.843 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2007, 2011) -->  Daniel got the football
2025-01-22 18:21:46.843 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the hallway.
2025-01-22 18:21:46.858 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2964, 2969) -->  back to the hallway.
2025-01-22 18:21:46.858 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the bathroom.
2025-01-22 18:21:46.887 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4894, 4899) --> . Daniel moved to the
2025-01-22 18:21:46.887 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary journeyed to the kitchen.
2025-01-22 18:21:46.915 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5410, 5416) --> . Mary journeyed to the
2025-01-22 18:21:46.915 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the office.
2025-01-22 18:21:46.945 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5410, 5416) --> . Mary journeyed to the
2025-01-22 18:21:46.945 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the hallway.
2025-01-22 18:21:46.962 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2960, 2966) -->  tragedy. John went back to
2025-01-22 18:21:46.962 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the kitchen.
2025-01-22 18:21:46.968 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1039, 1045) --> . Sandra went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:21:47.772 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's house.<|eot_id|>
2025-01-22 18:21:47.772 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8168])
2025-01-22 18:21:50.016 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [521.9875, 48.60520438134867, 321.609375, 46.83688752612812, 18.560134242957748], 'topk_indices': array([2009,   24, 8159, 4899,   14, 8151, 2374, 8155, 8162, 1046, 8166,
       2006, 2011, 8163, 8156, 2007, 8158, 2010, 8164,    0]), 'topk_tokens': [' the', '\n\n', '?', ' bathroom', '\n', ':', 'little', ' football', ':', '.', '<|end_header_id|>', '.', '.', '<|eot_id|>', ' before', ' Daniel', ' bathroom', ' football', '<|start_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [1493.125, 363.775, 421.4, 90.22916666666667]}, 'weight': {'score': [21.487890625, 23.279932459307307, 22.27734375, 23.286558234968645, 29.50088028169014], 'topk_indices': array([3244, 3271, 3116, 3164, 7409, 7447, 1468, 1406, 4251, 4235, 5094,
       5155, 7123, 7179, 3427, 3453, 4865, 4919, 4948, 4890]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.939453125, 20.428125, 19.909375, 20.052083333333332]}, 'saliency': {'score': [3.365673828125, 0.2724131909917697, 1.9423149956597223, 0.2611106648357771, 0.13417676468970072], 'topk_indices': array([8137,   51, 8159, 8066,   54, 1926, 8152, 1045, 2008, 2967, 8161,
       8150, 2374, 8155, 1040, 4899, 8156, 2007, 8158, 2010]), 'topk_tokens': [' return', ' Proof', '?', ' location', '\n\n\n\n', '      ', ' Where', ' kitchen', ' got', ' hallway', 'Answer', 'Question', 'little', ' football', ' Sandra', ' bathroom', ' before', ' Daniel', ' bathroom', ' football'], 'evidence_proportions': [10.63037109375, 2.31279296875, 2.0728515625, 0.477294921875]}}, 'pred_res': "Daniel's house.<|eot_id|>", 'score': 0}
2025-01-22 18:21:50.039 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:21:50.051 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-96_pid-1_2-5-6-9.pkl | len: 3 |  size: 2.03 KB
Processing depth (2, 5, 6, 9):   2%|â–         | 2/100 [00:56<48:42, 29.83s/it]is_0k: False
your chose emoji: ['ğŸ§‘ğŸ¾\u200dâœˆï¸', 'ğŸš¶ğŸ¾\u200dâ™€\u200dâ¡ï¸', 'ğŸŒ©ï¸', 'ğŸš¶ğŸ»\u200dâ™€ï¸\u200dâ¡', 'ğŸ¤ğŸ»', 'ğŸ‘¬ğŸ»', 'ğŸ§›\u200dâ™‚', 'ğŸŸ¢', 'ğŸ‡²ğŸ‡º', 'ğŸ‡¸ğŸ‡¿']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.35s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.42s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.62s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.25s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.70s/it]
Processing depth (0, 1, 2, 3):   2%|â–         | 2/100 [01:13<48:42, 29.83s/it]2025-01-22 18:22:06.661 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the football.
2025-01-22 18:22:06.712 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the hallway.
2025-01-22 18:22:06.717 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (900, 905) --> . Daniel went to the
2025-01-22 18:22:06.717 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the bathroom.
2025-01-22 18:22:06.728 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2016, 2021) -->  cable. Daniel moved to
2025-01-22 18:22:06.728 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary journeyed to the kitchen.
2025-01-22 18:22:06.744 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2985, 2991) -->  tragedy. Mary journeyed to
2025-01-22 18:22:06.744 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the office.
2025-01-22 18:22:06.775 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2985, 2991) -->  tragedy. Mary journeyed to
2025-01-22 18:22:06.775 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the hallway.
2025-01-22 18:22:06.793 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2921, 2927) --> . John went back to the
2025-01-22 18:22:06.793 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the kitchen.
2025-01-22 18:22:06.799 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1050, 1056) --> . Sandra went back to the
2025-01-22 18:22:06.799 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 18:22:06.799 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 18:22:06.799 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 18:22:06.799 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ‘®ğŸ»\u200dâ™€', 'ğŸš©', 'ğŸ‘¨ğŸ½\u200dğŸ¦¯', 'ğŸ§‘\u200dğŸŒ¾', 'ğŸ‘©ğŸ½\u200dâ¤\u200dğŸ‘©ğŸ¾', 'ğŸ‘©ğŸ¿\u200dğŸ’»', 'ğŸ§‘ğŸ¼\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ§‘ğŸ¾', 'ğŸª•', 'ğŸ¤ğŸ»', 'ğŸ™ğŸ¼\u200dâ™€ï¸']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.81s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:08,  4.49s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.38s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.03s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.57s/it]
Processing depth (0, 2, 3, 6):   2%|â–         | 2/100 [01:29<48:42, 29.83s/it]2025-01-22 18:22:22.970 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the football.
2025-01-22 18:22:23.014 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the hallway.
2025-01-22 18:22:23.024 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1757, 1762) --> . Daniel went to the
2025-01-22 18:22:23.024 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the bathroom.
2025-01-22 18:22:23.038 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2846, 2851) --> . Daniel moved to the
2025-01-22 18:22:23.038 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary journeyed to the kitchen.
2025-01-22 18:22:23.064 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4634, 4640) --> . Mary journeyed to the
2025-01-22 18:22:23.064 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the office.
2025-01-22 18:22:23.088 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4634, 4640) --> . Mary journeyed to the
2025-01-22 18:22:23.088 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the hallway.
2025-01-22 18:22:23.102 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2725, 2731) --> . John went back to the
2025-01-22 18:22:23.102 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the kitchen.
2025-01-22 18:22:23.107 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (977, 983) -->  Sandra went back to the kitchen
2025-01-22 18:22:23.107 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 18:22:23.107 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 18:22:23.108 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 18:22:23.108 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ§‘ğŸ½\u200dğŸ³', 'ğŸ–', 'ğŸ‘ğŸ¼', 'ğŸ‡¸ğŸ‡¯', 'ğŸ‡¨ğŸ‡¾', 'ğŸš', 'ğŸ§”ğŸ½\u200dâ™‚ï¸', 'ğŸ‡¸ğŸ‡±', 'ğŸ’•', 'ğŸ¥']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.37s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.78s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.84s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.32s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.84s/it]
Processing depth (0, 2, 6, 9):   2%|â–         | 2/100 [01:47<48:42, 29.83s/it]2025-01-22 18:22:40.318 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the football.
2025-01-22 18:22:40.361 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the hallway.
2025-01-22 18:22:40.370 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1853, 1858) --> . Daniel went to the
2025-01-22 18:22:40.370 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the bathroom.
2025-01-22 18:22:40.398 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4752, 4757) -->  the senate. Daniel moved
2025-01-22 18:22:40.399 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary journeyed to the kitchen.
2025-01-22 18:22:40.425 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5308, 5314) --> . Mary journeyed to the
2025-01-22 18:22:40.426 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the office.
2025-01-22 18:22:40.452 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5308, 5314) --> . Mary journeyed to the
2025-01-22 18:22:40.453 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the hallway.
2025-01-22 18:22:40.469 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2821, 2827) --> . John went back to the
2025-01-22 18:22:40.469 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the kitchen.
2025-01-22 18:22:40.475 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (970, 976) --> . Sandra went back to the
2025-01-22 18:22:40.476 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 18:22:40.476 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 18:22:40.476 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 18:22:40.476 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ§ğŸ¿', 'ğŸ‘º', 'ğŸŒ', 'â™‹', 'ğŸš¶ğŸ»\u200dâ™‚ï¸', 'ğŸ§ğŸ»\u200dâ™‚ï¸', 'â™“', 'ğŸŒ²', 'ğŸ³', 'ğŸ§…']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.05s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.37s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.43s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.08s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.54s/it]
Processing depth (0, 2, 4, 9):   2%|â–         | 2/100 [02:03<48:42, 29.83s/it]2025-01-22 18:22:56.469 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the football.
2025-01-22 18:22:56.509 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the hallway.
2025-01-22 18:22:56.518 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1779, 1784) --> . Daniel went to the
2025-01-22 18:22:56.518 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the bathroom.
2025-01-22 18:22:56.537 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3618, 3623) --> . Daniel moved to the
2025-01-22 18:22:56.537 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary journeyed to the kitchen.
2025-01-22 18:22:56.566 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5154, 5160) --> . Mary journeyed to the
2025-01-22 18:22:56.566 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the office.
2025-01-22 18:22:56.595 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5154, 5160) --> . Mary journeyed to the
2025-01-22 18:22:56.595 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the hallway.
2025-01-22 18:22:56.610 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2761, 2767) --> . John went back to the
2025-01-22 18:22:56.611 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the kitchen.
2025-01-22 18:22:56.615 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (930, 936) --> . Sandra went back to the
2025-01-22 18:22:56.615 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 18:22:56.616 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 18:22:56.616 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 18:22:56.616 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ‡¿ğŸ‡¦', 'ğŸš´\u200dâ™€', 'ğŸ™‡\u200dâ™€', 'ğŸ¦¹ğŸ½', 'ğŸŠğŸ¾\u200dâ™‚ï¸', 'ğŸ§ğŸ½\u200dâ™€ï¸', 'ğŸ¤¹ğŸ¿\u200dâ™‚', 'ğŸƒğŸ»\u200dâ™‚ï¸', 'ğŸ§‘ğŸ½\u200dâ¤\u200dğŸ’‹\u200dğŸ§‘ğŸ¾', 'ğŸ–ï¸']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.63s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.63s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.61s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.20s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.72s/it]
Processing depth (1, 2, 5, 9):   2%|â–         | 2/100 [02:20<48:42, 29.83s/it]2025-01-22 18:23:13.269 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the football.
2025-01-22 18:23:13.273 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (896, 900) -->  Daniel got the football
2025-01-22 18:23:13.273 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the hallway.
2025-01-22 18:23:13.285 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2010, 2015) -->  cable. Daniel went to
2025-01-22 18:23:13.286 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the bathroom.
2025-01-22 18:23:13.308 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4248, 4253) --> . Daniel moved to the
2025-01-22 18:23:13.308 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary journeyed to the kitchen.
2025-01-22 18:23:13.336 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5408, 5414) -->  journeyed to the office.
2025-01-22 18:23:13.336 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the office.
2025-01-22 18:23:13.368 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5407, 5413) -->  Mary journeyed to the office
2025-01-22 18:23:13.368 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the hallway.
2025-01-22 18:23:13.385 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2915, 2921) --> . John went back to the
2025-01-22 18:23:13.385 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the kitchen.
2025-01-22 18:23:13.390 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1044, 1050) --> . Sandra went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:23:14.234 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's house.<|eot_id|>
2025-01-22 18:23:14.235 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8142])
2025-01-22 18:23:16.455 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [228.05703125, 22.812054941682014, 97.09722222222223, 22.140779187738993, 12.91241244612069], 'topk_indices': array([ 898, 8130,  897, 8030, 8132, 8129, 8040,  895,    1, 8141,  257,
          3,  896,   14, 8140,  900,   24,  899,    0, 8137]), 'topk_tokens': [' the', ' before', ' got', '.\n\n', ' bathroom', ' football', ' location', '.', '<|start_header_id|>', '\n\n', 'hue', '<|end_header_id|>', ' Daniel', '\n', '<|end_header_id|>', '.', '\n\n', ' football', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [632.4375, 110.959375, 211.325, 69.99479166666667]}, 'weight': {'score': [22.25078125, 23.266810543278083, 21.77907986111111, 23.27262030498335, 29.973868534482758], 'topk_indices': array([3283, 3256, 3176, 3128, 7435, 7397, 1411, 1473, 4259, 4275, 5143,
       5082, 7118, 7174, 3465, 3439, 4936, 4859, 4884, 4907]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.939453125, 24.0921875, 19.909375, 19.541666666666668]}, 'saliency': {'score': [1.43697509765625, 0.12770137330225598, 0.538818359375, 0.12355858555877637, 0.10148646913725755], 'topk_indices': array([8141,   99, 8139,   32,   51,    8, 8135, 8111, 8130,  897, 8040,
       8124,   24, 2016, 8129, 4253, 8132,  257,  896,  899]), 'topk_tokens': ['\n\n', 'ION', 'assistant', '***', ' Proof', ' Date', 'Answer', ' return', ' before', ' got', ' location', 'Question', '\n\n', ' hallway', ' football', ' bathroom', ' bathroom', 'hue', ' Daniel', ' football'], 'evidence_proportions': [4.499755859375, 0.607421875, 1.11142578125, 0.3577067057291667]}}, 'pred_res': "Daniel's house.<|eot_id|>", 'score': 0}
2025-01-22 18:23:16.461 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:23:16.462 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-96_pid-2_1-2-5-9.pkl | len: 3 |  size: 2.04 KB
Processing depth (1, 2, 5, 9):   3%|â–         | 3/100 [02:23<1:29:59, 55.66s/it]is_0k: False
your chose emoji: ['ğŸ¤¸\u200dâ™‚', 'ğŸ', 'ğŸ’ƒğŸ½', 'ğŸ€', 'ğŸ¦¸ğŸ¾\u200dâ™€ï¸', 'ğŸ´', 'ğŸ§ğŸ¿\u200dâ™‚ï¸\u200dâ¡ï¸', 'ğŸ¥¨', 'ğŸš£ğŸ¿\u200dâ™‚ï¸', 'ğŸ˜›']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.83s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.07s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.80s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.30s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.89s/it]
Processing depth (0, 4, 6, 7):   3%|â–         | 3/100 [02:40<1:29:59, 55.66s/it]2025-01-22 18:23:33.792 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the football.
2025-01-22 18:23:33.837 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the hallway.
2025-01-22 18:23:33.851 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2804, 2809) -->  back to the hallway.
2025-01-22 18:23:33.851 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the bathroom.
2025-01-22 18:23:33.874 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4702, 4707) --> . Daniel moved to the
2025-01-22 18:23:33.875 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary journeyed to the kitchen.
2025-01-22 18:23:33.901 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5200, 5206) --> . Mary journeyed to the
2025-01-22 18:23:33.901 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the office.
2025-01-22 18:23:33.927 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5200, 5206) --> . Mary journeyed to the
2025-01-22 18:23:33.927 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the hallway.
2025-01-22 18:23:33.942 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2801, 2807) --> . John went back to the
2025-01-22 18:23:33.942 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the kitchen.
2025-01-22 18:23:33.947 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (968, 974) --> . Sandra went back to the
2025-01-22 18:23:33.947 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 18:23:33.947 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 18:23:33.947 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 18:23:33.947 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ‘°ğŸ½\u200dâ™‚ï¸', 'ğŸ•´ğŸ¿', 'ğŸšµ\u200dâ™‚', 'ğŸ‡¦ğŸ‡º', 'ğŸ‡²ğŸ‡½', 'ğŸ˜š', 'ğŸ§‘ğŸ»\u200dğŸ“', 'ğŸ®', 'ğŸ•º', '\U0001faf6ğŸ»']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.14s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.22s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.47s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.18s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.59s/it]
Processing depth (0, 2, 8, 9):   3%|â–         | 3/100 [02:57<1:29:59, 55.66s/it]2025-01-22 18:23:50.339 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the football.
2025-01-22 18:23:50.383 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the hallway.
2025-01-22 18:23:50.394 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1737, 1742) --> . Daniel went to the
2025-01-22 18:23:50.394 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the bathroom.
2025-01-22 18:23:50.429 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6559, 6564) --> . Daniel moved to the
2025-01-22 18:23:50.429 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary journeyed to the kitchen.
2025-01-22 18:23:50.460 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5178, 5184) --> . Mary journeyed to the
2025-01-22 18:23:50.460 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the office.
2025-01-22 18:23:50.486 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5178, 5184) --> . Mary journeyed to the
2025-01-22 18:23:50.487 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the hallway.
2025-01-22 18:23:50.501 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2815, 2821) --> . John went back to the
2025-01-22 18:23:50.501 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the kitchen.
2025-01-22 18:23:50.505 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (839, 845) -->  Sandra went back to the kitchen
2025-01-22 18:23:50.506 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 18:23:50.506 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 18:23:50.506 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 18:23:50.506 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ•´ï¸', 'ğŸ¤ğŸ½', 'ğŸŒ•', 'â™»ï¸', 'ğŸ§˜\u200dâ™€', 'ğŸ•°', 'ğŸ‘', 'â­', 'âš½', 'ğŸŸ«']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.48s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.45s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.50s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.23s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.69s/it]
Processing depth (1, 3, 6, 8):   3%|â–         | 3/100 [03:13<1:29:59, 55.66s/it]2025-01-22 18:24:07.009 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the football.
2025-01-22 18:24:07.013 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (780, 784) -->  Daniel got the football
2025-01-22 18:24:07.013 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the hallway.
2025-01-22 18:24:07.030 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2824, 2829) -->  back to the hallway.
2025-01-22 18:24:07.030 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the bathroom.
2025-01-22 18:24:07.055 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4712, 4717) --> . Daniel moved to the
2025-01-22 18:24:07.056 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary journeyed to the kitchen.
2025-01-22 18:24:07.084 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5018, 5024) --> . Mary journeyed to the
2025-01-22 18:24:07.085 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the office.
2025-01-22 18:24:07.113 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5018, 5024) --> . Mary journeyed to the
2025-01-22 18:24:07.113 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the hallway.
2025-01-22 18:24:07.129 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2821, 2827) --> . John went back to the
2025-01-22 18:24:07.130 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the kitchen.
2025-01-22 18:24:07.134 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (928, 934) --> . Sandra went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:24:07.976 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's house.<|eot_id|>
2025-01-22 18:24:07.976 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8152])
2025-01-22 18:24:10.195 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [227.9046875, 19.85034871244635, 90.55729166666667, 19.180912744856474, 26.309198288690474], 'topk_indices': array([8150, 8139, 8142,  781,  779, 8040, 8135, 8146, 8140, 8050,  275,
        782,   14,  780, 8148,   24, 8147,  784,  783,    0]), 'topk_tokens': ['<|end_header_id|>', ' football', ' bathroom', ' got', '.', '.\n\n', ':', ':', ' before', ' location', 'hue', ' the', '\n', ' Daniel', '<|start_header_id|>', '\n\n', '<|eot_id|>', '.', ' football', '<|begin_of_text|>'], 'evidence_proportions': [735.875, 95.95, 166.05, 50.765625]}, 'weight': {'score': [21.487890625, 23.274001762722257, 20.6640625, 23.28419039515831, 29.903025793650794], 'topk_indices': array([3286, 3313, 3158, 3206, 7393, 7431, 1509, 1447, 4283, 4299, 5222,
       5161, 7170, 7114, 3495, 3469, 4899, 5008, 4924, 4979]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.939453125, 20.428125, 19.909375, 20.052083333333332]}, 'saliency': {'score': [1.4647491455078125, 0.11138123419297977, 0.5069003634982638, 0.10716949308742454, 0.20454491509331596], 'topk_indices': array([8049, 8136, 8120,   16, 8144, 8040, 8006, 4717, 8121, 8145,   24,
       8140,  781, 8134, 8050, 8139, 8142,  275,  780,  783]), 'topk_tokens': [' first', ' Where', 'Just', ' Date', ' \n', '.\n\n', ' context', ' bathroom', ' return', 'Answer', '\n\n', ' before', ' got', 'Question', ' location', ' football', ' bathroom', 'hue', ' Daniel', ' football'], 'evidence_proportions': [5.141357421875, 0.6087158203125, 0.840283203125, 0.24742635091145834]}}, 'pred_res': "Daniel's house.<|eot_id|>", 'score': 0}
2025-01-22 18:24:10.202 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:24:10.202 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-96_pid-3_1-3-6-8.pkl | len: 3 |  size: 2.02 KB
Processing depth (1, 3, 6, 8):   4%|â–         | 4/100 [03:17<1:27:50, 54.90s/it]is_0k: False
your chose emoji: ['ğŸŠğŸ½\u200dâ™€', 'â®ï¸', '6ï¸âƒ£', 'ğŸ¤ŒğŸ»', 'ğŸ’‡ğŸ¿\u200dâ™‚ï¸', 'ğŸ’‡\u200dâ™‚', 'ğŸ§‘ğŸ¿\u200dğŸ¦³', 'ğŸª°', 'ğŸ•¸ï¸', 'ğŸ‹ğŸ¼\u200dâ™€ï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.88s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.80s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.80s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.25s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.83s/it]
Processing depth (1, 6, 7, 9):   4%|â–         | 4/100 [03:34<1:27:50, 54.90s/it]2025-01-22 18:24:27.322 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the football.
2025-01-22 18:24:27.327 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (830, 834) -->  Daniel got the football
2025-01-22 18:24:27.328 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the hallway.
2025-01-22 18:24:27.346 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2926, 2931) -->  back to the hallway.
2025-01-22 18:24:27.346 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the bathroom.
2025-01-22 18:24:27.380 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5674, 5679) -->  Daniel moved to the bathroom
2025-01-22 18:24:27.380 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary journeyed to the kitchen.
2025-01-22 18:24:27.407 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5322, 5328) --> . Mary journeyed to the
2025-01-22 18:24:27.407 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the office.
2025-01-22 18:24:27.437 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5322, 5328) --> . Mary journeyed to the
2025-01-22 18:24:27.437 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the hallway.
2025-01-22 18:24:27.452 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2923, 2929) --> . John went back to the
2025-01-22 18:24:27.452 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the kitchen.
2025-01-22 18:24:27.457 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (984, 990) --> . Sandra went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:24:28.273 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's house.<|eot_id|>
2025-01-22 18:24:28.273 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8252])
2025-01-22 18:24:30.527 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [247.86875, 25.498945714718353, 87.78125, 24.821268026652064, 21.134074253318584], 'topk_indices': array([ 100,  907,  831, 8235, 8240, 5838,  832, 8242,  277,   24,   14,
        909,  830,    3,  867,  834,  553,  833, 8247,    0]), 'topk_tokens': ['E', ' or', ' got', ':', ' before', ' a', ' the', ' bathroom', 'hue', '\n\n', '\n', ' com', ' Daniel', '<|end_header_id|>', 'posit', '.', ',', ' football', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [750.75, 140.0125, 179.5125, 59.458333333333336]}, 'weight': {'score': [22.91015625, 23.36059774379164, 20.6640625, 23.367601086162832, 30.13509402654867], 'topk_indices': array([3282, 3309, 3154, 3202, 7517, 7479, 1431, 1493, 4299, 4315, 5177,
       5116, 7200, 7256, 3485, 3511, 4941, 4893, 4970, 4918]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.939453125, 20.428125, 25.5984375, 20.052083333333332]}, 'saliency': {'score': [1.6801788330078125, 0.14230399544783465, 0.4993387858072917, 0.13777872795633292, 0.15687993142457135], 'topk_indices': array([8150,  100,  887, 8221,  907, 5678,   24,   99, 8245, 8240,  831,
        866, 8234, 8239,  277, 8242,  909,  830,  867,  833]), 'topk_tokens': [' location', 'E', 'ig', ' return', ' or', ' bathroom', '\n\n', 'ION', 'Answer', ' before', ' got', ' com', 'Question', ' football', 'hue', ' bathroom', ' com', ' Daniel', 'posit', ' football'], 'evidence_proportions': [5.296875, 0.8517578125, 1.2685546875, 0.3024190266927083]}}, 'pred_res': "Daniel's house.<|eot_id|>", 'score': 0}
2025-01-22 18:24:30.534 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:24:30.534 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-96_pid-4_1-6-7-9.pkl | len: 3 |  size: 1.98 KB
Processing depth (1, 6, 7, 9):   5%|â–Œ         | 5/100 [03:37<1:07:11, 42.44s/it]Processing depth (1, 6, 7, 9):   5%|â–Œ         | 5/100 [03:37<1:08:52, 43.50s/it]
2025-01-22 18:24:30.590 | INFO     | __main__:<module>:82 - Selected idx: 98
2025-01-22 18:24:30.590 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the football before the hallway? 
2025-01-22 18:24:30.590 | INFO     | __main__:<module>:84 - Answer: garden
2025-01-22 18:24:30.590 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 18:24:30.590 | INFO     | __main__:<module>:86 - Needle: [' Sandra went back to the kitchen.', ' Daniel picked up the football.', ' Sandra travelled to the bathroom.', ' Mary journeyed to the office.', ' John went back to the hallway.', ' Daniel went back to the garden.', ' Mary journeyed to the kitchen.', ' Mary journeyed to the office.', ' John moved to the garden.', ' Daniel went to the hallway.', ' Sandra went to the bedroom.']
2025-01-22 18:24:30.590 | INFO     | __main__:<module>:87 - Real Needle: [' Daniel picked up the football.', ' Daniel went back to the garden.', ' Daniel went to the hallway.', ' Sandra went to the bedroom.']
2025-01-22 18:24:30.590 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ’ğŸ¾\u200dâ™‚ï¸', 'ğŸ§‘ğŸ¾\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ§‘ğŸ»', 'ğŸ™†\u200dâ™‚', 'â›‘', 'ğŸ§ğŸ»\u200dâ™‚ï¸', 'ğŸ¤·ğŸ¼\u200dâ™‚ï¸', 'ğŸ§‘ğŸ¿\u200dğŸ¤\u200dğŸ§‘ğŸ½', 'ğŸ™‡ğŸ¼\u200dâ™‚ï¸', 'ğŸƒğŸ¼\u200dâ™€ï¸\u200dâ¡ï¸', 'ğŸ‘¨ğŸ¼\u200dâ¤ï¸\u200dğŸ‘¨ğŸ¼']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.64s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.19s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.86s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.32s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.91s/it]
Processing depth (0, 4, 5, 9):   0%|          | 0/100 [00:17<?, ?it/s]2025-01-22 18:24:48.022 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the football.
2025-01-22 18:24:48.022 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the football.
2025-01-22 18:24:48.022 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went back to the garden.
2025-01-22 18:24:48.041 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3638, 3644) --> . Daniel went back to the
2025-01-22 18:24:48.042 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the hallway.
2025-01-22 18:24:48.060 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3639, 3644) -->  Daniel went back to the
2025-01-22 18:24:48.060 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the bedroom.
2025-01-22 18:24:48.085 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5099, 5104) -->  Sandra went back to the
2025-01-22 18:24:48.086 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went back to the kitchen.
2025-01-22 18:24:48.113 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5098, 5104) --> . Sandra went back to the
2025-01-22 18:24:48.113 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra travelled to the bathroom.
2025-01-22 18:24:48.131 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3436, 3441) --> . Sandra travelled to the
2025-01-22 18:24:48.131 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the office.
2025-01-22 18:24:48.140 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1739, 1745) --> . Mary journeyed to the
2025-01-22 18:24:48.140 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the hallway.
2025-01-22 18:24:48.175 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6674, 6680) --> . John went back to the
2025-01-22 18:24:48.176 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary journeyed to the kitchen.
2025-01-22 18:24:48.186 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1739, 1745) --> . Mary journeyed to the
2025-01-22 18:24:48.186 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary journeyed to the office.
2025-01-22 18:24:48.207 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (1739, 1745) --> . Mary journeyed to the
2025-01-22 18:24:48.207 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  John moved to the garden.
2025-01-22 18:24:48.240 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (6630, 6635) --> . John moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:24:49.179 | INFO     | test_jbb_embedding:begin_test:693 - Daniel picked up the football.<|eot_id|>
2025-01-22 18:24:49.179 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8197])
2025-01-22 18:24:51.429 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [237.19642857142858, 20.37398056402439, 110.92265625, 19.369530578080845, 17.949327256944443], 'topk_indices': array([7671, 8094, 3644,   20, 8185,    4, 8085,   35, 6639,   38,    9,
       8095, 7672, 8195,   24,   23,   14, 8193, 8192,    0]), 'topk_tokens': [' Min', ' first', ' garden', ' Jul', ' before', '\n\n', '.\n\n', '.', 'ï¿½', '***', ':', ' location', 'nes', '<|end_header_id|>', '\n\n', '4', '\n', '<|start_header_id|>', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [341.85, 270.875, 247.65, 81.675]}, 'weight': {'score': [22.594494047619047, 23.283799542682928, 20.443359375, 23.299537719621576, 29.747395833333332], 'topk_indices': array([3270, 3297, 3190, 3142, 7474, 7436, 1437, 1499, 4295, 4311, 5194,
       5133, 7135, 7191, 3459, 3485, 4951, 4903, 4928, 4980]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.2875, 20.927083333333332, 23.1828125, 24.3140625]}, 'saliency': {'score': [1.3000372023809523, 0.11456274265196265, 0.58681640625, 0.10918307559234473, 0.13814247979058158], 'topk_indices': array([  39, 8166, 7582, 8187, 8085,    8,   19, 8094, 6639,   34, 8185,
       7671,   24, 8184, 3644,   23,   20,   38, 8095, 7672]), 'topk_tokens': ['\n\n\n', ' return', 'nes', ' hallway', '.\n\n', ' Date', '26', ' first', 'ï¿½', ' football', ' before', ' Min', '\n\n', ' football', ' garden', '4', ' Jul', '***', ' location', 'nes'], 'evidence_proportions': [1.82060546875, 1.385986328125, 1.47314453125, 0.50322265625]}}, 'pred_res': 'Daniel picked up the football.<|eot_id|>', 'score': 0}
2025-01-22 18:24:51.437 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:24:51.437 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-98_pid-0_0-4-5-9.pkl | len: 3 |  size: 2.0 KB
Processing depth (0, 4, 5, 9):   1%|          | 1/100 [00:20<34:13, 20.74s/it]is_0k: False
your chose emoji: ['ğŸƒğŸ¿\u200dâ™‚', 'ğŸ¦¹ğŸ¿\u200dâ™‚ï¸', 'ğŸ‘¨ğŸ¿\u200dâœˆ', 'ğŸ§”ğŸ¿\u200dâ™€', 'ğŸŠ\u200dâ™‚ï¸', '\U0001faf5ğŸ½', 'ğŸ†', 'ğŸ‘¨ğŸ¾\u200dğŸ­', 'ğŸ¤¹\u200dâ™‚ï¸', 'ğŸ‘']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.61s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.86s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.58s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  2.96s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.59s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (3, 4, 6, 7):   1%|          | 1/100 [00:36<34:13, 20.74s/it]2025-01-22 18:25:07.558 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the football.
2025-01-22 18:25:07.571 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2548, 2553) --> . Daniel picked up the
2025-01-22 18:25:07.571 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went back to the garden.
2025-01-22 18:25:07.589 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3470, 3476) --> . Daniel went back to the
2025-01-22 18:25:07.589 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the hallway.
2025-01-22 18:25:07.610 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3471, 3476) -->  Daniel went back to the
2025-01-22 18:25:07.610 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the bedroom.
2025-01-22 18:25:07.635 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4921, 4926) -->  Sandra went back to the
2025-01-22 18:25:07.635 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went back to the kitchen.
2025-01-22 18:25:07.662 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4920, 4926) --> . Sandra went back to the
2025-01-22 18:25:07.662 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra travelled to the bathroom.
2025-01-22 18:25:07.680 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3104, 3109) --> . Sandra travelled to the
2025-01-22 18:25:07.680 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the office.
2025-01-22 18:25:07.688 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1543, 1549) --> . Mary journeyed to the
2025-01-22 18:25:07.688 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the hallway.
2025-01-22 18:25:07.722 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6632, 6638) --> . John went back to the
2025-01-22 18:25:07.722 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary journeyed to the kitchen.
2025-01-22 18:25:07.730 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1543, 1549) --> . Mary journeyed to the
2025-01-22 18:25:07.730 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary journeyed to the office.
2025-01-22 18:25:07.738 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (1543, 1549) --> . Mary journeyed to the
2025-01-22 18:25:07.738 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  John moved to the garden.
2025-01-22 18:25:07.773 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (6496, 6501) --> . John moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:25:12.100 | INFO     | test_jbb_embedding:begin_test:693 - Daniel picked up the football.<|eot_id|>
2025-01-22 18:25:12.100 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8147])
2025-01-22 18:25:14.992 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [250.43005952380952, 26.89572852760736, 159.04921875, 25.661909692174557, 25.39810505319149], 'topk_indices': array([2696,   23, 8001, 2704, 2701, 8035,    9, 8134, 2548, 2706, 8145,
       2554, 8045,   24,   14, 2549, 2553, 8143, 8142,    0]), 'topk_tokens': [' leve', '4', ' context', ' ne', 'as', '.\n\n', ':', ' football', '.', ' the', '<|end_header_id|>', '.', ' location', '\n\n', '\n', ' Daniel', ' football', '<|start_header_id|>', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [629.7, 158.88541666666666, 163.1375, 68.30625]}, 'weight': {'score': [22.61235119047619, 23.239731595092024, 20.443359375, 23.25518837309927, 29.382646276595743], 'topk_indices': array([3304, 3331, 3176, 3224, 7426, 7388, 1441, 1503, 4297, 4313, 5121,
       5182, 7165, 7109, 3494, 3520, 4975, 4891, 4946, 4916]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.3625, 20.927083333333332, 23.1828125, 24.3140625]}, 'saliency': {'score': [1.484468005952381, 0.15025138995398774, 0.8446792602539063, 0.14335366912966296, 0.1864299368351064], 'topk_indices': array([8140, 3109, 8035, 2701, 2559, 8044, 8135, 2705, 2630,   24, 2550,
       8001, 2704, 8137, 2632, 2696, 8134, 8045, 2549, 2553]), 'topk_tokens': ['Answer', ' bathroom', '.\n\n', 'as', ' one', ' first', ' before', 'ared', 'ared', '\n\n', ' picked', ' context', ' ne', ' hallway', ' shore', ' leve', ' football', ' location', ' Daniel', ' football'], 'evidence_proportions': [3.784765625, 0.8875732421875, 0.997900390625, 0.38701171875]}}, 'pred_res': 'Daniel picked up the football.<|eot_id|>', 'score': 0}
2025-01-22 18:25:14.999 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:25:14.999 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-98_pid-1_3-4-6-7.pkl | len: 3 |  size: 2.03 KB
Processing depth (3, 4, 6, 7):   2%|â–         | 2/100 [00:44<36:35, 22.40s/it]is_0k: False
your chose emoji: ['4âƒ£', 'ğŸŒ‘', 'ğŸ“™', 'ğŸ¦º', 'ğŸ’‡ğŸ½\u200dâ™‚ï¸', 'â‡', 'ğŸ’†ğŸ¾\u200dâ™‚', 'ğŸ§\u200dâ™‚', '\U0001fae2', 'ğŸ‘³ğŸ¾']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:05<00:16,  5.34s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:09,  4.98s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.71s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.27s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.88s/it]
Processing depth (1, 3, 5, 7):   2%|â–         | 2/100 [01:01<36:35, 22.40s/it]2025-01-22 18:25:32.280 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the football.
2025-01-22 18:25:32.285 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (829, 834) --> . Daniel picked up the
2025-01-22 18:25:32.285 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went back to the garden.
2025-01-22 18:25:32.300 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2981, 2987) -->  tragedy. Daniel went back to
2025-01-22 18:25:32.300 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the hallway.
2025-01-22 18:25:32.315 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2983, 2988) -->  Daniel went back to the
2025-01-22 18:25:32.315 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the bedroom.
2025-01-22 18:25:32.348 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5734, 5739) --> . Sandra went to the
2025-01-22 18:25:32.348 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went back to the kitchen.
2025-01-22 18:25:32.373 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5039, 5045) -->  Sandra went back to the kitchen
2025-01-22 18:25:32.373 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra travelled to the bathroom.
2025-01-22 18:25:32.391 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3441, 3446) --> . Sandra travelled to the
2025-01-22 18:25:32.391 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the office.
2025-01-22 18:25:32.410 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1789, 1795) --> . Mary journeyed to the
2025-01-22 18:25:32.410 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the hallway.
2025-01-22 18:25:32.444 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6666, 6672) --> . John went back to the
2025-01-22 18:25:32.444 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary journeyed to the kitchen.
2025-01-22 18:25:32.454 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1789, 1795) --> . Mary journeyed to the
2025-01-22 18:25:32.454 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary journeyed to the office.
2025-01-22 18:25:32.464 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (1789, 1795) --> . Mary journeyed to the
2025-01-22 18:25:32.464 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  John moved to the garden.
2025-01-22 18:25:32.497 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (6530, 6535) --> . John moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:25:33.322 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's garden.<|eot_id|>
2025-01-22 18:25:33.322 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8191])
2025-01-22 18:25:35.565 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [203.6532738095238, 20.72950100683427, 136.5703125, 19.687446206811753, 14.616026947463768], 'topk_indices': array([ 257, 8190,    4, 8045,  830,   23,    1, 8185, 2988,   24, 8079,
       8187,  835,    9, 8089,  834, 8189,   14, 8186,    0]), 'topk_tokens': ['hue', '\n\n', '\n\n', ' context', ' Daniel', '4', '<|start_header_id|>', ':', ' garden', '\n\n', '.\n\n', '<|start_header_id|>', '.', ':', ' location', ' football', '<|end_header_id|>', '\n', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [413.1, 181.02083333333334, 202.35, 22.66875]}, 'weight': {'score': [23.157738095238095, 23.272188491579204, 21.0419921875, 23.28345263894012, 29.351222826086957], 'topk_indices': array([3265, 3292, 3137, 3185, 7432, 7470, 1487, 1425, 4285, 4301, 5121,
       5182, 7209, 7153, 3464, 3490, 4879, 4904, 4927, 4956]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.3625, 25.766927083333332, 23.1828125, 20.796875]}, 'saliency': {'score': [1.2180989583333333, 0.11543395713040792, 0.769720458984375, 0.10936886121261373, 0.10802902000537817], 'topk_indices': array([1791, 8179, 8173, 8181,   24, 2395, 8088,    8, 8184, 8160, 8079,
       7763,  831, 8045, 8178,  257,  830, 2988, 8089,  834]), 'topk_tokens': [' journey', ' before', 'Question', ' hallway', '\n\n', 'little', ' first', ' Date', 'Answer', ' return', '.\n\n', 'inen', ' picked', ' context', ' football', 'hue', ' Daniel', ' garden', ' location', ' football'], 'evidence_proportions': [2.43388671875, 1.1045328776041667, 1.231494140625, 0.1251953125]}}, 'pred_res': "Daniel's garden.<|eot_id|>", 'score': 100}
2025-01-22 18:25:35.571 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:25:35.572 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-98_pid-2_1-3-5-7.pkl | len: 3 |  size: 2.03 KB
Processing depth (1, 3, 5, 7):   3%|â–         | 3/100 [01:04<34:51, 21.57s/it]is_0k: False
your chose emoji: ['ğŸˆ¸', 'ğŸ§ğŸ¾\u200dâ™€', 'ğŸ…±', 'ğŸ¦¹\u200dâ™€', 'ğŸ™†ğŸ»', 'ğŸ‘±ğŸ¿\u200dâ™‚ï¸', 'ğŸ‹ğŸ»\u200dâ™‚', 'ğŸ‘¨ğŸ½\u200dğŸ¦¯\u200dâ¡', 'ğŸ§™ğŸ½', '\U0001faf6ğŸ½']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.45s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.88s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.75s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.06s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.67s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (2, 5, 6, 7):   3%|â–         | 3/100 [01:21<34:51, 21.57s/it]2025-01-22 18:25:52.136 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the football.
2025-01-22 18:25:52.146 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2005, 2010) -->  cable. Daniel picked up
2025-01-22 18:25:52.146 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went back to the garden.
2025-01-22 18:25:52.168 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4208, 4214) -->  Daniel went back to the garden
2025-01-22 18:25:52.168 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the hallway.
2025-01-22 18:25:52.192 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4788, 4793) -->  the senate. Daniel went
2025-01-22 18:25:52.192 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the bedroom.
2025-01-22 18:25:52.218 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5063, 5068) -->  Sandra went back to the
2025-01-22 18:25:52.218 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went back to the kitchen.
2025-01-22 18:25:52.243 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5062, 5068) --> . Sandra went back to the
2025-01-22 18:25:52.243 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra travelled to the bathroom.
2025-01-22 18:25:52.260 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3436, 3441) --> . Sandra travelled to the
2025-01-22 18:25:52.260 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the office.
2025-01-22 18:25:52.270 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1835, 1841) --> . Mary journeyed to the
2025-01-22 18:25:52.270 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the hallway.
2025-01-22 18:25:52.304 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6689, 6695) -->  John went back to the hallway
2025-01-22 18:25:52.304 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary journeyed to the kitchen.
2025-01-22 18:25:52.313 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1835, 1841) --> . Mary journeyed to the
2025-01-22 18:25:52.313 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary journeyed to the office.
2025-01-22 18:25:52.323 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (1835, 1841) --> . Mary journeyed to the
2025-01-22 18:25:52.323 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  John moved to the garden.
2025-01-22 18:25:52.356 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (6650, 6655) --> . John moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:25:56.014 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 18:25:56.015 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8213])
2025-01-22 18:25:59.023 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [223.08630952380952, 26.723601433179162, 178.8671875, 25.471687231759656, 41.105078125], 'topk_indices': array([8196, 8110, 8201, 2012,    4, 8067, 4213, 8200, 2022, 2007,   24,
       8101,    9, 8208, 8209, 2011, 8111, 8211,   14,    0]), 'topk_tokens': [':', ' first', ' before', '.', '\n\n', ' context', ' garden', ' football', 'ï¿½', ' Daniel', '\n\n', '.\n\n', ':', '<|eot_id|>', '<|start_header_id|>', ' football', ' location', '<|end_header_id|>', '\n', '<|begin_of_text|>'], 'evidence_proportions': [393.3, 330.5, 78.8625, 68.2]}, 'weight': {'score': [25.02938988095238, 23.29476022395326, 21.2052734375, 23.300542228694052, 29.6744140625], 'topk_indices': array([3297, 3270, 3142, 3190, 7446, 7484, 1461, 1399, 4301, 4285, 5206,
       5145, 7161, 7217, 3459, 3485, 4940, 4915, 4992, 4963]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.7890625, 24.688802083333332, 24.39375, 24.3140625]}, 'saliency': {'score': [1.4416344052269345, 0.1505266614874939, 0.9803512573242188, 0.14313165885696083, 0.3088214874267578], 'topk_indices': array([4795, 7777,   24, 8206, 2013, 8195,   14, 8101, 8182, 2022, 8110,
       8201,    8, 8067, 8203, 4213, 8200, 2007, 8111, 2011]), 'topk_tokens': [' hallway', 'inen', '\n\n', 'Answer', 'ï¿½', 'Question', '\n', '.\n\n', ' return', 'ï¿½', ' first', ' before', ' Date', ' context', ' hallway', ' garden', ' football', ' Daniel', ' location', ' football'], 'evidence_proportions': [2.5716796875, 2.171142578125, 0.472540283203125, 0.4052734375]}}, 'pred_res': 'The garden.<|eot_id|>', 'score': 100}
2025-01-22 18:25:59.029 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:25:59.029 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-98_pid-3_2-5-6-7.pkl | len: 3 |  size: 2.02 KB
Processing depth (2, 5, 6, 7):   4%|â–         | 4/100 [01:28<35:42, 22.31s/it]is_0k: False
your chose emoji: ['ğŸ§ğŸ»\u200dâ™‚\u200dâ¡ï¸', 'ğŸŒ‹', 'ğŸ‘š', 'ğŸ‘¨ğŸ¼\u200dğŸ¦½\u200dâ¡', 'âœ³', 'ğŸ‘¨ğŸ¾\u200dâ¤\u200dğŸ’‹\u200dğŸ‘¨ğŸ¾', 'ğŸš»', 'ğŸƒğŸ»', 'ğŸ‘²ğŸ¼', 'ğŸš¶ğŸ¾\u200dâ™‚\u200dâ¡ï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.08s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.45s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.68s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.30s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.73s/it]
Processing depth (0, 1, 4, 6):   4%|â–         | 4/100 [01:45<35:42, 22.31s/it]2025-01-22 18:26:16.195 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the football.
2025-01-22 18:26:16.196 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the football.
2025-01-22 18:26:16.196 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went back to the garden.
2025-01-22 18:26:16.201 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (841, 847) --> . Daniel went back to the
2025-01-22 18:26:16.201 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the hallway.
2025-01-22 18:26:16.206 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (842, 847) -->  Daniel went back to the
2025-01-22 18:26:16.206 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the bedroom.
2025-01-22 18:26:16.247 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4784, 4789) --> . Sandra went to the
2025-01-22 18:26:16.248 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went back to the kitchen.
2025-01-22 18:26:16.279 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5052, 5058) --> . Sandra went back to the
2025-01-22 18:26:16.279 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra travelled to the bathroom.
2025-01-22 18:26:16.296 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3333, 3338) --> . Sandra travelled to the
2025-01-22 18:26:16.296 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the office.
2025-01-22 18:26:16.305 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1752, 1758) --> . Mary journeyed to the
2025-01-22 18:26:16.305 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the hallway.
2025-01-22 18:26:16.338 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6726, 6732) --> . John went back to the
2025-01-22 18:26:16.338 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary journeyed to the kitchen.
2025-01-22 18:26:16.349 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1752, 1758) --> . Mary journeyed to the
2025-01-22 18:26:16.349 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary journeyed to the office.
2025-01-22 18:26:16.359 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (1752, 1758) --> . Mary journeyed to the
2025-01-22 18:26:16.359 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  John moved to the garden.
2025-01-22 18:26:16.395 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (6662, 6667) --> . John moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:26:17.211 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 18:26:17.211 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8261])
2025-01-22 18:26:19.442 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [245.43526785714286, 12.339412663359148, 34.3986328125, 11.635111582652687, 9.979055551382212], 'topk_indices': array([   4, 8230, 8159, 8249, 8255,    1, 8242, 8149,    9, 8260,  845,
        844,   23, 8259,   24,   14, 8257, 8256,    0,  847]), 'topk_tokens': ['\n\n', ' return', ' location', ' before', ':', '<|start_header_id|>', '.\n\n', '.\n\n', ':', '\n\n', ' to', ' back', '4', '<|end_header_id|>', '\n\n', '\n', '<|start_header_id|>', '<|eot_id|>', '<|begin_of_text|>', ' garden'], 'evidence_proportions': [203.25, 364.5416666666667, 377.3, 12.828125]}, 'weight': {'score': [21.757068452380953, 23.340826930058082, 20.443359375, 23.35901023253688, 30.024338942307693], 'topk_indices': array([3316, 3289, 3203, 3155, 7490, 7528, 1450, 1512, 4387, 4371, 5195,
       5256, 7267, 7211, 3510, 3536, 5013, 4990, 5042, 4965]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.2875, 20.927083333333332, 23.1828125, 20.796875]}, 'saliency': {'score': [1.3611689976283483, 0.06858905448802789, 0.18250732421875, 0.06472450376327163, 0.0748456808236929], 'topk_indices': array([  14, 8243, 8254, 8260,  105,   19, 8149,  843,    8,   16, 8249,
       8230, 8248, 8159,   20,   23,  842,   24,  844,  847]), 'topk_tokens': ['\n', 'Question', 'Answer', '\n\n', 'ION', '26', '.\n\n', ' went', ' Date', ' Date', ' before', ' return', ' football', ' location', ' Jul', '4', ' Daniel', '\n\n', ' back', ' garden'], 'evidence_proportions': [1.148486328125, 1.94482421875, 2.16630859375, 0.0683258056640625]}}, 'pred_res': 'The garden.<|eot_id|>', 'score': 100}
2025-01-22 18:26:19.456 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:26:19.457 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-98_pid-4_0-1-4-6.pkl | len: 3 |  size: 1.99 KB
Processing depth (0, 1, 4, 6):   5%|â–Œ         | 5/100 [01:48<34:15, 21.63s/it]Processing depth (0, 1, 4, 6):   5%|â–Œ         | 5/100 [01:48<34:27, 21.77s/it]
2025-01-22 18:26:19.521 | INFO     | __main__:<module>:82 - Selected idx: 100
2025-01-22 18:26:19.521 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the apple before the garden? 
2025-01-22 18:26:19.534 | INFO     | __main__:<module>:84 - Answer: bedroom
2025-01-22 18:26:19.534 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 18:26:19.534 | INFO     | __main__:<module>:86 - Needle: [' Mary moved to the bedroom.', ' Daniel picked up the apple.', ' John went to the hallway.', ' Sandra went back to the kitchen.', ' John went to the bathroom.', ' Sandra moved to the hallway.', ' Daniel travelled to the bedroom.', ' Mary travelled to the bathroom.', ' Daniel went back to the garden.', ' John went to the office.']
2025-01-22 18:26:19.534 | INFO     | __main__:<module>:87 - Real Needle: [' Daniel picked up the apple.', ' Daniel travelled to the bedroom.', ' Daniel went back to the garden.', ' John went to the office.']
2025-01-22 18:26:19.534 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ›', 'ğŸ‘©ğŸ¿\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘©ğŸ»', 'ğŸ¤ğŸ½', 'ğŸ‘¨ğŸ¿\u200dâ¤ï¸\u200dğŸ‘¨ğŸ¾', 'ğŸ§‘ğŸ»\u200dâ¤\u200dğŸ’‹\u200dğŸ§‘ğŸ¼', 'ğŸ‘³ğŸ½\u200dâ™€', 'ğŸƒğŸ½\u200dâ™‚\u200dâ¡ï¸', 'ğŸ§\u200dâ™‚', 'ğŸ‡¬ğŸ‡¦', 'ğŸ¤µğŸ»\u200dâ™€ï¸']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  3.89s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.38s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.12s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:12<00:00,  2.68s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:12<00:00,  3.23s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (2, 4, 6, 8):   0%|          | 0/100 [00:14<?, ?it/s]2025-01-22 18:26:34.274 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the apple.
2025-01-22 18:26:34.283 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1741, 1746) --> . Daniel picked up the
2025-01-22 18:26:34.283 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel travelled to the bedroom.
2025-01-22 18:26:34.301 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3573, 3578) --> . Daniel travelled to the
2025-01-22 18:26:34.301 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the garden.
2025-01-22 18:26:34.324 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4605, 4611) -->  Daniel went back to the garden
2025-01-22 18:26:34.325 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 18:26:34.347 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4466, 4471) -->  execution. John went to
2025-01-22 18:26:34.347 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bedroom.
2025-01-22 18:26:34.374 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5361, 5366) --> . Mary moved to the
2025-01-22 18:26:34.374 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went to the hallway.
2025-01-22 18:26:34.397 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4466, 4471) -->  execution. John went to
2025-01-22 18:26:34.397 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the kitchen.
2025-01-22 18:26:34.420 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4471, 4477) -->  the hallway. Sandra went back
2025-01-22 18:26:34.421 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the bathroom.
2025-01-22 18:26:34.443 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4466, 4471) -->  execution. John went to
2025-01-22 18:26:34.443 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra moved to the hallway.
2025-01-22 18:26:34.445 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (267, 272) --> . Sandra moved to the
2025-01-22 18:26:34.445 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary travelled to the bathroom.
2025-01-22 18:26:34.473 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (5457, 5462) --> . Mary travelled to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:26:38.889 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's hand.<|eot_id|>
2025-01-22 18:26:38.889 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8165])
2025-01-22 18:26:41.827 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [311.1979166666667, 24.12564466515671, 85.89415322580645, 23.146918509733858, 22.33997182377049], 'topk_indices': array([8019, 8159, 8146, 8154, 8053, 4611, 8147, 1747, 8063, 8156, 8150,
       8148, 8152, 1746, 3578, 8155, 8153,    0, 8160, 8161]), 'topk_tokens': [' context', ':', '.\n\n', ' the', '.\n\n', '.', 'Question', '.', ' location', '?', ' was', ':', ' apple', ' apple', ' bedroom', ' garden', ' before', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [515.0, 342.1, 318.3958333333333, 67.85625]}, 'weight': {'score': [22.881696428571427, 23.267384916748284, 22.441532258064516, 23.271537318260226, 29.739497950819672], 'topk_indices': array([3336, 3309, 3229, 3181, 7404, 7442, 1439, 1501, 4334, 4318, 5155,
       5216, 7125, 7181, 3492, 3518, 4974, 5003, 4951, 4926]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.3625, 21.01875, 24.688802083333332, 23.0953125]}, 'saliency': {'score': [1.7711414155505953, 0.13231825571686, 0.49235682333669356, 0.12670262215935343, 0.1688319972304047], 'topk_indices': array([8059, 8134, 8146, 3575, 1743, 8158, 8053, 4610, 8149, 8156, 8150,
       1742, 8019, 8063, 8147, 8152, 1746, 8155, 3578, 8153]), 'topk_tokens': [' item', ' return', '.\n\n', ' travelled', ' picked', 'Answer', '.\n\n', ' garden', ' Where', '?', ' was', ' Daniel', ' context', ' location', 'Question', ' apple', ' apple', ' garden', ' bedroom', ' before'], 'evidence_proportions': [2.8591796875, 1.92548828125, 1.9150390625, 0.3560791015625]}}, 'pred_res': "Daniel's hand.<|eot_id|>", 'score': 0}
2025-01-22 18:26:41.873 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:26:41.874 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-100_pid-0_2-4-6-8.pkl | len: 3 |  size: 2.01 KB
Processing depth (2, 4, 6, 8):   1%|          | 1/100 [00:22<36:41, 22.24s/it]is_0k: False
your chose emoji: ['ğŸ§ğŸ¿\u200dâ™€ï¸', 'ğŸ§‘ğŸ¾\u200dâ¤ï¸\u200dğŸ§‘ğŸ¿', '7ï¸âƒ£', 'ğŸ¦¥', 'ğŸ™ï¸', 'ğŸš¶', 'â™Š', 'ğŸŒ¼', 'ğŸ‡²ğŸ‡³', 'ğŸ§ğŸ¿\u200dâ™‚ï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:05<00:15,  5.22s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.76s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.36s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.03s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.63s/it]
Processing depth (0, 2, 4, 8):   1%|          | 1/100 [00:38<36:41, 22.24s/it]2025-01-22 18:26:58.384 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the apple.
2025-01-22 18:26:58.384 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the apple.
2025-01-22 18:26:58.384 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel travelled to the bedroom.
2025-01-22 18:26:58.394 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2010, 2015) -->  cable. Daniel travelled to
2025-01-22 18:26:58.395 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the garden.
2025-01-22 18:26:58.416 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3614, 3620) -->  Hon. Daniel went back to
2025-01-22 18:26:58.417 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 18:26:58.441 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4554, 4559) -->  went to the hallway.
2025-01-22 18:26:58.441 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bedroom.
2025-01-22 18:26:58.471 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5619, 5624) --> . Mary moved to the
2025-01-22 18:26:58.472 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went to the hallway.
2025-01-22 18:26:58.497 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4553, 4558) -->  John went to the hallway
2025-01-22 18:26:58.497 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the kitchen.
2025-01-22 18:26:58.522 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4556, 4562) -->  the hallway. Sandra went back
2025-01-22 18:26:58.522 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the bathroom.
2025-01-22 18:26:58.545 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4554, 4559) -->  went to the hallway.
2025-01-22 18:26:58.545 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra moved to the hallway.
2025-01-22 18:26:58.547 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (361, 366) --> . Sandra moved to the
2025-01-22 18:26:58.547 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary travelled to the bathroom.
2025-01-22 18:26:58.576 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (5715, 5720) --> . Mary travelled to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:26:59.400 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's hand.<|eot_id|>
2025-01-22 18:26:59.400 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8173])
2025-01-22 18:27:01.611 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [409.9017857142857, 50.78917334271037, 125.47379032258064, 49.575905496061054, 51.06688701923077], 'topk_indices': array([8168,   24,   35,    1, 3067, 3621, 8071, 8026,   28, 1569, 3068,
       8163, 8161, 8027, 3086, 3103,    0, 3104, 3084, 3085]), 'topk_tokens': ['<|eot_id|>', '\n\n', '.', '<|start_header_id|>', ' Fourth', ' garden', ' location', ' you', '<|end_header_id|>', 'ation', ' of', ' garden', ' before', ' context', 'ation', ' const', '<|begin_of_text|>', 'ern', ' const', 'ern'], 'evidence_proportions': [700.0, 374.1375, 464.1458333333333, 90.475]}, 'weight': {'score': [23.40922619047619, 23.27187041340509, 22.34702620967742, 23.27504442854505, 29.614182692307693], 'topk_indices': array([3265, 3292, 3185, 3137, 7404, 7442, 1411, 1473, 4289, 4273, 5164,
       5103, 7125, 7181, 3448, 3474, 4880, 4957, 4928, 4905]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.08125, 25.4453125, 24.93359375, 20.871875]}, 'saliency': {'score': [2.3508765811011907, 0.29004336243272993, 0.7343080582157258, 0.2830209962139571, 0.39379788912259617], 'topk_indices': array([8155, 3026, 8026, 8025, 3083, 1569, 8160, 3028, 8071, 3621, 2016,
       3067, 8161, 3086, 8163, 8027, 3103, 3104, 3084, 3085]), 'topk_tokens': ['Question', ' Fourth', ' you', ' provided', ' great', 'ation', ' apple', ' July', ' location', ' garden', ' bedroom', ' Fourth', ' before', 'ation', ' garden', ' context', ' const', 'ern', ' const', 'ern'], 'evidence_proportions': [3.7408203125, 2.30439453125, 2.7610677083333335, 0.515185546875]}}, 'pred_res': "Daniel's hand.<|eot_id|>", 'score': 0}
2025-01-22 18:27:01.618 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:27:01.619 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-100_pid-1_0-2-4-8.pkl | len: 3 |  size: 2.04 KB
Processing depth (0, 2, 4, 8):   2%|â–         | 2/100 [00:41<33:55, 20.77s/it]is_0k: False
your chose emoji: ['ğŸƒğŸ»\u200dâ™€\u200dâ¡', 'ğŸ˜’', 'âœğŸ¿', 'ğŸ§ğŸ¿\u200dâ™‚\u200dâ¡', 'ğŸ“™', 'ğŸ›©', 'ğŸš‰', 'ğŸš­', 'ğŸ§‘ğŸ¿\u200dâœˆ', 'ğŸ‘©ğŸ»\u200dğŸ¦¼\u200dâ¡ï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.87s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.84s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.67s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.22s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.79s/it]
Processing depth (1, 2, 4, 8):   2%|â–         | 2/100 [00:59<33:55, 20.77s/it]2025-01-22 18:27:18.742 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the apple.
2025-01-22 18:27:18.747 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (901, 906) --> . Daniel picked up the
2025-01-22 18:27:18.748 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel travelled to the bedroom.
2025-01-22 18:27:18.759 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2010, 2015) -->  cable. Daniel travelled to
2025-01-22 18:27:18.760 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the garden.
2025-01-22 18:27:18.778 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3641, 3647) --> . Daniel went back to the
2025-01-22 18:27:18.778 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 18:27:18.804 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4540, 4545) -->  went to the hallway.
2025-01-22 18:27:18.804 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bedroom.
2025-01-22 18:27:18.835 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5585, 5590) --> . Mary moved to the
2025-01-22 18:27:18.836 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went to the hallway.
2025-01-22 18:27:18.858 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4539, 4544) -->  John went to the hallway
2025-01-22 18:27:18.858 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the kitchen.
2025-01-22 18:27:18.885 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4542, 4548) -->  the hallway. Sandra went back
2025-01-22 18:27:18.885 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the bathroom.
2025-01-22 18:27:18.907 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4540, 4545) -->  went to the hallway.
2025-01-22 18:27:18.907 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra moved to the hallway.
2025-01-22 18:27:18.909 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (355, 360) --> . Sandra moved to the
2025-01-22 18:27:18.909 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary travelled to the bathroom.
2025-01-22 18:27:18.937 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (5641, 5646) --> . Mary travelled to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:27:19.763 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's house.<|eot_id|>
2025-01-22 18:27:19.763 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8197])
2025-01-22 18:27:22.029 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [299.67113095238096, 24.79190548780488, 169.07862903225808, 23.534498496563575, 15.225826907467532], 'topk_indices': array([   9, 8179, 8186,   24,  906, 8184, 8085, 8182, 8180, 3648, 8095,
       2016, 8195,   14, 8188, 8187, 8185, 8192, 8193,    0]), 'topk_tokens': [':', 'Question', ' the', '\n\n', ' apple', ' apple', '.\n\n', ' was', ':', '.', ' location', ' bedroom', '<|end_header_id|>', '\n', '?', ' garden', ' before', '<|eot_id|>', '<|start_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [460.0, 261.00625, 314.4583333333333, 160.2625]}, 'weight': {'score': [22.331473214285715, 23.27618330792683, 22.34702620967742, 23.282153212444772, 28.866274350649352], 'topk_indices': array([3279, 3306, 3163, 3115, 7454, 7416, 1473, 1411, 4309, 4293, 5167,
       5228, 7193, 7137, 3488, 3462, 4944, 4969, 5021, 4992]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.3625, 25.4453125, 20.927083333333332, 20.871875]}, 'saliency': {'score': [1.6783970424107142, 0.13753700814596037, 0.9915180821572581, 0.13031665051047803, 0.11089057426948051], 'topk_indices': array([ 357, 8094, 2013,  903, 8085, 8182, 8051, 3647, 8181,  356, 8179,
        902, 8188,  360, 8095,  906, 8184, 2016, 8185, 8187]), 'topk_tokens': [' moved', ' first', ' travelled', ' picked', '.\n\n', ' was', ' context', ' garden', ' Where', ' Sandra', 'Question', ' Daniel', '?', ' hallway', ' location', ' apple', ' apple', ' bedroom', ' before', ' garden'], 'evidence_proportions': [2.625390625, 1.61005859375, 1.6407877604166667, 0.844873046875]}}, 'pred_res': "Daniel's house.<|eot_id|>", 'score': 0}
2025-01-22 18:27:22.036 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:27:22.036 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-100_pid-2_1-2-4-8.pkl | len: 3 |  size: 2.03 KB
Processing depth (1, 2, 4, 8):   3%|â–         | 3/100 [01:02<33:19, 20.61s/it]is_0k: False
your chose emoji: ['ğŸŸï¸', 'ğŸ§‘ğŸ½\u200dâ¤\u200dğŸ§‘ğŸ¾', 'ğŸ¥’', 'ğŸ§‘ğŸ»\u200dâš–', 'ğŸ‡¨ğŸ‡²', 'ğŸª¶', 'ğŸ¤¸ğŸ½\u200dâ™‚', 'ğŸ§‘ğŸ¿\u200dâš–ï¸', 'ğŸ¤ğŸ¾', 'ğŸ‘©ğŸ½\u200dğŸ¦²']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.06s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:09,  4.52s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.36s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.81s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.38s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 2, 3, 4):   3%|â–         | 3/100 [01:17<33:19, 20.61s/it]2025-01-22 18:27:37.325 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the apple.
2025-01-22 18:27:37.326 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the apple.
2025-01-22 18:27:37.326 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel travelled to the bedroom.
2025-01-22 18:27:37.335 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1753, 1758) --> . Daniel travelled to the
2025-01-22 18:27:37.335 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the garden.
2025-01-22 18:27:37.349 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2844, 2850) -->  Daniel went back to the garden
2025-01-22 18:27:37.349 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 18:27:37.371 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3570, 3575) --> . John went to the
2025-01-22 18:27:37.371 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bedroom.
2025-01-22 18:27:37.399 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5615, 5620) --> . Mary moved to the
2025-01-22 18:27:37.399 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went to the hallway.
2025-01-22 18:27:37.417 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3570, 3575) --> . John went to the
2025-01-22 18:27:37.417 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the kitchen.
2025-01-22 18:27:37.444 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4574, 4580) -->  the hallway. Sandra went back
2025-01-22 18:27:37.444 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the bathroom.
2025-01-22 18:27:37.462 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3570, 3575) --> . John went to the
2025-01-22 18:27:37.462 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra moved to the hallway.
2025-01-22 18:27:37.464 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (320, 325) -->  Sandra moved to the hallway
2025-01-22 18:27:37.464 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary travelled to the bathroom.
2025-01-22 18:27:37.493 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (5669, 5674) --> . Mary travelled to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:27:41.836 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's house.<|eot_id|>
2025-01-22 18:27:41.836 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8181])
2025-01-22 18:27:44.763 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [530.985119047619, 53.0359084799609, 154.16834677419354, 51.4161299495819, 42.16813858695652], 'topk_indices': array([8163,   24, 2850, 7355, 8034, 8170,   35, 8164, 8168, 8079, 1758,
       8166,   67,  105, 8172, 8035,   68, 8171, 8169,    0]), 'topk_tokens': ['Question', '\n\n', '.', 'nes', ' you', ' the', '.', ':', ' apple', ' location', ' bedroom', ' was', 'ION', 'ION', '?', ' context', 'E', ' garden', ' before', '<|begin_of_text|>'], 'evidence_proportions': [851.7, 552.6, 625.1666666666666, 75.6375]}, 'weight': {'score': [21.753348214285715, 23.28261317815249, 21.986643145161292, 23.291502705361534, 29.88360507246377], 'topk_indices': array([3333, 3306, 3226, 3178, 7402, 7440, 1451, 1513, 4339, 4323, 5208,
       5147, 7179, 7123, 3489, 3515, 4924, 4949, 5001, 4972]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.08125, 21.01875, 24.688802083333332, 18.6375]}, 'saliency': {'score': [2.975254603794643, 0.3028098485803091, 0.968293220766129, 0.2933716630912214, 0.3194297016530797], 'topk_indices': array([8075, 1755, 8165, 8174,   31, 8166, 7355, 2849, 8172, 8163, 8079,
          0, 8168,   67,   68,  105, 1758, 8035, 8169, 8171]), 'topk_tokens': [' item', ' travelled', ' Where', 'Answer', ' picked', ' was', 'nes', ' garden', '?', 'Question', ' location', '<|begin_of_text|>', ' apple', 'ION', 'E', 'ION', ' bedroom', ' context', ' before', ' garden'], 'evidence_proportions': [4.4890625, 2.9943359375, 3.892578125, 0.3415771484375]}}, 'pred_res': "Daniel's house.<|eot_id|>", 'score': 0}
2025-01-22 18:27:44.769 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:27:44.770 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-100_pid-3_0-2-3-4.pkl | len: 3 |  size: 1.99 KB
Processing depth (0, 2, 3, 4):   4%|â–         | 4/100 [01:25<34:19, 21.45s/it]is_0k: False
your chose emoji: ['ğŸ”„', 'ğŸ‘©ğŸ¾\u200dğŸ«', 'â©', 'ğŸ’¹', 'ğŸ¦¸ğŸ¼', 'ğŸ‘©ğŸ¿\u200dâ¤ï¸\u200dğŸ‘©ğŸ¿', 'ğŸ‘¨ğŸ»\u200dâ¤ï¸\u200dğŸ‘¨ğŸ¾', 'ğŸ‹ï¸\u200dâ™‚ï¸', 'ğŸª„', 'ğŸˆ']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.92s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.92s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.69s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.24s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.82s/it]
Processing depth (0, 3, 4, 9):   4%|â–         | 4/100 [01:42<34:19, 21.45s/it]2025-01-22 18:28:01.906 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the apple.
2025-01-22 18:28:01.906 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the apple.
2025-01-22 18:28:01.906 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel travelled to the bedroom.
2025-01-22 18:28:01.920 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2824, 2829) -->  Daniel travelled to the bedroom
2025-01-22 18:28:01.921 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the garden.
2025-01-22 18:28:01.939 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3560, 3566) -->  Daniel went back to the garden
2025-01-22 18:28:01.939 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 18:28:01.961 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4493, 4498) -->  execution. John went to
2025-01-22 18:28:01.961 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bedroom.
2025-01-22 18:28:01.988 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5465, 5470) --> . Mary moved to the
2025-01-22 18:28:01.988 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went to the hallway.
2025-01-22 18:28:02.014 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4493, 4498) -->  execution. John went to
2025-01-22 18:28:02.014 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the kitchen.
2025-01-22 18:28:02.044 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4498, 4504) -->  the hallway. Sandra went back
2025-01-22 18:28:02.044 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the bathroom.
2025-01-22 18:28:02.066 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4493, 4498) -->  execution. John went to
2025-01-22 18:28:02.066 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra moved to the hallway.
2025-01-22 18:28:02.068 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (309, 314) --> . Sandra moved to the
2025-01-22 18:28:02.068 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary travelled to the bathroom.
2025-01-22 18:28:02.099 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (5593, 5598) --> . Mary travelled to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:28:02.938 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's bedroom.<|eot_id|>
2025-01-22 18:28:02.938 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8181])
2025-01-22 18:28:05.152 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [360.82105654761904, 29.416863315615835, 105.24344758064517, 28.271989708866208, 37.00169836956522], 'topk_indices': array([  14, 8069,   65,   35, 8166,  104, 8079, 8172, 8171,   24,   69,
       8176, 2828, 8169,   66,    1,   67,  105,   68,    0]), 'topk_tokens': ['\n', '.\n\n', ' OF', '.', ' was', ' P', ' location', '?', ' garden', '\n\n', 'ER', '<|eot_id|>', ' bedroom', ' before', ' P', '<|start_header_id|>', 'ION', 'ION', 'E', '<|begin_of_text|>'], 'evidence_proportions': [488.15, 548.85, 368.7916666666667, 35.8984375]}, 'weight': {'score': [24.106770833333332, 23.28138364491691, 22.441532258064516, 23.282453770597638, 29.8106884057971], 'topk_indices': array([3281, 3308, 3201, 3153, 7472, 7434, 1479, 1417, 4345, 4361, 5169,
       5230, 7155, 7211, 3520, 3494, 4971, 4946, 5023, 4994]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.08125, 26.4453125, 24.688802083333332, 23.0953125]}, 'saliency': {'score': [2.2862665085565474, 0.16718889611207843, 0.6101467993951613, 0.1600280101230094, 0.27973363019418024], 'topk_indices': array([  31, 8035,   24, 8172,   64, 8168, 8163,   69, 2825, 3565,  310,
       8079,    0,   66, 8169, 8171, 2828,   68,   67,  105]), 'topk_tokens': [' picked', ' context', '\n\n', '?', 'ENCES', ' apple', 'Question', 'ER', ' travelled', ' garden', ' Sandra', ' location', '<|begin_of_text|>', ' P', ' before', ' garden', ' bedroom', 'E', 'ION', 'ION'], 'evidence_proportions': [2.61357421875, 3.97119140625, 2.355224609375, 0.1912841796875]}}, 'pred_res': "Daniel's bedroom.<|eot_id|>", 'score': 100}
2025-01-22 18:28:05.160 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:28:05.160 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-100_pid-4_0-3-4-9.pkl | len: 3 |  size: 1.99 KB
Processing depth (0, 3, 4, 9):   5%|â–Œ         | 5/100 [01:45<33:21, 21.07s/it]Processing depth (0, 3, 4, 9):   5%|â–Œ         | 5/100 [01:45<33:26, 21.13s/it]
2025-01-22 18:28:05.257 | INFO     | __main__:<module>:82 - Selected idx: 102
2025-01-22 18:28:05.258 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the apple before the garden? 
2025-01-22 18:28:05.258 | INFO     | __main__:<module>:84 - Answer: bedroom
2025-01-22 18:28:05.258 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 18:28:05.258 | INFO     | __main__:<module>:86 - Needle: [' Mary moved to the bedroom.', ' Daniel got the apple.', ' Sandra went back to the kitchen.', ' Mary picked up the milk.', ' Mary put down the milk.', ' John went to the bathroom.', ' Daniel travelled to the bedroom.', ' Sandra moved to the hallway.', ' John went to the hallway.', ' Daniel went back to the garden.', ' Mary travelled to the bathroom.']
2025-01-22 18:28:05.258 | INFO     | __main__:<module>:87 - Real Needle: [' Daniel got the apple.', ' Daniel travelled to the bedroom.', ' Daniel went back to the garden.', ' Mary travelled to the bathroom.']
2025-01-22 18:28:05.258 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ§šğŸ¿\u200dâ™€ï¸', 'ğŸ§¯', 'ğŸ„ğŸ½\u200dâ™€', 'â›°ï¸', 'ğŸ§‘ğŸ¾\u200dâ¤\u200dğŸ§‘ğŸ½', 'ğŸ—“ï¸', 'ğŸ¤¦\u200dâ™‚', 'â—€ï¸', 'ğŸ‘©ğŸ»\u200dâ¤\u200dğŸ‘¨ğŸ¾', 'ğŸŸ ']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.99s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.16s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.86s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.36s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.96s/it]
Processing depth (0, 4, 5, 6):   0%|          | 0/100 [00:17<?, ?it/s]2025-01-22 18:28:22.843 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the apple.
2025-01-22 18:28:22.884 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel travelled to the bedroom.
2025-01-22 18:28:22.902 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3639, 3644) --> . Daniel travelled to the
2025-01-22 18:28:22.902 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the garden.
2025-01-22 18:28:22.924 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4203, 4209) --> . Daniel went back to the
2025-01-22 18:28:22.924 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary travelled to the bathroom.
2025-01-22 18:28:22.948 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4814, 4819) -->  the senate. Mary travelled
2025-01-22 18:28:22.948 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bedroom.
2025-01-22 18:28:22.981 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6702, 6707) --> . Mary moved to the
2025-01-22 18:28:22.981 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the kitchen.
2025-01-22 18:28:22.999 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3483, 3489) -->  Sandra went back to the kitchen
2025-01-22 18:28:22.999 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary picked up the milk.
2025-01-22 18:28:23.016 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3448, 3453) --> . Mary picked up the
2025-01-22 18:28:23.016 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary put down the milk.
2025-01-22 18:28:23.017 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (148, 153) --> . Mary put down the
2025-01-22 18:28:23.017 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went to the bathroom.
2025-01-22 18:28:23.044 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5478, 5483) --> . John went to the
2025-01-22 18:28:23.044 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra moved to the hallway.
2025-01-22 18:28:23.065 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (4089, 4094) --> . Sandra moved to the
2025-01-22 18:28:23.065 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  John went to the hallway.
2025-01-22 18:28:23.092 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (5478, 5483) --> . John went to the
2025-01-22 18:28:23.092 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 18:28:23.092 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 18:28:23.092 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 18:28:23.092 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['\U0001faf2ğŸ¿', 'ğŸ‘¨ğŸ½\u200dâœˆ', 'ğŸ§”ğŸ½\u200dâ™€ï¸', 'ğŸ‘©ğŸ¼\u200dâ¤\u200dğŸ‘¨ğŸ¼', 'ğŸ‘©ğŸ½\u200dğŸ¦¼\u200dâ¡', 'â›¹ğŸ¿\u200dâ™‚', 'ğŸ§‘ğŸ½\u200dğŸ¦¯\u200dâ¡ï¸', 'ğŸ§š\u200dâ™€', 'ğŸ’\u200dâ™€ï¸', 'ğŸ§‘ğŸ¿\u200dğŸš’']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.32s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.50s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.80s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.36s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.81s/it]
Processing depth (3, 4, 6, 8):   0%|          | 0/100 [00:34<?, ?it/s]2025-01-22 18:28:40.091 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the apple.
2025-01-22 18:28:40.110 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2900, 2904) -->  Daniel got the apple
2025-01-22 18:28:40.111 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel travelled to the bedroom.
2025-01-22 18:28:40.131 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3644, 3649) -->  Hon. Daniel travelled to
2025-01-22 18:28:40.131 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the garden.
2025-01-22 18:28:40.158 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4735, 4741) --> . Daniel went back to the
2025-01-22 18:28:40.159 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary travelled to the bathroom.
2025-01-22 18:28:40.192 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6545, 6550) -->  Mary travelled to the bathroom
2025-01-22 18:28:40.192 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bedroom.
2025-01-22 18:28:40.230 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6680, 6685) --> . Mary moved to the
2025-01-22 18:28:40.231 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the kitchen.
2025-01-22 18:28:40.252 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3518, 3524) --> . Sandra went back to the
2025-01-22 18:28:40.252 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary picked up the milk.
2025-01-22 18:28:40.271 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3460, 3465) --> . Mary picked up the
2025-01-22 18:28:40.271 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary put down the milk.
2025-01-22 18:28:40.272 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (123, 128) --> . Mary put down the
2025-01-22 18:28:40.272 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went to the bathroom.
2025-01-22 18:28:40.299 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5366, 5371) --> . John went to the
2025-01-22 18:28:40.299 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra moved to the hallway.
2025-01-22 18:28:40.321 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (4087, 4092) --> . Sandra moved to the
2025-01-22 18:28:40.321 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  John went to the hallway.
2025-01-22 18:28:40.349 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (5366, 5371) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:28:41.170 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's house.<|eot_id|>
2025-01-22 18:28:41.171 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8202])
2025-01-22 18:28:43.423 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [344.10625, 28.111475472273003, 123.53472222222223, 26.914379831881213, 24.015396712662337], 'topk_indices': array([  14, 8187, 8056, 2903, 8196, 8090, 3650, 8184, 8100, 8193, 8189,
       2915, 2904, 3645, 8192, 8185, 8190, 8197,    0, 8198]), 'topk_tokens': ['\n', ' was', ' context', ' apple', ':', '.\n\n', ' bedroom', 'Question', ' location', '?', ' apple', ' the', '.', '.', ' garden', ':', ' before', '<|eot_id|>', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [582.6875, 533.6, 207.0, 128.275]}, 'weight': {'score': [24.682421875, 23.29172189213894, 20.56640625, 23.30034839397472, 29.582183441558442], 'topk_indices': array([3321, 3294, 3166, 3214, 7441, 7479, 1519, 1457, 4322, 4338, 5221,
       5160, 7218, 7162, 3483, 3509, 4917, 4942, 4985, 5014]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.681640625, 25.8265625, 20.927083333333332, 26.4453125]}, 'saliency': {'score': [2.1522705078125, 0.155390360179578, 0.6773749457465278, 0.14818345773350258, 0.1841363287591315], 'topk_indices': array([8099, 4741,  124, 8187, 8195, 8090, 2901, 8186, 8193, 3646, 3647,
       2900, 8056, 8100, 2903, 8184, 8189, 8192, 3650, 8190]), 'topk_tokens': [' first', ' garden', ' Mary', ' was', 'Answer', '.\n\n', ' got', ' Where', '?', ' Daniel', ' travelled', ' Daniel', ' context', ' location', ' apple', 'Question', ' apple', ' garden', ' bedroom', ' before'], 'evidence_proportions': [4.032958984375, 3.263671875, 1.03955078125, 0.87158203125]}}, 'pred_res': "Daniel's house.<|eot_id|>", 'score': 0}
2025-01-22 18:28:43.430 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:28:43.430 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-102_pid-0_3-4-6-8.pkl | len: 3 |  size: 2.01 KB
Processing depth (3, 4, 6, 8):   1%|          | 1/100 [00:38<1:02:49, 38.08s/it]is_0k: False
your chose emoji: ['ğŸ§‘\u200dğŸ¦¯\u200dâ¡', 'ğŸ–±', 'ğŸ‘©ğŸ¾\u200dğŸ¤\u200dğŸ‘¨ğŸ¼', 'ğŸ‘¦', 'ğŸš¶ğŸ»\u200dâ™€ï¸', 'ğŸ’†ğŸ»\u200dâ™‚', 'ğŸ§ğŸ½', 'ğŸ§€', 'ğŸ’‚ğŸ½\u200dâ™€ï¸', 'ğŸ™‹ğŸ¼\u200dâ™‚ï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  3.93s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.41s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.24s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.98s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.44s/it]
Processing depth (0, 4, 6, 7):   1%|          | 1/100 [00:53<1:02:49, 38.08s/it]2025-01-22 18:28:59.040 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the apple.
2025-01-22 18:28:59.085 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel travelled to the bedroom.
2025-01-22 18:28:59.106 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3613, 3618) --> . Daniel travelled to the
2025-01-22 18:28:59.107 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the garden.
2025-01-22 18:28:59.131 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4711, 4717) --> . Daniel went back to the
2025-01-22 18:28:59.131 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary travelled to the bathroom.
2025-01-22 18:28:59.161 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5638, 5643) --> . Mary travelled to the
2025-01-22 18:28:59.162 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bedroom.
2025-01-22 18:28:59.201 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6639, 6644) -->  Mary moved to the bedroom
2025-01-22 18:28:59.201 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the kitchen.
2025-01-22 18:28:59.219 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3456, 3462) --> . Sandra went back to the
2025-01-22 18:28:59.219 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary picked up the milk.
2025-01-22 18:28:59.235 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3329, 3334) -->  Mary picked up the milk
2025-01-22 18:28:59.236 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary put down the milk.
2025-01-22 18:28:59.236 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (148, 153) --> . Mary put down the
2025-01-22 18:28:59.236 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went to the bathroom.
2025-01-22 18:28:59.265 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5412, 5417) --> . John went to the
2025-01-22 18:28:59.265 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra moved to the hallway.
2025-01-22 18:28:59.287 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (4071, 4076) --> . Sandra moved to the
2025-01-22 18:28:59.287 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  John went to the hallway.
2025-01-22 18:28:59.315 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (5412, 5417) --> . John went to the
2025-01-22 18:28:59.315 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 18:28:59.315 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 18:28:59.315 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 18:28:59.315 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸš¹', 'ğŸ‘©ğŸ½\u200dğŸ”§', 'ğŸ›', 'ğŸ¤œğŸ»', 'ğŸŸ§', 'ğŸ„ğŸ¿\u200dâ™€ï¸', 'ğŸ’', 'ğŸ‘©ğŸ¾\u200dâš–', 'ğŸ˜', 'ğŸ']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.55s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.90s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.73s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.30s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.83s/it]
Processing depth (0, 2, 3, 5):   1%|          | 1/100 [01:11<1:02:49, 38.08s/it]2025-01-22 18:29:16.461 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the apple.
2025-01-22 18:29:16.506 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel travelled to the bedroom.
2025-01-22 18:29:16.516 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2009, 2014) -->  cable. Daniel travelled to
2025-01-22 18:29:16.516 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the garden.
2025-01-22 18:29:16.532 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3048, 3054) --> . Daniel went back to the
2025-01-22 18:29:16.532 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary travelled to the bathroom.
2025-01-22 18:29:16.556 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4284, 4289) --> . Mary travelled to the
2025-01-22 18:29:16.556 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bedroom.
2025-01-22 18:29:16.592 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6692, 6697) --> . Mary moved to the
2025-01-22 18:29:16.592 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the kitchen.
2025-01-22 18:29:16.610 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3578, 3584) -->  Sandra went back to the kitchen
2025-01-22 18:29:16.610 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary picked up the milk.
2025-01-22 18:29:16.630 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3565, 3570) --> . Mary picked up the
2025-01-22 18:29:16.630 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary put down the milk.
2025-01-22 18:29:16.631 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (148, 153) --> . Mary put down the
2025-01-22 18:29:16.631 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went to the bathroom.
2025-01-22 18:29:16.661 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5600, 5605) --> . John went to the
2025-01-22 18:29:16.661 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra moved to the hallway.
2025-01-22 18:29:16.681 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (4146, 4151) --> . Sandra moved to the
2025-01-22 18:29:16.681 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  John went to the hallway.
2025-01-22 18:29:16.711 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (5600, 5605) --> . John went to the
2025-01-22 18:29:16.711 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 18:29:16.711 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 18:29:16.711 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 18:29:16.711 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸšƒ', 'ğŸ©º', 'ğŸ¤³ğŸ»', 'ğŸº', 'ğŸ¦¸ğŸ¾\u200dâ™‚ï¸', 'ã€°ï¸', 'ğŸ‘¨ğŸ½\u200dâ¤\u200dğŸ‘¨ğŸ¼', 'ğŸ•µğŸ»\u200dâ™€ï¸', 'ğŸ‘©ğŸ¿\u200dâ¤\u200dğŸ’‹\u200dğŸ‘©ğŸ½', 'ğŸ‘¨ğŸ½\u200dğŸ¨']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.09s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.65s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.77s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.36s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.81s/it]
Processing depth (2, 4, 7, 9):   1%|          | 1/100 [01:28<1:02:49, 38.08s/it]2025-01-22 18:29:34.157 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the apple.
2025-01-22 18:29:34.167 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1740, 1744) -->  Daniel got the apple
2025-01-22 18:29:34.168 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel travelled to the bedroom.
2025-01-22 18:29:34.188 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3607, 3612) --> . Daniel travelled to the
2025-01-22 18:29:34.188 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the garden.
2025-01-22 18:29:34.217 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5643, 5649) --> . Daniel went back to the
2025-01-22 18:29:34.217 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary travelled to the bathroom.
2025-01-22 18:29:34.255 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7226, 7231) --> . Mary travelled to the
2025-01-22 18:29:34.255 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bedroom.
2025-01-22 18:29:34.291 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6664, 6669) --> . Mary moved to the
2025-01-22 18:29:34.291 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the kitchen.
2025-01-22 18:29:34.309 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3450, 3456) --> . Sandra went back to the
2025-01-22 18:29:34.309 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary picked up the milk.
2025-01-22 18:29:34.325 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3322, 3327) --> . Mary picked up the
2025-01-22 18:29:34.325 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary put down the milk.
2025-01-22 18:29:34.326 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (111, 116) --> . Mary put down the
2025-01-22 18:29:34.326 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went to the bathroom.
2025-01-22 18:29:34.358 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5417, 5422) --> . John went to the
2025-01-22 18:29:34.358 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra moved to the hallway.
2025-01-22 18:29:34.382 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (4065, 4070) --> . Sandra moved to the
2025-01-22 18:29:34.382 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  John went to the hallway.
2025-01-22 18:29:34.412 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (5417, 5422) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:29:35.272 | INFO     | test_jbb_embedding:begin_test:693 - The doctor's office.<|eot_id|>
2025-01-22 18:29:35.272 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8178])
2025-01-22 18:29:37.490 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [376.39375, 31.354086450311698, 152.29166666666666, 29.968911538461537, 19.085426682692308], 'topk_indices': array([8159, 8163,   14, 8160, 1740, 8066, 1744, 8169, 3609, 8161, 8165,
       8168, 8076,  191, 3612, 8166, 1743, 8173,    0, 8174]), 'topk_tokens': ['.\n\n', ' was', '\n', 'Question', ' Daniel', '.\n\n', '.', '?', ' travelled', ':', ' apple', ' garden', ' location', 'ION', ' bedroom', ' before', ' apple', '<|eot_id|>', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [737.25, 495.15, 310.5208333333333, 48.0]}, 'weight': {'score': [22.058203125, 23.268207202664712, 20.56640625, 23.28315673076923, 29.263701923076923], 'topk_indices': array([3278, 3305, 3150, 3198, 7405, 7443, 1437, 1499, 4310, 4294, 5121,
       5182, 7120, 7176, 3474, 3500, 4975, 4946, 4923, 4898]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.681640625, 21.01875, 20.927083333333332, 20.75625]}, 'saliency': {'score': [2.35426025390625, 0.17610560697996883, 0.8514573838975694, 0.16775166766826924, 0.14176189716045673], 'topk_indices': array([8162,  112, 3608, 8169,    0, 8171, 1741, 5644, 5649, 8032, 8160,
       1740,  191, 8165, 3609, 8076, 8166, 8168, 3612, 1743]), 'topk_tokens': [' Where', ' Mary', ' Daniel', '?', '<|begin_of_text|>', 'Answer', ' got', ' Daniel', ' garden', ' context', 'Question', ' Daniel', 'ION', ' apple', ' travelled', ' location', ' before', ' garden', ' bedroom', ' apple'], 'evidence_proportions': [5.208740234375, 2.8623046875, 1.7637532552083333, 0.271240234375]}}, 'pred_res': "The doctor's office.<|eot_id|>", 'score': 0}
2025-01-22 18:29:37.496 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:29:37.496 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-102_pid-1_2-4-7-9.pkl | len: 3 |  size: 2.04 KB
Processing depth (2, 4, 7, 9):   2%|â–         | 2/100 [01:32<1:17:33, 47.48s/it]is_0k: False
your chose emoji: ['ğŸ‚', 'ğŸ’ªğŸ¿', 'ğŸŒğŸ¼\u200dâ™€', '\U0001faf8ğŸ»', 'ğŸ¤¦ğŸ½\u200dâ™‚', 'ğŸ§™ğŸ½\u200dâ™€', 'ğŸ§‘ğŸ»\u200dğŸ”¬', 'ğŸ§˜ğŸ½', '\U0001fae2', 'ğŸ§”\u200dâ™‚ï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:05<00:16,  5.58s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:11<00:11,  6.00s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:16<00:05,  5.31s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:17<00:00,  3.59s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:17<00:00,  4.33s/it]
Processing depth (3, 4, 5, 7):   2%|â–         | 2/100 [01:51<1:17:33, 47.48s/it]2025-01-22 18:29:57.206 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the apple.
2025-01-22 18:29:57.222 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2968, 2972) -->  Daniel got the apple
2025-01-22 18:29:57.222 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel travelled to the bedroom.
2025-01-22 18:29:57.244 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3626, 3631) -->  Hon. Daniel travelled to
2025-01-22 18:29:57.245 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the garden.
2025-01-22 18:29:57.268 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4234, 4240) -->  Daniel went back to the garden
2025-01-22 18:29:57.269 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary travelled to the bathroom.
2025-01-22 18:29:57.296 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5624, 5629) --> . Mary travelled to the
2025-01-22 18:29:57.297 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bedroom.
2025-01-22 18:29:57.332 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6660, 6665) --> . Mary moved to the
2025-01-22 18:29:57.332 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the kitchen.
2025-01-22 18:29:57.351 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3528, 3534) --> . Sandra went back to the
2025-01-22 18:29:57.351 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary picked up the milk.
2025-01-22 18:29:57.368 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3476, 3481) --> . Mary picked up the
2025-01-22 18:29:57.368 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary put down the milk.
2025-01-22 18:29:57.369 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (143, 148) --> . Mary put down the
2025-01-22 18:29:57.369 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went to the bathroom.
2025-01-22 18:29:57.399 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5428, 5433) --> . John went to the
2025-01-22 18:29:57.399 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra moved to the hallway.
2025-01-22 18:29:57.420 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (4109, 4114) --> . Sandra moved to the
2025-01-22 18:29:57.420 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  John went to the hallway.
2025-01-22 18:29:57.447 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (5428, 5433) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:29:58.297 | INFO     | test_jbb_embedding:begin_test:693 - Daniel got the apple.<|eot_id|>
2025-01-22 18:29:58.297 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8170])
2025-01-22 18:30:00.527 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [349.0265625, 25.470386485990456, 117.01215277777777, 24.267155352962916, 22.17795850409836], 'topk_indices': array([8058, 2967, 8153,  145, 8157,  149,    3, 2968, 8161, 2970, 2969,
       8160, 8158,  160, 2972,  161, 8165, 2971,    0, 8166]), 'topk_tokens': ['.\n\n', '.', ':', ' put', ' apple', '.', '<|end_header_id|>', ' Daniel', '?', ' the', ' got', ' garden', ' before', 'UG', '.', 'G', '<|eot_id|>', ' apple', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [945.375, 240.0, 275.6875, 68.98125]}, 'weight': {'score': [24.388671875, 23.26091436742934, 20.56640625, 23.270086123259826, 29.17238729508197], 'topk_indices': array([3248, 3275, 3168, 3120, 7405, 7443, 1417, 1479, 4287, 4303, 5132,
       5193, 7182, 7126, 3441, 3467, 4974, 4897, 4922, 4945]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.681640625, 25.8265625, 24.688802083333332, 20.75625]}, 'saliency': {'score': [2.288055419921875, 0.14101228535459745, 0.6558719211154513, 0.13343857467593093, 0.1609256931992828], 'topk_indices': array([8155,  159,  144, 8154,  148, 3632, 4239, 8068, 8024, 8161, 8152,
        145, 8157, 2968, 2969, 8158, 8160,  161,  160, 2971]), 'topk_tokens': [' was', ' STR', ' Mary', ' Where', ' milk', ' bedroom', ' garden', ' location', ' context', '?', 'Question', ' put', ' apple', ' Daniel', ' got', ' before', ' garden', 'G', 'UG', ' apple'], 'evidence_proportions': [6.42578125, 1.5615234375, 1.7037760416666667, 0.4055419921875]}}, 'pred_res': 'Daniel got the apple.<|eot_id|>', 'score': 0}
2025-01-22 18:30:00.533 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:30:00.533 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-102_pid-2_3-4-5-7.pkl | len: 3 |  size: 1.99 KB
Processing depth (3, 4, 5, 7):   3%|â–         | 3/100 [01:55<58:43, 36.32s/it]  is_0k: False
your chose emoji: ['ğŸ’', '\U0001fac5ğŸ½', 'ğŸ™ğŸ¾\u200dâ™‚', 'ğŸ¤·', 'ğŸ’†ğŸ½\u200dâ™‚ï¸', 'ğŸ‡§ğŸ‡®', 'ğŸ‡¹ğŸ‡·', 'ğŸ’‡ğŸ½', 'ğŸ¤½ğŸ»\u200dâ™€', 'ğŸ‡§ğŸ‡§']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.29s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:10,  5.04s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:15<00:05,  5.09s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  3.51s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  4.02s/it]
Processing depth (2, 3, 4, 6):   3%|â–         | 3/100 [02:12<58:43, 36.32s/it]2025-01-22 18:30:18.346 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the apple.
2025-01-22 18:30:18.356 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1804, 1808) -->  Daniel got the apple
2025-01-22 18:30:18.356 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel travelled to the bedroom.
2025-01-22 18:30:18.373 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2888, 2893) --> . Daniel travelled to the
2025-01-22 18:30:18.374 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the garden.
2025-01-22 18:30:18.392 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3634, 3640) -->  Hon. Daniel went back to
2025-01-22 18:30:18.392 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary travelled to the bathroom.
2025-01-22 18:30:18.415 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4632, 4637) --> . Mary travelled to the
2025-01-22 18:30:18.415 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bedroom.
2025-01-22 18:30:18.456 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6644, 6649) --> . Mary moved to the
2025-01-22 18:30:18.456 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the kitchen.
2025-01-22 18:30:18.474 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3508, 3514) --> . Sandra went back to the
2025-01-22 18:30:18.474 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary picked up the milk.
2025-01-22 18:30:18.491 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3450, 3455) --> . Mary picked up the
2025-01-22 18:30:18.491 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary put down the milk.
2025-01-22 18:30:18.492 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (143, 148) --> . Mary put down the
2025-01-22 18:30:18.492 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went to the bathroom.
2025-01-22 18:30:18.519 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5240, 5245) --> . John went to the
2025-01-22 18:30:18.519 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra moved to the hallway.
2025-01-22 18:30:18.539 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (4060, 4065) --> . Sandra moved to the
2025-01-22 18:30:18.539 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  John went to the hallway.
2025-01-22 18:30:18.565 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (5240, 5245) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:30:19.387 | INFO     | test_jbb_embedding:begin_test:693 - The capitol<|eot_id|>
2025-01-22 18:30:19.387 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8162])
2025-01-22 18:30:21.602 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [170.559375, 17.611941212492347, 62.673611111111114, 17.034660562338143, 14.49645353618421], 'topk_indices': array([8161,    9,   24, 8145, 3641, 2893, 8143, 1807, 8151, 8153,    3,
       8060, 8050, 8152, 8160, 8150,   14,    0, 8157, 8158]), 'topk_tokens': ['\n\n', ':', '\n\n', ':', ' garden', ' bedroom', '.\n\n', ' apple', ' the', '?', '<|end_header_id|>', ' location', '.\n\n', ' garden', '<|end_header_id|>', ' before', '\n', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [319.6875, 167.825, 180.41666666666666, 42.1625]}, 'weight': {'score': [23.26015625, 23.259581674831598, 20.56640625, 23.271536641386113, 29.491776315789473], 'topk_indices': array([3284, 3311, 3156, 3204, 7395, 7433, 1501, 1439, 4319, 4335, 5207,
       5146, 7172, 7116, 3473, 3499, 4913, 4938, 4961, 4990]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.681640625, 21.01875, 24.93359375, 20.75625]}, 'saliency': {'score': [1.051641845703125, 0.09777955372349587, 0.338714599609375, 0.09435731824544873, 0.10700118750856634], 'topk_indices': array([8159, 2890, 1805, 8021,   14, 8059, 8143, 8146, 8155, 8050, 8153,
       1804, 8149, 8144, 3641, 1807, 8060, 2893, 8152, 8150]), 'topk_tokens': ['assistant', ' travelled', ' got', ' locations', '\n', ' first', '.\n\n', ' Where', 'Answer', '.\n\n', '?', ' Daniel', ' apple', 'Question', ' garden', ' apple', ' location', ' bedroom', ' garden', ' before'], 'evidence_proportions': [2.21875, 0.9376953125, 1.0488688151041667, 0.2352294921875]}}, 'pred_res': 'The capitol<|eot_id|>', 'score': 0}
2025-01-22 18:30:21.608 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:30:21.608 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-102_pid-3_2-3-4-6.pkl | len: 3 |  size: 2.02 KB
Processing depth (2, 3, 4, 6):   4%|â–         | 4/100 [02:16<48:28, 30.30s/it]is_0k: False
your chose emoji: ['ğŸ’°', 'ğŸ’´', 'ğŸ‘¨\u200dğŸ‘¦\u200dğŸ‘¦', 'âš”ï¸', 'ğŸ‘¨ğŸ¼\u200dğŸ¼', 'ğŸ™\u200dâ™€ï¸', 'â˜€', 'ğŸ§Ÿ', 'ğŸ‡¹ğŸ‡¼', 'ğŸ‘©ğŸ»\u200dğŸ¦¯\u200dâ¡']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.54s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.79s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.54s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.17s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.71s/it]
Processing depth (5, 6, 7, 8):   4%|â–         | 4/100 [02:32<48:28, 30.30s/it]2025-01-22 18:30:38.112 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the apple.
2025-01-22 18:30:38.134 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4185, 4189) -->  Daniel got the apple
2025-01-22 18:30:38.134 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel travelled to the bedroom.
2025-01-22 18:30:38.157 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4657, 4662) --> . Daniel travelled to the
2025-01-22 18:30:38.157 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the garden.
2025-01-22 18:30:38.187 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5635, 5641) --> . Daniel went back to the
2025-01-22 18:30:38.188 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary travelled to the bathroom.
2025-01-22 18:30:38.225 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6566, 6571) --> . Mary travelled to the
2025-01-22 18:30:38.226 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bedroom.
2025-01-22 18:30:38.259 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6702, 6707) --> . Mary moved to the
2025-01-22 18:30:38.259 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the kitchen.
2025-01-22 18:30:38.277 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3491, 3497) --> . Sandra went back to the
2025-01-22 18:30:38.277 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary picked up the milk.
2025-01-22 18:30:38.297 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3363, 3368) --> . Mary picked up the
2025-01-22 18:30:38.298 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary put down the milk.
2025-01-22 18:30:38.299 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (143, 148) --> . Mary put down the
2025-01-22 18:30:38.299 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went to the bathroom.
2025-01-22 18:30:38.327 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5367, 5372) --> . John went to the
2025-01-22 18:30:38.327 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra moved to the hallway.
2025-01-22 18:30:38.348 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (4100, 4105) --> . Sandra moved to the
2025-01-22 18:30:38.348 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  John went to the hallway.
2025-01-22 18:30:38.379 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (5367, 5372) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:30:39.195 | INFO     | test_jbb_embedding:begin_test:693 - The hallway.<|eot_id|>
2025-01-22 18:30:39.195 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8206])
2025-01-22 18:30:41.429 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [236.925, 20.904021120112073, 111.14149305555556, 19.97565505028824, 14.790793117088608], 'topk_indices': array([4659, 8059,    9, 8193, 4185, 8104, 8200, 8094, 4189, 8187,    1,
         24, 8060, 8202, 4188,   14, 4662, 8204,    0, 8201]), 'topk_tokens': [' travelled', ' you', ':', ' apple', ' Daniel', ' location', ':', '.\n\n', '.', '.\n\n', '<|start_header_id|>', '\n\n', ' context', '<|start_header_id|>', ' apple', '\n', ' bedroom', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [463.375, 348.6, 147.11458333333334, 51.8625]}, 'weight': {'score': [22.058203125, 23.302280652332804, 20.56640625, 23.317412877161782, 29.974683544303797], 'topk_indices': array([3319, 3346, 3191, 3239, 7491, 7453, 1491, 1429, 4326, 4342, 5161,
       5222, 7230, 7174, 3515, 3541, 4986, 4938, 4963, 5015]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.681640625, 21.01875, 20.927083333333332, 20.75625]}, 'saliency': {'score': [1.4568389892578124, 0.11764269482713333, 0.610809326171875, 0.11217992963431789, 0.112030029296875], 'topk_indices': array([8059,   14,    8, 8175, 8188, 8094, 8058,   24, 8187, 8194, 8199,
       4186, 4658, 8104, 8193, 4185, 4659, 8060, 4188, 4662]), 'topk_tokens': [' you', '\n', ' Date', ' return', 'Question', '.\n\n', ' provided', '\n\n', '.\n\n', ' before', 'Answer', ' got', ' Daniel', ' location', ' apple', ' Daniel', ' travelled', ' context', ' apple', ' bedroom'], 'evidence_proportions': [3.244140625, 2.00751953125, 0.7665201822916666, 0.30469970703125]}}, 'pred_res': 'The hallway.<|eot_id|>', 'score': 0}
2025-01-22 18:30:41.436 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:30:41.436 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-102_pid-4_5-6-7-8.pkl | len: 3 |  size: 2.03 KB
Processing depth (5, 6, 7, 8):   5%|â–Œ         | 5/100 [02:36<41:59, 26.52s/it]Processing depth (5, 6, 7, 8):   5%|â–Œ         | 5/100 [02:36<49:26, 31.23s/it]
2025-01-22 18:30:41.509 | INFO     | __main__:<module>:82 - Selected idx: 104
2025-01-22 18:30:41.509 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the football before the bathroom? 
2025-01-22 18:30:41.509 | INFO     | __main__:<module>:84 - Answer: bedroom
2025-01-22 18:30:41.509 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 18:30:41.509 | INFO     | __main__:<module>:86 - Needle: [' Mary moved to the bedroom.', ' Mary picked up the milk.', ' John went to the bathroom.', ' Sandra grabbed the football.', ' John went to the hallway.', ' Sandra went to the bedroom.', ' Mary put down the milk.', ' Mary travelled to the bathroom.', ' Sandra journeyed to the bathroom.', ' John went to the office.']
2025-01-22 18:30:41.509 | INFO     | __main__:<module>:87 - Real Needle: [' Sandra grabbed the football.', ' Sandra went to the bedroom.', ' Sandra journeyed to the bathroom.', ' John went to the office.']
2025-01-22 18:30:41.509 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸªŸ', 'ğŸ˜°', 'â„¢ï¸', 'ğŸ¤µ\u200dâ™‚ï¸', 'ğŸ¤¸ğŸ¾\u200dâ™‚ï¸', 'ğŸ’˜', 'ğŸ‘©ğŸ¿\u200dâ¤\u200dğŸ‘¨ğŸ¼', 'ğŸš¶ğŸ¿\u200dâ™‚\u200dâ¡ï¸', 'ğŸ§‘ğŸ¾\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ§‘ğŸ¿', 'ğŸ¤¾ğŸ¼']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.29s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.63s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.50s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.91s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.49s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 1, 2, 6):   0%|          | 0/100 [00:15<?, ?it/s]2025-01-22 18:30:57.387 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra grabbed the football.
2025-01-22 18:30:57.430 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went to the bedroom.
2025-01-22 18:30:57.435 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (907, 912) --> . Sandra went to the
2025-01-22 18:30:57.435 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra journeyed to the bathroom.
2025-01-22 18:30:57.445 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1876, 1882) -->  Sandra journeyed to the bathroom
2025-01-22 18:30:57.445 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 18:30:57.474 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3756, 3761) --> . John went to the
2025-01-22 18:30:57.474 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bedroom.
2025-01-22 18:30:57.475 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (149, 154) --> . Mary moved to the
2025-01-22 18:30:57.475 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary picked up the milk.
2025-01-22 18:30:57.481 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1057, 1062) --> . Mary picked up the
2025-01-22 18:30:57.481 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went to the bathroom.
2025-01-22 18:30:57.503 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3756, 3761) --> . John went to the
2025-01-22 18:30:57.503 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the hallway.
2025-01-22 18:30:57.524 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3756, 3761) --> . John went to the
2025-01-22 18:30:57.524 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary put down the milk.
2025-01-22 18:30:57.544 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4030, 4035) --> . Mary put down the
2025-01-22 18:30:57.544 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary travelled to the bathroom.
2025-01-22 18:30:57.579 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (7012, 7017) --> . Mary travelled to the
2025-01-22 18:30:57.579 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 18:30:57.579 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 18:30:57.579 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 18:30:57.579 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ¤¥', 'ğŸš¶ğŸ½\u200dâ™€', 'ğŸ‡¸ğŸ‡¹', 'ğŸš¶\u200dâ™€', 'ğŸ³', 'ğŸ¤¹', 'ğŸŒ‘', 'ğŸ‘©ğŸ¾\u200dâ¤\u200dğŸ’‹\u200dğŸ‘¨ğŸ¿', 'ğŸ‡²ğŸ‡¹', 'ğŸ‘©\u200dâš•ï¸']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.11s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.48s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.41s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.13s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.59s/it]
Processing depth (6, 7, 8, 9):   0%|          | 0/100 [00:31<?, ?it/s]2025-01-22 18:31:13.607 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra grabbed the football.
2025-01-22 18:31:13.632 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4896, 4900) -->  Sandra grabbed the football
2025-01-22 18:31:13.632 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went to the bedroom.
2025-01-22 18:31:13.664 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5762, 5767) --> . Sandra went to the
2025-01-22 18:31:13.664 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra journeyed to the bathroom.
2025-01-22 18:31:13.702 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6668, 6674) --> . Sandra journeyed to the
2025-01-22 18:31:13.702 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 18:31:13.723 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3799, 3804) --> . John went to the
2025-01-22 18:31:13.723 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bedroom.
2025-01-22 18:31:13.724 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (143, 148) --> . Mary moved to the
2025-01-22 18:31:13.724 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary picked up the milk.
2025-01-22 18:31:13.729 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1045, 1050) --> . Mary picked up the
2025-01-22 18:31:13.729 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went to the bathroom.
2025-01-22 18:31:13.750 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3799, 3804) --> . John went to the
2025-01-22 18:31:13.750 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the hallway.
2025-01-22 18:31:13.770 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3799, 3804) --> . John went to the
2025-01-22 18:31:13.770 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary put down the milk.
2025-01-22 18:31:13.794 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4085, 4090) --> . Mary put down the
2025-01-22 18:31:13.794 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary travelled to the bathroom.
2025-01-22 18:31:13.830 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (7089, 7094) --> . Mary travelled to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:31:14.614 | INFO     | test_jbb_embedding:begin_test:693 - Sandra<|eot_id|>
2025-01-22 18:31:14.614 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8219])
2025-01-22 18:31:16.900 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [294.140625, 34.2577953964972, 175.625, 33.102793838717574, 29.2842345505618], 'topk_indices': array([8218, 8117, 8107, 8073, 8200, 4896, 8204, 4900, 8201, 8202,   14,
         24, 4899, 8209, 8206, 8207, 8215, 8214, 8217,    0]), 'topk_tokens': ['\n\n', ' location', '.\n\n', ' context', '.\n\n', ' Sandra', ' was', '.', 'Question', ':', '\n', '\n\n', ' football', ' bathroom', ' football', ' before', '<|start_header_id|>', '<|eot_id|>', '<|end_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [783.125, 219.65, 164.67708333333334, 132.8]}, 'weight': {'score': [22.223828125, 23.30782504256872, 20.258333333333333, 23.32167289984092, 29.466643258426966], 'topk_indices': array([3265, 3292, 3137, 3185, 7472, 7510, 1411, 1473, 4298, 4314, 5205,
       5144, 7249, 7193, 3448, 3474, 4969, 4921, 4946, 4998]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [30.005859375, 20.796875, 21.213541666666668, 18.6375]}, 'saliency': {'score': [1.9780029296875, 0.19261725817072337, 0.9316365559895833, 0.1855347456444261, 0.2142152250482795], 'topk_indices': array([8107, 8210, 8216, 8204, 8200, 5767, 7094, 8188, 8203, 8117,   24,
       4897, 8073, 6273, 8201, 4896, 8207, 4899, 8206, 8209]), 'topk_tokens': ['.\n\n', '?', 'assistant', ' was', '.\n\n', ' bedroom', ' bathroom', ' return', ' Where', ' location', '\n\n', ' grabbed', ' context', ' bathroom', 'Question', ' Sandra', ' before', ' football', ' football', ' bathroom'], 'evidence_proportions': [6.01953125, 1.272802734375, 0.9535725911458334, 0.679296875]}}, 'pred_res': 'Sandra<|eot_id|>', 'score': 0}
2025-01-22 18:31:16.916 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:31:16.916 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-104_pid-0_6-7-8-9.pkl | len: 3 |  size: 2.04 KB
Processing depth (6, 7, 8, 9):   1%|          | 1/100 [00:35<58:16, 35.32s/it]is_0k: False
your chose emoji: ['ğŸ‘©ğŸ¾\u200dâ¤\u200dğŸ‘©ğŸ¿', 'ğŸƒğŸ»\u200dâ™‚ï¸\u200dâ¡ï¸', 'ğŸ‘¨ğŸ¼\u200dğŸš€', 'ğŸ§™ğŸ½', 'ğŸ‘¨ğŸ¾\u200dğŸ¦¼', 'â¬œ', 'ğŸˆ\u200dâ¬›', 'ğŸ‘©ğŸ»\u200dâ¤\u200dğŸ‘©ğŸ¿', 'ğŸ§\u200dâ™€ï¸', 'ğŸ‘³']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.61s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.80s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.42s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.85s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.49s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (2, 4, 6, 7):   1%|          | 1/100 [00:51<58:16, 35.32s/it]2025-01-22 18:31:32.983 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra grabbed the football.
2025-01-22 18:31:32.995 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1822, 1826) -->  Sandra grabbed the football
2025-01-22 18:31:32.995 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went to the bedroom.
2025-01-22 18:31:33.015 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3643, 3648) -->  Hon. Sandra went to
2025-01-22 18:31:33.015 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra journeyed to the bathroom.
2025-01-22 18:31:33.044 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4882, 4888) --> . Sandra journeyed to the
2025-01-22 18:31:33.045 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 18:31:33.064 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3778, 3783) --> . John went to the
2025-01-22 18:31:33.064 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bedroom.
2025-01-22 18:31:33.065 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (143, 148) --> . Mary moved to the
2025-01-22 18:31:33.065 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary picked up the milk.
2025-01-22 18:31:33.070 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (947, 952) --> . Mary picked up the
2025-01-22 18:31:33.070 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went to the bathroom.
2025-01-22 18:31:33.089 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3778, 3783) --> . John went to the
2025-01-22 18:31:33.089 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the hallway.
2025-01-22 18:31:33.110 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3778, 3783) --> . John went to the
2025-01-22 18:31:33.110 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary put down the milk.
2025-01-22 18:31:33.132 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4052, 4057) --> . Mary put down the
2025-01-22 18:31:33.132 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary travelled to the bathroom.
2025-01-22 18:31:33.169 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (7019, 7024) --> . Mary travelled to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:31:35.439 | INFO     | test_jbb_embedding:begin_test:693 - the bedroom<|eot_id|>
2025-01-22 18:31:35.439 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8207])
2025-01-22 18:31:38.200 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [162.87109375, 17.360296132764923, 79.64375, 16.774668734681374, 13.421216114457831], 'topk_indices': array([8200, 8188, 1822, 8190,    4, 8195, 8105, 8206, 8095, 8061, 3649,
         24,    1,    9, 8201, 1825,   14, 8205,    0, 8202]), 'topk_tokens': ['Answer', '.\n\n', ' Sandra', ':', '\n\n', ' before', ' location', '\n\n', '.\n\n', ' context', ' bedroom', '\n\n', '<|start_header_id|>', ':', ':', ' football', '\n', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [419.25, 147.50625, 113.14583333333333, 32.803125]}, 'weight': {'score': [23.42578125, 23.311023142509136, 20.258333333333333, 23.321964996936273, 30.070030120481928], 'topk_indices': array([3333, 3306, 3226, 3178, 7468, 7430, 1457, 1519, 4319, 4303, 5133,
       5194, 7151, 7207, 3515, 3489, 4910, 4987, 4958, 4935]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [30.005859375, 25.6046875, 21.213541666666668, 18.6375]}, 'saliency': {'score': [1.1267547607421875, 0.09764385711261038, 0.422503662109375, 0.093927188948089, 0.10119049807628953], 'topk_indices': array([  14, 8176, 8204,   24, 4888,  148, 8095,    8, 4285, 8195, 1823,
       8189, 8200, 8194, 8105, 8197, 8061, 1822, 3649, 1825]), 'topk_tokens': ['\n', ' return', 'assistant', '\n\n', ' bathroom', ' bedroom', '.\n\n', ' Date', 'nes', ' before', ' grabbed', 'Question', 'Answer', ' football', ' location', ' bathroom', ' context', ' Sandra', ' bedroom', ' football'], 'evidence_proportions': [3.2822265625, 0.93525390625, 0.6526082356770834, 0.16285400390625]}}, 'pred_res': 'the bedroom<|eot_id|>', 'score': 100}
2025-01-22 18:31:38.212 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:31:38.212 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-104_pid-1_2-4-6-7.pkl | len: 3 |  size: 2.02 KB
Processing depth (2, 4, 6, 7):   2%|â–         | 2/100 [00:56<44:12, 27.07s/it]is_0k: False
your chose emoji: ['ğŸ’†ğŸ¼\u200dâ™‚ï¸', 'â˜¯ï¸', 'ğŸ‘¨\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘¨', 'ğŸ¤·\u200dâ™€ï¸', 'ğŸ‘©ğŸ»\u200dğŸ¤\u200dğŸ‘¨ğŸ½', 'ğŸ’…ğŸ¾', 'ğŸ§”ğŸ»\u200dâ™€ï¸', 'ğŸ‡°ğŸ‡³', 'ğŸ§–ğŸ¼', 'ğŸ§™ğŸ¾\u200dâ™€ï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.78s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.74s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.69s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.28s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.81s/it]
Processing depth (5, 6, 7, 9):   2%|â–         | 2/100 [01:13<44:12, 27.07s/it]2025-01-22 18:31:55.400 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra grabbed the football.
2025-01-22 18:31:55.422 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4246, 4250) -->  Sandra grabbed the football
2025-01-22 18:31:55.423 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went to the bedroom.
2025-01-22 18:31:55.452 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4854, 4859) --> . Sandra went to the
2025-01-22 18:31:55.452 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra journeyed to the bathroom.
2025-01-22 18:31:55.486 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5652, 5658) --> . Sandra journeyed to the
2025-01-22 18:31:55.486 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 18:31:55.509 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3783, 3788) --> . John went to the
2025-01-22 18:31:55.509 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bedroom.
2025-01-22 18:31:55.510 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (143, 148) --> . Mary moved to the
2025-01-22 18:31:55.510 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary picked up the milk.
2025-01-22 18:31:55.516 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (977, 982) --> . Mary picked up the
2025-01-22 18:31:55.516 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went to the bathroom.
2025-01-22 18:31:55.535 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3783, 3788) --> . John went to the
2025-01-22 18:31:55.535 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the hallway.
2025-01-22 18:31:55.556 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3783, 3788) --> . John went to the
2025-01-22 18:31:55.556 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary put down the milk.
2025-01-22 18:31:55.579 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4033, 4038) --> . Mary put down the
2025-01-22 18:31:55.579 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary travelled to the bathroom.
2025-01-22 18:31:55.617 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (7007, 7012) --> . Mary travelled to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:31:56.383 | INFO     | test_jbb_embedding:begin_test:693 - the bedroom<|eot_id|>
2025-01-22 18:31:56.383 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8189])
2025-01-22 18:31:58.600 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [186.3203125, 17.357507705688477, 107.1, 16.61180261299435, 20.528927364864863], 'topk_indices': array([8188, 8043, 8077,    3, 8182, 8087,    9, 8179, 4249, 8174, 8172,
         24, 8176, 4859, 8183,   14, 8177, 8187,    0, 8184]), 'topk_tokens': ['\n\n', ' context', '.\n\n', '<|end_header_id|>', 'Answer', ' location', ':', ' bathroom', ' football', ' was', ':', '\n\n', ' football', ' bedroom', ':', '\n', ' before', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [344.25, 200.725, 149.39583333333334, 89.88125]}, 'weight': {'score': [22.223828125, 23.275936126708984, 20.258333333333333, 23.28963917802751, 28.94995777027027], 'topk_indices': array([3249, 3276, 3121, 3169, 7462, 7424, 1485, 1423, 4255, 4271, 5165,
       5104, 7195, 7139, 3458, 3432, 4929, 4958, 4906, 4881]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [30.005859375, 20.796875, 21.213541666666668, 18.6375]}, 'saliency': {'score': [1.18428955078125, 0.0971427857875824, 0.57147216796875, 0.09272460637646616, 0.14776363888302366], 'topk_indices': array([8160, 8186, 4247,  148, 8174, 8158, 5658,   24, 7922, 8173, 8043,
       8171, 8087, 4246, 8182, 4249, 8179, 8176, 8177, 4859]), 'topk_tokens': [' location', 'assistant', ' grabbed', ' bedroom', ' was', ' return', ' bathroom', '\n\n', ' Square', ' Where', ' context', 'Question', ' location', ' Sandra', 'Answer', ' football', ' bathroom', ' football', ' before', ' bedroom'], 'evidence_proportions': [2.664794921875, 1.096240234375, 0.8775227864583334, 0.4560546875]}}, 'pred_res': 'the bedroom<|eot_id|>', 'score': 100}
2025-01-22 18:31:58.609 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:31:58.609 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-104_pid-2_5-6-7-9.pkl | len: 3 |  size: 2.05 KB
Processing depth (5, 6, 7, 9):   3%|â–         | 3/100 [01:17<38:50, 24.02s/it]is_0k: False
your chose emoji: ['ğŸ‹ğŸ¿', 'ğŸ‘¨ğŸ¾\u200dğŸš€', 'ğŸ‘©ğŸ»\u200dâ¤ï¸\u200dğŸ‘¨ğŸ»', 'ğŸ§›ğŸ»', 'ğŸ¥©', 'ğŸ§—ğŸ¾', 'ğŸ§™ğŸ¾', 'ğŸ§”\u200dâ™€', 'ğŸ§‘ğŸ¿\u200dğŸ¦±', 'ğŸ¤¹ğŸ¿']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.44s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:10,  5.01s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.97s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  3.54s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  4.03s/it]
Processing depth (0, 4, 7, 8):   3%|â–         | 3/100 [01:34<38:50, 24.02s/it]2025-01-22 18:32:16.573 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra grabbed the football.
2025-01-22 18:32:16.615 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went to the bedroom.
2025-01-22 18:32:16.633 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3639, 3644) --> . Sandra went to the
2025-01-22 18:32:16.633 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra journeyed to the bathroom.
2025-01-22 18:32:16.666 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5633, 5639) --> . Sandra journeyed to the
2025-01-22 18:32:16.666 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 18:32:16.688 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3691, 3696) --> . John went to the
2025-01-22 18:32:16.688 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bedroom.
2025-01-22 18:32:16.689 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (149, 154) --> . Mary moved to the
2025-01-22 18:32:16.689 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary picked up the milk.
2025-01-22 18:32:16.696 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1051, 1056) --> . Mary picked up the
2025-01-22 18:32:16.696 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went to the bathroom.
2025-01-22 18:32:16.715 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3691, 3696) --> . John went to the
2025-01-22 18:32:16.715 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the hallway.
2025-01-22 18:32:16.733 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3691, 3696) --> . John went to the
2025-01-22 18:32:16.734 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary put down the milk.
2025-01-22 18:32:16.753 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3992, 3997) -->  ground. Mary put down
2025-01-22 18:32:16.754 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary travelled to the bathroom.
2025-01-22 18:32:16.793 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (7014, 7019) --> . Mary travelled to the
2025-01-22 18:32:16.793 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 18:32:16.793 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 18:32:16.793 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 18:32:16.793 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ«‘', 'ğŸ‘¨\u200dğŸ‘§\u200dğŸ‘§', 'ğŸ§ğŸ»\u200dâ™‚ï¸\u200dâ¡', 'ğŸ§—ğŸ½\u200dâ™‚', 'ğŸ‘®ğŸ¿\u200dâ™‚ï¸', 'ğŸ¤½ğŸ¼\u200dâ™‚ï¸', 'ğŸ‡¼ğŸ‡¸', 'ğŸŒ¥ï¸', 'ğŸ§›ğŸ»', 'ğŸ’ğŸ»']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  3.89s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.38s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.79s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.34s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.75s/it]
Processing depth (3, 6, 7, 9):   3%|â–         | 3/100 [01:52<38:50, 24.02s/it]2025-01-22 18:32:33.749 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra grabbed the football.
2025-01-22 18:32:33.764 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2750, 2754) -->  Sandra grabbed the football
2025-01-22 18:32:33.764 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went to the bedroom.
2025-01-22 18:32:33.797 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4623, 4628) -->  Sandra went to the bedroom
2025-01-22 18:32:33.797 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra journeyed to the bathroom.
2025-01-22 18:32:33.830 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5584, 5590) --> . Sandra journeyed to the
2025-01-22 18:32:33.831 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 18:32:33.849 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3657, 3662) -->  Hon. John went to
2025-01-22 18:32:33.849 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bedroom.
2025-01-22 18:32:33.850 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (123, 128) --> . Mary moved to the
2025-01-22 18:32:33.850 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary picked up the milk.
2025-01-22 18:32:33.855 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (983, 988) --> . Mary picked up the
2025-01-22 18:32:33.855 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went to the bathroom.
2025-01-22 18:32:33.873 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3657, 3662) -->  Hon. John went to
2025-01-22 18:32:33.873 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the hallway.
2025-01-22 18:32:33.895 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3657, 3662) -->  Hon. John went to
2025-01-22 18:32:33.895 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary put down the milk.
2025-01-22 18:32:33.917 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3892, 3897) --> . Mary put down the
2025-01-22 18:32:33.917 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary travelled to the bathroom.
2025-01-22 18:32:33.956 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (6999, 7004) --> . Mary travelled to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:32:34.742 | INFO     | test_jbb_embedding:begin_test:693 - the hallway<|eot_id|>
2025-01-22 18:32:34.743 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8173])
2025-01-22 18:32:36.968 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [223.73125, 22.890273361056753, 145.66041666666666, 21.94270705143982, 18.988014914772727], 'topk_indices': array([1537, 8156,    9,    1, 8084, 8160, 4627, 8163, 8027, 8167, 2753,
         24, 8061, 8071, 3140, 8161, 8168,   14, 8171,    0]), 'topk_tokens': [' the', ':', ':', '<|start_header_id|>', ' the', ' football', ' bedroom', ' bathroom', ' context', ':', ' football', '\n\n', '.\n\n', ' location', 'ern', ' before', '<|eot_id|>', '\n', '<|end_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [343.3125, 276.125, 171.08333333333334, 138.85]}, 'weight': {'score': [24.782421875, 23.278310757093934, 21.8609375, 23.279841519505293, 29.781013257575758], 'topk_indices': array([3347, 3320, 3192, 3240, 7464, 7426, 1457, 1519, 4349, 4365, 5166,
       5227, 7147, 7203, 3529, 3503, 4991, 4943, 4968, 5020]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [30.005859375, 26.2234375, 21.213541666666668, 23.4453125]}, 'saliency': {'score': [1.51072998046875, 0.12904199648743273, 0.81915283203125, 0.1230935489430147, 0.1403188994436553], 'topk_indices': array([8070, 8142, 8166,   24, 1533, 1473, 8155, 8061,  128, 5590, 2750,
       3139, 8027, 8071, 3140, 8160, 8161, 2753, 4627, 8163]), 'topk_tokens': [' first', ' return', 'Answer', '\n\n', ' until', ' question', 'Question', '.\n\n', ' bedroom', ' bathroom', ' Sandra', ' const', ' context', ' location', 'ern', ' football', ' before', ' football', ' bedroom', ' bathroom'], 'evidence_proportions': [2.6966552734375, 1.9603515625, 0.9677734375, 0.763916015625]}}, 'pred_res': 'the hallway<|eot_id|>', 'score': 0}
2025-01-22 18:32:36.975 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:32:36.976 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-104_pid-3_3-6-7-9.pkl | len: 3 |  size: 2.04 KB
Processing depth (3, 6, 7, 9):   4%|â–         | 4/100 [01:55<47:29, 29.69s/it]is_0k: False
your chose emoji: ['ğŸ’†ğŸ½\u200dâ™‚ï¸', 'ğŸ³', 'ğŸ’ƒğŸ¿', 'ğŸ¨', 'ğŸ‡²ğŸ‡·', 'ğŸ§˜ğŸ»\u200dâ™€ï¸', 'ğŸ§ğŸ¿\u200dâ™‚ï¸', 'ğŸ§‘ğŸ½\u200dâ¤ï¸\u200dğŸ§‘ğŸ¾', 'ğŸ˜­', 'ğŸ§—']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.16s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.46s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.47s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.08s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.56s/it]
Processing depth (0, 1, 3, 8):   4%|â–         | 4/100 [02:11<47:29, 29.69s/it]2025-01-22 18:32:52.929 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra grabbed the football.
2025-01-22 18:32:52.969 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went to the bedroom.
2025-01-22 18:32:52.974 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (907, 912) --> . Sandra went to the
2025-01-22 18:32:52.974 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra journeyed to the bathroom.
2025-01-22 18:32:52.989 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2998, 3004) -->  tragedy. Sandra journeyed to
2025-01-22 18:32:52.989 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 18:32:53.011 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3798, 3803) --> . John went to the
2025-01-22 18:32:53.011 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bedroom.
2025-01-22 18:32:53.012 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (149, 154) --> . Mary moved to the
2025-01-22 18:32:53.012 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary picked up the milk.
2025-01-22 18:32:53.017 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1057, 1062) --> . Mary picked up the
2025-01-22 18:32:53.017 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went to the bathroom.
2025-01-22 18:32:53.038 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3798, 3803) --> . John went to the
2025-01-22 18:32:53.038 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the hallway.
2025-01-22 18:32:53.061 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3798, 3803) --> . John went to the
2025-01-22 18:32:53.061 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary put down the milk.
2025-01-22 18:32:53.083 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3979, 3984) -->  ground. Mary put down
2025-01-22 18:32:53.083 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary travelled to the bathroom.
2025-01-22 18:32:53.118 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (6964, 6969) --> . Mary travelled to the
2025-01-22 18:32:53.118 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 18:32:53.118 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 18:32:53.118 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 18:32:53.118 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ¤¾ğŸ½\u200dâ™€', 'ğŸ€', 'ğŸƒğŸ»\u200dâ™‚ï¸\u200dâ¡ï¸', 'ğŸ‘®\u200dâ™€ï¸', 'ğŸ¦”', '\U0001faf1ğŸ¼\u200d\U0001faf2ğŸ¾', 'ğŸ“¯', 'ğŸ•”', 'ğŸ§‘ğŸ»\u200dğŸ”¬', 'ğŸ§ğŸ¼\u200dâ™‚\u200dâ¡ï¸']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.61s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.97s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.79s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.26s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.83s/it]
Processing depth (4, 5, 6, 7):   4%|â–         | 4/100 [02:28<47:29, 29.69s/it]2025-01-22 18:33:10.226 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra grabbed the football.
2025-01-22 18:33:10.247 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3640, 3644) -->  Sandra grabbed the football
2025-01-22 18:33:10.247 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went to the bedroom.
2025-01-22 18:33:10.268 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4251, 4256) -->  Sandra went to the bedroom
2025-01-22 18:33:10.268 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra journeyed to the bathroom.
2025-01-22 18:33:10.292 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4800, 4806) -->  the senate. Sandra journeyed
2025-01-22 18:33:10.293 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 18:33:10.311 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3774, 3779) -->  went to the hallway.
2025-01-22 18:33:10.311 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bedroom.
2025-01-22 18:33:10.312 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (143, 148) --> . Mary moved to the
2025-01-22 18:33:10.312 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary picked up the milk.
2025-01-22 18:33:10.317 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1045, 1050) --> . Mary picked up the
2025-01-22 18:33:10.317 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went to the bathroom.
2025-01-22 18:33:10.336 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3774, 3779) -->  went to the hallway.
2025-01-22 18:33:10.336 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the hallway.
2025-01-22 18:33:10.355 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3773, 3778) -->  John went to the hallway
2025-01-22 18:33:10.355 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary put down the milk.
2025-01-22 18:33:10.375 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4046, 4051) --> . Mary put down the
2025-01-22 18:33:10.375 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary travelled to the bathroom.
2025-01-22 18:33:10.409 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (6988, 6993) -->  Mary travelled to the bathroom
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:33:11.233 | INFO     | test_jbb_embedding:begin_test:693 - Sandra's hands<|eot_id|>
2025-01-22 18:33:11.233 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8197])
2025-01-22 18:33:13.476 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [521.6859375, 45.02576981707317, 277.625, 42.999858128834354, 72.52789463141026], 'topk_indices': array([3644, 8050, 8095, 8187,   24, 8184, 3638, 3631, 3642,   14, 8193,
       8185, 8051, 8195, 8192, 3640, 3641, 3639, 3643,    0]), 'topk_tokens': ['.', ' you', ' location', ' bathroom', '\n\n', ' football', ' Hon', '\n', ' the', '\n', '<|start_header_id|>', ' before', ' context', '<|end_header_id|>', '<|eot_id|>', ' Sandra', ' grabbed', '.', ' football', '<|begin_of_text|>'], 'evidence_proportions': [1608.25, 379.55, 152.24479166666666, 237.9]}, 'weight': {'score': [25.32109375, 23.29727705792683, 22.594791666666666, 23.294896472392637, 29.78064903846154], 'topk_indices': array([3286, 3259, 3179, 3131, 7488, 7450, 1411, 1473, 4339, 4323, 5179,
       5240, 7171, 7227, 3442, 3468, 5033, 5004, 4928, 4953]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [30.005859375, 26.2234375, 25.153645833333332, 20.871875]}, 'saliency': {'score': [3.8538055419921875, 0.25701058736661586, 1.590234375, 0.24327652445600076, 0.5404375516451322], 'topk_indices': array([ 145, 8049, 8190, 8050, 8179,  148, 3751, 1220, 8095, 3622, 4255,
       3759, 8185, 8184, 3638, 8187, 8051, 3641, 3640, 3643]), 'topk_tokens': [' moved', ' provided', 'Answer', ' you', 'Question', ' bedroom', 'ï¿½', 'nes', ' location', ' Grow', ' bedroom', 'ï¿½', ' before', ' football', ' Hon', ' bathroom', ' context', ' grabbed', ' Sandra', ' football'], 'evidence_proportions': [12.74169921875, 2.78544921875, 0.9531148274739584, 1.29267578125]}}, 'pred_res': "Sandra's hands<|eot_id|>", 'score': 0}
2025-01-22 18:33:13.483 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:33:13.483 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-104_pid-4_4-5-6-7.pkl | len: 3 |  size: 2.04 KB
Processing depth (4, 5, 6, 7):   5%|â–Œ         | 5/100 [02:31<50:53, 32.15s/it]Processing depth (4, 5, 6, 7):   5%|â–Œ         | 5/100 [02:31<48:07, 30.40s/it]
2025-01-22 18:33:13.580 | INFO     | __main__:<module>:82 - Selected idx: 106
2025-01-22 18:33:13.580 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the football before the bedroom? 
2025-01-22 18:33:13.580 | INFO     | __main__:<module>:84 - Answer: kitchen
2025-01-22 18:33:13.580 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 18:33:13.580 | INFO     | __main__:<module>:86 - Needle: [' Sandra moved to the hallway.', ' Sandra went back to the kitchen.', ' Mary took the football.', ' John went to the office.', ' John went to the hallway.', ' Mary went back to the kitchen.', ' John went to the bathroom.', ' Mary journeyed to the bedroom.', ' Daniel moved to the office.']
2025-01-22 18:33:13.580 | INFO     | __main__:<module>:87 - Real Needle: [' Mary took the football.', ' Mary went back to the kitchen.', ' Mary journeyed to the bedroom.', ' Daniel moved to the office.']
2025-01-22 18:33:13.580 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ§‘ğŸ»\u200dğŸ¦½\u200dâ¡ï¸', 'ğŸ™ğŸ¼\u200dâ™‚ï¸', 'ğŸ˜¼', 'ğŸ§ğŸ¿\u200dâ™‚\u200dâ¡', 'ğŸ¤¾ğŸ»\u200dâ™‚', 'ğŸ•—', 'ğŸ¤µğŸ¾\u200dâ™€ï¸', 'ğŸ‡·ğŸ‡´', 'ğŸ‘©ğŸ¾\u200dâš•ï¸', 'ğŸ§¾']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.34s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.90s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.74s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.29s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.81s/it]
Processing depth (1, 2, 5, 6):   0%|          | 0/100 [00:16<?, ?it/s]2025-01-22 18:33:30.580 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary took the football.
2025-01-22 18:33:30.584 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (814, 818) -->  Mary took the football
2025-01-22 18:33:30.584 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went back to the kitchen.
2025-01-22 18:33:30.595 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1790, 1796) --> . Mary went back to the
2025-01-22 18:33:30.595 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bedroom.
2025-01-22 18:33:30.619 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4162, 4168) --> . Mary journeyed to the
2025-01-22 18:33:30.619 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel moved to the office.
2025-01-22 18:33:30.643 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4631, 4636) --> . Daniel moved to the
2025-01-22 18:33:30.643 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the hallway.
2025-01-22 18:33:30.652 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1795, 1800) -->  the kitchen. Sandra moved
2025-01-22 18:33:30.652 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the kitchen.
2025-01-22 18:33:30.661 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1791, 1797) -->  Mary went back to the kitchen
2025-01-22 18:33:30.663 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went to the office.
2025-01-22 18:33:30.686 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4634, 4639) -->  to the office. John
2025-01-22 18:33:30.686 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the hallway.
2025-01-22 18:33:30.709 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4635, 4640) -->  the office. John went
2025-01-22 18:33:30.710 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went to the bathroom.
2025-01-22 18:33:30.734 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4635, 4640) -->  the office. John went
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:33:31.591 | INFO     | test_jbb_embedding:begin_test:693 - Mary took the football.<|eot_id|>
2025-01-22 18:33:31.592 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8147])
2025-01-22 18:33:33.809 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [272.6770833333333, 19.024484279141106, 133.64182692307693, 17.999338593730716, 14.743998579545455], 'topk_indices': array([8130, 8035, 8001, 1796,   23, 8141, 8134,  814,   24,    3, 8045,
        816, 8145,   14, 8142,  815,  818,   28,  817,    0]), 'topk_tokens': [':', '.\n\n', ' context', ' kitchen', '4', ':', ' football', ' Mary', '\n\n', '<|end_header_id|>', ' location', ' the', '<|end_header_id|>', '\n', '<|eot_id|>', ' took', '.', '<|end_header_id|>', ' football', '<|begin_of_text|>'], 'evidence_proportions': [792.375, 222.0625, 166.53125, 45.03125]}, 'weight': {'score': [21.433407738095237, 23.24907208588957, 22.491286057692307, 23.25620912007898, 29.272159090909092], 'topk_indices': array([3285, 3312, 3157, 3205, 7422, 7384, 1488, 1426, 4328, 4312, 5208,
       5147, 7105, 7161, 3468, 3494, 4972, 4924, 5001, 4949]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.498046875, 20.708333333333332, 20.052083333333332, 19.909375]}, 'saliency': {'score': [1.6706194196428572, 0.10557896526313267, 0.86968994140625, 0.09907116137300614, 0.11301963112571023], 'topk_indices': array([8035, 8044,   23, 8131, 8135,   24,   20, 1798, 8129, 4168, 8140,
       8073, 8001, 8137, 1796, 8045,  814, 8134,  815,  817]), 'topk_tokens': ['.\n\n', ' first', '4', ' Where', ' before', '\n\n', ' Jul', ' Sandra', 'Question', ' bedroom', 'Answer', ' moved', ' context', ' bedroom', ' kitchen', ' location', ' Mary', ' football', ' took', ' football'], 'evidence_proportions': [5.4931640625, 1.18994140625, 0.8125813802083334, 0.21904296875]}}, 'pred_res': 'Mary took the football.<|eot_id|>', 'score': 0}
2025-01-22 18:33:33.813 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:33:33.813 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-106_pid-0_1-2-5-6.pkl | len: 3 |  size: 2.04 KB
Processing depth (1, 2, 5, 6):   1%|          | 1/100 [00:20<33:13, 20.14s/it]is_0k: False
your chose emoji: ['â«', 'ğŸ§™ğŸ¾\u200dâ™‚', 'ğŸ•¡', 'ğŸ’‡ğŸ¼', 'ğŸ‘¨ğŸ¾\u200dğŸš’', 'ğŸ’†ğŸ»\u200dâ™‚ï¸', 'ğŸ”©', 'ğŸ˜‡', 'ğŸ‘§', 'ğŸš¶ğŸ¾\u200dâ™€']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.95s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.23s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.85s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.33s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.94s/it]
Processing depth (4, 6, 7, 9):   1%|          | 1/100 [00:37<33:13, 20.14s/it]2025-01-22 18:33:51.443 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary took the football.
2025-01-22 18:33:51.460 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3608, 3612) -->  Mary took the football
2025-01-22 18:33:51.460 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went back to the kitchen.
2025-01-22 18:33:51.480 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3889, 3895) -->  Sandra went back to the kitchen
2025-01-22 18:33:51.480 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bedroom.
2025-01-22 18:33:51.509 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5718, 5724) --> . Mary journeyed to the
2025-01-22 18:33:51.509 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel moved to the office.
2025-01-22 18:33:51.545 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7238, 7243) -->  Daniel moved to the office
2025-01-22 18:33:51.545 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the hallway.
2025-01-22 18:33:51.554 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1861, 1866) --> . Sandra moved to the
2025-01-22 18:33:51.555 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the kitchen.
2025-01-22 18:33:51.574 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3888, 3894) --> . Sandra went back to the
2025-01-22 18:33:51.574 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went to the office.
2025-01-22 18:33:51.598 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4756, 4761) -->  the kitchen. John went
2025-01-22 18:33:51.598 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the hallway.
2025-01-22 18:33:51.622 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4756, 4761) -->  the kitchen. John went
2025-01-22 18:33:51.622 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went to the bathroom.
2025-01-22 18:33:51.646 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4756, 4761) -->  the kitchen. John went
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:33:52.451 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 18:33:52.451 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8179])
2025-01-22 18:33:54.666 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [101.49776785714286, 9.637546596186752, 53.78245192307692, 9.259325061462816, 13.474196742957746], 'topk_indices': array([8160, 8162, 8067, 8172, 8167,    4, 8166,   28,    3,    1,   23,
          9, 8178, 8173,   24,   14, 8175, 8177,    0, 8174]), 'topk_tokens': ['.\n\n', ':', '.\n\n', 'Answer', ' before', '\n\n', ' football', '<|end_header_id|>', '<|end_header_id|>', '<|start_header_id|>', '4', ':', '\n\n', ':', '\n\n', '\n', '<|start_header_id|>', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [206.1875, 89.07291666666667, 105.69791666666667, 27.615625]}, 'weight': {'score': [23.86123511904762, 23.2733744805671, 22.126201923076923, 23.275523394283958, 29.315140845070424], 'topk_indices': array([3257, 3284, 3177, 3129, 7454, 7416, 1399, 1461, 4298, 4282, 5112,
       5173, 7125, 7181, 3466, 3440, 4889, 4937, 4914, 4966]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.498046875, 25.860677083333332, 20.052083333333332, 23.9234375]}, 'saliency': {'score': [0.6353963216145834, 0.0524256409482133, 0.3255145733173077, 0.05004792779079594, 0.09860960194762323], 'topk_indices': array([8173, 8067,   16, 8148, 8171, 8176,   23, 8178,   14, 8077,   20,
          8, 8169, 8161,   24, 8167, 3894, 3611, 8172, 8166]), 'topk_tokens': [':', '.\n\n', ' Date', ' return', ' \n', 'assistant', '4', '\n\n', '\n', ' location', ' Jul', ' Date', ' bedroom', 'Question', '\n\n', ' before', ' kitchen', ' football', 'Answer', ' football'], 'evidence_proportions': [1.3526611328125, 0.6285807291666666, 0.5580037434895834, 0.16263427734375]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 100}
2025-01-22 18:33:54.674 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:33:54.674 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-106_pid-1_4-6-7-9.pkl | len: 3 |  size: 2.01 KB
Processing depth (4, 6, 7, 9):   2%|â–         | 2/100 [00:41<33:35, 20.56s/it]is_0k: False
your chose emoji: ['ğŸ§‘ğŸ»\u200dğŸ¦¯\u200dâ¡', 'ğŸ§“', 'â¤µï¸', 'ğŸ‘¨\u200dâ¤ï¸\u200dğŸ‘¨', 'ğŸ§‘ğŸ»\u200dğŸ¤\u200dğŸ§‘ğŸ½', 'ğŸ‘³ğŸ¾\u200dâ™‚', 'â„¹', 'ğŸ’¢', 'ğŸ—ºï¸', 'ğŸ§‘\u200dğŸš€']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.65s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.15s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.90s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.45s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.99s/it]
Processing depth (0, 3, 6, 7):   2%|â–         | 2/100 [00:58<33:35, 20.56s/it]2025-01-22 18:34:12.397 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary took the football.
2025-01-22 18:34:12.440 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went back to the kitchen.
2025-01-22 18:34:12.455 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2921, 2927) -->  Mary went back to the kitchen
2025-01-22 18:34:12.455 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bedroom.
2025-01-22 18:34:12.479 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4770, 4776) -->  the senate. Mary journeyed
2025-01-22 18:34:12.480 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel moved to the office.
2025-01-22 18:34:12.508 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5619, 5624) --> . Daniel moved to the
2025-01-22 18:34:12.508 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the hallway.
2025-01-22 18:34:12.518 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2003, 2008) -->  cable. Sandra moved to
2025-01-22 18:34:12.518 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the kitchen.
2025-01-22 18:34:12.533 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2922, 2928) -->  went back to the kitchen.
2025-01-22 18:34:12.533 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went to the office.
2025-01-22 18:34:12.557 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4777, 4782) -->  the bedroom. John went
2025-01-22 18:34:12.557 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the hallway.
2025-01-22 18:34:12.584 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4777, 4782) -->  the bedroom. John went
2025-01-22 18:34:12.584 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went to the bathroom.
2025-01-22 18:34:12.608 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4777, 4782) -->  the bedroom. John went
2025-01-22 18:34:12.608 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 18:34:12.608 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 18:34:12.608 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 18:34:12.608 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ™‹ğŸ¿', 'ğŸ‘®ğŸ½\u200dâ™‚', 'ğŸ‘³ğŸ»\u200dâ™€ï¸', 'ğŸ“²', 'ğŸ¤œğŸ»', 'ğŸ‘°ğŸ¾\u200dâ™‚ï¸', 'ğŸ¤·ğŸ¼', 'âš±', 'ğŸ”…', 'ğŸ³']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.92s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.07s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.88s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.31s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.91s/it]
Processing depth (0, 1, 2, 5):   2%|â–         | 2/100 [01:16<33:35, 20.56s/it]2025-01-22 18:34:30.191 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary took the football.
2025-01-22 18:34:30.231 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went back to the kitchen.
2025-01-22 18:34:30.236 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (824, 830) --> . Mary went back to the
2025-01-22 18:34:30.237 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bedroom.
2025-01-22 18:34:30.246 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1753, 1759) --> . Mary journeyed to the
2025-01-22 18:34:30.246 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel moved to the office.
2025-01-22 18:34:30.269 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4169, 4174) --> . Daniel moved to the
2025-01-22 18:34:30.269 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the hallway.
2025-01-22 18:34:30.278 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1758, 1763) -->  the bedroom. Sandra moved
2025-01-22 18:34:30.278 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the kitchen.
2025-01-22 18:34:30.282 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (825, 831) -->  Mary went back to the kitchen
2025-01-22 18:34:30.282 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went to the office.
2025-01-22 18:34:30.307 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4759, 4764) --> . John went to the
2025-01-22 18:34:30.307 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the hallway.
2025-01-22 18:34:30.331 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4759, 4764) --> . John went to the
2025-01-22 18:34:30.331 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went to the bathroom.
2025-01-22 18:34:30.357 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4759, 4764) --> . John went to the
2025-01-22 18:34:30.357 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 18:34:30.357 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 18:34:30.357 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 18:34:30.357 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ§­', 'ğŸ‡²ğŸ‡¦', 'ğŸ‡­ğŸ‡³', 'ğŸƒğŸ¾\u200dâ™€\u200dâ¡ï¸', 'ğŸ§œğŸ¼\u200dâ™‚', 'ğŸ©¹', 'ğŸ§‘ğŸ¼\u200dğŸ¤\u200dğŸ§‘ğŸ¼', 'ğŸ§\u200dâ™€', 'ğŸ‘©ğŸ½\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘©ğŸ»', 'ğŸ™‡ğŸ¼\u200dâ™‚ï¸']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.68s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:11<00:11,  5.67s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:15<00:05,  5.14s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  3.48s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  4.12s/it]
Processing depth (5, 6, 7, 8):   2%|â–         | 2/100 [01:34<33:35, 20.56s/it]2025-01-22 18:34:48.541 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary took the football.
2025-01-22 18:34:48.561 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4147, 4151) -->  Mary took the football
2025-01-22 18:34:48.561 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went back to the kitchen.
2025-01-22 18:34:48.581 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3868, 3874) -->  Sandra went back to the kitchen
2025-01-22 18:34:48.581 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bedroom.
2025-01-22 18:34:48.616 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5598, 5604) --> . Mary journeyed to the
2025-01-22 18:34:48.617 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel moved to the office.
2025-01-22 18:34:48.649 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6511, 6516) --> . Daniel moved to the
2025-01-22 18:34:48.649 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the hallway.
2025-01-22 18:34:48.658 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1789, 1794) --> . Sandra moved to the
2025-01-22 18:34:48.659 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the kitchen.
2025-01-22 18:34:48.678 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3867, 3873) --> . Sandra went back to the
2025-01-22 18:34:48.678 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went to the office.
2025-01-22 18:34:48.702 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4712, 4717) -->  the kitchen. John went
2025-01-22 18:34:48.702 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the hallway.
2025-01-22 18:34:48.728 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4712, 4717) -->  the kitchen. John went
2025-01-22 18:34:48.728 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went to the bathroom.
2025-01-22 18:34:48.752 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4712, 4717) -->  the kitchen. John went
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:34:49.531 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 18:34:49.531 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8151])
2025-01-22 18:34:51.739 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [86.15922619047619, 10.770354273975963, 116.55649038461539, 10.235803163932404, 11.697317023026315], 'topk_indices': array([8005,    3, 8049,   25, 4713, 8134,    4, 8039, 8144,   23,    9,
          1,   28,   24, 8145, 8150,   14,    0, 8149, 8146]), 'topk_tokens': [' context', '<|end_header_id|>', ' location', '<|eot_id|>', ' kitchen', ':', '\n\n', '.\n\n', 'Answer', '4', ':', '<|start_header_id|>', '<|end_header_id|>', '\n\n', ':', '\n\n', '\n', '<|begin_of_text|>', '<|end_header_id|>', '<|eot_id|>'], 'evidence_proportions': [185.625, 76.36979166666667, 77.6875, 28.5]}, 'weight': {'score': [22.905505952380953, 23.25362168874172, 22.126201923076923, 23.258139185271986, 29.38623903508772], 'topk_indices': array([3324, 3297, 3205, 3157, 7380, 7418, 1487, 1425, 4304, 4288, 5124,
       5185, 7101, 7157, 3480, 3506, 4949, 4926, 4901, 4978]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.498046875, 25.860677083333332, 20.052083333333332, 19.909375]}, 'saliency': {'score': [0.5301252092633929, 0.05801793188039421, 0.7298137958233173, 0.054640487044134316, 0.08776360227350603], 'topk_indices': array([  16, 8039, 8120,   23, 8143, 8139, 8141,   14,    8,   20, 8148,
       8133, 8049,   24, 8005, 8150, 4150, 8138, 4713, 8144]), 'topk_tokens': [' Date', '.\n\n', ' return', '4', ' \n', ' before', ' bedroom', '\n', ' Date', ' Jul', 'assistant', 'Question', ' location', '\n\n', ' context', '\n\n', ' football', ' football', ' kitchen', 'Answer'], 'evidence_proportions': [1.2489013671875, 0.5289713541666666, 0.3732503255208333, 0.14473876953125]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 100}
2025-01-22 18:34:51.763 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:34:51.763 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-106_pid-2_5-6-7-8.pkl | len: 3 |  size: 2.02 KB
Processing depth (5, 6, 7, 8):   3%|â–         | 3/100 [01:38<1:00:12, 37.24s/it]is_0k: False
your chose emoji: ['ğŸ¤½ğŸ¾\u200dâ™‚ï¸', 'ğŸ‘Œ', 'ğŸš´ğŸ¼\u200dâ™€', 'ğŸ¤³ğŸ»', 'ğŸ¤¸\u200dâ™€ï¸', '\U0001f6de', 'ğŸ ', 'ğŸ§‘ğŸ¿\u200dâš•ï¸', 'ğŸ—„', 'â›“ï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:05<00:15,  5.23s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.08s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.80s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.34s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.94s/it]
Processing depth (5, 6, 7, 9):   3%|â–         | 3/100 [01:55<1:00:12, 37.24s/it]2025-01-22 18:35:09.397 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary took the football.
2025-01-22 18:35:09.418 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4228, 4232) -->  took the football.
2025-01-22 18:35:09.418 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went back to the kitchen.
2025-01-22 18:35:09.442 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3947, 3953) -->  went back to the kitchen.
2025-01-22 18:35:09.442 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bedroom.
2025-01-22 18:35:09.471 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5680, 5686) --> . Mary journeyed to the
2025-01-22 18:35:09.472 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel moved to the office.
2025-01-22 18:35:09.510 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7251, 7256) --> . Daniel moved to the
2025-01-22 18:35:09.510 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the hallway.
2025-01-22 18:35:09.520 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1801, 1806) --> . Sandra moved to the
2025-01-22 18:35:09.520 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the kitchen.
2025-01-22 18:35:09.540 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3946, 3952) -->  Sandra went back to the kitchen
2025-01-22 18:35:09.540 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went to the office.
2025-01-22 18:35:09.563 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4782, 4787) -->  the kitchen. John went
2025-01-22 18:35:09.564 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the hallway.
2025-01-22 18:35:09.588 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4782, 4787) -->  the kitchen. John went
2025-01-22 18:35:09.589 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went to the bathroom.
2025-01-22 18:35:09.613 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4782, 4787) -->  the kitchen. John went
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:35:10.419 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 18:35:10.420 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8193])
2025-01-22 18:35:12.681 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [156.22619047619048, 14.013030365422157, 118.59375, 13.312873895570009, 16.67677033253205], 'topk_indices': array([8181, 8183, 8186, 8176, 4276, 8091,    4, 8180, 8081, 8192,    1,
         23, 4230,    9, 8187,   24,   14,    0, 8191, 8188]), 'topk_tokens': [' before', ' bedroom', 'Answer', ':', 'ï¿½', ' location', '\n\n', ' football', '.\n\n', '\n\n', '<|start_header_id|>', '4', ' football', ':', ':', '\n\n', '\n', '<|begin_of_text|>', '<|end_header_id|>', '<|eot_id|>'], 'evidence_proportions': [307.0625, 154.04166666666666, 162.0, 31.25]}, 'weight': {'score': [20.370535714285715, 23.292987814177646, 23.04717548076923, 23.301303265738127, 29.803285256410255], 'topk_indices': array([3269, 3296, 3141, 3189, 7474, 7436, 1499, 1437, 4296, 4312, 5225,
       5164, 7201, 7145, 3452, 3478, 4940, 4915, 4963, 4992]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.71484375, 20.84375, 20.052083333333332, 19.909375]}, 'saliency': {'score': [0.8492838541666666, 0.07773361839044961, 0.8113872821514423, 0.07340455344885109, 0.12550931099133614], 'topk_indices': array([7581, 8185, 7582,   16, 8162, 7537,   14, 8181, 8175, 4783,    8,
         23,   20,   24, 5686, 8091, 8186, 8180, 8183, 4230]), 'topk_tokens': [' Min', ' \n', 'nes', ' Date', ' return', 'nes', '\n', ' before', 'Question', ' kitchen', ' Date', '4', ' Jul', '\n\n', ' bedroom', ' location', 'Answer', ' football', ' bedroom', ' football'], 'evidence_proportions': [1.7650146484375, 0.8566487630208334, 0.8068033854166666, 0.158837890625]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 100}
2025-01-22 18:35:12.689 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:35:12.689 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-106_pid-3_5-6-7-9.pkl | len: 3 |  size: 1.99 KB
Processing depth (5, 6, 7, 9):   4%|â–         | 4/100 [01:59<49:16, 30.80s/it]  is_0k: False
your chose emoji: ['ğŸ•µğŸ½\u200dâ™€ï¸', 'ğŸ‘ï¸', 'ğŸ“', 'ğŸ‘ğŸ¿', 'ğŸ§‘\u200dğŸ”§', 'ğŸƒğŸ¼\u200dâ™‚\u200dâ¡ï¸', 'ğŸš¶ğŸ¼\u200dâ¡ï¸', 'ğŸ§œğŸ»\u200dâ™€ï¸', 'ğŸ§–ğŸ»\u200dâ™‚', 'ğŸ§”ğŸ»\u200dâ™€']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.52s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.75s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.65s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.22s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.74s/it]
Processing depth (1, 5, 7, 9):   4%|â–         | 4/100 [02:15<49:16, 30.80s/it]2025-01-22 18:35:29.463 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary took the football.
2025-01-22 18:35:29.467 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (794, 798) -->  Mary took the football
2025-01-22 18:35:29.467 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went back to the kitchen.
2025-01-22 18:35:29.486 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3879, 3885) -->  Sandra went back to the kitchen
2025-01-22 18:35:29.486 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bedroom.
2025-01-22 18:35:29.520 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5638, 5644) --> . Mary journeyed to the
2025-01-22 18:35:29.520 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel moved to the office.
2025-01-22 18:35:29.555 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7134, 7139) -->  Daniel moved to the office
2025-01-22 18:35:29.555 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the hallway.
2025-01-22 18:35:29.564 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1810, 1815) --> . Sandra moved to the
2025-01-22 18:35:29.564 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the kitchen.
2025-01-22 18:35:29.585 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3878, 3884) --> . Sandra went back to the
2025-01-22 18:35:29.586 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went to the office.
2025-01-22 18:35:29.610 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4660, 4665) --> . John went to the
2025-01-22 18:35:29.610 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the hallway.
2025-01-22 18:35:29.634 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4660, 4665) --> . John went to the
2025-01-22 18:35:29.635 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went to the bathroom.
2025-01-22 18:35:29.662 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4660, 4665) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:35:30.529 | INFO     | test_jbb_embedding:begin_test:693 - Mary took the football.<|eot_id|>
2025-01-22 18:35:30.529 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8183])
2025-01-22 18:35:32.741 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [523.0059523809524, 46.06380558270217, 213.46754807692307, 44.298443451283944, 54.685948202054796], 'topk_indices': array([8171, 8080, 8036, 8170,   14, 8079, 8078, 8109,  796, 8071, 8110,
        798,  646, 8178, 8181, 8037, 8081, 8111,  797,    0]), 'topk_tokens': [' before', ' first', ' you', ' football', '\n', ' the', ' in', ' moved', ' the', '.\n\n', ' to', '.', 'ï¿½', '<|eot_id|>', '<|end_header_id|>', ' context', ' location', ' the', ' football', '<|begin_of_text|>'], 'evidence_proportions': [1242.125, 295.875, 405.875, 360.825]}, 'weight': {'score': [23.86123511904762, 23.277069844857074, 19.845552884615383, 23.286524565364296, 29.356806506849313], 'topk_indices': array([3315, 3288, 3208, 3160, 7462, 7424, 1446, 1508, 4313, 4329, 5170,
       5231, 7201, 7145, 3471, 3497, 5024, 4995, 4972, 4947]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.498046875, 25.860677083333332, 20.052083333333332, 23.9234375]}, 'saliency': {'score': [3.2447916666666665, 0.2598624342436782, 1.2271399864783654, 0.24907084679571354, 0.4088055336312072], 'topk_indices': array([1812,  795, 8075, 8071,  651, 1811, 8171, 8080, 8101,  653,  794,
       5644, 8173,  646, 8109, 8170, 1815, 8037, 8081,  797]), 'topk_tokens': [' moved', ' took', ' obtained', '.\n\n', 'â™€', ' Sandra', ' before', ' first', ' left', 'ï¿½', ' Mary', ' bedroom', ' bedroom', 'ï¿½', ' moved', ' football', ' hallway', ' context', ' location', ' football'], 'evidence_proportions': [8.45703125, 2.0728352864583335, 1.944580078125, 2.0416015625]}}, 'pred_res': 'Mary took the football.<|eot_id|>', 'score': 0}
2025-01-22 18:35:32.760 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:35:32.760 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-106_pid-4_1-5-7-9.pkl | len: 3 |  size: 2.03 KB
Processing depth (1, 5, 7, 9):   5%|â–Œ         | 5/100 [02:19<42:38, 26.93s/it]Processing depth (1, 5, 7, 9):   5%|â–Œ         | 5/100 [02:19<44:04, 27.83s/it]
2025-01-22 18:35:32.838 | INFO     | __main__:<module>:82 - Selected idx: 108
2025-01-22 18:35:32.838 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the football before the bedroom? 
2025-01-22 18:35:32.838 | INFO     | __main__:<module>:84 - Answer: kitchen
2025-01-22 18:35:32.838 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 18:35:32.838 | INFO     | __main__:<module>:86 - Needle: [' Sandra moved to the hallway.', ' John went to the bathroom.', ' Mary picked up the football.', ' John went to the office.', ' Daniel moved to the office.', ' John went to the hallway.', ' Sandra went back to the kitchen.', ' Mary went back to the kitchen.', ' Mary journeyed to the bedroom.', ' Sandra travelled to the hallway.']
2025-01-22 18:35:32.838 | INFO     | __main__:<module>:87 - Real Needle: [' Mary picked up the football.', ' Mary went back to the kitchen.', ' Mary journeyed to the bedroom.', ' Sandra travelled to the hallway.']
2025-01-22 18:35:32.838 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ¤¸ğŸ¾\u200dâ™‚', 'ğŸ§‘ğŸ¿\u200dğŸ¦³', 'ğŸ§‘ğŸ¼\u200dğŸ¤\u200dğŸ§‘ğŸ½', 'ğŸ˜±', 'ğŸ’½', 'ğŸ†“', 'ğŸ§ğŸ½\u200dâ™€\u200dâ¡ï¸', 'ğŸ‡¨ğŸ‡¾', 'ğŸ‘¡', 'ğŸ§ğŸ»\u200dâ™€ï¸']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.46s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.11s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.89s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.36s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.92s/it]
Processing depth (0, 3, 6, 9):   0%|          | 0/100 [00:17<?, ?it/s]2025-01-22 18:35:50.403 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the football.
2025-01-22 18:35:50.403 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the football.
2025-01-22 18:35:50.404 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went back to the kitchen.
2025-01-22 18:35:50.419 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2398, 2404) -->  Sandra went back to the kitchen
2025-01-22 18:35:50.419 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bedroom.
2025-01-22 18:35:50.448 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4879, 4885) --> . Mary journeyed to the
2025-01-22 18:35:50.449 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra travelled to the hallway.
2025-01-22 18:35:50.495 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6471, 6476) -->  Sandra moved to the hallway
2025-01-22 18:35:50.495 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the hallway.
2025-01-22 18:35:50.532 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6470, 6475) --> . Sandra moved to the
2025-01-22 18:35:50.533 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went to the bathroom.
2025-01-22 18:35:50.542 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1859, 1864) --> . John went to the
2025-01-22 18:35:50.543 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went to the office.
2025-01-22 18:35:50.554 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1859, 1864) --> . John went to the
2025-01-22 18:35:50.554 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel moved to the office.
2025-01-22 18:35:50.580 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4884, 4889) -->  the bedroom. Daniel moved
2025-01-22 18:35:50.581 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went to the hallway.
2025-01-22 18:35:50.591 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1859, 1864) --> . John went to the
2025-01-22 18:35:50.591 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra went back to the kitchen.
2025-01-22 18:35:50.603 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (2397, 2403) --> . Sandra went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:35:51.394 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 18:35:51.394 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8208])
2025-01-22 18:35:53.642 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [412.3494318181818, 38.987562416270855, 131.5796370967742, 37.62885740990439, 14.164395960365853], 'topk_indices': array([427, 327, 421,  14,  33, 537, 185, 356,  69, 538, 105, 422, 328,
        67, 423,  68, 544,  34,   0, 539]), 'topk_tokens': [',', ' half', '6', '\n', ' the', ' ', 'ION', ' half', 'ER', '6', 'ION', ',', ' of', 'ION', '000', 'E', ',', ' football', '<|begin_of_text|>', ','], 'evidence_proportions': [1278.0, 201.5, 147.07291666666666, 118.05]}, 'weight': {'score': [23.754261363636363, 23.300070028011206, 20.596270161290324, 23.309119499264526, 29.734756097560975], 'topk_indices': array([3269, 3296, 3189, 3141, 7483, 7445, 1467, 1405, 4272, 4288, 5215,
       5154, 7210, 7154, 3452, 3478, 4979, 4956, 4931, 5008]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.2875, 25.860677083333332, 20.052083333333332, 27.1359375]}, 'saliency': {'score': [2.5818647904829546, 0.21506948567470466, 0.7545244770665323, 0.20663695301487037, 0.11006629757764863], 'topk_indices': array([  38,   39,  421,   64,  536,  355,   69,  538,  185,   31, 8062,
          0,  327,  105,  356,  539,   68,   67,  423,   34]), 'topk_tokens': ['***', '\n\n\n', '6', 'ENCES', ' setting', ' latter', 'ER', '6', 'ION', ' picked', ' context', '<|begin_of_text|>', ' half', 'ION', ' half', ',', 'E', 'ION', '000', ' football'], 'evidence_proportions': [7.9958984375, 1.4683024088541667, 0.7184244791666666, 0.740234375]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 100}
2025-01-22 18:35:53.650 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:35:53.650 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-108_pid-0_0-3-6-9.pkl | len: 3 |  size: 1.91 KB
Processing depth (0, 3, 6, 9):   1%|          | 1/100 [00:20<34:08, 20.69s/it]is_0k: False
your chose emoji: ['ğŸï¸', 'ğŸ˜¹', 'ğŸ‚ğŸ¿', 'ğŸ™…ğŸ»\u200dâ™‚', 'ğŸ‘©ğŸ¿\u200dğŸ¤\u200dğŸ‘¨ğŸ¾', 'ğŸ‘©ğŸ¿\u200dâ¤\u200dğŸ’‹\u200dğŸ‘¨ğŸ½', 'ğŸ§šğŸ¾', 'ğŸ‘©ğŸ¼\u200dâœˆ', 'ğŸ§ğŸ½\u200dâ™€ï¸', 'ğŸ°']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.25s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.97s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.66s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  2.99s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.61s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (3, 6, 7, 9):   1%|          | 1/100 [00:36<34:08, 20.69s/it]2025-01-22 18:36:09.841 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the football.
2025-01-22 18:36:09.858 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2870, 2875) --> . Mary picked up the
2025-01-22 18:36:09.858 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went back to the kitchen.
2025-01-22 18:36:09.871 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2186, 2192) -->  Sandra went back to the kitchen
2025-01-22 18:36:09.871 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bedroom.
2025-01-22 18:36:09.900 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5569, 5575) --> . Mary journeyed to the
2025-01-22 18:36:09.900 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra travelled to the hallway.
2025-01-22 18:36:09.931 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6361, 6366) -->  Sandra moved to the hallway
2025-01-22 18:36:09.931 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the hallway.
2025-01-22 18:36:09.963 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6360, 6365) --> . Sandra moved to the
2025-01-22 18:36:09.963 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went to the bathroom.
2025-01-22 18:36:09.972 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1773, 1778) --> . John went to the
2025-01-22 18:36:09.972 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went to the office.
2025-01-22 18:36:09.981 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1773, 1778) --> . John went to the
2025-01-22 18:36:09.981 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel moved to the office.
2025-01-22 18:36:10.004 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4691, 4696) -->  the kitchen. Daniel moved
2025-01-22 18:36:10.004 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went to the hallway.
2025-01-22 18:36:10.013 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1773, 1778) --> . John went to the
2025-01-22 18:36:10.013 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra went back to the kitchen.
2025-01-22 18:36:10.024 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (2185, 2191) --> . Sandra went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:36:13.364 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 18:36:13.364 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8154])
2025-01-22 18:36:16.323 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [138.66335227272728, 12.579652637305381, 86.65877016129032, 11.95399937530849, 17.301171875], 'topk_indices': array([8141, 2876,    4,   28,    3, 8042, 8052, 8008,   23, 8153,    9,
          1, 8148,   24, 4692,   14, 2875, 8152,    0, 8149]), 'topk_tokens': [' football', '.', '\n\n', '<|end_header_id|>', '<|end_header_id|>', '.\n\n', ' location', ' context', '4', '\n\n', ':', '<|start_header_id|>', ':', '\n\n', ' kitchen', '\n', ' football', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [240.35, 140.92708333333334, 123.33333333333333, 52.65625]}, 'weight': {'score': [23.711647727272727, 23.25419310101753, 20.49344758064516, 23.263511846001975, 29.495454545454546], 'topk_indices': array([3305, 3278, 3138, 3186, 7357, 7395, 1409, 1471, 4283, 4267, 5097,
       5158, 7066, 7122, 3461, 3487, 4874, 4951, 4922, 4899]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.1, 25.860677083333332, 20.052083333333332, 27.1359375]}, 'saliency': {'score': [0.8373884721235796, 0.06964544567740898, 0.5293835055443549, 0.06580262405380445, 0.12695229270241476], 'topk_indices': array([8042,   23,   14, 2191,    8,   20, 8142, 8136, 2186, 2872, 1222,
       8147, 5575,   24, 8141, 8144, 8052, 8008, 4692, 2875]), 'topk_tokens': ['.\n\n', '4', '\n', ' kitchen', ' Date', ' Jul', ' before', 'Question', ' Sandra', ' picked', 'ï¿½', 'Answer', ' bedroom', '\n\n', ' football', ' bedroom', ' location', ' context', ' kitchen', ' football'], 'evidence_proportions': [1.33466796875, 1.0392252604166667, 0.5965983072916666, 0.38685302734375]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 100}
2025-01-22 18:36:16.329 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:36:16.329 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-108_pid-1_3-6-7-9.pkl | len: 3 |  size: 2.03 KB
Processing depth (3, 6, 7, 9):   2%|â–         | 2/100 [00:43<35:42, 21.86s/it]is_0k: False
your chose emoji: ['ğŸ’®', 'ğŸ’ª', 'ğŸ‡«ğŸ‡¯', 'ğŸ‘©ğŸ¼\u200dâ¤\u200dğŸ’‹\u200dğŸ‘¨ğŸ»', 'â˜¸ï¸', 'â™Ÿ', 'ğŸ”š', 'ğŸ––', 'ğŸ•´ğŸ¼', 'ğŸ§ğŸ¿\u200dâ™‚ï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:05<00:16,  5.62s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.47s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:15<00:04,  4.89s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  3.36s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  4.05s/it]
Processing depth (0, 1, 3, 5):   2%|â–         | 2/100 [01:01<35:42, 21.86s/it]2025-01-22 18:36:34.265 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the football.
2025-01-22 18:36:34.266 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the football.
2025-01-22 18:36:34.266 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went back to the kitchen.
2025-01-22 18:36:34.271 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (901, 907) --> . Mary went back to the
2025-01-22 18:36:34.271 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bedroom.
2025-01-22 18:36:34.288 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2943, 2949) --> . Mary journeyed to the
2025-01-22 18:36:34.289 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra travelled to the hallway.
2025-01-22 18:36:34.312 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4227, 4232) -->  Sandra travelled to the hallway
2025-01-22 18:36:34.312 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the hallway.
2025-01-22 18:36:34.338 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4228, 4233) -->  travelled to the hallway.
2025-01-22 18:36:34.339 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went to the bathroom.
2025-01-22 18:36:34.348 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1854, 1859) --> . John went to the
2025-01-22 18:36:34.348 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went to the office.
2025-01-22 18:36:34.358 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1854, 1859) --> . John went to the
2025-01-22 18:36:34.358 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel moved to the office.
2025-01-22 18:36:34.382 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4788, 4793) -->  the senate. Daniel moved
2025-01-22 18:36:34.382 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went to the hallway.
2025-01-22 18:36:34.393 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1854, 1859) --> . John went to the
2025-01-22 18:36:34.393 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra went back to the kitchen.
2025-01-22 18:36:34.399 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (902, 908) -->  Mary went back to the kitchen
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:36:35.156 | INFO     | test_jbb_embedding:begin_test:693 - kitchen<|eot_id|>
2025-01-22 18:36:35.157 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8148])
2025-01-22 18:36:37.364 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [140.5138494318182, 13.619751410869831, 37.206558719758064, 13.184722862705298, 6.638146033653846], 'topk_indices': array([   9,   23,   65,   24,  104,  328,  423,   14, 8144, 8146,  544,
         66,   69,   34, 8143,  105,   67,  539,   68,    0]), 'topk_tokens': [':', '4', ' OF', '\n\n', ' P', ' of', '000', '\n', '<|start_header_id|>', '<|end_header_id|>', ',', ' P', 'ER', ' football', '<|eot_id|>', 'ION', 'ION', ',', 'E', '<|begin_of_text|>'], 'evidence_proportions': [407.4, 91.35416666666667, 63.046875, 25.5796875]}, 'weight': {'score': [22.601207386363637, 23.251052401545824, 21.357106854838708, 23.260068072363545, 29.60546875], 'topk_indices': array([3284, 3311, 3156, 3204, 7441, 7403, 1480, 1418, 4321, 4337, 5199,
       5138, 7168, 7112, 3493, 3467, 4915, 4963, 4940, 4992]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.2875, 20.708333333333332, 20.052083333333332, 28.2453125]}, 'saliency': {'score': [0.7998671098188921, 0.07425698402132407, 0.23206870786605344, 0.07168158439095446, 0.05213634784405048], 'topk_indices': array([  39,  104,   60,   57, 8138,  327,   52,   64,   31,  539,  356,
        907,  423,   66,    0,   69,   34,  105,   68,   67]), 'topk_tokens': ['\n\n\n', ' P', '\n\n\n\n', ' Proof', ' bedroom', ' half', ' Gutenberg', 'ENCES', ' picked', ',', ' half', ' kitchen', '000', ' P', '<|begin_of_text|>', 'ER', ' football', 'ION', 'E', 'ION'], 'evidence_proportions': [2.44560546875, 0.4366048177083333, 0.2920328776041667, 0.199444580078125]}}, 'pred_res': 'kitchen<|eot_id|>', 'score': 100}
2025-01-22 18:36:37.376 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:36:37.377 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-108_pid-2_0-1-3-5.pkl | len: 3 |  size: 1.96 KB
Processing depth (0, 1, 3, 5):   3%|â–         | 3/100 [01:04<34:44, 21.49s/it]is_0k: False
your chose emoji: ['ğŸ§ğŸ¼\u200dâ™€\u200dâ¡', 'ğŸ™\u200dâ™‚', 'ğŸš¨', 'ğŸ‡¦ğŸ‡¨', 'ğŸ…ğŸ½', 'ğŸ™‡ğŸ¿\u200dâ™‚ï¸', 'â¡', 'ğŸ‘Œ', 'ğŸŒ', 'â†–']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.43s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.80s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.91s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.45s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.93s/it]
Processing depth (5, 6, 7, 8):   3%|â–         | 3/100 [01:21<34:44, 21.49s/it]2025-01-22 18:36:54.864 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the football.
2025-01-22 18:36:54.887 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4118, 4123) --> . Mary picked up the
2025-01-22 18:36:54.887 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went back to the kitchen.
2025-01-22 18:36:54.899 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2128, 2134) -->  Sandra went back to the kitchen
2025-01-22 18:36:54.899 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bedroom.
2025-01-22 18:36:54.928 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5579, 5585) --> . Mary journeyed to the
2025-01-22 18:36:54.928 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra travelled to the hallway.
2025-01-22 18:36:54.961 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6222, 6227) -->  moved to the hallway.
2025-01-22 18:36:54.961 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the hallway.
2025-01-22 18:36:54.995 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6221, 6226) -->  Sandra moved to the hallway
2025-01-22 18:36:54.995 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went to the bathroom.
2025-01-22 18:36:55.005 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1727, 1732) --> . John went to the
2025-01-22 18:36:55.005 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went to the office.
2025-01-22 18:36:55.015 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1727, 1732) --> . John went to the
2025-01-22 18:36:55.015 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel moved to the office.
2025-01-22 18:36:55.043 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4693, 4698) -->  the kitchen. Daniel moved
2025-01-22 18:36:55.043 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went to the hallway.
2025-01-22 18:36:55.052 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1727, 1732) --> . John went to the
2025-01-22 18:36:55.052 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra went back to the kitchen.
2025-01-22 18:36:55.064 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (2127, 2133) --> . Sandra went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:36:55.868 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 18:36:55.869 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8130])
2025-01-22 18:36:58.073 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [81.37428977272727, 9.425495473687446, 62.19153225806452, 9.027151338180692, 12.963526526162791], 'topk_indices': array([   4, 8113,    3, 8028, 8123, 8111,   23,   28,    1,   24, 8018,
          9, 8124, 4694, 8129, 8126,   14,    0, 8128, 8125]), 'topk_tokens': ['\n\n', ':', '<|end_header_id|>', ' location', 'Answer', '.\n\n', '4', '<|end_header_id|>', '<|start_header_id|>', '\n\n', '.\n\n', ':', ':', ' kitchen', '\n\n', '<|start_header_id|>', '\n', '<|begin_of_text|>', '<|end_header_id|>', '<|eot_id|>'], 'evidence_proportions': [108.6875, 93.84375, 89.44270833333333, 29.415625]}, 'weight': {'score': [22.343394886363637, 23.23263056375261, 21.4765625, 23.241789139851484, 29.203851744186046], 'topk_indices': array([3297, 3270, 3142, 3190, 7415, 7377, 1425, 1487, 4291, 4275, 5099,
       5160, 7154, 7098, 3479, 3453, 4924, 4901, 4953, 4876]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.1, 25.860677083333332, 20.052083333333332, 21.115625]}, 'saliency': {'score': [0.46234130859375, 0.05038023634061271, 0.3706271263860887, 0.048029890154848, 0.09486637559047965], 'topk_indices': array([8111, 8122,   23, 7984,   14,   20, 4123,    8, 8118,   24, 8099,
       8018, 8117, 8120, 8127, 8028, 8112, 8129, 8123, 4694]), 'topk_tokens': ['.\n\n', ' \n', '4', ' context', '\n', ' Jul', ' football', ' Date', ' before', '\n\n', ' return', '.\n\n', ' football', ' bedroom', 'assistant', ' location', 'Question', '\n\n', 'Answer', ' kitchen'], 'evidence_proportions': [0.590478515625, 0.6428629557291666, 0.42413330078125, 0.163427734375]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 100}
2025-01-22 18:36:58.079 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:36:58.079 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-108_pid-3_5-6-7-8.pkl | len: 3 |  size: 2.02 KB
Processing depth (5, 6, 7, 8):   4%|â–         | 4/100 [01:25<33:53, 21.18s/it]is_0k: False
your chose emoji: ['ğŸ–¤', '1âƒ£', 'â°', 'ğŸ™‚\u200dâ†•ï¸', 'ğŸ§ğŸ»\u200dâ™€', 'â›¹\u200dâ™€', 'ğŸ¬', 'ğŸ§´', 'ğŸ˜', 'ğŸ‡§ğŸ‡«']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  3.96s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.75s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.85s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.39s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.85s/it]
Processing depth (2, 4, 8, 9):   4%|â–         | 4/100 [01:42<33:53, 21.18s/it]2025-01-22 18:37:15.266 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the football.
2025-01-22 18:37:15.276 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1847, 1852) --> . Mary picked up the
2025-01-22 18:37:15.276 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went back to the kitchen.
2025-01-22 18:37:15.287 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2210, 2216) -->  Sandra went back to the kitchen
2025-01-22 18:37:15.287 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bedroom.
2025-01-22 18:37:15.322 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6654, 6660) -->  Mary journeyed to the bedroom
2025-01-22 18:37:15.322 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra travelled to the hallway.
2025-01-22 18:37:15.354 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6472, 6477) -->  Sandra moved to the hallway
2025-01-22 18:37:15.354 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the hallway.
2025-01-22 18:37:15.391 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6471, 6476) --> . Sandra moved to the
2025-01-22 18:37:15.391 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went to the bathroom.
2025-01-22 18:37:15.401 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1852, 1857) -->  football. John went to
2025-01-22 18:37:15.401 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went to the office.
2025-01-22 18:37:15.410 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1852, 1857) -->  football. John went to
2025-01-22 18:37:15.410 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel moved to the office.
2025-01-22 18:37:15.434 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4859, 4864) --> . Daniel moved to the
2025-01-22 18:37:15.435 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went to the hallway.
2025-01-22 18:37:15.444 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1852, 1857) -->  football. John went to
2025-01-22 18:37:15.444 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra went back to the kitchen.
2025-01-22 18:37:15.456 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (2209, 2215) --> . Sandra went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:37:16.199 | INFO     | test_jbb_embedding:begin_test:693 - kitchen<|eot_id|>
2025-01-22 18:37:16.200 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8182])
2025-01-22 18:37:18.408 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [71.97585227272727, 6.55809025656689, 66.02595766129032, 6.154414081714215, 7.158960314764493], 'topk_indices': array([8170, 8165, 8175, 8070, 8163,    3,   28,    9,   23,    1, 2215,
       1852,   24, 8176, 8178, 8181,   14, 8180,    0, 8177]), 'topk_tokens': [' before', ':', 'Answer', '.\n\n', '.\n\n', '<|end_header_id|>', '<|end_header_id|>', ':', '4', '<|start_header_id|>', ' kitchen', ' football', '\n\n', ':', '<|start_header_id|>', '\n\n', '\n', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [105.8375, 82.63541666666667, 66.90104166666667, 31.4125]}, 'weight': {'score': [24.944957386363637, 23.279323839340258, 22.024949596774192, 23.279599498893262, 29.723278985507246], 'topk_indices': array([3290, 3317, 3162, 3210, 7475, 7437, 1473, 1411, 4286, 4302, 5109,
       5170, 7118, 7174, 3473, 3499, 4934, 4911, 4963, 4886]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.1, 25.860677083333332, 24.57421875, 27.1359375]}, 'saliency': {'score': [0.4535272771661932, 0.03577748125620418, 0.39143617691532256, 0.03329151039104771, 0.0541534423828125], 'topk_indices': array([  16,   14,    8, 8166, 8070, 8163,   20,   23, 8036, 3634, 8170,
       8179,   24, 8172, 8164, 8181, 8169, 8175, 2215, 1852]), 'topk_tokens': [' Date', '\n', ' Date', ' Where', '.\n\n', '.\n\n', ' Jul', '4', ' context', ' kitchen', ' before', 'assistant', '\n\n', ' bedroom', 'Question', '\n\n', ' football', 'Answer', ' kitchen', ' football'], 'evidence_proportions': [0.577783203125, 0.58831787109375, 0.40850830078125, 0.22154541015625]}}, 'pred_res': 'kitchen<|eot_id|>', 'score': 100}
2025-01-22 18:37:18.414 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:37:18.414 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-108_pid-4_2-4-8-9.pkl | len: 3 |  size: 2.02 KB
Processing depth (2, 4, 8, 9):   5%|â–Œ         | 5/100 [01:45<33:03, 20.87s/it]Processing depth (2, 4, 8, 9):   5%|â–Œ         | 5/100 [01:45<33:24, 21.10s/it]
2025-01-22 18:37:18.473 | INFO     | __main__:<module>:82 - Selected idx: 110
2025-01-22 18:37:18.473 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the apple before the bedroom? 
2025-01-22 18:37:18.473 | INFO     | __main__:<module>:84 - Answer: bathroom
2025-01-22 18:37:18.473 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 18:37:18.473 | INFO     | __main__:<module>:86 - Needle: [' John grabbed the milk.', ' Daniel went back to the office.', ' Sandra got the apple.', ' Mary moved to the bathroom.', ' Sandra travelled to the bathroom.', ' Mary went back to the garden.', ' John left the milk.', ' Sandra journeyed to the bedroom.', ' John grabbed the milk.']
2025-01-22 18:37:18.473 | INFO     | __main__:<module>:87 - Real Needle: [' Sandra got the apple.', ' Sandra travelled to the bathroom.', ' Sandra journeyed to the bedroom.', ' John grabbed the milk.']
2025-01-22 18:37:18.473 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸƒğŸ¿\u200dâ™€ï¸', 'ğŸ’ªğŸ¼', 'ğŸ‡¹ğŸ‡²', 'ğŸ‘¨ğŸ»\u200dğŸ¦¼\u200dâ¡ï¸', 'ğŸ•µğŸ¼\u200dâ™€ï¸', 'ğŸ‘¨ğŸ¿\u200dâš–ï¸', 'ğŸ•µğŸ»\u200dâ™€', 'â­', 'ğŸ¦“', 'ğŸ˜²']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  3.96s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.36s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.48s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.19s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.60s/it]
Processing depth (1, 5, 7, 8):   0%|          | 0/100 [00:16<?, ?it/s]2025-01-22 18:37:34.734 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra got the apple.
2025-01-22 18:37:34.738 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (896, 900) -->  Sandra got the apple
2025-01-22 18:37:34.738 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra travelled to the bathroom.
2025-01-22 18:37:34.762 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4251, 4256) -->  Sandra travelled to the bathroom
2025-01-22 18:37:34.763 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra journeyed to the bedroom.
2025-01-22 18:37:34.794 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5827, 5833) --> . Sandra journeyed to the
2025-01-22 18:37:34.794 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John grabbed the milk.
2025-01-22 18:37:34.830 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6683, 6687) -->  John grabbed the milk
2025-01-22 18:37:34.830 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went back to the office.
2025-01-22 18:37:34.854 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3970, 3976) -->  Daniel went back to the office
2025-01-22 18:37:34.854 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary moved to the bathroom.
2025-01-22 18:37:34.874 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3506, 3511) --> . Mary moved to the
2025-01-22 18:37:34.874 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the garden.
2025-01-22 18:37:34.900 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5057, 5063) -->  Mary went back to the garden
2025-01-22 18:37:34.900 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John left the milk.
2025-01-22 18:37:34.922 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3931, 3935) -->  John left the milk
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:37:35.791 | INFO     | test_jbb_embedding:begin_test:693 - Sandra's house.<|eot_id|>
2025-01-22 18:37:35.791 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8192])
2025-01-22 18:37:38.090 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [279.015625, 21.76902265100671, 142.00892857142858, 20.860043684855917, 25.568049733231707], 'topk_indices': array([8185, 8183, 8089, 8182, 4255, 8175,   24, 8080, 3511, 8186,  896,
       8180, 8046,   14, 8190, 8090,  899, 8187,    0, 8188]), 'topk_tokens': ['Answer', '?', ' first', ' bedroom', ' bathroom', ':', '\n\n', '.\n\n', ' bathroom', ':', ' Sandra', ' before', ' context', '\n', '<|end_header_id|>', ' location', ' apple', '<|eot_id|>', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [628.375, 336.5, 158.3125, 38.85546875]}, 'weight': {'score': [25.619654605263158, 23.30527951494814, 23.399925595238095, 23.299643623543837, 28.930640243902438], 'topk_indices': array([3269, 3242, 3114, 3162, 7415, 7453, 1404, 1466, 4303, 4319, 5139,
       5200, 7192, 7136, 3425, 3451, 4891, 4939, 4968, 4916]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.095703125, 27.8390625, 21.213541666666668, 26.978515625]}, 'saliency': {'score': [1.9799033717105263, 0.12257918706385372, 0.783935546875, 0.11654882004186465, 0.17222744081078506], 'topk_indices': array([4252, 8183, 8051, 5833, 8080,  897, 8176, 8086, 8089, 8179, 8174,
       8185, 8180, 8182, 4255, 8046, 8090, 3511,  896,  899]), 'topk_tokens': [' travelled', '?', ' locations', ' bedroom', '.\n\n', ' got', ' Where', ' item', ' first', ' apple', 'Question', 'Answer', ' before', ' bedroom', ' bathroom', ' context', ' location', ' bathroom', ' Sandra', ' apple'], 'evidence_proportions': [4.68408203125, 2.500390625, 0.8846028645833334, 0.26806640625]}}, 'pred_res': "Sandra's house.<|eot_id|>", 'score': 0}
2025-01-22 18:37:38.097 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:37:38.097 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-110_pid-0_1-5-7-8.pkl | len: 3 |  size: 2.04 KB
Processing depth (1, 5, 7, 8):   1%|          | 1/100 [00:19<32:13, 19.53s/it]is_0k: False
your chose emoji: ['ğŸ„\u200dâ™‚ï¸', 'ğŸ•µğŸ¼\u200dâ™‚', 'ğŸ‡¨ğŸ‡«', 'âš”ï¸', '#âƒ£', 'ğŸš´ğŸ¼\u200dâ™€ï¸', 'ğŸ§‘ğŸ½\u200dğŸ¼', 'ğŸ§‘ğŸ½\u200dğŸ¤\u200dğŸ§‘ğŸ¾', 'ğŸƒğŸ¼\u200dâ™€ï¸\u200dâ¡', 'âœŒğŸ¾']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.60s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.61s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.17s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.72s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.34s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (2, 4, 6, 9):   1%|          | 1/100 [00:34<32:13, 19.53s/it]2025-01-22 18:37:53.305 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra got the apple.
2025-01-22 18:37:53.314 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1560, 1564) -->  Sandra got the apple
2025-01-22 18:37:53.315 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra travelled to the bathroom.
2025-01-22 18:37:53.334 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3522, 3527) --> . Sandra travelled to the
2025-01-22 18:37:53.334 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra journeyed to the bedroom.
2025-01-22 18:37:53.362 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4597, 4603) -->  Sandra journeyed to the bedroom
2025-01-22 18:37:53.362 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John grabbed the milk.
2025-01-22 18:37:53.398 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7201, 7205) -->  John grabbed the milk
2025-01-22 18:37:53.398 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went back to the office.
2025-01-22 18:37:53.417 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3836, 3842) -->  Daniel went back to the office
2025-01-22 18:37:53.417 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary moved to the bathroom.
2025-01-22 18:37:53.436 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3238, 3243) --> . Mary moved to the
2025-01-22 18:37:53.436 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the garden.
2025-01-22 18:37:53.463 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4797, 4803) -->  the senate. Mary went back
2025-01-22 18:37:53.463 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John left the milk.
2025-01-22 18:37:53.483 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3821, 3825) -->  John left the milk
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:37:58.647 | INFO     | test_jbb_embedding:begin_test:693 - Sandra's hand<|eot_id|>
2025-01-22 18:37:58.647 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8153])
2025-01-22 18:38:02.037 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [243.09292763157896, 18.328768697891125, 80.33928571428571, 17.642132439009366, 21.691721270161292], 'topk_indices': array([   1, 3243, 8135, 3527, 8146, 8007, 8051, 8136, 8041,   24, 8134,
       8141, 8147,   14, 1563, 1560, 8151, 8148,    0, 8149]), 'topk_tokens': ['<|start_header_id|>', ' bathroom', 'Question', ' bathroom', 'Answer', ' context', ' location', ':', '.\n\n', '\n\n', '.\n\n', ' before', ':', '\n', ' apple', ' Sandra', '<|end_header_id|>', '<|eot_id|>', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [526.0, 247.4, 195.14583333333334, 26.72265625]}, 'weight': {'score': [25.550575657894736, 23.26493915522315, 23.450892857142858, 23.259107203363726, 29.310987903225808], 'topk_indices': array([3331, 3304, 3170, 3218, 7416, 7378, 1457, 1519, 4339, 4323, 5209,
       5148, 7094, 7150, 3513, 3487, 4950, 5002, 4925, 4973]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.095703125, 22.15, 25.735677083333332, 26.978515625]}, 'saliency': {'score': [1.6908119603207237, 0.10207684616530392, 0.44843255905877977, 0.09746134134276621, 0.16165296493038053], 'topk_indices': array([8050, 3523, 3524, 8137,   24, 1561, 8041, 8134, 4602, 8140, 8135,
       8051, 8143, 8007, 8141, 3243, 8146, 3527, 1563, 1560]), 'topk_tokens': [' first', ' Sandra', ' travelled', ' Where', '\n\n', ' got', '.\n\n', '.\n\n', ' bedroom', ' apple', 'Question', ' location', ' bedroom', ' context', ' before', ' bathroom', 'Answer', ' bathroom', ' apple', ' Sandra'], 'evidence_proportions': [4.00439453125, 1.45654296875, 1.34423828125, 0.1899261474609375]}}, 'pred_res': "Sandra's hand<|eot_id|>", 'score': 0}
2025-01-22 18:38:02.044 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:38:02.044 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-110_pid-1_2-4-6-9.pkl | len: 3 |  size: 2.06 KB
Processing depth (2, 4, 6, 9):   2%|â–         | 2/100 [00:43<36:08, 22.13s/it]is_0k: False
your chose emoji: ['ğŸ¹', 'ğŸ™‡ğŸ¿\u200dâ™‚', 'ğŸ‘°\u200dâ™€', '\U0001faf1ğŸ¼', 'ğŸ‘®ğŸ¾', 'ğŸšˆ', 'ğŸ¦¹ğŸ¿\u200dâ™€', 'ğŸ˜', 'ğŸ’ƒğŸ»', 'ğŸ§‘ğŸ¼\u200dğŸ¦¯\u200dâ¡ï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.54s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.40s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.11s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.91s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.42s/it]
Processing depth (0, 2, 3, 8):   2%|â–         | 2/100 [00:58<36:08, 22.13s/it]2025-01-22 18:38:17.578 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra got the apple.
2025-01-22 18:38:17.622 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra travelled to the bathroom.
2025-01-22 18:38:17.633 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1801, 1806) --> . Sandra travelled to the
2025-01-22 18:38:17.634 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra journeyed to the bedroom.
2025-01-22 18:38:17.651 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2899, 2905) --> . Sandra journeyed to the
2025-01-22 18:38:17.651 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John grabbed the milk.
2025-01-22 18:38:17.685 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6612, 6616) -->  John grabbed the milk
2025-01-22 18:38:17.686 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went back to the office.
2025-01-22 18:38:17.723 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3905, 3911) --> . Daniel went back to the
2025-01-22 18:38:17.723 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary moved to the bathroom.
2025-01-22 18:38:17.749 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3462, 3467) --> . Mary moved to the
2025-01-22 18:38:17.749 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the garden.
2025-01-22 18:38:17.776 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4944, 4950) --> . Mary went back to the
2025-01-22 18:38:17.776 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John left the milk.
2025-01-22 18:38:17.797 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3865, 3869) -->  John left the milk
2025-01-22 18:38:17.797 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 18:38:17.797 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 18:38:17.797 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 18:38:17.798 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ‘©ğŸ¼\u200dğŸ¦¼', 'ğŸ–•', '\U0001fae5', 'ğŸ•µğŸ½\u200dâ™‚ï¸', 'ğŸ§ğŸ»\u200dâ¡', 'âœğŸ¿', 'ğŸ§‘ğŸ»\u200dğŸš’', 'ğŸ‘½', 'ğŸƒğŸ¾\u200dâ™‚ï¸\u200dâ¡', 'ğŸ›–']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.74s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.09s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.76s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.24s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.84s/it]
Processing depth (0, 1, 2, 6):   2%|â–         | 2/100 [01:16<36:08, 22.13s/it]2025-01-22 18:38:35.049 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra got the apple.
2025-01-22 18:38:35.090 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra travelled to the bathroom.
2025-01-22 18:38:35.095 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (901, 906) --> . Sandra travelled to the
2025-01-22 18:38:35.095 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra journeyed to the bedroom.
2025-01-22 18:38:35.106 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2010, 2016) -->  cable. Sandra journeyed to
2025-01-22 18:38:35.107 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John grabbed the milk.
2025-01-22 18:38:35.130 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4767, 4771) -->  John grabbed the milk
2025-01-22 18:38:35.130 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went back to the office.
2025-01-22 18:38:35.151 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3998, 4004) -->  Daniel went back to the office
2025-01-22 18:38:35.151 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary moved to the bathroom.
2025-01-22 18:38:35.170 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3512, 3517) --> . Mary moved to the
2025-01-22 18:38:35.171 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the garden.
2025-01-22 18:38:35.196 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4977, 4983) --> . Mary went back to the
2025-01-22 18:38:35.196 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John left the milk.
2025-01-22 18:38:35.229 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3989, 3993) -->  John left the milk
2025-01-22 18:38:35.229 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 18:38:35.229 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 18:38:35.229 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 18:38:35.229 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ²', 'ğŸ’†ğŸ¼\u200dâ™‚ï¸', 'ğŸ’', 'ğŸ˜¡', 'ğŸ¥¡', 'ğŸ‡±ğŸ‡§', 'ğŸ§˜ğŸ¾\u200dâ™‚ï¸', 'ğŸ™‹ğŸ¼\u200dâ™€ï¸', 'ğŸ™ğŸ¿\u200dâ™‚', 'ğŸ‘ğŸ½']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  3.87s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.29s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.52s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.19s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.60s/it]
Processing depth (0, 1, 5, 7):   2%|â–         | 2/100 [01:32<36:08, 22.13s/it]2025-01-22 18:38:51.365 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra got the apple.
2025-01-22 18:38:51.411 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra travelled to the bathroom.
2025-01-22 18:38:51.419 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (821, 826) --> . Sandra travelled to the
2025-01-22 18:38:51.419 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra journeyed to the bedroom.
2025-01-22 18:38:51.441 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4214, 4220) -->  Sandra journeyed to the bedroom
2025-01-22 18:38:51.441 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John grabbed the milk.
2025-01-22 18:38:51.468 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5638, 5642) -->  John grabbed the milk
2025-01-22 18:38:51.468 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went back to the office.
2025-01-22 18:38:51.488 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3894, 3900) --> . Daniel went back to the
2025-01-22 18:38:51.488 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary moved to the bathroom.
2025-01-22 18:38:51.505 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3493, 3498) --> . Mary moved to the
2025-01-22 18:38:51.506 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the garden.
2025-01-22 18:38:51.530 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4940, 4946) --> . Mary went back to the
2025-01-22 18:38:51.530 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John left the milk.
2025-01-22 18:38:51.552 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3864, 3868) -->  John left the milk
2025-01-22 18:38:51.552 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 18:38:51.552 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 18:38:51.552 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 18:38:51.552 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ§‘ğŸ»\u200dâ¤ï¸\u200dğŸ§‘ğŸ½', 'ğŸ”‚', 'ğŸš¶ğŸ¼\u200dâ™‚\u200dâ¡ï¸', 'ğŸ‘¨\u200dğŸ¦°', 'ğŸš³', 'ğŸ’', 'ğŸ‘©ğŸ¾\u200dğŸ¦¯\u200dâ¡ï¸', '\U0001fa75', 'ğŸ›¹', '\U0001fac3ğŸ¼']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.86s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.74s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.34s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.03s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.60s/it]
Processing depth (2, 4, 6, 8):   2%|â–         | 2/100 [01:49<36:08, 22.13s/it]2025-01-22 18:39:07.744 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra got the apple.
2025-01-22 18:39:07.754 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1842, 1846) -->  Sandra got the apple
2025-01-22 18:39:07.754 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra travelled to the bathroom.
2025-01-22 18:39:07.776 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3615, 3620) -->  Hon. Sandra travelled to
2025-01-22 18:39:07.776 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra journeyed to the bedroom.
2025-01-22 18:39:07.800 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4853, 4859) -->  Sandra journeyed to the bedroom
2025-01-22 18:39:07.801 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John grabbed the milk.
2025-01-22 18:39:07.833 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6588, 6592) -->  grabbed the milk.
2025-01-22 18:39:07.833 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went back to the office.
2025-01-22 18:39:07.856 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3945, 3951) -->  the ground. Daniel went back
2025-01-22 18:39:07.856 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary moved to the bathroom.
2025-01-22 18:39:07.873 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3438, 3443) --> . Mary moved to the
2025-01-22 18:39:07.873 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the garden.
2025-01-22 18:39:07.898 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5027, 5033) --> . Mary went back to the
2025-01-22 18:39:07.899 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John left the milk.
2025-01-22 18:39:07.920 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3881, 3885) -->  John left the milk
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:39:08.761 | INFO     | test_jbb_embedding:begin_test:693 - Sandra's desk.<|eot_id|>
2025-01-22 18:39:08.762 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8119])
2025-01-22 18:39:10.967 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [325.3799342105263, 32.01869536444226, 155.27380952380952, 31.008769487750556, 29.393402777777776], 'topk_indices': array([8102, 8109, 3443, 7973, 1845, 1846, 8007, 1849, 8113, 8117, 1850,
       8017, 8107, 3473, 3476, 3474, 8114, 3475, 8115,    0]), 'topk_tokens': [':', ' bedroom', ' bathroom', ' context', ' apple', '.', '.\n\n', ' *', ':', '<|end_header_id|>', '      ', ' location', ' before', ' *', '      ', '      ', '<|eot_id|>', ' *', '<|start_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [658.5, 263.825, 336.25, 52.8984375]}, 'weight': {'score': [25.799753289473685, 23.241593049741443, 22.140997023809526, 23.23843881464984, 29.49375], 'topk_indices': array([3272, 3299, 3144, 3192, 7406, 7368, 1467, 1405, 4275, 4291, 5110,
       5171, 7145, 7089, 3461, 3487, 4880, 4905, 4957, 4928]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.095703125, 26.9578125, 25.735677083333332, 22.15234375]}, 'saliency': {'score': [2.257645456414474, 0.17942520363287984, 0.8261369977678571, 0.1728591144866679, 0.21841634114583333], 'topk_indices': array([8106, 3472, 8016, 8101, 8112, 1849, 7973, 3621, 4858, 1845, 1850,
       8107, 8109, 8017, 3473, 3443, 1842, 3474, 3476, 3475]), 'topk_tokens': [' apple', '      ', ' first', 'Question', 'Answer', ' *', ' context', ' bathroom', ' bedroom', ' apple', '      ', ' before', ' bedroom', ' location', ' *', ' bathroom', ' Sandra', '      ', '      ', ' *'], 'evidence_proportions': [4.686279296875, 1.81171875, 2.3138020833333335, 0.30218505859375]}}, 'pred_res': "Sandra's desk.<|eot_id|>", 'score': 0}
2025-01-22 18:39:10.973 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:39:10.973 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-110_pid-2_2-4-6-8.pkl | len: 3 |  size: 2.03 KB
Processing depth (2, 4, 6, 8):   3%|â–         | 3/100 [01:52<1:10:19, 43.50s/it]is_0k: False
your chose emoji: ['ğŸš¶\u200dâ™‚\u200dâ¡ï¸', 'âœŒğŸ¿', 'ğŸ“¿', 'ğŸ–‡', 'ğŸŸ£', 'ğŸ¦¸ğŸ¾\u200dâ™€', 'ğŸ¯', 'ğŸ°', 'â›¹ğŸ½', 'ğŸ’¶']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.67s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:10,  5.05s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.69s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.26s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.83s/it]
Processing depth (0, 1, 2, 7):   3%|â–         | 3/100 [02:09<1:10:19, 43.50s/it]2025-01-22 18:39:28.379 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra got the apple.
2025-01-22 18:39:28.419 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra travelled to the bathroom.
2025-01-22 18:39:28.425 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (901, 906) --> . Sandra travelled to the
2025-01-22 18:39:28.425 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra journeyed to the bedroom.
2025-01-22 18:39:28.437 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1865, 1871) --> . Sandra journeyed to the
2025-01-22 18:39:28.437 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John grabbed the milk.
2025-01-22 18:39:28.470 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5784, 5788) -->  John grabbed the milk
2025-01-22 18:39:28.470 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went back to the office.
2025-01-22 18:39:28.490 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3941, 3947) -->  the ground. Daniel went back
2025-01-22 18:39:28.490 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary moved to the bathroom.
2025-01-22 18:39:28.510 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3440, 3445) --> . Mary moved to the
2025-01-22 18:39:28.510 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the garden.
2025-01-22 18:39:28.535 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5012, 5018) --> . Mary went back to the
2025-01-22 18:39:28.536 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John left the milk.
2025-01-22 18:39:28.559 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3877, 3881) -->  John left the milk
2025-01-22 18:39:28.559 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 18:39:28.559 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 18:39:28.559 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 18:39:28.559 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ…°', 'ğŸ¦¾', 'ğŸ§ğŸ½\u200dâ™€ï¸', 'ğŸš¶ğŸ½\u200dâ™‚\u200dâ¡ï¸', 'ğŸ¦¢', 'ğŸ§‘ğŸ½\u200dâš•', 'ğŸš–', 'ğŸ§‡', 'ğŸš¶ğŸ¼\u200dâ¡', 'â›¹ğŸ½\u200dâ™€ï¸']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.38s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:11,  5.66s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:16<00:05,  5.58s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:17<00:00,  3.84s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:17<00:00,  4.40s/it]
Processing depth (5, 6, 7, 9):   3%|â–         | 3/100 [02:29<1:10:19, 43.50s/it]2025-01-22 18:39:47.862 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra got the apple.
2025-01-22 18:39:47.883 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4225, 4229) -->  got the apple.
2025-01-22 18:39:47.883 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra travelled to the bathroom.
2025-01-22 18:39:47.910 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4764, 4769) -->  the senate. Sandra travelled
2025-01-22 18:39:47.910 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra journeyed to the bedroom.
2025-01-22 18:39:47.942 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5653, 5659) --> . Sandra journeyed to the
2025-01-22 18:39:47.943 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John grabbed the milk.
2025-01-22 18:39:47.979 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7353, 7357) -->  John grabbed the milk
2025-01-22 18:39:47.979 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went back to the office.
2025-01-22 18:39:47.999 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3943, 3949) -->  Daniel went back to the office
2025-01-22 18:39:47.999 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary moved to the bathroom.
2025-01-22 18:39:48.018 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3471, 3476) --> . Mary moved to the
2025-01-22 18:39:48.018 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the garden.
2025-01-22 18:39:48.047 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4978, 4984) --> . Mary went back to the
2025-01-22 18:39:48.047 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John left the milk.
2025-01-22 18:39:48.068 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3918, 3922) -->  John left the milk
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:39:48.839 | INFO     | test_jbb_embedding:begin_test:693 - the garden<|eot_id|>
2025-01-22 18:39:48.839 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8157])
2025-01-22 18:39:51.063 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [162.4753289473684, 17.992317708333335, 182.74107142857142, 17.228167333743844, 35.99267578125], 'topk_indices': array([8045,    9, 5659, 8156,   23, 8055, 8148, 8147, 8145, 4771, 8138,
       8151, 3476,    1,   14,   28,   24, 8155,    0, 8152]), 'topk_tokens': ['.\n\n', ':', ' bedroom', '\n\n', '4', ' location', '?', ' bedroom', ' before', ' bathroom', '.\n\n', ':', ' bathroom', '<|start_header_id|>', '\n', '<|end_header_id|>', '\n\n', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [282.5, 160.65625, 176.625, 23.5]}, 'weight': {'score': [23.78248355263158, 23.2698912377451, 22.32514880952381, 23.271135121613302, 29.437744140625], 'topk_indices': array([3253, 3280, 3125, 3173, 7374, 7412, 1415, 1477, 4291, 4275, 5182,
       5121, 7146, 7090, 3436, 3462, 4916, 4968, 4891, 4939]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.5703125, 26.878125, 21.213541666666668, 26.978515625]}, 'saliency': {'score': [0.9817263954564145, 0.10033168418734681, 0.9881649925595238, 0.0959731867747941, 0.2601020336151123], 'topk_indices': array([  23, 4768,    8, 8141, 3473, 8148, 8154, 8144, 8138, 4227, 8139,
       8150,   24, 8055, 8145, 5659, 4224, 8147, 4771, 3476]), 'topk_tokens': ['4', ' travelled', ' Date', ' Where', ' moved', '?', 'assistant', ' apple', '.\n\n', ' apple', 'Question', 'Answer', '\n\n', ' location', ' before', ' bedroom', ' Sandra', ' bedroom', ' bathroom', ' bathroom'], 'evidence_proportions': [1.5372314453125, 1.2228271484375, 0.9517008463541666, 0.16988372802734375]}}, 'pred_res': 'the garden<|eot_id|>', 'score': 0}
2025-01-22 18:39:51.070 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:39:51.071 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-110_pid-3_5-6-7-9.pkl | len: 3 |  size: 2.03 KB
Processing depth (5, 6, 7, 9):   4%|â–         | 4/100 [02:32<1:07:27, 42.16s/it]is_0k: False
your chose emoji: ['ğŸ¦¹ğŸ»', 'ğŸ¦¹ğŸ»\u200dâ™€', 'ğŸ‘¨ğŸ»\u200dâœˆï¸', 'ğŸ‡«ğŸ‡´', 'âœ¡', 'ğŸ¦¢', 'ğŸ‘¨ğŸ»\u200dğŸ¨', 'ğŸŠğŸ»\u200dâ™€', 'ğŸ„ğŸ¾', 'ğŸ‡µğŸ‡­']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.50s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.86s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.72s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.32s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.83s/it]
Processing depth (2, 4, 7, 8):   4%|â–         | 4/100 [02:49<1:07:27, 42.16s/it]2025-01-22 18:40:08.199 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra got the apple.
2025-01-22 18:40:08.207 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1594, 1598) -->  Sandra got the apple
2025-01-22 18:40:08.207 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra travelled to the bathroom.
2025-01-22 18:40:08.228 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3516, 3521) --> . Sandra travelled to the
2025-01-22 18:40:08.228 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra journeyed to the bedroom.
2025-01-22 18:40:08.257 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5619, 5625) --> . Sandra journeyed to the
2025-01-22 18:40:08.257 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John grabbed the milk.
2025-01-22 18:40:08.289 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6555, 6559) -->  John grabbed the milk
2025-01-22 18:40:08.289 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went back to the office.
2025-01-22 18:40:08.313 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3843, 3849) --> . Daniel went back to the
2025-01-22 18:40:08.313 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary moved to the bathroom.
2025-01-22 18:40:08.329 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3276, 3281) --> . Mary moved to the
2025-01-22 18:40:08.330 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the garden.
2025-01-22 18:40:08.354 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4912, 4918) --> . Mary went back to the
2025-01-22 18:40:08.354 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John left the milk.
2025-01-22 18:40:08.373 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3815, 3819) -->  John left the milk
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:40:09.229 | INFO     | test_jbb_embedding:begin_test:693 - Sandra's hand.<|eot_id|>
2025-01-22 18:40:09.229 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8181])
2025-01-22 18:40:11.442 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [250.84416118421052, 17.20619119623656, 100.66220238095238, 16.445913978082025, 11.885163959703947], 'topk_indices': array([1598, 8164, 8169, 1595,    3, 8069, 3521, 3281,    1, 8162, 1593,
       8175,   24,   14, 1597, 8179, 8177, 1594,    0, 8176]), 'topk_tokens': ['.', ':', ' before', ' got', '<|end_header_id|>', '.\n\n', ' bathroom', ' bathroom', '<|start_header_id|>', '.\n\n', '.', ':', '\n\n', '\n', ' apple', '<|end_header_id|>', '<|start_header_id|>', ' Sandra', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [668.75, 216.3, 155.39583333333334, 19.291015625]}, 'weight': {'score': [24.122532894736842, 23.281708211143695, 21.369419642857142, 23.284677561701866, 29.10341282894737], 'topk_indices': array([3298, 3325, 3158, 3206, 7434, 7472, 1449, 1511, 4295, 4311, 5212,
       5151, 7155, 7211, 3481, 3507, 4908, 4883, 4967, 4938]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.095703125, 22.15, 21.213541666666668, 26.978515625]}, 'saliency': {'score': [1.70098876953125, 0.09580750525988209, 0.51983642578125, 0.09096921309975135, 0.08756697805304277], 'topk_indices': array([  14, 8165, 3518, 3517, 8079, 8069, 8162,   24, 8035, 8163, 8169,
       5625, 8168, 1595, 8174, 8171, 3281, 3521, 1597, 1594]), 'topk_tokens': ['\n', ' Where', ' travelled', ' Sandra', ' location', '.\n\n', '.\n\n', '\n\n', ' context', 'Question', ' before', ' bedroom', ' apple', ' got', 'Answer', ' bedroom', ' bathroom', ' bathroom', ' apple', ' Sandra'], 'evidence_proportions': [5.124755859375, 1.265869140625, 0.8240152994791666, 0.1365814208984375]}}, 'pred_res': "Sandra's hand.<|eot_id|>", 'score': 0}
2025-01-22 18:40:11.449 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:40:11.449 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-110_pid-4_2-4-7-8.pkl | len: 3 |  size: 2.04 KB
Processing depth (2, 4, 7, 8):   5%|â–Œ         | 5/100 [02:52<54:18, 34.30s/it]  Processing depth (2, 4, 7, 8):   5%|â–Œ         | 5/100 [02:53<54:47, 34.60s/it]
2025-01-22 18:40:11.570 | INFO     | __main__:<module>:82 - Selected idx: 112
2025-01-22 18:40:11.571 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the apple before the bedroom? 
2025-01-22 18:40:11.571 | INFO     | __main__:<module>:84 - Answer: bathroom
2025-01-22 18:40:11.571 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 18:40:11.571 | INFO     | __main__:<module>:86 - Needle: [' Mary moved to the bathroom.', ' Sandra grabbed the apple.', ' John grabbed the milk.', ' Daniel went back to the office.', ' Sandra travelled to the bathroom.', ' John left the milk.', ' Daniel journeyed to the garden.', ' John grabbed the milk.', ' Mary went back to the garden.', ' Sandra journeyed to the bedroom.', ' John went back to the hallway.']
2025-01-22 18:40:11.571 | INFO     | __main__:<module>:87 - Real Needle: [' Sandra grabbed the apple.', ' Sandra travelled to the bathroom.', ' Sandra journeyed to the bedroom.', ' John went back to the hallway.']
2025-01-22 18:40:11.571 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ‘¨ğŸ¾\u200dğŸ¤\u200dğŸ‘¨ğŸ¿', 'ğŸ¾', 'ğŸˆµ', 'ğŸ‘½', 'ğŸ‡¦ğŸ‡±', 'ğŸ¤ğŸ»', 'ğŸ‘©ğŸ½\u200dğŸ¦¯', 'ğŸ‡¦ğŸ‡«', 'ğŸ‘¨ğŸ¾\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘¨ğŸ½', 'â˜¢ï¸']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.07s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.68s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.88s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.41s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.86s/it]
Processing depth (2, 3, 7, 8):   0%|          | 0/100 [00:16<?, ?it/s]2025-01-22 18:40:28.734 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra grabbed the apple.
2025-01-22 18:40:28.745 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1854, 1858) -->  Sandra grabbed the apple
2025-01-22 18:40:28.745 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra travelled to the bathroom.
2025-01-22 18:40:28.760 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2919, 2924) -->  Sandra travelled to the bathroom
2025-01-22 18:40:28.760 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra journeyed to the bedroom.
2025-01-22 18:40:28.794 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5778, 5784) --> . Sandra journeyed to the
2025-01-22 18:40:28.795 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the hallway.
2025-01-22 18:40:28.838 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6627, 6633) --> . John went back to the
2025-01-22 18:40:28.838 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bathroom.
2025-01-22 18:40:28.876 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (7522, 7527) --> . Mary moved to the
2025-01-22 18:40:28.877 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John grabbed the milk.
2025-01-22 18:40:28.878 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (298, 302) -->  John grabbed the milk
2025-01-22 18:40:28.879 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the office.
2025-01-22 18:40:28.920 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (7002, 7008) --> . Daniel went back to the
2025-01-22 18:40:28.920 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John left the milk.
2025-01-22 18:40:28.942 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3950, 3954) -->  left the milk.
2025-01-22 18:40:28.943 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel journeyed to the garden.
2025-01-22 18:40:28.953 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1774, 1780) --> . Daniel journeyed to the
2025-01-22 18:40:28.953 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John grabbed the milk.
2025-01-22 18:40:28.954 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (298, 302) -->  John grabbed the milk
2025-01-22 18:40:28.955 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Mary went back to the garden.
2025-01-22 18:40:28.997 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (7082, 7088) -->  Mary went back to the garden
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:40:29.752 | INFO     | test_jbb_embedding:begin_test:693 - the garden<|eot_id|>
2025-01-22 18:40:29.752 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8178])
2025-01-22 18:40:32.006 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [280.51934523809524, 23.802610469380273, 140.99955357142858, 22.634248076923075, 26.87256610576923], 'topk_indices': array([   1, 5784, 1860, 8168,  302, 1858, 8165,   24,   14, 8172, 1857,
       8166, 1861, 1862, 1780, 2923, 1854, 8176, 8173,    0]), 'topk_tokens': ['<|start_header_id|>', ' bedroom', '      ', ' bedroom', '.', '.', ' apple', '\n\n', '\n', ':', ' apple', ' before', ' *', '      ', ' garden', ' bathroom', ' Sandra', '<|end_header_id|>', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [555.0, 464.65, 196.1875, 28.421875]}, 'weight': {'score': [24.090029761904763, 23.266085289084465, 22.556473214285713, 23.2670125, 29.134615384615383], 'topk_indices': array([3258, 3285, 3178, 3130, 7411, 7373, 1472, 1410, 4279, 4295, 5151,
       5090, 7094, 7150, 3467, 3441, 4915, 4892, 4944, 4867]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [29.748046875, 27.8390625, 21.213541666666668, 20.0703125]}, 'saliency': {'score': [2.052882603236607, 0.13425366381039144, 0.8472630092075892, 0.12622332106370193, 0.19715505746694711], 'topk_indices': array([ 299, 2916, 1776, 1860, 2919, 8032, 8171, 8160, 1855, 2920, 5784,
       8168, 8165, 1861, 8166, 1857, 1862, 1780, 2923, 1854]), 'topk_tokens': [' grabbed', 'ï¿½ï¿½', ' journey', '      ', ' Sandra', ' context', 'Answer', 'Question', ' grabbed', ' travelled', ' bedroom', ' bedroom', ' apple', ' *', ' before', ' apple', '      ', ' garden', ' bathroom', ' Sandra'], 'evidence_proportions': [4.55517578125, 3.5572265625, 1.0353190104166667, 0.14863077799479166]}}, 'pred_res': 'the garden<|eot_id|>', 'score': 0}
2025-01-22 18:40:32.027 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:40:32.027 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-112_pid-0_2-3-7-8.pkl | len: 3 |  size: 2.04 KB
Processing depth (2, 3, 7, 8):   1%|          | 1/100 [00:20<33:34, 20.35s/it]is_0k: False
your chose emoji: ['\U0001fac4ğŸ¾', 'ğŸƒ', 'ğŸ‘¨\u200dâš•', 'ğŸ¦“', 'ğŸ™‚', '\U0001fac3ğŸ¿', 'ğŸª°', 'ğŸ§‘ğŸ¿\u200dğŸš’', 'ğŸ‘†ğŸ»', 'ğŸ§‘ğŸ¾\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ§‘ğŸ¼']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.22s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.55s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.57s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.21s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.68s/it]
Processing depth (5, 6, 8, 9):   1%|          | 1/100 [00:36<33:34, 20.35s/it]2025-01-22 18:40:48.570 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra grabbed the apple.
2025-01-22 18:40:48.593 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4219, 4223) -->  grabbed the apple.
2025-01-22 18:40:48.594 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra travelled to the bathroom.
2025-01-22 18:40:48.618 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4772, 4777) -->  the senate. Sandra travelled
2025-01-22 18:40:48.618 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra journeyed to the bedroom.
2025-01-22 18:40:48.651 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6520, 6526) --> . Sandra journeyed to the
2025-01-22 18:40:48.651 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the hallway.
2025-01-22 18:40:48.691 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7231, 7237) --> . John went back to the
2025-01-22 18:40:48.692 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bathroom.
2025-01-22 18:40:48.729 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (7400, 7405) --> . Mary moved to the
2025-01-22 18:40:48.729 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John grabbed the milk.
2025-01-22 18:40:48.731 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (298, 302) -->  John grabbed the milk
2025-01-22 18:40:48.731 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the office.
2025-01-22 18:40:48.771 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6933, 6939) --> . Daniel went back to the
2025-01-22 18:40:48.771 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John left the milk.
2025-01-22 18:40:48.790 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3959, 3963) -->  left the milk.
2025-01-22 18:40:48.790 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel journeyed to the garden.
2025-01-22 18:40:48.800 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1786, 1792) --> . Daniel journeyed to the
2025-01-22 18:40:48.800 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John grabbed the milk.
2025-01-22 18:40:48.801 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (298, 302) -->  John grabbed the milk
2025-01-22 18:40:48.801 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Mary went back to the garden.
2025-01-22 18:40:48.838 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (7080, 7086) --> . Mary went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:40:49.607 | INFO     | test_jbb_embedding:begin_test:693 - the hallway<|eot_id|>
2025-01-22 18:40:49.608 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8182])
2025-01-22 18:40:51.906 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [91.17782738095238, 16.50597510690287, 76.990625, 16.052651002583342, 19.544921875], 'topk_indices': array([8172, 8176, 8163,    4, 8170,    9,   23, 8178,    3,    1, 7568,
         24, 7569, 7370,   14, 7921, 7524,    0, 8180, 8177]), 'topk_tokens': [' bedroom', ':', '.\n\n', '\n\n', ' before', ':', '4', '<|start_header_id|>', '<|end_header_id|>', '<|start_header_id|>', ' Min', '\n\n', 'nes', 'nes', '\n', ' Square', 'nes', '<|begin_of_text|>', '<|end_header_id|>', '<|eot_id|>'], 'evidence_proportions': [184.9375, 75.503125, 94.56770833333333, 38.34375]}, 'weight': {'score': [22.42782738095238, 23.264458613317043, 21.911607142857143, 23.272444719522696, 28.86007462686567], 'topk_indices': array([3282, 3255, 3175, 3127, 7461, 7423, 1484, 1422, 4305, 4321, 5134,
       5195, 7125, 7181, 3464, 3438, 4899, 4924, 4976, 4947]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.22265625, 26.878125, 21.213541666666668, 20.0703125]}, 'saliency': {'score': [0.5259007045200893, 0.09273901620723884, 0.47337559291294645, 0.08998115230771005, 0.14003172917152518], 'topk_indices': array([4779,    8,   23,   20, 8169, 7292, 7920, 7369, 7523, 8175, 7321,
         24, 4218, 8170, 8172, 7569, 7370, 7568, 7921, 7524]), 'topk_tokens': [' bathroom', ' Date', '4', ' Jul', ' apple', 'nes', 'Bridge', ' Min', ' Min', 'Answer', 'nes', '\n\n', ' Sandra', ' before', ' bedroom', 'nes', 'nes', ' Min', ' Square', 'nes'], 'evidence_proportions': [1.077880859375, 0.564227294921875, 0.470703125, 0.18117268880208334]}}, 'pred_res': 'the hallway<|eot_id|>', 'score': 0}
2025-01-22 18:40:51.919 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:40:51.919 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-112_pid-1_5-6-8-9.pkl | len: 3 |  size: 2.0 KB
Processing depth (5, 6, 8, 9):   2%|â–         | 2/100 [00:40<32:48, 20.08s/it]is_0k: False
your chose emoji: ['ğŸ‘¨ğŸ¾\u200dğŸ¦¯', 'ğŸ‡¦ğŸ‡½', 'ğŸ¦µğŸ¿', 'ğŸŒ', 'ğŸ§™ğŸ»', 'ğŸ§šğŸ»', 'ğŸ‘­ğŸ½', 'ğŸ§•ğŸ¼', 'ğŸš£ğŸ½\u200dâ™€ï¸', 'ğŸŒğŸ»\u200dâ™‚']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.46s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.93s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.70s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.28s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.81s/it]
Processing depth (1, 2, 3, 7):   2%|â–         | 2/100 [00:57<32:48, 20.08s/it]2025-01-22 18:41:09.078 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra grabbed the apple.
2025-01-22 18:41:09.083 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (827, 831) -->  Sandra grabbed the apple
2025-01-22 18:41:09.083 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra travelled to the bathroom.
2025-01-22 18:41:09.094 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1864, 1869) --> . Sandra travelled to the
2025-01-22 18:41:09.095 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra journeyed to the bedroom.
2025-01-22 18:41:09.110 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2940, 2946) --> . Sandra journeyed to the
2025-01-22 18:41:09.113 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the hallway.
2025-01-22 18:41:09.142 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5729, 5735) --> . John went back to the
2025-01-22 18:41:09.142 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bathroom.
2025-01-22 18:41:09.180 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (7402, 7407) --> . Mary moved to the
2025-01-22 18:41:09.180 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John grabbed the milk.
2025-01-22 18:41:09.181 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (264, 268) -->  John grabbed the milk
2025-01-22 18:41:09.181 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the office.
2025-01-22 18:41:09.217 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6920, 6926) --> . Daniel went back to the
2025-01-22 18:41:09.217 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John left the milk.
2025-01-22 18:41:09.236 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4028, 4032) -->  John left the milk
2025-01-22 18:41:09.236 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel journeyed to the garden.
2025-01-22 18:41:09.245 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1785, 1791) --> . Daniel journeyed to the
2025-01-22 18:41:09.245 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John grabbed the milk.
2025-01-22 18:41:09.247 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (264, 268) -->  John grabbed the milk
2025-01-22 18:41:09.247 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Mary went back to the garden.
2025-01-22 18:41:09.289 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (7061, 7067) --> . Mary went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:41:10.039 | INFO     | test_jbb_embedding:begin_test:693 - the garden<|eot_id|>
2025-01-22 18:41:10.039 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8170])
2025-01-22 18:41:12.255 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [145.15625, 16.84075423651046, 104.234375, 16.13194529998768, 9.797675461065573], 'topk_indices': array([8169, 8155, 8152, 2947, 8153,    4, 8151, 8164,    3, 8160, 8161,
          1, 1869,   14, 8158,   24, 8166, 8168,    0, 8165]), 'topk_tokens': ['\n\n', ' was', 'Question', '.', ':', '\n\n', '.\n\n', ':', '<|end_header_id|>', ' bedroom', '?', '<|start_header_id|>', ' bathroom', '\n', ' before', '\n\n', '<|start_header_id|>', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [262.78125, 187.075, 151.10416666666666, 25.859375]}, 'weight': {'score': [22.735491071428573, 23.263879542395692, 22.463169642857142, 23.268699180731797, 29.371670081967213], 'topk_indices': array([3308, 3281, 3153, 3201, 7425, 7463, 1483, 1421, 4282, 4298, 5180,
       5119, 7140, 7196, 3464, 3490, 4944, 4973, 4896, 4921]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [29.748046875, 22.15, 21.213541666666668, 20.0703125]}, 'saliency': {'score': [0.9132138206845238, 0.09304677761856876, 0.6512869698660714, 0.08851777495341567, 0.07074149710233094], 'topk_indices': array([8155, 1787, 1786, 8167, 8064,  265, 1791, 8154, 8151,  830, 8161,
       8157, 8163, 8152, 2946,  827,   24, 8160, 8158, 1869]), 'topk_tokens': [' was', ' journey', ' Daniel', 'assistant', ' item', ' grabbed', ' garden', ' Where', '.\n\n', ' apple', '?', ' apple', 'Answer', 'Question', ' bedroom', ' Sandra', '\n\n', ' bedroom', ' before', ' bathroom'], 'evidence_proportions': [2.10223388671875, 1.12353515625, 0.7199300130208334, 0.1385498046875]}}, 'pred_res': 'the garden<|eot_id|>', 'score': 0}
2025-01-22 18:41:12.259 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:41:12.259 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-112_pid-2_1-2-3-7.pkl | len: 3 |  size: 2.03 KB
Processing depth (1, 2, 3, 7):   3%|â–         | 3/100 [01:00<32:39, 20.20s/it]is_0k: False
your chose emoji: ['ğŸ‘©\u200dğŸ¦¼', 'ğŸ§ğŸ»\u200dâ™‚ï¸\u200dâ¡', 'ğŸ¦µğŸ»', 'ğŸ§”ğŸ¾', 'ğŸ§ğŸ¾\u200dâ™‚ï¸', '\U0001faf7ğŸ»', 'ğŸ’®', 'ğŸ‡±ğŸ‡°', 'ğŸ©±', 'ğŸ’ˆ']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.48s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.66s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.80s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.33s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.83s/it]
Processing depth (0, 2, 6, 9):   3%|â–         | 3/100 [01:17<32:39, 20.20s/it]2025-01-22 18:41:29.260 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra grabbed the apple.
2025-01-22 18:41:29.299 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra travelled to the bathroom.
2025-01-22 18:41:29.323 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1771, 1776) --> . Sandra travelled to the
2025-01-22 18:41:29.323 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra journeyed to the bedroom.
2025-01-22 18:41:29.350 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4767, 4773) --> . Sandra journeyed to the
2025-01-22 18:41:29.350 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the hallway.
2025-01-22 18:41:29.389 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7256, 7262) --> . John went back to the
2025-01-22 18:41:29.389 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bathroom.
2025-01-22 18:41:29.430 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (7440, 7445) -->  Mary moved to the bathroom
2025-01-22 18:41:29.430 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John grabbed the milk.
2025-01-22 18:41:29.432 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (264, 268) -->  John grabbed the milk
2025-01-22 18:41:29.432 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the office.
2025-01-22 18:41:29.470 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6959, 6965) -->  Daniel went back to the office
2025-01-22 18:41:29.470 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John left the milk.
2025-01-22 18:41:29.489 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3942, 3946) -->  John left the milk
2025-01-22 18:41:29.489 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel journeyed to the garden.
2025-01-22 18:41:29.497 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1606, 1612) --> . Daniel journeyed to the
2025-01-22 18:41:29.497 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John grabbed the milk.
2025-01-22 18:41:29.499 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (264, 268) -->  John grabbed the milk
2025-01-22 18:41:29.499 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Mary went back to the garden.
2025-01-22 18:41:29.540 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (7105, 7111) --> . Mary went back to the
2025-01-22 18:41:29.541 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 18:41:29.541 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 18:41:29.541 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 18:41:29.541 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ‘±\u200dâ™‚', 'ğŸ“š', 'ğŸ‘¨ğŸ½\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘¨ğŸ»', 'ğŸ‘©ğŸ¼\u200dğŸ³', 'ğŸ‡µğŸ‡³', 'ğŸ™ˆ', 'ğŸ¤§', 'ğŸ‘©ğŸ½\u200dğŸ¤\u200dğŸ‘©ğŸ¼', 'ğŸ‘¨ğŸ¾\u200dğŸ¦²', 'ğŸ¦¶']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.51s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.38s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.37s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.05s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.54s/it]
Processing depth (1, 2, 4, 5):   3%|â–         | 3/100 [01:33<32:39, 20.20s/it]2025-01-22 18:41:45.422 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra grabbed the apple.
2025-01-22 18:41:45.427 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (901, 905) -->  Sandra grabbed the apple
2025-01-22 18:41:45.427 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra travelled to the bathroom.
2025-01-22 18:41:45.440 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2015, 2020) -->  cable. Sandra travelled to
2025-01-22 18:41:45.440 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra journeyed to the bedroom.
2025-01-22 18:41:45.460 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3629, 3635) -->  Hon. Sandra journeyed to
2025-01-22 18:41:45.461 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the hallway.
2025-01-22 18:41:45.487 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4230, 4236) -->  John went back to the hallway
2025-01-22 18:41:45.488 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bathroom.
2025-01-22 18:41:45.533 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (7444, 7449) --> . Mary moved to the
2025-01-22 18:41:45.534 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John grabbed the milk.
2025-01-22 18:41:45.535 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (298, 302) -->  John grabbed the milk
2025-01-22 18:41:45.536 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the office.
2025-01-22 18:41:45.579 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6962, 6968) --> . Daniel went back to the
2025-01-22 18:41:45.579 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John left the milk.
2025-01-22 18:41:45.606 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3970, 3974) -->  John left the milk
2025-01-22 18:41:45.606 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel journeyed to the garden.
2025-01-22 18:41:45.618 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1845, 1851) --> . Daniel journeyed to the
2025-01-22 18:41:45.618 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John grabbed the milk.
2025-01-22 18:41:45.619 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (298, 302) -->  John grabbed the milk
2025-01-22 18:41:45.620 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Mary went back to the garden.
2025-01-22 18:41:45.657 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (7103, 7109) --> . Mary went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:41:46.433 | INFO     | test_jbb_embedding:begin_test:693 - the hallway<|eot_id|>
2025-01-22 18:41:46.433 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8216])
2025-01-22 18:41:48.723 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [134.19940476190476, 16.89768372064728, 136.121875, 16.084724901996815, 8.161272321428571], 'topk_indices': array([   9,  302, 8212,    4, 8206, 8197, 8207, 1851, 7965,    3, 2021,
       8210,  299,    1, 8204,   14,   24, 8214,    0, 8211]), 'topk_tokens': [':', '.', '<|start_header_id|>', '\n\n', ' bedroom', '.\n\n', '?', ' garden', ' Square', '<|end_header_id|>', ' bathroom', ':', ' grabbed', '<|start_header_id|>', ' before', '\n', '\n\n', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [285.59375, 138.3375, 103.27083333333333, 60.75]}, 'weight': {'score': [26.385416666666668, 23.305534432412703, 22.463169642857142, 23.301222934276613, 29.737165178571427], 'topk_indices': array([3272, 3299, 3144, 3192, 7467, 7505, 1471, 1409, 4307, 4323, 5179,
       5118, 7182, 7238, 3501, 3475, 4920, 4972, 4895, 4943]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [29.748046875, 26.5765625, 25.220052083333332, 25.149739583333332]}, 'saliency': {'score': [0.9471755254836309, 0.09420075714189302, 0.8758492606026785, 0.08865498135403267, 0.06114378429594494], 'topk_indices': array([   8, 8197, 1847, 8207, 8203,  902, 1846,  904, 8209, 3636, 8198,
        301,   24, 7965, 1851,  901, 8204, 8206,  299, 2021]), 'topk_tokens': [' Date', '.\n\n', ' journey', '?', ' apple', ' grabbed', ' Daniel', ' apple', 'Answer', ' bedroom', 'Question', ' milk', '\n\n', ' Square', ' garden', ' Sandra', ' before', ' bedroom', ' grabbed', ' bathroom'], 'evidence_proportions': [2.2789306640625, 0.914111328125, 0.6035563151041666, 0.430511474609375]}}, 'pred_res': 'the hallway<|eot_id|>', 'score': 0}
2025-01-22 18:41:48.734 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:41:48.734 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-112_pid-3_1-2-4-5.pkl | len: 3 |  size: 2.04 KB
Processing depth (1, 2, 4, 5):   4%|â–         | 4/100 [01:37<42:35, 26.62s/it]is_0k: False
your chose emoji: ['ğŸ‘·ğŸ»\u200dâ™‚ï¸', 'ğŸ™‡ğŸ¼\u200dâ™€', 'ğŸ‡¦ğŸ‡®', 'ğŸ§”ğŸ»\u200dâ™€ï¸', '\U0001faf4ğŸ¿', 'ğŸ„ğŸ¾', 'ğŸ‘¨ğŸ»\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘¨ğŸ¾', 'ğŸ•µğŸ½\u200dâ™‚ï¸', 'ğŸ‘·ğŸ¿', 'ğŸ“½ï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.82s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.22s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.65s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.16s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.79s/it]
Processing depth (2, 3, 5, 9):   4%|â–         | 4/100 [01:53<42:35, 26.62s/it]2025-01-22 18:42:05.729 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra grabbed the apple.
2025-01-22 18:42:05.739 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1860, 1864) -->  Sandra grabbed the apple
2025-01-22 18:42:05.739 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra travelled to the bathroom.
2025-01-22 18:42:05.754 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2940, 2945) --> . Sandra travelled to the
2025-01-22 18:42:05.754 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra journeyed to the bedroom.
2025-01-22 18:42:05.775 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4156, 4162) --> . Sandra journeyed to the
2025-01-22 18:42:05.775 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the hallway.
2025-01-22 18:42:05.811 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7100, 7106) -->  John went back to the hallway
2025-01-22 18:42:05.811 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bathroom.
2025-01-22 18:42:05.848 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (7374, 7379) --> . Mary moved to the
2025-01-22 18:42:05.848 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John grabbed the milk.
2025-01-22 18:42:05.850 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (298, 302) -->  John grabbed the milk
2025-01-22 18:42:05.850 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the office.
2025-01-22 18:42:05.885 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6885, 6891) --> . Daniel went back to the
2025-01-22 18:42:05.885 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John left the milk.
2025-01-22 18:42:05.904 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3957, 3961) -->  John left the milk
2025-01-22 18:42:05.904 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel journeyed to the garden.
2025-01-22 18:42:05.913 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1780, 1786) --> . Daniel journeyed to the
2025-01-22 18:42:05.913 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John grabbed the milk.
2025-01-22 18:42:05.915 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (298, 302) -->  John grabbed the milk
2025-01-22 18:42:05.915 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Mary went back to the garden.
2025-01-22 18:42:05.956 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (7026, 7032) --> . Mary went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:42:06.724 | INFO     | test_jbb_embedding:begin_test:693 - the garden<|eot_id|>
2025-01-22 18:42:06.724 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8158])
2025-01-22 18:42:08.956 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [260.32589285714283, 21.792670552015686, 151.17767857142857, 20.615906462060458, 14.633948863636364], 'topk_indices': array([1786, 4162,    1, 2912, 8149,  302, 8145, 1864, 8148, 1863, 1860,
       8146, 1867,   24,   14, 1868, 2945, 8156, 8153,    0]), 'topk_tokens': [' garden', ' bedroom', '<|start_header_id|>', '.', '?', '.', ' apple', '.', ' bedroom', ' apple', ' Sandra', ' before', ' *', '\n\n', '\n', '      ', ' bathroom', '<|end_header_id|>', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [439.25, 355.15, 180.58333333333334, 141.765625]}, 'weight': {'score': [24.186755952380953, 23.25016848425438, 22.463169642857142, 23.251140306909317, 29.020738636363635], 'topk_indices': array([3307, 3280, 3152, 3200, 7435, 7397, 1416, 1478, 4316, 4300, 5172,
       5111, 7112, 7168, 3463, 3489, 4936, 4913, 4888, 4965]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [29.748046875, 22.15, 21.213541666666668, 25.149739583333332]}, 'saliency': {'score': [1.6215587797619047, 0.1221803717279592, 0.9459368024553572, 0.11473824691066471, 0.10813681862571023], 'topk_indices': array([1781, 1866, 1782, 8151,   24, 1861, 2942, 8140, 1786,  299, 2941,
       8145, 8146, 4162, 1867, 1863, 1868, 8148, 1860, 2945]), 'topk_tokens': [' Daniel', '      ', ' journey', 'Answer', '\n\n', ' grabbed', ' travelled', 'Question', ' garden', ' grabbed', ' Sandra', ' apple', ' before', ' bedroom', ' *', ' apple', '      ', ' bedroom', ' Sandra', ' bathroom'], 'evidence_proportions': [3.4896240234375, 2.0697265625, 0.8818359375, 0.742431640625]}}, 'pred_res': 'the garden<|eot_id|>', 'score': 0}
2025-01-22 18:42:08.961 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:42:08.962 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-112_pid-4_2-3-5-9.pkl | len: 3 |  size: 2.03 KB
Processing depth (2, 3, 5, 9):   5%|â–Œ         | 5/100 [01:57<38:30, 24.32s/it]Processing depth (2, 3, 5, 9):   5%|â–Œ         | 5/100 [01:57<37:09, 23.47s/it]
2025-01-22 18:42:09.031 | INFO     | __main__:<module>:82 - Selected idx: 114
2025-01-22 18:42:09.031 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the milk before the bathroom? 
2025-01-22 18:42:09.032 | INFO     | __main__:<module>:84 - Answer: hallway
2025-01-22 18:42:09.032 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 18:42:09.032 | INFO     | __main__:<module>:86 - Needle: [' John grabbed the milk.', ' Mary went back to the garden.', ' John went back to the hallway.', ' Sandra journeyed to the garden.', ' Daniel went back to the office.', ' John travelled to the bathroom.', ' Sandra went back to the hallway.']
2025-01-22 18:42:09.032 | INFO     | __main__:<module>:87 - Real Needle: [' John grabbed the milk.', ' John went back to the hallway.', ' John travelled to the bathroom.', ' Sandra went back to the hallway.']
2025-01-22 18:42:09.032 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ™…ğŸ¿', 'ğŸ«•', 'ğŸ', 'ğŸ’†ğŸ¼\u200dâ™‚', 'ğŸ¤¸ğŸ¿\u200dâ™‚ï¸', '\U0001faf8', 'ğŸ‡­ğŸ‡°', 'ğŸ»', 'ğŸš£', 'ğŸ§‘ğŸ½\u200dğŸ„']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.53s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.99s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.81s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.31s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.86s/it]
Processing depth (2, 7, 8, 9):   0%|          | 0/100 [00:17<?, ?it/s]2025-01-22 18:42:26.257 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John grabbed the milk.
2025-01-22 18:42:26.267 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1867, 1871) -->  John grabbed the milk
2025-01-22 18:42:26.268 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the hallway.
2025-01-22 18:42:26.296 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5553, 5559) --> . John went back to the
2025-01-22 18:42:26.296 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the bathroom.
2025-01-22 18:42:26.331 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6504, 6509) --> . John travelled to the
2025-01-22 18:42:26.331 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the hallway.
2025-01-22 18:42:26.360 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5554, 5560) -->  John went back to the hallway
2025-01-22 18:42:26.361 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary went back to the garden.
2025-01-22 18:42:26.361 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 37) -->  went back to the garden.
2025-01-22 18:42:26.361 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra journeyed to the garden.
2025-01-22 18:42:26.364 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (643, 649) -->  Sandra journeyed to the garden
2025-01-22 18:42:26.364 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the office.
2025-01-22 18:42:26.373 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1787, 1793) --> . Daniel went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:42:27.183 | INFO     | test_jbb_embedding:begin_test:693 - John's house.<|eot_id|>
2025-01-22 18:42:27.183 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8167])
2025-01-22 18:42:29.417 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [476.8809523809524, 38.126193390452876, 398.0486111111111, 36.19623969991391, 26.7966796875], 'topk_indices': array([1870,    3, 5554, 8155, 8150, 8065,    9, 8157, 1867,   35, 2121,
        648, 8163, 8165,   24, 6509, 1002,   14, 5559,    0]), 'topk_tokens': [' milk', '<|end_header_id|>', ' John', ' before', ':', ' location', ':', ' bathroom', ' John', ' garden', ' the', ' garden', '<|start_header_id|>', '<|end_header_id|>', '\n\n', ' bathroom', ' election', '\n', ' hallway', '<|begin_of_text|>'], 'evidence_proportions': [577.8125, 440.5833333333333, 357.05, 545.75]}, 'weight': {'score': [22.81845238095238, 23.2906364749082, 22.17230902777778, 23.294331685832002, 30.126785714285713], 'topk_indices': array([3328, 3301, 3173, 3221, 7436, 7398, 1485, 1423, 4300, 4284, 5135,
       5196, 7119, 7175, 3484, 3510, 4960, 4921, 4989, 4896]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.978515625, 20.0703125, 19.990625, 25.149739583333332]}, 'saliency': {'score': [3.0726143973214284, 0.2168066615428014, 2.3736436631944446, 0.20465624603658067, 0.20569022042410715], 'topk_indices': array([ 644, 8160,   24, 5555, 6506, 1000, 1868, 8155, 5554, 8154, 8149,
       8065, 1870, 1867,   35,  648, 8157, 1002, 6509, 5559]), 'topk_tokens': [' journey', 'Answer', '\n\n', ' went', ' travelled', ' Minnesota', ' grabbed', ' before', ' John', ' milk', 'Question', ' location', ' milk', ' John', ' garden', ' garden', ' bathroom', ' election', ' bathroom', ' hallway'], 'evidence_proportions': [4.117431640625, 2.4334309895833335, 1.89775390625, 3.9943033854166665]}}, 'pred_res': "John's house.<|eot_id|>", 'score': 0}
2025-01-22 18:42:29.424 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:42:29.424 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-114_pid-0_2-7-8-9.pkl | len: 3 |  size: 2.06 KB
Processing depth (2, 7, 8, 9):   1%|          | 1/100 [00:20<33:30, 20.30s/it]is_0k: False
your chose emoji: ['ğŸ‘±ğŸ¼\u200dâ™‚', 'ğŸ’ˆ', 'ğŸ§˜ğŸ¼\u200dâ™‚ï¸', 'ğŸ’´', 'ğŸ’†ğŸ»\u200dâ™€ï¸', 'ğŸ™‚\u200dâ†”', 'ğŸ¦™', 'ğŸ§–ğŸ»\u200dâ™‚', 'â›¹ğŸ¼\u200dâ™€', 'ğŸ§‘ğŸ»\u200dğŸ¦¼\u200dâ¡ï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.08s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:09,  4.55s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.46s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.20s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.65s/it]
Processing depth (1, 6, 7, 8):   1%|          | 1/100 [00:36<33:30, 20.30s/it]2025-01-22 18:42:45.754 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John grabbed the milk.
2025-01-22 18:42:45.758 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (834, 838) -->  John grabbed the milk
2025-01-22 18:42:45.758 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the hallway.
2025-01-22 18:42:45.786 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4753, 4759) -->  the senate. John went back
2025-01-22 18:42:45.786 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the bathroom.
2025-01-22 18:42:45.815 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5636, 5641) --> . John travelled to the
2025-01-22 18:42:45.815 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the hallway.
2025-01-22 18:42:45.839 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4756, 4762) -->  John went back to the hallway
2025-01-22 18:42:45.839 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary went back to the garden.
2025-01-22 18:42:45.839 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 37) -->  went back to the garden.
2025-01-22 18:42:45.839 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra journeyed to the garden.
2025-01-22 18:42:45.843 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (642, 648) --> . Sandra journeyed to the
2025-01-22 18:42:45.843 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the office.
2025-01-22 18:42:45.854 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1792, 1798) --> . Daniel went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:42:46.683 | INFO     | test_jbb_embedding:begin_test:693 - John's house.<|eot_id|>
2025-01-22 18:42:46.684 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8175])
2025-01-22 18:42:48.935 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [364.8065476190476, 26.557524761555392, 233.28125, 25.22760013515174, 13.042388091216216], 'topk_indices': array([8063,  835, 5638,  838,  837, 8163, 8165, 8169, 8029, 8073,    1,
         14,    3,   28, 8173, 5641, 8170,   24, 4761,    0]), 'topk_tokens': ['.\n\n', ' grabbed', ' travelled', '.', ' milk', ' before', ' bathroom', ':', ' context', ' location', '<|start_header_id|>', '\n', '<|end_header_id|>', '<|end_header_id|>', '<|end_header_id|>', ' bathroom', '<|eot_id|>', '\n\n', ' hallway', '<|begin_of_text|>'], 'evidence_proportions': [424.625, 220.09375, 390.15, 448.5208333333333]}, 'weight': {'score': [23.944196428571427, 23.287704053558326, 20.91840277777778, 23.29125007679076, 29.59522804054054], 'topk_indices': array([3307, 3334, 3163, 3211, 7422, 7460, 1490, 1428, 4302, 4286, 5181,
       5120, 7199, 7143, 3490, 3516, 4906, 4881, 4929, 4958]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.978515625, 24.010416666666668, 19.990625, 25.149739583333332]}, 'saliency': {'score': [2.387602306547619, 0.15080292949643861, 1.3026529947916667, 0.14248420630029796, 0.09705486813107052], 'topk_indices': array([ 644, 8144,   35, 2377, 8069,   39, 8157, 2391, 8162,   24, 8163,
       8168,  837,  835, 8073, 8029, 5638, 8165, 5641, 4761]), 'topk_tokens': [' journey', ' return', ' garden', 'nes', ' item', '***', 'Question', 'nes', ' milk', '\n\n', ' before', 'Answer', ' milk', ' grabbed', ' location', ' context', ' travelled', ' bathroom', ' bathroom', ' hallway'], 'evidence_proportions': [3.0240478515625, 1.3111165364583333, 2.150390625, 3.2374674479166665]}}, 'pred_res': "John's house.<|eot_id|>", 'score': 0}
2025-01-22 18:42:48.942 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:42:48.942 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-114_pid-1_1-6-7-8.pkl | len: 3 |  size: 2.07 KB
Processing depth (1, 6, 7, 8):   2%|â–         | 2/100 [00:39<32:24, 19.84s/it]is_0k: False
your chose emoji: ['ğŸƒğŸ½\u200dâ™€ï¸\u200dâ¡', 'ğŸ’ğŸ¼\u200dâ™€ï¸', 'ğŸ§ğŸ¾\u200dâ™€', 'ğŸ§‘ğŸ½\u200dğŸ”§', 'ğŸ‘©ğŸ»\u200dâš–', 'ğŸ‘¨ğŸ¾\u200dğŸ”¬', 'ğŸ¦¹\u200dâ™€', 'ğŸ˜‹', 'ğŸ§’', 'ğŸ§œğŸ¿']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.60s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.32s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.38s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.11s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.59s/it]
Processing depth (0, 1, 8, 9):   2%|â–         | 2/100 [00:55<32:24, 19.84s/it]2025-01-22 18:43:05.000 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John grabbed the milk.
2025-01-22 18:43:05.044 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the hallway.
2025-01-22 18:43:05.048 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (840, 846) --> . John went back to the
2025-01-22 18:43:05.049 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the bathroom.
2025-01-22 18:43:05.085 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6534, 6539) --> . John travelled to the
2025-01-22 18:43:05.085 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the hallway.
2025-01-22 18:43:05.090 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (841, 847) -->  John went back to the hallway
2025-01-22 18:43:05.090 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary went back to the garden.
2025-01-22 18:43:05.090 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (33, 39) -->  milk. Mary went back to
2025-01-22 18:43:05.091 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra journeyed to the garden.
2025-01-22 18:43:05.094 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (649, 655) --> . Sandra journeyed to the
2025-01-22 18:43:05.094 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the office.
2025-01-22 18:43:05.103 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1801, 1807) --> . Daniel went back to the
2025-01-22 18:43:05.103 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 18:43:05.103 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 18:43:05.104 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 18:43:05.104 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ‘©ğŸ¾\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘©ğŸ¾', 'ğŸ§ğŸ¿\u200dâ™€', 'ğŸ„ğŸ¼', 'ğŸ™‡ğŸ¿', 'ğŸ’‡ğŸ¼\u200dâ™€ï¸', 'ğŸ‡§ğŸ‡¦', 'ğŸš', 'ğŸ¨', 'ğŸ‘†ğŸ¾', 'ğŸ‘©ğŸ½\u200dğŸ¦°']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.70s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.69s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.73s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.27s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.80s/it]
Processing depth (4, 5, 6, 7):   2%|â–         | 2/100 [01:13<32:24, 19.84s/it]2025-01-22 18:43:22.265 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John grabbed the milk.
2025-01-22 18:43:22.285 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3603, 3607) -->  John grabbed the milk
2025-01-22 18:43:22.285 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the hallway.
2025-01-22 18:43:22.307 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4143, 4149) --> . John went back to the
2025-01-22 18:43:22.307 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the bathroom.
2025-01-22 18:43:22.333 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4621, 4626) -->  John travelled to the bathroom
2025-01-22 18:43:22.333 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the hallway.
2025-01-22 18:43:22.358 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4144, 4150) -->  John went back to the hallway
2025-01-22 18:43:22.358 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary went back to the garden.
2025-01-22 18:43:22.358 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 37) -->  went back to the garden.
2025-01-22 18:43:22.358 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra journeyed to the garden.
2025-01-22 18:43:22.362 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (636, 642) --> . Sandra journeyed to the
2025-01-22 18:43:22.362 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the office.
2025-01-22 18:43:22.373 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1743, 1749) --> . Daniel went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:43:23.182 | INFO     | test_jbb_embedding:begin_test:693 - John's house.<|eot_id|>
2025-01-22 18:43:23.183 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8169])
2025-01-22 18:43:25.423 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [627.3690476190476, 47.94872736172296, 649.9583333333334, 45.12025082995205, 37.12819102112676], 'topk_indices': array([3603,   32,   36, 3296, 8067,   29, 8164,   14, 3323, 3604,   24,
       8159, 8157, 8167, 3606, 7369, 4149, 3324,   35,    0]), 'topk_tokens': [' John', ' back', '.', 'iring', ' location', '\n\n', '<|eot_id|>', '\n', 'iring', ' grabbed', '\n\n', ' bathroom', ' before', '<|end_header_id|>', ' milk', 'nes', ' hallway', ' a', ' garden', '<|begin_of_text|>'], 'evidence_proportions': [974.25, 490.625, 471.75, 662.5416666666666]}, 'weight': {'score': [24.172991071428573, 23.279555953255016, 20.91840277777778, 23.28247475562523, 29.392825704225352], 'topk_indices': array([3313, 3286, 3158, 3206, 7454, 7416, 1503, 1441, 4351, 4335, 5245,
       5184, 7193, 7137, 3469, 3495, 4941, 4966, 4989, 5018]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.978515625, 20.0703125, 25.6796875, 25.149739583333332]}, 'saliency': {'score': [4.186476934523809, 0.2738658514783713, 3.66748046875, 0.25625243750384236, 0.2774752764634683], 'topk_indices': array([  31, 7291, 8023,   32, 3298, 3603,   30, 8067, 3302, 4625, 8156,
       3296, 8157, 3323, 7369, 3604, 3606, 8159, 4149,   35]), 'topk_tokens': [' went', 'nes', ' context', ' back', ' gun', ' John', 'Mary', ' location', ' enemy', ' bathroom', ' milk', 'iring', ' before', 'iring', 'nes', ' grabbed', ' milk', ' bathroom', ' hallway', ' garden'], 'evidence_proportions': [7.083251953125, 2.5442708333333335, 3.2490234375, 4.6787109375]}}, 'pred_res': "John's house.<|eot_id|>", 'score': 0}
2025-01-22 18:43:25.429 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:43:25.429 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-114_pid-2_4-5-6-7.pkl | len: 3 |  size: 2.01 KB
Processing depth (4, 5, 6, 7):   3%|â–         | 3/100 [01:16<44:21, 27.44s/it]is_0k: False
your chose emoji: ['ğŸ§ğŸ¾\u200dâ™‚\u200dâ¡', 'ğŸ¦ ', 'ğŸƒ', 'ğŸ‡§ğŸ‡¸', 'ğŸ•Œ', 'ğŸ‘¨ğŸ¿\u200dğŸ¦°', 'ğŸ‘¨ğŸ¾\u200dâš–', 'ğŸ§”ğŸ¾\u200dâ™€ï¸', 'ğŸ™‹ğŸ»\u200dâ™‚ï¸', 'ğŸ‡ªğŸ‡¹']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.38s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.76s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.69s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.22s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.75s/it]
Processing depth (2, 3, 5, 8):   3%|â–         | 3/100 [01:33<44:21, 27.44s/it]2025-01-22 18:43:42.272 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John grabbed the milk.
2025-01-22 18:43:42.282 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1796, 1800) -->  grabbed the milk.
2025-01-22 18:43:42.282 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the hallway.
2025-01-22 18:43:42.298 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2927, 2933) --> . John went back to the
2025-01-22 18:43:42.298 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the bathroom.
2025-01-22 18:43:42.319 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4195, 4200) -->  John travelled to the bathroom
2025-01-22 18:43:42.319 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the hallway.
2025-01-22 18:43:42.334 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2928, 2934) -->  John went back to the hallway
2025-01-22 18:43:42.334 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary went back to the garden.
2025-01-22 18:43:42.335 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 37) -->  went back to the garden.
2025-01-22 18:43:42.335 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra journeyed to the garden.
2025-01-22 18:43:42.338 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (636, 642) --> . Sandra journeyed to the
2025-01-22 18:43:42.338 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the office.
2025-01-22 18:43:42.347 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1781, 1787) --> . Daniel went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:43:43.194 | INFO     | test_jbb_embedding:begin_test:693 - John's house.<|eot_id|>
2025-01-22 18:43:43.194 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8128])
2025-01-22 18:43:45.428 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [814.2738095238095, 37.641238008855, 471.7638888888889, 34.660084805981214, 58.52742034313726], 'topk_indices': array([1788, 1796, 1794,   24, 8116, 2899, 2926, 1799, 8118,   14, 8123,
         28, 2929, 4199, 1795, 8126, 2928, 2927, 2933,    0]), 'topk_tokens': ['.', ' grabbed', 'ï¿½', '\n\n', ' before', '.', ' Gov', '.', ' bathroom', '\n', '<|eot_id|>', '<|end_header_id|>', ' went', ' bathroom', ' John', '<|end_header_id|>', ' John', '.', ' hallway', '<|begin_of_text|>'], 'evidence_proportions': [745.5, 904.0416666666666, 607.85, 942.375]}, 'weight': {'score': [23.253720238095237, 23.250782114746034, 20.91840277777778, 23.255962679189324, 28.827205882352942], 'topk_indices': array([3295, 3268, 3188, 3140, 7383, 7421, 1417, 1479, 4271, 4287, 5167,
       5106, 7104, 7160, 3451, 3477, 4960, 4908, 4883, 4931]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.15234375, 20.0703125, 25.6796875, 25.149739583333332]}, 'saliency': {'score': [5.099004836309524, 0.21176882720260423, 2.6962348090277777, 0.19355919499003646, 0.3996950037339154], 'topk_indices': array([ 637,  638, 1794, 1783,   35, 1792, 2900, 8116, 4196, 1798, 1782,
       1789, 1796, 2926, 2929, 8118, 1795, 2928, 4199, 2933]), 'topk_tokens': [' Sandra', ' journey', 'ï¿½', ' went', ' garden', 'ï¿½', ' During', ' before', ' travelled', ' milk', ' Daniel', 'ï¿½', ' grabbed', ' Gov', ' went', ' bathroom', ' John', ' John', ' bathroom', ' hallway'], 'evidence_proportions': [4.205322265625, 4.673828125, 4.4375, 6.671223958333333]}}, 'pred_res': "John's house.<|eot_id|>", 'score': 0}
2025-01-22 18:43:45.435 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:43:45.435 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-114_pid-3_2-3-5-8.pkl | len: 3 |  size: 2.01 KB
Processing depth (2, 3, 5, 8):   4%|â–         | 4/100 [01:36<39:12, 24.51s/it]is_0k: False
your chose emoji: ['*âƒ£', 'ğŸ‘‹ğŸ»', 'ğŸ§\u200dâ¡', 'ğŸ¤¹ğŸ¿\u200dâ™€ï¸', 'ğŸ', 'ğŸ‘©ğŸ»\u200dğŸ“', 'ğŸ’', 'ğŸ‘‡ğŸ½', 'ğŸ—', 'ğŸ‘¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.56s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.68s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.52s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.17s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.69s/it]
Processing depth (3, 4, 5, 7):   4%|â–         | 4/100 [01:52<39:12, 24.51s/it]2025-01-22 18:44:01.916 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John grabbed the milk.
2025-01-22 18:44:01.929 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2726, 2730) -->  grabbed the milk.
2025-01-22 18:44:01.929 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the hallway.
2025-01-22 18:44:01.949 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3519, 3525) --> . John went back to the
2025-01-22 18:44:01.949 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the bathroom.
2025-01-22 18:44:01.972 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4122, 4127) --> . John travelled to the
2025-01-22 18:44:01.973 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the hallway.
2025-01-22 18:44:01.991 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3520, 3526) -->  John went back to the hallway
2025-01-22 18:44:01.991 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary went back to the garden.
2025-01-22 18:44:01.991 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 37) -->  went back to the garden.
2025-01-22 18:44:01.991 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra journeyed to the garden.
2025-01-22 18:44:01.995 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (638, 644) --> . Sandra journeyed to the
2025-01-22 18:44:01.995 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the office.
2025-01-22 18:44:02.004 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1731, 1737) --> . Daniel went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:44:02.852 | INFO     | test_jbb_embedding:begin_test:693 - John grabbed the milk.<|eot_id|>
2025-01-22 18:44:02.852 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8135])
2025-01-22 18:44:05.074 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [367.875, 25.91908331285328, 218.26041666666666, 24.604943511544636, 46.088686342592595], 'topk_indices': array([8121, 8129, 8033, 8117, 8118, 8126, 2661, 8120,   14,   24, 4127,
       8122, 7989, 8131, 8125, 8133, 8130, 3525, 8123,    0]), 'topk_tokens': [' the', ':', ' location', 'Question', ':', '?', ',', ' was', '\n', '\n\n', ' bathroom', ' milk', ' context', '<|start_header_id|>', ' bathroom', '<|end_header_id|>', '<|eot_id|>', ' hallway', ' before', '<|begin_of_text|>'], 'evidence_proportions': [462.125, 354.6666666666667, 228.825, 434.125]}, 'weight': {'score': [21.899181547619047, 23.25081408208405, 20.91840277777778, 23.259502523459687, 29.15162037037037], 'topk_indices': array([3328, 3301, 3167, 3215, 7360, 7398, 1491, 1429, 4325, 4309, 5181,
       5120, 7081, 7137, 3510, 3484, 4974, 4897, 4922, 4945]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.15234375, 20.0703125, 19.990625, 25.149739583333332]}, 'saliency': {'score': [2.1907784598214284, 0.1456902729670988, 1.2142605251736112, 0.13801264406678293, 0.3382294266312211], 'topk_indices': array([2662, 8126,   24, 8120,   35, 2711, 2588, 8119, 2606, 8033, 2680,
       2728, 2726, 8117, 7989, 8122, 8123, 4127, 8125, 3525]), 'topk_tokens': [' mess', '?', '\n\n', ' was', ' garden', 'ï¿½', 'engers', ' Where', 'ared', ' location', ' ne', ' milk', ' grabbed', 'Question', ' context', ' milk', ' before', ' bathroom', ' bathroom', ' hallway'], 'evidence_proportions': [2.7216796875, 1.7735188802083333, 1.16474609375, 3.109130859375]}}, 'pred_res': 'John grabbed the milk.<|eot_id|>', 'score': 0}
2025-01-22 18:44:05.080 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:44:05.080 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-114_pid-4_3-4-5-7.pkl | len: 3 |  size: 2.03 KB
Processing depth (3, 4, 5, 7):   5%|â–Œ         | 5/100 [01:55<36:01, 22.75s/it]Processing depth (3, 4, 5, 7):   5%|â–Œ         | 5/100 [01:56<36:44, 23.20s/it]
2025-01-22 18:44:05.136 | INFO     | __main__:<module>:82 - Selected idx: 116
2025-01-22 18:44:05.136 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the milk before the kitchen? 
2025-01-22 18:44:05.136 | INFO     | __main__:<module>:84 - Answer: bathroom
2025-01-22 18:44:05.137 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 18:44:05.137 | INFO     | __main__:<module>:86 - Needle: [' Sandra journeyed to the garden.', ' John took the milk.', ' Mary went back to the garden.', ' Daniel went back to the office.', ' John travelled to the bathroom.', ' John journeyed to the kitchen.', ' Sandra went back to the hallway.']
2025-01-22 18:44:05.137 | INFO     | __main__:<module>:87 - Real Needle: [' John took the milk.', ' John travelled to the bathroom.', ' John journeyed to the kitchen.', ' Sandra went back to the hallway.']
2025-01-22 18:44:05.137 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸŸ©', 'ğŸ”¹', 'ğŸ§–\u200dâ™€', 'ğŸŒ…', 'ğŸ‘©ğŸ¼\u200dğŸ¦°', 'ğŸ–ï¸', 'ğŸ§ğŸ½\u200dâ™€', 'ğŸš£ğŸ»\u200dâ™€', 'ğŸ¦¸', 'ğŸ‘¨\u200dğŸ¦¼']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.24s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.75s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.69s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.23s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.74s/it]
Processing depth (0, 3, 5, 7):   0%|          | 0/100 [00:16<?, ?it/s]2025-01-22 18:44:21.847 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John took the milk.
2025-01-22 18:44:21.888 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the bathroom.
2025-01-22 18:44:21.907 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2992, 2997) -->  tragedy. John travelled to
2025-01-22 18:44:21.907 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the kitchen.
2025-01-22 18:44:21.930 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4208, 4214) -->  John journeyed to the kitchen
2025-01-22 18:44:21.931 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the hallway.
2025-01-22 18:44:21.965 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5594, 5600) --> . Sandra went back to the
2025-01-22 18:44:21.965 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra journeyed to the garden.
2025-01-22 18:44:21.992 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4582, 4588) -->  Sandra journeyed to the garden
2025-01-22 18:44:21.992 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went back to the garden.
2025-01-22 18:44:22.014 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4245, 4251) -->  Mary went back to the garden
2025-01-22 18:44:22.014 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the office.
2025-01-22 18:44:22.015 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (302, 308) --> . Daniel went back to the
2025-01-22 18:44:22.016 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 18:44:22.016 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 18:44:22.016 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 18:44:22.016 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ¯', 'ğŸ’', 'ğŸ‘', 'ğŸ“¨', 'ğŸª—', 'ğŸ™‡ğŸ¾\u200dâ™‚ï¸', 'ğŸ™', 'ğŸ§—ğŸ¼', 'ğŸ‘©ğŸ¼\u200dâ¤ï¸\u200dğŸ‘©ğŸ¼', 'ğŸ‘¨ğŸ½\u200dğŸ“']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.48s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.61s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.60s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.22s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.72s/it]
Processing depth (0, 2, 7, 9):   0%|          | 0/100 [00:33<?, ?it/s]2025-01-22 18:44:38.754 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John took the milk.
2025-01-22 18:44:38.798 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the bathroom.
2025-01-22 18:44:38.807 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1859, 1864) --> . John travelled to the
2025-01-22 18:44:38.807 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the kitchen.
2025-01-22 18:44:38.836 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5653, 5659) --> . John journeyed to the
2025-01-22 18:44:38.836 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the hallway.
2025-01-22 18:44:38.872 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7208, 7214) --> . Sandra went back to the
2025-01-22 18:44:38.872 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra journeyed to the garden.
2025-01-22 18:44:38.895 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4712, 4718) --> . Sandra journeyed to the
2025-01-22 18:44:38.896 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went back to the garden.
2025-01-22 18:44:38.917 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4275, 4281) --> . Mary went back to the
2025-01-22 18:44:38.917 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the office.
2025-01-22 18:44:38.919 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (302, 308) --> . Daniel went back to the
2025-01-22 18:44:38.919 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 18:44:38.919 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 18:44:38.919 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 18:44:38.919 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ‡³ğŸ‡«', '\U0001fab8', 'ğŸ‘…', 'ğŸ§‘\u200dğŸ’¼', 'ğŸ‘©ğŸ¿\u200dğŸ¦²', 'ğŸ‡³ğŸ‡¿', 'ğŸ³\u200dğŸŒˆ', 'â˜¦', 'ğŸ‘©ğŸ½\u200dğŸš’', 'ğŸ‘±ğŸ¾\u200dâ™€']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.42s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.74s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.84s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.32s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.83s/it]
Processing depth (2, 4, 5, 9):   0%|          | 0/100 [00:51<?, ?it/s]2025-01-22 18:44:56.921 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John took the milk.
2025-01-22 18:44:56.929 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1628, 1632) -->  took the milk.
2025-01-22 18:44:56.930 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the bathroom.
2025-01-22 18:44:56.949 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3593, 3598) --> . John travelled to the
2025-01-22 18:44:56.950 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the kitchen.
2025-01-22 18:44:56.977 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4116, 4122) -->  John journeyed to the kitchen
2025-01-22 18:44:56.977 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the hallway.
2025-01-22 18:44:57.012 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7133, 7139) -->  Sandra went back to the hallway
2025-01-22 18:44:57.013 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra journeyed to the garden.
2025-01-22 18:44:57.036 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4614, 4620) -->  Sandra journeyed to the garden
2025-01-22 18:44:57.036 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went back to the garden.
2025-01-22 18:44:57.058 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4196, 4202) --> . Mary went back to the
2025-01-22 18:44:57.058 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the office.
2025-01-22 18:44:57.060 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (257, 263) --> . Daniel went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:44:57.866 | INFO     | test_jbb_embedding:begin_test:693 - The office.<|eot_id|>
2025-01-22 18:44:57.866 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8185])
2025-01-22 18:45:00.083 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [382.6770833333333, 29.961815308988765, 152.97743055555554, 28.781142624861946, 47.40194818037975], 'topk_indices': array([8073, 3595, 8038, 8083, 8169, 8175, 8168, 8170, 1623, 1631, 8174,
       8183, 8172, 3598, 8039, 1630, 8180, 8173,    0, 8181]), 'topk_tokens': ['.\n\n', ' travelled', ' you', ' location', ' Where', ' kitchen', ':', ' was', 'ï¿½', '.', ' the', '<|end_header_id|>', ' milk', ' bathroom', ' context', ' milk', '<|eot_id|>', ' before', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [776.1875, 546.65, 299.6041666666667, 66.765625]}, 'weight': {'score': [23.029761904761905, 23.29029143258427, 22.20355902777778, 23.293363257761687, 29.495648734177216], 'topk_indices': array([3356, 3329, 3249, 3201, 7424, 7462, 1476, 1538, 4356, 4340, 5158,
       5219, 7201, 7145, 3512, 3538, 4960, 4935, 4983, 5012]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.38671875, 19.990625, 23.404947916666668, 26.94921875]}, 'saliency': {'score': [2.1805187406994047, 0.1666265132663654, 0.8293999565972222, 0.15997273258701222, 0.34301294254351267], 'topk_indices': array([8037, 8154, 1622, 4121, 8038, 1627, 8170, 1623, 1628, 1621, 8083,
       8169, 8167, 8175, 3595, 8172, 8039, 1630, 3598, 8173]), 'topk_tokens': [' provided', ' return', 'ï¿½', ' kitchen', ' you', ' John', ' was', 'ï¿½', ' took', 'ï¿½', ' location', ' Where', 'Question', ' kitchen', ' travelled', ' milk', ' context', ' milk', ' bathroom', ' before'], 'evidence_proportions': [4.263427734375, 2.92734375, 1.8789876302083333, 0.4710896809895833]}}, 'pred_res': 'The office.<|eot_id|>', 'score': 0}
2025-01-22 18:45:00.091 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:45:00.091 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-116_pid-0_2-4-5-9.pkl | len: 3 |  size: 2.04 KB
Processing depth (2, 4, 5, 9):   1%|          | 1/100 [00:54<1:30:32, 54.87s/it]is_0k: False
your chose emoji: ['ğŸš¶ğŸ½\u200dâ™‚ï¸\u200dâ¡ï¸', 'ğŸ•µ', 'ğŸ§º', 'ğŸ‘©ğŸ¿\u200dâ¤ï¸\u200dğŸ‘¨ğŸ¿', 'ğŸ”š', 'ğŸ›€', 'ğŸš´ğŸ¾\u200dâ™€', 'ğŸ‘¨ğŸ¾\u200dâ¤ï¸\u200dğŸ‘¨ğŸ¾', 'ğŸ‘', 'ğŸ§‘ğŸ»\u200dğŸ¦½']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  3.98s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.66s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.67s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.31s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.76s/it]
Processing depth (0, 5, 7, 8):   1%|          | 1/100 [01:11<1:30:32, 54.87s/it]2025-01-22 18:45:16.841 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John took the milk.
2025-01-22 18:45:16.883 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the bathroom.
2025-01-22 18:45:16.904 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4161, 4166) --> . John travelled to the
2025-01-22 18:45:16.904 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the kitchen.
2025-01-22 18:45:16.937 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5658, 5664) -->  John journeyed to the kitchen
2025-01-22 18:45:16.937 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the hallway.
2025-01-22 18:45:16.972 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6614, 6620) --> . Sandra went back to the
2025-01-22 18:45:16.972 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra journeyed to the garden.
2025-01-22 18:45:17.000 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4724, 4730) --> . Sandra journeyed to the
2025-01-22 18:45:17.000 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went back to the garden.
2025-01-22 18:45:17.025 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4258, 4264) -->  Mary went back to the garden
2025-01-22 18:45:17.025 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the office.
2025-01-22 18:45:17.026 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (277, 283) -->  Daniel went back to the office
2025-01-22 18:45:17.027 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 18:45:17.027 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 18:45:17.027 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 18:45:17.027 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ‘´ğŸ¿', 'ğŸš´ğŸ½\u200dâ™‚ï¸', 'ğŸ‘©ğŸ¾\u200dâš–', 'ğŸŒ¨ï¸', 'ğŸ˜­', 'ğŸ‡¶ğŸ‡¦', 'ğŸš¶', 'ğŸ‘¨ğŸ¼\u200dğŸ¨', 'ğŸƒğŸ½\u200dâ™€\u200dâ¡ï¸', 'ğŸ‘©ğŸ½\u200dğŸš€']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.48s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.65s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.53s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.14s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.66s/it]
Processing depth (0, 5, 6, 8):   1%|          | 1/100 [01:28<1:30:32, 54.87s/it]2025-01-22 18:45:33.587 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John took the milk.
2025-01-22 18:45:33.627 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the bathroom.
2025-01-22 18:45:33.652 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4188, 4193) -->  John travelled to the bathroom
2025-01-22 18:45:33.652 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the kitchen.
2025-01-22 18:45:33.678 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4845, 4851) --> . John journeyed to the
2025-01-22 18:45:33.678 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the hallway.
2025-01-22 18:45:33.720 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6602, 6608) --> . Sandra went back to the
2025-01-22 18:45:33.720 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra journeyed to the garden.
2025-01-22 18:45:33.757 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4738, 4744) -->  the senate. Sandra journeyed
2025-01-22 18:45:33.757 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went back to the garden.
2025-01-22 18:45:33.785 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4259, 4265) --> . Mary went back to the
2025-01-22 18:45:33.785 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the office.
2025-01-22 18:45:33.787 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (302, 308) --> . Daniel went back to the
2025-01-22 18:45:33.788 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 18:45:33.788 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 18:45:33.788 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 18:45:33.788 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ“¢', 'ğŸ¥¬', 'ğŸ§–ğŸ¿', 'ğŸ‡¸ğŸ‡®', 'â˜¸ï¸', 'ğŸ³ï¸\u200dâš§', 'ğŸ‡²ğŸ‡¶', 'ğŸ™ğŸ½\u200dâ™€ï¸', 'ğŸšµğŸ½\u200dâ™€ï¸', 'ğŸ¡']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  3.99s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.42s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.42s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.13s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.57s/it]
Processing depth (0, 1, 5, 8):   1%|          | 1/100 [01:44<1:30:32, 54.87s/it]2025-01-22 18:45:49.895 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John took the milk.
2025-01-22 18:45:49.936 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the bathroom.
2025-01-22 18:45:49.940 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (907, 912) --> . John travelled to the
2025-01-22 18:45:49.941 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the kitchen.
2025-01-22 18:45:49.962 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4186, 4192) -->  John journeyed to the kitchen
2025-01-22 18:45:49.962 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the hallway.
2025-01-22 18:45:50.001 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6580, 6586) --> . Sandra went back to the
2025-01-22 18:45:50.001 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra journeyed to the garden.
2025-01-22 18:45:50.028 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4689, 4695) --> . Sandra journeyed to the
2025-01-22 18:45:50.028 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went back to the garden.
2025-01-22 18:45:50.054 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4258, 4264) --> . Mary went back to the
2025-01-22 18:45:50.054 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the office.
2025-01-22 18:45:50.056 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (302, 308) --> . Daniel went back to the
2025-01-22 18:45:50.056 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 18:45:50.056 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 18:45:50.056 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 18:45:50.056 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ‘¸ğŸ»', 'ğŸ‘©ğŸ¼\u200dâš–ï¸', 'ğŸ‡¦ğŸ‡¿', 'ğŸ§', 'ğŸ‘', 'ğŸ¤®', 'âš“', 'ğŸ’œ', 'ğŸ‡µğŸ‡ª', 'ğŸ‘¨ğŸ¼\u200dğŸ¦³']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.32s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.50s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.41s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.05s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.55s/it]
Processing depth (0, 2, 6, 7):   1%|          | 1/100 [02:00<1:30:32, 54.87s/it]2025-01-22 18:46:06.108 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John took the milk.
2025-01-22 18:46:06.152 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the bathroom.
2025-01-22 18:46:06.161 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1811, 1816) --> . John travelled to the
2025-01-22 18:46:06.162 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the kitchen.
2025-01-22 18:46:06.185 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4741, 4747) --> . John journeyed to the
2025-01-22 18:46:06.186 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the hallway.
2025-01-22 18:46:06.217 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5582, 5588) --> . Sandra went back to the
2025-01-22 18:46:06.217 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra journeyed to the garden.
2025-01-22 18:46:06.241 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4634, 4640) --> . Sandra journeyed to the
2025-01-22 18:46:06.242 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went back to the garden.
2025-01-22 18:46:06.265 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4244, 4250) -->  Mary went back to the garden
2025-01-22 18:46:06.265 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the office.
2025-01-22 18:46:06.266 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (278, 284) --> . Daniel went back to the
2025-01-22 18:46:06.267 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 18:46:06.267 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 18:46:06.267 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 18:46:06.267 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸš´ğŸ½\u200dâ™€ï¸', 'ğŸ–', 'ğŸš®', 'ğŸ§‘ğŸ½\u200dğŸ”¬', 'ğŸ§ğŸ¼\u200dâ™€ï¸', 'ğŸ‘©\u200dğŸ¦¼\u200dâ¡ï¸', 'ğŸ§œğŸ»', 'ğŸ‹\u200dâ™‚ï¸', 'ğŸ¤´ğŸ¿', 'ğŸ˜‘']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.38s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.85s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.84s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.29s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.82s/it]
Processing depth (0, 1, 6, 8):   1%|          | 1/100 [02:18<1:30:32, 54.87s/it]2025-01-22 18:46:23.306 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John took the milk.
2025-01-22 18:46:23.349 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the bathroom.
2025-01-22 18:46:23.354 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (841, 846) --> . John travelled to the
2025-01-22 18:46:23.354 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the kitchen.
2025-01-22 18:46:23.379 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4841, 4847) --> . John journeyed to the
2025-01-22 18:46:23.379 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the hallway.
2025-01-22 18:46:23.413 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6574, 6580) --> . Sandra went back to the
2025-01-22 18:46:23.413 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra journeyed to the garden.
2025-01-22 18:46:23.437 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4734, 4740) -->  the senate. Sandra journeyed
2025-01-22 18:46:23.437 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went back to the garden.
2025-01-22 18:46:23.460 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4255, 4261) --> . Mary went back to the
2025-01-22 18:46:23.460 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the office.
2025-01-22 18:46:23.462 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (302, 308) --> . Daniel went back to the
2025-01-22 18:46:23.462 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 18:46:23.462 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 18:46:23.462 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 18:46:23.462 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ¤¥', 'ğŸ§ğŸ»\u200dâ™€', 'ğŸŒ‘', 'ğŸ’‚ğŸ¾', 'ğŸªƒ', 'ğŸ•µ', 'ğŸˆº', 'â¤µ', 'ğŸ¤µğŸ¿\u200dâ™‚ï¸', 'ğŸ§‘ğŸ»\u200dğŸ’¼']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  3.95s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.37s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.48s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.10s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.55s/it]
Processing depth (2, 5, 6, 8):   1%|          | 1/100 [02:34<1:30:32, 54.87s/it]2025-01-22 18:46:39.414 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John took the milk.
2025-01-22 18:46:39.423 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1849, 1853) -->  John took the milk
2025-01-22 18:46:39.423 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the bathroom.
2025-01-22 18:46:39.444 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4188, 4193) -->  John travelled to the bathroom
2025-01-22 18:46:39.444 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the kitchen.
2025-01-22 18:46:39.466 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4560, 4566) -->  John journeyed to the kitchen
2025-01-22 18:46:39.467 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the hallway.
2025-01-22 18:46:39.499 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6440, 6446) --> . Sandra went back to the
2025-01-22 18:46:39.499 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra journeyed to the garden.
2025-01-22 18:46:39.522 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4527, 4533) -->  Sandra journeyed to the garden
2025-01-22 18:46:39.522 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went back to the garden.
2025-01-22 18:46:39.543 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4248, 4254) -->  Mary went back to the garden
2025-01-22 18:46:39.543 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the office.
2025-01-22 18:46:39.544 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (297, 303) --> . Daniel went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:46:40.355 | INFO     | test_jbb_embedding:begin_test:693 - John's house.<|eot_id|>
2025-01-22 18:46:40.355 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8111])
2025-01-22 18:46:42.567 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [346.26488095238096, 31.454159092309588, 151.46875, 30.36793150154799, 30.532877604166668], 'topk_indices': array([7999, 1853,   24,   14, 8009, 8096, 8105, 8094, 7965, 8101, 1856,
       8109, 1857, 8098, 4192, 1852, 8099, 8106,    0, 8107]), 'topk_tokens': ['.\n\n', '.', '\n\n', '\n', ' location', ' was', ':', ':', ' context', ' kitchen', ' *', '<|end_header_id|>', '      ', ' milk', ' bathroom', ' milk', ' before', '<|eot_id|>', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [715.5, 573.7, 216.52083333333334, 40.322916666666664]}, 'weight': {'score': [23.852306547619047, 23.22596361227508, 23.45746527777778, 23.223818691950463, 28.748511904761905], 'topk_indices': array([3249, 3276, 3121, 3169, 7354, 7392, 1406, 1468, 4263, 4279, 5183,
       5122, 7075, 7131, 3458, 3432, 4924, 4947, 4976, 4899]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [25.212890625, 25.6796875, 23.404947916666668, 21.869791666666668]}, 'saliency': {'score': [2.336579822358631, 0.17513737950032351, 0.9189317491319444, 0.16785829715315403, 0.2212709699358259], 'topk_indices': array([8080, 8102, 8103, 8096, 1849, 1850, 8104, 8095, 8093, 8009, 1856,
       4173, 7965, 1857, 4189, 8101, 8098, 1852, 8099, 4192]), 'topk_tokens': [' return', '?', ' \n', ' was', ' John', ' took', 'Answer', ' Where', 'Question', ' location', ' *', 'outs', ' context', '      ', ' travelled', ' kitchen', ' milk', ' milk', ' before', ' bathroom'], 'evidence_proportions': [4.65380859375, 4.1951171875, 1.3511555989583333, 0.22840372721354166]}}, 'pred_res': "John's house.<|eot_id|>", 'score': 0}
2025-01-22 18:46:42.574 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:46:42.574 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-116_pid-1_2-5-6-8.pkl | len: 3 |  size: 2.01 KB
Processing depth (2, 5, 6, 8):   2%|â–         | 2/100 [02:37<2:15:22, 82.88s/it]is_0k: False
your chose emoji: ['ğŸ¤˜ğŸ¼', 'ğŸ˜ƒ', 'ğŸ§¬', 'ğŸ˜’', 'ğŸ‘¨ğŸ»\u200dğŸ’¼', 'â›', 'ğŸ­', 'âšª', 'ğŸ¤“', 'ğŸ§ğŸ»\u200dâ™€']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.52s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.86s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.52s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.15s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.70s/it]
Processing depth (4, 6, 8, 9):   2%|â–         | 2/100 [02:53<2:15:22, 82.88s/it]2025-01-22 18:46:59.130 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John took the milk.
2025-01-22 18:46:59.151 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3603, 3607) -->  John took the milk
2025-01-22 18:46:59.152 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the bathroom.
2025-01-22 18:46:59.176 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4789, 4794) -->  the senate. John travelled
2025-01-22 18:46:59.176 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the kitchen.
2025-01-22 18:46:59.213 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6643, 6649) --> . John journeyed to the
2025-01-22 18:46:59.213 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the hallway.
2025-01-22 18:46:59.250 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7226, 7232) --> . Sandra went back to the
2025-01-22 18:46:59.250 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra journeyed to the garden.
2025-01-22 18:46:59.278 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4728, 4734) --> . Sandra journeyed to the
2025-01-22 18:46:59.278 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went back to the garden.
2025-01-22 18:46:59.301 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4265, 4271) --> . Mary went back to the
2025-01-22 18:46:59.301 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the office.
2025-01-22 18:46:59.303 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (297, 303) --> . Daniel went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:47:00.152 | INFO     | test_jbb_embedding:begin_test:693 - John took the milk.<|eot_id|>
2025-01-22 18:47:00.152 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8171])
2025-01-22 18:47:02.368 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [164.56994047619048, 16.397445406165893, 72.62152777777777, 15.890542409342348, 10.780517578125], 'topk_indices': array([8157, 8170, 3605, 8156, 3607, 8154,    1, 8155, 8162,    3,   24,
         14, 8161, 8159, 8158, 3606, 8169,    0, 8166, 8167]), 'topk_tokens': [' the', '\n\n', ' the', ' was', '.', ':', '<|start_header_id|>', ' Where', '?', '<|end_header_id|>', '\n\n', '\n', ' kitchen', ' before', ' milk', ' milk', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [497.0625, 74.59375, 156.63541666666666, 25.822916666666668]}, 'weight': {'score': [22.483258928571427, 23.287489295326644, 20.94965277777778, 23.294738206822373, 29.93988715277778], 'topk_indices': array([3313, 3286, 3206, 3158, 7444, 7406, 1406, 1468, 4277, 4293, 5212,
       5151, 7120, 7176, 3469, 3495, 5005, 4941, 4976, 4916]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [25.212890625, 24.71875, 19.4140625, 21.869791666666668]}, 'saliency': {'score': [0.9946361723400298, 0.088773551476098, 0.4125773111979167, 0.08571865501474148, 0.08127572801378039], 'topk_indices': array([8140, 8059, 8163, 8164, 8170, 8156, 4796, 8025, 8162, 6649, 3604,
       8069, 8168,   24, 8153, 8155, 8159, 8161, 8158, 3606]), 'topk_tokens': [' return', '.\n\n', ' \n', 'Answer', '\n\n', ' was', ' bathroom', ' context', '?', ' kitchen', ' took', ' location', 'assistant', '\n\n', 'Question', ' Where', ' before', ' kitchen', ' milk', ' milk'], 'evidence_proportions': [3.25634765625, 0.473193359375, 0.7681884765625, 0.1478118896484375]}}, 'pred_res': 'John took the milk.<|eot_id|>', 'score': 0}
2025-01-22 18:47:02.376 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:47:02.376 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-116_pid-2_4-6-8-9.pkl | len: 3 |  size: 2.03 KB
Processing depth (4, 6, 8, 9):   3%|â–         | 3/100 [02:57<1:27:25, 54.08s/it]is_0k: False
your chose emoji: ['ğŸ¤œğŸ¾', 'â˜„', 'ğŸ™†ğŸ¾\u200dâ™‚ï¸', 'ğŸ¤¸ğŸ½\u200dâ™‚', 'â£', 'ğŸ‡µğŸ‡¾', 'ğŸƒ\u200dâ™€ï¸', 'ğŸ‘©ğŸ¿\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘©ğŸ¿', 'ğŸš¶ğŸ½\u200dâ™€ï¸', 'ğŸ¬']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.63s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.75s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.67s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.21s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.75s/it]
Processing depth (1, 2, 3, 7):   3%|â–         | 3/100 [03:13<1:27:25, 54.08s/it]2025-01-22 18:47:19.096 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John took the milk.
2025-01-22 18:47:19.100 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (903, 907) -->  John took the milk
2025-01-22 18:47:19.101 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the bathroom.
2025-01-22 18:47:19.111 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2010, 2015) -->  cable. John travelled to
2025-01-22 18:47:19.111 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the kitchen.
2025-01-22 18:47:19.126 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2975, 2981) --> . John journeyed to the
2025-01-22 18:47:19.126 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the hallway.
2025-01-22 18:47:19.159 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5694, 5700) --> . Sandra went back to the
2025-01-22 18:47:19.160 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra journeyed to the garden.
2025-01-22 18:47:19.184 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4795, 4801) -->  the senate. Sandra journeyed
2025-01-22 18:47:19.184 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went back to the garden.
2025-01-22 18:47:19.206 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4316, 4322) --> . Mary went back to the
2025-01-22 18:47:19.206 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the office.
2025-01-22 18:47:19.208 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (297, 303) --> . Daniel went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:47:20.073 | INFO     | test_jbb_embedding:begin_test:693 - John took the milk.<|eot_id|>
2025-01-22 18:47:20.074 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8235])
2025-01-22 18:47:22.304 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [201.10863095238096, 24.910079433721776, 126.32703993055556, 24.23613445618368, 14.726731520432692], 'topk_indices': array([8225,    4, 8219,   24, 8226,  275, 8218, 8133, 8089,    9, 8123,
        906,  907, 8222, 8223,   14, 8233,    0, 8230, 8231]), 'topk_tokens': [' kitchen', '\n\n', ' Where', '\n\n', '?', ' If', ':', ' location', ' context', ':', '.\n\n', ' milk', '.', ' milk', ' before', '\n', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [571.6875, 178.996875, 151.36458333333334, 22.2265625]}, 'weight': {'score': [22.411458333333332, 23.33436134377276, 22.263020833333332, 23.339077174045617, 29.74939903846154], 'topk_indices': array([3363, 3336, 3256, 3208, 7478, 7516, 1473, 1411, 4344, 4328, 5239,
       5178, 7235, 7179, 3545, 3519, 4971, 4948, 4923, 5000]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [25.212890625, 24.4171875, 19.4140625, 21.869791666666668]}, 'saliency': {'score': [1.1930309477306547, 0.13425671715677348, 0.7575293646918403, 0.13017656512632067, 0.10940889211801383], 'topk_indices': array([8227, 8204, 8132,   14, 8228, 8226, 8129,    8, 8123,  298, 2016,
        275, 8217, 8219, 8225, 8133, 8089,  906, 8223, 8222]), 'topk_tokens': [' \n', ' return', ' first', '\n', 'Answer', '?', ' item', ' Date', '.\n\n', ' Daniel', ' bathroom', ' If', 'Question', ' Where', ' kitchen', ' location', ' context', ' milk', ' before', ' milk'], 'evidence_proportions': [3.758056640625, 1.0093994140625, 0.698974609375, 0.130096435546875]}}, 'pred_res': 'John took the milk.<|eot_id|>', 'score': 0}
2025-01-22 18:47:22.310 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:47:22.311 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-116_pid-3_1-2-3-7.pkl | len: 3 |  size: 2.0 KB
Processing depth (1, 2, 3, 7):   4%|â–         | 4/100 [03:17<1:04:57, 40.60s/it]is_0k: False
your chose emoji: ['ğŸ‡®ğŸ‡²', 'ğŸ§‘ğŸ½\u200dğŸ¼', 'ğŸ§‘ğŸ»\u200dâ¤\u200dğŸ’‹\u200dğŸ§‘ğŸ¾', 'ğŸ“›', 'ğŸ‘©ğŸ¾\u200dâ¤\u200dğŸ‘©ğŸ½', 'ğŸ‘¨ğŸ¾\u200dğŸ“', 'ğŸ‘©ğŸ¼\u200dâ¤\u200dğŸ‘©ğŸ½', 'â›¹ğŸ¼\u200dâ™‚ï¸', 'ğŸ§\u200dâ™‚ï¸\u200dâ¡', 'ğŸ§šğŸ¾\u200dâ™€']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.54s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.70s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.46s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.15s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.66s/it]
Processing depth (1, 2, 4, 9):   4%|â–         | 4/100 [03:33<1:04:57, 40.60s/it]2025-01-22 18:47:38.677 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John took the milk.
2025-01-22 18:47:38.681 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (837, 841) -->  John took the milk
2025-01-22 18:47:38.681 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the bathroom.
2025-01-22 18:47:38.690 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1827, 1832) --> . John travelled to the
2025-01-22 18:47:38.691 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the kitchen.
2025-01-22 18:47:38.709 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3606, 3612) -->  John journeyed to the kitchen
2025-01-22 18:47:38.709 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the hallway.
2025-01-22 18:47:38.746 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7242, 7248) --> . Sandra went back to the
2025-01-22 18:47:38.746 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra journeyed to the garden.
2025-01-22 18:47:38.774 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4630, 4636) -->  Sandra journeyed to the garden
2025-01-22 18:47:38.774 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went back to the garden.
2025-01-22 18:47:38.796 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4212, 4218) --> . Mary went back to the
2025-01-22 18:47:38.796 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the office.
2025-01-22 18:47:38.798 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (297, 303) --> . Daniel went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:47:39.647 | INFO     | test_jbb_embedding:begin_test:693 - John took the milk.<|eot_id|>
2025-01-22 18:47:39.647 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8189])
2025-01-22 18:47:41.850 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [204.06622023809524, 20.87380599975586, 85.07899305555556, 20.260199466454065, 21.772665895061728], 'topk_indices': array([8172,    1, 8087, 8173, 8117, 8174,    9,  275,  842,   24,   14,
       8043, 8176,  841,  840, 8177, 8187, 8184,    0, 8185]), 'topk_tokens': [':', '<|start_header_id|>', ' location', ' Where', ' the', ' was', ':', ' If', ' Paul', '\n\n', '\n', ' context', ' milk', '.', ' milk', ' before', '<|end_header_id|>', '<|eot_id|>', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [554.6875, 161.125, 190.42708333333334, 19.7421875]}, 'weight': {'score': [22.497767857142858, 23.295719146728516, 22.20355902777778, 23.300185706181775, 29.61689814814815], 'topk_indices': array([3315, 3342, 3235, 3187, 7422, 7460, 1525, 1463, 4356, 4372, 5251,
       5190, 7192, 7136, 3498, 3524, 5044, 4992, 5015, 4967]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [25.212890625, 19.990625, 23.404947916666668, 21.869791666666668]}, 'saliency': {'score': [1.2698465983072917, 0.11452666670084, 0.5138414171006944, 0.11066926647136215, 0.16020767777054398], 'topk_indices': array([8186,  837,    8,   24,  257,  298, 8174, 8041, 1832,  838, 8171,
       8087,  275, 8173, 8179,  842, 8043, 8177, 8176,  840]), 'topk_tokens': ['assistant', ' John', ' Date', '\n\n', 'hue', ' Daniel', ' was', ' provided', ' bathroom', ' took', 'Question', ' location', ' If', ' Where', ' kitchen', ' Paul', ' context', ' before', ' milk', ' milk'], 'evidence_proportions': [3.693603515625, 0.8830078125, 1.1350504557291667, 0.11117045084635417]}}, 'pred_res': 'John took the milk.<|eot_id|>', 'score': 0}
2025-01-22 18:47:41.878 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:47:41.878 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-116_pid-4_1-2-4-9.pkl | len: 3 |  size: 2.03 KB
Processing depth (1, 2, 4, 9):   5%|â–Œ         | 5/100 [03:36<52:16, 33.01s/it]  Processing depth (1, 2, 4, 9):   5%|â–Œ         | 5/100 [03:36<1:08:37, 43.35s/it]
2025-01-22 18:47:41.951 | INFO     | __main__:<module>:82 - Selected idx: 118
2025-01-22 18:47:41.952 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the apple before the bathroom? 
2025-01-22 18:47:41.952 | INFO     | __main__:<module>:84 - Answer: kitchen
2025-01-22 18:47:41.952 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 18:47:41.952 | INFO     | __main__:<module>:86 - Needle: [' Daniel went back to the office.', ' John left the milk.', ' Sandra took the apple.', ' Mary moved to the bathroom.', ' Sandra travelled to the kitchen.', ' John grabbed the milk.', ' John grabbed the milk.', ' Mary went back to the garden.', ' Sandra moved to the bathroom.', ' Daniel journeyed to the garden.']
2025-01-22 18:47:41.952 | INFO     | __main__:<module>:87 - Real Needle: [' Sandra took the apple.', ' Sandra travelled to the kitchen.', ' Sandra moved to the bathroom.', ' Daniel journeyed to the garden.']
2025-01-22 18:47:41.952 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸŒğŸ¾\u200dâ™‚ï¸', 'ğŸ§‘ğŸ¼\u200dâ¤ï¸\u200dğŸ§‘ğŸ¿', 'ğŸ’†ğŸ¾\u200dâ™‚', 'ğŸ§§', 'ğŸœ', 'ğŸ‘±ğŸ»\u200dâ™€', 'â›¹ğŸ½\u200dâ™‚ï¸', 'ğŸ§‘ğŸ¼\u200dâš•', 'ğŸ®', 'ğŸ‘©ğŸ»\u200dğŸ¦³']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.82s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.89s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.58s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.14s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.72s/it]
Processing depth (2, 3, 5, 9):   0%|          | 0/100 [00:16<?, ?it/s]2025-01-22 18:47:58.698 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra took the apple.
2025-01-22 18:47:58.708 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1856, 1860) -->  Sandra took the apple
2025-01-22 18:47:58.708 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra travelled to the kitchen.
2025-01-22 18:47:58.726 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2951, 2956) --> . Sandra travelled to the
2025-01-22 18:47:58.726 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the bathroom.
2025-01-22 18:47:58.749 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4270, 4275) --> . Sandra moved to the
2025-01-22 18:47:58.749 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the garden.
2025-01-22 18:47:58.788 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7166, 7172) -->  Daniel journeyed to the garden
2025-01-22 18:47:58.789 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went back to the office.
2025-01-22 18:47:58.827 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6966, 6972) --> . Daniel went back to the
2025-01-22 18:47:58.827 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John left the milk.
2025-01-22 18:47:58.850 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4489, 4493) -->  John left the milk
2025-01-22 18:47:58.850 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary moved to the bathroom.
2025-01-22 18:47:58.874 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4271, 4276) -->  Sandra moved to the bathroom
2025-01-22 18:47:58.874 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John grabbed the milk.
2025-01-22 18:47:58.888 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2393, 2397) -->  John grabbed the milk
2025-01-22 18:47:58.888 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John grabbed the milk.
2025-01-22 18:47:58.903 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (2393, 2397) -->  John grabbed the milk
2025-01-22 18:47:58.903 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary went back to the garden.
2025-01-22 18:47:58.944 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (5010, 5016) -->  Mary went back to the garden
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:47:59.718 | INFO     | test_jbb_embedding:begin_test:693 - kitchen<|eot_id|>
2025-01-22 18:47:59.718 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8214])
2025-01-22 18:48:02.133 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [70.479296875, 7.701803901210904, 29.916352370689655, 7.4692167605288935, 7.717122395833333], 'topk_indices': array([   1, 8197, 8208, 8067,   23, 8210, 1859, 8102,    9, 1856, 1863,
       1864, 8068,   24, 8112,   28,   14, 8212,    0, 8209]), 'topk_tokens': ['<|start_header_id|>', ':', ':', ' you', '4', '<|start_header_id|>', ' apple', '.\n\n', ':', ' Sandra', ' *', '      ', ' context', '\n\n', ' location', '<|end_header_id|>', '\n', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [182.3125, 64.46875, 47.225, 20.311197916666668]}, 'weight': {'score': [23.60390625, 23.309257864792503, 24.916217672413794, 23.302830979125858, 29.728448275862068], 'topk_indices': array([3291, 3318, 3211, 3163, 7495, 7457, 1481, 1419, 4297, 4281, 5152,
       5213, 7234, 7178, 3474, 3500, 4911, 4886, 4934, 4963]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [27.982421875, 22.15, 21.040625, 24.032552083333332]}, 'saliency': {'score': [0.471337890625, 0.04297370441757561, 0.19775285391971983, 0.04137528631526039, 0.05740680913815553], 'topk_indices': array([8183,    8,   23, 8111,   20, 8102, 8066, 8067, 8207, 1862, 8202,
       8196,   24, 8204, 1859, 1863, 1864, 8068, 8112, 1856]), 'topk_tokens': [' return', ' Date', '4', ' first', ' Jul', '.\n\n', ' provided', ' you', 'Answer', '      ', ' before', 'Question', '\n\n', ' bathroom', ' apple', ' *', '      ', ' context', ' location', ' Sandra'], 'evidence_proportions': [1.36846923828125, 0.3739013671875, 0.26510009765625, 0.126312255859375]}}, 'pred_res': 'kitchen<|eot_id|>', 'score': 100}
2025-01-22 18:48:02.156 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:48:02.156 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-118_pid-0_2-3-5-9.pkl | len: 3 |  size: 2.02 KB
Processing depth (2, 3, 5, 9):   1%|          | 1/100 [00:20<33:09, 20.10s/it]is_0k: False
your chose emoji: ['â˜ ', 'ğŸ‘©ğŸ¾\u200dâ¤\u200dğŸ’‹\u200dğŸ‘©ğŸ½', 'ğŸ‘©ğŸ¾\u200dâ¤\u200dğŸ‘©ğŸ¿', 'ğŸ‘«ğŸ»', 'ğŸ‘©ğŸ¿\u200dğŸ¦½\u200dâ¡ï¸', 'ğŸš£ğŸ¾\u200dâ™€', 'ğŸ‘©ğŸ½\u200dğŸŒ¾', 'âœˆï¸', 'ğŸ¤¹', 'ğŸ™…ğŸ¿\u200dâ™€']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.86s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.79s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.27s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.74s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.41s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (3, 6, 8, 9):   1%|          | 1/100 [00:35<33:09, 20.10s/it]2025-01-22 18:48:17.597 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra took the apple.
2025-01-22 18:48:17.612 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2901, 2905) -->  Sandra took the apple
2025-01-22 18:48:17.612 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra travelled to the kitchen.
2025-01-22 18:48:17.636 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4785, 4790) -->  the senate. Sandra travelled
2025-01-22 18:48:17.636 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the bathroom.
2025-01-22 18:48:17.657 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4303, 4308) -->  Mary moved to the bathroom
2025-01-22 18:48:17.658 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the garden.
2025-01-22 18:48:17.694 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7243, 7249) --> . Daniel journeyed to the
2025-01-22 18:48:17.694 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went back to the office.
2025-01-22 18:48:17.729 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6940, 6946) --> . Daniel went back to the
2025-01-22 18:48:17.729 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John left the milk.
2025-01-22 18:48:17.750 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4391, 4395) -->  John left the milk
2025-01-22 18:48:17.750 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary moved to the bathroom.
2025-01-22 18:48:17.772 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4302, 4307) --> . Mary moved to the
2025-01-22 18:48:17.772 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John grabbed the milk.
2025-01-22 18:48:17.782 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2156, 2160) -->  John grabbed the milk
2025-01-22 18:48:17.782 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John grabbed the milk.
2025-01-22 18:48:17.793 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (2156, 2160) -->  John grabbed the milk
2025-01-22 18:48:17.793 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary went back to the garden.
2025-01-22 18:48:17.817 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (4941, 4947) --> . Mary went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:48:22.882 | INFO     | test_jbb_embedding:begin_test:693 - Sandra took the apple.<|eot_id|>
2025-01-22 18:48:22.882 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8204])
2025-01-22 18:48:26.048 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [149.44296875, 16.108999939076398, 84.77209051724138, 15.538037815641088, 28.292528105945124], 'topk_indices': array([8056,    9,   23,    1, 4792, 8194, 2901, 8187, 8198, 8092, 8057,
         24, 8192, 8058, 8102,   14, 8200, 8202,    0, 8199]), 'topk_tokens': [' provided', ':', '4', '<|start_header_id|>', ' kitchen', ' bathroom', ' Sandra', ':', ':', '.\n\n', ' you', '\n\n', ' before', ' context', ' location', '\n', '<|start_header_id|>', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [279.78125, 149.9875, 180.325, 36.361979166666664]}, 'weight': {'score': [24.73125, 23.291608916169125, 22.916756465517242, 23.28941204186075, 29.236661585365855], 'topk_indices': array([3334, 3307, 3227, 3179, 7489, 7451, 1439, 1501, 4329, 4313, 5162,
       5223, 7193, 7137, 3490, 3516, 4937, 4912, 4996, 4967]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [27.982421875, 26.878125, 25.3359375, 20.270833333333332]}, 'saliency': {'score': [1.0672515869140624, 0.09033628519289935, 0.5223378148572199, 0.08640562199178528, 0.20540367684713223], 'topk_indices': array([8173, 8188,   24, 8092, 6631, 8101, 8197, 8057, 8191, 4307, 2904,
       8186, 8056, 4788, 8192, 4792, 8194, 8102, 8058, 2901]), 'topk_tokens': [' return', ' Where', '\n\n', '.\n\n', ' bathroom', ' first', 'Answer', ' you', ' apple', ' bathroom', ' apple', 'Question', ' provided', ' Sandra', ' before', ' kitchen', ' bathroom', ' location', ' context', ' Sandra'], 'evidence_proportions': [2.1185302734375, 1.127880859375, 1.21103515625, 0.19605509440104166]}}, 'pred_res': 'Sandra took the apple.<|eot_id|>', 'score': 0}
2025-01-22 18:48:26.075 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:48:26.075 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-118_pid-1_3-6-8-9.pkl | len: 3 |  size: 2.06 KB
Processing depth (3, 6, 8, 9):   2%|â–         | 2/100 [00:44<36:29, 22.35s/it]is_0k: False
your chose emoji: ['ğŸ‡³ğŸ‡µ', 'â™¨', 'ğŸ§ğŸ¼\u200dâ™‚ï¸\u200dâ¡ï¸', '\U0001faf0ğŸ½', 'ğŸ‡¨ğŸ‡º', 'ğŸ‘·ğŸ»\u200dâ™€', 'ğŸ§‘ğŸ¼\u200dğŸ¦°', 'ğŸ§‘ğŸ»\u200dğŸ¦¯', 'ğŸ‘¨ğŸ»\u200dğŸ¦¼\u200dâ¡ï¸', 'ğŸ‡§ğŸ‡§']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:05<00:15,  5.15s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.15s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.81s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.35s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.96s/it]
Processing depth (0, 3, 4, 7):   2%|â–         | 2/100 [01:01<36:29, 22.35s/it]2025-01-22 18:48:43.739 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra took the apple.
2025-01-22 18:48:43.783 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra travelled to the kitchen.
2025-01-22 18:48:43.798 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2967, 2972) -->  tragedy. Sandra travelled to
2025-01-22 18:48:43.799 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the bathroom.
2025-01-22 18:48:43.818 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3632, 3637) --> . Sandra moved to the
2025-01-22 18:48:43.818 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the garden.
2025-01-22 18:48:43.848 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5615, 5621) --> . Daniel journeyed to the
2025-01-22 18:48:43.848 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went back to the office.
2025-01-22 18:48:43.887 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6912, 6918) --> . Daniel went back to the
2025-01-22 18:48:43.887 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John left the milk.
2025-01-22 18:48:43.911 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4474, 4478) -->  John left the milk
2025-01-22 18:48:43.911 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary moved to the bathroom.
2025-01-22 18:48:43.929 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3633, 3638) -->  Sandra moved to the bathroom
2025-01-22 18:48:43.929 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John grabbed the milk.
2025-01-22 18:48:43.941 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2460, 2464) -->  John grabbed the milk
2025-01-22 18:48:43.941 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John grabbed the milk.
2025-01-22 18:48:43.954 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (2460, 2464) -->  John grabbed the milk
2025-01-22 18:48:43.954 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary went back to the garden.
2025-01-22 18:48:43.982 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (4924, 4930) --> . Mary went back to the
2025-01-22 18:48:43.982 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 18:48:43.982 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 18:48:43.982 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 18:48:43.982 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['âŒ', 'ğŸ™ğŸ¼\u200dâ™‚', 'ğŸ§ğŸ½\u200dâ™‚ï¸', 'ğŸ‘¦ğŸ¿', '\U0001fac5ğŸ¾', 'ğŸšµğŸ½\u200dâ™€ï¸', 'ğŸ‘±ğŸ½', 'ğŸï¸', 'ğŸ•´ğŸ»', 'â˜ğŸ»']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.19s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:09,  4.55s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.60s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.24s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.70s/it]
Processing depth (0, 1, 7, 9):   2%|â–         | 2/100 [01:18<36:29, 22.35s/it]2025-01-22 18:49:00.476 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra took the apple.
2025-01-22 18:49:00.518 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra travelled to the kitchen.
2025-01-22 18:49:00.524 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (901, 906) --> . Sandra travelled to the
2025-01-22 18:49:00.524 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the bathroom.
2025-01-22 18:49:00.548 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4340, 4345) -->  Mary moved to the bathroom
2025-01-22 18:49:00.548 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the garden.
2025-01-22 18:49:00.588 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7255, 7261) -->  cold. Daniel journeyed to
2025-01-22 18:49:00.588 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went back to the office.
2025-01-22 18:49:00.628 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6941, 6947) --> . Daniel went back to the
2025-01-22 18:49:00.628 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John left the milk.
2025-01-22 18:49:00.650 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4464, 4468) -->  John left the milk
2025-01-22 18:49:00.650 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary moved to the bathroom.
2025-01-22 18:49:00.671 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4339, 4344) --> . Mary moved to the
2025-01-22 18:49:00.671 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John grabbed the milk.
2025-01-22 18:49:00.686 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2200, 2204) -->  John grabbed the milk
2025-01-22 18:49:00.686 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John grabbed the milk.
2025-01-22 18:49:00.699 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (2200, 2204) -->  John grabbed the milk
2025-01-22 18:49:00.699 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary went back to the garden.
2025-01-22 18:49:00.724 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (4956, 4962) --> . Mary went back to the
2025-01-22 18:49:00.725 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 18:49:00.725 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 18:49:00.725 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 18:49:00.725 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['â›¹ğŸ¿\u200dâ™‚', 'ğŸ’†ğŸ¿\u200dâ™‚ï¸', 'ğŸ“¿', 'ğŸš£ğŸ¾\u200dâ™‚', 'ğŸ§‘ğŸ»\u200dğŸ­', '6âƒ£', 'ğŸ‡¦ğŸ‡¬', 'âœ‹', 'ğŸ‘ğŸ»', 'ğŸ¤ŒğŸ½']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.14s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.23s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.49s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.21s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.62s/it]
Processing depth (0, 3, 5, 9):   2%|â–         | 2/100 [01:34<36:29, 22.35s/it]2025-01-22 18:49:17.058 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra took the apple.
2025-01-22 18:49:17.103 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra travelled to the kitchen.
2025-01-22 18:49:17.123 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2834, 2839) --> . Sandra travelled to the
2025-01-22 18:49:17.123 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the bathroom.
2025-01-22 18:49:17.143 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4151, 4156) --> . Sandra moved to the
2025-01-22 18:49:17.144 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the garden.
2025-01-22 18:49:17.179 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7143, 7149) -->  Daniel journeyed to the garden
2025-01-22 18:49:17.180 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went back to the office.
2025-01-22 18:49:17.216 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6835, 6841) --> . Daniel went back to the
2025-01-22 18:49:17.218 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John left the milk.
2025-01-22 18:49:17.241 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4328, 4332) -->  John left the milk
2025-01-22 18:49:17.241 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary moved to the bathroom.
2025-01-22 18:49:17.262 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4152, 4157) -->  Sandra moved to the bathroom
2025-01-22 18:49:17.262 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John grabbed the milk.
2025-01-22 18:49:17.272 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2134, 2138) -->  John grabbed the milk
2025-01-22 18:49:17.272 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John grabbed the milk.
2025-01-22 18:49:17.282 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (2134, 2138) -->  John grabbed the milk
2025-01-22 18:49:17.282 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary went back to the garden.
2025-01-22 18:49:17.310 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (4804, 4810) -->  the senate. Mary went back
2025-01-22 18:49:17.311 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 18:49:17.311 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 18:49:17.311 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 18:49:17.311 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ‘«ğŸ¾', 'ğŸƒğŸ½\u200dâ™‚', 'ğŸ™…ğŸ»\u200dâ™€ï¸', 'â„¹', 'ğŸ‘©ğŸ¿\u200dğŸ¦½\u200dâ¡ï¸', 'ğŸ‘©ğŸ¾\u200dğŸ¦¯', 'ğŸ‘¨\u200dğŸ¦¯\u200dâ¡ï¸', 'ğŸ¤¿', 'ğŸ”‡', 'ğŸ¤¾\u200dâ™€']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.81s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.83s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.75s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.27s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.83s/it]
Processing depth (3, 5, 7, 8):   2%|â–         | 2/100 [01:52<36:29, 22.35s/it]2025-01-22 18:49:34.505 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra took the apple.
2025-01-22 18:49:34.519 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2919, 2923) -->  Sandra took the apple
2025-01-22 18:49:34.519 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra travelled to the kitchen.
2025-01-22 18:49:34.544 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4209, 4214) -->  Sandra travelled to the kitchen
2025-01-22 18:49:34.544 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the bathroom.
2025-01-22 18:49:34.567 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4287, 4292) -->  Mary moved to the bathroom
2025-01-22 18:49:34.567 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the garden.
2025-01-22 18:49:34.600 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6604, 6610) --> . Daniel journeyed to the
2025-01-22 18:49:34.600 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went back to the office.
2025-01-22 18:49:34.638 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6807, 6813) --> . Daniel went back to the
2025-01-22 18:49:34.638 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John left the milk.
2025-01-22 18:49:34.664 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4375, 4379) -->  John left the milk
2025-01-22 18:49:34.664 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary moved to the bathroom.
2025-01-22 18:49:34.686 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4286, 4291) --> . Mary moved to the
2025-01-22 18:49:34.686 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John grabbed the milk.
2025-01-22 18:49:34.698 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2378, 2382) -->  John grabbed the milk
2025-01-22 18:49:34.698 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John grabbed the milk.
2025-01-22 18:49:34.709 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (2378, 2382) -->  John grabbed the milk
2025-01-22 18:49:34.709 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary went back to the garden.
2025-01-22 18:49:34.735 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (4919, 4925) --> . Mary went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:49:35.533 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 18:49:35.533 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8146])
2025-01-22 18:49:37.744 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [150.5140625, 11.248111348018162, 59.07165948275862, 10.733024691358025, 11.536814563679245], 'topk_indices': array([8119, 8129, 8044, 8127,   23,    1, 8034, 8000,   24,   28, 8140,
       8145, 2922,    3, 4213, 8142,   14, 8144,    0, 8141]), 'topk_tokens': ['.', ':', ' location', '.\n\n', '4', '<|start_header_id|>', '.\n\n', ' context', '\n\n', '<|end_header_id|>', ':', '\n\n', ' apple', '<|end_header_id|>', ' kitchen', '<|start_header_id|>', '\n', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [266.90625, 261.2, 73.76875, 44.635416666666664]}, 'weight': {'score': [24.746484375, 23.243198935452202, 22.916756465517242, 23.24065586419753, 28.76798349056604], 'topk_indices': array([3316, 3289, 3177, 3129, 7437, 7399, 1399, 1461, 4313, 4297, 5120,
       5181, 7176, 7120, 3472, 3498, 4915, 4974, 4945, 4890]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [27.982421875, 26.9390625, 25.3359375, 20.270833333333332]}, 'saliency': {'score': [1.0464874267578126, 0.06216461747127715, 0.3757618871228448, 0.05861143512490355, 0.08301141127100531], 'topk_indices': array([8118, 8138,   20, 8133, 4209, 8143, 8034,   24, 8115, 8134, 8145,
       8044, 4210, 8128, 8139, 2919, 8136, 8000, 2922, 4213]), 'topk_tokens': [' directly', ' \n', ' Jul', ' apple', ' Sandra', 'assistant', '.\n\n', '\n\n', ' return', ' before', '\n\n', ' location', ' travelled', 'Question', 'Answer', ' Sandra', ' bathroom', ' context', ' apple', ' kitchen'], 'evidence_proportions': [1.987060546875, 1.778515625, 0.4982177734375, 0.2663065592447917]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 100}
2025-01-22 18:49:37.750 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:49:37.750 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-118_pid-2_3-5-7-8.pkl | len: 3 |  size: 2.05 KB
Processing depth (3, 5, 7, 8):   3%|â–         | 3/100 [01:55<1:12:32, 44.87s/it]is_0k: False
your chose emoji: ['ğŸ›•', 'ğŸ¤¶ğŸ¿', 'ğŸ”¡', 'âœğŸ»', 'ğŸ‡¹ğŸ‡¼', 'ğŸš†', 'ğŸ‘¨ğŸ¾\u200dâ¤ï¸\u200dğŸ‘¨ğŸ¿', 'ğŸ‡¸ğŸ‡¾', 'ğŸ“–', 'ğŸ¥']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:05<00:15,  5.07s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:11<00:11,  5.61s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:15<00:05,  5.15s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  3.51s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  4.16s/it]
Processing depth (1, 4, 5, 8):   3%|â–         | 3/100 [02:14<1:12:32, 44.87s/it]2025-01-22 18:49:56.836 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra took the apple.
2025-01-22 18:49:56.840 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (828, 832) -->  Sandra took the apple
2025-01-22 18:49:56.840 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra travelled to the kitchen.
2025-01-22 18:49:56.858 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3634, 3639) -->  Hon. Sandra travelled to
2025-01-22 18:49:56.858 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the bathroom.
2025-01-22 18:49:56.882 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4223, 4228) -->  Sandra moved to the bathroom
2025-01-22 18:49:56.882 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the garden.
2025-01-22 18:49:56.918 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6622, 6628) --> . Daniel journeyed to the
2025-01-22 18:49:56.918 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went back to the office.
2025-01-22 18:49:56.953 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6937, 6943) --> . Daniel went back to the
2025-01-22 18:49:56.953 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John left the milk.
2025-01-22 18:49:56.975 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4455, 4459) -->  John left the milk
2025-01-22 18:49:56.975 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary moved to the bathroom.
2025-01-22 18:49:56.997 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4224, 4229) -->  moved to the bathroom.
2025-01-22 18:49:56.997 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John grabbed the milk.
2025-01-22 18:49:57.007 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2209, 2213) -->  John grabbed the milk
2025-01-22 18:49:57.008 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John grabbed the milk.
2025-01-22 18:49:57.018 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (2209, 2213) -->  John grabbed the milk
2025-01-22 18:49:57.018 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary went back to the garden.
2025-01-22 18:49:57.045 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (4893, 4899) --> . Mary went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:49:57.845 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 18:49:57.845 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8186])
2025-01-22 18:50:00.077 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [121.58515625, 9.973300693002809, 45.18265086206897, 9.573631372850123, 12.384779002568493], 'topk_indices': array([8167, 8159, 8039, 8174, 8169,    9, 8074,    1, 8185, 8040,   23,
         24, 8084, 8180,  831,   14,   28, 8184,    0, 8181]), 'topk_tokens': ['.\n\n', '.', ' you', ' before', ':', ':', '.\n\n', '<|start_header_id|>', '\n\n', ' context', '4', '\n\n', ' location', ':', ' apple', '\n', '<|end_header_id|>', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [246.09375, 163.8875, 84.20625, 34.4765625]}, 'weight': {'score': [25.099609375, 23.293906078275736, 23.099946120689655, 23.29016047297297, 30.098458904109588], 'topk_indices': array([3324, 3297, 3217, 3169, 7427, 7465, 1484, 1422, 4299, 4315, 5144,
       5205, 7134, 7190, 3480, 3506, 4969, 4998, 4946, 4921]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [27.982421875, 26.9578125, 26.7296875, 20.270833333333332]}, 'saliency': {'score': [0.8292724609375, 0.05553096128858072, 0.2757042194234914, 0.052845475480363176, 0.09467963649802012], 'topk_indices': array([8183, 8173, 8157, 8155, 8074, 8185,   23,   20,   24, 8168, 3640,
       8038, 8174, 3637, 8179,  828, 8176, 8040, 8084,  831]), 'topk_tokens': ['assistant', ' apple', ' location', ' return', '.\n\n', '\n\n', '4', ' Jul', '\n\n', 'Question', ' kitchen', ' provided', ' before', ' travelled', 'Answer', ' Sandra', ' bathroom', ' context', ' location', ' apple'], 'evidence_proportions': [1.7783203125, 1.04482421875, 0.5964599609375, 0.21095784505208334]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 100}
2025-01-22 18:50:00.084 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:50:00.084 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-118_pid-3_1-4-5-8.pkl | len: 3 |  size: 2.02 KB
Processing depth (1, 4, 5, 8):   4%|â–         | 4/100 [02:18<57:33, 35.97s/it]  is_0k: False
your chose emoji: ['ã€°ï¸', 'ğŸ‘ğŸ»', 'ğŸ‘¨ğŸ½\u200dğŸ¦¯\u200dâ¡ï¸', 'ğŸ’·', 'ğŸ¤™ğŸ¾', 'ğŸ§\u200dâ™‚ï¸', 'ğŸ§ğŸ¼\u200dâ™€ï¸', 'ğŸ§œğŸ»\u200dâ™€', 'ğŸ¦¹ğŸ¾\u200dâ™€ï¸', 'ğŸ’‡ğŸ½\u200dâ™‚ï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.56s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.22s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.91s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.34s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.93s/it]
Processing depth (0, 1, 2, 9):   4%|â–         | 4/100 [02:35<57:33, 35.97s/it]2025-01-22 18:50:17.516 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra took the apple.
2025-01-22 18:50:17.559 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra travelled to the kitchen.
2025-01-22 18:50:17.565 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (901, 906) --> . Sandra travelled to the
2025-01-22 18:50:17.565 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the bathroom.
2025-01-22 18:50:17.575 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2010, 2015) -->  cable. Sandra moved to
2025-01-22 18:50:17.575 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the garden.
2025-01-22 18:50:17.615 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7244, 7250) --> . Daniel journeyed to the
2025-01-22 18:50:17.615 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went back to the office.
2025-01-22 18:50:17.653 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6947, 6953) --> . Daniel went back to the
2025-01-22 18:50:17.653 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John left the milk.
2025-01-22 18:50:17.676 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4412, 4416) -->  John left the milk
2025-01-22 18:50:17.676 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary moved to the bathroom.
2025-01-22 18:50:17.688 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2012, 2017) -->  Sandra moved to the bathroom
2025-01-22 18:50:17.688 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John grabbed the milk.
2025-01-22 18:50:17.702 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2392, 2396) -->  John grabbed the milk
2025-01-22 18:50:17.702 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John grabbed the milk.
2025-01-22 18:50:17.715 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (2392, 2396) -->  John grabbed the milk
2025-01-22 18:50:17.715 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary went back to the garden.
2025-01-22 18:50:17.739 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (4828, 4834) -->  the senate. Mary went back
2025-01-22 18:50:17.739 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 18:50:17.739 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 18:50:17.739 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 18:50:17.739 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['âŒš', 'ğŸ‘¨ğŸ¿\u200dâ¤\u200dğŸ‘¨ğŸ¾', 'ğŸ‡¸ğŸ‡´', 'ğŸ™ğŸ½\u200dâ™€ï¸', 'â˜¢ï¸', 'ğŸ¤²ğŸ¼', 'ğŸ‘¨\u200dğŸ‘¨\u200dğŸ‘§\u200dğŸ‘§', 'ğŸ¤·\u200dâ™€ï¸', 'ğŸ‘¨ğŸ»\u200dğŸ¦¯', 'ğŸˆº']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.33s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.36s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.50s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.14s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.61s/it]
Processing depth (0, 4, 5, 6):   4%|â–         | 4/100 [02:51<57:33, 35.97s/it]2025-01-22 18:50:33.846 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra took the apple.
2025-01-22 18:50:33.896 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra travelled to the kitchen.
2025-01-22 18:50:33.915 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3586, 3591) --> . Sandra travelled to the
2025-01-22 18:50:33.916 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the bathroom.
2025-01-22 18:50:33.936 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4190, 4195) -->  Sandra moved to the bathroom
2025-01-22 18:50:33.936 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the garden.
2025-01-22 18:50:33.963 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4721, 4727) -->  Daniel journeyed to the garden
2025-01-22 18:50:33.963 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went back to the office.
2025-01-22 18:50:34.004 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6926, 6932) --> . Daniel went back to the
2025-01-22 18:50:34.004 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John left the milk.
2025-01-22 18:50:34.027 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4422, 4426) -->  John left the milk
2025-01-22 18:50:34.027 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary moved to the bathroom.
2025-01-22 18:50:34.052 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4191, 4196) -->  moved to the bathroom.
2025-01-22 18:50:34.052 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John grabbed the milk.
2025-01-22 18:50:34.062 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2040, 2044) -->  John grabbed the milk
2025-01-22 18:50:34.062 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John grabbed the milk.
2025-01-22 18:50:34.072 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (2040, 2044) -->  John grabbed the milk
2025-01-22 18:50:34.072 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary went back to the garden.
2025-01-22 18:50:34.096 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (4881, 4887) --> . Mary went back to the
2025-01-22 18:50:34.097 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 18:50:34.097 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 18:50:34.097 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 18:50:34.097 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ‘ğŸ¾', 'ğŸ‘¨ğŸ¿\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘¨ğŸ»', 'ğŸ‘±ğŸ¾\u200dâ™€', 'ğŸ™…ğŸ¾\u200dâ™‚', 'ğŸ¤±ğŸ½', 'ğŸ’‘ğŸ¾', 'ğŸš¨', 'ğŸ”¬', 'ğŸ‡¸ğŸ‡¦', 'ğŸ§œğŸ¼\u200dâ™‚ï¸']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:05<00:15,  5.17s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.07s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.78s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.31s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.91s/it]
Processing depth (1, 3, 5, 9):   4%|â–         | 4/100 [03:09<57:33, 35.97s/it]2025-01-22 18:50:51.465 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra took the apple.
2025-01-22 18:50:51.469 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (816, 820) -->  Sandra took the apple
2025-01-22 18:50:51.469 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra travelled to the kitchen.
2025-01-22 18:50:51.484 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2883, 2888) --> . Sandra travelled to the
2025-01-22 18:50:51.484 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the bathroom.
2025-01-22 18:50:51.507 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4128, 4133) --> . Sandra moved to the
2025-01-22 18:50:51.507 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the garden.
2025-01-22 18:50:51.545 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7108, 7114) -->  Daniel journeyed to the garden
2025-01-22 18:50:51.546 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went back to the office.
2025-01-22 18:50:51.582 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6800, 6806) --> . Daniel went back to the
2025-01-22 18:50:51.582 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John left the milk.
2025-01-22 18:50:51.604 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4321, 4325) -->  John left the milk
2025-01-22 18:50:51.605 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary moved to the bathroom.
2025-01-22 18:50:51.625 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4129, 4134) -->  Sandra moved to the bathroom
2025-01-22 18:50:51.625 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John grabbed the milk.
2025-01-22 18:50:51.636 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2139, 2143) -->  John grabbed the milk
2025-01-22 18:50:51.636 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John grabbed the milk.
2025-01-22 18:50:51.646 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (2139, 2143) -->  John grabbed the milk
2025-01-22 18:50:51.646 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary went back to the garden.
2025-01-22 18:50:51.671 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (4797, 4803) -->  the senate. Mary went back
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:50:52.537 | INFO     | test_jbb_embedding:begin_test:693 - Sandra took the apple.<|eot_id|>
2025-01-22 18:50:52.537 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8162])
2025-01-22 18:50:54.753 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [98.368359375, 10.825541564605022, 51.08176185344828, 10.465969516233367, 9.314741290983607], 'topk_indices': array([8161, 8144, 8050, 8145, 8152,    9, 8156, 8016, 8150,   23, 8060,
          1,  819,   24,   14,   28, 8160, 8158,    0, 8157]), 'topk_tokens': ['\n\n', 'Question', '.\n\n', ':', ' bathroom', ':', ':', ' context', ' before', '4', ' location', '<|start_header_id|>', ' apple', '\n\n', '\n', '<|end_header_id|>', '<|end_header_id|>', '<|start_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [247.75, 87.85, 75.65, 26.477864583333332]}, 'weight': {'score': [23.60390625, 23.26172114206981, 24.953125, 23.254834200961064, 29.283043032786885], 'topk_indices': array([3285, 3312, 3151, 3199, 7437, 7399, 1410, 1472, 4330, 4346, 5148,
       5209, 7176, 7120, 3468, 3494, 4973, 5002, 4925, 4950]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [27.982421875, 22.15, 21.040625, 24.032552083333332]}, 'saliency': {'score': [0.6473190307617187, 0.05978636873038503, 0.36084405307112066, 0.05726279479168271, 0.06923863145171619], 'topk_indices': array([   8,   16, 8050, 2888,   19, 8014, 8146, 4133, 8149,   23, 8155,
         24,   20, 8144, 8150,  816, 8016, 8060, 8152,  819]), 'topk_tokens': [' Date', ' Date', '.\n\n', ' kitchen', '26', ' provided', ' Where', ' bathroom', ' apple', '4', 'Answer', '\n\n', ' Jul', 'Question', ' before', ' Sandra', ' context', ' location', ' bathroom', ' apple'], 'evidence_proportions': [1.82757568359375, 0.5098876953125, 0.4255859375, 0.15978495279947916]}}, 'pred_res': 'Sandra took the apple.<|eot_id|>', 'score': 0}
2025-01-22 18:50:54.760 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:50:54.761 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-118_pid-4_1-3-5-9.pkl | len: 3 |  size: 2.04 KB
Processing depth (1, 3, 5, 9):   5%|â–Œ         | 5/100 [03:12<1:07:38, 42.72s/it]Processing depth (1, 3, 5, 9):   5%|â–Œ         | 5/100 [03:12<1:01:03, 38.56s/it]
2025-01-22 18:50:54.874 | INFO     | __main__:<module>:82 - Selected idx: 120
2025-01-22 18:50:54.874 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the football before the garden? 
2025-01-22 18:50:54.874 | INFO     | __main__:<module>:84 - Answer: kitchen
2025-01-22 18:50:54.874 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 18:50:54.874 | INFO     | __main__:<module>:86 - Needle: [' Daniel moved to the kitchen.', ' John got the football.', ' Daniel went to the garden.', ' John moved to the kitchen.', ' Sandra journeyed to the bedroom.', ' John travelled to the garden.', ' Mary moved to the bathroom.']
2025-01-22 18:50:54.874 | INFO     | __main__:<module>:87 - Real Needle: [' John got the football.', ' John moved to the kitchen.', ' John travelled to the garden.', ' Mary moved to the bathroom.']
2025-01-22 18:50:54.874 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ‘±ğŸ¾', 'ğŸ‡¸ğŸ‡§', 'ğŸ§‘ğŸ½\u200dğŸ„', 'ğŸ‡«ğŸ‡¯', 'ğŸ‹ğŸ¿\u200dâ™‚ï¸', 'ğŸ¾', 'ğŸ¤ª', 'ğŸ©', 'ğŸšš', 'ğŸš¶\u200dâ™‚ï¸\u200dâ¡ï¸']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.86s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.87s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.58s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.11s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.71s/it]
Processing depth (0, 2, 6, 9):   0%|          | 0/100 [00:16<?, ?it/s]2025-01-22 18:51:11.523 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John got the football.
2025-01-22 18:51:11.566 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John moved to the kitchen.
2025-01-22 18:51:11.574 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1792, 1797) --> . John moved to the
2025-01-22 18:51:11.575 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the garden.
2025-01-22 18:51:11.597 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4664, 4669) -->  John travelled to the garden
2025-01-22 18:51:11.598 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the bathroom.
2025-01-22 18:51:11.633 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7233, 7238) --> . Mary moved to the
2025-01-22 18:51:11.633 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the kitchen.
2025-01-22 18:51:11.642 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1793, 1798) -->  John moved to the kitchen
2025-01-22 18:51:11.642 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the garden.
2025-01-22 18:51:11.651 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1796, 1801) -->  the kitchen. Daniel went
2025-01-22 18:51:11.651 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra journeyed to the bedroom.
2025-01-22 18:51:11.673 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4304, 4310) --> . Sandra journeyed to the
2025-01-22 18:51:11.673 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 18:51:11.673 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 18:51:11.673 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 18:51:11.673 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ‡¦ğŸ‡®', 'ğŸ’‚ğŸ¿\u200dâ™€ï¸', 'ğŸ‘©ğŸ½\u200dğŸ¦½\u200dâ¡ï¸', 'ğŸ‘­ğŸ¾', 'ğŸ§›ğŸ¼\u200dâ™‚ï¸', 'ğŸ•µï¸\u200dâ™‚ï¸', 'ğŸ´\u200dâ˜ ', 'ğŸ‘©ğŸ¾\u200dğŸ¦¼\u200dâ¡', 'ğŸ—œï¸', 'â–ªï¸']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.54s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.78s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.83s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.31s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.84s/it]
Processing depth (1, 2, 6, 8):   0%|          | 0/100 [00:34<?, ?it/s]2025-01-22 18:51:29.083 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John got the football.
2025-01-22 18:51:29.087 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (896, 900) -->  John got the football
2025-01-22 18:51:29.087 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John moved to the kitchen.
2025-01-22 18:51:29.096 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1782, 1787) --> . John moved to the
2025-01-22 18:51:29.097 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the garden.
2025-01-22 18:51:29.122 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4741, 4746) -->  the senate. John travelled
2025-01-22 18:51:29.122 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the bathroom.
2025-01-22 18:51:29.156 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6587, 6592) --> . Mary moved to the
2025-01-22 18:51:29.157 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the kitchen.
2025-01-22 18:51:29.165 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1783, 1788) -->  John moved to the kitchen
2025-01-22 18:51:29.166 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the garden.
2025-01-22 18:51:29.175 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1786, 1791) -->  the kitchen. Daniel went
2025-01-22 18:51:29.175 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra journeyed to the bedroom.
2025-01-22 18:51:29.203 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4262, 4268) --> . Sandra journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:51:30.055 | INFO     | test_jbb_embedding:begin_test:693 - John got the football.<|eot_id|>
2025-01-22 18:51:30.055 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8137])
2025-01-22 18:51:32.267 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [398.4375, 38.71750998157248, 376.0234375, 37.20837060456508, 25.67578125], 'topk_indices': array([8034, 8063, 8131, 7596, 7552, 8125,  896, 8124,  900,   24, 7991,
       8132, 7605, 8035, 8025,   14,  899, 8135, 8133,    0]), 'topk_tokens': [' first', ' moved', ':', ' tele', 'graph', ' before', ' John', ' football', '.', '\n\n', ' context', '<|eot_id|>', ' or', ' location', '.\n\n', '\n', ' football', '<|end_header_id|>', '<|start_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [825.375, 439.4, 136.0625, 278.3]}, 'weight': {'score': [22.04481907894737, 23.25065264127764, 22.73291015625, 23.254501465144973, 29.17406798245614], 'topk_indices': array([3280, 3307, 3152, 3200, 7422, 7384, 1410, 1472, 4274, 4290, 5162,
       5101, 7161, 7105, 3463, 3489, 4916, 4893, 4868, 4945]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [25.654296875, 18.88125, 24.71875, 19.646875]}, 'saliency': {'score': [2.4035612407483553, 0.2177218350497159, 2.1972808837890625, 0.20868989260824722, 0.18741701360334428], 'topk_indices': array([7996, 8130, 7620, 8127, 8034, 8119, 1787, 8125, 8025, 7551,  896,
       8063,  257, 7605, 7552, 7596, 8124, 8035, 7991,  899]), 'topk_tokens': [' locations', 'Answer', 'nes', ' garden', ' first', 'Question', ' kitchen', ' before', '.\n\n', ' tele', ' John', ' moved', 'hue', ' or', 'graph', ' tele', ' football', ' location', ' context', ' football'], 'evidence_proportions': [5.59130859375, 2.2169921875, 0.90999755859375, 1.53349609375]}}, 'pred_res': 'John got the football.<|eot_id|>', 'score': 0}
2025-01-22 18:51:32.292 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:51:32.292 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-120_pid-0_1-2-6-8.pkl | len: 3 |  size: 2.04 KB
Processing depth (1, 2, 6, 8):   1%|          | 1/100 [00:37<1:01:32, 37.30s/it]is_0k: False
your chose emoji: ['â²', 'ğŸ‘¨ğŸ¿\u200dğŸ¦½\u200dâ¡', 'â­', 'ğŸ‹\u200dğŸŸ©', 'ğŸ‘©ğŸ½\u200dğŸ¼', 'ğŸ•ï¸', 'ğŸ’“', 'ğŸ…°ï¸', 'ğŸ‘ˆğŸ¿', 'ğŸ™ğŸ¾']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.58s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.94s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.65s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.25s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.79s/it]
Processing depth (0, 3, 4, 9):   1%|          | 1/100 [00:54<1:01:32, 37.30s/it]2025-01-22 18:51:49.214 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John got the football.
2025-01-22 18:51:49.256 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John moved to the kitchen.
2025-01-22 18:51:49.271 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2940, 2945) --> . John moved to the
2025-01-22 18:51:49.271 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the garden.
2025-01-22 18:51:49.289 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3647, 3652) -->  Hon. John travelled to
2025-01-22 18:51:49.289 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the bathroom.
2025-01-22 18:51:49.329 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7269, 7274) --> . Mary moved to the
2025-01-22 18:51:49.329 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the kitchen.
2025-01-22 18:51:49.345 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2941, 2946) -->  John moved to the kitchen
2025-01-22 18:51:49.346 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the garden.
2025-01-22 18:51:49.356 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1847, 1852) -->  Daniel went to the garden
2025-01-22 18:51:49.356 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra journeyed to the bedroom.
2025-01-22 18:51:49.379 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4372, 4378) --> . Sandra journeyed to the
2025-01-22 18:51:49.379 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 18:51:49.379 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 18:51:49.379 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 18:51:49.379 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ¥³', 'âœŠğŸ¾', 'ğŸ§\u200dâ™‚', 'ğŸ§ğŸ¿\u200dâ™‚ï¸\u200dâ¡ï¸', 'ğŸ§‘ğŸ½\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ§‘ğŸ¾', '4ï¸âƒ£', 'ğŸ‘©ğŸ¿\u200dğŸ’¼', 'ğŸ‘©ğŸ»\u200dâ¤\u200dğŸ‘©ğŸ¼', 'ğŸ‘©ğŸ¿\u200dâ¤ï¸\u200dğŸ‘¨ğŸ¾', 'ğŸ¤˜ğŸ»']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.82s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.95s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.72s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.23s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.81s/it]
Processing depth (0, 4, 6, 8):   1%|          | 1/100 [01:11<1:01:32, 37.30s/it]2025-01-22 18:52:06.390 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John got the football.
2025-01-22 18:52:06.430 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John moved to the kitchen.
2025-01-22 18:52:06.448 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3631, 3636) -->  Hon. John moved to
2025-01-22 18:52:06.449 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the garden.
2025-01-22 18:52:06.472 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4677, 4682) --> . John travelled to the
2025-01-22 18:52:06.472 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the bathroom.
2025-01-22 18:52:06.504 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6555, 6560) --> . Mary moved to the
2025-01-22 18:52:06.504 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the kitchen.
2025-01-22 18:52:06.524 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3633, 3638) -->  John moved to the kitchen
2025-01-22 18:52:06.524 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the garden.
2025-01-22 18:52:06.535 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1852, 1857) --> . Daniel went to the
2025-01-22 18:52:06.535 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra journeyed to the bedroom.
2025-01-22 18:52:06.561 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4281, 4287) -->  Sandra journeyed to the bedroom
2025-01-22 18:52:06.561 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 18:52:06.561 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 18:52:06.561 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 18:52:06.561 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ§ğŸ¼\u200dâ™€', 'ğŸ‘ğŸ½', 'ğŸ‡±ğŸ‡¨', 'ğŸ§‘ğŸ¿\u200dğŸ¤\u200dğŸ§‘ğŸ¼', 'ğŸ‘‹ğŸ¿', 'ğŸ¥', 'ğŸ‘¨ğŸ½\u200dâ¤\u200dğŸ‘¨ğŸ»', 'ğŸ§\u200dâ™€ï¸\u200dâ¡ï¸', 'ğŸ§‘ğŸ¾\u200dâ¤\u200dğŸ§‘ğŸ½', 'ğŸ¤¾ğŸ½\u200dâ™‚ï¸']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.28s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.55s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.61s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.24s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.71s/it]
Processing depth (1, 3, 5, 9):   1%|          | 1/100 [01:28<1:01:32, 37.30s/it]2025-01-22 18:52:23.349 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John got the football.
2025-01-22 18:52:23.353 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (816, 820) -->  John got the football
2025-01-22 18:52:23.353 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John moved to the kitchen.
2025-01-22 18:52:23.371 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2965, 2970) -->  tragedy. John moved to
2025-01-22 18:52:23.371 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the garden.
2025-01-22 18:52:23.393 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4187, 4192) -->  John travelled to the garden
2025-01-22 18:52:23.393 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the bathroom.
2025-01-22 18:52:23.433 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7189, 7194) --> . Mary moved to the
2025-01-22 18:52:23.433 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the kitchen.
2025-01-22 18:52:23.448 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2967, 2972) -->  John moved to the kitchen
2025-01-22 18:52:23.448 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the garden.
2025-01-22 18:52:23.457 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1846, 1851) --> . Daniel went to the
2025-01-22 18:52:23.457 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra journeyed to the bedroom.
2025-01-22 18:52:23.479 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4264, 4270) --> . Sandra journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:52:24.339 | INFO     | test_jbb_embedding:begin_test:693 - John got the football.<|eot_id|>
2025-01-22 18:52:24.340 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8141])
2025-01-22 18:52:26.556 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [277.7212171052632, 27.38625061394892, 179.609375, 26.49934293686028, 15.810215836864407], 'topk_indices': array([ 817, 7995,  816, 8128, 8038, 8129, 8067,    3,    1, 8069,  820,
       8029, 8039,   24,   14, 8137,  819, 8139, 8136,    0]), 'topk_tokens': [' got', ' context', ' John', ' football', ' first', ' before', ' moved', '<|end_header_id|>', '<|start_header_id|>', ' the', '.', '.\n\n', ' location', '\n\n', '\n', '<|start_header_id|>', ' football', '<|end_header_id|>', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [649.25, 156.065625, 237.2125, 142.6625]}, 'weight': {'score': [23.51685855263158, 23.258959817043223, 21.49755859375, 23.26183099025774, 29.546610169491526], 'topk_indices': array([3248, 3275, 3120, 3168, 7368, 7406, 1472, 1410, 4292, 4276, 5170,
       5109, 7139, 7083, 3447, 3473, 4870, 4953, 4895, 4924]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [25.654296875, 24.6890625, 24.5046875, 19.646875]}, 'saliency': {'score': [1.7279245476973684, 0.15181390428824135, 0.9878692626953125, 0.14647132345715408, 0.11545213602356992], 'topk_indices': array([7993, 8110,   16, 8033, 8035,   32,  821, 8131,  263, 8029,   24,
       8038,  817, 8129,  816, 7995, 8128, 8067, 8039,  819]), 'topk_tokens': [' provided', ' return', ' Date', ' obtained', ' item', '***', ' Paul', ' garden', 'hue', '.\n\n', '\n\n', ' first', ' got', ' before', ' John', ' context', ' football', ' moved', ' location', ' football'], 'evidence_proportions': [4.318603515625, 0.8787353515625, 1.48037109375, 0.7521240234375]}}, 'pred_res': 'John got the football.<|eot_id|>', 'score': 0}
2025-01-22 18:52:26.571 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:52:26.571 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-120_pid-1_1-3-5-9.pkl | len: 3 |  size: 2.07 KB
Processing depth (1, 3, 5, 9):   2%|â–         | 2/100 [01:31<1:17:14, 47.29s/it]is_0k: False
your chose emoji: ['â˜ªï¸', 'ğŸˆ³', 'ğŸ‘', 'ğŸ§‘ğŸ½\u200dğŸ¦¯\u200dâ¡ï¸', 'ğŸ§–\u200dâ™€', 'ğŸ™ğŸ¿\u200dâ™€', 'ğŸ‘©ğŸ¾\u200dğŸ«', 'ğŸ›¡ï¸', 'ğŸªƒ', 'ğŸ‘ƒğŸ¾']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.69s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.77s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.29s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  2.91s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.51s/it]
Processing depth (0, 3, 5, 7):   2%|â–         | 2/100 [01:47<1:17:14, 47.29s/it]2025-01-22 18:52:42.394 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John got the football.
2025-01-22 18:52:42.434 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John moved to the kitchen.
2025-01-22 18:52:42.448 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2886, 2891) --> . John moved to the
2025-01-22 18:52:42.448 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the garden.
2025-01-22 18:52:42.469 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4207, 4212) -->  John travelled to the garden
2025-01-22 18:52:42.469 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the bathroom.
2025-01-22 18:52:42.497 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5605, 5610) --> . Mary moved to the
2025-01-22 18:52:42.497 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the kitchen.
2025-01-22 18:52:42.511 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2887, 2892) -->  John moved to the kitchen
2025-01-22 18:52:42.511 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the garden.
2025-01-22 18:52:42.520 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1792, 1797) --> . Daniel went to the
2025-01-22 18:52:42.521 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra journeyed to the bedroom.
2025-01-22 18:52:42.542 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4310, 4316) --> . Sandra journeyed to the
2025-01-22 18:52:42.543 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 18:52:42.543 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 18:52:42.543 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 18:52:42.543 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['\U0001fa7b', 'ğŸ§—ğŸ»\u200dâ™€', 'ğŸ§—\u200dâ™‚', 'ğŸ§”ğŸ»', 'ğŸ‘¨ğŸ½\u200dâ¤ï¸\u200dğŸ‘¨ğŸ¼', 'ğŸ¤°ğŸ»', 'ğŸ¤¦ğŸ»\u200dâ™€', 'ğŸ¦¶ğŸ¿', 'ğŸ‘¨ğŸ»\u200dğŸ¼', 'ğŸ“¦']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.79s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.08s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.97s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.39s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.97s/it]
Processing depth (0, 3, 5, 8):   2%|â–         | 2/100 [02:05<1:17:14, 47.29s/it]2025-01-22 18:53:00.189 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John got the football.
2025-01-22 18:53:00.229 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John moved to the kitchen.
2025-01-22 18:53:00.244 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2944, 2949) --> . John moved to the
2025-01-22 18:53:00.244 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the garden.
2025-01-22 18:53:00.268 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4203, 4208) -->  John travelled to the garden
2025-01-22 18:53:00.269 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the bathroom.
2025-01-22 18:53:00.301 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6669, 6674) --> . Mary moved to the
2025-01-22 18:53:00.302 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the kitchen.
2025-01-22 18:53:00.316 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2945, 2950) -->  John moved to the kitchen
2025-01-22 18:53:00.316 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the garden.
2025-01-22 18:53:00.326 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1858, 1863) --> . Daniel went to the
2025-01-22 18:53:00.326 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra journeyed to the bedroom.
2025-01-22 18:53:00.348 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4340, 4346) --> . Sandra journeyed to the
2025-01-22 18:53:00.348 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 18:53:00.349 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 18:53:00.349 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 18:53:00.349 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ’­', '\U0001faf7ğŸ½', 'ğŸ¤¸ğŸ½\u200dâ™‚', 'ğŸƒğŸ»\u200dâ™‚\u200dâ¡', 'ğŸ‡²ğŸ‡³', 'ğŸ§˜ğŸ»\u200dâ™‚', 'ğŸ‘©ğŸ¿\u200dğŸ¦¯\u200dâ¡ï¸', 'ğŸ‘©ğŸ¼\u200dğŸ¤', 'ğŸ§‘ğŸ¼\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ§‘ğŸ¾', 'ğŸ¦¹ğŸ¿\u200dâ™‚']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.16s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.34s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.43s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.06s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.53s/it]
Processing depth (0, 1, 2, 3):   2%|â–         | 2/100 [02:21<1:17:14, 47.29s/it]2025-01-22 18:53:16.200 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John got the football.
2025-01-22 18:53:16.244 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John moved to the kitchen.
2025-01-22 18:53:16.249 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (826, 831) --> . John moved to the
2025-01-22 18:53:16.249 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the garden.
2025-01-22 18:53:16.258 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1780, 1785) --> . John travelled to the
2025-01-22 18:53:16.258 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the bathroom.
2025-01-22 18:53:16.273 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2926, 2931) --> . Mary moved to the
2025-01-22 18:53:16.273 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the kitchen.
2025-01-22 18:53:16.277 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (827, 832) -->  John moved to the kitchen
2025-01-22 18:53:16.277 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the garden.
2025-01-22 18:53:16.286 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1783, 1788) -->  to the garden. Daniel
2025-01-22 18:53:16.286 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra journeyed to the bedroom.
2025-01-22 18:53:16.311 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4330, 4336) --> . Sandra journeyed to the
2025-01-22 18:53:16.311 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 18:53:16.311 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 18:53:16.311 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 18:53:16.311 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ‘³ğŸ»\u200dâ™€', 'ğŸ‡§ğŸ‡·', 'ğŸ§‘ğŸ½\u200dâ¤\u200dğŸ§‘ğŸ»', '\U0001fa76', 'ğŸƒğŸ¾\u200dâ™‚ï¸\u200dâ¡ï¸', 'ğŸš¶ğŸ¿\u200dâ™‚\u200dâ¡ï¸', 'ğŸ™…ğŸ½', 'ğŸ‘©ğŸ¾\u200dâœˆï¸', 'ğŸ‘©ğŸ»\u200dğŸ’»', 'ğŸ‘°ğŸ¼\u200dâ™‚']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.96s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.98s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.67s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.17s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.78s/it]
Processing depth (2, 6, 7, 8):   2%|â–         | 2/100 [02:38<1:17:14, 47.29s/it]2025-01-22 18:53:33.146 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John got the football.
2025-01-22 18:53:33.156 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2000, 2004) -->  John got the football
2025-01-22 18:53:33.156 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John moved to the kitchen.
2025-01-22 18:53:33.179 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4649, 4654) --> . John moved to the
2025-01-22 18:53:33.179 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the garden.
2025-01-22 18:53:33.206 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5583, 5588) --> . John travelled to the
2025-01-22 18:53:33.206 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the bathroom.
2025-01-22 18:53:33.238 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6533, 6538) --> . Mary moved to the
2025-01-22 18:53:33.238 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the kitchen.
2025-01-22 18:53:33.261 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4650, 4655) -->  John moved to the kitchen
2025-01-22 18:53:33.261 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the garden.
2025-01-22 18:53:33.271 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2003, 2008) -->  football. Daniel went to
2025-01-22 18:53:33.271 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra journeyed to the bedroom.
2025-01-22 18:53:33.292 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4271, 4277) -->  Sandra journeyed to the bedroom
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:53:34.134 | INFO     | test_jbb_embedding:begin_test:693 - John got the football.<|eot_id|>
2025-01-22 18:53:34.134 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8161])
2025-01-22 18:53:36.372 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [219.74671052631578, 21.249391382900537, 234.521484375, 20.365666133595766, 27.27632472826087], 'topk_indices': array([6029, 2002, 6022,   23, 1999, 6030, 8059,    9, 5894, 5886, 8157,
       2004,    1,   14,   24,    3, 8156, 8159, 2003,    0]), 'topk_tokens': [' true', ' the', 'this', '4', '.', ' to', ' location', ':', '-day', ' time', '<|start_header_id|>', '.', '<|start_header_id|>', '\n', '\n\n', '<|end_header_id|>', '<|eot_id|>', '<|end_header_id|>', ' football', '<|begin_of_text|>'], 'evidence_proportions': [692.125, 78.13125, 148.1, 55.10625]}, 'weight': {'score': [20.800575657894736, 23.264958966193042, 24.59423828125, 23.268102626399312, 28.99026268115942], 'topk_indices': array([3248, 3275, 3162, 3114, 7440, 7402, 1399, 1461, 4316, 4332, 5226,
       5165, 7123, 7179, 3455, 3481, 4942, 4990, 4967, 5019]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [25.654296875, 18.88125, 19.990625, 19.646875]}, 'saliency': {'score': [1.40673828125, 0.11780130553631032, 1.52923583984375, 0.11201058649491788, 0.19844010947407156], 'topk_indices': array([8130,   35,   23, 7739,   16,    8, 8158,   20, 2001, 8143, 2000,
       8015, 5886, 6022, 6029, 8059, 8148, 5894,   24, 2003]), 'topk_tokens': [' return', '-text', '4', 'inen', ' Date', ' Date', 'assistant', ' Jul', ' got', 'Question', ' John', ' context', ' time', 'this', ' true', ' location', ' football', '-day', '\n\n', ' football'], 'evidence_proportions': [4.796630859375, 0.3806640625, 0.8552734375, 0.27236328125]}}, 'pred_res': 'John got the football.<|eot_id|>', 'score': 0}
2025-01-22 18:53:36.378 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:53:36.379 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-120_pid-2_2-6-7-8.pkl | len: 3 |  size: 2.03 KB
Processing depth (2, 6, 7, 8):   3%|â–         | 3/100 [02:41<1:33:04, 57.57s/it]is_0k: False
your chose emoji: ['ğŸ‘¨ğŸ»\u200dğŸ«', 'ğŸƒğŸ¾\u200dâ™€ï¸\u200dâ¡', 'ğŸ™ğŸ¼', 'ğŸ', 'ğŸ•–', 'ğŸ‘©ğŸ¾\u200dğŸ¤\u200dğŸ‘¨ğŸ¼', 'ğŸ‘', 'ğŸ¤°ğŸ»', 'ğŸ…', 'ğŸ¤œğŸ¼']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.75s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.23s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.79s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.36s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.94s/it]
Processing depth (0, 3, 6, 7):   3%|â–         | 3/100 [02:58<1:33:04, 57.57s/it]2025-01-22 18:53:53.883 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John got the football.
2025-01-22 18:53:53.928 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John moved to the kitchen.
2025-01-22 18:53:53.945 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2738, 2743) --> . John moved to the
2025-01-22 18:53:53.945 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the garden.
2025-01-22 18:53:53.971 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4592, 4597) -->  John travelled to the garden
2025-01-22 18:53:53.971 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the bathroom.
2025-01-22 18:53:54.002 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5449, 5454) --> . Mary moved to the
2025-01-22 18:53:54.002 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the kitchen.
2025-01-22 18:53:54.018 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2739, 2744) -->  John moved to the kitchen
2025-01-22 18:53:54.019 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the garden.
2025-01-22 18:53:54.029 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1610, 1615) --> . Daniel went to the
2025-01-22 18:53:54.029 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra journeyed to the bedroom.
2025-01-22 18:53:54.055 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4174, 4180) --> . Sandra journeyed to the
2025-01-22 18:53:54.055 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 18:53:54.055 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 18:53:54.055 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 18:53:54.055 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ§†', '\U0001fac3', 'ğŸ‘¨ğŸ»\u200dğŸ«', 'ğŸ‘ƒğŸ¾', 'ğŸ‘œ', 'ğŸ§“ğŸ½', 'ğŸšµğŸ¼\u200dâ™€ï¸', 'ğŸš£ğŸ¾\u200dâ™‚', 'ğŸŒ¥', 'ğŸ‡ªğŸ‡º']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:05<00:15,  5.08s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.81s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.35s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.02s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.62s/it]
Processing depth (1, 3, 4, 7):   3%|â–         | 3/100 [03:15<1:33:04, 57.57s/it]2025-01-22 18:54:10.327 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John got the football.
2025-01-22 18:54:10.332 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (896, 900) -->  John got the football
2025-01-22 18:54:10.332 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John moved to the kitchen.
2025-01-22 18:54:10.347 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2833, 2838) -->  John moved to the kitchen
2025-01-22 18:54:10.347 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the garden.
2025-01-22 18:54:10.367 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3606, 3611) --> . John travelled to the
2025-01-22 18:54:10.367 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the bathroom.
2025-01-22 18:54:10.400 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5621, 5626) --> . Mary moved to the
2025-01-22 18:54:10.400 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the kitchen.
2025-01-22 18:54:10.414 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2834, 2839) -->  moved to the kitchen.
2025-01-22 18:54:10.414 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the garden.
2025-01-22 18:54:10.423 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1797, 1802) -->  Daniel went to the garden
2025-01-22 18:54:10.423 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra journeyed to the bedroom.
2025-01-22 18:54:10.444 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4261, 4267) -->  Sandra journeyed to the bedroom
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:54:11.262 | INFO     | test_jbb_embedding:begin_test:693 - John's house.<|eot_id|>
2025-01-22 18:54:11.262 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8167])
2025-01-22 18:54:13.514 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [461.07236842105266, 34.377229957160345, 311.859375, 32.83489167178857, 39.66205512152778], 'topk_indices': array([   9,  896, 8089, 8063,  895, 4934, 8081,   24, 8064, 4933, 8162,
         14,  900, 8055, 8065, 8093, 8165, 8163,  899,    0]), 'topk_tokens': [':', ' John', ' the', ' the', '.', ' to', '.\n', '\n\n', ' first', ' moved', '<|eot_id|>', '\n', '.', '.\n\n', ' location', ' moved', '<|end_header_id|>', '<|start_header_id|>', ' football', '<|begin_of_text|>'], 'evidence_proportions': [967.0, 493.45, 172.375, 312.65]}, 'weight': {'score': [22.060855263157894, 23.281529222766217, 23.3974609375, 23.284152197295636, 29.69184027777778], 'topk_indices': array([3317, 3290, 3210, 3162, 7400, 7438, 1478, 1416, 4314, 4330, 5131,
       5192, 7121, 7177, 3499, 3473, 4985, 4956, 4927, 4902]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [25.654296875, 23.6703125, 19.990625, 19.646875]}, 'saliency': {'score': [2.8048288445723686, 0.19094717896553703, 1.8859176635742188, 0.1815085459722649, 0.2887314690483941], 'topk_indices': array([  24, 8136, 2834, 8085, 8026, 8058, 8021, 8061, 8067,  897, 8059,
        896, 8154, 8055,  257, 8064, 4933, 8065, 8093,  899]), 'topk_tokens': ['\n\n', ' return', ' moved', ' left', ' locations', ' person', ' context', ' item', ' traveled', ' got', ' obtained', ' John', ' football', '.\n\n', 'hue', ' first', ' moved', ' location', ' moved', ' football'], 'evidence_proportions': [6.52099609375, 3.0380859375, 0.894873046875, 1.50859375]}}, 'pred_res': "John's house.<|eot_id|>", 'score': 0}
2025-01-22 18:54:13.521 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:54:13.522 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-120_pid-3_1-3-4-7.pkl | len: 3 |  size: 2.02 KB
Processing depth (1, 3, 4, 7):   4%|â–         | 4/100 [03:18<1:19:12, 49.51s/it]is_0k: False
your chose emoji: ['ğŸ§‘\u200dğŸ„', 'ğŸŒï¸\u200dâ™‚ï¸', 'ğŸ›Œ', 'ğŸª§', 'ğŸ§‘\u200dğŸ¦¯\u200dâ¡ï¸', 'ğŸ‘¨ğŸ»\u200dâš–ï¸', 'ğŸ‡®ğŸ‡³', 'ğŸ’‡ğŸ¼\u200dâ™‚', 'ğŸ’†ğŸ»', 'ğŸ§‘ğŸ»\u200dğŸ¤']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.76s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.07s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.89s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.35s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.93s/it]
Processing depth (3, 6, 7, 9):   4%|â–         | 4/100 [03:36<1:19:12, 49.51s/it]2025-01-22 18:54:31.056 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John got the football.
2025-01-22 18:54:31.070 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2828, 2832) -->  John got the football
2025-01-22 18:54:31.070 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John moved to the kitchen.
2025-01-22 18:54:31.094 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4715, 4720) --> . John moved to the
2025-01-22 18:54:31.094 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the garden.
2025-01-22 18:54:31.122 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5605, 5610) --> . John travelled to the
2025-01-22 18:54:31.123 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the bathroom.
2025-01-22 18:54:31.161 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7252, 7257) -->  cold. Mary moved to
2025-01-22 18:54:31.161 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the kitchen.
2025-01-22 18:54:31.187 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4716, 4721) -->  John moved to the kitchen
2025-01-22 18:54:31.187 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the garden.
2025-01-22 18:54:31.196 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1733, 1738) --> . Daniel went to the
2025-01-22 18:54:31.196 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra journeyed to the bedroom.
2025-01-22 18:54:31.218 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4249, 4255) -->  Sandra journeyed to the bedroom
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:54:32.051 | INFO     | test_jbb_embedding:begin_test:693 - John got the football.<|eot_id|>
2025-01-22 18:54:32.051 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8175])
2025-01-22 18:54:34.270 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [359.0600328947368, 30.569710656639764, 417.1171875, 29.043728125383765, 34.98709909539474], 'topk_indices': array([8156, 8164, 8160, 4717,    3, 8158, 1739, 8166, 2832,   24, 2831,
         14, 8165, 8073, 8162, 8163, 8173, 8170,    0, 8171]), 'topk_tokens': ['.\n\n', ' the', ' was', ' moved', '<|end_header_id|>', ':', '.', '?', '.', '\n\n', ' football', '\n', ' garden', ' location', ' football', ' before', '<|end_header_id|>', '<|eot_id|>', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [587.625, 473.05, 290.7, 130.578125]}, 'weight': {'score': [21.85855263157895, 23.289855404744436, 23.193359375, 23.29338465553236, 29.802425986842106], 'topk_indices': array([3284, 3311, 3156, 3204, 7412, 7374, 1493, 1431, 4318, 4302, 5137,
       5198, 7089, 7145, 3493, 3467, 4939, 4962, 4991, 4914]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [25.654296875, 18.88125, 19.990625, 23.6671875]}, 'saliency': {'score': [2.0661299856085527, 0.16961825159249663, 2.519256591796875, 0.1605763829458584, 0.2541266993472451], 'topk_indices': array([8101, 2829, 8072,   24, 8159, 8029,    0, 4720, 8168, 8166, 4254,
       5610, 1738, 8157, 4717, 8073, 2831, 8165, 8162, 8163]), 'topk_tokens': [' moved', ' got', ' first', '\n\n', ' Where', ' context', '<|begin_of_text|>', ' kitchen', 'Answer', '?', ' bedroom', ' garden', ' garden', 'Question', ' moved', ' location', ' football', ' garden', ' football', ' before'], 'evidence_proportions': [3.9462890625, 2.41689453125, 1.5287109375, 0.7486572265625]}}, 'pred_res': 'John got the football.<|eot_id|>', 'score': 0}
2025-01-22 18:54:34.276 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:54:34.277 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-120_pid-4_3-6-7-9.pkl | len: 3 |  size: 2.05 KB
Processing depth (3, 6, 7, 9):   5%|â–Œ         | 5/100 [03:39<1:01:58, 39.14s/it]Processing depth (3, 6, 7, 9):   5%|â–Œ         | 5/100 [03:39<1:09:28, 43.88s/it]
2025-01-22 18:54:34.367 | INFO     | __main__:<module>:82 - Selected idx: 122
2025-01-22 18:54:34.367 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the milk before the garden? 
2025-01-22 18:54:34.367 | INFO     | __main__:<module>:84 - Answer: office
2025-01-22 18:54:34.367 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 18:54:34.367 | INFO     | __main__:<module>:86 - Needle: [' Daniel picked up the milk.', ' Mary moved to the bathroom.', ' Sandra journeyed to the bedroom.', ' Sandra travelled to the bathroom.', ' Daniel travelled to the office.', ' Sandra got the apple.', ' John went back to the kitchen.', ' Sandra discarded the apple.', ' Mary went to the kitchen.', ' Daniel moved to the garden.', ' Sandra journeyed to the bedroom.']
2025-01-22 18:54:34.367 | INFO     | __main__:<module>:87 - Real Needle: [' Daniel picked up the milk.', ' Daniel travelled to the office.', ' Daniel moved to the garden.', ' Sandra journeyed to the bedroom.']
2025-01-22 18:54:34.367 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ‡¨ğŸ‡­', 'ğŸ‘©ğŸ»\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘¨ğŸ¿', '\U0001faf4ğŸ¼', 'â˜¯', 'ğŸ§ğŸ¿\u200dâ™€', 'ğŸ™‡ğŸ¾\u200dâ™‚ï¸', 'ğŸ‘±ğŸ¼\u200dâ™‚ï¸', 'ğŸš¶ğŸ¿\u200dâ™€', 'ğŸ•¹ï¸', 'ğŸ‚']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.86s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.11s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:15<00:05,  5.06s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  3.53s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  4.08s/it]
Processing depth (3, 4, 8, 9):   0%|          | 0/100 [00:18<?, ?it/s]2025-01-22 18:54:52.880 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the milk.
2025-01-22 18:54:52.897 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2968, 2973) --> . Daniel picked up the
2025-01-22 18:54:52.897 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel travelled to the office.
2025-01-22 18:54:52.917 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3649, 3654) -->  Hon. Daniel travelled to
2025-01-22 18:54:52.917 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the garden.
2025-01-22 18:54:52.953 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6578, 6583) --> . Daniel moved to the
2025-01-22 18:54:52.953 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra journeyed to the bedroom.
2025-01-22 18:54:52.995 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7169, 7175) -->  Sandra journeyed to the bedroom
2025-01-22 18:54:52.995 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bathroom.
2025-01-22 18:54:53.015 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3791, 3796) --> . Mary moved to the
2025-01-22 18:54:53.016 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra travelled to the bathroom.
2025-01-22 18:54:53.024 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1382, 1387) --> . Sandra travelled to the
2025-01-22 18:54:53.024 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra got the apple.
2025-01-22 18:54:53.029 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (960, 964) -->  Sandra got the apple
2025-01-22 18:54:53.029 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the kitchen.
2025-01-22 18:54:53.049 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3680, 3686) --> . John went back to the
2025-01-22 18:54:53.049 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra discarded the apple.
2025-01-22 18:54:53.076 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4834, 4838) -->  Sandra discarded the apple
2025-01-22 18:54:53.076 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary went to the kitchen.
2025-01-22 18:54:53.097 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (3683, 3688) -->  back to the kitchen.
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:54:53.875 | INFO     | test_jbb_embedding:begin_test:693 - the office<|eot_id|>
2025-01-22 18:54:53.875 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8229])
2025-01-22 18:54:56.109 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [342.0394345238095, 34.18657742072652, 154.53609913793105, 32.96972787556533, 23.79307263962766], 'topk_indices': array([2969,   23, 1387, 8083, 2968, 8127, 8211, 8212, 2973, 8117,   24,
          1, 3650, 8217, 2940, 8227,   14, 8225, 8224,    0]), 'topk_tokens': [' Daniel', '4', ' bathroom', ' context', '.', ' location', 'Question', ':', ' milk', '.\n\n', '\n\n', '<|start_header_id|>', '.', ' before', '.', '<|end_header_id|>', '\n', '<|start_header_id|>', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [606.85, 566.7, 212.825, 41.825520833333336]}, 'weight': {'score': [23.566964285714285, 23.309887923703073, 22.75377155172414, 23.311199349101578, 29.20994015957447], 'topk_indices': array([3308, 3335, 3228, 3180, 7498, 7460, 1472, 1410, 4344, 4328, 5241,
       5180, 7181, 7237, 3491, 3517, 4957, 5034, 5005, 4982]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.3625, 25.8265625, 19.909375, 25.735677083333332]}, 'saliency': {'score': [1.9748128255208333, 0.19181527675479892, 0.99591064453125, 0.18438810230306885, 0.17478066302360373], 'topk_indices': array([8198,   20,   24, 3655, 8117, 2939, 2970, 2941, 8216,  960, 3652,
       8219, 8083, 8222, 8127, 2969, 8217, 8211, 2973, 1387]), 'topk_tokens': [' return', ' Jul', '\n\n', ' office', '.\n\n', ' Gov', ' picked', ' During', ' milk', ' Sandra', ' travelled', ' garden', ' context', 'Answer', ' location', ' Daniel', ' before', 'Question', ' milk', ' bathroom'], 'evidence_proportions': [3.4533203125, 3.4287109375, 1.075390625, 0.2806599934895833]}}, 'pred_res': 'the office<|eot_id|>', 'score': 100}
2025-01-22 18:54:56.115 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:54:56.115 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-122_pid-0_3-4-8-9.pkl | len: 3 |  size: 2.03 KB
Processing depth (3, 4, 8, 9):   1%|          | 1/100 [00:21<35:44, 21.66s/it]is_0k: False
your chose emoji: ['ğŸ‡µğŸ‡³', 'ğŸ‘©ğŸ¾\u200dğŸ¤\u200dğŸ‘¨ğŸ»', 'ğŸ•¢', 'ğŸŒª', 'ğŸ§‘ğŸ¿\u200dâ¤\u200dğŸ§‘ğŸ¼', 'ğŸ¦¸ğŸ¼\u200dâ™€', 'ğŸ‘¨ğŸ½\u200dğŸ¦°', 'ğŸ‘¨ğŸ»\u200dâ¤ï¸\u200dğŸ‘¨ğŸ¿', 'ğŸ’ª', 'ğŸ‘¨ğŸ¾\u200dğŸ¦½\u200dâ¡ï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.04s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:09,  4.57s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.39s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.12s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.58s/it]
Processing depth (4, 5, 6, 9):   1%|          | 1/100 [00:37<35:44, 21.66s/it]2025-01-22 18:55:12.403 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the milk.
2025-01-22 18:55:12.424 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3524, 3529) --> . Daniel picked up the
2025-01-22 18:55:12.424 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel travelled to the office.
2025-01-22 18:55:12.444 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4139, 4144) --> . Daniel travelled to the
2025-01-22 18:55:12.444 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the garden.
2025-01-22 18:55:12.468 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4667, 4672) --> . Daniel moved to the
2025-01-22 18:55:12.468 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra journeyed to the bedroom.
2025-01-22 18:55:12.506 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7169, 7175) -->  Sandra journeyed to the bedroom
2025-01-22 18:55:12.506 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bathroom.
2025-01-22 18:55:12.526 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3635, 3640) --> . Mary moved to the
2025-01-22 18:55:12.526 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra travelled to the bathroom.
2025-01-22 18:55:12.533 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1261, 1266) -->  Republican. Sandra travelled to
2025-01-22 18:55:12.533 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra got the apple.
2025-01-22 18:55:12.538 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (932, 936) -->  Sandra got the apple
2025-01-22 18:55:12.538 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the kitchen.
2025-01-22 18:55:12.556 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3576, 3582) --> . John went back to the
2025-01-22 18:55:12.556 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra discarded the apple.
2025-01-22 18:55:12.588 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4774, 4778) -->  Sandra discarded the apple
2025-01-22 18:55:12.589 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary went to the kitchen.
2025-01-22 18:55:12.608 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (3579, 3584) -->  back to the kitchen.
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:55:13.423 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 18:55:13.423 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8207])
2025-01-22 18:55:15.790 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [354.1904761904762, 35.45278429163114, 391.1341594827586, 33.36818429035421, 19.822195030120483], 'topk_indices': array([8194, 3526, 8206,  935, 8195,    1, 3530,    3, 4141, 4144, 3525,
       3529,   24, 3582,   14, 8205, 1267, 8202,    0, 8203]), 'topk_tokens': [' milk', ' picked', '\n\n', ' apple', ' before', '<|start_header_id|>', '.', '<|end_header_id|>', ' travelled', ' office', ' Daniel', ' milk', '\n\n', ' kitchen', '\n', '<|end_header_id|>', ' bathroom', '<|eot_id|>', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [681.1, 621.55, 143.7875, 34.302083333333336]}, 'weight': {'score': [22.422247023809526, 23.29717573699598, 23.58917025862069, 23.2983898149283, 29.363140060240966], 'topk_indices': array([3333, 3306, 3226, 3178, 7460, 7498, 1452, 1514, 4370, 4354, 5237,
       5176, 7181, 7237, 3489, 3515, 4953, 4978, 5001, 5030]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.3625, 21.01875, 19.909375, 25.735677083333332]}, 'saliency': {'score': [2.0811971028645835, 0.19673695600864904, 2.365497457570043, 0.18417809859606724, 0.1457784262048193], 'topk_indices': array([8197, 8204, 3577,  932,   24, 8189, 8061, 8200, 8195, 4140, 8194,
       3526, 1264,  935, 4144, 3529, 3525, 4141, 3582, 1267]), 'topk_tokens': [' garden', 'assistant', ' John', ' Sandra', '\n\n', 'Question', ' context', 'Answer', ' before', ' Daniel', ' milk', ' picked', ' travelled', ' apple', ' office', ' milk', ' Daniel', ' travelled', ' kitchen', ' bathroom'], 'evidence_proportions': [4.0416015625, 3.6775390625, 0.737255859375, 0.23719278971354166]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 0}
2025-01-22 18:55:15.796 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:55:15.797 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-122_pid-1_4-5-6-9.pkl | len: 3 |  size: 2.08 KB
Processing depth (4, 5, 6, 9):   2%|â–         | 2/100 [00:41<33:28, 20.50s/it]is_0k: False
your chose emoji: ['ğŸ•¥', 'ğŸ«‚', 'ğŸ‘˜', 'ğŸ“»', 'ğŸ‘¨ğŸ¼\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘¨ğŸ»', 'ğŸ§‘ğŸ½\u200dğŸ¤\u200dğŸ§‘ğŸ¾', 'â›¹ğŸ½\u200dâ™‚', 'ğŸ‡¹ğŸ‡¼', 'ğŸ‘©ğŸ¼\u200dâ¤\u200dğŸ’‹\u200dğŸ‘©ğŸ¿', 'ğŸ¦½']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.55s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.80s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.67s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.21s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.75s/it]
Processing depth (2, 6, 7, 8):   2%|â–         | 2/100 [00:58<33:28, 20.50s/it]2025-01-22 18:55:33.026 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the milk.
2025-01-22 18:55:33.035 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1798, 1803) --> . Daniel picked up the
2025-01-22 18:55:33.035 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel travelled to the office.
2025-01-22 18:55:33.060 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4737, 4742) --> . Daniel travelled to the
2025-01-22 18:55:33.061 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the garden.
2025-01-22 18:55:33.091 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5662, 5667) --> . Daniel moved to the
2025-01-22 18:55:33.091 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra journeyed to the bedroom.
2025-01-22 18:55:33.124 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6644, 6650) --> . Sandra journeyed to the
2025-01-22 18:55:33.124 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bathroom.
2025-01-22 18:55:33.145 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3663, 3668) --> . Mary moved to the
2025-01-22 18:55:33.145 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra travelled to the bathroom.
2025-01-22 18:55:33.151 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1284, 1289) --> . Sandra travelled to the
2025-01-22 18:55:33.151 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra got the apple.
2025-01-22 18:55:33.156 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (960, 964) -->  Sandra got the apple
2025-01-22 18:55:33.156 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the kitchen.
2025-01-22 18:55:33.176 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3631, 3637) -->  Hon. John went back to
2025-01-22 18:55:33.176 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra discarded the apple.
2025-01-22 18:55:33.202 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4800, 4804) -->  Sandra discarded the apple
2025-01-22 18:55:33.202 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary went to the kitchen.
2025-01-22 18:55:33.223 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (3635, 3640) -->  back to the kitchen.
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:55:33.976 | INFO     | test_jbb_embedding:begin_test:693 - the office<|eot_id|>
2025-01-22 18:55:33.976 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8167])
2025-01-22 18:55:36.188 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [437.36011904761904, 39.950395550250946, 230.35452586206895, 38.24238668555241, 26.07781498015873], 'topk_indices': array([1289,    3,    1, 8055, 8155, 8163, 1798, 1800, 1695, 8165, 8065,
       8021, 1616, 4742,   14, 1803,   24, 1617, 8162,    0]), 'topk_tokens': [' bathroom', '<|end_header_id|>', '<|start_header_id|>', '.\n\n', ' before', '<|start_header_id|>', '.', ' picked', ' some', '<|end_header_id|>', ' location', ' context', ' some', ' office', '\n', ' milk', '\n\n', ' time', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [757.0, 572.9, 433.6, 61.177083333333336]}, 'weight': {'score': [21.130208333333332, 23.263725670216672, 23.58270474137931, 23.268104715790123, 29.1202876984127], 'topk_indices': array([3266, 3293, 3186, 3138, 7402, 7440, 1434, 1496, 4312, 4328, 5207,
       5146, 7179, 7123, 3475, 3449, 4923, 4971, 4948, 5000]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.3625, 21.01875, 19.909375, 21.213541666666668]}, 'saliency': {'score': [2.473179408482143, 0.22423466142964255, 1.4096974339978448, 0.21418339155741933, 0.1938452342199901], 'topk_indices': array([8157, 8149,   24, 1675, 5667, 8154, 8155, 8160, 7733, 4739, 1695,
       1799, 1616, 8065, 1800, 8021, 1289, 4742, 1617, 1803]), 'topk_tokens': [' garden', 'Question', '\n\n', 'Min', ' garden', ' milk', ' before', 'Answer', 'inen', ' travelled', ' some', ' Daniel', ' some', ' location', ' picked', ' context', ' bathroom', ' office', ' time', ' milk'], 'evidence_proportions': [4.41875, 3.2359375, 2.3125, 0.3501383463541667]}}, 'pred_res': 'the office<|eot_id|>', 'score': 100}
2025-01-22 18:55:36.195 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:55:36.195 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-122_pid-2_2-6-7-8.pkl | len: 3 |  size: 2.06 KB
Processing depth (2, 6, 7, 8):   3%|â–         | 3/100 [01:01<33:03, 20.45s/it]is_0k: False
your chose emoji: ['ğŸ¤', 'ğŸ—½', 'ğŸ‘¨ğŸ¼\u200dâš–ï¸', 'ğŸ§‘ğŸ»\u200dğŸ“', 'ğŸŒğŸ»\u200dâ™‚ï¸', 'ğŸ˜', 'ğŸ¤¸ğŸ¿\u200dâ™‚', 'ğŸ‡®ğŸ‡³', 'ğŸ¦®', 'ğŸš£ğŸ¿']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.33s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:10,  5.01s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.94s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.41s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.94s/it]
Processing depth (0, 1, 2, 3):   3%|â–         | 3/100 [01:19<33:03, 20.45s/it]2025-01-22 18:55:53.633 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the milk.
2025-01-22 18:55:53.634 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the milk.
2025-01-22 18:55:53.634 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel travelled to the office.
2025-01-22 18:55:53.638 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (901, 906) --> . Daniel travelled to the
2025-01-22 18:55:53.638 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the garden.
2025-01-22 18:55:53.647 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1800, 1805) --> . Daniel moved to the
2025-01-22 18:55:53.648 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra journeyed to the bedroom.
2025-01-22 18:55:53.663 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2934, 2940) --> . Sandra journeyed to the
2025-01-22 18:55:53.663 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bathroom.
2025-01-22 18:55:53.683 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3764, 3769) --> . Mary moved to the
2025-01-22 18:55:53.683 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra travelled to the bathroom.
2025-01-22 18:55:53.691 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1280, 1285) --> . Sandra travelled to the
2025-01-22 18:55:53.691 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra got the apple.
2025-01-22 18:55:53.700 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (913, 917) -->  got the apple.
2025-01-22 18:55:53.700 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the kitchen.
2025-01-22 18:55:53.723 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3653, 3659) --> . John went back to the
2025-01-22 18:55:53.723 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra discarded the apple.
2025-01-22 18:55:53.748 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4888, 4892) -->  discarded the apple.
2025-01-22 18:55:53.748 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary went to the kitchen.
2025-01-22 18:55:53.769 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (3656, 3661) -->  back to the kitchen.
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:55:54.647 | INFO     | test_jbb_embedding:begin_test:693 - Daniel picked up the milk.<|eot_id|>
2025-01-22 18:55:54.647 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8169])
2025-01-22 18:55:56.866 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [668.3854166666666, 64.6366264839065, 141.8480603448276, 62.79967830316463, 19.453903198242188], 'topk_indices': array([ 56,  39,  62,  52, 100,  57,  60,  63, 101, 102,  64, 103,  65,
       104,  69,  66,   0,  67, 105,  68]), 'topk_tokens': ['istributed', '\n\n\n', 'MIN', ' Gutenberg', 'MIN', ' Proof', '\n\n\n\n', 'ISC', 'ISC', 'ENCES', 'ENCES', ' OF', ' OF', ' P', 'ER', ' P', '<|begin_of_text|>', 'ION', 'ION', 'E'], 'evidence_proportions': [1484.6, 793.7, 429.0, 83.265625]}, 'weight': {'score': [21.04985119047619, 23.276932138049197, 20.677801724137932, 23.291972586504126, 29.858642578125], 'topk_indices': array([3275, 3302, 3195, 3147, 7422, 7460, 1488, 1426, 4313, 4329, 5196,
       5135, 7143, 7199, 3474, 3500, 4912, 4937, 4989, 4960]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.025, 21.01875, 19.909375, 21.213541666666668]}, 'saliency': {'score': [3.4980701264880953, 0.3705620248057153, 0.7821634226831896, 0.36100481378813415, 0.1399458646774292], 'topk_indices': array([ 41,  56,  62, 100,  60,  57, 103,  52,  63,   0, 102, 101,  65,
        64, 104,  69,  66,  68,  67, 105]), 'topk_tokens': ['-text', 'istributed', 'MIN', 'MIN', '\n\n\n\n', ' Proof', ' OF', ' Gutenberg', 'ISC', '<|begin_of_text|>', 'ENCES', 'ISC', ' OF', 'ENCES', ' P', 'ER', ' P', 'E', 'ION', 'ION'], 'evidence_proportions': [7.8578125, 4.0947265625, 2.18525390625, 0.4617513020833333]}}, 'pred_res': 'Daniel picked up the milk.<|eot_id|>', 'score': 0}
2025-01-22 18:55:56.873 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:55:56.873 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-122_pid-3_0-1-2-3.pkl | len: 3 |  size: 1.96 KB
Processing depth (0, 1, 2, 3):   4%|â–         | 4/100 [01:22<32:51, 20.54s/it]is_0k: False
your chose emoji: ['ğŸ˜…', 'ğŸ’‘ğŸ¼', 'ğŸ‹ğŸ¾\u200dâ™€ï¸', 'ğŸƒğŸ¼\u200dâ™€ï¸\u200dâ¡', 'â™¨', 'ğŸ', 'ğŸŠğŸ¼\u200dâ™€', 'ğŸ‘¨ğŸ¾\u200dğŸ”§', 'ğŸ‘¨ğŸ¾\u200dğŸ­', 'âŒš']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.08s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.32s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.49s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.20s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.62s/it]
Processing depth (0, 1, 3, 5):   4%|â–         | 4/100 [01:38<32:51, 20.54s/it]2025-01-22 18:56:13.108 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the milk.
2025-01-22 18:56:13.109 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the milk.
2025-01-22 18:56:13.109 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel travelled to the office.
2025-01-22 18:56:13.113 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (833, 838) --> . Daniel travelled to the
2025-01-22 18:56:13.113 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the garden.
2025-01-22 18:56:13.128 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2918, 2923) --> . Daniel moved to the
2025-01-22 18:56:13.128 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra journeyed to the bedroom.
2025-01-22 18:56:13.150 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4193, 4199) --> . Sandra journeyed to the
2025-01-22 18:56:13.150 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bathroom.
2025-01-22 18:56:13.168 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3689, 3694) --> . Mary moved to the
2025-01-22 18:56:13.168 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra travelled to the bathroom.
2025-01-22 18:56:13.175 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1294, 1299) --> . Sandra travelled to the
2025-01-22 18:56:13.175 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra got the apple.
2025-01-22 18:56:13.179 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (926, 930) -->  Sandra got the apple
2025-01-22 18:56:13.180 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the kitchen.
2025-01-22 18:56:13.198 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3657, 3663) -->  Hon. John went back to
2025-01-22 18:56:13.198 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra discarded the apple.
2025-01-22 18:56:13.222 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4819, 4823) -->  Sandra discarded the apple
2025-01-22 18:56:13.222 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary went to the kitchen.
2025-01-22 18:56:13.240 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (3661, 3666) -->  back to the kitchen.
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:56:14.129 | INFO     | test_jbb_embedding:begin_test:693 - Daniel picked up the milk.<|eot_id|>
2025-01-22 18:56:14.129 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8185])
2025-01-22 18:56:16.338 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [870.9077380952381, 108.0479571271528, 302.3243534482759, 105.38677107656385, 42.260715060763886], 'topk_indices': array([1071,   57,   60,  100, 1031, 1033,   63, 1072,  101,  102,   64,
        103,   65,  104,   69,   66,    0,   67,  105,   68]), 'topk_tokens': [' galaxy', ' Proof', '\n\n\n\n', 'MIN', ' galaxy', ' states', 'ISC', ' of', 'ISC', 'ENCES', 'ENCES', ' OF', ' OF', ' P', 'ER', ' P', '<|begin_of_text|>', 'ION', 'ION', 'E'], 'evidence_proportions': [1727.0, 1209.3, 565.55, 129.96875]}, 'weight': {'score': [21.04985119047619, 23.29465539880298, 23.58270474137931, 23.29942219952071, 30.13498263888889], 'topk_indices': array([3320, 3347, 3186, 3234, 7452, 7414, 1502, 1440, 4365, 4349, 5165,
       5226, 7181, 7125, 3529, 3503, 4990, 4942, 5019, 4967]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.025, 21.01875, 19.909375, 21.213541666666668]}, 'saliency': {'score': [4.556722005208333, 0.6177905902650543, 1.8527789938038792, 0.6032235233587702, 0.3229170905219184], 'topk_indices': array([  60, 1033,   57,  100, 1071,   52,   63,  103, 1031,    0,  102,
        101,   65,   64,  104,   69,   66,   68,   67,  105]), 'topk_tokens': ['\n\n\n\n', ' states', ' Proof', 'MIN', ' galaxy', ' Gutenberg', 'ISC', ' OF', ' galaxy', '<|begin_of_text|>', 'ENCES', 'ISC', ' OF', 'ENCES', ' P', 'ER', ' P', 'E', 'ION', 'ION'], 'evidence_proportions': [8.990625, 6.45390625, 2.7921875, 0.7512613932291666]}}, 'pred_res': 'Daniel picked up the milk.<|eot_id|>', 'score': 0}
2025-01-22 18:56:16.345 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:56:16.345 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-122_pid-4_0-1-3-5.pkl | len: 3 |  size: 1.96 KB
Processing depth (0, 1, 3, 5):   5%|â–Œ         | 5/100 [01:41<31:54, 20.16s/it]Processing depth (0, 1, 3, 5):   5%|â–Œ         | 5/100 [01:41<32:17, 20.39s/it]
2025-01-22 18:56:16.414 | INFO     | __main__:<module>:82 - Selected idx: 124
2025-01-22 18:56:16.414 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the apple before the garden? 
2025-01-22 18:56:16.414 | INFO     | __main__:<module>:84 - Answer: office
2025-01-22 18:56:16.414 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 18:56:16.414 | INFO     | __main__:<module>:86 - Needle: [' John went back to the kitchen.', ' Mary took the apple.', ' Mary went to the office.', ' Sandra journeyed to the bedroom.', ' Daniel went to the garden.', ' Daniel moved to the kitchen.', ' Mary went back to the garden.', ' Sandra got the apple.']
2025-01-22 18:56:16.414 | INFO     | __main__:<module>:87 - Real Needle: [' Mary took the apple.', ' Mary went to the office.', ' Mary went back to the garden.', ' Sandra got the apple.']
2025-01-22 18:56:16.414 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['\U0001fae4', 'ğŸ“»', 'ğŸ¤¹ğŸ»\u200dâ™€ï¸', 'ãŠ—ï¸', 'ğŸƒğŸ¾\u200dâ™‚', 'ğŸ™…ğŸ¿\u200dâ™€ï¸', 'ğŸš¶ğŸ»\u200dâ™€\u200dâ¡ï¸', 'ğŸ¤', 'ğŸ’\u200dâ™€ï¸', 'ğŸ§‘ğŸ¿\u200dâ¤\u200dğŸ§‘ğŸ½']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.70s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.44s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.01s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:12<00:00,  2.59s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:12<00:00,  3.22s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 3, 4, 6):   0%|          | 0/100 [00:14<?, ?it/s]2025-01-22 18:56:31.124 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary took the apple.
2025-01-22 18:56:31.166 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went to the office.
2025-01-22 18:56:31.184 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2894, 2899) --> . Mary went to the
2025-01-22 18:56:31.184 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the garden.
2025-01-22 18:56:31.203 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3579, 3585) --> . Mary went back to the
2025-01-22 18:56:31.203 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra got the apple.
2025-01-22 18:56:31.226 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4728, 4732) -->  Sandra got the apple
2025-01-22 18:56:31.227 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the kitchen.
2025-01-22 18:56:31.248 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3684, 3690) --> . John went back to the
2025-01-22 18:56:31.249 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra journeyed to the bedroom.
2025-01-22 18:56:31.267 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3133, 3139) -->  ranks. Sandra journeyed to
2025-01-22 18:56:31.267 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the garden.
2025-01-22 18:56:31.287 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3582, 3587) -->  back to the garden.
2025-01-22 18:56:31.287 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel moved to the kitchen.
2025-01-22 18:56:31.312 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4921, 4926) -->  Daniel moved to the kitchen
2025-01-22 18:56:31.312 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 18:56:31.312 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 18:56:31.312 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 18:56:31.313 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ§‘ğŸ¿\u200dğŸ¤\u200dğŸ§‘ğŸ½', 'ğŸ‘‚ğŸ½', 'ğŸš¶ğŸ¿\u200dâ™€ï¸\u200dâ¡ï¸', 'ğŸ‡¬ğŸ‡ª', 'ğŸŸ£', 'ğŸ', 'ğŸ¤¾ğŸ¿\u200dâ™€', 'ğŸ§‘ğŸ»\u200dğŸ’»', 'ğŸ«', 'ğŸ§–ğŸ½\u200dâ™€']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.97s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.10s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.70s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.29s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.88s/it]
Processing depth (2, 4, 5, 9):   0%|          | 0/100 [00:31<?, ?it/s]2025-01-22 18:56:48.546 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary took the apple.
2025-01-22 18:56:48.556 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1744, 1748) -->  Mary took the apple
2025-01-22 18:56:48.556 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went to the office.
2025-01-22 18:56:48.576 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3571, 3576) --> . Mary went to the
2025-01-22 18:56:48.576 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the garden.
2025-01-22 18:56:48.600 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4152, 4158) --> . Mary went back to the
2025-01-22 18:56:48.600 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra got the apple.
2025-01-22 18:56:48.640 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7127, 7131) -->  got the apple.
2025-01-22 18:56:48.640 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the kitchen.
2025-01-22 18:56:48.659 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3670, 3676) -->  John went back to the kitchen
2025-01-22 18:56:48.659 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra journeyed to the bedroom.
2025-01-22 18:56:48.675 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3023, 3029) -->  tragedy. Sandra journeyed to
2025-01-22 18:56:48.675 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the garden.
2025-01-22 18:56:48.695 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4155, 4160) -->  back to the garden.
2025-01-22 18:56:48.695 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel moved to the kitchen.
2025-01-22 18:56:48.723 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4903, 4908) --> . Daniel moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:56:49.519 | INFO     | test_jbb_embedding:begin_test:693 - Mary's.<|eot_id|>
2025-01-22 18:56:49.519 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8176])
2025-01-22 18:56:51.744 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [820.8881578947369, 72.00719919295672, 468.875, 69.18554135430749, 58.90239726027397], 'topk_indices': array([7129, 7130, 8161, 8071, 8064,   24, 8104, 8163, 8070, 8167,   14,
       1747, 1748, 8074, 8166, 8174, 8164, 8172, 8171,    0]), 'topk_tokens': [' apple', '.', ' was', ' in', '.\n\n', '\n\n', ' the', ' apple', ' item', '?', '\n', ' apple', '.', ' location', ' garden', '<|end_header_id|>', ' before', '<|start_header_id|>', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [1295.25, 675.95, 360.7708333333333, 1217.875]}, 'weight': {'score': [21.500411184210527, 23.276653063096113, 22.475852272727273, 23.282965735221826, 29.32298801369863], 'topk_indices': array([3334, 3307, 3179, 3227, 7453, 7415, 1441, 1503, 4324, 4340, 5173,
       5234, 7192, 7136, 3490, 3516, 5007, 4930, 4978, 4955]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.240234375, 19.403125, 20.708333333333332, 20.5703125]}, 'saliency': {'score': [4.682334498355263, 0.40191314540535583, 2.7525745738636362, 0.3855628250007681, 0.4310486675941781], 'topk_indices': array([1744, 8145, 8161, 8064, 7126, 8073, 8158, 8160, 3576, 8167, 3030,
       3025, 8068, 7129, 8070, 8163, 8074, 8164, 1747, 8166]), 'topk_tokens': [' Mary', ' return', ' was', '.\n\n', ' Sandra', ' first', 'Question', ' Where', ' office', '?', ' bedroom', ' Sandra', ' obtained', ' apple', ' item', ' apple', ' location', ' before', ' apple', ' garden'], 'evidence_proportions': [8.86865234375, 3.4630859375, 1.8233235677083333, 6.30859375]}}, 'pred_res': "Mary's.<|eot_id|>", 'score': 0}
2025-01-22 18:56:51.751 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:56:51.751 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-124_pid-0_2-4-5-9.pkl | len: 3 |  size: 2.01 KB
Processing depth (2, 4, 5, 9):   1%|          | 1/100 [00:35<58:06, 35.22s/it]is_0k: False
your chose emoji: ['ğŸ§ğŸ½\u200dâ¡', 'ğŸ‘©ğŸ¿\u200dğŸ’»', 'ğŸ™‡ğŸ½\u200dâ™€', 'ğŸš´ğŸ½\u200dâ™‚', 'ğŸŒ½', 'ğŸ™\u200dâ™€ï¸', 'ğŸ§‘ğŸ»\u200dğŸ¦²', 'ğŸš±', '\U0001faf7ğŸ½', 'ğŸ‘©ğŸ¾\u200dğŸ¦¼']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.48s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.43s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.53s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.16s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.65s/it]
Processing depth (1, 2, 6, 7):   1%|          | 1/100 [00:51<58:06, 35.22s/it]2025-01-22 18:57:08.291 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary took the apple.
2025-01-22 18:57:08.295 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (816, 820) -->  Mary took the apple
2025-01-22 18:57:08.296 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went to the office.
2025-01-22 18:57:08.305 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1786, 1791) --> . Mary went to the
2025-01-22 18:57:08.305 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the garden.
2025-01-22 18:57:08.332 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4752, 4758) -->  the senate. Mary went back
2025-01-22 18:57:08.332 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra got the apple.
2025-01-22 18:57:08.364 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5633, 5637) -->  got the apple.
2025-01-22 18:57:08.364 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the kitchen.
2025-01-22 18:57:08.387 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3739, 3745) --> . John went back to the
2025-01-22 18:57:08.387 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra journeyed to the bedroom.
2025-01-22 18:57:08.403 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3072, 3078) --> . Sandra journeyed to the
2025-01-22 18:57:08.403 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the garden.
2025-01-22 18:57:08.427 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4757, 4762) -->  back to the garden.
2025-01-22 18:57:08.427 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel moved to the kitchen.
2025-01-22 18:57:08.451 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4967, 4972) --> . Daniel moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:57:09.301 | INFO     | test_jbb_embedding:begin_test:693 - Mary took the apple.<|eot_id|>
2025-01-22 18:57:09.301 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8180])
2025-01-22 18:57:11.523 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [458.4917763157895, 39.33536268638475, 175.6505681818182, 37.988733724358184, 32.583125], 'topk_indices': array([1790, 8077, 4725, 4752, 8106,   23, 8094,    3,    1,  820, 8068,
       8107, 8078,  819,   14,   24, 8175, 8108, 8178,    0]), 'topk_tokens': [' the', ' first', ' senate', ' the', ' moved', '4', '.\n', '<|end_header_id|>', '<|start_header_id|>', '.', '.\n\n', ' to', ' location', ' apple', '\n', '\n\n', '<|eot_id|>', ' the', '<|end_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [783.875, 576.85, 215.515625, 349.625]}, 'weight': {'score': [22.744654605263158, 23.274669243461258, 20.06747159090909, 23.284573263419727, 29.053541666666668], 'topk_indices': array([3273, 3300, 3193, 3145, 7431, 7393, 1422, 1484, 4285, 4301, 5109,
       5170, 7148, 7092, 3482, 3456, 4957, 4905, 4928, 4880]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.240234375, 19.403125, 24.6484375, 20.5703125]}, 'saliency': {'score': [2.5493228310032894, 0.21675172897633524, 0.9507002397017046, 0.20932442051613745, 0.229200439453125], 'topk_indices': array([1787,  817, 8107, 4664, 8080, 8074,   16, 1788, 8072, 8034, 8068,
       8108,  816, 8077,    0, 8106,   24, 4725, 8078,  819]), 'topk_tokens': [' Mary', ' took', ' to', 'Penn', ' traveled', ' item', ' Date', ' went', ' obtained', ' context', '.\n\n', ' the', ' Mary', ' first', '<|begin_of_text|>', ' moved', '\n\n', ' senate', ' location', ' apple'], 'evidence_proportions': [5.32080078125, 2.8361328125, 0.95989990234375, 1.803466796875]}}, 'pred_res': 'Mary took the apple.<|eot_id|>', 'score': 0}
2025-01-22 18:57:11.530 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:57:11.530 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-124_pid-1_1-2-6-7.pkl | len: 3 |  size: 2.03 KB
Processing depth (1, 2, 6, 7):   2%|â–         | 2/100 [00:54<42:41, 26.14s/it]is_0k: False
your chose emoji: ['ğŸ‘©ğŸ¾\u200dâš–ï¸', 'ğŸ‘©ğŸ¾\u200dğŸ¦¯\u200dâ¡', 'ğŸ‘¶ğŸ»', 'ğŸ§', 'ğŸƒğŸ»\u200dâ¡ï¸', 'ğŸš–', 'ğŸ‘¨ğŸ¾\u200dğŸ¦¼\u200dâ¡', 'âš ', 'ğŸ¤¼', 'ğŸ‘¨ğŸ»\u200dğŸ“']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.33s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.70s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.65s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.25s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.75s/it]
Processing depth (1, 2, 5, 9):   2%|â–         | 2/100 [01:11<42:41, 26.14s/it]2025-01-22 18:57:28.243 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary took the apple.
2025-01-22 18:57:28.248 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (802, 806) -->  Mary took the apple
2025-01-22 18:57:28.248 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went to the office.
2025-01-22 18:57:28.259 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1769, 1774) -->  Mary went to the office
2025-01-22 18:57:28.259 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the garden.
2025-01-22 18:57:28.284 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4249, 4255) -->  Mary went back to the garden
2025-01-22 18:57:28.284 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra got the apple.
2025-01-22 18:57:28.319 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7167, 7171) -->  got the apple.
2025-01-22 18:57:28.319 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the kitchen.
2025-01-22 18:57:28.339 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3799, 3805) --> . John went back to the
2025-01-22 18:57:28.340 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra journeyed to the bedroom.
2025-01-22 18:57:28.359 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3132, 3138) --> . Sandra journeyed to the
2025-01-22 18:57:28.359 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the garden.
2025-01-22 18:57:28.380 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4251, 4256) -->  back to the garden.
2025-01-22 18:57:28.380 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel moved to the kitchen.
2025-01-22 18:57:28.405 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5014, 5019) -->  Daniel moved to the kitchen
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:57:29.261 | INFO     | test_jbb_embedding:begin_test:693 - Mary took the apple.<|eot_id|>
2025-01-22 18:57:29.261 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8214])
2025-01-22 18:57:31.498 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [422.3092105263158, 33.76386015092503, 180.17897727272728, 32.466796636085625, 40.67747961956522], 'topk_indices': array([8213, 8202, 8068,    9, 8201,  804, 8102,    4, 8112,   23,    3,
        806, 8210,    1,   14,  805,   24, 8212, 8209,    0]), 'topk_tokens': ['\n\n', ' before', ' context', ':', ' apple', ' the', '.\n\n', '\n\n', ' location', '4', '<|end_header_id|>', '.', '<|start_header_id|>', '<|start_header_id|>', '\n', ' apple', '\n\n', '<|end_header_id|>', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [789.1875, 412.45, 247.45833333333334, 330.03125]}, 'weight': {'score': [23.744654605263158, 23.323362950340798, 21.155894886363637, 23.328216743119267, 30.159986413043477], 'topk_indices': array([3360, 3333, 3205, 3253, 7493, 7455, 1454, 1516, 4326, 4342, 5238,
       5177, 7232, 7176, 3516, 3542, 4962, 4939, 4991, 4914]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.240234375, 23.4171875, 24.470052083333332, 20.5703125]}, 'saliency': {'score': [2.5940326891447367, 0.18863250821567673, 0.9886807528409091, 0.18088894065366973, 0.29903196251910663], 'topk_indices': array([8183,   20, 8211,    8,   15,   23, 4265,  802, 4262, 1773, 8204,
          0, 8202,  803,   16, 8068, 8112, 8201,   24,  805]), 'topk_tokens': [' return', ' Jul', 'assistant', ' Date', 'Today', '4', 'outs', ' Mary', 'ree', ' office', ' garden', '<|begin_of_text|>', ' before', ' took', ' Date', ' context', ' location', ' apple', '\n\n', ' apple'], 'evidence_proportions': [5.35498046875, 2.418359375, 1.49853515625, 1.6959228515625]}}, 'pred_res': 'Mary took the apple.<|eot_id|>', 'score': 0}
2025-01-22 18:57:31.521 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:57:31.521 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-124_pid-2_1-2-5-9.pkl | len: 3 |  size: 2.04 KB
Processing depth (1, 2, 5, 9):   3%|â–         | 3/100 [01:14<37:43, 23.33s/it]is_0k: False
your chose emoji: ['â›¹ï¸\u200dâ™€ï¸', 'ğŸ§›ğŸ¿', 'ğŸ§‘ğŸ»\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ§‘ğŸ¿', 'ğŸ‘©ğŸ¾\u200dâ¤\u200dğŸ’‹\u200dğŸ‘©ğŸ¾', 'ğŸ‡§ğŸ‡¦', 'ğŸ¤', 'ğŸ’', 'ğŸ§‘ğŸ½\u200dğŸ¦¼\u200dâ¡ï¸', 'ğŸ’ğŸ½\u200dâ™€ï¸', 'ğŸš¶\u200dâ™€\u200dâ¡ï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.06s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.76s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.42s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.86s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.45s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 3, 7, 9):   3%|â–         | 3/100 [01:30<37:43, 23.33s/it]2025-01-22 18:57:47.051 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary took the apple.
2025-01-22 18:57:47.093 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went to the office.
2025-01-22 18:57:47.107 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2888, 2893) --> . Mary went to the
2025-01-22 18:57:47.107 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the garden.
2025-01-22 18:57:47.140 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5718, 5724) --> . Mary went back to the
2025-01-22 18:57:47.140 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra got the apple.
2025-01-22 18:57:47.179 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7214, 7218) -->  Sandra got the apple
2025-01-22 18:57:47.179 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the kitchen.
2025-01-22 18:57:47.202 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3763, 3769) --> . John went back to the
2025-01-22 18:57:47.202 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra journeyed to the bedroom.
2025-01-22 18:57:47.221 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3096, 3102) --> . Sandra journeyed to the
2025-01-22 18:57:47.221 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the garden.
2025-01-22 18:57:47.255 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5721, 5726) -->  back to the garden.
2025-01-22 18:57:47.256 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel moved to the kitchen.
2025-01-22 18:57:47.285 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4970, 4975) --> . Daniel moved to the
2025-01-22 18:57:47.286 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 18:57:47.286 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 18:57:47.286 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 18:57:47.286 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸŒï¸\u200dâ™€', '\U0001faf3ğŸ¼', 'ğŸ§¹', 'ğŸ¢', 'ğŸŠ\u200dâ™€ï¸', 'ğŸ‘©ğŸ»\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘©ğŸ½', 'ğŸ˜…', 'ğŸ‘¨ğŸ½\u200dâ¤\u200dğŸ‘¨ğŸ½', 'ğŸ‘·ğŸ¼', 'ğŸƒ\u200dâ™€']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.19s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.71s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.88s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.38s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.86s/it]
Processing depth (0, 3, 4, 5):   3%|â–         | 3/100 [01:47<37:43, 23.33s/it]2025-01-22 18:58:04.449 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary took the apple.
2025-01-22 18:58:04.494 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went to the office.
2025-01-22 18:58:04.510 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2892, 2897) --> . Mary went to the
2025-01-22 18:58:04.511 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the garden.
2025-01-22 18:58:04.529 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3589, 3595) --> . Mary went back to the
2025-01-22 18:58:04.529 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra got the apple.
2025-01-22 18:58:04.556 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4166, 4170) -->  Sandra got the apple
2025-01-22 18:58:04.557 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the kitchen.
2025-01-22 18:58:04.575 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3694, 3700) --> . John went back to the
2025-01-22 18:58:04.575 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra journeyed to the bedroom.
2025-01-22 18:58:04.600 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3112, 3118) --> . Sandra journeyed to the
2025-01-22 18:58:04.600 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the garden.
2025-01-22 18:58:04.619 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3592, 3597) -->  back to the garden.
2025-01-22 18:58:04.619 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel moved to the kitchen.
2025-01-22 18:58:04.647 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4952, 4957) --> . Daniel moved to the
2025-01-22 18:58:04.647 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 18:58:04.647 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 18:58:04.647 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 18:58:04.647 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ‘©ğŸ¾\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘¨ğŸ»', 'ğŸ‘·ğŸ¿\u200dâ™‚ï¸', 'ğŸ––ğŸ¼', '\U0001faf3ğŸ½', 'ğŸ¤¼\u200dâ™‚', 'ğŸ§ğŸ¿\u200dâ™‚ï¸', 'ğŸ‹ğŸ¼\u200dâ™‚', 'ğŸ™ğŸ½', 'ğŸ§‘ğŸ½\u200dâ¤\u200dğŸ’‹\u200dğŸ§‘ğŸ¿', 'ğŸ§‘ğŸ½\u200dâš•ï¸']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.31s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.47s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.58s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.16s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.65s/it]
Processing depth (2, 3, 5, 7):   3%|â–         | 3/100 [02:04<37:43, 23.33s/it]2025-01-22 18:58:21.269 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary took the apple.
2025-01-22 18:58:21.278 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1726, 1730) -->  Mary took the apple
2025-01-22 18:58:21.278 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went to the office.
2025-01-22 18:58:21.292 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2864, 2869) --> . Mary went to the
2025-01-22 18:58:21.292 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the garden.
2025-01-22 18:58:21.317 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4189, 4195) -->  Mary went back to the garden
2025-01-22 18:58:21.318 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra got the apple.
2025-01-22 18:58:21.345 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5622, 5626) -->  Sandra got the apple
2025-01-22 18:58:21.345 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the kitchen.
2025-01-22 18:58:21.364 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3739, 3745) --> . John went back to the
2025-01-22 18:58:21.365 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra journeyed to the bedroom.
2025-01-22 18:58:21.380 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3103, 3109) -->  ranks. Sandra journeyed to
2025-01-22 18:58:21.381 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the garden.
2025-01-22 18:58:21.404 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4191, 4196) -->  back to the garden.
2025-01-22 18:58:21.404 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel moved to the kitchen.
2025-01-22 18:58:21.430 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4957, 4962) --> . Daniel moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:58:22.172 | INFO     | test_jbb_embedding:begin_test:693 - Mary<|eot_id|>
2025-01-22 18:58:22.172 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8150])
2025-01-22 18:58:24.383 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [391.07894736842104, 36.50886285574092, 211.14488636363637, 35.20460639871779, 46.305013020833336], 'topk_indices': array([8004, 8135, 8133,   23, 8038, 8141, 8078, 8048, 8140,    1, 1730,
       8137, 1729,   14, 8138,   24, 8148,    0, 8145, 8146]), 'topk_tokens': [' context', ' was', ':', '4', '.\n\n', '?', ' the', ' location', ' garden', '<|start_header_id|>', '.', ' apple', ' apple', '\n', ' before', '\n\n', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [674.875, 217.925, 244.3125, 543.875]}, 'weight': {'score': [24.27261513157895, 23.259656372669284, 21.161576704545453, 23.262974278757245, 29.47421875], 'topk_indices': array([3267, 3294, 3139, 3187, 7409, 7371, 1485, 1423, 4282, 4266, 5166,
       5105, 7056, 7112, 3450, 3476, 4870, 4947, 4895, 4918]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.240234375, 19.403125, 24.470052083333332, 28.095703125]}, 'saliency': {'score': [2.5139288651315788, 0.20202126095877546, 1.1840487393465908, 0.193942004516436, 0.3468226114908854], 'topk_indices': array([8147, 8076, 8143,   20, 8119, 8038, 8141,   16, 8134, 5622, 8132,
       5625, 8004,    0, 8048,   24, 8140, 8138, 8137, 1729]), 'topk_tokens': ['assistant', ' moved', 'Answer', ' Jul', ' return', '.\n\n', '?', ' Date', ' Where', ' Sandra', 'Question', ' apple', ' context', '<|begin_of_text|>', ' location', '\n\n', ' garden', ' before', ' apple', ' apple'], 'evidence_proportions': [4.51611328125, 1.1109375, 1.5182291666666667, 3.759033203125]}}, 'pred_res': 'Mary<|eot_id|>', 'score': 0}
2025-01-22 18:58:24.390 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:58:24.390 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-124_pid-3_2-3-5-7.pkl | len: 3 |  size: 2.03 KB
Processing depth (2, 3, 5, 7):   4%|â–         | 4/100 [02:07<55:59, 34.99s/it]is_0k: False
your chose emoji: ['ğŸ±', 'ğŸ“¸', 'ğŸ’¤', 'ğŸ™…ğŸ¿', 'ğŸ“„', 'ğŸ’†ğŸ»\u200dâ™‚', 'ğŸ”©', 'ğŸ‘¨ğŸ¼\u200dâ¤\u200dğŸ‘¨ğŸ½', 'ğŸ¤¹\u200dâ™‚ï¸', 'ğŸ§œğŸ¾\u200dâ™‚ï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.20s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.73s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.61s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.24s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.73s/it]
Processing depth (3, 5, 7, 9):   4%|â–         | 4/100 [02:24<55:59, 34.99s/it]2025-01-22 18:58:41.101 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary took the apple.
2025-01-22 18:58:41.118 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2896, 2900) -->  Mary took the apple
2025-01-22 18:58:41.119 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went to the office.
2025-01-22 18:58:41.144 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4237, 4242) -->  Mary went to the office
2025-01-22 18:58:41.144 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the garden.
2025-01-22 18:58:41.175 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5596, 5602) --> . Mary went back to the
2025-01-22 18:58:41.175 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra got the apple.
2025-01-22 18:58:41.213 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7139, 7143) -->  got the apple.
2025-01-22 18:58:41.213 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the kitchen.
2025-01-22 18:58:41.233 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3807, 3813) --> . John went back to the
2025-01-22 18:58:41.233 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra journeyed to the bedroom.
2025-01-22 18:58:41.251 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3133, 3139) -->  ranks. Sandra journeyed to
2025-01-22 18:58:41.251 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the garden.
2025-01-22 18:58:41.281 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5599, 5604) -->  back to the garden.
2025-01-22 18:58:41.281 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel moved to the kitchen.
2025-01-22 18:58:41.309 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4922, 4927) --> . Daniel moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:58:42.056 | INFO     | test_jbb_embedding:begin_test:693 - Mary<|eot_id|>
2025-01-22 18:58:42.056 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8188])
2025-01-22 18:58:44.282 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [1611.0526315789473, 112.20447191697191, 657.2045454545455, 107.2384495030065, 76.58929984177215], 'topk_indices': array([8086, 7331, 7574, 2900, 8116, 7664, 5595, 5536, 7379, 5535, 4350,
       5596, 7572, 8183, 7528, 7380, 8184, 7573,    0, 5597]), 'topk_tokens': [' location', 'nes', 'ot', '.', ' the', 'ot', ' St', ' One', ' Min', '.', ' composing', '.', ' Min', '<|eot_id|>', 'nes', 'nes', '<|start_header_id|>', 'nes', '<|begin_of_text|>', ' Mary'], 'evidence_proportions': [1348.625, 1195.2, 2189.0833333333335, 1526.25]}, 'weight': {'score': [22.55674342105263, 23.296932234432234, 21.161576704545453, 23.304422896981226, 29.914952531645568], 'topk_indices': array([3297, 3324, 3217, 3169, 7465, 7427, 1517, 1455, 4323, 4307, 5172,
       5233, 7148, 7204, 3506, 3480, 5026, 4974, 4997, 4949]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.240234375, 23.4171875, 20.708333333333332, 20.5703125]}, 'saliency': {'score': [9.840357730263158, 0.6353444081959707, 3.6224476207386362, 0.6058178989561602, 0.5646261867088608], 'topk_indices': array([8176, 7663, 7574, 2899, 7141, 8175, 7664, 8086, 7302, 7527, 5536,
       7331, 5595, 7379, 4350, 7572, 7528, 7380, 7573, 5597]), 'topk_tokens': [' before', 'nes', 'ot', ' apple', ' apple', ' apple', 'ot', ' location', 'nes', ' Min', ' One', 'nes', ' St', ' Min', ' composing', ' Min', 'nes', 'nes', 'nes', ' Mary'], 'evidence_proportions': [9.2109375, 7.835546875, 13.229817708333334, 7.8916015625]}}, 'pred_res': 'Mary<|eot_id|>', 'score': 0}
2025-01-22 18:58:44.289 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:58:44.289 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-124_pid-4_3-5-7-9.pkl | len: 3 |  size: 1.95 KB
Processing depth (3, 5, 7, 9):   5%|â–Œ         | 5/100 [02:27<46:47, 29.55s/it]Processing depth (3, 5, 7, 9):   5%|â–Œ         | 5/100 [02:27<46:48, 29.56s/it]
2025-01-22 18:58:44.356 | INFO     | __main__:<module>:82 - Selected idx: 126
2025-01-22 18:58:44.356 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the apple before the hallway? 
2025-01-22 18:58:44.356 | INFO     | __main__:<module>:84 - Answer: office
2025-01-22 18:58:44.356 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 18:58:44.356 | INFO     | __main__:<module>:86 - Needle: [' Daniel moved to the kitchen.', ' Daniel went to the garden.', ' John went back to the kitchen.', ' Mary picked up the apple.', ' Sandra journeyed to the bedroom.', ' Mary travelled to the office.', ' Mary travelled to the hallway.', ' Sandra travelled to the bathroom.']
2025-01-22 18:58:44.356 | INFO     | __main__:<module>:87 - Real Needle: [' Mary picked up the apple.', ' Mary travelled to the office.', ' Mary travelled to the hallway.', ' Sandra travelled to the bathroom.']
2025-01-22 18:58:44.356 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ‘©ğŸ¾\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘¨ğŸ¼', 'ğŸŒ¥', 'ğŸ‡¨ğŸ‡¦', 'ğŸ¤µğŸ½\u200dâ™€ï¸', 'ğŸ˜º', 'ğŸ§‘ğŸ»\u200dğŸ¦¯\u200dâ¡', 'ğŸ˜µ\u200dğŸ’«', 'ğŸ§', 'ğŸ¦¸ğŸ¿\u200dâ™‚', 'ğŸ‘©\u200dâ¤ï¸\u200dğŸ‘¨']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.20s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.38s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.43s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.13s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.59s/it]
Processing depth (1, 2, 4, 5):   0%|          | 0/100 [00:15<?, ?it/s]2025-01-22 18:59:00.455 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 18:59:00.460 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (828, 833) --> . Mary picked up the
2025-01-22 18:59:00.460 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the office.
2025-01-22 18:59:00.470 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1746, 1751) --> . Mary travelled to the
2025-01-22 18:59:00.470 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary travelled to the hallway.
2025-01-22 18:59:00.481 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1746, 1751) --> . Mary travelled to the
2025-01-22 18:59:00.481 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra travelled to the bathroom.
2025-01-22 18:59:00.513 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4220, 4225) -->  Sandra travelled to the bathroom
2025-01-22 18:59:00.514 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the kitchen.
2025-01-22 18:59:00.528 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2902, 2907) --> . Daniel moved to the
2025-01-22 18:59:00.528 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the garden.
2025-01-22 18:59:00.543 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2230, 2235) --> . Daniel went to the
2025-01-22 18:59:00.543 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the kitchen.
2025-01-22 18:59:00.545 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (297, 303) --> . John went back to the
2025-01-22 18:59:00.545 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra journeyed to the bedroom.
2025-01-22 18:59:00.566 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3770, 3776) --> . Sandra journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:59:01.346 | INFO     | test_jbb_embedding:begin_test:693 - the kitchen<|eot_id|>
2025-01-22 18:59:01.346 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8151])
2025-01-22 18:59:03.558 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [513.78125, 48.35247378265669, 364.70454545454544, 46.34676288373814, 41.57138671875], 'topk_indices': array([ 297,   14, 7609, 7610,  257, 7568,  275,  298,  274, 8149, 8147,
        303,  299, 7597, 8146, 7553, 7567, 7611,    0, 7612]), 'topk_tokens': ['.', '\n', ' of', ' the', 'hue', 'ot', ' If', ' John', '.', '<|end_header_id|>', '<|start_header_id|>', ' kitchen', ' went', ' or', '<|eot_id|>', ' three', 'nes', ' Min', '<|begin_of_text|>', 'nes'], 'evidence_proportions': [724.6, 588.4, 588.4, 153.725]}, 'weight': {'score': [22.862890625, 23.26940236722679, 20.253551136363637, 23.278584830785352, 29.855208333333334], 'topk_indices': array([3298, 3325, 3170, 3218, 7414, 7376, 1506, 1444, 4312, 4296, 5200,
       5139, 7153, 7097, 3481, 3507, 4964, 4941, 4916, 4993]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.1, 20.75625, 20.75625, 27.8390625]}, 'saliency': {'score': [2.9569091796875, 0.2739817182900466, 1.9708640358664773, 0.26276362431709255, 0.3055674235026042], 'topk_indices': array([ 829, 7566, 8138, 7568, 8141, 1748, 1751,  275, 7522,  830,  833,
        298, 7597, 7553,  257,  299,  303, 7567, 7611, 7612]), 'topk_tokens': [' Mary', ' Min', ' apple', 'ot', ' hallway', ' travelled', ' office', ' If', 'nes', ' picked', ' apple', ' John', ' or', ' three', 'hue', ' went', ' kitchen', 'nes', ' Min', 'nes'], 'evidence_proportions': [4.2560546875, 3.1916015625, 3.1916015625, 1.18837890625]}}, 'pred_res': 'the kitchen<|eot_id|>', 'score': 0}
2025-01-22 18:59:03.565 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:59:03.565 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-126_pid-0_1-2-4-5.pkl | len: 3 |  size: 1.98 KB
Processing depth (1, 2, 4, 5):   1%|          | 1/100 [00:19<31:32, 19.12s/it]is_0k: False
your chose emoji: ['ğŸ’\u200dâ™‚', 'ğŸ’ğŸ»\u200dâ™€', 'ğŸ™†ğŸ¿\u200dâ™‚', 'ğŸŒ¥ï¸', 'ğŸ›³', 'ğŸ‘º', 'ğŸ‡µğŸ‡«', 'ğŸ‡µğŸ‡³', 'ğŸ‹ğŸ½\u200dâ™€ï¸', 'ğŸ§—ğŸ¾\u200dâ™€']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.42s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.90s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.88s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.41s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.92s/it]
Processing depth (0, 1, 2, 9):   1%|          | 1/100 [00:36<31:32, 19.12s/it]2025-01-22 18:59:21.240 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 18:59:21.240 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the apple.
2025-01-22 18:59:21.241 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the office.
2025-01-22 18:59:21.245 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (834, 839) --> . Mary travelled to the
2025-01-22 18:59:21.245 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary travelled to the hallway.
2025-01-22 18:59:21.250 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (834, 839) --> . Mary travelled to the
2025-01-22 18:59:21.250 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra travelled to the bathroom.
2025-01-22 18:59:21.285 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7106, 7111) -->  Sandra travelled to the bathroom
2025-01-22 18:59:21.285 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the kitchen.
2025-01-22 18:59:21.301 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3074, 3079) --> . Daniel moved to the
2025-01-22 18:59:21.302 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the garden.
2025-01-22 18:59:21.316 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2518, 2523) --> . Daniel went to the
2025-01-22 18:59:21.316 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the kitchen.
2025-01-22 18:59:21.317 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (270, 276) -->  John went back to the kitchen
2025-01-22 18:59:21.318 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra journeyed to the bedroom.
2025-01-22 18:59:21.340 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3811, 3817) -->  Sandra journeyed to the bedroom
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:59:22.150 | INFO     | test_jbb_embedding:begin_test:693 - Mary's office.<|eot_id|>
2025-01-22 18:59:22.150 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8143])
2025-01-22 18:59:24.378 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [720.35, 56.3286525475752, 259.5667613636364, 54.13790031469826, 47.570103236607146], 'topk_indices': array([ 185,   73,  103,  347,   29,   39,   35,   69,   74,   66, 1920,
        104,  111, 2001,   68,  112,   67,  106,  105,    0]), 'topk_tokens': ['ION', '.', ' OF', ' of', '\n\n', '\n\n\n', '.', 'ER', ' PA', ' P', ' of', ' P', '.', ' arrival', 'E', ' PA', 'ION', 'E', 'ION', '<|begin_of_text|>'], 'evidence_proportions': [1202.5, 799.1, 799.1, 80.7]}, 'weight': {'score': [22.858203125, 23.252620472682626, 22.57528409090909, 23.25543298006911, 29.097098214285715], 'topk_indices': array([3294, 3321, 3214, 3166, 7434, 7396, 1430, 1492, 4292, 4308, 5159,
       5220, 7117, 7173, 3503, 3477, 4924, 5013, 4949, 4984]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.08125, 20.75625, 20.75625, 27.8390625]}, 'saliency': {'score': [3.8502685546875, 0.3221114072571363, 1.5803111683238635, 0.3099870659400839, 0.33681256430489676], 'topk_indices': array([  31,  185,  102,   69,   56,   36,  110,   38,   66,   64,  104,
       1919,   39,   74,   68,   67, 2001,  106,  112,  105]), 'topk_tokens': [' picked', 'ION', 'ENCES', 'ER', 'istributed', ' PA', ' ST', '***', ' P', 'ENCES', ' P', ' arrival', '\n\n\n', ' PA', 'E', 'ION', ' arrival', 'E', ' PA', 'ION'], 'evidence_proportions': [6.24609375, 4.2765625, 4.2765625, 0.60185546875]}}, 'pred_res': "Mary's office.<|eot_id|>", 'score': 100}
2025-01-22 18:59:24.385 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:59:24.385 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-126_pid-1_0-1-2-9.pkl | len: 3 |  size: 1.9 KB
Processing depth (0, 1, 2, 9):   2%|â–         | 2/100 [00:39<32:51, 20.12s/it]is_0k: False
your chose emoji: ['ğŸ‘¨ğŸ¼\u200dâœˆï¸', 'â‡ï¸', 'ğŸ®', 'ğŸ§™ğŸ¼', 'ğŸ‘±ğŸ¿', 'ğŸ‡¸ğŸ‡­', 'ğŸ¥', 'ğŸ§', 'ğŸ§‘ğŸ»\u200dğŸ¦¯\u200dâ¡', 'ğŸ…']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.43s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.46s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.95s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.40s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.87s/it]
Processing depth (0, 1, 8, 9):   2%|â–         | 2/100 [00:57<32:51, 20.12s/it]2025-01-22 18:59:41.586 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 18:59:41.586 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the apple.
2025-01-22 18:59:41.587 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the office.
2025-01-22 18:59:41.591 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (828, 833) --> . Mary travelled to the
2025-01-22 18:59:41.591 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary travelled to the hallway.
2025-01-22 18:59:41.595 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (828, 833) --> . Mary travelled to the
2025-01-22 18:59:41.595 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra travelled to the bathroom.
2025-01-22 18:59:41.631 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7205, 7210) --> . Sandra travelled to the
2025-01-22 18:59:41.631 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the kitchen.
2025-01-22 18:59:41.644 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2613, 2618) -->  Daniel moved to the kitchen
2025-01-22 18:59:41.644 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the garden.
2025-01-22 18:59:41.654 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2083, 2088) -->  cable. Daniel went to
2025-01-22 18:59:41.654 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the kitchen.
2025-01-22 18:59:41.656 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (303, 309) --> . John went back to the
2025-01-22 18:59:41.656 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra journeyed to the bedroom.
2025-01-22 18:59:41.674 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3650, 3656) --> . Sandra journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 18:59:42.548 | INFO     | test_jbb_embedding:begin_test:693 - Mary picked up the apple.<|eot_id|>
2025-01-22 18:59:42.548 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8141])
2025-01-22 18:59:45.574 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [721.70625, 68.33126611813827, 258.65127840909093, 66.20133895506727, 28.311292613636365], 'topk_indices': array([368,  69,  73, 370,  74,  66, 104, 340, 111, 369, 112, 341, 343,
       106,  67, 372,  68, 344, 105,   0]), 'topk_tokens': [' latter', 'ER', '.', ' of', ' PA', ' P', ' P', ' half', '.', ' half', ' PA', ' of', ' past', 'E', 'ION', ' past', 'E', ' century', 'ION', '<|begin_of_text|>'], 'evidence_proportions': [1321.2, 731.0, 731.0, 103.625]}, 'weight': {'score': [21.4359375, 23.258661580498586, 22.348011363636363, 23.265634643871127, 29.650568181818183], 'topk_indices': array([3361, 3334, 3254, 3206, 7384, 7422, 1466, 1528, 4320, 4336, 5147,
       5208, 7155, 7099, 3517, 3543, 4908, 4985, 4933, 4956]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.08125, 20.75625, 20.75625, 22.15]}, 'saliency': {'score': [3.762445068359375, 0.3933877496392607, 1.3946366743607954, 0.38235101062947474, 0.21285955255681818], 'topk_indices': array([ 64, 101, 341, 110,  38, 104,  66, 339, 368,  74, 106, 340, 369,
        68, 112,  67, 343, 372, 105, 344]), 'topk_tokens': ['ENCES', 'ISC', ' of', ' ST', '***', ' P', ' P', ' latter', ' latter', ' PA', 'E', ' half', ' half', 'E', ' PA', 'ION', ' past', ' past', 'ION', ' century'], 'evidence_proportions': [6.60390625, 3.9169921875, 3.9169921875, 0.6118896484375]}}, 'pred_res': 'Mary picked up the apple.<|eot_id|>', 'score': 0}
2025-01-22 18:59:45.580 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 18:59:45.581 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-126_pid-2_0-1-8-9.pkl | len: 3 |  size: 1.93 KB
Processing depth (0, 1, 8, 9):   3%|â–         | 3/100 [01:01<33:19, 20.61s/it]is_0k: False
your chose emoji: ['\U0001faf7ğŸ½', 'ğŸ’ªğŸ¼', 'ğŸ™ğŸ½\u200dâ™€', 'ğŸ‘©\u200dğŸ’¼', 'ğŸƒğŸ½\u200dâ™€ï¸\u200dâ¡ï¸', 'ğŸ¶', 'âš«', 'ğŸ', 'ğŸ‡²ğŸ‡»', 'ğŸŒ“']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:05<00:15,  5.11s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.17s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.50s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.09s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.74s/it]
Processing depth (0, 2, 3, 5):   3%|â–         | 3/100 [01:17<33:19, 20.61s/it]2025-01-22 19:00:02.333 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:00:02.334 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the apple.
2025-01-22 19:00:02.334 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the office.
2025-01-22 19:00:02.343 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1800, 1805) --> . Mary travelled to the
2025-01-22 19:00:02.343 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary travelled to the hallway.
2025-01-22 19:00:02.354 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1800, 1805) --> . Mary travelled to the
2025-01-22 19:00:02.354 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra travelled to the bathroom.
2025-01-22 19:00:02.378 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4226, 4231) -->  Sandra travelled to the bathroom
2025-01-22 19:00:02.378 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the kitchen.
2025-01-22 19:00:02.392 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2958, 2963) --> . Daniel moved to the
2025-01-22 19:00:02.393 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the garden.
2025-01-22 19:00:02.410 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2496, 2501) --> . Daniel went to the
2025-01-22 19:00:02.410 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the kitchen.
2025-01-22 19:00:02.413 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (303, 309) --> . John went back to the
2025-01-22 19:00:02.413 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra journeyed to the bedroom.
2025-01-22 19:00:02.435 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3808, 3814) --> . Sandra journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:00:03.255 | INFO     | test_jbb_embedding:begin_test:693 - Mary's hands.<|eot_id|>
2025-01-22 19:00:03.255 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8167])
2025-01-22 19:00:05.478 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [1014.740625, 77.38766984943078, 290.84517045454544, 74.50307232065953, 26.12632123161765], 'topk_indices': array([ 24,  38,  39,  75,  72, 103,  69, 110,  35,  73,  66, 104,  74,
       111, 112,  67,  68, 106,   0, 105]), 'topk_tokens': ['\n\n', '***', '\n\n\n', 'UL', ' ST', ' OF', 'ER', ' ST', '.', '.', ' P', ' P', ' PA', '.', ' PA', 'ION', 'E', 'E', '<|begin_of_text|>', 'ION'], 'evidence_proportions': [1992.2, 978.1, 978.1, 110.5625]}, 'weight': {'score': [22.858203125, 23.27354556861305, 20.253551136363637, 23.282742901747262, 29.32261029411765], 'topk_indices': array([3298, 3325, 3218, 3170, 7372, 7410, 1498, 1436, 4302, 4318, 5131,
       5192, 7149, 7093, 3507, 3481, 4956, 4985, 4908, 4933]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.08125, 20.75625, 20.75625, 27.8390625]}, 'saliency': {'score': [5.557135009765625, 0.4406229916452442, 1.5428133877840908, 0.42504794192487233, 0.1938312754911535], 'topk_indices': array([ 36,  69,  75,  39,  56,  64, 101, 102,  31,  38,  72, 104,  66,
       110,  74,  68, 106,  67, 112, 105]), 'topk_tokens': [' PA', 'ER', 'UL', '\n\n\n', 'istributed', 'ENCES', 'ISC', 'ENCES', ' picked', '***', ' ST', ' P', ' P', ' ST', ' PA', 'E', 'E', 'ION', ' PA', 'ION'], 'evidence_proportions': [10.590625, 5.38671875, 5.38671875, 0.8644775390625]}}, 'pred_res': "Mary's hands.<|eot_id|>", 'score': 0}
2025-01-22 19:00:05.484 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 19:00:05.484 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-126_pid-3_0-2-3-5.pkl | len: 3 |  size: 1.88 KB
Processing depth (0, 2, 3, 5):   4%|â–         | 4/100 [01:21<32:31, 20.33s/it]is_0k: False
your chose emoji: ['ğŸ‘´ğŸ½', 'ğŸš•', 'ğŸ‘‹ğŸ»', 'ğŸ‘©ğŸ¼\u200dâ¤\u200dğŸ’‹\u200dğŸ‘©ğŸ»', 'ğŸ™ğŸ»\u200dâ™€ï¸', '\U0001faf0ğŸ¿', 'â™Š', 'ğŸ‘¼', '\U0001faf6ğŸ½', 'ğŸ§ğŸ¿\u200dâ¡']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.84s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.95s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.81s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.35s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.90s/it]
Processing depth (0, 3, 5, 9):   4%|â–         | 4/100 [01:38<32:31, 20.33s/it]2025-01-22 19:00:22.994 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:00:22.994 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the apple.
2025-01-22 19:00:22.994 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the office.
2025-01-22 19:00:23.009 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2896, 2901) --> . Mary travelled to the
2025-01-22 19:00:23.009 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary travelled to the hallway.
2025-01-22 19:00:23.024 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2896, 2901) --> . Mary travelled to the
2025-01-22 19:00:23.024 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra travelled to the bathroom.
2025-01-22 19:00:23.060 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7231, 7236) --> . Sandra travelled to the
2025-01-22 19:00:23.060 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the kitchen.
2025-01-22 19:00:23.075 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2958, 2963) --> . Daniel moved to the
2025-01-22 19:00:23.075 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the garden.
2025-01-22 19:00:23.088 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2422, 2427) --> . Daniel went to the
2025-01-22 19:00:23.088 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the kitchen.
2025-01-22 19:00:23.089 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (303, 309) --> . John went back to the
2025-01-22 19:00:23.089 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra journeyed to the bedroom.
2025-01-22 19:00:23.108 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3692, 3698) --> . Sandra journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:00:23.932 | INFO     | test_jbb_embedding:begin_test:693 - Mary's office.<|eot_id|>
2025-01-22 19:00:23.933 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8177])
2025-01-22 19:00:26.155 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [777.853125, 76.03830694461426, 227.82102272727272, 73.90293566424972, 22.029698202054796], 'topk_indices': array([ 69,  73,  35, 546, 104, 553, 548, 437,  66,  74, 431, 432, 111,
       555, 112, 106,  67,  68, 105,   0]), 'topk_tokens': ['ER', '.', '.', ',', ' P', ' em', ' to', 's', ' P', ' PA', ' to', ' ', '.', ' per', ' PA', 'E', 'ION', 'E', 'ION', '<|begin_of_text|>'], 'evidence_proportions': [1771.6, 628.25, 628.25, 83.3125]}, 'weight': {'score': [21.4359375, 23.288994681501407, 20.253551136363637, 23.30175625230429, 29.773758561643834], 'topk_indices': array([3325, 3298, 3218, 3170, 7410, 7448, 1486, 1424, 4338, 4322, 5194,
       5133, 7125, 7181, 3507, 3481, 4910, 4987, 4958, 4935]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.08125, 20.75625, 20.75625, 22.15]}, 'saliency': {'score': [4.18458251953125, 0.4312798317814678, 1.1903852982954546, 0.42000216507158655, 0.16868444991438356], 'topk_indices': array([ 38, 102,  72, 101, 436,  34, 185, 437, 104,  64, 110,  66, 106,
       553,  74,  68, 555,  67, 112, 105]), 'topk_tokens': ['***', 'ENCES', ' ST', 'ISC', ' em', ' apple', 'ION', 's', ' P', 'ENCES', ' ST', ' P', 'E', ' em', ' PA', 'E', ' per', 'ION', ' PA', 'ION'], 'evidence_proportions': [9.58984375, 3.334765625, 3.334765625, 0.478955078125]}}, 'pred_res': "Mary's office.<|eot_id|>", 'score': 100}
2025-01-22 19:00:26.163 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 19:00:26.163 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-126_pid-4_0-3-5-9.pkl | len: 3 |  size: 1.87 KB
Processing depth (0, 3, 5, 9):   5%|â–Œ         | 5/100 [01:41<32:23, 20.46s/it]Processing depth (0, 3, 5, 9):   5%|â–Œ         | 5/100 [01:41<32:14, 20.36s/it]
2025-01-22 19:00:26.238 | INFO     | __main__:<module>:82 - Selected idx: 128
2025-01-22 19:00:26.238 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the apple before the garden? 
2025-01-22 19:00:26.238 | INFO     | __main__:<module>:84 - Answer: hallway
2025-01-22 19:00:26.238 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 19:00:26.238 | INFO     | __main__:<module>:86 - Needle: [' Daniel went to the garden.', ' John went back to the kitchen.', ' Mary picked up the apple.', ' Sandra travelled to the bathroom.', ' Sandra journeyed to the bedroom.', ' Mary travelled to the hallway.', ' Daniel moved to the kitchen.', ' Sandra journeyed to the bedroom.', ' Mary moved to the garden.', ' Daniel journeyed to the bathroom.']
2025-01-22 19:00:26.238 | INFO     | __main__:<module>:87 - Real Needle: [' Mary picked up the apple.', ' Mary travelled to the hallway.', ' Mary moved to the garden.', ' Daniel journeyed to the bathroom.']
2025-01-22 19:00:26.238 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ‘©ğŸ¾\u200dğŸ¦¯\u200dâ¡ï¸', 'âª', 'âœ', 'ğŸ¤´', 'ğŸ‘©ğŸ½\u200dâ¤\u200dğŸ‘©ğŸ¾', 'ğŸ›¹', 'ğŸ¤œğŸ»', 'ğŸ™‹\u200dâ™‚ï¸', 'ğŸ™…ğŸ½\u200dâ™‚ï¸', 'ğŸƒğŸ»\u200dâ¡ï¸']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.23s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.34s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.46s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.14s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.59s/it]
Processing depth (1, 2, 6, 7):   0%|          | 0/100 [00:15<?, ?it/s]2025-01-22 19:00:42.370 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:00:42.375 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (834, 839) --> . Mary picked up the
2025-01-22 19:00:42.375 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the hallway.
2025-01-22 19:00:42.385 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1806, 1811) --> . Mary travelled to the
2025-01-22 19:00:42.385 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary moved to the garden.
2025-01-22 19:00:42.409 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4887, 4892) --> . Mary moved to the
2025-01-22 19:00:42.410 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the bathroom.
2025-01-22 19:00:42.446 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5636, 5642) -->  Daniel journeyed to the bathroom
2025-01-22 19:00:42.446 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went to the garden.
2025-01-22 19:00:42.474 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4562, 4567) -->  Daniel went to the garden
2025-01-22 19:00:42.474 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the kitchen.
2025-01-22 19:00:42.492 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2997, 3003) -->  tragedy. John went back to
2025-01-22 19:00:42.492 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra travelled to the bathroom.
2025-01-22 19:00:42.523 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5690, 5695) --> . Sandra travelled to the
2025-01-22 19:00:42.523 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra journeyed to the bedroom.
2025-01-22 19:00:42.525 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (297, 303) --> . Sandra journeyed to the
2025-01-22 19:00:42.525 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel moved to the kitchen.
2025-01-22 19:00:42.543 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3447, 3452) --> . Daniel moved to the
2025-01-22 19:00:42.543 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra journeyed to the bedroom.
2025-01-22 19:00:42.545 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (297, 303) --> . Sandra journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:00:43.361 | INFO     | test_jbb_embedding:begin_test:693 - The bedroom.<|eot_id|>
2025-01-22 19:00:43.361 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8201])
2025-01-22 19:00:45.623 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [161.65252976190476, 21.361091007435398, 261.9457859848485, 20.025457246932515, 32.952098357371796], 'topk_indices': array([   4,  257,  274,  304,  299,   28,  300,   24, 8089,  301,    9,
       8055, 8197,  298, 8199, 8196,   14, 1811,  303,    0]), 'topk_tokens': ['\n\n', 'hue', '.', '.', ' journey', '<|end_header_id|>', 'ed', '\n\n', '.\n\n', ' to', ':', ' context', '<|start_header_id|>', ' Sandra', '<|end_header_id|>', '<|eot_id|>', '\n', ' hallway', ' bedroom', '<|begin_of_text|>'], 'evidence_proportions': [258.1, 275.575, 86.49375, 48.9765625]}, 'weight': {'score': [22.027901785714285, 23.29570560092638, 22.279356060606062, 23.303087615030673, 29.77263621794872], 'topk_indices': array([3308, 3281, 3201, 3153, 7430, 7468, 1442, 1504, 4330, 4314, 5149,
       5210, 7207, 7151, 3496, 3470, 4974, 4939, 4914, 5003]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.1, 20.75625, 19.646875, 25.01171875]}, 'saliency': {'score': [0.8855445498511905, 0.12165023826029986, 1.5801262133049243, 0.11377643608608129, 0.26020226111778844], 'topk_indices': array([8191, 8189,  300,   24, 8188,    8,    0, 1808, 8099,  839, 8089,
       4566,  321,  312,  257,  299, 8055,  298, 1811,  303]), 'topk_tokens': [' garden', ' before', 'ed', '\n\n', ' apple', ' Date', '<|begin_of_text|>', ' travelled', ' location', ' apple', '.\n\n', ' garden', 'ï¿½', 'ï¿½', 'hue', ' journey', ' context', ' Sandra', ' hallway', ' bedroom'], 'evidence_proportions': [1.47265625, 1.43408203125, 0.4292724609375, 0.31939697265625]}}, 'pred_res': 'The bedroom.<|eot_id|>', 'score': 0}
2025-01-22 19:00:45.655 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 19:00:45.656 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-128_pid-0_1-2-6-7.pkl | len: 3 |  size: 2.03 KB
Processing depth (1, 2, 6, 7):   1%|          | 1/100 [00:19<31:50, 19.30s/it]is_0k: False
your chose emoji: ['ğŸ‹ğŸ½\u200dâ™‚', 'ğŸ™‡ğŸ»\u200dâ™€', 'ğŸ‘ˆğŸ½', 'ğŸ‘³', 'ğŸ‘­ğŸ»', 'â›¹ğŸ½', 'ğŸŒğŸ¿\u200dâ™‚', 'ğŸ‘©ğŸ»\u200dâ¤\u200dğŸ’‹\u200dğŸ‘©ğŸ¼', 'ğŸ‡­ğŸ‡°', 'ğŸ‹ï¸\u200dâ™€ï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.53s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.47s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.45s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.85s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.45s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (3, 4, 5, 9):   1%|          | 1/100 [00:34<31:50, 19.30s/it]2025-01-22 19:01:01.257 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:01:01.275 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2923, 2928) -->  Mary picked up the apple
2025-01-22 19:01:01.275 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the hallway.
2025-01-22 19:01:01.294 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3620, 3625) -->  Mary travelled to the hallway
2025-01-22 19:01:01.294 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary moved to the garden.
2025-01-22 19:01:01.316 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4220, 4225) -->  Mary moved to the garden
2025-01-22 19:01:01.316 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the bathroom.
2025-01-22 19:01:01.358 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7277, 7283) -->  cold. Daniel journeyed to
2025-01-22 19:01:01.358 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went to the garden.
2025-01-22 19:01:01.380 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4526, 4531) -->  Daniel went to the garden
2025-01-22 19:01:01.380 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the kitchen.
2025-01-22 19:01:01.395 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2985, 2991) -->  tragedy. John went back to
2025-01-22 19:01:01.396 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra travelled to the bathroom.
2025-01-22 19:01:01.428 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5801, 5806) --> . Sandra travelled to the
2025-01-22 19:01:01.429 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra journeyed to the bedroom.
2025-01-22 19:01:01.430 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (297, 303) --> . Sandra journeyed to the
2025-01-22 19:01:01.430 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel moved to the kitchen.
2025-01-22 19:01:01.447 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3435, 3440) --> . Daniel moved to the
2025-01-22 19:01:01.448 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra journeyed to the bedroom.
2025-01-22 19:01:01.449 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (297, 303) --> . Sandra journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:01:04.320 | INFO     | test_jbb_embedding:begin_test:693 - Mary's hand<|eot_id|>
2025-01-22 19:01:04.320 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8187])
2025-01-22 19:01:07.089 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [478.01636904761904, 42.84908424908425, 271.1723484848485, 40.79977492010816, 69.80336707746478], 'topk_indices': array([8181,   14, 8176, 3624, 8168, 8173, 8171, 8041, 8169, 8172, 2927,
       2928, 8178, 8170, 8177, 8174, 8175,    0, 8182, 8183]), 'topk_tokens': [':', '\n', ' the', ' hallway', '.\n\n', ' the', ' Where', ' context', 'Question', ' was', ' apple', '.', '?', ':', ' garden', ' apple', ' before', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [978.2, 674.8, 318.95, 29.765625]}, 'weight': {'score': [25.253720238095237, 23.27181394993895, 22.279356060606062, 23.270723866150444, 29.033230633802816], 'topk_indices': array([3269, 3296, 3189, 3141, 7438, 7400, 1468, 1406, 4278, 4294, 5113,
       5174, 7114, 7170, 3484, 3458, 4897, 4949, 4920, 4872]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.7078125, 26.8515625, 24.1609375, 23.62109375]}, 'saliency': {'score': [3.305757068452381, 0.23255446810134311, 1.6253107244318181, 0.21897307539408187, 0.500001719300176], 'topk_indices': array([8085, 8179,  303, 8168, 8170, 8180,  298, 2924, 2911, 2923, 8172,
       8178, 8171, 8041, 8169, 3624, 2927, 8177, 8175, 8174]), 'topk_tokens': [' location', ' \n', ' bedroom', '.\n\n', ':', 'Answer', ' Sandra', ' picked', 'ï¿½', ' Mary', ' was', '?', ' Where', ' context', 'Question', ' hallway', ' apple', ' garden', ' before', ' apple'], 'evidence_proportions': [6.8623046875, 4.903515625, 1.91025390625, 0.17342122395833334]}}, 'pred_res': "Mary's hand<|eot_id|>", 'score': 0}
2025-01-22 19:01:07.094 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 19:01:07.094 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-128_pid-1_3-4-5-9.pkl | len: 3 |  size: 1.99 KB
Processing depth (3, 4, 5, 9):   2%|â–         | 2/100 [00:40<33:34, 20.56s/it]is_0k: False
your chose emoji: ['ğŸ‘¤', 'ğŸ§‘ğŸ¼\u200dğŸ¦¼', 'ğŸ‘¨ğŸ½\u200dğŸ’¼', 'ğŸ‘ğŸ¾', 'ğŸ§‘ğŸ¿\u200dâ¤\u200dğŸ’‹\u200dğŸ§‘ğŸ¼', 'ğŸ‘‚', 'ğŸŸ©', 'ğŸ‡µğŸ‡³', 'ğŸ¤“', 'ğŸ™‡ğŸ¼\u200dâ™‚ï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.74s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.19s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:15<00:05,  5.06s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  3.45s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  4.03s/it]
Processing depth (0, 4, 5, 6):   2%|â–         | 2/100 [00:58<33:34, 20.56s/it]2025-01-22 19:01:25.033 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:01:25.034 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the apple.
2025-01-22 19:01:25.034 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the hallway.
2025-01-22 19:01:25.061 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3634, 3639) -->  Hon. Mary travelled to
2025-01-22 19:01:25.061 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary moved to the garden.
2025-01-22 19:01:25.085 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4236, 4241) -->  Mary moved to the garden
2025-01-22 19:01:25.086 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the bathroom.
2025-01-22 19:01:25.111 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4803, 4809) -->  the senate. Daniel journeyed
2025-01-22 19:01:25.111 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went to the garden.
2025-01-22 19:01:25.134 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4548, 4553) -->  Daniel went to the garden
2025-01-22 19:01:25.134 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the kitchen.
2025-01-22 19:01:25.150 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2950, 2956) --> . John went back to the
2025-01-22 19:01:25.150 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra travelled to the bathroom.
2025-01-22 19:01:25.183 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5721, 5726) -->  Sandra travelled to the bathroom
2025-01-22 19:01:25.183 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra journeyed to the bedroom.
2025-01-22 19:01:25.185 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (269, 275) --> . Sandra journeyed to the
2025-01-22 19:01:25.185 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel moved to the kitchen.
2025-01-22 19:01:25.202 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3335, 3340) --> . Daniel moved to the
2025-01-22 19:01:25.202 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra journeyed to the bedroom.
2025-01-22 19:01:25.204 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (269, 275) --> . Sandra journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:01:26.039 | INFO     | test_jbb_embedding:begin_test:693 - Mary's bedroom.<|eot_id|>
2025-01-22 19:01:26.039 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8213])
2025-01-22 19:01:28.303 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [411.5762648809524, 36.1528648369036, 248.10795454545453, 34.329977142550845, 19.185558500744047], 'topk_indices': array([  66,   29,   73, 8201,   68,   24,   63, 3640, 8208,   14, 8111,
         74,   35, 8209,   67,  111,  112,  106,  105,    0]), 'topk_tokens': [' P', '\n\n', '.', ' before', 'E', '\n\n', 'ISC', ' hallway', '<|eot_id|>', '\n', ' location', ' PA', '.', '<|start_header_id|>', 'ION', '.', ' PA', 'E', 'ION', '<|begin_of_text|>'], 'evidence_proportions': [741.5, 616.05, 306.975, 53.412760416666664]}, 'weight': {'score': [24.014136904761905, 23.290268226630964, 22.261363636363637, 23.292565777382993, 29.038690476190474], 'topk_indices': array([3291, 3318, 3211, 3163, 7498, 7460, 1512, 1450, 4304, 4288, 5215,
       5154, 7181, 7237, 3480, 3506, 4956, 4979, 5008, 4931]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.08125, 25.5640625, 24.1609375, 24.2109375]}, 'saliency': {'score': [2.4279058547247026, 0.20615001407314995, 1.3949233546401516, 0.1956272999231385, 0.1372486296154204], 'topk_indices': array([ 350, 8200,   34,   38,   39,   30, 8201,   31,  110,   64,   62,
       3637, 8111,  106,   74,   67,   63, 3640,  105,  112]), 'topk_tokens': [' century', ' apple', ' apple', '***', '\n\n\n', 'Mary', ' before', ' picked', ' ST', 'ENCES', 'MIN', ' travelled', ' location', 'E', ' PA', 'ION', 'ISC', ' hallway', 'ION', ' PA'], 'evidence_proportions': [4.002734375, 3.9216796875, 1.8802734375, 0.3270975748697917]}}, 'pred_res': "Mary's bedroom.<|eot_id|>", 'score': 0}
2025-01-22 19:01:28.310 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 19:01:28.310 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-128_pid-2_0-4-5-6.pkl | len: 3 |  size: 1.96 KB
Processing depth (0, 4, 5, 6):   3%|â–         | 3/100 [01:01<33:43, 20.86s/it]is_0k: False
your chose emoji: ['ğŸ—ï¸', 'ğŸ‘¨ğŸ¾\u200dğŸ­', 'ğŸ—¾', 'ğŸ‡¨ğŸ‡­', 'ğŸ‘¬ğŸ¿', 'ğŸ‘‰ğŸ¾', 'ğŸ‘©ğŸ¿\u200dâ¤\u200dğŸ‘©ğŸ¾', 'ğŸ§‘ğŸ¾\u200dâ¤\u200dğŸ§‘ğŸ½', 'ğŸ§‘ğŸ¾\u200dğŸ¦½\u200dâ¡', 'ğŸ§œğŸ¼']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  3.79s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.31s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.21s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.74s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.26s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (3, 6, 7, 8):   3%|â–         | 3/100 [01:16<33:43, 20.86s/it]2025-01-22 19:01:43.057 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:01:43.075 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2922, 2927) --> . Mary picked up the
2025-01-22 19:01:43.075 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the hallway.
2025-01-22 19:01:43.100 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4757, 4762) -->  the senate. Mary travelled
2025-01-22 19:01:43.101 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary moved to the garden.
2025-01-22 19:01:43.129 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5593, 5598) --> . Mary moved to the
2025-01-22 19:01:43.129 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the bathroom.
2025-01-22 19:01:43.167 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6512, 6518) -->  Daniel journeyed to the bathroom
2025-01-22 19:01:43.167 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went to the garden.
2025-01-22 19:01:43.191 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4479, 4484) --> . Daniel went to the
2025-01-22 19:01:43.191 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the kitchen.
2025-01-22 19:01:43.206 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2985, 2991) -->  tragedy. John went back to
2025-01-22 19:01:43.207 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra travelled to the bathroom.
2025-01-22 19:01:43.238 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5647, 5652) --> . Sandra travelled to the
2025-01-22 19:01:43.239 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra journeyed to the bedroom.
2025-01-22 19:01:43.240 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (297, 303) --> . Sandra journeyed to the
2025-01-22 19:01:43.240 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel moved to the kitchen.
2025-01-22 19:01:43.259 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3435, 3440) --> . Daniel moved to the
2025-01-22 19:01:43.259 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra journeyed to the bedroom.
2025-01-22 19:01:43.261 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (297, 303) --> . Sandra journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:01:51.463 | INFO     | test_jbb_embedding:begin_test:693 - Mary picked up the apple.<|eot_id|>
2025-01-22 19:01:51.463 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8167])
2025-01-22 19:01:54.489 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [186.28125, 24.454716187270503, 167.90104166666666, 23.452734182479055, 36.3758324795082], 'topk_indices': array([   3, 8149, 8148, 8152,   24, 8158, 8150, 8157,   14, 2928, 8165,
       2922, 2894, 8154, 2927, 8155, 4764,    0, 8162, 8163]), 'topk_tokens': ['<|end_header_id|>', 'Question', '.\n\n', ' was', '\n\n', '?', ':', ' garden', '\n', '.', '<|end_header_id|>', '.', '.', ' apple', ' apple', ' before', ' hallway', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [476.25, 172.4375, 94.58125, 32.59375]}, 'weight': {'score': [23.153645833333332, 23.258858629130966, 21.595407196969695, 23.26589452932479, 29.110143442622952], 'topk_indices': array([3296, 3269, 3189, 3141, 7446, 7408, 1418, 1480, 4284, 4300, 5125,
       5186, 7185, 7129, 3484, 3458, 4944, 4921, 4896, 4973]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.1, 25.484375, 19.646875, 25.01171875]}, 'saliency': {'score': [1.0362781343005953, 0.13574141055309058, 0.9858768347537878, 0.12995460175598356, 0.2650296570824795], 'topk_indices': array([ 678, 4761, 2895,  303,  749, 8160, 2893, 2921, 2924, 8151, 2992,
       8021, 2923,  298, 8149, 8157, 8155, 8154, 2927, 4764]), 'topk_tokens': [' set', ' travelled', ' During', ' bedroom', ' services', 'Answer', ' Gov', ' Gov', ' picked', ' Where', ' kitchen', ' context', ' Mary', ' Sandra', 'Question', ' garden', ' before', ' apple', ' apple', ' hallway'], 'evidence_proportions': [2.4853515625, 1.1701171875, 0.4481689453125, 0.207275390625]}}, 'pred_res': 'Mary picked up the apple.<|eot_id|>', 'score': 0}
2025-01-22 19:01:54.495 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 19:01:54.495 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-128_pid-3_3-6-7-8.pkl | len: 3 |  size: 2.04 KB
Processing depth (3, 6, 7, 8):   4%|â–         | 4/100 [01:28<36:44, 22.96s/it]is_0k: False
your chose emoji: ['ğŸ‡¦ğŸ‡¬', 'ğŸ‡¹ğŸ‡²', '1ï¸âƒ£', 'ğŸ¦°', 'ğŸ§œ\u200dâ™‚', 'ğŸŒğŸ¿', 'ğŸ§ğŸ¿\u200dâ™‚ï¸', 'ğŸ”', 'ğŸ‘¨\u200dğŸ¦¼', 'ğŸ¤¸ğŸ»\u200dâ™€ï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.25s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.64s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.79s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.29s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.78s/it]
Processing depth (0, 4, 7, 8):   4%|â–         | 4/100 [01:44<36:44, 22.96s/it]2025-01-22 19:02:11.348 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:02:11.349 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the apple.
2025-01-22 19:02:11.349 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the hallway.
2025-01-22 19:02:11.371 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3667, 3672) --> . Mary travelled to the
2025-01-22 19:02:11.371 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary moved to the garden.
2025-01-22 19:02:11.400 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5702, 5707) -->  Mary moved to the garden
2025-01-22 19:02:11.400 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the bathroom.
2025-01-22 19:02:11.437 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6663, 6669) --> . Daniel journeyed to the
2025-01-22 19:02:11.437 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went to the garden.
2025-01-22 19:02:11.461 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4584, 4589) -->  Daniel went to the garden
2025-01-22 19:02:11.462 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the kitchen.
2025-01-22 19:02:11.477 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2948, 2954) --> . John went back to the
2025-01-22 19:02:11.477 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra travelled to the bathroom.
2025-01-22 19:02:11.508 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5797, 5802) --> . Sandra travelled to the
2025-01-22 19:02:11.508 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra journeyed to the bedroom.
2025-01-22 19:02:11.509 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (303, 309) --> . Sandra journeyed to the
2025-01-22 19:02:11.509 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel moved to the kitchen.
2025-01-22 19:02:11.528 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3335, 3340) --> . Daniel moved to the
2025-01-22 19:02:11.529 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra journeyed to the bedroom.
2025-01-22 19:02:11.531 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (303, 309) --> . Sandra journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:02:12.443 | INFO     | test_jbb_embedding:begin_test:693 - Mary picked up the apple.<|eot_id|>
2025-01-22 19:02:12.443 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8227])
2025-01-22 19:02:14.717 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [403.9077380952381, 46.58121962332928, 298.469696969697, 44.64675574853229, 28.914599072802197], 'topk_indices': array([ 185,   29,   73, 8125, 8215, 3672,   24,   14, 8222,  518,   35,
         74,   69,   68,  111,  106,  112,  105,   67,    0]), 'topk_tokens': ['ION', '\n\n', '.', ' location', ' before', ' hallway', '\n\n', '\n', '<|eot_id|>', ' an', '.', ' PA', 'ER', 'E', '.', 'E', ' PA', 'ION', 'ION', '<|begin_of_text|>'], 'evidence_proportions': [872.2, 386.15, 327.575, 92.07291666666667]}, 'weight': {'score': [21.743675595238095, 23.31415552855407, 21.39938446969697, 23.32591770119863, 29.676682692307693], 'topk_indices': array([3378, 3351, 3265, 3217, 7512, 7474, 1474, 1412, 4336, 4352, 5228,
       5167, 7183, 7239, 3560, 3534, 4992, 4969, 5021, 4944]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.08125, 20.75625, 24.1609375, 20.270833333333332]}, 'saliency': {'score': [2.231143043154762, 0.2647630026389733, 1.761112097537879, 0.25367279948553695, 0.21752460186298078], 'topk_indices': array([ 304,  755,   34,  185,   39,   31, 8215,   38,  110, 8217, 8125,
         69,    0,   68,  106,   74, 3672,  105,  112,   67]), 'topk_tokens': [' Sandra', ' services', ' apple', 'ION', '\n\n\n', ' picked', ' before', '***', ' ST', ' garden', ' location', 'ER', '<|begin_of_text|>', 'E', 'E', ' PA', ' hallway', 'ION', ' PA', 'ION'], 'evidence_proportions': [4.709375, 2.07490234375, 1.9443359375, 0.53515625]}}, 'pred_res': 'Mary picked up the apple.<|eot_id|>', 'score': 0}
2025-01-22 19:02:14.741 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 19:02:14.742 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-128_pid-4_0-4-7-8.pkl | len: 3 |  size: 1.95 KB
Processing depth (0, 4, 7, 8):   5%|â–Œ         | 5/100 [01:48<34:48, 21.98s/it]Processing depth (0, 4, 7, 8):   5%|â–Œ         | 5/100 [01:48<34:20, 21.69s/it]
2025-01-22 19:02:14.795 | INFO     | __main__:<module>:82 - Selected idx: 130
2025-01-22 19:02:14.795 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the apple before the bedroom? 
2025-01-22 19:02:14.795 | INFO     | __main__:<module>:84 - Answer: garden
2025-01-22 19:02:14.795 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 19:02:14.795 | INFO     | __main__:<module>:86 - Needle: [' Mary picked up the apple.', ' Mary journeyed to the garden.', ' Mary went to the bedroom.', ' John went to the office.']
2025-01-22 19:02:14.795 | INFO     | __main__:<module>:87 - Real Needle: [' Mary picked up the apple.', ' Mary journeyed to the garden.', ' Mary went to the bedroom.', ' John went to the office.']
2025-01-22 19:02:14.795 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ', 'ğŸŠğŸ¿\u200dâ™€ï¸', 'ğŸ‘²ğŸ¼', 'ğŸ§‘ğŸ¿\u200dğŸ“', 'ğŸ‘¨ğŸ½\u200dâ¤\u200dğŸ’‹\u200dğŸ‘¨ğŸ¾', 'ğŸ§‘\u200dğŸ„', 'ğŸ‘©ğŸ»\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘¨ğŸ¾', 'ğŸ‘®ğŸ¾\u200dâ™‚ï¸', 'âš’', 'ğŸ§™ğŸ¾']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.40s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.84s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.59s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  2.98s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.59s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 1, 4, 9):   0%|          | 0/100 [00:16<?, ?it/s]2025-01-22 19:02:31.044 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:02:31.045 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the apple.
2025-01-22 19:02:31.045 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:02:31.049 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (821, 827) --> . Mary journeyed to the
2025-01-22 19:02:31.049 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:02:31.069 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3615, 3620) -->  Hon. Mary went to
2025-01-22 19:02:31.069 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:02:31.109 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7340, 7345) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:02:34.720 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 19:02:34.720 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8170])
is_0k: False
your chose emoji: ['ğŸ‘¨ğŸ½\u200dâ¤\u200dğŸ’‹\u200dğŸ‘¨ğŸ¿', 'ğŸ‘¨ğŸ»\u200dğŸ¦°', 'ğŸ‡¹ğŸ‡¬', 'ğŸ§‘ğŸ»\u200dâš•ï¸', 'ğŸ¥', 'ğŸ¤¸', '\U0001faf4ğŸ»', 'ğŸ‘°\u200dâ™€ï¸', 'ğŸ‘¸ğŸ¿', 'ğŸ‘©ğŸ¼\u200dğŸ¦¯\u200dâ¡ï¸']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.74s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.87s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.53s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.15s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.71s/it]
Processing depth (0, 2, 3, 7):   0%|          | 0/100 [00:39<?, ?it/s]2025-01-22 19:02:54.204 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:02:54.205 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the apple.
2025-01-22 19:02:54.205 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:02:54.215 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2004, 2010) -->  cable. Mary journeyed to
2025-01-22 19:02:54.216 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:02:54.233 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2896, 2901) --> . Mary went to the
2025-01-22 19:02:54.233 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:02:54.265 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5776, 5781) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:02:55.057 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 19:02:55.057 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8124])
is_0k: False
your chose emoji: ['ğŸ˜µ', 'ğŸ¤¦ğŸ½\u200dâ™€', 'ğŸ¤¦\u200dâ™€', 'ğŸ¤ğŸ½', 'ğŸ‡ğŸ¼', 'ğŸ¯', 'ğŸ¤', 'ğŸšµğŸ¼\u200dâ™€', 'ğŸ§‘ğŸ¾\u200dğŸ¦²', 'ğŸ™ğŸ½\u200dâ™€']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.92s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.20s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.92s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  3.43s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  4.01s/it]
Processing depth (2, 3, 5, 6):   0%|          | 0/100 [01:00<?, ?it/s]2025-01-22 19:03:15.145 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:03:15.155 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1773, 1778) --> . Mary picked up the
2025-01-22 19:03:15.155 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:03:15.169 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2873, 2879) --> . Mary journeyed to the
2025-01-22 19:03:15.170 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:03:15.190 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4138, 4143) --> . Mary went to the
2025-01-22 19:03:15.190 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:03:15.215 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4585, 4590) -->  John went to the office
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:03:16.017 | INFO     | test_jbb_embedding:begin_test:693 - Mary's garden.<|eot_id|>
2025-01-22 19:03:16.017 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8134])
is_0k: False
your chose emoji: ['ğŸ§Ÿ\u200dâ™‚', 'ğŸ’‡', 'ğŸ’†ğŸ¾\u200dâ™€ï¸', 'ğŸŠğŸ½', 'ğŸ¤½', 'ğŸƒğŸ¼\u200dâ™€\u200dâ¡', 'ğŸ‘¨ğŸ¼\u200dğŸ¦¯', 'ğŸ‘ğŸ½', 'ğŸ¹', 'ğŸ§ğŸ½\u200dâ™‚ï¸']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:05<00:15,  5.21s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.86s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.74s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.34s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.90s/it]
Processing depth (1, 4, 5, 7):   0%|          | 0/100 [01:20<?, ?it/s]2025-01-22 19:03:35.866 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:03:35.871 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (762, 767) -->  Mary picked up the apple
2025-01-22 19:03:35.871 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:03:35.895 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3595, 3601) --> . Mary journeyed to the
2025-01-22 19:03:35.895 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:03:35.918 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4195, 4200) -->  Mary went to the bedroom
2025-01-22 19:03:35.918 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:03:35.951 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5580, 5585) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:03:36.773 | INFO     | test_jbb_embedding:begin_test:693 - Mary's garden.<|eot_id|>
2025-01-22 19:03:36.774 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8122])
is_0k: False
your chose emoji: ['ğŸ˜', 'ğŸ§ğŸ»\u200dâ™‚', 'ğŸšµğŸ¿\u200dâ™‚ï¸', 'ğŸŒ½', 'ğŸ‘©ğŸ¾\u200dğŸ³', 'ğŸ—£', 'ğŸ§­', 'ğŸ˜¾', 'ğŸ˜º', 'ğŸ§ğŸ¼\u200dâ™‚ï¸\u200dâ¡ï¸']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.63s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.68s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.85s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.41s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.90s/it]
Processing depth (2, 4, 8, 9):   0%|          | 0/100 [01:41<?, ?it/s]2025-01-22 19:03:56.533 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:03:56.543 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1998, 2003) -->  cable. Mary picked up
2025-01-22 19:03:56.543 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:03:56.566 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3741, 3747) --> . Mary journeyed to the
2025-01-22 19:03:56.566 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:03:56.609 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6612, 6617) --> . Mary went to the
2025-01-22 19:03:56.609 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:03:56.651 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7231, 7236) -->  cold. John went to
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:03:57.584 | INFO     | test_jbb_embedding:begin_test:693 - Mary picked up the apple.<|eot_id|>
2025-01-22 19:03:57.585 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8140])
is_0k: False
your chose emoji: ['ğŸ‘¨ğŸ»\u200dğŸ¦¼\u200dâ¡', 'ğŸ‹ğŸ¼\u200dâ™€', 'ğŸ¦¹\u200dâ™€ï¸', 'â›ˆï¸', 'â™¦ï¸', 'ğŸ™‹\u200dâ™€ï¸', 'â—', 'ğŸ‡²ğŸ‡³', 'âœŒğŸ¼', 'ğŸ§‘ğŸ¼\u200dâ¤\u200dğŸ§‘ğŸ½']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  3.89s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.84s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.80s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.09s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.65s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (2, 3, 4, 6):   0%|          | 0/100 [02:01<?, ?it/s]2025-01-22 19:04:16.311 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:04:16.322 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1847, 1852) --> . Mary picked up the
2025-01-22 19:04:16.322 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:04:16.337 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2891, 2897) --> . Mary journeyed to the
2025-01-22 19:04:16.337 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:04:16.359 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3622, 3627) --> . Mary went to the
2025-01-22 19:04:16.359 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:04:16.383 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4742, 4747) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:04:19.622 | INFO     | test_jbb_embedding:begin_test:693 - Mary's hand.<|eot_id|>
2025-01-22 19:04:19.622 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8196])
is_0k: False
your chose emoji: ['ğŸ‘±ğŸ¼\u200dâ™‚', 'ğŸ‘¨ğŸ¿\u200dğŸ¼', 'ğŸ‘©ğŸ¿\u200dğŸ¦°', 'ğŸ‡³ğŸ‡«', '\U0001faf1ğŸ»\u200d\U0001faf2ğŸ¾', 'ğŸŒğŸ¼\u200dâ™€', 'ğŸ‡²ğŸ‡¹', 'ğŸ‡¬ğŸ‡¶', 'ğŸ‘©ğŸ»\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘©ğŸ½', 'ğŸ’‡ğŸ¿\u200dâ™‚ï¸']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.73s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.91s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.82s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.48s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.97s/it]
Processing depth (2, 3, 5, 8):   0%|          | 0/100 [02:25<?, ?it/s]2025-01-22 19:04:40.444 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:04:40.454 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1853, 1858) --> . Mary picked up the
2025-01-22 19:04:40.455 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:04:40.471 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2931, 2937) --> . Mary journeyed to the
2025-01-22 19:04:40.471 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:04:40.496 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4217, 4222) -->  Mary went to the bedroom
2025-01-22 19:04:40.496 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:04:40.531 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6498, 6503) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:04:41.367 | INFO     | test_jbb_embedding:begin_test:693 - Mary's garden.<|eot_id|>
2025-01-22 19:04:41.367 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8120])
is_0k: False
your chose emoji: ['â¹ï¸', 'ğŸ§™ğŸ¿', 'ğŸ¡', 'ğŸ’‡ğŸ¼\u200dâ™‚ï¸', 'ğŸ™‹ğŸ»\u200dâ™€ï¸', 'ğŸ¸', 'ğŸ¤ğŸ¾', 'ğŸ¤µğŸ»', 'ğŸ¦¹ğŸ½\u200dâ™€', 'ğŸ']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:05<00:15,  5.12s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.71s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.43s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  2.84s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.51s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (2, 7, 8, 9):   0%|          | 0/100 [02:44<?, ?it/s]2025-01-22 19:04:59.428 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:04:59.437 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1737, 1742) --> . Mary picked up the
2025-01-22 19:04:59.437 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:04:59.466 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5553, 5559) --> . Mary journeyed to the
2025-01-22 19:04:59.466 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:04:59.511 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6504, 6509) --> . Mary went to the
2025-01-22 19:04:59.512 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:04:59.547 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7200, 7205) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:05:04.239 | INFO     | test_jbb_embedding:begin_test:693 - Mary picked up the apple.<|eot_id|>
2025-01-22 19:05:04.239 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8160])
is_0k: False
your chose emoji: ['ğŸ¤·ğŸ»\u200dâ™‚', 'ğŸ‘³ğŸ¼', 'ğŸ™‡ğŸ½\u200dâ™‚ï¸', 'ğŸŒï¸\u200dâ™€ï¸', 'ğŸ›ŒğŸ»', 'ğŸ¤µğŸ½\u200dâ™€', 'ğŸ¤¦ğŸ¾\u200dâ™€', 'ğŸ¤³', '\U0001faf1ğŸ¼\u200d\U0001faf2ğŸ»', 'ğŸŒï¸\u200dâ™‚']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.95s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.04s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.83s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.36s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.94s/it]
Processing depth (3, 4, 6, 9):   0%|          | 0/100 [03:09<?, ?it/s]2025-01-22 19:05:24.764 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:05:24.778 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2911, 2916) --> . Mary picked up the
2025-01-22 19:05:24.779 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:05:24.797 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3608, 3614) -->  Hon. Mary journeyed to
2025-01-22 19:05:24.797 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:05:24.825 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4722, 4727) --> . Mary went to the
2025-01-22 19:05:24.825 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:05:24.865 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7192, 7197) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:05:25.629 | INFO     | test_jbb_embedding:begin_test:693 - the garden<|eot_id|>
2025-01-22 19:05:25.629 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8136])
is_0k: False
your chose emoji: ['ğŸ‘·\u200dâ™‚ï¸', 'ğŸ’ƒğŸ¿', 'ğŸ‘‡', 'ğŸ¤¾ğŸ¾\u200dâ™‚ï¸', 'ğŸš¶ğŸ¾', 'ğŸ¦ª', 'ğŸ§', 'ğŸ‘¨ğŸ¿\u200dğŸ¤\u200dğŸ‘¨ğŸ»', 'â–ª', 'ğŸ™ğŸ¿\u200dâ™€ï¸']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.44s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:10,  5.02s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.96s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.18s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.80s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 4, 5, 6):   0%|          | 0/100 [03:30<?, ?it/s]2025-01-22 19:05:45.206 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:05:45.206 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the apple.
2025-01-22 19:05:45.207 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:05:45.225 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3587, 3593) --> . Mary journeyed to the
2025-01-22 19:05:45.225 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:05:45.245 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4187, 4192) -->  Mary went to the bedroom
2025-01-22 19:05:45.246 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:05:45.270 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4830, 4835) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:05:50.050 | INFO     | test_jbb_embedding:begin_test:693 - Mary picked up the apple.<|eot_id|>
2025-01-22 19:05:50.050 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8146])
is_0k: False
your chose emoji: ['ğŸ¾', 'ğŸ’£', 'ğŸ‘©\u200dğŸ‘§\u200dğŸ‘¦', 'ğŸ™ï¸', 'â˜¢', 'âœŒğŸ¼', '\U0001fae5', 'ğŸ§‘ğŸ¼\u200dğŸ¤\u200dğŸ§‘ğŸ½', 'ğŸ§ğŸ½\u200dâ™‚\u200dâ¡ï¸', 'ğŸ§‘ğŸ¾\u200dğŸ­']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:05<00:15,  5.04s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.03s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.85s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.32s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.92s/it]
Processing depth (1, 2, 4, 5):   0%|          | 0/100 [03:55<?, ?it/s]2025-01-22 19:06:10.186 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:06:10.190 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (895, 900) --> . Mary picked up the
2025-01-22 19:06:10.190 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:06:10.200 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1845, 1851) --> . Mary journeyed to the
2025-01-22 19:06:10.200 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:06:10.219 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3628, 3633) --> . Mary went to the
2025-01-22 19:06:10.220 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:06:10.244 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4243, 4248) -->  John went to the office
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:06:11.077 | INFO     | test_jbb_embedding:begin_test:693 - Mary's hand.<|eot_id|>
2025-01-22 19:06:11.077 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8204])
is_0k: False
your chose emoji: ['\U0001f9cc', 'ğŸ‘¨ğŸ¼\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘¨ğŸ»', '\U0001fac5ğŸ»', 'ğŸ‘¨ğŸ¼\u200dâ¤\u200dğŸ‘¨ğŸ¼', 'ğŸ§‘ğŸ¼\u200dâ¤ï¸\u200dğŸ§‘ğŸ¾', 'ğŸ§›ğŸ¿\u200dâ™€ï¸', 'ğŸ™‹ğŸ¾\u200dâ™‚', 'â°', 'ğŸš¶ğŸ½\u200dâ™€\u200dâ¡ï¸', 'ğŸ™ğŸ¼\u200dâ™€']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.84s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.98s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.54s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  2.93s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.60s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 1, 4, 5):   0%|          | 0/100 [04:14<?, ?it/s]2025-01-22 19:06:29.469 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:06:29.470 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the apple.
2025-01-22 19:06:29.470 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:06:29.475 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (821, 827) --> . Mary journeyed to the
2025-01-22 19:06:29.475 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:06:29.496 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3578, 3583) --> . Mary went to the
2025-01-22 19:06:29.497 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:06:29.517 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4120, 4125) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:06:32.573 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 19:06:32.573 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8098])
is_0k: False
your chose emoji: ['ğŸ‡¼ğŸ‡¸', 'ğŸª£', 'â—¼ï¸', 'ğŸ‹ğŸ¿', 'ğŸ¤ğŸ½', 'ğŸ’‹', 'ãŠ™ï¸', 'â™¨ï¸', 'ğŸ’\u200dâ™‚', 'ğŸ™…ğŸ½\u200dâ™€ï¸']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.77s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.17s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.82s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.34s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.93s/it]
Processing depth (2, 3, 6, 8):   0%|          | 0/100 [04:37<?, ?it/s]2025-01-22 19:06:52.999 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:06:53.011 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1799, 1804) --> . Mary picked up the
2025-01-22 19:06:53.011 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:06:53.027 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2889, 2895) --> . Mary journeyed to the
2025-01-22 19:06:53.028 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:06:53.052 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4804, 4809) -->  the senate. Mary went
2025-01-22 19:06:53.055 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:06:53.095 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6624, 6629) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:06:53.873 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 19:06:53.874 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8164])
is_0k: False
your chose emoji: ['ğŸª', 'â™', 'ğŸ‘©ğŸ¾\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘©ğŸ¼', 'ğŸ§ğŸ¾\u200dâ™€ï¸', 'ğŸ§\u200dâ™‚', 'ğŸ‘¨ğŸ½\u200dğŸ¤\u200dğŸ‘¨ğŸ¼', 'ğŸ‘¨ğŸ¼\u200dâ¤\u200dğŸ‘¨ğŸ»', 'â›ˆï¸', 'ğŸŒ¨', 'ğŸ‘Œ']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.55s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.66s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.63s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.25s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.75s/it]
Processing depth (0, 1, 8, 9):   0%|          | 0/100 [04:57<?, ?it/s]2025-01-22 19:07:12.841 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:07:12.842 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the apple.
2025-01-22 19:07:12.842 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:07:12.846 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (901, 907) --> . Mary journeyed to the
2025-01-22 19:07:12.847 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:07:12.879 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6575, 6580) -->  Mary went to the bedroom
2025-01-22 19:07:12.880 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:07:12.918 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7178, 7183) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:07:13.721 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 19:07:13.721 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8118])
is_0k: False
your chose emoji: ['ğŸ§†', '\U0001f9cc', 'âœ', 'ğŸŠ', '\U0001faf4ğŸ¿', 'ğŸ‘¨ğŸ½\u200dğŸ¦¼\u200dâ¡', 'ğŸ¤¹ğŸ¾\u200dâ™€', 'â›¹ğŸ¼\u200dâ™€', 'ğŸ', 'ğŸ•µï¸\u200dâ™€ï¸']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.85s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.07s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.98s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  3.46s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  4.02s/it]
Processing depth (0, 1, 2, 5):   0%|          | 0/100 [05:19<?, ?it/s]2025-01-22 19:07:34.205 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:07:34.206 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the apple.
2025-01-22 19:07:34.206 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:07:34.211 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (812, 818) -->  Mary journeyed to the garden
2025-01-22 19:07:34.211 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:07:34.223 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1830, 1835) --> . Mary went to the
2025-01-22 19:07:34.223 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:07:34.244 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4170, 4175) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:07:35.052 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 19:07:35.053 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8152])
is_0k: False
your chose emoji: ['ğŸ¤½ğŸ¾\u200dâ™‚', 'â˜€ï¸', 'â¤µï¸', 'ğŸ§ğŸ¿\u200dâ™€ï¸', 'ğŸ§šğŸ¾\u200dâ™€ï¸', 'ğŸ¤¹ğŸ¾\u200dâ™€', 'ğŸ‘©ğŸ»\u200dâ¤\u200dğŸ’‹\u200dğŸ‘©ğŸ»', 'â˜˜', 'ğŸ™‡ğŸ½\u200dâ™€ï¸', 'ğŸ›„']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.51s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.94s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.80s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.07s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.70s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 5, 6, 9):   0%|          | 0/100 [05:38<?, ?it/s]2025-01-22 19:07:53.883 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:07:53.883 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the apple.
2025-01-22 19:07:53.883 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:07:53.904 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4202, 4208) -->  Mary journeyed to the garden
2025-01-22 19:07:53.905 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:07:53.928 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4828, 4833) --> . Mary went to the
2025-01-22 19:07:53.929 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:07:53.965 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7352, 7357) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:07:58.658 | INFO     | test_jbb_embedding:begin_test:693 - Mary picked up the apple.<|eot_id|>
2025-01-22 19:07:58.658 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8184])
is_0k: False
your chose emoji: ['ğŸ³', 'ğŸ‘¨ğŸ»\u200dâœˆï¸', 'ğŸ§ğŸ»\u200dâ™€ï¸', 'ğŸ¦Ÿ', 'ğŸ‘©ğŸ½\u200dâ¤\u200dğŸ‘©ğŸ¼', 'ğŸ¦¿', 'ğŸ‘©ğŸ¿\u200dâ¤\u200dğŸ’‹\u200dğŸ‘©ğŸ¾', 'ğŸ•ï¸', 'ğŸ¤°ğŸ½', 'ğŸ§‘ğŸ¿\u200dâ¤\u200dğŸ’‹\u200dğŸ§‘ğŸ»']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.58s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.72s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.88s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.40s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.90s/it]
Processing depth (3, 5, 6, 9):   0%|          | 0/100 [06:03<?, ?it/s]2025-01-22 19:08:18.967 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:08:18.985 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2941, 2946) --> . Mary picked up the
2025-01-22 19:08:18.985 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:08:19.011 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4244, 4250) -->  Mary journeyed to the garden
2025-01-22 19:08:19.012 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:08:19.037 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4766, 4771) --> . Mary went to the
2025-01-22 19:08:19.038 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:08:19.074 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7157, 7162) -->  John went to the office
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:08:19.849 | INFO     | test_jbb_embedding:begin_test:693 - the garden<|eot_id|>
2025-01-22 19:08:19.849 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8200])
is_0k: False
your chose emoji: ['ğŸ‘©ğŸ»\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘©ğŸ¾', 'ğŸ¡', 'âºï¸', 'ğŸ–•ğŸ¾', 'ğŸ‘¨ğŸ»\u200dğŸ¤\u200dğŸ‘¨ğŸ¼', 'ğŸ§ğŸ¿\u200dâ™‚ï¸', 'ğŸ‘©ğŸ½\u200dğŸ¦²', 'ğŸ¤´ğŸ½', 'ğŸ‘¨ğŸ¿\u200dâ¤ï¸\u200dğŸ‘¨ğŸ½', 'ğŸ¤±ğŸ»']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.05s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.61s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.28s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.77s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.35s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (3, 4, 5, 8):   0%|          | 0/100 [06:22<?, ?it/s]2025-01-22 19:08:37.265 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:08:37.280 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2750, 2755) -->  Mary picked up the apple
2025-01-22 19:08:37.280 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:08:37.301 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3585, 3591) --> . Mary journeyed to the
2025-01-22 19:08:37.301 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:08:37.322 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4148, 4153) --> . Mary went to the
2025-01-22 19:08:37.322 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:08:37.354 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6596, 6601) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:08:57.873 | INFO     | test_jbb_embedding:begin_test:693 - ğŸ‘¨ğŸ»â€ğŸŒ¾ğŸ‘¨ğŸ»â€ğŸŒ¾<|eot_id|>
2025-01-22 19:08:57.874 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8142])
is_0k: False
your chose emoji: ['ğŸ§ğŸ½\u200dâ™€ï¸', 'ğŸ‘¨ğŸ»\u200dğŸŒ¾', 'ğŸ¾', 'ğŸ‘©ğŸ»\u200dâš–', 'ğŸš¶ğŸ»\u200dâ™€ï¸\u200dâ¡', 'ğŸƒğŸ¿\u200dâ¡ï¸', 'ğŸ™‚\u200dâ†”ï¸', 'ğŸ¥', 'ğŸ§', 'ğŸ’Š']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.75s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:10,  5.04s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.82s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.38s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.93s/it]
Processing depth (0, 3, 7, 9):   0%|          | 0/100 [07:03<?, ?it/s]2025-01-22 19:09:18.299 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:09:18.300 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the apple.
2025-01-22 19:09:18.300 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:09:18.322 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2877, 2883) --> . Mary journeyed to the
2025-01-22 19:09:18.322 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:09:18.353 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5586, 5591) --> . Mary went to the
2025-01-22 19:09:18.353 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:09:18.393 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7109, 7114) -->  John went to the office
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:09:19.286 | INFO     | test_jbb_embedding:begin_test:693 - Mary picked up the apple.<|eot_id|>
2025-01-22 19:09:19.286 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8146])
is_0k: False
your chose emoji: ['ğŸ‘', 'ğŸ‡¹ğŸ‡«', 'ğŸ‘®ğŸ¾', 'ğŸ‘©ğŸ»\u200dâ¤ï¸\u200dğŸ‘©ğŸ½', 'ğŸ‘©ğŸ»\u200dğŸ¦³', 'ğŸ––ğŸ½', 'ğŸ”µ', 'ğŸ’‡ğŸ¾\u200dâ™€ï¸', 'ğŸš´ğŸ¾\u200dâ™‚ï¸', 'ğŸ¤¦']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:05<00:15,  5.15s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.89s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.87s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.45s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.99s/it]
Processing depth (0, 1, 3, 6):   0%|          | 0/100 [07:24<?, ?it/s]2025-01-22 19:09:39.549 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:09:39.550 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the apple.
2025-01-22 19:09:39.550 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:09:39.554 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (821, 827) --> . Mary journeyed to the
2025-01-22 19:09:39.554 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:09:39.568 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2832, 2837) --> . Mary went to the
2025-01-22 19:09:39.568 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:09:39.594 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4720, 4725) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:09:40.382 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 19:09:40.382 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8146])
is_0k: False
your chose emoji: ['ğŸ™ŒğŸ¾', 'ğŸ‘©ğŸ¾\u200dğŸ¦¯', 'ğŸš‘', '8ï¸âƒ£', 'ğŸ’ğŸ¿', 'ğŸ§‘ğŸ¾\u200dğŸ¦¼\u200dâ¡', 'ğŸ–²', 'ğŸ§ğŸ¿\u200dâ™‚', 'ğŸ‘¨ğŸ¿\u200dâœˆ', 'ğŸ‘©\u200dğŸ¤']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.48s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.80s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.80s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.29s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.82s/it]
Processing depth (0, 2, 7, 9):   0%|          | 0/100 [07:45<?, ?it/s]2025-01-22 19:10:00.649 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:10:00.649 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the apple.
2025-01-22 19:10:00.650 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:10:00.659 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1863, 1869) --> . Mary journeyed to the
2025-01-22 19:10:00.659 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:10:00.689 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5606, 5611) --> . Mary went to the
2025-01-22 19:10:00.690 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:10:00.728 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7214, 7219) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:10:01.625 | INFO     | test_jbb_embedding:begin_test:693 - Mary picked up the apple.<|eot_id|>
2025-01-22 19:10:01.625 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8158])
is_0k: False
your chose emoji: ['ğŸ‘¨ğŸ¿\u200dğŸ¦²', 'ğŸ§ğŸ¾\u200dâ™€\u200dâ¡', 'ğŸ™', 'ğŸ§™ğŸ½\u200dâ™‚ï¸', 'ğŸ‘±\u200dâ™€', 'ğŸ§–ğŸ¾\u200dâ™€', 'ğŸ¤¦ğŸ½\u200dâ™‚', 'â›¹ğŸ¼\u200dâ™‚', 'ğŸ’‚ğŸ¼\u200dâ™€ï¸', 'ğŸ¦°']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.14s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.83s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.63s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  2.97s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.57s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (1, 2, 3, 8):   0%|          | 0/100 [08:05<?, ?it/s]2025-01-22 19:10:20.154 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:10:20.159 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (789, 794) --> . Mary picked up the
2025-01-22 19:10:20.159 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:10:20.170 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1759, 1765) --> . Mary journeyed to the
2025-01-22 19:10:20.170 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:10:20.184 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2876, 2881) --> . Mary went to the
2025-01-22 19:10:20.184 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:10:20.220 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6646, 6651) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:10:23.730 | INFO     | test_jbb_embedding:begin_test:693 - Mary's garden.<|eot_id|>
2025-01-22 19:10:23.730 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8214])
is_0k: False
your chose emoji: ['ğŸ‘¨ğŸ½\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘¨ğŸ»', 'ğŸ‘¨ğŸ¿\u200dğŸŒ¾', 'ğŸƒğŸ¿\u200dâ™€\u200dâ¡', 'ğŸ‘©ğŸ½\u200dğŸ¦¯\u200dâ¡ï¸', 'ğŸ‘¨\u200dğŸ­', 'ğŸ‘¨ğŸ¼\u200dâ¤\u200dğŸ‘¨ğŸ½', 'ğŸ™‡\u200dâ™€ï¸', 'ğŸ§–ğŸ»\u200dâ™€ï¸', 'ğŸ§‘ğŸ¾\u200dğŸš€', 'ğŸ€']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.70s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.79s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.75s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.42s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.91s/it]
Processing depth (4, 6, 7, 9):   0%|          | 0/100 [08:28<?, ?it/s]2025-01-22 19:10:43.828 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:10:43.850 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3601, 3606) --> . Mary picked up the
2025-01-22 19:10:43.851 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:10:43.876 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4730, 4736) -->  Mary journeyed to the garden
2025-01-22 19:10:43.877 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:10:43.915 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5609, 5614) -->  Mary went to the bedroom
2025-01-22 19:10:43.916 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:10:43.957 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7119, 7124) -->  John went to the office
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:10:44.746 | INFO     | test_jbb_embedding:begin_test:693 - Mary's hand<|eot_id|>
2025-01-22 19:10:44.746 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8162])
is_0k: False
your chose emoji: ['ğŸ•µğŸ¼', 'ğŸ‘¨ğŸ½\u200dğŸ¦³', 'ğŸ§‘ğŸ½\u200dğŸ¦½', 'ğŸ‡¸ğŸ‡°', 'ğŸ‘©ğŸ»\u200dğŸ”¬', 'ğŸ‡°ğŸ‡¾', 'ğŸ‘©ğŸ¾\u200dğŸ¦½\u200dâ¡', 'ğŸ¤·', 'ğŸ™ğŸ½\u200dâ™€', 'ğŸ‡ºğŸ‡¿']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:05<00:15,  5.08s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.92s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.61s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.24s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.81s/it]
Processing depth (5, 6, 7, 8):   0%|          | 0/100 [08:49<?, ?it/s]2025-01-22 19:11:04.087 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:11:04.110 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4113, 4118) --> . Mary picked up the
2025-01-22 19:11:04.111 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:11:04.137 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4562, 4568) -->  Mary journeyed to the garden
2025-01-22 19:11:04.137 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:11:04.165 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5524, 5529) --> . Mary went to the
2025-01-22 19:11:04.165 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:11:04.201 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6474, 6479) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:11:05.004 | INFO     | test_jbb_embedding:begin_test:693 - Mary's hand.<|eot_id|>
2025-01-22 19:11:05.004 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8110])
is_0k: False
your chose emoji: ['â€¼ï¸', 'âœğŸ½', 'ğŸ•ï¸', 'ğŸ—ºï¸', 'ğŸ¤©', 'ğŸ¤¾ğŸ½\u200dâ™€ï¸', 'ğŸ‘', 'ğŸ§œğŸ»', 'ğŸ¤·\u200dâ™‚ï¸', 'â›¹ğŸ¿\u200dâ™€']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.17s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.75s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.78s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.37s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.84s/it]
Processing depth (3, 5, 7, 8):   0%|          | 0/100 [09:09<?, ?it/s]2025-01-22 19:11:24.304 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:11:24.318 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2837, 2842) --> . Mary picked up the
2025-01-22 19:11:24.318 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:11:24.339 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4103, 4109) --> . Mary journeyed to the
2025-01-22 19:11:24.339 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:11:24.366 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5452, 5457) --> . Mary went to the
2025-01-22 19:11:24.366 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:11:24.399 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6480, 6485) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:11:25.298 | INFO     | test_jbb_embedding:begin_test:693 - Mary picked up the apple.<|eot_id|>
2025-01-22 19:11:25.298 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8140])
is_0k: False
your chose emoji: ['ğŸ¯', 'ğŸ‡¼ğŸ‡¸', 'ğŸ‡®ğŸ‡¸', 'ğŸ¤½ğŸ¾\u200dâ™‚', 'ğŸ§‘ğŸ¼\u200dâ¤\u200dğŸ§‘ğŸ½', 'ğŸ‘©ğŸ¾\u200dğŸ’»', 'âŒ', 'ğŸ‘©ğŸ¾\u200dğŸ¼', 'ğŸ‘®ğŸ½', 'â¤´']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.12s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.49s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.54s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.95s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.49s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 5, 8, 9):   0%|          | 0/100 [09:28<?, ?it/s]2025-01-22 19:11:43.260 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:11:43.260 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the apple.
2025-01-22 19:11:43.261 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:11:43.287 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4266, 4272) -->  Mary journeyed to the garden
2025-01-22 19:11:43.288 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:11:43.328 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6658, 6663) --> . Mary went to the
2025-01-22 19:11:43.329 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:11:43.366 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7297, 7302) -->  cold. John went to
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:11:46.122 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 19:11:46.122 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8202])
is_0k: False
your chose emoji: ['â™‚', 'ğŸ‘©ğŸ¼\u200dğŸ¤\u200dğŸ‘¨ğŸ¾', 'ğŸ§ğŸ¾\u200dâ™‚ï¸\u200dâ¡ï¸', 'ğŸ¦¹ğŸ¼\u200dâ™€', 'ğŸ‘¨ğŸ¾\u200dğŸ¦±', 'ğŸ§ğŸ»', 'ğŸ§‘ğŸ»\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ§‘ğŸ¾', 'ğŸ‘©ğŸ¼\u200dâ¤\u200dğŸ‘¨ğŸ½', 'ğŸš‚', 'âš–ï¸']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.59s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.99s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.95s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  3.50s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  4.01s/it]
Processing depth (2, 5, 6, 9):   0%|          | 0/100 [09:51<?, ?it/s]2025-01-22 19:12:06.703 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:12:06.712 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1743, 1748) --> . Mary picked up the
2025-01-22 19:12:06.712 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:12:06.733 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4141, 4147) --> . Mary journeyed to the
2025-01-22 19:12:06.733 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:12:06.757 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4752, 4757) -->  the senate. Mary went
2025-01-22 19:12:06.757 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:12:06.793 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7184, 7189) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:12:07.579 | INFO     | test_jbb_embedding:begin_test:693 - Mary's hand<|eot_id|>
2025-01-22 19:12:07.580 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8122])
is_0k: False
your chose emoji: ['8ï¸âƒ£', 'ğŸ›ƒ', 'ğŸ–±', 'ğŸ§\u200dâ™‚', 'â›¹ğŸ¿', 'ğŸ‹ğŸ¼\u200dâ™‚ï¸', 'ğŸ‘©ğŸ½\u200dğŸš€', 'ğŸ§“ğŸ¿', 'ğŸ‘ƒ', 'ğŸ™ŒğŸ¿']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.66s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:10,  5.01s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:05,  5.01s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  3.46s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  4.00s/it]
Processing depth (2, 3, 8, 9):   0%|          | 0/100 [10:12<?, ?it/s]2025-01-22 19:12:27.666 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:12:27.675 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1789, 1794) --> . Mary picked up the
2025-01-22 19:12:27.675 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:12:27.692 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2877, 2883) --> . Mary journeyed to the
2025-01-22 19:12:27.692 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:12:27.726 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6509, 6514) -->  Mary went to the bedroom
2025-01-22 19:12:27.726 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:12:27.766 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7113, 7118) -->  John went to the office
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:12:28.532 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 19:12:28.532 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8156])
is_0k: False
your chose emoji: ['ğŸ‡³ğŸ‡®', 'ğŸ•µ\u200dâ™€', 'ğŸ‘\u200dğŸ—¨', 'ğŸ‘©ğŸ¿\u200dâ¤\u200dğŸ’‹\u200dğŸ‘©ğŸ¾', 'ğŸ§‘\u200dğŸ“', 'ğŸ§‘ğŸ¾\u200dğŸ¦¼', 'ğŸª ', 'ğŸ´', 'ğŸ‘°ğŸ½\u200dâ™‚ï¸', 'ğŸ¤¹ğŸ½']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.41s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.82s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.71s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.30s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.81s/it]
Processing depth (0, 4, 7, 9):   0%|          | 0/100 [10:32<?, ?it/s]2025-01-22 19:12:47.664 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:12:47.664 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the apple.
2025-01-22 19:12:47.665 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:12:47.687 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3641, 3647) --> . Mary journeyed to the
2025-01-22 19:12:47.687 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:12:47.716 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5724, 5729) --> . Mary went to the
2025-01-22 19:12:47.716 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:12:47.752 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7209, 7214) -->  John went to the office
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:12:48.642 | INFO     | test_jbb_embedding:begin_test:693 - Mary picked up the apple.<|eot_id|>
2025-01-22 19:12:48.643 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8150])
is_0k: False
your chose emoji: ['ğŸ§”ğŸ¿', 'ğŸ‘¨ğŸ¼\u200dâ¤\u200dğŸ’‹\u200dğŸ‘¨ğŸ½', 'ğŸŒ', 'ğŸš°', '\U0001faf1ğŸ¼\u200d\U0001faf2ğŸ»', 'â„¹', 'ğŸ›¤', 'ğŸ§ğŸ»\u200dâ™‚ï¸', 'ğŸ‡·ğŸ‡¸', 'ğŸ’†ğŸ½\u200dâ™‚']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:05<00:15,  5.04s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.04s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.66s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.22s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.82s/it]
Processing depth (0, 3, 5, 6):   0%|          | 0/100 [10:52<?, ?it/s]2025-01-22 19:13:07.900 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:13:07.900 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the apple.
2025-01-22 19:13:07.901 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:13:07.915 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2867, 2873) --> . Mary journeyed to the
2025-01-22 19:13:07.915 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:13:07.936 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4201, 4206) -->  Mary went to the bedroom
2025-01-22 19:13:07.937 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:13:07.960 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4708, 4713) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:13:08.841 | INFO     | test_jbb_embedding:begin_test:693 - Mary picked up the apple.<|eot_id|>
2025-01-22 19:13:08.841 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8134])
is_0k: False
your chose emoji: ['ğŸ§˜ğŸ¿', 'ğŸ‡µğŸ‡¾', 'ğŸ‘©ğŸ¾\u200dğŸ¦¯\u200dâ¡ï¸', 'ğŸ‘¨ğŸ½\u200dğŸ¦¯', 'ğŸ§™\u200dâ™€ï¸', 'ğŸ¥‚', 'â†–ï¸', 'ğŸ‘¨\u200dğŸ”§', 'ğŸ¬', 'ğŸ¦¹ğŸ½']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.93s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.07s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.88s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.38s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.96s/it]
Processing depth (1, 5, 6, 7):   0%|          | 0/100 [11:13<?, ?it/s]2025-01-22 19:13:28.674 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:13:28.678 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (823, 828) --> . Mary picked up the
2025-01-22 19:13:28.678 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:13:28.699 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4188, 4194) -->  Mary journeyed to the garden
2025-01-22 19:13:28.700 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:13:28.723 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4738, 4743) -->  the senate. Mary went
2025-01-22 19:13:28.723 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:13:28.756 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5694, 5699) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:13:29.556 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 19:13:29.556 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8126])
is_0k: False
your chose emoji: ['ğŸ‘©\u200dğŸ¦²', 'ğŸ™‹', 'ğŸ§œğŸ¿\u200dâ™‚', 'ğŸ•¸ï¸', 'ğŸ™ğŸ¿\u200dâ™€', 'ğŸ¤µğŸ¼\u200dâ™‚', 'ğŸ‡¹ğŸ‡²', 'ğŸš£ğŸ½\u200dâ™€', 'ğŸ¤', 'ğŸ¦½']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.41s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.66s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.68s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.27s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.76s/it]
Processing depth (0, 3, 4, 6):   0%|          | 0/100 [11:33<?, ?it/s]2025-01-22 19:13:48.617 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:13:48.617 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the apple.
2025-01-22 19:13:48.617 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:13:48.636 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2913, 2919) --> . Mary journeyed to the
2025-01-22 19:13:48.636 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:13:48.656 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3597, 3602) -->  Hon. Mary went to
2025-01-22 19:13:48.656 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:13:48.682 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4622, 4627) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:13:49.576 | INFO     | test_jbb_embedding:begin_test:693 - Mary picked up the apple.<|eot_id|>
2025-01-22 19:13:49.576 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8152])
is_0k: False
your chose emoji: ['ğŸ‘©ğŸ½\u200dâ¤\u200dğŸ’‹\u200dğŸ‘¨ğŸ¾', 'ğŸª¨', 'âœ´ï¸', 'ğŸŒ‘', 'ğŸ§‘ğŸ»\u200dğŸ¦¯\u200dâ¡ï¸', 'ğŸ™ğŸ¿\u200dâ™‚', 'ğŸ‘‰ğŸ½', 'ğŸ•§', 'ğŸ‘¸ğŸ»', 'ğŸ§™ğŸ¼\u200dâ™‚']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.61s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.65s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.47s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.14s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.66s/it]
Processing depth (0, 3, 5, 9):   0%|          | 0/100 [11:53<?, ?it/s]2025-01-22 19:14:08.621 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:14:08.622 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the apple.
2025-01-22 19:14:08.622 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:14:08.639 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2873, 2879) --> . Mary journeyed to the
2025-01-22 19:14:08.640 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:14:08.665 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4150, 4155) --> . Mary went to the
2025-01-22 19:14:08.665 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:14:08.701 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7205, 7210) -->  John went to the office
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:14:09.557 | INFO     | test_jbb_embedding:begin_test:693 - Mary picked up the apple.<|eot_id|>
2025-01-22 19:14:09.557 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8174])
is_0k: False
your chose emoji: ['ğŸ®', 'ğŸ’‚ğŸ¼\u200dâ™€', 'ğŸƒğŸ½', 'ğŸ¦¹\u200dâ™€ï¸', 'ğŸ§‘ğŸ»\u200dğŸ“', '\U0001faf4ğŸ¼', 'ğŸ¤', 'ğŸ§šğŸ¼\u200dâ™‚', 'ğŸ‘©ğŸ½\u200dâ¤\u200dğŸ‘©ğŸ¿', 'ğŸ‘©ğŸ»\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘¨ğŸ¿']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.86s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.99s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.88s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.37s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.93s/it]
Processing depth (0, 1, 6, 7):   0%|          | 0/100 [12:14<?, ?it/s]2025-01-22 19:14:29.252 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:14:29.252 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the apple.
2025-01-22 19:14:29.252 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:14:29.257 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (784, 790) -->  Mary journeyed to the garden
2025-01-22 19:14:29.257 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:14:29.280 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4760, 4765) --> . Mary went to the
2025-01-22 19:14:29.281 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:14:29.313 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5642, 5647) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:14:30.128 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 19:14:30.128 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8200])
is_0k: False
your chose emoji: ['ğŸ§˜ğŸ½\u200dâ™‚ï¸', 'ğŸ‡', 'ğŸ˜µ\u200dğŸ’«', 'ğŸ§ğŸ½\u200dâ™€ï¸', 'ğŸ§ğŸ½\u200dâ™€\u200dâ¡ï¸', 'ğŸ‘¨ğŸ»\u200dâ¤\u200dğŸ‘¨ğŸ¾', 'ğŸ¤·ğŸ¾\u200dâ™‚ï¸', 'ğŸ‘¨ğŸ¾\u200dğŸ¤\u200dğŸ‘¨ğŸ¼', 'ğŸ‘¨ğŸ½\u200dâš•ï¸', 'ğŸ„\u200dâ™€']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.87s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:11<00:11,  5.62s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.84s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.08s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.83s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (1, 4, 6, 8):   0%|          | 0/100 [12:34<?, ?it/s]2025-01-22 19:14:49.453 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:14:49.458 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (895, 900) --> . Mary picked up the
2025-01-22 19:14:49.458 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:14:49.477 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3611, 3617) --> . Mary journeyed to the
2025-01-22 19:14:49.477 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:14:49.501 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4762, 4767) -->  the senate. Mary went
2025-01-22 19:14:49.501 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:14:49.534 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6622, 6627) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:14:54.612 | INFO     | test_jbb_embedding:begin_test:693 - Mary's garden.<|eot_id|>
2025-01-22 19:14:54.613 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8162])
is_0k: False
your chose emoji: ['ğŸ¦¶ğŸ»', 'ğŸ§ğŸ¾\u200dâ™‚ï¸', 'ğŸ–¨ï¸', 'ğŸ¶', 'ğŸ§”ğŸ¼\u200dâ™‚', 'ğŸ§‘ğŸ»\u200dâ¤ï¸\u200dğŸ§‘ğŸ¿', 'ğŸ“š', 'ğŸ§‘ğŸ¼\u200dâ¤\u200dğŸ’‹\u200dğŸ§‘ğŸ¾', 'ğŸ¦¶ğŸ¾', 'ğŸ¯']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.54s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.77s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.94s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.51s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.98s/it]
Processing depth (4, 5, 6, 7):   0%|          | 0/100 [13:00<?, ?it/s]2025-01-22 19:15:15.480 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:15:15.498 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3598, 3603) -->  Hon. Mary picked up
2025-01-22 19:15:15.499 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:15:15.521 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4111, 4117) --> . Mary journeyed to the
2025-01-22 19:15:15.521 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:15:15.549 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4696, 4701) --> . Mary went to the
2025-01-22 19:15:15.550 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:15:15.578 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5576, 5581) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:15:16.318 | INFO     | test_jbb_embedding:begin_test:693 - the garden<|eot_id|>
2025-01-22 19:15:16.319 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8116])
is_0k: False
your chose emoji: ['ğŸ‘®ğŸ¼', 'ğŸš£ğŸ¿\u200dâ™€', 'ğŸ’…ğŸ½', 'ğŸ¨', 'ğŸ³\u200dâš§ï¸', 'âœ‚', 'ğŸ–¨ï¸', 'â›¸ï¸', 'ğŸ™ğŸ¼', 'ğŸ§ğŸ»\u200dâ™‚']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  3.80s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.42s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.47s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.88s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.41s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (2, 3, 4, 8):   0%|          | 0/100 [13:19<?, ?it/s]2025-01-22 19:15:34.040 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:15:34.050 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1802, 1807) -->  Mary picked up the apple
2025-01-22 19:15:34.051 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:15:34.084 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2891, 2897) --> . Mary journeyed to the
2025-01-22 19:15:34.084 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:15:34.106 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3617, 3622) -->  Mary went to the bedroom
2025-01-22 19:15:34.106 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:15:34.144 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6595, 6600) -->  John went to the office
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:15:37.805 | INFO     | test_jbb_embedding:begin_test:693 - Mary's garden.<|eot_id|>
2025-01-22 19:15:37.805 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8146])
is_0k: False
your chose emoji: ['ğŸ‡µğŸ‡­', 'ğŸ¤½ğŸ½', 'ğŸŠğŸ¾\u200dâ™‚ï¸', 'ğŸƒğŸ½\u200dâ™€\u200dâ¡', 'â˜£', 'ğŸƒ\u200dâ¡ï¸', 'ğŸ•µğŸ½\u200dâ™€', 'ğŸ‡»ğŸ‡º', 'ğŸ§‘ğŸ»\u200dâš•ï¸', 'ğŸ‘']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:05<00:16,  5.35s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.41s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:15<00:05,  5.11s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  3.45s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  4.11s/it]
Processing depth (0, 6, 7, 9):   0%|          | 0/100 [13:43<?, ?it/s]2025-01-22 19:15:58.700 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:15:58.701 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the apple.
2025-01-22 19:15:58.701 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:15:58.725 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4697, 4703) --> . Mary journeyed to the
2025-01-22 19:15:58.725 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:15:58.753 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5618, 5623) --> . Mary went to the
2025-01-22 19:15:58.753 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:15:58.789 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7316, 7321) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:15:59.683 | INFO     | test_jbb_embedding:begin_test:693 - Mary picked up the apple.<|eot_id|>
2025-01-22 19:15:59.683 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8154])
is_0k: False
your chose emoji: ['ğŸ”’', 'ğŸ‘©ğŸ¼\u200dâš•', 'ğŸ’', 'ğŸƒğŸ»\u200dâ™€ï¸\u200dâ¡ï¸', 'ğŸ‡ªğŸ‡·', 'ğŸ‘©ğŸ¼\u200dâ¤\u200dğŸ‘©ğŸ¿', 'ğŸ•´ğŸ»', 'ğŸ›°ï¸', 'ğŸ§\u200dâ™‚', 'â›¹ğŸ¿\u200dâ™‚']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.80s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.21s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.80s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.37s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.95s/it]
Processing depth (3, 4, 6, 7):   0%|          | 0/100 [14:04<?, ?it/s]2025-01-22 19:16:19.454 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:16:19.470 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2917, 2922) --> . Mary picked up the
2025-01-22 19:16:19.470 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:16:19.491 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3602, 3608) -->  Hon. Mary journeyed to
2025-01-22 19:16:19.491 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:16:19.516 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4848, 4853) --> . Mary went to the
2025-01-22 19:16:19.516 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:16:19.547 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5632, 5637) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:16:20.309 | INFO     | test_jbb_embedding:begin_test:693 - the garden<|eot_id|>
2025-01-22 19:16:20.310 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8148])
is_0k: False
your chose emoji: ['ğŸ‡¸ğŸ‡¦', 'ğŸ‘©ğŸ½\u200dğŸ³', 'ğŸ‘¨ğŸ½\u200dâ¤\u200dğŸ’‹\u200dğŸ‘¨ğŸ»', 'ğŸ™‹\u200dâ™€ï¸', 'ğŸ¤Ÿ', 'ğŸ§‘ğŸ¿\u200dâ¤\u200dğŸ§‘ğŸ»', '\U0001fa8f', 'ğŸ–ï¸', 'â™¿', 'ğŸŸï¸']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.82s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.93s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.67s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.32s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.86s/it]
Processing depth (2, 4, 6, 7):   0%|          | 0/100 [14:24<?, ?it/s]2025-01-22 19:16:39.797 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:16:39.806 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1787, 1792) --> . Mary picked up the
2025-01-22 19:16:39.807 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:16:39.825 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3610, 3616) -->  Hon. Mary journeyed to
2025-01-22 19:16:39.825 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:16:39.851 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4774, 4779) -->  the senate. Mary went
2025-01-22 19:16:39.851 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:16:39.882 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5616, 5621) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:16:40.628 | INFO     | test_jbb_embedding:begin_test:693 - the garden<|eot_id|>
2025-01-22 19:16:40.628 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8156])
is_0k: False
your chose emoji: ['ğŸ¤±ğŸ¿', 'ğŸ‡ªğŸ‡ª', 'ğŸ§š\u200dâ™‚', 'ğŸ¤¹ğŸ»\u200dâ™€ï¸', 'ğŸ‘©ğŸ¿', 'ğŸ‹\u200dâ™‚', 'ğŸ§‘ğŸ¾\u200dâ¤\u200dğŸ’‹\u200dğŸ§‘ğŸ»', 'ğŸ‘ğŸ¾', 'â›¹ğŸ»', 'ğŸ¤³ğŸ¿']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.36s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.48s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.54s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.25s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.70s/it]
Processing depth (3, 4, 5, 7):   0%|          | 0/100 [14:44<?, ?it/s]2025-01-22 19:16:59.847 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:16:59.862 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2871, 2876) --> . Mary picked up the
2025-01-22 19:16:59.862 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:16:59.886 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3592, 3598) -->  Mary journeyed to the garden
2025-01-22 19:16:59.887 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:16:59.914 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4191, 4196) -->  Mary went to the bedroom
2025-01-22 19:16:59.914 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:16:59.944 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5584, 5589) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:17:00.748 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 19:17:00.748 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8164])
is_0k: False
your chose emoji: ['ğŸ‘©ğŸ»\u200dğŸ“', 'ğŸ¤½\u200dâ™‚', 'ğŸ‘©ğŸ½\u200dâ¤\u200dğŸ‘¨ğŸ¾', 'ğŸ‘¾', 'ğŸ•¶ï¸', 'ğŸ¤·ğŸ»\u200dâ™€', 'ğŸ™ğŸ¼\u200dâ™€ï¸', 'ğŸ§”ğŸ½', 'ğŸ—ï¸', 'ğŸ‘¨ğŸ½\u200dğŸ¦¯\u200dâ¡ï¸']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.52s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.60s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.54s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.16s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.67s/it]
Processing depth (3, 4, 5, 9):   0%|          | 0/100 [15:04<?, ?it/s]2025-01-22 19:17:19.413 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:17:19.427 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2881, 2886) --> . Mary picked up the
2025-01-22 19:17:19.428 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:17:19.448 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3631, 3637) --> . Mary journeyed to the
2025-01-22 19:17:19.448 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:17:19.471 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4184, 4189) --> . Mary went to the
2025-01-22 19:17:19.472 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:17:19.512 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7216, 7221) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:17:20.320 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 19:17:20.320 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8154])
is_0k: False
your chose emoji: ['ğŸ‘©ğŸ¿\u200dğŸ¦²', 'ğŸ¦‰', 'ğŸŠ\u200dâ™‚ï¸', 'ğŸ„\u200dğŸŸ«', 'ğŸ‘¨ğŸ½\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘¨ğŸ¼', 'ğŸ¤°ğŸ»', 'ğŸ§—ğŸ»\u200dâ™‚ï¸', 'ğŸŸª', 'ğŸš’', 'ğŸ‘²ğŸ¾']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.78s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  5.00s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.89s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.42s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.96s/it]
Processing depth (0, 3, 4, 5):   0%|          | 0/100 [15:25<?, ?it/s]2025-01-22 19:17:40.647 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:17:40.647 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the apple.
2025-01-22 19:17:40.648 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:17:40.666 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2935, 2941) --> . Mary journeyed to the
2025-01-22 19:17:40.666 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:17:40.684 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3638, 3643) --> . Mary went to the
2025-01-22 19:17:40.685 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:17:40.706 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4256, 4261) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:17:41.613 | INFO     | test_jbb_embedding:begin_test:693 - Mary picked up the apple.<|eot_id|>
2025-01-22 19:17:41.613 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8184])
is_0k: False
your chose emoji: ['ğŸ‘©ğŸ¾\u200dğŸ¤\u200dğŸ‘©ğŸ½', '\U0001fac4ğŸ½', 'ğŸ‘¼ğŸ¼', 'ğŸ’‡ğŸ¼\u200dâ™‚ï¸', 'ğŸ‘©ğŸ½\u200dğŸ¦¼\u200dâ¡ï¸', 'ğŸ§Ÿ\u200dâ™‚ï¸', 'â›¹ğŸ½\u200dâ™‚ï¸', 'ğŸš¶ğŸ¾\u200dâ™€ï¸\u200dâ¡', 'ğŸ™‹\u200dâ™€', '\U0001fa76']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.41s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.47s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.80s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.28s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.77s/it]
Processing depth (1, 2, 4, 9):   0%|          | 0/100 [15:45<?, ?it/s]2025-01-22 19:18:00.582 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:18:00.587 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (838, 843) -->  Mary picked up the apple
2025-01-22 19:18:00.587 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:18:00.598 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1869, 1875) --> . Mary journeyed to the
2025-01-22 19:18:00.598 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:18:00.619 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3629, 3634) -->  Mary went to the bedroom
2025-01-22 19:18:00.619 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:18:00.658 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7125, 7130) -->  John went to the office
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:18:01.453 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 19:18:01.453 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8170])
is_0k: False
your chose emoji: ['ğŸ‘©ğŸ¼\u200dğŸ¦±', 'ğŸ‡¬ğŸ‡¦', 'ğŸ‘©ğŸ»\u200dğŸŒ¾', 'ğŸ”ª', 'ğŸ‘©ğŸ¼\u200dâš•', 'ğŸ§‘ğŸ¼\u200dğŸ¦½\u200dâ¡ï¸', 'ğŸ‘©ğŸ¿\u200dâ¤ï¸\u200dğŸ‘©ğŸ½', 'ğŸ˜', 'â›·ï¸', 'ğŸ§\u200dâ™‚ï¸']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.74s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.72s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.38s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.82s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.46s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 2, 3, 6):   0%|          | 0/100 [16:04<?, ?it/s]2025-01-22 19:18:19.397 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:18:19.398 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the apple.
2025-01-22 19:18:19.398 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:18:19.407 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1799, 1805) --> . Mary journeyed to the
2025-01-22 19:18:19.407 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:18:19.422 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2940, 2945) --> . Mary went to the
2025-01-22 19:18:19.422 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:18:19.447 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4896, 4901) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:18:23.878 | INFO     | test_jbb_embedding:begin_test:693 - Mary picked up the apple.<|eot_id|>
2025-01-22 19:18:23.878 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8216])
is_0k: False
your chose emoji: ['ğŸ˜˜', 'ğŸ‘©ğŸ¼\u200dâ¤\u200dğŸ’‹\u200dğŸ‘¨ğŸ¿', 'ğŸ‘©ğŸ½\u200dâ¤\u200dğŸ‘¨ğŸ½', 'ğŸ‘©ğŸ¾\u200dâ¤\u200dğŸ’‹\u200dğŸ‘¨ğŸ½', 'ğŸ‘·ğŸ¿\u200dâ™‚ï¸', 'ğŸ‘«ğŸ¼', 'ğŸ¿', 'ğŸ§ğŸ¼\u200dâ™‚', 'ğŸ³\u200dâš§', 'ğŸ‘¨ğŸ¾\u200dğŸ¤\u200dğŸ‘¨ğŸ»']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:05<00:15,  5.24s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.32s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:15<00:05,  5.06s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  3.51s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  4.13s/it]
Processing depth (0, 4, 8, 9):   0%|          | 0/100 [16:29<?, ?it/s]2025-01-22 19:18:44.996 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:18:44.996 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the apple.
2025-01-22 19:18:44.996 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:18:45.018 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3617, 3623) --> . Mary journeyed to the
2025-01-22 19:18:45.019 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:18:45.052 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6611, 6616) -->  Mary went to the bedroom
2025-01-22 19:18:45.052 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:18:45.093 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7214, 7219) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:18:45.955 | INFO     | test_jbb_embedding:begin_test:693 - Mary picked up the apple.<|eot_id|>
2025-01-22 19:18:45.955 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8146])
is_0k: False
your chose emoji: ['ğŸ‘€', 'ğŸ§‘ğŸ¿\u200dâ¤\u200dğŸ’‹\u200dğŸ§‘ğŸ¼', 'ğŸ—¡', 'ğŸ™ğŸ¿\u200dâ™€ï¸', 'ğŸ‘¨ğŸ»', 'ğŸš£ğŸ¾\u200dâ™‚ï¸', 'ğŸ§ğŸ»', 'ğŸ§‘ğŸ¾\u200dâœˆï¸', 'ğŸ’„', 'ğŸ³']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.68s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.18s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.97s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  3.48s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  4.03s/it]
Processing depth (0, 3, 6, 9):   0%|          | 0/100 [16:51<?, ?it/s]2025-01-22 19:19:06.021 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:19:06.022 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the apple.
2025-01-22 19:19:06.022 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:19:06.039 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2966, 2972) -->  tragedy. Mary journeyed to
2025-01-22 19:19:06.039 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:19:06.066 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4788, 4793) -->  the senate. Mary went
2025-01-22 19:19:06.067 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:19:06.104 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7244, 7249) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:19:06.990 | INFO     | test_jbb_embedding:begin_test:693 - Mary picked up the apple.<|eot_id|>
2025-01-22 19:19:06.990 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8184])
is_0k: False
your chose emoji: ['ğŸ‘©ğŸ¼\u200dâ¤ï¸\u200dğŸ‘©ğŸ»', 'ğŸ§¾', '\U0001fab7', 'ğŸ‘©ğŸ»\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘¨ğŸ»', 'ğŸ‘¨ğŸ½\u200dâ¤ï¸\u200dğŸ‘¨ğŸ½', 'ğŸ§šğŸ¾\u200dâ™€', 'ğŸ’‡ğŸ¿\u200dâ™€', '\U0001faf1ğŸ¿', 'â›¹ï¸\u200dâ™‚ï¸', 'ğŸŒ‰']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.83s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.84s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.42s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.83s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.50s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 1, 7, 9):   0%|          | 0/100 [17:10<?, ?it/s]2025-01-22 19:19:25.055 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:19:25.056 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the apple.
2025-01-22 19:19:25.056 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:19:25.061 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (831, 837) --> . Mary journeyed to the
2025-01-22 19:19:25.061 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:19:25.089 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5632, 5637) --> . Mary went to the
2025-01-22 19:19:25.089 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:19:25.124 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7212, 7217) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:19:31.130 | INFO     | test_jbb_embedding:begin_test:693 - Mary picked up the apple.<|eot_id|>
2025-01-22 19:19:31.130 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8170])
is_0k: False
your chose emoji: ['\U0001faf1ğŸ¼\u200d\U0001faf2ğŸ¾', 'ğŸ§‘ğŸ¼\u200dğŸ¤\u200dğŸ§‘ğŸ¼', 'ğŸº', 'ğŸ‹ğŸ»\u200dâ™€', 'â†—', 'ğŸ‡²ğŸ‡¼', 'ğŸ™\u200dâ™€ï¸', 'ğŸ§‘ğŸ¿\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ§‘ğŸ¼', 'ğŸ«”', 'ğŸ‡°ğŸ‡¾']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.60s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.72s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.86s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.39s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.89s/it]
Processing depth (0, 5, 7, 8):   0%|          | 0/100 [17:36<?, ?it/s]2025-01-22 19:19:51.989 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:19:51.989 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the apple.
2025-01-22 19:19:51.989 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:19:52.013 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4143, 4149) --> . Mary journeyed to the
2025-01-22 19:19:52.014 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:19:52.042 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5620, 5625) --> . Mary went to the
2025-01-22 19:19:52.043 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:19:52.079 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6602, 6607) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:19:52.954 | INFO     | test_jbb_embedding:begin_test:693 - Mary picked up the apple.<|eot_id|>
2025-01-22 19:19:52.955 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8108])
is_0k: False
your chose emoji: ['â˜ºï¸', 'ğŸ‘·\u200dâ™‚', 'ğŸ‡«ğŸ‡®', 'âœ', 'â™ˆ', 'ğŸ‘¨ğŸ½\u200dâ¤\u200dğŸ‘¨ğŸ¿', 'ğŸ—', 'ğŸš´ğŸ¾\u200dâ™‚', 'ğŸ”®', 'â˜®']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.99s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.95s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.82s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.38s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.94s/it]
Processing depth (3, 6, 7, 9):   0%|          | 0/100 [17:57<?, ?it/s]2025-01-22 19:20:12.758 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:20:12.776 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3031, 3036) --> . Mary picked up the
2025-01-22 19:20:12.776 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:20:12.805 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4842, 4848) -->  Mary journeyed to the garden
2025-01-22 19:20:12.805 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:20:12.836 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5716, 5721) --> . Mary went to the
2025-01-22 19:20:12.837 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:20:12.875 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7085, 7090) -->  John went to the office
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:20:13.719 | INFO     | test_jbb_embedding:begin_test:693 - Mary's garden.<|eot_id|>
2025-01-22 19:20:13.719 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8122])
is_0k: False
your chose emoji: ['ğŸŒš', 'ğŸ‘©ğŸ»\u200dğŸ¤\u200dğŸ‘¨ğŸ¿', 'ğŸŒ¶', 'ğŸ¤œğŸ¾', 'ğŸƒğŸ¼\u200dâ¡', '\U0001faab', 'ğŸ‡´ğŸ‡²', 'ğŸ‡²ğŸ‡ª', 'ğŸ“±', 'ğŸ¥®']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.64s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.59s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.54s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.15s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.67s/it]
Processing depth (0, 3, 8, 9):   0%|          | 0/100 [18:17<?, ?it/s]2025-01-22 19:20:32.525 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:20:32.526 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the apple.
2025-01-22 19:20:32.526 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:20:32.541 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2869, 2875) --> . Mary journeyed to the
2025-01-22 19:20:32.541 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:20:32.574 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6608, 6613) --> . Mary went to the
2025-01-22 19:20:32.574 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:20:32.613 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7198, 7203) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:20:33.515 | INFO     | test_jbb_embedding:begin_test:693 - Mary picked up the apple.<|eot_id|>
2025-01-22 19:20:33.515 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8136])
is_0k: False
your chose emoji: ['ğŸ‘‹ğŸ¾', 'ğŸ§šğŸ¼', 'ğŸ¶', 'ğŸ§›ğŸ¿\u200dâ™€', 'ğŸ§ğŸ¿\u200dâ¡ï¸', 'ğŸ¡', 'ğŸ‘©ğŸ½\u200dâ¤\u200dğŸ’‹\u200dğŸ‘¨ğŸ¿', 'ğŸ˜¼', 'ğŸ¤¸ğŸ½', 'ğŸ—‚']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.48s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:10,  5.05s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.98s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.47s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.99s/it]
Processing depth (0, 2, 3, 9):   0%|          | 0/100 [18:38<?, ?it/s]2025-01-22 19:20:53.734 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:20:53.734 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the apple.
2025-01-22 19:20:53.734 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:20:53.746 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1855, 1861) --> . Mary journeyed to the
2025-01-22 19:20:53.746 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:20:53.761 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2930, 2935) --> . Mary went to the
2025-01-22 19:20:53.762 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:20:53.798 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7188, 7193) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:20:54.730 | INFO     | test_jbb_embedding:begin_test:693 - Mary picked up the apple.<|eot_id|>
2025-01-22 19:20:54.730 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8150])
is_0k: False
your chose emoji: ['ğŸ’†ğŸ»\u200dâ™€', 'âœŒğŸ½', 'ğŸ§šğŸ½\u200dâ™‚', 'ğŸ‡¹ğŸ‡¬', 'ğŸ†“', 'ğŸ‡¨ğŸ‡²', 'ğŸ‘©ğŸ¾\u200dâš–ï¸', 'ğŸ¦º', 'ğŸ§ğŸ¾\u200dâ™‚ï¸', 'ğŸ§ğŸ¾\u200dâ™€ï¸\u200dâ¡']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.65s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.97s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.91s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.43s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.96s/it]
Processing depth (0, 2, 5, 7):   0%|          | 0/100 [18:59<?, ?it/s]2025-01-22 19:21:14.905 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:21:14.906 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the apple.
2025-01-22 19:21:14.906 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:21:14.915 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1853, 1859) --> . Mary journeyed to the
2025-01-22 19:21:14.916 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:21:14.936 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4140, 4145) --> . Mary went to the
2025-01-22 19:21:14.937 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:21:14.965 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5582, 5587) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:21:15.850 | INFO     | test_jbb_embedding:begin_test:693 - Mary picked up the apple.<|eot_id|>
2025-01-22 19:21:15.851 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8174])
is_0k: False
your chose emoji: ['â†–ï¸', 'ğŸ§‘ğŸ¾\u200dğŸ’¼', 'ğŸš¶\u200dâ™€\u200dâ¡ï¸', 'ğŸ›¹', 'ğŸ§›ğŸ¿\u200dâ™‚', 'ğŸ§‘ğŸ¾\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ§‘ğŸ¼', 'ğŸ“¢', 'ğŸ‡§ğŸ‡±', 'ğŸƒğŸ¿\u200dâ™‚\u200dâ¡ï¸', 'ğŸ§”ğŸ»\u200dâ™‚ï¸']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:05<00:15,  5.08s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.25s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:15<00:05,  5.02s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  3.41s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  4.04s/it]
Processing depth (2, 3, 6, 7):   0%|          | 0/100 [19:20<?, ?it/s]2025-01-22 19:21:35.965 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:21:35.975 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1790, 1795) -->  Mary picked up the apple
2025-01-22 19:21:35.975 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:21:35.990 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2923, 2929) --> . Mary journeyed to the
2025-01-22 19:21:35.990 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:21:36.017 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4918, 4923) --> . Mary went to the
2025-01-22 19:21:36.017 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:21:36.049 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5809, 5814) -->  John went to the office
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:21:36.960 | INFO     | test_jbb_embedding:begin_test:693 - Mary picked up the apple.<|eot_id|>
2025-01-22 19:21:36.960 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8196])
is_0k: False
your chose emoji: ['ğŸ§‘ğŸ¿\u200dğŸ„', 'ğŸ‘©ğŸ»\u200dâ¤ï¸\u200dğŸ‘¨ğŸ½', 'ğŸŒ¯', 'ğŸ©±', 'ğŸ‘ˆğŸ¼', 'ğŸ‘©ğŸ¿\u200dğŸ¤\u200dğŸ‘©ğŸ¼', 'ğŸ‘©ğŸ½\u200dğŸ¦¯\u200dâ¡', 'ğŸ§‘ğŸ¾\u200dğŸš’', 'ğŸ‘°\u200dâ™‚', 'ğŸ‘©\u200dğŸ‘¦\u200dğŸ‘¦']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.88s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.14s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.68s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  2.99s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.68s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 1, 3, 8):   0%|          | 0/100 [19:40<?, ?it/s]2025-01-22 19:21:55.695 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:21:55.696 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the apple.
2025-01-22 19:21:55.696 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:21:55.701 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (901, 907) --> . Mary journeyed to the
2025-01-22 19:21:55.701 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:21:55.722 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2844, 2849) --> . Mary went to the
2025-01-22 19:21:55.722 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:21:55.762 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6486, 6491) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:21:59.583 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 19:21:59.583 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8112])
is_0k: False
your chose emoji: ['ğŸ¤½ğŸ¾\u200dâ™‚ï¸', 'ğŸ©º', 'ğŸ‡®ğŸ‡´', '\U0001fac4', 'ğŸ™Œ', 'ğŸ‘ŠğŸ¿', 'ğŸ‘©\u200dğŸ‘§\u200dğŸ‘¦', 'â¬‡ï¸', 'ğŸŠğŸ¿', 'ğŸ†’']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.92s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.09s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.98s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  3.44s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  4.02s/it]
Processing depth (3, 4, 6, 8):   0%|          | 0/100 [20:05<?, ?it/s]2025-01-22 19:22:20.518 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:22:20.533 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2901, 2906) --> . Mary picked up the
2025-01-22 19:22:20.533 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:22:20.551 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3584, 3590) -->  Hon. Mary journeyed to
2025-01-22 19:22:20.551 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:22:20.580 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4686, 4691) --> . Mary went to the
2025-01-22 19:22:20.580 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:22:20.612 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6562, 6567) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:22:21.380 | INFO     | test_jbb_embedding:begin_test:693 - the garden<|eot_id|>
2025-01-22 19:22:21.380 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8116])
is_0k: False
your chose emoji: ['ğŸš¡', 'ğŸ˜‘', 'â„¢ï¸', 'ğŸ¦®', 'ğŸ¤¾ğŸ»', 'ğŸ‘', 'ğŸ‘¨ğŸ½\u200dğŸ¼', 'ğŸƒğŸ¿\u200dâ™‚\u200dâ¡', 'ğŸ§”\u200dâ™€ï¸', 'ğŸ§—ğŸ»\u200dâ™€ï¸']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.34s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.63s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.69s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.27s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.76s/it]
Processing depth (0, 3, 4, 9):   0%|          | 0/100 [20:25<?, ?it/s]2025-01-22 19:22:40.395 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:22:40.396 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the apple.
2025-01-22 19:22:40.396 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:22:40.414 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2937, 2943) --> . Mary journeyed to the
2025-01-22 19:22:40.415 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:22:40.435 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3641, 3646) -->  Hon. Mary went to
2025-01-22 19:22:40.436 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:22:40.474 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7131, 7136) -->  John went to the office
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:22:41.358 | INFO     | test_jbb_embedding:begin_test:693 - Mary picked up the apple.<|eot_id|>
2025-01-22 19:22:41.361 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8168])
is_0k: False
your chose emoji: ['ğŸ§‘ğŸ»\u200dâš–', 'ğŸš´ğŸ¿\u200dâ™‚ï¸', 'ğŸ§ğŸ»\u200dâ™‚ï¸', 'ğŸ¤¦ğŸ¼\u200dâ™‚ï¸', 'ğŸ›’', 'ğŸ‘©ğŸ»\u200dğŸ”§', 'â›¹ğŸ¾\u200dâ™‚ï¸', 'ğŸ‘¨ğŸ»\u200dğŸ¦¼\u200dâ¡', 'â˜‘', 'ğŸ¥¢']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.71s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.46s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.48s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.14s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.64s/it]
Processing depth (0, 1, 2, 7):   0%|          | 0/100 [20:45<?, ?it/s]2025-01-22 19:23:00.223 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:23:00.224 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the apple.
2025-01-22 19:23:00.224 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:23:00.229 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (775, 781) --> . Mary journeyed to the
2025-01-22 19:23:00.229 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:23:00.238 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1754, 1759) --> . Mary went to the
2025-01-22 19:23:00.238 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:23:00.275 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5748, 5753) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:23:01.076 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 19:23:01.076 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8146])
is_0k: False
your chose emoji: ['ğŸ¿', 'ğŸ•¹ï¸', 'ğŸª’', 'â¯ï¸', 'ğŸ‘‰ğŸ¼', 'ğŸ‘¨\u200dğŸ‘©\u200dğŸ‘¦\u200dğŸ‘¦', 'ğŸƒğŸ½\u200dâ™€\u200dâ¡', 'ğŸ', 'ğŸ§‘ğŸ¼\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ§‘ğŸ¿', 'ğŸ˜ª']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.93s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.03s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.99s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.40s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.99s/it]
Processing depth (0, 1, 3, 9):   0%|          | 0/100 [21:06<?, ?it/s]2025-01-22 19:23:21.028 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:23:21.028 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the apple.
2025-01-22 19:23:21.028 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:23:21.033 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (901, 907) --> . Mary journeyed to the
2025-01-22 19:23:21.033 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:23:21.047 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2900, 2905) --> . Mary went to the
2025-01-22 19:23:21.047 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:23:21.082 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7216, 7221) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:23:21.866 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 19:23:21.866 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8154])
is_0k: False
your chose emoji: ['ğŸšµ\u200dâ™€ï¸', 'ğŸ‡²ğŸ‡º', 'ğŸ‘©ğŸ»\u200dğŸ¦¼\u200dâ¡ï¸', 'ğŸ”™', 'ğŸ‘µğŸ¿', '\U0001faf1ğŸ»\u200d\U0001faf2ğŸ¿', 'ğŸª§', 'ğŸ‘©ğŸ¼\u200dğŸ¦³', 'ğŸ‘©ğŸ¼\u200dğŸ¦±', 'ğŸ«‘']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  3.85s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.65s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.60s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.23s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.68s/it]
Processing depth (2, 4, 5, 9):   0%|          | 0/100 [21:25<?, ?it/s]2025-01-22 19:23:40.657 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:23:40.667 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1835, 1840) --> . Mary picked up the
2025-01-22 19:23:40.667 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:23:40.685 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3665, 3671) --> . Mary journeyed to the
2025-01-22 19:23:40.686 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:23:40.709 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4284, 4289) --> . Mary went to the
2025-01-22 19:23:40.710 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:23:40.750 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7149, 7154) -->  John went to the office
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:23:41.643 | INFO     | test_jbb_embedding:begin_test:693 - Mary picked up the apple.<|eot_id|>
2025-01-22 19:23:41.643 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8186])
is_0k: False
your chose emoji: ['\U0001faf5ğŸ¼', '\U0001faf2', 'ğŸ‹ğŸ¼\u200dâ™‚ï¸', 'ğŸ‘¨ğŸ¾\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘¨ğŸ»', 'ğŸ§\u200dâ™‚ï¸', 'ğŸ’ğŸ»\u200dâ™€ï¸', 'ğŸš´ğŸ¼\u200dâ™€ï¸', 'ğŸ§”ğŸ¾\u200dâ™€', 'ğŸ‘©ğŸ¿\u200dğŸ¤\u200dğŸ‘©ğŸ¼', 'ğŸ°']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.40s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.79s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.43s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.85s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.48s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (3, 5, 7, 9):   0%|          | 0/100 [21:44<?, ?it/s]2025-01-22 19:23:59.676 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:23:59.689 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2715, 2720) --> . Mary picked up the
2025-01-22 19:23:59.689 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:23:59.710 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4071, 4077) --> . Mary journeyed to the
2025-01-22 19:23:59.710 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:23:59.742 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5534, 5539) --> . Mary went to the
2025-01-22 19:23:59.743 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:23:59.781 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7089, 7094) -->  John went to the office
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:24:05.588 | INFO     | test_jbb_embedding:begin_test:693 - Mary picked up the apple.<|eot_id|>
2025-01-22 19:24:05.588 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8126])
is_0k: False
your chose emoji: ['ğŸŒ°', 'â—¼', 'ğŸ–ï¸', 'ğŸ›ŒğŸ¾', 'ğŸ‘ˆğŸ½', 'ğŸƒğŸ¿\u200dâ™‚ï¸\u200dâ¡', 'ğŸ‹ğŸ¿\u200dâ™€', 'ğŸ‘¨ğŸ¼\u200dğŸ¦¯\u200dâ¡', 'ğŸ˜‚', 'ğŸ§ˆ']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:05<00:15,  5.12s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.00s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.77s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.36s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.94s/it]
Processing depth (1, 2, 4, 8):   0%|          | 0/100 [22:11<?, ?it/s]2025-01-22 19:24:26.238 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:24:26.243 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (836, 841) -->  Mary picked up the apple
2025-01-22 19:24:26.243 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:24:26.253 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1813, 1819) --> . Mary journeyed to the
2025-01-22 19:24:26.253 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:24:26.273 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3644, 3649) --> . Mary went to the
2025-01-22 19:24:26.273 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:24:26.309 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6634, 6639) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:24:27.089 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 19:24:27.089 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8176])
is_0k: False
your chose emoji: ['ğŸ‘¨ğŸ¾\u200dâ¤ï¸\u200dğŸ‘¨ğŸ¼', 'ğŸ§”\u200dâ™€ï¸', 'ğŸƒğŸ½\u200dâ™‚\u200dâ¡ï¸', 'â™‚', 'ğŸ§ğŸ½\u200dâ™‚', 'ğŸ¬', 'ğŸ‘©ğŸ½\u200dğŸ’»', 'ğŸ§‘ğŸ¿\u200dâš•ï¸', 'ğŸ§˜ğŸ¼', 'ğŸ§ğŸ¾\u200dâ™‚ï¸']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.78s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.87s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.75s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.31s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.86s/it]
Processing depth (1, 2, 6, 8):   0%|          | 0/100 [22:31<?, ?it/s]2025-01-22 19:24:46.499 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:24:46.504 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (815, 820) --> . Mary picked up the
2025-01-22 19:24:46.504 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:24:46.513 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1787, 1793) --> . Mary journeyed to the
2025-01-22 19:24:46.513 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:24:46.536 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4746, 4751) -->  the senate. Mary went
2025-01-22 19:24:46.536 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:24:46.572 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6580, 6585) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:24:47.447 | INFO     | test_jbb_embedding:begin_test:693 - Mary picked up the apple.<|eot_id|>
2025-01-22 19:24:47.447 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8124])
is_0k: False
your chose emoji: ['ğŸ¥­', 'ğŸ—ºï¸', 'ğŸ‘©ğŸ»\u200dğŸ¨', 'ğŸ¤¿', 'ğŸ¦¹ğŸ½', 'ğŸƒğŸ½\u200dâ¡', 'ğŸ˜¤', 'ğŸ•—', 'ğŸ‘©ğŸ»\u200dâ¤ï¸\u200dğŸ‘©ğŸ¿', 'ğŸˆ´']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.51s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.82s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.59s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.22s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.74s/it]
Processing depth (0, 1, 5, 6):   0%|          | 0/100 [22:51<?, ?it/s]2025-01-22 19:25:06.479 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:25:06.479 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the apple.
2025-01-22 19:25:06.480 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:25:06.485 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (901, 907) --> . Mary journeyed to the
2025-01-22 19:25:06.485 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:25:06.505 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4146, 4151) --> . Mary went to the
2025-01-22 19:25:06.506 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:25:06.529 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4756, 4761) -->  the senate. John went
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:25:07.333 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 19:25:07.333 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8138])
is_0k: False
your chose emoji: ['ğŸš¤', 'ğŸŒğŸ¾\u200dâ™€', 'ğŸ‘©ğŸ»\u200dğŸ¦±', 'ğŸš¶ğŸ½\u200dâ¡ï¸', 'ğŸˆ', 'ğŸ¤·ğŸ½\u200dâ™‚', 'ğŸ•Š', 'ğŸš¶ğŸ½\u200dâ™€ï¸', 'ğŸ¤µğŸ¾\u200dâ™€', 'ğŸ¤”']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:05<00:15,  5.05s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.78s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.43s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.08s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.67s/it]
Processing depth (3, 5, 6, 8):   0%|          | 0/100 [23:11<?, ?it/s]2025-01-22 19:25:26.038 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:25:26.052 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2873, 2878) --> . Mary picked up the
2025-01-22 19:25:26.052 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:25:26.077 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4184, 4190) -->  Mary journeyed to the garden
2025-01-22 19:25:26.077 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:25:26.102 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4718, 4723) --> . Mary went to the
2025-01-22 19:25:26.102 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:25:26.134 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6616, 6621) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:25:26.887 | INFO     | test_jbb_embedding:begin_test:693 - the garden<|eot_id|>
2025-01-22 19:25:26.887 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8156])
is_0k: False
your chose emoji: ['ğŸµï¸', 'ğŸ§‘ğŸ»\u200dğŸ¤\u200dğŸ§‘ğŸ¼', 'ğŸ‘©ğŸ¼\u200dâ¤ï¸\u200dğŸ‘©ğŸ»', 'ğŸ¤¾ğŸ»', 'ğŸº', 'ğŸ‡¬ğŸ‡§', 'ğŸ©¸', 'ğŸ§‘ğŸ»\u200dğŸ­', 'ğŸ¤¸ğŸ¾', 'ãŠ™ï¸']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.88s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.67s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.72s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.03s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.65s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (4, 7, 8, 9):   0%|          | 0/100 [23:30<?, ?it/s]2025-01-22 19:25:45.704 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:25:45.741 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3581, 3586) --> . Mary picked up the
2025-01-22 19:25:45.742 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:25:45.782 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5621, 5627) --> . Mary journeyed to the
2025-01-22 19:25:45.783 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:25:45.818 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6534, 6539) --> . Mary went to the
2025-01-22 19:25:45.819 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:25:45.858 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7131, 7136) -->  John went to the office
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:25:48.746 | INFO     | test_jbb_embedding:begin_test:693 - Mary's hand<|eot_id|>
2025-01-22 19:25:48.747 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8168])
is_0k: False
your chose emoji: ['ğŸ‡ªğŸ‡­', 'ğŸ‘¨\u200dğŸ‘©\u200dğŸ‘¦\u200dğŸ‘¦', 'â†–', 'ğŸ‘¨\u200dğŸ‘¨\u200dğŸ‘¦\u200dğŸ‘¦', 'ğŸ‡µğŸ‡¾', 'ğŸ›€ğŸ¼', 'ğŸ§‘ğŸ»\u200dâ¤\u200dğŸ’‹\u200dğŸ§‘ğŸ¼', 'ğŸ‘³\u200dâ™€', 'ğŸ‡¦ğŸ‡¼', 'ğŸ–']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.46s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:10,  5.07s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.92s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.41s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.95s/it]
Processing depth (0, 2, 5, 6):   0%|          | 0/100 [23:54<?, ?it/s]2025-01-22 19:26:09.057 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:26:09.058 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the apple.
2025-01-22 19:26:09.058 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:26:09.067 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1859, 1865) --> . Mary journeyed to the
2025-01-22 19:26:09.067 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:26:09.088 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4227, 4232) -->  Mary went to the bedroom
2025-01-22 19:26:09.088 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:26:09.116 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4852, 4857) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:26:10.020 | INFO     | test_jbb_embedding:begin_test:693 - Mary picked up the apple.<|eot_id|>
2025-01-22 19:26:10.021 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8164])
is_0k: False
your chose emoji: ['ğŸ•´ğŸ¾', 'ğŸ‘¨ğŸ»\u200dğŸ¦±', 'ğŸ‘¨\u200dğŸ‘§\u200dğŸ‘¦', 'ğŸª¶', 'ğŸ’‡ğŸ¼\u200dâ™‚ï¸', '\U0001faa9', 'ğŸ¤³ğŸ¿', 'ğŸ§ğŸ¿\u200dâ™‚ï¸\u200dâ¡', 'ğŸšµğŸ¿\u200dâ™‚ï¸', 'â›¹ğŸ¿\u200dâ™€']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.34s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.85s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.61s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.22s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.74s/it]
Processing depth (2, 3, 5, 7):   0%|          | 0/100 [24:13<?, ?it/s]2025-01-22 19:26:28.923 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:26:28.933 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1622, 1627) -->  Mary picked up the apple
2025-01-22 19:26:28.933 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:26:28.948 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2781, 2787) --> . Mary journeyed to the
2025-01-22 19:26:28.949 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:26:28.972 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4156, 4161) --> . Mary went to the
2025-01-22 19:26:28.972 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:26:29.003 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5652, 5657) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:26:29.777 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 19:26:29.777 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8184])
is_0k: False
your chose emoji: ['ğŸ¤·ğŸ¼\u200dâ™‚ï¸', 'ğŸ•µğŸ¼', 'âœŒğŸ¿', 'ğŸ’‘ğŸ¿', 'ğŸ•¡', 'ğŸ‘¨ğŸ¾\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘¨ğŸ½', 'ğŸ–¥ï¸', 'ğŸ§ğŸ¿\u200dâ™€ï¸\u200dâ¡', 'ğŸ‘©ğŸ¼\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘©ğŸ¿', 'ğŸ‡¬ğŸ‡ª']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.67s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.87s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.78s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.07s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.70s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (6, 7, 8, 9):   0%|          | 0/100 [24:33<?, ?it/s]2025-01-22 19:26:48.587 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:26:48.611 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4611, 4616) --> . Mary picked up the
2025-01-22 19:26:48.621 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:26:48.654 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5446, 5452) -->  Mary journeyed to the garden
2025-01-22 19:26:48.655 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:26:48.689 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6474, 6479) --> . Mary went to the
2025-01-22 19:26:48.689 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:26:48.723 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7103, 7108) -->  John went to the office
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:26:51.983 | INFO     | test_jbb_embedding:begin_test:693 - the doctor's office<|eot_id|>
2025-01-22 19:26:51.983 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8154])
is_0k: False
your chose emoji: ['ğŸ§‘ğŸ¾\u200dğŸ¦½\u200dâ¡', 'ğŸ‘°ğŸ»\u200dâ™€ï¸', 'ğŸ¤’', 'ğŸ“’', 'ğŸ’ğŸ¾\u200dâ™€ï¸', 'ğŸ’ğŸ¾\u200dâ™‚', 'ğŸ§ğŸ¼\u200dâ™‚', 'ğŸ’‚ğŸ¿', 'ğŸ‘©\u200dğŸ¼', 'ğŸ§‘ğŸ¿\u200dğŸ”§']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.69s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.75s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.94s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.39s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.91s/it]
Processing depth (2, 5, 6, 8):   0%|          | 0/100 [24:57<?, ?it/s]2025-01-22 19:27:12.095 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:27:12.105 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1789, 1794) --> . Mary picked up the
2025-01-22 19:27:12.105 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:27:12.129 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4138, 4144) -->  Mary journeyed to the garden
2025-01-22 19:27:12.129 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:27:12.153 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4698, 4703) --> . Mary went to the
2025-01-22 19:27:12.153 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:27:12.184 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6464, 6469) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:27:12.978 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 19:27:12.979 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8130])
is_0k: False
your chose emoji: ['â•', 'ğŸ§—ğŸ½', 'ğŸ³\u200dâš§', 'ğŸƒğŸ»', 'ğŸš¶ğŸ½\u200dâ™‚ï¸\u200dâ¡', 'â›±', 'ğŸ‡»ğŸ‡®', 'ğŸ‰', 'ğŸ§‘ğŸ½\u200dğŸ”¬', 'ğŸ‘¶ğŸ¾']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.76s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.79s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.48s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.09s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.66s/it]
Processing depth (0, 1, 2, 8):   0%|          | 0/100 [25:16<?, ?it/s]2025-01-22 19:27:31.698 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:27:31.699 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the apple.
2025-01-22 19:27:31.699 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:27:31.704 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (827, 833) --> . Mary journeyed to the
2025-01-22 19:27:31.704 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:27:31.714 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1808, 1813) --> . Mary went to the
2025-01-22 19:27:31.714 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:27:31.751 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6494, 6499) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:27:32.528 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 19:27:32.529 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8134])
is_0k: False
your chose emoji: ['ğŸª¨', 'ğŸ‘¨ğŸ¾\u200dğŸ¦¼', 'âº', 'ğŸ’‡ğŸ½', 'ğŸ', 'ğŸ˜£', 'ğŸ¤ŒğŸ½', 'ğŸ‘©ğŸ¼\u200dğŸ¤\u200dğŸ‘©ğŸ»', 'ğŸŠ\u200dâ™‚', 'ğŸ„ğŸ»\u200dâ™‚']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.98s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.09s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.86s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.35s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.94s/it]
Processing depth (1, 2, 3, 9):   0%|          | 0/100 [25:37<?, ?it/s]2025-01-22 19:27:52.302 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:27:52.307 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (821, 826) --> . Mary picked up the
2025-01-22 19:27:52.307 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:27:52.317 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1853, 1859) --> . Mary journeyed to the
2025-01-22 19:27:52.317 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:27:52.332 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2973, 2978) -->  tragedy. Mary went to
2025-01-22 19:27:52.332 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:27:52.371 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7261, 7266) -->  cold. John went to
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:27:53.262 | INFO     | test_jbb_embedding:begin_test:693 - Mary picked up the apple.<|eot_id|>
2025-01-22 19:27:53.262 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8202])
is_0k: False
your chose emoji: ['ğŸ›ŒğŸ¼', 'ğŸ§‘ğŸ¼\u200dğŸ¦½\u200dâ¡', 'ğŸ§‘ğŸ¿\u200dâ¤\u200dğŸ§‘ğŸ¼', 'ğŸ‡§ğŸ‡¸', 'ğŸ‘¨ğŸ½\u200dâ¤ï¸\u200dğŸ‘¨ğŸ¿', 'ğŸ’ƒğŸ»', 'ğŸ¤¾ğŸ¾\u200dâ™‚', 'ğŸ–‡ï¸', 'ğŸ‘©ğŸ½\u200dâ¤\u200dğŸ‘©ğŸ¿', 'ğŸ„ğŸ»\u200dâ™€ï¸']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.22s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.57s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.37s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.83s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.41s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (1, 4, 6, 7):   0%|          | 0/100 [25:55<?, ?it/s]2025-01-22 19:28:10.822 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:28:10.826 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (695, 700) --> . Mary picked up the
2025-01-22 19:28:10.826 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:28:10.847 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3589, 3595) --> . Mary journeyed to the
2025-01-22 19:28:10.847 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:28:10.873 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4742, 4747) --> . Mary went to the
2025-01-22 19:28:10.873 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:28:10.902 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5645, 5650) -->  John went to the office
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:28:14.851 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 19:28:14.851 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8176])
is_0k: False
your chose emoji: ['ğŸ‘°ğŸ¿\u200dâ™€', 'ğŸ‘©ğŸ¾\u200dğŸ¤\u200dğŸ‘¨ğŸ¼', 'ğŸ‘©ğŸ¾\u200dâ¤\u200dğŸ‘¨ğŸ»', 'ğŸ”¢', 'ğŸ™‹ğŸ¿\u200dâ™‚', 'ğŸª…', 'ğŸ‹ğŸ¾\u200dâ™‚', 'ğŸ‘¨ğŸ¿\u200dğŸ¦½', 'ğŸ§ğŸ¾\u200dâ™‚', 'ğŸ˜‰']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:05<00:15,  5.19s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.22s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.90s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  3.41s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  4.02s/it]
Processing depth (2, 6, 7, 9):   0%|          | 0/100 [26:20<?, ?it/s]2025-01-22 19:28:35.720 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:28:35.728 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1786, 1791) -->  Mary picked up the apple
2025-01-22 19:28:35.729 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:28:35.753 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4823, 4829) --> . Mary journeyed to the
2025-01-22 19:28:35.754 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:28:35.785 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5718, 5723) --> . Mary went to the
2025-01-22 19:28:35.786 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:28:35.840 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7226, 7231) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:28:36.638 | INFO     | test_jbb_embedding:begin_test:693 - The capitol<|eot_id|>
2025-01-22 19:28:36.639 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8170])
is_0k: False
your chose emoji: ['â˜ğŸ½', 'ğŸ‘©ğŸ¿\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘©ğŸ¼', 'ğŸ§ğŸ¼\u200dâ™‚\u200dâ¡', 'ğŸ‘¦ğŸ¿', '\U0001fac5ğŸ¾', 'ğŸ¤ğŸ¾', 'ğŸ‘¨ğŸ¾\u200dğŸ¦¼', 'ğŸ§™ğŸ½\u200dâ™€ï¸', 'ğŸ‡°ğŸ‡­', 'ğŸ¾']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:05<00:15,  5.07s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.08s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:15<00:05,  5.01s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  3.45s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  4.03s/it]
Processing depth (2, 3, 4, 7):   0%|          | 0/100 [26:41<?, ?it/s]2025-01-22 19:28:56.748 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:28:56.758 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1867, 1872) --> . Mary picked up the
2025-01-22 19:28:56.758 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:28:56.772 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2948, 2954) -->  Mary journeyed to the garden
2025-01-22 19:28:56.773 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:28:56.790 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3624, 3629) --> . Mary went to the
2025-01-22 19:28:56.790 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:28:56.818 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5630, 5635) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:28:57.637 | INFO     | test_jbb_embedding:begin_test:693 - Mary's hand.<|eot_id|>
2025-01-22 19:28:57.637 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8168])
is_0k: False
your chose emoji: ['ğŸ‘€', 'ğŸ‘¨ğŸ¼\u200dâš•ï¸', 'ğŸ§›\u200dâ™‚ï¸', 'ğŸ‘¨ğŸ»\u200dâœˆ', 'ğŸ§‘ğŸ¿\u200dâ¤ï¸\u200dğŸ§‘ğŸ¼', 'ğŸƒğŸ¿\u200dâ™‚\u200dâ¡', 'ğŸ‘±\u200dâ™€ï¸', 'ğŸŠğŸ¿\u200dâ™€', 'ğŸƒğŸ¼', 'ğŸ“']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.17s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.40s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.73s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.29s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.74s/it]
Processing depth (5, 6, 8, 9):   0%|          | 0/100 [27:01<?, ?it/s]2025-01-22 19:29:16.528 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:29:16.549 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4103, 4108) --> . Mary picked up the
2025-01-22 19:29:16.549 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:29:16.575 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4600, 4606) -->  Mary journeyed to the garden
2025-01-22 19:29:16.575 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:29:16.610 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6564, 6569) --> . Mary went to the
2025-01-22 19:29:16.610 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:29:16.649 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7199, 7204) -->  John went to the office
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:29:17.426 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 19:29:17.426 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8156])
is_0k: False
your chose emoji: ['â†ªï¸', 'ğŸ‘©ğŸ¿\u200dâ¤\u200dğŸ’‹\u200dğŸ‘¨ğŸ»', 'ğŸ§ğŸ½\u200dâ™‚', 'ğŸ‘®ğŸ»\u200dâ™‚', 'â˜', 'ğŸ¤³ğŸ½', 'ğŸ¤ğŸ½', 'ğŸ‡§ğŸ‡³', 'ğŸ‘†ğŸ¾', 'ğŸ‘°ğŸ¿\u200dâ™‚ï¸']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.13s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.74s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.96s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.48s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.93s/it]
Processing depth (1, 3, 6, 8):   0%|          | 0/100 [27:22<?, ?it/s]2025-01-22 19:29:37.539 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:29:37.543 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (815, 820) --> . Mary picked up the
2025-01-22 19:29:37.543 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:29:37.557 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2921, 2927) --> . Mary journeyed to the
2025-01-22 19:29:37.558 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:29:37.581 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4780, 4785) -->  the senate. Mary went
2025-01-22 19:29:37.581 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:29:37.613 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6646, 6651) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:29:38.453 | INFO     | test_jbb_embedding:begin_test:693 - Mary's garden.<|eot_id|>
2025-01-22 19:29:38.454 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8206])
is_0k: False
your chose emoji: ['ğŸ‰', 'ğŸ§™ğŸ»\u200dâ™‚', 'ğŸ‘¨ğŸ¾\u200dâ¤\u200dğŸ’‹\u200dğŸ‘¨ğŸ¿', 'ğŸ‘¨ğŸ½\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘¨ğŸ¿', 'ğŸ™„', 'ğŸ‘¨ğŸ»\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘¨ğŸ¾', 'ğŸ¤¦ğŸ¾\u200dâ™€ï¸', 'ğŸ§š\u200dâ™‚ï¸', 'ğŸ™ğŸ»\u200dâ™‚ï¸', 'ğŸŒ§']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.19s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.74s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.33s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.80s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.40s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (5, 6, 7, 9):   0%|          | 0/100 [27:41<?, ?it/s]2025-01-22 19:29:56.993 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:29:57.016 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4145, 4150) --> . Mary picked up the
2025-01-22 19:29:57.016 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:29:57.039 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4619, 4625) --> . Mary journeyed to the
2025-01-22 19:29:57.040 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:29:57.067 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5560, 5565) --> . Mary went to the
2025-01-22 19:29:57.068 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:29:57.109 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7103, 7108) -->  John went to the office
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:30:01.542 | INFO     | test_jbb_embedding:begin_test:693 - Mary's hand.<|eot_id|>
2025-01-22 19:30:01.542 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8146])
is_0k: False
your chose emoji: ['ğŸ‘©ğŸ½\u200dâœˆ', 'ğŸ‘‡ğŸ»', 'ğŸ‘ŠğŸ½', 'ğŸ¦‹', 'ğŸ‘¨\u200dğŸ”§', 'ğŸ§”ğŸ¼\u200dâ™€', 'ğŸ‘©ğŸ¿\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘©ğŸ¾', 'ğŸ‘’', 'ğŸ¥ª', 'ğŸ‡§ğŸ‡±']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:05<00:17,  5.83s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:11<00:11,  5.52s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:15<00:04,  4.83s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  3.37s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  4.07s/it]
Processing depth (1, 4, 5, 8):   0%|          | 0/100 [28:08<?, ?it/s]2025-01-22 19:30:23.284 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:30:23.288 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (761, 766) --> . Mary picked up the
2025-01-22 19:30:23.288 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:30:23.308 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3608, 3614) -->  Hon. Mary journeyed to
2025-01-22 19:30:23.308 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:30:23.328 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4211, 4216) -->  Mary went to the bedroom
2025-01-22 19:30:23.329 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:30:23.382 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6584, 6589) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:30:24.200 | INFO     | test_jbb_embedding:begin_test:693 - Mary's hand.<|eot_id|>
2025-01-22 19:30:24.200 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8128])
is_0k: False
your chose emoji: ['ğŸ—’', 'ğŸ”°', 'ğŸ’˜', 'ğŸœ', 'ğŸ‡µğŸ‡·', 'ğŸ¦¶ğŸ»', 'â›²', 'ğŸ‘¨ğŸ»\u200dğŸ¤\u200dğŸ‘¨ğŸ¾', 'ğŸ‘¨ğŸ½\u200dâ¤\u200dğŸ‘¨ğŸ»', 'ğŸ§‚']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.73s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.86s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.75s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.35s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.87s/it]
Processing depth (0, 3, 6, 7):   0%|          | 0/100 [28:28<?, ?it/s]2025-01-22 19:30:43.669 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:30:43.670 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the apple.
2025-01-22 19:30:43.670 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:30:43.687 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2837, 2843) --> . Mary journeyed to the
2025-01-22 19:30:43.687 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:30:43.712 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4754, 4759) -->  the senate. Mary went
2025-01-22 19:30:43.712 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:30:43.741 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5710, 5715) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:30:44.628 | INFO     | test_jbb_embedding:begin_test:693 - Mary picked up the apple.<|eot_id|>
2025-01-22 19:30:44.628 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8134])
is_0k: False
your chose emoji: ['ğŸ‡°ğŸ‡·', 'ğŸ¤ŸğŸ½', 'ğŸ™‡ğŸ½', 'ğŸ‘ğŸ»', 'ğŸ‘©ğŸ¿\u200dâš•ï¸', 'ğŸ–ğŸ½', 'ğŸ‘¨\u200dğŸ‘§\u200dğŸ‘§', 'ğŸ˜®', 'ğŸ’‚ğŸ¿\u200dâ™‚', 'â†˜ï¸']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.79s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.96s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.91s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.38s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.94s/it]
Processing depth (1, 3, 5, 7):   0%|          | 0/100 [28:49<?, ?it/s]2025-01-22 19:31:04.439 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:31:04.443 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (815, 820) --> . Mary picked up the
2025-01-22 19:31:04.444 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:31:04.460 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2960, 2966) -->  tragedy. Mary journeyed to
2025-01-22 19:31:04.460 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:31:04.481 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4199, 4204) -->  Mary went to the bedroom
2025-01-22 19:31:04.481 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:31:04.508 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5609, 5614) -->  John went to the office
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:31:05.315 | INFO     | test_jbb_embedding:begin_test:693 - Mary's hand.<|eot_id|>
2025-01-22 19:31:05.316 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8166])
is_0k: False
your chose emoji: ['ğŸ”½', 'ğŸ¥µ', 'ğŸ‡ªğŸ‡¦', 'ğŸ§‘ğŸ¾\u200dâ¤\u200dğŸ’‹\u200dğŸ§‘ğŸ¼', 'ğŸ’…ğŸ¼', 'ğŸš´ğŸ¼\u200dâ™‚', 'ğŸ‘¨ğŸ¼\u200dâ¤ï¸\u200dğŸ‘¨ğŸ¼', 'ğŸ‘¨\u200dğŸ‘§\u200dğŸ‘¦', 'ğŸ–', '\U0001faf8ğŸ¼']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.77s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.94s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.72s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.26s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.83s/it]
Processing depth (4, 5, 6, 9):   0%|          | 0/100 [29:09<?, ?it/s]2025-01-22 19:31:24.621 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:31:24.640 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3595, 3600) --> . Mary picked up the
2025-01-22 19:31:24.640 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:31:24.665 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4194, 4200) -->  Mary journeyed to the garden
2025-01-22 19:31:24.665 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:31:24.688 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4756, 4761) -->  the senate. Mary went
2025-01-22 19:31:24.688 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:31:24.725 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7241, 7246) -->  cold. John went to
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:31:25.561 | INFO     | test_jbb_embedding:begin_test:693 - Mary's garden.<|eot_id|>
2025-01-22 19:31:25.561 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8144])
is_0k: False
your chose emoji: ['ğŸ‘¨ğŸ¾\u200dâ¤\u200dğŸ’‹\u200dğŸ‘¨ğŸ¿', 'ğŸ‘±ğŸ»\u200dâ™€', 'ğŸ§‘ğŸ¼\u200dğŸ’»', '3ï¸âƒ£', 'ğŸ‘°ğŸ¾\u200dâ™‚ï¸', 'â£ï¸', 'ğŸª', 'ğŸï¸', 'ğŸ¥¥', 'ğŸ‡¸ğŸ‡ª']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.19s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.39s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.66s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.26s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.71s/it]
Processing depth (1, 3, 5, 6):   0%|          | 0/100 [29:29<?, ?it/s]2025-01-22 19:31:44.385 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:31:44.390 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (830, 835) -->  Mary picked up the apple
2025-01-22 19:31:44.390 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:31:44.407 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2879, 2885) --> . Mary journeyed to the
2025-01-22 19:31:44.407 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:31:44.428 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4158, 4163) --> . Mary went to the
2025-01-22 19:31:44.428 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:31:44.452 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4768, 4773) -->  the senate. John went
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:31:45.366 | INFO     | test_jbb_embedding:begin_test:693 - Mary picked up the apple.<|eot_id|>
2025-01-22 19:31:45.366 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8172])
is_0k: False
your chose emoji: ['ğŸ’¸', 'ğŸ™ğŸ½', 'ğŸ¤œ', 'ğŸ¤´ğŸ»', 'ğŸ‘©ğŸ¾\u200dâ¤\u200dğŸ’‹\u200dğŸ‘©ğŸ»', 'ğŸ¤¹ğŸ»', 'ğŸ§‘ğŸ¾\u200dâ¤\u200dğŸ’‹\u200dğŸ§‘ğŸ¼', '6ï¸âƒ£', 'ğŸ§‘ğŸ¿\u200dğŸ¦±', 'ğŸ™‹ğŸ¼\u200dâ™‚']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.17s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.49s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.56s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.16s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.64s/it]
Processing depth (1, 3, 8, 9):   0%|          | 0/100 [29:49<?, ?it/s]2025-01-22 19:32:04.502 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:32:04.507 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (821, 826) --> . Mary picked up the
2025-01-22 19:32:04.507 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:32:04.524 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2875, 2881) --> . Mary journeyed to the
2025-01-22 19:32:04.524 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:32:04.555 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6484, 6489) --> . Mary went to the
2025-01-22 19:32:04.556 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:32:04.591 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7081, 7086) -->  John went to the office
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:32:05.459 | INFO     | test_jbb_embedding:begin_test:693 - Mary picked up the apple.<|eot_id|>
2025-01-22 19:32:05.459 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8126])
is_0k: False
your chose emoji: ['ğŸ™ğŸ»\u200dâ™€ï¸', 'ğŸ§™ğŸ»', 'ğŸ¤¾\u200dâ™€', 'ğŸ§ğŸ¼', 'ğŸ‘¨\u200dğŸ‘§', 'ğŸ™ğŸ»\u200dâ™€', 'ğŸ¤·ğŸ¿', 'â¤µ', 'ğŸ—', 'ğŸƒ\u200dâ™‚ï¸']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.04s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.46s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.61s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.22s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.67s/it]
Processing depth (0, 2, 6, 8):   0%|          | 0/100 [30:09<?, ?it/s]2025-01-22 19:32:24.129 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:32:24.130 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the apple.
2025-01-22 19:32:24.130 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:32:24.139 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1606, 1612) -->  Mary journeyed to the garden
2025-01-22 19:32:24.139 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:32:24.163 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4607, 4612) -->  Mary went to the bedroom
2025-01-22 19:32:24.164 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:32:24.200 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6494, 6499) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:32:24.998 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 19:32:24.999 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8158])
is_0k: False
your chose emoji: ['ğŸ‘©ğŸ¿\u200dğŸ”¬', 'â˜˜', 'ğŸ‘±ğŸ¼\u200dâ™‚ï¸', 'ğŸ’ƒğŸ»', '\U0001faf1ğŸ¾\u200d\U0001faf2ğŸ»', 'ğŸšµğŸ¾\u200dâ™€', 'â˜®ï¸', '2ï¸âƒ£', 'ğŸ‘¨\u200dğŸ‘¨\u200dğŸ‘§\u200dğŸ‘§', 'ğŸ’\u200dâ™‚']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.12s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.48s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.48s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.10s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.58s/it]
Processing depth (5, 7, 8, 9):   0%|          | 0/100 [30:28<?, ?it/s]2025-01-22 19:32:43.202 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:32:43.225 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4163, 4168) --> . Mary picked up the
2025-01-22 19:32:43.225 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:32:43.256 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5653, 5659) --> . Mary journeyed to the
2025-01-22 19:32:43.257 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:32:43.292 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6636, 6641) --> . Mary went to the
2025-01-22 19:32:43.292 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:32:43.327 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7133, 7138) -->  John went to the office
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:32:44.169 | INFO     | test_jbb_embedding:begin_test:693 - Mary's garden.<|eot_id|>
2025-01-22 19:32:44.169 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8170])
is_0k: False
your chose emoji: ['ğŸš¶ğŸ¼\u200dâ™€\u200dâ¡', 'ğŸ‘¨', 'ğŸ§‘ğŸ¼\u200dğŸ¦¯\u200dâ¡', 'ğŸ•¦', 'ğŸ‹ğŸ»\u200dâ™‚ï¸', 'ğŸ‘©ğŸ½\u200dğŸ’¼', 'ğŸ’‡ğŸ¿\u200dâ™‚ï¸', 'ğŸ¤«', 'ğŸ‘©ğŸ¿\u200dâ¤\u200dğŸ’‹\u200dğŸ‘¨ğŸ»', 'ğŸ§µ']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.33s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.73s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.38s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.83s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.44s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 1, 4, 6):   0%|          | 0/100 [30:47<?, ?it/s]2025-01-22 19:33:02.093 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:33:02.093 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the apple.
2025-01-22 19:33:02.093 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:33:02.100 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (829, 835) --> . Mary journeyed to the
2025-01-22 19:33:02.100 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:33:02.117 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3617, 3622) -->  Hon. Mary went to
2025-01-22 19:33:02.118 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:33:02.141 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4764, 4769) -->  the senate. John went
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:33:04.885 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 19:33:04.885 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8160])
is_0k: False
your chose emoji: ['ğŸ‡´ğŸ‡²', 'ğŸ’‡ğŸ¼\u200dâ™€', 'ğŸ‘¨ğŸ¾\u200dğŸ«', 'ğŸ§¤', '2âƒ£', 'ğŸ‡²ğŸ‡¦', '\U0001faf7ğŸ¿', 'ğŸ‘³ğŸ»\u200dâ™‚ï¸', 'ğŸ‘©ğŸ»\u200dğŸ”§', 'ğŸ§‘ğŸ¾\u200dâ¤ï¸\u200dğŸ§‘ğŸ¼']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:05<00:15,  5.26s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.91s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.64s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.23s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.83s/it]
Processing depth (0, 1, 5, 9):   0%|          | 0/100 [31:09<?, ?it/s]2025-01-22 19:33:24.799 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:33:24.800 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the apple.
2025-01-22 19:33:24.800 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:33:24.805 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (781, 787) --> . Mary journeyed to the
2025-01-22 19:33:24.805 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:33:24.826 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4110, 4115) --> . Mary went to the
2025-01-22 19:33:24.826 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:33:24.863 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7095, 7100) -->  John went to the office
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:33:25.660 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 19:33:25.661 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8156])
is_0k: False
your chose emoji: ['ğŸ˜™', 'ğŸ¤·ğŸ¾', 'ğŸ™‹ğŸ¼', 'ğŸ‘©ğŸ¾\u200dğŸ¦°', 'â†˜', 'ğŸ‘¨ğŸ¼\u200dâ¤ï¸\u200dğŸ‘¨ğŸ½', 'ğŸš´ğŸ¼\u200dâ™€ï¸', 'ğŸ¦¸', 'ğŸ§ğŸ¼', 'ğŸ‘©\u200dğŸ‘©\u200dğŸ‘§\u200dğŸ‘§']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.32s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.75s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.62s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.20s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.72s/it]
Processing depth (0, 1, 3, 7):   0%|          | 0/100 [31:30<?, ?it/s]2025-01-22 19:33:45.427 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:33:45.427 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the apple.
2025-01-22 19:33:45.427 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:33:45.432 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (819, 825) --> . Mary journeyed to the
2025-01-22 19:33:45.432 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:33:45.450 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2928, 2933) --> . Mary went to the
2025-01-22 19:33:45.450 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:33:45.478 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5651, 5656) -->  John went to the office
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:33:46.270 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 19:33:46.270 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8216])
is_0k: False
your chose emoji: ['ğŸ¤µğŸ»\u200dâ™€ï¸', 'ğŸ‘¨ğŸ¾\u200dğŸ«', 'ğŸ§ğŸ¼\u200dâ™‚\u200dâ¡', 'ğŸ‘©ğŸ½\u200dğŸ­', 'ğŸ‘©ğŸ»\u200dâ¤\u200dğŸ’‹\u200dğŸ‘©ğŸ»', 'ğŸ‡»ğŸ‡¬', 'ğŸ‘©ğŸ»\u200dâ¤ï¸\u200dğŸ‘©ğŸ½', 'ã€°', 'ğŸ‡³ğŸ‡¬', 'ğŸ‘¨ğŸ¼\u200dâ¤ï¸\u200dğŸ‘¨ğŸ¿']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.56s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.85s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.17s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.68s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.34s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 2, 5, 9):   0%|          | 0/100 [31:48<?, ?it/s]2025-01-22 19:34:03.852 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:34:03.853 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the apple.
2025-01-22 19:34:03.853 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:34:03.861 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1597, 1603) --> . Mary journeyed to the
2025-01-22 19:34:03.861 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:34:03.881 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4118, 4123) --> . Mary went to the
2025-01-22 19:34:03.882 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:34:03.921 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7225, 7230) -->  cold. John went to
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:34:11.302 | INFO     | test_jbb_embedding:begin_test:693 - Mary picked up the apple.<|eot_id|>
2025-01-22 19:34:11.303 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8140])
is_0k: False
your chose emoji: ['ğŸ‘±ğŸ»\u200dâ™€', 'ğŸ¤µğŸ¿\u200dâ™‚', 'ğŸ˜', 'ğŸ™ğŸ¿', 'ğŸ¤·\u200dâ™€ï¸', 'ğŸŒ©', 'ğŸ¤·ğŸ»', 'ğŸ¤¸ğŸ¾\u200dâ™€ï¸', 'ğŸ“ƒ', 'ğŸ‘¨ğŸ½\u200dâ¤\u200dğŸ‘¨ğŸ¾']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:05<00:15,  5.04s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.71s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.46s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.07s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.66s/it]
Processing depth (0, 1, 5, 7):   0%|          | 0/100 [32:16<?, ?it/s]2025-01-22 19:34:31.255 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:34:31.255 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the apple.
2025-01-22 19:34:31.255 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:34:31.261 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (825, 831) --> . Mary journeyed to the
2025-01-22 19:34:31.261 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:34:31.283 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4205, 4210) -->  Mary went to the bedroom
2025-01-22 19:34:31.284 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:34:31.316 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5610, 5615) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:34:32.116 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 19:34:32.116 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8118])
is_0k: False
your chose emoji: ['â™‰', 'ğŸš¶ğŸ¿\u200dâ™€ï¸', 'âœ”', 'ğŸ…ğŸ½', 'âœğŸ¼', 'ğŸ™ğŸ¾', 'ğŸš£', 'ğŸ’ğŸ»', 'ğŸ‘©ğŸ¿\u200dâ¤\u200dğŸ‘©ğŸ¼', 'â›¸ï¸']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.09s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:10,  5.07s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.92s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.37s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.90s/it]
Processing depth (1, 3, 4, 5):   0%|          | 0/100 [32:36<?, ?it/s]2025-01-22 19:34:51.648 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:34:51.652 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (667, 672) --> . Mary picked up the
2025-01-22 19:34:51.652 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:34:51.667 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2735, 2741) --> . Mary journeyed to the
2025-01-22 19:34:51.668 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:34:51.688 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3572, 3577) --> . Mary went to the
2025-01-22 19:34:51.688 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:34:51.708 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4156, 4161) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:34:52.498 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 19:34:52.498 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8150])
is_0k: False
your chose emoji: ['ğŸ‡·ğŸ‡ª', 'ğŸ™†ğŸ½\u200dâ™€', 'ğŸ‡ğŸ¿', 'ğŸ§ğŸ¿\u200dâ™€\u200dâ¡ï¸', 'ğŸ‘³ğŸ¼\u200dâ™€', 'ğŸ•¸ï¸', 'ğŸ', 'ğŸ¾', '\U0001fada', 'ğŸ‘©ğŸ»\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘¨ğŸ½']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  3.88s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.69s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.82s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.36s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.81s/it]
Processing depth (0, 2, 4, 8):   0%|          | 0/100 [32:56<?, ?it/s]2025-01-22 19:35:11.637 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:35:11.638 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the apple.
2025-01-22 19:35:11.638 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:35:11.647 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1799, 1805) --> . Mary journeyed to the
2025-01-22 19:35:11.647 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:35:11.667 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3609, 3614) -->  Hon. Mary went to
2025-01-22 19:35:11.668 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:35:11.702 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6586, 6591) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:35:12.568 | INFO     | test_jbb_embedding:begin_test:693 - Mary picked up the apple.<|eot_id|>
2025-01-22 19:35:12.569 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8108])
is_0k: False
your chose emoji: ['ğŸ™', 'ğŸ§\u200dâ™‚', 'ğŸ§ğŸ¼\u200dâ™€', 'âœŒ', 'ğŸ˜–', 'ğŸ‘«ğŸ¼', 'ğŸ§™\u200dâ™‚ï¸', 'ğŸ“¯', 'ğŸ§ğŸ¾\u200dâ™€ï¸', 'ğŸ¤¸\u200dâ™€']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  3.94s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.47s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.40s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.11s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.56s/it]
Processing depth (0, 1, 2, 4):   0%|          | 0/100 [33:15<?, ?it/s]2025-01-22 19:35:30.973 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:35:30.973 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the apple.
2025-01-22 19:35:30.973 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:35:30.978 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (901, 907) --> . Mary journeyed to the
2025-01-22 19:35:30.978 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:35:30.987 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1878, 1883) --> . Mary went to the
2025-01-22 19:35:30.987 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:35:31.005 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3648, 3653) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:35:31.804 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 19:35:31.805 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8205])
is_0k: False
your chose emoji: ['âš¡', '#âƒ£', 'ğŸƒğŸ½\u200dâ™‚\u200dâ¡', 'ğŸ¹', 'ğŸ‘©ğŸ¿\u200dâ¤\u200dğŸ‘©ğŸ¿', 'ğŸ‘¨ğŸ¿\u200dğŸ¦¯\u200dâ¡', 'ğŸ‘¨ğŸ¾\u200dğŸ¤\u200dğŸ‘¨ğŸ½', 'ğŸ§šğŸ»\u200dâ™‚', 'ğŸ¤¸ğŸ¿\u200dâ™‚', 'ğŸ‘¨ğŸ»\u200dâ¤\u200dğŸ‘¨ğŸ¿']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.56s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.71s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.19s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.70s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.34s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (1, 3, 4, 9):   0%|          | 0/100 [33:34<?, ?it/s]2025-01-22 19:35:49.296 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:35:49.300 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (780, 785) -->  Mary picked up the apple
2025-01-22 19:35:49.300 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:35:49.314 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2907, 2913) --> . Mary journeyed to the
2025-01-22 19:35:49.315 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:35:49.332 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3641, 3646) -->  Hon. Mary went to
2025-01-22 19:35:49.333 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:35:49.368 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7301, 7306) -->  cold. John went to
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:35:54.313 | INFO     | test_jbb_embedding:begin_test:693 - Mary's hand<|eot_id|>
2025-01-22 19:35:54.313 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8198])
is_0k: False
your chose emoji: ['ğŸ§‘ğŸ¼\u200dğŸš’', 'ğŸ‘©ğŸ¼\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘¨ğŸ¼', 'ğŸ§ğŸ½\u200dâ™‚ï¸\u200dâ¡', 'ğŸšµğŸ»\u200dâ™€ï¸', 'ğŸ‘ğŸ¾', 'ğŸ‘±ğŸ¼', 'ğŸ‘©ğŸ¿\u200dğŸ¦¯\u200dâ¡ï¸', 'ğŸŒ¤ï¸', 'ğŸ‘¨ğŸ¿\u200dğŸ³', 'ğŸ‘ğŸ»']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:05<00:15,  5.24s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.83s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.52s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.10s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.71s/it]
Processing depth (1, 6, 7, 9):   0%|          | 0/100 [33:59<?, ?it/s]2025-01-22 19:36:14.293 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:36:14.298 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (895, 900) --> . Mary picked up the
2025-01-22 19:36:14.298 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:36:14.321 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4745, 4751) -->  the senate. Mary journeyed
2025-01-22 19:36:14.321 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:36:14.349 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5702, 5707) --> . Mary went to the
2025-01-22 19:36:14.349 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:36:14.388 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7115, 7120) -->  John went to the office
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:36:15.165 | INFO     | test_jbb_embedding:begin_test:693 - Mary's hand<|eot_id|>
2025-01-22 19:36:15.165 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8158])
is_0k: False
your chose emoji: ['ğŸ‘«ğŸ½', 'ğŸ‡¬ğŸ‡®', 'ğŸ‘¦ğŸ¿', 'ğŸ‘¨\u200dğŸ¦°', 'ğŸ¤½ğŸ¼\u200dâ™‚', 'ğŸˆ³', 'ğŸ‡µğŸ‡°', 'ğŸ‘©ğŸ»\u200dğŸ¤\u200dğŸ‘©ğŸ½', 'ğŸš¶ğŸ»\u200dâ™‚ï¸', 'ğŸ‡¯ğŸ‡ª']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:05<00:15,  5.13s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.42s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:15<00:04,  4.97s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  3.46s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  4.09s/it]
Processing depth (1, 3, 4, 8):   0%|          | 0/100 [34:20<?, ?it/s]2025-01-22 19:36:35.431 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:36:35.435 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (813, 818) --> . Mary picked up the
2025-01-22 19:36:35.435 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:36:35.450 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2887, 2893) --> . Mary journeyed to the
2025-01-22 19:36:35.450 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:36:35.471 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3621, 3626) -->  Hon. Mary went to
2025-01-22 19:36:35.472 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:36:35.506 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6618, 6623) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:36:36.324 | INFO     | test_jbb_embedding:begin_test:693 - Mary's hand<|eot_id|>
2025-01-22 19:36:36.325 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8160])
is_0k: False
your chose emoji: ['ğŸ‘©ğŸ»\u200dğŸ¦½\u200dâ¡', 'ğŸ‘¨ğŸ¼\u200dğŸ¼', 'â—€', 'ğŸ™‡ğŸ½\u200dâ™€', 'ğŸ‘©ğŸ¼\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘©ğŸ»', 'ğŸ§‘ğŸ¼\u200dâœˆ', 'ğŸ˜º', 'ğŸŒ•', 'ğŸ‘ğŸ¿', 'ğŸ§œğŸ¼']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.97s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.81s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.61s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.38s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.88s/it]
Processing depth (1, 3, 5, 8):   0%|          | 0/100 [34:40<?, ?it/s]2025-01-22 19:36:55.872 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:36:55.878 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (895, 900) --> . Mary picked up the
2025-01-22 19:36:55.878 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:36:55.896 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2960, 2966) -->  tragedy. Mary journeyed to
2025-01-22 19:36:55.896 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:36:55.920 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4221, 4226) -->  Mary went to the bedroom
2025-01-22 19:36:55.921 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:36:55.955 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6590, 6595) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:36:56.787 | INFO     | test_jbb_embedding:begin_test:693 - Mary's hand.<|eot_id|>
2025-01-22 19:36:56.787 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8144])
is_0k: False
your chose emoji: ['ğŸ§šğŸ¾\u200dâ™€ï¸', 'ğŸš´ğŸ½', 'ğŸ§ğŸ¿\u200dâ™€', 'ğŸ‘½', 'ğŸ§—ğŸ¿', 'ğŸ§šğŸ»\u200dâ™€ï¸', 'ğŸ†', 'ğŸ', 'ğŸš¶ğŸ»\u200dâ™€ï¸\u200dâ¡ï¸', 'ğŸ¦¹ğŸ¾\u200dâ™‚']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.67s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.89s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.85s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.32s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.87s/it]
Processing depth (1, 2, 6, 9):   0%|          | 0/100 [35:01<?, ?it/s]2025-01-22 19:37:16.760 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:37:16.765 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (845, 850) --> . Mary picked up the
2025-01-22 19:37:16.765 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:37:16.774 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1817, 1823) --> . Mary journeyed to the
2025-01-22 19:37:16.774 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:37:16.798 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4750, 4755) --> . Mary went to the
2025-01-22 19:37:16.798 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:37:16.834 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7153, 7158) -->  John went to the office
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:37:17.769 | INFO     | test_jbb_embedding:begin_test:693 - Mary picked up the apple.<|eot_id|>
2025-01-22 19:37:17.769 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8190])
is_0k: False
your chose emoji: ['ğŸ‘®ğŸ¾', 'ğŸ‘©ğŸ¾\u200dâ¤\u200dğŸ’‹\u200dğŸ‘¨ğŸ¼', 'ğŸ§‘ğŸ¿\u200dğŸ¤\u200dğŸ§‘ğŸ¿', 'ğŸ‘¨ğŸ½\u200dğŸ¦°', 'ğŸ¦´', '\U0001faf1ğŸ¼\u200d\U0001faf2ğŸ½', 'ğŸš´ğŸ»\u200dâ™‚ï¸', 'ğŸ‡¬ğŸ‡­', '\U0001faf1ğŸ¾', 'ğŸŒ–']
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.67s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.90s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.50s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  2.92s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.56s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 1, 2, 9):   0%|          | 0/100 [35:21<?, ?it/s]2025-01-22 19:37:36.182 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the apple.
2025-01-22 19:37:36.183 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the apple.
2025-01-22 19:37:36.183 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:37:36.188 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (901, 907) --> . Mary journeyed to the
2025-01-22 19:37:36.188 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:37:36.197 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1852, 1857) --> . Mary went to the
2025-01-22 19:37:36.197 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:37:36.233 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7243, 7248) -->  John went to the office
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:37:39.140 | INFO     | test_jbb_embedding:begin_test:693 - the garden<|eot_id|>
2025-01-22 19:37:39.140 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8174])
Processing depth (0, 1, 2, 9):   0%|          | 0/100 [35:27<?, ?it/s]
2025-01-22 19:37:42.132 | INFO     | __main__:<module>:82 - Selected idx: 132
2025-01-22 19:37:42.132 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the apple before the bedroom? 
2025-01-22 19:37:42.132 | INFO     | __main__:<module>:84 - Answer: garden
2025-01-22 19:37:42.132 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 19:37:42.132 | INFO     | __main__:<module>:86 - Needle: [' Mary got the apple.', ' Mary journeyed to the garden.', ' John went to the office.', ' Mary went to the bedroom.', ' Sandra moved to the garden.']
2025-01-22 19:37:42.132 | INFO     | __main__:<module>:87 - Real Needle: [' Mary got the apple.', ' Mary journeyed to the garden.', ' Mary went to the bedroom.', ' Sandra moved to the garden.']
2025-01-22 19:37:42.132 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ’ğŸ½', 'ğŸ§‘ğŸ¼\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ§‘ğŸ»', 'ğŸ™…ğŸ¾\u200dâ™€ï¸', 'ğŸ™…ğŸ»\u200dâ™‚ï¸', 'â™¾ï¸', 'ğŸ˜—', 'ğŸ¤ŒğŸ½', 'ğŸ‘©ğŸ¿\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘¨ğŸ¿', 'ğŸ„ğŸ¼\u200dâ™€', 'ğŸ‘§']
is_0k: False
args.context_length: 3900
args.loss_type: label
cnt: 0
s_id: 130
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:05<00:15,  5.21s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.35s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:15<00:05,  5.05s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  3.47s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  4.10s/it]
Processing depth (1, 2, 4, 5):   0%|          | 0/100 [00:18<?, ?it/s]2025-01-22 19:38:00.809 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the apple.
2025-01-22 19:38:00.813 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (768, 772) -->  Mary got the apple
2025-01-22 19:38:00.814 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:38:00.823 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1552, 1558) --> . Mary journeyed to the
2025-01-22 19:38:00.824 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:38:00.843 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3473, 3478) --> . Mary went to the
2025-01-22 19:38:00.844 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra moved to the garden.
2025-01-22 19:38:00.863 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4081, 4086) --> . Sandra moved to the
2025-01-22 19:38:00.863 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went to the office.
2025-01-22 19:38:00.891 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5625, 5630) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:38:01.702 | INFO     | test_jbb_embedding:begin_test:693 - Mary's garden.<|eot_id|>
2025-01-22 19:38:01.702 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8097])
2025-01-22 19:38:03.907 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [250.075, 17.940788966049382, 75.1375, 17.330427631578946, 17.144667514534884], 'topk_indices': array([8081,  769, 8088, 1558,    1, 8084, 8087, 8080,   14,   24, 7950,
        772, 8085, 7995,  771, 8095, 7951, 8092,    0, 8093]), 'topk_tokens': [' Where', ' got', '?', ' garden', '<|start_header_id|>', ' apple', ' bedroom', ':', '\n', '\n\n', ' you', '.', ' before', ' location', ' apple', '<|end_header_id|>', ' context', '<|eot_id|>', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [551.3125, 287.2916666666667, 134.575, 79.925]}, 'weight': {'score': [21.397265625, 23.232282021604938, 18.6375, 23.239672020123837, 29.29796511627907], 'topk_indices': array([3314, 3287, 3207, 3159, 7392, 7354, 1450, 1512, 4314, 4298, 5109,
       5170, 7131, 7075, 3522, 3496, 4911, 4934, 4963, 4886]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.353515625, 20.052083333333332, 19.403125, 21.040625]}, 'saliency': {'score': [1.478948974609375, 0.09899040316358025, 0.36630859375, 0.09540702701722137, 0.12865785110828487], 'topk_indices': array([7991,   20, 8088,   24,  768, 1554, 3478, 7994, 7950, 8079, 7949,
        769, 8081, 1558, 8084, 8087, 8085, 7995,  771, 7951]), 'topk_tokens': [' item', ' Jul', '?', '\n\n', ' Mary', ' journey', ' bedroom', ' first', ' you', 'Question', ' provided', ' got', ' Where', ' garden', ' apple', ' bedroom', ' before', ' location', ' apple', ' context'], 'evidence_proportions': [3.672607421875, 1.5449625651041667, 0.6470703125, 0.4766845703125]}}, 'pred_res': "Mary's garden.<|eot_id|>", 'score': 100}
2025-01-22 19:38:03.920 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 19:38:03.920 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-132_pid-0_1-2-4-5.pkl | len: 3 |  size: 2.04 KB
Processing depth (1, 2, 4, 5):   1%|          | 1/100 [00:21<35:43, 21.65s/it]is_0k: False
your chose emoji: ['ğŸ§ğŸ¾\u200dâ™‚ï¸', 'ğŸ‘‹ğŸ¿', 'â¬†ï¸', '\U0001fabb', 'ğŸ‘ğŸ½', 'ğŸ¤²ğŸ¼', 'ğŸ†', 'âšœ', 'â™', 'â¤']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.36s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:10,  5.03s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.90s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.48s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.98s/it]
Processing depth (0, 4, 5, 8):   1%|          | 1/100 [00:39<35:43, 21.65s/it]2025-01-22 19:38:21.560 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the apple.
2025-01-22 19:38:21.600 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:38:21.618 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3627, 3633) -->  Hon. Mary journeyed to
2025-01-22 19:38:21.621 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:38:21.642 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4230, 4235) -->  Mary went to the bedroom
2025-01-22 19:38:21.642 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra moved to the garden.
2025-01-22 19:38:21.675 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6637, 6642) --> . Sandra moved to the
2025-01-22 19:38:21.675 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went to the office.
2025-01-22 19:38:21.704 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5801, 5806) --> . John went to the
2025-01-22 19:38:21.704 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 19:38:21.704 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 19:38:21.705 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 19:38:21.705 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ‘©ğŸ¿\u200dâ¤\u200dğŸ’‹\u200dğŸ‘©ğŸ½', 'ğŸ¤½\u200dâ™‚ï¸', 'ğŸš¶ğŸ»\u200dâ™€\u200dâ¡ï¸', 'ğŸ’¶', 'ğŸ“ ', 'ğŸ“¿', 'ğŸ‘°ğŸ½\u200dâ™€', 'ğŸ¤œğŸ½', 'ğŸ§ğŸ½', 'ğŸ‘©ğŸ¿\u200dğŸ¦½\u200dâ¡']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.15s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.41s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.52s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.14s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.60s/it]
Processing depth (0, 1, 2, 3):   1%|          | 1/100 [00:55<35:43, 21.65s/it]2025-01-22 19:38:37.908 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the apple.
2025-01-22 19:38:37.948 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:38:37.953 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (820, 826) --> . Mary journeyed to the
2025-01-22 19:38:37.953 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:38:37.964 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1853, 1858) --> . Mary went to the
2025-01-22 19:38:37.964 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra moved to the garden.
2025-01-22 19:38:37.980 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2927, 2932) --> . Sandra moved to the
2025-01-22 19:38:37.980 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went to the office.
2025-01-22 19:38:38.008 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5703, 5708) --> . John went to the
2025-01-22 19:38:38.008 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 19:38:38.008 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 19:38:38.008 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 19:38:38.008 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸŒµ', 'â™»ï¸', 'ğŸ‘¨ğŸ½\u200dğŸ”¬', 'ğŸ•ºğŸ»', 'âš±', 'ğŸ•ºğŸ¾', 'ğŸ§‘ğŸ¿\u200dâ¤\u200dğŸ’‹\u200dğŸ§‘ğŸ¾', 'ğŸ†•', 'ğŸ–Œï¸', 'ğŸ‘ˆğŸ¿']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.07s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:09,  4.55s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.84s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.35s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.80s/it]
Processing depth (0, 2, 5, 7):   1%|          | 1/100 [01:12<35:43, 21.65s/it]2025-01-22 19:38:55.002 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the apple.
2025-01-22 19:38:55.047 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:38:55.055 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1728, 1734) --> . Mary journeyed to the
2025-01-22 19:38:55.056 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:38:55.075 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4133, 4138) --> . Mary went to the
2025-01-22 19:38:55.075 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra moved to the garden.
2025-01-22 19:38:55.103 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5549, 5554) --> . Sandra moved to the
2025-01-22 19:38:55.103 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went to the office.
2025-01-22 19:38:55.132 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5605, 5610) --> . John went to the
2025-01-22 19:38:55.133 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 19:38:55.133 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 19:38:55.133 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 19:38:55.133 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ§ğŸ¿', 'ğŸ§‘ğŸ¾\u200dğŸ¦³', 'ğŸ™‡ğŸ»\u200dâ™€ï¸', 'ğŸ§‘ğŸ½\u200dâš–ï¸', 'ğŸ‡©ğŸ‡°', 'â™', 'ğŸ¦¾', 'ğŸ¤¸', 'â˜‚', 'ğŸ·']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.38s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.24s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.36s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.16s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.59s/it]
Processing depth (5, 6, 7, 8):   1%|          | 1/100 [01:29<35:43, 21.65s/it]2025-01-22 19:39:11.374 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the apple.
2025-01-22 19:39:11.394 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4112, 4116) -->  Mary got the apple
2025-01-22 19:39:11.394 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:39:11.419 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4672, 4678) --> . Mary journeyed to the
2025-01-22 19:39:11.419 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:39:11.446 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5557, 5562) --> . Mary went to the
2025-01-22 19:39:11.446 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra moved to the garden.
2025-01-22 19:39:11.479 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6475, 6480) --> . Sandra moved to the
2025-01-22 19:39:11.479 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went to the office.
2025-01-22 19:39:11.508 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5611, 5616) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:39:12.358 | INFO     | test_jbb_embedding:begin_test:693 - Mary's garden.<|eot_id|>
2025-01-22 19:39:12.358 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8105])
2025-01-22 19:39:14.571 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [338.603125, 28.501653459546127, 125.725, 27.674219813188174, 24.64353390957447], 'topk_indices': array([   4, 8099, 8086,   23, 4116, 4112, 8096, 8095, 4113,    9, 7959,
       8088, 8093,   14,   24, 4115, 8103, 8100,    0, 8101]), 'topk_tokens': ['\n\n', ':', '.\n\n', '4', '.', ' Mary', '?', ' bedroom', ' got', ':', ' context', ':', ' before', '\n', '\n\n', ' apple', '<|end_header_id|>', '<|eot_id|>', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [791.5, 283.3333333333333, 241.725, 139.4875]}, 'weight': {'score': [21.397265625, 23.2407826375185, 18.6375, 23.248191613571695, 29.51496010638298], 'topk_indices': array([3235, 3262, 3107, 3155, 7394, 7356, 1403, 1465, 4253, 4269, 5089,
       5150, 7133, 7077, 3444, 3418, 4943, 4914, 4879, 4854]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.353515625, 20.052083333333332, 19.403125, 21.040625]}, 'saliency': {'score': [2.0371826171875, 0.15741382329759188, 0.60625, 0.1524850150876067, 0.18537285987367022], 'topk_indices': array([4678, 8086,    8,   20, 7957, 4235, 8096, 8003, 8098, 8089, 8092,
       8087,   24, 4113, 5562, 4112, 7959, 8093, 8095, 4115]), 'topk_tokens': [' garden', '.\n\n', ' Date', ' Jul', ' provided', 'nes', '?', ' location', 'Answer', ' Where', ' apple', 'Question', '\n\n', ' got', ' bedroom', ' Mary', ' context', ' before', ' bedroom', ' apple'], 'evidence_proportions': [5.48046875, 1.5301106770833333, 1.145166015625, 0.783056640625]}}, 'pred_res': "Mary's garden.<|eot_id|>", 'score': 100}
2025-01-22 19:39:14.576 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 19:39:14.577 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-132_pid-1_5-6-7-8.pkl | len: 3 |  size: 1.99 KB
Processing depth (5, 6, 7, 8):   2%|â–         | 2/100 [01:32<1:22:26, 50.48s/it]is_0k: False
your chose emoji: ['ğŸ‘ƒğŸ¿', 'ğŸ§—\u200dâ™€ï¸', 'ğŸ«', 'ğŸªš', 'ğŸ‘°ğŸ½', 'ğŸ™\u200dâ™€', 'ğŸœ', 'â›¹ğŸ¼\u200dâ™‚', 'ğŸ¥', 'ğŸ—“ï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.90s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.18s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.83s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.34s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.94s/it]
Processing depth (5, 6, 8, 9):   2%|â–         | 2/100 [01:49<1:22:26, 50.48s/it]2025-01-22 19:39:32.164 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the apple.
2025-01-22 19:39:32.184 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4193, 4197) -->  got the apple.
2025-01-22 19:39:32.184 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:39:32.210 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4762, 4768) -->  the senate. Mary journeyed
2025-01-22 19:39:32.210 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:39:32.244 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6627, 6632) --> . Mary went to the
2025-01-22 19:39:32.244 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra moved to the garden.
2025-01-22 19:39:32.279 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7237, 7242) --> . Sandra moved to the
2025-01-22 19:39:32.279 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went to the office.
2025-01-22 19:39:32.310 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5735, 5740) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:39:33.148 | INFO     | test_jbb_embedding:begin_test:693 - Mary's garden.<|eot_id|>
2025-01-22 19:39:33.148 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8187])
2025-01-22 19:39:35.420 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [368.415625, 24.18179181929182, 130.15, 23.273706368646664, 21.652077414772727], 'topk_indices': array([8041, 8180, 8174,    9, 6632,   23, 8177, 8170, 8175, 8181, 4192,
         14, 4193,   24, 4770, 4195, 8182, 8183, 8185,    0]), 'topk_tokens': [' context', 'Answer', ' apple', ':', ' bedroom', '4', ' bedroom', ':', ' before', ':', ' Mary', '\n', ' got', '\n\n', ' garden', ' apple', '<|eot_id|>', '<|start_header_id|>', '<|end_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [678.9375, 273.1354166666667, 391.1, 211.65]}, 'weight': {'score': [21.42265625, 23.30476381257631, 18.6375, 23.31223208818126, 29.569069602272727], 'topk_indices': array([3283, 3310, 3155, 3203, 7428, 7466, 1437, 1499, 4283, 4267, 5129,
       5190, 7187, 7131, 3466, 3492, 4983, 4954, 4915, 4890]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.5703125, 23.9921875, 19.403125, 21.040625]}, 'saliency': {'score': [2.16544189453125, 0.1353208288022741, 0.6910888671875, 0.1300077532962722, 0.1595060175115412], 'topk_indices': array([  23,    8,   20, 7238, 6629, 8171, 4766, 8041,   24, 8169, 6628,
       8175, 8174, 8180, 6632, 8177, 4192, 4193, 4770, 4195]), 'topk_tokens': ['4', ' Date', ' Jul', ' Sandra', ' went', ' Where', ' journey', ' context', '\n\n', 'Question', ' Mary', ' before', ' apple', 'Answer', ' bedroom', ' bedroom', ' Mary', ' got', ' garden', ' apple'], 'evidence_proportions': [4.17822265625, 1.65771484375, 2.10703125, 1.222900390625]}}, 'pred_res': "Mary's garden.<|eot_id|>", 'score': 100}
2025-01-22 19:39:35.427 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 19:39:35.428 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-132_pid-2_5-6-8-9.pkl | len: 3 |  size: 2.01 KB
Processing depth (5, 6, 8, 9):   3%|â–         | 3/100 [01:53<59:44, 36.95s/it]  is_0k: False
your chose emoji: ['ğŸ‘©ğŸ½\u200dğŸ¦½\u200dâ¡ï¸', 'ğŸ¤½ğŸ¾', 'ğŸ¤½ğŸ¼\u200dâ™€', 'ğŸ‘©ğŸ¾\u200dâ¤ï¸\u200dğŸ‘¨ğŸ¾', 'ğŸ§™', 'ğŸ›¡ï¸', 'ğŸ™†ğŸ½', 'ğŸ‘©ğŸ»\u200dâ¤ï¸\u200dğŸ‘¨ğŸ¼', 'ğŸ§”ğŸ»', 'ğŸ‘³ğŸ¼\u200dâ™€ï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.68s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.22s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:15<00:05,  5.35s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  3.68s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  4.23s/it]
Processing depth (1, 4, 5, 6):   3%|â–         | 3/100 [02:12<59:44, 36.95s/it]2025-01-22 19:39:54.412 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the apple.
2025-01-22 19:39:54.417 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (896, 900) -->  Mary got the apple
2025-01-22 19:39:54.417 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:39:54.439 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3702, 3708) --> . Mary journeyed to the
2025-01-22 19:39:54.439 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:39:54.459 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4249, 4254) --> . Mary went to the
2025-01-22 19:39:54.460 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra moved to the garden.
2025-01-22 19:39:54.483 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4871, 4876) --> . Sandra moved to the
2025-01-22 19:39:54.483 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went to the office.
2025-01-22 19:39:54.515 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5807, 5812) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:39:55.342 | INFO     | test_jbb_embedding:begin_test:693 - Mary's garden.<|eot_id|>
2025-01-22 19:39:55.342 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8137])
2025-01-22 19:39:57.554 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [297.39375, 21.18615248771499, 20.196875, 20.50602857362908, 10.02508060515873], 'topk_indices': array([8119,    3, 8128, 8131, 8127, 3708, 8120,  896,   23,  900, 7991,
       8035,   14, 8125,   24,  899, 8132, 8135,    0, 8133]), 'topk_tokens': ['Question', '<|end_header_id|>', '?', ':', ' bedroom', ' garden', ':', ' Mary', '4', '.', ' context', ' location', '\n', ' before', '\n\n', ' apple', '<|eot_id|>', '<|end_header_id|>', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [701.625, 272.1041666666667, 138.4375, 163.3125]}, 'weight': {'score': [21.397265625, 23.259684044840295, 18.6375, 23.267122034812076, 29.142609126984127], 'topk_indices': array([3263, 3236, 3108, 3156, 7416, 7378, 1466, 1404, 4222, 4238, 5150,
       5089, 7099, 7155, 3445, 3419, 4925, 4842, 4896, 4867]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.353515625, 20.052083333333332, 19.403125, 21.040625]}, 'saliency': {'score': [1.78079833984375, 0.11668601446128302, 0.095941162109375, 0.11259747197873345, 0.07532016814701141], 'topk_indices': array([8034, 8128,   19,  257,   23,   20,  897, 4254, 8121,   24, 8130,
       8124, 8119, 8035, 7991, 3708,  896, 8125, 8127,  899]), 'topk_tokens': [' first', '?', '26', 'hue', '4', ' Jul', ' got', ' bedroom', ' Where', '\n\n', 'Answer', ' apple', 'Question', ' location', ' context', ' garden', ' Mary', ' before', ' bedroom', ' apple'], 'evidence_proportions': [4.8466796875, 1.4268391927083333, 0.6576171875, 0.876025390625]}}, 'pred_res': "Mary's garden.<|eot_id|>", 'score': 100}
2025-01-22 19:39:57.579 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 19:39:57.579 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-132_pid-3_1-4-5-6.pkl | len: 3 |  size: 2.01 KB
Processing depth (1, 4, 5, 6):   4%|â–         | 4/100 [02:15<49:46, 31.11s/it]is_0k: False
your chose emoji: ['ğŸš¡', 'ğŸ§”', 'ğŸ¤¸ğŸ¼', 'ğŸ•\u200dğŸ¦º', 'ğŸ‘©ğŸ¿\u200dâ¤\u200dğŸ‘©ğŸ»', 'ğŸš£ğŸ¾\u200dâ™€', 'ğŸ§–ğŸ»', 'ğŸª', 'ğŸ™†ğŸ¾\u200dâ™€ï¸', 'â˜¸ï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.15s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.70s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.79s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.37s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.83s/it]
Processing depth (1, 2, 4, 7):   4%|â–         | 4/100 [02:32<49:46, 31.11s/it]2025-01-22 19:40:14.676 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the apple.
2025-01-22 19:40:14.680 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (779, 783) -->  got the apple.
2025-01-22 19:40:14.680 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:40:14.690 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1752, 1758) --> . Mary journeyed to the
2025-01-22 19:40:14.690 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:40:14.708 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3619, 3624) --> . Mary went to the
2025-01-22 19:40:14.709 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra moved to the garden.
2025-01-22 19:40:14.741 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5605, 5610) --> . Sandra moved to the
2025-01-22 19:40:14.741 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went to the office.
2025-01-22 19:40:14.774 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5661, 5666) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:40:15.582 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 19:40:15.583 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8201])
2025-01-22 19:40:17.862 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [90.50859375, 10.377142628595807, 5.88046875, 10.183947170344785, 10.649208470394736], 'topk_indices': array([  22,   13,    4, 8055,    3, 8195, 8182, 8197,   19,   20, 8200,
          1,    9, 1758,   24,   14,   23, 8199,    0, 8196]), 'topk_tokens': ['202', '3', '\n\n', ' context', '<|end_header_id|>', ':', '.\n\n', '<|start_header_id|>', '26', ' Jul', '\n\n', '<|start_header_id|>', ':', ' garden', '\n\n', '\n', '4', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [164.015625, 85.84895833333333, 87.89375, 39.909375]}, 'weight': {'score': [20.240625, 23.31742899804973, 18.6375, 23.32781360802054, 29.654276315789474], 'topk_indices': array([3283, 3310, 3155, 3203, 7454, 7492, 1450, 1512, 4288, 4304, 5248,
       5187, 7231, 7175, 3486, 3512, 5041, 5012, 4958, 4983]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.5703125, 20.052083333333332, 19.403125, 21.040625]}, 'saliency': {'score': [0.452655029296875, 0.056983992392002, 0.0275054931640625, 0.056034484109576545, 0.08110504150390625], 'topk_indices': array([   9, 8183,   14, 8182, 8200,   15, 8189, 8194,    8, 8170, 8099,
       8191,   22,   16,   24,   19, 8055,   20,   23, 1758]), 'topk_tokens': [':', 'Question', '\n', '.\n\n', '\n\n', 'Today', ' before', 'Answer', ' Date', ' return', ' location', ' bedroom', '202', ' Date', '\n\n', '26', ' context', ' Jul', '4', ' garden'], 'evidence_proportions': [0.890869140625, 0.40838623046875, 0.382177734375, 0.22568359375]}}, 'pred_res': 'The garden.<|eot_id|>', 'score': 100}
2025-01-22 19:40:17.873 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 19:40:17.873 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-132_pid-4_1-2-4-7.pkl | len: 3 |  size: 1.99 KB
Processing depth (1, 2, 4, 7):   5%|â–Œ         | 5/100 [02:35<43:04, 27.21s/it]Processing depth (1, 2, 4, 7):   5%|â–Œ         | 5/100 [02:35<49:17, 31.13s/it]
2025-01-22 19:40:17.931 | INFO     | __main__:<module>:82 - Selected idx: 134
2025-01-22 19:40:17.931 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the apple before the bedroom? 
2025-01-22 19:40:17.931 | INFO     | __main__:<module>:84 - Answer: garden
2025-01-22 19:40:17.931 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 19:40:17.931 | INFO     | __main__:<module>:86 - Needle: [' John went to the office.', ' Sandra moved to the garden.', ' Mary took the apple.', ' Mary journeyed to the garden.', ' Mary went to the bedroom.', ' John moved to the kitchen.']
2025-01-22 19:40:17.931 | INFO     | __main__:<module>:87 - Real Needle: [' Mary took the apple.', ' Mary journeyed to the garden.', ' Mary went to the bedroom.', ' John moved to the kitchen.']
2025-01-22 19:40:17.931 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ‘©ğŸ»\u200dğŸ¨', 'ğŸ‘©ğŸ¾\u200dâ¤\u200dğŸ‘©ğŸ¾', 'ğŸ§˜ğŸ½\u200dâ™‚ï¸', 'ğŸ‘³ğŸ»\u200dâ™‚ï¸', 'ãŠ™', 'ğŸ‘©ğŸ¿\u200dğŸ¦½\u200dâ¡', 'ğŸŒš', 'ğŸ§‘ğŸ½\u200dâ¤\u200dğŸ’‹\u200dğŸ§‘ğŸ¼', 'ğŸ‘¨ğŸ»\u200dğŸ”¬', 'â˜ ï¸']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.01s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.41s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.42s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.88s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.41s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (3, 4, 7, 9):   0%|          | 0/100 [00:15<?, ?it/s]2025-01-22 19:40:33.406 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary took the apple.
2025-01-22 19:40:33.422 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2962, 2966) -->  Mary took the apple
2025-01-22 19:40:33.422 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:40:33.442 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3623, 3629) -->  Mary journeyed to the garden
2025-01-22 19:40:33.442 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:40:33.471 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5743, 5748) --> . Mary went to the
2025-01-22 19:40:33.471 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John moved to the kitchen.
2025-01-22 19:40:33.511 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7265, 7270) --> . John moved to the
2025-01-22 19:40:33.512 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went to the office.
2025-01-22 19:40:33.516 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (959, 964) --> . John went to the
2025-01-22 19:40:33.516 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the garden.
2025-01-22 19:40:33.537 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4218, 4223) -->  Sandra moved to the garden
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:40:36.623 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 19:40:36.623 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8207])
2025-01-22 19:40:39.584 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [132.29921875, 11.243014426004873, 68.671875, 10.876827055317849, 11.733182565789473], 'topk_indices': array([8056, 8180,    4, 8176, 8060, 8201,    1, 8105, 8095, 2965, 8206,
       3628,    9, 8061,   23,   24,   14, 8205,    0, 8202]), 'topk_tokens': ['\n', '.', '\n\n', ' return', ' you', ':', '<|start_header_id|>', ' location', '.\n\n', ' apple', '\n\n', ' garden', ':', ' context', '4', '\n\n', '\n', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [221.453125, 174.29166666666666, 105.4375, 37.446875]}, 'weight': {'score': [21.96328125, 23.320582749695493, 22.09609375, 23.3253982655868, 29.85559210526316], 'topk_indices': array([3242, 3269, 3114, 3162, 7444, 7482, 1411, 1473, 4286, 4270, 5160,
       5099, 7159, 7215, 3425, 3451, 4858, 4906, 4935, 4883]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.240234375, 23.813802083333332, 19.403125, 18.88125]}, 'saliency': {'score': [0.8277679443359375, 0.062014644125637564, 0.421466064453125, 0.05970295950369613, 0.0893798828125], 'topk_indices': array([8195,   16, 8189, 8206, 8060, 8095, 8200,   19, 8179, 8059,    8,
       8176, 8197,   24,   20, 8105,   23, 2965, 3628, 8061]), 'topk_tokens': [' before', ' Date', 'Question', '\n\n', ' you', '.\n\n', 'Answer', '26', ' directly', ' provided', ' Date', ' return', ' bedroom', '\n\n', ' Jul', ' location', '4', ' apple', ' garden', ' context'], 'evidence_proportions': [1.5, 1.146240234375, 0.5582275390625, 0.17735595703125]}}, 'pred_res': 'The garden.<|eot_id|>', 'score': 100}
2025-01-22 19:40:39.591 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 19:40:39.591 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-134_pid-0_3-4-7-9.pkl | len: 3 |  size: 1.99 KB
Processing depth (3, 4, 7, 9):   1%|          | 1/100 [00:21<35:33, 21.55s/it]is_0k: False
your chose emoji: ['ğŸš¶\u200dâ™€\u200dâ¡ï¸', 'ğŸ‘©ğŸ½\u200dğŸ¦¼', 'ğŸ™‡ğŸ¿\u200dâ™‚', 'ğŸ©¹', 'ğŸƒ', 'ğŸ‘©ğŸ¿\u200dâ¤ï¸\u200dğŸ‘©ğŸ¼', 'ğŸšµğŸ»\u200dâ™‚', 'ğŸ‘¨ğŸ»\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘¨ğŸ½', 'ğŸ¤½ğŸ¾\u200dâ™‚', 'ğŸ™‡ğŸ»\u200dâ™€']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.89s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.11s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.81s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.32s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.91s/it]
Processing depth (1, 2, 3, 9):   1%|          | 1/100 [00:39<35:33, 21.55s/it]2025-01-22 19:40:57.218 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary took the apple.
2025-01-22 19:40:57.222 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (896, 900) -->  Mary took the apple
2025-01-22 19:40:57.223 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:40:57.231 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1736, 1742) --> . Mary journeyed to the
2025-01-22 19:40:57.232 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:40:57.246 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2839, 2844) --> . Mary went to the
2025-01-22 19:40:57.246 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John moved to the kitchen.
2025-01-22 19:40:57.281 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7201, 7206) --> . John moved to the
2025-01-22 19:40:57.281 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went to the office.
2025-01-22 19:40:57.286 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (964, 969) --> . John went to the
2025-01-22 19:40:57.286 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the garden.
2025-01-22 19:40:57.306 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4145, 4150) --> . Sandra moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:40:58.147 | INFO     | test_jbb_embedding:begin_test:693 - Mary's garden.<|eot_id|>
2025-01-22 19:40:58.147 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8133])
2025-01-22 19:41:00.395 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [272.6625, 21.788355764503443, 169.6, 20.98702350111029, 13.082906788793103], 'topk_indices': array([8124,   23, 8120,  898,  896, 7987, 8123, 8031, 8116, 8127, 8021,
         24,   14,  900, 8121,  899, 8128, 8131, 8129,    0]), 'topk_tokens': ['?', '4', ' apple', ' the', ' Mary', ' context', ' bedroom', ' location', ':', ':', '.\n\n', '\n\n', '\n', '.', ' before', ' apple', '<|eot_id|>', '<|end_header_id|>', '<|start_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [680.625, 257.0625, 158.3, 79.375]}, 'weight': {'score': [20.834765625, 23.25383711283186, 19.8390625, 23.26401835831483, 29.34321120689655], 'topk_indices': array([3297, 3324, 3217, 3169, 7418, 7380, 1434, 1496, 4304, 4288, 5105,
       5166, 7151, 7095, 3486, 3512, 4924, 4901, 4876, 4953]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.240234375, 20.052083333333332, 19.403125, 18.88125]}, 'saliency': {'score': [1.617730712890625, 0.12024381144325759, 0.9174072265625, 0.11556562587946043, 0.09489546150996767], 'topk_indices': array([8030, 8102,   20, 8124,   24, 8021, 8117,  897, 1742, 8027, 8115,
       2844, 8031, 7987, 8126, 8120,  896, 8121, 8123,  899]), 'topk_tokens': [' first', ' return', ' Jul', '?', '\n\n', '.\n\n', ' Where', ' took', ' garden', ' item', 'Question', ' bedroom', ' location', ' context', 'Answer', ' apple', ' Mary', ' before', ' bedroom', ' apple'], 'evidence_proportions': [4.61669921875, 1.358154296875, 0.75224609375, 0.3955322265625]}}, 'pred_res': "Mary's garden.<|eot_id|>", 'score': 100}
2025-01-22 19:41:00.420 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 19:41:00.420 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-134_pid-1_1-2-3-9.pkl | len: 3 |  size: 2.01 KB
Processing depth (1, 2, 3, 9):   2%|â–         | 2/100 [00:42<34:30, 21.13s/it]is_0k: False
your chose emoji: ['ğŸ••', 'ğŸ¦·', 'ğŸ¦', 'ğŸ§´', 'ğŸ½', 'ğŸ§ğŸ¿\u200dâ™€\u200dâ¡ï¸', 'ğŸŠğŸ¼', 'ğŸ›·', 'ğŸ‘©ğŸ¼\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘©ğŸ½', 'ğŸ¤º']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.57s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.77s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.63s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.29s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.79s/it]
Processing depth (1, 4, 5, 7):   2%|â–         | 2/100 [00:59<34:30, 21.13s/it]2025-01-22 19:41:17.822 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary took the apple.
2025-01-22 19:41:17.826 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (824, 828) -->  Mary took the apple
2025-01-22 19:41:17.826 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:41:17.845 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3630, 3636) --> . Mary journeyed to the
2025-01-22 19:41:17.846 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:41:17.870 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4159, 4164) --> . Mary went to the
2025-01-22 19:41:17.870 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John moved to the kitchen.
2025-01-22 19:41:17.898 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5611, 5616) --> . John moved to the
2025-01-22 19:41:17.898 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went to the office.
2025-01-22 19:41:17.903 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (914, 919) --> . John went to the
2025-01-22 19:41:17.903 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the garden.
2025-01-22 19:41:17.930 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4163, 4168) -->  the bedroom. Sandra moved
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:41:18.794 | INFO     | test_jbb_embedding:begin_test:693 - Mary took the apple.<|eot_id|>
2025-01-22 19:41:18.794 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8191])
2025-01-22 19:41:21.047 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [272.3578125, 20.803469001708567, 141.6, 20.039253889024987, 15.222274604885058], 'topk_indices': array([   1, 8185, 8079, 8174, 3636,  826,  825,  828,    9, 8179, 8045,
         23, 8089,   24,   14, 8189,  827, 8187, 8186,    0]), 'topk_tokens': ['<|start_header_id|>', ':', '.\n\n', ':', ' garden', ' the', ' took', '.', ':', ' before', ' context', '4', ' location', '\n\n', '\n', '<|end_header_id|>', ' apple', '<|start_header_id|>', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [666.375, 291.3958333333333, 134.925, 71.73125]}, 'weight': {'score': [20.834765625, 23.30179285147669, 22.134375, 23.30926648242283, 29.57165948275862], 'topk_indices': array([3295, 3268, 3140, 3188, 7462, 7424, 1424, 1486, 4352, 4336, 5254,
       5193, 7201, 7145, 3451, 3477, 4995, 4970, 5047, 5018]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.240234375, 20.052083333333332, 19.403125, 18.88125]}, 'saliency': {'score': [1.588568115234375, 0.11571779220838037, 0.868017578125, 0.11118814934707634, 0.11452356974283855], 'topk_indices': array([4164, 8184,   19, 8043,    8, 3632,  824, 8088, 8178, 8173,   23,
         20,   24, 8181, 8179,  825, 3636, 8045, 8089,  827]), 'topk_tokens': [' bedroom', 'Answer', '26', ' provided', ' Date', ' journey', ' Mary', ' first', ' apple', 'Question', '4', ' Jul', '\n\n', ' bedroom', ' before', ' took', ' garden', ' context', ' location', ' apple'], 'evidence_proportions': [4.45166015625, 1.5035807291666667, 0.64482421875, 0.3438232421875]}}, 'pred_res': 'Mary took the apple.<|eot_id|>', 'score': 0}
2025-01-22 19:41:21.059 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 19:41:21.060 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-134_pid-2_1-4-5-7.pkl | len: 3 |  size: 2.02 KB
Processing depth (1, 4, 5, 7):   3%|â–         | 3/100 [01:03<33:47, 20.90s/it]is_0k: False
your chose emoji: ['ğŸ™ğŸ¿\u200dâ™‚', 'ğŸ§™\u200dâ™‚ï¸', 'ğŸ§‘ğŸ¿\u200dğŸ”¬', 'ğŸ‘¨ğŸ¾\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘¨ğŸ»', 'ğŸš‹', 'ğŸ”Œ', 'ğŸ†', 'ğŸ‘©ğŸ»\u200dğŸ¤\u200dğŸ‘©ğŸ¼', 'ğŸ•´ğŸ»', 'ğŸ§ğŸ¾\u200dâ™‚ï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.45s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.44s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.00s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:12<00:00,  2.60s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:12<00:00,  3.21s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 1, 2, 6):   3%|â–         | 3/100 [01:17<33:47, 20.90s/it]2025-01-22 19:41:35.730 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary took the apple.
2025-01-22 19:41:35.777 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:41:35.782 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (820, 826) --> . Mary journeyed to the
2025-01-22 19:41:35.782 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:41:35.791 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1771, 1776) --> . Mary went to the
2025-01-22 19:41:35.791 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John moved to the kitchen.
2025-01-22 19:41:35.816 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4825, 4830) -->  the senate. John moved
2025-01-22 19:41:35.816 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went to the office.
2025-01-22 19:41:35.821 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (913, 918) --> . John went to the
2025-01-22 19:41:35.822 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the garden.
2025-01-22 19:41:35.848 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4246, 4251) -->  Sandra moved to the garden
2025-01-22 19:41:35.849 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 19:41:35.849 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 19:41:35.849 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 19:41:35.849 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ‘©ğŸ¿\u200dâ¤\u200dğŸ’‹\u200dğŸ‘©ğŸ¼', 'ğŸ‘©ğŸ¼\u200dâœˆï¸', 'ğŸ§‘ğŸ¾\u200dâ¤\u200dğŸ§‘ğŸ¿', 'ğŸ¦¸ğŸ¼\u200dâ™€', 'ğŸ‡¼ğŸ‡¸', 'ğŸ‘¨\u200dâš•ï¸', 'ğŸŒ™', 'ğŸ', 'ğŸ‘¨ğŸ¾\u200dâ¤\u200dğŸ’‹\u200dğŸ‘¨ğŸ¼', 'ğŸ‘©ğŸ¼\u200dâ¤\u200dğŸ’‹\u200dğŸ‘¨ğŸ¾']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:05<00:15,  5.11s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.21s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.84s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.28s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.92s/it]
Processing depth (1, 3, 6, 7):   3%|â–         | 3/100 [01:35<33:47, 20.90s/it]2025-01-22 19:41:53.305 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary took the apple.
2025-01-22 19:41:53.310 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (896, 900) -->  Mary took the apple
2025-01-22 19:41:53.310 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:41:53.325 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2963, 2969) -->  tragedy. Mary journeyed to
2025-01-22 19:41:53.325 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:41:53.348 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4701, 4706) --> . Mary went to the
2025-01-22 19:41:53.348 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John moved to the kitchen.
2025-01-22 19:41:53.375 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5539, 5544) --> . John moved to the
2025-01-22 19:41:53.375 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went to the office.
2025-01-22 19:41:53.380 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (905, 910) -->  John went to the office
2025-01-22 19:41:53.380 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the garden.
2025-01-22 19:41:53.405 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4186, 4191) -->  Sandra moved to the garden
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:41:54.256 | INFO     | test_jbb_embedding:begin_test:693 - Mary took the apple.<|eot_id|>
2025-01-22 19:41:54.256 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8121])
2025-01-22 19:41:56.474 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [116.54453125, 13.180179868291482, 105.69375, 12.810471105139609, 13.749117337740385], 'topk_indices': array([7974,   20, 8009, 8102, 8120, 8104, 8109,  899,    1,    9, 8115,
       8019, 7975,   24,   23,   14, 8117, 8119,    0, 8116]), 'topk_tokens': [' you', ' Jul', '.\n\n', '.\n\n', '\n\n', ':', ' before', ' apple', '<|start_header_id|>', ':', ':', ' location', ' context', '\n\n', '4', '\n', '<|start_header_id|>', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [300.125, 97.9140625, 61.38125, 47.2]}, 'weight': {'score': [22.28671875, 23.245534065731167, 24.103125, 23.246843726834694, 29.397235576923077], 'topk_indices': array([3259, 3286, 3173, 3125, 7352, 7390, 1414, 1476, 4284, 4268, 5182,
       5121, 7073, 7129, 3442, 3468, 4898, 4923, 4946, 4975]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.240234375, 24.891927083333332, 19.403125, 18.88125]}, 'saliency': {'score': [0.70941162109375, 0.07190189333398726, 0.63720703125, 0.06962820344834908, 0.09997015732985276], 'topk_indices': array([  22, 8105,  896,   16,    8, 7973, 8090, 8108,   19,   24, 8109,
       8111, 8103, 8114, 2970,   23,   20,  899, 8019, 7975]), 'topk_tokens': ['202', ' Where', ' Mary', ' Date', ' Date', ' provided', ' return', ' apple', '26', '\n\n', ' before', ' bedroom', 'Question', 'Answer', ' garden', '4', ' Jul', ' apple', ' location', ' context'], 'evidence_proportions': [2.02685546875, 0.5711263020833334, 0.29306640625, 0.237744140625]}}, 'pred_res': 'Mary took the apple.<|eot_id|>', 'score': 0}
2025-01-22 19:41:56.486 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 19:41:56.487 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-134_pid-3_1-3-6-7.pkl | len: 3 |  size: 2.01 KB
Processing depth (1, 3, 6, 7):   4%|â–         | 4/100 [01:38<42:37, 26.64s/it]is_0k: False
your chose emoji: ['ğŸŒŒ', 'ğŸ‘©ğŸ¾\u200dğŸ¦°', 'ğŸ’–', 'ğŸ§šğŸ½\u200dâ™‚ï¸', 'ğŸ§ğŸ»\u200dâ™€ï¸', 'ğŸ¥¬', 'ğŸ«‚', 'ğŸš´\u200dâ™€', 'ğŸ¡', '8âƒ£']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.45s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:10,  5.01s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.73s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.28s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.83s/it]
Processing depth (3, 5, 8, 9):   4%|â–         | 4/100 [01:55<42:37, 26.64s/it]2025-01-22 19:42:13.596 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary took the apple.
2025-01-22 19:42:13.613 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2932, 2936) -->  Mary took the apple
2025-01-22 19:42:13.613 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:42:13.637 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4144, 4150) --> . Mary journeyed to the
2025-01-22 19:42:13.638 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:42:13.673 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6517, 6522) --> . Mary went to the
2025-01-22 19:42:13.673 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John moved to the kitchen.
2025-01-22 19:42:13.710 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7213, 7218) --> . John moved to the
2025-01-22 19:42:13.710 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went to the office.
2025-01-22 19:42:13.716 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (911, 916) --> . John went to the
2025-01-22 19:42:13.716 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the garden.
2025-01-22 19:42:13.738 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4148, 4153) -->  to the garden. Sandra
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:42:14.530 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 19:42:14.531 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8157])
2025-01-22 19:42:16.760 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [119.65703125, 11.522572954963236, 134.865625, 11.104846056273063, 9.16552734375], 'topk_indices': array([8010, 8140, 8126, 8130, 8138,    4, 8150,    1, 8045, 8011, 4150,
       8156, 8151,   24,    9,   23,   14, 8155,    0, 8152]), 'topk_tokens': [' you', ':', ' return', '.', '.\n\n', '\n\n', 'Answer', '<|start_header_id|>', '.\n\n', ' context', ' garden', '\n\n', ':', '\n\n', ':', '4', '\n', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [180.84375, 187.85416666666666, 68.14375, 40.384375]}, 'weight': {'score': [20.834765625, 23.266046262254903, 19.99375, 23.276052237084873, 29.0109375], 'topk_indices': array([3297, 3270, 3142, 3190, 7398, 7436, 1501, 1439, 4310, 4294, 5216,
       5155, 7163, 7107, 3453, 3479, 4923, 4975, 4898, 4946]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.240234375, 20.052083333333332, 19.403125, 18.88125]}, 'saliency': {'score': [0.6780914306640625, 0.06224861519009459, 0.7626708984375, 0.059872098690469326, 0.06820111955915178], 'topk_indices': array([8009, 8149, 2935, 8129, 8045,   14,   19, 8154, 8139, 8055, 8156,
         24, 8126,    8, 8147,   20,   23, 8150, 8011, 4150]), 'topk_tokens': [' provided', ' \n', ' apple', ' directly', '.\n\n', '\n', '26', 'assistant', 'Question', ' location', '\n\n', '\n\n', ' return', ' Date', ' bedroom', ' Jul', '4', 'Answer', ' context', ' garden'], 'evidence_proportions': [1.2530517578125, 0.981201171875, 0.341015625, 0.19146728515625]}}, 'pred_res': 'The garden.<|eot_id|>', 'score': 100}
2025-01-22 19:42:16.766 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 19:42:16.766 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-134_pid-4_3-5-8-9.pkl | len: 3 |  size: 1.98 KB
Processing depth (3, 5, 8, 9):   5%|â–Œ         | 5/100 [01:58<38:32, 24.34s/it]Processing depth (3, 5, 8, 9):   5%|â–Œ         | 5/100 [01:58<37:37, 23.76s/it]
2025-01-22 19:42:16.854 | INFO     | __main__:<module>:82 - Selected idx: 136
2025-01-22 19:42:16.854 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the apple before the bedroom? 
2025-01-22 19:42:16.854 | INFO     | __main__:<module>:84 - Answer: garden
2025-01-22 19:42:16.854 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 19:42:16.854 | INFO     | __main__:<module>:86 - Needle: [' John moved to the kitchen.', ' Mary grabbed the apple.', ' Mary journeyed to the garden.', ' John went to the office.', ' Sandra moved to the garden.', ' Mary went to the bedroom.', ' John went to the office.']
2025-01-22 19:42:16.854 | INFO     | __main__:<module>:87 - Real Needle: [' Mary grabbed the apple.', ' Mary journeyed to the garden.', ' Mary went to the bedroom.', ' John went to the office.']
2025-01-22 19:42:16.854 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ§”ğŸ¿\u200dâ™‚', 'â€¼ï¸', 'ğŸ‘©ğŸ¿\u200dğŸ¦¼', 'ğŸª–', 'ğŸ‡°ğŸ‡¼', 'ğŸ§‘ğŸ¿\u200dğŸ¤\u200dğŸ§‘ğŸ»', 'ğŸª£', 'ğŸ“', 'ğŸ§™ğŸ¼\u200dâ™€', 'ğŸ§‘ğŸ»\u200dâœˆ']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.22s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.25s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.43s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.11s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.56s/it]
Processing depth (0, 2, 5, 7):   0%|          | 0/100 [00:15<?, ?it/s]2025-01-22 19:42:32.892 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the apple.
2025-01-22 19:42:32.936 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:42:32.946 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1866, 1872) --> . Mary journeyed to the
2025-01-22 19:42:32.946 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:42:32.968 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4196, 4201) -->  Mary went to the bedroom
2025-01-22 19:42:32.968 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:42:32.998 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5637, 5642) --> . John went to the
2025-01-22 19:42:32.998 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John moved to the kitchen.
2025-01-22 19:42:33.016 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3112, 3117) -->  ranks. John moved to
2025-01-22 19:42:33.016 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the garden.
2025-01-22 19:42:33.016 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (110, 115) --> . Sandra moved to the
2025-01-22 19:42:33.017 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 19:42:33.017 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 19:42:33.017 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 19:42:33.017 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ™ğŸ¿\u200dâ™€', 'ğŸ’†ğŸ»\u200dâ™‚', 'ğŸ‘¨ğŸ¼\u200dâ¤\u200dğŸ’‹\u200dğŸ‘¨ğŸ¼', 'âš—ï¸', 'ğŸ‘©\u200dğŸ‘¦\u200dğŸ‘¦', 'ğŸ§“', 'ğŸ§‘ğŸ½\u200dğŸ³', 'ğŸ¥Š', 'ğŸ¤½', 'ğŸ‘©ğŸ½\u200dâ¤ï¸\u200dğŸ‘©ğŸ¾']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:05<00:15,  5.23s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.88s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.62s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.17s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.78s/it]
Processing depth (1, 2, 5, 8):   0%|          | 0/100 [00:32<?, ?it/s]2025-01-22 19:42:49.956 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the apple.
2025-01-22 19:42:49.963 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (830, 834) -->  Mary grabbed the apple
2025-01-22 19:42:49.963 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:42:49.983 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1763, 1769) -->  Mary journeyed to the garden
2025-01-22 19:42:49.983 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:42:50.009 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4232, 4237) -->  Mary went to the bedroom
2025-01-22 19:42:50.009 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:42:50.045 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6649, 6654) --> . John went to the
2025-01-22 19:42:50.046 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John moved to the kitchen.
2025-01-22 19:42:50.061 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3099, 3104) --> . John moved to the
2025-01-22 19:42:50.062 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the garden.
2025-01-22 19:42:50.062 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (105, 110) --> . Sandra moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:42:50.864 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 19:42:50.864 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8209])
2025-01-22 19:42:53.092 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [97.719140625, 13.261042338955187, 182.3546875, 12.847928379369348, 11.843282063802084], 'topk_indices': array([8190, 8203, 8200,    4,  109, 8097, 8063, 8208,    9,    1, 8199,
       8197,   23,  110, 8205,   24,   14, 8207,    0, 8204]), 'topk_tokens': ['.\n\n', ':', '?', '\n\n', ' the', '.\n\n', ' context', '\n\n', ':', '<|start_header_id|>', ' bedroom', ' before', '4', ' garden', '<|start_header_id|>', '\n\n', '\n', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [123.765625, 90.0625, 172.2875, 11.5015625]}, 'weight': {'score': [23.612109375, 23.32177758158792, 19.9609375, 23.325175499572232, 29.801920572916668], 'topk_indices': array([3326, 3299, 3219, 3171, 7456, 7418, 1504, 1442, 4318, 4302, 5192,
       5131, 7099, 7155, 3508, 3482, 4956, 4985, 4890, 4915]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.005859375, 23.813802083333332, 24.8296875, 18.6375]}, 'saliency': {'score': [0.6385566711425781, 0.07279971977936252, 0.947412109375, 0.07034784213047218, 0.0904536247253418], 'topk_indices': array([8200,  107, 8097, 8208,   14, 8202, 8193, 4236, 8178,   20, 8107,
       8191,    8,   23,  106,   24, 8063, 8197,  110, 8199]), 'topk_tokens': ['?', ' moved', '.\n\n', '\n\n', '\n', 'Answer', ' Where', ' bedroom', ' return', ' Jul', ' location', 'Question', ' Date', '4', ' Sandra', '\n\n', ' context', ' before', ' garden', ' bedroom'], 'evidence_proportions': [0.88946533203125, 0.5714518229166666, 1.10458984375, 0.0523223876953125]}}, 'pred_res': 'The garden.<|eot_id|>', 'score': 100}
2025-01-22 19:42:53.110 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 19:42:53.110 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-136_pid-0_1-2-5-8.pkl | len: 3 |  size: 1.99 KB
Processing depth (1, 2, 5, 8):   1%|          | 1/100 [00:36<59:39, 36.16s/it]is_0k: False
your chose emoji: ['ğŸ§‘ğŸ½\u200dğŸ¼', 'ğŸ‘¨ğŸ¼\u200dğŸ¤\u200dğŸ‘¨ğŸ¾', 'ğŸ™…\u200dâ™‚ï¸', 'ğŸ§ğŸ½\u200dâ™€ï¸', 'ğŸ™†ğŸ¼\u200dâ™‚', 'ğŸ‘©ğŸ¿\u200dâ¤ï¸\u200dğŸ‘©ğŸ¼', 'ğŸ’†ğŸ»\u200dâ™‚', 'ğŸˆ²', 'ğŸ‘©ğŸ¿\u200dâœˆ', 'ğŸ‘ï¸\u200dğŸ—¨ï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.61s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.94s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.77s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.30s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.85s/it]
Processing depth (1, 5, 6, 7):   1%|          | 1/100 [00:53<59:39, 36.16s/it]2025-01-22 19:43:10.360 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the apple.
2025-01-22 19:43:10.365 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (820, 824) -->  Mary grabbed the apple
2025-01-22 19:43:10.366 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:43:10.390 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4176, 4182) --> . Mary journeyed to the
2025-01-22 19:43:10.390 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:43:10.414 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4787, 4792) -->  the senate. Mary went
2025-01-22 19:43:10.414 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:43:10.443 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5665, 5670) --> . John went to the
2025-01-22 19:43:10.443 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John moved to the kitchen.
2025-01-22 19:43:10.461 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3045, 3050) -->  tragedy. John moved to
2025-01-22 19:43:10.461 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the garden.
2025-01-22 19:43:10.462 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (105, 110) --> . Sandra moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:43:11.246 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 19:43:11.246 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8173])
2025-01-22 19:43:13.451 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [73.309375, 14.360898131727005, 197.95078125, 13.990793986312301, 12.414225260416666], 'topk_indices': array([8156, 8154,  109, 8061,    9, 8164, 8027, 8167, 8172,   23, 8163,
        110, 8161,    1,   24,   14, 8171, 8169,    0, 8168]), 'topk_tokens': [':', '.\n\n', ' the', '.\n\n', ':', '?', ' context', ':', '\n\n', '4', ' bedroom', ' garden', ' before', '<|start_header_id|>', '\n\n', '\n', '<|end_header_id|>', '<|start_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [139.734375, 72.8125, 69.303125, 24.771875]}, 'weight': {'score': [22.308984375, 23.292498624021526, 22.86484375, 23.295438328627547, 29.762820512820515], 'topk_indices': array([3328, 3355, 3200, 3248, 7406, 7444, 1414, 1476, 4336, 4320, 5149,
       5210, 7183, 7127, 3537, 3511, 4939, 4914, 4991, 4962]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.005859375, 20.052083333333332, 24.13125, 18.6375]}, 'saliency': {'score': [0.4462615966796875, 0.07782685640040209, 1.0487823486328125, 0.07573033666950228, 0.09341489351712741], 'topk_indices': array([ 555, 8061, 4794,    8, 8172, 8164,   20, 8071,  107,   23, 8142,
       8157,   24, 8166, 8155, 8027,  106, 8161,  110, 8163]), 'topk_tokens': [' instead', '.\n\n', ' bedroom', ' Date', '\n\n', '?', ' Jul', ' location', ' moved', '4', ' return', ' Where', '\n\n', 'Answer', 'Question', ' context', ' Sandra', ' before', ' garden', ' bedroom'], 'evidence_proportions': [1.0238037109375, 0.3699951171875, 0.40321044921875, 0.118798828125]}}, 'pred_res': 'The garden.<|eot_id|>', 'score': 100}
2025-01-22 19:43:13.457 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 19:43:13.458 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-136_pid-1_1-5-6-7.pkl | len: 3 |  size: 2.0 KB
Processing depth (1, 5, 6, 7):   2%|â–         | 2/100 [00:56<43:52, 26.86s/it]is_0k: False
your chose emoji: ['ğŸ‡¸ğŸ‡¸', 'ğŸ›', 'ğŸ‘©ğŸ½\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘¨ğŸ¿', 'ğŸ––ğŸ½', 'ğŸ“„', 'ğŸ‘±ğŸ¿\u200dâ™‚ï¸', 'ğŸ˜', 'ğŸ†', 'ğŸ§‘ğŸ¼\u200dâ¤ï¸\u200dğŸ§‘ğŸ»', 'ğŸ¤¾ğŸ¼\u200dâ™‚ï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.68s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.73s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.62s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.15s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.71s/it]
Processing depth (0, 1, 3, 8):   2%|â–         | 2/100 [01:13<43:52, 26.86s/it]2025-01-22 19:43:30.022 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the apple.
2025-01-22 19:43:30.063 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:43:30.068 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (826, 832) --> . Mary journeyed to the
2025-01-22 19:43:30.068 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:43:30.084 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2931, 2936) --> . Mary went to the
2025-01-22 19:43:30.084 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:43:30.115 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6613, 6618) --> . John went to the
2025-01-22 19:43:30.115 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John moved to the kitchen.
2025-01-22 19:43:30.130 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3095, 3100) --> . John moved to the
2025-01-22 19:43:30.130 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the garden.
2025-01-22 19:43:30.131 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (110, 115) --> . Sandra moved to the
2025-01-22 19:43:30.131 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 19:43:30.131 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 19:43:30.131 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 19:43:30.131 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ¤¦ğŸ»\u200dâ™€', '\U0001f6df', 'ğŸ§”\u200dâ™‚ï¸', 'ğŸ¥³', 'ğŸš¶ğŸ¿\u200dâ™‚', 'ğŸƒğŸ¼\u200dâ™€ï¸\u200dâ¡', 'ğŸ§˜ğŸ¿', 'ğŸ‘£', 'ğŸ„', 'ğŸ¤·ğŸ¿']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.73s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.89s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.95s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.36s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.92s/it]
Processing depth (3, 5, 6, 7):   2%|â–         | 2/100 [01:30<43:52, 26.86s/it]2025-01-22 19:43:47.671 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the apple.
2025-01-22 19:43:47.686 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2896, 2900) -->  Mary grabbed the apple
2025-01-22 19:43:47.686 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:43:47.713 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4217, 4223) -->  Mary journeyed to the garden
2025-01-22 19:43:47.713 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:43:47.738 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4861, 4866) --> . Mary went to the
2025-01-22 19:43:47.739 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:43:47.766 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5737, 5742) --> . John went to the
2025-01-22 19:43:47.766 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John moved to the kitchen.
2025-01-22 19:43:47.781 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3096, 3101) --> . John moved to the
2025-01-22 19:43:47.781 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the garden.
2025-01-22 19:43:47.782 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (105, 110) --> . Sandra moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:43:48.538 | INFO     | test_jbb_embedding:begin_test:693 - the garden<|eot_id|>
2025-01-22 19:43:48.538 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8187])
2025-01-22 19:43:50.782 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [114.15703125, 11.337904456654456, 124.546875, 10.947160309436274, 11.534616268382353], 'topk_indices': array([8085, 8180,    1,    3, 8168, 8075, 8041,    9,   23, 8170, 8175,
       8183,   24, 8181, 8186, 4222,   14, 8185,    0, 8182]), 'topk_tokens': [' location', 'Answer', '<|start_header_id|>', '<|end_header_id|>', '.\n\n', '.\n\n', ' context', ':', '4', ':', ' before', '<|start_header_id|>', '\n\n', ':', '\n\n', ' garden', '\n', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [177.5625, 175.77083333333334, 68.08125, 35.571875]}, 'weight': {'score': [22.25546875, 23.297867063492063, 19.9609375, 23.304511335784312, 29.48860294117647], 'topk_indices': array([3323, 3296, 3168, 3216, 7420, 7458, 1459, 1521, 4294, 4310, 5192,
       5131, 7175, 7119, 3505, 3479, 4913, 4985, 4888, 4956]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.005859375, 23.813802083333332, 19.403125, 18.6375]}, 'saliency': {'score': [0.7331344604492187, 0.06251834035647512, 0.6845703125, 0.06011235480215035, 0.08632785572725184], 'topk_indices': array([ 107,   23, 8179, 2897, 8184, 8156,   24, 2899, 8186, 8085,  555,
        106,  110, 8174, 8175, 8169, 8177, 8041, 8180, 4222]), 'topk_tokens': [' moved', '4', ' \n', ' grabbed', 'assistant', ' return', '\n\n', ' apple', '\n\n', ' location', ' instead', ' Sandra', ' garden', ' apple', ' before', 'Question', ' bedroom', ' context', 'Answer', ' garden'], 'evidence_proportions': [1.2713623046875, 1.1747233072916667, 0.3112060546875, 0.194573974609375]}}, 'pred_res': 'the garden<|eot_id|>', 'score': 100}
2025-01-22 19:43:50.790 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 19:43:50.791 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-136_pid-2_3-5-6-7.pkl | len: 3 |  size: 2.03 KB
Processing depth (3, 5, 6, 7):   3%|â–         | 3/100 [01:33<51:09, 31.64s/it]is_0k: False
your chose emoji: ['ğŸ§‘ğŸ½\u200dâš•', 'ğŸš¶ğŸ½\u200dâ™€ï¸\u200dâ¡', 'ğŸ‡¬ğŸ‡«', 'âœ', 'ğŸšµğŸ¼\u200dâ™‚ï¸', 'ğŸ™ğŸ¼\u200dâ™‚', 'ğŸ‘©ğŸ¾\u200dâ¤ï¸\u200dğŸ‘¨ğŸ¼', 'ğŸ‘¨\u200dğŸ‘§\u200dğŸ‘§', 'ğŸ¦¸\u200dâ™‚', 'ğŸ’']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.50s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.49s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.68s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.31s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.78s/it]
Processing depth (0, 4, 6, 7):   3%|â–         | 3/100 [01:50<51:09, 31.64s/it]2025-01-22 19:44:07.704 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the apple.
2025-01-22 19:44:07.746 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:44:07.766 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3588, 3594) --> . Mary journeyed to the
2025-01-22 19:44:07.767 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:44:07.792 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4743, 4748) -->  the senate. Mary went
2025-01-22 19:44:07.792 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:44:07.824 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5619, 5624) --> . John went to the
2025-01-22 19:44:07.824 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John moved to the kitchen.
2025-01-22 19:44:07.838 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2989, 2994) -->  tragedy. John moved to
2025-01-22 19:44:07.838 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the garden.
2025-01-22 19:44:07.839 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (110, 115) --> . Sandra moved to the
2025-01-22 19:44:07.839 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 19:44:07.839 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 19:44:07.839 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 19:44:07.839 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ¥“', 'ğŸšª', 'ğŸ’‚ğŸ¿', 'ğŸ§œğŸ»', '\U0001faf7ğŸ¿', 'ğŸ›‚', 'ğŸ§œğŸ»\u200dâ™€ï¸', 'ğŸ”¼', 'ğŸ¤·', 'ğŸ‘«ğŸ½']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:05<00:15,  5.21s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.76s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.50s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.08s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.69s/it]
Processing depth (2, 4, 5, 7):   3%|â–         | 3/100 [02:07<51:09, 31.64s/it]2025-01-22 19:44:24.425 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the apple.
2025-01-22 19:44:24.436 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1860, 1864) -->  Mary grabbed the apple
2025-01-22 19:44:24.436 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:44:24.458 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3632, 3638) --> . Mary journeyed to the
2025-01-22 19:44:24.459 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:44:24.483 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4204, 4209) -->  Mary went to the bedroom
2025-01-22 19:44:24.484 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:44:24.517 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5647, 5652) --> . John went to the
2025-01-22 19:44:24.517 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John moved to the kitchen.
2025-01-22 19:44:24.535 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3107, 3112) -->  ranks. John moved to
2025-01-22 19:44:24.536 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the garden.
2025-01-22 19:44:24.536 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (105, 110) --> . Sandra moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:44:25.346 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 19:44:25.346 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8165])
2025-01-22 19:44:27.558 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [136.471875, 43.226811183888344, 247.671875, 42.746428790857706, 12.07252956081081], 'topk_indices': array([7520, 7475, 7330, 7472, 7516, 7282, 7521, 7480, 7476, 7410, 7512,
       7495, 7331, 7522, 7477,    0, 7478, 7523, 7524, 7479]), 'topk_tokens': [' joke', ' joke', ' Min', 'rate', ' perpet', 'nes', ' on', 'ot', ' on', 'nes', '\n', '.\n', 'nes', ' the', ' the', '<|begin_of_text|>', ' Min', ' Min', 'nes', 'nes'], 'evidence_proportions': [293.9375, 91.078125, 171.225, 30.21875]}, 'weight': {'score': [22.48359375, 23.291641160626835, 22.36796875, 23.294762034590807, 30.06524493243243], 'topk_indices': array([3270, 3297, 3142, 3190, 7416, 7378, 1467, 1405, 4296, 4280, 5131,
       5192, 7083, 7139, 3453, 3479, 4985, 4913, 4888, 4956]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.005859375, 20.052083333333332, 24.8296875, 18.6375]}, 'saliency': {'score': [0.8935089111328125, 0.24761003425142325, 1.4108642578125, 0.24459325865874218, 0.09313531824060388], 'topk_indices': array([7513, 7521, 7477, 4143, 7495, 7476, 7472, 7330, 7471, 7520, 7480,
       7475, 7282, 7516, 7410, 7331, 7478, 7524, 7523, 7479]), 'topk_tokens': ['made', ' on', ' the', ' column', '.\n', ' on', 'rate', ' Min', ' perpet', ' joke', 'ot', ' joke', 'nes', ' perpet', 'nes', 'nes', ' Min', 'nes', ' Min', 'nes'], 'evidence_proportions': [2.1143798828125, 0.4850260416666667, 1.15615234375, 0.14434814453125]}}, 'pred_res': 'The garden.<|eot_id|>', 'score': 100}
2025-01-22 19:44:27.566 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 19:44:27.567 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-136_pid-3_2-4-5-7.pkl | len: 3 |  size: 1.93 KB
Processing depth (2, 4, 5, 7):   4%|â–         | 4/100 [02:10<53:52, 33.67s/it]is_0k: False
your chose emoji: ['ğŸ¤¹ğŸ¼\u200dâ™€ï¸', 'ğŸ“µ', 'ğŸ„ğŸ¾\u200dâ™€', 'ğŸš´\u200dâ™‚', 'ğŸ‘·ğŸ»\u200dâ™‚ï¸', 'ğŸ‘®ğŸ»', 'ğŸ§˜\u200dâ™€', 'ğŸ¤¸ğŸ¾\u200dâ™‚ï¸', 'ğŸ§ğŸ½\u200dâ™‚\u200dâ¡ï¸', 'ğŸ”ï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.82s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:11<00:11,  5.85s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:16<00:05,  5.41s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:17<00:00,  3.66s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:17<00:00,  4.32s/it]
Processing depth (1, 5, 6, 9):   4%|â–         | 4/100 [02:29<53:52, 33.67s/it]2025-01-22 19:44:46.703 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the apple.
2025-01-22 19:44:46.707 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (807, 811) -->  grabbed the apple.
2025-01-22 19:44:46.708 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 19:44:46.728 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4170, 4176) --> . Mary journeyed to the
2025-01-22 19:44:46.728 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:44:46.752 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4739, 4744) --> . Mary went to the
2025-01-22 19:44:46.752 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 19:44:46.787 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7124, 7129) -->  John went to the office
2025-01-22 19:44:46.787 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John moved to the kitchen.
2025-01-22 19:44:46.802 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3110, 3115) --> . John moved to the
2025-01-22 19:44:46.802 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the garden.
2025-01-22 19:44:46.803 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (105, 110) --> . Sandra moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:44:47.608 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 19:44:47.608 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8161])
2025-01-22 19:44:49.809 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [83.563671875, 11.678215718397844, 154.9921875, 11.325271430108188, 14.046495225694445], 'topk_indices': array([8145, 8010, 8142, 8049, 8155,    9,   23,  110, 8152, 8160, 8015,
          1, 8151,   24, 8149,   14, 8159,    0, 8157, 8156]), 'topk_tokens': [' Where', '\n', '.\n\n', '.\n\n', ':', ':', '4', ' garden', '?', '\n\n', ' context', '<|start_header_id|>', ' bedroom', '\n\n', ' before', '\n', '<|end_header_id|>', '<|begin_of_text|>', '<|start_header_id|>', '<|eot_id|>'], 'evidence_proportions': [160.78125, 59.385416666666664, 123.475, 10.8921875]}, 'weight': {'score': [20.973828125, 23.280871049730525, 19.9609375, 23.29062519209491, 29.64279513888889], 'topk_indices': array([3310, 3337, 3182, 3230, 7452, 7414, 1520, 1458, 4342, 4326, 5204,
       5143, 7135, 7191, 3519, 3493, 4920, 4945, 4968, 4997]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.22265625, 20.052083333333332, 19.403125, 22.6515625]}, 'saliency': {'score': [0.4117393493652344, 0.06354147776968627, 0.815240478515625, 0.06176117933848756, 0.10409280988905165], 'topk_indices': array([ 107,   20, 4744, 8049, 8160,    8, 8148, 8059,   23, 8130,   24,
       8152, 8154, 8145,  106, 8143, 8015,  110, 8149, 8151]), 'topk_tokens': [' moved', ' Jul', ' bedroom', '.\n\n', '\n\n', ' Date', ' apple', ' location', '4', ' return', '\n\n', '?', 'Answer', ' Where', ' Sandra', 'Question', ' context', ' garden', ' before', ' bedroom'], 'evidence_proportions': [0.86370849609375, 0.3010660807291667, 0.5330322265625, 0.0616790771484375]}}, 'pred_res': 'The garden.<|eot_id|>', 'score': 100}
2025-01-22 19:44:49.817 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 19:44:49.817 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-136_pid-4_1-5-6-9.pkl | len: 3 |  size: 2.0 KB
Processing depth (1, 5, 6, 9):   5%|â–Œ         | 5/100 [02:32<46:47, 29.55s/it]Processing depth (1, 5, 6, 9):   5%|â–Œ         | 5/100 [02:32<48:25, 30.59s/it]
2025-01-22 19:44:49.888 | INFO     | __main__:<module>:82 - Selected idx: 138
2025-01-22 19:44:49.888 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the football before the kitchen? 
2025-01-22 19:44:49.888 | INFO     | __main__:<module>:84 - Answer: bathroom
2025-01-22 19:44:49.888 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 19:44:49.888 | INFO     | __main__:<module>:86 - Needle: [' Mary journeyed to the garden.', ' Sandra moved to the garden.', ' John got the football.', ' Mary went to the bedroom.', ' John travelled to the bathroom.', ' Mary picked up the apple.', ' John travelled to the kitchen.', ' Mary dropped the apple.']
2025-01-22 19:44:49.888 | INFO     | __main__:<module>:87 - Real Needle: [' John got the football.', ' John travelled to the bathroom.', ' John travelled to the kitchen.', ' Mary dropped the apple.']
2025-01-22 19:44:49.888 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ¤¾ğŸ¼\u200dâ™€ï¸', 'ğŸ‘¨ğŸ»\u200dğŸ¦°', 'ğŸ¥', 'ğŸ™ğŸ»', 'ğŸ”‹', 'ğŸ‘·ğŸ½', 'ğŸ’†ğŸ¾\u200dâ™€ï¸', 'ğŸ‘¨ğŸ¼\u200dâ¤\u200dğŸ‘¨ğŸ»', 'ğŸšµğŸ»\u200dâ™€ï¸', 'ğŸŒ¿']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  3.96s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.45s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.70s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.28s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.72s/it]
Processing depth (1, 5, 6, 8):   0%|          | 0/100 [00:16<?, ?it/s]2025-01-22 19:45:06.743 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John got the football.
2025-01-22 19:45:06.747 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (782, 786) -->  John got the football
2025-01-22 19:45:06.747 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the bathroom.
2025-01-22 19:45:06.769 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4124, 4129) -->  John travelled to the bathroom
2025-01-22 19:45:06.770 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the kitchen.
2025-01-22 19:45:06.791 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4125, 4130) -->  travelled to the bathroom.
2025-01-22 19:45:06.792 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary dropped the apple.
2025-01-22 19:45:06.824 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6492, 6496) -->  Mary dropped the apple
2025-01-22 19:45:06.824 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the garden.
2025-01-22 19:45:06.838 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2858, 2864) --> . Mary journeyed to the
2025-01-22 19:45:06.838 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the garden.
2025-01-22 19:45:06.851 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2560, 2565) --> . Sandra moved to the
2025-01-22 19:45:06.851 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:45:06.879 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5855, 5860) --> . Mary went to the
2025-01-22 19:45:06.880 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary picked up the apple.
2025-01-22 19:45:06.895 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3257, 3262) --> . Mary picked up the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:45:07.765 | INFO     | test_jbb_embedding:begin_test:693 - John got the football.<|eot_id|>
2025-01-22 19:45:07.765 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8156])
2025-01-22 19:45:09.984 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [281.5859375, 21.29315786248315, 76.45014880952381, 20.573506773399014, 21.43280029296875], 'topk_indices': array([8155, 8137,  784, 8146, 7548, 8152,  781, 7504, 7549, 8143, 8144,
         24,   14, 8054,    1,  786,  785, 8154,    0, 8151]), 'topk_tokens': ['\n\n', '.\n\n', ' the', ' kitchen', ' Min', '<|start_header_id|>', '.', 'nes', 'nes', ' football', ' before', '\n\n', '\n', ' location', '<|start_header_id|>', '.', ' football', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [655.3125, 235.55, 230.025, 29.85546875]}, 'weight': {'score': [24.840711805555557, 23.26864888466724, 20.620535714285715, 23.272012584667486, 29.537109375], 'topk_indices': array([3374, 3347, 3189, 3237, 7403, 7441, 1516, 1454, 4340, 4356, 5163,
       5224, 7124, 7180, 3530, 3556, 5017, 4940, 4965, 4988]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [25.654296875, 25.6796875, 21.81875, 26.755859375]}, 'saliency': {'score': [1.9448445638020833, 0.11837241538293602, 0.4230157761346726, 0.11353571473671298, 0.160783052444458], 'topk_indices': array([8147, 8138, 8153, 8050, 8053,  782,   24, 8125,  783, 4658,  269,
       4128, 7548, 8146, 7504, 8144, 7549, 8054, 8143,  785]), 'topk_tokens': ['?', 'Question', 'assistant', ' item', ' first', ' John', '\n\n', ' return', ' got', ' kitchen', 'hue', ' bathroom', ' Min', ' kitchen', 'nes', ' before', 'nes', ' location', ' football', ' football'], 'evidence_proportions': [4.3837890625, 1.751123046875, 1.57783203125, 0.206817626953125]}}, 'pred_res': 'John got the football.<|eot_id|>', 'score': 0}
2025-01-22 19:45:09.996 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 19:45:09.997 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-138_pid-0_1-5-6-8.pkl | len: 3 |  size: 2.04 KB
Processing depth (1, 5, 6, 8):   1%|          | 1/100 [00:19<32:58, 19.98s/it]is_0k: False
your chose emoji: ['ğŸƒğŸ¼\u200dâ™‚\u200dâ¡', '\U0001faf1ğŸ¿', '\U0001fac5ğŸ¾', 'ğŸŒ”', 'ğŸ‘©ğŸ¿\u200dğŸ«', 'ğŸŒ¶ï¸', 'ğŸ’Š', 'ğŸ™ğŸ¿', 'ğŸ™‡ğŸ¼\u200dâ™€ï¸', 'ğŸ™‡ğŸ¼']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  3.95s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:09,  4.54s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.47s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.14s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.59s/it]
Processing depth (2, 5, 6, 7):   1%|          | 1/100 [00:36<32:58, 19.98s/it]2025-01-22 19:45:26.856 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John got the football.
2025-01-22 19:45:26.865 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1756, 1760) -->  John got the football
2025-01-22 19:45:26.865 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the bathroom.
2025-01-22 19:45:26.888 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4153, 4158) --> . John travelled to the
2025-01-22 19:45:26.888 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the kitchen.
2025-01-22 19:45:26.909 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4153, 4158) --> . John travelled to the
2025-01-22 19:45:26.909 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary dropped the apple.
2025-01-22 19:45:26.936 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5658, 5662) -->  Mary dropped the apple
2025-01-22 19:45:26.937 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the garden.
2025-01-22 19:45:26.955 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2912, 2918) --> . Mary journeyed to the
2025-01-22 19:45:26.955 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the garden.
2025-01-22 19:45:26.968 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2580, 2585) --> . Sandra moved to the
2025-01-22 19:45:26.968 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:45:26.999 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6232, 6237) --> . Mary went to the
2025-01-22 19:45:26.999 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary picked up the apple.
2025-01-22 19:45:27.016 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3299, 3304) --> . Mary picked up the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:45:27.905 | INFO     | test_jbb_embedding:begin_test:693 - John got the football.<|eot_id|>
2025-01-22 19:45:27.905 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8192])
2025-01-22 19:45:30.144 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [272.4201388888889, 22.358332062233067, 103.58482142857143, 21.597313327611573, 27.6108993902439], 'topk_indices': array([8186, 1756, 8089, 8046,    3, 1760, 8179, 8180, 1584,    1, 8080,
       4158,   14, 8090,   24, 1759, 8187, 8190, 8188,    0]), 'topk_tokens': [':', ' John', ' first', ' context', '<|end_header_id|>', '.', ' football', ' before', 'ï¿½', '<|start_header_id|>', '.\n\n', ' bathroom', '\n', ' location', '\n\n', ' football', '<|eot_id|>', '<|end_header_id|>', '<|start_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [537.125, 251.7, 251.7, 59.515625]}, 'weight': {'score': [22.752604166666668, 23.291069249542403, 20.620535714285715, 23.29913368992153, 29.281440548780488], 'topk_indices': array([3342, 3315, 3229, 3181, 7439, 7477, 1437, 1499, 4324, 4340, 5202,
       5141, 7216, 7160, 3524, 3498, 4995, 4918, 4966, 4943]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [25.654296875, 19.990625, 19.990625, 26.755859375]}, 'saliency': {'score': [1.6500583224826388, 0.12493432483126143, 0.5672316778273809, 0.12042960727723455, 0.1970994530654535], 'topk_indices': array([8189, 1757,    0, 8086, 8185, 8161, 8080, 8174, 4155, 8089, 8182,
         24, 1756, 1584, 8180, 8046, 8179, 8090, 4158, 1759]), 'topk_tokens': ['assistant', ' got', '<|begin_of_text|>', ' item', 'Answer', ' return', '.\n\n', 'Question', ' travelled', ' first', ' kitchen', '\n\n', ' John', 'ï¿½', ' before', ' context', ' football', ' location', ' bathroom', ' football'], 'evidence_proportions': [3.659423828125, 1.34365234375, 1.34365234375, 0.406707763671875]}}, 'pred_res': 'John got the football.<|eot_id|>', 'score': 0}
2025-01-22 19:45:30.151 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 19:45:30.151 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-138_pid-1_2-5-6-7.pkl | len: 3 |  size: 2.09 KB
Processing depth (2, 5, 6, 7):   2%|â–         | 2/100 [00:40<32:48, 20.08s/it]is_0k: False
your chose emoji: ['ğŸ‡ªğŸ‡¦', 'ğŸ¤¹ğŸ¼\u200dâ™€', 'ğŸ§šğŸ¼\u200dâ™‚', 'ğŸ‘©ğŸ¼\u200dâ¤ï¸\u200dğŸ‘¨ğŸ¾', 'ğŸ¦Ÿ', 'ğŸ‘¨ğŸ¼\u200dğŸ’¼', 'ğŸ‘±\u200dâ™‚', 'ğŸ‘©ğŸ¿\u200dğŸ¦°', 'ğŸ§šğŸ½\u200dâ™€ï¸', 'ğŸ™ğŸ¾']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.07s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:09,  4.54s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.45s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.09s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.57s/it]
Processing depth (1, 4, 8, 9):   2%|â–         | 2/100 [00:56<32:48, 20.08s/it]2025-01-22 19:45:46.485 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John got the football.
2025-01-22 19:45:46.489 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (836, 840) -->  John got the football
2025-01-22 19:45:46.489 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the bathroom.
2025-01-22 19:45:46.506 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3599, 3604) --> . John travelled to the
2025-01-22 19:45:46.507 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the kitchen.
2025-01-22 19:45:46.524 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3599, 3604) --> . John travelled to the
2025-01-22 19:45:46.524 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary dropped the apple.
2025-01-22 19:45:46.558 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7276, 7280) -->  Mary dropped the apple
2025-01-22 19:45:46.558 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the garden.
2025-01-22 19:45:46.573 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2926, 2932) --> . Mary journeyed to the
2025-01-22 19:45:46.573 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the garden.
2025-01-22 19:45:46.587 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2738, 2743) --> . Sandra moved to the
2025-01-22 19:45:46.587 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:45:46.619 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6229, 6234) --> . Mary went to the
2025-01-22 19:45:46.619 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary picked up the apple.
2025-01-22 19:45:46.636 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3313, 3318) --> . Mary picked up the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:45:47.504 | INFO     | test_jbb_embedding:begin_test:693 - John got the football.<|eot_id|>
2025-01-22 19:45:47.504 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8206])
2025-01-22 19:45:49.926 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [228.94097222222223, 19.40722644353758, 69.63764880952381, 18.816474143206854, 11.65697419241573], 'topk_indices': array([   3,  835, 8194,  849, 8094,    9, 7683,  837, 8104, 8193,    1,
        838,   14, 8202,   24,  840, 8204, 8201,  839,    0]), 'topk_tokens': ['<|end_header_id|>', '.', ' before', 'g', '.\n\n', ':', 'nes', ' got', ' location', ' football', '<|start_header_id|>', ' the', '\n', '<|start_header_id|>', '\n\n', '.', '<|end_header_id|>', '<|eot_id|>', ' football', '<|begin_of_text|>'], 'evidence_proportions': [719.375, 109.9, 109.9, 36.109375]}, 'weight': {'score': [22.752604166666668, 23.312690339870873, 20.620535714285715, 23.320844170746636, 29.807408707865168], 'topk_indices': array([3329, 3356, 3243, 3195, 7485, 7447, 1430, 1492, 4320, 4336, 5204,
       5143, 7111, 7167, 3544, 3518, 4968, 4997, 4945, 4920]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [25.654296875, 19.990625, 19.990625, 26.755859375]}, 'saliency': {'score': [1.4808349609375, 0.109172801062953, 0.38032459077380953, 0.10545381618392366, 0.08838379249144136], 'topk_indices': array([8177, 8103,  849, 8188,  836, 8060,    0, 8203,  915, 8196, 8175,
       8194,  837,   24,  283, 7683,  873, 8104, 8193,  839]), 'topk_tokens': [' location', ' first', 'g', 'Question', ' John', ' context', '<|begin_of_text|>', 'assistant', ' com', ' kitchen', ' return', ' before', ' got', '\n\n', 'hue', 'nes', 'posit', ' location', ' football', ' football'], 'evidence_proportions': [4.907470703125, 0.603271484375, 0.603271484375, 0.24810791015625]}}, 'pred_res': 'John got the football.<|eot_id|>', 'score': 0}
2025-01-22 19:45:49.933 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 19:45:49.934 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-138_pid-2_1-4-8-9.pkl | len: 3 |  size: 2.06 KB
Processing depth (1, 4, 8, 9):   3%|â–         | 3/100 [00:59<32:14, 19.95s/it]is_0k: False
your chose emoji: ['ğŸ§‘ğŸ¾\u200dâ¤\u200dğŸ§‘ğŸ¿', 'ğŸš£\u200dâ™€', 'ğŸ‹ğŸ»\u200dâ™‚', 'ğŸš¶ğŸ¼\u200dâ™€ï¸\u200dâ¡ï¸', 'ğŸ‘¨ğŸ¼\u200dâ¤\u200dğŸ’‹\u200dğŸ‘¨ğŸ¿', 'ğŸ‘ƒğŸ¼', 'ğŸ™‹ğŸ¿\u200dâ™€', 'ğŸšº', 'ğŸ•œ', 'ğŸ¤¸ğŸ¿\u200dâ™€ï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  3.85s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.43s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.14s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:12<00:00,  2.67s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:12<00:00,  3.23s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (2, 4, 5, 6):   3%|â–         | 3/100 [01:14<32:14, 19.95s/it]2025-01-22 19:46:04.880 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John got the football.
2025-01-22 19:46:04.890 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1795, 1799) -->  got the football.
2025-01-22 19:46:04.890 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the bathroom.
2025-01-22 19:46:04.908 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3622, 3627) -->  Hon. John travelled to
2025-01-22 19:46:04.908 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the kitchen.
2025-01-22 19:46:04.928 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3622, 3627) -->  Hon. John travelled to
2025-01-22 19:46:04.928 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary dropped the apple.
2025-01-22 19:46:04.952 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4773, 4777) -->  Mary dropped the apple
2025-01-22 19:46:04.953 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the garden.
2025-01-22 19:46:04.969 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2938, 2944) --> . Mary journeyed to the
2025-01-22 19:46:04.969 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the garden.
2025-01-22 19:46:04.985 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2700, 2705) --> . Sandra moved to the
2025-01-22 19:46:04.985 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:46:05.017 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6273, 6278) --> . Mary went to the
2025-01-22 19:46:05.017 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary picked up the apple.
2025-01-22 19:46:05.033 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3323, 3328) --> . Mary picked up the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:46:09.293 | INFO     | test_jbb_embedding:begin_test:693 - the capitol<|eot_id|>
2025-01-22 19:46:09.293 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8181])
2025-01-22 19:46:12.517 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [378.5130208333333, 25.84839320625611, 126.27827380952381, 24.810088627992634, 52.19231939935065], 'topk_indices': array([3625, 8175, 1778, 8169,    1, 1794, 8168, 1796, 1776,   14, 3628,
       1795,   24, 1798, 8079, 8177, 8179, 1797, 8176,    0]), 'topk_tokens': [' travelled', ':', 'ï¿½', ' before', '<|start_header_id|>', ' John', ' football', ' the', 'ï¿½', '\n', ' bathroom', ' got', '\n\n', '.', ' location', '<|start_header_id|>', '<|end_header_id|>', ' football', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [830.625, 330.475, 330.475, 46.49609375]}, 'weight': {'score': [24.35112847222222, 23.292506720430108, 20.620535714285715, 23.297056284530388, 28.586444805194805], 'topk_indices': array([3306, 3279, 3199, 3151, 7470, 7432, 1473, 1411, 4319, 4303, 5119,
       5180, 7153, 7209, 3468, 3494, 4944, 4896, 4973, 4921]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.828125, 24.7984375, 24.7984375, 26.755859375]}, 'saliency': {'score': [2.2569986979166665, 0.14549443309258156, 0.7008899507068452, 0.13939616634774019, 0.3614824963854505], 'topk_indices': array([1778,  810,    0, 8163,   24, 8035, 8150, 8078, 8171, 8169, 7930,
       8174, 1794, 3625, 1795, 8168, 1776, 8079, 3628, 1797]), 'topk_tokens': ['ï¿½', 'ï¿½', '<|begin_of_text|>', 'Question', '\n\n', ' context', ' return', ' first', ' kitchen', ' before', ' Square', 'Answer', ' John', ' travelled', ' got', ' football', 'ï¿½', ' location', ' bathroom', ' football'], 'evidence_proportions': [4.72021484375, 2.04794921875, 2.04794921875, 0.31640625]}}, 'pred_res': 'the capitol<|eot_id|>', 'score': 0}
2025-01-22 19:46:12.539 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 19:46:12.540 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-138_pid-3_2-4-5-6.pkl | len: 3 |  size: 2.06 KB
Processing depth (2, 4, 5, 6):   4%|â–         | 4/100 [01:22<33:35, 21.00s/it]is_0k: False
your chose emoji: ['ğŸ‘©ğŸ»\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘¨ğŸ¼', 'ğŸ†‘', 'ğŸˆ¸', '#âƒ£', 'ğŸ¤°ğŸ»', 'ğŸ‘©ğŸ¼\u200dâ¤ï¸\u200dğŸ‘©ğŸ¼', 'ğŸ‘¨ğŸ½\u200dğŸ’¼', 'ğŸƒ', 'ğŸ§—ğŸ¾\u200dâ™‚ï¸', 'ğŸŒ¦ï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.13s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.16s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.09s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.91s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.36s/it]
Processing depth (1, 2, 3, 9):   4%|â–         | 4/100 [01:37<33:35, 21.00s/it]2025-01-22 19:46:27.834 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John got the football.
2025-01-22 19:46:27.838 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (836, 840) -->  John got the football
2025-01-22 19:46:27.838 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the bathroom.
2025-01-22 19:46:27.848 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1800, 1805) --> . John travelled to the
2025-01-22 19:46:27.849 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the kitchen.
2025-01-22 19:46:27.858 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1800, 1805) --> . John travelled to the
2025-01-22 19:46:27.858 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary dropped the apple.
2025-01-22 19:46:27.903 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7103, 7107) -->  dropped the apple.
2025-01-22 19:46:27.903 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the garden.
2025-01-22 19:46:27.918 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2952, 2958) --> . Mary journeyed to the
2025-01-22 19:46:27.918 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the garden.
2025-01-22 19:46:27.931 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2708, 2713) --> . Sandra moved to the
2025-01-22 19:46:27.931 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bedroom.
2025-01-22 19:46:27.962 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6179, 6184) --> . Mary went to the
2025-01-22 19:46:27.962 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary picked up the apple.
2025-01-22 19:46:27.980 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3301, 3306) --> . Mary picked up the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:46:28.837 | INFO     | test_jbb_embedding:begin_test:693 - John got the football.<|eot_id|>
2025-01-22 19:46:28.837 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8144])
2025-01-22 19:46:31.051 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [232.54079861111111, 16.966064962562907, 40.06845238095238, 16.42764669153922, 13.40508822737069], 'topk_indices': array([ 835, 8032,   23,  849,    9, 7998,  837, 8131, 8042,    3,  838,
          1,   14,   24,  840, 8139, 8140, 8142,    0,  839]), 'topk_tokens': ['.', '.\n\n', '4', 'g', ':', ' context', ' got', ' football', ' location', '<|end_header_id|>', ' the', '<|start_header_id|>', '\n', '\n\n', '.', '<|eot_id|>', '<|start_header_id|>', '<|end_header_id|>', '<|begin_of_text|>', ' football'], 'evidence_proportions': [715.4375, 119.9, 119.9, 31.24609375]}, 'weight': {'score': [21.467447916666668, 23.261791150116608, 20.620535714285715, 23.272615587999507, 29.70393318965517], 'topk_indices': array([3344, 3317, 3183, 3231, 7429, 7391, 1436, 1498, 4314, 4330, 5186,
       5125, 7112, 7168, 3532, 3506, 4979, 4950, 4902, 4927]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [25.654296875, 19.990625, 19.990625, 20.97265625]}, 'saliency': {'score': [1.5006103515625, 0.09419996103099684, 0.21443248930431547, 0.09076628193340104, 0.09919541457603717], 'topk_indices': array([ 841, 8041,  849,   16, 8141, 8132, 8126,  836, 7889, 1805, 8113,
        915,  283,   24,  873,  837, 7998, 8042, 8131,  839]), 'topk_tokens': [' Paul', ' first', 'g', ' Date', 'assistant', ' before', 'Question', ' John', ' Square', ' bathroom', ' return', ' com', 'hue', '\n\n', 'posit', ' got', ' context', ' location', ' football', ' football'], 'evidence_proportions': [4.91259765625, 0.66806640625, 0.66806640625, 0.16998291015625]}}, 'pred_res': 'John got the football.<|eot_id|>', 'score': 0}
2025-01-22 19:46:31.058 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 19:46:31.058 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-138_pid-4_1-2-3-9.pkl | len: 3 |  size: 2.04 KB
Processing depth (1, 2, 3, 9):   5%|â–Œ         | 5/100 [01:41<31:49, 20.10s/it]Processing depth (1, 2, 3, 9):   5%|â–Œ         | 5/100 [01:41<32:01, 20.22s/it]
2025-01-22 19:46:31.130 | INFO     | __main__:<module>:82 - Selected idx: 140
2025-01-22 19:46:31.130 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the apple before the garden? 
2025-01-22 19:46:31.130 | INFO     | __main__:<module>:84 - Answer: office
2025-01-22 19:46:31.130 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 19:46:31.130 | INFO     | __main__:<module>:86 - Needle: [' Daniel went back to the hallway.', ' Sandra picked up the apple.', ' Mary moved to the garden.', ' Sandra went to the office.', ' John moved to the hallway.', ' Sandra went to the garden.', ' Mary moved to the office.']
2025-01-22 19:46:31.131 | INFO     | __main__:<module>:87 - Real Needle: [' Sandra picked up the apple.', ' Sandra went to the office.', ' Sandra went to the garden.', ' Mary moved to the office.']
2025-01-22 19:46:31.131 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸš¥', 'ğŸ‘¨ğŸ¾\u200dğŸ¼', 'ğŸŒ’', 'ğŸ¥”', 'ğŸ”©', 'ğŸƒğŸ»\u200dâ™‚\u200dâ¡ï¸', 'ğŸ¥£', 'ğŸ¤£', 'ğŸ§ğŸ»\u200dâ™‚ï¸\u200dâ¡', 'ğŸ‘¶ğŸ»']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.72s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.45s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.17s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.90s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.44s/it]
Processing depth (4, 6, 8, 9):   0%|          | 0/100 [00:15<?, ?it/s]2025-01-22 19:46:46.618 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra picked up the apple.
2025-01-22 19:46:46.640 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3529, 3534) --> . Sandra picked up the
2025-01-22 19:46:46.640 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went to the office.
2025-01-22 19:46:46.674 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4715, 4720) --> . Sandra went to the
2025-01-22 19:46:46.675 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went to the garden.
2025-01-22 19:46:46.706 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4715, 4720) --> . Sandra went to the
2025-01-22 19:46:46.706 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the office.
2025-01-22 19:46:46.728 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3679, 3684) --> . Mary moved to the
2025-01-22 19:46:46.728 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went back to the hallway.
2025-01-22 19:46:46.759 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5818, 5824) -->  Daniel went back to the hallway
2025-01-22 19:46:46.759 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary moved to the garden.
2025-01-22 19:46:46.777 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3679, 3684) --> . Mary moved to the
2025-01-22 19:46:46.777 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the hallway.
2025-01-22 19:46:46.789 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2481, 2486) --> . John moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:46:47.660 | INFO     | test_jbb_embedding:begin_test:693 - Sandra's office.<|eot_id|>
2025-01-22 19:46:47.661 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8152])
2025-01-22 19:46:49.877 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [238.090625, 21.70708394652931, 127.21484375, 20.96603997289973, 50.928466796875], 'topk_indices': array([8121, 8040, 8143, 2529, 8137, 2535, 8135, 8146, 3535,   23,    1,
       8139, 8006,   24,   14, 8140,    0, 8150, 8147, 8148]), 'topk_tokens': [' return', '.\n\n', '?', 'ï¿½', ' was', 'ï¿½', ':', ':', '.', '4', '<|start_header_id|>', ' apple', ' context', '\n\n', '\n', ' before', '<|begin_of_text|>', '<|end_header_id|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [350.6, 215.575, 215.575, 170.6125]}, 'weight': {'score': [21.18359375, 23.261158250551876, 21.79248046875, 23.269171324525747, 29.055419921875], 'topk_indices': array([3311, 3338, 3231, 3183, 7427, 7389, 1427, 1489, 4302, 4318, 5123,
       5184, 7166, 7110, 3494, 3520, 4925, 4900, 4977, 4948]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [23.49375, 20.796875, 20.796875, 19.646875]}, 'saliency': {'score': [1.3775390625, 0.11899683233976423, 0.6832199096679688, 0.11478416741731337, 0.36806535720825195], 'topk_indices': array([2530,   19, 2529, 8137,   23, 3534, 2536, 2535, 8134, 7720, 8136,
         24, 8121,   20, 8142, 3530, 8145, 8140, 8139, 8006]), 'topk_tokens': ['ï¿½', '26', 'ï¿½', ' was', '4', ' apple', 'ï¿½', 'ï¿½', 'Question', 'inen', ' Where', '\n\n', ' return', ' Jul', ' garden', ' Sandra', 'Answer', ' before', ' apple', ' context'], 'evidence_proportions': [2.1833984375, 1.234765625, 1.234765625, 0.8572265625]}}, 'pred_res': "Sandra's office.<|eot_id|>", 'score': 100}
2025-01-22 19:46:49.891 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 19:46:49.891 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-140_pid-0_4-6-8-9.pkl | len: 3 |  size: 1.99 KB
Processing depth (4, 6, 8, 9):   1%|          | 1/100 [00:18<30:48, 18.67s/it]is_0k: False
your chose emoji: ['ğŸ“¶', 'ğŸŸ', 'ğŸ‘¨ğŸ¼\u200dğŸ¼', 'ğŸ§™ğŸ¿\u200dâ™€', 'ğŸ‘©ğŸ¼\u200dğŸ¤\u200dğŸ‘¨ğŸ½', 'â™Œ', 'ğŸ‘´ğŸ¿', 'ğŸ¤›', 'ğŸ˜ƒ', 'ğŸ§‘\u200dğŸ§’\u200dğŸ§’']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.01s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.40s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.22s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.96s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.43s/it]
Processing depth (2, 4, 7, 9):   1%|          | 1/100 [00:34<30:48, 18.67s/it]2025-01-22 19:47:05.530 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra picked up the apple.
2025-01-22 19:47:05.539 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1755, 1760) --> . Sandra picked up the
2025-01-22 19:47:05.539 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went to the office.
2025-01-22 19:47:05.559 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3593, 3598) --> . Sandra went to the
2025-01-22 19:47:05.559 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went to the garden.
2025-01-22 19:47:05.578 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3593, 3598) --> . Sandra went to the
2025-01-22 19:47:05.578 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the office.
2025-01-22 19:47:05.599 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3721, 3726) -->  moved to the garden.
2025-01-22 19:47:05.599 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went back to the hallway.
2025-01-22 19:47:05.632 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5885, 5891) --> . Daniel went back to the
2025-01-22 19:47:05.633 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary moved to the garden.
2025-01-22 19:47:05.653 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3720, 3725) -->  Mary moved to the garden
2025-01-22 19:47:05.653 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the hallway.
2025-01-22 19:47:05.665 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2448, 2453) -->  John moved to the hallway
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:47:06.442 | INFO     | test_jbb_embedding:begin_test:693 - The office.<|eot_id|>
2025-01-22 19:47:06.442 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8192])
2025-01-22 19:47:08.678 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [280.85625, 27.4048083963876, 173.26171875, 26.497387533709244, 26.141148158482142], 'topk_indices': array([8177, 8183, 8186, 8182,   23,    1, 8175, 8080, 8045,   24, 8179,
       8118,   14, 8180, 8090, 8046, 8190,    0, 8187, 8188]), 'topk_tokens': [' was', '?', ':', ' garden', '4', '<|start_header_id|>', ':', '.\n\n', ' you', '\n\n', ' apple', ' moved', '\n', ' before', ' location', ' context', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [361.35, 230.225, 230.225, 301.625]}, 'weight': {'score': [21.15546875, 23.305865953746643, 23.203125, 23.311339329492522, 29.85639880952381], 'topk_indices': array([3329, 3356, 3201, 3249, 7435, 7473, 1515, 1453, 4362, 4378, 5173,
       5234, 7206, 7150, 3512, 3538, 4998, 4975, 5027, 4950]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [23.49375, 20.796875, 20.796875, 19.534375]}, 'saliency': {'score': [1.6001220703125, 0.15189301051073956, 1.0535202026367188, 0.14657422940384437, 0.19600786481584823], 'topk_indices': array([8183, 8089, 8177, 8044,   24, 8185, 8161, 8080,   20, 8176, 8045,
       1760, 8174, 1756, 8182, 8118, 8180, 8179, 8090, 8046]), 'topk_tokens': ['?', ' first', ' was', ' provided', '\n\n', 'Answer', ' return', '.\n\n', ' Jul', ' Where', ' you', ' apple', 'Question', ' Sandra', ' garden', ' moved', ' before', ' apple', ' location', ' context'], 'evidence_proportions': [2.29677734375, 1.289892578125, 1.289892578125, 1.52392578125]}}, 'pred_res': 'The office.<|eot_id|>', 'score': 100}
2025-01-22 19:47:08.686 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 19:47:08.686 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-140_pid-1_2-4-7-9.pkl | len: 3 |  size: 2.02 KB
Processing depth (2, 4, 7, 9):   2%|â–         | 2/100 [00:37<30:36, 18.74s/it]is_0k: False
your chose emoji: ['ğŸˆº', 'ğŸ§—ğŸ¼\u200dâ™€ï¸', 'â™¥ï¸', 'ğŸ§ğŸ»\u200dâ™‚ï¸', 'ğŸ‘©ğŸ¿\u200dâ¤\u200dğŸ‘¨ğŸ½', 'ğŸ‘³ğŸ¾\u200dâ™€ï¸', 'ğŸ¤µğŸ¼\u200dâ™€ï¸', 'ğŸ‘©ğŸ»\u200dâš–ï¸', 'ğŸ‘¨ğŸ½\u200dğŸ¦³', 'ğŸšµğŸ¼']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.04s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.46s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.03s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:12<00:00,  2.60s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:12<00:00,  3.18s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 1, 3, 5):   2%|â–         | 2/100 [00:51<30:36, 18.74s/it]2025-01-22 19:47:23.169 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra picked up the apple.
2025-01-22 19:47:23.170 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (32, 37) -->  picked up the apple.
2025-01-22 19:47:23.170 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went to the office.
2025-01-22 19:47:23.174 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (836, 841) --> . Sandra went to the
2025-01-22 19:47:23.174 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went to the garden.
2025-01-22 19:47:23.178 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (836, 841) --> . Sandra went to the
2025-01-22 19:47:23.178 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the office.
2025-01-22 19:47:23.197 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3830, 3835) --> . Mary moved to the
2025-01-22 19:47:23.198 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went back to the hallway.
2025-01-22 19:47:23.234 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6206, 6212) --> . Daniel went back to the
2025-01-22 19:47:23.234 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary moved to the garden.
2025-01-22 19:47:23.254 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3830, 3835) --> . Mary moved to the
2025-01-22 19:47:23.254 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the hallway.
2025-01-22 19:47:23.266 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2542, 2547) --> . John moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:47:27.192 | INFO     | test_jbb_embedding:begin_test:693 - The office.<|eot_id|>
2025-01-22 19:47:27.192 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8207])
2025-01-22 19:47:30.231 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [314.69375, 29.373913159337313, 75.7890625, 28.584846827970146, 31.42925824175824], 'topk_indices': array([  25, 8201,   36, 8194, 8105,  105,   23,   70, 8205,   67, 8195,
         14,   24,    1, 8203,   68,  106,   69, 8202,    0]), 'topk_tokens': ['<|eot_id|>', ':', '.', ' apple', ' location', ' P', '4', 'ER', '<|end_header_id|>', ' P', ' before', '\n', '\n\n', '<|start_header_id|>', '<|start_header_id|>', 'ION', 'ION', 'E', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [505.65, 327.05, 327.05, 99.025]}, 'weight': {'score': [20.83046875, 23.30257377573395, 19.8876953125, 23.315308408785025, 29.24261675824176], 'topk_indices': array([3290, 3317, 3162, 3210, 7420, 7458, 1494, 1432, 4321, 4337, 5152,
       5213, 7123, 7179, 3473, 3499, 4986, 4934, 4909, 4957]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.08125, 20.796875, 20.796875, 19.646875]}, 'saliency': {'score': [1.750958251953125, 0.16521929056523327, 0.37351226806640625, 0.16093108955363697, 0.22361109806941107], 'topk_indices': array([  63,  102,   23, 8197, 8061,   65, 8200,   31,   32,   64,  837,
         70,   24,   67, 8105, 8194, 8195,   69,   68,  106]), 'topk_tokens': ['MIN', 'ISC', '4', ' garden', ' context', 'ENCES', 'Answer', 'andra', ' picked', 'ISC', ' Sandra', 'ER', '\n\n', ' P', ' location', ' apple', ' before', 'E', 'ION', 'ION'], 'evidence_proportions': [2.6396484375, 1.93447265625, 1.93447265625, 0.4952392578125]}}, 'pred_res': 'The office.<|eot_id|>', 'score': 100}
2025-01-22 19:47:30.237 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 19:47:30.237 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-140_pid-2_0-1-3-5.pkl | len: 3 |  size: 1.98 KB
Processing depth (0, 1, 3, 5):   3%|â–         | 3/100 [00:59<32:22, 20.03s/it]is_0k: False
your chose emoji: ['ğŸ“¦', 'ğŸ™‡ğŸ¿\u200dâ™‚', 'ğŸ‘¨ğŸ»\u200dğŸ³', 'ğŸ§‘ğŸ»\u200dâœˆ', 'ğŸ§‘ğŸ¿\u200dğŸ¦¼', 'ğŸš´ğŸ»\u200dâ™€ï¸', 'ğŸ‹ğŸ¿\u200dâ™€', 'ğŸ‘¨ğŸ¿\u200dğŸš’', 'ğŸ‘ŒğŸ»', 'ğŸ‘©ğŸ¿\u200dğŸ¤\u200dğŸ‘©ğŸ¾']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.84s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.63s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.49s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.07s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.63s/it]
Processing depth (0, 1, 3, 9):   3%|â–         | 3/100 [01:15<32:22, 20.03s/it]2025-01-22 19:47:46.916 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra picked up the apple.
2025-01-22 19:47:46.916 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (32, 37) -->  picked up the apple.
2025-01-22 19:47:46.916 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went to the office.
2025-01-22 19:47:46.920 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (776, 781) --> . Sandra went to the
2025-01-22 19:47:46.920 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went to the garden.
2025-01-22 19:47:46.924 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (776, 781) --> . Sandra went to the
2025-01-22 19:47:46.924 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the office.
2025-01-22 19:47:46.942 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3760, 3765) --> . Mary moved to the
2025-01-22 19:47:46.942 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went back to the hallway.
2025-01-22 19:47:46.972 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6079, 6085) -->  Daniel went back to the hallway
2025-01-22 19:47:46.972 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary moved to the garden.
2025-01-22 19:47:46.990 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3760, 3765) --> . Mary moved to the
2025-01-22 19:47:46.990 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the hallway.
2025-01-22 19:47:47.002 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2418, 2423) --> . John moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:47:47.782 | INFO     | test_jbb_embedding:begin_test:693 - The office.<|eot_id|>
2025-01-22 19:47:47.782 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8141])
2025-01-22 19:47:50.068 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [319.8875, 35.296496991280854, 90.70703125, 34.48505149870482, 16.49932650862069], 'topk_indices': array([  25,  105, 7614, 7540,   67, 7570, 8139,   70,   24,   14,    1,
       7569, 8137,   68,  106, 7615,   69, 7571, 8136,    0]), 'topk_tokens': ['<|eot_id|>', ' P', ' two', 'nes', ' P', ' or', '<|end_header_id|>', 'ER', '\n\n', '\n', '<|start_header_id|>', ' two', '<|start_header_id|>', 'ION', 'ION', ' or', 'E', ' three', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [548.75, 315.4, 315.4, 100.0]}, 'weight': {'score': [20.83046875, 23.252314104138524, 21.79248046875, 23.26116993801653, 29.09428879310345], 'topk_indices': array([3315, 3288, 3160, 3208, 7432, 7394, 1504, 1442, 4295, 4279, 5157,
       5096, 7075, 7131, 3497, 3471, 4873, 4950, 4921, 4898]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.08125, 20.796875, 20.796875, 19.646875]}, 'saliency': {'score': [1.798187255859375, 0.19910059229361107, 0.48809814453125, 0.19458527292675312, 0.1167620954842403], 'topk_indices': array([8123,   32, 7539,    0, 8129, 8039,   24,  777,   67, 7606, 7570,
         70, 7614, 7540, 7569,   69,   68, 7615,  106, 7571]), 'topk_tokens': ['Question', ' picked', ' Min', '<|begin_of_text|>', ' before', ' location', '\n\n', ' Sandra', ' P', ' tele', ' or', 'ER', ' two', 'nes', ' two', 'E', 'ION', ' or', 'ION', ' three'], 'evidence_proportions': [2.830078125, 1.93623046875, 1.93623046875, 0.4902099609375]}}, 'pred_res': 'The office.<|eot_id|>', 'score': 100}
2025-01-22 19:47:50.080 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 19:47:50.080 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-140_pid-3_0-1-3-9.pkl | len: 3 |  size: 1.99 KB
Processing depth (0, 1, 3, 9):   4%|â–         | 4/100 [01:18<31:55, 19.95s/it]is_0k: False
your chose emoji: ['ğŸ¹', 'ğŸ–', 'ğŸ‡ğŸ¿', 'ğŸ‘°\u200dâ™‚', 'ğŸ–Šï¸', '\U0001faf2', 'ğŸ¤¾ğŸ»\u200dâ™‚ï¸', 'ğŸ”¨', 'ğŸ§‘ğŸ¼\u200dğŸ¤\u200dğŸ§‘ğŸ½', 'ğŸ¤˜']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.17s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.72s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.41s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.02s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.55s/it]
Processing depth (0, 1, 5, 9):   4%|â–         | 4/100 [01:35<31:55, 19.95s/it]2025-01-22 19:48:06.436 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra picked up the apple.
2025-01-22 19:48:06.436 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (32, 37) -->  picked up the apple.
2025-01-22 19:48:06.437 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went to the office.
2025-01-22 19:48:06.440 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (770, 775) --> . Sandra went to the
2025-01-22 19:48:06.440 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went to the garden.
2025-01-22 19:48:06.444 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (770, 775) --> . Sandra went to the
2025-01-22 19:48:06.444 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the office.
2025-01-22 19:48:06.462 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3704, 3709) --> . Mary moved to the
2025-01-22 19:48:06.463 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went back to the hallway.
2025-01-22 19:48:06.492 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5852, 5858) --> . Daniel went back to the
2025-01-22 19:48:06.492 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary moved to the garden.
2025-01-22 19:48:06.510 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3704, 3709) --> . Mary moved to the
2025-01-22 19:48:06.510 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the hallway.
2025-01-22 19:48:06.522 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2434, 2439) --> . John moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:48:07.304 | INFO     | test_jbb_embedding:begin_test:693 - The office.<|eot_id|>
2025-01-22 19:48:07.305 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8243])
2025-01-22 19:48:09.537 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [404.825, 36.741532747119464, 134.64453125, 35.65393166037276, 14.264711152522937], 'topk_indices': array([  23,  103,  102,   28,   14, 8241,   24,    1,   65,  104,   66,
       8239,  105,   70,   67, 8238,   68,    0,  106,   69]), 'topk_tokens': ['4', 'ENCES', 'ISC', '<|end_header_id|>', '\n', '<|end_header_id|>', '\n\n', '<|start_header_id|>', 'ENCES', ' OF', ' OF', '<|start_header_id|>', ' P', 'ER', ' P', '<|eot_id|>', 'ION', '<|begin_of_text|>', 'ION', 'E'], 'evidence_proportions': [682.0, 353.475, 353.475, 230.35]}, 'weight': {'score': [20.83046875, 23.342616737416616, 19.8876953125, 23.355471129248386, 29.776232798165136], 'topk_indices': array([3363, 3336, 3256, 3208, 7522, 7484, 1440, 1502, 4349, 4333, 5235,
       5174, 7261, 7205, 3545, 3519, 4976, 4999, 4951, 5028]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.08125, 20.796875, 20.796875, 19.646875]}, 'saliency': {'score': [2.2605224609375, 0.204888616206792, 0.67938232421875, 0.19895554564730783, 0.10419450112439077], 'topk_indices': array([113,  40,  53,  58,  61,  43,   0,  42,  64, 104, 103, 102,  66,
       105,  65,  70,  67,  69,  68, 106]), 'topk_tokens': [' PA', '\n\n\n', ' Gutenberg', ' Proof', '\n\n\n\n', ' prepared', '<|begin_of_text|>', '-text', 'ISC', ' OF', 'ENCES', 'ISC', ' OF', ' P', 'ENCES', 'ER', ' P', 'E', 'ION', 'ION'], 'evidence_proportions': [3.626171875, 2.13037109375, 2.13037109375, 1.15517578125]}}, 'pred_res': 'The office.<|eot_id|>', 'score': 100}
2025-01-22 19:48:09.543 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 19:48:09.543 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-140_pid-4_0-1-5-9.pkl | len: 3 |  size: 1.99 KB
Processing depth (0, 1, 5, 9):   5%|â–Œ         | 5/100 [01:38<31:18, 19.78s/it]Processing depth (0, 1, 5, 9):   5%|â–Œ         | 5/100 [01:38<31:09, 19.68s/it]
2025-01-22 19:48:09.612 | INFO     | __main__:<module>:82 - Selected idx: 142
2025-01-22 19:48:09.612 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the apple before the garden? 
2025-01-22 19:48:09.612 | INFO     | __main__:<module>:84 - Answer: office
2025-01-22 19:48:09.612 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 19:48:09.612 | INFO     | __main__:<module>:86 - Needle: [' Sandra picked up the apple.', ' Daniel went back to the hallway.', ' Mary put down the milk.', ' Sandra went to the office.', ' John moved to the hallway.', ' Mary got the milk there.', ' Sandra went to the garden.', ' Mary moved to the garden.']
2025-01-22 19:48:09.612 | INFO     | __main__:<module>:87 - Real Needle: [' Sandra picked up the apple.', ' Sandra went to the office.', ' Sandra went to the garden.', ' Mary moved to the garden.']
2025-01-22 19:48:09.612 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ’‚ğŸ¿\u200dâ™€ï¸', 'ğŸ“', 'ğŸ§‘ğŸ»\u200dğŸ¤\u200dğŸ§‘ğŸ¿', 'ğŸ‘©ğŸ¾\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘©ğŸ¼', 'ğŸ‘¨\u200dğŸ‘¨\u200dğŸ‘§\u200dğŸ‘¦', 'ğŸ‘©ğŸ¿\u200dğŸ¦¼\u200dâ¡', 'ğŸš‹', 'ğŸ‘©ğŸ¿\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘©ğŸ¼', 'ğŸ§°', 'ğŸ‹ğŸ½\u200dâ™€ï¸']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  3.82s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.27s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:03,  3.97s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:12<00:00,  2.59s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:12<00:00,  3.12s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (1, 2, 6, 7):   0%|          | 0/100 [00:14<?, ?it/s]2025-01-22 19:48:23.886 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra picked up the apple.
2025-01-22 19:48:23.891 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (907, 912) --> . Sandra picked up the
2025-01-22 19:48:23.891 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went to the office.
2025-01-22 19:48:23.900 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1871, 1876) --> . Sandra went to the
2025-01-22 19:48:23.901 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went to the garden.
2025-01-22 19:48:23.912 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1871, 1876) --> . Sandra went to the
2025-01-22 19:48:23.912 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the garden.
2025-01-22 19:48:23.941 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5644, 5649) --> . Mary moved to the
2025-01-22 19:48:23.941 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went back to the hallway.
2025-01-22 19:48:23.954 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2409, 2415) --> . Daniel went back to the
2025-01-22 19:48:23.955 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary put down the milk.
2025-01-22 19:48:23.963 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1793, 1798) --> . Mary put down the
2025-01-22 19:48:23.963 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the hallway.
2025-01-22 19:48:23.964 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (183, 188) --> . John moved to the
2025-01-22 19:48:23.965 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary got the milk there.
2025-01-22 19:48:23.968 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (631, 636) --> . Mary got the milk
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:48:30.288 | INFO     | test_jbb_embedding:begin_test:693 - Sandra's office.<|eot_id|>
2025-01-22 19:48:30.288 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8168])
2025-01-22 19:48:33.243 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [561.38125, 45.32906211750306, 355.125, 43.259095522204454, 21.99816009963768], 'topk_indices': array([ 912,  636, 7542,  189,  637, 7350,  550,  913, 7543, 8066,  551,
       8156, 8166,  908,   14,   24, 1876, 8163,    0, 8164]), 'topk_tokens': [' apple', ' there', ' Min', '.', '.', 'nes', ',', '.', 'nes', ' location', ' instead', ' before', '<|end_header_id|>', ' Sandra', '\n', '\n\n', ' office', '<|eot_id|>', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [709.4, 672.75, 672.75, 190.625]}, 'weight': {'score': [21.18359375, 23.281959531823745, 21.124255952380953, 23.2926962879813, 29.769927536231883], 'topk_indices': array([3319, 3292, 3164, 3212, 7435, 7397, 1429, 1491, 4271, 4287, 5120,
       5181, 7174, 7118, 3475, 3501, 4974, 4945, 4922, 4897]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [23.49375, 20.796875, 20.796875, 19.646875]}, 'saliency': {'score': [3.260791015625, 0.2520596563743115, 1.9205787295386905, 0.2403468346592831, 0.1634698397871377], 'topk_indices': array([1873, 8022, 8150,  636,   24,  635,  909, 8155, 7498, 7350,  188,
       7542,  912, 1872, 8066, 8156, 7543,  551, 1876,  908]), 'topk_tokens': [' went', ' context', 'Question', ' there', '\n\n', ' milk', ' picked', ' apple', 'nes', 'nes', ' hallway', ' Min', ' apple', ' Sandra', ' location', ' before', 'nes', ' instead', ' office', ' Sandra'], 'evidence_proportions': [4.625390625, 3.7083984375, 3.7083984375, 1.0009765625]}}, 'pred_res': "Sandra's office.<|eot_id|>", 'score': 100}
2025-01-22 19:48:33.250 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 19:48:33.250 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-142_pid-0_1-2-6-7.pkl | len: 3 |  size: 2.01 KB
Processing depth (1, 2, 6, 7):   1%|          | 1/100 [00:23<38:51, 23.55s/it]is_0k: False
your chose emoji: ['ğŸ™ğŸ¼\u200dâ™€', 'ğŸ§‘ğŸ¿', 'ğŸ’¿', 'ğŸ‡¸ğŸ‡¿', 'ğŸ™ğŸ¿\u200dâ™€ï¸', 'ğŸ‹\u200dâ™€', 'â­ï¸', 'ğŸ§›\u200dâ™€', 'ğŸ™‹ğŸ¿\u200dâ™‚', 'ğŸ‘¨ğŸ½\u200dâ¤\u200dğŸ‘¨ğŸ¿']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  3.85s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.17s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.29s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.00s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.43s/it]
Processing depth (0, 5, 6, 8):   1%|          | 1/100 [00:38<38:51, 23.55s/it]2025-01-22 19:48:48.672 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra picked up the apple.
2025-01-22 19:48:48.672 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (32, 37) -->  picked up the apple.
2025-01-22 19:48:48.672 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went to the office.
2025-01-22 19:48:48.693 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4157, 4162) --> . Sandra went to the
2025-01-22 19:48:48.693 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went to the garden.
2025-01-22 19:48:48.715 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4157, 4162) --> . Sandra went to the
2025-01-22 19:48:48.716 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the garden.
2025-01-22 19:48:48.754 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6626, 6631) -->  Mary moved to the garden
2025-01-22 19:48:48.754 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went back to the hallway.
2025-01-22 19:48:48.766 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2206, 2212) --> . Daniel went back to the
2025-01-22 19:48:48.766 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary put down the milk.
2025-01-22 19:48:48.775 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1788, 1793) --> . Mary put down the
2025-01-22 19:48:48.775 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the hallway.
2025-01-22 19:48:48.776 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (190, 195) --> . John moved to the
2025-01-22 19:48:48.776 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary got the milk there.
2025-01-22 19:48:48.779 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (638, 643) --> . Mary got the milk
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:48:49.621 | INFO     | test_jbb_embedding:begin_test:693 - Sandra's office.<|eot_id|>
2025-01-22 19:48:49.621 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8159])
2025-01-22 19:48:51.838 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [641.2, 62.162369041784096, 281.6815476190476, 60.16844596674877, 67.46807861328125], 'topk_indices': array([  75,    1,   14,  112,   24, 8149,  113,   70,  105, 7535, 7491,
       7536, 8147,   67, 8155, 8154,   68,  106,   69,    0]), 'topk_tokens': [' PA', '<|start_header_id|>', '\n', '.', '\n\n', ' garden', ' PA', 'ER', ' P', ' Min', 'nes', 'nes', ' before', ' P', '<|start_header_id|>', '<|eot_id|>', 'ION', 'ION', 'E', '<|begin_of_text|>'], 'evidence_proportions': [1044.9, 574.8, 574.8, 370.3]}, 'weight': {'score': [21.958984375, 23.26188579830903, 21.124255952380953, 23.270623268165025, 29.0517578125], 'topk_indices': array([3324, 3297, 3217, 3169, 7428, 7390, 1486, 1424, 4316, 4300, 5178,
       5117, 7111, 7167, 3480, 3506, 4894, 4919, 4942, 4971]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.08125, 20.796875, 20.796875, 24.1609375]}, 'saliency': {'score': [3.6941650390625, 0.3518313807667565, 1.518705822172619, 0.3405812531269243, 0.4923057556152344], 'topk_indices': array([  31, 8057,   65, 8146,  102,   37, 4158,   70,  105,   75,   67,
       8149,  113, 8147, 7535, 7491, 7536,   69,   68,  106]), 'topk_tokens': ['andra', ' location', 'ENCES', ' apple', 'ISC', ' PA', ' Sandra', 'ER', ' P', ' PA', ' P', ' garden', ' PA', ' before', ' Min', 'nes', 'nes', 'E', 'ION', 'ION'], 'evidence_proportions': [5.387109375, 3.5412109375, 3.5412109375, 2.30712890625]}}, 'pred_res': "Sandra's office.<|eot_id|>", 'score': 100}
2025-01-22 19:48:51.845 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 19:48:51.845 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-142_pid-1_0-5-6-8.pkl | len: 3 |  size: 1.96 KB
Processing depth (0, 5, 6, 8):   2%|â–         | 2/100 [00:42<33:42, 20.64s/it]is_0k: False
your chose emoji: ['ğŸï¸', 'ğŸª¨', 'ğŸ‘©\u200dâš•ï¸', 'ğŸ§ğŸ¼\u200dâ™€', 'ğŸ‘', 'ğŸ§‘ğŸ¼\u200dğŸ„', 'ğŸ‘¨ğŸ½\u200dâš•', 'ğŸ¤Œ', 'ğŸšµğŸ¾\u200dâ™‚', 'ğŸ‘¯\u200dâ™‚']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  3.82s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.06s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.12s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.88s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.30s/it]
Processing depth (1, 4, 5, 6):   2%|â–         | 2/100 [00:56<33:42, 20.64s/it]2025-01-22 19:49:06.730 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra picked up the apple.
2025-01-22 19:49:06.734 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (792, 797) -->  Sandra picked up the apple
2025-01-22 19:49:06.734 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went to the office.
2025-01-22 19:49:06.751 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3562, 3567) --> . Sandra went to the
2025-01-22 19:49:06.751 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went to the garden.
2025-01-22 19:49:06.769 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3562, 3567) --> . Sandra went to the
2025-01-22 19:49:06.769 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the garden.
2025-01-22 19:49:06.792 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4748, 4753) --> . Mary moved to the
2025-01-22 19:49:06.792 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went back to the hallway.
2025-01-22 19:49:06.803 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2221, 2227) --> . Daniel went back to the
2025-01-22 19:49:06.803 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary put down the milk.
2025-01-22 19:49:06.812 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1747, 1752) --> . Mary put down the
2025-01-22 19:49:06.812 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the hallway.
2025-01-22 19:49:06.813 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (183, 188) --> . John moved to the
2025-01-22 19:49:06.813 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary got the milk there.
2025-01-22 19:49:06.816 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (618, 623) -->  Mary got the milk there
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:49:07.557 | INFO     | test_jbb_embedding:begin_test:693 - the office<|eot_id|>
2025-01-22 19:49:07.557 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8178])
2025-01-22 19:49:09.778 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [233.9859375, 24.986162897310514, 150.3407738095238, 24.149150694188474, 26.210119298986488], 'topk_indices': array([8163, 8167, 8169, 8161,    4,    9, 8168, 8172,   23, 8066, 8032,
       8076,    1,   14, 8166,   24, 8173, 8176, 8174,    0]), 'topk_tokens': [' was', ' the', '?', ':', '\n\n', ':', ' garden', ':', '4', '.\n\n', ' context', ' location', '<|start_header_id|>', '\n', ' before', '\n\n', '<|eot_id|>', '<|end_header_id|>', '<|start_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [305.5, 264.05, 264.05, 102.34375]}, 'weight': {'score': [22.335546875, 23.28588210574572, 21.849330357142858, 23.29192391571446, 29.54835304054054], 'topk_indices': array([3371, 3344, 3264, 3216, 7423, 7461, 1445, 1507, 4335, 4351, 5152,
       5213, 7144, 7200, 3553, 3527, 4954, 4977, 5006, 4929]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.1015625, 20.796875, 20.796875, 19.646875]}, 'saliency': {'score': [1.403302001953125, 0.1384126919697433, 0.8631708054315477, 0.13343447516394827, 0.19549766746727196], 'topk_indices': array([7568, 8169,  792,   19, 7569,   16, 8162,    8, 8171, 8147,   23,
       8066, 8160,   20, 8165,   24, 8168, 8076, 8032, 8166]), 'topk_tokens': [' Min', '?', ' Sandra', '26', 'nes', ' Date', ' Where', ' Date', 'Answer', ' return', '4', '.\n\n', 'Question', ' Jul', ' apple', '\n\n', ' garden', ' location', ' context', ' before'], 'evidence_proportions': [2.24384765625, 1.441845703125, 1.441845703125, 0.4856689453125]}}, 'pred_res': 'the office<|eot_id|>', 'score': 100}
2025-01-22 19:49:09.784 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 19:49:09.785 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-142_pid-2_1-4-5-6.pkl | len: 3 |  size: 1.99 KB
Processing depth (1, 4, 5, 6):   3%|â–         | 3/100 [01:00<31:22, 19.40s/it]is_0k: False
your chose emoji: ['â—¾', 'ğŸ§‘ğŸ¿\u200dâš–ï¸', 'ğŸ‘©ğŸ»\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘¨ğŸ¿', 'ğŸ—', 'ğŸ–•ğŸ¾', 'ğŸ‘©ğŸ»\u200dğŸ¤\u200dğŸ‘©ğŸ½', 'ğŸ™', 'ğŸš¢', 'ğŸ¤', 'ğŸ‹ï¸\u200dâ™€ï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.34s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.48s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.28s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.97s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.48s/it]
Processing depth (1, 4, 5, 9):   3%|â–         | 3/100 [01:15<31:22, 19.40s/it]2025-01-22 19:49:25.471 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra picked up the apple.
2025-01-22 19:49:25.476 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (801, 806) --> . Sandra picked up the
2025-01-22 19:49:25.476 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went to the office.
2025-01-22 19:49:25.494 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3643, 3648) -->  Hon. Sandra went to
2025-01-22 19:49:25.494 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went to the garden.
2025-01-22 19:49:25.515 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3643, 3648) -->  Hon. Sandra went to
2025-01-22 19:49:25.515 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the garden.
2025-01-22 19:49:25.550 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7129, 7134) -->  Mary moved to the garden
2025-01-22 19:49:25.550 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went back to the hallway.
2025-01-22 19:49:25.561 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2169, 2175) --> . Daniel went back to the
2025-01-22 19:49:25.561 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary put down the milk.
2025-01-22 19:49:25.569 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1757, 1762) --> . Mary put down the
2025-01-22 19:49:25.569 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the hallway.
2025-01-22 19:49:25.570 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (183, 188) --> . John moved to the
2025-01-22 19:49:25.570 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary got the milk there.
2025-01-22 19:49:25.572 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (400, 405) -->  Mary got the milk there
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:49:26.341 | INFO     | test_jbb_embedding:begin_test:693 - The office.<|eot_id|>
2025-01-22 19:49:26.342 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8186])
2025-01-22 19:49:28.558 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [247.659375, 27.930630190522717, 136.06845238095238, 27.11248005400761, 29.550656049679485], 'topk_indices': array([8074,   20,   25, 2411, 8174, 2400, 4237, 8084, 8040,    1,   23,
       2395, 8182,   14,   24, 2413, 8181, 2414, 8184,    0]), 'topk_tokens': ['.\n\n', ' Jul', '<|eot_id|>', '\n', ' before', ' the', 'ree', ' location', ' context', '<|start_header_id|>', '4', 'the', '<|start_header_id|>', '\n', '\n\n', ' to', '<|eot_id|>', ' the', '<|end_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [331.125, 260.175, 260.175, 139.1625]}, 'weight': {'score': [24.716015625, 23.304368817171472, 21.849330357142858, 23.304653937032036, 30.197516025641026], 'topk_indices': array([3306, 3333, 3178, 3226, 7419, 7457, 1455, 1517, 4317, 4301, 5132,
       5193, 7196, 7140, 3489, 3515, 4966, 4937, 4914, 4889]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [23.49375, 25.6046875, 25.6046875, 24.1609375]}, 'saliency': {'score': [1.528076171875, 0.1542414305090147, 0.7734665643601191, 0.14927267849745304, 0.22354478102463943], 'topk_indices': array([   8, 7750, 3649,   16, 8176, 4240,   19, 2412, 2316, 2414,   23,
       2413, 8174, 8084, 4237,   20,   24, 8040,  802, 2395]), 'topk_tokens': [' Date', 'inen', ' office', ' Date', ' garden', 'outs', '26', 'street', ' Min', ' the', '4', ' to', ' before', ' location', 'ree', ' Jul', '\n\n', ' context', ' Sandra', 'the'], 'evidence_proportions': [2.1541015625, 1.5609375, 1.5609375, 0.836328125]}}, 'pred_res': 'The office.<|eot_id|>', 'score': 100}
2025-01-22 19:49:28.563 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 19:49:28.564 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-142_pid-3_1-4-5-9.pkl | len: 3 |  size: 2.0 KB
Processing depth (1, 4, 5, 9):   4%|â–         | 4/100 [01:18<30:39, 19.16s/it]is_0k: False
your chose emoji: ['ğŸ’«', 'ğŸ’\u200dâ™‚ï¸', 'ğŸ•µğŸ½\u200dâ™‚ï¸', 'ğŸ‘©ğŸ¼\u200dâ¤ï¸\u200dğŸ‘©ğŸ½', 'ğŸ’†ğŸ»\u200dâ™€', 'ğŸ¦­', 'ğŸ™ğŸ»\u200dâ™€ï¸', 'ğŸ‘¨ğŸ¾\u200dğŸ”¬', 'âœ³', 'ğŸš¶ğŸ¼\u200dâ™‚\u200dâ¡ï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  3.96s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.23s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.16s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.91s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.36s/it]
Processing depth (3, 4, 5, 7):   4%|â–         | 4/100 [01:33<30:39, 19.16s/it]2025-01-22 19:49:43.661 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra picked up the apple.
2025-01-22 19:49:43.676 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2869, 2874) -->  Sandra picked up the apple
2025-01-22 19:49:43.676 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went to the office.
2025-01-22 19:49:43.694 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3642, 3647) --> . Sandra went to the
2025-01-22 19:49:43.694 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went to the garden.
2025-01-22 19:49:43.712 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3642, 3647) --> . Sandra went to the
2025-01-22 19:49:43.712 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the garden.
2025-01-22 19:49:43.740 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5744, 5749) --> . Mary moved to the
2025-01-22 19:49:43.740 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went back to the hallway.
2025-01-22 19:49:43.751 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2163, 2169) --> . Daniel went back to the
2025-01-22 19:49:43.751 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary put down the milk.
2025-01-22 19:49:43.759 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1755, 1760) --> . Mary put down the
2025-01-22 19:49:43.759 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the hallway.
2025-01-22 19:49:43.760 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (165, 170) --> . John moved to the
2025-01-22 19:49:43.760 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary got the milk there.
2025-01-22 19:49:43.762 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (403, 408) --> . Mary got the milk
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:49:44.604 | INFO     | test_jbb_embedding:begin_test:693 - Sandra's office.<|eot_id|>
2025-01-22 19:49:44.604 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8186])
2025-01-22 19:49:46.945 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [301.375, 27.316331827063998, 142.4077380952381, 26.346883822265866, 41.69350961538461], 'topk_indices': array([8168,   23, 2874, 8172, 8176, 8170,    1, 8074, 8169, 8171, 2184,
       8173, 8040,   24,   14, 8174, 8184, 8181,    0, 8182]), 'topk_tokens': ['Question', '4', '.', ' the', ' garden', ' Where', '<|start_header_id|>', '.\n\n', ':', ' was', 're', ' apple', ' context', '\n\n', '\n', ' before', '<|end_header_id|>', '<|eot_id|>', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [388.2, 313.425, 313.425, 190.45]}, 'weight': {'score': [22.335546875, 23.290228459330727, 21.124255952380953, 23.298155187492327, 29.452123397435898], 'topk_indices': array([3326, 3353, 3246, 3198, 7417, 7455, 1453, 1515, 4343, 4327, 5199,
       5138, 7178, 7122, 3509, 3535, 4940, 4992, 4915, 4963]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.1015625, 20.796875, 20.796875, 19.646875]}, 'saliency': {'score': [1.80440673828125, 0.1507735035742092, 0.7716122581845238, 0.14511371732884804, 0.3124373998397436], 'topk_indices': array([8038,   20,   23,    8, 8179, 8155, 8074, 2873, 2869, 8171,   24,
       3647, 8084, 2184, 8170, 8168, 8176, 8040, 8173, 8174]), 'topk_tokens': [' provided', ' Jul', '4', ' Date', 'Answer', ' return', '.\n\n', ' apple', ' Sandra', ' was', '\n\n', ' office', ' location', 're', ' Where', 'Question', ' garden', ' context', ' apple', ' before'], 'evidence_proportions': [2.859375, 1.712060546875, 1.712060546875, 0.934130859375]}}, 'pred_res': "Sandra's office.<|eot_id|>", 'score': 100}
2025-01-22 19:49:46.951 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 19:49:46.952 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-142_pid-4_3-4-5-7.pkl | len: 3 |  size: 2.02 KB
Processing depth (3, 4, 5, 7):   5%|â–Œ         | 5/100 [01:37<29:53, 18.88s/it]Processing depth (3, 4, 5, 7):   5%|â–Œ         | 5/100 [01:37<30:51, 19.49s/it]
2025-01-22 19:49:47.170 | INFO     | __main__:<module>:82 - Selected idx: 144
2025-01-22 19:49:47.170 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the football before the bathroom? 
2025-01-22 19:49:47.171 | INFO     | __main__:<module>:84 - Answer: office
2025-01-22 19:49:47.171 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 19:49:47.171 | INFO     | __main__:<module>:86 - Needle: [' Daniel got the football.', ' Daniel went to the office.', ' Mary got the milk there.', ' John moved to the hallway.', ' Mary put down the milk.', ' Daniel travelled to the bathroom.', ' Mary moved to the garden.']
2025-01-22 19:49:47.171 | INFO     | __main__:<module>:87 - Real Needle: [' Daniel got the football.', ' Daniel went to the office.', ' Daniel travelled to the bathroom.', ' Mary moved to the garden.']
2025-01-22 19:49:47.171 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ§ğŸ»\u200dâ™€\u200dâ¡', 'âï¸', 'ğŸ‡­ğŸ‡°', 'ğŸ‘©ğŸ½\u200dğŸ¤', 'ğŸ¤¹ğŸ»\u200dâ™€', 'ğŸ‘¨ğŸ½\u200dâœˆï¸', 'ğŸ‘¨ğŸ½\u200dâš–', 'ğŸ¤¹\u200dâ™€', 'ğŸ§‘ğŸ»\u200dğŸ”¬', 'âš—ï¸']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.39s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.45s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.19s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.71s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.30s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 2, 7, 8):   0%|          | 0/100 [00:14<?, ?it/s]2025-01-22 19:50:02.182 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the football.
2025-01-22 19:50:02.233 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the office.
2025-01-22 19:50:02.243 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1792, 1797) --> . Daniel went to the
2025-01-22 19:50:02.243 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel travelled to the bathroom.
2025-01-22 19:50:02.273 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5578, 5583) --> . Daniel travelled to the
2025-01-22 19:50:02.273 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the garden.
2025-01-22 19:50:02.308 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6528, 6533) --> . Mary moved to the
2025-01-22 19:50:02.308 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the milk there.
2025-01-22 19:50:02.332 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4392, 4397) --> . Mary got the milk
2025-01-22 19:50:02.332 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John moved to the hallway.
2025-01-22 19:50:02.346 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2852, 2857) --> . John moved to the
2025-01-22 19:50:02.346 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary put down the milk.
2025-01-22 19:50:02.367 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4396, 4401) -->  milk there. Mary put
2025-01-22 19:50:02.368 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 19:50:02.368 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 19:50:02.368 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 19:50:02.368 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ‘©ğŸ»\u200dğŸ¦¼', 'ğŸ§‘ğŸ½\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ§‘ğŸ¾', 'ğŸ‘¨ğŸ½\u200dğŸ¦¯\u200dâ¡', 'ğŸ©³', 'ğŸŒ»', 'ğŸ–', 'ğŸ•µğŸ¿\u200dâ™€', 'ğŸ‘¶', 'ğŸ™†ğŸ¿\u200dâ™‚', 'â¤\u200dğŸ”¥']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  3.68s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.06s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.33s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.02s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.42s/it]
Processing depth (3, 5, 6, 8):   0%|          | 0/100 [00:30<?, ?it/s]2025-01-22 19:50:17.853 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the football.
2025-01-22 19:50:17.869 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2870, 2874) -->  Daniel got the football
2025-01-22 19:50:17.869 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the office.
2025-01-22 19:50:17.890 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4130, 4135) --> . Daniel went to the
2025-01-22 19:50:17.891 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel travelled to the bathroom.
2025-01-22 19:50:17.916 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4752, 4757) -->  the senate. Daniel travelled
2025-01-22 19:50:17.916 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the garden.
2025-01-22 19:50:17.953 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6620, 6625) --> . Mary moved to the
2025-01-22 19:50:17.953 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the milk there.
2025-01-22 19:50:17.977 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4422, 4427) --> . Mary got the milk
2025-01-22 19:50:17.977 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John moved to the hallway.
2025-01-22 19:50:17.991 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2873, 2878) -->  football. John moved to
2025-01-22 19:50:17.991 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary put down the milk.
2025-01-22 19:50:18.012 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4426, 4431) -->  milk there. Mary put
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:50:18.887 | INFO     | test_jbb_embedding:begin_test:693 - Daniel got the football.<|eot_id|>
2025-01-22 19:50:18.887 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8154])
2025-01-22 19:50:21.132 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [584.4605263157895, 50.40973669691025, 528.8229166666666, 48.27686761265698, 34.19282670454545], 'topk_indices': array([8042, 2872, 2871, 8008, 8141, 8152, 8147, 2870, 8137, 8144,   14,
       2883, 8148, 8142, 8149, 2884, 2874, 8150, 2873,    0]), 'topk_tokens': ['.\n\n', ' the', ' got', ' context', ' football', '<|end_header_id|>', 'Answer', ' Daniel', ':', ' bathroom', '\n', ' summer', ':', ' before', '<|eot_id|>', ' of', '.', '<|start_header_id|>', ' football', '<|begin_of_text|>'], 'evidence_proportions': [1904.5, 351.9, 260.925, 84.525]}, 'weight': {'score': [22.79235197368421, 23.268904794016674, 23.980208333333334, 23.2687059452721, 29.28811553030303], 'topk_indices': array([3297, 3270, 3190, 3142, 7433, 7395, 1495, 1433, 4273, 4289, 5102,
       5163, 7172, 7116, 3453, 3479, 4904, 4927, 4956, 4879]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.939453125, 19.665625, 25.746875, 19.646875]}, 'saliency': {'score': [3.8915180407072367, 0.2810358830443079, 3.08994140625, 0.2674022036742413, 0.25070329145951703], 'topk_indices': array([8146, 8139, 8148, 2874, 8042, 8138, 2884, 2879, 4759, 8052, 2871,
       8008, 8136, 8147, 8141, 8142, 2870, 2883, 8144, 2873]), 'topk_tokens': [' \n', ' was', ':', '.', '.\n\n', ' Where', ' of', ' hallway', ' bathroom', ' location', ' got', ' context', 'Question', 'Answer', ' football', ' before', ' Daniel', ' summer', ' bathroom', ' football'], 'evidence_proportions': [13.392578125, 1.85888671875, 1.777734375, 0.4370849609375]}}, 'pred_res': 'Daniel got the football.<|eot_id|>', 'score': 0}
2025-01-22 19:50:21.140 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 19:50:21.140 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-144_pid-0_3-5-6-8.pkl | len: 3 |  size: 2.03 KB
Processing depth (3, 5, 6, 8):   1%|          | 1/100 [00:33<55:53, 33.88s/it]is_0k: False
your chose emoji: ['ğŸ‘©ğŸ¾', 'ğŸ”Ÿ', 'ğŸ¤¾\u200dâ™€ï¸', 'ğŸ™ğŸ¼', 'ğŸ‡¸ğŸ‡²', 'ğŸ¥£', 'ğŸ‘©ğŸ¼\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘¨ğŸ¿', 'â¤\u200dğŸ”¥', 'ğŸ‡ºğŸ‡¬', 'ğŸ§›ğŸ¿']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  3.75s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:07<00:08,  4.02s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:11<00:03,  3.98s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:12<00:00,  2.79s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:12<00:00,  3.21s/it]
Processing depth (0, 5, 6, 7):   1%|          | 1/100 [00:48<55:53, 33.88s/it]2025-01-22 19:50:36.226 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the football.
2025-01-22 19:50:36.268 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the office.
2025-01-22 19:50:36.296 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4215, 4220) -->  Daniel went to the office
2025-01-22 19:50:36.296 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel travelled to the bathroom.
2025-01-22 19:50:36.320 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4874, 4879) --> . Daniel travelled to the
2025-01-22 19:50:36.320 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the garden.
2025-01-22 19:50:36.349 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5742, 5747) --> . Mary moved to the
2025-01-22 19:50:36.349 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the milk there.
2025-01-22 19:50:36.372 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4490, 4495) --> . Mary got the milk
2025-01-22 19:50:36.372 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John moved to the hallway.
2025-01-22 19:50:36.386 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2936, 2941) --> . John moved to the
2025-01-22 19:50:36.386 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary put down the milk.
2025-01-22 19:50:36.408 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4494, 4499) -->  milk there. Mary put
2025-01-22 19:50:36.408 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 19:50:36.408 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 19:50:36.408 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 19:50:36.408 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ‚', 'ğŸ•´ğŸ¾', 'ğŸ“¢', 'ğŸš´', 'ğŸ‘©ğŸ½\u200dâ¤\u200dğŸ‘¨ğŸ¿', 'ğŸ”¹', 'ğŸš¶ğŸ¼\u200dâ™‚ï¸\u200dâ¡ï¸', 'ğŸ‘¦ğŸ¾', 'ğŸ‘¨ğŸ¾\u200dğŸ¦½\u200dâ¡ï¸', 'ğŸ‘¨ğŸ»\u200dâ¤\u200dğŸ’‹\u200dğŸ‘¨ğŸ¼']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.33s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.41s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.29s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.96s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.47s/it]
Processing depth (1, 2, 7, 8):   1%|          | 1/100 [01:04<55:53, 33.88s/it]2025-01-22 19:50:52.018 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the football.
2025-01-22 19:50:52.023 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (896, 900) -->  Daniel got the football
2025-01-22 19:50:52.023 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the office.
2025-01-22 19:50:52.032 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1806, 1811) --> . Daniel went to the
2025-01-22 19:50:52.032 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel travelled to the bathroom.
2025-01-22 19:50:52.061 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5808, 5813) --> . Daniel travelled to the
2025-01-22 19:50:52.061 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the garden.
2025-01-22 19:50:52.097 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6657, 6662) -->  Mary moved to the garden
2025-01-22 19:50:52.098 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the milk there.
2025-01-22 19:50:52.119 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4492, 4497) --> . Mary got the milk
2025-01-22 19:50:52.119 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John moved to the hallway.
2025-01-22 19:50:52.133 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2940, 2945) --> . John moved to the
2025-01-22 19:50:52.133 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary put down the milk.
2025-01-22 19:50:52.157 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4496, 4501) -->  milk there. Mary put
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:50:53.012 | INFO     | test_jbb_embedding:begin_test:693 - Daniel got the football.<|eot_id|>
2025-01-22 19:50:53.012 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8228])
2025-01-22 19:50:55.261 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [388.74013157894734, 39.57670868772782, 131.1625, 38.599659895070765, 39.343048391990294], 'topk_indices': array([ 897,  895, 8227, 8224, 5834, 3304,    3,  896,  257, 8215,    1,
       8226,   14, 5835,   24, 5836,  900,  899,    0, 8223]), 'topk_tokens': [' got', '.', '\n\n', '<|start_header_id|>', '      ', ' a', '<|end_header_id|>', ' Daniel', 'hue', ' football', '<|start_header_id|>', '<|end_header_id|>', '\n', ' *', '\n\n', '      ', '.', ' football', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [1205.5, 68.525, 315.025, 129.2625]}, 'weight': {'score': [22.736019736842106, 23.33750759416768, 22.4859375, 23.3404604761469, 29.86665655339806], 'topk_indices': array([3280, 3307, 3200, 3152, 7457, 7419, 1442, 1504, 4313, 4297, 5181,
       5120, 7196, 7140, 3463, 3489, 4974, 4945, 4922, 4897]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.939453125, 19.665625, 21.01875, 24.1609375]}, 'saliency': {'score': [2.5444303813733553, 0.2227413580744988, 0.7224446614583333, 0.21644467176490437, 0.29831154832562196], 'topk_indices': array([8221, 8116, 8126, 8212, 8197, 8216,    0, 5834, 8210,   24,  897,
       8082, 8218, 5835, 5813, 5836,  896, 8215,  257,  899]), 'topk_tokens': ['Answer', '.\n\n', ' location', ' Where', ' return', ' before', '<|begin_of_text|>', '      ', 'Question', '\n\n', ' got', ' context', ' bathroom', ' *', ' bathroom', '      ', ' Daniel', ' football', 'hue', ' football'], 'evidence_proportions': [8.4873046875, 0.40233154296875, 1.70615234375, 0.7705078125]}}, 'pred_res': 'Daniel got the football.<|eot_id|>', 'score': 0}
2025-01-22 19:50:55.269 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 19:50:55.269 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-144_pid-1_1-2-7-8.pkl | len: 3 |  size: 2.06 KB
Processing depth (1, 2, 7, 8):   2%|â–         | 2/100 [01:08<55:34, 34.03s/it]is_0k: False
your chose emoji: ['ğŸ§‘ğŸ¼\u200dğŸš’', 'ğŸ§˜ğŸ½\u200dâ™€ï¸', 'ğŸ™†ğŸ»\u200dâ™‚ï¸', 'ğŸ§ğŸ¿\u200dâ™€ï¸', 'ğŸ§‘ğŸ¾\u200dğŸ¦¯', 'ğŸ‘®ğŸ»\u200dâ™‚', 'ğŸ‘©ğŸ¼\u200dâ¤ï¸\u200dğŸ‘¨ğŸ¼', 'ğŸ‘¨ğŸ¿\u200dğŸ’»', 'ğŸš¶ğŸ¿\u200dâ™€\u200dâ¡ï¸', 'ğŸ™†ğŸ»\u200dâ™€ï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  3.77s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:09,  4.50s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.56s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.21s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.64s/it]
Processing depth (1, 4, 5, 8):   2%|â–         | 2/100 [01:24<55:34, 34.03s/it]2025-01-22 19:51:11.759 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the football.
2025-01-22 19:51:11.764 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (896, 900) -->  Daniel got the football
2025-01-22 19:51:11.764 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the office.
2025-01-22 19:51:11.781 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3609, 3614) -->  Hon. Daniel went to
2025-01-22 19:51:11.781 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel travelled to the bathroom.
2025-01-22 19:51:11.802 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4211, 4216) -->  Daniel travelled to the bathroom
2025-01-22 19:51:11.802 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the garden.
2025-01-22 19:51:11.834 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6521, 6526) -->  Mary moved to the garden
2025-01-22 19:51:11.834 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the milk there.
2025-01-22 19:51:11.856 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4511, 4516) -->  Mary got the milk there
2025-01-22 19:51:11.856 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John moved to the hallway.
2025-01-22 19:51:11.870 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2918, 2923) --> . John moved to the
2025-01-22 19:51:11.870 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary put down the milk.
2025-01-22 19:51:11.892 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4514, 4519) -->  milk there. Mary put
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:51:12.697 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's house.<|eot_id|>
2025-01-22 19:51:12.697 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8170])
2025-01-22 19:51:14.921 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [924.5986842105264, 69.77780837004406, 328.01875, 67.30604494347506, 106.8194679054054], 'topk_indices': array([ 898,  907,  897, 8160,   24,   14, 8157,  895, 4246,  896,  257,
       8158, 8166, 2923,  899,  900, 8165,  901,  902,    0]), 'topk_tokens': [' the', 'â™€', ' got', ' bathroom', '\n\n', '\n', ' football', '.', 'ot', ' Daniel', 'hue', ' before', '<|start_header_id|>', ' hallway', ' football', '.', '<|eot_id|>', 'ï¿½', 'ï¿½', '<|begin_of_text|>'], 'evidence_proportions': [1988.75, 951.7, 783.85, 186.925]}, 'weight': {'score': [25.498355263157894, 23.294094927802252, 23.501041666666666, 23.288567138731874, 30.02829391891892], 'topk_indices': array([3258, 3285, 3130, 3178, 7431, 7393, 1482, 1420, 4263, 4279, 5187,
       5126, 7170, 7114, 3455, 3481, 4951, 4928, 4980, 4903]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.939453125, 24.4734375, 26.7078125, 24.1609375]}, 'saliency': {'score': [6.1928967927631575, 0.39653328080067607, 1.6110595703125, 0.3807617397500538, 0.8262007429793075], 'topk_indices': array([8068,  903, 3612,  911,  909, 4246,  897,  908, 8152, 4215,  907,
       8158, 8157, 8160,  896,  257,  899, 2923,  902,  901]), 'topk_tokens': [' location', 'ï¿½', ' went', 'ï¿½', 'ï¿½', 'ot', ' got', 'ï¸', 'Question', ' bathroom', 'â™€', ' before', ' football', ' bathroom', ' Daniel', 'hue', ' football', ' hallway', 'ï¿½', 'ï¿½'], 'evidence_proportions': [13.9677734375, 5.619921875, 5.578515625, 1.1603515625]}}, 'pred_res': "Daniel's house.<|eot_id|>", 'score': 0}
2025-01-22 19:51:14.929 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 19:51:14.929 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-144_pid-2_1-4-5-8.pkl | len: 3 |  size: 2.0 KB
Processing depth (1, 4, 5, 8):   3%|â–         | 3/100 [01:27<44:24, 27.47s/it]is_0k: False
your chose emoji: ['ğŸ¥‹', 'ğŸ¤¹ğŸ¼\u200dâ™‚', 'ğŸš¼', 'ğŸ›°', 'ğŸ‘©\u200dğŸ¦²', 'ğŸ’‚ğŸ½\u200dâ™€ï¸', 'ğŸ“½ï¸', 'ğŸ‘©\u200dâ¤\u200dğŸ’‹\u200dğŸ‘©', 'ğŸ•µğŸ»\u200dâ™€', 'ğŸ‘©ğŸ¼\u200dâ¤\u200dğŸ’‹\u200dğŸ‘©ğŸ»']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  3.71s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.19s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.19s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.92s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.35s/it]
Processing depth (2, 3, 5, 8):   3%|â–         | 3/100 [01:42<44:24, 27.47s/it]2025-01-22 19:51:30.077 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the football.
2025-01-22 19:51:30.086 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2000, 2004) -->  Daniel got the football
2025-01-22 19:51:30.087 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the office.
2025-01-22 19:51:30.101 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2973, 2978) -->  tragedy. Daniel went to
2025-01-22 19:51:30.101 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel travelled to the bathroom.
2025-01-22 19:51:30.121 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4229, 4234) -->  Daniel travelled to the bathroom
2025-01-22 19:51:30.122 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the garden.
2025-01-22 19:51:30.154 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6620, 6625) --> . Mary moved to the
2025-01-22 19:51:30.154 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the milk there.
2025-01-22 19:51:30.175 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4500, 4505) --> . Mary got the milk
2025-01-22 19:51:30.175 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John moved to the hallway.
2025-01-22 19:51:30.190 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2978, 2983) -->  the office. John moved
2025-01-22 19:51:30.190 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary put down the milk.
2025-01-22 19:51:30.212 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4504, 4509) -->  milk there. Mary put
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:51:31.062 | INFO     | test_jbb_embedding:begin_test:693 - Daniel got the football.<|eot_id|>
2025-01-22 19:51:31.062 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8182])
2025-01-22 19:51:33.286 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [535.9605263157895, 40.85680901759531, 165.50052083333333, 39.47317388803681, 50.42099609375], 'topk_indices': array([8070, 8181, 8172,    3, 8170, 2002, 2001, 8080, 8169,    1,   14,
       1999,   24, 2000, 2004, 8180, 8178, 2003,    0, 8177]), 'topk_tokens': ['.\n\n', '\n\n', ' bathroom', '<|end_header_id|>', ' before', ' the', ' got', ' location', ' football', '<|start_header_id|>', '\n', '.', '\n\n', ' Daniel', '.', '<|end_header_id|>', '<|start_header_id|>', ' football', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [1465.75, 319.3875, 399.1, 145.5625]}, 'weight': {'score': [24.57360197368421, 23.300846163245357, 23.5453125, 23.297429064417177, 29.8685546875], 'topk_indices': array([3300, 3327, 3200, 3152, 7391, 7429, 1461, 1399, 4305, 4321, 5195,
       5134, 7168, 7112, 3483, 3509, 4982, 4953, 4930, 4905]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.939453125, 25.4734375, 26.7078125, 19.646875]}, 'saliency': {'score': [3.6602140727796053, 0.2293650010930245, 0.8779988606770833, 0.2201728979941526, 0.3838809967041016], 'topk_indices': array([8070,   16, 8167, 2175, 2177, 8175, 8151, 8166, 8036,   24, 2985,
       4233, 8170, 8164, 2001, 8080, 8172, 8169, 2000, 2003]), 'topk_tokens': ['.\n\n', ' Date', ' was', 'ï¿½', 'ï¿½', 'Answer', ' return', ' Where', ' context', '\n\n', ' hallway', ' bathroom', ' before', 'Question', ' got', ' location', ' bathroom', ' football', ' Daniel', ' football'], 'evidence_proportions': [10.36376953125, 1.88310546875, 2.9103515625, 0.8243408203125]}}, 'pred_res': 'Daniel got the football.<|eot_id|>', 'score': 0}
2025-01-22 19:51:33.292 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 19:51:33.293 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-144_pid-3_2-3-5-8.pkl | len: 3 |  size: 2.07 KB
Processing depth (2, 3, 5, 8):   4%|â–         | 4/100 [01:46<38:11, 23.87s/it]is_0k: False
your chose emoji: ['ğŸ§ğŸ»\u200dâ™‚', 'ğŸƒğŸ¿\u200dâ™‚ï¸', 'ğŸƒğŸ½\u200dâ¡ï¸', 'ğŸ‚ğŸ¾', 'ğŸ•µğŸ»\u200dâ™‚ï¸', 'ğŸ‹ğŸ½\u200dâ™‚ï¸', 'âš½', 'ğŸ§ğŸ»\u200dâ™€ï¸', 'ğŸš·', 'ğŸ‘©ğŸ¾\u200dâš•']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.05s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.25s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.21s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.91s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.38s/it]
Processing depth (2, 4, 6, 9):   4%|â–         | 4/100 [02:01<38:11, 23.87s/it]2025-01-22 19:51:48.600 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the football.
2025-01-22 19:51:48.609 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1730, 1734) -->  Daniel got the football
2025-01-22 19:51:48.609 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the office.
2025-01-22 19:51:48.629 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3544, 3549) --> . Daniel went to the
2025-01-22 19:51:48.629 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel travelled to the bathroom.
2025-01-22 19:51:48.654 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4710, 4715) --> . Daniel travelled to the
2025-01-22 19:51:48.654 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the garden.
2025-01-22 19:51:48.689 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7097, 7102) -->  Mary moved to the garden
2025-01-22 19:51:48.689 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the milk there.
2025-01-22 19:51:48.714 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4414, 4419) --> . Mary got the milk
2025-01-22 19:51:48.714 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John moved to the hallway.
2025-01-22 19:51:48.728 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2868, 2873) --> . John moved to the
2025-01-22 19:51:48.728 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary put down the milk.
2025-01-22 19:51:48.749 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4418, 4423) -->  milk there. Mary put
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:51:49.587 | INFO     | test_jbb_embedding:begin_test:693 - Daniel got the football.<|eot_id|>
2025-01-22 19:51:49.588 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8134])
2025-01-22 19:51:51.802 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [865.3026315789474, 73.62471576941986, 247.11875, 71.44694597013083, 109.49190848214286], 'topk_indices': array([8115,  100, 8125, 8116,   14, 7987, 8117, 3549, 8119, 8124,  592,
       7988, 8032, 8122, 1730, 8121, 1734, 8130, 1733,    0]), 'topk_tokens': ['.\n\n', 'E', '?', 'Question', '\n', ' you', ':', ' office', ' was', ' bathroom', 'ï¿½', ' context', ' location', ' before', ' Daniel', ' football', '.', '<|start_header_id|>', ' football', '<|begin_of_text|>'], 'evidence_proportions': [2091.25, 884.4, 485.6, 245.15]}, 'weight': {'score': [22.736019736842106, 23.25796229719764, 22.4859375, 23.260615627314245, 29.568080357142858], 'topk_indices': array([3280, 3307, 3152, 3200, 7387, 7425, 1427, 1489, 4281, 4265, 5114,
       5175, 7108, 7164, 3489, 3463, 4891, 4939, 4968, 4916]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.939453125, 19.665625, 21.01875, 24.1609375]}, 'saliency': {'score': [5.31982421875, 0.4159366453877827, 1.2822916666666666, 0.4028325736507961, 0.7941491263253349], 'topk_indices': array([ 590, 8103, 2977, 7987,    0, 8119, 4715, 1731,   99, 8118,  592,
       3549, 8116, 8122, 8032, 7988, 8124, 1730, 8121, 1733]), 'topk_tokens': ['ï¿½', ' return', 'lyn', ' you', '<|begin_of_text|>', ' was', ' bathroom', ' got', 'ION', ' Where', 'ï¿½', ' office', 'Question', ' before', ' location', ' context', ' bathroom', ' Daniel', ' football', ' football'], 'evidence_proportions': [14.95703125, 4.1181640625, 2.636328125, 1.49521484375]}}, 'pred_res': 'Daniel got the football.<|eot_id|>', 'score': 0}
2025-01-22 19:51:51.809 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 19:51:51.809 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-144_pid-4_2-4-6-9.pkl | len: 3 |  size: 2.04 KB
Processing depth (2, 4, 6, 9):   5%|â–Œ         | 5/100 [02:04<34:44, 21.94s/it]Processing depth (2, 4, 6, 9):   5%|â–Œ         | 5/100 [02:04<39:27, 24.92s/it]
2025-01-22 19:51:51.871 | INFO     | __main__:<module>:82 - Selected idx: 146
2025-01-22 19:51:51.871 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the football before the kitchen? 
2025-01-22 19:51:51.871 | INFO     | __main__:<module>:84 - Answer: hallway
2025-01-22 19:51:51.872 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 19:51:51.872 | INFO     | __main__:<module>:86 - Needle: [' Daniel got the football there.', ' Mary got the milk there.', ' John moved to the hallway.', ' Daniel moved to the hallway.', ' Mary put down the milk.', ' Daniel moved to the kitchen.', ' Mary moved to the garden.']
2025-01-22 19:51:51.872 | INFO     | __main__:<module>:87 - Real Needle: [' Daniel got the football there.', ' Daniel moved to the hallway.', ' Daniel moved to the kitchen.', ' Mary moved to the garden.']
2025-01-22 19:51:51.872 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ‘©ğŸ»\u200dğŸš€', 'â›ˆï¸', 'ğŸ§ğŸ¾\u200dâ™‚', 'â›¹ğŸ¿', 'â‡', 'ğŸš¶\u200dâ™€\u200dâ¡ï¸', 'ğŸ“®', 'âœŒğŸ»', '\U0001fac4ğŸ¼', 'ğŸ¤¢']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.30s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.36s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.22s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.93s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.43s/it]
Processing depth (1, 3, 4, 7):   0%|          | 0/100 [00:15<?, ?it/s]2025-01-22 19:52:07.351 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the football there.
2025-01-22 19:52:07.355 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (781, 786) --> . Daniel got the football
2025-01-22 19:52:07.355 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the hallway.
2025-01-22 19:52:07.369 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2740, 2745) -->  Daniel moved to the hallway
2025-01-22 19:52:07.369 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the kitchen.
2025-01-22 19:52:07.382 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2741, 2746) -->  moved to the hallway.
2025-01-22 19:52:07.382 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the garden.
2025-01-22 19:52:07.414 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5599, 5604) --> . Mary moved to the
2025-01-22 19:52:07.414 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the milk there.
2025-01-22 19:52:07.445 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6417, 6422) --> . Mary got the milk
2025-01-22 19:52:07.445 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John moved to the hallway.
2025-01-22 19:52:07.458 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2741, 2746) -->  moved to the hallway.
2025-01-22 19:52:07.458 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary put down the milk.
2025-01-22 19:52:07.468 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1903, 1908) --> . Mary put down the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:52:08.343 | INFO     | test_jbb_embedding:begin_test:693 - Daniel got the football there.<|eot_id|>
2025-01-22 19:52:08.343 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8183])
2025-01-22 19:52:10.559 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [245.80078125, 21.269207717444417, 110.54010416666667, 20.553995483682982, 17.544580078125], 'topk_indices': array([8111,  100,   29,   99,  787,    9, 8170,  782, 8179, 8182,    1,
       8081, 8171,    3,   14,   24,  786,  785, 8178,    0]), 'topk_tokens': [' the', 'E', '\n\n', 'ION', '.', ':', ' football', ' Daniel', '<|start_header_id|>', '\n\n', '<|start_header_id|>', ' location', ' before', '<|end_header_id|>', '\n', '\n\n', ' there', ' football', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [520.85, 191.275, 226.275, 44.803125]}, 'weight': {'score': [22.562109375, 23.29388208526753, 21.947916666666668, 23.298154559256535, 29.492578125], 'topk_indices': array([3338, 3311, 3231, 3183, 7404, 7442, 1529, 1467, 4330, 4314, 5131,
       5192, 7101, 7157, 3520, 3494, 4933, 4908, 4956, 4985]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [23.48125, 26.0046875, 21.115625, 19.646875]}, 'saliency': {'score': [1.5540679931640624, 0.11868482226705657, 0.632745361328125, 0.11421683410562163, 0.1268220901489258], 'topk_indices': array([8080,  100,    8, 8182, 8152, 8176, 8183,  783, 2744,   99, 8165,
        287,   24, 8173, 8171, 8081, 8170,  782,  786,  785]), 'topk_tokens': [' first', 'E', ' Date', '\n\n', ' return', 'Answer', 'hall', ' got', ' hallway', 'ION', 'Question', 'hue', '\n\n', ' kitchen', ' before', ' location', ' football', ' Daniel', ' there', ' football'], 'evidence_proportions': [3.33984375, 1.34931640625, 1.3005859375, 0.22652587890625]}}, 'pred_res': 'Daniel got the football there.<|eot_id|>', 'score': 0}
2025-01-22 19:52:10.566 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 19:52:10.566 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-146_pid-0_1-3-4-7.pkl | len: 3 |  size: 2.04 KB
Processing depth (1, 3, 4, 7):   1%|          | 1/100 [00:18<30:41, 18.60s/it]is_0k: False
your chose emoji: ['ğŸ¥œ', 'ğŸ§ğŸ¼\u200dâ™€ï¸\u200dâ¡', '\U0001faf1ğŸ¿\u200d\U0001faf2ğŸ¾', 'ğŸˆº', 'ğŸ‘¯\u200dâ™‚', 'ğŸ‘©ğŸ½\u200dğŸ¨', 'ğŸ’‘ğŸ¿', 'ğŸ¤³ğŸ»', 'ğŸ‘µ', 'ğŸ‘¨ğŸ¾\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘¨ğŸ»']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.29s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.41s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.00s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:12<00:00,  2.58s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:12<00:00,  3.17s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 1, 5, 6):   1%|          | 1/100 [00:33<30:41, 18.60s/it]2025-01-22 19:52:25.065 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the football there.
2025-01-22 19:52:25.066 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  got the football there.
2025-01-22 19:52:25.066 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the hallway.
2025-01-22 19:52:25.070 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (841, 846) --> . Daniel moved to the
2025-01-22 19:52:25.070 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the kitchen.
2025-01-22 19:52:25.074 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (841, 846) --> . Daniel moved to the
2025-01-22 19:52:25.074 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the garden.
2025-01-22 19:52:25.100 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4773, 4778) --> . Mary moved to the
2025-01-22 19:52:25.100 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the milk there.
2025-01-22 19:52:25.132 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6483, 6488) --> . Mary got the milk
2025-01-22 19:52:25.132 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John moved to the hallway.
2025-01-22 19:52:25.136 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (842, 847) -->  Daniel moved to the hallway
2025-01-22 19:52:25.136 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary put down the milk.
2025-01-22 19:52:25.147 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2153, 2158) --> . Mary put down the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:52:31.879 | INFO     | test_jbb_embedding:begin_test:693 - There is no information about a football in the text.<|eot_id|>
2025-01-22 19:52:31.879 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8215])
2025-01-22 19:52:34.605 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [766.86875, 54.27772876612315, 446.575, 51.81698338017842, 39.069417317708336], 'topk_indices': array([   3, 8198, 8113, 8204, 8200, 8206,   32,  846,  185,   24,   33,
       8205,  540, 8202,  537, 8210,   34, 8203, 8211,    0]), 'topk_tokens': ['<|end_header_id|>', ':', ' location', ' the', ' was', '?', ' the', ' hallway', 'ION', '\n\n', ' football', ' kitchen', ' instead', ' football', ' an', '<|eot_id|>', ' there', ' before', '<|start_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [1639.6, 663.8, 663.8, 100.275]}, 'weight': {'score': [20.27578125, 23.327284619128744, 23.577604166666667, 23.334283919406086, 29.88037109375], 'topk_indices': array([3289, 3316, 3209, 3161, 7458, 7496, 1437, 1499, 4348, 4364, 5238,
       5177, 7235, 7179, 3472, 3498, 4954, 5031, 5002, 4979]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.6375, 19.909375, 19.909375, 19.646875]}, 'saliency': {'score': [4.102618408203125, 0.3061825271127403, 2.9146484375, 0.2921221939491553, 0.30129019419352215], 'topk_indices': array([  24, 8206, 4210, 4330,  421, 8199,   31,  423,   64, 8113,  185,
       8197,  537,   33,  846,   34, 8205,  540, 8203, 8202]), 'topk_tokens': ['\n\n', '?', ' kitchen', 'nes', ' hour', ' Where', ' got', ' instead', 'ENCES', ' location', 'ION', 'Question', ' an', ' football', ' hallway', ' there', ' kitchen', ' instead', ' before', ' football'], 'evidence_proportions': [9.41328125, 3.2490234375, 3.2490234375, 0.4991455078125]}}, 'pred_res': 'There is no information about a football in the text.<|eot_id|>', 'score': 0}
2025-01-22 19:52:34.612 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 19:52:34.612 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-146_pid-1_0-1-5-6.pkl | len: 3 |  size: 2.07 KB
Processing depth (0, 1, 5, 6):   2%|â–         | 2/100 [00:42<35:36, 21.80s/it]is_0k: False
your chose emoji: ['ğŸ¨', 'ğŸ‘©\u200dâ¤ï¸\u200dğŸ‘¨', 'ğŸ›€ğŸ¾', 'ğŸ‘¨ğŸ¾\u200dâ¤ï¸\u200dğŸ‘¨ğŸ¼', 'ğŸ…', 'ğŸƒğŸ¼\u200dâ™‚\u200dâ¡', '\U0001faf1ğŸ¼\u200d\U0001faf2ğŸ¿', 'ğŸƒğŸ¾\u200dâ™€ï¸\u200dâ¡ï¸', 'ğŸ§‘ğŸ»\u200dâ¤\u200dğŸ§‘ğŸ¿', 'ğŸ‡©ğŸ‡´']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.32s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.14s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:03,  3.96s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.84s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.30s/it]
Processing depth (1, 3, 4, 9):   2%|â–         | 2/100 [00:57<35:36, 21.80s/it]2025-01-22 19:52:49.512 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the football there.
2025-01-22 19:52:49.517 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (815, 820) --> . Daniel got the football
2025-01-22 19:52:49.517 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the hallway.
2025-01-22 19:52:49.531 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2927, 2932) --> . Daniel moved to the
2025-01-22 19:52:49.531 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the kitchen.
2025-01-22 19:52:49.548 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2927, 2932) --> . Daniel moved to the
2025-01-22 19:52:49.548 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the garden.
2025-01-22 19:52:49.588 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7215, 7220) --> . Mary moved to the
2025-01-22 19:52:49.588 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the milk there.
2025-01-22 19:52:49.623 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6461, 6466) --> . Mary got the milk
2025-01-22 19:52:49.623 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John moved to the hallway.
2025-01-22 19:52:49.638 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2928, 2933) -->  Daniel moved to the hallway
2025-01-22 19:52:49.638 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary put down the milk.
2025-01-22 19:52:49.650 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2181, 2186) --> . Mary put down the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:52:50.535 | INFO     | test_jbb_embedding:begin_test:693 - Daniel got the football there.<|eot_id|>
2025-01-22 19:52:50.535 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8171])
2025-01-22 19:52:52.750 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [421.6421875, 22.28111236848544, 209.36666666666667, 20.954966058483844, 22.5463207347973], 'topk_indices': array([  61,    9,   63,  853, 8158, 2932,  816,   24,    3,  100,   99,
        817, 8170,   14, 8166,  818, 8171,  819,    0,  820]), 'topk_tokens': ['ION', ':', 'ER', ' com', ' football', ' hallway', ' Daniel', '\n\n', '<|end_header_id|>', 'E', 'ION', ' got', '\n\n', '\n', '<|eot_id|>', ' the', 'hall', ' football', '<|begin_of_text|>', ' there'], 'evidence_proportions': [885.5, 367.7, 367.7, 65.66875]}, 'weight': {'score': [20.73671875, 23.2829015781747, 23.577604166666667, 23.28861519381988, 29.38872466216216], 'topk_indices': array([3294, 3267, 3139, 3187, 7432, 7394, 1473, 1411, 4298, 4282, 5154,
       5093, 7109, 7165, 3476, 3450, 4947, 4895, 4918, 4870]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [23.48125, 19.909375, 19.909375, 19.646875]}, 'saliency': {'score': [2.385821533203125, 0.12638354318953388, 1.3720540364583333, 0.11853567278785017, 0.1668187734243032], 'topk_indices': array([8159, 3616,   35,   24, 8170, 8153, 8161,  100,   61, 8069,  853,
        257,   99, 8158,  817,  816, 2932, 8171,  819,  820]), 'topk_tokens': [' before', ' kitchen', '-text', '\n\n', '\n\n', 'Question', ' kitchen', 'E', 'ION', ' location', ' com', 'hue', 'ION', ' football', ' got', ' Daniel', ' hallway', 'hall', ' football', ' there'], 'evidence_proportions': [5.5662109375, 1.8255859375, 1.8255859375, 0.3259033203125]}}, 'pred_res': 'Daniel got the football there.<|eot_id|>', 'score': 0}
2025-01-22 19:52:52.765 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 19:52:52.765 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-146_pid-2_1-3-4-9.pkl | len: 3 |  size: 2.0 KB
Processing depth (1, 3, 4, 9):   3%|â–         | 3/100 [01:00<32:33, 20.14s/it]is_0k: False
your chose emoji: ['ğŸŒğŸ½\u200dâ™‚', 'ğŸ™‹ğŸ¾\u200dâ™€', 'ğŸ©¹', 'ğŸ‘ğŸ¼', 'ğŸ‘©ğŸ½\u200dğŸ¤\u200dğŸ‘©ğŸ¾', 'â™¨', 'ğŸ‘‡', 'ğŸ™…ğŸ½\u200dâ™€', 'ğŸ§ğŸ»\u200dâ™‚', 'ğŸ‘¨ğŸ½\u200dğŸš€']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.27s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.68s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.39s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.02s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.55s/it]
Processing depth (2, 4, 5, 9):   3%|â–         | 3/100 [01:16<32:33, 20.14s/it]2025-01-22 19:53:08.706 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the football there.
2025-01-22 19:53:08.716 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1853, 1858) --> . Daniel got the football
2025-01-22 19:53:08.716 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the hallway.
2025-01-22 19:53:08.734 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3603, 3608) --> . Daniel moved to the
2025-01-22 19:53:08.734 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the kitchen.
2025-01-22 19:53:08.752 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3603, 3608) --> . Daniel moved to the
2025-01-22 19:53:08.752 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the garden.
2025-01-22 19:53:08.792 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7116, 7121) -->  Mary moved to the garden
2025-01-22 19:53:08.792 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the milk there.
2025-01-22 19:53:08.823 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6407, 6412) --> . Mary got the milk
2025-01-22 19:53:08.823 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John moved to the hallway.
2025-01-22 19:53:08.841 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3604, 3609) -->  Daniel moved to the hallway
2025-01-22 19:53:08.841 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary put down the milk.
2025-01-22 19:53:08.854 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2193, 2198) --> . Mary put down the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:53:09.722 | INFO     | test_jbb_embedding:begin_test:693 - Daniel got the football there.<|eot_id|>
2025-01-22 19:53:09.722 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8159])
2025-01-22 19:53:11.935 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [469.9703125, 30.217434835211957, 277.6458333333333, 28.678554125138426, 19.291877297794116], 'topk_indices': array([1856, 8149, 8153, 8057,  980, 1859, 8146,   24, 8147, 1854, 1860,
       3608, 1858, 8154, 8155, 1861, 1857, 1862, 1863,    0]), 'topk_tokens': [' the', ' kitchen', ':', ' location', ' *', '.', ' football', '\n\n', ' before', ' Daniel', ' *', ' hallway', ' there', '<|eot_id|>', '<|start_header_id|>', '      ', ' football', ' *', '      ', '<|begin_of_text|>'], 'evidence_proportions': [876.1, 455.15, 455.15, 93.48125]}, 'weight': {'score': [21.865234375, 23.281177254349423, 23.577604166666667, 23.284114679463517, 29.823988970588236], 'topk_indices': array([3287, 3314, 3207, 3159, 7406, 7444, 1417, 1479, 4314, 4298, 5151,
       5212, 7183, 7127, 3470, 3496, 4963, 4886, 4934, 4911]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [23.48125, 19.909375, 19.909375, 24.1609375]}, 'saliency': {'score': [2.6509765625, 0.17008806531027934, 1.7898111979166667, 0.160993243490064, 0.1442568161908318], 'topk_indices': array([8013,  978, 3605, 8141, 7737, 8152,  980, 1855, 8057, 8147, 1860,
       8149, 1858, 8146, 1854, 1861, 3608, 1857, 1862, 1863]), 'topk_tokens': [' context', ' *', ' moved', 'Question', 'inen', 'Answer', ' *', ' got', ' location', ' before', ' *', ' kitchen', ' there', ' football', ' Daniel', '      ', ' hallway', ' football', ' *', '      '], 'evidence_proportions': [5.581640625, 2.2427734375, 2.2427734375, 0.53671875]}}, 'pred_res': 'Daniel got the football there.<|eot_id|>', 'score': 0}
2025-01-22 19:53:11.942 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 19:53:11.943 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-146_pid-3_2-4-5-9.pkl | len: 3 |  size: 2.04 KB
Processing depth (2, 4, 5, 9):   4%|â–         | 4/100 [01:19<31:36, 19.76s/it]is_0k: False
your chose emoji: ['ğŸ¤«', 'ğŸ‹\u200dâ™‚ï¸', 'ğŸ‘©ğŸ¿\u200dâ¤\u200dğŸ‘©ğŸ¼', 'ğŸ™ğŸ¼', '\U0001faf5ğŸ¼', 'âœˆ', 'ğŸ‘©\u200dâœˆï¸', 'â›¹ï¸\u200dâ™€ï¸', 'ğŸ™ğŸ¿\u200dâ™‚', 'ğŸ§šğŸ¼']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  3.71s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.23s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.39s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.09s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.49s/it]
Processing depth (2, 3, 4, 5):   4%|â–         | 4/100 [01:35<31:36, 19.76s/it]2025-01-22 19:53:27.644 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the football there.
2025-01-22 19:53:27.653 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1999, 2004) --> . Daniel got the football
2025-01-22 19:53:27.654 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the hallway.
2025-01-22 19:53:27.669 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2966, 2971) -->  tragedy. Daniel moved to
2025-01-22 19:53:27.669 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the kitchen.
2025-01-22 19:53:27.685 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2966, 2971) -->  tragedy. Daniel moved to
2025-01-22 19:53:27.685 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the garden.
2025-01-22 19:53:27.707 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4244, 4249) -->  Mary moved to the garden
2025-01-22 19:53:27.707 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the milk there.
2025-01-22 19:53:27.740 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6463, 6468) --> . Mary got the milk
2025-01-22 19:53:27.740 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John moved to the hallway.
2025-01-22 19:53:27.755 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2968, 2973) -->  Daniel moved to the hallway
2025-01-22 19:53:27.755 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary put down the milk.
2025-01-22 19:53:27.766 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2373, 2378) --> . Mary put down the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:53:28.656 | INFO     | test_jbb_embedding:begin_test:693 - Daniel got the football there.<|eot_id|>
2025-01-22 19:53:28.656 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8165])
2025-01-22 19:53:30.870 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [436.0375, 35.170252815866796, 237.7625, 33.81082472642321, 20.026243397887324], 'topk_indices': array([8092, 8081, 8163,   24, 8061,   14, 8091, 8062, 2004, 8155, 2000,
       8053, 8152, 8153, 8093, 8063, 8160, 2003,    0, 8161]), 'topk_tokens': [' to', ' a', '<|end_header_id|>', '\n\n', ' the', '\n', ' moved', ' first', ' there', ' kitchen', ' Daniel', '.\n\n', ' football', ' before', ' the', ' location', '<|eot_id|>', ' football', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [981.1, 302.9, 302.9, 157.25]}, 'weight': {'score': [24.769140625, 23.27057572233105, 23.577604166666667, 23.26632431144719, 28.937720070422536], 'topk_indices': array([3249, 3276, 3121, 3169, 7426, 7388, 1399, 1461, 4312, 4296, 5125,
       5186, 7165, 7109, 3458, 3432, 4944, 4896, 4973, 4921]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [23.48125, 25.7171875, 25.7171875, 24.1609375]}, 'saliency': {'score': [2.67103271484375, 0.19534809885949742, 1.5704833984375, 0.18672388616881072, 0.1435882138534331], 'topk_indices': array([  24, 8083, 8019, 8065,    0, 8147, 8149, 2001, 8158, 8053, 2004,
       8062, 2972, 8091, 8153, 8155, 2000, 8152, 8063, 2003]), 'topk_tokens': ['\n\n', ' left', ' context', ' traveled', '<|begin_of_text|>', 'Question', ' Where', ' got', 'Answer', '.\n\n', ' there', ' first', ' hallway', ' moved', ' before', ' kitchen', ' Daniel', ' football', ' location', ' football'], 'evidence_proportions': [6.141015625, 1.77744140625, 1.77744140625, 0.988232421875]}}, 'pred_res': 'Daniel got the football there.<|eot_id|>', 'score': 0}
2025-01-22 19:53:30.876 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 19:53:30.876 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-146_pid-4_2-3-4-5.pkl | len: 3 |  size: 2.07 KB
Processing depth (2, 3, 4, 5):   5%|â–Œ         | 5/100 [01:38<30:48, 19.46s/it]Processing depth (2, 3, 4, 5):   5%|â–Œ         | 5/100 [01:38<31:20, 19.80s/it]
2025-01-22 19:53:30.941 | INFO     | __main__:<module>:82 - Selected idx: 148
2025-01-22 19:53:30.941 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the football before the kitchen? 
2025-01-22 19:53:30.941 | INFO     | __main__:<module>:84 - Answer: hallway
2025-01-22 19:53:30.941 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 19:53:30.941 | INFO     | __main__:<module>:86 - Needle: [' Mary got the milk there.', ' Daniel picked up the football.', ' John moved to the hallway.', ' Mary put down the milk.', ' Daniel moved to the hallway.', ' Daniel moved to the kitchen.', ' Mary moved to the garden.']
2025-01-22 19:53:30.941 | INFO     | __main__:<module>:87 - Real Needle: [' Daniel picked up the football.', ' Daniel moved to the hallway.', ' Daniel moved to the kitchen.', ' Mary moved to the garden.']
2025-01-22 19:53:30.941 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ§‘ğŸ¿\u200dâš–', 'ğŸ§™ğŸ½\u200dâ™‚', 'ğŸ‚ğŸ¿', 'ğŸŸ', 'ğŸ”¢', 'ğŸ§‘ğŸ¾\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ§‘ğŸ½', 'ğŸ‡µğŸ‡¬', 'ğŸ§œğŸ»', 'ğŸš´ğŸ¼', 'ğŸ‘°']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  3.76s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.13s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.08s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:12<00:00,  2.64s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:12<00:00,  3.15s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (2, 5, 7, 9):   0%|          | 0/100 [00:14<?, ?it/s]2025-01-22 19:53:45.381 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the football.
2025-01-22 19:53:45.390 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1803, 1808) --> . Daniel picked up the
2025-01-22 19:53:45.390 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the hallway.
2025-01-22 19:53:45.401 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2046, 2051) -->  John moved to the hallway
2025-01-22 19:53:45.401 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the kitchen.
2025-01-22 19:53:45.421 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4205, 4210) -->  moved to the hallway.
2025-01-22 19:53:45.422 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the garden.
2025-01-22 19:53:45.462 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7241, 7246) --> . Mary moved to the
2025-01-22 19:53:45.463 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the milk there.
2025-01-22 19:53:45.494 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6617, 6622) --> . Mary got the milk
2025-01-22 19:53:45.494 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John moved to the hallway.
2025-01-22 19:53:45.504 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2044, 2049) -->  cable. John moved to
2025-01-22 19:53:45.504 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary put down the milk.
2025-01-22 19:53:45.536 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5807, 5812) --> . Mary put down the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:53:48.115 | INFO     | test_jbb_embedding:begin_test:693 - The hallway.<|eot_id|>
2025-01-22 19:53:48.115 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8201])
2025-01-22 19:53:50.936 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [199.53125, 17.781682334836663, 92.39895833333334, 17.199695495164647, 17.53276422050562], 'topk_indices': array([8099, 8194, 8200,    9, 8188, 8089,    1, 8182, 8189,   23, 8184,
       8195,    3, 1808,   24,   14, 8199, 8197,    0, 8196]), 'topk_tokens': [' location', 'Answer', '\n\n', ':', ' football', '.\n\n', '<|start_header_id|>', '.\n\n', ' before', '4', ':', ':', '<|end_header_id|>', ' football', '\n\n', '\n', '<|end_header_id|>', '<|start_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [254.15, 259.475, 236.475, 48.025]}, 'weight': {'score': [22.025390625, 23.29361439541687, 22.678645833333334, 23.297848573876852, 28.835147471910112], 'topk_indices': array([3322, 3295, 3215, 3167, 7420, 7458, 1439, 1501, 4296, 4280, 5174,
       5113, 7135, 7191, 3504, 3478, 4967, 4938, 4915, 4890]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.3625, 24.9765625, 21.115625, 19.646875]}, 'saliency': {'score': [1.224151611328125, 0.09778372896176789, 0.520068359375, 0.09425066162139262, 0.1257552243350597], 'topk_indices': array([5724,    8, 8198, 8193, 8185, 8089, 8182,   23,   20, 8170,   24,
       4208, 8191, 8099, 2050, 8189, 8194, 8183, 8188, 1808]), 'topk_tokens': [' kitchen', ' Date', 'assistant', ' \n', ' Where', '.\n\n', '.\n\n', '4', ' Jul', ' return', '\n\n', ' hallway', ' kitchen', ' location', ' hallway', ' before', 'Answer', 'Question', ' football', ' football'], 'evidence_proportions': [1.4978515625, 1.7296875, 1.419873046875, 0.2491943359375]}}, 'pred_res': 'The hallway.<|eot_id|>', 'score': 100}
2025-01-22 19:53:50.947 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 19:53:50.947 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-148_pid-0_2-5-7-9.pkl | len: 3 |  size: 2.03 KB
Processing depth (2, 5, 7, 9):   1%|          | 1/100 [00:19<32:52, 19.92s/it]is_0k: False
your chose emoji: ['ğŸ§‘\u200dğŸ§’\u200dğŸ§’', 'ğŸªœ', 'ğŸ‘¨ğŸ¼\u200dğŸ¤\u200dğŸ‘¨ğŸ½', 'ğŸ‘©ğŸ¿\u200dğŸ“', 'ğŸ‘©\u200dğŸ¦°', 'ğŸ‡©ğŸ‡²', 'ğŸ‘©ğŸ»\u200dâ¤ï¸\u200dğŸ‘¨ğŸ¿', 'ğŸ™ğŸ¾', '\U0001fa88', 'ğŸ‘¨ğŸ¾\u200dğŸ¦³']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.40s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.27s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.27s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.93s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.43s/it]
Processing depth (1, 3, 8, 9):   1%|          | 1/100 [00:35<32:52, 19.92s/it]2025-01-22 19:54:06.361 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the football.
2025-01-22 19:54:06.365 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (829, 834) --> . Daniel picked up the
2025-01-22 19:54:06.365 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the hallway.
2025-01-22 19:54:06.374 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1824, 1829) -->  John moved to the hallway
2025-01-22 19:54:06.374 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the kitchen.
2025-01-22 19:54:06.387 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2593, 2598) -->  moved to the hallway.
2025-01-22 19:54:06.387 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the garden.
2025-01-22 19:54:06.421 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7116, 7121) -->  Mary moved to the garden
2025-01-22 19:54:06.421 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the milk there.
2025-01-22 19:54:06.452 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6443, 6448) --> . Mary got the milk
2025-01-22 19:54:06.452 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John moved to the hallway.
2025-01-22 19:54:06.461 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1823, 1828) --> . John moved to the
2025-01-22 19:54:06.461 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary put down the milk.
2025-01-22 19:54:06.487 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5649, 5654) --> . Mary put down the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:54:07.370 | INFO     | test_jbb_embedding:begin_test:693 - Daniel picked up the football.<|eot_id|>
2025-01-22 19:54:07.370 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8179])
2025-01-22 19:54:09.580 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [200.3453125, 19.58188324981667, 115.06666666666666, 18.96232508898981, 18.621995192307693], 'topk_indices': array([   4, 8067, 8175, 8167, 8161,    3, 8033, 8178,    9, 8077,  835,
       8162, 8166,    1,   24,   14,  834, 8177, 8174,    0]), 'topk_tokens': ['\n\n', '.\n\n', '<|start_header_id|>', ' before', 'Question', '<|end_header_id|>', ' context', '\n\n', ':', ' location', '.', ':', ' football', '<|start_header_id|>', '\n\n', '\n', ' football', '<|end_header_id|>', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [393.6, 196.375, 137.45, 73.95625]}, 'weight': {'score': [23.15390625, 23.296409038132484, 21.203125, 23.30061295568921, 29.763221153846153], 'topk_indices': array([3340, 3313, 3233, 3185, 7444, 7406, 1425, 1487, 4292, 4308, 5194,
       5133, 7183, 7127, 3522, 3496, 4987, 4880, 4958, 4905]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.3625, 24.9765625, 21.115625, 24.1609375]}, 'saliency': {'score': [1.230023193359375, 0.10933006284756172, 0.6456949869791667, 0.10559134473387444, 0.13960168300530848], 'topk_indices': array([8176, 8031,   16, 8178, 1828, 8163, 8148,    8, 6492, 8169, 8172,
         24, 8167,  830,  831, 8077, 8033, 8161, 8166,  834]), 'topk_tokens': ['assistant', ' provided', ' Date', '\n\n', ' hallway', ' Where', ' return', ' Date', ' kitchen', ' kitchen', 'Answer', '\n\n', ' before', ' Daniel', ' picked', ' location', ' context', 'Question', ' football', ' football'], 'evidence_proportions': [2.2953125, 1.371728515625, 0.799365234375, 0.4536865234375]}}, 'pred_res': 'Daniel picked up the football.<|eot_id|>', 'score': 0}
2025-01-22 19:54:09.587 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 19:54:09.587 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-148_pid-1_1-3-8-9.pkl | len: 3 |  size: 2.08 KB
Processing depth (1, 3, 8, 9):   2%|â–         | 2/100 [00:38<31:18, 19.17s/it]is_0k: False
your chose emoji: ['ğŸ§”ğŸ½\u200dâ™€ï¸', 'ğŸ‘·ğŸ»\u200dâ™‚ï¸', 'ğŸ—‘ï¸', 'ğŸ¤¾', 'ğŸ…ğŸ½', 'ğŸ§˜ğŸ½\u200dâ™€', 'ğŸ‘©ğŸ½\u200dâ¤\u200dğŸ‘¨ğŸ¼', 'ğŸ–Œï¸', 'ğŸ•‰', 'ğŸ§‘ğŸ¾\u200dâ¤ï¸\u200dğŸ§‘ğŸ¿']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.19s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.48s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.54s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.17s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.64s/it]
Processing depth (1, 3, 4, 8):   2%|â–         | 2/100 [00:54<31:18, 19.17s/it]2025-01-22 19:54:25.871 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the football.
2025-01-22 19:54:25.875 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (823, 828) --> . Daniel picked up the
2025-01-22 19:54:25.875 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the hallway.
2025-01-22 19:54:25.886 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2116, 2121) -->  John moved to the hallway
2025-01-22 19:54:25.886 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the kitchen.
2025-01-22 19:54:25.900 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2974, 2979) -->  tragedy. Daniel moved to
2025-01-22 19:54:25.900 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the garden.
2025-01-22 19:54:25.932 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6499, 6504) --> . Mary moved to the
2025-01-22 19:54:25.932 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the milk there.
2025-01-22 19:54:25.963 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6455, 6460) --> . Mary got the milk
2025-01-22 19:54:25.963 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John moved to the hallway.
2025-01-22 19:54:25.974 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2115, 2120) --> . John moved to the
2025-01-22 19:54:25.974 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary put down the milk.
2025-01-22 19:54:26.001 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5669, 5674) --> . Mary put down the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:54:26.899 | INFO     | test_jbb_embedding:begin_test:693 - Daniel picked up the football.<|eot_id|>
2025-01-22 19:54:26.899 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8157])
2025-01-22 19:54:29.140 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [201.2546875, 21.433379289215686, 107.51875, 20.831815384615386, 26.74309118470149], 'topk_indices': array([8045,    9,  824, 6112, 8140, 8147,    1, 8055, 8156,  829, 8145,
       8144,    3,   24,   14,  828, 8155, 8153, 8152,    0]), 'topk_tokens': ['.\n\n', ':', ' Daniel', 'the', ':', ' kitchen', '<|start_header_id|>', ' location', '\n\n', '.', ' before', ' football', '<|end_header_id|>', '\n\n', '\n', ' football', '<|end_header_id|>', '<|start_header_id|>', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [416.6, 229.425, 101.36875, 57.625]}, 'weight': {'score': [23.17578125, 23.276845894607842, 21.203125, 23.280923076923077, 29.633628731343283], 'topk_indices': array([3311, 3338, 3183, 3231, 7412, 7450, 1419, 1481, 4332, 4316, 5139,
       5200, 7189, 7133, 3514, 3540, 4941, 4964, 4993, 4916]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.3625, 24.9765625, 25.7171875, 19.646875]}, 'saliency': {'score': [1.2172393798828125, 0.11861743553012025, 0.5647054036458333, 0.11508958834134615, 0.19980837693854944], 'topk_indices': array([3600, 8126, 5976, 8154, 8156,  257, 7743, 8150, 6112, 8141,  825,
         24, 2120, 8139,  824, 8055, 8145, 8147, 8144,  828]), 'topk_tokens': [' kitchen', ' return', ' way', 'assistant', '\n\n', 'hue', 'inen', 'Answer', 'the', ' Where', ' picked', '\n\n', ' hallway', 'Question', ' Daniel', ' location', ' before', ' kitchen', ' football', ' football'], 'evidence_proportions': [2.44921875, 1.5521484375, 0.574267578125, 0.29332275390625]}}, 'pred_res': 'Daniel picked up the football.<|eot_id|>', 'score': 0}
2025-01-22 19:54:29.147 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 19:54:29.148 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-148_pid-2_1-3-4-8.pkl | len: 3 |  size: 2.07 KB
Processing depth (1, 3, 4, 8):   3%|â–         | 3/100 [00:58<31:16, 19.35s/it]is_0k: False
your chose emoji: ['ğŸ›', 'ğŸ‘¸ğŸ½', 'ğŸ‹ğŸ¿\u200dâ™‚ï¸', 'ğŸŸ', 'ğŸ‘©\u200dğŸš€', 'ğŸ§‘\u200dğŸŒ¾', 'ğŸ¤ğŸ¿', 'ğŸ‘©ğŸ»\u200dâ¤ï¸\u200dğŸ‘©ğŸ»', 'ğŸ§›ğŸ½\u200dâ™€', 'ğŸ˜–']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.22s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.23s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.05s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.83s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.32s/it]
Processing depth (4, 6, 8, 9):   3%|â–         | 3/100 [01:13<31:16, 19.35s/it]2025-01-22 19:54:44.106 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the football.
2025-01-22 19:54:44.126 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3622, 3627) -->  Hon. Daniel picked up
2025-01-22 19:54:44.126 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the hallway.
2025-01-22 19:54:44.137 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2036, 2041) -->  John moved to the hallway
2025-01-22 19:54:44.138 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the kitchen.
2025-01-22 19:54:44.165 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4849, 4854) --> . Daniel moved to the
2025-01-22 19:54:44.166 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the garden.
2025-01-22 19:54:44.200 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7213, 7218) --> . Mary moved to the
2025-01-22 19:54:44.201 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the milk there.
2025-01-22 19:54:44.232 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6591, 6596) --> . Mary got the milk
2025-01-22 19:54:44.232 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John moved to the hallway.
2025-01-22 19:54:44.242 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2034, 2039) -->  cable. John moved to
2025-01-22 19:54:44.242 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary put down the milk.
2025-01-22 19:54:44.270 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5731, 5736) --> . Mary put down the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:54:45.159 | INFO     | test_jbb_embedding:begin_test:693 - Daniel picked up the football.<|eot_id|>
2025-01-22 19:54:45.159 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8149])
2025-01-22 19:54:47.375 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [393.703125, 27.124934831943083, 193.44583333333333, 25.914342583466798, 20.849795386904763], 'topk_indices': array([2598, 3624, 2040, 2670,   14, 3627, 2654,   24, 2599, 4854, 2673,
       8003, 3625, 4851, 8144, 4852, 3628, 8145, 8147,    0]), 'topk_tokens': [' ne', ' Daniel', ' hallway', 'as', '\n', ' the', ',', '\n\n', 'ared', ' hallway', ' ne', ' context', ' picked', ' moved', '<|eot_id|>', ' to', ' football', '<|start_header_id|>', '<|end_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [532.325, 383.45, 582.15, 76.8875]}, 'weight': {'score': [22.92578125, 23.276400729882237, 22.678645833333334, 23.27836927898238, 30.00843253968254], 'topk_indices': array([3285, 3312, 3139, 3187, 7430, 7392, 1417, 1479, 4282, 4298, 5160,
       5099, 7163, 7107, 3468, 3494, 4876, 4901, 4953, 4924]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [27.1703125, 24.9765625, 19.909375, 19.646875]}, 'saliency': {'score': [2.413226318359375, 0.15278423335531158, 1.0865397135416666, 0.14548902898142016, 0.15859791589161706], 'topk_indices': array([2454, 2670, 4852, 8142, 6634, 8139, 2580, 2655, 2598, 2581, 8136,
       2599, 3624, 2673, 8003, 2040, 3625, 4851, 4854, 3628]), 'topk_tokens': ['      ', 'as', ' to', 'Answer', ' kitchen', ' kitchen', ' mess', ' mess', ' ne', 'engers', ' football', 'ared', ' Daniel', ' ne', ' context', ' hallway', ' picked', ' moved', ' hallway', ' football'], 'evidence_proportions': [3.6283203125, 2.6078125, 3.01552734375, 0.4012451171875]}}, 'pred_res': 'Daniel picked up the football.<|eot_id|>', 'score': 0}
2025-01-22 19:54:47.382 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 19:54:47.382 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-148_pid-3_4-6-8-9.pkl | len: 3 |  size: 2.04 KB
Processing depth (4, 6, 8, 9):   4%|â–         | 4/100 [01:16<30:15, 18.91s/it]is_0k: False
your chose emoji: ['ğŸ‘Ÿ', 'ğŸ', 'ğŸƒ\u200dâ™€ï¸\u200dâ¡', 'ğŸ‘©ğŸ¾\u200dğŸ¦²', 'ğŸ‡¸ğŸ‡¾', 'ğŸ™\u200dâ™‚ï¸', 'ğŸ§–ğŸ¼\u200dâ™€ï¸', 'ğŸ‹ğŸ½\u200dâ™€ï¸', 'â˜', 'ğŸ§˜\u200dâ™€']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.43s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.49s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.17s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.88s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.41s/it]
Processing depth (2, 4, 5, 7):   4%|â–         | 4/100 [01:31<30:15, 18.91s/it]2025-01-22 19:55:02.822 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the football.
2025-01-22 19:55:02.832 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1998, 2003) -->  cable. Daniel picked up
2025-01-22 19:55:02.832 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the hallway.
2025-01-22 19:55:02.842 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2176, 2181) -->  John moved to the hallway
2025-01-22 19:55:02.843 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the kitchen.
2025-01-22 19:55:02.861 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3707, 3712) --> . Daniel moved to the
2025-01-22 19:55:02.861 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the garden.
2025-01-22 19:55:02.888 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5581, 5586) --> . Mary moved to the
2025-01-22 19:55:02.888 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the milk there.
2025-01-22 19:55:02.919 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6487, 6492) --> . Mary got the milk
2025-01-22 19:55:02.919 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John moved to the hallway.
2025-01-22 19:55:02.929 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2175, 2180) --> . John moved to the
2025-01-22 19:55:02.929 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary put down the milk.
2025-01-22 19:55:02.956 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5635, 5640) --> . Mary put down the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:55:03.763 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's hallway.<|eot_id|>
2025-01-22 19:55:03.764 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8129])
2025-01-22 19:55:05.977 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [487.6875, 40.984859198229216, 192.05416666666667, 39.601619426948254, 36.694206957547166], 'topk_indices': array([  24, 8025, 8122, 2644, 2628, 8116,   14, 8112, 8117, 8017, 8124,
       2573, 2005, 8027, 2647, 8125, 8123, 2000, 2004,    0]), 'topk_tokens': ['\n\n', ' the', 'Answer', 'as', ',', ' football', '\n', ':', ' before', '.\n\n', '<|eot_id|>', 'ared', '.', ' location', ' ne', '<|start_header_id|>', ':', ' Daniel', ' football', '<|begin_of_text|>'], 'evidence_proportions': [810.9, 539.1, 455.0, 145.75]}, 'weight': {'score': [22.83046875, 23.2568671606001, 21.203125, 23.261725021612943, 29.78007075471698], 'topk_indices': array([3241, 3268, 3161, 3113, 7394, 7356, 1461, 1399, 4276, 4260, 5093,
       5154, 7133, 7077, 3424, 3450, 4848, 4947, 4918, 4873]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.7890625, 24.9765625, 19.909375, 19.646875]}, 'saliency': {'score': [3.0377197265625, 0.2297819318644706, 0.9806844075520833, 0.22145510797546544, 0.27511136036998823], 'topk_indices': array([ 257, 7983, 8023, 8026, 8119, 2554, 2629, 2001, 8111, 2572, 8117,
       2555, 8122, 8116, 2573, 2180, 8027, 2647, 2000, 2004]), 'topk_tokens': ['hue', ' context', ' item', ' first', ' kitchen', ' mess', ' mess', ' picked', 'Question', ' ne', ' before', 'engers', 'Answer', ' football', 'ared', ' hallway', ' location', ' ne', ' Daniel', ' football'], 'evidence_proportions': [5.3587890625, 3.719921875, 2.34765625, 0.72451171875]}}, 'pred_res': "Daniel's hallway.<|eot_id|>", 'score': 100}
2025-01-22 19:55:05.985 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 19:55:05.985 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-148_pid-4_2-4-5-7.pkl | len: 3 |  size: 2.01 KB
Processing depth (2, 4, 5, 7):   5%|â–Œ         | 5/100 [01:34<29:45, 18.80s/it]Processing depth (2, 4, 5, 7):   5%|â–Œ         | 5/100 [01:35<30:05, 19.00s/it]
2025-01-22 19:55:06.030 | INFO     | __main__:<module>:82 - Selected idx: 150
2025-01-22 19:55:06.030 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the milk before the bathroom? 
2025-01-22 19:55:06.031 | INFO     | __main__:<module>:84 - Answer: bedroom
2025-01-22 19:55:06.031 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 19:55:06.031 | INFO     | __main__:<module>:86 - Needle: [' John took the milk.', ' Sandra grabbed the milk.', ' Mary went back to the kitchen.', ' Mary went to the bathroom.', ' John journeyed to the bedroom.', ' Sandra went back to the hallway.', ' Mary travelled to the hallway.', ' Daniel went to the bedroom.', ' John travelled to the bathroom.', ' Sandra put down the milk.']
2025-01-22 19:55:06.031 | INFO     | __main__:<module>:87 - Real Needle: [' John took the milk.', ' John journeyed to the bedroom.', ' John travelled to the bathroom.', ' Sandra put down the milk.']
2025-01-22 19:55:06.031 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ”', 'ğŸ„ğŸ¼\u200dâ™€', 'ğŸ›', 'ğŸ‡¬ğŸ‡·', 'ğŸ‡²ğŸ‡´', 'ğŸ¤½ğŸ½\u200dâ™‚ï¸', 'ğŸ‘±\u200dâ™€', 'ğŸ‘©ğŸ¾', 'â™‘', 'ğŸ’†\u200dâ™‚']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.35s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.43s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.39s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.05s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.54s/it]
Processing depth (0, 2, 4, 8):   0%|          | 0/100 [00:15<?, ?it/s]2025-01-22 19:55:21.952 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John took the milk.
2025-01-22 19:55:21.990 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bedroom.
2025-01-22 19:55:22.001 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2009, 2015) -->  cable. John journeyed to
2025-01-22 19:55:22.001 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the bathroom.
2025-01-22 19:55:22.019 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3618, 3623) -->  Hon. John travelled to
2025-01-22 19:55:22.019 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra put down the milk.
2025-01-22 19:55:22.050 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6606, 6611) --> . Sandra put down the
2025-01-22 19:55:22.050 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra grabbed the milk.
2025-01-22 19:55:22.062 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2535, 2539) -->  Sandra grabbed the milk
2025-01-22 19:55:22.062 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went back to the kitchen.
2025-01-22 19:55:22.075 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2499, 2505) --> . Mary went back to the
2025-01-22 19:55:22.075 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bathroom.
2025-01-22 19:55:22.087 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2500, 2505) -->  Mary went back to the
2025-01-22 19:55:22.087 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the hallway.
2025-01-22 19:55:22.118 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6457, 6463) --> . Sandra went back to the
2025-01-22 19:55:22.118 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary travelled to the hallway.
2025-01-22 19:55:22.122 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (814, 819) --> . Mary travelled to the
2025-01-22 19:55:22.122 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel went to the bedroom.
2025-01-22 19:55:22.148 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (5430, 5435) -->  Daniel went to the bedroom
2025-01-22 19:55:22.148 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 19:55:22.148 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 19:55:22.148 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 19:55:22.148 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ™‹ğŸ¿', 'ğŸ‘©\u200dğŸ¦³', 'ğŸ§”\u200dâ™‚', 'â¸ï¸', 'ğŸ‘¨ğŸ¼\u200dâ¤\u200dğŸ’‹\u200dğŸ‘¨ğŸ¿', 'ğŸŸ«', 'ğŸ¦¹ğŸ¼\u200dâ™€ï¸', 'ğŸ’‚ğŸ»\u200dâ™€ï¸', 'ğŸ›»', 'ğŸ›']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  3.84s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:07<00:07,  3.80s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:11<00:03,  3.87s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:12<00:00,  2.79s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:12<00:00,  3.17s/it]
Processing depth (4, 5, 6, 7):   0%|          | 0/100 [00:30<?, ?it/s]2025-01-22 19:55:36.545 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John took the milk.
2025-01-22 19:55:36.564 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3598, 3602) -->  John took the milk
2025-01-22 19:55:36.564 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bedroom.
2025-01-22 19:55:36.586 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4122, 4128) --> . John journeyed to the
2025-01-22 19:55:36.586 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the bathroom.
2025-01-22 19:55:36.608 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4613, 4618) --> . John travelled to the
2025-01-22 19:55:36.608 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra put down the milk.
2025-01-22 19:55:36.637 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5559, 5564) --> . Sandra put down the
2025-01-22 19:55:36.637 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra grabbed the milk.
2025-01-22 19:55:36.650 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2493, 2497) -->  Sandra grabbed the milk
2025-01-22 19:55:36.650 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went back to the kitchen.
2025-01-22 19:55:36.664 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2399, 2405) --> . Mary went back to the
2025-01-22 19:55:36.664 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bathroom.
2025-01-22 19:55:36.678 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2400, 2405) -->  Mary went back to the
2025-01-22 19:55:36.678 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the hallway.
2025-01-22 19:55:36.715 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6427, 6433) --> . Sandra went back to the
2025-01-22 19:55:36.715 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary travelled to the hallway.
2025-01-22 19:55:36.719 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (809, 814) --> . Mary travelled to the
2025-01-22 19:55:36.719 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel went to the bedroom.
2025-01-22 19:55:36.745 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (5341, 5346) --> . Daniel went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:55:37.538 | INFO     | test_jbb_embedding:begin_test:693 - The hallway.<|eot_id|>
2025-01-22 19:55:37.538 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8156])
2025-01-22 19:55:39.751 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [329.2375, 36.08304479715652, 340.65725806451616, 34.19541656388752, 28.713336074561404], 'topk_indices': array([5346, 8140, 2496, 4618,   14, 2497,   24, 7485, 2493, 8143, 5090,
       8146, 8144, 8154, 8152, 7530, 7531, 7486, 8151,    0]), 'topk_tokens': [' bedroom', ' Where', ' milk', ' bathroom', '\n', '.', '\n\n', ' Min', ' Sandra', ' milk', ' Mary', ' bathroom', ' before', '<|end_header_id|>', '<|start_header_id|>', ' Min', 'nes', 'nes', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [407.4375, 263.7916666666667, 257.6, 416.85]}, 'weight': {'score': [21.655859375, 23.25577966049761, 22.286794354838708, 23.263430986371485, 29.087719298245613], 'topk_indices': array([3308, 3281, 3153, 3201, 7423, 7385, 1411, 1473, 4316, 4300, 5135,
       5196, 7100, 7156, 3490, 3464, 4942, 4919, 4894, 4971]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [25.212890625, 19.4140625, 19.990625, 23.165625]}, 'saliency': {'score': [1.9468505859375, 0.20312709460028802, 2.0341875630040325, 0.19182500476959485, 0.20837937739857457], 'topk_indices': array([2494, 5560, 6433, 3601, 4128, 5342, 5094, 2496,  814, 7485, 8143,
       5346, 4618, 5090, 2493, 8144, 8146, 7531, 7530, 7486]), 'topk_tokens': [' grabbed', ' Sandra', ' hallway', ' milk', ' bedroom', ' Daniel', ' bathroom', ' milk', ' hallway', ' Min', ' milk', ' bedroom', ' bathroom', ' Mary', ' Sandra', ' before', ' bathroom', 'nes', ' Min', 'nes'], 'evidence_proportions': [2.7032470703125, 1.4027506510416667, 1.3517578125, 2.58974609375]}}, 'pred_res': 'The hallway.<|eot_id|>', 'score': 0}
2025-01-22 19:55:39.759 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 19:55:39.760 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-150_pid-0_4-5-6-7.pkl | len: 3 |  size: 2.03 KB
Processing depth (4, 5, 6, 7):   1%|          | 1/100 [00:33<55:30, 33.64s/it]is_0k: False
your chose emoji: ['ğŸ‘”', 'ğŸŒ¼', 'ğŸŠğŸ¼', 'ğŸ‚', 'ğŸ§‘ğŸ¼\u200dğŸ¤', 'ğŸ‡±ğŸ‡º', 'ğŸ‚', 'ğŸƒ\u200dâ™€', 'ğŸ¥µ', 'ğŸ§‘ğŸ»\u200dâ¤\u200dğŸ§‘ğŸ½']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.55s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.28s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.09s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.87s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.37s/it]
Processing depth (0, 2, 3, 5):   1%|          | 1/100 [00:48<55:30, 33.64s/it]2025-01-22 19:55:55.134 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John took the milk.
2025-01-22 19:55:55.173 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bedroom.
2025-01-22 19:55:55.182 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1852, 1858) --> . John journeyed to the
2025-01-22 19:55:55.182 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the bathroom.
2025-01-22 19:55:55.196 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2937, 2942) --> . John travelled to the
2025-01-22 19:55:55.196 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra put down the milk.
2025-01-22 19:55:55.217 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4141, 4146) --> . Sandra put down the
2025-01-22 19:55:55.217 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra grabbed the milk.
2025-01-22 19:55:55.229 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2513, 2517) -->  Sandra grabbed the milk
2025-01-22 19:55:55.229 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went back to the kitchen.
2025-01-22 19:55:55.241 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2477, 2483) --> . Mary went back to the
2025-01-22 19:55:55.241 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bathroom.
2025-01-22 19:55:55.253 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2478, 2483) -->  Mary went back to the
2025-01-22 19:55:55.253 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the hallway.
2025-01-22 19:55:55.285 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6439, 6445) --> . Sandra went back to the
2025-01-22 19:55:55.285 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary travelled to the hallway.
2025-01-22 19:55:55.288 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (762, 767) --> . Mary travelled to the
2025-01-22 19:55:55.288 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel went to the bedroom.
2025-01-22 19:55:55.323 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (5359, 5364) --> . Daniel went to the
2025-01-22 19:55:55.323 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 19:55:55.323 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 19:55:55.323 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 19:55:55.323 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ¤·ğŸ¾\u200dâ™‚ï¸', 'ğŸ™ğŸ»\u200dâ™€', '\U0001faf5ğŸ¾', 'ğŸŒ¥ï¸', 'ğŸ‘”', 'ğŸ¦µğŸ¿', 'ğŸ¥š', 'ğŸ§\u200dâ™€', 'â›¹ğŸ¿', 'ğŸ§ğŸ¿\u200dâ™€ï¸']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.35s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.47s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.30s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.01s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.51s/it]
Processing depth (1, 5, 6, 7):   1%|          | 1/100 [01:04<55:30, 33.64s/it]2025-01-22 19:56:11.043 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John took the milk.
2025-01-22 19:56:11.048 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (834, 838) -->  John took the milk
2025-01-22 19:56:11.048 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bedroom.
2025-01-22 19:56:11.072 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4146, 4152) --> . John journeyed to the
2025-01-22 19:56:11.072 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the bathroom.
2025-01-22 19:56:11.096 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4757, 4762) -->  the senate. John travelled
2025-01-22 19:56:11.096 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra put down the milk.
2025-01-22 19:56:11.123 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5725, 5730) --> . Sandra put down the
2025-01-22 19:56:11.123 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra grabbed the milk.
2025-01-22 19:56:11.137 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2518, 2522) -->  Sandra grabbed the milk
2025-01-22 19:56:11.137 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went back to the kitchen.
2025-01-22 19:56:11.151 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2482, 2488) --> . Mary went back to the
2025-01-22 19:56:11.152 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bathroom.
2025-01-22 19:56:11.166 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2483, 2488) -->  Mary went back to the
2025-01-22 19:56:11.166 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the hallway.
2025-01-22 19:56:11.197 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6493, 6499) --> . Sandra went back to the
2025-01-22 19:56:11.197 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary travelled to the hallway.
2025-01-22 19:56:11.201 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (770, 775) -->  Mary travelled to the hallway
2025-01-22 19:56:11.201 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel went to the bedroom.
2025-01-22 19:56:11.231 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (5581, 5586) --> . Daniel went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:56:11.976 | INFO     | test_jbb_embedding:begin_test:693 - the kitchen<|eot_id|>
2025-01-22 19:56:11.976 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8160])
2025-01-22 19:56:14.189 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [187.446875, 19.176761760382213, 138.1008064516129, 18.307426497781066, 21.44978151483051], 'topk_indices': array([2518, 4152, 8048, 8142, 8149, 5319, 8144, 8143, 8141,   24, 8145,
       8147,   14, 8151, 8158, 8148, 8150, 8155,    0, 8156]), 'topk_tokens': [' Sandra', ' bedroom', '.\n\n', 'Question', ' the', '.', ' Where', ':', '.\n\n', '\n\n', ' was', ' milk', '\n', '?', '<|end_header_id|>', ' before', ' bathroom', '<|eot_id|>', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [238.375, 224.58333333333334, 120.8125, 168.775]}, 'weight': {'score': [22.837890625, 23.267437676099473, 23.269909274193548, 23.2684872719428, 29.696504237288135], 'topk_indices': array([3282, 3309, 3202, 3154, 7439, 7401, 1490, 1428, 4306, 4290, 5107,
       5168, 7178, 7122, 3507, 3481, 4932, 4961, 4909, 4884]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [25.212890625, 19.4140625, 24.71875, 23.165625]}, 'saliency': {'score': [1.12342529296875, 0.10610175702292356, 0.9107587260584677, 0.10051856708714713, 0.16613898843021715], 'topk_indices': array([  14,  771, 8153,  774, 8048,  837,   24, 8141, 4148, 8145, 5318,
       8144, 8151, 4764, 8142, 4152, 2518, 8147, 8148, 8150]), 'topk_tokens': ['\n', ' travelled', 'Answer', ' hallway', '.\n\n', ' milk', '\n\n', '.\n\n', ' journey', ' was', ' bathroom', ' Where', '?', ' bathroom', 'Question', ' bedroom', ' Sandra', ' milk', ' before', ' bathroom'], 'evidence_proportions': [1.562255859375, 1.1833902994791667, 0.76806640625, 1.05576171875]}}, 'pred_res': 'the kitchen<|eot_id|>', 'score': 0}
2025-01-22 19:56:14.197 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 19:56:14.198 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-150_pid-1_1-5-6-7.pkl | len: 3 |  size: 2.01 KB
Processing depth (1, 5, 6, 7):   2%|â–         | 2/100 [01:08<55:42, 34.11s/it]is_0k: False
your chose emoji: ['ğŸ§‘\u200dâš•ï¸', 'ğŸš»', 'ğŸƒğŸ»\u200dâ¡ï¸', 'ğŸ‘”', 'ğŸ™‡ğŸ¼\u200dâ™‚', 'ğŸ§šğŸ¾\u200dâ™‚', 'âœ‚ï¸', 'ğŸ’…ğŸ¾', 'ğŸ§™', 'ğŸ¤¼\u200dâ™€ï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  3.96s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.18s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.14s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.92s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.36s/it]
Processing depth (2, 5, 7, 8):   2%|â–         | 2/100 [01:23<55:42, 34.11s/it]2025-01-22 19:56:29.481 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John took the milk.
2025-01-22 19:56:29.491 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1754, 1758) -->  John took the milk
2025-01-22 19:56:29.491 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bedroom.
2025-01-22 19:56:29.512 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4152, 4158) --> . John journeyed to the
2025-01-22 19:56:29.512 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the bathroom.
2025-01-22 19:56:29.539 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5631, 5636) --> . John travelled to the
2025-01-22 19:56:29.539 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra put down the milk.
2025-01-22 19:56:29.573 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6558, 6563) --> . Sandra put down the
2025-01-22 19:56:29.573 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra grabbed the milk.
2025-01-22 19:56:29.585 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2246, 2250) -->  Sandra grabbed the milk
2025-01-22 19:56:29.585 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went back to the kitchen.
2025-01-22 19:56:29.596 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2164, 2170) --> . Mary went back to the
2025-01-22 19:56:29.597 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bathroom.
2025-01-22 19:56:29.608 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2165, 2170) -->  Mary went back to the
2025-01-22 19:56:29.608 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the hallway.
2025-01-22 19:56:29.644 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6469, 6475) --> . Sandra went back to the
2025-01-22 19:56:29.644 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary travelled to the hallway.
2025-01-22 19:56:29.648 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (809, 814) --> . Mary travelled to the
2025-01-22 19:56:29.648 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel went to the bedroom.
2025-01-22 19:56:29.674 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (5453, 5458) --> . Daniel went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:56:30.463 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 19:56:30.463 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8182])
2025-01-22 19:56:32.722 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [162.325, 18.770666615760536, 150.29637096774192, 17.916427188345217, 17.530161830357144], 'topk_indices': array([8164, 8166,  814, 8165, 8163, 5129, 4158,    3, 8171, 5128, 8169,
       8173, 8167,   24,   14, 8180, 8170, 8172, 8177,    0]), 'topk_tokens': ['Question', ' Where', ' hallway', ':', '.\n\n', '.', ' bedroom', '<|end_header_id|>', ' the', ' bathroom', ' milk', '?', ' was', '\n\n', '\n', '<|end_header_id|>', ' before', ' bathroom', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [196.96875, 206.79166666666666, 139.4375, 104.1375]}, 'weight': {'score': [21.655859375, 23.287881795968236, 22.286794354838708, 23.295709944369314, 29.881473214285716], 'topk_indices': array([3333, 3306, 3226, 3178, 7473, 7435, 1501, 1439, 4324, 4340, 5218,
       5157, 7212, 7156, 3489, 3515, 4976, 5005, 4953, 4928]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [25.212890625, 19.4140625, 19.990625, 23.165625]}, 'saliency': {'score': [0.904803466796875, 0.1049610955873931, 0.8928065146169355, 0.09999182396038235, 0.12760816301618302], 'topk_indices': array([  14, 2170, 4154, 8080, 6475, 8163, 2246,  811,   24, 8173, 8167,
       8166, 5636, 8164, 8169, 4158,  814, 5128, 8170, 8172]), 'topk_tokens': ['\n', ' kitchen', ' journey', ' location', ' hallway', '.\n\n', ' Sandra', ' travelled', '\n\n', '?', ' was', ' Where', ' bathroom', 'Question', ' milk', ' bedroom', ' hallway', ' bathroom', ' before', ' bathroom'], 'evidence_proportions': [1.29541015625, 1.0568033854166667, 0.706591796875, 0.6081298828125]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 0}
2025-01-22 19:56:32.729 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 19:56:32.730 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-150_pid-2_2-5-7-8.pkl | len: 3 |  size: 2.03 KB
Processing depth (2, 5, 7, 8):   3%|â–         | 3/100 [01:26<43:38, 27.00s/it]is_0k: False
your chose emoji: ['ğŸŒï¸\u200dâ™‚ï¸', 'ğŸ§ğŸ¾\u200dâ™‚ï¸', 'ğŸ‡¹ğŸ‡²', 'â›¹ï¸\u200dâ™€', 'â¯', '\U0001fac5ğŸ¾', 'ğŸ§‘ğŸ¾\u200dğŸ­', 'ğŸ—ï¸', 'ğŸ‘©ğŸ»\u200dğŸ¦½\u200dâ¡ï¸', 'ğŸ©¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  3.90s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.15s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.11s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.89s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.33s/it]
Processing depth (1, 6, 8, 9):   3%|â–         | 3/100 [01:41<43:38, 27.00s/it]2025-01-22 19:56:47.777 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John took the milk.
2025-01-22 19:56:47.782 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (902, 906) -->  John took the milk
2025-01-22 19:56:47.782 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bedroom.
2025-01-22 19:56:47.805 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4692, 4698) --> . John journeyed to the
2025-01-22 19:56:47.805 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the bathroom.
2025-01-22 19:56:47.843 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6514, 6519) --> . John travelled to the
2025-01-22 19:56:47.843 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra put down the milk.
2025-01-22 19:56:47.878 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7210, 7215) --> . Sandra put down the
2025-01-22 19:56:47.878 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra grabbed the milk.
2025-01-22 19:56:47.891 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2408, 2412) -->  Sandra grabbed the milk
2025-01-22 19:56:47.891 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went back to the kitchen.
2025-01-22 19:56:47.903 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2202, 2208) --> . Mary went back to the
2025-01-22 19:56:47.903 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bathroom.
2025-01-22 19:56:47.914 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2203, 2208) -->  Mary went back to the
2025-01-22 19:56:47.914 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the hallway.
2025-01-22 19:56:47.948 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6425, 6431) --> . Sandra went back to the
2025-01-22 19:56:47.948 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary travelled to the hallway.
2025-01-22 19:56:47.952 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (809, 814) --> . Mary travelled to the
2025-01-22 19:56:47.953 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel went to the bedroom.
2025-01-22 19:56:47.978 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (5345, 5350) --> . Daniel went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:56:48.758 | INFO     | test_jbb_embedding:begin_test:693 - The hallway.<|eot_id|>
2025-01-22 19:56:48.758 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8172])
2025-01-22 19:56:50.970 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [405.28125, 46.7999503058104, 381.31048387096774, 44.64098273633678, 62.22451923076923], 'topk_indices': array([8157, 8155, 8154, 7547, 2411, 5723,  814, 3492,  815, 8170,  909,
       8159,  906,  905, 8162, 8160, 5724, 8168, 8167,    0]), 'topk_tokens': [' was', ':', 'Question', 'nes', ' milk', 'nes', ' hallway', ' Ramsey', '.', '<|end_header_id|>', 'ï¿½', ' milk', '.', ' milk', ' bathroom', ' before', 'ot', '<|start_header_id|>', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [808.875, 303.5208333333333, 254.3, 355.5]}, 'weight': {'score': [21.655859375, 23.282324159021407, 22.286794354838708, 23.290127054098967, 30.03918269230769], 'topk_indices': array([3299, 3272, 3144, 3192, 7427, 7389, 1488, 1426, 4295, 4279, 5200,
       5139, 7104, 7160, 3481, 3455, 4906, 4954, 4931, 4983]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [25.212890625, 19.4140625, 19.990625, 23.165625]}, 'saliency': {'score': [2.3584716796875, 0.265593732081422, 2.356319304435484, 0.2524634943050683, 0.4534954364483173], 'topk_indices': array([7215,  909, 5106, 4698, 7502, 7546,  907, 7547,  811, 5723, 2411,
       8154, 3492, 2408, 8159, 5724,  814, 8160,  905, 8162]), 'topk_tokens': [' milk', 'ï¿½', ' bathroom', ' bedroom', 'nes', ' Min', 'ï¿½', 'nes', ' travelled', 'nes', ' milk', 'Question', ' Ramsey', ' Sandra', ' milk', 'ot', ' hallway', ' before', ' milk', ' bathroom'], 'evidence_proportions': [5.27197265625, 1.5337727864583333, 1.31533203125, 2.06044921875]}}, 'pred_res': 'The hallway.<|eot_id|>', 'score': 0}
2025-01-22 19:56:50.977 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 19:56:50.977 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-150_pid-3_1-6-8-9.pkl | len: 3 |  size: 2.01 KB
Processing depth (1, 6, 8, 9):   4%|â–         | 4/100 [01:44<37:40, 23.54s/it]is_0k: False
your chose emoji: ['ğŸ¥»', 'ğŸ›€ğŸ¾', 'â¤', 'ğŸŒğŸ¼', 'ğŸ˜©', 'ğŸ‹ğŸ½\u200dâ™€', 'ğŸ‹\u200dâ™‚', 'ğŸ¤‘', 'ğŸ‘©ğŸ»\u200dâ¤ï¸\u200dğŸ‘©ğŸ½', 'ğŸ‘©ğŸ¼\u200dâ¤\u200dğŸ‘©ğŸ¾']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:10,  3.65s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.12s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.20s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.93s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.34s/it]
Processing depth (1, 3, 4, 6):   4%|â–         | 4/100 [01:59<37:40, 23.54s/it]2025-01-22 19:57:06.093 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John took the milk.
2025-01-22 19:57:06.098 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (836, 840) -->  John took the milk
2025-01-22 19:57:06.098 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bedroom.
2025-01-22 19:57:06.113 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2944, 2950) --> . John journeyed to the
2025-01-22 19:57:06.113 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the bathroom.
2025-01-22 19:57:06.131 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3615, 3620) --> . John travelled to the
2025-01-22 19:57:06.131 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra put down the milk.
2025-01-22 19:57:06.154 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4727, 4732) --> . Sandra put down the
2025-01-22 19:57:06.154 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra grabbed the milk.
2025-01-22 19:57:06.167 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2472, 2476) -->  Sandra grabbed the milk
2025-01-22 19:57:06.167 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went back to the kitchen.
2025-01-22 19:57:06.179 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2266, 2272) --> . Mary went back to the
2025-01-22 19:57:06.179 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bathroom.
2025-01-22 19:57:06.190 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2267, 2272) -->  Mary went back to the
2025-01-22 19:57:06.190 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the hallway.
2025-01-22 19:57:06.229 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6561, 6567) --> . Sandra went back to the
2025-01-22 19:57:06.230 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary travelled to the hallway.
2025-01-22 19:57:06.235 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (771, 776) --> . Mary travelled to the
2025-01-22 19:57:06.235 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel went to the bedroom.
2025-01-22 19:57:06.264 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (5533, 5538) --> . Daniel went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:57:07.053 | INFO     | test_jbb_embedding:begin_test:693 - the hallway<|eot_id|>
2025-01-22 19:57:07.053 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8248])
2025-01-22 19:57:09.291 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [206.20625, 23.650832096109564, 149.35887096774192, 22.73033727134146, 18.14506219660194], 'topk_indices': array([8237,   24,    9, 8229, 8097, 8136, 8230, 8231, 8234, 8232, 8233,
       8246, 8239,   14, 8238, 8235, 8236,    0, 8243, 8244]), 'topk_tokens': [' the', '\n\n', ':', '.\n\n', '\n', '.\n\n', 'Question', ':', ' the', ' Where', ' was', '<|end_header_id|>', '?', '\n', ' bathroom', ' milk', ' before', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [330.875, 193.53125, 205.425, 122.4625]}, 'weight': {'score': [21.655859375, 23.339621712519694, 22.286794354838708, 23.347708650914633, 29.84132281553398], 'topk_indices': array([3392, 3365, 3237, 3285, 7491, 7529, 1430, 1492, 4414, 4430, 5237,
       5298, 7252, 7196, 3606, 3580, 5056, 5085, 5033, 5008]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [25.212890625, 19.4140625, 19.990625, 23.165625]}, 'saliency': {'score': [1.1671630859375, 0.13047566204096472, 0.9420717300907258, 0.12487892709127286, 0.13249532458851637], 'topk_indices': array([  14, 8229, 5204, 8240, 8102, 8136, 5208, 8241, 2472,  839,  776,
       3620, 2950, 8233, 8239, 8230, 8232, 8235, 8236, 8238]), 'topk_tokens': ['\n', '.\n\n', ' Mary', ' \n', ' context', '.\n\n', ' bathroom', 'Answer', ' Sandra', ' milk', ' hallway', ' bathroom', ' bedroom', ' was', '?', 'Question', ' Where', ' milk', ' before', ' bathroom'], 'evidence_proportions': [2.1737060546875, 0.9570719401041666, 1.039208984375, 0.7419921875]}}, 'pred_res': 'the hallway<|eot_id|>', 'score': 0}
2025-01-22 19:57:09.299 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 19:57:09.299 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-150_pid-4_1-3-4-6.pkl | len: 3 |  size: 1.99 KB
Processing depth (1, 3, 4, 6):   5%|â–Œ         | 5/100 [02:03<34:17, 21.66s/it]Processing depth (1, 3, 4, 6):   5%|â–Œ         | 5/100 [02:03<39:03, 24.66s/it]
2025-01-22 19:57:09.441 | INFO     | __main__:<module>:82 - Selected idx: 152
2025-01-22 19:57:09.441 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the milk before the bathroom? 
2025-01-22 19:57:09.441 | INFO     | __main__:<module>:84 - Answer: bedroom
2025-01-22 19:57:09.441 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 19:57:09.441 | INFO     | __main__:<module>:86 - Needle: [' Daniel went to the bedroom.', ' Mary went back to the kitchen.', ' Sandra went back to the hallway.', ' John picked up the milk.', ' Mary went to the bathroom.', ' Sandra put down the milk.', ' Sandra grabbed the milk.', ' John journeyed to the bedroom.', ' Mary travelled to the hallway.', ' John travelled to the bathroom.', ' Sandra moved to the garden.']
2025-01-22 19:57:09.441 | INFO     | __main__:<module>:87 - Real Needle: [' John picked up the milk.', ' John journeyed to the bedroom.', ' John travelled to the bathroom.', ' Sandra moved to the garden.']
2025-01-22 19:57:09.441 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ‘©ğŸ»\u200dâ¤ï¸\u200dğŸ‘©ğŸ½', 'ğŸ’†ğŸ¿\u200dâ™€ï¸', 'ğŸ™ğŸ¾', 'ğŸ•µ\u200dâ™€ï¸', 'ğŸ§‘ğŸ¼\u200dâ¤ï¸\u200dğŸ§‘ğŸ¿', 'ğŸ‹ğŸ¾\u200dâ™‚ï¸', 'ğŸ”œ', 'ğŸ‘¨ğŸ¾\u200dğŸ¤\u200dğŸ‘¨ğŸ»', 'ğŸ‘©ğŸ¼\u200dâ¤ï¸\u200dğŸ‘¨ğŸ¿', '2ï¸âƒ£']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  3.86s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:07<00:08,  4.02s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:11<00:03,  3.83s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:12<00:00,  2.48s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:12<00:00,  3.00s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (2, 4, 7, 9):   0%|          | 0/100 [00:13<?, ?it/s]2025-01-22 19:57:23.546 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John picked up the milk.
2025-01-22 19:57:23.555 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1791, 1796) --> . John picked up the
2025-01-22 19:57:23.555 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bedroom.
2025-01-22 19:57:23.573 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3534, 3540) --> . John journeyed to the
2025-01-22 19:57:23.573 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the bathroom.
2025-01-22 19:57:23.599 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5499, 5504) --> . John travelled to the
2025-01-22 19:57:23.599 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra moved to the garden.
2025-01-22 19:57:23.634 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7162, 7167) -->  Sandra moved to the garden
2025-01-22 19:57:23.634 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went to the bedroom.
2025-01-22 19:57:23.657 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4779, 4784) --> . Daniel went to the
2025-01-22 19:57:23.657 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went back to the kitchen.
2025-01-22 19:57:23.670 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2544, 2550) -->  Mary went back to the kitchen
2025-01-22 19:57:23.670 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the hallway.
2025-01-22 19:57:23.704 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6295, 6301) --> . Sandra went back to the
2025-01-22 19:57:23.704 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary went to the bathroom.
2025-01-22 19:57:23.728 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4839, 4844) -->  the senate. Mary went
2025-01-22 19:57:23.728 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra put down the milk.
2025-01-22 19:57:23.733 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1061, 1066) --> . Sandra put down the
2025-01-22 19:57:23.733 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra grabbed the milk.
2025-01-22 19:57:23.767 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (7125, 7129) -->  Sandra grabbed the milk
2025-01-22 19:57:23.767 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Mary travelled to the hallway.
2025-01-22 19:57:23.782 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (3162, 3167) --> . Mary travelled to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:57:27.466 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 19:57:27.467 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8205])
2025-01-22 19:57:30.377 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [144.3407738095238, 23.7575459917154, 256.171875, 22.42038936940253, 24.001026642628204], 'topk_indices': array([4784, 4843, 3540, 2632, 2706,    4, 8103, 1067, 8093, 4783, 8193,
          9,   24, 4844, 8195, 8203, 4845,   14, 8200,    0]), 'topk_tokens': [' bedroom', ' went', ' bedroom', 'ared', ' ne', '\n\n', ' location', '.', '.\n\n', ' the', ' before', ':', '\n\n', ' to', ' bathroom', '<|end_header_id|>', ' the', '\n', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [169.2, 192.41666666666666, 140.8625, 65.26875]}, 'weight': {'score': [21.47061011904762, 23.296536153752438, 23.2421875, 23.301480454852165, 29.64142628205128], 'topk_indices': array([3389, 3362, 3234, 3282, 7490, 7452, 1427, 1489, 4366, 4382, 5264,
       5203, 7173, 7229, 3584, 3558, 4966, 5043, 5014, 4991]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.334375, 19.4140625, 19.990625, 25.5546875]}, 'saliency': {'score': [0.7809767950148809, 0.13137725175705106, 1.5021701388888888, 0.12364934912606582, 0.18024503267728365], 'topk_indices': array([  14,   24, 2688, 4781, 8192, 4780, 4843, 1066, 2632, 1062, 3167,
       2614, 2706, 8103, 8193, 5504, 3540, 4784, 4846, 8195]), 'topk_tokens': ['\n', '\n\n', ' mess', ' went', ' milk', ' Daniel', ' went', ' milk', 'ared', ' Sandra', ' hallway', 'engers', ' ne', ' location', ' before', ' bathroom', ' bedroom', ' bedroom', ' bathroom', ' bathroom'], 'evidence_proportions': [0.97138671875, 0.97509765625, 0.744677734375, 0.3939208984375]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 0}
2025-01-22 19:57:30.384 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 19:57:30.384 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-152_pid-0_2-4-7-9.pkl | len: 3 |  size: 2.0 KB
Processing depth (2, 4, 7, 9):   1%|          | 1/100 [00:20<34:24, 20.85s/it]is_0k: False
your chose emoji: ['ğŸƒ\u200dâ™‚ï¸\u200dâ¡ï¸', 'ğŸŒ\u200dâ™‚ï¸', 'ğŸ¥', 'â¬œ', 'ğŸ§šğŸ¼\u200dâ™€', 'ğŸŒğŸ¼', 'ğŸ—¾', 'ğŸ‘¨ğŸ»\u200dğŸ¦¼\u200dâ¡ï¸', 'ğŸ‘¨ğŸ»\u200dğŸ¤\u200dğŸ‘¨ğŸ½', '\U0001faf7ğŸ¿']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.54s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.34s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.03s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.79s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.32s/it]
Processing depth (0, 2, 7, 9):   1%|          | 1/100 [00:35<34:24, 20.85s/it]2025-01-22 19:57:45.468 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John picked up the milk.
2025-01-22 19:57:45.468 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the milk.
2025-01-22 19:57:45.468 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bedroom.
2025-01-22 19:57:45.477 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1793, 1799) --> . John journeyed to the
2025-01-22 19:57:45.477 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the bathroom.
2025-01-22 19:57:45.504 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5583, 5588) --> . John travelled to the
2025-01-22 19:57:45.504 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra moved to the garden.
2025-01-22 19:57:45.538 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7138, 7143) -->  Sandra moved to the garden
2025-01-22 19:57:45.538 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went to the bedroom.
2025-01-22 19:57:45.561 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4779, 4784) -->  the senate. Daniel went
2025-01-22 19:57:45.561 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went back to the kitchen.
2025-01-22 19:57:45.573 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2538, 2544) --> . Mary went back to the
2025-01-22 19:57:45.573 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the hallway.
2025-01-22 19:57:45.606 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6325, 6331) --> . Sandra went back to the
2025-01-22 19:57:45.606 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary went to the bathroom.
2025-01-22 19:57:45.618 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2539, 2544) -->  Mary went back to the
2025-01-22 19:57:45.618 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra put down the milk.
2025-01-22 19:57:45.624 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1113, 1118) --> . Sandra put down the
2025-01-22 19:57:45.624 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra grabbed the milk.
2025-01-22 19:57:45.657 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (7101, 7105) -->  Sandra grabbed the milk
2025-01-22 19:57:45.657 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Mary travelled to the hallway.
2025-01-22 19:57:45.672 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (3236, 3241) -->  Mary travelled to the hallway
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:57:46.457 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 19:57:46.458 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8175])
2025-01-22 19:57:48.701 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [320.36011904761904, 29.919773324773782, 242.01128472222223, 28.2285355867504, 12.355282738095237], 'topk_indices': array([ 111, 2540,   14,  165, 2539,  112,   68,  184,   69,   24,  181,
         35,  106,  105,   67, 8170, 8171, 1799,  185,    0]), 'topk_tokens': ['.', ' went', '\n', 'ION', ' Mary', ' PA', 'E', ' P', 'ER', '\n\n', 'G', '.', 'E', 'ION', 'ION', '<|eot_id|>', '<|start_header_id|>', ' bedroom', 'ION', '<|begin_of_text|>'], 'evidence_proportions': [577.55, 418.2708333333333, 125.3875, 140.65]}, 'weight': {'score': [21.635044642857142, 23.2676349657618, 23.912109375, 23.268999738332717, 29.258184523809526], 'topk_indices': array([3328, 3301, 3209, 3161, 7466, 7428, 1485, 1423, 4302, 4318, 5196,
       5135, 7149, 7205, 3496, 3522, 4960, 4912, 4989, 4937]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.025, 19.4140625, 19.990625, 25.5546875]}, 'saliency': {'score': [1.6858375186011905, 0.16855087522831835, 1.5659840901692708, 0.15843258742525165, 0.08927832709418403], 'topk_indices': array([1152,   74,  184,   68,   69, 2540,    0,  181,  165,   34, 8165,
       1795,  106, 1114,  112, 2539,  105,   67,  185, 1799]), 'topk_tokens': ['nes', ' PA', ' P', 'E', 'ER', ' went', '<|begin_of_text|>', 'G', 'ION', ' milk', ' bathroom', ' journey', 'E', ' Sandra', ' PA', ' Mary', 'ION', 'ION', 'ION', ' bedroom'], 'evidence_proportions': [3.0109375, 2.0878499348958335, 0.705029296875, 0.859130859375]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 0}
2025-01-22 19:57:48.728 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 19:57:48.728 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-152_pid-1_0-2-7-9.pkl | len: 3 |  size: 1.94 KB
Processing depth (0, 2, 7, 9):   2%|â–         | 2/100 [00:39<31:38, 19.38s/it]is_0k: False
your chose emoji: ['ğŸ‘¨\u200dğŸ¨', 'ğŸ¤µğŸ¼\u200dâ™‚ï¸', 'ğŸŒ®', 'ğŸ§‘ğŸ¼', 'âœğŸ»', 'ğŸ‘©ğŸ½\u200dâ¤\u200dğŸ‘¨ğŸ¼', 'ğŸ§•ğŸ½', 'ğŸ“¹', 'ğŸ™‚\u200dâ†”', 'ğŸ”•']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.56s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.76s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.28s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  2.98s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.54s/it]
Processing depth (0, 1, 4, 5):   2%|â–         | 2/100 [00:55<31:38, 19.38s/it]2025-01-22 19:58:04.623 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John picked up the milk.
2025-01-22 19:58:04.624 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the milk.
2025-01-22 19:58:04.624 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bedroom.
2025-01-22 19:58:04.628 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (901, 907) --> . John journeyed to the
2025-01-22 19:58:04.628 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the bathroom.
2025-01-22 19:58:04.646 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3633, 3638) --> . John travelled to the
2025-01-22 19:58:04.646 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra moved to the garden.
2025-01-22 19:58:04.667 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4232, 4237) -->  Sandra moved to the garden
2025-01-22 19:58:04.667 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went to the bedroom.
2025-01-22 19:58:04.690 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4845, 4850) -->  the senate. Daniel went
2025-01-22 19:58:04.690 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went back to the kitchen.
2025-01-22 19:58:04.703 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2562, 2568) --> . Mary went back to the
2025-01-22 19:58:04.703 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the hallway.
2025-01-22 19:58:04.735 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6367, 6373) --> . Sandra went back to the
2025-01-22 19:58:04.735 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary went to the bathroom.
2025-01-22 19:58:04.747 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2563, 2568) -->  Mary went back to the
2025-01-22 19:58:04.747 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra put down the milk.
2025-01-22 19:58:04.753 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1227, 1232) -->  Republican. Sandra put down
2025-01-22 19:58:04.753 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra grabbed the milk.
2025-01-22 19:58:04.787 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (7135, 7139) -->  Sandra grabbed the milk
2025-01-22 19:58:04.787 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Mary travelled to the hallway.
2025-01-22 19:58:04.803 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (3281, 3286) --> . Mary travelled to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:58:05.573 | INFO     | test_jbb_embedding:begin_test:693 - the kitchen<|eot_id|>
2025-01-22 19:58:05.573 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8201])
2025-01-22 19:58:07.810 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [331.9375, 35.31262189176012, 207.05034722222223, 33.78915551736836, 14.082905016447368], 'topk_indices': array([8199, 7383,  112,   14, 7384, 8196,   67,  166,   35,   24, 7432,
        106,  165,  105,  181,  907,  184, 8197,  185,    0]), 'topk_tokens': ['<|end_header_id|>', ' tele', ' PA', '\n', 'graph', '<|eot_id|>', 'ION', 'E', '.', '\n\n', ' tele', 'E', 'ION', 'ION', 'G', ' bedroom', ' P', '<|start_header_id|>', 'ION', '<|begin_of_text|>'], 'evidence_proportions': [597.9, 437.5, 147.125, 124.1125]}, 'weight': {'score': [21.635044642857142, 23.28909106838128, 23.73849826388889, 23.291368755370076, 29.39144736842105], 'topk_indices': array([3317, 3344, 3163, 3211, 7456, 7494, 1480, 1418, 4308, 4324, 5274,
       5213, 7177, 7233, 3500, 3526, 5015, 4990, 5067, 5038]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.025, 19.4140625, 19.990625, 25.5546875]}, 'saliency': {'score': [1.7327357700892858, 0.20040987294688567, 1.2765401204427083, 0.19170488549753745, 0.10291089509662829], 'topk_indices': array([1233,  166,  903,  180,   38,   34, 8191,  106,  112, 1229,   67,
        181,  184, 7383, 7384,  165,  105, 7432,  907,  185]), 'topk_tokens': [' milk', 'E', ' journey', 'UG', '***', ' milk', ' bathroom', 'E', ' PA', ' Sandra', 'ION', 'G', ' P', ' tele', 'graph', 'ION', 'ION', ' tele', ' bedroom', 'ION'], 'evidence_proportions': [3.165234375, 2.1173502604166665, 0.746337890625, 0.82509765625]}}, 'pred_res': 'the kitchen<|eot_id|>', 'score': 0}
2025-01-22 19:58:07.817 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 19:58:07.817 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-152_pid-2_0-1-4-5.pkl | len: 3 |  size: 1.95 KB
Processing depth (0, 1, 4, 5):   3%|â–         | 3/100 [00:58<31:06, 19.24s/it]is_0k: False
your chose emoji: ['â˜‚', 'â›±', 'ğŸ‡¹ğŸ‡¹', 'ğŸ‘”', 'ğŸ‘¨\u200dğŸ‘©\u200dğŸ‘¦\u200dğŸ‘¦', 'ğŸ‘¨ğŸ»\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘¨ğŸ¼', 'ğŸ‘¨ğŸ»\u200dğŸ¤', 'ğŸ‡»ğŸ‡®', 'ğŸ§šğŸ¼\u200dâ™‚ï¸', 'â™‹']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  3.81s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.30s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.15s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:12<00:00,  2.68s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:12<00:00,  3.21s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (3, 4, 5, 6):   3%|â–         | 3/100 [01:12<31:06, 19.24s/it]2025-01-22 19:58:22.405 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John picked up the milk.
2025-01-22 19:58:22.419 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2894, 2899) --> . John picked up the
2025-01-22 19:58:22.419 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bedroom.
2025-01-22 19:58:22.437 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3624, 3630) --> . John journeyed to the
2025-01-22 19:58:22.437 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the bathroom.
2025-01-22 19:58:22.460 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4175, 4180) --> . John travelled to the
2025-01-22 19:58:22.460 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra moved to the garden.
2025-01-22 19:58:22.488 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4737, 4742) --> . Sandra moved to the
2025-01-22 19:58:22.488 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went to the bedroom.
2025-01-22 19:58:22.514 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4897, 4902) --> . Daniel went to the
2025-01-22 19:58:22.514 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went back to the kitchen.
2025-01-22 19:58:22.527 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2533, 2539) --> . Mary went back to the
2025-01-22 19:58:22.527 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the hallway.
2025-01-22 19:58:22.565 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6329, 6335) --> . Sandra went back to the
2025-01-22 19:58:22.565 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary went to the bathroom.
2025-01-22 19:58:22.579 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2534, 2539) -->  Mary went back to the
2025-01-22 19:58:22.579 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra put down the milk.
2025-01-22 19:58:22.584 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1073, 1078) --> . Sandra put down the
2025-01-22 19:58:22.584 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra grabbed the milk.
2025-01-22 19:58:22.621 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (7095, 7099) -->  Sandra grabbed the milk
2025-01-22 19:58:22.621 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Mary travelled to the hallway.
2025-01-22 19:58:22.637 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (3242, 3247) --> . Mary travelled to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:58:26.277 | INFO     | test_jbb_embedding:begin_test:693 - The hallway.<|eot_id|>
2025-01-22 19:58:26.278 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8169])
2025-01-22 19:58:29.122 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [198.78571428571428, 23.92744852851199, 208.3515625, 22.656802603203943, 17.535611979166667], 'topk_indices': array([2534,    3,    4, 8057,    9, 8067, 8156, 8023, 1079, 4180, 7637,
       8159,   24, 8157,   14, 8167, 3630, 8165,    0, 8164]), 'topk_tokens': [' Mary', '<|end_header_id|>', '\n\n', '.\n\n', ':', ' location', ' milk', ' context', '.', ' bathroom', ' or', ' bathroom', '\n\n', ' before', '\n', '<|end_header_id|>', ' bedroom', '<|start_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [199.625, 286.0, 193.475, 98.6]}, 'weight': {'score': [20.395833333333332, 23.26322733113069, 22.408854166666668, 23.27443776956254, 29.2765625], 'topk_indices': array([3308, 3335, 3222, 3174, 7416, 7454, 1501, 1439, 4318, 4334, 5214,
       5153, 7137, 7193, 3517, 3491, 4978, 4949, 5007, 4924]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.334375, 19.4140625, 19.990625, 21.040625]}, 'saliency': {'score': [1.0618780226934523, 0.1346856788041483, 1.2610948350694444, 0.12728928091786043, 0.13243738810221353], 'topk_indices': array([7593, 7562, 2899, 1078, 4902, 8153,   24, 4958, 3626, 7637, 8067,
       2534, 1074, 3247, 8156, 8023, 8157, 4180, 8159, 3630]), 'topk_tokens': [' three', 'nes', ' milk', ' milk', ' bedroom', ' Where', '\n\n', ' bathroom', ' journey', ' or', ' location', ' Mary', ' Sandra', ' hallway', ' milk', ' context', ' before', ' bathroom', ' bathroom', ' bedroom'], 'evidence_proportions': [1.09150390625, 1.4638671875, 1.005078125, 0.6066650390625]}}, 'pred_res': 'The hallway.<|eot_id|>', 'score': 0}
2025-01-22 19:58:29.130 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 19:58:29.130 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-152_pid-3_3-4-5-6.pkl | len: 3 |  size: 2.05 KB
Processing depth (3, 4, 5, 6):   4%|â–         | 4/100 [01:19<32:05, 20.06s/it]is_0k: False
your chose emoji: ['ğŸ§–ğŸ¼\u200dâ™‚ï¸', 'ğŸ®', 'ğŸ§—ğŸ¼\u200dâ™€', 'ğŸ‘¨\u200dğŸ‘§', 'ğŸ•µğŸ»', 'â•', 'ğŸ¤¦ğŸ¼', 'ğŸ¦¸ğŸ¾\u200dâ™‚', 'ğŸŒ•', 'ğŸ§\u200dâ™€ï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  3.86s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.29s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.30s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.05s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.48s/it]
Processing depth (2, 3, 4, 8):   4%|â–         | 4/100 [01:35<32:05, 20.06s/it]2025-01-22 19:58:44.743 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John picked up the milk.
2025-01-22 19:58:44.752 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1803, 1808) --> . John picked up the
2025-01-22 19:58:44.752 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bedroom.
2025-01-22 19:58:44.767 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2944, 2950) --> . John journeyed to the
2025-01-22 19:58:44.767 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the bathroom.
2025-01-22 19:58:44.785 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3631, 3636) --> . John travelled to the
2025-01-22 19:58:44.785 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra moved to the garden.
2025-01-22 19:58:44.817 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6634, 6639) --> . Sandra moved to the
2025-01-22 19:58:44.817 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went to the bedroom.
2025-01-22 19:58:44.841 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4925, 4930) --> . Daniel went to the
2025-01-22 19:58:44.841 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went back to the kitchen.
2025-01-22 19:58:44.854 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2555, 2561) --> . Mary went back to the
2025-01-22 19:58:44.854 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the hallway.
2025-01-22 19:58:44.888 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6437, 6443) --> . Sandra went back to the
2025-01-22 19:58:44.888 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary went to the bathroom.
2025-01-22 19:58:44.902 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2556, 2561) -->  Mary went back to the
2025-01-22 19:58:44.902 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra put down the milk.
2025-01-22 19:58:44.909 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1073, 1078) --> . Sandra put down the
2025-01-22 19:58:44.909 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra grabbed the milk.
2025-01-22 19:58:44.944 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (7233, 7237) -->  Sandra grabbed the milk
2025-01-22 19:58:44.944 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Mary travelled to the hallway.
2025-01-22 19:58:44.960 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (3250, 3255) -->  Mary travelled to the hallway
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:58:45.780 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 19:58:45.780 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8197])
2025-01-22 19:58:48.014 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [217.88244047619048, 21.757534298780488, 218.08420138888889, 20.383792060665602, 14.230125633445946], 'topk_indices': array([8180, 8196, 7237, 8191, 8178,    9, 3636, 8182, 2946, 8193, 8184,
       1079,   24,   14, 8185, 8187, 8195, 2950,    0, 8192]), 'topk_tokens': [':', '\n\n', '.', ':', '.\n\n', ':', ' bathroom', ' was', ' journey', '<|start_header_id|>', ' milk', '.', '\n\n', '\n', ' before', ' bathroom', '<|end_header_id|>', ' bedroom', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [224.5, 378.8333333333333, 174.35, 61.65625]}, 'weight': {'score': [20.395833333333332, 23.294096798780487, 23.25542534722222, 23.301742102112243, 29.849239864864863], 'topk_indices': array([3342, 3315, 3175, 3223, 7410, 7448, 1501, 1439, 4324, 4308, 5192,
       5131, 7182, 7126, 3524, 3498, 4979, 4950, 4921, 4896]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.334375, 19.4140625, 19.990625, 21.040625]}, 'saliency': {'score': [1.1677594866071428, 0.12190050078601372, 1.3397759331597223, 0.11381913589989101, 0.1065776928051098], 'topk_indices': array([7236, 1808, 8182, 1075, 8181, 3254, 1076, 8190, 1078,   24, 8179,
       4926, 4930, 1074, 2946, 8184, 3636, 8185, 8187, 2950]), 'topk_tokens': [' milk', ' milk', ' was', ' put', ' Where', ' hallway', ' down', 'Answer', ' milk', '\n\n', 'Question', ' Daniel', ' bedroom', ' Sandra', ' journey', ' milk', ' bathroom', ' before', ' bathroom', ' bedroom'], 'evidence_proportions': [1.309375, 1.9386393229166667, 0.8931640625, 0.37568359375]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 0}
2025-01-22 19:58:48.022 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 19:58:48.022 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-152_pid-4_2-3-4-8.pkl | len: 3 |  size: 2.01 KB
Processing depth (2, 3, 4, 8):   5%|â–Œ         | 5/100 [01:38<31:05, 19.64s/it]Processing depth (2, 3, 4, 8):   5%|â–Œ         | 5/100 [01:38<31:12, 19.71s/it]
2025-01-22 19:58:48.081 | INFO     | __main__:<module>:82 - Selected idx: 154
2025-01-22 19:58:48.081 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the milk before the bathroom? 
2025-01-22 19:58:48.081 | INFO     | __main__:<module>:84 - Answer: bedroom
2025-01-22 19:58:48.081 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 19:58:48.081 | INFO     | __main__:<module>:86 - Needle: [' Mary travelled to the hallway.', ' Mary went to the bathroom.', ' John picked up the milk.', ' Sandra went back to the hallway.', ' John journeyed to the bedroom.', ' Sandra grabbed the milk.', ' Daniel went to the bedroom.', ' John travelled to the bathroom.', ' Mary went back to the kitchen.']
2025-01-22 19:58:48.081 | INFO     | __main__:<module>:87 - Real Needle: [' John picked up the milk.', ' John journeyed to the bedroom.', ' John travelled to the bathroom.', ' Mary went back to the kitchen.']
2025-01-22 19:58:48.081 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ‘¨ğŸ»\u200dğŸ¦³', 'ğŸ‘¨ğŸ¿\u200dğŸ¦¯\u200dâ¡', 'ğŸƒ\u200dâ™€\u200dâ¡', 'ğŸ‘©ğŸ¿\u200dâœˆï¸', 'ğŸ§ğŸ¼\u200dâ™€ï¸', 'â›¸ï¸', 'ğŸ¤¦ğŸ½\u200dâ™€ï¸', 'ğŸ§', 'ğŸ‘°\u200dâ™€', 'ğŸ¾']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.27s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.29s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.08s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:12<00:00,  2.63s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:12<00:00,  3.20s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 5, 8, 9):   0%|          | 0/100 [00:14<?, ?it/s]2025-01-22 19:59:02.687 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John picked up the milk.
2025-01-22 19:59:02.688 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the milk.
2025-01-22 19:59:02.688 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bedroom.
2025-01-22 19:59:02.710 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4233, 4239) -->  John journeyed to the bedroom
2025-01-22 19:59:02.711 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the bathroom.
2025-01-22 19:59:02.745 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6638, 6643) --> . John travelled to the
2025-01-22 19:59:02.746 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary went back to the kitchen.
2025-01-22 19:59:02.784 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7260, 7266) --> . Mary went back to the
2025-01-22 19:59:02.784 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the hallway.
2025-01-22 19:59:02.801 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3534, 3539) --> . Mary travelled to the
2025-01-22 19:59:02.801 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went to the bathroom.
2025-01-22 19:59:02.802 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (149, 154) --> . Mary went to the
2025-01-22 19:59:02.802 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the hallway.
2025-01-22 19:59:02.807 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (907, 913) --> . Sandra went back to the
2025-01-22 19:59:02.807 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra grabbed the milk.
2025-01-22 19:59:02.837 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6397, 6401) -->  grabbed the milk.
2025-01-22 19:59:02.837 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel went to the bedroom.
2025-01-22 19:59:02.845 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1741, 1746) -->  Daniel went to the bedroom
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:59:05.272 | INFO     | test_jbb_embedding:begin_test:693 - kitchen<|eot_id|>
2025-01-22 19:59:05.273 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8219])
2025-01-22 19:59:08.283 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [205.71875, 25.348312834468498, 221.4625, 24.2631746941896, 16.567200377747252], 'topk_indices': array([  64, 7541, 7586, 8206,   65,  155,  545, 2708,   14, 6039,   66,
         24, 8207, 6040,   67, 8209,  105, 8214,   68,    0]), 'topk_tokens': ['ENCES', 'nes', 'nes', ' milk', ' OF', '.', ',', ' Hill', '\n', '\n', ' P', '\n\n', ' before', 'the', 'ION', ' bathroom', 'ION', '<|eot_id|>', 'E', '<|begin_of_text|>'], 'evidence_proportions': [363.3, 230.5625, 140.15, 104.19791666666667]}, 'weight': {'score': [21.724786931818183, 23.321190479810266, 21.8434375, 23.330005733944954, 29.8698489010989], 'topk_indices': array([3297, 3270, 3190, 3142, 7478, 7440, 1418, 1480, 4286, 4302, 5158,
       5097, 7210, 7154, 3479, 3453, 4874, 4899, 4922, 4951]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.025, 23.936197916666668, 19.990625, 20.708333333333332]}, 'saliency': {'score': [1.1707985617897727, 0.1429336759418329, 1.267958984375, 0.1367271120030581, 0.12446828988882211], 'topk_indices': array([  24,   34, 7585, 7541,   66, 7586, 4238, 8201,   64, 2708, 8206,
       1745, 6643,  154, 6040, 8207,   68,   67,  105, 8209]), 'topk_tokens': ['\n\n', ' milk', ' Min', 'nes', ' P', 'nes', ' bedroom', 'Question', 'ENCES', ' Hill', ' milk', ' bedroom', ' bathroom', ' bathroom', 'the', ' before', 'E', 'ION', 'ION', ' bathroom'], 'evidence_proportions': [1.91728515625, 1.5438639322916667, 0.72568359375, 0.5465901692708334]}}, 'pred_res': 'kitchen<|eot_id|>', 'score': 0}
2025-01-22 19:59:08.290 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 19:59:08.290 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-154_pid-0_0-5-8-9.pkl | len: 3 |  size: 1.94 KB
Processing depth (0, 5, 8, 9):   1%|          | 1/100 [00:20<33:12, 20.13s/it]is_0k: False
your chose emoji: ['ğŸ‡¨ğŸ‡µ', 'ğŸ–‹ï¸', 'ğŸ‘¨ğŸ¼\u200dâ¤\u200dğŸ’‹\u200dğŸ‘¨ğŸ»', 'ğŸ•‘', 'ğŸ‘°ğŸ¿\u200dâ™€ï¸', 'ğŸ‘·ğŸ¼\u200dâ™‚', 'ğŸ¤´', 'ğŸ§ğŸ»\u200dâ¡ï¸', 'ğŸ§‘ğŸ¾\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ§‘ğŸ¿', 'ğŸ§”ğŸ¾\u200dâ™‚ï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.75s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.69s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.32s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  2.97s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.54s/it]
Processing depth (2, 4, 8, 9):   1%|          | 1/100 [00:36<33:12, 20.13s/it]2025-01-22 19:59:24.361 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John picked up the milk.
2025-01-22 19:59:24.370 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1874, 1879) --> . John picked up the
2025-01-22 19:59:24.370 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bedroom.
2025-01-22 19:59:24.388 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3608, 3614) --> . John journeyed to the
2025-01-22 19:59:24.388 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the bathroom.
2025-01-22 19:59:24.424 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6544, 6549) --> . John travelled to the
2025-01-22 19:59:24.424 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary went back to the kitchen.
2025-01-22 19:59:24.459 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7240, 7246) --> . Mary went back to the
2025-01-22 19:59:24.459 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the hallway.
2025-01-22 19:59:24.476 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3371, 3376) -->  Mary travelled to the hallway
2025-01-22 19:59:24.476 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went to the bathroom.
2025-01-22 19:59:24.477 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (143, 148) --> . Mary went to the
2025-01-22 19:59:24.477 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the hallway.
2025-01-22 19:59:24.483 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (901, 907) --> . Sandra went back to the
2025-01-22 19:59:24.483 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra grabbed the milk.
2025-01-22 19:59:24.517 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6264, 6268) -->  Sandra grabbed the milk
2025-01-22 19:59:24.517 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel went to the bedroom.
2025-01-22 19:59:24.525 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1734, 1739) --> . Daniel went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:59:25.273 | INFO     | test_jbb_embedding:begin_test:693 - the kitchen<|eot_id|>
2025-01-22 19:59:25.273 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8189])
2025-01-22 19:59:27.479 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [229.4090909090909, 33.240074157714844, 245.37, 32.05910834868017, 20.543431332236842], 'topk_indices': array([7324, 8178, 7557, 7574, 7372, 7539, 8176, 8174, 7584, 8180, 8184,
       7540, 8179, 8177, 7373,    0, 7586, 7585, 7541, 8185]), 'topk_tokens': ['nes', ' the', '.\n', '\n', ' Min', ' the', ' milk', ' was', ' the', '?', '<|eot_id|>', ' Min', ' bathroom', ' before', 'nes', '<|begin_of_text|>', 'nes', ' Min', 'nes', '<|start_header_id|>'], 'evidence_proportions': [368.8, 188.45833333333334, 286.6, 106.54166666666667]}, 'weight': {'score': [20.334517045454547, 23.286422729492188, 23.18125, 23.294718769183547, 29.30345394736842], 'topk_indices': array([3341, 3314, 3186, 3234, 7478, 7440, 1494, 1432, 4354, 4370, 5177,
       5238, 7190, 7134, 3553, 3527, 5019, 4967, 4942, 4990]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.334375, 19.4140625, 19.990625, 20.708333333333332]}, 'saliency': {'score': [1.2107266512784092, 0.18591448664665222, 1.46806640625, 0.1792110286218539, 0.1542247972990337], 'topk_indices': array([7542, 7537, 7295, 8174, 7578, 1739, 6549, 8180, 8173, 7324, 8171,
       7372, 8176, 8177, 7540, 7373, 8179, 7586, 7585, 7541]), 'topk_tokens': ['ot', ' joke', 'nes', ' was', ' perpet', ' bedroom', ' bathroom', '?', ' Where', 'nes', 'Question', ' Min', ' milk', ' before', ' Min', 'nes', ' bathroom', 'nes', ' Min', 'nes'], 'evidence_proportions': [2.03408203125, 0.9921875, 1.43759765625, 0.5540771484375]}}, 'pred_res': 'the kitchen<|eot_id|>', 'score': 0}
2025-01-22 19:59:27.486 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 19:59:27.486 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-154_pid-1_2-4-8-9.pkl | len: 3 |  size: 1.97 KB
Processing depth (2, 4, 8, 9):   2%|â–         | 2/100 [00:39<31:58, 19.58s/it]is_0k: False
your chose emoji: ['ğŸ‘±ğŸ¾\u200dâ™‚ï¸', 'ğŸ§ğŸ½\u200dâ™‚', 'ğŸ§›ğŸ½', 'ğŸ‘©ğŸ¿\u200dğŸ¦¯\u200dâ¡', 'ğŸ§‘ğŸ¼\u200dğŸ¦³', 'ğŸ§±', 'ğŸ¦¹ğŸ¿\u200dâ™‚', 'ğŸ‘ğŸ»', 'ğŸ‡»ğŸ‡¬', 'ğŸ›ï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.48s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.61s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.77s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.40s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.86s/it]
Processing depth (2, 4, 5, 7):   2%|â–         | 2/100 [00:56<31:58, 19.58s/it]2025-01-22 19:59:44.608 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John picked up the milk.
2025-01-22 19:59:44.617 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1828, 1833) --> . John picked up the
2025-01-22 19:59:44.618 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bedroom.
2025-01-22 19:59:44.640 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3638, 3644) --> . John journeyed to the
2025-01-22 19:59:44.640 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the bathroom.
2025-01-22 19:59:44.668 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4238, 4243) -->  John travelled to the bathroom
2025-01-22 19:59:44.669 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary went back to the kitchen.
2025-01-22 19:59:44.700 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5747, 5753) --> . Mary went back to the
2025-01-22 19:59:44.700 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the hallway.
2025-01-22 19:59:44.718 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3474, 3479) --> . Mary travelled to the
2025-01-22 19:59:44.718 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went to the bathroom.
2025-01-22 19:59:44.719 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (143, 148) --> . Mary went to the
2025-01-22 19:59:44.719 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the hallway.
2025-01-22 19:59:44.724 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (827, 833) --> . Sandra went back to the
2025-01-22 19:59:44.724 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra grabbed the milk.
2025-01-22 19:59:44.763 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6418, 6422) -->  grabbed the milk.
2025-01-22 19:59:44.764 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel went to the bedroom.
2025-01-22 19:59:44.771 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1602, 1607) --> . Daniel went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 19:59:45.566 | INFO     | test_jbb_embedding:begin_test:693 - the hallway<|eot_id|>
2025-01-22 19:59:45.567 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8219])
2025-01-22 19:59:47.851 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [427.94034090909093, 53.17814628435904, 475.51, 50.87807721712538, 36.00510817307692], 'topk_indices': array([ 196, 6420,  197, 1833, 8207, 8209, 1160, 1834, 1174, 1159, 1231,
       1213, 1232, 1219, 1218, 1173, 1158,  198, 1233,    0]), 'topk_tokens': ['ATION', ' milk', ' OF', ' milk', ' before', ' bathroom', 'ioneer', '.', 'ot', 'P', '\n', 'nes', 'Min', 'P', '\n', 'nes', '\n', ' INCIDENT', 'nes', '<|begin_of_text|>'], 'evidence_proportions': [791.6, 323.9166666666667, 345.85, 297.3229166666667]}, 'weight': {'score': [21.627485795454547, 23.310316452809534, 20.758125, 23.3226500382263, 29.39114010989011], 'topk_indices': array([3308, 3335, 3228, 3180, 7430, 7468, 1520, 1458, 4330, 4314, 5141,
       5202, 7115, 7171, 3497, 3523, 4902, 4927, 4979, 4950]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.334375, 19.4140625, 25.6796875, 20.708333333333332]}, 'saliency': {'score': [2.4936079545454546, 0.3035469101572002, 2.72869140625, 0.29023682387232413, 0.2676381540822459], 'topk_indices': array([1603,  195,  148, 1607, 1153, 1158, 8207, 1174,  116, 6420, 1159,
       1833, 1219, 8209, 1160, 1213, 1232, 1173,  198, 1233]), 'topk_tokens': [' Daniel', 'ARR', ' bathroom', ' bedroom', 'nes', '\n', ' before', 'ot', ' Published', ' milk', 'P', ' milk', 'P', ' bathroom', 'ioneer', 'nes', 'Min', 'nes', ' INCIDENT', 'nes'], 'evidence_proportions': [4.2765625, 1.7491861979166667, 2.5078125, 1.7403971354166667]}}, 'pred_res': 'the hallway<|eot_id|>', 'score': 0}
2025-01-22 19:59:47.881 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 19:59:47.881 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-154_pid-2_2-4-5-7.pkl | len: 3 |  size: 1.94 KB
Processing depth (2, 4, 5, 7):   3%|â–         | 3/100 [00:59<32:15, 19.95s/it]is_0k: False
your chose emoji: ['ğŸ‘©ğŸ»\u200dğŸŒ¾', 'ğŸ‘©ğŸ»\u200dğŸ¤\u200dğŸ‘¨ğŸ¿', 'â›©ï¸', 'ğŸ§šğŸ½\u200dâ™€', 'ğŸ‡©ğŸ‡²', 'ğŸ‘§ğŸ¾', 'ğŸ’‚ğŸ¾\u200dâ™‚', 'ğŸ¤³ğŸ½', 'ğŸ‘©ğŸ½\u200dâ¤\u200dğŸ’‹\u200dğŸ‘¨ğŸ»', 'ğŸ‘³ğŸ»\u200dâ™€']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.41s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.37s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.03s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:12<00:00,  2.61s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:12<00:00,  3.20s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (5, 6, 7, 8):   3%|â–         | 3/100 [01:14<32:15, 19.95s/it]2025-01-22 20:00:02.704 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John picked up the milk.
2025-01-22 20:00:02.724 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4186, 4191) --> . John picked up the
2025-01-22 20:00:02.724 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bedroom.
2025-01-22 20:00:02.747 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4746, 4752) --> . John journeyed to the
2025-01-22 20:00:02.747 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the bathroom.
2025-01-22 20:00:02.774 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5637, 5642) --> . John travelled to the
2025-01-22 20:00:02.775 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary went back to the kitchen.
2025-01-22 20:00:02.806 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6552, 6558) --> . Mary went back to the
2025-01-22 20:00:02.807 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the hallway.
2025-01-22 20:00:02.823 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3362, 3367) --> . Mary travelled to the
2025-01-22 20:00:02.823 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went to the bathroom.
2025-01-22 20:00:02.824 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (143, 148) --> . Mary went to the
2025-01-22 20:00:02.824 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the hallway.
2025-01-22 20:00:02.828 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (827, 833) --> . Sandra went back to the
2025-01-22 20:00:02.828 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra grabbed the milk.
2025-01-22 20:00:02.857 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6273, 6277) -->  grabbed the milk.
2025-01-22 20:00:02.857 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel went to the bedroom.
2025-01-22 20:00:02.865 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1576, 1581) --> . Daniel went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:00:05.516 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 20:00:05.516 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8195])
2025-01-22 20:00:08.222 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [263.32670454545456, 28.882806782141987, 262.815, 27.5325343516133, 26.832253757911392], 'topk_indices': array([8181, 5642,  149, 6276, 8177, 8178,   14, 8179, 8176,   24, 8193,
       8184, 8180, 8186, 8182, 8191, 8190, 8183, 8185,    0]), 'topk_tokens': [' the', ' bathroom', '.', '.', 'Question', ':', '\n', ' Where', '.\n\n', '\n\n', '<|end_header_id|>', ' the', ' was', '?', ' milk', '<|start_header_id|>', '<|eot_id|>', ' before', ' bathroom', '<|begin_of_text|>'], 'evidence_proportions': [342.5, 331.5208333333333, 227.65, 158.88541666666666]}, 'weight': {'score': [20.334517045454547, 23.291435411075874, 20.758125, 23.307186234817813, 29.335047468354432], 'topk_indices': array([3318, 3345, 3238, 3190, 7422, 7460, 1474, 1536, 4345, 4329, 5212,
       5151, 7199, 7143, 3507, 3533, 4928, 4953, 4976, 5005]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.334375, 19.4140625, 19.990625, 20.708333333333332]}, 'saliency': {'score': [1.4120649857954546, 0.16256148782000945, 1.39654296875, 0.15540425386359802, 0.19572371470777294], 'topk_indices': array([4188,  833,   24, 6273,  148, 8176, 8049, 4191, 4748, 6275, 4752,
       8180, 1581, 8179, 8186, 8177, 5642, 8182, 8183, 8185]), 'topk_tokens': [' picked', ' hallway', '\n\n', ' grabbed', ' bathroom', '.\n\n', ' context', ' milk', ' journey', ' milk', ' bedroom', ' was', ' bedroom', ' Where', '?', 'Question', ' bathroom', ' milk', ' before', ' bathroom'], 'evidence_proportions': [1.90390625, 1.7801106770833333, 1.1888671875, 0.8201497395833334]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 0}
2025-01-22 20:00:08.228 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:00:08.229 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-154_pid-3_5-6-7-8.pkl | len: 3 |  size: 2.02 KB
Processing depth (5, 6, 7, 8):   4%|â–         | 4/100 [01:20<32:10, 20.11s/it]is_0k: False
your chose emoji: ['ğŸ‘¸ğŸ»', 'ğŸ„ğŸ½\u200dâ™‚', 'ğŸ‘©ğŸ¾\u200dğŸ”¬', 'ğŸ‘©ğŸ¾\u200dğŸŒ¾', 'ğŸ‡¯ğŸ‡µ', '\U0001fac4ğŸ¼', 'â†™', 'ğŸ‘©ğŸ»\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘©ğŸ½', 'ğŸ‡¸ğŸ‡¬', 'ğŸ‘ğŸ½']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.82s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.85s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.49s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.08s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.67s/it]
Processing depth (0, 5, 6, 9):   4%|â–         | 4/100 [01:37<32:10, 20.11s/it]2025-01-22 20:00:25.349 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John picked up the milk.
2025-01-22 20:00:25.349 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the milk.
2025-01-22 20:00:25.349 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bedroom.
2025-01-22 20:00:25.370 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4223, 4229) -->  John journeyed to the bedroom
2025-01-22 20:00:25.370 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the bathroom.
2025-01-22 20:00:25.394 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4867, 4872) --> . John travelled to the
2025-01-22 20:00:25.394 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary went back to the kitchen.
2025-01-22 20:00:25.432 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7236, 7242) --> . Mary went back to the
2025-01-22 20:00:25.432 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the hallway.
2025-01-22 20:00:25.448 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3353, 3358) -->  Mary travelled to the hallway
2025-01-22 20:00:25.448 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went to the bathroom.
2025-01-22 20:00:25.449 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (149, 154) --> . Mary went to the
2025-01-22 20:00:25.449 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the hallway.
2025-01-22 20:00:25.453 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (837, 843) --> . Sandra went back to the
2025-01-22 20:00:25.453 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra grabbed the milk.
2025-01-22 20:00:25.483 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6396, 6400) -->  Sandra grabbed the milk
2025-01-22 20:00:25.484 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel went to the bedroom.
2025-01-22 20:00:25.492 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1598, 1603) --> . Daniel went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:00:26.263 | INFO     | test_jbb_embedding:begin_test:693 - the kitchen<|eot_id|>
2025-01-22 20:00:26.263 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8191])
2025-01-22 20:00:28.509 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [314.1988636363636, 32.09169438003417, 307.83, 30.48376319504112, 31.89940137987013], 'topk_indices': array([8172, 6399, 8182, 5701, 4224, 8180,   67, 4349, 8176,   24,  155,
         35, 8178,   68, 5702,  105, 8186, 8179, 8181,    0]), 'topk_tokens': ['.\n\n', ' milk', '?', 'nes', ' journey', ' the', 'ION', 'nes', ' was', '\n\n', '.', '.', ' milk', 'E', 'ot', 'ION', '<|eot_id|>', ' before', ' bathroom', '<|begin_of_text|>'], 'evidence_proportions': [537.3, 404.1041666666667, 189.0, 142.70833333333334]}, 'weight': {'score': [21.724786931818183, 23.29510922626312, 23.18125, 23.299699084018656, 29.67268668831169], 'topk_indices': array([3323, 3296, 3168, 3216, 7454, 7416, 1454, 1516, 4316, 4300, 5123,
       5184, 7130, 7186, 3497, 3523, 4919, 4942, 4971, 4894]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.025, 23.936197916666668, 19.990625, 20.708333333333332]}, 'saliency': {'score': [1.8157404119318181, 0.18325068981495607, 1.8892578125, 0.1736072686840248, 0.23617088020621957], 'topk_indices': array([8175, 8176,   38,   68,   67,   34, 5701, 4872, 8173, 6399, 4228,
       1603, 4349, 4224,  154, 5702,  105, 8178, 8179, 8181]), 'topk_tokens': [' Where', ' was', '***', 'E', 'ION', ' milk', 'nes', ' bathroom', 'Question', ' milk', ' bedroom', ' bedroom', 'nes', ' journey', ' bathroom', 'ot', 'ION', ' milk', ' before', ' bathroom'], 'evidence_proportions': [2.8705078125, 2.7106119791666665, 0.993359375, 0.7272135416666666]}}, 'pred_res': 'the kitchen<|eot_id|>', 'score': 0}
2025-01-22 20:00:28.515 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:00:28.516 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-154_pid-4_0-5-6-9.pkl | len: 3 |  size: 1.96 KB
Processing depth (0, 5, 6, 9):   5%|â–Œ         | 5/100 [01:40<31:56, 20.17s/it]Processing depth (0, 5, 6, 9):   5%|â–Œ         | 5/100 [01:40<31:47, 20.08s/it]
2025-01-22 20:00:28.565 | INFO     | __main__:<module>:82 - Selected idx: 156
2025-01-22 20:00:28.565 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the football before the office? 
2025-01-22 20:00:28.565 | INFO     | __main__:<module>:84 - Answer: bathroom
2025-01-22 20:00:28.565 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 20:00:28.565 | INFO     | __main__:<module>:86 - Needle: [' Sandra went back to the hallway.', ' Mary got the football.', ' John discarded the apple.', ' John put down the apple there.', ' Mary travelled to the bathroom.', ' John grabbed the apple.', ' John moved to the kitchen.', ' John travelled to the bathroom.', ' John got the apple.', ' Mary travelled to the office.', ' John moved to the hallway.']
2025-01-22 20:00:28.565 | INFO     | __main__:<module>:87 - Real Needle: [' Mary got the football.', ' Mary travelled to the bathroom.', ' Mary travelled to the office.', ' John moved to the hallway.']
2025-01-22 20:00:28.565 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ§‘ğŸ»\u200dğŸŒ¾', 'ğŸ‘·ğŸ¿\u200dâ™€', 'ğŸ’ªğŸ»', 'ğŸƒ\u200dâ¡ï¸', 'ğŸš¶ğŸ¼\u200dâ™€\u200dâ¡ï¸', '\U0001fac3ğŸ»', 'ğŸ§‘ğŸ¼\u200dğŸ­', 'ğŸ¤½ğŸ½', 'ğŸŒ', 'ğŸ‘·ğŸ»\u200dâ™‚ï¸']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.29s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.57s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.34s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.81s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.40s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (1, 3, 6, 8):   0%|          | 0/100 [00:15<?, ?it/s]2025-01-22 20:00:44.001 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the football.
2025-01-22 20:00:44.006 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (767, 771) -->  got the football.
2025-01-22 20:00:44.006 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the bathroom.
2025-01-22 20:00:44.020 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2872, 2877) --> . Mary travelled to the
2025-01-22 20:00:44.020 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary travelled to the office.
2025-01-22 20:00:44.036 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2872, 2877) --> . Mary travelled to the
2025-01-22 20:00:44.036 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John moved to the hallway.
2025-01-22 20:00:44.061 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4284, 4289) --> . John moved to the
2025-01-22 20:00:44.061 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went back to the hallway.
2025-01-22 20:00:44.088 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5052, 5058) --> . Sandra went back to the
2025-01-22 20:00:44.089 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John discarded the apple.
2025-01-22 20:00:44.116 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5776, 5780) -->  John discarded the apple
2025-01-22 20:00:44.116 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John put down the apple there.
2025-01-22 20:00:44.134 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2511, 2517) --> . John put down the apple
2025-01-22 20:00:44.134 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John grabbed the apple.
2025-01-22 20:00:44.142 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1563, 1567) -->  John grabbed the apple
2025-01-22 20:00:44.142 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John moved to the kitchen.
2025-01-22 20:00:44.169 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4284, 4289) --> . John moved to the
2025-01-22 20:00:44.169 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John travelled to the bathroom.
2025-01-22 20:00:44.183 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (2873, 2878) -->  Mary travelled to the bathroom
2025-01-22 20:00:44.183 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  John got the apple.
2025-01-22 20:00:44.222 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (6183, 6187) -->  John got the apple
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:00:47.258 | INFO     | test_jbb_embedding:begin_test:693 - Mary's location<|eot_id|>
2025-01-22 20:00:47.258 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8169])
2025-01-22 20:00:50.022 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [348.7730263157895, 26.674383565834557, 126.01286764705883, 25.50461109742579, 40.00220514112903], 'topk_indices': array([ 767, 8066, 8057,  768, 8160,   24, 8167,   14,  760, 8157, 8159,
        757, 8067, 8164,  756,  770, 8156,  769,    0,  758]), 'topk_tokens': [' got', ' first', '.\n\n', ' the', '?', '\n\n', '<|end_header_id|>', '\n', 'â™€', ' before', ' office', 'ï¿½', ' location', '<|eot_id|>', 'ï¿½', '.', ' football', ' football', '<|begin_of_text|>', 'ï¿½'], 'evidence_proportions': [926.875, 213.65, 213.65, 156.5375]}, 'weight': {'score': [20.27796052631579, 23.27390785609398, 24.029871323529413, 23.277753186968837, 30.009576612903224], 'topk_indices': array([3295, 3268, 3188, 3140, 7400, 7362, 1418, 1480, 4257, 4273, 5087,
       5148, 7127, 7071, 3477, 3451, 4905, 4882, 4934, 4857]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.828125, 20.75625, 20.75625, 18.88125]}, 'saliency': {'score': [1.8716591282894737, 0.15176718735659875, 0.8130600873161765, 0.14497301252270908, 0.3104432629000756], 'topk_indices': array([8057, 8063,  766, 8151,  232, 8160, 7598, 8066,  767,  759, 2877,
       8157,  757,  760, 8159, 8067,  756, 8156,  769,  758]), 'topk_tokens': ['.\n\n', ' item', ' Mary', 'Question', 'ï¿½', '?', 'nes', ' first', ' got', '\u200d', ' bathroom', ' before', 'ï¿½', 'â™€', ' office', ' location', 'ï¿½', ' football', ' football', 'ï¿½'], 'evidence_proportions': [5.08154296875, 1.127587890625, 1.127587890625, 0.79189453125]}}, 'pred_res': "Mary's location<|eot_id|>", 'score': 0}
2025-01-22 20:00:50.029 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:00:50.029 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-156_pid-0_1-3-6-8.pkl | len: 3 |  size: 1.99 KB
Processing depth (1, 3, 6, 8):   1%|          | 1/100 [00:21<35:16, 21.38s/it]is_0k: False
your chose emoji: ['ğŸ‘©\u200dğŸ¦²', 'ğŸ§‘\u200dğŸ¼', 'ğŸ†', 'ğŸ˜¼', 'ğŸŒ\u200dâ™€', 'ğŸ‘©ğŸ»\u200dğŸ¦±', 'ğŸ˜©', 'ğŸ§ğŸ»\u200dâ™€ï¸', 'âœ’', 'ğŸ‘©ğŸ»\u200dâ¤ï¸\u200dğŸ‘¨ğŸ¼']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.16s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:09,  4.54s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.41s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.13s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.60s/it]
Processing depth (1, 5, 6, 8):   1%|          | 1/100 [00:37<35:16, 21.38s/it]2025-01-22 20:01:06.186 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the football.
2025-01-22 20:01:06.191 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (816, 820) -->  Mary got the football
2025-01-22 20:01:06.191 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the bathroom.
2025-01-22 20:01:06.213 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4170, 4175) -->  travelled to the bathroom.
2025-01-22 20:01:06.214 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary travelled to the office.
2025-01-22 20:01:06.239 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4240, 4245) --> . Mary travelled to the
2025-01-22 20:01:06.239 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John moved to the hallway.
2025-01-22 20:01:06.269 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4399, 4404) -->  execution. John moved to
2025-01-22 20:01:06.270 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went back to the hallway.
2025-01-22 20:01:06.295 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5083, 5089) -->  Sandra went back to the hallway
2025-01-22 20:01:06.295 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John discarded the apple.
2025-01-22 20:01:06.321 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5666, 5670) -->  John discarded the apple
2025-01-22 20:01:06.321 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John put down the apple there.
2025-01-22 20:01:06.334 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2675, 2681) --> . John put down the apple
2025-01-22 20:01:06.335 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John grabbed the apple.
2025-01-22 20:01:06.344 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1713, 1717) -->  John grabbed the apple
2025-01-22 20:01:06.344 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John moved to the kitchen.
2025-01-22 20:01:06.370 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4399, 4404) -->  execution. John moved to
2025-01-22 20:01:06.370 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John travelled to the bathroom.
2025-01-22 20:01:06.390 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (4169, 4174) -->  John travelled to the bathroom
2025-01-22 20:01:06.390 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  John got the apple.
2025-01-22 20:01:06.419 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (6209, 6213) -->  John got the apple
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:01:07.284 | INFO     | test_jbb_embedding:begin_test:693 - Mary got the football.<|eot_id|>
2025-01-22 20:01:07.285 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8177])
2025-01-22 20:01:09.502 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [295.8544407894737, 20.96945484413203, 112.16084558823529, 19.945298080472497, 18.25887784090909], 'topk_indices': array([8160,  817, 8158,  818,    1, 8170, 8065, 8075, 8165, 8171,   14,
       8164,   24, 4173,  820, 8173, 8175, 8172,  819,    0]), 'topk_tokens': [':', ' got', '.\n\n', ' the', '<|start_header_id|>', 'Answer', '.\n\n', ' location', ' before', ':', '\n', ' football', '\n\n', ' bathroom', '.', '<|start_header_id|>', '<|end_header_id|>', '<|eot_id|>', ' football', '<|begin_of_text|>'], 'evidence_proportions': [663.375, 372.3, 167.9, 53.346875]}, 'weight': {'score': [22.948190789473685, 23.269666870415648, 25.46920955882353, 23.26121646979205, 29.338541666666668], 'topk_indices': array([3275, 3248, 3168, 3120, 7450, 7412, 1410, 1472, 4267, 4251, 5192,
       5131, 7189, 7133, 3431, 3457, 4876, 4851, 4934, 4905]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.611328125, 21.81875, 20.75625, 23.3390625]}, 'saliency': {'score': [1.9170596474095394, 0.11735146669420461, 0.7637921501608456, 0.11043951410758505, 0.13651795820756393], 'topk_indices': array([8158, 4170, 8065, 8149, 8031, 8174, 8146, 7916,  816, 8167,  821,
       8159,   24,  817, 8165, 8075, 8170, 8164, 4173,  819]), 'topk_tokens': ['.\n\n', ' travelled', '.\n\n', ' directly', ' context', 'assistant', ' return', ' Square', ' Mary', ' office', ' Paul', 'Question', '\n\n', ' got', ' before', ' location', 'Answer', ' football', ' bathroom', ' football'], 'evidence_proportions': [4.62890625, 2.458203125, 0.83330078125, 0.29019775390625]}}, 'pred_res': 'Mary got the football.<|eot_id|>', 'score': 0}
2025-01-22 20:01:09.509 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:01:09.509 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-156_pid-1_1-5-6-8.pkl | len: 3 |  size: 2.06 KB
Processing depth (1, 5, 6, 8):   2%|â–         | 2/100 [00:40<33:05, 20.26s/it]is_0k: False
your chose emoji: ['ğŸ’ªğŸ½', 'ğŸ‡¬ğŸ‡±', 'ğŸ¦¾', '\U0001faf3ğŸ¿', 'ğŸš¶ğŸ¾\u200dâ™‚', 'ğŸ‘©ğŸ½\u200dâ¤\u200dğŸ‘©ğŸ¼', 'ğŸ†“', 'ğŸ¥§', 'ğŸ‘±\u200dâ™‚ï¸', 'ğŸ‘©ğŸ»\u200dğŸ¼']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  3.85s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.08s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:11<00:03,  3.99s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.83s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.26s/it]
Processing depth (1, 2, 6, 8):   2%|â–         | 2/100 [00:55<33:05, 20.26s/it]2025-01-22 20:01:24.371 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the football.
2025-01-22 20:01:24.376 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (896, 900) -->  Mary got the football
2025-01-22 20:01:24.376 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the bathroom.
2025-01-22 20:01:24.385 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1863, 1868) --> . Mary travelled to the
2025-01-22 20:01:24.385 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary travelled to the office.
2025-01-22 20:01:24.395 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1863, 1868) --> . Mary travelled to the
2025-01-22 20:01:24.395 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John moved to the hallway.
2025-01-22 20:01:24.418 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4380, 4385) --> . John moved to the
2025-01-22 20:01:24.418 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went back to the hallway.
2025-01-22 20:01:24.447 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5220, 5226) --> . Sandra went back to the
2025-01-22 20:01:24.447 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John discarded the apple.
2025-01-22 20:01:24.474 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5842, 5846) -->  John discarded the apple
2025-01-22 20:01:24.474 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John put down the apple there.
2025-01-22 20:01:24.488 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2693, 2699) --> . John put down the apple
2025-01-22 20:01:24.488 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John grabbed the apple.
2025-01-22 20:01:24.497 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1725, 1729) -->  John grabbed the apple
2025-01-22 20:01:24.497 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John moved to the kitchen.
2025-01-22 20:01:24.521 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4380, 4385) --> . John moved to the
2025-01-22 20:01:24.521 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John travelled to the bathroom.
2025-01-22 20:01:24.534 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (1864, 1869) -->  Mary travelled to the bathroom
2025-01-22 20:01:24.534 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  John got the apple.
2025-01-22 20:01:24.569 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (6266, 6270) -->  got the apple.
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:01:25.392 | INFO     | test_jbb_embedding:begin_test:693 - Mary's house.<|eot_id|>
2025-01-22 20:01:25.392 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8213])
2025-01-22 20:01:27.642 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [230.38815789473685, 19.17701169973223, 89.71530330882354, 18.391600246539262, 14.92158435639881], 'topk_indices': array([8101,    1, 8196, 8204, 8111, 8206,  900, 8067, 1868, 8203,   14,
       8201, 8207, 8200,   24,  899, 8208, 8209, 8211,    0]), 'topk_tokens': ['.\n\n', '<|start_header_id|>', ':', '?', ' location', 'Answer', '.', ' context', ' bathroom', ' office', '\n', ' before', ':', ' football', '\n\n', ' football', '<|eot_id|>', '<|start_header_id|>', '<|end_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [556.9375, 185.975, 185.975, 57.975]}, 'weight': {'score': [21.49547697368421, 23.29686739289192, 23.462086397058822, 23.30037210584344, 29.368303571428573], 'topk_indices': array([3266, 3293, 3138, 3186, 7446, 7484, 1484, 1422, 4303, 4319, 5126,
       5187, 7167, 7223, 3449, 3475, 4980, 4897, 4922, 4951]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.611328125, 20.75625, 20.75625, 18.88125]}, 'saliency': {'score': [1.400795384457237, 0.10692977533832614, 0.6023227467256433, 0.10185482647143551, 0.10769144694010417], 'topk_indices': array([8197, 8205, 8194, 8185,  897, 8210, 8204, 8182, 7964,   24,  896,
       8195, 8111, 8067, 8201, 8203, 8206, 1868, 8200,  899]), 'topk_tokens': [' Where', ' \n', '.\n\n', ' directly', ' got', 'assistant', '?', ' return', ' Square', '\n\n', ' Mary', 'Question', ' location', ' context', ' before', ' office', 'Answer', ' bathroom', ' football', ' football'], 'evidence_proportions': [3.86181640625, 0.976708984375, 0.976708984375, 0.2801513671875]}}, 'pred_res': "Mary's house.<|eot_id|>", 'score': 0}
2025-01-22 20:01:27.649 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:01:27.650 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-156_pid-2_1-2-6-8.pkl | len: 3 |  size: 2.04 KB
Processing depth (1, 2, 6, 8):   3%|â–         | 3/100 [00:59<31:11, 19.29s/it]is_0k: False
your chose emoji: ['ğŸ§ğŸ¾\u200dâ™€', 'ğŸ‘¨ğŸ»\u200dğŸ”§', 'ğŸ§œğŸ¿\u200dâ™€ï¸', 'ğŸ§‘ğŸ¾\u200dğŸ”¬', 'ğŸ‘¨ğŸ¼\u200dâ¤ï¸\u200dğŸ‘¨ğŸ¿', 'ğŸ‘©ğŸ½\u200dğŸ¨', 'â™£', 'ğŸ‘®ğŸ»\u200dâ™‚ï¸', 'ğŸ‘‹ğŸ¿', 'ğŸ§•']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.81s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.56s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:03,  3.93s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:12<00:00,  2.55s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:12<00:00,  3.20s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (5, 7, 8, 9):   3%|â–         | 3/100 [01:13<31:11, 19.29s/it]2025-01-22 20:01:42.275 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the football.
2025-01-22 20:01:42.299 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4233, 4237) -->  got the football.
2025-01-22 20:01:42.299 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the bathroom.
2025-01-22 20:01:42.320 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4132, 4137) -->  John travelled to the bathroom
2025-01-22 20:01:42.320 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary travelled to the office.
2025-01-22 20:01:42.347 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5637, 5642) --> . Mary travelled to the
2025-01-22 20:01:42.347 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John moved to the hallway.
2025-01-22 20:01:42.371 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4324, 4329) -->  moved to the kitchen.
2025-01-22 20:01:42.371 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went back to the hallway.
2025-01-22 20:01:42.397 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5068, 5074) --> . Sandra went back to the
2025-01-22 20:01:42.397 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John discarded the apple.
2025-01-22 20:01:42.429 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5644, 5648) -->  John discarded the apple
2025-01-22 20:01:42.429 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John put down the apple there.
2025-01-22 20:01:42.441 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2538, 2544) --> . John put down the apple
2025-01-22 20:01:42.441 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John grabbed the apple.
2025-01-22 20:01:42.448 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1554, 1558) -->  John grabbed the apple
2025-01-22 20:01:42.448 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John moved to the kitchen.
2025-01-22 20:01:42.469 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4323, 4328) -->  John moved to the kitchen
2025-01-22 20:01:42.469 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John travelled to the bathroom.
2025-01-22 20:01:42.493 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (4131, 4136) --> . John travelled to the
2025-01-22 20:01:42.493 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  John got the apple.
2025-01-22 20:01:42.522 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (6144, 6148) -->  got the apple.
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:01:48.113 | INFO     | test_jbb_embedding:begin_test:693 - Mary got the football.<|eot_id|>
2025-01-22 20:01:48.113 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8203])
2025-01-22 20:01:51.448 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [317.4375, 26.022346453814283, 133.30652573529412, 24.895822473322703, 27.482792721518987], 'topk_indices': array([   9, 4231, 8186, 4236, 8188, 8091, 8057,   24, 8101, 8193,   14,
       8191, 4235, 7948, 8190, 4232, 4233, 8201,    0, 8198]), 'topk_tokens': [':', '!', ':', '.', ' was', '.\n\n', ' context', '\n\n', ' location', ' office', '\n', ' before', ' football', ' Square', ' football', ' Mary', ' got', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [753.0, 284.95, 194.3625, 124.55]}, 'weight': {'score': [21.817845394736842, 23.29054959785523, 23.21714154411765, 23.294287762173433, 29.424446202531644], 'topk_indices': array([3344, 3317, 3189, 3237, 7450, 7488, 1451, 1513, 4333, 4349, 5157,
       5218, 7227, 7171, 3500, 3526, 4921, 4998, 4969, 4946]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.828125, 25.6796875, 20.75625, 19.809375]}, 'saliency': {'score': [1.954615542763158, 0.14703641366644832, 0.8072994456571692, 0.14007051810156154, 0.20301587068581883], 'topk_indices': array([8188, 8172, 8100,    0, 4231,   24, 8187, 7947, 8185, 5642, 8057,
       4136, 8101, 8191, 8193, 7948, 4235, 4233, 8190, 4232]), 'topk_tokens': [' was', ' return', ' first', '<|begin_of_text|>', '!', '\n\n', ' Where', 'Bridge', 'Question', ' bathroom', ' context', ' bathroom', ' location', ' before', ' office', ' Square', ' football', ' got', ' football', ' Mary'], 'evidence_proportions': [4.505615234375, 2.084375, 1.094921875, 0.64375]}}, 'pred_res': 'Mary got the football.<|eot_id|>', 'score': 0}
2025-01-22 20:01:51.455 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:01:51.455 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-156_pid-3_5-7-8-9.pkl | len: 3 |  size: 2.03 KB
Processing depth (5, 7, 8, 9):   4%|â–         | 4/100 [01:22<33:43, 21.07s/it]is_0k: False
your chose emoji: ['ğŸ§˜ğŸ¿\u200dâ™€', 'ğŸ‘®ğŸ½', 'ğŸ‘©ğŸ»\u200dâ¤\u200dğŸ‘©ğŸ¿', 'ğŸ¬', 'ğŸƒğŸ¿\u200dâ™‚ï¸\u200dâ¡ï¸', 'ğŸƒğŸ½\u200dâ™€', 'ğŸ§‘ğŸ¾\u200dğŸ¦°', 'ğŸ‡§ğŸ‡³', 'ğŸ‘¢', 'ğŸ¤¹ğŸ¾']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.10s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.31s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.60s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.16s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.61s/it]
Processing depth (2, 3, 4, 5):   4%|â–         | 4/100 [01:39<33:43, 21.07s/it]2025-01-22 20:02:07.749 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the football.
2025-01-22 20:02:07.758 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1853, 1857) -->  Mary got the football
2025-01-22 20:02:07.759 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the bathroom.
2025-01-22 20:02:07.774 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2977, 2982) -->  tragedy. Mary travelled to
2025-01-22 20:02:07.774 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary travelled to the office.
2025-01-22 20:02:07.788 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2977, 2982) -->  tragedy. Mary travelled to
2025-01-22 20:02:07.789 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John moved to the hallway.
2025-01-22 20:02:07.811 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4256, 4261) --> . John moved to the
2025-01-22 20:02:07.811 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went back to the hallway.
2025-01-22 20:02:07.842 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5204, 5210) --> . Sandra went back to the
2025-01-22 20:02:07.842 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John discarded the apple.
2025-01-22 20:02:07.876 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5818, 5822) -->  John discarded the apple
2025-01-22 20:02:07.876 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John put down the apple there.
2025-01-22 20:02:07.889 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2681, 2687) --> . John put down the apple
2025-01-22 20:02:07.890 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John grabbed the apple.
2025-01-22 20:02:07.898 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1714, 1718) -->  John grabbed the apple
2025-01-22 20:02:07.898 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John moved to the kitchen.
2025-01-22 20:02:07.921 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4256, 4261) --> . John moved to the
2025-01-22 20:02:07.921 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John travelled to the bathroom.
2025-01-22 20:02:07.938 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (2979, 2984) -->  Mary travelled to the bathroom
2025-01-22 20:02:07.938 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  John got the apple.
2025-01-22 20:02:07.968 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (6289, 6293) -->  John got the apple
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:02:08.834 | INFO     | test_jbb_embedding:begin_test:693 - Mary got the football.<|eot_id|>
2025-01-22 20:02:08.834 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8185])
2025-01-22 20:02:11.064 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [138.81620065789474, 13.944177073155839, 81.41176470588235, 13.370548747695144, 6.907784598214286], 'topk_indices': array([   1, 8181,   23,   28, 8168, 8083, 8179, 8166,   14, 8039,   24,
       1856, 8176, 8172, 8173, 8175, 2983, 8180,    0, 8183]), 'topk_tokens': ['<|start_header_id|>', '<|start_header_id|>', '4', '<|end_header_id|>', ':', ' location', ':', '.\n\n', '\n', ' context', '\n\n', ' football', '?', ' football', ' before', ' office', ' bathroom', '<|eot_id|>', '<|begin_of_text|>', '<|end_header_id|>'], 'evidence_proportions': [323.0, 123.18125, 123.18125, 22.7390625]}, 'weight': {'score': [24.552220394736842, 23.27981115657059, 24.029871323529413, 23.273704479102644, 29.58504464285714], 'topk_indices': array([3287, 3260, 3132, 3180, 7428, 7466, 1411, 1473, 4267, 4283, 5171,
       5110, 7167, 7111, 3443, 3469, 4964, 4935, 4887, 4912]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.611328125, 26.5640625, 26.5640625, 18.88125]}, 'saliency': {'score': [0.8834453381990132, 0.07786250708449102, 0.5722440831801471, 0.07391474465321528, 0.05159541538783482], 'topk_indices': array([  19, 8037,   23,   20, 8154, 7764, 8166, 8178,   24, 8169, 8167,
       8176, 8083, 7765, 8039, 8173, 8175, 1856, 8172, 2983]), 'topk_tokens': ['26', ' provided', '4', ' Jul', ' return', ' genu', '.\n\n', 'Answer', '\n\n', ' Where', 'Question', '?', ' location', 'inen', ' context', ' before', ' office', ' football', ' football', ' bathroom'], 'evidence_proportions': [2.1685791015625, 0.758544921875, 0.758544921875, 0.10513916015625]}}, 'pred_res': 'Mary got the football.<|eot_id|>', 'score': 0}
2025-01-22 20:02:11.071 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:02:11.071 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-156_pid-4_2-3-4-5.pkl | len: 3 |  size: 2.05 KB
Processing depth (2, 3, 4, 5):   5%|â–Œ         | 5/100 [01:42<32:32, 20.55s/it]Processing depth (2, 3, 4, 5):   5%|â–Œ         | 5/100 [01:42<32:27, 20.50s/it]
2025-01-22 20:02:11.135 | INFO     | __main__:<module>:82 - Selected idx: 158
2025-01-22 20:02:11.135 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the football before the office? 
2025-01-22 20:02:11.135 | INFO     | __main__:<module>:84 - Answer: bathroom
2025-01-22 20:02:11.135 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 20:02:11.136 | INFO     | __main__:<module>:86 - Needle: [' John travelled to the bathroom.', ' Mary grabbed the football.', ' Sandra went back to the hallway.', ' Mary travelled to the bathroom.', ' John moved to the kitchen.', ' Mary travelled to the office.', ' John grabbed the apple.']
2025-01-22 20:02:11.136 | INFO     | __main__:<module>:87 - Real Needle: [' Mary grabbed the football.', ' Mary travelled to the bathroom.', ' Mary travelled to the office.', ' John grabbed the apple.']
2025-01-22 20:02:11.136 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ‡µğŸ‡±', 'ğŸ‘³', 'ğŸ‘¤', 'ğŸƒğŸ¼\u200dâ™‚ï¸\u200dâ¡', 'ğŸƒ\u200dâ™‚\u200dâ¡ï¸', '7ï¸âƒ£', 'ğŸ¤ğŸ»', 'ğŸ¤ğŸ¾', 'ğŸ§‘ğŸ¿\u200dğŸ¦¯\u200dâ¡', 'ğŸ¤¹\u200dâ™€']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  4.00s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.30s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.33s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.00s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.46s/it]
Processing depth (0, 3, 4, 9):   0%|          | 0/100 [00:15<?, ?it/s]2025-01-22 20:02:26.743 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the football.
2025-01-22 20:02:26.786 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the bathroom.
2025-01-22 20:02:26.801 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2934, 2939) --> . Mary travelled to the
2025-01-22 20:02:26.802 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary travelled to the office.
2025-01-22 20:02:26.819 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2934, 2939) --> . Mary travelled to the
2025-01-22 20:02:26.819 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John grabbed the apple.
2025-01-22 20:02:26.854 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7119, 7123) -->  grabbed the apple.
2025-01-22 20:02:26.855 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the bathroom.
2025-01-22 20:02:26.871 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2935, 2940) -->  Mary travelled to the bathroom
2025-01-22 20:02:26.871 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the hallway.
2025-01-22 20:02:26.905 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5746, 5752) --> . Sandra went back to the
2025-01-22 20:02:26.905 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the kitchen.
2025-01-22 20:02:26.911 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1264, 1269) --> . John moved to the
2025-01-22 20:02:26.911 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 20:02:26.912 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 20:02:26.912 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 20:02:26.912 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸš¶\u200dâ¡ï¸', 'ğŸ‘¨ğŸ¾\u200dğŸ”§', 'ğŸ¥²', 'ğŸš£\u200dâ™‚', 'ğŸ™ğŸ»', 'ğŸš¶ğŸ»\u200dâ™‚', 'ğŸ‡±ğŸ‡¹', 'ğŸƒğŸ¿', 'ğŸ‘©ğŸ½\u200dğŸ¦½', 'ğŸ‘©\u200dâ¤\u200dğŸ‘©']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.52s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.38s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.24s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.94s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.46s/it]
Processing depth (2, 4, 5, 8):   0%|          | 0/100 [00:31<?, ?it/s]2025-01-22 20:02:42.525 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the football.
2025-01-22 20:02:42.534 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1743, 1747) -->  grabbed the football.
2025-01-22 20:02:42.534 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the bathroom.
2025-01-22 20:02:42.552 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3594, 3599) --> . Mary travelled to the
2025-01-22 20:02:42.553 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary travelled to the office.
2025-01-22 20:02:42.570 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3594, 3599) --> . Mary travelled to the
2025-01-22 20:02:42.571 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John grabbed the apple.
2025-01-22 20:02:42.602 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6510, 6514) -->  John grabbed the apple
2025-01-22 20:02:42.602 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the bathroom.
2025-01-22 20:02:42.620 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3595, 3600) -->  Mary travelled to the bathroom
2025-01-22 20:02:42.620 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the hallway.
2025-01-22 20:02:42.649 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5792, 5798) --> . Sandra went back to the
2025-01-22 20:02:42.649 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the kitchen.
2025-01-22 20:02:42.655 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1228, 1233) -->  Republican. John moved to
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:02:43.425 | INFO     | test_jbb_embedding:begin_test:693 - the bathroom<|eot_id|>
2025-01-22 20:02:43.425 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8148])
2025-01-22 20:02:45.637 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [181.69618055555554, 18.044749110538586, 184.6328125, 17.353467260071454, 24.63440910218254], 'topk_indices': array([8142, 8147, 8036, 8002, 1234,   23,   24, 8129, 1745, 8135, 8046,
       8139, 8144, 8136,   14, 8138, 3599, 8146,    0, 8143]), 'topk_tokens': [':', '\n\n', '.\n\n', ' context', ' kitchen', '4', '\n\n', '.\n\n', ' football', ' football', ' location', '?', '<|start_header_id|>', ' before', '\n', ' office', ' bathroom', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [289.09375, 198.9875, 198.9875, 31.0703125]}, 'weight': {'score': [22.537760416666668, 23.27021991166728, 23.8798828125, 23.27064244024886, 29.566964285714285], 'topk_indices': array([3278, 3305, 3198, 3150, 7397, 7435, 1431, 1493, 4291, 4275, 5147,
       5086, 7118, 7174, 3461, 3487, 4863, 4911, 4940, 4888]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.48046875, 20.75625, 20.75625, 27.048828125]}, 'saliency': {'score': [1.0125495062934027, 0.10133710198278968, 1.1992759704589844, 0.09715220052003126, 0.17923336937313988], 'topk_indices': array([8132, 8042, 8117, 1162, 8129, 1743, 1142, 8130, 8141, 8139, 1231,
       8002, 4057, 1234, 8046, 8136, 1745, 8135, 8138, 3599]), 'topk_tokens': [' Where', ' item', ' return', 'nes', '.\n\n', ' grabbed', 'nes', 'Question', 'Answer', '?', ' moved', ' context', ' bathroom', ' kitchen', ' location', ' before', ' football', ' football', ' office', ' bathroom'], 'evidence_proportions': [1.802001953125, 1.014794921875, 1.014794921875, 0.2174835205078125]}}, 'pred_res': 'the bathroom<|eot_id|>', 'score': 100}
2025-01-22 20:02:45.641 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:02:45.642 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-158_pid-0_2-4-5-8.pkl | len: 3 |  size: 2.04 KB
Processing depth (2, 4, 5, 8):   1%|          | 1/100 [00:34<56:46, 34.41s/it]is_0k: False
your chose emoji: ['ğŸ‘¦ğŸ¿', 'ğŸ§ğŸ¼\u200dâ™€ï¸', 'ğŸ¥®', 'ğŸ•¶ï¸', 'ğŸ•µğŸ¼', 'ğŸ‘±ğŸ½\u200dâ™‚ï¸', 'ğŸ§™ğŸ»\u200dâ™€ï¸', 'ğŸ› ï¸', 'ğŸ‘©\u200dğŸ“', 'ğŸ’‚ğŸ¿']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.35s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.79s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.62s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.14s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.69s/it]
Processing depth (1, 2, 7, 9):   1%|          | 1/100 [00:50<56:46, 34.41s/it]2025-01-22 20:03:02.177 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the football.
2025-01-22 20:03:02.181 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (792, 796) -->  Mary grabbed the football
2025-01-22 20:03:02.182 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the bathroom.
2025-01-22 20:03:02.190 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1814, 1819) --> . Mary travelled to the
2025-01-22 20:03:02.190 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary travelled to the office.
2025-01-22 20:03:02.199 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1814, 1819) --> . Mary travelled to the
2025-01-22 20:03:02.199 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John grabbed the apple.
2025-01-22 20:03:02.233 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7179, 7183) -->  grabbed the apple.
2025-01-22 20:03:02.233 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the bathroom.
2025-01-22 20:03:02.242 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1815, 1820) -->  Mary travelled to the bathroom
2025-01-22 20:03:02.242 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the hallway.
2025-01-22 20:03:02.272 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6113, 6119) -->  Sandra went back to the hallway
2025-01-22 20:03:02.272 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the kitchen.
2025-01-22 20:03:02.277 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1140, 1145) --> . John moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:03:03.113 | INFO     | test_jbb_embedding:begin_test:693 - Mary's house.<|eot_id|>
2025-01-22 20:03:03.113 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8224])
2025-01-22 20:03:05.347 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [464.28125, 37.71903108666586, 266.08203125, 36.335907939704626, 24.68508276608911], 'topk_indices': array([8206, 8205, 8214,   14, 8121, 8078, 8207, 8215,  793, 8217, 8112,
       8220,  796, 8212, 8219, 8218, 8211, 8122,  795,    0]), 'topk_tokens': ['Question', '.\n\n', ' office', '\n', ' first', ' context', ':', '?', ' grabbed', 'Answer', '.\n\n', '<|start_header_id|>', '.', ' before', '<|eot_id|>', ':', ' football', ' location', ' football', '<|begin_of_text|>'], 'evidence_proportions': [1044.75, 374.925, 374.925, 107.203125]}, 'weight': {'score': [22.75043402777778, 23.333057311292087, 24.2705078125, 23.332506598620775, 29.757116336633665], 'topk_indices': array([3312, 3339, 3184, 3232, 7505, 7467, 1512, 1450, 4313, 4297, 5205,
       5144, 7188, 7244, 3495, 3521, 4998, 4969, 4946, 4921]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.263671875, 20.75625, 20.75625, 22.22265625]}, 'saliency': {'score': [3.06561279296875, 0.212457421542634, 1.7974700927734375, 0.203093696481562, 0.18821202646387686], 'topk_indices': array([8218, 8124, 8193, 4131, 8116, 8112, 8118, 8215,  792, 8214, 8121,
       8206, 8212, 1819, 8078, 8217,  793, 8122, 8211,  795]), 'topk_tokens': [':', ' traveled', ' return', ' bathroom', ' obtained', '.\n\n', ' item', '?', ' Mary', ' office', ' first', 'Question', ' before', ' bathroom', ' context', 'Answer', ' grabbed', ' location', ' football', ' football'], 'evidence_proportions': [7.8291015625, 2.13046875, 2.13046875, 0.639984130859375]}}, 'pred_res': "Mary's house.<|eot_id|>", 'score': 0}
2025-01-22 20:03:05.355 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:03:05.356 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-158_pid-1_1-2-7-9.pkl | len: 3 |  size: 2.03 KB
Processing depth (1, 2, 7, 9):   2%|â–         | 2/100 [00:54<42:05, 25.77s/it]is_0k: False
your chose emoji: ['ğŸ§‘\u200dâœˆï¸', 'ğŸƒğŸ»\u200dâ™€\u200dâ¡', 'ğŸ‡ºğŸ‡¦', 'ğŸ‹ğŸ¼\u200dâ™‚ï¸', 'ğŸ§‘ğŸ¾\u200dâ¤ï¸\u200dğŸ§‘ğŸ»', 'ğŸ‘¨\u200dğŸ‘©\u200dğŸ‘§\u200dğŸ‘§', 'ğŸ§–ğŸ»\u200dâ™‚ï¸', 'ğŸ¤¾ğŸ¿\u200dâ™€', 'ğŸ‘¨ğŸ½\u200dğŸ¦°', 'ğŸ§˜ğŸ¾\u200dâ™€']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  3.82s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.39s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.41s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.10s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.53s/it]
Processing depth (0, 3, 4, 8):   2%|â–         | 2/100 [01:09<42:05, 25.77s/it]2025-01-22 20:03:21.267 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the football.
2025-01-22 20:03:21.307 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the bathroom.
2025-01-22 20:03:21.325 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2977, 2982) -->  tragedy. Mary travelled to
2025-01-22 20:03:21.325 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary travelled to the office.
2025-01-22 20:03:21.340 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2977, 2982) -->  tragedy. Mary travelled to
2025-01-22 20:03:21.341 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John grabbed the apple.
2025-01-22 20:03:21.377 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6668, 6672) -->  John grabbed the apple
2025-01-22 20:03:21.377 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the bathroom.
2025-01-22 20:03:21.392 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2979, 2984) -->  Mary travelled to the bathroom
2025-01-22 20:03:21.392 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the hallway.
2025-01-22 20:03:21.423 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5856, 5862) --> . Sandra went back to the
2025-01-22 20:03:21.423 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the kitchen.
2025-01-22 20:03:21.431 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1264, 1269) --> . John moved to the
2025-01-22 20:03:21.432 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 20:03:21.432 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 20:03:21.432 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 20:03:21.432 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ§‘ğŸ»\u200dâ¤\u200dğŸ§‘ğŸ¾', 'ğŸ§‘ğŸ¾\u200dğŸ¦±', 'ğŸ‡²ğŸ‡»', 'ğŸ¤¸ğŸ½\u200dâ™‚', 'ğŸ‘©ğŸ»\u200dğŸ¤', 'ğŸ§‘ğŸ¿\u200dğŸ¤\u200dğŸ§‘ğŸ¼', 'ğŸ™‚\u200dâ†”ï¸', 'ğŸ™ğŸ½\u200dâ™‚ï¸', 'ğŸ§‘ğŸ¿\u200dâš–ï¸', 'ğŸ§™ğŸ¾\u200dâ™‚ï¸']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.55s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.33s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.03s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.85s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.36s/it]
Processing depth (0, 1, 3, 4):   2%|â–         | 2/100 [01:25<42:05, 25.77s/it]2025-01-22 20:03:36.753 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the football.
2025-01-22 20:03:36.792 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the bathroom.
2025-01-22 20:03:36.797 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (900, 905) --> . Mary travelled to the
2025-01-22 20:03:36.797 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary travelled to the office.
2025-01-22 20:03:36.802 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (900, 905) --> . Mary travelled to the
2025-01-22 20:03:36.803 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John grabbed the apple.
2025-01-22 20:03:36.824 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3727, 3731) -->  John grabbed the apple
2025-01-22 20:03:36.824 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the bathroom.
2025-01-22 20:03:36.828 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (901, 906) -->  Mary travelled to the bathroom
2025-01-22 20:03:36.828 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the hallway.
2025-01-22 20:03:36.858 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6102, 6108) -->  Sandra went back to the hallway
2025-01-22 20:03:36.858 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the kitchen.
2025-01-22 20:03:36.864 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1270, 1275) --> . John moved to the
2025-01-22 20:03:36.865 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 20:03:36.865 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 20:03:36.865 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 20:03:36.865 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ‘¨ğŸ»\u200dâ¤\u200dğŸ‘¨ğŸ¼', 'ğŸ§‘ğŸ½\u200dğŸ¤\u200dğŸ§‘ğŸ»', 'ğŸ™…\u200dâ™€ï¸', 'ğŸ‘¨ğŸ»\u200dğŸ¦¯\u200dâ¡ï¸', 'ğŸ¦¸ğŸ¾\u200dâ™‚ï¸', 'ğŸ™…ğŸ¼\u200dâ™€', 'ğŸ™†ğŸ¿\u200dâ™‚', 'ğŸ™‹ğŸ¿\u200dâ™€', 'ğŸƒğŸ½\u200dâ™€', 'ğŸš¶ğŸ½\u200dâ™€\u200dâ¡']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.34s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.66s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.46s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.09s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.61s/it]
Processing depth (1, 5, 6, 8):   2%|â–         | 2/100 [01:42<42:05, 25.77s/it]2025-01-22 20:03:53.520 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the football.
2025-01-22 20:03:53.525 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (828, 832) -->  Mary grabbed the football
2025-01-22 20:03:53.525 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the bathroom.
2025-01-22 20:03:53.548 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4099, 4104) -->  John travelled to the bathroom
2025-01-22 20:03:53.549 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary travelled to the office.
2025-01-22 20:03:53.570 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4224, 4229) -->  travelled to the bathroom.
2025-01-22 20:03:53.572 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John grabbed the apple.
2025-01-22 20:03:53.604 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6636, 6640) -->  John grabbed the apple
2025-01-22 20:03:53.604 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the bathroom.
2025-01-22 20:03:53.633 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4098, 4103) --> . John travelled to the
2025-01-22 20:03:53.633 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the hallway.
2025-01-22 20:03:53.664 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6085, 6091) -->  Sandra went back to the hallway
2025-01-22 20:03:53.664 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the kitchen.
2025-01-22 20:03:53.670 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1237, 1242) -->  Republican. John moved to
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:03:54.502 | INFO     | test_jbb_embedding:begin_test:693 - Mary's house.<|eot_id|>
2025-01-22 20:03:54.502 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8158])
2025-01-22 20:03:56.716 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [342.14409722222223, 27.56693228464649, 201.9375, 26.52690299310939, 41.512522977941174], 'topk_indices': array([8055,   14, 8151, 8139, 8046, 8012, 8141, 8156, 8148, 8149,   24,
        832, 8152, 8146,  831, 8056, 8154, 8145, 8153,    0]), 'topk_tokens': [' first', '\n', 'Answer', '.\n\n', '.\n\n', ' context', ':', '<|end_header_id|>', ' office', '?', '\n\n', '.', ':', ' before', ' football', ' location', '<|start_header_id|>', ' football', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [593.5, 367.425, 326.575, 78.6484375]}, 'weight': {'score': [25.485677083333332, 23.2751769084671, 23.767578125, 23.269311592531068, 29.401424632352942], 'topk_indices': array([3266, 3293, 3138, 3186, 7391, 7429, 1490, 1428, 4275, 4291, 5165,
       5104, 7156, 7100, 3475, 3449, 4958, 4881, 4906, 4929]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.263671875, 25.6796875, 21.81875, 27.048828125]}, 'saliency': {'score': [2.4203355577256946, 0.15585299102629885, 1.1798095703125, 0.14882161518414697, 0.30323230519014244], 'topk_indices': array([ 828, 8127,   24, 4100,  232, 8149, 7895, 8055, 8052, 8140,  829,
       8151, 8012, 4103, 8148, 4227, 8146, 8056,  831, 8145]), 'topk_tokens': [' Mary', ' return', '\n\n', ' travelled', 'ï¿½', '?', ' Square', ' first', ' item', 'Question', ' grabbed', 'Answer', ' context', ' bathroom', ' office', ' bathroom', ' before', ' location', ' football', ' football'], 'evidence_proportions': [4.43310546875, 2.59638671875, 2.126220703125, 0.555145263671875]}}, 'pred_res': "Mary's house.<|eot_id|>", 'score': 0}
2025-01-22 20:03:56.724 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:03:56.724 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-158_pid-2_1-5-6-8.pkl | len: 3 |  size: 2.03 KB
Processing depth (1, 5, 6, 8):   3%|â–         | 3/100 [01:45<1:00:33, 37.46s/it]is_0k: False
your chose emoji: ['ğŸ¤˜', 'ğŸ‘°ğŸ¼', 'ğŸ‡ºğŸ‡¬', 'ğŸ¤¾ğŸ»\u200dâ™€ï¸', 'âš™', 'ğŸ³\u200dğŸŒˆ', 'ğŸš´ğŸ¼\u200dâ™€ï¸', 'ğŸ§ğŸ»\u200dâ¡', 'ğŸ¥·ğŸ¿', 'ğŸ™‡ğŸ¿\u200dâ™‚ï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.15s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.27s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.23s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.96s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.42s/it]
Processing depth (0, 2, 6, 7):   3%|â–         | 3/100 [02:00<1:00:33, 37.46s/it]2025-01-22 20:04:12.220 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the football.
2025-01-22 20:04:12.259 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the bathroom.
2025-01-22 20:04:12.269 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1878, 1883) --> . Mary travelled to the
2025-01-22 20:04:12.269 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary travelled to the office.
2025-01-22 20:04:12.278 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1878, 1883) --> . Mary travelled to the
2025-01-22 20:04:12.278 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John grabbed the apple.
2025-01-22 20:04:12.306 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5725, 5729) -->  John grabbed the apple
2025-01-22 20:04:12.306 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the bathroom.
2025-01-22 20:04:12.315 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1879, 1884) -->  Mary travelled to the bathroom
2025-01-22 20:04:12.315 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the hallway.
2025-01-22 20:04:12.347 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6086, 6092) -->  Sandra went back to the hallway
2025-01-22 20:04:12.348 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the kitchen.
2025-01-22 20:04:12.354 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1264, 1269) --> . John moved to the
2025-01-22 20:04:12.354 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 20:04:12.354 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 20:04:12.354 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 20:04:12.354 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ¤˜', 'ğŸš´ğŸ»', 'ğŸ¦¿', 'ğŸ™…ğŸ½\u200dâ™€ï¸', 'â™', 'âš ', 'ğŸ‘©ğŸ¾\u200dâ¤ï¸\u200dğŸ‘©ğŸ¿', 'ğŸš', 'ğŸ§‘ğŸ¾\u200dâœˆ', 'ğŸ‡ğŸ¾']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.32s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.36s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.27s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.99s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.48s/it]
Processing depth (0, 5, 7, 8):   3%|â–         | 3/100 [02:16<1:00:33, 37.46s/it]2025-01-22 20:04:27.970 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the football.
2025-01-22 20:04:28.010 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the bathroom.
2025-01-22 20:04:28.032 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4065, 4070) -->  John travelled to the bathroom
2025-01-22 20:04:28.033 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary travelled to the office.
2025-01-22 20:04:28.056 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4178, 4183) --> . Mary travelled to the
2025-01-22 20:04:28.057 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John grabbed the apple.
2025-01-22 20:04:28.088 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6664, 6668) -->  John grabbed the apple
2025-01-22 20:04:28.088 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the bathroom.
2025-01-22 20:04:28.109 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4064, 4069) --> . John travelled to the
2025-01-22 20:04:28.109 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the hallway.
2025-01-22 20:04:28.139 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6101, 6107) -->  Sandra went back to the hallway
2025-01-22 20:04:28.139 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the kitchen.
2025-01-22 20:04:28.145 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1225, 1230) -->  Republican. John moved to
2025-01-22 20:04:28.145 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 20:04:28.145 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 20:04:28.145 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 20:04:28.145 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ™†ğŸ¼', 'ğŸ§‘ğŸ»\u200dğŸ¦¯\u200dâ¡ï¸', 'ğŸ¤¸ğŸ½\u200dâ™‚', 'ğŸ‘¨ğŸ½\u200dâ¤\u200dğŸ‘¨ğŸ½', 'ğŸ§ğŸ½\u200dâ™€\u200dâ¡ï¸', 'ğŸ‘¨ğŸ¼\u200dğŸ¦¯', 'ğŸ¥“', 'ğŸ¥¥', 'ğŸ§˜\u200dâ™‚ï¸', 'ğŸ¤½\u200dâ™€']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.43s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:10,  5.39s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.81s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.32s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.91s/it]
Processing depth (1, 2, 3, 7):   3%|â–         | 3/100 [02:34<1:00:33, 37.46s/it]2025-01-22 20:04:45.647 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the football.
2025-01-22 20:04:45.650 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (776, 780) -->  Mary grabbed the football
2025-01-22 20:04:45.651 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the bathroom.
2025-01-22 20:04:45.659 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1798, 1803) --> . Mary travelled to the
2025-01-22 20:04:45.660 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary travelled to the office.
2025-01-22 20:04:45.669 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1798, 1803) --> . Mary travelled to the
2025-01-22 20:04:45.669 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John grabbed the apple.
2025-01-22 20:04:45.695 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5637, 5641) -->  John grabbed the apple
2025-01-22 20:04:45.696 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the bathroom.
2025-01-22 20:04:45.704 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1799, 1804) -->  Mary travelled to the bathroom
2025-01-22 20:04:45.705 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the hallway.
2025-01-22 20:04:45.733 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5813, 5819) --> . Sandra went back to the
2025-01-22 20:04:45.733 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the kitchen.
2025-01-22 20:04:45.738 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1124, 1129) --> . John moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:04:46.568 | INFO     | test_jbb_embedding:begin_test:693 - Mary's house.<|eot_id|>
2025-01-22 20:04:46.568 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8172])
2025-01-22 20:04:48.799 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [359.19444444444446, 29.00584480122324, 217.1318359375, 27.90605231236949, 21.518880208333332], 'topk_indices': array([  14,   24, 8153, 1803, 8060, 8163, 8165, 8162, 8155,  780, 8170,
        146, 8160, 8166, 8070,  779, 8168, 8167, 8159,    0]), 'topk_tokens': ['\n', '\n\n', '.\n\n', ' bathroom', '.\n\n', '?', 'Answer', ' office', ':', '.', '<|end_header_id|>', 'ï¿½', ' before', ':', ' location', ' football', '<|start_header_id|>', '<|eot_id|>', ' football', '<|begin_of_text|>'], 'evidence_proportions': [736.8125, 323.6, 323.6, 70.5625]}, 'weight': {'score': [23.822916666666668, 23.29058868501529, 22.36572265625, 23.2912293867461, 29.669583333333332], 'topk_indices': array([3311, 3284, 3192, 3144, 7439, 7401, 1434, 1496, 4287, 4303, 5120,
       5181, 7108, 7164, 3467, 3493, 4945, 4912, 4887, 4974]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.263671875, 20.75625, 20.75625, 27.048828125]}, 'saliency': {'score': [2.319369845920139, 0.16290025623566515, 1.4084587097167969, 0.15568426460441362, 0.1581732177734375], 'topk_indices': array([8166, 8153,  776, 8060, 8066, 8141, 8156, 8026, 8163, 8069,  146,
       8154,  777, 8162, 8160, 8165, 1803, 8070,  779, 8159]), 'topk_tokens': [':', '.\n\n', ' Mary', '.\n\n', ' item', ' return', ' Where', ' context', '?', ' first', 'ï¿½', 'Question', ' grabbed', ' office', ' before', 'Answer', ' bathroom', ' location', ' football', ' football'], 'evidence_proportions': [5.484619140625, 1.78369140625, 1.78369140625, 0.493316650390625]}}, 'pred_res': "Mary's house.<|eot_id|>", 'score': 0}
2025-01-22 20:04:48.808 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:04:48.808 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-158_pid-3_1-2-3-7.pkl | len: 3 |  size: 2.01 KB
Processing depth (1, 2, 3, 7):   4%|â–         | 4/100 [02:37<1:09:10, 43.23s/it]is_0k: False
your chose emoji: ['ğŸ¤¾ğŸ¿\u200dâ™€ï¸', 'ğŸ¦µğŸ¾', 'ğŸ¤¾', 'ğŸ§–\u200dâ™€ï¸', 'ğŸ‡¨ğŸ‡´', 'ğŸ§šğŸ¼\u200dâ™‚', 'ğŸ»\u200dâ„ï¸', 'ğŸ¤¾ğŸ¿\u200dâ™‚', 'ğŸ‡°ğŸ‡­', 'ğŸ‘©ğŸ½\u200dâ¤\u200dğŸ‘¨ğŸ¿']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.44s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.52s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.26s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.94s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.47s/it]
Processing depth (1, 2, 5, 7):   4%|â–         | 4/100 [02:53<1:09:10, 43.23s/it]2025-01-22 20:05:04.582 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the football.
2025-01-22 20:05:04.586 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (792, 796) -->  Mary grabbed the football
2025-01-22 20:05:04.586 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the bathroom.
2025-01-22 20:05:04.595 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1758, 1763) --> . Mary travelled to the
2025-01-22 20:05:04.595 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary travelled to the office.
2025-01-22 20:05:04.604 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1758, 1763) --> . Mary travelled to the
2025-01-22 20:05:04.604 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John grabbed the apple.
2025-01-22 20:05:04.633 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5681, 5685) -->  John grabbed the apple
2025-01-22 20:05:04.633 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the bathroom.
2025-01-22 20:05:04.642 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1759, 1764) -->  Mary travelled to the bathroom
2025-01-22 20:05:04.642 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the hallway.
2025-01-22 20:05:04.671 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5857, 5863) --> . Sandra went back to the
2025-01-22 20:05:04.672 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the kitchen.
2025-01-22 20:05:04.677 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1090, 1095) --> . John moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:05:05.505 | INFO     | test_jbb_embedding:begin_test:693 - Mary's location.<|eot_id|>
2025-01-22 20:05:05.505 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8214])
2025-01-22 20:05:07.918 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [314.86805555555554, 27.272426828526225, 219.81640625, 26.26333175485763, 50.03961181640625], 'topk_indices': array([8195, 8197, 8199,   14,  793, 1543, 1763,  636,  647, 8205, 8112,
        796,  795, 8202,  646, 8204, 8210, 8201, 8209,    0]), 'topk_tokens': ['.\n\n', ':', ' was', '\n', ' grabbed', 'ot', ' bathroom', 'ï¿½', 'ï¿½', '?', ' location', '.', ' football', ' before', 'ï¿½', ' office', '<|start_header_id|>', ' football', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [653.25, 265.55, 265.55, 99.78125]}, 'weight': {'score': [23.822916666666668, 23.33142037848363, 22.36572265625, 23.332227445618965, 30.021647135416668], 'topk_indices': array([3343, 3316, 3188, 3236, 7475, 7437, 1456, 1518, 4353, 4369, 5225,
       5164, 7214, 7158, 3525, 3499, 4941, 4966, 5018, 4989]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.263671875, 20.75625, 20.75625, 27.048828125]}, 'saliency': {'score': [2.0635172526041665, 0.1556634771805023, 1.4048004150390625, 0.14902440117373672, 0.3816792170206706], 'topk_indices': array([1510,  637, 1543,  636,  644, 8196, 8205,  634,  643, 1542,  641,
        793,  646, 8112, 1763, 8202,  647, 8204,  795, 8201]), 'topk_tokens': ['nes', 'ï¿½', 'ot', 'ï¿½', 'ï¿½', 'Question', '?', 'ï¿½', '\u200d', 'nes', 'â¤', ' grabbed', 'ï¿½', ' location', ' bathroom', ' before', 'ï¿½', ' office', ' football', ' football'], 'evidence_proportions': [4.91015625, 1.4740234375, 1.4740234375, 0.69061279296875]}}, 'pred_res': "Mary's location.<|eot_id|>", 'score': 0}
2025-01-22 20:05:07.924 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:05:07.925 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-158_pid-4_1-2-5-7.pkl | len: 3 |  size: 1.99 KB
Processing depth (1, 2, 5, 7):   5%|â–Œ         | 5/100 [02:56<54:40, 34.54s/it]  Processing depth (1, 2, 5, 7):   5%|â–Œ         | 5/100 [02:56<55:58, 35.35s/it]
2025-01-22 20:05:07.989 | INFO     | __main__:<module>:82 - Selected idx: 160
2025-01-22 20:05:07.989 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the football before the kitchen? 
2025-01-22 20:05:07.989 | INFO     | __main__:<module>:84 - Answer: bathroom
2025-01-22 20:05:07.989 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 20:05:07.989 | INFO     | __main__:<module>:86 - Needle: [' Sandra travelled to the office.', ' Daniel went to the kitchen.', ' Mary took the football.', ' John got the apple.', ' Mary went to the bathroom.', ' Daniel journeyed to the bedroom.', ' John discarded the apple.', ' Mary journeyed to the kitchen.', ' Daniel moved to the bedroom.']
2025-01-22 20:05:07.989 | INFO     | __main__:<module>:87 - Real Needle: [' Mary took the football.', ' Mary went to the bathroom.', ' Mary journeyed to the kitchen.', ' Daniel moved to the bedroom.']
2025-01-22 20:05:07.989 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ‘ğŸ¼', 'ğŸƒğŸ»\u200dâ™‚ï¸\u200dâ¡ï¸', 'ğŸ¤', 'ğŸ‡§ğŸ‡¯', 'ğŸ§ğŸ½\u200dâ™‚ï¸\u200dâ¡ï¸', 'ğŸ–Šï¸', 'ğŸŠğŸ¼\u200dâ™‚', 'ğŸ‡¾ğŸ‡¹', 'ğŸ‘©ğŸ½\u200dâ¤ï¸\u200dğŸ‘©ğŸ¿', 'ğŸ§‘ğŸ¼\u200dâ¤\u200dğŸ’‹\u200dğŸ§‘ğŸ¿']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.41s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.81s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.54s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.10s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.65s/it]
Processing depth (1, 5, 8, 9):   0%|          | 0/100 [00:16<?, ?it/s]2025-01-22 20:05:24.883 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary took the football.
2025-01-22 20:05:24.888 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (830, 834) -->  Mary took the football
2025-01-22 20:05:24.888 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went to the bathroom.
2025-01-22 20:05:24.908 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4140, 4145) --> . Mary went to the
2025-01-22 20:05:24.908 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the kitchen.
2025-01-22 20:05:24.940 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6504, 6510) --> . Mary journeyed to the
2025-01-22 20:05:24.940 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel moved to the bedroom.
2025-01-22 20:05:24.974 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7139, 7144) -->  Daniel moved to the bedroom
2025-01-22 20:05:24.974 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra travelled to the office.
2025-01-22 20:05:24.983 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1822, 1827) --> . Sandra travelled to the
2025-01-22 20:05:24.983 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the kitchen.
2025-01-22 20:05:25.010 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5618, 5623) --> . Daniel went to the
2025-01-22 20:05:25.010 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John got the apple.
2025-01-22 20:05:25.044 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6712, 6716) -->  John got the apple
2025-01-22 20:05:25.044 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the bedroom.
2025-01-22 20:05:25.068 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4601, 4607) -->  Daniel journeyed to the bedroom
2025-01-22 20:05:25.068 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John discarded the apple.
2025-01-22 20:05:25.092 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4952, 4956) -->  John discarded the apple
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:05:25.952 | INFO     | test_jbb_embedding:begin_test:693 - Mary took the football.<|eot_id|>
2025-01-22 20:05:25.952 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8190])
2025-01-22 20:05:28.303 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [380.303125, 25.74944884352496, 129.35221354166666, 24.57414636765247, 25.95517828525641], 'topk_indices': array([8171, 8181, 8189, 8078, 8088,    1,  830,  831,  834, 8180,  832,
         14, 8177,   24, 8178, 8188, 8186, 8185,  833,    0]), 'topk_tokens': ['.\n\n', '?', '\n\n', '.\n\n', ' location', '<|start_header_id|>', ' Mary', ' took', '.', ' kitchen', ' the', '\n', ' football', '\n\n', ' before', '<|end_header_id|>', '<|start_header_id|>', '<|eot_id|>', ' football', '<|begin_of_text|>'], 'evidence_proportions': [1042.75, 172.5, 217.20833333333334, 253.8625]}, 'weight': {'score': [22.5, 23.290079946295617, 23.795247395833332, 23.29053123849552, 29.555088141025642], 'topk_indices': array([3347, 3320, 3240, 3192, 7467, 7429, 1424, 1486, 4311, 4327, 5211,
       5150, 7206, 7150, 3503, 3529, 4947, 5004, 4922, 4975]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.498046875, 19.403125, 20.052083333333332, 25.3359375]}, 'saliency': {'score': [2.3758544921875, 0.144103445180909, 0.8228937784830729, 0.13662694635413472, 0.19367394080528846], 'topk_indices': array([7927, 6510, 8078,    0, 1823, 8181, 8159, 8187, 8174, 8116,   24,
       8172, 8088,  831, 4145,  830, 8180, 8178, 8177,  833]), 'topk_tokens': [' Square', ' kitchen', '.\n\n', '<|begin_of_text|>', ' Sandra', '?', ' return', 'assistant', ' Where', ' moved', '\n\n', 'Question', ' location', ' took', ' bathroom', ' Mary', ' kitchen', ' before', ' football', ' football'], 'evidence_proportions': [7.3134765625, 0.8728515625, 1.0464680989583333, 1.5240234375]}}, 'pred_res': 'Mary took the football.<|eot_id|>', 'score': 0}
2025-01-22 20:05:28.309 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:05:28.310 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-160_pid-0_1-5-8-9.pkl | len: 3 |  size: 2.06 KB
Processing depth (1, 5, 8, 9):   1%|          | 1/100 [00:20<33:22, 20.22s/it]is_0k: False
your chose emoji: ['ğŸ”', 'ğŸ§‘ğŸ¼\u200dğŸ¦¯\u200dâ¡ï¸', 'ğŸ•', 'ğŸšµğŸ½\u200dâ™€ï¸', 'ğŸ§‘ğŸ»\u200dğŸ¦½', 'ğŸ™†ğŸ»\u200dâ™€ï¸', 'ğŸ™†\u200dâ™‚', 'ğŸ§ğŸ¿\u200dâ™€', 'ğŸš£\u200dâ™‚', 'ğŸ‘©ğŸ»\u200dğŸš’']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  3.87s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:09,  4.54s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.50s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.91s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.45s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (4, 5, 7, 9):   1%|          | 1/100 [00:35<33:22, 20.22s/it]2025-01-22 20:05:43.865 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary took the football.
2025-01-22 20:05:43.883 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3644, 3648) -->  Mary took the football
2025-01-22 20:05:43.883 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went to the bathroom.
2025-01-22 20:05:43.905 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4227, 4232) -->  Mary went to the bathroom
2025-01-22 20:05:43.905 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the kitchen.
2025-01-22 20:05:43.935 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5658, 5664) --> . Mary journeyed to the
2025-01-22 20:05:43.936 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel moved to the bedroom.
2025-01-22 20:05:43.977 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7299, 7304) -->  cold. Daniel moved to
2025-01-22 20:05:43.977 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra travelled to the office.
2025-01-22 20:05:43.988 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2004, 2009) -->  cable. Sandra travelled to
2025-01-22 20:05:43.988 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the kitchen.
2025-01-22 20:05:44.016 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5662, 5667) -->  to the kitchen. Daniel
2025-01-22 20:05:44.016 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John got the apple.
2025-01-22 20:05:44.051 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6896, 6900) -->  John got the apple
2025-01-22 20:05:44.051 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the bedroom.
2025-01-22 20:05:44.074 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4723, 4729) -->  Daniel journeyed to the bedroom
2025-01-22 20:05:44.074 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John discarded the apple.
2025-01-22 20:05:44.098 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5052, 5056) -->  John discarded the apple
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:05:47.220 | INFO     | test_jbb_embedding:begin_test:693 - Mary took the football.<|eot_id|>
2025-01-22 20:05:47.220 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8214])
2025-01-22 20:05:49.820 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [460.62109375, 26.011074601436047, 182.57552083333334, 24.487797091031446, 17.726953125], 'topk_indices': array([3644, 4230, 3643, 8112, 8204, 4227, 8208,   24, 3645, 4228, 8202,
       8210, 3646,   14, 8201, 8212, 8209, 3647,    0, 4231]), 'topk_tokens': [' Mary', ' the', '.', ' location', ' kitchen', ' Mary', ':', '\n\n', ' took', ' went', ' before', '<|start_header_id|>', ' the', '\n', ' football', '<|end_header_id|>', '<|eot_id|>', ' football', '<|begin_of_text|>', ' bathroom'], 'evidence_proportions': [884.625, 802.5, 232.8125, 52.909375]}, 'weight': {'score': [23.570703125, 23.295108464159668, 24.889973958333332, 23.289750741771687, 28.949305555555554], 'topk_indices': array([3332, 3305, 3177, 3225, 7459, 7421, 1467, 1405, 4303, 4319, 5132,
       5193, 7106, 7162, 3514, 3488, 4952, 4904, 4981, 4929]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.498046875, 25.0921875, 20.052083333333332, 23.9296875]}, 'saliency': {'score': [3.0955108642578124, 0.14662760000703573, 1.154998779296875, 0.13645036109990594, 0.12689158121744792], 'topk_indices': array([3655, 5664, 7965,   24, 8068,    8, 8198, 2006, 8207, 8196, 8112,
       3644, 4227, 8204, 8202, 3645, 4228, 8201, 3647, 4231]), 'topk_tokens': [' Grow', ' kitchen', ' Square', '\n\n', ' context', ' Date', ' Where', ' Sandra', 'Answer', 'Question', ' location', ' Mary', ' Mary', ' kitchen', ' before', ' took', ' went', ' football', ' football', ' bathroom'], 'evidence_proportions': [6.0859375, 5.77578125, 1.1954752604166667, 0.30294189453125]}}, 'pred_res': 'Mary took the football.<|eot_id|>', 'score': 0}
2025-01-22 20:05:49.827 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:05:49.827 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-160_pid-1_4-5-7-9.pkl | len: 3 |  size: 2.05 KB
Processing depth (4, 5, 7, 9):   2%|â–         | 2/100 [00:41<34:16, 20.99s/it]is_0k: False
your chose emoji: ['ğŸ‘¨ğŸ¾\u200dğŸ¤\u200dğŸ‘¨ğŸ½', 'ğŸ‘ğŸ¾', 'ğŸŒ¬', 'ğŸ‘¨ğŸ»\u200dğŸ¤\u200dğŸ‘¨ğŸ½', 'ğŸ‘©ğŸ¼\u200dğŸ¦¼\u200dâ¡', 'ğŸ—œï¸', 'ğŸ‘©ğŸ¾\u200dâš•', '\U0001fac4', 'ğŸ‘¨ğŸ¼\u200dâ¤\u200dğŸ‘¨ğŸ½', 'ğŸ•¥']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  3.80s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.46s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.40s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.04s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.50s/it]
Processing depth (1, 3, 4, 6):   2%|â–         | 2/100 [00:57<34:16, 20.99s/it]2025-01-22 20:06:05.691 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary took the football.
2025-01-22 20:06:05.697 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (896, 900) -->  Mary took the football
2025-01-22 20:06:05.697 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went to the bathroom.
2025-01-22 20:06:05.714 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2956, 2961) --> . Mary went to the
2025-01-22 20:06:05.714 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the kitchen.
2025-01-22 20:06:05.732 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3639, 3645) -->  Hon. Mary journeyed to
2025-01-22 20:06:05.732 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel moved to the bedroom.
2025-01-22 20:06:05.755 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4738, 4743) --> . Daniel moved to the
2025-01-22 20:06:05.755 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra travelled to the office.
2025-01-22 20:06:05.765 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2100, 2105) --> . Sandra travelled to the
2025-01-22 20:06:05.765 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the kitchen.
2025-01-22 20:06:05.797 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5613, 5618) --> . Daniel went to the
2025-01-22 20:06:05.797 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John got the apple.
2025-01-22 20:06:05.829 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6740, 6744) -->  John got the apple
2025-01-22 20:06:05.829 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the bedroom.
2025-01-22 20:06:05.852 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4631, 4637) --> . Daniel journeyed to the
2025-01-22 20:06:05.852 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John discarded the apple.
2025-01-22 20:06:05.879 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4987, 4991) -->  John discarded the apple
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:06:06.751 | INFO     | test_jbb_embedding:begin_test:693 - Mary took the football.<|eot_id|>
2025-01-22 20:06:06.751 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8198])
2025-01-22 20:06:08.982 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [219.13515625, 17.311869360443847, 70.2998046875, 16.66111832628417, 8.205935594512194], 'topk_indices': array([8086,    9,   23,    4, 8186,  898, 8197,  900,  896, 8185,    3,
       2961,    1,   14,   24, 8193,  899, 8194,    0, 8196]), 'topk_tokens': ['.\n\n', ':', '4', '\n\n', ' before', ' the', '\n\n', '.', ' Mary', ' football', '<|end_header_id|>', ' bathroom', '<|start_header_id|>', '\n', '\n\n', '<|eot_id|>', ' football', '<|start_header_id|>', '<|begin_of_text|>', '<|end_header_id|>'], 'evidence_proportions': [654.875, 181.5875, 107.38541666666667, 42.190625]}, 'weight': {'score': [22.3453125, 23.299614757346664, 22.664713541666668, 23.3038226369989, 29.726371951219512], 'topk_indices': array([3302, 3329, 3222, 3174, 7451, 7489, 1466, 1404, 4312, 4328, 5256,
       5195, 7172, 7228, 3511, 3485, 5010, 5039, 4957, 4982]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.498046875, 19.403125, 24.05859375, 19.909375]}, 'saliency': {'score': [1.36439208984375, 0.09598599589607974, 0.4243634541829427, 0.09190984279103645, 0.0605569699915444], 'topk_indices': array([   4, 8167, 8182,    8, 8191, 8197, 7949,   16,    0, 8096,  897,
       8180, 8195, 8186, 8188,   24,  896, 8185, 2961,  899]), 'topk_tokens': ['\n\n', ' return', ' Where', ' Date', 'Answer', '\n\n', ' Square', ' Date', '<|begin_of_text|>', ' location', ' took', 'Question', 'assistant', ' before', ' kitchen', '\n\n', ' Mary', ' football', ' bathroom', ' football'], 'evidence_proportions': [4.57763671875, 0.83271484375, 0.5924479166666666, 0.251806640625]}}, 'pred_res': 'Mary took the football.<|eot_id|>', 'score': 0}
2025-01-22 20:06:08.989 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:06:08.990 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-160_pid-2_1-3-4-6.pkl | len: 3 |  size: 2.07 KB
Processing depth (1, 3, 4, 6):   3%|â–         | 3/100 [01:00<32:34, 20.15s/it]is_0k: False
your chose emoji: ['ğŸ“¡', 'ğŸš¶ğŸ¾\u200dâ™€ï¸', 'ğŸ°', 'ğŸ‘©ğŸ¼\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘©ğŸ¼', 'ğŸ‘¨ğŸ¾\u200dğŸ¦°', 'ğŸ˜›', 'ğŸ’ƒğŸ»', 'ğŸ•µğŸ¿\u200dâ™‚ï¸', 'ğŸ‘¨ğŸ¾\u200dâ¤\u200dğŸ’‹\u200dğŸ‘¨ğŸ¿', 'ğŸ¥§']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.01s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.25s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.19s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.94s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.40s/it]
Processing depth (2, 3, 5, 6):   3%|â–         | 3/100 [01:16<32:34, 20.15s/it]2025-01-22 20:06:24.375 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary took the football.
2025-01-22 20:06:24.383 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1744, 1748) -->  Mary took the football
2025-01-22 20:06:24.383 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went to the bathroom.
2025-01-22 20:06:24.398 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2888, 2893) --> . Mary went to the
2025-01-22 20:06:24.398 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the kitchen.
2025-01-22 20:06:24.419 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4142, 4148) --> . Mary journeyed to the
2025-01-22 20:06:24.419 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel moved to the bedroom.
2025-01-22 20:06:24.441 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4650, 4655) --> . Daniel moved to the
2025-01-22 20:06:24.441 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra travelled to the office.
2025-01-22 20:06:24.450 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1810, 1815) --> . Sandra travelled to the
2025-01-22 20:06:24.450 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the kitchen.
2025-01-22 20:06:24.477 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5627, 5632) --> . Daniel went to the
2025-01-22 20:06:24.477 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John got the apple.
2025-01-22 20:06:24.514 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6752, 6756) -->  John got the apple
2025-01-22 20:06:24.514 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the bedroom.
2025-01-22 20:06:24.537 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4604, 4610) -->  Daniel journeyed to the bedroom
2025-01-22 20:06:24.537 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John discarded the apple.
2025-01-22 20:06:24.561 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4961, 4965) -->  John discarded the apple
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:06:25.330 | INFO     | test_jbb_embedding:begin_test:693 - bathroom<|eot_id|>
2025-01-22 20:06:25.330 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8188])
2025-01-22 20:06:27.534 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [67.733984375, 7.165384930869247, 26.285807291666668, 6.960369326899472, 8.412990817775974], 'topk_indices': array([8041, 8176, 8171, 8187,   20,    1, 8086,    9,   28, 1748,   23,
         24, 1747, 8175, 8042,   14, 2893, 8186,    0, 8183]), 'topk_tokens': [' you', ' before', ':', '\n\n', ' Jul', '<|start_header_id|>', ' location', ':', '<|end_header_id|>', '.', '4', '\n\n', ' football', ' football', ' context', '\n', ' bathroom', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [164.984375, 69.875, 48.768229166666664, 10.5515625]}, 'weight': {'score': [21.143359375, 23.29691696679282, 23.795247395833332, 23.300735700257764, 30.00020292207792], 'topk_indices': array([3311, 3284, 3156, 3204, 7469, 7431, 1503, 1441, 4330, 4346, 5159,
       5220, 7152, 7208, 3493, 3467, 5013, 4931, 4956, 4984]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.498046875, 19.403125, 20.052083333333332, 19.909375]}, 'saliency': {'score': [0.4000892639160156, 0.03992114266754288, 0.16652488708496094, 0.03866401092690369, 0.06380264480392654], 'topk_indices': array([  22, 8178, 8041, 8185,    8, 8040,   16, 8157, 8181, 8170,   19,
       8176,   24,   23, 8086,   20, 8042, 1747, 8175, 2893]), 'topk_tokens': ['202', ' kitchen', ' you', 'assistant', ' Date', ' provided', ' Date', ' return', 'Answer', 'Question', '26', ' before', '\n\n', '4', ' location', ' Jul', ' context', ' football', ' football', ' bathroom'], 'evidence_proportions': [1.14678955078125, 0.3201171875, 0.2564493815104167, 0.0550689697265625]}}, 'pred_res': 'bathroom<|eot_id|>', 'score': 100}
2025-01-22 20:06:27.549 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:06:27.549 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-160_pid-3_2-3-5-6.pkl | len: 3 |  size: 2.03 KB
Processing depth (2, 3, 5, 6):   4%|â–         | 4/100 [01:19<31:14, 19.52s/it]is_0k: False
your chose emoji: ['ğŸ§‘ğŸ¾\u200dğŸ¼', 'ğŸ³\u200dâš§ï¸', 'ğŸ¦«', 'ğŸ‘©ğŸ»\u200dâ¤\u200dğŸ’‹\u200dğŸ‘¨ğŸ¾', 'ğŸ§”\u200dâ™€', 'ğŸ•µğŸ¾\u200dâ™€', 'ğŸ‘¨ğŸ»\u200dâœˆï¸', 'ğŸšµ', 'ğŸ’‚ğŸ¿\u200dâ™€ï¸', 'ğŸ’ğŸ¼']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.50s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.43s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.24s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.95s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.47s/it]
Processing depth (1, 5, 6, 8):   4%|â–         | 4/100 [01:35<31:14, 19.52s/it]2025-01-22 20:06:43.384 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary took the football.
2025-01-22 20:06:43.388 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (784, 788) -->  Mary took the football
2025-01-22 20:06:43.389 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went to the bathroom.
2025-01-22 20:06:43.409 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4134, 4139) --> . Mary went to the
2025-01-22 20:06:43.409 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the kitchen.
2025-01-22 20:06:43.436 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4725, 4731) --> . Mary journeyed to the
2025-01-22 20:06:43.436 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel moved to the bedroom.
2025-01-22 20:06:43.468 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6529, 6534) --> . Daniel moved to the
2025-01-22 20:06:43.468 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra travelled to the office.
2025-01-22 20:06:43.477 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1754, 1759) --> . Sandra travelled to the
2025-01-22 20:06:43.477 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the kitchen.
2025-01-22 20:06:43.506 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5579, 5584) --> . Daniel went to the
2025-01-22 20:06:43.506 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John got the apple.
2025-01-22 20:06:43.544 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6724, 6728) -->  John got the apple
2025-01-22 20:06:43.544 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the bedroom.
2025-01-22 20:06:43.568 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4618, 4624) --> . Daniel journeyed to the
2025-01-22 20:06:43.568 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John discarded the apple.
2025-01-22 20:06:43.595 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4995, 4999) -->  John discarded the apple
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:06:44.431 | INFO     | test_jbb_embedding:begin_test:693 - Mary took the football.<|eot_id|>
2025-01-22 20:06:44.431 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8166])
2025-01-22 20:06:46.651 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [283.546875, 23.815227537030236, 104.041015625, 22.938913461538462, 16.431818181818183], 'topk_indices': array([8160, 8054, 8165, 8154,  783,  786, 4139,   14,  784,   24,  785,
          1, 8064, 8153,  788, 8164, 8162, 8161,  787,    0]), 'topk_tokens': [':', '.\n\n', '\n\n', ' before', '.', ' the', ' bathroom', '\n', ' Mary', '\n\n', ' took', '<|start_header_id|>', ' location', ' football', '.', '<|end_header_id|>', '<|start_header_id|>', '<|eot_id|>', ' football', '<|begin_of_text|>'], 'evidence_proportions': [936.5, 158.3, 107.27083333333333, 97.9625]}, 'weight': {'score': [21.143359375, 23.261830165870975, 22.664713541666668, 23.268808653846154, 28.946022727272727], 'topk_indices': array([3320, 3347, 3192, 3240, 7421, 7459, 1452, 1514, 4321, 4305, 5210,
       5149, 7142, 7198, 3503, 3529, 4932, 4907, 4955, 4984]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.498046875, 19.403125, 20.052083333333332, 19.909375]}, 'saliency': {'score': [1.801544189453125, 0.13244292686145795, 0.6186472574869791, 0.1268981971153846, 0.12355642607717802], 'topk_indices': array([   0, 8054, 1812, 8165, 8148, 8063, 8150, 8020, 8159, 8163,   24,
       8135, 8156, 8154,  785, 8064,  784, 4139, 8153,  787]), 'topk_tokens': ['<|begin_of_text|>', '.\n\n', 'ot', '\n\n', 'Question', ' first', ' Where', ' context', 'Answer', 'assistant', '\n\n', ' return', ' kitchen', ' before', ' took', ' location', ' Mary', ' bathroom', ' football', ' football'], 'evidence_proportions': [6.614990234375, 0.78134765625, 0.50048828125, 0.5322509765625]}}, 'pred_res': 'Mary took the football.<|eot_id|>', 'score': 0}
2025-01-22 20:06:46.659 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:06:46.660 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-160_pid-4_1-5-6-8.pkl | len: 3 |  size: 2.06 KB
Processing depth (1, 5, 6, 8):   5%|â–Œ         | 5/100 [01:38<30:40, 19.37s/it]Processing depth (1, 5, 6, 8):   5%|â–Œ         | 5/100 [01:38<31:13, 19.73s/it]
2025-01-22 20:06:46.715 | INFO     | __main__:<module>:82 - Selected idx: 162
2025-01-22 20:06:46.715 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the football before the kitchen? 
2025-01-22 20:06:46.715 | INFO     | __main__:<module>:84 - Answer: bathroom
2025-01-22 20:06:46.715 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 20:06:46.715 | INFO     | __main__:<module>:86 - Needle: [' Mary grabbed the football.', ' Daniel journeyed to the bedroom.', ' Mary went to the bathroom.', ' John got the apple.', ' John discarded the apple.', ' Mary journeyed to the kitchen.', ' Sandra travelled to the office.']
2025-01-22 20:06:46.715 | INFO     | __main__:<module>:87 - Real Needle: [' Mary grabbed the football.', ' Mary went to the bathroom.', ' Mary journeyed to the kitchen.', ' Sandra travelled to the office.']
2025-01-22 20:06:46.715 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ‘¨ğŸ¿\u200dğŸ¦±', 'â˜ğŸ¼', 'ğŸ™†ğŸ¿', 'ğŸ™…ğŸ¾\u200dâ™‚', 'ğŸª“', 'ğŸ§‘ğŸ»\u200dğŸ¦³', 'ğŸ¤ŸğŸ¾', 'ğŸ§œğŸ½\u200dâ™€', 'ğŸ‘©\u200dğŸ¦³', 'ğŸ˜«']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.13s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.44s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.39s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.06s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.53s/it]
Processing depth (1, 2, 4, 9):   0%|          | 0/100 [00:15<?, ?it/s]2025-01-22 20:07:02.598 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the football.
2025-01-22 20:07:02.602 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (833, 837) -->  Mary grabbed the football
2025-01-22 20:07:02.603 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went to the bathroom.
2025-01-22 20:07:02.613 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1870, 1875) --> . Mary went to the
2025-01-22 20:07:02.613 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the kitchen.
2025-01-22 20:07:02.639 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3604, 3610) --> . Mary journeyed to the
2025-01-22 20:07:02.640 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra travelled to the office.
2025-01-22 20:07:02.675 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7226, 7231) --> . Sandra travelled to the
2025-01-22 20:07:02.675 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel journeyed to the bedroom.
2025-01-22 20:07:02.681 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1123, 1129) --> . Daniel journeyed to the
2025-01-22 20:07:02.681 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John got the apple.
2025-01-22 20:07:02.682 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (252, 256) -->  John got the apple
2025-01-22 20:07:02.682 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John discarded the apple.
2025-01-22 20:07:02.703 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3612, 3616) -->  John discarded the apple
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:07:03.498 | INFO     | test_jbb_embedding:begin_test:693 - Mary's location<|eot_id|>
2025-01-22 20:07:03.498 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8200])
2025-01-22 20:07:05.730 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [573.7671875, 39.58085075582104, 362.0, 37.72045231974538, 30.839887640449437], 'topk_indices': array([3609, 8183, 8098, 3608, 8189,  759, 8181,  837, 8198, 8195, 8191,
       1875, 8187,  836, 3610, 8196, 8190, 8188, 3611,    0]), 'topk_tokens': [' the', ':', ' location', ' to', ' the', 'ï¿½', '.\n\n', '.', '<|end_header_id|>', '<|eot_id|>', '?', ' bathroom', ' football', ' football', ' kitchen', '<|start_header_id|>', ' kitchen', ' before', '.', '<|begin_of_text|>'], 'evidence_proportions': [1027.875, 402.15, 822.1666666666666, 84.01875]}, 'weight': {'score': [22.056640625, 23.321873476167255, 23.919642857142858, 23.32394666574856, 30.14325842696629], 'topk_indices': array([3367, 3340, 3192, 3240, 7443, 7405, 1496, 1434, 4375, 4359, 5231,
       5170, 7176, 7120, 3523, 3549, 4972, 4947, 5024, 4995]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.263671875, 19.403125, 20.052083333333332, 22.15]}, 'saliency': {'score': [3.24459228515625, 0.2216821131322001, 2.2314278738839284, 0.21083688800170614, 0.23261492439870085], 'topk_indices': array([3611,  833, 1129, 8054, 8184,  262,  255,  757, 8181, 8098, 8191,
        759,  834, 8182, 8187, 8188,  836, 3610, 1875, 8190]), 'topk_tokens': ['.', ' Mary', ' bedroom', ' context', ' Where', 'hue', ' apple', 'ï¿½', '.\n\n', ' location', '?', 'ï¿½', ' grabbed', 'Question', ' football', ' before', ' football', ' kitchen', ' bathroom', ' kitchen'], 'evidence_proportions': [7.5927734375, 1.9142578125, 3.7294921875, 0.514501953125]}}, 'pred_res': "Mary's location<|eot_id|>", 'score': 0}
2025-01-22 20:07:05.737 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:07:05.738 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-162_pid-0_1-2-4-9.pkl | len: 3 |  size: 2.03 KB
Processing depth (1, 2, 4, 9):   1%|          | 1/100 [00:18<31:11, 18.90s/it]is_0k: False
your chose emoji: ['ğŸ‘©ğŸ½\u200dâ¤ï¸\u200dğŸ‘©ğŸ»', 'ğŸ§ğŸ»\u200dâ™€ï¸', 'ğŸ˜„', 'ğŸ‹ğŸ¾\u200dâ™‚ï¸', 'ğŸ–Œï¸', 'ğŸ‘¨ğŸ¼\u200dğŸ¤', 'ğŸ‘©ğŸ»\u200dâ¤\u200dğŸ’‹\u200dğŸ‘¨ğŸ½', 'ğŸ½', 'ğŸ§ğŸ»\u200dâ™€', 'ğŸ§‘ğŸ»\u200dğŸ¼']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  3.68s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.30s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.10s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:12<00:00,  2.66s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:12<00:00,  3.18s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (1, 4, 7, 9):   1%|          | 1/100 [00:33<31:11, 18.90s/it]2025-01-22 20:07:20.253 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the football.
2025-01-22 20:07:20.258 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (831, 835) -->  Mary grabbed the football
2025-01-22 20:07:20.258 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went to the bathroom.
2025-01-22 20:07:20.275 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3560, 3565) --> . Mary went to the
2025-01-22 20:07:20.275 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the kitchen.
2025-01-22 20:07:20.307 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5595, 5601) --> . Mary journeyed to the
2025-01-22 20:07:20.308 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra travelled to the office.
2025-01-22 20:07:20.342 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7125, 7130) -->  Sandra travelled to the office
2025-01-22 20:07:20.342 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel journeyed to the bedroom.
2025-01-22 20:07:20.347 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1072, 1078) -->  Daniel journeyed to the bedroom
2025-01-22 20:07:20.348 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John got the apple.
2025-01-22 20:07:20.349 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (249, 253) -->  got the apple.
2025-01-22 20:07:20.349 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John discarded the apple.
2025-01-22 20:07:20.370 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3567, 3571) -->  John discarded the apple
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:07:23.826 | INFO     | test_jbb_embedding:begin_test:693 - Mary's bedroom.<|eot_id|>
2025-01-22 20:07:23.826 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8168])
2025-01-22 20:07:26.577 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [346.5125, 31.87864092522335, 270.6607142857143, 30.694466633894557, 40.426824700342465], 'topk_indices': array([ 234, 5601, 8159,   14,   24, 7688, 7689, 8166, 8158, 8155,  835,
       7726, 5602,  834, 8066, 8156, 8164, 3565, 8163,    0]), 'topk_tokens': ['ï¿½', ' kitchen', '?', '\n', '\n\n', ' out', ' of', '<|end_header_id|>', ' kitchen', ' football', '.', ' out', '.', ' football', ' location', ' before', '<|start_header_id|>', ' bathroom', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [618.4375, 326.825, 411.6458333333333, 70.5]}, 'weight': {'score': [23.06015625, 23.280949776649123, 24.478794642857142, 23.279431531891362, 29.34803082191781], 'topk_indices': array([3296, 3323, 3168, 3216, 7453, 7415, 1438, 1500, 4286, 4302, 5097,
       5158, 7192, 7136, 3479, 3505, 4951, 4922, 4899, 4874]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.263671875, 19.403125, 20.052083333333332, 26.1640625]}, 'saliency': {'score': [2.00887451171875, 0.1805332227255691, 1.66400146484375, 0.1734869672051662, 0.3013796871655608], 'topk_indices': array([7561, 8065, 7725, 8150,  251,  234, 8022,  232,  831, 1077,  832,
       7726, 7688, 5601, 8156, 8066, 8158, 8155,  834, 3565]), 'topk_tokens': ['nes', ' first', ' breaking', 'Question', ' apple', 'ï¿½', ' context', 'ï¿½', ' Mary', ' bedroom', ' grabbed', ' out', ' out', ' kitchen', ' before', ' location', ' kitchen', ' football', ' football', ' bathroom'], 'evidence_proportions': [4.60107421875, 1.5763671875, 1.899658203125, 0.498681640625]}}, 'pred_res': "Mary's bedroom.<|eot_id|>", 'score': 0}
2025-01-22 20:07:26.582 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:07:26.583 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-162_pid-1_1-4-7-9.pkl | len: 3 |  size: 2.04 KB
Processing depth (1, 4, 7, 9):   2%|â–         | 2/100 [00:39<32:44, 20.04s/it]is_0k: False
your chose emoji: ['\U0001fad7', 'ğŸ¤¾ğŸ»\u200dâ™€', 'ğŸŒ\u200dâ™€', 'ğŸ¤²', 'ğŸ¿', 'ğŸ‹ğŸ¾\u200dâ™‚ï¸', 'ğŸ‘¨ğŸ»\u200dğŸ¦°', 'â›¹ğŸ½\u200dâ™€', 'ğŸ‘¨ğŸ¾\u200dğŸ¤\u200dğŸ‘¨ğŸ»', 'ğŸ›€ğŸ»']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.82s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.81s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.45s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.14s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.70s/it]
Processing depth (0, 2, 7, 8):   2%|â–         | 2/100 [00:56<32:44, 20.04s/it]2025-01-22 20:07:43.142 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the football.
2025-01-22 20:07:43.180 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went to the bathroom.
2025-01-22 20:07:43.187 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1600, 1605) --> . Mary went to the
2025-01-22 20:07:43.187 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the kitchen.
2025-01-22 20:07:43.214 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5595, 5601) --> . Mary journeyed to the
2025-01-22 20:07:43.215 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra travelled to the office.
2025-01-22 20:07:43.246 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6594, 6599) --> . Sandra travelled to the
2025-01-22 20:07:43.246 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel journeyed to the bedroom.
2025-01-22 20:07:43.251 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (999, 1005) --> . Daniel journeyed to the
2025-01-22 20:07:43.251 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John got the apple.
2025-01-22 20:07:43.252 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (257, 261) -->  John got the apple
2025-01-22 20:07:43.252 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John discarded the apple.
2025-01-22 20:07:43.268 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3573, 3577) -->  John discarded the apple
2025-01-22 20:07:43.269 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 20:07:43.269 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 20:07:43.269 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 20:07:43.269 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ’‘ğŸ¿', 'â—»', 'ğŸ™ğŸ¼\u200dâ™‚ï¸', 'ğŸŒ¯', 'ğŸ’“', 'ğŸ¤ğŸ¿', 'â›¹ğŸ»', 'ğŸ„ğŸ¾\u200dâ™‚ï¸', 'ğŸ§”ğŸ½\u200dâ™‚ï¸', 'ğŸ»']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.06s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.30s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.42s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.04s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.51s/it]
Processing depth (0, 1, 3, 7):   2%|â–         | 2/100 [01:12<32:44, 20.04s/it]2025-01-22 20:07:58.991 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the football.
2025-01-22 20:07:59.030 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went to the bathroom.
2025-01-22 20:07:59.035 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (905, 910) --> . Mary went to the
2025-01-22 20:07:59.035 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the kitchen.
2025-01-22 20:07:59.053 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2987, 2993) -->  tragedy. Mary journeyed to
2025-01-22 20:07:59.053 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra travelled to the office.
2025-01-22 20:07:59.083 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5716, 5721) --> . Sandra travelled to the
2025-01-22 20:07:59.084 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel journeyed to the bedroom.
2025-01-22 20:07:59.091 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1230, 1236) -->  Republican. Daniel journeyed to
2025-01-22 20:07:59.091 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John got the apple.
2025-01-22 20:07:59.092 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (257, 261) -->  John got the apple
2025-01-22 20:07:59.092 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John discarded the apple.
2025-01-22 20:07:59.109 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3644, 3648) -->  John discarded the apple
2025-01-22 20:07:59.110 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 20:07:59.110 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 20:07:59.110 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 20:07:59.110 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ–', 'ğŸ¤¹ğŸ»\u200dâ™€', 'ğŸ§‘ğŸ¾\u200dâœˆ', 'ğŸ¤ŒğŸ¿', '7ï¸âƒ£', 'ğŸ§œ', 'ğŸ™‡ğŸ¾\u200dâ™€', 'ğŸ•´ğŸ¿', 'ğŸ§šğŸ¿\u200dâ™€ï¸', 'ğŸ‘©ğŸ»\u200dâ¤\u200dğŸ’‹\u200dğŸ‘©ğŸ¿']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.46s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.19s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.10s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.85s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.35s/it]
Processing depth (0, 1, 2, 6):   2%|â–         | 2/100 [01:27<32:44, 20.04s/it]2025-01-22 20:08:14.330 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the football.
2025-01-22 20:08:14.369 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went to the bathroom.
2025-01-22 20:08:14.373 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (799, 804) --> . Mary went to the
2025-01-22 20:08:14.373 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the kitchen.
2025-01-22 20:08:14.381 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1623, 1629) -->  Mary journeyed to the kitchen
2025-01-22 20:08:14.381 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra travelled to the office.
2025-01-22 20:08:14.404 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4760, 4765) --> . Sandra travelled to the
2025-01-22 20:08:14.404 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel journeyed to the bedroom.
2025-01-22 20:08:14.409 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1025, 1031) --> . Daniel journeyed to the
2025-01-22 20:08:14.409 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John got the apple.
2025-01-22 20:08:14.411 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (257, 261) -->  John got the apple
2025-01-22 20:08:14.411 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John discarded the apple.
2025-01-22 20:08:14.428 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3596, 3600) -->  John discarded the apple
2025-01-22 20:08:14.428 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 20:08:14.428 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 20:08:14.428 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 20:08:14.428 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸš¶ğŸ½\u200dâ¡', 'ğŸ‘¨ğŸ¾\u200dğŸ”¬', 'ğŸ§‘\u200dğŸ¦¼\u200dâ¡ï¸', 'ğŸ”·', 'ğŸï¸', 'ğŸ‘¨ğŸ»\u200dâ¤ï¸\u200dğŸ‘¨ğŸ¼', 'ğŸ„ğŸ½', 'ğŸ‘©ğŸ½\u200dğŸ¦²', 'ğŸ§‘ğŸ¿\u200dâœˆï¸', 'ğŸšµğŸ¼\u200dâ™€']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.46s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.56s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.35s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  2.99s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.53s/it]
Processing depth (1, 5, 8, 9):   2%|â–         | 2/100 [01:43<32:44, 20.04s/it]2025-01-22 20:08:30.263 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the football.
2025-01-22 20:08:30.269 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (821, 825) -->  Mary grabbed the football
2025-01-22 20:08:30.269 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went to the bathroom.
2025-01-22 20:08:30.292 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4198, 4203) -->  Mary went to the bathroom
2025-01-22 20:08:30.292 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the kitchen.
2025-01-22 20:08:30.325 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6577, 6583) --> . Mary journeyed to the
2025-01-22 20:08:30.325 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra travelled to the office.
2025-01-22 20:08:30.359 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7085, 7090) -->  Sandra travelled to the office
2025-01-22 20:08:30.359 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel journeyed to the bedroom.
2025-01-22 20:08:30.365 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1111, 1117) --> . Daniel journeyed to the
2025-01-22 20:08:30.365 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John got the apple.
2025-01-22 20:08:30.366 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (252, 256) -->  John got the apple
2025-01-22 20:08:30.366 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John discarded the apple.
2025-01-22 20:08:30.383 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3617, 3621) -->  John discarded the apple
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:08:31.958 | INFO     | test_jbb_embedding:begin_test:693 - Mary's location is not specified before the kitchen, but it is mentioned that "Mary grabbed the football" before the text about Mary journeying to the kitchen.
2025-01-22 20:08:31.958 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8146])
2025-01-22 20:08:34.189 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [488.859375, 33.86057338323721, 336.76785714285717, 32.21662045594578, 41.77381552419355], 'topk_indices': array([6583, 8000, 8127, 8135,   24,   14, 8137,  256, 8044,  255, 8133,
       6584, 8136,  824, 8142, 8134, 4202, 8144, 8141,    0]), 'topk_tokens': [' kitchen', ' context', '.\n\n', ' the', '\n\n', '\n', '?', '.', ' location', ' apple', ' football', '.', ' kitchen', ' football', '<|start_header_id|>', ' before', ' bathroom', '<|end_header_id|>', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [708.75, 599.55, 553.7916666666666, 124.3375]}, 'weight': {'score': [24.482421875, 23.255827018652596, 23.919642857142858, 23.251658772335183, 28.7734375], 'topk_indices': array([3254, 3281, 3126, 3174, 7375, 7413, 1422, 1484, 4274, 4290, 5172,
       5111, 7152, 7096, 3437, 3463, 4965, 4913, 4936, 4888]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.263671875, 25.0921875, 20.052083333333332, 26.1640625]}, 'saliency': {'score': [3.22840576171875, 0.19125014560356332, 2.1400844029017856, 0.18040272823763864, 0.2959850680443548], 'topk_indices': array([7873,    0, 6579, 8130, 8043,  821,  253, 6578, 8137, 8128, 8000,
        822, 6583, 8044,  255, 8133, 8134, 8136,  824, 4202]), 'topk_tokens': [' Square', '<|begin_of_text|>', ' journey', ' Where', ' first', ' Mary', ' got', ' Mary', '?', 'Question', ' context', ' grabbed', ' kitchen', ' location', ' apple', ' football', ' before', ' kitchen', ' football', ' bathroom'], 'evidence_proportions': [5.364501953125, 4.4115234375, 2.8258463541666665, 0.819482421875]}}, 'pred_res': 'Mary\'s location is not specified before the kitchen, but it is mentioned that "Mary grabbed the football" before the text about Mary journeying to the kitchen.', 'score': 0}
2025-01-22 20:08:34.196 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:08:34.197 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-162_pid-2_1-5-8-9.pkl | len: 3 |  size: 2.19 KB
Processing depth (1, 5, 8, 9):   3%|â–         | 3/100 [01:47<1:07:31, 41.77s/it]is_0k: False
your chose emoji: ['\U0001faf1ğŸ¼', '0âƒ£', 'ğŸª ', 'ğŸ¥™', 'ğŸ·', 'âš’', 'ğŸ§‘ğŸ¾\u200dğŸ¦°', 'ğŸ‘³ğŸ¼\u200dâ™€ï¸', 'ğŸ¦µğŸ¼', 'ğŸ‘¨ğŸ»\u200dâ¤\u200dğŸ‘¨ğŸ¿']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.08s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.70s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.63s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.24s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.71s/it]
Processing depth (2, 3, 5, 7):   3%|â–         | 3/100 [02:03<1:07:31, 41.77s/it]2025-01-22 20:08:50.753 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the football.
2025-01-22 20:08:50.765 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2012, 2016) -->  Mary grabbed the football
2025-01-22 20:08:50.765 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went to the bathroom.
2025-01-22 20:08:50.780 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2987, 2992) -->  tragedy. Mary went to
2025-01-22 20:08:50.780 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the kitchen.
2025-01-22 20:08:50.803 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4261, 4267) --> . Mary journeyed to the
2025-01-22 20:08:50.803 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra travelled to the office.
2025-01-22 20:08:50.839 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5734, 5739) --> . Sandra travelled to the
2025-01-22 20:08:50.839 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel journeyed to the bedroom.
2025-01-22 20:08:50.846 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1219, 1225) -->  Republican. Daniel journeyed to
2025-01-22 20:08:50.846 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John got the apple.
2025-01-22 20:08:50.848 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (252, 256) -->  John got the apple
2025-01-22 20:08:50.848 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John discarded the apple.
2025-01-22 20:08:50.869 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3737, 3741) -->  John discarded the apple
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:08:51.656 | INFO     | test_jbb_embedding:begin_test:693 - The bathroom.<|eot_id|>
2025-01-22 20:08:51.656 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8162])
2025-01-22 20:08:53.867 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [204.521875, 19.897209889773425, 139.68526785714286, 19.236832800393554, 20.59799107142857], 'topk_indices': array([2016, 4267, 8156, 8152, 2477, 8143,    1,    9, 4268,   28,   23,
       8149, 8150,   14, 2015,   24, 2993, 8160,    0, 8157]), 'topk_tokens': ['.', ' kitchen', ':', ' kitchen', 'ï¿½', '.\n\n', '<|start_header_id|>', ':', '.', '<|end_header_id|>', '4', ' football', ' before', '\n', ' football', '\n\n', ' bathroom', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [398.15625, 140.175, 264.1875, 42.3625]}, 'weight': {'score': [23.50859375, 23.277761405388855, 25.650111607142858, 23.273108896507196, 29.422098214285715], 'topk_indices': array([3297, 3270, 3190, 3142, 7419, 7381, 1411, 1473, 4273, 4289, 5183,
       5122, 7158, 7102, 3479, 3453, 4924, 4976, 4947, 4899]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.263671875, 25.2109375, 20.052083333333332, 22.15]}, 'saliency': {'score': [1.21226806640625, 0.11084018013481706, 0.88543701171875, 0.10679726863960076, 0.14827259608677457], 'topk_indices': array([8146,   19, 8143, 2012, 8155, 8131, 2477, 2013,   23, 8016, 8144,
         20, 8060,   24, 4267, 8152, 8150, 8149, 2015, 2993]), 'topk_tokens': [' Where', '26', '.\n\n', ' Mary', 'Answer', ' return', 'ï¿½', ' grabbed', '4', ' context', 'Question', ' Jul', ' location', '\n\n', ' kitchen', ' kitchen', ' before', ' football', ' football', ' bathroom'], 'evidence_proportions': [2.9437255859375, 0.7662109375, 1.2211507161458333, 0.2625]}}, 'pred_res': 'The bathroom.<|eot_id|>', 'score': 100}
2025-01-22 20:08:53.875 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:08:53.875 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-162_pid-3_2-3-5-7.pkl | len: 3 |  size: 2.02 KB
Processing depth (2, 3, 5, 7):   4%|â–         | 4/100 [02:07<52:52, 33.05s/it]  is_0k: False
your chose emoji: ['ğŸ’¨', 'ğŸ‘©ğŸ¿\u200dğŸ¦¼', 'ğŸ™†ğŸ¾\u200dâ™‚', 'ğŸ§˜ğŸ»\u200dâ™€ï¸', 'ğŸ‘µğŸ¾', 'â“‚', 'ğŸ‘¨\u200dğŸ¦½\u200dâ¡ï¸', 'ğŸ‡¦ğŸ‡²', 'ğŸ™†ğŸ»\u200dâ™‚ï¸', 'ğŸ–¨ï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.17s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.35s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.43s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.16s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.59s/it]
Processing depth (1, 5, 7, 8):   4%|â–         | 4/100 [02:23<52:52, 33.05s/it]2025-01-22 20:09:09.982 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the football.
2025-01-22 20:09:09.987 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (901, 905) -->  Mary grabbed the football
2025-01-22 20:09:09.987 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went to the bathroom.
2025-01-22 20:09:10.007 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4157, 4162) --> . Mary went to the
2025-01-22 20:09:10.007 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the kitchen.
2025-01-22 20:09:10.039 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5601, 5607) --> . Mary journeyed to the
2025-01-22 20:09:10.039 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra travelled to the office.
2025-01-22 20:09:10.074 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6600, 6605) --> . Sandra travelled to the
2025-01-22 20:09:10.075 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel journeyed to the bedroom.
2025-01-22 20:09:10.082 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1224, 1230) -->  Republican. Daniel journeyed to
2025-01-22 20:09:10.082 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John got the apple.
2025-01-22 20:09:10.084 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (252, 256) -->  John got the apple
2025-01-22 20:09:10.084 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John discarded the apple.
2025-01-22 20:09:10.104 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3575, 3579) -->  John discarded the apple
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:09:10.877 | INFO     | test_jbb_embedding:begin_test:693 - Mary's location<|eot_id|>
2025-01-22 20:09:10.877 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8170])
2025-01-22 20:09:13.111 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [391.44375, 41.732809249969414, 390.48214285714283, 40.273574763484454, 27.01266891891892], 'topk_indices': array([  14, 8157,   24, 5945,  905, 8166, 8168, 6085, 5947, 5952,  904,
       4162, 6082, 5953, 8165, 6089, 6083, 5954, 6090,    0]), 'topk_tokens': ['\n', ' football', '\n\n', '\n', '.', '<|start_header_id|>', '<|end_header_id|>', ' from', ' way', ' to', ' football', ' bathroom', '\n', ' the', '<|eot_id|>', ' to', 'the', ' office', ' the', '<|begin_of_text|>'], 'evidence_proportions': [870.125, 371.45, 261.0833333333333, 184.925]}, 'weight': {'score': [22.056640625, 23.29036346812676, 25.650111607142858, 23.28933606708441, 29.78589527027027], 'topk_indices': array([3321, 3294, 3166, 3214, 7441, 7403, 1416, 1478, 4316, 4332, 5188,
       5127, 7180, 7124, 3519, 3493, 4929, 4952, 4981, 4904]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.263671875, 19.403125, 20.052083333333332, 22.15]}, 'saliency': {'score': [2.48968505859375, 0.23245787028363207, 2.495640345982143, 0.2230182464445878, 0.20372627876900337], 'topk_indices': array([6087, 8158, 5952, 6085, 7901, 8068, 6089,  901, 5951, 6088,  255,
       6090,  902, 5947, 8157, 1231, 6083,  904, 4162, 5954]), 'topk_tokens': [' boat', ' before', ' to', ' from', ' Square', ' location', ' to', ' Mary', ' landing', ' landing', ' apple', ' the', ' grabbed', ' way', ' football', ' bedroom', 'the', ' football', ' bathroom', ' office'], 'evidence_proportions': [6.5791015625, 1.82568359375, 1.3025716145833333, 1.306689453125]}}, 'pred_res': "Mary's location<|eot_id|>", 'score': 0}
2025-01-22 20:09:13.117 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:09:13.118 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-162_pid-4_1-5-7-8.pkl | len: 3 |  size: 2.02 KB
Processing depth (1, 5, 7, 8):   5%|â–Œ         | 5/100 [02:26<44:26, 28.07s/it]Processing depth (1, 5, 7, 8):   5%|â–Œ         | 5/100 [02:26<46:21, 29.28s/it]
2025-01-22 20:09:13.239 | INFO     | __main__:<module>:82 - Selected idx: 164
2025-01-22 20:09:13.239 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the apple before the office? 
2025-01-22 20:09:13.239 | INFO     | __main__:<module>:84 - Answer: bedroom
2025-01-22 20:09:13.239 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 20:09:13.239 | INFO     | __main__:<module>:86 - Needle: [' Mary went to the bathroom.', ' Daniel journeyed to the bedroom.', ' John got the apple.', ' John journeyed to the bedroom.', ' Mary journeyed to the hallway.', ' John moved to the office.', ' Mary went back to the kitchen.']
2025-01-22 20:09:13.239 | INFO     | __main__:<module>:87 - Real Needle: [' John got the apple.', ' John journeyed to the bedroom.', ' John moved to the office.', ' Mary went back to the kitchen.']
2025-01-22 20:09:13.239 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ¤¦ğŸ¾\u200dâ™€', 'ğŸŠğŸ¼\u200dâ™‚', 'ğŸ•', 'ğŸ’ğŸ¿', 'ğŸ¦¸ğŸ¾\u200dâ™€', 'ğŸ§‘\u200dâš•ï¸', 'ğŸ¤¸ğŸ¿\u200dâ™€', 'ğŸ‘¶', 'ğŸ‘±ğŸ¿\u200dâ™€ï¸', 'ğŸƒğŸ¾\u200dâ™‚\u200dâ¡ï¸']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.27s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.31s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.21s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.94s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.43s/it]
Processing depth (1, 3, 5, 7):   0%|          | 0/100 [00:15<?, ?it/s]2025-01-22 20:09:28.749 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John got the apple.
2025-01-22 20:09:28.753 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (830, 834) -->  got the apple.
2025-01-22 20:09:28.753 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bedroom.
2025-01-22 20:09:28.771 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2972, 2978) -->  tragedy. John journeyed to
2025-01-22 20:09:28.771 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the office.
2025-01-22 20:09:28.792 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4238, 4243) -->  John moved to the office
2025-01-22 20:09:28.792 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary went back to the kitchen.
2025-01-22 20:09:28.820 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5675, 5681) --> . Mary went back to the
2025-01-22 20:09:28.820 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary went to the bathroom.
2025-01-22 20:09:28.837 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3422, 3427) --> . Mary went to the
2025-01-22 20:09:28.837 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the bedroom.
2025-01-22 20:09:28.852 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2974, 2980) -->  John journeyed to the bedroom
2025-01-22 20:09:28.852 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the hallway.
2025-01-22 20:09:28.854 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (355, 361) --> . Mary journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:09:29.716 | INFO     | test_jbb_embedding:begin_test:693 - John got the apple.<|eot_id|>
2025-01-22 20:09:29.716 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8156])
2025-01-22 20:09:31.954 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [243.5639880952381, 23.526395314989582, 252.58823529411765, 22.47789873476173, 31.384344951923076], 'topk_indices': array([ 830,    1, 8139, 8137,  361, 8150,   14, 8044,  362, 8144, 8154,
        833, 2979,   24,  819, 8152,  832, 8054, 8151,    0]), 'topk_tokens': [' got', '<|start_header_id|>', ':', '.\n\n', ' hallway', ':', '\n', '.\n\n', '.', ' before', '<|end_header_id|>', '.', ' bedroom', '\n\n', 'ï¿½', '<|start_header_id|>', ' apple', ' location', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [616.0, 225.171875, 210.125, 41.53125]}, 'weight': {'score': [22.21577380952381, 23.27164595845079, 21.23207720588235, 23.278645833333332, 29.806490384615383], 'topk_indices': array([3256, 3283, 3176, 3128, 7411, 7449, 1423, 1485, 4314, 4330, 5204,
       5143, 7132, 7188, 3471, 3445, 4997, 4968, 4920, 4945]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.5703125, 24.25390625, 22.8953125, 20.708333333333332]}, 'saliency': {'score': [1.3533819289434523, 0.1328266535133748, 1.4674072265625, 0.1268767051663896, 0.2291980449969952], 'topk_indices': array([ 829, 8044,   32,   24, 8053, 8010, 8143,  357, 8146,  830, 8050,
       8149, 8138, 8144,  817,  819,  361, 2979, 8054,  832]), 'topk_tokens': [' John', '.\n\n', '***', '\n\n', ' first', ' context', ' apple', ' journey', ' office', ' got', ' item', 'Answer', 'Question', ' before', 'ï¿½', 'ï¿½', ' hallway', ' bedroom', ' location', ' apple'], 'evidence_proportions': [3.3837890625, 1.2470703125, 1.21220703125, 0.22373453776041666]}}, 'pred_res': 'John got the apple.<|eot_id|>', 'score': 0}
2025-01-22 20:09:31.964 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:09:31.964 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-164_pid-0_1-3-5-7.pkl | len: 3 |  size: 2.02 KB
Processing depth (1, 3, 5, 7):   1%|          | 1/100 [00:18<30:43, 18.62s/it]is_0k: False
your chose emoji: ['ğŸ™\u200dâ™€', 'ğŸ‘', 'ğŸ˜´', 'ğŸ™†ğŸ½', 'ğŸ‡²ğŸ‡³', 'ğŸ‘©ğŸ¾\u200dâ¤ï¸\u200dğŸ‘©ğŸ½', 'ğŸ‘®ğŸ¿\u200dâ™‚', 'ğŸ™ğŸ¼\u200dâ™€', 'ğŸ§›ğŸ»\u200dâ™‚', 'ğŸ˜¬']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.40s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.68s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.90s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.36s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.86s/it]
Processing depth (3, 4, 5, 9):   1%|          | 1/100 [00:35<30:43, 18.62s/it]2025-01-22 20:09:49.203 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John got the apple.
2025-01-22 20:09:49.218 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2901, 2905) -->  John got the apple
2025-01-22 20:09:49.218 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bedroom.
2025-01-22 20:09:49.240 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3637, 3643) --> . John journeyed to the
2025-01-22 20:09:49.240 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the office.
2025-01-22 20:09:49.260 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4201, 4206) --> . John moved to the
2025-01-22 20:09:49.261 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary went back to the kitchen.
2025-01-22 20:09:49.299 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7152, 7158) -->  Mary went back to the kitchen
2025-01-22 20:09:49.299 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary went to the bathroom.
2025-01-22 20:09:49.315 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3255, 3260) --> . Mary went to the
2025-01-22 20:09:49.316 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the bedroom.
2025-01-22 20:09:49.334 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3638, 3644) -->  John journeyed to the bedroom
2025-01-22 20:09:49.334 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the hallway.
2025-01-22 20:09:49.335 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (355, 361) --> . Mary journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:09:51.013 | INFO     | test_jbb_embedding:begin_test:693 - John got the apple. During the summer of 1859 a man by the name of Jackson was lynched by a mob in Wright county, and Gov.
2025-01-22 20:09:51.013 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8190])
2025-01-22 20:09:53.266 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [233.2797619047619, 51.25212452703527, 433.00735294117646, 49.9875728080932, 19.106564405487806], 'topk_indices': array([7651, 7605, 3261, 7648, 7617, 7610, 7544, 7650, 7588, 7589, 7655,
       7649, 7662, 7619, 7611, 7618, 7663,    0, 7620, 7664]), 'topk_tokens': ['\n', ' five', '.', ' four', ' and', ' tele', 'nes', ' five', ' Min', 'nes', ' tele', ' or', ' and', ' or', 'graph', ' two', ' two', '<|begin_of_text|>', ' three', ' or'], 'evidence_proportions': [383.25, 282.5, 258.975, 62.666666666666664]}, 'weight': {'score': [21.936755952380953, 23.289322821310876, 21.23207720588235, 23.29709438228081, 29.334794207317074], 'topk_indices': array([3348, 3321, 3235, 3187, 7443, 7481, 1424, 1486, 4388, 4372, 5189,
       5250, 7164, 7220, 3530, 3504, 5043, 4991, 4966, 5014]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [25.396484375, 19.4140625, 18.88125, 24.69921875]}, 'saliency': {'score': [1.2986537388392858, 0.29288030750335653, 2.378963694852941, 0.2859416613178265, 0.13994561172113185], 'topk_indices': array([8180, 7605, 7581, 3260, 7648, 7609, 7654, 7650, 7649, 7544, 7619,
       7588, 7589, 7610, 7618, 7663, 7655, 7611, 7664, 7620]), 'topk_tokens': [' office', ' five', ' perpet', ' bathroom', ' four', ' bogus', ' bogus', ' five', ' or', 'nes', ' or', ' Min', 'nes', ' tele', ' two', ' two', ' tele', 'graph', ' or', ' three'], 'evidence_proportions': [2.51123046875, 1.4087727864583333, 1.27041015625, 0.4036865234375]}}, 'pred_res': 'John got the apple. During the summer of 1859 a man by the name of Jackson was lynched by a mob in Wright county, and Gov.', 'score': 0}
2025-01-22 20:09:53.273 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:09:53.274 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-164_pid-1_3-4-5-9.pkl | len: 3 |  size: 2.05 KB
Processing depth (3, 4, 5, 9):   2%|â–         | 2/100 [00:39<32:59, 20.20s/it]is_0k: False
your chose emoji: ['ğŸ¤½ğŸ½\u200dâ™€', 'ğŸš«', 'ğŸ““', 'ğŸ‘©ğŸ¾\u200dâ¤\u200dğŸ’‹\u200dğŸ‘©ğŸ¼', 'ğŸ¤½ğŸ¿\u200dâ™‚', 'ğŸ§‘ğŸ½\u200dğŸ¦½', 'â›¹ï¸\u200dâ™‚ï¸', 'ğŸ‘¨ğŸ½\u200dğŸ¤\u200dğŸ‘¨ğŸ¿', 'ğŸŒ¸', 'ğŸ•']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.04s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.27s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.08s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:12<00:00,  2.66s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:12<00:00,  3.20s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 2, 7, 9):   2%|â–         | 2/100 [00:54<32:59, 20.20s/it]2025-01-22 20:10:08.298 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John got the apple.
2025-01-22 20:10:08.339 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bedroom.
2025-01-22 20:10:08.348 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1755, 1761) --> . John journeyed to the
2025-01-22 20:10:08.348 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the office.
2025-01-22 20:10:08.375 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5605, 5610) --> . John moved to the
2025-01-22 20:10:08.375 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary went back to the kitchen.
2025-01-22 20:10:08.410 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7110, 7116) -->  Mary went back to the kitchen
2025-01-22 20:10:08.410 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary went to the bathroom.
2025-01-22 20:10:08.426 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3165, 3170) -->  ranks. Mary went to
2025-01-22 20:10:08.426 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the bedroom.
2025-01-22 20:10:08.435 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1756, 1762) -->  John journeyed to the bedroom
2025-01-22 20:10:08.435 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the hallway.
2025-01-22 20:10:08.441 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (293, 299) -->  Mary journeyed to the hallway
2025-01-22 20:10:08.441 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 20:10:08.441 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 20:10:08.441 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 20:10:08.441 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ‹ğŸ¾\u200dâ™€', 'ğŸ’†ğŸ¿\u200dâ™€', 'ğŸ€', 'ğŸ¤·ğŸ¼\u200dâ™‚ï¸', 'ğŸª¡', 'ğŸ§‘ğŸ»\u200dâ¤\u200dğŸ§‘ğŸ¼', 'âœï¸', 'ğŸ“‚', 'ğŸ¤˜ğŸ¾', 'ğŸŒğŸ»\u200dâ™€']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.24s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.45s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.36s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.03s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.52s/it]
Processing depth (5, 6, 7, 8):   2%|â–         | 2/100 [01:11<32:59, 20.20s/it]2025-01-22 20:10:24.666 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John got the apple.
2025-01-22 20:10:24.686 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4176, 4180) -->  John got the apple
2025-01-22 20:10:24.686 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bedroom.
2025-01-22 20:10:24.706 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4095, 4101) -->  Daniel journeyed to the bedroom
2025-01-22 20:10:24.706 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the office.
2025-01-22 20:10:24.733 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5629, 5634) --> . John moved to the
2025-01-22 20:10:24.733 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary went back to the kitchen.
2025-01-22 20:10:24.770 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6543, 6549) --> . Mary went back to the
2025-01-22 20:10:24.770 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary went to the bathroom.
2025-01-22 20:10:24.786 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3288, 3293) --> . Mary went to the
2025-01-22 20:10:24.786 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the bedroom.
2025-01-22 20:10:24.806 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4094, 4100) --> . Daniel journeyed to the
2025-01-22 20:10:24.806 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the hallway.
2025-01-22 20:10:24.808 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (355, 361) --> . Mary journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:10:25.549 | INFO     | test_jbb_embedding:begin_test:693 - the bedroom<|eot_id|>
2025-01-22 20:10:25.549 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8186])
2025-01-22 20:10:27.778 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [250.70238095238096, 22.74300128220784, 302.97058823529414, 21.57124125874126, 23.68994140625], 'topk_indices': array([8074, 4180, 8169, 8179, 4183,  362, 3293,   14, 8180, 8176, 8167,
       4100, 8177,  361, 8084, 8174, 4179, 8184, 8181,    0]), 'topk_tokens': ['.\n\n', '.', ':', 'Answer', 'ï¿½', '.', ' bathroom', '\n', ':', ' office', '.\n\n', ' bedroom', '?', ' hallway', ' location', ' before', ' apple', '<|end_header_id|>', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [492.625, 381.25, 172.05, 24.416666666666668]}, 'weight': {'score': [22.333333333333332, 23.296050723531568, 19.938419117647058, 23.305533830204883, 29.8302734375], 'topk_indices': array([3304, 3331, 3218, 3170, 7427, 7465, 1472, 1534, 4323, 4339, 5222,
       5161, 7148, 7204, 3487, 3513, 4963, 5015, 4986, 4938]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [25.396484375, 24.79296875, 18.88125, 20.708333333333332]}, 'saliency': {'score': [1.626554943266369, 0.12838016556127121, 1.610251034007353, 0.12142967174512713, 0.1753312110900879], 'topk_indices': array([4183, 8167, 4177, 8177,  357, 4742, 4176, 8168, 8173, 8170, 4096,
       4095, 8179, 8176, 8084, 8174, 3293, 4100,  361, 4179]), 'topk_tokens': ['ï¿½', '.\n\n', ' got', '?', ' journey', ' bedroom', ' John', 'Question', ' apple', ' Where', ' journey', ' Daniel', 'Answer', ' office', ' location', ' before', ' bathroom', ' bedroom', ' hallway', ' apple'], 'evidence_proportions': [3.3739013671875, 2.6241048177083335, 0.82841796875, 0.12922159830729166]}}, 'pred_res': 'the bedroom<|eot_id|>', 'score': 100}
2025-01-22 20:10:27.785 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:10:27.785 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-164_pid-2_5-6-7-8.pkl | len: 3 |  size: 2.0 KB
Processing depth (5, 6, 7, 8):   3%|â–         | 3/100 [01:14<43:13, 26.74s/it]is_0k: False
your chose emoji: ['ğŸ‘©ğŸ½\u200dâš–ï¸', 'ğŸ»\u200dâ„ï¸', 'ğŸš¾', 'ğŸ‘”', 'ğŸš¶ğŸ¿\u200dâ™€', 'ğŸ‘°ğŸ½\u200dâ™‚ï¸', '\U0001fae5', 'ğŸ‘¨ğŸ½\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘¨ğŸ¼', 'ğŸ‘©\u200dğŸ¦½', 'ğŸ‹ğŸ¿\u200dâ™€ï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  3.85s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.42s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.46s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.11s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.56s/it]
Processing depth (0, 4, 7, 8):   3%|â–         | 3/100 [01:30<43:13, 26.74s/it]2025-01-22 20:10:43.864 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John got the apple.
2025-01-22 20:10:43.906 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bedroom.
2025-01-22 20:10:43.924 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3624, 3630) -->  Hon. John journeyed to
2025-01-22 20:10:43.924 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the office.
2025-01-22 20:10:43.951 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5721, 5726) --> . John moved to the
2025-01-22 20:10:43.952 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary went back to the kitchen.
2025-01-22 20:10:43.984 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6628, 6634) -->  Mary went back to the kitchen
2025-01-22 20:10:43.984 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary went to the bathroom.
2025-01-22 20:10:44.000 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3307, 3312) --> . Mary went to the
2025-01-22 20:10:44.000 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the bedroom.
2025-01-22 20:10:44.017 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3626, 3632) -->  John journeyed to the bedroom
2025-01-22 20:10:44.017 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the hallway.
2025-01-22 20:10:44.019 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (308, 314) --> . Mary journeyed to the
2025-01-22 20:10:44.019 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 20:10:44.019 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 20:10:44.019 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 20:10:44.020 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ§‘ğŸ»\u200dğŸ¨', 'ğŸ‘¨ğŸ¾\u200dğŸ¦¼\u200dâ¡', 'ğŸ‡¬ğŸ‡¶', 'ğŸ¤·ğŸ¼\u200dâ™€ï¸', 'ğŸ›³', 'ğŸŸ', 'ğŸ¤¸ğŸ»\u200dâ™€ï¸', 'ğŸ‘©ğŸ½\u200dâ¤ï¸\u200dğŸ‘©ğŸ»', 'ğŸ™…\u200dâ™‚ï¸', 'ğŸ‘©ğŸ¿\u200dâ¤\u200dğŸ‘¨ğŸ¿']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.06s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.08s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:11<00:03,  3.97s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:12<00:00,  2.79s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:12<00:00,  3.24s/it]
Processing depth (0, 1, 7, 8):   3%|â–         | 3/100 [01:45<43:13, 26.74s/it]2025-01-22 20:10:58.819 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John got the apple.
2025-01-22 20:10:58.862 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bedroom.
2025-01-22 20:10:58.867 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (907, 913) --> . John journeyed to the
2025-01-22 20:10:58.867 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the office.
2025-01-22 20:10:58.895 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5681, 5686) --> . John moved to the
2025-01-22 20:10:58.896 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary went back to the kitchen.
2025-01-22 20:10:58.928 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6603, 6609) --> . Mary went back to the
2025-01-22 20:10:58.928 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary went to the bathroom.
2025-01-22 20:10:58.944 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3252, 3257) --> . Mary went to the
2025-01-22 20:10:58.944 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the bedroom.
2025-01-22 20:10:58.949 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (908, 914) -->  John journeyed to the bedroom
2025-01-22 20:10:58.949 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the hallway.
2025-01-22 20:10:58.951 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (360, 366) --> . Mary journeyed to the
2025-01-22 20:10:58.951 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 20:10:58.951 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 20:10:58.951 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 20:10:58.951 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['âœ‹ğŸ»', 'ğŸˆ', 'ğŸ—“', 'ğŸ“°', 'ğŸ‘©ğŸ»\u200dâ¤\u200dğŸ‘¨ğŸ¼', 'ğŸ¦†', 'ğŸ‘©ğŸ¼\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘¨ğŸ¼', '\U0001faf1ğŸ½', 'ğŸ¦', 'ğŸšµ']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.34s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.55s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.43s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.02s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.55s/it]
Processing depth (6, 7, 8, 9):   3%|â–         | 3/100 [02:01<43:13, 26.74s/it]2025-01-22 20:11:14.884 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John got the apple.
2025-01-22 20:11:14.906 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4736, 4740) -->  John got the apple
2025-01-22 20:11:14.907 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bedroom.
2025-01-22 20:11:14.926 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4071, 4077) -->  Daniel journeyed to the bedroom
2025-01-22 20:11:14.927 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the office.
2025-01-22 20:11:14.958 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6539, 6544) --> . John moved to the
2025-01-22 20:11:14.958 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary went back to the kitchen.
2025-01-22 20:11:14.997 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7235, 7241) --> . Mary went back to the
2025-01-22 20:11:14.997 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary went to the bathroom.
2025-01-22 20:11:15.013 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3232, 3237) --> . Mary went to the
2025-01-22 20:11:15.013 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the bedroom.
2025-01-22 20:11:15.033 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4070, 4076) --> . Daniel journeyed to the
2025-01-22 20:11:15.033 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the hallway.
2025-01-22 20:11:15.034 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (312, 318) -->  Mary journeyed to the hallway
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:11:15.855 | INFO     | test_jbb_embedding:begin_test:693 - John's home.<|eot_id|>
2025-01-22 20:11:15.856 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8178])
2025-01-22 20:11:18.070 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [423.3110119047619, 41.06242742329788, 334.2867647058824, 39.4644863686602, 31.796566611842106], 'topk_indices': array([4740, 4737, 4091, 8167, 8163, 8162, 8165, 8160, 8032, 8159, 8076,
       8161, 8169, 8168, 4739, 8166, 4092, 8174,    0, 8173]), 'topk_tokens': ['.', ' got', ' of', ' the', ' was', ' Where', ' apple', 'Question', ' context', '.\n\n', ' location', ':', '?', ' office', ' apple', ' before', ' to', '<|start_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [1017.375, 438.6666666666667, 392.3, 37.755208333333336]}, 'weight': {'score': [22.333333333333332, 23.28681357719105, 21.731158088235293, 23.292520224425886, 29.67701480263158], 'topk_indices': array([3298, 3325, 3212, 3164, 7453, 7415, 1438, 1500, 4338, 4322, 5170,
       5231, 7129, 7185, 3481, 3507, 4927, 4952, 5004, 4975]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [25.396484375, 24.79296875, 18.88125, 20.708333333333332]}, 'saliency': {'score': [2.6473839169456843, 0.22916924803374436, 1.9785874310661764, 0.21928067905932433, 0.24190521240234375], 'topk_indices': array([7516, 8163, 4076, 8171, 5589, 7560, 7368, 7561, 8159, 4737, 8169,
       4092, 8162, 8032, 8076, 8165, 8160, 8168, 8166, 4739]), 'topk_tokens': ['nes', ' was', ' bedroom', 'Answer', ' John', ' Min', 'nes', 'nes', '.\n\n', ' got', '?', ' to', ' Where', ' context', ' location', ' apple', 'Question', ' office', ' before', ' apple'], 'evidence_proportions': [6.7197265625, 2.98291015625, 1.93037109375, 0.1944732666015625]}}, 'pred_res': "John's home.<|eot_id|>", 'score': 0}
2025-01-22 20:11:18.078 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:11:18.078 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-164_pid-3_6-7-8-9.pkl | len: 3 |  size: 1.99 KB
Processing depth (6, 7, 8, 9):   4%|â–         | 4/100 [02:04<57:39, 36.04s/it]is_0k: False
your chose emoji: ['ğŸ‘µğŸ½', 'ğŸ§ğŸ¿\u200dâ™€ï¸', 'ğŸ™‹ğŸ»\u200dâ™€', 'ğŸ§‘\u200dğŸ§’\u200dğŸ§’', 'ğŸ‘ğŸ»', 'ğŸ¿', 'ğŸ‘©ğŸ»\u200dâœˆï¸', 'ğŸ§‘ğŸ¿\u200dğŸ¦½\u200dâ¡ï¸', 'ğŸ§\u200dâ™‚ï¸', 'ğŸ˜¶']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.04s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:09,  4.56s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.45s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.09s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.57s/it]
Processing depth (1, 2, 3, 9):   4%|â–         | 4/100 [02:20<57:39, 36.04s/it]2025-01-22 20:11:34.168 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John got the apple.
2025-01-22 20:11:34.172 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (805, 809) -->  John got the apple
2025-01-22 20:11:34.172 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bedroom.
2025-01-22 20:11:34.181 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1821, 1827) --> . John journeyed to the
2025-01-22 20:11:34.182 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the office.
2025-01-22 20:11:34.196 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2921, 2926) -->  John moved to the office
2025-01-22 20:11:34.196 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary went back to the kitchen.
2025-01-22 20:11:34.231 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7164, 7170) -->  Mary went back to the kitchen
2025-01-22 20:11:34.231 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary went to the bathroom.
2025-01-22 20:11:34.247 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3276, 3281) --> . Mary went to the
2025-01-22 20:11:34.247 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the bedroom.
2025-01-22 20:11:34.256 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1822, 1828) -->  John journeyed to the bedroom
2025-01-22 20:11:34.256 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the hallway.
2025-01-22 20:11:34.257 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (311, 317) --> . Mary journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:11:35.075 | INFO     | test_jbb_embedding:begin_test:693 - John's location<|eot_id|>
2025-01-22 20:11:35.075 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8216])
2025-01-22 20:11:37.316 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [333.9940476190476, 33.077936792797175, 316.4154411764706, 31.716736951472924, 53.551490542763155], 'topk_indices': array([8197, 8111, 8199, 8210,  806,   24, 8104,  805, 8207,  271,  809,
       8206,   14, 8204, 1827, 8114,  808, 8211, 8212,    0]), 'topk_tokens': ['.\n\n', ' in', ':', ':', ' got', '\n\n', '.\n\n', ' John', '?', 'hue', '.', ' office', '\n', ' before', ' bedroom', ' location', ' apple', '<|eot_id|>', '<|start_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [887.375, 399.375, 183.35, 25.229166666666668]}, 'weight': {'score': [22.89248511904762, 23.314136832339702, 21.23207720588235, 23.31954566984476, 29.580921052631577], 'topk_indices': array([3369, 3342, 3208, 3256, 7455, 7493, 1457, 1519, 4360, 4376, 5175,
       5236, 7176, 7232, 3551, 3525, 5000, 4977, 4952, 5029]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [25.396484375, 19.4140625, 22.8953125, 24.69921875]}, 'saliency': {'score': [2.0363682338169644, 0.18549033263722017, 1.9491146312040442, 0.17707448506352372, 0.39712990208675986], 'topk_indices': array([1822,  328, 8104, 8209, 8207, 8070, 8113,  317, 8110,  326, 8203,
        806, 8198,  805, 8206, 8204,  271, 8114, 1827,  808]), 'topk_tokens': [' John', '\u200d', '.\n\n', 'Answer', '?', ' context', ' first', ' hallway', ' item', 'â¤', ' apple', ' got', 'Question', ' John', ' office', ' before', 'hue', ' location', ' bedroom', ' apple'], 'evidence_proportions': [6.013427734375, 2.0840657552083335, 1.052978515625, 0.15678914388020834]}}, 'pred_res': "John's location<|eot_id|>", 'score': 0}
2025-01-22 20:11:37.337 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:11:37.338 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-164_pid-4_1-2-3-9.pkl | len: 3 |  size: 1.99 KB
Processing depth (1, 2, 3, 9):   5%|â–Œ         | 5/100 [02:23<47:28, 29.99s/it]Processing depth (1, 2, 3, 9):   5%|â–Œ         | 5/100 [02:24<45:36, 28.81s/it]
2025-01-22 20:11:37.396 | INFO     | __main__:<module>:82 - Selected idx: 166
2025-01-22 20:11:37.396 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the apple before the office? 
2025-01-22 20:11:37.396 | INFO     | __main__:<module>:84 - Answer: bedroom
2025-01-22 20:11:37.396 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 20:11:37.396 | INFO     | __main__:<module>:86 - Needle: [' Mary journeyed to the hallway.', ' Daniel journeyed to the bedroom.', ' John picked up the apple.', ' John journeyed to the bedroom.', ' Mary went to the bathroom.', ' John moved to the office.', ' Mary went back to the kitchen.']
2025-01-22 20:11:37.396 | INFO     | __main__:<module>:87 - Real Needle: [' John picked up the apple.', ' John journeyed to the bedroom.', ' John moved to the office.', ' Mary went back to the kitchen.']
2025-01-22 20:11:37.396 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['â', 'ğŸ‘©ğŸ¿\u200dğŸ«', 'ğŸ§‘ğŸ»\u200dğŸ¦½\u200dâ¡ï¸', 'ğŸ¦\u200dâ¬›', 'ğŸ‘©ğŸ½\u200dğŸ“', 'ğŸ‘¨ğŸ½\u200dâ¤ï¸\u200dğŸ‘¨ğŸ»', '\U0001faf7ğŸ½', 'ğŸ¤µğŸ¾\u200dâ™‚ï¸', 'ğŸ‘©ğŸ¼\u200dğŸ¦³', 'ğŸ‘±ğŸ¼\u200dâ™‚ï¸']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  3.84s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:09,  4.54s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.30s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.97s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.46s/it]
Processing depth (1, 2, 6, 7):   0%|          | 0/100 [00:15<?, ?it/s]2025-01-22 20:11:52.977 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John picked up the apple.
2025-01-22 20:11:52.981 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (895, 900) --> . John picked up the
2025-01-22 20:11:52.982 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bedroom.
2025-01-22 20:11:52.991 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1793, 1799) --> . John journeyed to the
2025-01-22 20:11:52.992 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the office.
2025-01-22 20:11:53.018 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4864, 4869) --> . John moved to the
2025-01-22 20:11:53.018 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary went back to the kitchen.
2025-01-22 20:11:53.046 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5795, 5801) --> . Mary went back to the
2025-01-22 20:11:53.046 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the hallway.
2025-01-22 20:11:53.073 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5270, 5276) --> . Mary journeyed to the
2025-01-22 20:11:53.073 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the bedroom.
2025-01-22 20:11:53.084 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1794, 1800) -->  John journeyed to the bedroom
2025-01-22 20:11:53.084 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bathroom.
2025-01-22 20:11:53.090 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1114, 1119) -->  Mary went to the bathroom
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:11:53.917 | INFO     | test_jbb_embedding:begin_test:693 - John's hand.<|eot_id|>
2025-01-22 20:11:53.917 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8179])
2025-01-22 20:11:56.127 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [208.5625, 23.13465725067221, 180.77573529411765, 22.304581005157804, 18.558131167763158], 'topk_indices': array([   1,  897, 8160, 1799, 8169,    9, 8167, 8173,  901, 8067, 7653,
       7564,  900, 8177, 8077,   24,   14, 7654, 8174,    0]), 'topk_tokens': ['<|start_header_id|>', ' picked', '.\n\n', ' bedroom', ' office', ':', ' before', ':', '.', '.\n\n', ' Min', 'nes', ' apple', '<|end_header_id|>', ' location', '\n\n', '\n', 'nes', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [414.4, 223.375, 208.825, 22.0]}, 'weight': {'score': [20.082386363636363, 23.289837829992667, 22.905330882352942, 23.29930615252364, 29.80797697368421], 'topk_indices': array([3268, 3295, 3188, 3140, 7456, 7418, 1491, 1429, 4263, 4247, 5064,
       5125, 7159, 7103, 3477, 3451, 4860, 4889, 4918, 4835]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.334375, 19.4140625, 18.88125, 20.708333333333332]}, 'saliency': {'score': [1.0899172696200283, 0.1304486744912613, 1.1424847771139706, 0.12574366124830183, 0.14157746967516446], 'topk_indices': array([4869,    8, 8073, 7563, 8076, 8067,  257, 8161, 8166, 8172, 8167,
         24, 8169,  897, 1799, 7564, 7653,  900, 8077, 7654]), 'topk_tokens': [' office', ' Date', ' item', ' Min', ' first', '.\n\n', 'hue', 'Question', ' apple', 'Answer', ' before', '\n\n', ' office', ' picked', ' bedroom', 'nes', ' Min', ' apple', ' location', 'nes'], 'evidence_proportions': [2.3171875, 1.1023356119791667, 1.01826171875, 0.1144866943359375]}}, 'pred_res': "John's hand.<|eot_id|>", 'score': 0}
2025-01-22 20:11:56.135 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:11:56.135 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-166_pid-0_1-2-6-7.pkl | len: 3 |  size: 2.0 KB
Processing depth (1, 2, 6, 7):   1%|          | 1/100 [00:18<30:45, 18.64s/it]is_0k: False
your chose emoji: ['ğŸ¤', 'ğŸ‘©ğŸ»\u200dğŸ³', 'ğŸ‘®\u200dâ™‚', 'ğŸŠ\u200dâ™‚ï¸', 'ğŸ‘¨ğŸ¿\u200dâ¤\u200dğŸ’‹\u200dğŸ‘¨ğŸ¾', 'ğŸ‘´ğŸ»', 'ğŸ¤¯', 'â™»', 'ğŸš¶ğŸ½\u200dâ™€\u200dâ¡', 'ğŸ¦¹ğŸ¾\u200dâ™‚ï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.32s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.41s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.31s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.99s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.49s/it]
Processing depth (1, 2, 4, 7):   1%|          | 1/100 [00:34<30:45, 18.64s/it]2025-01-22 20:12:11.892 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John picked up the apple.
2025-01-22 20:12:11.897 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (813, 818) --> . John picked up the
2025-01-22 20:12:11.897 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bedroom.
2025-01-22 20:12:11.906 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1851, 1857) --> . John journeyed to the
2025-01-22 20:12:11.906 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the office.
2025-01-22 20:12:11.923 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3621, 3626) -->  Hon. John moved to
2025-01-22 20:12:11.923 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary went back to the kitchen.
2025-01-22 20:12:11.955 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5631, 5637) --> . Mary went back to the
2025-01-22 20:12:11.955 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the hallway.
2025-01-22 20:12:11.980 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5032, 5038) --> . Mary journeyed to the
2025-01-22 20:12:11.980 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the bedroom.
2025-01-22 20:12:11.989 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1852, 1858) -->  John journeyed to the bedroom
2025-01-22 20:12:11.989 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bathroom.
2025-01-22 20:12:11.994 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1105, 1110) --> . Mary went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:12:12.814 | INFO     | test_jbb_embedding:begin_test:693 - John's pocket.<|eot_id|>
2025-01-22 20:12:12.814 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8185])
2025-01-22 20:12:15.028 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [257.16335227272725, 24.053966170004884, 231.0514705882353, 22.992809700576757, 16.383035007911392], 'topk_indices': array([8079, 8166, 8167, 8082, 8168, 8179, 8181,  819,   14, 8073, 8183,
       8176,   24, 8175, 8173, 1857,  818, 8083, 8180,    0]), 'topk_tokens': [' item', '.\n\n', 'Question', ' first', ':', ':', '<|start_header_id|>', '.', '\n', '.\n\n', '<|end_header_id|>', '?', '\n\n', ' office', ' before', ' bedroom', ' apple', ' location', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [445.95, 335.1666666666667, 238.7125, 37.213541666666664]}, 'weight': {'score': [21.175071022727273, 23.29794554531021, 21.23207720588235, 23.307986409375385, 29.980617088607595], 'topk_indices': array([3281, 3254, 3174, 3126, 7384, 7422, 1415, 1477, 4279, 4295, 5176,
       5115, 7105, 7161, 3463, 3437, 4956, 4927, 4904, 4879]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.334375, 19.4140625, 23.6890625, 20.708333333333332]}, 'saliency': {'score': [1.4038058194247158, 0.13453193519193485, 1.4088709214154411, 0.12844679735675005, 0.12256921695757515], 'topk_indices': array([8073,  814, 8077,   24, 8039, 8176, 1853, 8169, 8079, 8178, 8082,
       8172,  815, 1110, 8167, 8173, 8175,  818, 8083, 1857]), 'topk_tokens': ['.\n\n', ' John', ' obtained', '\n\n', ' context', '?', ' journey', ' Where', ' item', 'Answer', ' first', ' apple', ' picked', ' bathroom', 'Question', ' before', ' office', ' apple', ' location', ' bedroom'], 'evidence_proportions': [2.4912109375, 1.760009765625, 1.324609375, 0.207427978515625]}}, 'pred_res': "John's pocket.<|eot_id|>", 'score': 0}
2025-01-22 20:12:15.035 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:12:15.036 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-166_pid-1_1-2-4-7.pkl | len: 3 |  size: 2.02 KB
Processing depth (1, 2, 4, 7):   2%|â–         | 2/100 [00:37<30:41, 18.79s/it]is_0k: False
your chose emoji: ['ğŸ‘¨ğŸ¿\u200dâ¤\u200dğŸ‘¨ğŸ¿', 'ğŸ§ğŸ¼\u200dâ™€\u200dâ¡ï¸', 'ğŸ‘³ğŸ»\u200dâ™€ï¸', 'ğŸ›', 'ğŸ‘©ğŸ¾\u200dâ¤\u200dğŸ‘©ğŸ¿', 'ğŸ™‹\u200dâ™€ï¸', 'âœ‹ğŸ»', 'â¬‡', 'ğŸ˜¡', 'ğŸ‘®ğŸ½\u200dâ™‚']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.37s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.33s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.27s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.98s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.47s/it]
Processing depth (0, 1, 3, 6):   2%|â–         | 2/100 [00:53<30:41, 18.79s/it]2025-01-22 20:12:30.697 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John picked up the apple.
2025-01-22 20:12:30.697 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the apple.
2025-01-22 20:12:30.698 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bedroom.
2025-01-22 20:12:30.702 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (827, 833) --> . John journeyed to the
2025-01-22 20:12:30.702 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the office.
2025-01-22 20:12:30.716 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2912, 2917) --> . John moved to the
2025-01-22 20:12:30.716 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary went back to the kitchen.
2025-01-22 20:12:30.740 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4816, 4822) -->  the senate. Mary went back
2025-01-22 20:12:30.740 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the hallway.
2025-01-22 20:12:30.770 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5139, 5145) --> . Mary journeyed to the
2025-01-22 20:12:30.771 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the bedroom.
2025-01-22 20:12:30.776 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (828, 834) -->  John journeyed to the bedroom
2025-01-22 20:12:30.776 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bathroom.
2025-01-22 20:12:30.782 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1120, 1125) --> . Mary went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:12:31.632 | INFO     | test_jbb_embedding:begin_test:693 - John's bedroom.<|eot_id|>
2025-01-22 20:12:31.632 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8213])
2025-01-22 20:12:33.860 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [340.31107954545456, 34.18414146178189, 238.54595588235293, 32.93564647792589, 14.507581485215054], 'topk_indices': array([ 104,   74, 8204, 6141,   35,   24, 8208,   68, 8209,  111,  833,
        112,   69, 8201, 8203,  185,   67,  105,  106,    0]), 'topk_tokens': [' P', ' PA', '?', 'the', '.', '\n\n', '<|eot_id|>', 'E', '<|start_header_id|>', '.', ' bedroom', ' PA', 'ER', ' before', ' office', 'ION', 'ION', 'ION', 'E', '<|begin_of_text|>'], 'evidence_proportions': [643.75, 394.2083333333333, 344.5, 30.057291666666668]}, 'weight': {'score': [21.326704545454547, 23.316891203140216, 21.23207720588235, 23.32658007979699, 29.799227150537636], 'topk_indices': array([3308, 3335, 3228, 3180, 7454, 7492, 1430, 1492, 4365, 4349, 5235,
       5174, 7231, 7175, 3517, 3491, 4969, 5021, 4992, 4944]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.08125, 19.4140625, 18.88125, 24.6484375]}, 'saliency': {'score': [1.7384615811434658, 0.19370873738170946, 1.48974609375, 0.18685815677500536, 0.11070185835643481], 'topk_indices': array([  56, 8197, 8195, 8200, 8111,   68,   31, 6141,   38,   74,    0,
         69,  185, 8201,  112,  833, 8203,   67,  106,  105]), 'topk_tokens': ['istributed', ' Where', 'Question', ' apple', ' location', 'E', ' picked', 'the', '***', ' PA', '<|begin_of_text|>', 'ER', 'ION', ' before', ' PA', ' bedroom', ' office', 'ION', 'E', 'ION'], 'evidence_proportions': [3.4876953125, 1.9527994791666667, 1.59267578125, 0.18791707356770834]}}, 'pred_res': "John's bedroom.<|eot_id|>", 'score': 100}
2025-01-22 20:12:33.867 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:12:33.868 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-166_pid-2_0-1-3-6.pkl | len: 3 |  size: 1.97 KB
Processing depth (0, 1, 3, 6):   3%|â–         | 3/100 [00:56<30:24, 18.81s/it]is_0k: False
your chose emoji: ['ğŸ‘ï¸\u200dğŸ—¨ï¸', 'ğŸ´\U000e0067\U000e0062\U000e0065\U000e006e\U000e0067\U000e007f', 'ğŸ§‘ğŸ¼\u200dğŸ¼', 'ğŸ§‘\u200dğŸ„', 'ğŸ‘©ğŸ½\u200dâ¤ï¸\u200dğŸ‘©ğŸ»', '\U0001fabf', 'ğŸƒ\u200dâ™€ï¸', 'ğŸ”›', 'ğŸ§‘ğŸ¾\u200dğŸš€', 'ğŸ§–ğŸ»\u200dâ™‚']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.33s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.33s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:03,  3.98s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:12<00:00,  2.59s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:12<00:00,  3.17s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 5, 7, 9):   3%|â–         | 3/100 [01:10<30:24, 18.81s/it]2025-01-22 20:12:48.373 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John picked up the apple.
2025-01-22 20:12:48.373 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the apple.
2025-01-22 20:12:48.373 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bedroom.
2025-01-22 20:12:48.397 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4165, 4171) --> . John journeyed to the
2025-01-22 20:12:48.397 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the office.
2025-01-22 20:12:48.426 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5625, 5630) --> . John moved to the
2025-01-22 20:12:48.426 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary went back to the kitchen.
2025-01-22 20:12:48.462 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7252, 7258) --> . Mary went back to the
2025-01-22 20:12:48.462 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the hallway.
2025-01-22 20:12:48.487 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5062, 5068) --> . Mary journeyed to the
2025-01-22 20:12:48.488 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the bedroom.
2025-01-22 20:12:48.509 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4166, 4172) -->  John journeyed to the bedroom
2025-01-22 20:12:48.509 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bathroom.
2025-01-22 20:12:48.514 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1077, 1082) --> . Mary went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:13:02.548 | INFO     | test_jbb_embedding:begin_test:693 - John's location is not specified before the office, but it is mentioned that John picked up the apple.<|eot_id|>
2025-01-22 20:13:02.549 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8225])
2025-01-22 20:13:05.478 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [419.1988636363636, 49.38714982377248, 349.7279411764706, 47.77014516424472, 32.20340119949495], 'topk_indices': array([4171,   68,    1, 4290,   35, 8214, 4270,  106,   14, 8221,  105,
       8216,   67, 8079,   24, 8220, 8213, 8215, 4291,    0]), 'topk_tokens': [' bedroom', 'E', '<|start_header_id|>', ' Min', '.', ' the', 'nes', 'E', '\n', '<|start_header_id|>', 'ION', '?', 'ION', ' context', '\n\n', '<|eot_id|>', ' before', ' office', 'nes', '<|begin_of_text|>'], 'evidence_proportions': [814.1, 470.2916666666667, 387.9, 65.10416666666667]}, 'weight': {'score': [20.252130681818183, 23.315137715726788, 21.23207720588235, 23.327690919220906, 29.333491161616163], 'topk_indices': array([3344, 3317, 3189, 3237, 7450, 7488, 1505, 1443, 4309, 4325, 5206,
       5145, 7202, 7146, 3500, 3526, 4922, 4945, 4974, 4897]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.08125, 19.4140625, 18.88125, 20.708333333333332]}, 'saliency': {'score': [2.2084461558948862, 0.28041010640116065, 2.1214240579044117, 0.2714085152099997, 0.23981976749921086], 'topk_indices': array([1082,   34, 8216, 8209, 1172,   38,   24, 8123, 8207,  105, 8212,
         31,   67, 4270, 4290, 4171, 8079, 8213, 8215, 4291]), 'topk_tokens': [' bathroom', ' apple', '?', ' Where', 'nes', '***', '\n\n', ' location', 'Question', 'ION', ' apple', ' picked', 'ION', 'nes', ' Min', ' bedroom', ' context', ' before', ' office', 'nes'], 'evidence_proportions': [4.5263671875, 2.433837890625, 1.86640625, 0.33648681640625]}}, 'pred_res': "John's location is not specified before the office, but it is mentioned that John picked up the apple.<|eot_id|>", 'score': 0}
2025-01-22 20:13:05.485 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:13:05.485 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-166_pid-3_0-5-7-9.pkl | len: 3 |  size: 2.08 KB
Processing depth (0, 5, 7, 9):   4%|â–         | 4/100 [01:27<38:11, 23.87s/it]is_0k: False
your chose emoji: ['ğŸ‡¦ğŸ‡¼', 'ğŸ•µğŸ»\u200dâ™‚ï¸', 'ğŸš¶ğŸ»\u200dâ™‚', 'ğŸ‡µğŸ‡·', 'ğŸ‘¨ğŸ½\u200dâ¤\u200dğŸ‘¨ğŸ¾', 'ğŸ‘¨ğŸ½\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘¨ğŸ¼', 'ğŸ•', 'ğŸ‡©ğŸ‡¿', 'ğŸ§‘ğŸ»\u200dâœˆ', 'ğŸ‘¨ğŸ»\u200dğŸ¤\u200dğŸ‘¨ğŸ¾']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.05s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.20s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.29s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.03s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.47s/it]
Processing depth (0, 5, 8, 9):   4%|â–         | 4/100 [01:43<38:11, 23.87s/it]2025-01-22 20:13:21.232 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John picked up the apple.
2025-01-22 20:13:21.233 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the apple.
2025-01-22 20:13:21.233 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bedroom.
2025-01-22 20:13:21.255 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4216, 4222) -->  John journeyed to the bedroom
2025-01-22 20:13:21.256 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the office.
2025-01-22 20:13:21.288 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6611, 6616) --> . John moved to the
2025-01-22 20:13:21.288 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary went back to the kitchen.
2025-01-22 20:13:21.327 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7273, 7279) -->  cold. Mary went back to
2025-01-22 20:13:21.327 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the hallway.
2025-01-22 20:13:21.352 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5062, 5068) --> . Mary journeyed to the
2025-01-22 20:13:21.352 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the bedroom.
2025-01-22 20:13:21.383 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4217, 4223) -->  journeyed to the bedroom.
2025-01-22 20:13:21.383 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the bathroom.
2025-01-22 20:13:21.390 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1220, 1225) -->  Republican. Mary went to
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:13:22.748 | INFO     | test_jbb_embedding:begin_test:693 - John's location is not specified before the office, but it is mentioned that John picked up the apple.<|eot_id|>
2025-01-22 20:13:22.748 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8181])
2025-01-22 20:13:24.961 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [521.2443181818181, 58.55707401637341, 300.38235294117646, 56.802605125844075, 21.334415584415584], 'topk_indices': array([1194,  181, 1207, 1155,  112, 8177, 1213,   24,   67,   29, 8176,
         35,   38, 1154,  106,  105,  185,   39, 1214,    0]), 'topk_tokens': ['nes', 'G', ' the', 'ot', ' PA', '<|start_header_id|>', 'Min', '\n\n', 'ION', '\n\n', '<|eot_id|>', '.', '***', 'nes', 'E', 'ION', 'ION', '\n\n\n', 'nes', '<|begin_of_text|>'], 'evidence_proportions': [1076.9, 502.125, 519.35, 78.89583333333333]}, 'weight': {'score': [22.399147727272727, 23.283573512341153, 21.521599264705884, 23.28963992480049, 29.375608766233768], 'topk_indices': array([3249, 3276, 3169, 3121, 7408, 7446, 1473, 1411, 4301, 4317, 5206,
       5145, 7166, 7110, 3440, 3466, 4940, 4963, 4915, 4992]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.08125, 23.936197916666668, 18.88125, 24.05859375]}, 'saliency': {'score': [2.9370893998579546, 0.33407172149926684, 1.7689568014705883, 0.3240460081434162, 0.16032469117796266], 'topk_indices': array([8169, 1155,   37, 4283,   31, 1042, 1134, 8035, 1194,   67,  106,
        112,    0, 1213,  105,  185, 1154,   38,   39, 1214]), 'topk_tokens': [' before', 'ot', 'UL', 'nes', ' picked', ' galaxy', 'nes', ' context', 'nes', 'ION', 'E', ' PA', '<|begin_of_text|>', 'Min', 'ION', 'ION', 'nes', '***', '\n\n\n', 'nes'], 'evidence_proportions': [5.62578125, 3.37158203125, 2.7, 0.4595947265625]}}, 'pred_res': "John's location is not specified before the office, but it is mentioned that John picked up the apple.<|eot_id|>", 'score': 0}
2025-01-22 20:13:24.977 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:13:24.978 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-166_pid-4_0-5-8-9.pkl | len: 3 |  size: 2.03 KB
Processing depth (0, 5, 8, 9):   5%|â–Œ         | 5/100 [01:47<35:17, 22.29s/it]Processing depth (0, 5, 8, 9):   5%|â–Œ         | 5/100 [01:47<34:03, 21.51s/it]
2025-01-22 20:13:25.060 | INFO     | __main__:<module>:82 - Selected idx: 168
2025-01-22 20:13:25.060 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the apple before the bedroom? 
2025-01-22 20:13:25.060 | INFO     | __main__:<module>:84 - Answer: office
2025-01-22 20:13:25.060 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 20:13:25.060 | INFO     | __main__:<module>:86 - Needle: [' Daniel journeyed to the bedroom.', ' Daniel went to the kitchen.', ' John got the apple.', ' Mary journeyed to the hallway.', ' Mary went back to the kitchen.', ' John travelled to the office.', ' Mary went to the bathroom.', ' Sandra travelled to the office.', ' John journeyed to the bedroom.', ' Daniel moved to the bedroom.']
2025-01-22 20:13:25.060 | INFO     | __main__:<module>:87 - Real Needle: [' John got the apple.', ' John travelled to the office.', ' John journeyed to the bedroom.', ' Daniel moved to the bedroom.']
2025-01-22 20:13:25.061 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ“¸', 'ğŸ§ğŸ¿', 'ğŸ›ï¸', 'ğŸŒ§ï¸', 'ğŸ‘¨ğŸ¼\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘¨ğŸ¾', '\U0001faf1ğŸ»\u200d\U0001faf2ğŸ¼', 'ğŸ‘ˆğŸ¾', 'ğŸ‡ºğŸ‡¿', 'ğŸ‡¦ğŸ‡¨', 'ğŸ™‡ğŸ½\u200dâ™‚ï¸']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.17s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.13s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.08s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.86s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.32s/it]
Processing depth (0, 3, 6, 9):   0%|          | 0/100 [00:14<?, ?it/s]2025-01-22 20:13:40.227 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John got the apple.
2025-01-22 20:13:40.268 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the office.
2025-01-22 20:13:40.278 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1045, 1050) -->  Sandra travelled to the office
2025-01-22 20:13:40.278 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the bedroom.
2025-01-22 20:13:40.296 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2985, 2991) -->  Daniel journeyed to the bedroom
2025-01-22 20:13:40.297 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel moved to the bedroom.
2025-01-22 20:13:40.311 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2988, 2993) -->  to the bedroom. Daniel
2025-01-22 20:13:40.311 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel journeyed to the bedroom.
2025-01-22 20:13:40.326 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2982, 2988) -->  the office. Daniel journeyed
2025-01-22 20:13:40.326 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the kitchen.
2025-01-22 20:13:40.340 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2989, 2994) -->  the bedroom. Daniel went
2025-01-22 20:13:40.341 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the hallway.
2025-01-22 20:13:40.359 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3549, 3555) --> . Mary journeyed to the
2025-01-22 20:13:40.359 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary went back to the kitchen.
2025-01-22 20:13:40.387 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4753, 4759) -->  the bedroom. Mary went back
2025-01-22 20:13:40.387 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary went to the bathroom.
2025-01-22 20:13:40.399 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (2520, 2525) --> . Mary went to the
2025-01-22 20:13:40.399 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra travelled to the office.
2025-01-22 20:13:40.404 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (1044, 1049) --> . Sandra travelled to the
2025-01-22 20:13:40.405 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 20:13:40.405 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 20:13:40.405 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 20:13:40.405 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ’‘ğŸ¼', '\U0001faf4ğŸ½', 'ğŸŒï¸\u200dâ™€', 'ğŸ‘©ğŸ¼\u200dâ¤\u200dğŸ‘¨ğŸ¼', 'ğŸƒğŸ»\u200dâ™‚', 'ğŸ”', '\U0001faf3ğŸ¿', 'ğŸ‡©ğŸ‡¿', 'ğŸ”·', 'ğŸ‘©ğŸ¼\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘¨ğŸ¿']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.81s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.64s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.44s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.04s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.61s/it]
Processing depth (2, 5, 7, 8):   0%|          | 0/100 [00:31<?, ?it/s]2025-01-22 20:13:56.651 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John got the apple.
2025-01-22 20:13:56.660 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1810, 1814) -->  John got the apple
2025-01-22 20:13:56.660 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the office.
2025-01-22 20:13:56.665 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (992, 997) -->  Sandra travelled to the office
2025-01-22 20:13:56.665 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the bedroom.
2025-01-22 20:13:56.679 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2899, 2905) -->  Daniel journeyed to the bedroom
2025-01-22 20:13:56.679 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel moved to the bedroom.
2025-01-22 20:13:56.693 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2902, 2907) -->  to the bedroom. Daniel
2025-01-22 20:13:56.693 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel journeyed to the bedroom.
2025-01-22 20:13:56.707 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2898, 2904) --> . Daniel journeyed to the
2025-01-22 20:13:56.707 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the kitchen.
2025-01-22 20:13:56.721 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2903, 2908) -->  the bedroom. Daniel went
2025-01-22 20:13:56.722 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the hallway.
2025-01-22 20:13:56.739 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3519, 3525) --> . Mary journeyed to the
2025-01-22 20:13:56.739 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary went back to the kitchen.
2025-01-22 20:13:56.762 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4664, 4670) --> . Mary went back to the
2025-01-22 20:13:56.762 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary went to the bathroom.
2025-01-22 20:13:56.774 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (2504, 2509) --> . Mary went to the
2025-01-22 20:13:56.774 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra travelled to the office.
2025-01-22 20:13:56.779 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (991, 996) --> . Sandra travelled to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:13:57.580 | INFO     | test_jbb_embedding:begin_test:693 - the capitol<|eot_id|>
2025-01-22 20:13:57.580 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8222])
2025-01-22 20:13:59.821 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [497.021875, 38.62369285019455, 236.23863636363637, 36.70357820340227, 28.390778616573034], 'topk_indices': array([8212, 1810,   23, 8216, 1811, 1778,    9, 8210, 8218, 8221,    1,
         24, 8110, 8220, 1779, 8120, 1813,   14, 8217,    0]), 'topk_tokens': [' bedroom', ' John', '4', ':', ' got', '.', ':', ' before', '<|start_header_id|>', '\n\n', '<|start_header_id|>', '\n\n', '.\n\n', '<|end_header_id|>', ' The', ' location', ' apple', '\n', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [969.25, 409.675, 378.7083333333333, 348.5625]}, 'weight': {'score': [24.341015625, 23.314890108219846, 21.067708333333332, 23.321454113633582, 30.04880617977528], 'topk_indices': array([3301, 3328, 3173, 3221, 7501, 7463, 1445, 1507, 4355, 4339, 5230,
       5169, 7240, 7184, 3484, 3510, 5023, 4946, 4971, 4994]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [25.396484375, 26.1640625, 24.79296875, 21.13125]}, 'saliency': {'score': [3.2461669921875, 0.215226911849085, 1.3175714666193181, 0.203356128356956, 0.21178547719891153], 'topk_indices': array([   0,   24, 8191,    8, 8119, 8204,  993, 1779, 8209, 8110, 2509,
       2904, 1810, 2281, 8215, 1811, 8210, 8212, 8120, 1813]), 'topk_tokens': ['<|begin_of_text|>', '\n\n', ' return', ' Date', ' first', 'Question', ' travelled', ' The', ' apple', '.\n\n', ' bathroom', ' bedroom', ' John', ' Bench', 'Answer', ' got', ' before', ' bedroom', ' location', ' apple'], 'evidence_proportions': [6.37353515625, 2.9388671875, 2.5242513020833335, 1.91787109375]}}, 'pred_res': 'the capitol<|eot_id|>', 'score': 0}
2025-01-22 20:13:59.829 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:13:59.829 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-168_pid-0_2-5-7-8.pkl | len: 3 |  size: 2.03 KB
Processing depth (2, 5, 7, 8):   1%|          | 1/100 [00:34<57:07, 34.62s/it]is_0k: False
your chose emoji: ['ğŸ‘©ğŸ»\u200dğŸ¦¯\u200dâ¡ï¸', 'ğŸ‘¨ğŸ»\u200dâ¤ï¸\u200dğŸ‘¨ğŸ¿', 'ğŸƒğŸ¼\u200dâ™‚ï¸\u200dâ¡ï¸', 'ğŸ‘¶ğŸ½', 'ğŸ’¼', 'ğŸ›', 'ğŸ ', 'â›“ï¸', 'ğŸ§‘ğŸ»\u200dâ¤\u200dğŸ’‹\u200dğŸ§‘ğŸ¿', 'ğŸ™ğŸ¾\u200dâ™€ï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.16s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:09,  4.54s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.50s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.12s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.61s/it]
Processing depth (0, 3, 4, 9):   1%|          | 1/100 [00:50<57:07, 34.62s/it]2025-01-22 20:14:16.182 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John got the apple.
2025-01-22 20:14:16.226 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the office.
2025-01-22 20:14:16.230 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (933, 938) -->  Sandra travelled to the office
2025-01-22 20:14:16.230 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the bedroom.
2025-01-22 20:14:16.245 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2847, 2853) -->  Daniel journeyed to the bedroom
2025-01-22 20:14:16.245 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel moved to the bedroom.
2025-01-22 20:14:16.261 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2850, 2855) -->  to the bedroom. Daniel
2025-01-22 20:14:16.261 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel journeyed to the bedroom.
2025-01-22 20:14:16.276 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2844, 2850) -->  the office. Daniel journeyed
2025-01-22 20:14:16.276 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the kitchen.
2025-01-22 20:14:16.291 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2851, 2856) -->  the bedroom. Daniel went
2025-01-22 20:14:16.291 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the hallway.
2025-01-22 20:14:16.311 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3368, 3374) -->  Mary journeyed to the hallway
2025-01-22 20:14:16.311 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary went back to the kitchen.
2025-01-22 20:14:16.337 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4735, 4741) --> . Mary went back to the
2025-01-22 20:14:16.337 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary went to the bathroom.
2025-01-22 20:14:16.353 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (2230, 2235) --> . Mary went to the
2025-01-22 20:14:16.354 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra travelled to the office.
2025-01-22 20:14:16.358 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (932, 937) --> . Sandra travelled to the
2025-01-22 20:14:16.358 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 20:14:16.359 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 20:14:16.359 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 20:14:16.359 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ‘¨ğŸ¾\u200dğŸ’¼', 'ğŸš†', 'ğŸšµğŸ¼\u200dâ™‚ï¸', 'ğŸ‘¨ğŸ½\u200dâ¤\u200dğŸ‘¨ğŸ¼', 'ğŸ§•ğŸ¼', 'ğŸŠğŸ¼', 'âš ', 'ğŸ¤µğŸ»', 'â‰ï¸', 'ğŸ‘¨ğŸ½']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.27s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.10s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.23s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.94s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.40s/it]
Processing depth (1, 2, 5, 7):   1%|          | 1/100 [01:06<57:07, 34.62s/it]2025-01-22 20:14:32.257 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John got the apple.
2025-01-22 20:14:32.263 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (896, 900) -->  John got the apple
2025-01-22 20:14:32.263 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the office.
2025-01-22 20:14:32.269 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1045, 1050) -->  Sandra travelled to the office
2025-01-22 20:14:32.269 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the bedroom.
2025-01-22 20:14:32.286 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3055, 3061) -->  Daniel journeyed to the bedroom
2025-01-22 20:14:32.287 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel moved to the bedroom.
2025-01-22 20:14:32.303 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3058, 3063) -->  to the bedroom. Daniel
2025-01-22 20:14:32.303 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel journeyed to the bedroom.
2025-01-22 20:14:32.318 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3054, 3060) --> . Daniel journeyed to the
2025-01-22 20:14:32.318 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the kitchen.
2025-01-22 20:14:32.333 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3059, 3064) -->  the bedroom. Daniel went
2025-01-22 20:14:32.333 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the hallway.
2025-01-22 20:14:32.352 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3556, 3562) -->  Mary journeyed to the hallway
2025-01-22 20:14:32.352 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary went back to the kitchen.
2025-01-22 20:14:32.381 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4801, 4807) -->  the senate. Mary went back
2025-01-22 20:14:32.381 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary went to the bathroom.
2025-01-22 20:14:32.393 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (2526, 2531) --> . Mary went to the
2025-01-22 20:14:32.393 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra travelled to the office.
2025-01-22 20:14:32.398 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (1044, 1049) --> . Sandra travelled to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:14:33.282 | INFO     | test_jbb_embedding:begin_test:693 - John got the apple.<|eot_id|>
2025-01-22 20:14:33.282 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8188])
2025-01-22 20:14:35.519 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [408.03125, 33.451407967032964, 145.4732481060606, 32.0764150255008, 19.710123697916668], 'topk_indices': array([  25, 3826,    4,    3,  898,  896, 8187,   23, 8086,  897,  895,
        900,   24,    1,   14,  899, 8186, 8184, 8183,    0]), 'topk_tokens': ['<|eot_id|>', ' of', '\n\n', '<|end_header_id|>', ' the', ' John', '\n\n', '4', ' location', ' got', '.', '.', '\n\n', '<|start_header_id|>', '\n', ' apple', '<|end_header_id|>', '<|start_header_id|>', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [1097.375, 269.875, 218.70833333333334, 221.9]}, 'weight': {'score': [24.341015625, 23.27999275030525, 22.707623106060606, 23.27970612633649, 29.65407986111111], 'topk_indices': array([3273, 3300, 3193, 3145, 7431, 7469, 1410, 1472, 4334, 4350, 5213,
       5152, 7188, 7132, 3482, 3456, 4929, 4954, 5006, 4977]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [25.396484375, 26.1640625, 24.79296875, 21.13125]}, 'saliency': {'score': [2.6991455078125, 0.18402165190495268, 0.8602660208037405, 0.175097166063511, 0.15023507012261283], 'topk_indices': array([  19, 8185, 8157,   16,   14, 8175,    8, 8187,   23, 3825,    0,
       8176, 8178, 3847,   24,  896,  257, 8086,  897,  899]), 'topk_tokens': ['26', 'assistant', ' return', ' Date', '\n', ' apple', ' Date', '\n\n', '4', ' corner', '<|begin_of_text|>', ' before', ' bedroom', ' corner', '\n\n', ' John', 'hue', ' location', ' got', ' apple'], 'evidence_proportions': [7.35546875, 1.87333984375, 1.4986165364583333, 1.24052734375]}}, 'pred_res': 'John got the apple.<|eot_id|>', 'score': 0}
2025-01-22 20:14:35.526 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:14:35.527 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-168_pid-1_1-2-5-7.pkl | len: 3 |  size: 2.03 KB
Processing depth (1, 2, 5, 7):   2%|â–         | 2/100 [01:10<57:34, 35.25s/it]is_0k: False
your chose emoji: ['ğŸ¦¸', 'ğŸ‘¨ğŸ½\u200dğŸ¦½\u200dâ¡ï¸', 'ğŸƒ\u200dâ™€ï¸\u200dâ¡', 'ğŸ‡²ğŸ‡¶', 'ğŸ™…ğŸ»\u200dâ™‚ï¸', 'ğŸ‘°ğŸ¼\u200dâ™€', 'ğŸ§ğŸ½', 'ğŸ–•ğŸ»', 'ğŸ˜“', 'ğŸ§ğŸ»\u200dâ™€']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.11s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.39s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.34s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.00s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.48s/it]
Processing depth (0, 1, 7, 8):   2%|â–         | 2/100 [01:26<57:34, 35.25s/it]2025-01-22 20:14:51.701 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John got the apple.
2025-01-22 20:14:51.743 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the office.
2025-01-22 20:14:51.747 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (821, 826) -->  John travelled to the office
2025-01-22 20:14:51.748 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the bedroom.
2025-01-22 20:14:51.762 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2979, 2985) -->  Daniel journeyed to the bedroom
2025-01-22 20:14:51.762 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel moved to the bedroom.
2025-01-22 20:14:51.776 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2982, 2987) -->  to the bedroom. Daniel
2025-01-22 20:14:51.777 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel journeyed to the bedroom.
2025-01-22 20:14:51.791 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2977, 2983) -->  tragedy. Daniel journeyed to
2025-01-22 20:14:51.791 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the kitchen.
2025-01-22 20:14:51.806 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2983, 2988) -->  the bedroom. Daniel went
2025-01-22 20:14:51.806 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the hallway.
2025-01-22 20:14:51.823 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3567, 3573) --> . Mary journeyed to the
2025-01-22 20:14:51.823 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary went back to the kitchen.
2025-01-22 20:14:51.847 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4936, 4942) --> . Mary went back to the
2025-01-22 20:14:51.847 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary went to the bathroom.
2025-01-22 20:14:51.859 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (2504, 2509) --> . Mary went to the
2025-01-22 20:14:51.859 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra travelled to the office.
2025-01-22 20:14:51.863 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (822, 827) -->  travelled to the office.
2025-01-22 20:14:51.863 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 20:14:51.863 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 20:14:51.863 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 20:14:51.863 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['âš›ï¸', 'ğŸŠğŸ¼\u200dâ™€ï¸', 'ğŸ¤¸ğŸ¿', 'ğŸ¦³', 'ğŸ‘¨ğŸ½\u200dâ¤\u200dğŸ’‹\u200dğŸ‘¨ğŸ½', 'âš™', 'âœŒğŸ½', 'ğŸ‘¨ğŸ¾\u200dâ¤\u200dğŸ‘¨ğŸ¼', 'ğŸ‘©ğŸ¾\u200dğŸ’¼', 'ğŸ’†ğŸ»']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.31s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.27s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.24s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.97s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.44s/it]
Processing depth (1, 2, 8, 9):   2%|â–         | 2/100 [01:42<57:34, 35.25s/it]2025-01-22 20:15:07.376 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John got the apple.
2025-01-22 20:15:07.381 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (816, 820) -->  John got the apple
2025-01-22 20:15:07.381 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the office.
2025-01-22 20:15:07.386 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (971, 976) -->  Sandra travelled to the office
2025-01-22 20:15:07.386 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the bedroom.
2025-01-22 20:15:07.400 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2843, 2849) -->  Daniel journeyed to the bedroom
2025-01-22 20:15:07.400 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel moved to the bedroom.
2025-01-22 20:15:07.413 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2846, 2851) -->  to the bedroom. Daniel
2025-01-22 20:15:07.414 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel journeyed to the bedroom.
2025-01-22 20:15:07.427 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2842, 2848) --> . Daniel journeyed to the
2025-01-22 20:15:07.427 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the kitchen.
2025-01-22 20:15:07.444 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2847, 2852) -->  the bedroom. Daniel went
2025-01-22 20:15:07.444 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the hallway.
2025-01-22 20:15:07.462 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3473, 3479) --> . Mary journeyed to the
2025-01-22 20:15:07.462 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary went back to the kitchen.
2025-01-22 20:15:07.486 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4860, 4866) --> . Mary went back to the
2025-01-22 20:15:07.486 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary went to the bathroom.
2025-01-22 20:15:07.497 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (2232, 2237) --> . Mary went to the
2025-01-22 20:15:07.497 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra travelled to the office.
2025-01-22 20:15:07.502 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (970, 975) --> . Sandra travelled to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:15:08.351 | INFO     | test_jbb_embedding:begin_test:693 - John got the apple.<|eot_id|>
2025-01-22 20:15:08.351 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8156])
2025-01-22 20:15:10.575 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [747.009375, 61.27599059205688, 284.094696969697, 58.676646360271434, 62.433314732142854], 'topk_indices': array([   1,  818, 8082, 8070,   14,   24, 8044, 8144, 8053,  816, 8083,
        817,  820,  821, 8084,  819, 8054, 8152, 8151,    0]), 'topk_tokens': ['<|start_header_id|>', ' the', ' moved', '.\n', '\n', '\n\n', '.\n\n', ' before', ' first', ' John', ' to', ' got', '.', ' Paul', ' the', ' apple', ' location', '<|start_header_id|>', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [1745.0, 889.3, 341.2083333333333, 293.2875]}, 'weight': {'score': [24.341015625, 23.250676100147096, 21.067708333333332, 23.25687365052437, 29.33984375], 'topk_indices': array([3334, 3307, 3227, 3179, 7435, 7397, 1478, 1416, 4309, 4293, 5111,
       5172, 7106, 7162, 3523, 3497, 4965, 4913, 4936, 4888]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [25.396484375, 26.1640625, 24.79296875, 21.13125]}, 'saliency': {'score': [4.876416015625, 0.3417752680459365, 1.6157300544507576, 0.32539854714489513, 0.45645359584263395], 'topk_indices': array([ 975, 8044, 8138, 8048, 8074,  972, 8050, 8143,  257, 8010, 8144,
       8053,  971, 8082, 8146,  816,  817,  821, 8054,  819]), 'topk_tokens': [' office', '.\n\n', 'Question', ' obtained', ' left', ' travelled', ' item', ' apple', 'hue', ' context', ' before', ' first', ' Sandra', ' moved', ' bedroom', ' John', ' got', ' Paul', ' location', ' apple'], 'evidence_proportions': [11.54296875, 6.1279296875, 2.186767578125, 1.51923828125]}}, 'pred_res': 'John got the apple.<|eot_id|>', 'score': 0}
2025-01-22 20:15:10.583 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:15:10.583 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-168_pid-2_1-2-8-9.pkl | len: 3 |  size: 2.03 KB
Processing depth (1, 2, 8, 9):   3%|â–         | 3/100 [01:45<56:50, 35.16s/it]is_0k: False
your chose emoji: ['ğŸ¤¾ğŸ¾\u200dâ™€ï¸', 'ğŸ‹ğŸ¼', 'ğŸ›»', 'ğŸ‡²ğŸ‡´', 'ğŸ¤¸ğŸ»', 'ğŸ¦', 'ğŸŒ¡', 'ğŸª¶', 'ğŸ‘©ğŸ½\u200dâœˆ', 'ğŸ¤¹ğŸ½\u200dâ™€ï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.57s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.53s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.39s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.01s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.55s/it]
Processing depth (1, 2, 3, 7):   3%|â–         | 3/100 [02:01<56:50, 35.16s/it]2025-01-22 20:15:26.765 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John got the apple.
2025-01-22 20:15:26.770 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (896, 900) -->  John got the apple
2025-01-22 20:15:26.770 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the office.
2025-01-22 20:15:26.775 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (981, 986) -->  Sandra travelled to the office
2025-01-22 20:15:26.775 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the bedroom.
2025-01-22 20:15:26.790 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2987, 2993) -->  tragedy. John journeyed to
2025-01-22 20:15:26.790 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel moved to the bedroom.
2025-01-22 20:15:26.804 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2992, 2997) -->  to the bedroom. Daniel
2025-01-22 20:15:26.804 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel journeyed to the bedroom.
2025-01-22 20:15:26.819 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2989, 2995) -->  John journeyed to the bedroom
2025-01-22 20:15:26.819 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the kitchen.
2025-01-22 20:15:26.834 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3000, 3005) -->  the bedroom. Daniel went
2025-01-22 20:15:26.834 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the hallway.
2025-01-22 20:15:26.852 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3600, 3606) --> . Mary journeyed to the
2025-01-22 20:15:26.852 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary went back to the kitchen.
2025-01-22 20:15:26.876 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4945, 4951) --> . Mary went back to the
2025-01-22 20:15:26.876 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary went to the bathroom.
2025-01-22 20:15:26.888 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (2514, 2519) --> . Mary went to the
2025-01-22 20:15:26.888 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra travelled to the office.
2025-01-22 20:15:26.893 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (980, 985) --> . Sandra travelled to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:15:27.770 | INFO     | test_jbb_embedding:begin_test:693 - John got the apple.<|eot_id|>
2025-01-22 20:15:27.770 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8204])
2025-01-22 20:15:30.017 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [964.8875, 69.57571441628077, 325.4782196969697, 66.34365034343186, 61.036865234375], 'topk_indices': array([8193,   24, 8191, 8189, 8058,  898,   14, 8200,  902,  895,  897,
        896, 8194, 8195,  901,  900, 8102, 8192,  899,    0]), 'topk_tokens': [' the', '\n\n', ' apple', ' was', ' context', ' the', '\n', '<|start_header_id|>', 'ï¿½', '.', ' got', ' John', ' bedroom', '?', 'ï¿½', '.', ' location', ' before', ' apple', '<|begin_of_text|>'], 'evidence_proportions': [2401.5, 970.2, 332.4166666666667, 569.25]}, 'weight': {'score': [24.179296875, 23.29475193456008, 21.734138257575758, 23.298898794922113, 29.7736328125], 'topk_indices': array([3311, 3284, 3204, 3156, 7457, 7495, 1488, 1426, 4306, 4290, 5207,
       5146, 7178, 7234, 3467, 3493, 4971, 4916, 4941, 5000]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [25.396484375, 26.1640625, 24.25390625, 21.13125]}, 'saliency': {'score': [6.0352783203125, 0.3917997965950981, 1.8765869140625, 0.3719460562110956, 0.46654586791992186], 'topk_indices': array([8096, 8098,  981, 8189,  982, 8101,  257, 8188,  902, 8195, 8186,
       8058, 8191,  897,  896, 8102, 8192, 8194,  901,  899]), 'topk_tokens': [' obtained', ' item', ' Sandra', ' was', ' travelled', ' first', 'hue', ' Where', 'ï¿½', '?', 'Question', ' context', ' apple', ' got', ' John', ' location', ' before', ' bedroom', 'ï¿½', ' apple'], 'evidence_proportions': [15.8837890625, 6.528515625, 1.6988118489583333, 2.8669921875]}}, 'pred_res': 'John got the apple.<|eot_id|>', 'score': 0}
2025-01-22 20:15:30.024 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:15:30.024 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-168_pid-3_1-2-3-7.pkl | len: 3 |  size: 2.0 KB
Processing depth (1, 2, 3, 7):   4%|â–         | 4/100 [02:04<46:19, 28.96s/it]is_0k: False
your chose emoji: ['ğŸ’†ğŸ½\u200dâ™€ï¸', 'ğŸ§šğŸ¼\u200dâ™€', 'ğŸ‘¨ğŸ¼\u200dğŸ”§', 'â†”', 'ğŸšµğŸ¼', 'ğŸ§‘ğŸ½\u200dğŸ¦¯\u200dâ¡ï¸', 'ğŸ', 'ğŸ‘©ğŸ¾\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘©ğŸ¾', 'â›¹\u200dâ™‚ï¸', 'ğŸ¦•']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.15s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:09,  4.55s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.42s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.07s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.56s/it]
Processing depth (0, 3, 6, 8):   4%|â–         | 4/100 [02:20<46:19, 28.96s/it]2025-01-22 20:15:46.078 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John got the apple.
2025-01-22 20:15:46.121 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the office.
2025-01-22 20:15:46.126 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (979, 984) -->  Sandra travelled to the office
2025-01-22 20:15:46.126 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the bedroom.
2025-01-22 20:15:46.140 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2933, 2939) -->  Daniel journeyed to the bedroom
2025-01-22 20:15:46.141 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel moved to the bedroom.
2025-01-22 20:15:46.155 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2936, 2941) -->  to the bedroom. Daniel
2025-01-22 20:15:46.155 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel journeyed to the bedroom.
2025-01-22 20:15:46.170 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2930, 2936) -->  the office. Daniel journeyed
2025-01-22 20:15:46.171 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the kitchen.
2025-01-22 20:15:46.186 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2937, 2942) -->  the bedroom. Daniel went
2025-01-22 20:15:46.186 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the hallway.
2025-01-22 20:15:46.203 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3543, 3549) --> . Mary journeyed to the
2025-01-22 20:15:46.203 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary went back to the kitchen.
2025-01-22 20:15:46.226 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4789, 4795) -->  the bedroom. Mary went back
2025-01-22 20:15:46.226 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary went to the bathroom.
2025-01-22 20:15:46.242 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (2506, 2511) --> . Mary went to the
2025-01-22 20:15:46.242 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra travelled to the office.
2025-01-22 20:15:46.247 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (978, 983) --> . Sandra travelled to the
2025-01-22 20:15:46.248 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 20:15:46.248 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 20:15:46.248 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 20:15:46.248 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ‡µğŸ‡¦', 'ğŸ¥¿', 'â˜„ï¸', 'ğŸ§‘\u200dâœˆï¸', 'ğŸŒğŸ¾\u200dâ™‚', 'ğŸ™‹', 'ğŸ‘±ğŸ¿\u200dâ™€', '\U0001faf1ğŸ¿\u200d\U0001faf2ğŸ¾', 'ğŸ¤', 'ğŸš‰']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.04s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:07<00:07,  3.88s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.17s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.99s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.38s/it]
Processing depth (0, 5, 7, 9):   4%|â–         | 4/100 [02:36<46:19, 28.96s/it]2025-01-22 20:16:01.501 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John got the apple.
2025-01-22 20:16:01.544 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the office.
2025-01-22 20:16:01.550 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (933, 938) -->  Sandra travelled to the office
2025-01-22 20:16:01.550 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the bedroom.
2025-01-22 20:16:01.566 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2941, 2947) -->  Daniel journeyed to the bedroom
2025-01-22 20:16:01.566 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel moved to the bedroom.
2025-01-22 20:16:01.581 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2944, 2949) -->  to the bedroom. Daniel
2025-01-22 20:16:01.581 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel journeyed to the bedroom.
2025-01-22 20:16:01.598 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2940, 2946) --> . Daniel journeyed to the
2025-01-22 20:16:01.598 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the kitchen.
2025-01-22 20:16:01.613 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2945, 2950) -->  the bedroom. Daniel went
2025-01-22 20:16:01.614 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the hallway.
2025-01-22 20:16:01.631 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3520, 3526) -->  Mary journeyed to the hallway
2025-01-22 20:16:01.631 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary went back to the kitchen.
2025-01-22 20:16:01.656 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4910, 4916) --> . Mary went back to the
2025-01-22 20:16:01.656 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary went to the bathroom.
2025-01-22 20:16:01.668 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (2496, 2501) --> . Mary went to the
2025-01-22 20:16:01.668 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra travelled to the office.
2025-01-22 20:16:01.673 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (932, 937) --> . Sandra travelled to the
2025-01-22 20:16:01.673 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 20:16:01.673 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 20:16:01.673 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 20:16:01.673 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ¦£', 'ğŸ‘©ğŸ¾\u200dâ¤\u200dğŸ’‹\u200dğŸ‘©ğŸ¿', 'ğŸ‹ğŸ¾\u200dâ™€', 'ğŸ§‘ğŸ¼\u200dğŸ¨', 'ğŸ‘©ğŸ¿\u200dğŸ’»', 'ğŸ‘³\u200dâ™‚ï¸', 'ğŸ‘¨ğŸ¿\u200dğŸ¦³', 'ğŸ§‘\u200dğŸ”§', 'ğŸƒğŸ¾\u200dâ™€ï¸', 'ğŸ‘©ğŸ¿\u200dğŸ¦±']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.72s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.33s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.21s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.96s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.47s/it]
Processing depth (2, 3, 6, 8):   4%|â–         | 4/100 [02:52<46:19, 28.96s/it]2025-01-22 20:16:17.490 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John got the apple.
2025-01-22 20:16:17.499 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1806, 1810) -->  John got the apple
2025-01-22 20:16:17.499 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the office.
2025-01-22 20:16:17.504 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1040, 1045) -->  Sandra travelled to the office
2025-01-22 20:16:17.504 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the bedroom.
2025-01-22 20:16:17.518 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2951, 2957) -->  Daniel journeyed to the bedroom
2025-01-22 20:16:17.519 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel moved to the bedroom.
2025-01-22 20:16:17.533 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2954, 2959) -->  to the bedroom. Daniel
2025-01-22 20:16:17.533 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel journeyed to the bedroom.
2025-01-22 20:16:17.548 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2948, 2954) -->  the office. Daniel journeyed
2025-01-22 20:16:17.548 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the kitchen.
2025-01-22 20:16:17.563 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2955, 2960) -->  the bedroom. Daniel went
2025-01-22 20:16:17.563 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the hallway.
2025-01-22 20:16:17.580 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3487, 3493) --> . Mary journeyed to the
2025-01-22 20:16:17.580 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary went back to the kitchen.
2025-01-22 20:16:17.609 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4811, 4817) -->  the bedroom. Mary went back
2025-01-22 20:16:17.609 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary went to the bathroom.
2025-01-22 20:16:17.624 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (2500, 2505) --> . Mary went to the
2025-01-22 20:16:17.624 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra travelled to the office.
2025-01-22 20:16:17.629 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (1039, 1044) --> . Sandra travelled to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:16:18.389 | INFO     | test_jbb_embedding:begin_test:693 - the office<|eot_id|>
2025-01-22 20:16:18.389 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8202])
2025-01-22 20:16:20.623 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [247.821875, 23.055228394685518, 150.42305871212122, 21.988062239295793, 37.04727056962025], 'topk_indices': array([   4,    1, 8183, 2949, 8171, 8195, 8185,    9, 8056,    3, 8100,
         23, 8090,   24, 8196, 8201,   14, 8200,    0, 8197]), 'topk_tokens': ['\n\n', '<|start_header_id|>', '.\n\n', ' office', ' return', 'Answer', ':', ':', ' context', '<|end_header_id|>', ' location', '4', '.\n\n', '\n\n', ':', '\n\n', '\n', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [388.4375, 382.5, 137.57291666666666, 132.95]}, 'weight': {'score': [24.341015625, 23.286222802901023, 22.244791666666668, 23.287850992209545, 29.412776898734176], 'topk_indices': array([3321, 3348, 3229, 3181, 7479, 7441, 1441, 1503, 4337, 4353, 5223,
       5162, 7162, 7218, 3537, 3511, 4964, 4987, 5016, 4939]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [25.396484375, 26.1640625, 24.79296875, 21.13125]}, 'saliency': {'score': [1.61943359375, 0.1284270154040712, 0.8866355202414773, 0.12169888238645948, 0.29158135909068433], 'topk_indices': array([8190,   20,   23,   24, 1041, 1128, 1040, 8090, 8201, 8199, 8171,
       1809, 2946, 8184, 2949, 1053, 8192, 8100, 8056, 8195]), 'topk_tokens': [' before', ' Jul', '4', '\n\n', ' travelled', 'ï¿½', ' Sandra', '.\n\n', '\n\n', 'assistant', ' return', ' apple', ' travelled', 'Question', ' office', 'ï¿½', ' bedroom', ' location', ' context', 'Answer'], 'evidence_proportions': [2.5267333984375, 2.6265625, 0.9104817708333334, 0.73720703125]}}, 'pred_res': 'the office<|eot_id|>', 'score': 100}
2025-01-22 20:16:20.633 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:16:20.633 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-168_pid-4_2-3-6-8.pkl | len: 3 |  size: 2.01 KB
Processing depth (2, 3, 6, 8):   5%|â–Œ         | 5/100 [02:55<58:12, 36.76s/it]Processing depth (2, 3, 6, 8):   5%|â–Œ         | 5/100 [02:55<55:34, 35.10s/it]
2025-01-22 20:16:20.707 | INFO     | __main__:<module>:82 - Selected idx: 170
2025-01-22 20:16:20.707 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the apple before the office? 
2025-01-22 20:16:20.707 | INFO     | __main__:<module>:84 - Answer: garden
2025-01-22 20:16:20.707 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 20:16:20.707 | INFO     | __main__:<module>:86 - Needle: [' Daniel went to the office.', ' Daniel journeyed to the garden.', ' John picked up the apple.', ' John went back to the garden.', ' Mary journeyed to the hallway.', ' John moved to the office.', ' Daniel went to the bathroom.']
2025-01-22 20:16:20.707 | INFO     | __main__:<module>:87 - Real Needle: [' John picked up the apple.', ' John went back to the garden.', ' John moved to the office.', ' Daniel went to the bathroom.']
2025-01-22 20:16:20.707 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ‘²ğŸ¼', 'ğŸ’ğŸ¼\u200dâ™‚', 'ğŸ‘©\u200dğŸ¼', 'ğŸ§ğŸ½\u200dâ™€', 'ğŸ–±', 'ğŸ‘±ğŸ¼\u200dâ™‚ï¸', 'ğŸ§‘ğŸ¼\u200dâ¤\u200dğŸ§‘ğŸ¿', 'ğŸ‘©\u200dğŸŒ¾', 'ğŸ¤ŸğŸ¼', 'ğŸ‘©ğŸ¼\u200dğŸ¦±']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.14s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.70s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.47s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.09s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.60s/it]
Processing depth (5, 6, 7, 9):   0%|          | 0/100 [00:15<?, ?it/s]2025-01-22 20:16:36.870 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John picked up the apple.
2025-01-22 20:16:36.890 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4202, 4207) -->  John picked up the apple
2025-01-22 20:16:36.891 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the garden.
2025-01-22 20:16:36.915 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4755, 4761) -->  the senate. John went back
2025-01-22 20:16:36.915 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the office.
2025-01-22 20:16:36.942 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5634, 5639) --> . John moved to the
2025-01-22 20:16:36.942 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went to the bathroom.
2025-01-22 20:16:36.947 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1077, 1082) --> . Daniel went to the
2025-01-22 20:16:36.947 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went to the office.
2025-01-22 20:16:36.953 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1077, 1082) --> . Daniel went to the
2025-01-22 20:16:36.953 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the garden.
2025-01-22 20:16:36.954 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (322, 328) -->  Daniel journeyed to the garden
2025-01-22 20:16:36.955 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the hallway.
2025-01-22 20:16:36.959 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (782, 788) --> . Mary journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:16:37.828 | INFO     | test_jbb_embedding:begin_test:693 - John picked up the apple.<|eot_id|>
2025-01-22 20:16:37.828 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8132])
2025-01-22 20:16:40.050 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [435.4613095238095, 39.77877996312231, 414.7279411764706, 37.96533438310485, 55.16760023584906], 'topk_indices': array([  24, 7985, 8020, 8123, 8030, 8117, 8115, 8128, 4207,   14,  327,
       7986, 8121, 8119, 4206, 8127, 8130, 8120, 8122,    0]), 'topk_tokens': ['\n\n', ' you', '.\n\n', '?', ' location', ' was', ':', '<|start_header_id|>', '.', '\n', ' garden', ' context', ' the', ' apple', ' apple', '<|eot_id|>', '<|end_header_id|>', ' before', ' office', '<|begin_of_text|>'], 'evidence_proportions': [752.6, 240.19791666666666, 380.35, 407.75]}, 'weight': {'score': [22.214657738095237, 23.235638829133375, 21.34329044117647, 23.242259864764726, 28.62234669811321], 'topk_indices': array([3320, 3293, 3213, 3165, 7423, 7385, 1443, 1505, 4294, 4278, 5167,
       5106, 7094, 7150, 3476, 3502, 4960, 4908, 4883, 4931]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [25.9421875, 24.010416666666668, 18.88125, 19.665625]}, 'saliency': {'score': [2.5702136811755953, 0.22310152528618624, 2.376665900735294, 0.21249266402197572, 0.40838104823850235], 'topk_indices': array([8020,  323, 8123,  322, 7985, 8117, 4202, 7984, 4763, 1082, 8116,
       8030, 4203, 8114, 7986,  327, 8119, 4206, 8120, 8122]), 'topk_tokens': ['.\n\n', ' journey', '?', ' Daniel', ' you', ' was', ' John', ' provided', ' garden', ' office', ' Where', ' location', ' picked', 'Question', ' context', ' garden', ' apple', ' apple', ' before', ' office'], 'evidence_proportions': [5.14921875, 1.42437744140625, 1.8935546875, 2.04287109375]}}, 'pred_res': 'John picked up the apple.<|eot_id|>', 'score': 0}
2025-01-22 20:16:40.060 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:16:40.060 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-170_pid-0_5-6-7-9.pkl | len: 3 |  size: 2.03 KB
Processing depth (5, 6, 7, 9):   1%|          | 1/100 [00:19<31:45, 19.25s/it]is_0k: False
your chose emoji: ['ğŸ‘¯\u200dâ™€', 'ğŸ–', 'ğŸ§‘ğŸ¾', 'ğŸˆ²', 'ğŸ™ğŸ¿\u200dâ™‚', 'ğŸ‡§ğŸ‡»', 'ğŸ•´ğŸ¼', 'ğŸ™‹ğŸ½', 'ğŸ¦¹ğŸ¿', 'ğŸ‡']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  3.74s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.27s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.36s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.03s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.46s/it]
Processing depth (1, 6, 8, 9):   1%|          | 1/100 [00:34<31:45, 19.25s/it]2025-01-22 20:16:55.725 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John picked up the apple.
2025-01-22 20:16:55.730 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (902, 907) --> . John picked up the
2025-01-22 20:16:55.730 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the garden.
2025-01-22 20:16:55.759 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4655, 4661) --> . John went back to the
2025-01-22 20:16:55.759 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the office.
2025-01-22 20:16:55.797 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6538, 6543) --> . John moved to the
2025-01-22 20:16:55.797 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went to the bathroom.
2025-01-22 20:16:55.805 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1234, 1239) -->  Republican. Daniel went to
2025-01-22 20:16:55.805 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went to the office.
2025-01-22 20:16:55.812 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1234, 1239) -->  Republican. Daniel went to
2025-01-22 20:16:55.812 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the garden.
2025-01-22 20:16:55.816 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (589, 595) --> . Daniel journeyed to the
2025-01-22 20:16:55.816 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the hallway.
2025-01-22 20:16:55.821 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (907, 913) -->  apple. Mary journeyed to
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:16:56.605 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 20:16:56.605 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8186])
2025-01-22 20:16:58.813 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [75.64620535714286, 10.301026911100257, 82.16957720588235, 9.982782020610967, 8.17562255859375], 'topk_indices': array([  20, 8167, 8180, 8159,    4,    9, 8084, 8074,    1, 8182,    3,
       8040, 8185,   23, 4661,   24,   14,    0, 8181, 8184]), 'topk_tokens': [' Jul', '.\n\n', ':', '.', '\n\n', ':', ' location', '.\n\n', '<|start_header_id|>', '<|start_header_id|>', '<|end_header_id|>', ' context', '\n\n', '4', ' garden', '\n\n', '\n', '<|begin_of_text|>', '<|eot_id|>', '<|end_header_id|>'], 'evidence_proportions': [103.5375, 98.58333333333333, 64.95, 30.9265625]}, 'weight': {'score': [21.14546130952381, 23.290006029429723, 22.698529411764707, 23.29676477579438, 29.5869140625], 'topk_indices': array([3370, 3343, 3199, 3247, 7425, 7463, 1425, 1487, 4352, 4336, 5176,
       5237, 7202, 7146, 3552, 3526, 5001, 4978, 4953, 5030]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.334375, 20.0703125, 18.88125, 24.5109375]}, 'saliency': {'score': [0.38700939360119047, 0.055936018878220785, 0.44899974149816174, 0.05426326410534367, 0.06047353744506836], 'topk_indices': array([   8, 8038, 8164, 8074, 8176, 8168,   19,   14, 8183,   16, 8158,
       8179, 8185, 8155,   23,   20, 8084,   24, 8040, 4661]), 'topk_tokens': [' Date', ' provided', ' else', '.\n\n', ' office', 'Question', '26', '\n', 'assistant', ' Date', ' directly', 'Answer', '\n\n', ' return', '4', ' Jul', ' location', '\n\n', ' context', ' garden'], 'evidence_proportions': [0.552001953125, 0.48724365234375, 0.31541748046875, 0.17332763671875]}}, 'pred_res': 'The garden.<|eot_id|>', 'score': 100}
2025-01-22 20:16:58.821 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:16:58.821 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-170_pid-1_1-6-8-9.pkl | len: 3 |  size: 2.01 KB
Processing depth (1, 6, 8, 9):   2%|â–         | 2/100 [00:38<30:58, 18.96s/it]is_0k: False
your chose emoji: ['ğŸ§‘ğŸ¿\u200dğŸ³', 'ğŸ‘¨ğŸ»\u200dâš•', 'ğŸªƒ', 'ğŸ¤¸\u200dâ™€ï¸', 'ğŸ§—ğŸ¿\u200dâ™€', 'ğŸŒ\u200dâ™‚ï¸', 'ğŸŠğŸ¾\u200dâ™€', 'ğŸŒ¡', 'ğŸ‘©ğŸ¿\u200dâ¤\u200dğŸ‘©ğŸ¼', 'ğŸ§‘ğŸ¾\u200dğŸ“']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  3.90s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.24s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.25s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.95s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.40s/it]
Processing depth (1, 3, 4, 6):   2%|â–         | 2/100 [00:53<30:58, 18.96s/it]2025-01-22 20:17:14.124 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John picked up the apple.
2025-01-22 20:17:14.129 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (828, 833) --> . John picked up the
2025-01-22 20:17:14.129 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the garden.
2025-01-22 20:17:14.143 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2905, 2911) --> . John went back to the
2025-01-22 20:17:14.143 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the office.
2025-01-22 20:17:14.162 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3624, 3629) --> . John moved to the
2025-01-22 20:17:14.162 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went to the bathroom.
2025-01-22 20:17:14.167 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1127, 1132) --> . Daniel went to the
2025-01-22 20:17:14.168 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went to the office.
2025-01-22 20:17:14.173 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1127, 1132) --> . Daniel went to the
2025-01-22 20:17:14.173 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the garden.
2025-01-22 20:17:14.175 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (368, 374) -->  Daniel journeyed to the garden
2025-01-22 20:17:14.175 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the hallway.
2025-01-22 20:17:14.179 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (833, 839) -->  apple. Mary journeyed to
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:17:14.973 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 20:17:14.973 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8200])
2025-01-22 20:17:17.201 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [90.98883928571429, 12.44189435267585, 162.47610294117646, 11.927495407225965, 10.617782417385058], 'topk_indices': array([8181, 8049, 8054,    4, 8194, 8190, 8188,    3,    1, 8088,    9,
       2911,   23, 8199,   24,   14, 8196,    0, 8198, 8195]), 'topk_tokens': ['.\n\n', '\n', ' context', '\n\n', ':', ' office', ' before', '<|end_header_id|>', '<|start_header_id|>', '.\n\n', ':', ' garden', '4', '\n\n', '\n\n', '\n', '<|start_header_id|>', '<|begin_of_text|>', '<|end_header_id|>', '<|eot_id|>'], 'evidence_proportions': [164.975, 80.734375, 53.278125, 67.01875]}, 'weight': {'score': [19.991815476190474, 23.299774091795683, 22.60110294117647, 23.309736680955297, 29.54076867816092], 'topk_indices': array([3335, 3308, 3228, 3180, 7453, 7491, 1437, 1499, 4293, 4309, 5128,
       5189, 7174, 7230, 3491, 3517, 4953, 4982, 4930, 4905]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.334375, 20.0703125, 18.88125, 19.665625]}, 'saliency': {'score': [0.46217564174107145, 0.06734523008207745, 1.0010699103860294, 0.06438567610657149, 0.08045371921583154], 'topk_indices': array([8184,    8,   16, 8098,   14,  833, 8088, 8169, 8197, 8187, 8193,
         20, 8199, 8188, 8054,   23,  373, 8190,   24, 2911]), 'topk_tokens': [' Where', ' Date', ' Date', ' location', '\n', ' apple', '.\n\n', ' return', 'assistant', ' apple', 'Answer', ' Jul', '\n\n', ' before', ' context', '4', ' garden', ' office', '\n\n', ' garden'], 'evidence_proportions': [0.878369140625, 0.3942667643229167, 0.2536865234375, 0.3359619140625]}}, 'pred_res': 'The garden.<|eot_id|>', 'score': 100}
2025-01-22 20:17:17.207 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:17:17.208 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-170_pid-2_1-3-4-6.pkl | len: 3 |  size: 2.01 KB
Processing depth (1, 3, 4, 6):   3%|â–         | 3/100 [00:56<30:13, 18.70s/it]is_0k: False
your chose emoji: ['ğŸ‹ğŸ½\u200dâ™‚', 'ğŸ‘¨ğŸ¼\u200dâ¤ï¸\u200dğŸ‘¨ğŸ¿', 'âš±ï¸', 'ğŸ‘©ğŸ¿\u200dğŸ«', 'ğŸ“”', 'ğŸ‘©ğŸ¿\u200dâ¤\u200dğŸ‘©ğŸ¼', 'ğŸ˜¶\u200dğŸŒ«', 'ğŸ‘©ğŸ¿\u200dâ¤\u200dğŸ‘©ğŸ¾', 'ğŸš£ğŸ½', 'ğŸ»']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.03s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.38s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.13s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:12<00:00,  2.68s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:12<00:00,  3.24s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 2, 6, 7):   3%|â–         | 3/100 [01:11<30:13, 18.70s/it]2025-01-22 20:17:32.241 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John picked up the apple.
2025-01-22 20:17:32.242 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the apple.
2025-01-22 20:17:32.242 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the garden.
2025-01-22 20:17:32.252 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1873, 1879) --> . John went back to the
2025-01-22 20:17:32.252 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the office.
2025-01-22 20:17:32.275 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4625, 4630) -->  John moved to the office
2025-01-22 20:17:32.275 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went to the bathroom.
2025-01-22 20:17:32.281 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1127, 1132) --> . Daniel went to the
2025-01-22 20:17:32.281 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went to the office.
2025-01-22 20:17:32.286 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1127, 1132) --> . Daniel went to the
2025-01-22 20:17:32.286 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the garden.
2025-01-22 20:17:32.288 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (373, 379) --> . Daniel journeyed to the
2025-01-22 20:17:32.288 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the hallway.
2025-01-22 20:17:32.293 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (834, 840) --> . Mary journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:17:35.242 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 20:17:35.242 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8148])
2025-01-22 20:17:38.096 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [109.50446428571429, 11.560726827996564, 82.53860294117646, 11.158478291014422, 7.681624615778689], 'topk_indices': array([   8, 8138,    1, 8136,   20, 8129, 8002,    4, 7997, 8147, 8144,
       8036,   23,    9,   24, 8146,   14, 1879,    0, 8143]), 'topk_tokens': [' Date', ' office', '<|start_header_id|>', ' before', ' Jul', '.\n\n', ' context', '\n\n', '\n', '\n\n', '<|start_header_id|>', '.\n\n', '4', ':', '\n\n', '<|end_header_id|>', '\n', ' garden', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [195.05, 115.015625, 45.7125, 81.1375]}, 'weight': {'score': [21.125372023809526, 23.250661345233713, 20.015625, 23.262941228583756, 28.900870901639344], 'topk_indices': array([3329, 3302, 3174, 3222, 7403, 7441, 1499, 1437, 4351, 4367, 5233,
       5172, 7180, 7124, 3537, 3511, 5026, 4997, 4974, 4949]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.08125, 20.0703125, 22.8953125, 19.665625]}, 'saliency': {'score': [0.5629708426339286, 0.06290028908694102, 0.4301614200367647, 0.06083632743889052, 0.056511425581134735], 'topk_indices': array([8145,  379, 8000, 8141, 8117,   16, 8147, 8046,   14,    9,   19,
       8136, 8138,    8, 8036,   23,   20,   24, 8002, 1879]), 'topk_tokens': ['assistant', ' garden', ' provided', 'Answer', ' return', ' Date', '\n\n', ' location', '\n', ':', '26', ' before', ' office', ' Date', '.\n\n', '4', ' Jul', '\n\n', ' context', ' garden'], 'evidence_proportions': [1.016455078125, 0.5629475911458334, 0.2655517578125, 0.40693359375]}}, 'pred_res': 'The garden.<|eot_id|>', 'score': 100}
2025-01-22 20:17:38.109 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:17:38.110 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-170_pid-3_0-2-6-7.pkl | len: 3 |  size: 1.99 KB
Processing depth (0, 2, 6, 7):   4%|â–         | 4/100 [01:17<31:18, 19.57s/it]is_0k: False
your chose emoji: ['ğŸ‘¦ğŸ¾', 'ğŸ‘¨ğŸ¿\u200dğŸ¦¯\u200dâ¡', 'ğŸ‘', '\U0001faf2ğŸ¿', 'ğŸ§‘ğŸ¼\u200dğŸ“', 'ğŸ‘±ğŸ¼', 'ğŸ’ğŸ¿', 'ğŸ§œğŸ¿\u200dâ™€', 'â™“', 'â™‚']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.24s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.56s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.35s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.05s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.54s/it]
Processing depth (0, 1, 3, 9):   4%|â–         | 4/100 [01:33<31:18, 19.57s/it]2025-01-22 20:17:54.432 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John picked up the apple.
2025-01-22 20:17:54.432 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the apple.
2025-01-22 20:17:54.432 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the garden.
2025-01-22 20:17:54.437 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (828, 834) --> . John went back to the
2025-01-22 20:17:54.437 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the office.
2025-01-22 20:17:54.453 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2887, 2892) -->  John moved to the office
2025-01-22 20:17:54.454 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went to the bathroom.
2025-01-22 20:17:54.460 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1078, 1083) --> . Daniel went to the
2025-01-22 20:17:54.460 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went to the office.
2025-01-22 20:17:54.466 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1078, 1083) --> . Daniel went to the
2025-01-22 20:17:54.466 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the garden.
2025-01-22 20:17:54.468 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (367, 373) --> . Daniel journeyed to the
2025-01-22 20:17:54.468 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the hallway.
2025-01-22 20:17:54.472 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (833, 839) -->  the garden. Mary journeyed
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:17:55.266 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 20:17:55.266 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8184])
2025-01-22 20:17:57.477 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [105.76488095238095, 10.495055041529254, 109.73345588235294, 10.042518637256105, 8.415385185917721], 'topk_indices': array([  20,    4,   69,    1, 8172, 8183, 8072,  373,   68,  105,    9,
         67, 8180,   23, 8182,   24,  834,   14,    0, 8179]), 'topk_tokens': [' Jul', '\n\n', 'ER', '<|start_header_id|>', ' before', '\n\n', '.\n\n', ' garden', 'E', 'ION', ':', 'ION', '<|start_header_id|>', '4', '<|end_header_id|>', '\n\n', ' garden', '\n', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [194.125, 119.71875, 60.425, 46.0]}, 'weight': {'score': [21.125372023809526, 23.28743167521681, 21.097426470588236, 23.29757197969076, 29.518789556962027], 'topk_indices': array([3298, 3325, 3170, 3218, 7413, 7375, 1506, 1444, 4307, 4291, 5173,
       5112, 7090, 7146, 3507, 3481, 4966, 4914, 4889, 4937]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.08125, 20.0703125, 22.8953125, 19.665625]}, 'saliency': {'score': [0.5390828450520834, 0.057518604577235635, 0.6343958237591911, 0.05507416209643246, 0.06302459330498418], 'topk_indices': array([  69, 8177, 8072, 8153, 8082,   16, 8171,    8,   14, 8174,   19,
         68, 8172,   20,   23,   24,  105,   67,  373,  834]), 'topk_tokens': ['ER', 'Answer', '.\n\n', ' return', ' location', ' Date', ' apple', ' Date', '\n', ' office', '26', 'E', ' before', ' Jul', '4', '\n\n', 'ION', 'ION', ' garden', ' garden'], 'evidence_proportions': [1.00322265625, 0.5746256510416666, 0.338818359375, 0.23255615234375]}}, 'pred_res': 'The garden.<|eot_id|>', 'score': 100}
2025-01-22 20:17:57.486 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:17:57.486 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-170_pid-4_0-1-3-9.pkl | len: 3 |  size: 1.97 KB
Processing depth (0, 1, 3, 9):   5%|â–Œ         | 5/100 [01:36<30:52, 19.50s/it]Processing depth (0, 1, 3, 9):   5%|â–Œ         | 5/100 [01:36<30:38, 19.35s/it]
2025-01-22 20:17:57.558 | INFO     | __main__:<module>:82 - Selected idx: 172
2025-01-22 20:17:57.558 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the football before the kitchen? 
2025-01-22 20:17:57.558 | INFO     | __main__:<module>:84 - Answer: garden
2025-01-22 20:17:57.558 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 20:17:57.558 | INFO     | __main__:<module>:86 - Needle: [' Daniel went back to the hallway.', ' John went back to the kitchen.', ' Sandra travelled to the bathroom.', ' Mary picked up the football.', ' Daniel went to the office.', ' Daniel journeyed to the garden.', ' Mary went to the garden.', ' Daniel went to the bathroom.', ' Daniel moved to the office.', ' Mary went back to the kitchen.', ' Sandra moved to the kitchen.']
2025-01-22 20:17:57.558 | INFO     | __main__:<module>:87 - Real Needle: [' Mary picked up the football.', ' Mary went to the garden.', ' Mary went back to the kitchen.', ' Sandra moved to the kitchen.']
2025-01-22 20:17:57.558 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ‘“', 'ğŸ‘©ğŸ½\u200dâ¤\u200dğŸ‘¨ğŸ¾', 'ğŸ§\u200dâ™‚ï¸', 'ğŸ•µ\u200dâ™€', 'ğŸ‘§', 'ğŸ‘¨ğŸ¾\u200dâš•', 'ğŸ¦', 'ğŸ––ğŸ¿', 'ğŸ¤¸ğŸ¾\u200dâ™€', 'ğŸ‘©ğŸ¾\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘¨ğŸ»']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.31s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.33s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.13s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.88s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.38s/it]
Processing depth (2, 3, 6, 9):   0%|          | 0/100 [00:15<?, ?it/s]2025-01-22 20:18:12.915 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the football.
2025-01-22 20:18:12.927 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2010, 2015) -->  cable. Mary picked up
2025-01-22 20:18:12.928 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went to the garden.
2025-01-22 20:18:12.943 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2953, 2958) --> . Mary went to the
2025-01-22 20:18:12.944 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the kitchen.
2025-01-22 20:18:12.967 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4724, 4730) -->  Mary went back to the kitchen
2025-01-22 20:18:12.967 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra moved to the kitchen.
2025-01-22 20:18:13.005 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7188, 7193) -->  Sandra moved to the kitchen
2025-01-22 20:18:13.005 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went back to the hallway.
2025-01-22 20:18:13.040 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6942, 6948) --> . Daniel went back to the
2025-01-22 20:18:13.040 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the kitchen.
2025-01-22 20:18:13.063 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4725, 4731) -->  went back to the kitchen.
2025-01-22 20:18:13.063 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra travelled to the bathroom.
2025-01-22 20:18:13.073 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1763, 1768) --> . Sandra travelled to the
2025-01-22 20:18:13.073 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went to the office.
2025-01-22 20:18:13.083 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1770, 1775) -->  Daniel moved to the office
2025-01-22 20:18:13.083 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel journeyed to the garden.
2025-01-22 20:18:13.108 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4884, 4890) --> . Daniel journeyed to the
2025-01-22 20:18:13.109 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel went to the bathroom.
2025-01-22 20:18:13.117 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (1766, 1771) -->  to the bathroom. Daniel
2025-01-22 20:18:13.117 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Daniel moved to the office.
2025-01-22 20:18:13.127 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (1767, 1772) -->  the bathroom. Daniel moved
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:18:13.935 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 20:18:13.935 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8225])
2025-01-22 20:18:16.180 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [126.2202380952381, 14.193957561071949, 99.72738486842105, 13.50809366966581, 9.61871408045977], 'topk_indices': array([8194, 8208, 8212,    4, 8219, 8113, 3113, 8224,    1,   23, 8123,
       8213,    9, 2958, 2016,   24,   14, 8223,    0, 8220]), 'topk_tokens': [' return', ':', ' football', '\n\n', ':', '.\n\n', 'ern', '\n\n', '<|start_header_id|>', '4', ' location', ' before', ':', ' garden', ' football', '\n\n', '\n', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [160.175, 173.55, 117.45833333333333, 55.45]}, 'weight': {'score': [24.14248511904762, 23.297393427929023, 21.93153782894737, 23.301574550128535, 29.349137931034484], 'topk_indices': array([3293, 3320, 3213, 3165, 7516, 7478, 1461, 1399, 4294, 4278, 5135,
       5196, 7255, 7199, 3502, 3476, 4912, 4989, 4937, 4960]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.5265625, 19.403125, 24.69921875, 25.8296875]}, 'saliency': {'score': [0.7228887648809523, 0.07835947499439794, 0.5681296900699013, 0.07442430750015301, 0.06968311879826689], 'topk_indices': array([8222, 8113, 8197, 8224,   14,   20, 8207, 8218,   23,    8, 8194,
       8079, 8215,   24, 3113, 8213, 8212, 8123, 2958, 2016]), 'topk_tokens': ['assistant', '.\n\n', ' directly', '\n\n', '\n', ' Jul', 'Question', 'Answer', '4', ' Date', ' return', ' context', ' kitchen', '\n\n', 'ern', ' before', ' football', ' location', ' garden', ' football'], 'evidence_proportions': [1.011572265625, 0.850537109375, 0.6899820963541666, 0.346044921875]}}, 'pred_res': 'The garden.<|eot_id|>', 'score': 100}
2025-01-22 20:18:16.197 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:18:16.197 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-172_pid-0_2-3-6-9.pkl | len: 3 |  size: 2.0 KB
Processing depth (2, 3, 6, 9):   1%|          | 1/100 [00:18<30:35, 18.54s/it]is_0k: False
your chose emoji: ['âª', 'ğŸ§‘ğŸ¾\u200dâ¤\u200dğŸ’‹\u200dğŸ§‘ğŸ»', '\U0001faf1ğŸ¼\u200d\U0001faf2ğŸ½', 'ğŸ§”ğŸ¿', 'ğŸ‘®ğŸ¼\u200dâ™€ï¸', 'ğŸ§€', 'ğŸ¤·', 'ğŸ‘¨ğŸ¾\u200dğŸ”§', 'ğŸ‘©ğŸ½\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘¨ğŸ¾', 'ğŸ“”']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.69s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.58s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.08s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.64s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.28s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (4, 5, 6, 7):   1%|          | 1/100 [00:33<30:35, 18.54s/it]2025-01-22 20:18:31.171 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the football.
2025-01-22 20:18:31.189 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3633, 3638) --> . Mary picked up the
2025-01-22 20:18:31.189 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went to the garden.
2025-01-22 20:18:31.209 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4251, 4256) --> . Mary went to the
2025-01-22 20:18:31.210 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the kitchen.
2025-01-22 20:18:31.234 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4937, 4943) --> . Mary went back to the
2025-01-22 20:18:31.234 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra moved to the kitchen.
2025-01-22 20:18:31.263 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6056, 6061) -->  Sandra moved to the kitchen
2025-01-22 20:18:31.263 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went back to the hallway.
2025-01-22 20:18:31.297 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6970, 6976) --> . Daniel went back to the
2025-01-22 20:18:31.297 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the kitchen.
2025-01-22 20:18:31.321 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4938, 4944) -->  Mary went back to the kitchen
2025-01-22 20:18:31.321 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra travelled to the bathroom.
2025-01-22 20:18:31.328 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1577, 1582) --> . Sandra travelled to the
2025-01-22 20:18:31.329 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went to the office.
2025-01-22 20:18:31.336 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1584, 1589) -->  Daniel moved to the office
2025-01-22 20:18:31.336 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel journeyed to the garden.
2025-01-22 20:18:31.361 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5052, 5058) --> . Daniel journeyed to the
2025-01-22 20:18:31.361 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel went to the bathroom.
2025-01-22 20:18:31.369 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (1580, 1585) -->  to the bathroom. Daniel
2025-01-22 20:18:31.369 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Daniel moved to the office.
2025-01-22 20:18:31.376 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (1581, 1586) -->  the bathroom. Daniel moved
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:18:34.639 | INFO     | test_jbb_embedding:begin_test:693 - Mary's house.<|eot_id|>
2025-01-22 20:18:34.639 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8237])
2025-01-22 20:18:37.553 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [334.23809523809524, 27.288999924150485, 239.19161184210526, 25.51681678584525, 20.95967741935484], 'topk_indices': array([   4, 3635, 8226, 8220, 8219, 8231, 8228, 8125, 8135,    9,   24,
       8224, 3633, 3638, 8235, 8227, 8225,   14, 8232,    0]), 'topk_tokens': ['\n\n', ' picked', ' the', ':', 'Question', ':', '?', '.\n\n', ' location', ':', '\n\n', ' football', '.', ' football', '<|end_header_id|>', ' kitchen', ' before', '\n', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [584.9, 229.75, 195.375, 354.7]}, 'weight': {'score': [21.94828869047619, 23.314803929004853, 22.54029605263158, 23.321909187446522, 29.730006720430108], 'topk_indices': array([3298, 3271, 3143, 3191, 7434, 7472, 1433, 1495, 4278, 4262, 5148,
       5087, 7155, 7211, 3480, 3454, 4927, 4898, 4850, 4875]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.1, 19.403125, 20.708333333333332, 25.8296875]}, 'saliency': {'score': [1.795991443452381, 0.15137140959211923, 1.4009238795230263, 0.14134573857776403, 0.15468786096060147], 'topk_indices': array([8221, 8091, 8206, 8228, 8125, 1578,    8,   24,   14, 8230, 3634,
       4256, 3635, 8135, 1582, 8219, 8224, 8225, 3638, 8227]), 'topk_tokens': [' Where', ' context', ' return', '?', '.\n\n', ' Sandra', ' Date', '\n\n', '\n', 'Answer', ' Mary', ' garden', ' picked', ' location', ' bathroom', 'Question', ' football', ' before', ' football', ' kitchen'], 'evidence_proportions': [3.1744140625, 1.15341796875, 0.9232584635416666, 2.107421875]}}, 'pred_res': "Mary's house.<|eot_id|>", 'score': 0}
2025-01-22 20:18:37.561 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:18:37.562 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-172_pid-1_4-5-6-7.pkl | len: 3 |  size: 2.0 KB
Processing depth (4, 5, 6, 7):   2%|â–         | 2/100 [00:39<32:59, 20.20s/it]is_0k: False
your chose emoji: ['ğŸ§‘ğŸ¿\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ§‘ğŸ½', 'ğŸ‘©ğŸ¾\u200dâš•ï¸', 'ğŸ§‘ğŸ»\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ§‘ğŸ¿', 'ğŸ’ğŸ¾', 'ğŸ§§', '\U0001fada', 'ğŸ¥›', 'ğŸ§‘\u200dğŸ”§', 'ğŸ‘©ğŸ¿\u200dğŸ¦¼\u200dâ¡ï¸', 'ğŸ‘±ğŸ¾\u200dâ™€ï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.54s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.81s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.46s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.05s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.62s/it]
Processing depth (1, 3, 4, 5):   2%|â–         | 2/100 [00:56<32:59, 20.20s/it]2025-01-22 20:18:53.755 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the football.
2025-01-22 20:18:53.759 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (662, 667) -->  Mary picked up the football
2025-01-22 20:18:53.759 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went to the garden.
2025-01-22 20:18:53.773 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2889, 2894) --> . Mary went to the
2025-01-22 20:18:53.773 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the kitchen.
2025-01-22 20:18:53.790 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3593, 3599) --> . Mary went back to the
2025-01-22 20:18:53.791 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra moved to the kitchen.
2025-01-22 20:18:53.810 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4151, 4156) -->  Sandra moved to the kitchen
2025-01-22 20:18:53.810 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went back to the hallway.
2025-01-22 20:18:53.844 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6870, 6876) --> . Daniel went back to the
2025-01-22 20:18:53.844 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the kitchen.
2025-01-22 20:18:53.862 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3594, 3600) -->  Mary went back to the kitchen
2025-01-22 20:18:53.862 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra travelled to the bathroom.
2025-01-22 20:18:53.870 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1543, 1548) --> . Sandra travelled to the
2025-01-22 20:18:53.870 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went to the office.
2025-01-22 20:18:53.878 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1550, 1555) -->  Daniel moved to the office
2025-01-22 20:18:53.878 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel journeyed to the garden.
2025-01-22 20:18:53.901 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4706, 4712) --> . Daniel journeyed to the
2025-01-22 20:18:53.901 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel went to the bathroom.
2025-01-22 20:18:53.909 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (1546, 1551) -->  to the bathroom. Daniel
2025-01-22 20:18:53.909 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Daniel moved to the office.
2025-01-22 20:18:53.916 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (1547, 1552) -->  the bathroom. Daniel moved
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:18:54.702 | INFO     | test_jbb_embedding:begin_test:693 - the garden<|eot_id|>
2025-01-22 20:18:54.702 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8211])
2025-01-22 20:18:56.929 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [116.95238095238095, 9.59891648405162, 57.86533717105263, 9.097561886879216, 10.460443115234375], 'topk_indices': array([  20, 8064,    3,    4, 8192, 8099, 8205,    1, 2894, 8065,   24,
       8210,    9,   23, 8109,  666,   14, 8209,    0, 8206]), 'topk_tokens': [' Jul', ' you', '<|end_header_id|>', '\n\n', '.\n\n', '.\n\n', ':', '<|start_header_id|>', ' garden', ' context', '\n\n', '\n\n', ':', '4', ' location', ' football', '\n', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [284.325, 76.29375, 68.80208333333333, 48.01875]}, 'weight': {'score': [23.094494047619047, 23.29197292731921, 22.54029605263158, 23.295984058859595, 29.600390625], 'topk_indices': array([3330, 3303, 3175, 3223, 7500, 7462, 1441, 1503, 4373, 4389, 5272,
       5211, 7239, 7183, 3486, 3512, 5036, 5013, 4988, 5065]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.9140625, 19.403125, 20.708333333333332, 25.8296875]}, 'saliency': {'score': [0.7231009347098214, 0.0528297656523447, 0.33581261885793584, 0.04978512518980399, 0.0778003215789795], 'topk_indices': array([  19, 8208, 8063, 8099, 8180, 8198, 8199, 8193,    8,   24, 8210,
       8201, 8204,   23,   20,  663, 2894, 8065, 8109,  666]), 'topk_tokens': ['26', 'assistant', ' provided', '.\n\n', ' return', ' football', ' before', 'Question', ' Date', '\n\n', '\n\n', ' kitchen', 'Answer', '4', ' Jul', ' picked', ' garden', ' context', ' location', ' football'], 'evidence_proportions': [1.990625, 0.36025390625, 0.3228251139322917, 0.2987548828125]}}, 'pred_res': 'the garden<|eot_id|>', 'score': 100}
2025-01-22 20:18:56.934 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:18:56.934 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-172_pid-2_1-3-4-5.pkl | len: 3 |  size: 2.02 KB
Processing depth (1, 3, 4, 5):   3%|â–         | 3/100 [00:59<32:02, 19.82s/it]is_0k: False
your chose emoji: ['ğŸ•¸', 'ğŸ§‘ğŸ¼\u200dğŸš’', 'ğŸ™†ğŸ¿\u200dâ™‚ï¸', 'ğŸ‘¨ğŸ½\u200dğŸ¦½\u200dâ¡', 'ğŸ’†ğŸ»\u200dâ™€ï¸', 'ğŸ§ğŸ½\u200dâ™‚', 'ğŸ¤¦\u200dâ™‚ï¸', 'ğŸ¦', 'ğŸ‘¨ğŸ¿\u200dğŸ¦¼\u200dâ¡', 'ğŸ–¼ï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.29s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.75s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.53s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  2.91s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.51s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (2, 5, 8, 9):   3%|â–         | 3/100 [01:15<32:02, 19.82s/it]2025-01-22 20:19:12.851 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the football.
2025-01-22 20:19:12.860 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1769, 1774) --> . Mary picked up the
2025-01-22 20:19:12.860 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went to the garden.
2025-01-22 20:19:12.881 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4151, 4156) --> . Mary went to the
2025-01-22 20:19:12.881 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the kitchen.
2025-01-22 20:19:12.914 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6644, 6650) --> . Mary went back to the
2025-01-22 20:19:12.914 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra moved to the kitchen.
2025-01-22 20:19:12.950 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7244, 7249) -->  Sandra moved to the kitchen
2025-01-22 20:19:12.950 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went back to the hallway.
2025-01-22 20:19:12.985 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6986, 6992) --> . Daniel went back to the
2025-01-22 20:19:12.985 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the kitchen.
2025-01-22 20:19:13.021 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6645, 6651) -->  Mary went back to the kitchen
2025-01-22 20:19:13.021 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra travelled to the bathroom.
2025-01-22 20:19:13.031 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1557, 1562) --> . Sandra travelled to the
2025-01-22 20:19:13.031 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went to the office.
2025-01-22 20:19:13.039 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1564, 1569) -->  Daniel moved to the office
2025-01-22 20:19:13.039 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel journeyed to the garden.
2025-01-22 20:19:13.063 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4889, 4895) --> . Daniel journeyed to the
2025-01-22 20:19:13.063 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel went to the bathroom.
2025-01-22 20:19:13.073 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (1560, 1565) -->  to the bathroom. Daniel
2025-01-22 20:19:13.073 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Daniel moved to the office.
2025-01-22 20:19:13.082 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (1561, 1566) -->  the bathroom. Daniel moved
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:19:15.080 | INFO     | test_jbb_embedding:begin_test:693 - the garden<|eot_id|>
2025-01-22 20:19:15.080 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8197])
2025-01-22 20:19:17.736 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [103.24404761904762, 14.816263338414634, 123.58059210526316, 14.08047805859231, 12.419788099315069], 'topk_indices': array([8193, 8190,    3,    4, 8095, 8184, 1650,   23, 1617, 8085,    9,
       8185, 8191, 4156,   24, 8196,   14,    0, 8195, 8192]), 'topk_tokens': ['<|start_header_id|>', 'Answer', '<|end_header_id|>', '\n\n', ' location', ' football', ' time', '4', ' part', '.\n\n', ':', ' before', ':', ' garden', '\n\n', '\n\n', '\n', '<|begin_of_text|>', '<|end_header_id|>', '<|eot_id|>'], 'evidence_proportions': [128.6375, 127.2625, 102.46875, 54.7625]}, 'weight': {'score': [21.94828869047619, 23.27285632621951, 22.54029605263158, 23.279692490173197, 29.131635273972602], 'topk_indices': array([3305, 3332, 3225, 3177, 7422, 7460, 1517, 1455, 4338, 4322, 5140,
       5201, 7181, 7125, 3508, 3534, 4917, 4994, 4965, 4942]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.1, 19.403125, 20.708333333333332, 25.8296875]}, 'saliency': {'score': [0.5526297433035714, 0.0812441718869093, 0.7205135947779605, 0.07704427813066193, 0.0914649440817637], 'topk_indices': array([1728,   23, 8189,    8, 1774,   14, 8194, 8085, 8051, 1650, 8179,
       8196,   24, 1617, 8095, 8190, 1562, 8185, 8184, 4156]), 'topk_tokens': [' some', '4', ' \n', ' Date', ' football', '\n', 'assistant', '.\n\n', ' context', ' time', 'Question', '\n\n', '\n\n', ' part', ' location', 'Answer', ' bathroom', ' before', ' football', ' garden'], 'evidence_proportions': [0.72412109375, 0.6227783203125, 0.5333251953125, 0.3341552734375]}}, 'pred_res': 'the garden<|eot_id|>', 'score': 100}
2025-01-22 20:19:17.743 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:19:17.743 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-172_pid-3_2-5-8-9.pkl | len: 3 |  size: 2.01 KB
Processing depth (2, 5, 8, 9):   4%|â–         | 4/100 [01:20<32:20, 20.21s/it]is_0k: False
your chose emoji: ['ğŸ¦»ğŸ½', '8ï¸âƒ£', 'ğŸ˜©', 'ğŸ‘©ğŸ¿\u200dğŸ”¬', 'â›¹ğŸ½\u200dâ™‚', 'ğŸ‡¨ğŸ‡½', '\U0001f6de', 'ğŸ‘©ğŸ¼\u200dğŸ¤\u200dğŸ‘¨ğŸ½', 'ğŸ“', 'ğŸ‘©\u200dâ¤\u200dğŸ’‹\u200dğŸ‘¨']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.05s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.32s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.21s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.99s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.44s/it]
Processing depth (1, 3, 5, 6):   4%|â–         | 4/100 [01:35<32:20, 20.21s/it]2025-01-22 20:19:33.220 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the football.
2025-01-22 20:19:33.225 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (661, 666) --> . Mary picked up the
2025-01-22 20:19:33.225 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went to the garden.
2025-01-22 20:19:33.242 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2837, 2842) --> . Mary went to the
2025-01-22 20:19:33.242 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the kitchen.
2025-01-22 20:19:33.264 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4143, 4149) --> . Mary went back to the
2025-01-22 20:19:33.265 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra moved to the kitchen.
2025-01-22 20:19:33.292 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4618, 4623) --> . Sandra moved to the
2025-01-22 20:19:33.292 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went back to the hallway.
2025-01-22 20:19:33.341 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6916, 6922) --> . Daniel went back to the
2025-01-22 20:19:33.341 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the kitchen.
2025-01-22 20:19:33.364 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4144, 4150) -->  Mary went back to the kitchen
2025-01-22 20:19:33.364 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra travelled to the bathroom.
2025-01-22 20:19:33.371 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1429, 1434) --> . Sandra travelled to the
2025-01-22 20:19:33.371 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went to the office.
2025-01-22 20:19:33.380 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1436, 1441) -->  Daniel moved to the office
2025-01-22 20:19:33.380 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel journeyed to the garden.
2025-01-22 20:19:33.413 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4778, 4784) -->  the senate. Daniel journeyed
2025-01-22 20:19:33.413 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel went to the bathroom.
2025-01-22 20:19:33.421 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (1432, 1437) -->  to the bathroom. Daniel
2025-01-22 20:19:33.422 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Daniel moved to the office.
2025-01-22 20:19:33.430 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (1433, 1438) -->  the bathroom. Daniel moved
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:19:34.276 | INFO     | test_jbb_embedding:begin_test:693 - Mary's room.<|eot_id|>
2025-01-22 20:19:34.276 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8149])
2025-01-22 20:19:36.495 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [163.96875, 16.001563075012267, 115.07113486842105, 15.152439801371555, 21.087332589285715], 'topk_indices': array([   1, 8132, 8139,    9, 8037,  663, 8046, 8137, 8136,  204, 8145,
       8003, 8147,   24,   14,  667,  666, 8047, 8144,    0]), 'topk_tokens': ['<|start_header_id|>', ':', ' kitchen', ':', '.\n\n', ' picked', ' first', ' before', ' football', 'ï¿½', '<|start_header_id|>', ' context', '<|end_header_id|>', '\n\n', '\n', '.', ' football', ' location', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [336.0, 130.6625, 128.23958333333334, 68.11875]}, 'weight': {'score': [20.808035714285715, 23.237734988346418, 23.162417763157894, 23.24439330285432, 29.074617346938776], 'topk_indices': array([3301, 3328, 3167, 3215, 7418, 7380, 1463, 1525, 4309, 4293, 5129,
       5190, 7157, 7101, 3484, 3510, 4906, 4931, 4983, 4954]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.1, 19.403125, 20.708333333333332, 21.040625]}, 'saliency': {'score': [0.8667457217261905, 0.08944753060981968, 0.6890371222245065, 0.08461524758809696, 0.15096391950334823], 'topk_indices': array([8118, 8142,  662, 1692,  202,   24, 1620, 8043, 8131,  204, 2842,
       8046, 8137, 8139, 1434,  663, 8136, 8003,  666, 8047]), 'topk_tokens': [' return', 'Answer', ' Mary', ' part', 'ï¿½', '\n\n', 'ern', ' item', 'Question', 'ï¿½', ' garden', ' first', ' before', ' kitchen', ' bathroom', ' picked', ' football', ' context', ' football', ' location'], 'evidence_proportions': [1.881640625, 0.65966796875, 0.6138509114583334, 0.36240234375]}}, 'pred_res': "Mary's room.<|eot_id|>", 'score': 0}
2025-01-22 20:19:36.506 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:19:36.510 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-172_pid-4_1-3-5-6.pkl | len: 3 |  size: 2.04 KB
Processing depth (1, 3, 5, 6):   5%|â–Œ         | 5/100 [01:38<31:10, 19.69s/it]Processing depth (1, 3, 5, 6):   5%|â–Œ         | 5/100 [01:38<31:19, 19.78s/it]
2025-01-22 20:19:36.573 | INFO     | __main__:<module>:82 - Selected idx: 174
2025-01-22 20:19:36.573 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the football before the kitchen? 
2025-01-22 20:19:36.573 | INFO     | __main__:<module>:84 - Answer: garden
2025-01-22 20:19:36.574 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 20:19:36.574 | INFO     | __main__:<module>:86 - Needle: [' Daniel went to the office.', ' Daniel went back to the hallway.', ' Mary picked up the football.', ' Daniel went to the bathroom.', ' John went back to the kitchen.', ' Daniel moved to the office.', ' Mary went to the garden.', ' Sandra travelled to the bathroom.', ' Daniel journeyed to the garden.', ' Mary went back to the kitchen.', ' Sandra moved to the kitchen.']
2025-01-22 20:19:36.574 | INFO     | __main__:<module>:87 - Real Needle: [' Mary picked up the football.', ' Mary went to the garden.', ' Mary went back to the kitchen.', ' Sandra moved to the kitchen.']
2025-01-22 20:19:36.574 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ†š', 'ğŸ§¨', 'ğŸ¤³ğŸ¾', 'ğŸœ', 'ğŸ‘©ğŸ¾\u200dğŸ’¼', 'ğŸ™‹ğŸ»\u200dâ™€ï¸', 'ğŸ‘¨ğŸ¾', 'ğŸ‘…', 'ğŸ‘¯\u200dâ™€', 'â“']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.22s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.76s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.51s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.11s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.63s/it]
Processing depth (0, 5, 6, 7):   0%|          | 0/100 [00:16<?, ?it/s]2025-01-22 20:19:52.858 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the football.
2025-01-22 20:19:52.858 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the football.
2025-01-22 20:19:52.858 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went to the garden.
2025-01-22 20:19:52.878 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4162, 4167) --> . Mary went to the
2025-01-22 20:19:52.879 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the kitchen.
2025-01-22 20:19:52.898 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3225, 3231) -->  John went back to the kitchen
2025-01-22 20:19:52.898 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra moved to the kitchen.
2025-01-22 20:19:52.926 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5617, 5622) --> . Sandra moved to the
2025-01-22 20:19:52.926 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went to the office.
2025-01-22 20:19:52.948 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4499, 4504) -->  execution. Daniel went to
2025-01-22 20:19:52.948 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went back to the hallway.
2025-01-22 20:19:52.961 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2562, 2568) -->  Daniel went back to the hallway
2025-01-22 20:19:52.961 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the bathroom.
2025-01-22 20:19:52.985 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4499, 4504) -->  execution. Daniel went to
2025-01-22 20:19:52.985 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the kitchen.
2025-01-22 20:19:53.002 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3224, 3230) --> . John went back to the
2025-01-22 20:19:53.002 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel moved to the office.
2025-01-22 20:19:53.030 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4981, 4986) --> . Daniel moved to the
2025-01-22 20:19:53.030 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra travelled to the bathroom.
2025-01-22 20:19:53.042 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (2036, 2041) -->  cable. Sandra travelled to
2025-01-22 20:19:53.042 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Daniel journeyed to the garden.
2025-01-22 20:19:53.060 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (3628, 3634) -->  Hon. Daniel journeyed to
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:19:54.311 | INFO     | test_jbb_embedding:begin_test:693 - Mary picked up the football in the first location, and then she went to the garden.<|eot_id|>
2025-01-22 20:19:54.312 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8193])
2025-01-22 20:19:56.540 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [247.63095238095238, 28.754676442776965, 120.53125, 27.761200765023965, 19.551317671654928], 'topk_indices': array([  31,   23,   38,    1, 8191, 8180,   35, 8181,   34,   39, 8081,
          9, 7682, 8091,   24, 8188,   14,  185, 8189,    0]), 'topk_tokens': [' picked', '4', '***', '<|start_header_id|>', '<|end_header_id|>', ' football', '.', ' before', ' football', '\n\n\n', '.\n\n', ':', 'nes', ' location', '\n\n', '<|eot_id|>', '\n', 'ION', '<|start_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [578.45, 158.125, 165.05208333333334, 105.4125]}, 'weight': {'score': [21.81063988095238, 23.275812896534894, 23.57339638157895, 23.278204497972226, 29.460827464788732], 'topk_indices': array([3318, 3291, 3204, 3156, 7484, 7446, 1437, 1499, 4349, 4333, 5199,
       5260, 7223, 7167, 3500, 3474, 5035, 5006, 4977, 4952]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.2875, 19.403125, 24.061197916666668, 21.040625]}, 'saliency': {'score': [1.4194219680059523, 0.16129686868499116, 0.7194053248355263, 0.15544351383437538, 0.14639164024675397], 'topk_indices': array([8175, 8047,    0,   36,   67, 7681, 8081,   57,  165,   24, 8183,
       8181,   39,   31,   38, 8091, 8180, 7682,   34,  185]), 'topk_tokens': ['Question', ' context', '<|begin_of_text|>', ' PA', 'ION', ' Min', '.\n\n', ' Proof', 'ION', '\n\n', ' kitchen', ' before', '\n\n\n', ' picked', '***', ' location', ' football', 'nes', ' football', 'ION'], 'evidence_proportions': [3.3392578125, 0.855517578125, 0.9878743489583334, 0.58134765625]}}, 'pred_res': 'Mary picked up the football in the first location, and then she went to the garden.<|eot_id|>', 'score': 100}
2025-01-22 20:19:56.548 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:19:56.548 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-174_pid-0_0-5-6-7.pkl | len: 3 |  size: 2.09 KB
Processing depth (0, 5, 6, 7):   1%|          | 1/100 [00:19<32:46, 19.86s/it]is_0k: False
your chose emoji: ['ğŸ§ğŸ¾\u200dâ™‚', 'ğŸ§œğŸ¿\u200dâ™‚', 'ğŸ‘©ğŸ»\u200dğŸ”§', 'â›·ï¸', 'ğŸ‘ŠğŸ¼', 'ğŸ§šğŸ»\u200dâ™‚', 'âœ‹ğŸ»', 'ğŸŠğŸ»\u200dâ™€ï¸', 'ğŸ‘¨\u200dğŸ¦±', 'ğŸ‘¬']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  3.83s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.32s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.17s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:12<00:00,  2.71s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:12<00:00,  3.24s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (1, 3, 6, 7):   1%|          | 1/100 [00:34<32:46, 19.86s/it]2025-01-22 20:20:11.321 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the football.
2025-01-22 20:20:11.325 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (895, 900) --> . Mary picked up the
2025-01-22 20:20:11.326 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went to the garden.
2025-01-22 20:20:11.345 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2979, 2984) -->  tragedy. Mary went to
2025-01-22 20:20:11.345 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the kitchen.
2025-01-22 20:20:11.362 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3257, 3263) -->  John went back to the kitchen
2025-01-22 20:20:11.362 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra moved to the kitchen.
2025-01-22 20:20:11.393 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5645, 5650) --> . Sandra moved to the
2025-01-22 20:20:11.393 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went to the office.
2025-01-22 20:20:11.408 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2798, 2803) -->  Daniel went back to the
2025-01-22 20:20:11.408 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went back to the hallway.
2025-01-22 20:20:11.430 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2797, 2803) --> . Daniel went back to the
2025-01-22 20:20:11.430 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the bathroom.
2025-01-22 20:20:11.445 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2798, 2803) -->  Daniel went back to the
2025-01-22 20:20:11.445 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the kitchen.
2025-01-22 20:20:11.463 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3256, 3262) --> . John went back to the
2025-01-22 20:20:11.463 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel moved to the office.
2025-01-22 20:20:11.489 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5035, 5040) --> . Daniel moved to the
2025-01-22 20:20:11.489 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra travelled to the bathroom.
2025-01-22 20:20:11.501 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (2113, 2118) --> . Sandra travelled to the
2025-01-22 20:20:11.501 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Daniel journeyed to the garden.
2025-01-22 20:20:11.523 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (3635, 3641) --> . Daniel journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:20:16.403 | INFO     | test_jbb_embedding:begin_test:693 - Mary picked up the football.<|eot_id|>
2025-01-22 20:20:16.403 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8143])
2025-01-22 20:20:19.194 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [206.93303571428572, 22.458085256567642, 121.28536184210526, 21.514668603932236, 20.219429347826086], 'topk_indices': array([8037, 2132, 2118,  968,    9, 8131,    3, 7997,  901, 8031, 8130,
       8039, 8041,   24,  900,   14, 8141, 8138, 8139,    0]), 'topk_tokens': [' item', 'ab', ' bathroom', 'ï¿½', ':', ' before', '<|end_header_id|>', ' context', '.', '.\n\n', ' football', ' the', ' location', '\n\n', ' football', '\n', '<|end_header_id|>', '<|eot_id|>', '<|start_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [457.15, 116.81875, 139.32291666666666, 127.9625]}, 'weight': {'score': [23.148809523809526, 23.239832049472135, 21.308799342105264, 23.249142141708916, 29.64639945652174], 'topk_indices': array([3300, 3273, 3138, 3186, 7396, 7434, 1479, 1417, 4263, 4279, 5117,
       5178, 7117, 7173, 3482, 3456, 4965, 4888, 4936, 4913]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.1, 25.2109375, 24.061197916666668, 21.040625]}, 'saliency': {'score': [1.182280040922619, 0.12399878666964614, 0.685045744243421, 0.1186143807432067, 0.14871348505434784], 'topk_indices': array([8112, 7995, 2985, 8136, 8040, 8031,  897, 2132, 8133,   24,  966,
        968, 8037, 8131,  896, 7997, 8041, 8130, 2118,  900]), 'topk_tokens': [' return', ' provided', ' garden', 'Answer', ' first', '.\n\n', ' picked', 'ab', ' kitchen', '\n\n', 'ï¿½', 'ï¿½', ' item', ' before', ' Mary', ' context', ' location', ' football', ' bathroom', ' football'], 'evidence_proportions': [2.545703125, 0.654541015625, 0.8603515625, 0.73291015625]}}, 'pred_res': 'Mary picked up the football.<|eot_id|>', 'score': 0}
2025-01-22 20:20:19.201 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:20:19.201 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-174_pid-1_1-3-6-7.pkl | len: 3 |  size: 2.06 KB
Processing depth (1, 3, 6, 7):   2%|â–         | 2/100 [00:42<35:07, 21.50s/it]is_0k: False
your chose emoji: ['ğŸšµğŸ¿\u200dâ™€ï¸', 'ğŸš´\u200dâ™€', 'ğŸ‘¨ğŸ¼', 'ğŸ§œ\u200dâ™‚ï¸', 'ğŸ˜³', '\U0001fac3ğŸ»', 'ğŸ¦‹', 'ğŸ¦”', 'ğŸ’Š', 'ğŸ’']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  3.99s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.25s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.30s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.10s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.51s/it]
Processing depth (3, 4, 6, 8):   2%|â–         | 2/100 [00:58<35:07, 21.50s/it]2025-01-22 20:20:35.030 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the football.
2025-01-22 20:20:35.043 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2746, 2751) --> . Mary picked up the
2025-01-22 20:20:35.043 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went to the garden.
2025-01-22 20:20:35.061 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3589, 3594) --> . Mary went to the
2025-01-22 20:20:35.061 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the kitchen.
2025-01-22 20:20:35.077 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3125, 3131) -->  John went back to the kitchen
2025-01-22 20:20:35.077 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra moved to the kitchen.
2025-01-22 20:20:35.114 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6571, 6576) --> . Sandra moved to the
2025-01-22 20:20:35.115 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went to the office.
2025-01-22 20:20:35.127 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2534, 2539) -->  Daniel went back to the
2025-01-22 20:20:35.127 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went back to the hallway.
2025-01-22 20:20:35.139 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2533, 2539) --> . Daniel went back to the
2025-01-22 20:20:35.139 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the bathroom.
2025-01-22 20:20:35.153 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2534, 2539) -->  Daniel went back to the
2025-01-22 20:20:35.153 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the kitchen.
2025-01-22 20:20:35.169 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3124, 3130) --> . John went back to the
2025-01-22 20:20:35.169 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel moved to the office.
2025-01-22 20:20:35.194 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5065, 5070) --> . Daniel moved to the
2025-01-22 20:20:35.194 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra travelled to the bathroom.
2025-01-22 20:20:35.203 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (1825, 1830) --> . Sandra travelled to the
2025-01-22 20:20:35.203 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Daniel journeyed to the garden.
2025-01-22 20:20:35.220 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (3592, 3598) -->  to the garden. Daniel journey
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:20:36.010 | INFO     | test_jbb_embedding:begin_test:693 - the garden<|eot_id|>
2025-01-22 20:20:36.010 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8231])
2025-01-22 20:20:38.270 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [149.13690476190476, 21.279891304347824, 134.6171875, 20.424623470948013, 13.363270399305556], 'topk_indices': array([8222, 8216, 8212,   23, 3594,    4,    1, 8225, 8218, 8230,    9,
       8119, 8219,   24, 8129, 2751, 8229,   14,    0, 8226]), 'topk_tokens': ['?', ' was', '.\n\n', '4', ' garden', '\n\n', '<|start_header_id|>', ':', ' football', '\n\n', ':', '.\n\n', ' before', '\n\n', ' location', ' football', '<|end_header_id|>', '\n', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [238.475, 175.7375, 117.78125, 70.825]}, 'weight': {'score': [21.765997023809526, 23.309907851590964, 21.645970394736842, 23.321608371559634, 29.719965277777778], 'topk_indices': array([3325, 3352, 3197, 3245, 7470, 7508, 1449, 1511, 4317, 4333, 5147,
       5208, 7247, 7191, 3508, 3534, 4995, 4966, 4943, 4918]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.1, 19.403125, 24.061197916666668, 21.040625]}, 'saliency': {'score': [0.8269333612351191, 0.1181747810858559, 0.7629683645148027, 0.11335691119552753, 0.10029771592881945], 'topk_indices': array([8223,   20, 8215, 8230, 2539,    8,   14, 8085, 8200, 8224, 8119,
       8221, 8213,   24, 3594, 1830, 8219, 8218, 8129, 2751]), 'topk_tokens': [' \n', ' Jul', ' Where', '\n\n', ' hallway', ' Date', '\n', ' context', ' return', 'Answer', '.\n\n', ' kitchen', 'Question', '\n\n', ' garden', ' bathroom', ' before', ' football', ' location', ' football'], 'evidence_proportions': [1.3201171875, 0.8625, 0.7533772786458334, 0.3864501953125]}}, 'pred_res': 'the garden<|eot_id|>', 'score': 100}
2025-01-22 20:20:38.283 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:20:38.284 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-174_pid-2_3-4-6-8.pkl | len: 3 |  size: 2.0 KB
Processing depth (3, 4, 6, 8):   3%|â–         | 3/100 [01:01<32:58, 20.40s/it]is_0k: False
your chose emoji: ['Â©ï¸', 'ğŸ•µğŸ¿\u200dâ™‚ï¸', 'ğŸ‘©ğŸ¾', 'ğŸ§‘ğŸ»\u200dâ¤\u200dğŸ§‘ğŸ¾', 'ğŸ‘®ğŸ¿\u200dâ™€ï¸', '\U0001faf3ğŸ¿', 'ğŸ‘²ğŸ¼', 'ğŸ‘¨ğŸ¼\u200dâ¤ï¸\u200dğŸ‘¨ğŸ¿', 'ğŸ‘©ğŸ½\u200dâœˆï¸', 'ğŸ§—ğŸ¿\u200dâ™‚ï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.52s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.43s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:03,  3.97s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:12<00:00,  2.59s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:12<00:00,  3.20s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (1, 3, 4, 7):   3%|â–         | 3/100 [01:16<32:58, 20.40s/it]2025-01-22 20:20:53.008 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the football.
2025-01-22 20:20:53.012 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (839, 844) --> . Mary picked up the
2025-01-22 20:20:53.012 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went to the garden.
2025-01-22 20:20:53.028 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2886, 2891) --> . Mary went to the
2025-01-22 20:20:53.028 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the kitchen.
2025-01-22 20:20:53.044 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3189, 3195) -->  John went back to the kitchen
2025-01-22 20:20:53.044 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra moved to the kitchen.
2025-01-22 20:20:53.071 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5679, 5684) --> . Sandra moved to the
2025-01-22 20:20:53.071 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went to the office.
2025-01-22 20:20:53.093 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4568, 4573) -->  execution. Daniel went to
2025-01-22 20:20:53.093 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went back to the hallway.
2025-01-22 20:20:53.106 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2588, 2594) -->  Daniel went back to the hallway
2025-01-22 20:20:53.106 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the bathroom.
2025-01-22 20:20:53.128 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4568, 4573) -->  execution. Daniel went to
2025-01-22 20:20:53.128 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the kitchen.
2025-01-22 20:20:53.144 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3187, 3193) -->  ranks. John went back to
2025-01-22 20:20:53.144 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel moved to the office.
2025-01-22 20:20:53.170 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5011, 5016) --> . Daniel moved to the
2025-01-22 20:20:53.170 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra travelled to the bathroom.
2025-01-22 20:20:53.181 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (1919, 1924) --> . Sandra travelled to the
2025-01-22 20:20:53.181 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Daniel journeyed to the garden.
2025-01-22 20:20:53.201 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (3656, 3662) -->  the kitchen. Daniel journeyed
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:20:58.565 | INFO     | test_jbb_embedding:begin_test:693 - Mary picked up the football.<|eot_id|>
2025-01-22 20:20:58.565 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8261])
2025-01-22 20:21:01.532 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [199.29464285714286, 25.395433128630202, 115.4654605263158, 24.533209552102377, 24.185909598214284], 'topk_indices': array([   1, 8115, 8156, 8249, 8158, 8157, 8188, 8149,    9,  845,   24,
       8259, 8189, 8248,  844,   14, 8159, 8256, 8257,    0]), 'topk_tokens': ['<|start_header_id|>', ' context', ' in', ' before', ' first', ' the', ' to', '.\n\n', ':', '.', '\n\n', '<|end_header_id|>', ' the', ' football', ' football', '\n', ' location', '<|eot_id|>', '<|start_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [454.9, 126.4375, 106.71875, 127.6375]}, 'weight': {'score': [21.765997023809526, 23.334752011737656, 23.511924342105264, 23.33794656459476, 29.781845238095237], 'topk_indices': array([3351, 3378, 3223, 3271, 7552, 7514, 1545, 1483, 4416, 4400, 5261,
       5322, 7291, 7235, 3534, 3560, 5063, 5038, 5115, 5086]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.1, 19.403125, 24.061197916666668, 21.040625]}, 'saliency': {'score': [1.116455078125, 0.14141095319306632, 0.6678980777138158, 0.1364770790485984, 0.17791864304315477], 'topk_indices': array([8245, 8153, 8161,    8, 8230, 1924, 8155,  840,    0, 8149, 8251,
       8249,   24, 8158,  841, 8187, 8115, 8248,  844, 8159]), 'topk_tokens': [' Where', ' obtained', ' traveled', ' Date', ' return', ' bathroom', ' item', ' Mary', '<|begin_of_text|>', '.\n\n', ' kitchen', ' before', '\n\n', ' first', ' picked', ' moved', ' context', ' football', ' football', ' location'], 'evidence_proportions': [2.5640625, 0.609765625, 0.6678059895833334, 0.713916015625]}}, 'pred_res': 'Mary picked up the football.<|eot_id|>', 'score': 0}
2025-01-22 20:21:01.540 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:21:01.540 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-174_pid-3_1-3-4-7.pkl | len: 3 |  size: 2.08 KB
Processing depth (1, 3, 4, 7):   4%|â–         | 4/100 [01:24<34:26, 21.53s/it]is_0k: False
your chose emoji: ['ğŸ‘©ğŸ¿\u200dâ¤\u200dğŸ‘¨ğŸ¾', 'ğŸ¤¹ğŸ¿\u200dâ™€', 'ğŸ’ğŸ¼\u200dâ™‚', 'ğŸ‹ğŸ½\u200dâ™‚ï¸', 'ğŸ¥–', 'ğŸ‘¨ğŸ¾\u200dğŸ¼', 'ğŸ‘©ğŸ¾\u200dâ¤\u200dğŸ’‹\u200dğŸ‘¨ğŸ½', 'ğŸ‘©ğŸ¼\u200dğŸ¦¼', 'ğŸ´\U000e0067\U000e0062\U000e0065\U000e006e\U000e0067\U000e007f', 'ğŸš']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.62s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.64s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.57s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.13s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.67s/it]
Processing depth (1, 2, 5, 8):   4%|â–         | 4/100 [01:41<34:26, 21.53s/it]2025-01-22 20:21:18.198 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the football.
2025-01-22 20:21:18.203 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (827, 832) --> . Mary picked up the
2025-01-22 20:21:18.203 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went to the garden.
2025-01-22 20:21:18.212 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1793, 1798) --> . Mary went to the
2025-01-22 20:21:18.212 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the kitchen.
2025-01-22 20:21:18.228 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3265, 3271) -->  John went back to the kitchen
2025-01-22 20:21:18.228 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra moved to the kitchen.
2025-01-22 20:21:18.262 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6663, 6668) --> . Sandra moved to the
2025-01-22 20:21:18.262 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went to the office.
2025-01-22 20:21:18.277 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2702, 2707) -->  Daniel went back to the
2025-01-22 20:21:18.277 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went back to the hallway.
2025-01-22 20:21:18.291 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2701, 2707) --> . Daniel went back to the
2025-01-22 20:21:18.291 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the bathroom.
2025-01-22 20:21:18.304 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2702, 2707) -->  Daniel went back to the
2025-01-22 20:21:18.304 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the kitchen.
2025-01-22 20:21:18.320 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3264, 3270) --> . John went back to the
2025-01-22 20:21:18.320 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel moved to the office.
2025-01-22 20:21:18.345 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5203, 5208) --> . Daniel moved to the
2025-01-22 20:21:18.346 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra travelled to the bathroom.
2025-01-22 20:21:18.355 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (2034, 2039) -->  cable. Sandra travelled to
2025-01-22 20:21:18.355 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Daniel journeyed to the garden.
2025-01-22 20:21:18.374 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (3643, 3649) --> . Daniel journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:21:19.291 | INFO     | test_jbb_embedding:begin_test:693 - Mary picked up the football.<|eot_id|>
2025-01-22 20:21:19.291 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8197])
2025-01-22 20:21:21.566 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [207.33184523809524, 23.158666158536587, 96.08963815789474, 22.343162695000615, 13.974542487157533], 'topk_indices': array([8094,    4,  827,  190,    1, 8085,   23,  829, 8184, 8195,   24,
          9, 1232, 8095,   14, 8192,  833,  832, 8193,    0]), 'topk_tokens': [' first', '\n\n', '.', 'ATION', '<|start_header_id|>', '.\n\n', '4', ' picked', ' football', '<|end_header_id|>', '\n\n', ':', 'nes', ' location', '\n', '<|eot_id|>', '.', ' football', '<|start_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [472.5, 169.15, 130.36458333333334, 72.70625]}, 'weight': {'score': [21.765997023809526, 23.282326600609757, 21.89124177631579, 23.29273123694878, 29.663527397260275], 'topk_indices': array([3281, 3308, 3146, 3194, 7422, 7460, 1485, 1423, 4290, 4274, 5109,
       5170, 7199, 7143, 3490, 3464, 4886, 4911, 4963, 4934]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.1, 19.403125, 24.061197916666668, 21.040625]}, 'saliency': {'score': [1.1588716052827381, 0.1294862775104802, 0.5566486559416118, 0.12483706214828875, 0.10744183684048587], 'topk_indices': array([8085, 8166,  190,    9, 8185,  752, 8187,    8, 8094, 8051, 1231,
       1172,   24,  828, 1798,  829, 8184, 1232, 8095,  832]), 'topk_tokens': ['.\n\n', ' return', 'ATION', ':', ' before', 'ï¿½', ' kitchen', ' Date', ' first', ' context', 'Min', 'nes', '\n\n', ' Mary', ' garden', ' picked', ' football', 'nes', ' location', ' football'], 'evidence_proportions': [2.6359375, 0.85859375, 0.8114013671875, 0.3990478515625]}}, 'pred_res': 'Mary picked up the football.<|eot_id|>', 'score': 0}
2025-01-22 20:21:21.573 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:21:21.573 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-174_pid-4_1-2-5-8.pkl | len: 3 |  size: 2.03 KB
Processing depth (1, 2, 5, 8):   5%|â–Œ         | 5/100 [01:44<33:13, 20.99s/it]Processing depth (1, 2, 5, 8):   5%|â–Œ         | 5/100 [01:44<33:13, 20.99s/it]
2025-01-22 20:21:21.629 | INFO     | __main__:<module>:82 - Selected idx: 176
2025-01-22 20:21:21.629 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the football before the kitchen? 
2025-01-22 20:21:21.629 | INFO     | __main__:<module>:84 - Answer: garden
2025-01-22 20:21:21.629 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 20:21:21.629 | INFO     | __main__:<module>:86 - Needle: [' John went back to the kitchen.', ' Mary picked up the football.', ' Daniel went to the bathroom.', ' Daniel went to the office.', ' Sandra travelled to the bathroom.', ' Mary went to the garden.', ' Daniel journeyed to the garden.', ' Daniel went back to the hallway.', ' Daniel moved to the office.', ' Mary went back to the kitchen.', ' Sandra moved to the kitchen.']
2025-01-22 20:21:21.629 | INFO     | __main__:<module>:87 - Real Needle: [' Mary picked up the football.', ' Mary went to the garden.', ' Mary went back to the kitchen.', ' Sandra moved to the kitchen.']
2025-01-22 20:21:21.629 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ™ï¸', 'ğŸ§‘ğŸ½', 'ğŸƒğŸ¿\u200dâ™‚', 'ğŸ‘¨ğŸ»\u200dâ¤\u200dğŸ’‹\u200dğŸ‘¨ğŸ¾', 'ğŸšš', 'ğŸ‘·ğŸ¿\u200dâ™€ï¸', 'ğŸ“ ', 'ğŸš´ğŸ¾\u200dâ™‚ï¸', 'ğŸ©¹', 'ğŸ•µğŸ¾\u200dâ™€']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  3.95s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.42s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.26s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.76s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.31s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 4, 7, 9):   0%|          | 0/100 [00:15<?, ?it/s]2025-01-22 20:21:37.260 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the football.
2025-01-22 20:21:37.260 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the football.
2025-01-22 20:21:37.260 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went to the garden.
2025-01-22 20:21:37.279 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3637, 3642) --> . Mary went to the
2025-01-22 20:21:37.279 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the kitchen.
2025-01-22 20:21:37.288 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1731, 1737) -->  John went back to the kitchen
2025-01-22 20:21:37.288 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra moved to the kitchen.
2025-01-22 20:21:37.297 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1735, 1740) -->  the kitchen. Daniel moved
2025-01-22 20:21:37.297 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the kitchen.
2025-01-22 20:21:37.306 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1730, 1736) --> . John went back to the
2025-01-22 20:21:37.306 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the bathroom.
2025-01-22 20:21:37.307 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (304, 309) -->  Daniel went back to the
2025-01-22 20:21:37.308 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the office.
2025-01-22 20:21:37.309 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (304, 309) -->  Daniel went back to the
2025-01-22 20:21:37.309 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra travelled to the bathroom.
2025-01-22 20:21:37.338 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4520, 4525) -->  Sandra travelled to the bathroom
2025-01-22 20:21:37.339 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel journeyed to the garden.
2025-01-22 20:21:37.372 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6682, 6688) --> . Daniel journeyed to the
2025-01-22 20:21:37.372 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel went back to the hallway.
2025-01-22 20:21:37.373 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (303, 309) --> . Daniel went back to the
2025-01-22 20:21:37.374 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Daniel moved to the office.
2025-01-22 20:21:37.382 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (1735, 1740) -->  the kitchen. Daniel moved
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:21:41.967 | INFO     | test_jbb_embedding:begin_test:693 - Mary picked up the football.<|eot_id|>
2025-01-22 20:21:41.967 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8207])
2025-01-22 20:21:44.797 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [263.3125, 29.694296208891597, 166.89638157894737, 28.452772282542018, 15.010316506410257], 'topk_indices': array([ 338, 1063,    9, 8105, 8205, 1062,  518,  185, 1064, 8202,   24,
         14, 1024, 8203, 1025, 1026,    0, 1065, 1027, 1066]), 'topk_tokens': [' century', 'into', ':', ' location', '<|end_header_id|>', '\n', ' an', 'ION', ' the', '<|eot_id|>', '\n\n', '\n', ' the', '<|start_header_id|>', ' galaxy', ' of', '<|begin_of_text|>', ' galaxy', ' states', ' of'], 'evidence_proportions': [486.6, 131.15, 213.20833333333334, 232.3125]}, 'weight': {'score': [22.48251488095238, 23.29606996041413, 22.57750822368421, 23.301515918292235, 29.971955128205128], 'topk_indices': array([3330, 3303, 3217, 3169, 7460, 7498, 1490, 1428, 4374, 4358, 5248,
       5187, 7237, 7181, 3486, 3512, 4989, 4964, 5012, 5041]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.2875, 19.403125, 24.061197916666668, 23.8625]}, 'saliency': {'score': [1.4958844866071428, 0.16719548437975792, 0.9752036646792763, 0.1600053506663293, 0.1118167975010016], 'topk_indices': array([ 366, 1024,   38,  309, 8195,  518,   31,   24, 8197,    0,   34,
        338, 1063,  185, 8105, 1026, 1066, 1025, 1027, 1065]), 'topk_tokens': [' past', ' the', '***', ' hallway', ' before', ' an', ' picked', '\n\n', ' kitchen', '<|begin_of_text|>', ' football', ' century', 'into', 'ION', ' location', ' of', ' of', ' galaxy', ' states', ' galaxy'], 'evidence_proportions': [2.7384765625, 0.66806640625, 1.3164876302083333, 1.29638671875]}}, 'pred_res': 'Mary picked up the football.<|eot_id|>', 'score': 0}
2025-01-22 20:21:44.804 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:21:44.804 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-176_pid-0_0-4-7-9.pkl | len: 3 |  size: 2.03 KB
Processing depth (0, 4, 7, 9):   1%|          | 1/100 [00:23<38:05, 23.08s/it]is_0k: False
your chose emoji: ['ğŸ‘³\u200dâ™‚ï¸', 'ğŸ¥', 'ğŸ‡²ğŸ‡¸', 'ğŸ§‘ğŸ¾\u200dâ¤ï¸\u200dğŸ§‘ğŸ¿', 'ğŸ§ğŸ¾\u200dâ™€\u200dâ¡', 'ğŸ¤¹ğŸ¿\u200dâ™€', 'ğŸ§ğŸ¼\u200dâ™€ï¸', 'ğŸ§', 'ğŸ§ğŸ½\u200dâ™€ï¸\u200dâ¡', 'ğŸ¥ƒ']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.41s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.74s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.53s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.14s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.67s/it]
Processing depth (2, 7, 8, 9):   1%|          | 1/100 [00:39<38:05, 23.08s/it]2025-01-22 20:22:01.233 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the football.
2025-01-22 20:22:01.242 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1743, 1748) --> . Mary picked up the
2025-01-22 20:22:01.242 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went to the garden.
2025-01-22 20:22:01.269 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5603, 5608) --> . Mary went to the
2025-01-22 20:22:01.270 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the kitchen.
2025-01-22 20:22:01.279 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1531, 1537) -->  John went back to the kitchen
2025-01-22 20:22:01.279 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra moved to the kitchen.
2025-01-22 20:22:01.287 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1535, 1540) -->  the kitchen. Daniel moved
2025-01-22 20:22:01.287 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the kitchen.
2025-01-22 20:22:01.295 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1530, 1536) --> . John went back to the
2025-01-22 20:22:01.295 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the bathroom.
2025-01-22 20:22:01.297 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (298, 303) -->  Daniel went back to the
2025-01-22 20:22:01.297 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the office.
2025-01-22 20:22:01.298 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (298, 303) -->  Daniel went back to the
2025-01-22 20:22:01.298 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra travelled to the bathroom.
2025-01-22 20:22:01.320 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4533, 4538) --> . Sandra travelled to the
2025-01-22 20:22:01.320 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel journeyed to the garden.
2025-01-22 20:22:01.357 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6690, 6696) --> . Daniel journeyed to the
2025-01-22 20:22:01.357 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel went back to the hallway.
2025-01-22 20:22:01.359 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (297, 303) --> . Daniel went back to the
2025-01-22 20:22:01.359 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Daniel moved to the office.
2025-01-22 20:22:01.366 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (1535, 1540) -->  the kitchen. Daniel moved
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:22:02.140 | INFO     | test_jbb_embedding:begin_test:693 - the bathroom<|eot_id|>
2025-01-22 20:22:02.140 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8227])
2025-01-22 20:22:04.378 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [269.42261904761904, 24.852179526123937, 195.91036184210526, 23.428095551340107, 33.35777698863637], 'topk_indices': array([5608, 1536,   11, 6097, 8125,  298, 8226, 5604, 8215,    4, 5542,
       8214,   24, 8225, 1748, 8115,    9,   14, 8222,    0]), 'topk_tokens': [' garden', ' kitchen', ' ', ' in', ' location', ' Daniel', '\n\n', ' Mary', ' before', '\n\n', '.', ' football', '\n\n', '<|end_header_id|>', ' football', '.\n\n', ':', '\n', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [263.025, 304.85, 232.20833333333334, 285.05]}, 'weight': {'score': [22.437872023809526, 23.303952764277035, 21.82894736842105, 23.313038298555867, 29.587180397727273], 'topk_indices': array([3305, 3332, 3225, 3177, 7436, 7474, 1428, 1490, 4338, 4354, 5155,
       5216, 7151, 7207, 3514, 3488, 4980, 4932, 5009, 4957]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.1, 19.403125, 24.061197916666668, 23.8625]}, 'saliency': {'score': [1.5599190848214286, 0.1395866310610951, 1.1896651418585527, 0.1310527961645989, 0.24652793190696023], 'topk_indices': array([8079,  303,    9, 4164, 8081,   24, 8209, 8220, 8217,    8, 8125,
       8215,   14, 5608, 1536, 8115, 5604,  298, 8214, 1748]), 'topk_tokens': [' provided', ' hallway', ':', ' bathroom', ' context', '\n\n', 'Question', 'Answer', ' kitchen', ' Date', ' location', ' before', '\n', ' garden', ' kitchen', '.\n\n', ' Mary', ' Daniel', ' football', ' football'], 'evidence_proportions': [1.47431640625, 1.69580078125, 1.4702962239583333, 1.6171875]}}, 'pred_res': 'the bathroom<|eot_id|>', 'score': 0}
2025-01-22 20:22:04.386 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:22:04.386 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-176_pid-1_2-7-8-9.pkl | len: 3 |  size: 2.01 KB
Processing depth (2, 7, 8, 9):   2%|â–         | 2/100 [00:42<34:20, 21.02s/it]is_0k: False
your chose emoji: ['ğŸ¦»ğŸ¿', 'ğŸ¤ğŸ¾', 'ğŸ’†ğŸ½\u200dâ™‚ï¸', 'ğŸš’', 'ğŸš¶ğŸ»\u200dâ™€ï¸\u200dâ¡ï¸', 'ğŸ‘©ğŸ½\u200dâ¤\u200dğŸ’‹\u200dğŸ‘¨ğŸ½', 'â¡', 'ğŸƒğŸ½', 'ğŸ‘©ğŸ¿\u200dğŸ¤\u200dğŸ‘©ğŸ½', 'ğŸ‘¨\u200dâš•ï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  4.00s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.28s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.27s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.77s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.30s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (1, 2, 3, 6):   2%|â–         | 2/100 [00:57<34:20, 21.02s/it]2025-01-22 20:22:19.434 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the football.
2025-01-22 20:22:19.438 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (822, 827) --> . Mary picked up the
2025-01-22 20:22:19.438 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went to the garden.
2025-01-22 20:22:19.447 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1760, 1765) -->  Mary went to the garden
2025-01-22 20:22:19.447 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the kitchen.
2025-01-22 20:22:19.455 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1571, 1577) -->  John went back to the kitchen
2025-01-22 20:22:19.455 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra moved to the kitchen.
2025-01-22 20:22:19.463 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1575, 1580) -->  the kitchen. Daniel moved
2025-01-22 20:22:19.463 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the kitchen.
2025-01-22 20:22:19.471 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1570, 1576) --> . John went back to the
2025-01-22 20:22:19.471 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the bathroom.
2025-01-22 20:22:19.473 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (298, 303) -->  Daniel went back to the
2025-01-22 20:22:19.473 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the office.
2025-01-22 20:22:19.474 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (298, 303) -->  Daniel went back to the
2025-01-22 20:22:19.474 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra travelled to the bathroom.
2025-01-22 20:22:19.500 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4507, 4512) -->  Sandra travelled to the bathroom
2025-01-22 20:22:19.500 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel journeyed to the garden.
2025-01-22 20:22:19.534 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6702, 6708) --> . Daniel journeyed to the
2025-01-22 20:22:19.534 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel went back to the hallway.
2025-01-22 20:22:19.536 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (297, 303) --> . Daniel went back to the
2025-01-22 20:22:19.536 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Daniel moved to the office.
2025-01-22 20:22:19.543 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (1575, 1580) -->  the kitchen. Daniel moved
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:22:22.890 | INFO     | test_jbb_embedding:begin_test:693 - Mary's house.<|eot_id|>
2025-01-22 20:22:22.890 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8213])
2025-01-22 20:22:25.596 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [245.00595238095238, 19.546722857838365, 166.12911184210526, 18.28341838298394, 24.61617476851852], 'topk_indices': array([ 824, 8212,    8, 8067,    4, 8200, 8101,    1, 8203,   23, 8111,
       8201,   24, 8211,    9,   14, 8208,  827, 8209,    0]), 'topk_tokens': [' picked', '\n\n', ' Date', ' context', '\n\n', ' football', '.\n\n', '<|start_header_id|>', ' kitchen', '4', ' location', ' before', '\n\n', '<|end_header_id|>', ':', '\n', '<|eot_id|>', ' football', '<|start_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [392.65, 215.875, 181.80208333333334, 202.3375]}, 'weight': {'score': [23.51264880952381, 23.290291047955208, 22.57750822368421, 23.29303914582567, 29.437114197530864], 'topk_indices': array([3302, 3329, 3174, 3222, 7494, 7456, 1488, 1426, 4353, 4369, 5180,
       5241, 7233, 7177, 3485, 3511, 5005, 5034, 4957, 4982]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.1, 23.9171875, 24.061197916666668, 23.8625]}, 'saliency': {'score': [1.4664248511904763, 0.10951743269848847, 1.0120303505345394, 0.10181968270877391, 0.18658927634910302], 'topk_indices': array([  14,  759, 8195, 8101,  823, 8182,   23,   32, 1764,  298,    9,
          8, 8067,  824,   24, 8200, 8111, 8201, 8203,  827]), 'topk_tokens': ['\n', 'ï¿½', 'Question', '.\n\n', ' Mary', ' return', '4', '***', ' garden', ' Daniel', ':', ' Date', ' context', ' picked', '\n\n', ' football', ' location', ' before', ' kitchen', ' football'], 'evidence_proportions': [2.19990234375, 1.4275390625, 1.1400553385416667, 1.1634765625]}}, 'pred_res': "Mary's house.<|eot_id|>", 'score': 0}
2025-01-22 20:22:25.611 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:22:25.611 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-176_pid-2_1-2-3-6.pkl | len: 3 |  size: 2.02 KB
Processing depth (1, 2, 3, 6):   3%|â–         | 3/100 [01:03<34:08, 21.12s/it]is_0k: False
your chose emoji: ['ğŸ‘©ğŸ¾\u200dâ¤\u200dğŸ‘©ğŸ¼', 'ğŸ¤¾ğŸ¼\u200dâ™‚ï¸', 'ğŸ²', 'â¹ï¸', 'ğŸ‘œ', 'ğŸ‘¨\u200dğŸ”§', 'ğŸ‘¨ğŸ»\u200dğŸš’', '\U0001faf1ğŸ¿\u200d\U0001faf2ğŸ½', 'ğŸ¤¾ğŸ¼\u200dâ™‚', 'ğŸš¶ğŸ¿\u200dâ™€']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.53s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.67s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.48s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.07s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.61s/it]
Processing depth (5, 6, 7, 9):   3%|â–         | 3/100 [01:20<34:08, 21.12s/it]2025-01-22 20:22:41.936 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the football.
2025-01-22 20:22:41.957 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4194, 4199) --> . Mary picked up the
2025-01-22 20:22:41.957 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went to the garden.
2025-01-22 20:22:41.981 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4780, 4785) --> . Mary went to the
2025-01-22 20:22:41.982 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the kitchen.
2025-01-22 20:22:41.990 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1607, 1613) -->  John went back to the kitchen
2025-01-22 20:22:41.990 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra moved to the kitchen.
2025-01-22 20:22:41.998 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1611, 1616) -->  the kitchen. Daniel moved
2025-01-22 20:22:41.998 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the kitchen.
2025-01-22 20:22:42.006 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1606, 1612) --> . John went back to the
2025-01-22 20:22:42.006 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the bathroom.
2025-01-22 20:22:42.008 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (290, 295) -->  Daniel went back to the
2025-01-22 20:22:42.008 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the office.
2025-01-22 20:22:42.009 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (290, 295) -->  Daniel went back to the
2025-01-22 20:22:42.009 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra travelled to the bathroom.
2025-01-22 20:22:42.031 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4556, 4561) --> . Sandra travelled to the
2025-01-22 20:22:42.032 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel journeyed to the garden.
2025-01-22 20:22:42.065 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6717, 6723) --> . Daniel journeyed to the
2025-01-22 20:22:42.065 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel went back to the hallway.
2025-01-22 20:22:42.067 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (289, 295) --> . Daniel went back to the
2025-01-22 20:22:42.067 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Daniel moved to the office.
2025-01-22 20:22:42.075 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (1611, 1616) -->  the kitchen. Daniel moved
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:22:42.878 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 20:22:42.878 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8240])
2025-01-22 20:22:45.108 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [106.09672619047619, 13.03781712513648, 67.5865542763158, 12.545748564271749, 15.810032894736842], 'topk_indices': array([8223, 8213, 8233,   25,    3, 8138,    4, 4785, 8234, 8128,   23,
          1, 8236,    9, 8239,   24,   14, 8238,    0, 8235]), 'topk_tokens': [':', '.', 'Answer', '<|eot_id|>', '<|end_header_id|>', ' location', '\n\n', ' garden', ':', '.\n\n', '4', '<|start_header_id|>', '<|start_header_id|>', ':', '\n\n', '\n\n', '\n', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [156.0, 104.775, 77.875, 91.38125]}, 'weight': {'score': [22.437872023809526, 23.323761449108336, 21.82894736842105, 23.33297535587732, 29.091611842105262], 'topk_indices': array([3379, 3352, 3272, 3224, 7475, 7437, 1524, 1462, 4361, 4377, 5184,
       5245, 7208, 7152, 3535, 3561, 4986, 5038, 5009, 4961]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.1, 19.403125, 24.061197916666668, 23.8625]}, 'saliency': {'score': [0.5869082496279762, 0.07110570527881611, 0.37423866673519735, 0.06837465616265351, 0.10355417351973684], 'topk_indices': array([8230, 8228, 8232, 8212,   16,    8, 4199,   14,   23, 8209, 8222,
       8128, 8237, 8239, 8227,   20, 8233, 8138,   24, 4785]), 'topk_tokens': [' kitchen', ' before', ' \n', ' directly', ' Date', ' Date', ' football', '\n', '4', ' return', 'Question', '.\n\n', 'assistant', '\n\n', ' football', ' Jul', 'Answer', ' location', '\n\n', ' garden'], 'evidence_proportions': [0.885693359375, 0.4951904296875, 0.4869384765625, 0.4998046875]}}, 'pred_res': 'The garden.<|eot_id|>', 'score': 100}
2025-01-22 20:22:45.118 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:22:45.119 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-176_pid-3_5-6-7-9.pkl | len: 3 |  size: 2.01 KB
Processing depth (5, 6, 7, 9):   4%|â–         | 4/100 [01:23<32:46, 20.48s/it]is_0k: False
your chose emoji: ['ğŸ‘®ğŸ¼\u200dâ™‚', 'ğŸ™‹ğŸ»\u200dâ™‚', 'ğŸ•‰ï¸', 'ğŸ§‘ğŸ½\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ§‘ğŸ¼', 'ğŸ‘©ğŸ»\u200dğŸ¦¼\u200dâ¡', 'ğŸ¦¸ğŸ»\u200dâ™‚', 'ğŸ§—ğŸ»\u200dâ™€ï¸', '#ï¸âƒ£', 'ğŸ§ğŸ¿\u200dâ™€ï¸', 'ğŸ¤¸ğŸ¾\u200dâ™‚']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.28s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.70s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.22s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.84s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.41s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (1, 4, 5, 7):   4%|â–         | 4/100 [01:38<32:46, 20.48s/it]2025-01-22 20:23:00.651 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the football.
2025-01-22 20:23:00.655 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (834, 839) --> . Mary picked up the
2025-01-22 20:23:00.655 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went to the garden.
2025-01-22 20:23:00.673 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3643, 3648) --> . Mary went to the
2025-01-22 20:23:00.673 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the kitchen.
2025-01-22 20:23:00.681 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1581, 1587) -->  John went back to the kitchen
2025-01-22 20:23:00.681 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra moved to the kitchen.
2025-01-22 20:23:00.689 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1585, 1590) -->  the kitchen. Daniel moved
2025-01-22 20:23:00.689 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the kitchen.
2025-01-22 20:23:00.697 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1580, 1586) --> . John went back to the
2025-01-22 20:23:00.697 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the bathroom.
2025-01-22 20:23:00.698 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (298, 303) -->  Daniel went back to the
2025-01-22 20:23:00.698 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the office.
2025-01-22 20:23:00.700 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (298, 303) -->  Daniel went back to the
2025-01-22 20:23:00.700 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra travelled to the bathroom.
2025-01-22 20:23:00.723 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4626, 4631) --> . Sandra travelled to the
2025-01-22 20:23:00.723 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel journeyed to the garden.
2025-01-22 20:23:00.756 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6731, 6737) -->  Daniel journeyed to the garden
2025-01-22 20:23:00.756 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel went back to the hallway.
2025-01-22 20:23:00.757 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (297, 303) --> . Daniel went back to the
2025-01-22 20:23:00.757 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Daniel moved to the office.
2025-01-22 20:23:00.765 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (1585, 1590) -->  the kitchen. Daniel moved
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:23:05.285 | INFO     | test_jbb_embedding:begin_test:693 - Mary picked up the football.<|eot_id|>
2025-01-22 20:23:05.285 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8241])
2025-01-22 20:23:08.205 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [258.6577380952381, 39.98431055919457, 215.01850328947367, 38.610646380574224, 21.624198190789475], 'topk_indices': array([8237, 1523,   32,   35, 2369,  149,   14,   24, 8239, 2384,  839,
        313, 2335, 2370, 8236, 1939, 2372, 2385, 2371,    0]), 'topk_tokens': ['<|start_header_id|>', 'ot', '***', '-text', ' the', '\n\n\n\n\n\n\n', '\n', '\n\n', '<|end_header_id|>', ' Min', ' football', 'ides', 'u', ' Min', '<|eot_id|>', 'asca', 'ot', 'nes', 'nes', '<|begin_of_text|>'], 'evidence_proportions': [415.0, 320.325, 146.71875, 174.975]}, 'weight': {'score': [22.437872023809526, 23.31224413209607, 22.422902960526315, 23.318616371411117, 29.48388157894737], 'topk_indices': array([3281, 3308, 3153, 3201, 7508, 7470, 1498, 1436, 4295, 4279, 5197,
       5136, 7247, 7191, 3490, 3464, 4907, 4990, 4932, 4961]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.1, 19.403125, 24.061197916666668, 23.8625]}, 'saliency': {'score': [1.4159691220238095, 0.2284848853143195, 1.328879908511513, 0.2203294571099954, 0.16010404887952304], 'topk_indices': array([8139, 2286, 2367, 1490,   33,  112, 1522, 2335,  257,   32,   35,
        149,  313, 2384,  839, 2370, 2372, 1939, 2385, 2371]), 'topk_tokens': [' location', 'nes', ' messenger', 'nes', '\n\n\n', ' Articles', 'nes', 'u', 'hue', '***', '-text', '\n\n\n\n\n\n\n', 'ides', ' Min', ' football', ' Min', 'ot', 'asca', 'nes', 'nes'], 'evidence_proportions': [2.29501953125, 1.52783203125, 0.9309488932291666, 1.007080078125]}}, 'pred_res': 'Mary picked up the football.<|eot_id|>', 'score': 0}
2025-01-22 20:23:08.212 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:23:08.213 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-176_pid-4_1-4-5-7.pkl | len: 3 |  size: 1.99 KB
Processing depth (1, 4, 5, 7):   5%|â–Œ         | 5/100 [01:46<33:55, 21.42s/it]Processing depth (1, 4, 5, 7):   5%|â–Œ         | 5/100 [01:46<33:45, 21.32s/it]
2025-01-22 20:23:08.315 | INFO     | __main__:<module>:82 - Selected idx: 178
2025-01-22 20:23:08.315 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the apple before the office? 
2025-01-22 20:23:08.315 | INFO     | __main__:<module>:84 - Answer: hallway
2025-01-22 20:23:08.315 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 20:23:08.315 | INFO     | __main__:<module>:86 - Needle: [' Daniel journeyed to the garden.', ' Daniel moved to the office.', ' Mary got the apple.', ' John went back to the kitchen.', ' Daniel went to the bathroom.', ' Sandra travelled to the bathroom.', ' Mary journeyed to the hallway.', ' Daniel went to the office.', ' Daniel went back to the hallway.', ' Mary travelled to the office.', ' Sandra moved to the kitchen.']
2025-01-22 20:23:08.315 | INFO     | __main__:<module>:87 - Real Needle: [' Mary got the apple.', ' Mary journeyed to the hallway.', ' Mary travelled to the office.', ' Sandra moved to the kitchen.']
2025-01-22 20:23:08.315 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ™ğŸ¿\u200dâ™€ï¸', 'ğŸ‘¨ğŸ»\u200dğŸ¦±', 'ğŸ‘¨ğŸ¾\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘¨ğŸ½', 'ğŸ‘©ğŸ¾\u200dâ¤ï¸\u200dğŸ‘©ğŸ¾', 'ğŸ‘©ğŸ¿\u200dğŸ¤\u200dğŸ‘¨ğŸ»', 'ğŸ', 'âš—', 'ğŸ™', 'ğŸ§ğŸ»\u200dâ™‚', 'ğŸ¤¶ğŸ½']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.32s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.58s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.46s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.09s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.60s/it]
Processing depth (0, 1, 6, 7):   0%|          | 0/100 [00:16<?, ?it/s]2025-01-22 20:23:24.494 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the apple.
2025-01-22 20:23:24.539 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the hallway.
2025-01-22 20:23:24.544 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (836, 842) --> . Mary journeyed to the
2025-01-22 20:23:24.544 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary travelled to the office.
2025-01-22 20:23:24.574 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4657, 4662) --> . Mary travelled to the
2025-01-22 20:23:24.575 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra moved to the kitchen.
2025-01-22 20:23:24.605 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5629, 5634) --> . Sandra moved to the
2025-01-22 20:23:24.605 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel journeyed to the garden.
2025-01-22 20:23:24.622 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2864, 2870) --> . Daniel journeyed to the
2025-01-22 20:23:24.622 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the office.
2025-01-22 20:23:24.642 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3600, 3605) -->  Daniel went to the office
2025-01-22 20:23:24.642 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the kitchen.
2025-01-22 20:23:24.653 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2229, 2235) --> . John went back to the
2025-01-22 20:23:24.653 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went to the bathroom.
2025-01-22 20:23:24.667 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2869, 2874) -->  the garden. Daniel went
2025-01-22 20:23:24.667 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra travelled to the bathroom.
2025-01-22 20:23:24.683 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (2939, 2944) --> . Sandra travelled to the
2025-01-22 20:23:24.683 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel went to the office.
2025-01-22 20:23:24.699 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (2869, 2874) -->  the garden. Daniel went
2025-01-22 20:23:24.699 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Daniel went back to the hallway.
2025-01-22 20:23:24.733 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (6929, 6935) --> . Daniel went back to the
2025-01-22 20:23:24.734 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 20:23:24.734 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 20:23:24.734 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 20:23:24.734 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['â›¹ğŸ»\u200dâ™€', 'ğŸ‡²ğŸ‡³', 'ğŸ‘©ğŸ½\u200dâš•ï¸', 'ğŸ’š', 'âœ‹ğŸ¿', 'ğŸŒğŸ¼\u200dâ™€', 'ğŸ¦¹ğŸ¿\u200dâ™‚ï¸', 'ğŸ‡¨ğŸ‡²', 'ğŸ”', 'ğŸ•“']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.32s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.37s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.17s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.92s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.42s/it]
Processing depth (0, 3, 5, 8):   0%|          | 0/100 [00:31<?, ?it/s]2025-01-22 20:23:40.214 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the apple.
2025-01-22 20:23:40.255 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the hallway.
2025-01-22 20:23:40.276 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2966, 2972) -->  tragedy. Mary journeyed to
2025-01-22 20:23:40.276 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary travelled to the office.
2025-01-22 20:23:40.300 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4270, 4275) -->  Mary travelled to the office
2025-01-22 20:23:40.300 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra moved to the kitchen.
2025-01-22 20:23:40.335 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6675, 6680) --> . Sandra moved to the
2025-01-22 20:23:40.335 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel journeyed to the garden.
2025-01-22 20:23:40.352 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3013, 3019) -->  Daniel journeyed to the garden
2025-01-22 20:23:40.352 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the office.
2025-01-22 20:23:40.373 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3670, 3675) -->  Daniel went to the office
2025-01-22 20:23:40.373 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the kitchen.
2025-01-22 20:23:40.386 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2486, 2492) --> . John went back to the
2025-01-22 20:23:40.386 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went to the bathroom.
2025-01-22 20:23:40.400 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3017, 3022) -->  the garden. Daniel went
2025-01-22 20:23:40.401 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra travelled to the bathroom.
2025-01-22 20:23:40.416 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3107, 3112) --> . Sandra travelled to the
2025-01-22 20:23:40.416 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel went to the office.
2025-01-22 20:23:40.431 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (3017, 3022) -->  the garden. Daniel went
2025-01-22 20:23:40.431 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Daniel went back to the hallway.
2025-01-22 20:23:40.473 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (7015, 7021) --> . Daniel went back to the
2025-01-22 20:23:40.473 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 20:23:40.473 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 20:23:40.473 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 20:23:40.473 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ‘©ğŸ½\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘¨ğŸ»', 'ğŸš¶\u200dâ™‚', 'ğŸƒ', 'ğŸ™„', 'ğŸ‘©ğŸ¿\u200dâ¤\u200dğŸ’‹\u200dğŸ‘¨ğŸ¼', 'ğŸ™ğŸ»\u200dâ™‚ï¸', 'ğŸ§š', 'ğŸï¸', '\U0001fac4ğŸ¼', 'ğŸ‡µğŸ‡­']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.75s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.63s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.27s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  2.98s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.53s/it]
Processing depth (4, 5, 8, 9):   0%|          | 0/100 [00:47<?, ?it/s]2025-01-22 20:23:56.475 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the apple.
2025-01-22 20:23:56.495 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3584, 3588) -->  Mary got the apple
2025-01-22 20:23:56.496 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the hallway.
2025-01-22 20:23:56.516 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4156, 4162) --> . Mary journeyed to the
2025-01-22 20:23:56.516 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary travelled to the office.
2025-01-22 20:23:56.547 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6489, 6494) --> . Mary travelled to the
2025-01-22 20:23:56.547 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra moved to the kitchen.
2025-01-22 20:23:56.581 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7131, 7136) -->  Sandra moved to the kitchen
2025-01-22 20:23:56.581 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel journeyed to the garden.
2025-01-22 20:23:56.595 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2898, 2904) --> . Daniel journeyed to the
2025-01-22 20:23:56.596 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the office.
2025-01-22 20:23:56.613 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3589, 3594) -->  Daniel went to the office
2025-01-22 20:23:56.613 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the kitchen.
2025-01-22 20:23:56.624 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2220, 2226) -->  John went back to the kitchen
2025-01-22 20:23:56.624 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went to the bathroom.
2025-01-22 20:23:56.638 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2903, 2908) -->  the garden. Daniel went
2025-01-22 20:23:56.638 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra travelled to the bathroom.
2025-01-22 20:23:56.652 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (2967, 2972) --> . Sandra travelled to the
2025-01-22 20:23:56.652 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel went to the office.
2025-01-22 20:23:56.666 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (2903, 2908) -->  the garden. Daniel went
2025-01-22 20:23:56.666 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Daniel went back to the hallway.
2025-01-22 20:23:56.699 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (6823, 6829) --> . Daniel went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:23:57.523 | INFO     | test_jbb_embedding:begin_test:693 - Mary's hallway.<|eot_id|>
2025-01-22 20:23:57.523 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8168])
2025-01-22 20:23:59.738 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [421.796875, 35.00153744951658, 237.20394736842104, 33.1009336866757, 30.711665783898304], 'topk_indices': array([  14, 8149, 8022, 3585, 3584, 8159, 8162, 8166, 8153, 8152, 8155,
       8151, 3586, 8157, 3587, 8156, 8158,    0, 8164, 8163]), 'topk_tokens': ['\n', '.\n\n', ' context', ' got', ' Mary', '?', ':', '<|end_header_id|>', ' was', ' Where', ' apple', ':', ' the', ' the', ' apple', ' before', ' office', '<|begin_of_text|>', '<|start_header_id|>', '<|eot_id|>'], 'evidence_proportions': [1362.75, 242.97916666666666, 255.425, 49.9875]}, 'weight': {'score': [22.9328125, 23.25171911332762, 22.47738486842105, 23.25613213361272, 29.041313559322035], 'topk_indices': array([3346, 3319, 3239, 3191, 7421, 7459, 1467, 1405, 4344, 4328, 5171,
       5232, 7142, 7198, 3502, 3528, 5009, 4980, 4957, 4932]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.353515625, 20.052083333333332, 20.75625, 25.8296875]}, 'saliency': {'score': [2.597698974609375, 0.19416414867079457, 1.3528988486842106, 0.18281167546491742, 0.2208815752449682], 'topk_indices': array([8021, 2910,   24, 8149, 8151, 8159, 8066, 8153, 8150, 8161, 8022,
       3585, 3539, 3584, 8152, 4162, 8155, 8156, 8158, 3587]), 'topk_tokens': [' you', ' bathroom', '\n\n', '.\n\n', ':', '?', ' location', ' was', 'Question', 'Answer', ' context', ' got', ' Ramsey', ' Mary', ' Where', ' hallway', ' apple', ' before', ' office', ' apple'], 'evidence_proportions': [9.041015625, 1.232177734375, 1.34072265625, 0.3386474609375]}}, 'pred_res': "Mary's hallway.<|eot_id|>", 'score': 100}
2025-01-22 20:23:59.765 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:23:59.765 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-178_pid-0_4-5-8-9.pkl | len: 3 |  size: 2.0 KB
Processing depth (4, 5, 8, 9):   1%|          | 1/100 [00:51<1:24:43, 51.35s/it]is_0k: False
your chose emoji: ['ğŸ“®', 'ğŸ‘¨\u200dâš–ï¸', 'ğŸ¤¶ğŸ¼', 'ğŸ«‚', 'ğŸ˜²', 'ğŸ¤™ğŸ¾', 'ğŸ›¶', 'ğŸ§™ğŸ¾', 'ğŸ‘©ğŸ»\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘©ğŸ¾', 'ğŸ•˜']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.36s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.67s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.52s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.14s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.65s/it]
Processing depth (1, 3, 5, 8):   1%|          | 1/100 [01:07<1:24:43, 51.35s/it]2025-01-22 20:24:16.109 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the apple.
2025-01-22 20:24:16.113 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (838, 842) -->  Mary got the apple
2025-01-22 20:24:16.113 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the hallway.
2025-01-22 20:24:16.127 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2925, 2931) --> . Mary journeyed to the
2025-01-22 20:24:16.128 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary travelled to the office.
2025-01-22 20:24:16.148 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4284, 4289) -->  Mary travelled to the office
2025-01-22 20:24:16.148 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra moved to the kitchen.
2025-01-22 20:24:16.184 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6585, 6590) --> . Sandra moved to the
2025-01-22 20:24:16.184 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel journeyed to the garden.
2025-01-22 20:24:16.199 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2988, 2994) --> . Daniel journeyed to the
2025-01-22 20:24:16.199 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the office.
2025-01-22 20:24:16.217 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3680, 3685) -->  Daniel went to the office
2025-01-22 20:24:16.217 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the kitchen.
2025-01-22 20:24:16.229 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2438, 2444) --> . John went back to the
2025-01-22 20:24:16.229 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went to the bathroom.
2025-01-22 20:24:16.245 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2993, 2998) -->  the garden. Daniel went
2025-01-22 20:24:16.246 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra travelled to the bathroom.
2025-01-22 20:24:16.267 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3058, 3063) -->  tragedy. Sandra travelled to
2025-01-22 20:24:16.267 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel went to the office.
2025-01-22 20:24:16.283 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (2993, 2998) -->  the garden. Daniel went
2025-01-22 20:24:16.283 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Daniel went back to the hallway.
2025-01-22 20:24:16.316 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (6887, 6893) --> . Daniel went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:24:17.161 | INFO     | test_jbb_embedding:begin_test:693 - Mary's kitchen.<|eot_id|>
2025-01-22 20:24:17.161 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8226])
2025-01-22 20:24:19.400 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [254.3953125, 24.62758043200875, 83.71751644736842, 23.790379084567373, 16.561201615767047], 'topk_indices': array([8212, 8224, 8210,    9, 8216, 8209, 8211, 2931,   24, 8079,   14,
        842, 8124, 8213,  841, 8080, 8214,    0, 8221, 8222]), 'topk_tokens': [' the', '<|end_header_id|>', ' Where', ':', ' office', ':', ' was', ' hallway', '\n\n', ' you', '\n', '.', ' location', ' apple', ' apple', ' context', ' before', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [654.9375, 234.08333333333334, 126.65, 86.08125]}, 'weight': {'score': [22.7390625, 23.30105040102078, 22.61143092105263, 23.305633107942725, 29.439808238636363], 'topk_indices': array([3368, 3341, 3213, 3261, 7479, 7517, 1532, 1470, 4400, 4384, 5199,
       5260, 7256, 7200, 3524, 3550, 5024, 5053, 4976, 5001]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.353515625, 20.052083333333332, 24.7703125, 21.040625]}, 'saliency': {'score': [1.5622314453125, 0.13647328913465337, 0.4587378250925164, 0.13148476686198712, 0.1198618628761985], 'topk_indices': array([   8, 8195,  843,   24, 8123, 8219,  838, 8211,  839, 8208, 8078,
       8079, 8210, 8216, 8124, 8213, 8214, 2931, 8080,  841]), 'topk_tokens': [' Date', ' return', ' Paul', '\n\n', ' first', 'Answer', ' Mary', ' was', ' got', 'Question', ' provided', ' you', ' Where', ' office', ' location', ' apple', ' before', ' hallway', ' context', ' apple'], 'evidence_proportions': [4.456787109375, 1.1947021484375, 0.77099609375, 0.478857421875]}}, 'pred_res': "Mary's kitchen.<|eot_id|>", 'score': 0}
2025-01-22 20:24:19.408 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:24:19.409 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-178_pid-1_1-3-5-8.pkl | len: 3 |  size: 2.02 KB
Processing depth (1, 3, 5, 8):   2%|â–         | 2/100 [01:10<53:24, 32.70s/it]  is_0k: False
your chose emoji: ['â˜”', 'ğŸ‡²ğŸ‡³', 'ğŸ§•ğŸ½', 'ğŸ§‘ğŸ½\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ§‘ğŸ»', 'ğŸ‡­ğŸ‡²', 'ğŸ§ğŸ½\u200dâ™€ï¸\u200dâ¡', 'ğŸ‘©ğŸ¿\u200dğŸ¦¯\u200dâ¡ï¸', 'ğŸ§‘ğŸ¾\u200dğŸ¦¼\u200dâ¡ï¸', 'ğŸ§šğŸ¼', 'ğŸ§Ÿ']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  3.97s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.24s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.22s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.99s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.43s/it]
Processing depth (2, 3, 5, 7):   2%|â–         | 2/100 [01:26<53:24, 32.70s/it]2025-01-22 20:24:34.886 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the apple.
2025-01-22 20:24:34.898 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1860, 1864) -->  Mary got the apple
2025-01-22 20:24:34.898 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the hallway.
2025-01-22 20:24:34.915 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2945, 2951) --> . Mary journeyed to the
2025-01-22 20:24:34.916 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary travelled to the office.
2025-01-22 20:24:34.936 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4232, 4237) -->  Mary travelled to the office
2025-01-22 20:24:34.937 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra moved to the kitchen.
2025-01-22 20:24:34.963 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5615, 5620) --> . Sandra moved to the
2025-01-22 20:24:34.964 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel journeyed to the garden.
2025-01-22 20:24:34.979 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2959, 2965) -->  Daniel journeyed to the garden
2025-01-22 20:24:34.979 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the office.
2025-01-22 20:24:34.999 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3650, 3655) -->  Daniel went to the office
2025-01-22 20:24:34.999 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the kitchen.
2025-01-22 20:24:35.013 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2482, 2488) --> . John went back to the
2025-01-22 20:24:35.013 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went to the bathroom.
2025-01-22 20:24:35.028 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2963, 2968) -->  the garden. Daniel went
2025-01-22 20:24:35.028 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra travelled to the bathroom.
2025-01-22 20:24:35.045 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3028, 3033) -->  tragedy. Sandra travelled to
2025-01-22 20:24:35.046 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel went to the office.
2025-01-22 20:24:35.062 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (2963, 2968) -->  the garden. Daniel went
2025-01-22 20:24:35.062 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Daniel went back to the hallway.
2025-01-22 20:24:35.098 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (6811, 6817) --> . Daniel went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:24:35.944 | INFO     | test_jbb_embedding:begin_test:693 - Mary's house.<|eot_id|>
2025-01-22 20:24:35.944 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8150])
2025-01-22 20:24:38.156 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [355.8078125, 30.96778409787808, 137.79502467105263, 29.66374015596047, 37.244296875], 'topk_indices': array([2948, 8038,   14, 8132, 8003, 1863,   24, 8131, 8141, 8133, 8143,
       8148, 8004, 8138, 8048, 8144, 2951, 8146,    0, 8145]), 'topk_tokens': ['ed', '.\n\n', '\n', 'Question', ' you', ' apple', '\n\n', '.\n\n', '?', ':', 'Answer', '<|end_header_id|>', ' context', ' before', ' location', ':', ' hallway', '<|start_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [694.25, 501.7916666666667, 185.4625, 80.21875]}, 'weight': {'score': [22.7390625, 23.243658392616215, 23.205386513157894, 23.245084735948115, 29.42625], 'topk_indices': array([3338, 3311, 3231, 3183, 7441, 7403, 1423, 1485, 4308, 4324, 5208,
       5147, 7124, 7180, 3520, 3494, 4972, 5001, 4949, 4924]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.353515625, 20.052083333333332, 24.7703125, 21.040625]}, 'saliency': {'score': [2.15386962890625, 0.1740888850346498, 0.8014317562705592, 0.16625261029908509, 0.27543045043945313], 'topk_indices': array([8142, 8119, 8134, 8144,   24, 8003, 8131, 8141, 1861, 8140, 1860,
       2947, 8137, 8132, 8138, 1863, 8048, 8004, 8143, 2951]), 'topk_tokens': [' \n', ' return', ' Where', ':', '\n\n', ' you', '.\n\n', '?', ' got', ' office', ' Mary', ' journey', ' apple', 'Question', ' before', ' apple', ' location', ' context', 'Answer', ' hallway'], 'evidence_proportions': [4.65869140625, 2.695068359375, 1.21015625, 0.444287109375]}}, 'pred_res': "Mary's house.<|eot_id|>", 'score': 0}
2025-01-22 20:24:38.163 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:24:38.164 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-178_pid-2_2-3-5-7.pkl | len: 3 |  size: 2.0 KB
Processing depth (2, 3, 5, 7):   3%|â–         | 3/100 [01:29<42:34, 26.33s/it]is_0k: False
your chose emoji: ['ğŸš¶ğŸ¾\u200dâ™€ï¸\u200dâ¡', 'â„¹', 'ğŸ¯', 'ğŸŒ‘', 'ğŸ‘™', 'ğŸ™‰', 'ğŸ§ğŸ¼\u200dâ™€ï¸', 'ğŸ‘·ğŸ¾\u200dâ™‚', 'âš–', 'ğŸŸ§']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.04s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.42s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.31s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.00s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.47s/it]
Processing depth (2, 4, 6, 8):   3%|â–         | 3/100 [01:45<42:34, 26.33s/it]2025-01-22 20:24:54.192 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the apple.
2025-01-22 20:24:54.202 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1790, 1794) -->  Mary got the apple
2025-01-22 20:24:54.202 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the hallway.
2025-01-22 20:24:54.224 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3626, 3632) --> . Mary journeyed to the
2025-01-22 20:24:54.224 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary travelled to the office.
2025-01-22 20:24:54.247 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4657, 4662) --> . Mary travelled to the
2025-01-22 20:24:54.248 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra moved to the kitchen.
2025-01-22 20:24:54.279 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6543, 6548) --> . Sandra moved to the
2025-01-22 20:24:54.279 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel journeyed to the garden.
2025-01-22 20:24:54.295 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2935, 2941) --> . Daniel journeyed to the
2025-01-22 20:24:54.295 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the office.
2025-01-22 20:24:54.316 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3634, 3639) -->  Daniel went to the office
2025-01-22 20:24:54.316 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the kitchen.
2025-01-22 20:24:54.328 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2398, 2404) --> . John went back to the
2025-01-22 20:24:54.328 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went to the bathroom.
2025-01-22 20:24:54.342 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2940, 2945) -->  the garden. Daniel went
2025-01-22 20:24:54.342 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra travelled to the bathroom.
2025-01-22 20:24:54.356 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3005, 3010) -->  tragedy. Sandra travelled to
2025-01-22 20:24:54.356 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel went to the office.
2025-01-22 20:24:54.372 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (2940, 2945) -->  the garden. Daniel went
2025-01-22 20:24:54.372 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Daniel went back to the hallway.
2025-01-22 20:24:54.393 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (3630, 3636) -->  to the hallway. Daniel went
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:24:55.236 | INFO     | test_jbb_embedding:begin_test:693 - Mary got the apple.<|eot_id|>
2025-01-22 20:24:55.236 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8178])
2025-01-22 20:24:57.448 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [210.515625, 22.58770321476592, 129.65625, 21.62412286101194, 15.650238037109375], 'topk_indices': array([8177, 8159,    1, 8032, 8066,    9, 3632, 8172, 8161, 8076,    3,
       8176,   24, 8168, 8174, 8166,   14, 1793,    0, 8173]), 'topk_tokens': ['\n\n', '.\n\n', '<|start_header_id|>', ' context', '.\n\n', ':', ' hallway', ':', ':', ' location', '<|end_header_id|>', '<|end_header_id|>', '\n\n', ' office', '<|start_header_id|>', ' before', '\n', ' apple', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [586.625, 174.60416666666666, 88.675, 74.5625]}, 'weight': {'score': [21.735546875, 23.266220892922625, 22.950657894736842, 23.27146586082728, 29.515869140625], 'topk_indices': array([3288, 3315, 3208, 3160, 7431, 7469, 1425, 1487, 4330, 4314, 5161,
       5222, 7146, 7202, 3493, 3519, 4938, 4963, 4986, 5015]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.353515625, 20.052083333333332, 20.75625, 21.040625]}, 'saliency': {'score': [1.27647705078125, 0.12545814043209877, 0.7847193667763158, 0.11954009232080204, 0.11539590358734131], 'topk_indices': array([8161, 8075,   14,   20, 8159, 8175, 8066,   24, 8162, 1791, 8160,
       8171, 1790, 8032, 8165, 8076, 8166, 8168, 3632, 1793]), 'topk_tokens': [':', ' first', '\n', ' Jul', '.\n\n', 'assistant', '.\n\n', '\n\n', ' Where', ' got', 'Question', 'Answer', ' Mary', ' context', ' apple', ' location', ' before', ' office', ' hallway', ' apple'], 'evidence_proportions': [3.99169921875, 0.8506266276041666, 0.4833251953125, 0.4084716796875]}}, 'pred_res': 'Mary got the apple.<|eot_id|>', 'score': 0}
2025-01-22 20:24:57.455 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:24:57.456 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-178_pid-3_2-4-6-8.pkl | len: 3 |  size: 2.03 KB
Processing depth (2, 4, 6, 8):   4%|â–         | 4/100 [01:49<37:41, 23.55s/it]is_0k: False
your chose emoji: ['ğŸ¦¹ğŸ¼\u200dâ™‚ï¸', 'ğŸ“„', 'ğŸ‘¨\u200dğŸ‘©\u200dğŸ‘¦', 'ğŸ–', 'ğŸ§‘ğŸ»\u200dâ¤\u200dğŸ§‘ğŸ¾', 'ğŸµ', 'ğŸ‡µğŸ‡±', 'ğŸ§œ\u200dâ™‚ï¸', 'â˜˜ï¸', 'ğŸ™']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  3.84s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.43s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.46s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.11s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.56s/it]
Processing depth (2, 3, 6, 8):   4%|â–         | 4/100 [02:04<37:41, 23.55s/it]2025-01-22 20:25:13.455 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the apple.
2025-01-22 20:25:13.464 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1856, 1860) -->  Mary got the apple
2025-01-22 20:25:13.465 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the hallway.
2025-01-22 20:25:13.481 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2980, 2986) -->  tragedy. Mary journeyed to
2025-01-22 20:25:13.481 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary travelled to the office.
2025-01-22 20:25:13.506 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4789, 4794) -->  the senate. Mary travelled
2025-01-22 20:25:13.509 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra moved to the kitchen.
2025-01-22 20:25:13.543 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6613, 6618) --> . Sandra moved to the
2025-01-22 20:25:13.544 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel journeyed to the garden.
2025-01-22 20:25:13.562 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3070, 3076) --> . Daniel journeyed to the
2025-01-22 20:25:13.562 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the office.
2025-01-22 20:25:13.581 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3662, 3667) -->  Daniel went to the office
2025-01-22 20:25:13.581 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the kitchen.
2025-01-22 20:25:13.594 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2478, 2484) --> . John went back to the
2025-01-22 20:25:13.594 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went to the bathroom.
2025-01-22 20:25:13.609 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3075, 3080) -->  the garden. Daniel went
2025-01-22 20:25:13.609 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra travelled to the bathroom.
2025-01-22 20:25:13.624 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3120, 3125) -->  ranks. Sandra travelled to
2025-01-22 20:25:13.624 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel went to the office.
2025-01-22 20:25:13.643 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (3075, 3080) -->  the garden. Daniel went
2025-01-22 20:25:13.643 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Daniel went back to the hallway.
2025-01-22 20:25:13.677 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (6924, 6930) -->  Daniel went back to the hallway
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:25:14.531 | INFO     | test_jbb_embedding:begin_test:693 - Mary's home.<|eot_id|>
2025-01-22 20:25:14.532 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8172])
2025-01-22 20:25:16.754 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [313.33828125, 30.694791666666667, 106.02754934210526, 29.64569537698657, 22.68599513319672], 'topk_indices': array([8159, 2984, 8026, 8154, 8060, 1859,   24, 2983, 8163, 8153, 8165,
       8162, 8155, 8160, 8070, 8166, 2987, 8168, 8167,    0]), 'topk_tokens': [' apple', 'ed', ' context', 'Question', '.\n\n', ' apple', '\n\n', ' journey', '?', '.\n\n', 'Answer', ' office', ':', ' before', ' location', ':', ' hallway', '<|start_header_id|>', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [683.25, 455.0104166666667, 48.234375, 112.50625]}, 'weight': {'score': [24.36953125, 23.256129587155964, 23.282689144736842, 23.253261865529137, 29.14702868852459], 'topk_indices': array([3310, 3283, 3203, 3155, 7453, 7415, 1481, 1419, 4314, 4330, 5208,
       5147, 7136, 7192, 3512, 3486, 4916, 4972, 5001, 4941]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.353515625, 24.891927083333332, 25.484375, 21.040625]}, 'saliency': {'score': [1.9322097778320313, 0.17263809250764525, 0.6214695980674342, 0.16620135098765515, 0.16845853211449796], 'topk_indices': array([8060, 8155,   24, 8166, 8069, 8156, 1857, 8163, 8153, 1856, 8026,
       8159, 8154, 1859, 2983, 8162, 8160, 8165, 8070, 2987]), 'topk_tokens': ['.\n\n', ':', '\n\n', ':', ' first', ' Where', ' got', '?', '.\n\n', ' Mary', ' context', ' apple', 'Question', ' apple', ' journey', ' office', ' before', 'Answer', ' location', ' hallway'], 'evidence_proportions': [4.492919921875, 2.6512044270833335, 0.323858642578125, 0.62919921875]}}, 'pred_res': "Mary's home.<|eot_id|>", 'score': 0}
2025-01-22 20:25:16.762 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:25:16.763 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-178_pid-4_2-3-6-8.pkl | len: 3 |  size: 1.99 KB
Processing depth (2, 3, 6, 8):   5%|â–Œ         | 5/100 [02:08<34:52, 22.02s/it]Processing depth (2, 3, 6, 8):   5%|â–Œ         | 5/100 [02:08<40:39, 25.68s/it]
2025-01-22 20:25:16.822 | INFO     | __main__:<module>:82 - Selected idx: 180
2025-01-22 20:25:16.822 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the apple before the office? 
2025-01-22 20:25:16.822 | INFO     | __main__:<module>:84 - Answer: bedroom
2025-01-22 20:25:16.822 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 20:25:16.823 | INFO     | __main__:<module>:86 - Needle: [' Mary grabbed the milk.', ' Daniel took the apple there.', ' Daniel moved to the bedroom.', ' Mary journeyed to the bathroom.', ' Mary got the football.', ' Mary discarded the milk.', ' Mary discarded the football.', ' Mary took the football.', ' Daniel journeyed to the office.', ' Sandra went to the kitchen.']
2025-01-22 20:25:16.823 | INFO     | __main__:<module>:87 - Real Needle: [' Daniel took the apple there.', ' Daniel moved to the bedroom.', ' Daniel journeyed to the office.', ' Sandra went to the kitchen.']
2025-01-22 20:25:16.823 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ¥§', 'ğŸ–‹ï¸', 'ğŸ', '\U0001fa7c', 'ğŸ§‘ğŸ¿\u200dğŸ”§', 'ğŸ‘©ğŸ¾\u200dğŸ¦²', 'ğŸ–±ï¸', 'ğŸ‘¨ğŸ¿\u200dğŸ­', 'ğŸ™…ğŸ½\u200dâ™‚', 'ğŸ¦¸\u200dâ™€']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  3.78s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.08s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.27s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.98s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.39s/it]
Processing depth (2, 3, 5, 8):   0%|          | 0/100 [00:15<?, ?it/s]2025-01-22 20:25:32.084 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel took the apple there.
2025-01-22 20:25:32.093 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1852, 1857) --> . Daniel took the apple
2025-01-22 20:25:32.093 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the bedroom.
2025-01-22 20:25:32.108 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2935, 2940) --> . Daniel moved to the
2025-01-22 20:25:32.108 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel journeyed to the office.
2025-01-22 20:25:32.129 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4215, 4221) -->  Daniel journeyed to the office
2025-01-22 20:25:32.129 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the kitchen.
2025-01-22 20:25:32.161 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6547, 6552) --> . Sandra went to the
2025-01-22 20:25:32.161 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the milk.
2025-01-22 20:25:32.179 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3816, 3820) -->  Mary grabbed the milk
2025-01-22 20:25:32.179 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the bathroom.
2025-01-22 20:25:32.184 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (895, 901) --> . Mary journeyed to the
2025-01-22 20:25:32.184 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary got the football.
2025-01-22 20:25:32.216 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6554, 6558) -->  Mary got the football
2025-01-22 20:25:32.216 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary discarded the milk.
2025-01-22 20:25:32.226 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1859, 1863) -->  Mary discarded the milk
2025-01-22 20:25:32.226 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary discarded the football.
2025-01-22 20:25:32.242 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (2694, 2698) -->  Mary discarded the football
2025-01-22 20:25:32.243 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary took the football.
2025-01-22 20:25:32.255 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (2697, 2701) -->  football. Mary took
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:25:33.010 | INFO     | test_jbb_embedding:begin_test:693 - the bedroom<|eot_id|>
2025-01-22 20:25:33.010 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8190])
2025-01-22 20:25:35.256 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [310.59375, 20.913521832662028, 127.04567307692308, 19.827992649766756, 8.622777035361842], 'topk_indices': array([8171, 8188, 8172,  901, 8173, 8180, 8184, 1854, 8177, 8181, 1852,
       8178, 1857, 8044, 8088, 2940, 1856, 1853,    0, 8185]), 'topk_tokens': ['.\n\n', '<|end_header_id|>', 'Question', ' bathroom', ':', ' office', ':', ' took', ' apple', '?', '.', ' before', ' there', ' context', ' location', ' bedroom', ' apple', ' Daniel', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [758.0, 342.85, 150.08333333333334, 23.54375]}, 'weight': {'score': [21.959449404761905, 23.299459141950447, 25.94501201923077, 23.29446967836975, 30.03782894736842], 'topk_indices': array([3275, 3302, 3195, 3147, 7421, 7459, 1468, 1406, 4318, 4334, 5167,
       5228, 7198, 7142, 3464, 3490, 5021, 4969, 4944, 4992]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [23.184375, 19.909375, 23.615885416666668, 20.796875]}, 'saliency': {'score': [1.8099873860677083, 0.1181058358697974, 0.7727954571063702, 0.11165463985871132, 0.06454799049778988], 'topk_indices': array([8171, 2934,  897, 2936, 8174, 8181, 2908, 8183, 1854, 1857, 8180,
       8172, 8178, 8177, 8044, 8088,  901, 2940, 1856, 1853]), 'topk_tokens': ['.\n\n', ' Gov', ' journey', ' Daniel', ' Where', '?', ' During', 'Answer', ' took', ' there', ' office', 'Question', ' before', ' apple', ' context', ' location', ' bathroom', ' bedroom', ' apple', ' Daniel'], 'evidence_proportions': [4.753515625, 1.65439453125, 0.8763427734375, 0.142425537109375]}}, 'pred_res': 'the bedroom<|eot_id|>', 'score': 100}
2025-01-22 20:25:35.263 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:25:35.264 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-180_pid-0_2-3-5-8.pkl | len: 3 |  size: 2.02 KB
Processing depth (2, 3, 5, 8):   1%|          | 1/100 [00:18<30:16, 18.35s/it]is_0k: False
your chose emoji: ['ğŸš¶ğŸ¿\u200dâ™€ï¸\u200dâ¡ï¸', 'ğŸ‘·ğŸ»\u200dâ™€', 'âœğŸ½', 'ğŸ‡ğŸ»', 'ğŸ•¢', 'â†•ï¸', 'ğŸ–', 'ğŸ™ğŸ½\u200dâ™‚ï¸', 'ğŸ§‘ğŸ½\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ§‘ğŸ¾', 'ğŸš´\u200dâ™‚']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.43s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.62s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.22s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.72s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.34s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (2, 3, 4, 6):   1%|          | 1/100 [00:33<30:16, 18.35s/it]2025-01-22 20:25:50.486 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel took the apple there.
2025-01-22 20:25:50.495 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1854, 1859) --> . Daniel took the apple
2025-01-22 20:25:50.495 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the bedroom.
2025-01-22 20:25:50.510 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2988, 2993) -->  tragedy. Daniel moved to
2025-01-22 20:25:50.510 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel journeyed to the office.
2025-01-22 20:25:50.528 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3618, 3624) -->  Daniel journeyed to the office
2025-01-22 20:25:50.528 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the kitchen.
2025-01-22 20:25:50.551 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4763, 4768) -->  the senate. Sandra went
2025-01-22 20:25:50.551 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the milk.
2025-01-22 20:25:50.569 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3819, 3823) -->  Mary grabbed the milk
2025-01-22 20:25:50.570 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the bathroom.
2025-01-22 20:25:50.574 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (895, 901) --> . Mary journeyed to the
2025-01-22 20:25:50.574 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary got the football.
2025-01-22 20:25:50.605 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6607, 6611) -->  got the football.
2025-01-22 20:25:50.606 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary discarded the milk.
2025-01-22 20:25:50.614 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1861, 1865) -->  Mary discarded the milk
2025-01-22 20:25:50.614 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary discarded the football.
2025-01-22 20:25:50.628 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (2804, 2808) -->  Mary discarded the football
2025-01-22 20:25:50.628 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary took the football.
2025-01-22 20:25:50.641 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (2807, 2811) -->  football. Mary took
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:25:53.043 | INFO     | test_jbb_embedding:begin_test:693 - the bedroom<|eot_id|>
2025-01-22 20:25:53.043 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8190])
2025-01-22 20:25:55.830 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [231.70182291666666, 16.601077139021115, 107.9813701923077, 15.75489456098085, 12.681139494243421], 'topk_indices': array([2991, 2992, 8176, 8186, 8172, 8173, 8171, 8177, 8181, 8180, 8088,
       8184, 1859, 1855, 8178, 8188, 2994, 1858, 8185,    0]), 'topk_tokens': [' moved', ' to', ' the', '<|start_header_id|>', 'Question', ':', '.\n\n', ' apple', '?', ' office', ' location', ':', ' there', ' Daniel', ' before', '<|end_header_id|>', ' bedroom', ' apple', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [512.3, 263.71875, 150.79166666666666, 16.17890625]}, 'weight': {'score': [24.468005952380953, 23.276720599902355, 25.05528846153846, 23.267972778050577, 28.812294407894736], 'topk_indices': array([3312, 3285, 3191, 3143, 7409, 7447, 1418, 1480, 4296, 4312, 5113,
       5174, 7186, 7130, 3506, 3480, 4915, 4967, 4938, 4890]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [23.184375, 25.7171875, 23.615885416666668, 25.525]}, 'saliency': {'score': [1.3944182623000372, 0.09324833169082983, 0.6851783165564904, 0.0880046847292167, 0.09063108343827098], 'topk_indices': array([ 897, 8175, 8087, 1856, 8171, 8181, 8044, 8174, 2991, 8183,  901,
       1859, 8180, 8088, 8172, 8178, 8177, 1855, 1858, 2994]), 'topk_tokens': [' journey', ' was', ' first', ' took', '.\n\n', '?', ' context', ' Where', ' moved', 'Answer', ' bathroom', ' there', ' office', ' location', 'Question', ' before', ' apple', ' Daniel', ' apple', ' bedroom'], 'evidence_proportions': [3.21689453125, 1.448583984375, 0.89404296875, 0.11822662353515626]}}, 'pred_res': 'the bedroom<|eot_id|>', 'score': 100}
2025-01-22 20:25:55.839 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:25:55.839 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-180_pid-1_2-3-4-6.pkl | len: 3 |  size: 2.03 KB
Processing depth (2, 3, 4, 6):   2%|â–         | 2/100 [00:38<32:06, 19.66s/it]is_0k: False
your chose emoji: ['ğŸ‘©ğŸ¾\u200dğŸ¤\u200dğŸ‘¨ğŸ»', 'â–¶', 'ğŸ§ğŸ¿', 'ğŸ‘«ğŸ¾', 'ğŸ¨', 'ğŸ§šğŸ¿', 'ğŸ‘¨\u200dğŸ¦²', 'ğŸŒ†', 'ğŸ‘©ğŸ¾\u200dâš•', 'ğŸ§‘ğŸ¿\u200dğŸ¤\u200dğŸ§‘ğŸ½']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.68s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.75s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.43s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.06s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.62s/it]
Processing depth (1, 2, 7, 8):   2%|â–         | 2/100 [00:55<32:06, 19.66s/it]2025-01-22 20:26:12.067 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel took the apple there.
2025-01-22 20:26:12.071 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (827, 832) --> . Daniel took the apple
2025-01-22 20:26:12.071 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the bedroom.
2025-01-22 20:26:12.080 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1774, 1779) --> . Daniel moved to the
2025-01-22 20:26:12.080 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel journeyed to the office.
2025-01-22 20:26:12.108 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5808, 5814) --> . Daniel journeyed to the
2025-01-22 20:26:12.109 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the kitchen.
2025-01-22 20:26:12.140 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6651, 6656) --> . Sandra went to the
2025-01-22 20:26:12.140 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the milk.
2025-01-22 20:26:12.159 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3854, 3858) -->  Mary grabbed the milk
2025-01-22 20:26:12.159 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the bathroom.
2025-01-22 20:26:12.163 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (833, 839) --> . Mary journeyed to the
2025-01-22 20:26:12.163 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary got the football.
2025-01-22 20:26:12.195 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6658, 6662) -->  Mary got the football
2025-01-22 20:26:12.195 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary discarded the milk.
2025-01-22 20:26:12.204 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1781, 1785) -->  Mary discarded the milk
2025-01-22 20:26:12.204 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary discarded the football.
2025-01-22 20:26:12.216 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (2594, 2598) -->  Mary discarded the football
2025-01-22 20:26:12.216 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary took the football.
2025-01-22 20:26:12.228 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (2597, 2601) -->  football. Mary took
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:26:13.628 | INFO     | test_jbb_embedding:begin_test:693 - There is no information about the apple before the office. However, it is mentioned that Daniel took the apple there.<|eot_id|>
2025-01-22 20:26:13.629 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8202])
2025-01-22 20:26:15.862 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [329.11011904761904, 26.103823887873247, 110.39423076923077, 25.055198884530522, 19.746617759146343], 'topk_indices': array([8055, 8051,   14, 8090, 8196, 1779,  830, 8190,   24, 8100, 8189,
       8185,  828,  829, 8056, 8198,  832,  831,    0, 8197]), 'topk_tokens': [' you', '\n', '\n', '.\n\n', ':', ' bedroom', ' the', ' before', '\n\n', ' location', ' apple', ':', ' Daniel', ' took', ' context', '<|start_header_id|>', ' there', ' apple', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [906.6, 260.875, 140.48958333333334, 46.2]}, 'weight': {'score': [21.003720238095237, 23.2965017519805, 25.94501201923077, 23.29396278959304, 29.3969131097561], 'topk_indices': array([3319, 3346, 3239, 3191, 7409, 7447, 1472, 1534, 4319, 4303, 5120,
       5181, 7112, 7168, 3502, 3528, 4945, 4897, 4974, 4922]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [23.184375, 19.909375, 20.270833333333332, 20.796875]}, 'saliency': {'score': [1.9594508579799108, 0.14705720537686623, 0.6377422626201923, 0.14082797294330526, 0.14746726431497714], 'topk_indices': array([8090, 8096,   35,   24,  839, 8054, 8186, 8192, 8195, 8190, 8184,
        275, 8100, 8189,  829, 1779,  828, 8056,  832,  831]), 'topk_tokens': ['.\n\n', ' item', '-text', '\n\n', ' bathroom', ' provided', ' Where', ' office', 'Answer', ' before', 'Question', 'hue', ' location', ' apple', ' took', ' bedroom', ' Daniel', ' context', ' there', ' apple'], 'evidence_proportions': [5.759765625, 1.321826171875, 0.7218831380208334, 0.281842041015625]}}, 'pred_res': 'There is no information about the apple before the office. However, it is mentioned that Daniel took the apple there.<|eot_id|>', 'score': 0}
2025-01-22 20:26:15.870 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:26:15.871 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-180_pid-2_1-2-7-8.pkl | len: 3 |  size: 2.11 KB
Processing depth (1, 2, 7, 8):   3%|â–         | 3/100 [00:58<32:03, 19.83s/it]is_0k: False
your chose emoji: ['ğŸ‘©\u200dğŸ‘©\u200dğŸ‘¦', 'ğŸ’‘ğŸ¿', 'ğŸ§¨', 'ğŸ‡µğŸ‡·', 'ğŸ‘©ğŸ¼\u200dâ¤ï¸\u200dğŸ‘¨ğŸ¼', 'ğŸ¦¹ğŸ¿\u200dâ™‚', 'ğŸšµğŸ»\u200dâ™‚ï¸', 'ğŸ§›ğŸ¾\u200dâ™‚', 'â³', 'ğŸ‘©ğŸ½\u200dğŸŒ¾']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.36s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.57s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.45s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.10s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.60s/it]
Processing depth (0, 2, 4, 9):   3%|â–         | 3/100 [01:15<32:03, 19.83s/it]2025-01-22 20:26:32.091 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel took the apple there.
2025-01-22 20:26:32.091 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  took the apple there.
2025-01-22 20:26:32.092 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the bedroom.
2025-01-22 20:26:32.102 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1854, 1859) --> . Daniel moved to the
2025-01-22 20:26:32.102 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel journeyed to the office.
2025-01-22 20:26:32.121 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3626, 3632) -->  Daniel journeyed to the office
2025-01-22 20:26:32.121 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the kitchen.
2025-01-22 20:26:32.158 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7137, 7142) -->  Sandra went to the kitchen
2025-01-22 20:26:32.158 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the milk.
2025-01-22 20:26:32.177 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3827, 3831) -->  Mary grabbed the milk
2025-01-22 20:26:32.177 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the bathroom.
2025-01-22 20:26:32.181 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (821, 827) --> . Mary journeyed to the
2025-01-22 20:26:32.181 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary got the football.
2025-01-22 20:26:32.212 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6511, 6515) -->  got the football.
2025-01-22 20:26:32.212 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary discarded the milk.
2025-01-22 20:26:32.221 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1861, 1865) -->  Mary discarded the milk
2025-01-22 20:26:32.221 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary discarded the football.
2025-01-22 20:26:32.235 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (2710, 2714) -->  Mary discarded the football
2025-01-22 20:26:32.236 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary took the football.
2025-01-22 20:26:32.251 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (2713, 2717) -->  football. Mary took
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:26:32.962 | INFO     | test_jbb_embedding:begin_test:693 - there<|eot_id|>
2025-01-22 20:26:32.962 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8174])
2025-01-22 20:26:35.176 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [543.3556547619048, 35.37765225632873, 113.56911057692308, 33.815473170356704, 32.63275505514706], 'topk_indices': array([7379,   73, 1856, 8165, 7302, 8168,   24,   31, 8164,   36,   74,
         33,   38, 8162, 7380,  111, 8170, 8169,   34,    0]), 'topk_tokens': [' Min', 'ION', ' moved', '?', 'nes', ':', '\n\n', ' took', ' office', 'ï¿½', 'E', ' apple', 'ï¿½', ' before', 'nes', 'ION', '<|start_header_id|>', '<|eot_id|>', ' there', '<|begin_of_text|>'], 'evidence_proportions': [1270.4, 594.65, 309.6875, 45.41875]}, 'weight': {'score': [22.660714285714285, 23.27648243548979, 25.05528846153846, 23.27238430196802, 29.436810661764707], 'topk_indices': array([3332, 3305, 3177, 3225, 7427, 7465, 1480, 1418, 4344, 4328, 5139,
       5200, 7204, 7148, 3514, 3488, 4916, 4993, 4941, 4964]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.340625, 19.909375, 23.615885416666668, 25.5859375]}, 'saliency': {'score': [3.0771542503720237, 0.19998079001123578, 0.6641505314753606, 0.19106454696749117, 0.24205667832318475], 'topk_indices': array([1859, 7331,   42,   74, 8167,   73, 8156, 8161, 1856, 7379, 7302,
         31, 8164,   38, 8162,   36,   33,  111, 7380,   34]), 'topk_tokens': [' bedroom', 'nes', ' PA', 'E', 'Answer', 'ION', 'Question', ' apple', ' moved', ' Min', 'nes', ' took', ' office', 'ï¿½', ' before', 'ï¿½', ' apple', 'ION', 'nes', ' there'], 'evidence_proportions': [7.29921875, 3.0837890625, 1.8611653645833333, 0.3076416015625]}}, 'pred_res': 'there<|eot_id|>', 'score': 0}
2025-01-22 20:26:35.183 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:26:35.183 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-180_pid-3_0-2-4-9.pkl | len: 3 |  size: 1.96 KB
Processing depth (0, 2, 4, 9):   4%|â–         | 4/100 [01:18<31:24, 19.63s/it]is_0k: False
your chose emoji: ['â„¢ï¸', 'ğŸ’€', 'ğŸƒ', 'ğŸ‘¨ğŸ¿\u200dğŸš’', '\U0001faf1ğŸ¿\u200d\U0001faf2ğŸ½', 'ğŸ‘¨\u200dğŸ¦¯\u200dâ¡ï¸', 'ğŸ‘±ğŸ¿\u200dâ™€ï¸', 'ğŸ’ğŸ¾', 'ğŸ‘©ğŸ¿\u200dğŸ¦³', '\U0001fae1']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  3.86s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.24s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.19s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.97s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.40s/it]
Processing depth (0, 1, 2, 5):   4%|â–         | 4/100 [01:33<31:24, 19.63s/it]2025-01-22 20:26:50.495 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel took the apple there.
2025-01-22 20:26:50.495 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  took the apple there.
2025-01-22 20:26:50.495 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the bedroom.
2025-01-22 20:26:50.500 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (901, 906) --> . Daniel moved to the
2025-01-22 20:26:50.500 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel journeyed to the office.
2025-01-22 20:26:50.512 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2017, 2023) -->  cable. Daniel journeyed to
2025-01-22 20:26:50.512 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the kitchen.
2025-01-22 20:26:50.550 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4215, 4220) --> . Sandra went to the
2025-01-22 20:26:50.550 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the milk.
2025-01-22 20:26:50.573 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3857, 3861) -->  Mary grabbed the milk
2025-01-22 20:26:50.573 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the bathroom.
2025-01-22 20:26:50.579 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (905, 911) -->  the bedroom. Mary journeyed
2025-01-22 20:26:50.579 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary got the football.
2025-01-22 20:26:50.618 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6650, 6654) -->  Mary got the football
2025-01-22 20:26:50.618 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary discarded the milk.
2025-01-22 20:26:50.630 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2026, 2030) -->  Mary discarded the milk
2025-01-22 20:26:50.630 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary discarded the football.
2025-01-22 20:26:50.647 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (2821, 2825) -->  Mary discarded the football
2025-01-22 20:26:50.647 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary took the football.
2025-01-22 20:26:50.663 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (2824, 2828) -->  football. Mary took
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:26:51.397 | INFO     | test_jbb_embedding:begin_test:693 - there<|eot_id|>
2025-01-22 20:26:51.398 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8232])
2025-01-22 20:26:53.635 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [696.4449404761905, 39.832342896174865, 203.1953125, 37.629570331582805, 17.1984737435567], 'topk_indices': array([8226, 8214,  166, 8223, 8215,   24,   32, 8222,  165,  181,   31,
        184, 8219,   33, 8220,  185,   34,    0, 8228, 8227]), 'topk_tokens': [':', 'Question', 'E', '?', ':', '\n\n', ' the', ' office', 'ION', 'G', ' took', ' P', ' apple', ' apple', ' before', 'ION', ' there', '<|begin_of_text|>', '<|start_header_id|>', '<|eot_id|>'], 'evidence_proportions': [1861.4, 718.15, 261.4010416666667, 31.8375]}, 'weight': {'score': [21.618675595238095, 23.326664010321796, 26.82782451923077, 23.319927027357107, 29.72519329896907], 'topk_indices': array([3327, 3300, 3172, 3220, 7467, 7505, 1480, 1418, 4358, 4374, 5177,
       5238, 7210, 7154, 3483, 3509, 4971, 4994, 4946, 5023]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.340625, 19.909375, 23.959635416666668, 20.796875]}, 'saliency': {'score': [3.8648158482142856, 0.2232720862031345, 1.2482346754807692, 0.21067786950510656, 0.1315137725515464], 'topk_indices': array([8223,    0, 8130,  180,  263, 8086,   38,  181,  184,   30,  165,
       8214,  906, 8222,   31, 8220, 8219,   33,  185,   34]), 'topk_tokens': ['?', '<|begin_of_text|>', ' location', 'UG', 'hue', ' context', '***', 'G', ' P', 'Daniel', 'ION', 'Question', ' bedroom', ' office', ' took', ' before', ' apple', ' apple', 'ION', ' there'], 'evidence_proportions': [10.95, 3.347265625, 1.468017578125, 0.17333984375]}}, 'pred_res': 'there<|eot_id|>', 'score': 0}
2025-01-22 20:26:53.642 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:26:53.642 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-180_pid-4_0-1-2-5.pkl | len: 3 |  size: 1.97 KB
Processing depth (0, 1, 2, 5):   5%|â–Œ         | 5/100 [01:36<30:24, 19.20s/it]Processing depth (0, 1, 2, 5):   5%|â–Œ         | 5/100 [01:36<30:38, 19.35s/it]
2025-01-22 20:26:53.687 | INFO     | __main__:<module>:82 - Selected idx: 182
2025-01-22 20:26:53.687 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the apple before the garden? 
2025-01-22 20:26:53.687 | INFO     | __main__:<module>:84 - Answer: office
2025-01-22 20:26:53.687 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 20:26:53.687 | INFO     | __main__:<module>:86 - Needle: [' Daniel grabbed the apple.', ' Mary got the football.', ' Mary took the football.', ' Daniel journeyed to the office.', ' Mary journeyed to the bathroom.', ' Sandra went to the kitchen.', ' Mary discarded the football.', ' Mary discarded the football.', ' Daniel travelled to the garden.', ' Mary journeyed to the bedroom.']
2025-01-22 20:26:53.687 | INFO     | __main__:<module>:87 - Real Needle: [' Daniel grabbed the apple.', ' Daniel journeyed to the office.', ' Daniel travelled to the garden.', ' Mary journeyed to the bedroom.']
2025-01-22 20:26:53.687 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['â›¹ğŸ»\u200dâ™€ï¸', 'â›¹ï¸\u200dâ™‚', 'âš’ï¸', 'ğŸ§‘ğŸ¼\u200dğŸ¤\u200dğŸ§‘ğŸ¼', 'ğŸ‘±ğŸ»\u200dâ™€', 'ğŸ§‘ğŸ½\u200dâš•ï¸', 'ğŸ‘¨ğŸ¿\u200dâ¤\u200dğŸ‘¨ğŸ¾', 'ğŸ‹ğŸ¼\u200dâ™€', 'ğŸ¤µğŸ¾', 'ğŸ§ğŸ¾\u200dâ™€ï¸\u200dâ¡']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.44s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.55s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.05s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:12<00:00,  2.63s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:12<00:00,  3.24s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (2, 3, 4, 6):   0%|          | 0/100 [00:14<?, ?it/s]2025-01-22 20:27:08.499 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel grabbed the apple.
2025-01-22 20:27:08.508 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1842, 1846) -->  Daniel grabbed the apple
2025-01-22 20:27:08.508 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the office.
2025-01-22 20:27:08.523 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2911, 2917) -->  Daniel journeyed to the office
2025-01-22 20:27:08.523 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel travelled to the garden.
2025-01-22 20:27:08.540 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3529, 3534) --> . Daniel travelled to the
2025-01-22 20:27:08.540 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary journeyed to the bedroom.
2025-01-22 20:27:08.563 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4633, 4639) --> . Mary journeyed to the
2025-01-22 20:27:08.563 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the football.
2025-01-22 20:27:08.594 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6673, 6677) -->  Mary got the football
2025-01-22 20:27:08.594 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary took the football.
2025-01-22 20:27:08.623 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6230, 6234) -->  Mary took the football
2025-01-22 20:27:08.624 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bathroom.
2025-01-22 20:27:08.646 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4633, 4639) --> . Mary journeyed to the
2025-01-22 20:27:08.646 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the kitchen.
2025-01-22 20:27:08.667 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4309, 4314) --> . Sandra went to the
2025-01-22 20:27:08.667 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary discarded the football.
2025-01-22 20:27:08.682 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3222, 3226) -->  Mary discarded the football
2025-01-22 20:27:08.682 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary discarded the football.
2025-01-22 20:27:08.698 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (3222, 3226) -->  Mary discarded the football
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:27:12.468 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's office.<|eot_id|>
2025-01-22 20:27:12.468 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8177])
2025-01-22 20:27:15.428 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [306.1800595238095, 31.005322319354445, 76.41608796296296, 30.143834168613946, 26.977638134057973], 'topk_indices': array([8171,    3, 8161,   24, 8168, 1846, 8075, 1842, 8162,   14, 1843,
          1, 8164, 8160, 8165, 8175, 1845,    0, 8172, 8173]), 'topk_tokens': [':', '<|end_header_id|>', ' Where', '\n\n', '?', '.', ' location', ' Daniel', ' was', '\n', ' grabbed', '<|start_header_id|>', ' apple', ':', ' before', '<|end_header_id|>', ' apple', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [1066.0, 116.57291666666667, 215.075, 65.16145833333333]}, 'weight': {'score': [22.87797619047619, 23.276103435627828, 24.806712962962962, 23.27204910220145, 29.367753623188406], 'topk_indices': array([3338, 3311, 3201, 3153, 7448, 7410, 1399, 1461, 4320, 4336, 5168,
       5229, 7187, 7131, 3494, 3520, 4993, 4945, 4970, 5022]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.333984375, 23.615885416666668, 21.01875, 20.052083333333332]}, 'saliency': {'score': [2.0961768740699407, 0.16728704275048906, 0.5245180483217593, 0.16111905312951588, 0.19674704731374548], 'topk_indices': array([8169,   20,   24,    0, 8158, 1766, 8160, 8170, 8168, 8162, 1764,
       8167, 8161, 8159, 8075, 1842, 8164, 1843, 8165, 1845]), 'topk_tokens': [' \n', ' Jul', '\n\n', '<|begin_of_text|>', '.\n\n', 'ï¿½', ':', 'Answer', '?', ' was', 'ï¿½', ' garden', ' Where', 'Question', ' location', ' Daniel', ' apple', ' grabbed', ' before', ' apple'], 'evidence_proportions': [7.9375, 0.7525634765625, 1.13984375, 0.3425191243489583]}}, 'pred_res': "Daniel's office.<|eot_id|>", 'score': 100}
2025-01-22 20:27:15.434 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:27:15.434 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-182_pid-0_2-3-4-6.pkl | len: 3 |  size: 2.03 KB
Processing depth (2, 3, 4, 6):   1%|          | 1/100 [00:21<35:42, 21.64s/it]is_0k: False
your chose emoji: ['ğŸ›‹ï¸', 'ğŸ‘‚ğŸ¼', 'ğŸ†˜', 'ğŸ‘¨ğŸ¿\u200dğŸ¦¼', 'ğŸ§›ğŸ»\u200dâ™‚ï¸', 'ğŸ‘¨ğŸ½\u200dâ¤\u200dğŸ‘¨ğŸ¿', 'ğŸ‡®ğŸ‡³', 'ğŸ¦¿', 'ğŸ™‹ğŸ¿\u200dâ™€ï¸', 'ğŸ']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.98s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.95s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.66s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.18s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.78s/it]
Processing depth (2, 4, 5, 6):   1%|          | 1/100 [00:38<35:42, 21.64s/it]2025-01-22 20:27:32.399 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel grabbed the apple.
2025-01-22 20:27:32.408 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1794, 1798) -->  Daniel grabbed the apple
2025-01-22 20:27:32.408 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the office.
2025-01-22 20:27:32.426 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3545, 3551) -->  Daniel journeyed to the office
2025-01-22 20:27:32.426 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel travelled to the garden.
2025-01-22 20:27:32.447 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4121, 4126) --> . Daniel travelled to the
2025-01-22 20:27:32.447 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary journeyed to the bedroom.
2025-01-22 20:27:32.470 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4630, 4636) -->  Mary journeyed to the bedroom
2025-01-22 20:27:32.470 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the football.
2025-01-22 20:27:32.502 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6679, 6683) -->  Mary got the football
2025-01-22 20:27:32.502 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary took the football.
2025-01-22 20:27:32.532 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6236, 6240) -->  Mary took the football
2025-01-22 20:27:32.532 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bathroom.
2025-01-22 20:27:32.555 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4631, 4637) -->  journeyed to the bedroom.
2025-01-22 20:27:32.555 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the kitchen.
2025-01-22 20:27:32.576 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4304, 4309) -->  Sandra went to the kitchen
2025-01-22 20:27:32.576 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary discarded the football.
2025-01-22 20:27:32.592 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3245, 3249) -->  Mary discarded the football
2025-01-22 20:27:32.593 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary discarded the football.
2025-01-22 20:27:32.608 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (3245, 3249) -->  Mary discarded the football
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:27:33.417 | INFO     | test_jbb_embedding:begin_test:693 - the capitol<|eot_id|>
2025-01-22 20:27:33.417 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8205])
2025-01-22 20:27:35.683 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [570.6517857142857, 41.16912772633118, 142.42303240740742, 39.47124915737223, 61.11709337349398], 'topk_indices': array([8186,   23, 8195, 3547, 1795, 3548, 1797, 8198, 8193, 8188,   24,
         14, 8093, 3546, 8199, 8203, 3550,    0, 8200, 8201]), 'topk_tokens': ['.\n\n', '4', ' garden', 'ed', ' grabbed', ' to', ' apple', 'Answer', ' before', ':', '\n\n', '\n', '.\n\n', ' journey', ':', '<|end_header_id|>', ' office', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [807.0, 1037.5, 374.35, 109.82291666666667]}, 'weight': {'score': [24.17001488095238, 23.2976384488851, 25.841724537037038, 23.286974123667115, 29.404932228915662], 'topk_indices': array([3314, 3341, 3224, 3176, 7432, 7470, 1429, 1491, 4372, 4356, 5235,
       5174, 7153, 7209, 3497, 3523, 4951, 4976, 4999, 5028]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.333984375, 23.615885416666668, 21.01875, 24.57421875]}, 'saliency': {'score': [3.6272437686011907, 0.23011260871055197, 1.0232091833043981, 0.2187443819827989, 0.4355654429240399], 'topk_indices': array([8174, 8197,   24, 8189, 8103, 1817, 4126, 8093, 8059, 8192, 8193,
       8187, 1794, 8195, 3545, 8198, 1797, 1795, 3546, 3550]), 'topk_tokens': [' return', ' \n', '\n\n', ' Where', ' location', 'itol', ' garden', '.\n\n', ' context', ' apple', ' before', 'Question', ' Daniel', ' garden', ' Daniel', 'Answer', ' apple', ' grabbed', ' journey', ' office'], 'evidence_proportions': [5.9462890625, 6.388671875, 2.0310546875, 0.6499430338541666]}}, 'pred_res': 'the capitol<|eot_id|>', 'score': 0}
2025-01-22 20:27:35.699 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:27:35.702 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-182_pid-1_2-4-5-6.pkl | len: 3 |  size: 2.01 KB
Processing depth (2, 4, 5, 6):   2%|â–         | 2/100 [00:41<34:01, 20.83s/it]is_0k: False
your chose emoji: ['ğŸ‡²ğŸ‡­', 'ğŸ™…ğŸ¿\u200dâ™‚ï¸', 'ğŸ§‘ğŸ¼\u200dğŸ¦²', 'ğŸš´ğŸ½\u200dâ™‚ï¸', 'ğŸ¤¾ğŸ½\u200dâ™‚', 'ğŸ‘®ğŸ»\u200dâ™€', 'ğŸ‡§ğŸ‡®', 'ğŸ’–', 'ğŸ‘ˆğŸ¼', 'ğŸ‘©ğŸ¼\u200dâ¤ï¸\u200dğŸ‘©ğŸ»']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.11s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.68s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.16s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.70s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.30s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 1, 5, 7):   2%|â–         | 2/100 [00:56<34:01, 20.83s/it]2025-01-22 20:27:50.703 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel grabbed the apple.
2025-01-22 20:27:50.745 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the office.
2025-01-22 20:27:50.750 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (900, 906) --> . Daniel journeyed to the
2025-01-22 20:27:50.750 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel travelled to the garden.
2025-01-22 20:27:50.770 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4144, 4149) -->  Daniel travelled to the garden
2025-01-22 20:27:50.771 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary journeyed to the bedroom.
2025-01-22 20:27:50.798 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5525, 5531) --> . Mary journeyed to the
2025-01-22 20:27:50.798 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the football.
2025-01-22 20:27:50.830 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6665, 6669) -->  Mary got the football
2025-01-22 20:27:50.830 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary took the football.
2025-01-22 20:27:50.863 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6228, 6232) -->  Mary took the football
2025-01-22 20:27:50.863 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bathroom.
2025-01-22 20:27:50.893 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5525, 5531) --> . Mary journeyed to the
2025-01-22 20:27:50.893 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the kitchen.
2025-01-22 20:27:50.914 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4363, 4368) --> . Sandra went to the
2025-01-22 20:27:50.914 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary discarded the football.
2025-01-22 20:27:50.938 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3434, 3438) -->  Mary discarded the football
2025-01-22 20:27:50.939 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary discarded the football.
2025-01-22 20:27:50.955 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (3434, 3438) -->  Mary discarded the football
2025-01-22 20:27:50.955 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 20:27:50.955 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 20:27:50.955 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 20:27:50.955 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ§´', 'ğŸ’©', 'ğŸ’ğŸ½\u200dâ™€', 'ğŸ¤±ğŸ¾', 'ğŸ§›ğŸ½\u200dâ™€ï¸', 'ğŸ§‘ğŸ¿\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ§‘ğŸ½', 'ğŸ“', 'ğŸ‘²ğŸ¼', 'ğŸ‘¨ğŸ»\u200dğŸ¦¯', 'ğŸ‘¨ğŸ»\u200dğŸ¦¼']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.23s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.39s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.37s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.05s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.53s/it]
Processing depth (1, 4, 6, 8):   2%|â–         | 2/100 [01:12<34:01, 20.83s/it]2025-01-22 20:28:06.798 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel grabbed the apple.
2025-01-22 20:28:06.802 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (832, 836) -->  Daniel grabbed the apple
2025-01-22 20:28:06.802 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the office.
2025-01-22 20:28:06.820 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3654, 3660) --> . Daniel journeyed to the
2025-01-22 20:28:06.820 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel travelled to the garden.
2025-01-22 20:28:06.844 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4897, 4902) --> . Daniel travelled to the
2025-01-22 20:28:06.844 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary journeyed to the bedroom.
2025-01-22 20:28:06.873 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5663, 5669) --> . Mary journeyed to the
2025-01-22 20:28:06.873 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the football.
2025-01-22 20:28:06.910 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6819, 6823) -->  Mary got the football
2025-01-22 20:28:06.910 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary took the football.
2025-01-22 20:28:06.941 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6419, 6423) -->  Mary took the football
2025-01-22 20:28:06.941 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bathroom.
2025-01-22 20:28:06.970 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5663, 5669) --> . Mary journeyed to the
2025-01-22 20:28:06.970 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the kitchen.
2025-01-22 20:28:06.994 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4472, 4477) -->  execution. Sandra went to
2025-01-22 20:28:06.994 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary discarded the football.
2025-01-22 20:28:07.010 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3319, 3323) -->  Mary discarded the football
2025-01-22 20:28:07.010 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary discarded the football.
2025-01-22 20:28:07.026 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (3319, 3323) -->  Mary discarded the football
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:28:07.842 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's house.<|eot_id|>
2025-01-22 20:28:07.842 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8229])
2025-01-22 20:28:10.093 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [491.82142857142856, 39.313179595431905, 137.07986111111111, 37.82932604179396, 24.64671052631579], 'topk_indices': array([8117,  831,    9,   24, 8220, 8219,  832, 8127, 8216, 8212,    1,
        836, 8227,   14, 8217,  833,  835,    0, 8224, 8225]), 'topk_tokens': ['.\n\n', '.', ':', '\n\n', '?', ' garden', ' Daniel', ' location', ' apple', ':', '<|start_header_id|>', '.', '<|end_header_id|>', '\n', ' before', ' grabbed', ' apple', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [1535.25, 305.7708333333333, 303.775, 138.95833333333334]}, 'weight': {'score': [21.922247023809526, 23.31507411007168, 25.632233796296298, 23.311002994011975, 29.388815789473686], 'topk_indices': array([3360, 3333, 3180, 3228, 7476, 7438, 1482, 1544, 4340, 4324, 5208,
       5147, 7147, 7203, 3521, 3547, 4924, 4949, 5001, 4972]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.333984375, 20.270833333333332, 21.01875, 20.052083333333332]}, 'saliency': {'score': [3.254580543154762, 0.21587779573791155, 0.94091796875, 0.2056872980760418, 0.1867929559004934], 'topk_indices': array([   0, 8210, 8222, 8117,   24, 8212, 8214,    8, 8083, 8220, 8213,
       8211,  279, 8127, 8219, 8216,  832, 8217,  833,  835]), 'topk_tokens': ['<|begin_of_text|>', '.\n\n', 'Answer', '.\n\n', '\n\n', ':', ' was', ' Date', ' context', '?', ' Where', 'Question', 'hue', ' location', ' garden', ' apple', ' Daniel', ' before', ' grabbed', ' apple'], 'evidence_proportions': [11.4619140625, 1.62841796875, 1.63232421875, 0.7610677083333334]}}, 'pred_res': "Daniel's house.<|eot_id|>", 'score': 0}
2025-01-22 20:28:10.102 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:28:10.103 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-182_pid-2_1-4-6-8.pkl | len: 3 |  size: 2.02 KB
Processing depth (1, 4, 6, 8):   3%|â–         | 3/100 [01:16<43:41, 27.03s/it]is_0k: False
your chose emoji: ['ğŸ‚ğŸ¾', 'ğŸ‘·ğŸ¿\u200dâ™‚', 'ğŸ§‘ğŸ¼\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ§‘ğŸ½', 'ğŸ§ğŸ»', 'ğŸ‘¨\u200dğŸ‘¦\u200dğŸ‘¦', 'ğŸšµğŸ¿\u200dâ™‚', 'ğŸ§ğŸ½\u200dâ™€ï¸', 'ğŸ‘¨ğŸ¼\u200dğŸš’', 'ğŸ‘©ğŸ½\u200dğŸ¤', 'ğŸ‘®ğŸ»']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  4.00s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.50s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.31s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.86s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.39s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (2, 3, 5, 7):   3%|â–         | 3/100 [01:32<43:41, 27.03s/it]2025-01-22 20:28:26.120 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel grabbed the apple.
2025-01-22 20:28:26.130 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1842, 1846) -->  Daniel grabbed the apple
2025-01-22 20:28:26.131 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the office.
2025-01-22 20:28:26.149 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2858, 2864) --> . Daniel journeyed to the
2025-01-22 20:28:26.149 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel travelled to the garden.
2025-01-22 20:28:26.170 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4194, 4199) -->  Daniel travelled to the garden
2025-01-22 20:28:26.171 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary journeyed to the bedroom.
2025-01-22 20:28:26.204 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5549, 5555) --> . Mary journeyed to the
2025-01-22 20:28:26.204 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the football.
2025-01-22 20:28:26.238 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6671, 6675) -->  Mary got the football
2025-01-22 20:28:26.238 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary took the football.
2025-01-22 20:28:26.281 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6300, 6304) -->  Mary took the football
2025-01-22 20:28:26.281 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bathroom.
2025-01-22 20:28:26.309 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5549, 5555) --> . Mary journeyed to the
2025-01-22 20:28:26.310 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the kitchen.
2025-01-22 20:28:26.331 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4418, 4423) -->  execution. Sandra went to
2025-01-22 20:28:26.331 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary discarded the football.
2025-01-22 20:28:26.349 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3300, 3304) -->  Mary discarded the football
2025-01-22 20:28:26.350 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary discarded the football.
2025-01-22 20:28:26.366 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (3300, 3304) -->  Mary discarded the football
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:28:29.220 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's house.<|eot_id|>
2025-01-22 20:28:29.220 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8185])
2025-01-22 20:28:31.782 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [361.0327380952381, 35.096860877000125, 90.29918981481481, 34.07276500491461, 32.00593964041096], 'topk_indices': array([   9,   24, 1843,    1, 8168, 8172, 1842, 8175, 8176,   14, 1853,
       8173, 1845, 8183, 1854, 1855,    0, 1856, 8180, 8181]), 'topk_tokens': [':', '\n\n', ' grabbed', '<|start_header_id|>', ':', ' apple', ' Daniel', ' garden', '?', '\n', ' *', ' before', ' apple', '<|end_header_id|>', '      ', ' *', '<|begin_of_text|>', '      ', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [964.25, 177.34375, 401.9, 108.52083333333333]}, 'weight': {'score': [22.99702380952381, 23.287788567240746, 25.632233796296298, 23.280761418786092, 29.689212328767123], 'topk_indices': array([3282, 3255, 3127, 3175, 7452, 7414, 1467, 1405, 4270, 4286, 5154,
       5093, 7191, 7135, 3448, 3474, 4864, 4912, 4941, 4889]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.333984375, 20.270833333333332, 25.5328125, 20.052083333333332]}, 'saliency': {'score': [2.4346168154761907, 0.19081602729078875, 0.6146963614004629, 0.18362047678423332, 0.2343296416818279], 'topk_indices': array([ 966,  970, 8178, 1847,  968, 4198, 8169, 8176, 8083, 8167, 1853,
       1843, 8172, 8175, 1842, 8173, 1845, 1854, 1855, 1856]), 'topk_tokens': [' *', ' *', 'Answer', 'ï¿½', ' *', ' garden', ' Where', '?', ' location', 'Question', ' *', ' grabbed', ' apple', ' garden', ' Daniel', ' before', ' apple', '      ', ' *', '      '], 'evidence_proportions': [7.27880859375, 0.9385986328125, 2.564453125, 0.5929768880208334]}}, 'pred_res': "Daniel's house.<|eot_id|>", 'score': 0}
2025-01-22 20:28:31.788 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:28:31.789 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-182_pid-3_2-3-5-7.pkl | len: 3 |  size: 2.01 KB
Processing depth (2, 3, 5, 7):   4%|â–         | 4/100 [01:37<39:52, 24.92s/it]is_0k: False
your chose emoji: ['ğŸ–ï¸', 'â›ˆï¸', 'ğŸ—', 'ğŸ‘©ğŸ¼\u200dğŸ¦±', 'ğŸ‘©ğŸ¾\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘¨ğŸ¾', 'ğŸ“„', 'ğŸ—‘', 'ğŸŸ¤', 'ğŸ§›ğŸ¼\u200dâ™‚ï¸', 'ğŸ‘¨ğŸ½\u200dâ¤\u200dğŸ‘¨ğŸ½']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.05s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.46s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.36s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.02s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.50s/it]
Processing depth (0, 2, 3, 9):   4%|â–         | 4/100 [01:53<39:52, 24.92s/it]2025-01-22 20:28:47.577 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel grabbed the apple.
2025-01-22 20:28:47.615 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the office.
2025-01-22 20:28:47.624 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1794, 1800) --> . Daniel journeyed to the
2025-01-22 20:28:47.624 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel travelled to the garden.
2025-01-22 20:28:47.639 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2929, 2934) --> . Daniel travelled to the
2025-01-22 20:28:47.639 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary journeyed to the bedroom.
2025-01-22 20:28:47.666 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5587, 5593) -->  journeyed to the bathroom.
2025-01-22 20:28:47.666 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the football.
2025-01-22 20:28:47.698 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6684, 6688) -->  Mary got the football
2025-01-22 20:28:47.699 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary took the football.
2025-01-22 20:28:47.728 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6268, 6272) -->  took the football.
2025-01-22 20:28:47.728 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bathroom.
2025-01-22 20:28:47.756 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5586, 5592) -->  Mary journeyed to the bathroom
2025-01-22 20:28:47.756 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the kitchen.
2025-01-22 20:28:47.780 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4452, 4457) -->  execution. Sandra went to
2025-01-22 20:28:47.780 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary discarded the football.
2025-01-22 20:28:47.797 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3436, 3440) -->  Mary discarded the football
2025-01-22 20:28:47.797 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary discarded the football.
2025-01-22 20:28:47.813 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (3436, 3440) -->  Mary discarded the football
2025-01-22 20:28:47.813 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 20:28:47.813 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 20:28:47.813 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 20:28:47.813 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸª', 'ğŸ‘©ğŸ½\u200dğŸ¤\u200dğŸ‘¨ğŸ¿', 'ğŸ›•', 'ğŸ§‘\u200dğŸš’', 'ğŸª’', 'ğŸ§‘ğŸ¿\u200dğŸ¦°', 'ğŸ‘©ğŸ»\u200dğŸ¤\u200dğŸ‘©ğŸ¾', 'ğŸ‡¨ğŸ‡µ', 'ğŸ¦¸\u200dâ™‚', 'ğŸ‡¸ğŸ‡¦']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.43s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.28s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.28s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.96s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.46s/it]
Processing depth (2, 3, 6, 8):   4%|â–         | 4/100 [02:09<39:52, 24.92s/it]2025-01-22 20:29:03.311 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel grabbed the apple.
2025-01-22 20:29:03.322 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1746, 1750) -->  Daniel grabbed the apple
2025-01-22 20:29:03.322 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the office.
2025-01-22 20:29:03.341 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2826, 2832) --> . Daniel journeyed to the
2025-01-22 20:29:03.342 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel travelled to the garden.
2025-01-22 20:29:03.366 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4715, 4720) --> . Daniel travelled to the
2025-01-22 20:29:03.367 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary journeyed to the bedroom.
2025-01-22 20:29:03.399 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5427, 5433) --> . Mary journeyed to the
2025-01-22 20:29:03.399 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the football.
2025-01-22 20:29:03.435 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6669, 6673) -->  Mary got the football
2025-01-22 20:29:03.435 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary took the football.
2025-01-22 20:29:03.471 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6225, 6229) -->  Mary took the football
2025-01-22 20:29:03.471 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bathroom.
2025-01-22 20:29:03.498 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5427, 5433) --> . Mary journeyed to the
2025-01-22 20:29:03.498 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the kitchen.
2025-01-22 20:29:03.521 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4369, 4374) --> . Sandra went to the
2025-01-22 20:29:03.521 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary discarded the football.
2025-01-22 20:29:03.539 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3276, 3280) -->  Mary discarded the football
2025-01-22 20:29:03.539 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary discarded the football.
2025-01-22 20:29:03.554 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (3276, 3280) -->  Mary discarded the football
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:29:04.386 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's pocket.<|eot_id|>
2025-01-22 20:29:04.386 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8161])
2025-01-22 20:29:06.599 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [594.9032738095239, 49.30723232880069, 97.76620370370371, 47.7341073629082, 33.423988217213115], 'topk_indices': array([8049, 8148,   24,   14, 8143, 8146, 8151, 8152, 8015, 1746, 8144,
       8159, 1747, 1750, 8149, 8059, 1749,    0, 8156, 8157]), 'topk_tokens': ['.\n\n', ' apple', '\n\n', '\n', 'Question', ' was', ' garden', '?', ' context', ' Daniel', ':', '<|end_header_id|>', ' grabbed', '.', ' before', ' location', ' apple', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [1647.25, 617.5833333333334, 339.125, 83.80729166666667]}, 'weight': {'score': [21.922247023809526, 23.26867802891094, 24.806712962962962, 23.267045016943932, 29.66982581967213], 'topk_indices': array([3317, 3290, 3157, 3205, 7380, 7418, 1443, 1505, 4292, 4308, 5131,
       5192, 7157, 7101, 3504, 3478, 4985, 4921, 4896, 4956]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.333984375, 20.270833333333332, 21.01875, 20.052083333333332]}, 'saliency': {'score': [3.8265380859375, 0.2741074436481686, 0.6597900390625, 0.2636312300234904, 0.24548489930199796], 'topk_indices': array([   0, 8144, 8049, 8055, 8130, 8146, 2832, 8145, 8152, 8058, 2828,
       8148, 8143, 8015, 8151, 1746, 8149, 1747, 8059, 1749]), 'topk_tokens': ['<|begin_of_text|>', ':', '.\n\n', ' item', ' return', ' was', ' office', ' Where', '?', ' first', ' journey', ' apple', 'Question', ' context', ' garden', ' Daniel', ' before', ' grabbed', ' location', ' apple'], 'evidence_proportions': [12.2548828125, 3.33642578125, 1.74951171875, 0.4286092122395833]}}, 'pred_res': "Daniel's pocket.<|eot_id|>", 'score': 0}
2025-01-22 20:29:06.607 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:29:06.608 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-182_pid-4_2-3-6-8.pkl | len: 3 |  size: 2.04 KB
Processing depth (2, 3, 6, 8):   5%|â–Œ         | 5/100 [02:12<45:06, 28.49s/it]Processing depth (2, 3, 6, 8):   5%|â–Œ         | 5/100 [02:12<42:05, 26.58s/it]
2025-01-22 20:29:06.713 | INFO     | __main__:<module>:82 - Selected idx: 184
2025-01-22 20:29:06.713 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the apple before the bathroom? 
2025-01-22 20:29:06.713 | INFO     | __main__:<module>:84 - Answer: garden
2025-01-22 20:29:06.713 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 20:29:06.713 | INFO     | __main__:<module>:86 - Needle: [' Sandra went to the kitchen.', ' Mary discarded the football.', ' Mary journeyed to the bedroom.', ' Daniel picked up the apple.', ' Mary got the football.', ' Mary discarded the football.', ' Daniel travelled to the garden.', ' Mary took the football.', ' Mary journeyed to the bathroom.', ' Daniel travelled to the bathroom.', ' Sandra travelled to the bathroom.']
2025-01-22 20:29:06.713 | INFO     | __main__:<module>:87 - Real Needle: [' Daniel picked up the apple.', ' Daniel travelled to the garden.', ' Daniel travelled to the bathroom.', ' Sandra travelled to the bathroom.']
2025-01-22 20:29:06.713 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ§ğŸ¼\u200dâ™‚ï¸', 'ğŸ‘³ğŸ¼\u200dâ™€ï¸', 'â¤ï¸', 'ğŸ‹ğŸ¾', 'ğŸ‘¨ğŸ¿\u200dâš•ï¸', 'ğŸ‘±ğŸ¼', 'ğŸ‘©ğŸ»\u200dğŸ”¬', 'ğŸ˜š', 'ğŸ˜‡', 'ğŸ•´']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.58s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.52s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.22s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.02s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.52s/it]
Processing depth (1, 3, 7, 9):   0%|          | 0/100 [00:15<?, ?it/s]2025-01-22 20:29:22.684 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the apple.
2025-01-22 20:29:22.689 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (900, 905) --> . Daniel picked up the
2025-01-22 20:29:22.689 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel travelled to the garden.
2025-01-22 20:29:22.703 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2983, 2988) -->  tragedy. Daniel travelled to
2025-01-22 20:29:22.703 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel travelled to the bathroom.
2025-01-22 20:29:22.721 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2983, 2988) -->  tragedy. Daniel travelled to
2025-01-22 20:29:22.721 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra travelled to the bathroom.
2025-01-22 20:29:22.750 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5799, 5804) -->  Daniel travelled to the bathroom
2025-01-22 20:29:22.750 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went to the kitchen.
2025-01-22 20:29:22.773 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4842, 4847) --> . Sandra went to the
2025-01-22 20:29:22.773 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary discarded the football.
2025-01-22 20:29:22.786 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2866, 2870) -->  Mary discarded the football
2025-01-22 20:29:22.787 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bedroom.
2025-01-22 20:29:22.798 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2009, 2015) -->  cable. Mary journeyed to
2025-01-22 20:29:22.798 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary got the football.
2025-01-22 20:29:22.821 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4452, 4456) -->  Mary got the football
2025-01-22 20:29:22.821 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary discarded the football.
2025-01-22 20:29:22.835 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (2866, 2870) -->  Mary discarded the football
2025-01-22 20:29:22.835 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary took the football.
2025-01-22 20:29:22.837 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (356, 360) -->  Mary took the football
2025-01-22 20:29:22.837 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Mary journeyed to the bathroom.
2025-01-22 20:29:22.853 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (2009, 2015) -->  cable. Mary journeyed to
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:29:23.623 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 20:29:23.624 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8165])
2025-01-22 20:29:25.843 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [114.0578125, 13.446543485247307, 67.80445075757575, 12.977530999691929, 8.44716796875], 'topk_indices': array([  20, 8158, 8138, 8146,    4, 8019,    1, 2989, 8159, 8164,    9,
       8053,   28, 8063,   23,   24,   14, 8163,    0, 8160]), 'topk_tokens': [' Jul', 'Answer', '.', '.\n\n', '\n\n', ' context', '<|start_header_id|>', ' garden', ':', '\n\n', ':', '.\n\n', '<|end_header_id|>', ' location', '4', '\n\n', '\n', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [203.2375, 97.590625, 97.590625, 57.8125]}, 'weight': {'score': [25.680859375, 23.267562821376103, 25.283617424242426, 23.2534167051756, 29.475], 'topk_indices': array([3266, 3293, 3138, 3186, 7412, 7450, 1472, 1410, 4256, 4272, 5092,
       5153, 7123, 7179, 3475, 3449, 4869, 4917, 4946, 4894]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.3625, 26.8265625, 26.8265625, 26.7078125]}, 'saliency': {'score': [0.710595703125, 0.0734255320878734, 0.43943647904829547, 0.0703667810502349, 0.06598383585611979], 'topk_indices': array([  19, 8153,  359, 8137,   14, 8162, 8134, 8155, 8164,    8, 8147,
        901,   24, 8053,   20,   23, 8019, 8158, 2989, 8063]), 'topk_tokens': ['26', ' before', ' football', ' directly', '\n', 'assistant', ' return', ' bathroom', '\n\n', ' Date', 'Question', ' Daniel', '\n\n', '.\n\n', ' Jul', '4', ' context', 'Answer', ' garden', ' location'], 'evidence_proportions': [1.224658203125, 0.6070068359375, 0.6070068359375, 0.4037109375]}}, 'pred_res': 'The garden.<|eot_id|>', 'score': 100}
2025-01-22 20:29:25.851 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:29:25.851 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-184_pid-0_1-3-7-9.pkl | len: 3 |  size: 2.0 KB
Processing depth (1, 3, 7, 9):   1%|          | 1/100 [00:19<31:23, 19.03s/it]is_0k: False
your chose emoji: ['ğŸ‘©ğŸ¾\u200dğŸš’', 'ğŸ©°', 'ğŸ‘±ğŸ¿\u200dâ™‚', 'ğŸ¥£', 'ğŸ•µğŸ½\u200dâ™€', 'ğŸ˜', 'ğŸ¤½ğŸ»', 'ğŸ‹\u200dâ™‚ï¸', 'ğŸ¦¶ğŸ½', 'ğŸ¤¹\u200dâ™€ï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.52s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.52s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:15<00:05,  5.28s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  3.79s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  4.18s/it]
Processing depth (5, 6, 8, 9):   1%|          | 1/100 [00:37<31:23, 19.03s/it]2025-01-22 20:29:44.347 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the apple.
2025-01-22 20:29:44.367 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4212, 4217) -->  Daniel picked up the apple
2025-01-22 20:29:44.368 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel travelled to the garden.
2025-01-22 20:29:44.391 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4785, 4790) -->  Daniel travelled to the garden
2025-01-22 20:29:44.391 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel travelled to the bathroom.
2025-01-22 20:29:44.420 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4786, 4791) -->  travelled to the garden.
2025-01-22 20:29:44.420 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra travelled to the bathroom.
2025-01-22 20:29:44.466 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6554, 6559) -->  Daniel travelled to the bathroom
2025-01-22 20:29:44.466 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went to the kitchen.
2025-01-22 20:29:44.497 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4760, 4765) -->  the senate. Sandra went
2025-01-22 20:29:44.497 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary discarded the football.
2025-01-22 20:29:44.511 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2858, 2862) -->  Mary discarded the football
2025-01-22 20:29:44.511 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bedroom.
2025-01-22 20:29:44.520 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1850, 1856) --> . Mary journeyed to the
2025-01-22 20:29:44.520 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary got the football.
2025-01-22 20:29:44.541 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4366, 4370) -->  Mary got the football
2025-01-22 20:29:44.541 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary discarded the football.
2025-01-22 20:29:44.554 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (2858, 2862) -->  Mary discarded the football
2025-01-22 20:29:44.555 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary took the football.
2025-01-22 20:29:44.556 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (356, 360) -->  Mary took the football
2025-01-22 20:29:44.557 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Mary journeyed to the bathroom.
2025-01-22 20:29:44.567 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (1850, 1856) --> . Mary journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:29:45.352 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 20:29:45.352 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8187])
2025-01-22 20:29:47.671 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [253.1390625, 16.8875248015873, 111.46875, 15.923261413911762, 25.001623019366196], 'topk_indices': array([8175, 8168, 8160,    1, 8036, 8156, 8040,    9, 8085, 8186,   23,
         24, 8181, 8075, 4789, 8041,   14, 8185,    0, 8182]), 'topk_tokens': [' before', '.\n\n', '.', '<|start_header_id|>', '\n', ' return', ' you', ':', ' location', '\n\n', '4', '\n\n', ':', '.\n\n', ' garden', ' context', '\n', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [274.7, 323.2, 281.55625, 133.1]}, 'weight': {'score': [24.963671875, 23.27474626068376, 24.658617424242426, 23.26498267942731, 28.927596830985916], 'topk_indices': array([3313, 3286, 3172, 3124, 7434, 7472, 1414, 1476, 4304, 4288, 5207,
       5146, 7155, 7211, 3475, 3501, 4934, 4909, 4957, 4986]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.9703125, 25.5328125, 20.64375, 26.7078125]}, 'saliency': {'score': [1.765911865234375, 0.09375137124160561, 0.7046527284564394, 0.08716381382880668, 0.1871184228171765], 'topk_indices': array([  23, 8040, 8039,   20, 8159, 8169, 8174, 4786, 8175,    8, 7765,
       4216, 8075, 8180, 8156, 4212, 8085, 8177, 4789, 8041]), 'topk_tokens': ['4', ' you', ' provided', ' Jul', ' directly', 'Question', ' apple', ' travelled', ' before', ' Date', 'inen', ' apple', '.\n\n', 'Answer', ' return', ' Daniel', ' location', ' bathroom', ' garden', ' context'], 'evidence_proportions': [1.999365234375, 2.2701171875, 1.8670166015625, 0.9271484375]}}, 'pred_res': 'The garden.<|eot_id|>', 'score': 100}
2025-01-22 20:29:47.682 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:29:47.682 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-184_pid-1_5-6-8-9.pkl | len: 3 |  size: 2.01 KB
Processing depth (5, 6, 8, 9):   2%|â–         | 2/100 [00:40<33:46, 20.68s/it]is_0k: False
your chose emoji: ['ğŸ‡¬ğŸ‡¼', 'ğŸ‘©ğŸ¾\u200dğŸ¤\u200dğŸ‘¨ğŸ½', 'ğŸšµğŸ½\u200dâ™€ï¸', 'ğŸŒğŸ¿\u200dâ™€', 'âš¡', 'ğŸš', 'ğŸ‘©ğŸ¿\u200dâš–', 'ğŸ‘™', 'ğŸ‘\u200dğŸ—¨', 'ğŸ‡µğŸ‡ª']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.02s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.32s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.45s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.13s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.57s/it]
Processing depth (0, 1, 2, 6):   2%|â–         | 2/100 [00:57<33:46, 20.68s/it]2025-01-22 20:30:03.972 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the apple.
2025-01-22 20:30:03.972 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the apple.
2025-01-22 20:30:03.972 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel travelled to the garden.
2025-01-22 20:30:03.977 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (832, 837) --> . Daniel travelled to the
2025-01-22 20:30:03.977 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel travelled to the bathroom.
2025-01-22 20:30:03.981 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (832, 837) --> . Daniel travelled to the
2025-01-22 20:30:03.981 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra travelled to the bathroom.
2025-01-22 20:30:03.990 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1601, 1606) -->  Daniel travelled to the bathroom
2025-01-22 20:30:03.990 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went to the kitchen.
2025-01-22 20:30:04.016 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4593, 4598) -->  Sandra went to the kitchen
2025-01-22 20:30:04.016 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary discarded the football.
2025-01-22 20:30:04.028 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2549, 2553) -->  discarded the football.
2025-01-22 20:30:04.028 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bedroom.
2025-01-22 20:30:04.036 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1604, 1610) -->  the bathroom. Mary journeyed
2025-01-22 20:30:04.036 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary got the football.
2025-01-22 20:30:04.056 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4269, 4273) -->  got the football.
2025-01-22 20:30:04.056 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary discarded the football.
2025-01-22 20:30:04.069 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (2549, 2553) -->  discarded the football.
2025-01-22 20:30:04.069 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary took the football.
2025-01-22 20:30:04.071 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (316, 320) -->  Mary took the football
2025-01-22 20:30:04.071 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Mary journeyed to the bathroom.
2025-01-22 20:30:04.079 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (1603, 1609) -->  to the bathroom. Mary journey
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:30:04.873 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 20:30:04.873 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8151])
2025-01-22 20:30:07.079 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [163.0109375, 19.77066278820211, 89.55397727272727, 19.1327594587088, 15.384323408018869], 'topk_indices': array([  24,   14,  327,  370,  346,  342,  341,  375, 8147, 8146,  374,
        343,  372,  344,  373,  347,  376,    0,  345,  348]), 'topk_tokens': ['\n\n', '\n', '\n', '\n', ' the', 'the', '\n', ' the', '<|start_header_id|>', '<|eot_id|>', ' of', ' latter', ' latter', ' half', ' half', ' past', ' past', '<|begin_of_text|>', ' of', ' century'], 'evidence_proportions': [249.9, 160.725, 160.725, 80.69375]}, 'weight': {'score': [22.706640625, 23.246234593451067, 23.866477272727273, 23.245040157079373, 28.63826650943396], 'topk_indices': array([3330, 3357, 3202, 3250, 7392, 7430, 1456, 1518, 4319, 4335, 5215,
       5154, 7113, 7169, 3539, 3513, 5008, 4931, 4956, 4979]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.08125, 21.01875, 21.01875, 26.7078125]}, 'saliency': {'score': [0.87606201171875, 0.11132791541153116, 0.5728907729640151, 0.10755970701437323, 0.11406434257075472], 'topk_indices': array([8141,  335,   24,  371,  319,  375,  369,  374,  339,    0,  837,
        342,  345,  343,  372,  344,  373,  347,  376,  348]), 'topk_tokens': [' bathroom', ' method', '\n\n', 'the', ' football', ' the', ' during', ' of', ' newspaper', '<|begin_of_text|>', ' garden', 'the', ' of', ' latter', ' latter', ' half', ' half', ' past', ' past', ' century'], 'evidence_proportions': [1.26435546875, 0.829931640625, 0.829931640625, 0.580029296875]}}, 'pred_res': 'The garden.<|eot_id|>', 'score': 100}
2025-01-22 20:30:07.086 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:30:07.086 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-184_pid-2_0-1-2-6.pkl | len: 3 |  size: 1.99 KB
Processing depth (0, 1, 2, 6):   3%|â–         | 3/100 [01:00<32:29, 20.10s/it]is_0k: False
your chose emoji: ['ğŸ‡®ğŸ‡©', '\U0001faf3ğŸ½', 'ğŸ‡²ğŸ‡º', 'ğŸ¥œ', 'ğŸ¤¹ğŸ¾\u200dâ™‚', 'ğŸ¥¶', 'ğŸ–ğŸ¿', 'ğŸ¦¤', 'ğŸ˜¹', 'ğŸ‘©ğŸ¼\u200dğŸ’¼']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.18s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.47s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.38s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.02s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.52s/it]
Processing depth (5, 6, 7, 9):   3%|â–         | 3/100 [01:16<32:29, 20.10s/it]2025-01-22 20:30:22.967 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the apple.
2025-01-22 20:30:22.987 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4137, 4142) --> . Daniel picked up the
2025-01-22 20:30:22.987 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel travelled to the garden.
2025-01-22 20:30:23.010 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4716, 4721) --> . Daniel travelled to the
2025-01-22 20:30:23.011 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel travelled to the bathroom.
2025-01-22 20:30:23.033 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4716, 4721) --> . Daniel travelled to the
2025-01-22 20:30:23.034 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra travelled to the bathroom.
2025-01-22 20:30:23.061 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5607, 5612) -->  Daniel travelled to the bathroom
2025-01-22 20:30:23.061 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went to the kitchen.
2025-01-22 20:30:23.083 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4611, 4616) -->  Sandra went to the kitchen
2025-01-22 20:30:23.084 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary discarded the football.
2025-01-22 20:30:23.097 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2702, 2706) -->  Mary discarded the football
2025-01-22 20:30:23.097 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bedroom.
2025-01-22 20:30:23.106 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1852, 1858) --> . Mary journeyed to the
2025-01-22 20:30:23.106 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary got the football.
2025-01-22 20:30:23.130 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4308, 4312) -->  Mary got the football
2025-01-22 20:30:23.130 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary discarded the football.
2025-01-22 20:30:23.142 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (2702, 2706) -->  Mary discarded the football
2025-01-22 20:30:23.143 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary took the football.
2025-01-22 20:30:23.144 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (356, 360) -->  Mary took the football
2025-01-22 20:30:23.144 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Mary journeyed to the bathroom.
2025-01-22 20:30:23.154 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (1852, 1858) --> . Mary journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:30:23.950 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 20:30:23.950 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8183])
2025-01-22 20:30:26.155 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [157.49375, 15.486371548986074, 83.87073863636364, 14.859686232017706, 18.477836277173914], 'topk_indices': array([8164, 8166, 8152, 8036, 8081,    1, 8171,    9, 4721, 8071, 8182,
       8177,   23,   24, 8037, 8179,   14,    0, 8181, 8178]), 'topk_tokens': ['.\n\n', ':', ' return', ' you', ' location', '<|start_header_id|>', ' before', ':', ' garden', '.\n\n', '\n\n', ':', '4', '\n\n', ' context', '<|start_header_id|>', '\n', '<|begin_of_text|>', '<|end_header_id|>', '<|eot_id|>'], 'evidence_proportions': [217.325, 150.775, 150.775, 111.1]}, 'weight': {'score': [22.776953125, 23.276289167481064, 24.66785037878788, 23.27187077339235, 29.182971014492754], 'topk_indices': array([3272, 3299, 3192, 3144, 7454, 7416, 1416, 1478, 4280, 4296, 5199,
       5138, 7193, 7137, 3481, 3455, 4992, 4940, 4963, 4915]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.3625, 21.01875, 21.01875, 26.7078125]}, 'saliency': {'score': [0.9465087890625, 0.08517210750920017, 0.5395193388967803, 0.0812104460968239, 0.1376420173092165], 'topk_indices': array([   8, 8180, 8036, 8182,   14, 8155, 8035,   24, 8071, 4142,   23,
         20, 8152, 8165, 8176, 8171, 8081, 8173, 4721, 8037]), 'topk_tokens': [' Date', 'assistant', ' you', '\n\n', '\n', ' directly', ' provided', '\n\n', '.\n\n', ' apple', '4', ' Jul', ' return', 'Question', 'Answer', ' before', ' location', ' bathroom', ' garden', ' context'], 'evidence_proportions': [1.31259765625, 0.851416015625, 0.851416015625, 0.77060546875]}}, 'pred_res': 'The garden.<|eot_id|>', 'score': 100}
2025-01-22 20:30:26.161 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:30:26.161 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-184_pid-3_5-6-7-9.pkl | len: 3 |  size: 2.01 KB
Processing depth (5, 6, 7, 9):   4%|â–         | 4/100 [01:19<31:30, 19.69s/it]is_0k: False
your chose emoji: ['ğŸ–•', 'ğŸ¤´ğŸ¼', 'ğŸ‡®ğŸ‡ª', 'ğŸ¦¹ğŸ¾\u200dâ™€ï¸', '\U0001faf2ğŸ½', 'ğŸ§‘ğŸ¿\u200dğŸ¦¯', 'ğŸ§œ\u200dâ™‚ï¸', 'ğŸ“', 'ğŸ‘‹ğŸ½', 'ğŸš¶ğŸ¾\u200dâ™‚ï¸\u200dâ¡']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.59s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.87s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.55s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.12s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.69s/it]
Processing depth (0, 3, 5, 9):   4%|â–         | 4/100 [01:35<31:30, 19.69s/it]2025-01-22 20:30:42.696 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the apple.
2025-01-22 20:30:42.696 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the apple.
2025-01-22 20:30:42.696 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel travelled to the garden.
2025-01-22 20:30:42.710 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2836, 2841) --> . Daniel travelled to the
2025-01-22 20:30:42.710 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel travelled to the bathroom.
2025-01-22 20:30:42.724 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2836, 2841) --> . Daniel travelled to the
2025-01-22 20:30:42.724 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra travelled to the bathroom.
2025-01-22 20:30:42.744 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4122, 4127) -->  Daniel travelled to the bathroom
2025-01-22 20:30:42.745 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went to the kitchen.
2025-01-22 20:30:42.767 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4610, 4615) --> . Sandra went to the
2025-01-22 20:30:42.767 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary discarded the football.
2025-01-22 20:30:42.780 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2708, 2712) -->  Mary discarded the football
2025-01-22 20:30:42.780 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bedroom.
2025-01-22 20:30:42.789 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1864, 1870) --> . Mary journeyed to the
2025-01-22 20:30:42.789 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary got the football.
2025-01-22 20:30:42.810 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4288, 4292) -->  Mary got the football
2025-01-22 20:30:42.811 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary discarded the football.
2025-01-22 20:30:42.823 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (2708, 2712) -->  Mary discarded the football
2025-01-22 20:30:42.823 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary took the football.
2025-01-22 20:30:42.825 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (362, 366) -->  Mary took the football
2025-01-22 20:30:42.825 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Mary journeyed to the bathroom.
2025-01-22 20:30:42.834 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (1864, 1870) --> . Mary journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:30:43.660 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 20:30:43.661 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8159])
2025-01-22 20:30:45.941 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [425.590625, 45.26678127297231, 220.73863636363637, 43.614660408188435, 31.15611293859649], 'topk_indices': array([7229, 1157, 7255,   69, 1177, 8154,   66, 7256,   14, 7333, 7258,
         67,  105,   68, 7287, 7286, 7257, 7334,    0, 7335]), 'topk_tokens': ['ot', 'nes', '\n', 'ER', 'nes', '<|eot_id|>', ' P', 'Min', '\n', ' the', 'ot', 'ION', 'ION', 'E', 'ot', 'nes', 'nes', ' Min', '<|begin_of_text|>', 'nes'], 'evidence_proportions': [666.5, 422.75, 422.75, 190.3625]}, 'weight': {'score': [22.706640625, 23.263057844278364, 23.942234848484848, 23.261666242754963, 29.46436403508772], 'topk_indices': array([3329, 3302, 3170, 3218, 7420, 7382, 1490, 1428, 4313, 4297, 5175,
       5114, 7103, 7159, 3511, 3485, 4939, 4916, 4891, 4968]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.08125, 21.01875, 21.01875, 26.7078125]}, 'saliency': {'score': [2.4778076171875, 0.2593661819828167, 1.356271454782197, 0.24943071488373258, 0.23362865782620615], 'topk_indices': array([  66, 8013,   41, 8149, 1157, 7228, 1870, 7285,   38, 1177, 7258,
       7256,   68,  105,   67, 7287, 7286, 7257, 7334, 7335]), 'topk_tokens': [' P', ' context', '-text', ' bathroom', 'nes', 'nes', ' bathroom', ' Min', '***', 'nes', 'ot', 'Min', 'E', 'ION', 'ION', 'ot', 'nes', 'nes', ' Min', 'nes'], 'evidence_proportions': [3.6173828125, 2.487109375, 2.487109375, 1.31962890625]}}, 'pred_res': 'The garden.<|eot_id|>', 'score': 100}
2025-01-22 20:30:45.948 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:30:45.948 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-184_pid-4_0-3-5-9.pkl | len: 3 |  size: 1.91 KB
Processing depth (0, 3, 5, 9):   5%|â–Œ         | 5/100 [01:39<31:14, 19.73s/it]Processing depth (0, 3, 5, 9):   5%|â–Œ         | 5/100 [01:39<31:25, 19.84s/it]
2025-01-22 20:30:46.038 | INFO     | __main__:<module>:82 - Selected idx: 186
2025-01-22 20:30:46.038 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the apple before the garden? 
2025-01-22 20:30:46.038 | INFO     | __main__:<module>:84 - Answer: office
2025-01-22 20:30:46.038 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 20:30:46.038 | INFO     | __main__:<module>:86 - Needle: [' Mary journeyed to the bathroom.', ' Daniel took the apple.', ' Sandra went to the kitchen.', ' Mary discarded the football.', ' Mary took the football.', ' Daniel journeyed to the office.', ' Mary got the football.', ' Daniel travelled to the garden.', ' Mary discarded the football.']
2025-01-22 20:30:46.038 | INFO     | __main__:<module>:87 - Real Needle: [' Daniel took the apple.', ' Daniel journeyed to the office.', ' Daniel travelled to the garden.', ' Mary discarded the football.']
2025-01-22 20:30:46.038 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ§‘ğŸ½\u200dâœˆ', 'ğŸ•¯', 'âœ¡', 'ğŸ¨', 'ğŸš¢', 'ğŸ¦¸\u200dâ™€', 'ğŸƒğŸ¾\u200dâ™‚', 'ğŸš¬', 'ğŸ§¥', 'ğŸ§‘ğŸ¾\u200dâ¤\u200dğŸ’‹\u200dğŸ§‘ğŸ¿']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.22s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.45s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.19s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.93s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.43s/it]
Processing depth (1, 2, 8, 9):   0%|          | 0/100 [00:15<?, ?it/s]2025-01-22 20:31:01.999 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel took the apple.
2025-01-22 20:31:02.004 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (902, 906) -->  Daniel took the apple
2025-01-22 20:31:02.004 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the office.
2025-01-22 20:31:02.013 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1807, 1813) -->  Daniel journeyed to the office
2025-01-22 20:31:02.013 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel travelled to the garden.
2025-01-22 20:31:02.047 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6503, 6508) -->  Daniel travelled to the garden
2025-01-22 20:31:02.048 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary discarded the football.
2025-01-22 20:31:02.082 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7132, 7136) -->  discarded the football.
2025-01-22 20:31:02.082 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the bathroom.
2025-01-22 20:31:02.102 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4042, 4048) --> . Mary journeyed to the
2025-01-22 20:31:02.102 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went to the kitchen.
2025-01-22 20:31:02.106 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (809, 814) --> . Sandra went to the
2025-01-22 20:31:02.106 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary took the football.
2025-01-22 20:31:02.124 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3815, 3819) -->  took the football.
2025-01-22 20:31:02.125 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary got the football.
2025-01-22 20:31:02.146 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4490, 4494) -->  Mary got the football
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:31:02.986 | INFO     | test_jbb_embedding:begin_test:693 - Daniel took the apple.<|eot_id|>
2025-01-22 20:31:02.986 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8173])
2025-01-22 20:31:05.204 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [283.3174342105263, 33.927385321100914, 189.14144736842104, 32.98262950104461, 37.48908390410959], 'topk_indices': array([   3, 8071, 8164, 8163,    9,   23, 8156,  816,  905,  815, 8160,
       8161,  906,   14,   24,    1, 8171, 8168,    0, 8169]), 'topk_tokens': ['<|end_header_id|>', ' location', '?', ' garden', ':', '4', ':', ' Paul', ' apple', '.', ' apple', ' before', '.', '\n', '\n\n', '<|start_header_id|>', '<|end_header_id|>', '<|eot_id|>', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [609.3125, 273.7291666666667, 235.425, 31.5703125]}, 'weight': {'score': [24.68544407894737, 23.284550840978593, 21.768503289473685, 23.284819727786655, 29.58240582191781], 'topk_indices': array([3275, 3302, 3147, 3195, 7420, 7458, 1472, 1410, 4294, 4310, 5148,
       5209, 7141, 7197, 3484, 3458, 4925, 4950, 4973, 5002]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.568359375, 23.615885416666668, 25.5328125, 23.34765625]}, 'saliency': {'score': [1.8558028371710527, 0.1864086540758792, 1.0887515419407894, 0.1804036148294442, 0.2794703653413955], 'topk_indices': array([4765, 8164,   23,   20,   16,  814,    8,  811,  902, 8157, 8155,
       8071,    0, 8163,   24,  810,  816, 8161,  905, 8160]), 'topk_tokens': [' senate', '?', '4', ' Jul', ' Date', ' kitchen', ' Date', ' went', ' Daniel', ' Where', 'Question', ' location', '<|begin_of_text|>', ' garden', '\n\n', ' Sandra', ' Paul', ' before', ' apple', ' apple'], 'evidence_proportions': [4.20068359375, 1.65185546875, 1.54609375, 0.2039794921875]}}, 'pred_res': 'Daniel took the apple.<|eot_id|>', 'score': 0}
2025-01-22 20:31:05.213 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:31:05.214 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-186_pid-0_1-2-8-9.pkl | len: 3 |  size: 2.04 KB
Processing depth (1, 2, 8, 9):   1%|          | 1/100 [00:19<31:29, 19.08s/it]is_0k: False
your chose emoji: ['ğŸ›…', 'ğŸ§‘ğŸ½\u200dğŸ¦¯\u200dâ¡', 'ğŸ§›ğŸ¿\u200dâ™‚ï¸', 'ğŸƒğŸ¼\u200dâ™‚', 'â„', 'ğŸ‹ğŸ¾', 'ğŸ§›ğŸ½\u200dâ™‚ï¸', 'ğŸ‘§ğŸ¼', 'ğŸ¤¾ğŸ½\u200dâ™€', 'ğŸ§˜\u200dâ™‚']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.33s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.38s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.27s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.94s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.45s/it]
Processing depth (2, 3, 6, 7):   1%|          | 1/100 [00:34<31:29, 19.08s/it]2025-01-22 20:31:20.853 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel took the apple.
2025-01-22 20:31:20.863 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1854, 1858) -->  Daniel took the apple
2025-01-22 20:31:20.863 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the office.
2025-01-22 20:31:20.878 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2920, 2926) --> . Daniel journeyed to the
2025-01-22 20:31:20.878 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel travelled to the garden.
2025-01-22 20:31:20.901 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4746, 4751) -->  the senate. Daniel travelled
2025-01-22 20:31:20.902 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary discarded the football.
2025-01-22 20:31:20.929 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5633, 5637) -->  Mary discarded the football
2025-01-22 20:31:20.929 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the bathroom.
2025-01-22 20:31:20.950 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4086, 4092) --> . Mary journeyed to the
2025-01-22 20:31:20.950 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went to the kitchen.
2025-01-22 20:31:20.954 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (809, 814) --> . Sandra went to the
2025-01-22 20:31:20.954 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary took the football.
2025-01-22 20:31:20.972 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3838, 3842) -->  Mary took the football
2025-01-22 20:31:20.972 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary got the football.
2025-01-22 20:31:20.994 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4517, 4521) -->  got the football.
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:31:21.776 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 20:31:21.776 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8165])
2025-01-22 20:31:24.025 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [580.7796052631579, 52.1179479919187, 332.6513157894737, 50.226607670070116, 29.33392776268116], 'topk_indices': array([8154,  815, 8093, 1853,   24, 8156,  810, 1855, 8163, 8155,   14,
       8152,    3, 8160, 1858, 8153, 1854, 8161, 1857,    0]), 'topk_tokens': [' the', '.', ' the', '.', '\n\n', '?', ' Sandra', ' took', '<|end_header_id|>', ' garden', '\n', ' apple', '<|end_header_id|>', '<|eot_id|>', '.', ' before', ' Daniel', '<|start_header_id|>', ' apple', '<|begin_of_text|>'], 'evidence_proportions': [1765.25, 345.875, 299.975, 99.671875]}, 'weight': {'score': [24.90296052631579, 23.27579167687033, 21.768503289473685, 23.2755114789642, 29.429121376811594], 'topk_indices': array([3261, 3288, 3133, 3181, 7406, 7444, 1405, 1467, 4274, 4258, 5177,
       5116, 7183, 7127, 3470, 3444, 4898, 4950, 4873, 4921]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.568359375, 20.270833333333332, 25.746875, 29.130859375]}, 'saliency': {'score': [3.811253597861842, 0.28960064369183913, 2.0267655222039473, 0.27730915164841924, 0.2110657622848732], 'topk_indices': array([  32, 8150, 8053, 8063, 8091,   24,  811, 8149, 8156,    0, 8019,
       8147,  814, 1855, 8153, 8155, 8152,  810, 1854, 1857]), 'topk_tokens': ['***', ' was', '.\n\n', ' location', ' moved', '\n\n', ' went', ' Where', '?', '<|begin_of_text|>', ' context', 'Question', ' kitchen', ' took', ' before', ' garden', ' apple', ' Sandra', ' Daniel', ' apple'], 'evidence_proportions': [12.4619140625, 1.759765625, 1.79052734375, 0.76373291015625]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 0}
2025-01-22 20:31:24.032 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:31:24.033 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-186_pid-1_2-3-6-7.pkl | len: 3 |  size: 2.02 KB
Processing depth (2, 3, 6, 7):   2%|â–         | 2/100 [00:37<30:54, 18.93s/it]is_0k: False
your chose emoji: ['ğŸ‘©ğŸ¼\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘©ğŸ½', 'ğŸ§‘ğŸ¼\u200dğŸ¤', 'ğŸ‘', 'ğŸ‡µğŸ‡¾', 'ğŸ‡¦ğŸ‡±', 'ğŸ’ƒğŸ¾', 'ğŸ¥™', 'ğŸƒğŸ¾\u200dâ™€\u200dâ¡', '\U0001fa7b', 'ğŸ‘—']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.18s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:09,  4.53s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.26s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.77s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.35s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 3, 6, 7):   2%|â–         | 2/100 [00:53<30:54, 18.93s/it]2025-01-22 20:31:39.704 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel took the apple.
2025-01-22 20:31:39.743 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the office.
2025-01-22 20:31:39.756 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2588, 2594) --> . Daniel journeyed to the
2025-01-22 20:31:39.756 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel travelled to the garden.
2025-01-22 20:31:39.779 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4593, 4598) -->  Daniel travelled to the garden
2025-01-22 20:31:39.779 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary discarded the football.
2025-01-22 20:31:39.806 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5555, 5559) -->  Mary discarded the football
2025-01-22 20:31:39.806 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the bathroom.
2025-01-22 20:31:39.825 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3898, 3904) --> . Mary journeyed to the
2025-01-22 20:31:39.826 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went to the kitchen.
2025-01-22 20:31:39.829 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (638, 643) --> . Sandra went to the
2025-01-22 20:31:39.829 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary took the football.
2025-01-22 20:31:39.850 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3662, 3666) -->  Mary took the football
2025-01-22 20:31:39.851 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary got the football.
2025-01-22 20:31:39.872 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4342, 4346) -->  Mary got the football
2025-01-22 20:31:39.872 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 20:31:39.873 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 20:31:39.873 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 20:31:39.873 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ•¯', '\U0001faf1ğŸ¿\u200d\U0001faf2ğŸ½', 'âš½', 'ğŸ‘©ğŸ¾\u200dğŸ¦°', 'ğŸ‡±ğŸ‡º', 'ğŸ»', 'ğŸ‘µğŸ½', 'ğŸ”', 'ğŸš', 'ğŸ‘²ğŸ½']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.06s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.23s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.39s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.20s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.59s/it]
Processing depth (0, 2, 7, 9):   2%|â–         | 2/100 [01:09<30:54, 18.93s/it]2025-01-22 20:31:55.900 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel took the apple.
2025-01-22 20:31:55.946 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the office.
2025-01-22 20:31:55.955 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1800, 1806) --> . Daniel journeyed to the
2025-01-22 20:31:55.955 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel travelled to the garden.
2025-01-22 20:31:55.982 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5601, 5606) -->  Daniel travelled to the garden
2025-01-22 20:31:55.982 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary discarded the football.
2025-01-22 20:31:56.021 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7096, 7100) -->  discarded the football.
2025-01-22 20:31:56.022 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the bathroom.
2025-01-22 20:31:56.042 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4038, 4044) --> . Mary journeyed to the
2025-01-22 20:31:56.042 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went to the kitchen.
2025-01-22 20:31:56.045 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (772, 777) --> . Sandra went to the
2025-01-22 20:31:56.045 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary took the football.
2025-01-22 20:31:56.063 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3822, 3826) -->  Mary took the football
2025-01-22 20:31:56.064 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary got the football.
2025-01-22 20:31:56.088 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4486, 4490) -->  Mary got the football
2025-01-22 20:31:56.088 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 20:31:56.088 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 20:31:56.088 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 20:31:56.088 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ’ªğŸ¼', 'ğŸˆ', 'ğŸ„ğŸ»\u200dâ™€', 'âœ‹ğŸ¼', 'ğŸ‘©ğŸ¿\u200dğŸ”§', 'ğŸŒ', 'â›¹ğŸ¾', 'ğŸ¤³ğŸ»', 'ğŸ‰', 'ğŸ‘¨ğŸ¾\u200dğŸ¦¯']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.33s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.28s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.26s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.98s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.46s/it]
Processing depth (2, 7, 8, 9):   2%|â–         | 2/100 [01:25<30:54, 18.93s/it]2025-01-22 20:32:11.711 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel took the apple.
2025-01-22 20:32:11.722 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1818, 1822) -->  Daniel took the apple
2025-01-22 20:32:11.723 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the office.
2025-01-22 20:32:11.754 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5656, 5662) -->  Daniel journeyed to the office
2025-01-22 20:32:11.754 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel travelled to the garden.
2025-01-22 20:32:11.789 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6638, 6643) --> . Daniel travelled to the
2025-01-22 20:32:11.789 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary discarded the football.
2025-01-22 20:32:11.826 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7289, 7293) -->  Mary discarded the football
2025-01-22 20:32:11.826 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the bathroom.
2025-01-22 20:32:11.847 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4131, 4137) --> . Mary journeyed to the
2025-01-22 20:32:11.847 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went to the kitchen.
2025-01-22 20:32:11.850 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (673, 678) --> . Sandra went to the
2025-01-22 20:32:11.850 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary took the football.
2025-01-22 20:32:11.871 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3881, 3885) -->  Mary took the football
2025-01-22 20:32:11.871 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary got the football.
2025-01-22 20:32:11.894 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4546, 4550) -->  got the football.
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:32:12.743 | INFO     | test_jbb_embedding:begin_test:693 - Daniel took the apple.<|eot_id|>
2025-01-22 20:32:12.743 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8177])
2025-01-22 20:32:14.962 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [391.57894736842104, 41.99503301137058, 194.14638157894737, 40.82405033165459, 45.294270833333336], 'topk_indices': array([8031, 2134,    4, 8091, 8103, 8079,   24, 8075,    1,    9, 8104,
       2144, 8065, 8105, 1821,   14, 8175,    0, 8173, 8172]), 'topk_tokens': [' context', ' du', '\n\n', '.\n', ' moved', ' the', '\n\n', ' location', '<|start_header_id|>', ':', ' to', ' the', '.\n\n', ' the', ' apple', '\n', '<|end_header_id|>', '<|begin_of_text|>', '<|start_header_id|>', '<|eot_id|>'], 'evidence_proportions': [801.0, 498.6666666666667, 208.6, 50.25]}, 'weight': {'score': [24.715049342105264, 23.29915599400905, 21.768503289473685, 23.299423826925437, 30.210833333333333], 'topk_indices': array([3284, 3311, 3204, 3156, 7418, 7456, 1453, 1515, 4297, 4313, 5119,
       5180, 7124, 7180, 3467, 3493, 4973, 4896, 4921, 4944]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.568359375, 23.615885416666668, 21.01875, 29.130859375]}, 'saliency': {'score': [2.477747866981908, 0.23340813864966684, 1.1370945980674343, 0.22606106856402008, 0.3512274169921875], 'topk_indices': array([2143,   24, 8159,   14, 2087, 8077, 2133,  674, 8167, 8165, 5661,
          8, 1818, 8164, 2134, 8065, 8031, 8103, 8075, 1821]), 'topk_tokens': [' up', '\n\n', 'Question', '\n', ' Ch', ' traveled', 'irie', ' Sandra', ' garden', ' before', ' office', ' Date', ' Daniel', ' apple', ' du', '.\n\n', ' context', ' moved', ' location', ' apple'], 'evidence_proportions': [5.613525390625, 2.9191080729166665, 1.1138671875, 0.3847808837890625]}}, 'pred_res': 'Daniel took the apple.<|eot_id|>', 'score': 0}
2025-01-22 20:32:14.967 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:32:14.967 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-186_pid-2_2-7-8-9.pkl | len: 3 |  size: 2.02 KB
Processing depth (2, 7, 8, 9):   3%|â–         | 3/100 [01:28<54:13, 33.54s/it]is_0k: False
your chose emoji: ['ğŸ‘³\u200dâ™€', 'ğŸ™†ğŸ¾\u200dâ™‚ï¸', 'ğŸ‘¨\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘¨', 'âœŒï¸', 'ğŸ‘©ğŸ¾\u200dâ¤\u200dğŸ’‹\u200dğŸ‘©ğŸ¾', '\U0001faf1ğŸ¼', 'ğŸ‘±ğŸ¿\u200dâ™‚', 'ğŸ‡ğŸ¾', 'ğŸ’”', 'ğŸ¤Œ']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.24s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.74s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.67s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.19s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.71s/it]
Processing depth (1, 5, 7, 8):   3%|â–         | 3/100 [01:45<54:13, 33.54s/it]2025-01-22 20:32:31.603 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel took the apple.
2025-01-22 20:32:31.607 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (902, 906) -->  Daniel took the apple
2025-01-22 20:32:31.608 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the office.
2025-01-22 20:32:31.628 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4150, 4156) --> . Daniel journeyed to the
2025-01-22 20:32:31.628 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel travelled to the garden.
2025-01-22 20:32:31.655 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5591, 5596) -->  Daniel travelled to the garden
2025-01-22 20:32:31.656 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary discarded the football.
2025-01-22 20:32:31.686 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6589, 6593) -->  Mary discarded the football
2025-01-22 20:32:31.686 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the bathroom.
2025-01-22 20:32:31.706 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4057, 4063) --> . Mary journeyed to the
2025-01-22 20:32:31.707 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went to the kitchen.
2025-01-22 20:32:31.711 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (809, 814) --> . Sandra went to the
2025-01-22 20:32:31.711 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary took the football.
2025-01-22 20:32:31.729 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3819, 3823) -->  Mary took the football
2025-01-22 20:32:31.729 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary got the football.
2025-01-22 20:32:31.750 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4490, 4494) -->  Mary got the football
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:32:32.585 | INFO     | test_jbb_embedding:begin_test:693 - Daniel took the apple.<|eot_id|>
2025-01-22 20:32:32.585 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8135])
2025-01-22 20:32:34.802 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [619.2894736842105, 61.86643572569743, 508.02467105263156, 59.512065532781826, 77.39366319444444], 'topk_indices': array([ 906,  810, 8033,    4, 8037, 8118,    1,   24,  905, 8023, 8123,
       8122,  816,  815,    9, 8133,   14, 8130,    0, 8131]), 'topk_tokens': ['.', ' Sandra', ' location', '\n\n', ' the', ':', '<|start_header_id|>', '\n\n', ' apple', '.\n\n', ' before', ' apple', ' Paul', '.', ':', '<|end_header_id|>', '\n', '<|eot_id|>', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [1118.5, 539.5, 715.75, 119.1875]}, 'weight': {'score': [24.846628289473685, 23.252386859407643, 22.986019736842106, 23.249271707926905, 29.375], 'topk_indices': array([3299, 3272, 3144, 3192, 7362, 7400, 1496, 1434, 4294, 4310, 5116,
       5177, 7083, 7139, 3481, 3455, 4893, 4941, 4918, 4970]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.568359375, 20.270833333333332, 25.5328125, 29.130859375]}, 'saliency': {'score': [4.007606907894737, 0.33952790037982367, 2.991866262335526, 0.3247003994513212, 0.5768534342447916], 'topk_indices': array([   9, 5592,   14, 8035,  257, 8023, 8117,   32, 8119,  811, 8125,
          8,  902, 8033,  814, 8123,  905,  810, 8122,  816]), 'topk_tokens': [':', ' travelled', '\n', ' traveled', 'hue', '.\n\n', 'Question', '***', ' Where', ' went', ' garden', ' Date', ' Daniel', ' location', ' kitchen', ' before', ' apple', ' Sandra', ' apple', ' Paul'], 'evidence_proportions': [7.76953125, 2.8943684895833335, 4.80625, 0.917236328125]}}, 'pred_res': 'Daniel took the apple.<|eot_id|>', 'score': 0}
2025-01-22 20:32:34.808 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:32:34.808 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-186_pid-3_1-5-7-8.pkl | len: 3 |  size: 2.02 KB
Processing depth (1, 5, 7, 8):   4%|â–         | 4/100 [01:48<45:00, 28.13s/it]is_0k: False
your chose emoji: ['ğŸ§™ğŸ¼', 'ğŸˆš', 'ğŸ§™ğŸ¾\u200dâ™€ï¸', 'ğŸ¤¼\u200dâ™‚', 'ğŸ³', 'â™‰', 'ğŸ‘©ğŸ¼', 'ğŸ‘ƒ', 'ğŸŠğŸ¿', 'ğŸ§ğŸ¼\u200dâ™‚ï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  3.77s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.26s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.38s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.05s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.48s/it]
Processing depth (2, 5, 6, 7):   4%|â–         | 4/100 [02:04<45:00, 28.13s/it]2025-01-22 20:32:50.710 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel took the apple.
2025-01-22 20:32:50.721 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1744, 1748) -->  Daniel took the apple
2025-01-22 20:32:50.721 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the office.
2025-01-22 20:32:50.745 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4170, 4176) --> . Daniel journeyed to the
2025-01-22 20:32:50.745 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel travelled to the garden.
2025-01-22 20:32:50.772 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4760, 4765) --> . Daniel travelled to the
2025-01-22 20:32:50.772 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary discarded the football.
2025-01-22 20:32:50.801 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5681, 5685) -->  Mary discarded the football
2025-01-22 20:32:50.801 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the bathroom.
2025-01-22 20:32:50.824 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4004, 4010) -->  to the ground. Mary journey
2025-01-22 20:32:50.824 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went to the kitchen.
2025-01-22 20:32:50.829 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (757, 762) --> . Sandra went to the
2025-01-22 20:32:50.829 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary took the football.
2025-01-22 20:32:50.850 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3811, 3815) -->  Mary took the football
2025-01-22 20:32:50.851 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary got the football.
2025-01-22 20:32:50.873 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4492, 4496) -->  Mary got the football
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:32:51.673 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 20:32:51.673 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8177])
2025-01-22 20:32:53.908 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [651.8125, 56.94099217508253, 343.9671052631579, 54.882761638619336, 42.15244791666667], 'topk_indices': array([4766,  763,   24,    1, 8158, 8031, 8164, 1743, 8168,    3,   14,
       1745, 8167, 8165, 1747, 8175, 1744, 8172, 8173,    0]), 'topk_tokens': ['.', '.', '\n\n', '<|start_header_id|>', '.\n\n', ' context', ' apple', '.', '?', '<|end_header_id|>', '\n', ' took', ' garden', ' before', ' apple', '<|end_header_id|>', ' Daniel', '<|eot_id|>', '<|start_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [1625.125, 471.375, 464.7, 183.046875]}, 'weight': {'score': [23.658717105263158, 23.284186254432083, 23.545230263157894, 23.282702908119397, 29.394583333333333], 'topk_indices': array([3312, 3339, 3184, 3232, 7430, 7468, 1491, 1429, 4358, 4342, 5225,
       5164, 7207, 7151, 3521, 3495, 4989, 4941, 5018, 4966]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.568359375, 20.270833333333332, 21.01875, 29.130859375]}, 'saliency': {'score': [4.139057360197368, 0.31943868013739457, 2.0765573601973686, 0.30642332454934895, 0.3170947265625], 'topk_indices': array([4765,  626,  759, 8158,    0, 8168, 1533, 8161, 4176,  257,  762,
       8031,  758, 8159, 1745, 8164, 8165, 8167, 1747, 1744]), 'topk_tokens': [' garden', 'ï¿½', ' went', '.\n\n', '<|begin_of_text|>', '?', 'rich', ' Where', ' office', 'hue', ' kitchen', ' context', ' Sandra', 'Question', ' took', ' apple', ' before', ' garden', ' apple', ' Daniel'], 'evidence_proportions': [11.67822265625, 2.458251953125, 2.320703125, 1.39404296875]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 0}
2025-01-22 20:32:53.913 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:32:53.914 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-186_pid-4_2-5-6-7.pkl | len: 3 |  size: 2.04 KB
Processing depth (2, 5, 6, 7):   5%|â–Œ         | 5/100 [02:07<39:23, 24.88s/it]Processing depth (2, 5, 6, 7):   5%|â–Œ         | 5/100 [02:07<40:29, 25.57s/it]
2025-01-22 20:32:53.977 | INFO     | __main__:<module>:82 - Selected idx: 188
2025-01-22 20:32:53.977 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the apple before the office? 
2025-01-22 20:32:53.977 | INFO     | __main__:<module>:84 - Answer: bathroom
2025-01-22 20:32:53.977 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 20:32:53.977 | INFO     | __main__:<module>:86 - Needle: [' Mary got the football.', ' John got the apple.', ' Mary journeyed to the bathroom.', ' John journeyed to the bathroom.', ' Mary grabbed the milk.', ' John went to the office.', ' Mary discarded the milk.']
2025-01-22 20:32:53.977 | INFO     | __main__:<module>:87 - Real Needle: [' John got the apple.', ' John journeyed to the bathroom.', ' John went to the office.', ' Mary discarded the milk.']
2025-01-22 20:32:53.977 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ¤¦ğŸ¿\u200dâ™‚ï¸', 'ğŸ§ğŸ¼\u200dâ™‚', 'ğŸ“³', 'ğŸ§‘ğŸ»\u200dğŸ³', 'ğŸ‚ğŸ¿', 'ğŸ¤¹\u200dâ™‚', 'ğŸ‘·ğŸ¼\u200dâ™‚', 'ğŸ¦š', 'ğŸ‘©ğŸ½\u200dâ¤ï¸\u200dğŸ‘¨ğŸ»', 'ğŸ¤Ÿ']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.05s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.29s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.23s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.91s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.39s/it]
Processing depth (6, 7, 8, 9):   0%|          | 0/100 [00:15<?, ?it/s]2025-01-22 20:33:09.750 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John got the apple.
2025-01-22 20:33:09.772 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4741, 4745) -->  John got the apple
2025-01-22 20:33:09.773 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bathroom.
2025-01-22 20:33:09.801 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5615, 5621) --> . John journeyed to the
2025-01-22 20:33:09.801 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went to the office.
2025-01-22 20:33:09.833 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6605, 6610) --> . John went to the
2025-01-22 20:33:09.833 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary discarded the milk.
2025-01-22 20:33:09.868 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7328, 7332) -->  Mary discarded the milk
2025-01-22 20:33:09.868 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the football.
2025-01-22 20:33:09.885 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3562, 3566) -->  Mary got the football
2025-01-22 20:33:09.885 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the bathroom.
2025-01-22 20:33:09.913 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5616, 5622) -->  John journeyed to the bathroom
2025-01-22 20:33:09.914 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary grabbed the milk.
2025-01-22 20:33:09.949 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (7512, 7516) -->  grabbed the milk.
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:33:10.807 | INFO     | test_jbb_embedding:begin_test:693 - The house of representatives.<|eot_id|>
2025-01-22 20:33:10.807 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8145])
2025-01-22 20:33:13.018 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [135.42146381578948, 12.956443490733923, 127.18108258928571, 12.47265047365989, 13.186617943548388], 'topk_indices': array([4744, 4745,    4, 8144, 8127, 8139, 8132, 8135,   23, 8126, 8128,
       8133,    1,    3,   14,   24, 8141,    0, 8143, 8140]), 'topk_tokens': [' apple', '.', '\n\n', '\n\n', 'Question', ':', ' apple', ' office', '4', '.\n\n', ':', ' before', '<|start_header_id|>', '<|end_header_id|>', '\n', '\n\n', '<|start_header_id|>', '<|begin_of_text|>', '<|end_header_id|>', '<|eot_id|>'], 'evidence_proportions': [210.625, 189.92708333333334, 103.4625, 18.408203125]}, 'weight': {'score': [22.445723684210527, 23.25151110702013, 24.284598214285715, 23.25161544978435, 28.613407258064516], 'topk_indices': array([3272, 3245, 3117, 3165, 7387, 7349, 1481, 1419, 4271, 4287, 5160,
       5099, 7065, 7121, 3428, 3454, 4912, 4864, 4941, 4889]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [25.396484375, 19.4140625, 18.6375, 28.802734375]}, 'saliency': {'score': [0.7903185392680921, 0.07030766093385647, 0.8575363159179688, 0.0672637412963792, 0.09408077116935484], 'topk_indices': array([   0, 8114, 8128,   20,   16,   23, 8129, 5617, 5616, 8142, 8138,
       7999, 8126, 5621, 4744, 8135, 8127,   24, 8132, 8133]), 'topk_tokens': ['<|begin_of_text|>', ' return', ':', ' Jul', ' Date', '4', ' Where', ' journey', ' John', 'assistant', 'Answer', ' context', '.\n\n', ' bathroom', ' apple', ' office', 'Question', '\n\n', ' apple', ' before'], 'evidence_proportions': [1.41400146484375, 1.0545857747395833, 0.4924072265625, 0.1426239013671875]}}, 'pred_res': 'The house of representatives.<|eot_id|>', 'score': 0}
2025-01-22 20:33:13.028 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:33:13.028 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-188_pid-0_6-7-8-9.pkl | len: 3 |  size: 2.05 KB
Processing depth (6, 7, 8, 9):   1%|          | 1/100 [00:18<31:17, 18.96s/it]is_0k: False
your chose emoji: ['ğŸ‘¶', 'ğŸ‘¨ğŸ»\u200dğŸ¦³', 'ğŸ‡¬ğŸ‡§', 'ğŸ‡¹ğŸ‡·', 'ğŸ˜˜', 'ğŸ§‘ğŸ¼\u200dâš•', 'ğŸ‘¨ğŸ»\u200dğŸ”§', 'ğŸ§”\u200dâ™‚', 'ğŸ¤ğŸ½', 'ğŸ–Œ']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.30s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.54s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.23s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.94s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.46s/it]
Processing depth (2, 3, 7, 9):   1%|          | 1/100 [00:34<31:17, 18.96s/it]2025-01-22 20:33:28.674 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John got the apple.
2025-01-22 20:33:28.683 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1740, 1744) -->  John got the apple
2025-01-22 20:33:28.683 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bathroom.
2025-01-22 20:33:28.697 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2878, 2884) --> . John journeyed to the
2025-01-22 20:33:28.698 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went to the office.
2025-01-22 20:33:28.725 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5694, 5699) --> . John went to the
2025-01-22 20:33:28.725 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary discarded the milk.
2025-01-22 20:33:28.763 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7260, 7264) -->  Mary discarded the milk
2025-01-22 20:33:28.763 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the football.
2025-01-22 20:33:28.779 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3446, 3450) -->  Mary got the football
2025-01-22 20:33:28.779 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the bathroom.
2025-01-22 20:33:28.793 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2879, 2885) -->  John journeyed to the bathroom
2025-01-22 20:33:28.793 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary grabbed the milk.
2025-01-22 20:33:28.834 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (7459, 7463) -->  Mary grabbed the milk
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:33:29.604 | INFO     | test_jbb_embedding:begin_test:693 - The office<|eot_id|>
2025-01-22 20:33:29.604 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8163])
2025-01-22 20:33:31.870 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [219.36513157894737, 19.5495461364193, 186.79910714285714, 18.794844307143734, 13.751182878521126], 'topk_indices': array([8061, 8051, 8057, 1741, 1742, 1744, 1740, 8154, 8144,   24,    3,
         14, 8058, 8159, 8151, 8153, 8161, 1743, 8158,    0]), 'topk_tokens': [' location', '.\n\n', ' item', ' got', ' the', '.', ' John', '?', '.\n\n', '\n\n', '<|end_header_id|>', '\n', ' in', '<|start_header_id|>', ' before', ' office', '<|end_header_id|>', ' apple', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [588.75, 185.85416666666666, 117.7875, 27.21875]}, 'weight': {'score': [22.445723684210527, 23.283389205241246, 25.936941964285715, 23.280778349010205, 29.766945422535212], 'topk_indices': array([3306, 3279, 3199, 3151, 7399, 7437, 1431, 1493, 4263, 4279, 5135,
       5074, 7151, 7095, 3493, 3467, 4851, 4928, 4899, 4876]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [25.396484375, 19.4140625, 18.6375, 28.802734375]}, 'saliency': {'score': [1.308082982113487, 0.10958181395707048, 1.2274431501116072, 0.1048576554791244, 0.10148534640459947], 'topk_indices': array([8058, 8051, 8156, 8147,   24, 8017, 8144, 8154, 8055, 8061, 8145,
       8057, 8150, 3449, 1741, 1740, 2884, 8151, 8153, 1743]), 'topk_tokens': [' in', '.\n\n', 'Answer', ' Where', '\n\n', ' context', '.\n\n', '?', ' obtained', ' location', 'Question', ' item', ' apple', ' football', ' got', ' John', ' bathroom', ' before', ' office', ' apple'], 'evidence_proportions': [3.873046875, 0.908447265625, 0.619384765625, 0.2034454345703125]}}, 'pred_res': 'The office<|eot_id|>', 'score': 0}
2025-01-22 20:33:31.878 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:33:31.878 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-188_pid-1_2-3-7-9.pkl | len: 3 |  size: 2.02 KB
Processing depth (2, 3, 7, 9):   2%|â–         | 2/100 [00:37<30:51, 18.90s/it]is_0k: False
your chose emoji: ['ğŸ¤·ğŸ»\u200dâ™€', 'ğŸ‘©ğŸ»\u200dâ¤ï¸\u200dğŸ‘©ğŸ»', 'ğŸ’ˆ', 'ğŸ’‡ğŸ¿\u200dâ™€', 'ğŸ¤–', 'ğŸª‚', 'ğŸ§‘ğŸ¼\u200dğŸ¨', 'ğŸš¶ğŸ¿\u200dâ™‚ï¸\u200dâ¡ï¸', 'â—»', 'ğŸ§›ğŸ½']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.27s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:09,  4.53s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.48s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.15s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.63s/it]
Processing depth (2, 6, 8, 9):   2%|â–         | 2/100 [00:54<30:51, 18.90s/it]2025-01-22 20:33:48.223 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John got the apple.
2025-01-22 20:33:48.231 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1726, 1730) -->  John got the apple
2025-01-22 20:33:48.232 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bathroom.
2025-01-22 20:33:48.256 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4719, 4725) --> . John journeyed to the
2025-01-22 20:33:48.257 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went to the office.
2025-01-22 20:33:48.288 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6597, 6602) --> . John went to the
2025-01-22 20:33:48.288 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary discarded the milk.
2025-01-22 20:33:48.324 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7117, 7121) -->  discarded the milk.
2025-01-22 20:33:48.324 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the football.
2025-01-22 20:33:48.343 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3473, 3477) -->  Mary got the football
2025-01-22 20:33:48.343 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the bathroom.
2025-01-22 20:33:48.366 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4720, 4726) -->  John journeyed to the bathroom
2025-01-22 20:33:48.366 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary grabbed the milk.
2025-01-22 20:33:48.403 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (7389, 7393) -->  Mary grabbed the milk
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:33:49.188 | INFO     | test_jbb_embedding:begin_test:693 - The capitol<|eot_id|>
2025-01-22 20:33:49.189 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8155])
2025-01-22 20:33:51.420 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [495.20723684210526, 40.596040696249084, 305.39955357142856, 39.07667307692308, 22.248979710820894], 'topk_indices': array([   9, 1235, 8141, 8151, 1725, 1727,   14, 1726, 1728, 8143, 8142,
       8145, 8153, 1236, 8154, 8155, 1730, 1729, 8150,    0]), 'topk_tokens': [':', 'ï¿½', ' the', '<|start_header_id|>', '.', ' got', '\n', ' John', ' the', ' before', ' apple', ' office', '<|end_header_id|>', 'ï¿½', '\n\n', 'b', '.', ' apple', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [1065.125, 422.625, 449.525, 91.265625]}, 'weight': {'score': [21.228207236842106, 23.26482440549154, 25.936941964285715, 23.264982692307694, 29.023787313432837], 'topk_indices': array([3254, 3281, 3126, 3174, 7448, 7410, 1485, 1423, 4322, 4306, 5191,
       5130, 7182, 7126, 3437, 3463, 4901, 4926, 4949, 4978]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [25.396484375, 19.4140625, 18.6375, 23.01953125]}, 'saliency': {'score': [2.961888363486842, 0.22938202794611118, 2.071162632533482, 0.21981863731971155, 0.16274432281949627], 'topk_indices': array([   0, 6602, 8139, 8053, 1234, 6599, 6598, 3476, 8154, 1235, 4725,
       1727, 8143, 4721, 8155, 1726, 1236, 8145, 8142, 1729]), 'topk_tokens': ['<|begin_of_text|>', ' office', ' Where', ' location', 'ï¿½', ' went', ' John', ' football', '\n\n', 'ï¿½', ' bathroom', ' got', ' before', ' journey', 'b', ' John', 'ï¿½', ' office', ' apple', ' apple'], 'evidence_proportions': [6.974609375, 2.3516438802083335, 2.449609375, 0.5048828125]}}, 'pred_res': 'The capitol<|eot_id|>', 'score': 0}
2025-01-22 20:33:51.428 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:33:51.428 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-188_pid-2_2-6-8-9.pkl | len: 3 |  size: 2.0 KB
Processing depth (2, 6, 8, 9):   3%|â–         | 3/100 [00:57<31:01, 19.19s/it]is_0k: False
your chose emoji: ['ğŸ§‘ğŸ»\u200dğŸ„', 'ğŸ‘¨\u200dğŸ¦½', 'ğŸ§™ğŸ¿', 'ğŸ“‹', '\U0001fadf', 'ğŸ‘©ğŸ»\u200dğŸ¤\u200dğŸ‘¨ğŸ½', 'ğŸ™‹ğŸ»\u200dâ™‚ï¸', 'ğŸ‘…', 'ğŸ‡ºğŸ‡³', 'â']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.12s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.17s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.26s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.96s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.41s/it]
Processing depth (3, 4, 8, 9):   3%|â–         | 3/100 [01:12<31:01, 19.19s/it]2025-01-22 20:34:06.959 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John got the apple.
2025-01-22 20:34:06.973 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2888, 2892) -->  John got the apple
2025-01-22 20:34:06.973 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bathroom.
2025-01-22 20:34:06.993 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3538, 3544) -->  John journeyed to the bathroom
2025-01-22 20:34:06.993 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went to the office.
2025-01-22 20:34:07.027 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6477, 6482) --> . John went to the
2025-01-22 20:34:07.027 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary discarded the milk.
2025-01-22 20:34:07.065 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7107, 7111) -->  discarded the milk.
2025-01-22 20:34:07.065 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the football.
2025-01-22 20:34:07.082 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3340, 3344) -->  got the football.
2025-01-22 20:34:07.082 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the bathroom.
2025-01-22 20:34:07.102 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3539, 3545) -->  journeyed to the bathroom.
2025-01-22 20:34:07.103 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary grabbed the milk.
2025-01-22 20:34:07.144 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (7379, 7383) -->  Mary grabbed the milk
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:34:08.006 | INFO     | test_jbb_embedding:begin_test:693 - John got the apple.<|eot_id|>
2025-01-22 20:34:08.006 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8159])
2025-01-22 20:34:10.225 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [186.2590460526316, 18.329773263293312, 183.4375, 17.652917025464387, 23.18384850543478], 'topk_indices': array([7546,    9, 8047, 7898, 7501, 8142, 2891, 8140, 8146, 2892,   14,
       8057, 8053,   24, 8147, 8054, 8157, 8155, 8154,    0]), 'topk_tokens': ['nes', ':', '.\n\n', ' Square', 'nes', ':', ' apple', '.\n\n', ' apple', '.', '\n', ' location', ' item', '\n\n', ' before', ' in', '<|end_header_id|>', '<|start_header_id|>', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [338.125, 231.375, 124.9125, 43.40234375]}, 'weight': {'score': [22.72532894736842, 23.27370742465082, 22.905691964285715, 23.27562296254152, 29.382246376811594], 'topk_indices': array([3288, 3315, 3160, 3208, 7438, 7400, 1399, 1461, 4357, 4341, 5213,
       5152, 7116, 7172, 3482, 3508, 4977, 4929, 5006, 4954]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [25.396484375, 24.154947916666668, 18.6375, 23.01953125]}, 'saliency': {'score': [1.1545088918585527, 0.10276361085479968, 1.081298828125, 0.09862009340113329, 0.1694258537845335], 'topk_indices': array([8054, 8143, 2889, 8140, 8013,   24, 8149, 3342, 7546, 8051, 7545,
       8141, 7501, 7898, 3543, 8147, 8057, 2891, 8053, 8146]), 'topk_tokens': [' in', ' Where', ' got', '.\n\n', ' context', '\n\n', ' office', ' football', 'nes', ' obtained', ' Min', 'Question', 'nes', ' Square', ' bathroom', ' before', ' location', ' apple', ' item', ' apple'], 'evidence_proportions': [2.201904296875, 1.53759765625, 0.57861328125, 0.252349853515625]}}, 'pred_res': 'John got the apple.<|eot_id|>', 'score': 0}
2025-01-22 20:34:10.232 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:34:10.232 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-188_pid-3_3-4-8-9.pkl | len: 3 |  size: 2.01 KB
Processing depth (3, 4, 8, 9):   4%|â–         | 4/100 [01:16<30:27, 19.04s/it]is_0k: False
your chose emoji: ['âœ´ï¸', 'ğŸ§‘ğŸ¼\u200dğŸ¦¯\u200dâ¡ï¸', '\U0001fac4ğŸ½', 'ğŸ¦¼', '\U0001fa75', 'ğŸ¤¾ğŸ¿\u200dâ™‚', 'ğŸ§‘ğŸ¿\u200dğŸš’', 'ğŸª•', 'ğŸ¤µğŸ»\u200dâ™‚', 'ğŸŒğŸ½\u200dâ™€ï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.19s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.50s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.37s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.02s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.52s/it]
Processing depth (1, 4, 7, 8):   4%|â–         | 4/100 [01:32<30:27, 19.04s/it]2025-01-22 20:34:26.219 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John got the apple.
2025-01-22 20:34:26.227 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (830, 834) -->  John got the apple
2025-01-22 20:34:26.227 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bathroom.
2025-01-22 20:34:26.247 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3579, 3585) --> . John journeyed to the
2025-01-22 20:34:26.248 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went to the office.
2025-01-22 20:34:26.275 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5638, 5643) --> . John went to the
2025-01-22 20:34:26.275 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary discarded the milk.
2025-01-22 20:34:26.307 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6602, 6606) -->  Mary discarded the milk
2025-01-22 20:34:26.307 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the football.
2025-01-22 20:34:26.326 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3355, 3359) -->  Mary got the football
2025-01-22 20:34:26.326 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the bathroom.
2025-01-22 20:34:26.345 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3580, 3586) -->  John journeyed to the bathroom
2025-01-22 20:34:26.345 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary grabbed the milk.
2025-01-22 20:34:26.381 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (7521, 7525) -->  Mary grabbed the milk
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:34:27.244 | INFO     | test_jbb_embedding:begin_test:693 - John's house.<|eot_id|>
2025-01-22 20:34:27.244 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8187])
2025-01-22 20:34:29.459 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [155.35608552631578, 17.47084478021978, 115.52957589285714, 16.981370487005027, 11.006577089608435], 'topk_indices': array([8168,   23,  553,    1,  835,  833, 4294, 8085, 8175, 8089,  834,
          3, 4293, 8075, 8185,   24,   14, 8183, 8182,    0]), 'topk_tokens': ['.\n\n', '4', ',', '<|start_header_id|>', ' Paul', ' apple', 'ot', ' location', ' before', ' the', '.', '<|end_header_id|>', 'nes', '.\n\n', '<|end_header_id|>', '\n\n', '\n', '<|start_header_id|>', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [341.875, 181.89583333333334, 74.625, 29.94140625]}, 'weight': {'score': [22.445723684210527, 23.30165216727717, 25.936941964285715, 23.2991228775898, 29.730609939759034], 'topk_indices': array([3310, 3337, 3182, 3230, 7371, 7409, 1448, 1510, 4311, 4327, 5122,
       5183, 7092, 7148, 3498, 3524, 4924, 4947, 4976, 4899]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [25.396484375, 19.4140625, 18.6375, 28.802734375]}, 'saliency': {'score': [0.9154920076069079, 0.09650533114888583, 0.7438572474888393, 0.09348661425769278, 0.08456512818853539], 'topk_indices': array([ 836, 8081, 4292, 8079,  830, 8046,  831,  277, 8087, 4294, 8075,
       4272, 8041, 8174,   24, 8175, 8085,  835,  833, 4293]), 'topk_tokens': [' were', ' item', ' Min', ' obtained', ' John', ' locations', ' got', 'hue', ' traveled', 'ot', '.\n\n', 'nes', ' context', ' apple', '\n\n', ' before', ' location', ' Paul', ' apple', 'nes'], 'evidence_proportions': [2.248291015625, 0.9486490885416666, 0.359228515625, 0.2282867431640625]}}, 'pred_res': "John's house.<|eot_id|>", 'score': 0}
2025-01-22 20:34:29.466 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:34:29.466 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-188_pid-4_1-4-7-8.pkl | len: 3 |  size: 2.02 KB
Processing depth (1, 4, 7, 8):   5%|â–Œ         | 5/100 [01:35<30:15, 19.11s/it]Processing depth (1, 4, 7, 8):   5%|â–Œ         | 5/100 [01:35<30:13, 19.09s/it]
2025-01-22 20:34:29.511 | INFO     | __main__:<module>:82 - Selected idx: 190
2025-01-22 20:34:29.512 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the apple before the office? 
2025-01-22 20:34:29.512 | INFO     | __main__:<module>:84 - Answer: bathroom
2025-01-22 20:34:29.512 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 20:34:29.512 | INFO     | __main__:<module>:86 - Needle: [' Daniel took the apple.', ' Mary travelled to the office.', ' Mary journeyed to the hallway.', ' Daniel journeyed to the bathroom.', ' Daniel went back to the office.', ' John journeyed to the bedroom.']
2025-01-22 20:34:29.512 | INFO     | __main__:<module>:87 - Real Needle: [' Daniel took the apple.', ' Daniel journeyed to the bathroom.', ' Daniel went back to the office.', ' John journeyed to the bedroom.']
2025-01-22 20:34:29.512 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ§‘ğŸ»\u200dğŸ¤\u200dğŸ§‘ğŸ½', 'ğŸ§ğŸ½\u200dâ™‚ï¸\u200dâ¡', 'ğŸ¦°', 'ğŸ‘¨\u200dâ¤\u200dğŸ’‹\u200dğŸ‘¨', 'ğŸ§™ğŸ¿\u200dâ™‚', 'ğŸ™‹\u200dâ™€', 'ğŸ¦¶ğŸ½', 'ğŸš¼', 'ğŸ‘©ğŸ»\u200dâœˆï¸', 'ğŸ’†\u200dâ™‚']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.17s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.36s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.21s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.76s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.31s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 3, 7, 8):   0%|          | 0/100 [00:14<?, ?it/s]2025-01-22 20:34:44.570 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel took the apple.
2025-01-22 20:34:44.617 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the bathroom.
2025-01-22 20:34:44.632 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2977, 2983) -->  tragedy. Daniel journeyed to
2025-01-22 20:34:44.632 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the office.
2025-01-22 20:34:44.663 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5790, 5796) --> . Daniel went back to the
2025-01-22 20:34:44.663 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the bedroom.
2025-01-22 20:34:44.701 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6659, 6665) --> . John journeyed to the
2025-01-22 20:34:44.701 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the office.
2025-01-22 20:34:44.707 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1219, 1224) -->  Republican. Mary travelled to
2025-01-22 20:34:44.708 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the hallway.
2025-01-22 20:34:44.732 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4851, 4857) --> . Mary journeyed to the
2025-01-22 20:34:44.732 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 20:34:44.732 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 20:34:44.732 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 20:34:44.732 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸŒğŸ¾\u200dâ™‚', 'ğŸšµğŸ½\u200dâ™‚', 'ğŸ•³ï¸', 'ğŸ‘©ğŸ½\u200dğŸ¤\u200dğŸ‘©ğŸ»', 'ğŸ§šğŸ»\u200dâ™‚', 'ğŸ§‘ğŸ»\u200dğŸ¤', 'ğŸ¾', 'ğŸ‘©ğŸ¼\u200dâ¤\u200dğŸ’‹\u200dğŸ‘¨ğŸ¿', 'ğŸ§€', 'ğŸ“¸']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  3.90s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.14s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.32s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.03s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.45s/it]
Processing depth (0, 1, 3, 9):   0%|          | 0/100 [00:30<?, ?it/s]2025-01-22 20:35:00.367 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel took the apple.
2025-01-22 20:35:00.411 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the bathroom.
2025-01-22 20:35:00.417 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (900, 906) --> . Daniel journeyed to the
2025-01-22 20:35:00.417 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the office.
2025-01-22 20:35:00.434 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3049, 3055) --> . Daniel went back to the
2025-01-22 20:35:00.434 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the bedroom.
2025-01-22 20:35:00.469 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7278, 7284) -->  cold. John journeyed to
2025-01-22 20:35:00.470 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the office.
2025-01-22 20:35:00.476 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1226, 1231) -->  Republican. Mary travelled to
2025-01-22 20:35:00.476 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the hallway.
2025-01-22 20:35:00.505 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4904, 4910) --> . Mary journeyed to the
2025-01-22 20:35:00.506 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 20:35:00.506 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 20:35:00.506 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 20:35:00.506 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ‘©\u200dğŸ­', '\U0001faf8ğŸ¿', 'â¬…ï¸', 'ğŸ‘¨ğŸ¼\u200dğŸ¦¯\u200dâ¡ï¸', 'ğŸ”ˆ', 'ğŸ§ğŸ¾\u200dâ™€', 'ğŸƒğŸ½', 'ğŸ²', 'ğŸ‘©ğŸ½\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘¨ğŸ¿', 'ğŸ‘©\u200dğŸ¦½\u200dâ¡']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.14s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.12s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.07s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.82s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.29s/it]
Processing depth (1, 4, 5, 6):   0%|          | 0/100 [00:46<?, ?it/s]2025-01-22 20:35:16.542 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel took the apple.
2025-01-22 20:35:16.546 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (822, 826) -->  Daniel took the apple
2025-01-22 20:35:16.546 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the bathroom.
2025-01-22 20:35:16.565 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3714, 3720) --> . Daniel journeyed to the
2025-01-22 20:35:16.565 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the office.
2025-01-22 20:35:16.586 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4261, 4267) --> . Daniel went back to the
2025-01-22 20:35:16.587 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the bedroom.
2025-01-22 20:35:16.611 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4925, 4931) -->  John journeyed to the bedroom
2025-01-22 20:35:16.611 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the office.
2025-01-22 20:35:16.617 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1112, 1117) --> . Mary travelled to the
2025-01-22 20:35:16.617 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the hallway.
2025-01-22 20:35:16.642 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4927, 4933) --> ed to the bedroom. Mary
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:35:17.457 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's house.<|eot_id|>
2025-01-22 20:35:17.457 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8140])
2025-01-22 20:35:19.676 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [127.04829545454545, 14.378590123418887, 59.421875, 14.01185650431566, 12.347086588541666], 'topk_indices': array([8121, 8127,  823,  257,    9,    1,  822, 8028, 8038, 8130, 8123,
       8128,   14,   24, 7994,  825, 8138,    0, 8135, 8136]), 'topk_tokens': ['.\n\n', ' apple', ' took', 'hue', ':', '<|start_header_id|>', ' Daniel', '.\n\n', ' location', ' office', ':', ' before', '\n', '\n\n', ' context', ' apple', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [443.6875, 90.38541666666667, 46.640625, 33.026041666666664]}, 'weight': {'score': [22.594460227272727, 23.256623787301976, 20.68465909090909, 23.261908523427866, 29.206510416666667], 'topk_indices': array([3248, 3275, 3120, 3168, 7415, 7377, 1484, 1422, 4234, 4250, 5161,
       5100, 7142, 7086, 3457, 3431, 4877, 4854, 4829, 4906]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.568359375, 20.270833333333332, 20.927083333333332, 23.936197916666668]}, 'saliency': {'score': [0.8091153231534091, 0.08001897119266548, 0.33134321732954547, 0.07770026756126695, 0.09131011962890626], 'topk_indices': array([7993, 8121, 8122,    8,   99, 3720, 7992, 8028, 8133, 8124,  823,
         24, 8127, 8038, 8130, 8128,  822,  257, 7994,  825]), 'topk_tokens': [' you', '.\n\n', 'Question', ' Date', 'ION', ' bathroom', ' provided', '.\n\n', 'Answer', ' Where', ' took', '\n\n', ' apple', ' location', ' office', ' before', ' Daniel', 'hue', ' context', ' apple'], 'evidence_proportions': [3.0816650390625, 0.4688924153645833, 0.23604329427083334, 0.20737711588541666]}}, 'pred_res': "Daniel's house.<|eot_id|>", 'score': 0}
2025-01-22 20:35:19.683 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:35:19.683 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-190_pid-0_1-4-5-6.pkl | len: 3 |  size: 2.03 KB
Processing depth (1, 4, 5, 6):   1%|          | 1/100 [00:50<1:22:38, 50.08s/it]is_0k: False
your chose emoji: ['ğŸ‘©\u200dğŸ¦½\u200dâ¡', 'ğŸ©°', 'ğŸ‘¨ğŸ»\u200dğŸ¦½', 'ğŸ–Œï¸', 'ğŸ˜¾', 'ğŸ‘¬ğŸ»', 'ğŸ›', 'ğŸ‘¨\u200dğŸ¨', 'ğŸ½ï¸', 'ğŸ‘©\u200dğŸ‘©\u200dğŸ‘§']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.15s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.67s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.40s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.02s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.55s/it]
Processing depth (3, 4, 5, 6):   1%|          | 1/100 [01:05<1:22:38, 50.08s/it]2025-01-22 20:35:35.647 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel took the apple.
2025-01-22 20:35:35.661 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2930, 2934) -->  Daniel took the apple
2025-01-22 20:35:35.661 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the bathroom.
2025-01-22 20:35:35.680 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3620, 3626) --> . Daniel journeyed to the
2025-01-22 20:35:35.680 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the office.
2025-01-22 20:35:35.700 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4220, 4226) -->  Daniel went back to the office
2025-01-22 20:35:35.701 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the bedroom.
2025-01-22 20:35:35.725 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4864, 4870) --> . John journeyed to the
2025-01-22 20:35:35.725 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the office.
2025-01-22 20:35:35.731 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1214, 1219) -->  Republican. Mary travelled to
2025-01-22 20:35:35.731 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the hallway.
2025-01-22 20:35:35.755 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4867, 4873) --> ed to the bedroom. Mary
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:35:36.544 | INFO     | test_jbb_embedding:begin_test:693 - The capitol<|eot_id|>
2025-01-22 20:35:36.545 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8152])
2025-01-22 20:35:38.753 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [230.25, 20.146873083997548, 96.70170454545455, 19.474086585816302, 11.576349431818182], 'topk_indices': array([8143,   23, 8133, 8146, 8135, 8140,    9, 2935, 2937,   24, 8139,
         14, 2934, 8142, 2936, 8150, 3626, 8147, 2933,    0]), 'topk_tokens': ['?', '4', '.\n\n', ':', ':', ' before', ':', ' S', 'y', '\n\n', ' apple', '\n', '.', ' office', 'ible', '<|end_header_id|>', ' bathroom', '<|eot_id|>', ' apple', '<|begin_of_text|>'], 'evidence_proportions': [558.625, 303.4791666666667, 114.46875, 53.885416666666664]}, 'weight': {'score': [22.2734375, 23.282786633966893, 22.887073863636363, 23.286056582430437, 30.281960227272727], 'topk_indices': array([3286, 3313, 3206, 3158, 7373, 7411, 1417, 1479, 4297, 4313, 5122,
       5183, 7090, 7146, 3513, 3487, 4899, 4924, 4947, 4976]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.568359375, 20.270833333333332, 24.272135416666668, 19.4140625]}, 'saliency': {'score': [1.4116321910511365, 0.11415847974785408, 0.5648415305397727, 0.11003364162825505, 0.0869679306492661], 'topk_indices': array([2902,   24, 2937, 2931, 8145, 2900, 2935, 8050, 2268, 2930, 8046,
       7901, 8140, 8134, 3622, 8139, 8142, 2936, 3626, 2933]), 'topk_tokens': [' During', '\n\n', 'y', ' took', 'Answer', ' Gov', ' S', ' location', ' Bench', ' Daniel', ' item', ' Square', ' before', 'Question', ' journey', ' apple', ' office', 'ible', ' bathroom', ' apple'], 'evidence_proportions': [3.838134765625, 1.6228434244791667, 0.7190348307291666, 0.2753499348958333]}}, 'pred_res': 'The capitol<|eot_id|>', 'score': 0}
2025-01-22 20:35:38.760 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:35:38.760 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-190_pid-1_3-4-5-6.pkl | len: 3 |  size: 1.97 KB
Processing depth (3, 4, 5, 6):   2%|â–         | 2/100 [01:09<52:00, 31.84s/it]  is_0k: False
your chose emoji: ['ğŸ’†ğŸ¾\u200dâ™‚ï¸', 'ğŸ•´ğŸ½', 'ğŸ’‚ğŸ»\u200dâ™‚ï¸', 'ğŸ„\u200dâ™€ï¸', 'âœ–', 'ğŸ™‚', 'ğŸ‘¨ğŸ¼\u200dğŸ¦²', 'ğŸ‘©ğŸ»\u200dğŸ’»', 'ğŸ‘®ğŸ¾\u200dâ™€ï¸', 'ğŸŒªï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  3.85s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.47s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.50s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.15s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.59s/it]
Processing depth (0, 2, 6, 7):   2%|â–         | 2/100 [01:25<52:00, 31.84s/it]2025-01-22 20:35:54.931 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel took the apple.
2025-01-22 20:35:54.975 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the bathroom.
2025-01-22 20:35:54.985 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2009, 2015) -->  cable. Daniel journeyed to
2025-01-22 20:35:54.985 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the office.
2025-01-22 20:35:55.010 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4921, 4927) --> . Daniel went back to the
2025-01-22 20:35:55.011 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the bedroom.
2025-01-22 20:35:55.043 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5791, 5797) --> . John journeyed to the
2025-01-22 20:35:55.043 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the office.
2025-01-22 20:35:55.051 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1219, 1224) -->  Republican. Mary travelled to
2025-01-22 20:35:55.051 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the hallway.
2025-01-22 20:35:55.077 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4926, 4932) -->  the office. Mary journeyed
2025-01-22 20:35:55.078 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 20:35:55.078 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 20:35:55.078 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 20:35:55.078 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ‹ğŸ¾\u200dâ™€', 'ğŸ¸', 'ğŸƒ\u200dâ™€\u200dâ¡ï¸', 'ğŸ§”\u200dâ™€', '\U0001fac3ğŸ½', 'ğŸ§‘ğŸ»\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ§‘ğŸ¾', 'ğŸ¤¹ğŸ½\u200dâ™‚', 'ğŸš´ğŸ¾\u200dâ™€', 'ğŸ™‹\u200dâ™€ï¸', 'ğŸ¤°ğŸ¿']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  3.75s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:07<00:07,  3.89s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:11<00:04,  4.03s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:12<00:00,  2.83s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:12<00:00,  3.23s/it]
Processing depth (0, 1, 6, 7):   2%|â–         | 2/100 [01:40<52:00, 31.84s/it]2025-01-22 20:36:09.710 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel took the apple.
2025-01-22 20:36:09.749 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the bathroom.
2025-01-22 20:36:09.754 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (900, 906) --> . Daniel journeyed to the
2025-01-22 20:36:09.754 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the office.
2025-01-22 20:36:09.777 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4769, 4775) -->  the senate. Daniel went back
2025-01-22 20:36:09.778 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the bedroom.
2025-01-22 20:36:09.805 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5625, 5631) --> . John journeyed to the
2025-01-22 20:36:09.805 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the office.
2025-01-22 20:36:09.811 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1226, 1231) -->  Republican. Mary travelled to
2025-01-22 20:36:09.811 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the hallway.
2025-01-22 20:36:09.838 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4776, 4782) -->  the office. Mary journeyed
2025-01-22 20:36:09.838 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 20:36:09.838 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 20:36:09.838 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 20:36:09.838 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['âœ‹ğŸ¼', 'ğŸ‘©\u200dğŸ¦±', 'ğŸ‘¨ğŸ¼\u200dâœˆï¸', 'ğŸ¤›ğŸ»', 'ğŸ‡ğŸ¼', 'ğŸ§–ğŸ¼\u200dâ™‚', 'ğŸ‘¨ğŸ¿\u200dğŸ¦°', 'ğŸ’‚ğŸ¿\u200dâ™€ï¸', 'ğŸ‘¨ğŸ½\u200dğŸ¦¯\u200dâ¡ï¸', 'ğŸ¤·ğŸ¿\u200dâ™€ï¸']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.01s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.39s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.27s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.93s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.41s/it]
Processing depth (0, 1, 4, 5):   2%|â–         | 2/100 [01:55<52:00, 31.84s/it]2025-01-22 20:36:25.283 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel took the apple.
2025-01-22 20:36:25.320 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the bathroom.
2025-01-22 20:36:25.325 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (852, 858) --> . Daniel journeyed to the
2025-01-22 20:36:25.325 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the office.
2025-01-22 20:36:25.342 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3605, 3611) --> . Daniel went back to the
2025-01-22 20:36:25.342 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the bedroom.
2025-01-22 20:36:25.363 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4190, 4196) --> . John journeyed to the
2025-01-22 20:36:25.363 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the office.
2025-01-22 20:36:25.368 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1101, 1106) --> . Mary travelled to the
2025-01-22 20:36:25.368 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the hallway.
2025-01-22 20:36:25.391 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4801, 4807) -->  the senate. Mary journeyed
2025-01-22 20:36:25.391 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 20:36:25.391 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 20:36:25.391 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 20:36:25.391 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸŠ', 'ğŸ“¨', 'ğŸ§‘ğŸ¿\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ§‘ğŸ¾', 'ğŸ‡¨ğŸ‡²', 'ğŸ•´', 'ğŸ§‘ğŸ¾\u200dâ¤\u200dğŸ’‹\u200dğŸ§‘ğŸ¿', 'ğŸ“…', 'ğŸ‡²ğŸ‡­', 'ğŸ™†ğŸ½\u200dâ™€ï¸', 'ğŸŒ¨']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  3.80s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:07<00:07,  3.97s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.07s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.87s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.28s/it]
Processing depth (0, 1, 3, 5):   2%|â–         | 2/100 [02:10<52:00, 31.84s/it]2025-01-22 20:36:40.353 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel took the apple.
2025-01-22 20:36:40.398 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the bathroom.
2025-01-22 20:36:40.402 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (832, 838) --> . Daniel journeyed to the
2025-01-22 20:36:40.402 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the office.
2025-01-22 20:36:40.416 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2907, 2913) --> . Daniel went back to the
2025-01-22 20:36:40.416 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the bedroom.
2025-01-22 20:36:40.437 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4187, 4193) -->  John journeyed to the bedroom
2025-01-22 20:36:40.437 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the office.
2025-01-22 20:36:40.442 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1125, 1130) --> . Mary travelled to the
2025-01-22 20:36:40.443 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the hallway.
2025-01-22 20:36:40.468 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4771, 4777) --> . Mary journeyed to the
2025-01-22 20:36:40.468 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 20:36:40.468 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 20:36:40.468 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 20:36:40.468 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ¤¹\u200dâ™‚', 'ğŸš¢', 'ğŸ§‘ğŸ¼\u200dâ¤\u200dğŸ§‘ğŸ¾', 'ğŸ›¥', 'ğŸ§—ğŸ¼\u200dâ™‚ï¸', 'ğŸ§‘ğŸ¾\u200dğŸ¦¯\u200dâ¡ï¸', 'ğŸ§ğŸ¿\u200dâ™‚\u200dâ¡ï¸', 'ğŸšµğŸ½\u200dâ™‚', 'ğŸ‘¨ğŸ¾\u200dâ¤\u200dğŸ‘¨ğŸ»', 'ğŸƒğŸ½\u200dâ™‚\u200dâ¡ï¸']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.26s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.30s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.32s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.01s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.48s/it]
Processing depth (0, 2, 4, 6):   2%|â–         | 2/100 [02:27<52:00, 31.84s/it]2025-01-22 20:36:56.739 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel took the apple.
2025-01-22 20:36:56.778 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the bathroom.
2025-01-22 20:36:56.787 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1605, 1611) -->  Daniel journeyed to the bathroom
2025-01-22 20:36:56.787 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the office.
2025-01-22 20:36:56.804 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3543, 3549) --> . Daniel went back to the
2025-01-22 20:36:56.805 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the bedroom.
2025-01-22 20:36:56.831 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4644, 4650) --> . John journeyed to the
2025-01-22 20:36:56.831 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the office.
2025-01-22 20:36:56.837 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1074, 1079) --> . Mary travelled to the
2025-01-22 20:36:56.837 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the hallway.
2025-01-22 20:36:56.866 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4647, 4653) --> ed to the bedroom. Mary
2025-01-22 20:36:56.866 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 20:36:56.866 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 20:36:56.866 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 20:36:56.866 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['7âƒ£', 'ğŸ–ğŸ½', 'ğŸ’‡ğŸ¿', 'ğŸ‘¨ğŸ¾\u200dğŸš’', 'ğŸ§›ğŸ¾\u200dâ™‚ï¸', 'â™‹', 'ğŸ‘©ğŸ¾\u200dâš•', 'ğŸš£ğŸ¼\u200dâ™€', 'ğŸ‡±ğŸ‡»', 'ğŸ¤µ']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.36s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:09,  4.51s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.28s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.93s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.46s/it]
Processing depth (1, 3, 6, 8):   2%|â–         | 2/100 [02:43<52:00, 31.84s/it]2025-01-22 20:37:12.706 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel took the apple.
2025-01-22 20:37:12.711 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (896, 900) -->  Daniel took the apple
2025-01-22 20:37:12.711 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the bathroom.
2025-01-22 20:37:12.727 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2979, 2985) -->  tragedy. Daniel journeyed to
2025-01-22 20:37:12.727 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the office.
2025-01-22 20:37:12.753 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4877, 4883) --> . Daniel went back to the
2025-01-22 20:37:12.753 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the bedroom.
2025-01-22 20:37:12.789 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6463, 6469) --> . John journeyed to the
2025-01-22 20:37:12.789 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the office.
2025-01-22 20:37:12.795 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1219, 1224) -->  Republican. Mary travelled to
2025-01-22 20:37:12.795 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the hallway.
2025-01-22 20:37:12.818 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4882, 4888) -->  the office. Mary journeyed
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:37:13.651 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's pocket.<|eot_id|>
2025-01-22 20:37:13.651 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8128])
2025-01-22 20:37:15.855 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [110.38210227272727, 11.86798114469315, 51.22869318181818, 11.546879823721907, 6.010651765046297], 'topk_indices': array([ 257,    9, 8109,  900, 8127,   23, 8115, 8111, 8116,  895,    1,
          3,   14,  896,   24,  899, 8126,    0, 8124, 8123]), 'topk_tokens': ['hue', ':', '.\n\n', '.', '\n\n', '4', ' apple', ':', ' before', '.', '<|start_header_id|>', '<|end_header_id|>', '\n', ' Daniel', '\n\n', ' apple', '<|end_header_id|>', '<|begin_of_text|>', '<|start_header_id|>', '<|eot_id|>'], 'evidence_proportions': [441.28125, 62.765625, 35.369791666666664, 12.411458333333334]}, 'weight': {'score': [22.681107954545453, 23.244281146230477, 24.019176136363637, 23.244758543776243, 28.938368055555557], 'topk_indices': array([3263, 3290, 3183, 3135, 7377, 7415, 1410, 1472, 4248, 4264, 5091,
       5152, 7154, 7098, 3472, 3446, 4939, 4848, 4910, 4873]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.568359375, 25.110677083333332, 20.927083333333332, 19.4140625]}, 'saliency': {'score': [0.7380239313299005, 0.06475324892291077, 0.31248890269886365, 0.06258764665019044, 0.04463068644205729], 'topk_indices': array([ 897,   20,   23, 8118, 8109, 8026, 8112, 2986, 8110,    0,   16,
       8121, 8125, 7982, 8116,  257, 8115,   24,  896,  899]), 'topk_tokens': [' took', ' Jul', '4', ' office', '.\n\n', ' location', ' Where', ' bathroom', 'Question', '<|begin_of_text|>', ' Date', 'Answer', 'assistant', ' context', ' before', 'hue', ' apple', '\n\n', ' Daniel', ' apple'], 'evidence_proportions': [3.1566162109375, 0.3555399576822917, 0.18348185221354166, 0.06265513102213542]}}, 'pred_res': "Daniel's pocket.<|eot_id|>", 'score': 0}
2025-01-22 20:37:15.861 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:37:15.862 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-190_pid-2_1-3-6-8.pkl | len: 3 |  size: 2.03 KB
Processing depth (1, 3, 6, 8):   3%|â–         | 3/100 [02:46<1:39:39, 61.64s/it]is_0k: False
your chose emoji: ['ğŸª†', 'ğŸ‘¨ğŸ¼\u200dğŸ“', 'ğŸš¶ğŸ¼', 'ğŸ™‹\u200dâ™€ï¸', 'ğŸ©¸', 'ğŸ‘°ğŸ¿\u200dâ™‚', 'ğŸš§', 'ğŸ—', 'ğŸ‘®ğŸ¿', 'ğŸ‘ğŸ½']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  3.80s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.50s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.47s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.08s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.54s/it]
Processing depth (1, 2, 4, 7):   3%|â–         | 3/100 [03:02<1:39:39, 61.64s/it]2025-01-22 20:37:31.913 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel took the apple.
2025-01-22 20:37:31.917 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (814, 818) -->  Daniel took the apple
2025-01-22 20:37:31.917 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the bathroom.
2025-01-22 20:37:31.926 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1784, 1790) --> . Daniel journeyed to the
2025-01-22 20:37:31.927 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the office.
2025-01-22 20:37:31.948 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3609, 3615) --> . Daniel went back to the
2025-01-22 20:37:31.948 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the bedroom.
2025-01-22 20:37:31.976 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5575, 5581) --> . John journeyed to the
2025-01-22 20:37:31.976 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the office.
2025-01-22 20:37:31.981 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1054, 1059) --> . Mary travelled to the
2025-01-22 20:37:31.981 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the hallway.
2025-01-22 20:37:32.004 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4728, 4734) --> . Mary journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:37:32.811 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's house.<|eot_id|>
2025-01-22 20:37:32.811 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8186])
2025-01-22 20:37:35.016 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [92.14985795454545, 12.172693552326292, 37.66903409090909, 11.922576170917116, 9.153761530496988], 'topk_indices': array([ 818, 8074, 8167, 8176,    9,  814, 8173, 8084,   23, 8040, 8169,
       8174,   14,    1,   24,  817, 8184, 8181,    0, 8182]), 'topk_tokens': ['.', '.\n\n', '.\n\n', ' office', ':', ' Daniel', ' apple', ' location', '4', ' context', ':', ' before', '\n', '<|start_header_id|>', '\n\n', ' apple', '<|end_header_id|>', '<|eot_id|>', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [350.875, 53.302083333333336, 35.497395833333336, 15.166666666666666]}, 'weight': {'score': [21.361150568181817, 23.303284131151546, 20.37215909090909, 23.312476052905836, 29.856551204819276], 'topk_indices': array([3320, 3293, 3213, 3165, 7425, 7463, 1420, 1482, 4331, 4315, 5139,
       5200, 7202, 7146, 3476, 3502, 4916, 4941, 4964, 4993]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.568359375, 20.270833333333332, 20.927083333333332, 19.4140625]}, 'saliency': {'score': [0.5976201837713068, 0.06739891910308417, 0.208648681640625, 0.0657781962964861, 0.06651926615152014], 'topk_indices': array([8167, 8183,   83,   23,    8, 8168,  815,   16, 8170, 8179,   20,
       8176,  261, 8084, 8173, 8040,  814, 8174,   24,  817]), 'topk_tokens': ['.\n\n', 'assistant', 'ol', '4', ' Date', 'Question', ' took', ' Date', ' Where', 'Answer', ' Jul', ' office', 'hue', ' location', ' apple', ' context', ' Daniel', ' before', '\n\n', ' apple'], 'evidence_proportions': [2.4681396484375, 0.2791544596354167, 0.185577392578125, 0.08111572265625]}}, 'pred_res': "Daniel's house.<|eot_id|>", 'score': 0}
2025-01-22 20:37:35.023 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:37:35.023 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-190_pid-3_1-2-4-7.pkl | len: 3 |  size: 2.02 KB
Processing depth (1, 2, 4, 7):   4%|â–         | 4/100 [03:05<1:11:47, 44.87s/it]is_0k: False
your chose emoji: ['ğŸ§ğŸ»\u200dâ™‚', 'ğŸ§˜ğŸ½\u200dâ™€ï¸', 'ğŸ€', 'ğŸ‘©ğŸ¿\u200dâ¤\u200dğŸ’‹\u200dğŸ‘©ğŸ»', 'ğŸ§˜ğŸ¿\u200dâ™€ï¸', 'ğŸœï¸', 'ğŸ‘‘', 'ğŸ§‘ğŸ¾\u200dâ¤ï¸\u200dğŸ§‘ğŸ¼', 'ğŸ˜”', 'ğŸ‘©ğŸ½\u200dğŸ«']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.03s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.68s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.56s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.16s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.65s/it]
Processing depth (1, 4, 7, 9):   4%|â–         | 4/100 [03:21<1:11:47, 44.87s/it]2025-01-22 20:37:51.294 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel took the apple.
2025-01-22 20:37:51.298 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (896, 900) -->  Daniel took the apple
2025-01-22 20:37:51.298 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the bathroom.
2025-01-22 20:37:51.316 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3592, 3598) --> . Daniel journeyed to the
2025-01-22 20:37:51.316 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the office.
2025-01-22 20:37:51.346 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5594, 5600) --> . Daniel went back to the
2025-01-22 20:37:51.346 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the bedroom.
2025-01-22 20:37:51.386 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7242, 7248) -->  cold. John journeyed to
2025-01-22 20:37:51.387 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the office.
2025-01-22 20:37:51.393 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1219, 1224) -->  Republican. Mary travelled to
2025-01-22 20:37:51.393 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the hallway.
2025-01-22 20:37:51.416 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4737, 4743) -->  the senate. Mary journeyed
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:37:52.225 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's house.<|eot_id|>
2025-01-22 20:37:52.226 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8154])
2025-01-22 20:37:54.440 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [127.58620383522727, 14.2824290103592, 50.45525568181818, 13.926621016817455, 7.751107742537314], 'topk_indices': array([ 900, 8144, 8007,    1,    9, 8135,  257,  895, 8141, 8137,   14,
       8142,   24,  896, 8008,  899, 8152,    0, 8150, 8149]), 'topk_tokens': ['.', ' office', ' you', '<|start_header_id|>', ':', '.\n\n', 'hue', '.', ' apple', ':', '\n', ' before', '\n\n', ' Daniel', ' context', ' apple', '<|end_header_id|>', '<|begin_of_text|>', '<|start_header_id|>', '<|eot_id|>'], 'evidence_proportions': [490.6875, 88.43229166666667, 31.309895833333332, 20.948893229166668]}, 'weight': {'score': [22.274857954545453, 23.279158238322914, 24.72372159090909, 23.279921951932547, 29.956623134328357], 'topk_indices': array([3264, 3291, 3184, 3136, 7403, 7365, 1472, 1410, 4262, 4278, 5187,
       5126, 7135, 7079, 3473, 3447, 4942, 4913, 4890, 4865]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.568359375, 20.270833333333332, 20.927083333333332, 22.764322916666668]}, 'saliency': {'score': [0.8399276733398438, 0.07847386638776511, 0.31284956498579547, 0.076094482286642, 0.05917272994767374], 'topk_indices': array([8151,    0,    8, 8137, 8006, 8007, 8135, 8147, 8052, 3598, 8138,
       8136,   24, 8144, 8142,  257, 8141,  896, 8008,  899]), 'topk_tokens': ['assistant', '<|begin_of_text|>', ' Date', ':', ' provided', ' you', '.\n\n', 'Answer', ' location', ' bathroom', ' Where', 'Question', '\n\n', ' office', ' before', 'hue', ' apple', ' Daniel', ' context', ' apple'], 'evidence_proportions': [3.515869140625, 0.4686482747395833, 0.152801513671875, 0.11437225341796875]}}, 'pred_res': "Daniel's house.<|eot_id|>", 'score': 0}
2025-01-22 20:37:54.445 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:37:54.446 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-190_pid-4_1-4-7-9.pkl | len: 3 |  size: 2.03 KB
Processing depth (1, 4, 7, 9):   5%|â–Œ         | 5/100 [03:24<56:30, 35.69s/it]  Processing depth (1, 4, 7, 9):   5%|â–Œ         | 5/100 [03:24<1:04:53, 40.98s/it]
2025-01-22 20:37:54.514 | INFO     | __main__:<module>:82 - Selected idx: 192
2025-01-22 20:37:54.514 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the apple before the kitchen? 
2025-01-22 20:37:54.514 | INFO     | __main__:<module>:84 - Answer: office
2025-01-22 20:37:54.514 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 20:37:54.514 | INFO     | __main__:<module>:86 - Needle: [' Daniel grabbed the apple.', ' Daniel went back to the office.', ' Mary travelled to the office.', ' Mary journeyed to the hallway.', ' Daniel moved to the kitchen.', ' John journeyed to the bedroom.']
2025-01-22 20:37:54.514 | INFO     | __main__:<module>:87 - Real Needle: [' Daniel grabbed the apple.', ' Daniel went back to the office.', ' Daniel moved to the kitchen.', ' John journeyed to the bedroom.']
2025-01-22 20:37:54.514 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ›´', 'ğŸ“™', 'ğŸ‘³\u200dâ™‚', 'ğŸ–Œï¸', 'â›¹ğŸ¾\u200dâ™‚', 'ğŸ§‘ğŸ½\u200dâ¤ï¸\u200dğŸ§‘ğŸ¼', 'ğŸ’–', 'ğŸƒğŸ¼\u200dâ™‚ï¸', 'â›¹ğŸ»\u200dâ™‚', 'âœŠğŸ»']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  3.98s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.28s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.39s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.13s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.55s/it]
Processing depth (1, 2, 4, 9):   0%|          | 0/100 [00:15<?, ?it/s]2025-01-22 20:38:10.449 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel grabbed the apple.
2025-01-22 20:38:10.453 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (842, 846) -->  Daniel grabbed the apple
2025-01-22 20:38:10.453 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went back to the office.
2025-01-22 20:38:10.462 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1770, 1776) --> . Daniel went back to the
2025-01-22 20:38:10.462 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the kitchen.
2025-01-22 20:38:10.482 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3601, 3606) --> . Daniel moved to the
2025-01-22 20:38:10.482 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the bedroom.
2025-01-22 20:38:10.518 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7147, 7153) -->  John journeyed to the bedroom
2025-01-22 20:38:10.519 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the office.
2025-01-22 20:38:10.543 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4735, 4740) --> . Mary travelled to the
2025-01-22 20:38:10.543 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the hallway.
2025-01-22 20:38:10.585 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (7107, 7113) --> . Mary journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:38:11.405 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's house.<|eot_id|>
2025-01-22 20:38:11.405 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8191])
2025-01-22 20:38:13.637 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [459.7708333333333, 44.31695502258025, 124.4090909090909, 43.13994914838868, 40.29194676598837], 'topk_indices': array([ 100, 8174,  841, 8079,   24, 8179,    1, 8118,   14,  842, 8119,
        846, 8189, 7615, 7659,  843,  845,    0, 8186, 8187]), 'topk_tokens': ['E', ':', '.', '.\n\n', '\n\n', ' before', '<|start_header_id|>', ' to', '\n', ' Daniel', ' the', '.', '<|end_header_id|>', ' three', ' or', ' grabbed', ' apple', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [1508.75, 263.625, 329.45, 65.19791666666667]}, 'weight': {'score': [22.955357142857142, 23.307846637373366, 20.37215909090909, 23.312710605317974, 29.811046511627907], 'topk_indices': array([3337, 3364, 3241, 3193, 7476, 7438, 1456, 1518, 4338, 4322, 5177,
       5238, 7159, 7215, 3546, 3520, 4984, 4936, 4961, 5013]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.333984375, 20.927083333333332, 19.909375, 23.936197916666668]}, 'saliency': {'score': [3.0864374069940474, 0.24714552438056878, 0.6801979758522727, 0.2392557184130315, 0.31061003928960756], 'topk_indices': array([  24, 7650, 8079, 7658,   99, 7613, 7606, 8173, 8117, 8175, 8181,
       8089, 8178, 8179,  257, 7659, 7615,  842,  845,  843]), 'topk_tokens': ['\n\n', ' tele', '.\n\n', ' two', 'ION', ' two', 'graph', 'Question', ' moved', ' Where', ' kitchen', ' location', ' apple', ' before', 'hue', ' or', ' three', ' Daniel', ' apple', ' grabbed'], 'evidence_proportions': [11.32470703125, 1.44677734375, 1.6845703125, 0.4021402994791667]}}, 'pred_res': "Daniel's house.<|eot_id|>", 'score': 0}
2025-01-22 20:38:13.644 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:38:13.644 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-192_pid-0_1-2-4-9.pkl | len: 3 |  size: 2.01 KB
Processing depth (1, 2, 4, 9):   1%|          | 1/100 [00:19<31:24, 19.04s/it]is_0k: False
your chose emoji: ['ğŸ‘¨ğŸ¾\u200dğŸš’', 'ğŸ‘¨ğŸ½\u200dâ¤ï¸\u200dğŸ‘¨ğŸ»', 'ğŸ§›ğŸ¿\u200dâ™€ï¸', 'ğŸ‘³ğŸ¿\u200dâ™‚ï¸', 'â™¥', 'ğŸ¤¹ğŸ¼\u200dâ™€', 'ğŸ‘¨\u200dâ¤ï¸\u200dğŸ‘¨', 'ğŸ‘®ğŸ¿\u200dâ™‚ï¸', 'ğŸš´ğŸ¾', 'ğŸ‡·ğŸ‡¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.31s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.43s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.36s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.04s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.53s/it]
Processing depth (2, 4, 5, 9):   1%|          | 1/100 [00:35<31:24, 19.04s/it]2025-01-22 20:38:29.924 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel grabbed the apple.
2025-01-22 20:38:29.933 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1848, 1852) -->  Daniel grabbed the apple
2025-01-22 20:38:29.933 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went back to the office.
2025-01-22 20:38:29.956 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3588, 3594) --> . Daniel went back to the
2025-01-22 20:38:29.956 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the kitchen.
2025-01-22 20:38:29.981 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4127, 4132) --> . Daniel moved to the
2025-01-22 20:38:29.982 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the bedroom.
2025-01-22 20:38:30.017 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7083, 7089) -->  John journeyed to the bedroom
2025-01-22 20:38:30.017 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the office.
2025-01-22 20:38:30.041 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4601, 4606) --> . Mary travelled to the
2025-01-22 20:38:30.041 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the hallway.
2025-01-22 20:38:30.081 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (7043, 7049) --> . Mary journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:38:30.901 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's hand.<|eot_id|>
2025-01-22 20:38:30.901 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8127])
2025-01-22 20:38:33.127 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [455.5386904761905, 44.97775710419486, 181.5340909090909, 43.727429912313205, 24.43525752314815], 'topk_indices': array([8121, 8109,   14,    1, 8112, 1848, 1851, 8111, 8114, 8118,    3,
       1849, 8117, 8110, 1852, 8125, 8115,    0, 8122, 8123]), 'topk_tokens': [':', 'Question', '\n', '<|start_header_id|>', ' was', ' Daniel', ' apple', ' Where', ' apple', '?', '<|end_header_id|>', ' grabbed', ' kitchen', ':', '.', '<|end_header_id|>', ' before', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [1204.25, 357.0416666666667, 368.7, 127.26041666666667]}, 'weight': {'score': [22.955357142857142, 23.250395958912534, 20.37215909090909, 23.255071322712116, 29.34056712962963], 'topk_indices': array([3299, 3272, 3144, 3192, 7412, 7374, 1473, 1411, 4270, 4286, 5166,
       5105, 7151, 7095, 3455, 3481, 4959, 4930, 4882, 4907]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.333984375, 20.927083333333332, 19.909375, 23.936197916666668]}, 'saliency': {'score': [2.9296409970238093, 0.243577395671554, 1.0353781960227273, 0.23553526347045975, 0.18562769006799767], 'topk_indices': array([8126,   24, 3594, 8015, 8108, 8110, 8119, 8025, 8112, 7981, 8118,
       8120, 8109, 8111, 1851, 1848, 8114, 1849, 8117, 8115]), 'topk_tokens': ['\n\n', '\n\n', ' office', '.\n\n', '.\n\n', ':', ' \n', ' location', ' was', ' context', '?', 'Answer', 'Question', ' Where', ' apple', ' Daniel', ' apple', ' grabbed', ' kitchen', ' before'], 'evidence_proportions': [9.03173828125, 1.8738606770833333, 1.87998046875, 0.7920735677083334]}}, 'pred_res': "Daniel's hand.<|eot_id|>", 'score': 0}
2025-01-22 20:38:33.143 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:38:33.143 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-192_pid-1_2-4-5-9.pkl | len: 3 |  size: 2.03 KB
Processing depth (2, 4, 5, 9):   2%|â–         | 2/100 [00:38<31:32, 19.31s/it]is_0k: False
your chose emoji: ['ğŸ™†', 'ğŸ¤°ğŸ»', 'ğŸŒ', 'ğŸ¥‰', 'ğŸ§”ğŸ¼\u200dâ™€ï¸', 'ğŸ‘ˆğŸ¿', 'ğŸ™‚\u200dâ†•ï¸', 'ğŸ‡¸ğŸ‡ª', 'ğŸ›€ğŸ¼', 'ğŸ„\u200dâ™‚']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.35s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.21s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.02s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.79s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.29s/it]
Processing depth (0, 4, 6, 8):   2%|â–         | 2/100 [00:53<31:32, 19.31s/it]2025-01-22 20:38:48.293 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel grabbed the apple.
2025-01-22 20:38:48.335 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went back to the office.
2025-01-22 20:38:48.352 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3529, 3535) -->  Daniel went back to the office
2025-01-22 20:38:48.353 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the kitchen.
2025-01-22 20:38:48.376 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4715, 4720) --> . Daniel moved to the
2025-01-22 20:38:48.376 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the bedroom.
2025-01-22 20:38:48.408 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6471, 6477) --> . John journeyed to the
2025-01-22 20:38:48.408 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the office.
2025-01-22 20:38:48.430 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4609, 4614) --> . Mary travelled to the
2025-01-22 20:38:48.430 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the hallway.
2025-01-22 20:38:48.468 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (7068, 7074) --> . Mary journeyed to the
2025-01-22 20:38:48.468 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 20:38:48.468 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 20:38:48.468 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 20:38:48.468 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ‡§ğŸ‡¿', 'ğŸ‘¤', 'ğŸ§œğŸ»\u200dâ™€', 'ğŸ‘´ğŸ»', 'ğŸ•ºğŸ¿', 'â˜ğŸ¼', 'ğŸ‘³ğŸ½\u200dâ™‚', 'ğŸ‡­ğŸ‡²', 'ğŸ¤¹ğŸ»\u200dâ™€', 'ğŸƒğŸ¾\u200dâ™‚']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:14,  4.70s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.72s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.55s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.11s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.67s/it]
Processing depth (2, 3, 4, 9):   2%|â–         | 2/100 [01:10<31:32, 19.31s/it]2025-01-22 20:39:04.966 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel grabbed the apple.
2025-01-22 20:39:04.974 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1752, 1756) -->  Daniel grabbed the apple
2025-01-22 20:39:04.975 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went back to the office.
2025-01-22 20:39:04.989 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2890, 2896) --> . Daniel went back to the
2025-01-22 20:39:04.989 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the kitchen.
2025-01-22 20:39:05.006 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3609, 3614) --> . Daniel moved to the
2025-01-22 20:39:05.006 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the bedroom.
2025-01-22 20:39:05.041 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7133, 7139) -->  John journeyed to the bedroom
2025-01-22 20:39:05.041 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the office.
2025-01-22 20:39:05.063 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4604, 4609) -->  Mary travelled to the office
2025-01-22 20:39:05.063 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the hallway.
2025-01-22 20:39:05.098 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (7093, 7099) --> . Mary journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:39:05.900 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's hand.<|eot_id|>
2025-01-22 20:39:05.900 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8177])
2025-01-22 20:39:08.127 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [431.7261904761905, 47.76476341851082, 216.8409090909091, 46.546765680618634, 53.030162183544306], 'topk_indices': array([8162, 8176,   24, 8164, 8159, 8075,   14, 1756,    3,    1, 8167,
       1752, 8168, 1755, 8160, 8175, 8165,    0, 8172, 8173]), 'topk_tokens': [' was', '\n\n', '\n\n', ' apple', 'Question', ' location', '\n', '.', '<|end_header_id|>', '<|start_header_id|>', ' kitchen', ' Daniel', '?', ' apple', ':', '<|end_header_id|>', ' before', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [1089.25, 330.7291666666667, 351.6, 161.14583333333334]}, 'weight': {'score': [22.955357142857142, 23.289407323633696, 22.196732954545453, 23.291743701669326, 29.432753164556964], 'topk_indices': array([3314, 3287, 3207, 3159, 7424, 7462, 1449, 1511, 4284, 4300, 5147,
       5208, 7201, 7145, 3502, 3476, 4924, 4972, 5001, 4949]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.333984375, 20.927083333333332, 19.909375, 23.936197916666668]}, 'saliency': {'score': [2.7911318824404763, 0.2621997479253271, 1.2926802201704546, 0.2542897368759206, 0.3938023048111155], 'topk_indices': array([7645, 8169, 8146, 8158, 8176,   24, 8160, 8162, 7601, 8168, 8170,
       8075, 8161, 1753, 8164, 8159, 8167, 1752, 1755, 8165]), 'topk_tokens': [' or', ' \n', ' return', '.\n\n', '\n\n', '\n\n', ':', ' was', ' three', '?', 'Answer', ' location', ' Where', ' grabbed', ' apple', 'Question', ' kitchen', ' Daniel', ' apple', ' before'], 'evidence_proportions': [8.1357421875, 1.9038899739583333, 1.81611328125, 0.9278157552083334]}}, 'pred_res': "Daniel's hand.<|eot_id|>", 'score': 0}
2025-01-22 20:39:08.134 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:39:08.134 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-192_pid-2_2-3-4-9.pkl | len: 3 |  size: 2.03 KB
Processing depth (2, 3, 4, 9):   3%|â–         | 3/100 [01:13<42:47, 26.47s/it]is_0k: False
your chose emoji: ['ğŸ‘¨ğŸ¼\u200dâ¤ï¸\u200dğŸ‘¨ğŸ¾', 'ğŸ‡®ğŸ‡¶', 'ğŸ‘¨ğŸ¾\u200dğŸ¦½\u200dâ¡ï¸', 'ğŸš£ğŸ½\u200dâ™‚', 'ğŸ§', 'ğŸƒ', 'ğŸ”œ', 'ğŸ‘¨ğŸ½\u200dğŸ¦¼\u200dâ¡ï¸', 'ğŸŠ\u200dâ™€', 'ğŸš´ğŸ¼']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.08s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:09,  4.55s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.55s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.18s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.65s/it]
Processing depth (1, 3, 4, 5):   3%|â–         | 3/100 [01:29<42:47, 26.47s/it]2025-01-22 20:39:24.450 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel grabbed the apple.
2025-01-22 20:39:24.457 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (826, 830) -->  Daniel grabbed the apple
2025-01-22 20:39:24.457 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went back to the office.
2025-01-22 20:39:24.471 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2950, 2956) --> . Daniel went back to the
2025-01-22 20:39:24.471 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the kitchen.
2025-01-22 20:39:24.492 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3653, 3658) --> . Daniel moved to the
2025-01-22 20:39:24.492 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the bedroom.
2025-01-22 20:39:24.523 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4244, 4250) -->  John journeyed to the bedroom
2025-01-22 20:39:24.523 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the office.
2025-01-22 20:39:24.550 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4788, 4793) -->  the senate. Mary travelled
2025-01-22 20:39:24.551 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the hallway.
2025-01-22 20:39:24.588 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (7258, 7264) --> . Mary journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:39:25.436 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's hand.<|eot_id|>
2025-01-22 20:39:25.436 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8257])
2025-01-22 20:39:27.687 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [406.5982142857143, 33.52722030512169, 90.93181818181819, 32.49817673514039, 33.18114824054622], 'topk_indices': array([ 846,    9, 8247, 8248,  257, 8145, 8155, 8240,   24,    1,  826,
       8245,  830,   14,  827,  829, 8255,    0, 8252, 8253]), 'topk_tokens': ['ï¿½', ':', ' kitchen', '?', 'hue', '.\n\n', ' location', ':', '\n\n', '<|start_header_id|>', ' Daniel', ' before', '.', '\n', ' grabbed', ' apple', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [1178.125, 207.9375, 284.5, 192.65625]}, 'weight': {'score': [22.955357142857142, 23.36378496185979, 22.521306818181817, 23.36595394736842, 29.948792016806724], 'topk_indices': array([3318, 3291, 3163, 3211, 7510, 7472, 1520, 1458, 4321, 4337, 5267,
       5206, 7152, 7208, 3474, 3500, 5011, 4951, 4976, 5040]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.333984375, 20.927083333333332, 19.909375, 23.936197916666668]}, 'saliency': {'score': [2.688267299107143, 0.18476359418986107, 0.5776478160511364, 0.177847913596238, 0.24802135820148372], 'topk_indices': array([  14,  844, 8242,    8, 8248,   24, 8145,  846, 8250, 8241,  847,
       8239, 8244, 8155, 8247, 8245,  257,  826,  829,  827]), 'topk_tokens': ['\n', 'ï¿½', ' was', ' Date', '?', '\n\n', '.\n\n', 'ï¿½', 'Answer', ' Where', 'ï¿½', 'Question', ' apple', ' location', ' kitchen', ' before', 'hue', ' Daniel', ' apple', ' grabbed'], 'evidence_proportions': [8.8056640625, 1.1088053385416667, 1.384765625, 1.2757161458333333]}}, 'pred_res': "Daniel's hand.<|eot_id|>", 'score': 0}
2025-01-22 20:39:27.694 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:39:27.694 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-192_pid-3_1-3-4-5.pkl | len: 3 |  size: 2.0 KB
Processing depth (1, 3, 4, 5):   4%|â–         | 4/100 [01:33<37:59, 23.74s/it]is_0k: False
your chose emoji: ['ğŸ‘©ğŸ½\u200dğŸ¤\u200dğŸ‘¨ğŸ»', 'ğŸ‘‹ğŸ¼', 'â›¹ğŸ¿\u200dâ™€', 'ğŸ‘®ğŸ½\u200dâ™‚ï¸', 'ğŸ‘©ğŸ¾\u200dâ¤\u200dğŸ’‹\u200dğŸ‘©ğŸ¿', 'ğŸ§–\u200dâ™€ï¸', 'ğŸ”³', 'ğŸ‘©ğŸ½\u200dâ¤ï¸\u200dğŸ‘¨ğŸ¼', 'ğŸ‘©ğŸ»\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘©ğŸ½', 'ğŸ‘©ğŸ¾\u200dâ¤ï¸\u200dğŸ‘©ğŸ¾']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  3.80s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.27s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:14<00:04,  4.92s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.39s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.79s/it]
Processing depth (0, 1, 3, 8):   4%|â–         | 4/100 [01:49<37:59, 23.74s/it]2025-01-22 20:39:44.543 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel grabbed the apple.
2025-01-22 20:39:44.582 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went back to the office.
2025-01-22 20:39:44.588 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (845, 851) -->  Daniel went back to the office
2025-01-22 20:39:44.588 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the kitchen.
2025-01-22 20:39:44.604 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2925, 2930) --> . Daniel moved to the
2025-01-22 20:39:44.605 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the bedroom.
2025-01-22 20:39:44.637 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6643, 6649) --> . John journeyed to the
2025-01-22 20:39:44.637 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the office.
2025-01-22 20:39:44.661 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4648, 4653) -->  Mary travelled to the office
2025-01-22 20:39:44.661 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the hallway.
2025-01-22 20:39:44.700 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (7228, 7234) --> . Mary journeyed to the
2025-01-22 20:39:44.700 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 20:39:44.701 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 20:39:44.701 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 20:39:44.701 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ‘©ğŸ¾\u200dâ¤\u200dğŸ‘©ğŸ½', 'ğŸ§Ÿ', 'ğŸ–ğŸ»', 'ğŸœ', 'ğŸ‘©ğŸ½\u200dâ¤\u200dğŸ’‹\u200dğŸ‘¨ğŸ½', 'ğŸ‘³ğŸ¼\u200dâ™€ï¸', 'ğŸ’‚ğŸ¼\u200dâ™€ï¸', 'ğŸ‘ƒğŸ¿', 'ğŸ‘¨ğŸ¿\u200dâ¤ï¸\u200dğŸ‘¨ğŸ¾', 'ğŸ‘©ğŸ¿\u200dâ¤\u200dğŸ‘¨ğŸ¼']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.59s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.45s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.37s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.01s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.54s/it]
Processing depth (0, 2, 6, 7):   4%|â–         | 4/100 [02:06<37:59, 23.74s/it]2025-01-22 20:40:00.921 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel grabbed the apple.
2025-01-22 20:40:00.960 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went back to the office.
2025-01-22 20:40:00.969 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1814, 1820) --> . Daniel went back to the
2025-01-22 20:40:00.969 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the kitchen.
2025-01-22 20:40:00.992 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4655, 4660) --> . Daniel moved to the
2025-01-22 20:40:00.992 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the bedroom.
2025-01-22 20:40:01.021 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5627, 5633) --> . John journeyed to the
2025-01-22 20:40:01.021 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the office.
2025-01-22 20:40:01.047 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4610, 4615) -->  Mary travelled to the office
2025-01-22 20:40:01.048 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the hallway.
2025-01-22 20:40:01.083 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (7091, 7097) -->  Mary journeyed to the hallway
2025-01-22 20:40:01.083 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 20:40:01.084 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 20:40:01.084 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 20:40:01.084 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ’‚ğŸ»\u200dâ™€', 'ğŸ‘©ğŸ¾\u200dâ¤ï¸\u200dğŸ‘©ğŸ¿', 'ğŸ', 'ğŸ‘¨\u200dğŸ«', 'ğŸ’š', 'ğŸšµğŸ¼\u200dâ™€ï¸', 'âœğŸ»', 'ğŸ‘¨ğŸ¾\u200dâ¤ï¸\u200dğŸ‘¨ğŸ¿', 'ğŸ§±', 'ğŸ™†ğŸ½\u200dâ™€ï¸']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  3.97s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.17s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.26s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.01s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.44s/it]
Processing depth (0, 6, 7, 9):   4%|â–         | 4/100 [02:22<37:59, 23.74s/it]2025-01-22 20:40:16.815 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel grabbed the apple.
2025-01-22 20:40:16.858 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went back to the office.
2025-01-22 20:40:16.884 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4786, 4792) -->  the senate. Daniel went back
2025-01-22 20:40:16.884 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the kitchen.
2025-01-22 20:40:16.914 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5673, 5678) --> . Daniel moved to the
2025-01-22 20:40:16.914 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the bedroom.
2025-01-22 20:40:16.951 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7260, 7266) --> . John journeyed to the
2025-01-22 20:40:16.951 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the office.
2025-01-22 20:40:16.974 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4726, 4731) --> . Mary travelled to the
2025-01-22 20:40:16.974 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the hallway.
2025-01-22 20:40:17.009 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (7142, 7148) -->  Mary journeyed to the hallway
2025-01-22 20:40:17.009 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 20:40:17.009 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 20:40:17.009 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 20:40:17.009 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ’', 'ğŸ‘©ğŸ»\u200dğŸ¦¼\u200dâ¡', 'ğŸ‘¨ğŸ½\u200dğŸ¦°', 'ğŸ¤¹ğŸ¼', 'ğŸ¤¹ğŸ¿\u200dâ™€ï¸', 'ğŸ§\u200dâ™€ï¸', 'ğŸ‘¨ğŸ¾\u200dâ¤ï¸\u200dğŸ‘¨ğŸ¾', 'â“‚ï¸', 'ğŸ‘¨ğŸ»\u200dâ¤\u200dğŸ’‹\u200dğŸ‘¨ğŸ¼', 'ğŸ§Š']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.60s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.34s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.15s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.87s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.40s/it]
Processing depth (3, 4, 8, 9):   4%|â–         | 4/100 [02:37<37:59, 23.74s/it]2025-01-22 20:40:32.514 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel grabbed the apple.
2025-01-22 20:40:32.527 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2716, 2720) -->  Daniel grabbed the apple
2025-01-22 20:40:32.528 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went back to the office.
2025-01-22 20:40:32.545 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3522, 3528) --> . Daniel went back to the
2025-01-22 20:40:32.545 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the kitchen.
2025-01-22 20:40:32.576 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6579, 6584) --> . Daniel moved to the
2025-01-22 20:40:32.577 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the bedroom.
2025-01-22 20:40:32.612 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7095, 7101) -->  John journeyed to the bedroom
2025-01-22 20:40:32.612 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the office.
2025-01-22 20:40:32.634 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4603, 4608) --> . Mary travelled to the
2025-01-22 20:40:32.634 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the hallway.
2025-01-22 20:40:32.669 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (7055, 7061) --> . Mary journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:40:33.496 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's hand.<|eot_id|>
2025-01-22 20:40:33.496 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8133])
2025-01-22 20:40:35.705 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [466.2797619047619, 42.38465734480639, 189.51136363636363, 41.08634919165741, 46.40947094298246], 'topk_indices': array([2716, 8021, 7986,   23, 8120, 2522,    3,   24, 8121,    1, 8031,
         14, 2717, 7987, 2720, 2719,    0, 8131, 8128, 8129]), 'topk_tokens': [' Daniel', '.\n\n', ' you', '4', ' apple', 'ï¿½', '<|end_header_id|>', '\n\n', ' before', '<|start_header_id|>', ' location', '\n', ' grabbed', ' context', '.', ' apple', '<|begin_of_text|>', '<|end_header_id|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [1158.375, 298.875, 508.6, 137.02083333333334]}, 'weight': {'score': [22.955357142857142, 23.251233097725876, 20.37215909090909, 23.25590830556584, 29.079769736842106], 'topk_indices': array([3286, 3313, 3206, 3158, 7386, 7424, 1411, 1473, 4290, 4306, 5107,
       5168, 7107, 7163, 3513, 3487, 4961, 4932, 4909, 4884]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.333984375, 20.927083333333332, 19.909375, 23.936197916666668]}, 'saliency': {'score': [2.9808756510416665, 0.235251910509181, 1.0387961647727273, 0.2270454332355686, 0.3356885408100329], 'topk_indices': array([8130, 7985, 8030, 8115, 6584,   24, 8126,   20, 7986, 6581, 8059,
       2522, 8123, 8121, 2716, 8120, 8031, 7987, 2717, 2719]), 'topk_tokens': ['assistant', ' provided', ' first', 'Question', ' kitchen', '\n\n', 'Answer', ' Jul', ' you', ' moved', ' moved', 'ï¿½', ' kitchen', ' before', ' Daniel', ' apple', ' location', ' context', ' grabbed', ' apple'], 'evidence_proportions': [8.618408203125, 1.627685546875, 2.7349609375, 0.7806396484375]}}, 'pred_res': "Daniel's hand.<|eot_id|>", 'score': 0}
2025-01-22 20:40:35.712 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:40:35.712 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-192_pid-4_3-4-8-9.pkl | len: 3 |  size: 2.06 KB
Processing depth (3, 4, 8, 9):   5%|â–Œ         | 5/100 [02:41<1:02:52, 39.71s/it]Processing depth (3, 4, 8, 9):   5%|â–Œ         | 5/100 [02:41<51:02, 32.24s/it]  
2025-01-22 20:40:35.793 | INFO     | __main__:<module>:82 - Selected idx: 194
2025-01-22 20:40:35.794 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the apple before the kitchen? 
2025-01-22 20:40:35.794 | INFO     | __main__:<module>:84 - Answer: office
2025-01-22 20:40:35.794 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 20:40:35.794 | INFO     | __main__:<module>:86 - Needle: [' Mary travelled to the office.', ' Mary journeyed to the hallway.', ' Daniel took the apple.', ' Daniel went back to the office.', ' John journeyed to the bedroom.', ' Daniel moved to the kitchen.', ' Sandra picked up the milk there.']
2025-01-22 20:40:35.794 | INFO     | __main__:<module>:87 - Real Needle: [' Daniel took the apple.', ' Daniel went back to the office.', ' Daniel moved to the kitchen.', ' Sandra picked up the milk there.']
2025-01-22 20:40:35.794 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸŒğŸ¾\u200dâ™‚', 'ğŸ§–ğŸ¾', 'ğŸ–•ğŸ½', 'ğŸ¦®', 'ğŸ‡©ğŸ‡´', 'ğŸ‡²ğŸ‡¶', 'ğŸ‘²ğŸ½', 'ğŸ§\u200dâ™€', 'ğŸ¤·ğŸ¾\u200dâ™€', 'ğŸª']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.25s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.70s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.60s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.15s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.67s/it]
Processing depth (1, 3, 6, 8):   0%|          | 0/100 [00:16<?, ?it/s]2025-01-22 20:40:52.607 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel took the apple.
2025-01-22 20:40:52.611 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (774, 778) -->  Daniel took the apple
2025-01-22 20:40:52.611 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went back to the office.
2025-01-22 20:40:52.625 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2868, 2874) --> . Daniel went back to the
2025-01-22 20:40:52.625 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the kitchen.
2025-01-22 20:40:52.650 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4736, 4741) -->  the senate. Daniel moved
2025-01-22 20:40:52.651 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra picked up the milk there.
2025-01-22 20:40:52.683 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6588, 6594) --> . Sandra picked up the milk
2025-01-22 20:40:52.683 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the office.
2025-01-22 20:40:52.706 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4039, 4044) --> . Mary travelled to the
2025-01-22 20:40:52.707 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the hallway.
2025-01-22 20:40:52.741 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (7078, 7084) -->  Mary journeyed to the hallway
2025-01-22 20:40:52.741 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the bedroom.
2025-01-22 20:40:52.762 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4091, 4097) --> . John journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:40:53.575 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's pocket.<|eot_id|>
2025-01-22 20:40:53.575 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8162])
2025-01-22 20:40:55.785 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [386.6145833333333, 39.551809009064186, 113.02941176470588, 38.50117677824268, 34.206858915441174], 'topk_indices': array([8149,  775, 8050, 8060,  778, 8153,   14,    3, 8152,  774,    1,
       8145,  776,   32, 8150, 8160,  777,    0, 8157, 8158]), 'topk_tokens': [' apple', ' took', '.\n\n', ' location', '.', '?', '\n', '<|end_header_id|>', ' kitchen', ' Daniel', '<|start_header_id|>', ':', ' the', 'ï¿½', ' before', '<|end_header_id|>', ' apple', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [1631.0, 90.76041666666667, 162.975, 39.244791666666664]}, 'weight': {'score': [24.042782738095237, 23.278532275845173, 21.826746323529413, 23.279594434531134, 29.735753676470587], 'topk_indices': array([3298, 3271, 3185, 3137, 7401, 7439, 1426, 1488, 4285, 4269, 5086,
       5147, 7178, 7122, 3454, 3480, 4940, 4911, 4863, 4888]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.568359375, 20.927083333333332, 24.6375, 24.979166666666668]}, 'saliency': {'score': [2.6010248093377974, 0.21473586938943073, 0.6437772863051471, 0.2076714130977149, 0.25999854592715993], 'topk_indices': array([  24, 8159, 8147,   30, 8050, 8153, 8155,  341,  273, 8146, 8144,
        775, 8060, 8016, 8149,   32, 8152,  774, 8150,  777]), 'topk_tokens': ['\n\n', 'assistant', ' was', 'ï¿½', '.\n\n', '?', 'Answer', ' century', 'hue', ' Where', 'Question', ' took', ' location', ' context', ' apple', 'ï¿½', ' kitchen', ' Daniel', ' before', ' apple'], 'evidence_proportions': [11.169921875, 0.50634765625, 1.0525634765625, 0.2734883626302083]}}, 'pred_res': "Daniel's pocket.<|eot_id|>", 'score': 0}
2025-01-22 20:40:55.795 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:40:55.795 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-194_pid-0_1-3-6-8.pkl | len: 3 |  size: 2.04 KB
Processing depth (1, 3, 6, 8):   1%|          | 1/100 [00:19<32:49, 19.90s/it]is_0k: False
your chose emoji: ['ğŸ¤', 'ğŸ‘°ğŸ»\u200dâ™€', 'ğŸ§—ğŸ»\u200dâ™‚', 'ğŸˆ', 'ğŸ“¶', 'ğŸ’‚ğŸ½\u200dâ™€ï¸', 'ğŸ“º', 'ğŸ‘¨ğŸ¾\u200dâ¤\u200dğŸ’‹\u200dğŸ‘¨ğŸ»', 'ğŸ', 'ğŸ§ğŸ½\u200dâ™‚ï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.09s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.43s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.44s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.09s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.56s/it]
Processing depth (0, 3, 4, 5):   1%|          | 1/100 [00:36<32:49, 19.90s/it]2025-01-22 20:41:12.041 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel took the apple.
2025-01-22 20:41:12.080 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went back to the office.
2025-01-22 20:41:12.094 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2872, 2878) --> . Daniel went back to the
2025-01-22 20:41:12.095 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the kitchen.
2025-01-22 20:41:12.113 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3606, 3611) -->  Hon. Daniel moved to
2025-01-22 20:41:12.113 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra picked up the milk there.
2025-01-22 20:41:12.135 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4209, 4215) -->  Sandra picked up the milk there
2025-01-22 20:41:12.135 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the office.
2025-01-22 20:41:12.161 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4055, 4060) --> . Mary travelled to the
2025-01-22 20:41:12.161 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the hallway.
2025-01-22 20:41:12.198 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (7094, 7100) -->  Mary journeyed to the hallway
2025-01-22 20:41:12.198 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the bedroom.
2025-01-22 20:41:12.222 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4107, 4113) --> . John journeyed to the
2025-01-22 20:41:12.222 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 20:41:12.222 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 20:41:12.222 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 20:41:12.222 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ™ƒ', 'ğŸ„ğŸ¼\u200dâ™‚ï¸', 'ğŸ…', 'ğŸ–•ğŸ½', 'ğŸ§Ÿ', 'ğŸ§œğŸ»\u200dâ™‚ï¸', 'ğŸ§•ğŸ½', 'ğŸ§™\u200dâ™€', 'ğŸ’ğŸ¾\u200dâ™‚ï¸', 'ğŸ‘¨\u200dğŸš€']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.32s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.39s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.34s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.00s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.50s/it]
Processing depth (1, 2, 3, 5):   1%|          | 1/100 [00:52<32:49, 19.90s/it]2025-01-22 20:41:28.063 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel took the apple.
2025-01-22 20:41:28.067 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (896, 900) -->  Daniel took the apple
2025-01-22 20:41:28.068 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went back to the office.
2025-01-22 20:41:28.077 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1846, 1852) --> . Daniel went back to the
2025-01-22 20:41:28.077 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the kitchen.
2025-01-22 20:41:28.091 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2921, 2926) --> . Daniel moved to the
2025-01-22 20:41:28.091 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra picked up the milk there.
2025-01-22 20:41:28.115 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4188, 4194) --> . Sandra picked up the milk
2025-01-22 20:41:28.115 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the office.
2025-01-22 20:41:28.134 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4067, 4072) --> . Mary travelled to the
2025-01-22 20:41:28.134 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the hallway.
2025-01-22 20:41:28.169 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (7142, 7148) -->  Mary journeyed to the hallway
2025-01-22 20:41:28.169 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the bedroom.
2025-01-22 20:41:28.189 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4107, 4113) --> . John journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:41:29.008 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's pocket.<|eot_id|>
2025-01-22 20:41:29.008 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8212])
2025-01-22 20:41:31.266 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [329.66815476190476, 30.532277209642075, 171.52573529411765, 29.470787212573384, 12.647954469086022], 'topk_indices': array([8193,  895, 8202, 8199,  257, 8195,    9,  896,  900,    3, 8200,
         24,    1, 8211,   14,  899, 8210,    0, 8207, 8208]), 'topk_tokens': ['.\n\n', '.', ' kitchen', ' apple', 'hue', ':', ':', ' Daniel', '.', '<|end_header_id|>', ' before', '\n\n', '<|start_header_id|>', '\n\n', '\n', ' apple', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [1022.375, 194.04166666666666, 291.4, 35.380208333333336]}, 'weight': {'score': [22.91703869047619, 23.31912740443146, 21.826746323529413, 23.323263209393346, 29.795362903225808], 'topk_indices': array([3327, 3354, 3237, 3189, 7497, 7459, 1466, 1404, 4348, 4332, 5224,
       5163, 7210, 7154, 3510, 3536, 4988, 5017, 4965, 4940]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.568359375, 20.927083333333332, 19.909375, 24.979166666666668]}, 'saliency': {'score': [2.0717686244419644, 0.1637672218116554, 0.9110681870404411, 0.15731270299265762, 0.093709227859333], 'topk_indices': array([  16, 2926, 8193, 8203, 8181, 8110,    8, 8196, 8205,  897, 8194,
         24, 8209, 8211, 8202, 8199, 8200,  257,  896,  899]), 'topk_tokens': [' Date', ' kitchen', '.\n\n', '?', ' return', ' location', ' Date', ' Where', 'Answer', ' took', 'Question', '\n\n', 'assistant', '\n\n', ' kitchen', ' apple', ' before', 'hue', ' Daniel', ' apple'], 'evidence_proportions': [7.05419921875, 1.0782063802083333, 1.48076171875, 0.23621622721354166]}}, 'pred_res': "Daniel's pocket.<|eot_id|>", 'score': 0}
2025-01-22 20:41:31.279 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:41:31.280 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-194_pid-1_1-2-3-5.pkl | len: 3 |  size: 2.02 KB
Processing depth (1, 2, 3, 5):   2%|â–         | 2/100 [00:55<47:28, 29.07s/it]is_0k: False
your chose emoji: ['ğŸ‘¨ğŸ»\u200dğŸ¦²', 'ğŸ‘©ğŸ»\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘©ğŸ»', 'ğŸ‘¨ğŸ¾\u200dâ¤ï¸\u200dğŸ‘¨ğŸ»', 'ğŸƒğŸ»\u200dâ™‚ï¸\u200dâ¡', '\U0001fa77', 'ğŸ‘©ğŸ»\u200dâ¤\u200dğŸ‘©ğŸ½', 'ğŸ‘–', 'ğŸƒ', 'ğŸš¶\u200dâ™€', 'ğŸ‘¶ğŸ¼']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.01s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.59s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.36s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.06s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.54s/it]
Processing depth (2, 6, 7, 9):   2%|â–         | 2/100 [01:11<47:28, 29.07s/it]2025-01-22 20:41:47.154 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel took the apple.
2025-01-22 20:41:47.163 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1780, 1784) -->  Daniel took the apple
2025-01-22 20:41:47.163 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went back to the office.
2025-01-22 20:41:47.187 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4699, 4705) --> . Daniel went back to the
2025-01-22 20:41:47.188 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the kitchen.
2025-01-22 20:41:47.217 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5620, 5625) --> . Daniel moved to the
2025-01-22 20:41:47.217 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra picked up the milk there.
2025-01-22 20:41:47.252 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7231, 7237) --> . Sandra picked up the milk
2025-01-22 20:41:47.253 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the office.
2025-01-22 20:41:47.275 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3950, 3955) -->  the ground. Mary travelled
2025-01-22 20:41:47.276 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the hallway.
2025-01-22 20:41:47.313 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (7166, 7172) --> . Mary journeyed to the
2025-01-22 20:41:47.313 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the bedroom.
2025-01-22 20:41:47.337 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4034, 4040) --> . John journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:41:48.162 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's pocket.<|eot_id|>
2025-01-22 20:41:48.162 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8150])
2025-01-22 20:41:50.382 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [476.0104166666667, 43.94662736138371, 297.25367647058823, 42.29767993591324, 38.71244959677419], 'topk_indices': array([8140,   23, 8133, 8038, 8004, 3954, 8149, 8138,   24, 1781, 1784,
       8144, 1780,   14, 8048, 1783, 8148, 8146,    0, 8145]), 'topk_tokens': [' kitchen', '4', ':', '.\n\n', ' context', ' travelled', '\n\n', ' before', '\n\n', ' took', '.', ':', ' Daniel', '\n', ' location', ' apple', '<|end_header_id|>', '<|start_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [1192.875, 465.4166666666667, 400.825, 71.34895833333333]}, 'weight': {'score': [22.91703869047619, 23.26877990063788, 20.987132352941178, 23.274470629467586, 29.723538306451612], 'topk_indices': array([3294, 3321, 3154, 3202, 7391, 7353, 1471, 1409, 4302, 4286, 5104,
       5165, 7116, 7060, 3503, 3477, 4958, 4881, 4929, 4906]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.568359375, 20.927083333333332, 19.909375, 24.979166666666668]}, 'saliency': {'score': [2.985322498139881, 0.2438617739990953, 1.8216552734375, 0.23346084169722087, 0.288848876953125], 'topk_indices': array([  20, 8147, 8038, 8134, 8137, 4705, 8132, 4040, 8047, 3957, 1519,
       8138, 8004, 1781, 8143, 8140, 3954, 1780, 8048, 1783]), 'topk_tokens': [' Jul', 'assistant', '.\n\n', ' Where', ' apple', ' office', 'Question', ' bedroom', ' first', ' office', 'rich', ' before', ' context', ' took', 'Answer', ' kitchen', ' travelled', ' Daniel', ' location', ' apple'], 'evidence_proportions': [8.42626953125, 2.53125, 2.18828125, 0.4762980143229167]}}, 'pred_res': "Daniel's pocket.<|eot_id|>", 'score': 0}
2025-01-22 20:41:50.392 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:41:50.392 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-194_pid-2_2-6-7-9.pkl | len: 3 |  size: 2.03 KB
Processing depth (2, 6, 7, 9):   3%|â–         | 3/100 [01:14<39:38, 24.52s/it]is_0k: False
your chose emoji: ['ğŸ™\u200dâ™€ï¸', 'ğŸ‡¹ğŸ‡¯', '\U0001fac3ğŸ¼', 'ğŸ‚ğŸ¼', 'ğŸ°', 'ğŸƒğŸ½\u200dâ™‚\u200dâ¡ï¸', 'ğŸ’Š', 'ğŸ¤½ğŸ»', 'ğŸ™\u200dâ™€', 'ğŸš£ğŸ¾\u200dâ™‚']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  3.93s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.22s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.20s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.95s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.39s/it]
Processing depth (4, 6, 8, 9):   3%|â–         | 3/100 [01:29<39:38, 24.52s/it]2025-01-22 20:42:05.759 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel took the apple.
2025-01-22 20:42:05.779 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3616, 3620) -->  Daniel took the apple
2025-01-22 20:42:05.779 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went back to the office.
2025-01-22 20:42:05.803 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4765, 4771) -->  the senate. Daniel went back
2025-01-22 20:42:05.803 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the kitchen.
2025-01-22 20:42:05.843 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6600, 6605) --> . Daniel moved to the
2025-01-22 20:42:05.843 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra picked up the milk there.
2025-01-22 20:42:05.880 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7263, 7269) --> . Sandra picked up the milk
2025-01-22 20:42:05.880 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the office.
2025-01-22 20:42:05.900 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4100, 4105) --> . Mary travelled to the
2025-01-22 20:42:05.900 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the hallway.
2025-01-22 20:42:05.939 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (7198, 7204) --> . Mary journeyed to the
2025-01-22 20:42:05.939 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the bedroom.
2025-01-22 20:42:05.961 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4173, 4179) -->  John journeyed to the bedroom
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:42:06.759 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's hand<|eot_id|>
2025-01-22 20:42:06.759 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8168])
2025-01-22 20:42:08.976 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [791.8720238095239, 53.55131961444309, 325.36764705882354, 51.07645336325627, 46.41802376760563], 'topk_indices': array([8155, 8066, 4767, 8158,   24,   14, 3618, 8156, 4769, 8164, 4773,
       3620, 3615, 4768, 8163, 3617, 8166, 3619, 3616,    0]), 'topk_tokens': [' apple', ' location', '.', ' kitchen', '\n\n', '\n', ' the', ' before', ' went', '<|start_header_id|>', ' office', '.', '.', ' Daniel', '<|eot_id|>', ' took', '<|end_header_id|>', ' apple', ' Daniel', '<|begin_of_text|>'], 'evidence_proportions': [1981.0, 959.4375, 511.9, 64.86458333333333]}, 'weight': {'score': [24.042782738095237, 23.276028916768666, 21.630055147058822, 23.277489778037385, 29.322403169014084], 'topk_indices': array([3274, 3247, 3119, 3167, 7385, 7423, 1399, 1461, 4268, 4284, 5177,
       5116, 7148, 7092, 3456, 3430, 4893, 4918, 4970, 4941]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.568359375, 24.8671875, 19.909375, 24.979166666666668]}, 'saliency': {'score': [5.228765578497024, 0.29942326633261934, 1.976461971507353, 0.28318791874980787, 0.34075154049295775], 'topk_indices': array([3615, 4102, 6601, 3566, 8022, 4178, 8150, 3467, 3614, 8066, 4623,
       8155, 8156, 4769, 8158, 4773, 3617, 4768, 3619, 3616]), 'topk_tokens': ['.', ' travelled', ' Daniel', ' speakers', ' context', ' bedroom', 'Question', ' Ramsey', ' Hon', ' location', ' representatives', ' apple', ' before', ' went', ' kitchen', ' office', ' took', ' Daniel', ' apple', ' Daniel'], 'evidence_proportions': [13.86376953125, 6.29541015625, 2.8033203125, 0.4266560872395833]}}, 'pred_res': "Daniel's hand<|eot_id|>", 'score': 0}
2025-01-22 20:42:08.984 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:42:08.984 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-194_pid-3_4-6-8-9.pkl | len: 3 |  size: 2.04 KB
Processing depth (4, 6, 8, 9):   4%|â–         | 4/100 [01:33<35:29, 22.18s/it]is_0k: False
your chose emoji: ['ğŸ§‘ğŸ½\u200dğŸ³', 'ğŸ§ğŸ¾\u200dâ™€\u200dâ¡', 'ğŸ¢', 'â›¹ğŸ¿\u200dâ™‚', 'ğŸ‘¨ğŸ»\u200dâœˆ', 'ğŸ‘°ğŸ½\u200dâ™‚', 'ğŸ‘±ğŸ¾', 'ğŸ¤³ğŸ»', 'ğŸŠğŸ¾', 'ğŸ’¢']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.40s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.45s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.20s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.93s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.44s/it]
Processing depth (0, 1, 4, 5):   4%|â–         | 4/100 [01:48<35:29, 22.18s/it]2025-01-22 20:42:24.777 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel took the apple.
2025-01-22 20:42:24.815 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went back to the office.
2025-01-22 20:42:24.819 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (832, 838) --> . Daniel went back to the
2025-01-22 20:42:24.819 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the kitchen.
2025-01-22 20:42:24.837 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3633, 3638) --> . Daniel moved to the
2025-01-22 20:42:24.837 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra picked up the milk there.
2025-01-22 20:42:24.857 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4245, 4251) -->  Sandra picked up the milk there
2025-01-22 20:42:24.857 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the office.
2025-01-22 20:42:24.877 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4091, 4096) --> . Mary travelled to the
2025-01-22 20:42:24.877 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the hallway.
2025-01-22 20:42:24.912 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (7207, 7213) --> . Mary journeyed to the
2025-01-22 20:42:24.912 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the bedroom.
2025-01-22 20:42:24.932 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4143, 4149) --> . John journeyed to the
2025-01-22 20:42:24.932 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 20:42:24.932 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 20:42:24.933 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 20:42:24.933 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ‘¨ğŸ¿\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘¨ğŸ¾', 'ğŸ™ğŸ»\u200dâ™€ï¸', 'ğŸ‘¬ğŸ¿', 'ğŸ§œ\u200dâ™€ï¸', 'ğŸ¥¶', 'ğŸ‡§ğŸ‡§', 'ğŸ¥', 'â†©ï¸', 'ğŸ§—ğŸ»\u200dâ™€ï¸', 'ğŸ‘']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.27s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.47s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.51s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.12s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.61s/it]
Processing depth (0, 1, 4, 6):   4%|â–         | 4/100 [02:05<35:29, 22.18s/it]2025-01-22 20:42:41.326 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel took the apple.
2025-01-22 20:42:41.365 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went back to the office.
2025-01-22 20:42:41.369 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (834, 840) --> . Daniel went back to the
2025-01-22 20:42:41.369 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the kitchen.
2025-01-22 20:42:41.386 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3619, 3624) --> . Daniel moved to the
2025-01-22 20:42:41.386 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra picked up the milk there.
2025-01-22 20:42:41.409 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4782, 4788) --> . Sandra picked up the milk
2025-01-22 20:42:41.409 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the office.
2025-01-22 20:42:41.429 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4077, 4082) --> . Mary travelled to the
2025-01-22 20:42:41.429 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the hallway.
2025-01-22 20:42:41.463 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (7132, 7138) -->  Mary journeyed to the hallway
2025-01-22 20:42:41.464 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the bedroom.
2025-01-22 20:42:41.484 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4129, 4135) --> . John journeyed to the
2025-01-22 20:42:41.484 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 20:42:41.484 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 20:42:41.484 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 20:42:41.484 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['ğŸ§‘ğŸ¾\u200dğŸ«', 'ğŸ§‘ğŸ½\u200dâœˆï¸', 'ğŸ¤Œ', 'ğŸ‘¨ğŸ»\u200dğŸ¦°', 'ğŸ§‘ğŸ»\u200dğŸ”§', 'ğŸ‘©ğŸ¿\u200dğŸ¤\u200dğŸ‘©ğŸ»', 'ğŸ‘¨ğŸ¿\u200dâ¤\u200dğŸ‘¨ğŸ½', 'ğŸª¨', 'ğŸ‡µğŸ‡°', 'ğŸ‡ªğŸ‡º']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  3.86s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:07<00:07,  3.82s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:11<00:03,  3.99s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:12<00:00,  2.80s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:12<00:00,  3.20s/it]
Processing depth (2, 3, 7, 9):   4%|â–         | 4/100 [02:20<35:29, 22.18s/it]2025-01-22 20:42:56.016 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel took the apple.
2025-01-22 20:42:56.025 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1860, 1864) -->  Daniel took the apple
2025-01-22 20:42:56.026 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went back to the office.
2025-01-22 20:42:56.041 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2958, 2964) --> . Daniel went back to the
2025-01-22 20:42:56.041 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the kitchen.
2025-01-22 20:42:56.069 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5661, 5666) -->  Daniel moved to the kitchen
2025-01-22 20:42:56.069 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra picked up the milk there.
2025-01-22 20:42:56.105 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7140, 7146) -->  Sandra picked up the milk there
2025-01-22 20:42:56.106 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the office.
2025-01-22 20:42:56.129 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4085, 4090) --> . Mary travelled to the
2025-01-22 20:42:56.129 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the hallway.
2025-01-22 20:42:56.165 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (7100, 7106) --> . Mary journeyed to the
2025-01-22 20:42:56.165 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the bedroom.
2025-01-22 20:42:56.187 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4137, 4143) --> . John journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:42:57.037 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's house.<|eot_id|>
2025-01-22 20:42:57.037 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8198])
2025-01-22 20:42:59.279 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [253.1123511904762, 31.085131478658536, 164.88051470588235, 30.235205831903944, 22.800327034883722], 'topk_indices': array([8086, 8052, 1860, 7532, 8181, 7577, 8189,    1,   14, 8096, 1867,
       1863,   24, 1868, 8196, 8188, 8186, 8193,    0, 8194]), 'topk_tokens': ['.\n\n', ' context', ' Daniel', 'nes', ':', 'nes', '?', '<|start_header_id|>', '\n', ' location', ' *', ' apple', '\n\n', '      ', '<|end_header_id|>', ' kitchen', ' before', '<|eot_id|>', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [668.0, 116.85416666666667, 334.575, 44.893229166666664]}, 'weight': {'score': [24.782366071428573, 23.311638719512196, 20.034007352941178, 23.314681412337663, 29.96547965116279], 'topk_indices': array([3305, 3332, 3225, 3177, 7469, 7431, 1423, 1485, 4309, 4325, 5195,
       5134, 7152, 7208, 3514, 3488, 4936, 4959, 4911, 4988]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.568359375, 20.927083333333332, 24.6984375, 27.516927083333332]}, 'saliency': {'score': [1.6673787434895833, 0.17211723513719512, 0.9178251378676471, 0.1667169011477541, 0.17090819602788881], 'topk_indices': array([8167, 1866, 8191,   24, 8189, 7384, 8180, 8182, 8052, 7576, 7532,
       7577, 8185, 1867, 1860, 1868, 8096, 1863, 8186, 8188]), 'topk_tokens': [' return', '      ', 'Answer', '\n\n', '?', 'nes', 'Question', ' Where', ' context', ' Min', 'nes', 'nes', ' apple', ' *', ' Daniel', '      ', ' location', ' apple', ' before', ' kitchen'], 'evidence_proportions': [4.68115234375, 0.66748046875, 2.076171875, 0.3174336751302083]}}, 'pred_res': "Daniel's house.<|eot_id|>", 'score': 0}
2025-01-22 20:42:59.286 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:42:59.287 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-194_pid-4_2-3-7-9.pkl | len: 3 |  size: 2.02 KB
Processing depth (2, 3, 7, 9):   5%|â–Œ         | 5/100 [02:23<51:10, 32.32s/it]Processing depth (2, 3, 7, 9):   5%|â–Œ         | 5/100 [02:23<45:25, 28.69s/it]
2025-01-22 20:42:59.344 | INFO     | __main__:<module>:82 - Selected idx: 196
2025-01-22 20:42:59.344 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the milk before the bedroom? 
2025-01-22 20:42:59.344 | INFO     | __main__:<module>:84 - Answer: garden
2025-01-22 20:42:59.344 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 20:42:59.344 | INFO     | __main__:<module>:86 - Needle: [' John journeyed to the bedroom.', ' Daniel grabbed the milk.', ' Daniel moved to the kitchen.', ' Sandra picked up the milk.', ' Daniel journeyed to the bathroom.', ' Sandra journeyed to the garden.', ' Daniel went back to the office.', ' Mary journeyed to the hallway.', ' Mary travelled to the office.', ' Sandra went to the bedroom.', ' Daniel journeyed to the hallway.']
2025-01-22 20:42:59.344 | INFO     | __main__:<module>:87 - Real Needle: [' Sandra picked up the milk.', ' Sandra journeyed to the garden.', ' Sandra went to the bedroom.', ' Daniel journeyed to the hallway.']
2025-01-22 20:42:59.344 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ§ğŸ¿\u200dâ¡ï¸', 'ğŸ‘¨ğŸ¾\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘¨ğŸ¾', 'ğŸ¤˜ğŸ½', 'ğŸš¶ğŸ½\u200dâ™‚\u200dâ¡', 'ğŸ§‘\u200dğŸ¦±', 'ğŸ™‚\u200dâ†”', 'ğŸ§­', 'ğŸ™\u200dâ™€ï¸', 'ğŸ‘±\u200dâ™€', 'ğŸ‘¨ğŸ¾\u200dğŸ¦¯\u200dâ¡']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.23s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:09,  4.52s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.26s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.95s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.46s/it]
Processing depth (0, 1, 8, 9):   0%|          | 0/100 [00:15<?, ?it/s]2025-01-22 20:43:15.379 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra picked up the milk.
2025-01-22 20:43:15.379 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (32, 37) -->  picked up the milk.
2025-01-22 20:43:15.379 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra journeyed to the garden.
2025-01-22 20:43:15.384 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (902, 908) --> . Sandra journeyed to the
2025-01-22 20:43:15.384 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went to the bedroom.
2025-01-22 20:43:15.420 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6620, 6625) --> . Sandra went to the
2025-01-22 20:43:15.421 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the hallway.
2025-01-22 20:43:15.440 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3838, 3844) -->  Mary journeyed to the hallway
2025-01-22 20:43:15.440 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John journeyed to the bedroom.
2025-01-22 20:43:15.460 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4044, 4050) --> . John journeyed to the
2025-01-22 20:43:15.460 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel grabbed the milk.
2025-01-22 20:43:15.472 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2408, 2412) -->  Daniel grabbed the milk
2025-01-22 20:43:15.472 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the kitchen.
2025-01-22 20:43:15.477 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (973, 978) --> . Daniel moved to the
2025-01-22 20:43:15.477 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the bathroom.
2025-01-22 20:43:15.513 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6110, 6116) -->  Daniel journeyed to the bathroom
2025-01-22 20:43:15.513 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel went back to the office.
2025-01-22 20:43:15.533 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3560, 3566) --> . Daniel went back to the
2025-01-22 20:43:15.533 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary journeyed to the hallway.
2025-01-22 20:43:15.552 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (3837, 3843) --> . Mary journeyed to the
2025-01-22 20:43:15.552 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Mary travelled to the office.
2025-01-22 20:43:15.584 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (6434, 6439) --> . Mary travelled to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:43:16.336 | INFO     | test_jbb_embedding:begin_test:693 - the kitchen<|eot_id|>
2025-01-22 20:43:16.336 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8195])
2025-01-22 20:43:18.560 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [267.4275568181818, 24.236057956208832, 120.78289473684211, 23.127801287171295, 27.83629511443662], 'topk_indices': array([8183,   40,   36,  104,   65, 8193,   24,   14,  908,   35,   66,
       8191,  105,   70,   67, 8190,   68,  106,   69,    0]), 'topk_tokens': [' before', '\n\n\n', '.', ' OF', 'ENCES', '<|end_header_id|>', '\n\n', '\n', ' garden', ' milk', ' OF', '<|start_header_id|>', ' P', 'ER', ' P', '<|eot_id|>', 'ION', 'ION', 'E', '<|begin_of_text|>'], 'evidence_proportions': [566.25, 355.5833333333333, 83.04375, 83.90625]}, 'weight': {'score': [22.371803977272727, 23.27274563918029, 21.810855263157894, 23.28200744193905, 29.182438380281692], 'topk_indices': array([3323, 3296, 3160, 3208, 7454, 7416, 1419, 1481, 4312, 4328, 5202,
       5141, 7130, 7186, 3505, 3479, 4925, 4900, 4948, 4977]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.025, 21.213541666666668, 20.796875, 25.131510416666668]}, 'saliency': {'score': [1.5363880504261365, 0.13686598484386436, 0.7246077688116777, 0.1303381311656158, 0.19731849348041372], 'topk_indices': array([  31,  903,   58,  103,   40, 8185,   64,  974,   32,   66,    0,
        105,   65,  908,   35,   70,   67,   69,   68,  106]), 'topk_tokens': ['andra', ' Sandra', ' Proof', 'ENCES', '\n\n\n', ' bedroom', 'ISC', ' Daniel', ' picked', ' OF', '<|begin_of_text|>', ' P', 'ENCES', ' garden', ' milk', 'ER', ' P', 'E', 'ION', 'ION'], 'evidence_proportions': [3.2037109375, 1.9772135416666667, 0.48896484375, 0.5789794921875]}}, 'pred_res': 'the kitchen<|eot_id|>', 'score': 0}
2025-01-22 20:43:18.566 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:43:18.566 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-196_pid-0_0-1-8-9.pkl | len: 3 |  size: 1.98 KB
Processing depth (0, 1, 8, 9):   1%|          | 1/100 [00:19<31:32, 19.12s/it]is_0k: False
your chose emoji: ['9âƒ£', 'ğŸ“Š', 'ğŸ§˜ğŸ¿\u200dâ™‚ï¸', 'ğŸ‹ğŸ¾\u200dâ™€', 'ğŸ¤½ğŸ¼\u200dâ™‚', 'ğŸ‘‚ğŸ½', 'ğŸ”‰', 'ğŸ¤¦ğŸ½\u200dâ™‚', 'ğŸ‘©ğŸ½\u200dğŸš’', 'ğŸ§‘ğŸ»\u200dâœˆ']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  3.93s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.47s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.27s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.78s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.33s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (1, 3, 4, 9):   1%|          | 1/100 [00:34<31:32, 19.12s/it]2025-01-22 20:43:33.692 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra picked up the milk.
2025-01-22 20:43:33.696 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (895, 900) --> . Sandra picked up the
2025-01-22 20:43:33.696 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra journeyed to the garden.
2025-01-22 20:43:33.713 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3048, 3054) --> . Sandra journeyed to the
2025-01-22 20:43:33.713 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went to the bedroom.
2025-01-22 20:43:33.731 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3661, 3666) -->  Sandra went to the bedroom
2025-01-22 20:43:33.731 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the hallway.
2025-01-22 20:43:33.753 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3864, 3870) -->  journeyed to the hallway.
2025-01-22 20:43:33.754 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John journeyed to the bedroom.
2025-01-22 20:43:33.776 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4012, 4018) -->  John journeyed to the bedroom
2025-01-22 20:43:33.776 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel grabbed the milk.
2025-01-22 20:43:33.791 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2466, 2470) -->  Daniel grabbed the milk
2025-01-22 20:43:33.791 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the kitchen.
2025-01-22 20:43:33.796 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (965, 970) --> . Daniel moved to the
2025-01-22 20:43:33.796 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the bathroom.
2025-01-22 20:43:33.827 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6135, 6141) -->  Daniel journeyed to the bathroom
2025-01-22 20:43:33.827 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel went back to the office.
2025-01-22 20:43:33.845 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3627, 3633) --> . Daniel went back to the
2025-01-22 20:43:33.845 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary journeyed to the hallway.
2025-01-22 20:43:33.869 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (3863, 3869) -->  Mary journeyed to the hallway
2025-01-22 20:43:33.869 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Mary travelled to the office.
2025-01-22 20:43:33.901 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (6441, 6446) --> . Mary travelled to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:43:36.288 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 20:43:36.289 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8210])
2025-01-22 20:43:39.055 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [271.16335227272725, 23.140082795568002, 164.46546052631578, 21.812120538452103, 22.065330795094937], 'topk_indices': array([3051,  967,  970, 8201,    9, 8197,  966,  895,  900,  896, 8200,
       3054,   24, 8198,  901, 8208, 8206,   14,    0, 8205]), 'topk_tokens': ['ed', ' moved', ' kitchen', '?', ':', ' milk', ' Daniel', '.', ' milk', ' Sandra', ' bedroom', ' garden', '\n\n', ' before', '.', '<|end_header_id|>', '<|start_header_id|>', '\n', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [515.9, 375.7083333333333, 160.3, 55.057291666666664]}, 'weight': {'score': [22.887428977272727, 23.289325992329236, 23.32689144736842, 23.290235381148044, 29.401503164556964], 'topk_indices': array([3249, 3276, 3121, 3169, 7471, 7433, 1473, 1411, 4377, 4361, 5233,
       5172, 7210, 7154, 3432, 3458, 4974, 5026, 4949, 4997]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [23.49375, 21.213541666666668, 26.2234375, 21.276041666666668]}, 'saliency': {'score': [1.6524880149147727, 0.1290345776607969, 0.9721535130550987, 0.12099404102832163, 0.16204061387460442], 'topk_indices': array([8194, 8201, 2469, 2467,   14, 8192, 8108,   24, 3050, 3049,  967,
        897,  970, 8197,  966, 8198,  900, 3054, 8200,  896]), 'topk_tokens': [' Where', '?', ' milk', ' grabbed', '\n', 'Question', ' location', '\n\n', ' journey', ' Sandra', ' moved', ' picked', ' kitchen', ' milk', ' Daniel', ' before', ' milk', ' garden', ' bedroom', ' Sandra'], 'evidence_proportions': [3.218359375, 2.158935546875, 1.080859375, 0.3175048828125]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 0}
2025-01-22 20:43:39.062 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:43:39.063 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-196_pid-1_1-3-4-9.pkl | len: 3 |  size: 2.01 KB
Processing depth (1, 3, 4, 9):   2%|â–         | 2/100 [00:39<32:32, 19.93s/it]is_0k: False
your chose emoji: ['\U0001faf1ğŸ»\u200d\U0001faf2ğŸ¼', 'â˜ğŸ¼', 'ğŸ§šğŸ»\u200dâ™€', 'ğŸƒğŸ¿\u200dâ™‚', 'ğŸ‡³ğŸ‡·', 'ğŸ’‡ğŸ¼', 'ğŸ¦¤', 'ğŸ§‘ğŸ½\u200dğŸ’»', 'ğŸ„', 'ğŸ§‘ğŸ»\u200dâ¤\u200dğŸ’‹\u200dğŸ§‘ğŸ¼']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.30s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.60s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.39s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.03s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.55s/it]
Processing depth (5, 6, 7, 9):   2%|â–         | 2/100 [00:55<32:32, 19.93s/it]2025-01-22 20:43:55.130 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra picked up the milk.
2025-01-22 20:43:55.150 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4253, 4258) --> . Sandra picked up the
2025-01-22 20:43:55.150 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra journeyed to the garden.
2025-01-22 20:43:55.174 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4939, 4945) --> . Sandra journeyed to the
2025-01-22 20:43:55.175 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went to the bedroom.
2025-01-22 20:43:55.202 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5824, 5829) --> . Sandra went to the
2025-01-22 20:43:55.203 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the hallway.
2025-01-22 20:43:55.222 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3862, 3868) -->  Mary journeyed to the hallway
2025-01-22 20:43:55.222 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John journeyed to the bedroom.
2025-01-22 20:43:55.242 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4086, 4092) --> . John journeyed to the
2025-01-22 20:43:55.242 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel grabbed the milk.
2025-01-22 20:43:55.252 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2198, 2202) -->  Daniel grabbed the milk
2025-01-22 20:43:55.252 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the kitchen.
2025-01-22 20:43:55.256 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (831, 836) --> . Daniel moved to the
2025-01-22 20:43:55.256 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the bathroom.
2025-01-22 20:43:55.287 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6296, 6302) --> . Daniel journeyed to the
2025-01-22 20:43:55.287 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel went back to the office.
2025-01-22 20:43:55.305 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3595, 3601) -->  Hon. Daniel went back to
2025-01-22 20:43:55.305 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary journeyed to the hallway.
2025-01-22 20:43:55.324 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (3861, 3867) --> . Mary journeyed to the
2025-01-22 20:43:55.324 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Mary travelled to the office.
2025-01-22 20:43:55.355 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (6491, 6496) --> . Mary travelled to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:43:56.171 | INFO     | test_jbb_embedding:begin_test:693 - The hallway.<|eot_id|>
2025-01-22 20:43:56.171 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8218])
2025-01-22 20:43:58.406 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [300.3494318181818, 39.96773126748571, 258.1735197368421, 38.249777907119224, 32.660109186746986], 'topk_indices': array([7648,    9, 8216, 7596, 7605, 7636, 2201, 7604, 7641, 7635,   14,
       7649, 7562, 7518, 7597, 8213, 7563, 7606,    0, 7650]), 'topk_tokens': [' and', ':', '<|end_header_id|>', ' tele', ' or', ' five', ' milk', ' two', ' tele', ' or', '\n', ' two', ' Min', 'nes', 'graph', '<|eot_id|>', 'nes', ' three', '<|begin_of_text|>', ' or'], 'evidence_proportions': [448.65, 307.7708333333333, 132.7375, 309.0208333333333]}, 'weight': {'score': [22.705610795454547, 23.295898081133682, 21.694901315789473, 23.30494405556917, 29.4324171686747], 'topk_indices': array([3285, 3258, 3130, 3178, 7417, 7455, 1489, 1427, 4264, 4280, 5136,
       5197, 7187, 7131, 3467, 3441, 4852, 4877, 4900, 4929]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [23.49375, 21.213541666666668, 20.796875, 25.131510416666668]}, 'saliency': {'score': [1.8755770596590908, 0.22861736758377935, 1.497593929893092, 0.218268853603457, 0.2436913180064006], 'topk_indices': array([7601, 7517, 7602, 7646, 7605, 4254, 7635, 7640, 7636, 7604, 7649,
       2201, 7596, 7641, 7518, 7562, 7597, 7563, 7606, 7650]), 'topk_tokens': [' set', ' Min', ' up', ' set', ' or', ' Sandra', ' or', ' bogus', ' five', ' two', ' two', ' milk', ' tele', ' tele', 'nes', ' Min', 'graph', 'nes', ' three', ' or'], 'evidence_proportions': [2.9158203125, 1.7313639322916667, 0.74541015625, 2.0947265625]}}, 'pred_res': 'The hallway.<|eot_id|>', 'score': 0}
2025-01-22 20:43:58.411 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:43:58.411 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-196_pid-2_5-6-7-9.pkl | len: 3 |  size: 1.96 KB
Processing depth (5, 6, 7, 9):   3%|â–         | 3/100 [00:58<31:47, 19.66s/it]is_0k: False
your chose emoji: ['â˜ğŸ¿', 'ğŸ‘°', 'ğŸ§–ğŸ½\u200dâ™€', 'ğŸš£ğŸ»\u200dâ™‚ï¸', 'ğŸ‘©ğŸ¼\u200dğŸ¤\u200dğŸ‘©ğŸ¿', 'ğŸ‘©ğŸ¼\u200dâ¤\u200dğŸ’‹\u200dğŸ‘©ğŸ¾', 'ğŸ¥·ğŸ¿', 'ğŸ‘©ğŸ¾', 'ğŸŒ«ï¸', 'ğŸ¤ğŸ¿']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.46s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.59s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.53s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.11s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.64s/it]
Processing depth (0, 5, 6, 8):   3%|â–         | 3/100 [01:15<31:47, 19.66s/it]2025-01-22 20:44:14.908 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra picked up the milk.
2025-01-22 20:44:14.908 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (32, 37) -->  picked up the milk.
2025-01-22 20:44:14.908 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra journeyed to the garden.
2025-01-22 20:44:14.929 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4168, 4174) --> . Sandra journeyed to the
2025-01-22 20:44:14.929 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went to the bedroom.
2025-01-22 20:44:14.952 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4665, 4670) --> . Sandra went to the
2025-01-22 20:44:14.952 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the hallway.
2025-01-22 20:44:14.975 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3823, 3829) -->  Mary journeyed to the hallway
2025-01-22 20:44:14.975 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John journeyed to the bedroom.
2025-01-22 20:44:14.994 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3974, 3980) -->  to the ground. John journey
2025-01-22 20:44:14.994 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel grabbed the milk.
2025-01-22 20:44:15.004 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2049, 2053) -->  Daniel grabbed the milk
2025-01-22 20:44:15.004 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the kitchen.
2025-01-22 20:44:15.009 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (923, 928) -->  Daniel moved to the kitchen
2025-01-22 20:44:15.009 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the bathroom.
2025-01-22 20:44:15.043 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6132, 6138) -->  Daniel journeyed to the bathroom
2025-01-22 20:44:15.044 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel went back to the office.
2025-01-22 20:44:15.061 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3523, 3529) --> . Daniel went back to the
2025-01-22 20:44:15.062 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary journeyed to the hallway.
2025-01-22 20:44:15.080 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (3822, 3828) --> . Mary journeyed to the
2025-01-22 20:44:15.081 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Mary travelled to the office.
2025-01-22 20:44:15.112 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (6456, 6461) --> . Mary travelled to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:44:15.912 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 20:44:15.913 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8185])
2025-01-22 20:44:18.130 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [341.43465909090907, 41.54639029677577, 218.671875, 39.90658833661417, 42.805160984848484], 'topk_indices': array([  65, 8175,   14,  542, 8173,  425, 8181,   24,  186, 4407,   66,
        426,  105, 8180,   67,   70,  106,   68,   69,    0]), 'topk_tokens': ['ENCES', ' bedroom', '\n', ' to', ' before', ' to', '<|start_header_id|>', '\n\n', 'ION', 'ot', ' OF', ' ', ' P', '<|eot_id|>', ' P', 'ER', 'ION', 'ION', 'E', '<|begin_of_text|>'], 'evidence_proportions': [561.4, 394.2916666666667, 133.0625, 278.9166666666667]}, 'weight': {'score': [22.371803977272727, 23.273800073277968, 22.72060032894737, 23.27882781742126, 29.695549242424242], 'topk_indices': array([3332, 3305, 3177, 3225, 7414, 7452, 1500, 1438, 4332, 4348, 5169,
       5230, 7135, 7191, 3488, 3514, 4994, 4971, 4946, 5023]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.025, 21.213541666666668, 20.796875, 25.131510416666668]}, 'saliency': {'score': [2.001309481534091, 0.23588286950987725, 1.3066598992598684, 0.22609830841304748, 0.32652352072975854], 'topk_indices': array([ 549,    0,   35, 8172,  903,   66, 4406, 4169,  105, 8173, 4407,
         65,  186, 1015, 8175,   67,   70,   69,  106,   68]), 'topk_tokens': [' per', '<|begin_of_text|>', ' milk', ' milk', 'ï¿½', ' OF', 'nes', ' Sandra', ' P', ' before', 'ot', 'ENCES', 'ION', ' Minnesota', ' bedroom', ' P', 'ER', 'E', 'ION', 'ION'], 'evidence_proportions': [3.0541015625, 2.314697265625, 0.68994140625, 1.9034016927083333]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 0}
2025-01-22 20:44:18.136 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:44:18.137 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-196_pid-3_0-5-6-8.pkl | len: 3 |  size: 1.96 KB
Processing depth (0, 5, 6, 8):   4%|â–         | 4/100 [01:18<31:30, 19.69s/it]is_0k: False
your chose emoji: ['ğŸ§‘ğŸ¿\u200dğŸ­', 'â™¨', 'ğŸ', 'ğŸ¤½ğŸ»\u200dâ™‚ï¸', 'ğŸš¶ğŸ½\u200dâ™‚ï¸', 'ğŸ›¡', 'ğŸš¶ğŸ¾\u200dâ™‚\u200dâ¡ï¸', 'ğŸ”§', 'ğŸ–²', 'ğŸ™…ğŸ¿\u200dâ™€ï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.21s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.64s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.52s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.10s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.61s/it]
Processing depth (2, 3, 4, 9):   4%|â–         | 4/100 [01:34<31:30, 19.69s/it]2025-01-22 20:44:34.302 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra picked up the milk.
2025-01-22 20:44:34.311 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1860, 1865) -->  Sandra picked up the milk
2025-01-22 20:44:34.311 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra journeyed to the garden.
2025-01-22 20:44:34.326 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2964, 2970) --> . Sandra journeyed to the
2025-01-22 20:44:34.326 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went to the bedroom.
2025-01-22 20:44:34.344 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3685, 3690) -->  Hon. Sandra went to
2025-01-22 20:44:34.344 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the hallway.
2025-01-22 20:44:34.364 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3925, 3931) -->  Mary journeyed to the hallway
2025-01-22 20:44:34.364 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John journeyed to the bedroom.
2025-01-22 20:44:34.384 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4129, 4135) --> . John journeyed to the
2025-01-22 20:44:34.384 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel grabbed the milk.
2025-01-22 20:44:34.395 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2238, 2242) -->  Daniel grabbed the milk
2025-01-22 20:44:34.395 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the kitchen.
2025-01-22 20:44:34.400 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (959, 964) --> . Daniel moved to the
2025-01-22 20:44:34.400 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the bathroom.
2025-01-22 20:44:34.433 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6254, 6260) --> . Daniel journeyed to the
2025-01-22 20:44:34.433 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel went back to the office.
2025-01-22 20:44:34.453 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3657, 3663) --> . Daniel went back to the
2025-01-22 20:44:34.454 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary journeyed to the hallway.
2025-01-22 20:44:34.475 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (3924, 3930) --> . Mary journeyed to the
2025-01-22 20:44:34.475 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Mary travelled to the office.
2025-01-22 20:44:34.507 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (6525, 6530) --> . Mary travelled to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:44:35.300 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 20:44:35.300 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8258])
2025-01-22 20:44:37.557 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [334.4801136363636, 26.247459826292218, 141.31496710526315, 24.88742036032191, 27.828712833737864], 'topk_indices': array([ 961, 1860, 2970, 8245,    9, 2251,  964, 8146,   24, 8248, 1865,
       8256, 2965, 8246,   14, 8253, 8254, 2966, 2967,    0]), 'topk_tokens': [' moved', ' Sandra', ' garden', ' milk', ':', 'E', ' kitchen', '.\n\n', '\n\n', ' bedroom', '.', '<|end_header_id|>', ' Sandra', ' before', '\n', '<|eot_id|>', '<|start_header_id|>', ' journey', 'ed', '<|begin_of_text|>'], 'evidence_proportions': [375.925, 733.2708333333334, 118.675, 80.98958333333333]}, 'weight': {'score': [24.832741477272727, 23.330296347294517, 21.062294407894736, 23.336774859773197, 29.620297330097088], 'topk_indices': array([3305, 3332, 3225, 3177, 7503, 7541, 1405, 1467, 4363, 4347, 5178,
       5239, 7280, 7224, 3524, 3550, 4983, 4935, 5012, 4960]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.0453125, 21.213541666666668, 25.6046875, 25.131510416666668]}, 'saliency': {'score': [2.2079634232954546, 0.14836218316392538, 0.8260120592619243, 0.13969715175621686, 0.20587987807190533], 'topk_indices': array([1861, 7649, 8156, 2241,  257, 3691, 8240, 8112, 1842,  961,  960,
       2970, 8245, 8246,  964, 1860, 8248, 2967, 2965, 2966]), 'topk_tokens': [' picked', 'nes', ' location', ' milk', 'hue', ' bedroom', 'Question', ' context', 'ï¿½', ' moved', ' Daniel', ' garden', ' milk', ' before', ' kitchen', ' Sandra', ' bedroom', 'ed', ' Sandra', ' journey'], 'evidence_proportions': [2.85810546875, 4.548746744791667, 0.708984375, 0.5745442708333334]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 0}
2025-01-22 20:44:37.564 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:44:37.564 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-196_pid-4_2-3-4-9.pkl | len: 3 |  size: 2.03 KB
Processing depth (2, 3, 4, 9):   5%|â–Œ         | 5/100 [01:38<31:01, 19.59s/it]Processing depth (2, 3, 4, 9):   5%|â–Œ         | 5/100 [01:39<31:23, 19.82s/it]
2025-01-22 20:44:38.566 | INFO     | __main__:<module>:82 - Selected idx: 198
2025-01-22 20:44:38.566 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the milk before the office? 
2025-01-22 20:44:38.566 | INFO     | __main__:<module>:84 - Answer: bathroom
2025-01-22 20:44:38.566 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 20:44:38.566 | INFO     | __main__:<module>:86 - Needle: [' Mary travelled to the office.', ' Daniel grabbed the milk.', ' Mary journeyed to the hallway.', ' Daniel journeyed to the bathroom.', ' John journeyed to the bedroom.', ' John went back to the office.', ' Daniel went to the office.', ' Mary travelled to the bedroom.']
2025-01-22 20:44:38.566 | INFO     | __main__:<module>:87 - Real Needle: [' Daniel grabbed the milk.', ' Daniel journeyed to the bathroom.', ' Daniel went to the office.', ' Mary travelled to the bedroom.']
2025-01-22 20:44:38.566 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['ğŸ¤¾ğŸ¿\u200dâ™€', 'ğŸ§‘ğŸ½\u200dğŸ³', 'ğŸ‘®ğŸ»\u200dâ™€', 'ğŸ‘°ğŸ½\u200dâ™‚', 'ğŸ—', 'ğŸ‘¨ğŸ¼\u200dâ¤\u200dğŸ’‹\u200dğŸ‘¨ğŸ»', 'ğŸ§‘ğŸ¾\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ§‘ğŸ»', 'ğŸ™ğŸ¼\u200dâ™€', 'ğŸ§‘ğŸ¼\u200dğŸ¦½\u200dâ¡', 'ğŸ‘¨\u200dğŸ¤']
is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:10,  3.66s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.37s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.30s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.79s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.30s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (5, 7, 8, 9):   0%|          | 0/100 [00:14<?, ?it/s]2025-01-22 20:44:53.591 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel grabbed the milk.
2025-01-22 20:44:53.614 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4147, 4151) -->  Daniel grabbed the milk
2025-01-22 20:44:53.615 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the bathroom.
2025-01-22 20:44:53.645 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5573, 5579) --> . Daniel journeyed to the
2025-01-22 20:44:53.645 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the office.
2025-01-22 20:44:53.656 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1556, 1561) -->  back to the office.
2025-01-22 20:44:53.657 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary travelled to the bedroom.
2025-01-22 20:44:53.679 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3894, 3899) --> . Mary travelled to the
2025-01-22 20:44:53.679 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the office.
2025-01-22 20:44:53.700 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3894, 3899) --> . Mary travelled to the
2025-01-22 20:44:53.701 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the hallway.
2025-01-22 20:44:53.734 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6255, 6261) --> . Mary journeyed to the
2025-01-22 20:44:53.734 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the bedroom.
2025-01-22 20:44:53.766 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6216, 6222) --> . John journeyed to the
2025-01-22 20:44:53.767 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the office.
2025-01-22 20:44:53.774 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1553, 1559) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:44:57.899 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's house.<|eot_id|>
2025-01-22 20:44:57.899 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8178])
2025-01-22 20:45:00.844 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [301.990625, 20.02941075357536, 160.87771739130434, 18.938388962275745, 10.577991224315069], 'topk_indices': array([   9, 8162, 5579, 3900, 4147, 4148, 8163, 8160, 8165,   14, 8169,
       4150, 8161, 8167, 8173, 8176, 8166,    0, 8168, 8174]), 'topk_tokens': [':', ' Where', ' bathroom', '.', ' Daniel', ' grabbed', ' was', 'Question', ' milk', '\n', '?', ' milk', ':', ' the', '<|eot_id|>', '<|end_header_id|>', ' before', '<|begin_of_text|>', ' office', '<|start_header_id|>'], 'evidence_proportions': [509.5, 252.60416666666666, 231.3875, 265.85]}, 'weight': {'score': [21.509765625, 23.28746485759687, 20.043478260869566, 23.30100205056525, 29.9375], 'topk_indices': array([3298, 3325, 3150, 3198, 7451, 7413, 1409, 1471, 4288, 4304, 5216,
       5155, 7184, 7128, 3507, 3481, 4926, 5003, 4951, 4974]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.263671875, 20.270833333333332, 18.346875, 20.75625]}, 'saliency': {'score': [1.8267578125, 0.11134122581094916, 0.815445609714674, 0.10513543414671142, 0.0798032577723673], 'topk_indices': array([  24, 6222,    8, 8161, 7923, 3899, 5574, 8163, 3896, 8076, 8169,
       8162, 4147, 5579, 4148, 8165, 4150, 8160, 8166, 8168]), 'topk_tokens': ['\n\n', ' bedroom', ' Date', ':', ' Square', ' office', ' Daniel', ' was', ' travelled', ' location', '?', ' Where', ' Daniel', ' bathroom', ' grabbed', ' milk', ' milk', 'Question', ' before', ' office'], 'evidence_proportions': [3.8826904296875, 1.421142578125, 1.02236328125, 1.47314453125]}}, 'pred_res': "Daniel's house.<|eot_id|>", 'score': 0}
2025-01-22 20:45:00.851 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:45:00.851 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-198_pid-0_5-7-8-9.pkl | len: 3 |  size: 2.02 KB
Processing depth (5, 7, 8, 9):   1%|          | 1/100 [00:22<36:35, 22.18s/it]is_0k: False
your chose emoji: ['ğŸ˜•', 'ğŸ‘¨ğŸ½\u200dâ¤ï¸\u200dğŸ’‹\u200dğŸ‘¨ğŸ½', 'ğŸŠ', 'ğŸ™ğŸ»\u200dâ™‚ï¸', 'ğŸ‡¿ğŸ‡¦', 'ğŸ§ğŸ¼\u200dâ™€ï¸\u200dâ¡ï¸', 'ğŸ‡§ğŸ‡´', 'ğŸ¦»ğŸ¾', 'ğŸ–‹', 'ğŸš¶ğŸ»']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.24s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.31s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.45s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.12s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.58s/it]
Processing depth (1, 4, 7, 8):   1%|          | 1/100 [00:38<36:35, 22.18s/it]2025-01-22 20:45:17.627 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel grabbed the milk.
2025-01-22 20:45:17.631 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (828, 832) -->  Daniel grabbed the milk
2025-01-22 20:45:17.631 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the bathroom.
2025-01-22 20:45:17.653 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3655, 3661) --> . Daniel journeyed to the
2025-01-22 20:45:17.654 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the office.
2025-01-22 20:45:17.663 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1727, 1732) -->  back to the office.
2025-01-22 20:45:17.663 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary travelled to the bedroom.
2025-01-22 20:45:17.683 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3954, 3959) --> . Mary travelled to the
2025-01-22 20:45:17.683 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the office.
2025-01-22 20:45:17.705 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3954, 3959) --> . Mary travelled to the
2025-01-22 20:45:17.705 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the hallway.
2025-01-22 20:45:17.736 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6315, 6321) --> . Mary journeyed to the
2025-01-22 20:45:17.737 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the bedroom.
2025-01-22 20:45:17.769 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6276, 6282) --> . John journeyed to the
2025-01-22 20:45:17.769 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the office.
2025-01-22 20:45:17.778 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1724, 1730) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:45:18.624 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's house.<|eot_id|>
2025-01-22 20:45:18.624 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8234])
2025-01-22 20:45:20.903 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [151.425, 16.343196096879932, 54.86141304347826, 15.905369020014644, 7.36111057394802], 'topk_indices': array([ 257, 8088, 8219,    9, 8218,    1, 8225, 8122, 8223, 8217, 8221,
         24, 8132,   14, 8232, 8224, 8222, 8229,    0, 8230]), 'topk_tokens': ['hue', ' context', ' was', ':', ' Where', '<|start_header_id|>', '?', '.\n\n', ' the', ':', ' milk', '\n\n', ' location', '\n', '<|end_header_id|>', ' office', ' before', '<|eot_id|>', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [344.90625, 118.21875, 105.95, 81.9625]}, 'weight': {'score': [21.509765625, 23.32758816923637, 20.043478260869566, 23.341243402184524, 29.730043316831683], 'topk_indices': array([3334, 3307, 3145, 3193, 7511, 7473, 1484, 1422, 4403, 4387, 5277,
       5216, 7250, 7194, 3548, 3522, 5070, 5041, 5018, 4993]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.263671875, 20.270833333333332, 18.346875, 20.75625]}, 'saliency': {'score': [0.927752685546875, 0.09102885607624135, 0.26813672936480976, 0.08848944215446325, 0.0537288779079324], 'topk_indices': array([7804,    8, 8219, 8122, 8131, 8225, 8128,   24, 3661, 8216,  829,
        831,  828, 8088, 8218,  257, 8132, 8221, 8222, 8224]), 'topk_tokens': ['inen', ' Date', ' was', '.\n\n', ' first', '?', ' item', '\n\n', ' bathroom', 'Question', ' grabbed', ' milk', ' Daniel', ' context', ' Where', 'hue', ' location', ' milk', ' before', ' office'], 'evidence_proportions': [2.579345703125, 0.65411376953125, 0.457861328125, 0.404736328125]}}, 'pred_res': "Daniel's house.<|eot_id|>", 'score': 0}
2025-01-22 20:45:20.911 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:45:20.911 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-198_pid-1_1-4-7-8.pkl | len: 3 |  size: 2.02 KB
Processing depth (1, 4, 7, 8):   2%|â–         | 2/100 [00:42<34:11, 20.93s/it]is_0k: False
your chose emoji: ['ğŸ‘©ğŸ»\u200dâ¤ï¸\u200dğŸ‘¨ğŸ¾', 'ğŸ§‘ğŸ¼\u200dâ¤ï¸\u200dğŸ§‘ğŸ¾', 'ğŸ§‘ğŸ¿\u200dğŸ’¼', 'ğŸƒğŸ¼\u200dâ™€ï¸', '\U0001faf6ğŸ½', 'ğŸŒğŸ¾\u200dâ™€ï¸', 'ğŸ§‘ğŸ¿\u200dğŸ¤\u200dğŸ§‘ğŸ¾', 'ğŸ“½', 'ğŸ§—\u200dâ™€ï¸', 'ğŸ‘¨ğŸ»\u200dğŸ¦±']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:12,  4.22s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.34s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.06s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:12<00:00,  2.66s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:12<00:00,  3.22s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (1, 4, 5, 7):   2%|â–         | 2/100 [00:56<34:11, 20.93s/it]2025-01-22 20:45:35.607 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel grabbed the milk.
2025-01-22 20:45:35.611 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (896, 900) -->  Daniel grabbed the milk
2025-01-22 20:45:35.612 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the bathroom.
2025-01-22 20:45:35.630 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3709, 3715) --> . Daniel journeyed to the
2025-01-22 20:45:35.630 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the office.
2025-01-22 20:45:35.639 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1771, 1776) -->  back to the office.
2025-01-22 20:45:35.639 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary travelled to the bedroom.
2025-01-22 20:45:35.659 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4030, 4035) --> . Mary travelled to the
2025-01-22 20:45:35.659 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the office.
2025-01-22 20:45:35.681 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4030, 4035) --> . Mary travelled to the
2025-01-22 20:45:35.681 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the hallway.
2025-01-22 20:45:35.713 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6261, 6267) -->  Mary journeyed to the hallway
2025-01-22 20:45:35.713 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the bedroom.
2025-01-22 20:45:35.746 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6221, 6227) --> . John journeyed to the
2025-01-22 20:45:35.746 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the office.
2025-01-22 20:45:35.755 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1768, 1774) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:45:40.788 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's house.<|eot_id|>
2025-01-22 20:45:40.788 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8183])
2025-01-22 20:45:43.835 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [138.4546875, 14.834975491693134, 49.52785326086956, 14.433363011175242, 10.718107524671053], 'topk_indices': array([8071, 8167, 8081,  900,  257,    1, 8168,    9, 8174, 8170, 8166,
         24, 8172,   14, 8178, 8171, 8181, 8173,    0, 8179]), 'topk_tokens': ['.\n\n', ' Where', ' location', '.', 'hue', '<|start_header_id|>', ' was', ':', '?', ' milk', ':', '\n\n', ' the', '\n', '<|eot_id|>', ' before', '<|end_header_id|>', ' office', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [322.8125, 90.53125, 119.175, 67.75625]}, 'weight': {'score': [21.509765625, 23.288348628756413, 21.368546195652176, 23.29813950632445, 28.66879111842105], 'topk_indices': array([3243, 3270, 3163, 3115, 7460, 7422, 1404, 1466, 4277, 4261, 5099,
       5160, 7143, 7199, 3452, 3426, 4901, 4924, 4953, 4876]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.263671875, 20.270833333333332, 18.346875, 20.75625]}, 'saliency': {'score': [0.82952880859375, 0.08204138276048666, 0.2548323921535326, 0.07971743068720834, 0.06861506010356702], 'topk_indices': array([8180, 8166, 8071, 7753,    8, 3715, 8168, 8174,   24,  897,  896,
        899, 8081, 8165, 7920, 8167,  257, 8170, 8171, 8173]), 'topk_tokens': ['assistant', ':', '.\n\n', 'inen', ' Date', ' bathroom', ' was', '?', '\n\n', ' grabbed', ' Daniel', ' milk', ' location', 'Question', ' Square', ' Where', 'hue', ' milk', ' before', ' office'], 'evidence_proportions': [2.333251953125, 0.4786580403645833, 0.54375, 0.3333740234375]}}, 'pred_res': "Daniel's house.<|eot_id|>", 'score': 0}
2025-01-22 20:45:43.843 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:45:43.843 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-198_pid-2_1-4-5-7.pkl | len: 3 |  size: 2.01 KB
Processing depth (1, 4, 5, 7):   3%|â–         | 3/100 [01:05<35:19, 21.85s/it]is_0k: False
your chose emoji: ['ğŸ‡²ğŸ‡°', 'ğŸš£ğŸ¿\u200dâ™€ï¸', 'ğŸ—“ï¸', 'ğŸ—º', 'ğŸŒ§', 'ğŸ§ğŸ¼\u200dâ™‚\u200dâ¡', 'ğŸ‘©ğŸ»\u200dâ¤ï¸\u200dğŸ‘©ğŸ½', 'ğŸ§›ğŸ½\u200dâ™€', '#ï¸âƒ£', 'ğŸ§‘ğŸ¾\u200dğŸ¦±']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.35s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:09,  4.52s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.43s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.05s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.56s/it]
Processing depth (1, 4, 7, 9):   3%|â–         | 3/100 [01:21<35:19, 21.85s/it]2025-01-22 20:46:00.035 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel grabbed the milk.
2025-01-22 20:46:00.040 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (896, 900) -->  Daniel grabbed the milk
2025-01-22 20:46:00.040 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the bathroom.
2025-01-22 20:46:00.058 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3607, 3613) --> . Daniel journeyed to the
2025-01-22 20:46:00.058 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the office.
2025-01-22 20:46:00.067 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1721, 1726) -->  back to the office.
2025-01-22 20:46:00.067 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary travelled to the bedroom.
2025-01-22 20:46:00.086 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3910, 3915) --> . Mary travelled to the
2025-01-22 20:46:00.086 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the office.
2025-01-22 20:46:00.105 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3910, 3915) --> . Mary travelled to the
2025-01-22 20:46:00.105 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the hallway.
2025-01-22 20:46:00.140 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6297, 6303) --> . Mary journeyed to the
2025-01-22 20:46:00.140 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the bedroom.
2025-01-22 20:46:00.174 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6222, 6228) --> . John journeyed to the
2025-01-22 20:46:00.175 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the office.
2025-01-22 20:46:00.183 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1718, 1724) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:46:01.025 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's house.<|eot_id|>
2025-01-22 20:46:01.026 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8160])
2025-01-22 20:46:03.234 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [162.8109375, 15.193043305157417, 64.27241847826087, 14.69043449815271, 7.5816650390625], 'topk_indices': array([   1, 7582,  900, 8048, 8144, 8143, 8145, 8058,  257,   24, 8147,
       8151,   14, 8149, 8158, 8155, 8148, 8156, 8150,    0]), 'topk_tokens': ['<|start_header_id|>', ' three', '.', '.\n\n', ' Where', ':', ' was', ' location', 'hue', '\n\n', ' milk', '?', '\n', ' the', '<|end_header_id|>', '<|eot_id|>', ' before', '<|start_header_id|>', ' office', '<|begin_of_text|>'], 'evidence_proportions': [353.875, 116.0625, 120.85, 108.01875]}, 'weight': {'score': [21.509765625, 23.265090959206173, 20.043478260869566, 23.278539678263545, 29.44580078125], 'topk_indices': array([3271, 3298, 3191, 3143, 7443, 7405, 1478, 1416, 4315, 4299, 5177,
       5116, 7126, 7182, 3480, 3454, 4970, 4941, 4918, 4893]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.263671875, 20.270833333333332, 18.346875, 20.75625]}, 'saliency': {'score': [0.9689697265625, 0.08436163701687492, 0.3183315111243207, 0.08152007680808382, 0.056962013244628906], 'topk_indices': array([7626,    8, 7903, 8048,   24, 8014, 3613, 8145, 7582, 8142,  899,
       8151,  896,  897, 8144, 8058, 8147,  257, 8148, 8150]), 'topk_tokens': [' or', ' Date', ' Square', '.\n\n', '\n\n', ' context', ' bathroom', ' was', ' three', 'Question', ' milk', '?', ' Daniel', ' grabbed', ' Where', ' location', ' milk', 'hue', ' before', ' office'], 'evidence_proportions': [2.5706787109375, 0.6318155924479166, 0.52275390625, 0.5384033203125]}}, 'pred_res': "Daniel's house.<|eot_id|>", 'score': 0}
2025-01-22 20:46:03.241 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:46:03.242 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-198_pid-3_1-4-7-9.pkl | len: 3 |  size: 2.02 KB
Processing depth (1, 4, 7, 9):   4%|â–         | 4/100 [01:24<33:24, 20.88s/it]is_0k: False
your chose emoji: ['ğŸ”', 'ğŸ§‘\u200dğŸ¦±', 'ğŸ•µğŸ¾\u200dâ™€ï¸', 'ğŸ¦†', 'ğŸ§‘ğŸ¾\u200dğŸ­', 'ğŸ™…ğŸ»\u200dâ™€', 'ğŸ§’ğŸ»', 'ğŸ¤·ğŸ»\u200dâ™€', 'ğŸ”»', 'ğŸ¤¸\u200dâ™‚ï¸']
is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.66s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:09,  4.67s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.40s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.07s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.61s/it]
Processing depth (0, 2, 5, 8):   4%|â–         | 4/100 [01:40<33:24, 20.88s/it]2025-01-22 20:46:19.526 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel grabbed the milk.
2025-01-22 20:46:19.566 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the bathroom.
2025-01-22 20:46:19.575 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1853, 1859) --> . Daniel journeyed to the
2025-01-22 20:46:19.575 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the office.
2025-01-22 20:46:19.584 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1715, 1720) -->  back to the office.
2025-01-22 20:46:19.584 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary travelled to the bedroom.
2025-01-22 20:46:19.603 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4032, 4037) --> . Mary travelled to the
2025-01-22 20:46:19.603 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the office.
2025-01-22 20:46:19.627 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4032, 4037) --> . Mary travelled to the
2025-01-22 20:46:19.627 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the hallway.
2025-01-22 20:46:19.659 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6309, 6315) --> . Mary journeyed to the
2025-01-22 20:46:19.659 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the bedroom.
2025-01-22 20:46:19.689 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6234, 6240) --> . John journeyed to the
2025-01-22 20:46:19.689 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the office.
2025-01-22 20:46:19.698 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1712, 1718) --> . John went back to the
2025-01-22 20:46:19.698 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 20:46:19.698 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 20:46:19.698 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 20:46:19.698 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['\U0001faf2ğŸ¾', 'ğŸ—', 'ğŸ™ğŸ¼', 'ğŸ¦¹ğŸ»', 'ğŸ‘¶ğŸ¾', 'ğŸ‡¸ğŸ‡¾', 'ğŸ§‘ğŸ¼\u200dâ¤\u200dğŸ’‹\u200dğŸ§‘ğŸ¿', 'ğŸ–¼', 'ğŸ¤µğŸ¾\u200dâ™€ï¸', 'ğŸ¦¸ğŸ»']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.60s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:09<00:08,  4.50s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.29s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.03s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.54s/it]
Processing depth (1, 4, 8, 9):   4%|â–         | 4/100 [01:56<33:24, 20.88s/it]2025-01-22 20:46:35.658 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel grabbed the milk.
2025-01-22 20:46:35.662 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (660, 664) -->  Daniel grabbed the milk
2025-01-22 20:46:35.662 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the bathroom.
2025-01-22 20:46:35.683 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3527, 3533) --> . Daniel journeyed to the
2025-01-22 20:46:35.684 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the office.
2025-01-22 20:46:35.693 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1425, 1430) -->  back to the office.
2025-01-22 20:46:35.694 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary travelled to the bedroom.
2025-01-22 20:46:35.717 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3856, 3861) --> . Mary travelled to the
2025-01-22 20:46:35.717 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the office.
2025-01-22 20:46:35.736 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3856, 3861) --> . Mary travelled to the
2025-01-22 20:46:35.736 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the hallway.
2025-01-22 20:46:35.773 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6231, 6237) --> . Mary journeyed to the
2025-01-22 20:46:35.773 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the bedroom.
2025-01-22 20:46:35.809 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6192, 6198) --> . John journeyed to the
2025-01-22 20:46:35.809 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the office.
2025-01-22 20:46:35.816 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1422, 1428) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 20:46:36.656 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's house.<|eot_id|>
2025-01-22 20:46:36.656 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8176])
2025-01-22 20:46:38.873 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [173.4203125, 16.6355452989363, 49.338315217391305, 16.15768651671583, 15.590291341145834], 'topk_indices': array([8163, 3533,  661,    4, 8073,   24,  664, 8164,  663,    1,    9,
        660, 8064, 8074, 8174,  275,   14,    0, 8172, 8171]), 'topk_tokens': [' milk', ' bathroom', ' grabbed', '\n\n', ' first', '\n\n', '.', ' before', ' milk', '<|start_header_id|>', ':', ' Daniel', '.\n\n', ' location', '<|end_header_id|>', 'hue', '\n', '<|begin_of_text|>', '<|start_header_id|>', '<|eot_id|>'], 'evidence_proportions': [416.75, 184.29166666666666, 83.96875, 55.1625]}, 'weight': {'score': [21.509765625, 23.28098636752659, 20.043478260869566, 23.294492648414455, 29.66189236111111], 'topk_indices': array([3309, 3336, 3229, 3181, 7409, 7447, 1451, 1513, 4327, 4343, 5138,
       5199, 7160, 7104, 3518, 3492, 4992, 4915, 4940, 4963]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.263671875, 20.270833333333332, 18.346875, 20.75625]}, 'saliency': {'score': [1.0974334716796874, 0.09255001256075009, 0.253471042798913, 0.08962488315098405, 0.11652162339952257], 'topk_indices': array([7554, 8158, 8145,   14, 7510, 8030, 8166,    8, 8070, 8169, 8073,
       8064, 8164, 8163,  661,  663, 3533,  660, 8074,  275]), 'topk_tokens': [' Min', 'Question', ' return', '\n', 'nes', ' context', ' office', ' Date', ' item', 'Answer', ' first', '.\n\n', ' before', ' milk', ' grabbed', ' milk', ' bathroom', ' Daniel', ' location', 'hue'], 'evidence_proportions': [3.163818359375, 0.98046875, 0.39345703125, 0.28865966796875]}}, 'pred_res': "Daniel's house.<|eot_id|>", 'score': 0}
2025-01-22 20:46:38.879 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 20:46:38.879 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-198_pid-4_1-4-8-9.pkl | len: 3 |  size: 2.03 KB
Processing depth (1, 4, 8, 9):   5%|â–Œ         | 5/100 [02:00<41:29, 26.20s/it]Processing depth (1, 4, 8, 9):   5%|â–Œ         | 5/100 [02:00<38:05, 24.06s/it]
is_0k: False
your chose emoji: ['ğŸ‡±ğŸ‡°', 'ğŸ‘©ğŸ¿\u200dğŸ¦³', 'â­', 'ğŸ§‘ğŸ»\u200dğŸš€', 'ğŸ§—ğŸ½\u200dâ™‚', 'ğŸŠ\u200dâ™€ï¸', 'ğŸ›', 'ğŸ‘©\u200dâ¤ï¸\u200dğŸ‘¨', 'ğŸŒ¥', 'ğŸ§‘ğŸ¾\u200dğŸ¦½\u200dâ¡']
is_0k: False
is_0k: False
is_0k: False
OVER: 3900 label
