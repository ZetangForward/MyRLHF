nohup: 忽略输入
2025-01-22 03:41:08.226 | INFO     | test_jbb_embedding:<module>:7 - ['/mnt/petrelfs/tangzecheng/MyRLHF/reetrievalheaddetect', '/mnt/petrelfs/tangzecheng/MyRLHF/reetrievalheaddetect/analysis', '/mnt/petrelfs/tangzecheng/anaconda3/envs/zecheng/lib/python310.zip', '/mnt/petrelfs/tangzecheng/anaconda3/envs/zecheng/lib/python3.10', '/mnt/petrelfs/tangzecheng/anaconda3/envs/zecheng/lib/python3.10/lib-dynload', '/mnt/petrelfs/tangzecheng/anaconda3/envs/zecheng/lib/python3.10/site-packages', '/mnt/petrelfs/tangzecheng/DeepSpeed', '/mnt/petrelfs/tangzecheng/modelzipper/src', '/mnt/petrelfs/tangzecheng/anaconda3/envs/zecheng/lib/python3.10/site-packages/setuptools/_vendor']
2025-01-22 03:41:10.356 | INFO     | __main__:<module>:11 - ['/mnt/petrelfs/tangzecheng/MyRLHF/reetrievalheaddetect', '/mnt/petrelfs/tangzecheng/MyRLHF/reetrievalheaddetect/faiss_attn', '/mnt/petrelfs/tangzecheng/MyRLHF/reetrievalheaddetect', '/mnt/petrelfs/tangzecheng/MyRLHF/reetrievalheaddetect/analysis', '/mnt/petrelfs/tangzecheng/anaconda3/envs/zecheng/lib/python310.zip', '/mnt/petrelfs/tangzecheng/anaconda3/envs/zecheng/lib/python3.10', '/mnt/petrelfs/tangzecheng/anaconda3/envs/zecheng/lib/python3.10/lib-dynload', '/mnt/petrelfs/tangzecheng/anaconda3/envs/zecheng/lib/python3.10/site-packages', '/mnt/petrelfs/tangzecheng/DeepSpeed', '/mnt/petrelfs/tangzecheng/modelzipper/src', '/mnt/petrelfs/tangzecheng/anaconda3/envs/zecheng/lib/python3.10/site-packages/setuptools/_vendor']
2025-01-22 03:41:11.140 | INFO     | __main__:<module>:82 - Selected idx: 0
2025-01-22 03:41:11.141 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the football before the bathroom? 
2025-01-22 03:41:11.141 | INFO     | __main__:<module>:84 - Answer: office
2025-01-22 03:41:11.141 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 03:41:11.141 | INFO     | __main__:<module>:86 - Needle: [' John went back to the bedroom.', ' John took the milk.', ' Mary journeyed to the office.', ' Sandra journeyed to the bedroom.', ' John journeyed to the office.', ' Mary journeyed to the bathroom.', ' Mary dropped the football.', ' Daniel went back to the kitchen.']
2025-01-22 03:41:11.141 | INFO     | __main__:<module>:87 - Real Needle: [' Mary journeyed to the office.', ' Mary journeyed to the bathroom.', ' Mary dropped the football.', ' Daniel went back to the kitchen.']
2025-01-22 03:41:11.141 | INFO     | __main__:<module>:88 - =============================================
ModelZipper is ready for launch🚀 | Current Version🦄 >>> 0.2.7 <<< | AOE Time🕒 2025-01-22 07:41:03
Process: 61000
begin to read data from ./haystack_for_detect/reasoning_needle_jbb_200.jsonl | file size: 247.16 KB | file type: jsonl
begin to testing with [3900]
  0%|          | 0/100 [00:00<?, ?it/s]You are attempting to use Flash Attention 2.0 without specifying a torch dtype. This might lead to unexpected behaviour

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:10,  3.62s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:07<00:07,  3.94s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:11<00:03,  3.97s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  2.80s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  3.20s/it]
Processing depth (0, 1, 4, 9):   0%|          | 0/100 [00:17<?, ?it/s]2025-01-22 03:41:28.504 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the office.
2025-01-22 03:41:28.505 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 37) -->  journeyed to the office.
2025-01-22 03:41:28.505 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the bathroom.
2025-01-22 03:41:28.509 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (843, 849) --> . Mary journeyed to the
2025-01-22 03:41:28.509 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary dropped the football.
2025-01-22 03:41:28.527 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3645, 3649) -->  Mary dropped the football
2025-01-22 03:41:28.527 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went back to the kitchen.
2025-01-22 03:41:28.565 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7224, 7230) --> . Daniel went back to the
2025-01-22 03:41:28.565 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the bedroom.
2025-01-22 03:41:28.566 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (258, 264) --> . John went back to the
2025-01-22 03:41:28.567 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John took the milk.
2025-01-22 03:41:28.574 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1425, 1429) -->  John took the milk
2025-01-22 03:41:28.574 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra journeyed to the bedroom.
2025-01-22 03:41:28.603 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5621, 5627) --> . Sandra journeyed to the
2025-01-22 03:41:28.603 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the office.
2025-01-22 03:41:28.603 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (31, 37) -->  journeyed to the office.
/mnt/petrelfs/tangzecheng/anaconda3/envs/zecheng/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:590: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/mnt/petrelfs/tangzecheng/anaconda3/envs/zecheng/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:595: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
The attention mask is not set and cannot be inferred from input because pad token is same as eos token. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
2025-01-22 03:41:31.539 | INFO     | test_jbb_embedding:begin_test:693 - Mary's bedroom.<|eot_id|>
2025-01-22 03:41:31.539 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8177])
2025-01-22 03:41:33.904 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [368.6115056818182, 34.885109732241105, 288.69034090909093, 33.296210433312844, 24.35671657986111], 'topk_indices': array([3649, 8162,    1, 8075,  849, 2554,  850,   24, 8158, 8160, 8159,
       3648,   14, 8168, 8164, 8165, 8167, 8175, 8172,    0]), 'topk_tokens': ['.', ' was', '<|start_header_id|>', ' location', ' bathroom', ' John', '.', '\n\n', '.\n\n', ':', 'Question', ' football', '\n', '?', ' football', ' before', ' bathroom', '<|end_header_id|>', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [555.125, 392.1666666666667, 555.75, 33.783854166666664]}, 'weight': {'score': [21.417258522727273, 23.28193773688715, 21.17294034090909, 23.292684004302398, 29.709635416666668], 'topk_indices': array([3304, 3331, 3224, 3176, 7454, 7416, 1513, 1451, 4342, 4358, 5153,
       5214, 7118, 7174, 3511, 3537, 4955, 4930, 4978, 5007]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.541666666666668, 20.052083333333332, 27.013671875, 20.927083333333332]}, 'saliency': {'score': [2.0652715509588067, 0.19569741176908853, 1.57208251953125, 0.18691915689103794, 0.1789616478814019], 'topk_indices': array([  24, 7746,   35, 8161, 2559,  264,   30, 8158, 8168, 2555, 7747,
         31, 8075, 2554, 8159,  849, 3648, 8165, 8164, 8167]), 'topk_tokens': ['\n\n', ' genu', ' office', ' Where', ' office', ' bedroom', 'Mary', '.\n\n', '?', ' journey', 'inen', ' journey', ' location', ' John', 'Question', ' bathroom', ' football', ' before', ' football', ' bathroom'], 'evidence_proportions': [2.9083658854166665, 1.896240234375, 3.880859375, 0.180816650390625]}}, 'pred_res': "Mary's bedroom.<|eot_id|>", 'score': 0}
2025-01-22 03:41:33.908 | INFO     | modelzipper.tutils:auto_save_data:296 - /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label not exist! --> Create data dir /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label
2025-01-22 03:41:33.912 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 03:41:33.912 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-0_pid-0_0-1-4-9.pkl | len: 3 |  size: 2.03 KB
Processing depth (0, 1, 4, 9):   1%|          | 1/100 [00:22<37:16, 22.59s/it]is_0k: False
your chose emoji: ['🏋\u200d♀️', '🧛🏿\u200d♂️', '\U0001f979', '🧖🏻', '👨\u200d❤\u200d💋\u200d👨', '🧑🏻\u200d🔬', '👩\u200d💻', '☄️', '🤛🏾', '👨🏿\u200d🔬']
emoji:
O: 🏋‍♀️ [9468, 237, 233, 102470, 32990, 31643]
N: 🧛🏿‍♂️ [9468, 100, 249, 9468, 237, 123, 102470, 17245, 224, 31643]

O: 🧛🏿‍♂️ [9468, 100, 249, 9468, 237, 123, 102470, 17245, 224, 31643]
N: 🥹 [9468, 98, 117]

O: 🥹 [9468, 98, 117]
N: 🧑🏻‍🔬 [9468, 100, 239, 9468, 237, 119, 102470, 9468, 242, 105]

O: 🧖🏻 [9468, 100, 244, 9468, 237, 119]
N: 👨‍❤‍💋‍👨 [9468, 239, 101, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101]

O: 👨‍❤‍💋‍👨 [9468, 239, 101, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101]
N: 🏋‍♀️ [9468, 237, 233, 102470, 32990, 31643]

O: 🧑🏻‍🔬 [9468, 100, 239, 9468, 237, 119, 102470, 9468, 242, 105]
N: 👩‍💻 [9468, 239, 102, 102470, 93273, 119]

O: 👩‍💻 [9468, 239, 102, 102470, 93273, 119]
N: ☄️ [18107, 226, 31643]

O: ☄️ [18107, 226, 31643]
N: 🧖🏻 [9468, 100, 244, 9468, 237, 119]

O: 🤛🏾 [9468, 97, 249, 9468, 237, 122]
N: 🤛🏾 [9468, 97, 249, 9468, 237, 122]

O: 👨🏿‍🔬 [9468, 239, 101, 9468, 237, 123, 102470, 9468, 242, 105]
N: 👨🏿‍🔬 [9468, 239, 101, 9468, 237, 123, 102470, 9468, 242, 105]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:11,  3.93s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.29s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.18s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.93s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.38s/it]
Processing depth (1, 4, 7, 8):   1%|          | 1/100 [00:37<37:16, 22.59s/it]2025-01-22 03:41:49.113 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the office.
2025-01-22 03:41:49.118 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (902, 908) --> . Mary journeyed to the
2025-01-22 03:41:49.118 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the bathroom.
2025-01-22 03:41:49.122 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (902, 908) --> . Mary journeyed to the
2025-01-22 03:41:49.122 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary dropped the football.
2025-01-22 03:41:49.150 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5635, 5639) -->  Mary dropped the football
2025-01-22 03:41:49.150 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went back to the kitchen.
2025-01-22 03:41:49.182 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6552, 6558) --> . Daniel went back to the
2025-01-22 03:41:49.182 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the bedroom.
2025-01-22 03:41:49.184 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (251, 257) --> . John went back to the
2025-01-22 03:41:49.184 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John took the milk.
2025-01-22 03:41:49.191 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1529, 1533) -->  took the milk.
2025-01-22 03:41:49.191 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra journeyed to the bedroom.
2025-01-22 03:41:49.219 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5638, 5644) -->  football. Sandra journeyed to
2025-01-22 03:41:49.219 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the office.
2025-01-22 03:41:49.224 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (903, 909) -->  Mary journeyed to the office
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 03:41:50.004 | INFO     | test_jbb_embedding:begin_test:693 - the bedroom<|eot_id|>
2025-01-22 03:41:50.004 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8187])
2025-01-22 03:41:52.220 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [548.3693181818181, 47.98057607766516, 721.3238636363636, 44.81027470841007, 32.75892857142857], 'topk_indices': array([3642, 8178, 8085, 8075, 8185,  257,   14, 8183, 5640, 3641, 8177,
        258, 5641, 8174, 5645, 5638, 8175, 8182, 5639,    0]), 'topk_tokens': ['.', '?', ' location', '.\n\n', '<|end_header_id|>', ' bedroom', '\n', '<|start_header_id|>', ' Sandra', ' bathroom', ' bathroom', '.', ' journey', ' football', ' bedroom', ' football', ' before', '<|eot_id|>', '.', '<|begin_of_text|>'], 'evidence_proportions': [575.75, 575.75, 988.75, 200.02083333333334]}, 'weight': {'score': [21.556463068181817, 23.282356667480766, 22.365767045454547, 23.289494129834253, 29.320413961038962], 'topk_indices': array([3297, 3324, 3217, 3169, 7422, 7460, 1475, 1413, 4341, 4325, 5227,
       5166, 7143, 7199, 3506, 3480, 4925, 4973, 5002, 4950]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.052083333333332, 20.052083333333332, 27.013671875, 20.927083333333332]}, 'saliency': {'score': [3.2689208984375, 0.2705912895729027, 4.223876953125, 0.2518146737358042, 0.23688853870738635], 'topk_indices': array([8172, 8075, 1162,  904, 8171,  264,    0, 5635, 8169, 5636, 8085,
        257, 8175, 5641, 5640, 8174, 5638, 3641, 8177, 5645]), 'topk_tokens': [' was', '.\n\n', 'nes', ' journey', ' Where', 'hue', '<|begin_of_text|>', ' Mary', 'Question', ' dropped', ' location', ' bedroom', ' before', ' journey', ' Sandra', ' football', ' football', ' bathroom', ' bathroom', ' bedroom'], 'evidence_proportions': [3.1280924479166665, 3.1280924479166665, 6.95703125, 1.0918375651041667]}}, 'pred_res': 'the bedroom<|eot_id|>', 'score': 0}
2025-01-22 03:41:52.228 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 03:41:52.229 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-0_pid-1_1-4-7-8.pkl | len: 3 |  size: 2.06 KB
Processing depth (1, 4, 7, 8):   2%|▏         | 2/100 [00:40<32:47, 20.08s/it]is_0k: False
your chose emoji: ['💅🏻', '👭🏿', '🛢️', '🦹🏻\u200d♀️', '🧑🏽\u200d❤️\u200d🧑🏻', '🇱🇸', '\U0001faf1🏼\u200d\U0001faf2🏽', '👫🏻', '🤌🏾', '\U0001faf3🏾']
emoji:
O: 💅🏻 [93273, 227, 9468, 237, 119]
N: 🇱🇸 [9468, 229, 109, 9468, 229, 116]

O: 👭🏿 [9468, 239, 255, 9468, 237, 123]
N: 🛢️ [9468, 249, 95, 31643]

O: 🛢️ [9468, 249, 95, 31643]
N: 🫱🏼‍🫲🏽 [9468, 104, 109, 9468, 237, 120, 102470, 9468, 104, 110, 9468, 237, 121]

O: 🦹🏻‍♀️ [9468, 99, 117, 9468, 237, 119, 102470, 32990, 31643]
N: 💅🏻 [93273, 227, 9468, 237, 119]

O: 🧑🏽‍❤️‍🧑🏻 [9468, 100, 239, 9468, 237, 121, 102470, 121643, 31643, 102470, 9468, 100, 239, 9468, 237, 119]
N: 🧑🏽‍❤️‍🧑🏻 [9468, 100, 239, 9468, 237, 121, 102470, 121643, 31643, 102470, 9468, 100, 239, 9468, 237, 119]

O: 🇱🇸 [9468, 229, 109, 9468, 229, 116]
N: 🤌🏾 [9468, 97, 234, 9468, 237, 122]

O: 🫱🏼‍🫲🏽 [9468, 104, 109, 9468, 237, 120, 102470, 9468, 104, 110, 9468, 237, 121]
N: 🦹🏻‍♀️ [9468, 99, 117, 9468, 237, 119, 102470, 32990, 31643]

O: 👫🏻 [9468, 239, 104, 9468, 237, 119]
N: 👭🏿 [9468, 239, 255, 9468, 237, 123]

O: 🤌🏾 [9468, 97, 234, 9468, 237, 122]
N: 👫🏻 [9468, 239, 104, 9468, 237, 119]

O: 🫳🏾 [9468, 104, 111, 9468, 237, 122]
N: 🫳🏾 [9468, 104, 111, 9468, 237, 122]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:11,  3.85s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.09s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:11<00:03,  3.94s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  2.82s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  3.24s/it]
Processing depth (0, 4, 5, 9):   2%|▏         | 2/100 [00:55<32:47, 20.08s/it]2025-01-22 03:42:06.891 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the office.
2025-01-22 03:42:06.891 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 37) -->  journeyed to the office.
2025-01-22 03:42:06.891 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the bathroom.
2025-01-22 03:42:06.910 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3649, 3655) --> . Mary journeyed to the
2025-01-22 03:42:06.910 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary dropped the football.
2025-01-22 03:42:06.930 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4240, 4244) -->  dropped the football.
2025-01-22 03:42:06.930 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went back to the kitchen.
2025-01-22 03:42:06.967 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7302, 7308) --> . Daniel went back to the
2025-01-22 03:42:06.967 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the bedroom.
2025-01-22 03:42:06.969 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (258, 264) --> . John went back to the
2025-01-22 03:42:06.969 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John took the milk.
2025-01-22 03:42:06.976 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1558, 1562) -->  John took the milk
2025-01-22 03:42:06.976 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra journeyed to the bedroom.
2025-01-22 03:42:07.005 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5717, 5723) --> . Sandra journeyed to the
2025-01-22 03:42:07.005 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the office.
2025-01-22 03:42:07.005 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (31, 37) -->  journeyed to the office.
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 03:42:07.826 | INFO     | test_jbb_embedding:begin_test:693 - Mary's bedroom.<|eot_id|>
2025-01-22 03:42:07.826 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8273])
2025-01-22 03:42:10.083 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [676.3167613636364, 54.282877643504534, 455.14204545454544, 51.54886632851415, 22.243001302083332], 'topk_indices': array([  31, 8264, 3656, 3653, 8171,   24, 4242,   14,  432, 3654,  549,
       8260, 8261, 8271, 8127,  433, 8263, 8268, 8269,    0]), 'topk_tokens': [' journey', '?', '.', ' to', ' location', '\n\n', ' football', '\n', ' to', ' the', ' to', ' football', ' before', '<|end_header_id|>', ' context', ' ', ' bathroom', '<|eot_id|>', '<|start_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [909.25, 956.4166666666666, 836.625, 56.411458333333336]}, 'weight': {'score': [20.365767045454547, 23.35925981873112, 21.17294034090909, 23.373104536204593, 29.804557291666665], 'topk_indices': array([3275, 3302, 3195, 3147, 7520, 7558, 1475, 1413, 4290, 4306, 5262,
       5201, 7252, 7196, 3458, 3484, 4952, 5000, 5029, 4977]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.541666666666668, 20.052083333333332, 21.23046875, 20.927083333333332]}, 'saliency': {'score': [3.5418201793323862, 0.3017239425981873, 2.4965154474431817, 0.28719745367645944, 0.1632653554280599], 'topk_indices': array([8264, 2340, 8257,   24, 1927,   30, 8125, 2708, 3651,   35, 2354,
       8255, 8171,   31, 3655, 4242, 8261, 8127, 8260, 8263]), 'topk_tokens': ['?', 'nes', ' Where', '\n\n', ' news', 'Mary', ' provided', ' office', ' journey', ' office', 'nes', 'Question', ' location', ' journey', ' bathroom', ' football', ' before', ' context', ' football', ' bathroom'], 'evidence_proportions': [4.795247395833333, 4.694498697916667, 4.791748046875, 0.30242919921875]}}, 'pred_res': "Mary's bedroom.<|eot_id|>", 'score': 0}
2025-01-22 03:42:10.090 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 03:42:10.091 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-0_pid-2_0-4-5-9.pkl | len: 3 |  size: 2.04 KB
Processing depth (0, 4, 5, 9):   3%|▎         | 3/100 [00:58<30:49, 19.07s/it]is_0k: False
your chose emoji: ['👩🏾\u200d❤️\u200d💋\u200d👨🏿', '🇿🇲', '👩🏻\u200d❤️\u200d💋\u200d👩🏾', '👩\u200d🦼\u200d➡️', '👩🏻\u200d❤\u200d💋\u200d👩🏼', '🧎🏼\u200d♀\u200d➡️', '🧝🏾', '👨🏽\u200d🦯\u200d➡', '🧑🏾\u200d🦼', '\U0001faf7🏿']
emoji:
O: 👩🏾‍❤️‍💋‍👨🏿 [9468, 239, 102, 9468, 237, 122, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 123]
N: 🧎🏼‍♀‍➡️ [9468, 100, 236, 9468, 237, 120, 102470, 32990, 102470, 98115, 94, 31643]

O: 🇿🇲 [9468, 229, 123, 9468, 229, 110]
N: 🇿🇲 [9468, 229, 123, 9468, 229, 110]

O: 👩🏻‍❤️‍💋‍👩🏾 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 122]
N: 🧝🏾 [9468, 100, 251, 9468, 237, 122]

O: 👩‍🦼‍➡️ [9468, 239, 102, 102470, 9468, 99, 120, 102470, 98115, 94, 31643]
N: 👩🏻‍❤️‍💋‍👩🏾 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 122]

O: 👩🏻‍❤‍💋‍👩🏼 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 120]
N: 👩🏻‍❤‍💋‍👩🏼 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 120]

O: 🧎🏼‍♀‍➡️ [9468, 100, 236, 9468, 237, 120, 102470, 32990, 102470, 98115, 94, 31643]
N: 👨🏽‍🦯‍➡ [9468, 239, 101, 9468, 237, 121, 102470, 9468, 99, 107, 102470, 98115, 94]

O: 🧝🏾 [9468, 100, 251, 9468, 237, 122]
N: 👩‍🦼‍➡️ [9468, 239, 102, 102470, 9468, 99, 120, 102470, 98115, 94, 31643]

O: 👨🏽‍🦯‍➡ [9468, 239, 101, 9468, 237, 121, 102470, 9468, 99, 107, 102470, 98115, 94]
N: 🧑🏾‍🦼 [9468, 100, 239, 9468, 237, 122, 102470, 9468, 99, 120]

O: 🧑🏾‍🦼 [9468, 100, 239, 9468, 237, 122, 102470, 9468, 99, 120]
N: 👩🏾‍❤️‍💋‍👨🏿 [9468, 239, 102, 9468, 237, 122, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 123]

O: 🫷🏿 [9468, 104, 115, 9468, 237, 123]
N: 🫷🏿 [9468, 104, 115, 9468, 237, 123]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:11,  3.72s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:07<00:07,  3.96s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:11<00:03,  3.73s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:11<00:00,  2.42s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:11<00:00,  2.93s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (2, 4, 6, 9):   3%|▎         | 3/100 [01:12<30:49, 19.07s/it]2025-01-22 03:42:23.584 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the office.
2025-01-22 03:42:23.598 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1751, 1757) --> . Mary journeyed to the
2025-01-22 03:42:23.599 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the bathroom.
2025-01-22 03:42:23.609 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1751, 1757) --> . Mary journeyed to the
2025-01-22 03:42:23.609 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary dropped the football.
2025-01-22 03:42:23.635 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4626, 4630) -->  dropped the football.
2025-01-22 03:42:23.635 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went back to the kitchen.
2025-01-22 03:42:23.670 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7141, 7147) -->  Daniel went back to the kitchen
2025-01-22 03:42:23.670 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the bedroom.
2025-01-22 03:42:23.671 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (251, 257) --> . John went back to the
2025-01-22 03:42:23.672 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John took the milk.
2025-01-22 03:42:23.678 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1305, 1309) -->  John took the milk
2025-01-22 03:42:23.678 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra journeyed to the bedroom.
2025-01-22 03:42:23.706 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5489, 5495) --> . Sandra journeyed to the
2025-01-22 03:42:23.706 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the office.
2025-01-22 03:42:23.717 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1752, 1758) -->  Mary journeyed to the office
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 03:42:27.183 | INFO     | test_jbb_embedding:begin_test:693 - Mary's house.<|eot_id|>
2025-01-22 03:42:27.183 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8197])
2025-01-22 03:42:29.916 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [352.8863636363636, 35.84719173069887, 240.9431818181818, 34.43861128142244, 41.422923018292686], 'topk_indices': array([8196, 8188, 8085, 8050, 8095,    9,   23,    1, 8180, 8185, 8187,
       8184,   24, 8051, 4628,   14, 8195, 8193,    0, 8192]), 'topk_tokens': ['\n\n', '?', '.\n\n', ' you', ' location', ':', '4', '<|start_header_id|>', ':', ' before', ' bathroom', ' football', '\n\n', ' context', ' football', '\n', '<|end_header_id|>', '<|start_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [398.375, 398.375, 607.6875, 92.04166666666667]}, 'weight': {'score': [21.593394886363637, 23.30413007683864, 22.224431818181817, 23.311657916922133, 30.04077743902439], 'topk_indices': array([3339, 3366, 3259, 3211, 7470, 7432, 1449, 1511, 4375, 4359, 5193,
       5254, 7209, 7153, 3548, 3522, 5047, 4970, 5018, 4995]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.052083333333332, 20.052083333333332, 21.23046875, 24.91796875]}, 'saliency': {'score': [2.008700284090909, 0.2007919666984922, 1.4660866477272727, 0.19250129030790158, 0.31647286764005333], 'topk_indices': array([8188,   14, 8050,   23, 5495, 5490, 8049, 8166,    0, 3563, 8181,
         24, 8095, 1753, 8179, 8185, 8051, 8184, 8187, 4628]), 'topk_tokens': ['?', '\n', ' you', '4', ' bedroom', ' Sandra', ' provided', ' return', '<|begin_of_text|>', ' bathroom', ' Where', '\n\n', ' location', ' journey', 'Question', ' before', ' context', ' football', ' bathroom', ' football'], 'evidence_proportions': [2.1815592447916665, 2.1815592447916665, 3.64990234375, 0.56884765625]}}, 'pred_res': "Mary's house.<|eot_id|>", 'score': 0}
2025-01-22 03:42:29.922 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 03:42:29.922 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-0_pid-3_2-4-6-9.pkl | len: 3 |  size: 2.04 KB
Processing depth (2, 4, 6, 9):   4%|▍         | 4/100 [01:18<30:59, 19.37s/it]is_0k: False
your chose emoji: ['👷🏻\u200d♀️', '👷🏻\u200d♀', '🧚🏾\u200d♀️', '🧗\u200d♀️', '🧎🏻\u200d➡', '👏🏻', '🧏🏿\u200d♂️', '🌺', '🧑🏾\u200d⚕', '🧎🏻\u200d♀\u200d➡️']
emoji:
O: 👷🏻‍♀️ [9468, 239, 115, 9468, 237, 119, 102470, 32990, 31643]
N: 🧏🏿‍♂️ [9468, 100, 237, 9468, 237, 123, 102470, 17245, 224, 31643]

O: 👷🏻‍♀ [9468, 239, 115, 9468, 237, 119, 102470, 32990]
N: 🌺 [9468, 234, 118]

O: 🧚🏾‍♀️ [9468, 100, 248, 9468, 237, 122, 102470, 32990, 31643]
N: 🧗‍♀️ [9468, 100, 245, 102470, 32990, 31643]

O: 🧗‍♀️ [9468, 100, 245, 102470, 32990, 31643]
N: 👏🏻 [9468, 239, 237, 9468, 237, 119]

O: 🧎🏻‍➡ [9468, 100, 236, 9468, 237, 119, 102470, 98115, 94]
N: 🧚🏾‍♀️ [9468, 100, 248, 9468, 237, 122, 102470, 32990, 31643]

O: 👏🏻 [9468, 239, 237, 9468, 237, 119]
N: 🧑🏾‍⚕ [9468, 100, 239, 9468, 237, 122, 102470, 158, 248, 243]

O: 🧏🏿‍♂️ [9468, 100, 237, 9468, 237, 123, 102470, 17245, 224, 31643]
N: 👷🏻‍♀ [9468, 239, 115, 9468, 237, 119, 102470, 32990]

O: 🌺 [9468, 234, 118]
N: 🧎🏻‍➡ [9468, 100, 236, 9468, 237, 119, 102470, 98115, 94]

O: 🧑🏾‍⚕ [9468, 100, 239, 9468, 237, 122, 102470, 158, 248, 243]
N: 👷🏻‍♀️ [9468, 239, 115, 9468, 237, 119, 102470, 32990, 31643]

O: 🧎🏻‍♀‍➡️ [9468, 100, 236, 9468, 237, 119, 102470, 32990, 102470, 98115, 94, 31643]
N: 🧎🏻‍♀‍➡️ [9468, 100, 236, 9468, 237, 119, 102470, 32990, 102470, 98115, 94, 31643]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:11,  3.91s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.09s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:11<00:03,  3.79s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  2.64s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  3.11s/it]
Processing depth (0, 2, 6, 9):   4%|▍         | 4/100 [01:32<30:59, 19.37s/it]2025-01-22 03:42:44.019 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the office.
2025-01-22 03:42:44.019 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 37) -->  journeyed to the office.
2025-01-22 03:42:44.020 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the bathroom.
2025-01-22 03:42:44.029 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1596, 1602) --> . Mary journeyed to the
2025-01-22 03:42:44.029 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary dropped the football.
2025-01-22 03:42:44.057 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4783, 4787) -->  Mary dropped the football
2025-01-22 03:42:44.058 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went back to the kitchen.
2025-01-22 03:42:44.102 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7273, 7279) -->  cold. Daniel went back to
2025-01-22 03:42:44.102 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the bedroom.
2025-01-22 03:42:44.104 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (256, 262) --> . John went back to the
2025-01-22 03:42:44.104 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John took the milk.
2025-01-22 03:42:44.112 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1310, 1314) -->  John took the milk
2025-01-22 03:42:44.112 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra journeyed to the bedroom.
2025-01-22 03:42:44.147 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5657, 5663) --> . Sandra journeyed to the
2025-01-22 03:42:44.147 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the office.
2025-01-22 03:42:44.147 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (31, 37) -->  journeyed to the office.
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 03:42:44.896 | INFO     | test_jbb_embedding:begin_test:693 - bedroom<|eot_id|>
2025-01-22 03:42:44.897 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8171])
2025-01-22 03:42:47.119 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [450.6917613636364, 49.70556252294139, 537.3238636363636, 47.30067889654324, 48.12839673913044], 'topk_indices': array([  31, 8153, 1762, 8154, 1683, 8169,   24, 1602, 8162, 8152,   14,
       5658, 5663, 8158, 4786, 1684, 8159, 8166, 8161,    0]), 'topk_tokens': [' journey', 'Question', ' some', ':', ' some', '<|end_header_id|>', '\n\n', ' bathroom', '?', '.\n\n', '\n', ' Sandra', ' bedroom', ' football', ' football', ' time', ' before', '<|eot_id|>', ' bathroom', '<|begin_of_text|>'], 'evidence_proportions': [630.125, 484.7083333333333, 739.375, 44.786458333333336]}, 'weight': {'score': [22.33096590909091, 23.269152239079897, 21.17294034090909, 23.277364412904415, 29.231884057971016], 'topk_indices': array([3361, 3334, 3206, 3254, 7434, 7396, 1494, 1556, 4329, 4313, 5141,
       5202, 7166, 7110, 3517, 3543, 4943, 4995, 4918, 4966]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.541666666666668, 20.052083333333332, 27.013671875, 24.27734375]}, 'saliency': {'score': [2.58544921875, 0.2816402127718555, 3.1061234907670454, 0.2677612079437815, 0.35157665307971014], 'topk_indices': array([ 586, 8155, 8025, 8162,  258, 8152,  257, 1762, 1683,   31, 8153,
       1684,  262, 8159, 1602, 8158, 5663, 4786, 5658, 8161]), 'topk_tokens': [' per', ' Where', ' context', '?', ' went', '.\n\n', ' John', ' some', ' some', ' journey', 'Question', ' time', ' bedroom', ' before', ' bathroom', ' football', ' bedroom', ' football', ' Sandra', ' bathroom'], 'evidence_proportions': [3.3181966145833335, 2.4736328125, 5.134765625, 0.2649739583333333]}}, 'pred_res': 'bedroom<|eot_id|>', 'score': 0}
2025-01-22 03:42:47.127 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 03:42:47.127 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-0_pid-4_0-2-6-9.pkl | len: 3 |  size: 2.03 KB
Processing depth (0, 2, 6, 9):   5%|▌         | 5/100 [01:35<29:25, 18.59s/it]Processing depth (0, 2, 6, 9):   5%|▌         | 5/100 [01:35<30:21, 19.17s/it]
2025-01-22 03:42:47.181 | INFO     | __main__:<module>:82 - Selected idx: 1
2025-01-22 03:42:47.181 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the location prior to the place where the apple was discarded, left or dropped?
2025-01-22 03:42:47.181 | INFO     | __main__:<module>:84 - Answer: office
2025-01-22 03:42:47.181 | INFO     | __main__:<module>:85 - Tag: 4-hop
2025-01-22 03:42:47.181 | INFO     | __main__:<module>:86 - Needle: [' Mary journeyed to the office.', ' John went back to the bedroom.', ' John journeyed to the office.', ' Mary got the apple.', ' John took the milk.', ' Mary journeyed to the bathroom.', ' Sandra journeyed to the bedroom.', ' Mary dropped the apple.', ' Daniel went back to the kitchen.']
2025-01-22 03:42:47.181 | INFO     | __main__:<module>:87 - Real Needle: [' Mary journeyed to the office.', ' Mary got the apple.', ' Mary journeyed to the bathroom.', ' Mary dropped the apple.', ' Daniel went back to the kitchen.']
2025-01-22 03:42:47.181 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['👳🏾\u200d♀️', '🥔', '🧘🏻', '👨🏿\u200d🦽', '💱', '🧚🏽\u200d♂', '🧚🏿\u200d♂️', '🧚🏿', '🤦🏿\u200d♀', '🙇🏿']
emoji:
O: 👳🏾‍♀️ [9468, 239, 111, 9468, 237, 122, 102470, 32990, 31643]
N: 🧚🏽‍♂ [9468, 100, 248, 9468, 237, 121, 102470, 17245, 224]

O: 🥔 [9468, 98, 242]
N: 🧘🏻 [9468, 100, 246, 9468, 237, 119]

O: 🧘🏻 [9468, 100, 246, 9468, 237, 119]
N: 🥔 [9468, 98, 242]

O: 👨🏿‍🦽 [9468, 239, 101, 9468, 237, 123, 102470, 9468, 99, 121]
N: 👨🏿‍🦽 [9468, 239, 101, 9468, 237, 123, 102470, 9468, 99, 121]

O: 💱 [93273, 109]
N: 🧚🏿‍♂️ [9468, 100, 248, 9468, 237, 123, 102470, 17245, 224, 31643]

O: 🧚🏽‍♂ [9468, 100, 248, 9468, 237, 121, 102470, 17245, 224]
N: 🧚🏿 [9468, 100, 248, 9468, 237, 123]

O: 🧚🏿‍♂️ [9468, 100, 248, 9468, 237, 123, 102470, 17245, 224, 31643]
N: 🤦🏿‍♀ [9468, 97, 99, 9468, 237, 123, 102470, 32990]

O: 🧚🏿 [9468, 100, 248, 9468, 237, 123]
N: 👳🏾‍♀️ [9468, 239, 111, 9468, 237, 122, 102470, 32990, 31643]

O: 🤦🏿‍♀ [9468, 97, 99, 9468, 237, 123, 102470, 32990]
N: 💱 [93273, 109]

O: 🙇🏿 [9468, 247, 229, 9468, 237, 123]
N: 🙇🏿 [9468, 247, 229, 9468, 237, 123]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.08s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.08s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.02s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.79s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.25s/it]
Processing depth (0, 1, 2, 4, 7):   0%|          | 0/100 [00:14<?, ?it/s]2025-01-22 03:43:02.293 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the office.
2025-01-22 03:43:02.293 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 37) -->  journeyed to the office.
2025-01-22 03:43:02.293 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary got the apple.
2025-01-22 03:43:02.297 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (812, 816) -->  Mary got the apple
2025-01-22 03:43:02.297 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bathroom.
2025-01-22 03:43:02.307 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1828, 1834) --> . Mary journeyed to the
2025-01-22 03:43:02.307 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary dropped the apple.
2025-01-22 03:43:02.326 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3665, 3669) -->  Mary dropped the apple
2025-01-22 03:43:02.327 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel went back to the kitchen.
2025-01-22 03:43:02.355 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5596, 5602) --> . Daniel went back to the
2025-01-22 03:43:02.355 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the bedroom.
2025-01-22 03:43:02.371 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2929, 2935) --> . John went back to the
2025-01-22 03:43:02.371 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the office.
2025-01-22 03:43:02.371 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (31, 37) -->  journeyed to the office.
2025-01-22 03:43:02.371 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John took the milk.
2025-01-22 03:43:02.409 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6846, 6850) -->  John took the milk
2025-01-22 03:43:02.409 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra journeyed to the bedroom.
2025-01-22 03:43:02.409 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (133, 139) -->  Sandra journeyed to the bedroom
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 03:43:03.278 | INFO     | test_jbb_embedding:begin_test:693 - Mary got the apple.<|eot_id|>
2025-01-22 03:43:03.279 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8217])
2025-01-22 03:43:05.518 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [488.5793269230769, 45.31901310986738, 520.4275568181819, 42.62935993146494, 65.84958639705883], 'topk_indices': array([8106,  384,   32, 8197,   29,  381,  413,  410,  106,   14,   35,
         31,   68,   69,   24,  382,  385, 8212, 8213,    0]), 'topk_tokens': [' location', ' past', 'ed', ' to', '\n\n', ' half', ' past', ' half', 'ION', '\n', ' office', ' journey', 'ION', 'E', '\n\n', ' of', ' century', '<|eot_id|>', '<|start_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [1003.0833333333334, 579.8125, 383.5416666666667, 433.78125, 54.822916666666664]}, 'weight': {'score': [22.13701923076923, 23.298182945005475, 22.40625, 23.304279234487822, 29.61875], 'topk_indices': array([3326, 3353, 3246, 3198, 7473, 7435, 1464, 1526, 4332, 4348, 5178,
       5239, 7156, 7212, 3535, 3509, 4974, 5032, 5003, 4949]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.541666666666668, 26.353515625, 20.052083333333332, 26.755859375, 20.927083333333332]}, 'saliency': {'score': [2.7942833533653846, 0.25625791919827534, 3.008841774680398, 0.24077076877495487, 0.48423695283777574], 'topk_indices': array([8190, 8062,  113,  106,   69, 8106,   39,    0, 8196,  384, 1834,
         68,  413,  138,   35,  410,  381, 8204,   31,  385]), 'topk_tokens': ['Question', ' context', '�', 'ION', 'E', ' location', '***', '<|begin_of_text|>', ' prior', ' past', ' bathroom', 'ION', ' past', ' bedroom', ' office', ' half', ' half', ' discarded', ' journey', ' century'], 'evidence_proportions': [5.274739583333333, 3.8681640625, 2.0123697916666665, 2.88818359375, 0.3172200520833333]}}, 'pred_res': 'Mary got the apple.<|eot_id|>', 'score': 0}
2025-01-22 03:43:05.534 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 03:43:05.534 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-1_pid-0_0-1-2-4-7.pkl | len: 3 |  size: 2.07 KB
Processing depth (0, 1, 2, 4, 7):   1%|          | 1/100 [00:18<30:08, 18.27s/it]is_0k: False
your chose emoji: ['🐝', '👱🏼\u200d♂️', '😝', '👥', '\U0001faf1🏻\u200d\U0001faf2🏼', '🤦🏿\u200d♀️', '🙇🏿\u200d♀', '👩🏿\u200d⚖️', '👩🏾\u200d🌾', '👨🏿\u200d❤️\u200d👨🏽']
emoji:
O: 🐝 [9468, 238, 251]
N: 👱🏼‍♂️ [9468, 239, 109, 9468, 237, 120, 102470, 17245, 224, 31643]

O: 👱🏼‍♂️ [9468, 239, 109, 9468, 237, 120, 102470, 17245, 224, 31643]
N: 🫱🏻‍🫲🏼 [9468, 104, 109, 9468, 237, 119, 102470, 9468, 104, 110, 9468, 237, 120]

O: 😝 [76460, 251]
N: 👩🏿‍⚖️ [9468, 239, 102, 9468, 237, 123, 102470, 158, 248, 244, 31643]

O: 👥 [9468, 239, 98]
N: 👥 [9468, 239, 98]

O: 🫱🏻‍🫲🏼 [9468, 104, 109, 9468, 237, 119, 102470, 9468, 104, 110, 9468, 237, 120]
N: 🙇🏿‍♀ [9468, 247, 229, 9468, 237, 123, 102470, 32990]

O: 🤦🏿‍♀️ [9468, 97, 99, 9468, 237, 123, 102470, 32990, 31643]
N: 🤦🏿‍♀️ [9468, 97, 99, 9468, 237, 123, 102470, 32990, 31643]

O: 🙇🏿‍♀ [9468, 247, 229, 9468, 237, 123, 102470, 32990]
N: 😝 [76460, 251]

O: 👩🏿‍⚖️ [9468, 239, 102, 9468, 237, 123, 102470, 158, 248, 244, 31643]
N: 🐝 [9468, 238, 251]

O: 👩🏾‍🌾 [9468, 239, 102, 9468, 237, 122, 102470, 9468, 234, 122]
N: 👩🏾‍🌾 [9468, 239, 102, 9468, 237, 122, 102470, 9468, 234, 122]

O: 👨🏿‍❤️‍👨🏽 [9468, 239, 101, 9468, 237, 123, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 121]
N: 👨🏿‍❤️‍👨🏽 [9468, 239, 101, 9468, 237, 123, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 121]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.19s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.13s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:03,  3.97s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  2.60s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  3.14s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (2, 4, 6, 7, 8):   1%|          | 1/100 [00:32<30:08, 18.27s/it]2025-01-22 03:43:19.857 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the office.
2025-01-22 03:43:19.868 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2005, 2011) -->  cable. Mary journeyed to
2025-01-22 03:43:19.868 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary got the apple.
2025-01-22 03:43:19.888 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3619, 3623) -->  Mary got the apple
2025-01-22 03:43:19.888 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bathroom.
2025-01-22 03:43:19.900 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2005, 2011) -->  cable. Mary journeyed to
2025-01-22 03:43:19.900 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary dropped the apple.
2025-01-22 03:43:19.927 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5616, 5620) -->  Mary dropped the apple
2025-01-22 03:43:19.927 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel went back to the kitchen.
2025-01-22 03:43:19.964 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6504, 6510) --> . Daniel went back to the
2025-01-22 03:43:19.964 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the bedroom.
2025-01-22 03:43:19.983 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2935, 2941) --> . John went back to the
2025-01-22 03:43:19.983 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the office.
2025-01-22 03:43:19.994 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2007, 2013) -->  Mary journeyed to the office
2025-01-22 03:43:19.994 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John took the milk.
2025-01-22 03:43:20.037 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6834, 6838) -->  John took the milk
2025-01-22 03:43:20.037 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra journeyed to the bedroom.
2025-01-22 03:43:20.038 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (143, 149) --> . Sandra journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 03:43:40.685 | INFO     | test_jbb_embedding:begin_test:693 - Mary dropped the apple. 
Mary dropped the apple. 
Mary dropped the apple. 
Mary dropped the apple. 
Mary dropped the apple. 
Mary dropped
2025-01-22 03:43:40.685 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8199])
2025-01-22 03:43:43.517 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [755.2980769230769, 93.70277252774052, 528.8494318181819, 90.41874156752115, 76.48704769736842], 'topk_indices': array([5391, 5617, 8182, 8181, 8087, 8184, 8173, 8044, 3622, 8186, 8078,
       8179, 8178, 5619, 3623, 5620, 8088,    0, 8194, 8195]), 'topk_tokens': [' readiness', ' dropped', ' where', ' place', ' first', ' apple', ':', ' context', ' apple', ' discarded', '.\n\n', ' to', ' prior', ' apple', '.', '.', ' location', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [588.5625, 1284.25, 588.5625, 1677.25, 121.5]}, 'weight': {'score': [23.95733173076923, 23.281019464089745, 22.224431818181817, 23.28171378633632, 29.44716282894737], 'topk_indices': array([3303, 3276, 3148, 3196, 7461, 7423, 1406, 1468, 4326, 4310, 5202,
       5141, 7200, 7144, 3459, 3485, 4918, 4995, 4966, 4943]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [23.740885416666668, 26.353515625, 23.740885416666668, 26.755859375, 20.927083333333332]}, 'saliency': {'score': [4.83306884765625, 0.5220613101679673, 3.0568736683238638, 0.5014735427382941, 0.5598947625411185], 'topk_indices': array([8082, 8078, 8159,  149, 8174, 8182, 8177, 8181, 8084, 8087, 5617,
       8172, 8044, 8184, 3622, 5391, 8178, 5619, 8186, 8088]), 'topk_tokens': [' obtained', '.\n\n', ' return', ' bedroom', ' Where', ' where', ' location', ' place', ' item', ' first', ' dropped', 'Question', ' context', ' apple', ' apple', ' readiness', ' prior', ' apple', ' discarded', ' location'], 'evidence_proportions': [3.4750162760416665, 8.76904296875, 3.4750162760416665, 11.2509765625, 0.6465861002604166]}}, 'pred_res': 'Mary dropped the apple. \nMary dropped the apple. \nMary dropped the apple. \nMary dropped the apple. \nMary dropped the apple. \nMary dropped', 'score': 0}
2025-01-22 03:43:43.521 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 03:43:43.522 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-1_pid-1_2-4-6-7-8.pkl | len: 3 |  size: 2.21 KB
Processing depth (2, 4, 6, 7, 8):   2%|▏         | 2/100 [00:56<48:46, 29.87s/it]is_0k: False
your chose emoji: ['📁', '👌🏽', '📗', '👸', '🚶🏼\u200d♂', '🧎🏽\u200d♀️\u200d➡️', '👨🏻\u200d🚒', '🥭', '🧑🏾\u200d🦽\u200d➡️', '👨🏼\u200d🦼\u200d➡']
emoji:
O: 📁 [9468, 241, 223]
N: 🚶🏼‍♂ [9468, 248, 114, 9468, 237, 120, 102470, 17245, 224]

O: 👌🏽 [9468, 239, 234, 9468, 237, 121]
N: 👌🏽 [9468, 239, 234, 9468, 237, 121]

O: 📗 [9468, 241, 245]
N: 👸 [9468, 110848]

O: 👸 [9468, 110848]
N: 👨🏻‍🚒 [9468, 239, 101, 9468, 237, 119, 102470, 9468, 248, 240]

O: 🚶🏼‍♂ [9468, 248, 114, 9468, 237, 120, 102470, 17245, 224]
N: 🧎🏽‍♀️‍➡️ [9468, 100, 236, 9468, 237, 121, 102470, 32990, 31643, 102470, 98115, 94, 31643]

O: 🧎🏽‍♀️‍➡️ [9468, 100, 236, 9468, 237, 121, 102470, 32990, 31643, 102470, 98115, 94, 31643]
N: 📁 [9468, 241, 223]

O: 👨🏻‍🚒 [9468, 239, 101, 9468, 237, 119, 102470, 9468, 248, 240]
N: 🥭 [9468, 98, 255]

O: 🥭 [9468, 98, 255]
N: 📗 [9468, 241, 245]

O: 🧑🏾‍🦽‍➡️ [9468, 100, 239, 9468, 237, 122, 102470, 9468, 99, 121, 102470, 98115, 94, 31643]
N: 🧑🏾‍🦽‍➡️ [9468, 100, 239, 9468, 237, 122, 102470, 9468, 99, 121, 102470, 98115, 94, 31643]

O: 👨🏼‍🦼‍➡ [9468, 239, 101, 9468, 237, 120, 102470, 9468, 99, 120, 102470, 98115, 94]
N: 👨🏼‍🦼‍➡ [9468, 239, 101, 9468, 237, 120, 102470, 9468, 99, 120, 102470, 98115, 94]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.03s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.08s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:11<00:03,  3.91s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  2.71s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  3.18s/it]
Processing depth (2, 3, 5, 6, 8):   2%|▏         | 2/100 [01:10<48:46, 29.87s/it]2025-01-22 03:43:57.939 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the office.
2025-01-22 03:43:57.949 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1806, 1812) --> . Mary journeyed to the
2025-01-22 03:43:57.949 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary got the apple.
2025-01-22 03:43:57.963 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2898, 2902) -->  Mary got the apple
2025-01-22 03:43:57.963 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bathroom.
2025-01-22 03:43:57.972 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1806, 1812) --> . Mary journeyed to the
2025-01-22 03:43:57.972 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary dropped the apple.
2025-01-22 03:43:57.994 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4758, 4762) -->  Mary dropped the apple
2025-01-22 03:43:57.995 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel went back to the kitchen.
2025-01-22 03:43:58.028 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6652, 6658) --> . Daniel went back to the
2025-01-22 03:43:58.028 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the bedroom.
2025-01-22 03:43:58.042 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2901, 2907) -->  apple. John went back to
2025-01-22 03:43:58.042 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the office.
2025-01-22 03:43:58.051 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1807, 1813) -->  Mary journeyed to the office
2025-01-22 03:43:58.051 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John took the milk.
2025-01-22 03:43:58.085 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6988, 6992) -->  John took the milk
2025-01-22 03:43:58.085 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra journeyed to the bedroom.
2025-01-22 03:43:58.085 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (143, 149) --> . Sandra journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 03:43:58.917 | INFO     | test_jbb_embedding:begin_test:693 - Mary got the apple.<|eot_id|>
2025-01-22 03:43:58.917 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8199])
2025-01-22 03:44:01.151 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [352.6370192307692, 33.44882483843434, 410.5625, 31.41332944928247, 56.90846011513158], 'topk_indices': array([1809, 8172, 1808,  146, 8173, 1812,  153,   23,  145, 8197,   14,
         24,  150,  446,  447, 8194, 8195,  585,  149,    0]), 'topk_tokens': ['ed', 'Question', ' journey', 'ed', ':', ' office', '�', '4', ' journey', '<|end_header_id|>', '\n', '\n\n', '.', ' em', 's', '<|eot_id|>', '<|start_header_id|>', ' em', ' bedroom', '<|begin_of_text|>'], 'evidence_proportions': [468.8333333333333, 441.5625, 468.8333333333333, 229.25, 143.21875]}, 'weight': {'score': [22.254807692307693, 23.280638412998414, 23.19637784090909, 23.284137165767202, 29.42660361842105], 'topk_indices': array([3356, 3329, 3201, 3249, 7431, 7469, 1442, 1504, 4337, 4353, 5221,
       5160, 7130, 7186, 3538, 3512, 5014, 4985, 4962, 4937]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.052083333333332, 26.353515625, 20.052083333333332, 26.755859375, 20.927083333333332]}, 'saliency': {'score': [2.0237145057091346, 0.1887815819907633, 2.3900090997869317, 0.17699018478627498, 0.42152284321032074], 'topk_indices': array([8192, 4420, 8088, 2908,   24,  447, 8044,  151,  131,  153, 1812,
       2901, 1808, 4171,  145,  144, 8172,  446,  585,  149]), 'topk_tokens': ['Answer', ' office', ' location', ' bedroom', '\n\n', 's', ' context', '�', ' Articles', '�', ' office', ' apple', ' journey', ' bathroom', ' journey', ' Sandra', 'Question', ' em', ' em', ' bedroom'], 'evidence_proportions': [2.5264485677083335, 2.94189453125, 2.5264485677083335, 1.5457763671875, 0.7247517903645834]}}, 'pred_res': 'Mary got the apple.<|eot_id|>', 'score': 0}
2025-01-22 03:44:01.159 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 03:44:01.159 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-1_pid-2_2-3-5-6-8.pkl | len: 3 |  size: 2.07 KB
Processing depth (2, 3, 5, 6, 8):   3%|▎         | 3/100 [01:13<39:15, 24.28s/it]is_0k: False
your chose emoji: ['🚶🏿\u200d♀\u200d➡️', '👨\u200d👩\u200d👧', '🤦🏿', '🧗\u200d♀', '🧗🏽\u200d♂️', '🧎🏼\u200d♀', '🇱🇹', '🙏🏿', '🔞', '🤾🏽\u200d♂']
emoji:
O: 🚶🏿‍♀‍➡️ [9468, 248, 114, 9468, 237, 123, 102470, 32990, 102470, 98115, 94, 31643]
N: 🧎🏼‍♀ [9468, 100, 236, 9468, 237, 120, 102470, 32990]

O: 👨‍👩‍👧 [9468, 239, 101, 102470, 9468, 239, 102, 102470, 9468, 239, 100]
N: 🧗🏽‍♂️ [9468, 100, 245, 9468, 237, 121, 102470, 17245, 224, 31643]

O: 🤦🏿 [9468, 97, 99, 9468, 237, 123]
N: 🤦🏿 [9468, 97, 99, 9468, 237, 123]

O: 🧗‍♀ [9468, 100, 245, 102470, 32990]
N: 🔞 [9468, 242, 252]

O: 🧗🏽‍♂️ [9468, 100, 245, 9468, 237, 121, 102470, 17245, 224, 31643]
N: 🚶🏿‍♀‍➡️ [9468, 248, 114, 9468, 237, 123, 102470, 32990, 102470, 98115, 94, 31643]

O: 🧎🏼‍♀ [9468, 100, 236, 9468, 237, 120, 102470, 32990]
N: 👨‍👩‍👧 [9468, 239, 101, 102470, 9468, 239, 102, 102470, 9468, 239, 100]

O: 🇱🇹 [9468, 229, 109, 9468, 229, 117]
N: 🙏🏿 [9468, 247, 237, 9468, 237, 123]

O: 🙏🏿 [9468, 247, 237, 9468, 237, 123]
N: 🧗‍♀ [9468, 100, 245, 102470, 32990]

O: 🔞 [9468, 242, 252]
N: 🇱🇹 [9468, 229, 109, 9468, 229, 117]

O: 🤾🏽‍♂ [9468, 97, 122, 9468, 237, 121, 102470, 17245, 224]
N: 🤾🏽‍♂ [9468, 97, 122, 9468, 237, 121, 102470, 17245, 224]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:11,  3.69s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:07<00:07,  3.91s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:11<00:03,  3.75s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  2.62s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  3.05s/it]
Processing depth (1, 2, 3, 6, 8):   3%|▎         | 3/100 [01:27<39:15, 24.28s/it]2025-01-22 03:44:15.109 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the office.
2025-01-22 03:44:15.113 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (836, 842) --> . Mary journeyed to the
2025-01-22 03:44:15.113 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary got the apple.
2025-01-22 03:44:15.122 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1870, 1874) -->  Mary got the apple
2025-01-22 03:44:15.122 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bathroom.
2025-01-22 03:44:15.127 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (836, 842) --> . Mary journeyed to the
2025-01-22 03:44:15.127 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary dropped the apple.
2025-01-22 03:44:15.150 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4726, 4730) -->  Mary dropped the apple
2025-01-22 03:44:15.150 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel went back to the kitchen.
2025-01-22 03:44:15.183 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6599, 6605) -->  Daniel went back to the kitchen
2025-01-22 03:44:15.183 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the bedroom.
2025-01-22 03:44:15.198 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2947, 2953) -->  the bathroom. John went back
2025-01-22 03:44:15.198 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the office.
2025-01-22 03:44:15.203 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (837, 843) -->  Mary journeyed to the office
2025-01-22 03:44:15.203 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John took the milk.
2025-01-22 03:44:15.236 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6906, 6910) -->  John took the milk
2025-01-22 03:44:15.236 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra journeyed to the bedroom.
2025-01-22 03:44:15.237 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (125, 131) --> . Sandra journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 03:44:15.975 | INFO     | test_jbb_embedding:begin_test:693 - the bedroom<|eot_id|>
2025-01-22 03:44:15.975 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8157])
2025-01-22 03:44:18.184 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [407.4807692307692, 49.02681088368673, 555.2627840909091, 46.504681142892366, 70.39460227272727], 'topk_indices': array([8001,   14,  842,  560,  127,  126,  131,  128,  567, 1732, 1654,
        132,  568, 8152, 8002, 8153,  569, 1655, 1733,    0]), 'topk_tokens': [' you', '\n', ' office', ',', ' journey', ' Sandra', ' bedroom', 'ed', ' em', ' summer', "'s", '.', 's', '<|eot_id|>', ' context', '<|start_header_id|>', ' per', ' work', "'s", '<|begin_of_text|>'], 'evidence_proportions': [524.8333333333334, 490.25, 524.8333333333334, 421.25, 108.41666666666667]}, 'weight': {'score': [23.17578125, 23.239944003554356, 23.327414772727273, 23.239912426026383, 28.75028409090909], 'topk_indices': array([3296, 3323, 3168, 3216, 7401, 7439, 1495, 1433, 4287, 4303, 5189,
       5128, 7116, 7172, 3479, 3505, 4982, 4905, 4930, 4953]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.052083333333332, 26.353515625, 20.052083333333332, 26.755859375, 24.91796875]}, 'saliency': {'score': [2.3707744891826925, 0.27600856200782875, 3.3013444380326704, 0.2610879229523371, 0.5042047674005682], 'topk_indices': array([8001,  452,  474,  128,  453, 1873,  568, 1653, 1654,  842, 2948,
        127,  567, 1732, 1733,  131,  126, 8002,  569, 1655]), 'topk_tokens': [' you', ' per', ' per', 'ed', ' hour', ' apple', 's', ' summer', "'s", ' office', ' bathroom', ' journey', ' em', ' summer', "'s", ' bedroom', ' Sandra', ' context', ' per', ' work'], 'evidence_proportions': [2.741455078125, 3.36181640625, 2.741455078125, 2.859619140625, 0.642822265625]}}, 'pred_res': 'the bedroom<|eot_id|>', 'score': 0}
2025-01-22 03:44:18.191 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 03:44:18.192 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-1_pid-3_1-2-3-6-8.pkl | len: 3 |  size: 2.04 KB
Processing depth (1, 2, 3, 6, 8):   4%|▍         | 4/100 [01:30<34:16, 21.42s/it]is_0k: False
your chose emoji: ['🚣🏿\u200d♀️', '🥺', '🦺', '👈🏻', '💆🏼', '\U0001fae8', '👩🏾\u200d🚀', '⛳', '🧑🏼\u200d⚖', '🍒']
emoji:
O: 🚣🏿‍♀️ [9468, 248, 96, 9468, 237, 123, 102470, 32990, 31643]
N: 👩🏾‍🚀 [9468, 239, 102, 9468, 237, 122, 102470, 9468, 248, 222]

O: 🥺 [9468, 98, 118]
N: 👈🏻 [9468, 239, 230, 9468, 237, 119]

O: 🦺 [9468, 99, 118]
N: 🫨 [9468, 104, 101]

O: 👈🏻 [9468, 239, 230, 9468, 237, 119]
N: 🦺 [9468, 99, 118]

O: 💆🏼 [93273, 228, 9468, 237, 120]
N: 🥺 [9468, 98, 118]

O: 🫨 [9468, 104, 101]
N: 🚣🏿‍♀️ [9468, 248, 96, 9468, 237, 123, 102470, 32990, 31643]

O: 👩🏾‍🚀 [9468, 239, 102, 9468, 237, 122, 102470, 9468, 248, 222]
N: 💆🏼 [93273, 228, 9468, 237, 120]

O: ⛳ [158, 249, 111]
N: 🧑🏼‍⚖ [9468, 100, 239, 9468, 237, 120, 102470, 158, 248, 244]

O: 🧑🏼‍⚖ [9468, 100, 239, 9468, 237, 120, 102470, 158, 248, 244]
N: ⛳ [158, 249, 111]

O: 🍒 [9468, 235, 240]
N: 🍒 [9468, 235, 240]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:10,  3.49s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:07<00:07,  3.84s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:11<00:03,  3.72s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  2.59s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  3.00s/it]
Processing depth (0, 1, 4, 8, 9):   4%|▍         | 4/100 [01:44<34:16, 21.42s/it]2025-01-22 03:44:31.856 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the office.
2025-01-22 03:44:31.856 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 37) -->  journeyed to the office.
2025-01-22 03:44:31.856 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary got the apple.
2025-01-22 03:44:31.860 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (782, 786) -->  Mary got the apple
2025-01-22 03:44:31.860 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bathroom.
2025-01-22 03:44:31.878 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3601, 3607) --> . Mary journeyed to the
2025-01-22 03:44:31.878 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary dropped the apple.
2025-01-22 03:44:31.909 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6592, 6596) -->  Mary dropped the apple
2025-01-22 03:44:31.910 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel went back to the kitchen.
2025-01-22 03:44:31.945 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7211, 7217) --> . Daniel went back to the
2025-01-22 03:44:31.945 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the bedroom.
2025-01-22 03:44:31.959 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2882, 2888) --> . John went back to the
2025-01-22 03:44:31.960 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the office.
2025-01-22 03:44:31.960 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (31, 37) -->  journeyed to the office.
2025-01-22 03:44:31.960 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John took the milk.
2025-01-22 03:44:31.992 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6905, 6909) -->  John took the milk
2025-01-22 03:44:31.993 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra journeyed to the bedroom.
2025-01-22 03:44:31.993 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (150, 156) --> . Sandra journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 03:44:32.834 | INFO     | test_jbb_embedding:begin_test:693 - Mary got the apple.<|eot_id|>
2025-01-22 03:44:32.834 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8165])
2025-01-22 03:44:35.129 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [560.7800480769231, 45.76585649565324, 479.35227272727275, 42.9417069528267, 33.12208686440678], 'topk_indices': array([  32,  156, 6594, 6593, 6595, 8144,   36,  160, 8044,   35,   31,
         14, 8145, 8152, 8010, 8054,   24, 8160,    0, 8161]), 'topk_tokens': ['ed', ' bedroom', ' the', ' dropped', ' apple', ' prior', '.', '�', '.\n\n', ' office', ' journey', '\n', ' to', ' discarded', ' context', ' location', '\n\n', '<|eot_id|>', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [968.0, 613.3125, 305.2708333333333, 991.5, 86.90104166666667]}, 'weight': {'score': [22.13701923076923, 23.25612411228113, 21.17294034090909, 23.26535268352014, 29.49311440677966], 'topk_indices': array([3285, 3312, 3205, 3157, 7429, 7391, 1434, 1496, 4283, 4299, 5162,
       5101, 7105, 7161, 3468, 3494, 4926, 4878, 4903, 4955]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.541666666666668, 26.353515625, 20.052083333333332, 26.755859375, 20.927083333333332]}, 'saliency': {'score': [3.2617093599759617, 0.25576969434921026, 2.545204856178977, 0.23993991175695129, 0.244342868610964], 'topk_indices': array([8044, 8140, 8050, 8138,  160,   24, 4438, 6592, 8150,  785, 3607,
       6593,   35, 6595, 8144,  156,   31, 8054, 8010, 8152]), 'topk_tokens': ['.\n\n', ' Where', ' item', 'Question', '�', '\n\n', ' office', ' Mary', ' apple', ' apple', ' bathroom', ' dropped', ' office', ' apple', ' prior', ' bedroom', ' journey', ' location', ' context', ' discarded'], 'evidence_proportions': [4.987955729166667, 4.077880859375, 1.6062825520833333, 6.49853515625, 0.4888916015625]}}, 'pred_res': 'Mary got the apple.<|eot_id|>', 'score': 0}
2025-01-22 03:44:35.136 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 03:44:35.136 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-1_pid-4_0-1-4-8-9.pkl | len: 3 |  size: 2.09 KB
Processing depth (0, 1, 4, 8, 9):   5%|▌         | 5/100 [01:47<31:21, 19.81s/it]Processing depth (0, 1, 4, 8, 9):   5%|▌         | 5/100 [01:47<34:10, 21.58s/it]
2025-01-22 03:44:35.192 | INFO     | __main__:<module>:82 - Selected idx: 2
2025-01-22 03:44:35.192 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the football before the bathroom? 
2025-01-22 03:44:35.192 | INFO     | __main__:<module>:84 - Answer: office
2025-01-22 03:44:35.192 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 03:44:35.192 | INFO     | __main__:<module>:86 - Needle: [' Daniel went back to the kitchen.', ' Mary journeyed to the office.', ' Sandra journeyed to the bedroom.', ' John went back to the bedroom.', ' John journeyed to the office.', ' Mary journeyed to the bathroom.', ' John took the milk.', ' John moved to the bedroom.', ' Mary dropped the football.', ' Daniel went back to the hallway.']
2025-01-22 03:44:35.192 | INFO     | __main__:<module>:87 - Real Needle: [' Mary journeyed to the office.', ' Mary journeyed to the bathroom.', ' Mary dropped the football.', ' Daniel went back to the hallway.']
2025-01-22 03:44:35.192 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['👩\u200d🦳', '🪦', '🇦🇷', '🤹\u200d♀', '👊🏼', '🌂', '👷🏼\u200d♂', '🚶🏿\u200d♀️', '🏳️\u200d🌈', '🏝']
emoji:
O: 👩‍🦳 [9468, 239, 102, 102470, 9468, 99, 111]
N: 🪦 [9468, 103, 99]

O: 🪦 [9468, 103, 99]
N: 🤹‍♀ [9468, 97, 117, 102470, 32990]

O: 🇦🇷 [9468, 229, 99, 9468, 229, 115]
N: 👊🏼 [9468, 239, 232, 9468, 237, 120]

O: 🤹‍♀ [9468, 97, 117, 102470, 32990]
N: 🌂 [9468, 234, 224]

O: 👊🏼 [9468, 239, 232, 9468, 237, 120]
N: 🇦🇷 [9468, 229, 99, 9468, 229, 115]

O: 🌂 [9468, 234, 224]
N: 🏳️‍🌈 [9468, 237, 111, 31643, 102470, 9468, 234, 230]

O: 👷🏼‍♂ [9468, 239, 115, 9468, 237, 120, 102470, 17245, 224]
N: 👩‍🦳 [9468, 239, 102, 102470, 9468, 99, 111]

O: 🚶🏿‍♀️ [9468, 248, 114, 9468, 237, 123, 102470, 32990, 31643]
N: 🚶🏿‍♀️ [9468, 248, 114, 9468, 237, 123, 102470, 32990, 31643]

O: 🏳️‍🌈 [9468, 237, 111, 31643, 102470, 9468, 234, 230]
N: 👷🏼‍♂ [9468, 239, 115, 9468, 237, 120, 102470, 17245, 224]

O: 🏝 [9468, 237, 251]
N: 🏝 [9468, 237, 251]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:10,  3.66s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:07<00:07,  3.90s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:11<00:03,  3.83s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  2.72s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  3.12s/it]
Processing depth (3, 5, 7, 9):   0%|          | 0/100 [00:14<?, ?it/s]2025-01-22 03:44:49.386 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the office.
2025-01-22 03:44:49.401 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2836, 2842) --> . Mary journeyed to the
2025-01-22 03:44:49.401 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the bathroom.
2025-01-22 03:44:49.416 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2836, 2842) --> . Mary journeyed to the
2025-01-22 03:44:49.416 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary dropped the football.
2025-01-22 03:44:49.444 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5645, 5649) -->  Mary dropped the football
2025-01-22 03:44:49.444 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went back to the hallway.
2025-01-22 03:44:49.475 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6097, 6103) -->  went back to the kitchen.
2025-01-22 03:44:49.475 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went back to the kitchen.
2025-01-22 03:44:49.505 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6096, 6102) -->  Daniel went back to the kitchen
2025-01-22 03:44:49.505 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra journeyed to the bedroom.
2025-01-22 03:44:49.511 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1293, 1299) --> . Sandra journeyed to the
2025-01-22 03:44:49.511 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the bedroom.
2025-01-22 03:44:49.544 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6194, 6200) --> . John went back to the
2025-01-22 03:44:49.545 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the office.
2025-01-22 03:44:49.559 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2837, 2843) -->  Mary journeyed to the office
2025-01-22 03:44:49.559 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John took the milk.
2025-01-22 03:44:49.585 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5542, 5546) -->  John took the milk
2025-01-22 03:44:49.585 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John moved to the bedroom.
2025-01-22 03:44:49.610 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (5211, 5216) --> . John moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 03:44:50.384 | INFO     | test_jbb_embedding:begin_test:693 - the office<|eot_id|>
2025-01-22 03:44:50.384 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8166])
2025-01-22 03:44:52.599 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [322.29829545454544, 28.79698595127326, 212.34280303030303, 27.254518211512387, 33.330403645833336], 'topk_indices': array([8156, 8064, 5649, 5645, 8020, 8165,    1, 8154, 8153,    3, 8160,
       8054,   23, 5644, 5648,   24,   14, 8164,    0, 8161]), 'topk_tokens': [' bathroom', ' location', '.', ' Mary', ' context', '\n\n', '<|start_header_id|>', ' before', ' football', '<|end_header_id|>', ':', '.\n\n', '4', '.', ' football', '\n\n', '\n', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [268.4166666666667, 268.4166666666667, 682.8125, 189.71875]}, 'weight': {'score': [21.533735795454547, 23.25854707394711, 22.207623106060606, 23.267498921484037, 29.458854166666665], 'topk_indices': array([3322, 3295, 3215, 3167, 7427, 7389, 1440, 1502, 4299, 4315, 5178,
       5117, 7103, 7159, 3478, 3504, 4912, 4942, 4887, 4971]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.052083333333332, 20.052083333333332, 27.013671875, 20.84375]}, 'saliency': {'score': [1.9652321555397727, 0.15956906310258018, 1.2569986979166667, 0.15020880598653397, 0.24540913899739583], 'topk_indices': array([  16, 8138, 8135, 5646, 6096,   20, 8159,   23, 8054, 5643, 4133,
       8064,   24, 8148, 8154, 8020, 5645, 8156, 8153, 5648]), 'topk_tokens': [' Date', ' directly', ' return', ' dropped', ' Daniel', ' Jul', 'Answer', '4', '.\n\n', ' St', ' bathroom', ' location', '\n\n', 'Question', ' before', ' context', ' Mary', ' bathroom', ' football', ' football'], 'evidence_proportions': [1.4112141927083333, 1.4112141927083333, 4.951416015625, 1.0824788411458333]}}, 'pred_res': 'the office<|eot_id|>', 'score': 100}
2025-01-22 03:44:52.606 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 03:44:52.606 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-2_pid-0_3-5-7-9.pkl | len: 3 |  size: 2.03 KB
Processing depth (3, 5, 7, 9):   1%|          | 1/100 [00:17<28:34, 17.32s/it]is_0k: False
your chose emoji: ['🪟', '🔰', '🍋', '🌒', '🧑🏼\u200d🦯', '🧎🏽\u200d♀\u200d➡', '🎀', '🤸\u200d♂', '💂\u200d♀', '👩🏾\u200d❤\u200d👩🏽']
emoji:
O: 🪟 [9468, 103, 253]
N: 🧑🏼‍🦯 [9468, 100, 239, 9468, 237, 120, 102470, 9468, 99, 107]

O: 🔰 [9468, 242, 108]
N: 🔰 [9468, 242, 108]

O: 🍋 [9468, 235, 233]
N: 💂‍♀ [93273, 224, 102470, 32990]

O: 🌒 [9468, 102032]
N: 🧎🏽‍♀‍➡ [9468, 100, 236, 9468, 237, 121, 102470, 32990, 102470, 98115, 94]

O: 🧑🏼‍🦯 [9468, 100, 239, 9468, 237, 120, 102470, 9468, 99, 107]
N: 🤸‍♂ [9468, 97, 116, 102470, 17245, 224]

O: 🧎🏽‍♀‍➡ [9468, 100, 236, 9468, 237, 121, 102470, 32990, 102470, 98115, 94]
N: 🎀 [9468, 236, 222]

O: 🎀 [9468, 236, 222]
N: 🌒 [9468, 102032]

O: 🤸‍♂ [9468, 97, 116, 102470, 17245, 224]
N: 🍋 [9468, 235, 233]

O: 💂‍♀ [93273, 224, 102470, 32990]
N: 🪟 [9468, 103, 253]

O: 👩🏾‍❤‍👩🏽 [9468, 239, 102, 9468, 237, 122, 102470, 121643, 102470, 9468, 239, 102, 9468, 237, 121]
N: 👩🏾‍❤‍👩🏽 [9468, 239, 102, 9468, 237, 122, 102470, 121643, 102470, 9468, 239, 102, 9468, 237, 121]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:11,  3.83s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:07<00:07,  3.85s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:11<00:03,  3.85s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  2.67s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  3.10s/it]
Processing depth (2, 3, 6, 8):   1%|          | 1/100 [00:31<28:34, 17.32s/it]2025-01-22 03:45:06.723 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the office.
2025-01-22 03:45:06.732 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1799, 1805) -->  Mary journeyed to the office
2025-01-22 03:45:06.732 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the bathroom.
2025-01-22 03:45:06.741 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1800, 1806) -->  journeyed to the office.
2025-01-22 03:45:06.741 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary dropped the football.
2025-01-22 03:45:06.764 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4771, 4775) -->  Mary dropped the football
2025-01-22 03:45:06.764 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went back to the hallway.
2025-01-22 03:45:06.794 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6189, 6195) --> . Daniel went back to the
2025-01-22 03:45:06.794 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went back to the kitchen.
2025-01-22 03:45:06.829 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6189, 6195) --> . Daniel went back to the
2025-01-22 03:45:06.829 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra journeyed to the bedroom.
2025-01-22 03:45:06.837 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1513, 1519) --> . Sandra journeyed to the
2025-01-22 03:45:06.837 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the bedroom.
2025-01-22 03:45:06.867 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6228, 6234) --> . John went back to the
2025-01-22 03:45:06.867 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the office.
2025-01-22 03:45:06.876 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1800, 1806) -->  journeyed to the office.
2025-01-22 03:45:06.876 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John took the milk.
2025-01-22 03:45:06.903 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5599, 5603) -->  John took the milk
2025-01-22 03:45:06.903 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John moved to the bedroom.
2025-01-22 03:45:06.929 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (5330, 5335) --> . John moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 03:45:07.694 | INFO     | test_jbb_embedding:begin_test:693 - the kitchen<|eot_id|>
2025-01-22 03:45:07.694 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8174])
2025-01-22 03:45:09.914 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [570.8068181818181, 49.549229452054796, 375.3901515151515, 46.813061815047405, 54.03955078125], 'topk_indices': array([6195, 4772, 2933, 4775,   23, 2939,   24, 8164, 8168, 8173, 8162,
       2905, 8161, 8062,   14, 8172, 4774, 6190,    0, 8169]), 'topk_tokens': [' kitchen', ' dropped', '.', '.', '4', ' bathroom', '\n\n', ' bathroom', ':', '\n\n', ' before', '.', ' football', '.\n\n', '\n', '<|end_header_id|>', ' football', ' Daniel', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [408.0416666666667, 389.75, 939.125, 669.0833333333334]}, 'weight': {'score': [22.329545454545453, 23.264084668542075, 20.781013257575758, 23.276706417005293, 29.425048828125], 'topk_indices': array([3321, 3294, 3194, 3146, 7403, 7441, 1473, 1411, 4301, 4285, 5185,
       5124, 7180, 7124, 3477, 3503, 4919, 4942, 4971, 4894]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [23.397135416666668, 19.541666666666668, 27.013671875, 20.927083333333332]}, 'saliency': {'score': [3.573508522727273, 0.27896303300055036, 2.1239420572916665, 0.2625408795002925, 0.4138767719268799], 'topk_indices': array([4786, 8173, 8158, 2932, 1519, 8156, 5332, 8072, 8167, 8100, 8062,
       2906, 4772, 6195, 8162, 2939, 8164, 8161, 4774, 6190]), 'topk_tokens': [' favor', '\n\n', ' Where', ' Gov', ' bedroom', 'Question', ' moved', ' location', 'Answer', ' moved', '.\n\n', ' During', ' dropped', ' kitchen', ' before', ' bathroom', ' bathroom', ' football', ' football', ' Daniel'], 'evidence_proportions': [2.5464680989583335, 2.059814453125, 6.6396484375, 4.070149739583333]}}, 'pred_res': 'the kitchen<|eot_id|>', 'score': 0}
2025-01-22 03:45:09.921 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 03:45:09.921 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-2_pid-1_2-3-6-8.pkl | len: 3 |  size: 2.02 KB
Processing depth (2, 3, 6, 8):   2%|▏         | 2/100 [00:34<28:16, 17.32s/it]is_0k: False
your chose emoji: ['🆔', '🥺', '🇨🇮', '⛹🏿\u200d♀', '🙇🏽\u200d♂️', '🧔🏿\u200d♀', '🙍🏾\u200d♀', '↖️', '🇪🇪', '🤷🏼\u200d♂']
emoji:
O: 🆔 [9468, 228, 242]
N: 🇨🇮 [9468, 229, 101, 9468, 229, 106]

O: 🥺 [9468, 98, 118]
N: 🧔🏿‍♀ [9468, 100, 242, 9468, 237, 123, 102470, 32990]

O: 🇨🇮 [9468, 229, 101, 9468, 229, 106]
N: 🙇🏽‍♂️ [9468, 247, 229, 9468, 237, 121, 102470, 17245, 224, 31643]

O: ⛹🏿‍♀ [158, 249, 117, 9468, 237, 123, 102470, 32990]
N: 🇪🇪 [9468, 229, 103, 9468, 229, 103]

O: 🙇🏽‍♂️ [9468, 247, 229, 9468, 237, 121, 102470, 17245, 224, 31643]
N: 🙍🏾‍♀ [9468, 247, 235, 9468, 237, 122, 102470, 32990]

O: 🧔🏿‍♀ [9468, 100, 242, 9468, 237, 123, 102470, 32990]
N: ↖️ [27017, 244, 31643]

O: 🙍🏾‍♀ [9468, 247, 235, 9468, 237, 122, 102470, 32990]
N: ⛹🏿‍♀ [158, 249, 117, 9468, 237, 123, 102470, 32990]

O: ↖️ [27017, 244, 31643]
N: 🥺 [9468, 98, 118]

O: 🇪🇪 [9468, 229, 103, 9468, 229, 103]
N: 🆔 [9468, 228, 242]

O: 🤷🏼‍♂ [9468, 97, 115, 9468, 237, 120, 102470, 17245, 224]
N: 🤷🏼‍♂ [9468, 97, 115, 9468, 237, 120, 102470, 17245, 224]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.15s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:07,  3.99s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:11<00:03,  3.86s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  2.50s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  3.04s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (1, 4, 6, 7):   2%|▏         | 2/100 [00:48<28:16, 17.32s/it]2025-01-22 03:45:23.783 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the office.
2025-01-22 03:45:23.788 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (895, 901) --> . Mary journeyed to the
2025-01-22 03:45:23.788 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the bathroom.
2025-01-22 03:45:23.793 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (895, 901) --> . Mary journeyed to the
2025-01-22 03:45:23.793 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary dropped the football.
2025-01-22 03:45:23.818 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4863, 4867) -->  Mary dropped the football
2025-01-22 03:45:23.818 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went back to the hallway.
2025-01-22 03:45:23.852 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5771, 5777) --> . Daniel went back to the
2025-01-22 03:45:23.853 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went back to the kitchen.
2025-01-22 03:45:23.882 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5771, 5777) --> . Daniel went back to the
2025-01-22 03:45:23.882 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra journeyed to the bedroom.
2025-01-22 03:45:23.890 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1522, 1528) --> . Sandra journeyed to the
2025-01-22 03:45:23.890 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the bedroom.
2025-01-22 03:45:23.925 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6166, 6172) -->  John went back to the bedroom
2025-01-22 03:45:23.925 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the office.
2025-01-22 03:45:23.929 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (896, 902) -->  Mary journeyed to the office
2025-01-22 03:45:23.929 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John took the milk.
2025-01-22 03:45:23.956 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5629, 5633) -->  John took the milk
2025-01-22 03:45:23.957 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John moved to the bedroom.
2025-01-22 03:45:23.986 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (5360, 5365) --> . John moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 03:45:27.112 | INFO     | test_jbb_embedding:begin_test:693 - Mary's hands.<|eot_id|>
2025-01-22 03:45:27.112 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8216])
2025-01-22 03:45:29.827 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [695.2784090909091, 62.620801898272084, 305.0416666666667, 59.935716035771165, 43.755560661764704], 'topk_indices': array([4881, 8198, 8202,   24, 8201,   14, 8114, 8070, 3651, 8199, 4867,
       3652, 8214, 4866, 8206, 8204, 8203, 8211,    0, 8212]), 'topk_tokens': [' for', 'Question', ' the', '\n\n', ' was', '\n', ' location', ' context', ' bathroom', ':', '.', '.', '<|end_header_id|>', ' football', ' bathroom', ' before', ' football', '<|eot_id|>', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [792.0, 792.0, 1223.625, 149.60416666666666]}, 'weight': {'score': [21.556463068181817, 23.291887852883914, 22.304214015151516, 23.300557775940216, 29.246875], 'topk_indices': array([3310, 3283, 3155, 3203, 7463, 7501, 1482, 1420, 4305, 4289, 5215,
       5154, 7184, 7240, 3492, 3466, 4913, 4965, 4888, 4936]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.052083333333332, 20.052083333333332, 27.013671875, 20.927083333333332]}, 'saliency': {'score': [4.164179021661932, 0.3467715150336913, 1.8431655421401516, 0.33043389797619593, 0.31360976275275737], 'topk_indices': array([  24, 8068, 8207, 3646, 3647, 8201, 1523, 1528, 4864, 4880, 8200,
        897, 8114, 8198, 8070, 3651, 8204, 4866, 8206, 8203]), 'topk_tokens': ['\n\n', ' provided', '?', ' Mary', ' journey', ' was', ' Sandra', ' bedroom', ' dropped', ' supposed', ' Where', ' journey', ' location', 'Question', ' context', ' bathroom', ' before', ' football', ' bathroom', ' football'], 'evidence_proportions': [4.2802734375, 4.2802734375, 8.68115234375, 0.9206746419270834]}}, 'pred_res': "Mary's hands.<|eot_id|>", 'score': 0}
2025-01-22 03:45:29.833 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 03:45:29.833 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-2_pid-2_1-4-6-7.pkl | len: 3 |  size: 2.05 KB
Processing depth (1, 4, 6, 7):   3%|▎         | 3/100 [00:54<29:54, 18.50s/it]is_0k: False
your chose emoji: ['🤝🏾', '👨🏻\u200d🎤', '🇲🇳', '🇸🇾', '🦐', '👩🏾\u200d❤\u200d💋\u200d👨🏼', '👨\u200d🎨', '🧑🏽\u200d❤\u200d🧑🏼', '🧝🏽\u200d♀', '🧑\u200d🍼']
emoji:
O: 🤝🏾 [9468, 97, 251, 9468, 237, 122]
N: 👨‍🎨 [9468, 239, 101, 102470, 9468, 236, 101]

O: 👨🏻‍🎤 [9468, 239, 101, 9468, 237, 119, 102470, 9468, 236, 97]
N: 🧑🏽‍❤‍🧑🏼 [9468, 100, 239, 9468, 237, 121, 102470, 121643, 102470, 9468, 100, 239, 9468, 237, 120]

O: 🇲🇳 [9468, 229, 110, 9468, 229, 111]
N: 👨🏻‍🎤 [9468, 239, 101, 9468, 237, 119, 102470, 9468, 236, 97]

O: 🇸🇾 [9468, 229, 116, 9468, 229, 122]
N: 🦐 [9468, 99, 238]

O: 🦐 [9468, 99, 238]
N: 👩🏾‍❤‍💋‍👨🏼 [9468, 239, 102, 9468, 237, 122, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 120]

O: 👩🏾‍❤‍💋‍👨🏼 [9468, 239, 102, 9468, 237, 122, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 120]
N: 🤝🏾 [9468, 97, 251, 9468, 237, 122]

O: 👨‍🎨 [9468, 239, 101, 102470, 9468, 236, 101]
N: 🇸🇾 [9468, 229, 116, 9468, 229, 122]

O: 🧑🏽‍❤‍🧑🏼 [9468, 100, 239, 9468, 237, 121, 102470, 121643, 102470, 9468, 100, 239, 9468, 237, 120]
N: 🧝🏽‍♀ [9468, 100, 251, 9468, 237, 121, 102470, 32990]

O: 🧝🏽‍♀ [9468, 100, 251, 9468, 237, 121, 102470, 32990]
N: 🇲🇳 [9468, 229, 110, 9468, 229, 111]

O: 🧑‍🍼 [9468, 100, 239, 102470, 9468, 104247]
N: 🧑‍🍼 [9468, 100, 239, 102470, 9468, 104247]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:11,  3.93s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:07<00:07,  3.95s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:11<00:03,  3.85s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  2.68s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  3.13s/it]
Processing depth (0, 1, 3, 9):   3%|▎         | 3/100 [01:08<29:54, 18.50s/it]2025-01-22 03:45:43.981 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the office.
2025-01-22 03:45:43.985 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 37) -->  journeyed to the office.
2025-01-22 03:45:43.985 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the bathroom.
2025-01-22 03:45:43.989 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (902, 908) --> . Mary journeyed to the
2025-01-22 03:45:43.989 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary dropped the football.
2025-01-22 03:45:44.005 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2893, 2897) -->  Mary dropped the football
2025-01-22 03:45:44.005 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went back to the hallway.
2025-01-22 03:45:44.037 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5835, 5841) --> . Daniel went back to the
2025-01-22 03:45:44.037 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went back to the kitchen.
2025-01-22 03:45:44.067 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5835, 5841) --> . Daniel went back to the
2025-01-22 03:45:44.067 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra journeyed to the bedroom.
2025-01-22 03:45:44.075 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1522, 1528) -->  Sandra journeyed to the bedroom
2025-01-22 03:45:44.075 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the bedroom.
2025-01-22 03:45:44.107 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6117, 6123) -->  John went back to the bedroom
2025-01-22 03:45:44.107 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the office.
2025-01-22 03:45:44.107 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (31, 37) -->  journeyed to the office.
2025-01-22 03:45:44.107 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John took the milk.
2025-01-22 03:45:44.137 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5555, 5559) -->  John took the milk
2025-01-22 03:45:44.137 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John moved to the bedroom.
2025-01-22 03:45:44.164 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (5224, 5229) --> . John moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 03:45:45.019 | INFO     | test_jbb_embedding:begin_test:693 - The office.<|eot_id|>
2025-01-22 03:45:45.020 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8164])
2025-01-22 03:45:47.235 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [253.35511363636363, 25.79101227651237, 137.1998106060606, 24.720503020589323, 16.475271451271187], 'topk_indices': array([8163, 8151, 8092,    9, 8062, 3107, 8154, 8052,   68,  106,   23,
          1,   69, 8152,   24,   14, 8160, 8159, 8162,    0]), 'topk_tokens': ['\n\n', ' football', ' the', ':', ' location', 'ern', ' bathroom', '.\n\n', 'ION', 'ION', '4', '<|start_header_id|>', 'E', ' before', '\n\n', '\n', '<|start_header_id|>', '<|eot_id|>', '<|end_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [380.0416666666667, 276.9166666666667, 344.75, 42.177083333333336]}, 'weight': {'score': [21.417258522727273, 23.255832108743572, 22.425426136363637, 23.264197540377264, 29.368379237288135], 'topk_indices': array([3287, 3314, 3159, 3207, 7449, 7411, 1475, 1413, 4302, 4318, 5130,
       5191, 7132, 7188, 3470, 3496, 4955, 4900, 4984, 4925]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.541666666666668, 20.052083333333332, 27.013671875, 20.927083333333332]}, 'saliency': {'score': [1.4015308726917615, 0.14229759946921688, 0.7643229166666666, 0.13635135763979858, 0.1216341438940016], 'topk_indices': array([7742, 7556, 8052, 3106, 8133,   20,   31, 8148,   23,   24,   69,
       3107, 2896,  106, 8062,   68,  908, 8151, 8152, 8154]), 'topk_tokens': ['inen', ' Min', '.\n\n', ' const', ' return', ' Jul', ' journey', ' Where', '4', '\n\n', 'E', 'ern', ' football', 'ION', ' location', 'ION', ' bathroom', ' football', ' before', ' bathroom'], 'evidence_proportions': [1.97705078125, 1.3606770833333333, 2.365478515625, 0.22423299153645834]}}, 'pred_res': 'The office.<|eot_id|>', 'score': 100}
2025-01-22 03:45:47.243 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 03:45:47.243 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-2_pid-3_0-1-3-9.pkl | len: 3 |  size: 2.01 KB
Processing depth (0, 1, 3, 9):   4%|▍         | 4/100 [01:11<28:54, 18.07s/it]is_0k: False
your chose emoji: ['🖊', '🦸🏿\u200d♂', '🙅🏻\u200d♀️', '👰🏼\u200d♀️', '🧙🏾', '🤚🏼', '🦖', '🧛\u200d♀', '🧑', '🎅🏿']
emoji:
O: 🖊 [9468, 244, 232]
N: 🖊 [9468, 244, 232]

O: 🦸🏿‍♂ [9468, 99, 116, 9468, 237, 123, 102470, 17245, 224]
N: 👰🏼‍♀️ [9468, 239, 108, 9468, 237, 120, 102470, 32990, 31643]

O: 🙅🏻‍♀️ [9468, 247, 227, 9468, 237, 119, 102470, 32990, 31643]
N: 🧙🏾 [9468, 100, 247, 9468, 237, 122]

O: 👰🏼‍♀️ [9468, 239, 108, 9468, 237, 120, 102470, 32990, 31643]
N: 🦸🏿‍♂ [9468, 99, 116, 9468, 237, 123, 102470, 17245, 224]

O: 🧙🏾 [9468, 100, 247, 9468, 237, 122]
N: 🙅🏻‍♀️ [9468, 247, 227, 9468, 237, 119, 102470, 32990, 31643]

O: 🤚🏼 [9468, 97, 248, 9468, 237, 120]
N: 🧛‍♀ [9468, 100, 249, 102470, 32990]

O: 🦖 [9468, 99, 244]
N: 🦖 [9468, 99, 244]

O: 🧛‍♀ [9468, 100, 249, 102470, 32990]
N: 🧑 [9468, 100, 239]

O: 🧑 [9468, 100, 239]
N: 🤚🏼 [9468, 97, 248, 9468, 237, 120]

O: 🎅🏿 [9468, 236, 227, 9468, 237, 123]
N: 🎅🏿 [9468, 236, 227, 9468, 237, 123]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:10,  3.53s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:07<00:07,  3.90s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:11<00:03,  3.75s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  2.62s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  3.04s/it]
Processing depth (0, 2, 4, 9):   4%|▍         | 4/100 [01:25<28:54, 18.07s/it]2025-01-22 03:46:01.061 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the office.
2025-01-22 03:46:01.062 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 37) -->  journeyed to the office.
2025-01-22 03:46:01.062 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the bathroom.
2025-01-22 03:46:01.071 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1795, 1801) --> . Mary journeyed to the
2025-01-22 03:46:01.071 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary dropped the football.
2025-01-22 03:46:01.090 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3625, 3629) -->  Mary dropped the football
2025-01-22 03:46:01.090 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went back to the hallway.
2025-01-22 03:46:01.121 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6177, 6183) --> . Daniel went back to the
2025-01-22 03:46:01.121 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went back to the kitchen.
2025-01-22 03:46:01.152 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6177, 6183) --> . Daniel went back to the
2025-01-22 03:46:01.152 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra journeyed to the bedroom.
2025-01-22 03:46:01.159 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1402, 1408) --> . Sandra journeyed to the
2025-01-22 03:46:01.159 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the bedroom.
2025-01-22 03:46:01.190 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6216, 6222) --> . John went back to the
2025-01-22 03:46:01.190 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the office.
2025-01-22 03:46:01.190 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (31, 37) -->  journeyed to the office.
2025-01-22 03:46:01.190 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John took the milk.
2025-01-22 03:46:01.217 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5587, 5591) -->  John took the milk
2025-01-22 03:46:01.217 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John moved to the bedroom.
2025-01-22 03:46:01.243 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (5318, 5323) --> . John moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 03:46:02.013 | INFO     | test_jbb_embedding:begin_test:693 - the bedroom<|eot_id|>
2025-01-22 03:46:02.014 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8196])
2025-01-22 03:46:04.263 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [261.87357954545456, 29.773042967797025, 167.8153409090909, 28.58655056490237, 27.335260416666667], 'topk_indices': array([8094, 8183,    9, 3624, 8165,    3, 8190, 8184, 8179, 1408, 8195,
         23, 8084, 3628,    1,   24,   14, 8194,    0, 8191]), 'topk_tokens': [' location', ' football', ':', '.', ' return', '<|end_header_id|>', ':', ' before', ':', ' bedroom', '\n\n', '4', '.\n\n', ' football', '<|start_header_id|>', '\n\n', '\n', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [360.9791666666667, 223.85416666666666, 486.8125, 50.828125]}, 'weight': {'score': [21.417258522727273, 23.293890278116614, 20.781013257575758, 23.309143973351343, 30.144375], 'topk_indices': array([3264, 3291, 3184, 3136, 7417, 7455, 1493, 1431, 4276, 4292, 5112,
       5173, 7181, 7125, 3447, 3473, 4907, 4882, 4959, 4930]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.541666666666668, 20.052083333333332, 27.013671875, 20.927083333333332]}, 'saliency': {'score': [1.5010181773792615, 0.16693308807693188, 0.9199681137547349, 0.160277061082947, 0.20720418294270834], 'topk_indices': array([3626,   31, 8195,   20,   23, 4975, 8050, 1801, 8094, 8084, 8165,
       8178,   24, 8184, 8189, 8183, 8186, 1403, 1408, 3628]), 'topk_tokens': [' dropped', ' journey', '\n\n', ' Jul', '4', ' office', ' context', ' bathroom', ' location', '.\n\n', ' return', 'Question', '\n\n', ' before', 'Answer', ' football', ' bathroom', ' Sandra', ' bedroom', ' football'], 'evidence_proportions': [1.8190104166666667, 1.13330078125, 3.411376953125, 0.2771708170572917]}}, 'pred_res': 'the bedroom<|eot_id|>', 'score': 0}
2025-01-22 03:46:04.271 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 03:46:04.271 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-2_pid-4_0-2-4-9.pkl | len: 3 |  size: 2.03 KB
Processing depth (0, 2, 4, 9):   5%|▌         | 5/100 [01:28<28:00, 17.69s/it]Processing depth (0, 2, 4, 9):   5%|▌         | 5/100 [01:29<28:11, 17.81s/it]
2025-01-22 03:46:04.337 | INFO     | __main__:<module>:82 - Selected idx: 3
2025-01-22 03:46:04.337 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the location prior to the place where the apple was discarded, left or dropped?
2025-01-22 03:46:04.337 | INFO     | __main__:<module>:84 - Answer: office
2025-01-22 03:46:04.337 | INFO     | __main__:<module>:85 - Tag: 4-hop
2025-01-22 03:46:04.337 | INFO     | __main__:<module>:86 - Needle: [' Sandra journeyed to the bedroom.', ' Mary journeyed to the office.', ' John went back to the bedroom.', ' Mary picked up the apple.', ' John journeyed to the office.', ' Daniel went back to the kitchen.', ' John moved to the bedroom.', ' Mary journeyed to the bathroom.', ' John took the milk.', ' Mary dropped the apple.', ' Daniel went back to the hallway.']
2025-01-22 03:46:04.337 | INFO     | __main__:<module>:87 - Real Needle: [' Mary journeyed to the office.', ' Mary picked up the apple.', ' Mary journeyed to the bathroom.', ' Mary dropped the apple.', ' Daniel went back to the hallway.']
2025-01-22 03:46:04.337 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['🏫', '🍰', '👨🏿\u200d🏫', '🤦\u200d♀️', '👨🏽\u200d💻', '🏃🏾\u200d♀\u200d➡', '🐳', '👨🏼\u200d💼', '🛰️', '👩🏽\u200d❤️\u200d💋\u200d👨🏼']
emoji:
O: 🏫 [9468, 237, 104]
N: 🐳 [9468, 238, 111]

O: 🍰 [9468, 43002]
N: 🤦‍♀️ [9468, 97, 99, 102470, 32990, 31643]

O: 👨🏿‍🏫 [9468, 239, 101, 9468, 237, 123, 102470, 9468, 237, 104]
N: 🏃🏾‍♀‍➡ [9468, 237, 225, 9468, 237, 122, 102470, 32990, 102470, 98115, 94]

O: 🤦‍♀️ [9468, 97, 99, 102470, 32990, 31643]
N: 🏫 [9468, 237, 104]

O: 👨🏽‍💻 [9468, 239, 101, 9468, 237, 121, 102470, 93273, 119]
N: 👨🏼‍💼 [9468, 239, 101, 9468, 237, 120, 102470, 93273, 120]

O: 🏃🏾‍♀‍➡ [9468, 237, 225, 9468, 237, 122, 102470, 32990, 102470, 98115, 94]
N: 👨🏿‍🏫 [9468, 239, 101, 9468, 237, 123, 102470, 9468, 237, 104]

O: 🐳 [9468, 238, 111]
N: 🍰 [9468, 43002]

O: 👨🏼‍💼 [9468, 239, 101, 9468, 237, 120, 102470, 93273, 120]
N: 👨🏽‍💻 [9468, 239, 101, 9468, 237, 121, 102470, 93273, 119]

O: 🛰️ [9468, 120388, 31643]
N: 🛰️ [9468, 120388, 31643]

O: 👩🏽‍❤️‍💋‍👨🏼 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 120]
N: 👩🏽‍❤️‍💋‍👨🏼 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 120]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.71s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.93s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.50s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  2.91s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.56s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 1, 3, 5, 6):   0%|          | 0/100 [00:16<?, ?it/s]2025-01-22 03:46:20.556 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the office.
2025-01-22 03:46:20.557 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 37) -->  journeyed to the office.
2025-01-22 03:46:20.557 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary picked up the apple.
2025-01-22 03:46:20.561 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (909, 914) --> . Mary picked up the
2025-01-22 03:46:20.562 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bathroom.
2025-01-22 03:46:20.577 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2988, 2994) -->  Mary journeyed to the bathroom
2025-01-22 03:46:20.578 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary dropped the apple.
2025-01-22 03:46:20.598 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4242, 4246) -->  dropped the apple.
2025-01-22 03:46:20.598 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel went back to the hallway.
2025-01-22 03:46:20.613 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (2973, 2979) -->  tragedy. Daniel went back to
2025-01-22 03:46:20.613 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra journeyed to the bedroom.
2025-01-22 03:46:20.616 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (632, 638) --> . Sandra journeyed to the
2025-01-22 03:46:20.616 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the bedroom.
2025-01-22 03:46:20.644 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5619, 5625) --> . John went back to the
2025-01-22 03:46:20.644 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the office.
2025-01-22 03:46:20.644 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (31, 37) -->  journeyed to the office.
2025-01-22 03:46:20.644 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went back to the kitchen.
2025-01-22 03:46:20.659 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2973, 2979) -->  tragedy. Daniel went back to
2025-01-22 03:46:20.659 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John moved to the bedroom.
2025-01-22 03:46:20.694 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7116, 7121) --> . John moved to the
2025-01-22 03:46:20.694 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John took the milk.
2025-01-22 03:46:20.703 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (1784, 1788) -->  John took the milk
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 03:46:26.536 | INFO     | test_jbb_embedding:begin_test:693 - Mary picked up the apple.<|eot_id|>
2025-01-22 03:46:26.536 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8211])
2025-01-22 03:46:29.733 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [544.3518518518518, 55.10665636795324, 405.5899621212121, 52.06782779345026, 41.563229166666666], 'topk_indices': array([  32,  638, 8055,  936,  937, 8090,  968, 8198, 8190,   31,   39,
       8191,   35, 8100,   14,   24, 8056,    0, 8206, 8207]), 'topk_tokens': ['ed', ' bedroom', ' you', ' compos', 'itor', '.\n\n', ' compos', ' discarded', ' prior', ' journey', '***', ' to', ' office', ' location', '\n', '\n\n', ' context', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [1059.3333333333333, 516.8, 401.8125, 542.1875, 196.3125]}, 'weight': {'score': [22.77777777777778, 23.281955816997442, 21.660984848484848, 23.29018651110021, 29.580833333333334], 'topk_indices': array([3288, 3315, 3142, 3190, 7477, 7439, 1481, 1419, 4332, 4316, 5168,
       5229, 7216, 7160, 3497, 3471, 4944, 4919, 4967, 4996]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.541666666666668, 22.1, 24.79296875, 20.97265625, 25.766927083333332]}, 'saliency': {'score': [3.0832971643518516, 0.3075094005882442, 2.246193625710227, 0.2904699244382819, 0.303331298828125], 'topk_indices': array([8189, 8184,   40,  957, 2993,  633,  914,   24,    0,  937, 8100,
         35, 8190,  638,  936,   31,   39,  968, 8198, 8056]), 'topk_tokens': [' location', 'Question', '\n\n\n', ' trib', ' bathroom', ' Sandra', ' apple', '\n\n', '<|begin_of_text|>', 'itor', ' location', ' office', ' prior', ' bedroom', ' compos', ' journey', '***', ' compos', ' discarded', ' context'], 'evidence_proportions': [5.569010416666667, 2.8236328125, 2.7784830729166665, 2.989501953125, 1.1813151041666667]}}, 'pred_res': 'Mary picked up the apple.<|eot_id|>', 'score': 0}
2025-01-22 03:46:29.737 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 03:46:29.738 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-3_pid-0_0-1-3-5-6.pkl | len: 3 |  size: 2.11 KB
Processing depth (0, 1, 3, 5, 6):   1%|          | 1/100 [00:25<41:44, 25.30s/it]is_0k: False
your chose emoji: ['🚶🏻\u200d♂\u200d➡️', '🧍🏼\u200d♂️', '🖲️', '🧘🏾\u200d♀', '🤶', '🧑🏾\u200d🦼\u200d➡', '👩🏽\u200d✈', '🤹🏻\u200d♀️', '\U0001fae8', '⤴']
emoji:
O: 🚶🏻‍♂‍➡️ [9468, 248, 114, 9468, 237, 119, 102470, 17245, 224, 102470, 98115, 94, 31643]
N: 🤶 [9468, 97, 114]

O: 🧍🏼‍♂️ [9468, 100, 235, 9468, 237, 120, 102470, 17245, 224, 31643]
N: 🤹🏻‍♀️ [9468, 97, 117, 9468, 237, 119, 102470, 32990, 31643]

O: 🖲️ [9468, 244, 110, 31643]
N: 👩🏽‍✈ [9468, 239, 102, 9468, 237, 121, 102470, 38798, 230]

O: 🧘🏾‍♀ [9468, 100, 246, 9468, 237, 122, 102470, 32990]
N: 🚶🏻‍♂‍➡️ [9468, 248, 114, 9468, 237, 119, 102470, 17245, 224, 102470, 98115, 94, 31643]

O: 🤶 [9468, 97, 114]
N: 🖲️ [9468, 244, 110, 31643]

O: 🧑🏾‍🦼‍➡ [9468, 100, 239, 9468, 237, 122, 102470, 9468, 99, 120, 102470, 98115, 94]
N: 🧑🏾‍🦼‍➡ [9468, 100, 239, 9468, 237, 122, 102470, 9468, 99, 120, 102470, 98115, 94]

O: 👩🏽‍✈ [9468, 239, 102, 9468, 237, 121, 102470, 38798, 230]
N: 🧍🏼‍♂️ [9468, 100, 235, 9468, 237, 120, 102470, 17245, 224, 31643]

O: 🤹🏻‍♀️ [9468, 97, 117, 9468, 237, 119, 102470, 32990, 31643]
N: 🫨 [9468, 104, 101]

O: 🫨 [9468, 104, 101]
N: 🧘🏾‍♀ [9468, 100, 246, 9468, 237, 122, 102470, 32990]

O: ⤴ [158, 97, 112]
N: ⤴ [158, 97, 112]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.90s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:10,  5.02s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.98s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.41s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.98s/it]
Processing depth (3, 4, 5, 6, 8):   1%|          | 1/100 [00:42<41:44, 25.30s/it]2025-01-22 03:46:47.434 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the office.
2025-01-22 03:46:47.454 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2985, 2991) -->  tragedy. Mary journeyed to
2025-01-22 03:46:47.454 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary picked up the apple.
2025-01-22 03:46:47.473 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3640, 3645) -->  Mary picked up the apple
2025-01-22 03:46:47.473 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bathroom.
2025-01-22 03:46:47.487 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2985, 2991) -->  tragedy. Mary journeyed to
2025-01-22 03:46:47.488 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary dropped the apple.
2025-01-22 03:46:47.515 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4893, 4897) -->  Mary dropped the apple
2025-01-22 03:46:47.515 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel went back to the hallway.
2025-01-22 03:46:47.529 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (2921, 2927) --> . Daniel went back to the
2025-01-22 03:46:47.530 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra journeyed to the bedroom.
2025-01-22 03:46:47.533 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (625, 631) --> . Sandra journeyed to the
2025-01-22 03:46:47.533 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the bedroom.
2025-01-22 03:46:47.562 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5666, 5672) --> . John went back to the
2025-01-22 03:46:47.562 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the office.
2025-01-22 03:46:47.580 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2987, 2993) -->  Mary journeyed to the office
2025-01-22 03:46:47.580 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went back to the kitchen.
2025-01-22 03:46:47.594 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2921, 2927) --> . Daniel went back to the
2025-01-22 03:46:47.594 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John moved to the bedroom.
2025-01-22 03:46:47.628 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7090, 7095) --> . John moved to the
2025-01-22 03:46:47.628 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John took the milk.
2025-01-22 03:46:47.637 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (1727, 1731) -->  John took the milk
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 03:46:48.492 | INFO     | test_jbb_embedding:begin_test:693 - the doctor's office<|eot_id|>
2025-01-22 03:46:48.492 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8203])
2025-01-22 03:46:50.756 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [466.34722222222223, 52.78474253503961, 540.8797348484849, 49.43626841620626, 34.081728653169016], 'topk_indices': array([  24, 4263, 5670, 8176, 4545, 8177,   14, 6626, 5671, 2975, 6624,
       2992,  632, 6625, 6627, 8198, 6628, 5672, 8199,    0]), 'topk_tokens': ['\n\n', ' bathroom', ' to', 'Question', '�', ':', '\n', ' back', ' the', 'lyn', ' Daniel', ' office', '.', ' went', ' to', '<|eot_id|>', ' the', ' bedroom', '<|start_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [443.3020833333333, 500.75, 443.3020833333333, 448.125, 495.9166666666667]}, 'weight': {'score': [24.62326388888889, 23.273059491163924, 21.482007575757574, 23.27584023941068, 29.428036971830984], 'topk_indices': array([3296, 3269, 3141, 3189, 7447, 7485, 1406, 1468, 4285, 4269, 5196,
       5135, 7190, 7134, 3478, 3452, 4888, 4916, 4945, 4863]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [24.891927083333332, 26.7078125, 24.891927083333332, 26.755859375, 20.927083333333332]}, 'saliency': {'score': [2.8253038194444446, 0.2956345097311091, 3.0144912257339014, 0.2762332398734845, 0.2588092642770687], 'topk_indices': array([2956, 4545, 5667, 2947, 5669, 2946, 5668, 6622, 3644, 8182, 6626,
        631, 8190, 2992, 8176, 4263, 2975, 6625, 6624, 5672]), 'topk_tokens': [' tragedy', '�', ' John', 'ching', ' back', 'lyn', ' went', ' St', ' apple', ' prior', ' back', ' bedroom', ' discarded', ' office', 'Question', ' bathroom', 'lyn', ' went', ' Daniel', ' bedroom'], 'evidence_proportions': [2.517578125, 3.4693359375, 2.517578125, 3.030517578125, 2.7672526041666665]}}, 'pred_res': "the doctor's office<|eot_id|>", 'score': 100}
2025-01-22 03:46:50.763 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 03:46:50.764 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-3_pid-1_3-4-5-6-8.pkl | len: 3 |  size: 2.07 KB
Processing depth (3, 4, 5, 6, 8):   2%|▏         | 2/100 [00:46<37:12, 22.78s/it]is_0k: False
your chose emoji: ['🛀🏾', '🙅🏾', '🧙🏿\u200d♂', '👩🏼\u200d🤝\u200d👨🏾', '🌪️', '🍑', '👩🏿\u200d❤️\u200d👩🏻', '🎋', '🏎️', '👋']
emoji:
O: 🛀🏾 [9468, 249, 222, 9468, 237, 122]
N: 🧙🏿‍♂ [9468, 100, 247, 9468, 237, 123, 102470, 17245, 224]

O: 🙅🏾 [9468, 247, 227, 9468, 237, 122]
N: 🏎️ [9468, 237, 236, 31643]

O: 🧙🏿‍♂ [9468, 100, 247, 9468, 237, 123, 102470, 17245, 224]
N: 🍑 [9468, 235, 239]

O: 👩🏼‍🤝‍👨🏾 [9468, 239, 102, 9468, 237, 120, 102470, 9468, 97, 251, 102470, 9468, 239, 101, 9468, 237, 122]
N: 👩🏿‍❤️‍👩🏻 [9468, 239, 102, 9468, 237, 123, 102470, 121643, 31643, 102470, 9468, 239, 102, 9468, 237, 119]

O: 🌪️ [9468, 234, 103, 31643]
N: 🙅🏾 [9468, 247, 227, 9468, 237, 122]

O: 🍑 [9468, 235, 239]
N: 🌪️ [9468, 234, 103, 31643]

O: 👩🏿‍❤️‍👩🏻 [9468, 239, 102, 9468, 237, 123, 102470, 121643, 31643, 102470, 9468, 239, 102, 9468, 237, 119]
N: 🎋 [9468, 236, 233]

O: 🎋 [9468, 236, 233]
N: 🛀🏾 [9468, 249, 222, 9468, 237, 122]

O: 🏎️ [9468, 237, 236, 31643]
N: 👩🏼‍🤝‍👨🏾 [9468, 239, 102, 9468, 237, 120, 102470, 9468, 97, 251, 102470, 9468, 239, 101, 9468, 237, 122]

O: 👋 [9468, 239, 233]
N: 👋 [9468, 239, 233]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.01s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.45s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.14s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  2.68s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  3.25s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (2, 3, 4, 8, 9):   2%|▏         | 2/100 [01:00<37:12, 22.78s/it]2025-01-22 03:47:05.469 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the office.
2025-01-22 03:47:05.479 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1759, 1765) --> . Mary journeyed to the
2025-01-22 03:47:05.479 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary picked up the apple.
2025-01-22 03:47:05.495 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2851, 2856) --> . Mary picked up the
2025-01-22 03:47:05.495 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bathroom.
2025-01-22 03:47:05.506 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1759, 1765) --> . Mary journeyed to the
2025-01-22 03:47:05.506 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary dropped the apple.
2025-01-22 03:47:05.538 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6629, 6633) -->  Mary dropped the apple
2025-01-22 03:47:05.539 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel went back to the hallway.
2025-01-22 03:47:05.552 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (2730, 2736) --> . Daniel went back to the
2025-01-22 03:47:05.552 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra journeyed to the bedroom.
2025-01-22 03:47:05.555 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (605, 611) --> . Sandra journeyed to the
2025-01-22 03:47:05.556 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the bedroom.
2025-01-22 03:47:05.587 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5749, 5755) --> . John went back to the
2025-01-22 03:47:05.587 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the office.
2025-01-22 03:47:05.597 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1760, 1766) -->  Mary journeyed to the office
2025-01-22 03:47:05.597 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went back to the kitchen.
2025-01-22 03:47:05.612 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2730, 2736) --> . Daniel went back to the
2025-01-22 03:47:05.612 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John moved to the bedroom.
2025-01-22 03:47:05.652 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7099, 7104) --> . John moved to the
2025-01-22 03:47:05.652 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John took the milk.
2025-01-22 03:47:05.659 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (1556, 1560) -->  took the milk.
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 03:47:11.397 | INFO     | test_jbb_embedding:begin_test:693 - Mary picked up the apple.<|eot_id|>
2025-01-22 03:47:11.397 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8203])
2025-01-22 03:47:14.378 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [481.0833333333333, 54.3131703229738, 288.90435606060606, 51.9480010742787, 58.050286091549296], 'topk_indices': array([8186, 8188, 8176, 8167, 8082, 6633, 8190, 6631, 8177, 8183,   24,
         14, 8182, 8048, 8092, 6630, 6632, 8198, 8199,    0]), 'topk_tokens': [' where', ' apple', 'Question', '.', '.\n\n', '.', ' discarded', ' the', ':', ' to', '\n\n', '\n', ' prior', ' context', ' location', ' dropped', ' apple', '<|eot_id|>', '<|start_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [389.125, 356.25, 389.125, 1240.5, 262.75]}, 'weight': {'score': [21.61892361111111, 23.27867154174284, 20.897017045454547, 23.293822897483118, 29.752200704225352], 'topk_indices': array([3336, 3309, 3229, 3181, 7447, 7485, 1438, 1500, 4325, 4341, 5197,
       5136, 7224, 7168, 3518, 3492, 4990, 4913, 4938, 4961]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.052083333333332, 22.1, 20.052083333333332, 26.755859375, 20.927083333333332]}, 'saliency': {'score': [2.822283709490741, 0.3071255141681901, 1.6122565991950757, 0.29350014927198437, 0.4346218915052817], 'topk_indices': array([8178, 8091, 8185, 2856,   24, 1187, 8181, 8163, 8186,  611, 6629,
       8196, 8188, 8176, 8092, 8048, 8182, 6630, 8190, 6632]), 'topk_tokens': [' Where', ' first', ' place', ' apple', '\n\n', 'nes', ' location', ' return', ' where', ' bedroom', ' Mary', 'Answer', ' apple', 'Question', ' location', ' context', ' prior', ' dropped', ' discarded', ' apple'], 'evidence_proportions': [2.0380859375, 1.9376953125, 2.0380859375, 8.25537109375, 1.5057779947916667]}}, 'pred_res': 'Mary picked up the apple.<|eot_id|>', 'score': 0}
2025-01-22 03:47:14.384 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 03:47:14.384 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-3_pid-2_2-3-4-8-9.pkl | len: 3 |  size: 2.09 KB
Processing depth (2, 3, 4, 8, 9):   3%|▎         | 3/100 [01:09<37:27, 23.17s/it]is_0k: False
your chose emoji: ['🏃\u200d♀\u200d➡', '👩🏻\u200d🍼', '🤵🏾\u200d♀', '💁🏿\u200d♂️', '🦶🏽', '🧔\u200d♂️', '🏟', '👨🏿\u200d❤\u200d👨🏽', 'Ⓜ', '🧼']
emoji:
O: 🏃‍♀‍➡ [9468, 237, 225, 102470, 32990, 102470, 98115, 94]
N: 🤵🏾‍♀ [9468, 97, 113, 9468, 237, 122, 102470, 32990]

O: 👩🏻‍🍼 [9468, 239, 102, 9468, 237, 119, 102470, 9468, 104247]
N: 🏃‍♀‍➡ [9468, 237, 225, 102470, 32990, 102470, 98115, 94]

O: 🤵🏾‍♀ [9468, 97, 113, 9468, 237, 122, 102470, 32990]
N: 🧔‍♂️ [9468, 100, 242, 102470, 17245, 224, 31643]

O: 💁🏿‍♂️ [93273, 223, 9468, 237, 123, 102470, 17245, 224, 31643]
N: 🏟 [9468, 237, 253]

O: 🦶🏽 [9468, 99, 114, 9468, 237, 121]
N: 👨🏿‍❤‍👨🏽 [9468, 239, 101, 9468, 237, 123, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 121]

O: 🧔‍♂️ [9468, 100, 242, 102470, 17245, 224, 31643]
N: 🦶🏽 [9468, 99, 114, 9468, 237, 121]

O: 🏟 [9468, 237, 253]
N: Ⓜ [158, 241, 224]

O: 👨🏿‍❤‍👨🏽 [9468, 239, 101, 9468, 237, 123, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 121]
N: 💁🏿‍♂️ [93273, 223, 9468, 237, 123, 102470, 17245, 224, 31643]

O: Ⓜ [158, 241, 224]
N: 👩🏻‍🍼 [9468, 239, 102, 9468, 237, 119, 102470, 9468, 104247]

O: 🧼 [9468, 100, 120]
N: 🧼 [9468, 100, 120]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.57s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.75s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.58s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.09s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.66s/it]
Processing depth (2, 5, 7, 8, 9):   3%|▎         | 3/100 [01:26<37:27, 23.17s/it]2025-01-22 03:47:30.706 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the office.
2025-01-22 03:47:30.715 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1618, 1624) -->  Mary journeyed to the office
2025-01-22 03:47:30.715 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary picked up the apple.
2025-01-22 03:47:30.735 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4147, 4152) --> . Mary picked up the
2025-01-22 03:47:30.735 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bathroom.
2025-01-22 03:47:30.744 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1619, 1625) -->  journeyed to the office.
2025-01-22 03:47:30.744 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary dropped the apple.
2025-01-22 03:47:30.776 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6579, 6583) -->  Mary dropped the apple
2025-01-22 03:47:30.776 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel went back to the hallway.
2025-01-22 03:47:30.789 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (2616, 2622) --> . Daniel went back to the
2025-01-22 03:47:30.789 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra journeyed to the bedroom.
2025-01-22 03:47:30.795 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (393, 399) --> . Sandra journeyed to the
2025-01-22 03:47:30.796 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the bedroom.
2025-01-22 03:47:30.824 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5625, 5631) -->  the bathroom. John went back
2025-01-22 03:47:30.824 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the office.
2025-01-22 03:47:30.832 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1619, 1625) -->  journeyed to the office.
2025-01-22 03:47:30.832 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went back to the kitchen.
2025-01-22 03:47:30.845 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2616, 2622) --> . Daniel went back to the
2025-01-22 03:47:30.845 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John moved to the bedroom.
2025-01-22 03:47:30.880 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7115, 7120) --> . John moved to the
2025-01-22 03:47:30.880 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John took the milk.
2025-01-22 03:47:30.888 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (1553, 1557) -->  John took the milk
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 03:47:31.793 | INFO     | test_jbb_embedding:begin_test:693 - Mary picked up the apple.<|eot_id|>
2025-01-22 03:47:31.793 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8267])
2025-01-22 03:47:34.044 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [332.625, 38.572975873745314, 257.969696969697, 36.72384730174199, 30.417779126213592], 'topk_indices': array([8254, 8231, 6582, 8259, 6583,   23,    9, 5626, 8146, 8265, 8240,
       1199, 8241,   14,   24, 8246, 8247, 8262, 8263,    0]), 'topk_tokens': [' discarded', '.', ' apple', '?\n', '.', '4', ':', ' bathroom', '.\n\n', '<|end_header_id|>', 'Question', 'nes', ':', '\n', '\n\n', ' prior', ' to', '<|eot_id|>', '<|start_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [354.3541666666667, 283.65, 368.0625, 484.0, 215.35416666666666]}, 'weight': {'score': [22.24884259259259, 23.33542447696215, 21.516335227272727, 23.346311022962603, 30.01926577669903], 'topk_indices': array([3394, 3367, 3239, 3287, 7517, 7479, 1450, 1512, 4380, 4364, 5195,
       5256, 7200, 7256, 3550, 3576, 5020, 4997, 4972, 5049]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [23.397135416666668, 22.1, 19.541666666666668, 26.755859375, 20.927083333333332]}, 'saliency': {'score': [1.9618145978009258, 0.21620643791948846, 1.5087002840909092, 0.20526920838599402, 0.22821726382357402], 'topk_indices': array([2617, 8247, 8250, 1239, 8249,   24,    0, 4152, 8112, 8156, 1179,
       8252, 8260, 6582,  399, 8254, 1199, 5626, 8240, 8246]), 'topk_tokens': [' Daniel', ' to', ' where', 'nes', ' place', '\n\n', '<|begin_of_text|>', ' apple', ' context', ' location', 'nes', ' apple', 'Answer', ' apple', ' bedroom', ' discarded', 'nes', ' bathroom', 'Question', ' prior'], 'evidence_proportions': [2.1551106770833335, 1.5986328125, 1.9134928385416667, 3.19970703125, 1.2942301432291667]}}, 'pred_res': 'Mary picked up the apple.<|eot_id|>', 'score': 0}
2025-01-22 03:47:34.056 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 03:47:34.056 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-3_pid-3_2-5-7-8-9.pkl | len: 3 |  size: 2.08 KB
Processing depth (2, 5, 7, 8, 9):   4%|▍         | 4/100 [01:29<34:51, 21.79s/it]is_0k: False
your chose emoji: ['🧚🏽\u200d♂️', '\U0001fae4', '👨🏼\u200d✈', '🚶🏽', '🤷🏾\u200d♀️', '🧔🏾\u200d♂️', '💁🏼\u200d♂', '🤽🏾\u200d♂️', '👩🏼\u200d❤️\u200d💋\u200d👩🏼', '👩🏾\u200d❤️\u200d💋\u200d👩🏿']
emoji:
O: 🧚🏽‍♂️ [9468, 100, 248, 9468, 237, 121, 102470, 17245, 224, 31643]
N: 🧔🏾‍♂️ [9468, 100, 242, 9468, 237, 122, 102470, 17245, 224, 31643]

O: 🫤 [9468, 104, 97]
N: 🤷🏾‍♀️ [9468, 97, 115, 9468, 237, 122, 102470, 32990, 31643]

O: 👨🏼‍✈ [9468, 239, 101, 9468, 237, 120, 102470, 38798, 230]
N: 🫤 [9468, 104, 97]

O: 🚶🏽 [9468, 248, 114, 9468, 237, 121]
N: 👨🏼‍✈ [9468, 239, 101, 9468, 237, 120, 102470, 38798, 230]

O: 🤷🏾‍♀️ [9468, 97, 115, 9468, 237, 122, 102470, 32990, 31643]
N: 👩🏼‍❤️‍💋‍👩🏼 [9468, 239, 102, 9468, 237, 120, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 120]

O: 🧔🏾‍♂️ [9468, 100, 242, 9468, 237, 122, 102470, 17245, 224, 31643]
N: 💁🏼‍♂ [93273, 223, 9468, 237, 120, 102470, 17245, 224]

O: 💁🏼‍♂ [93273, 223, 9468, 237, 120, 102470, 17245, 224]
N: 🚶🏽 [9468, 248, 114, 9468, 237, 121]

O: 🤽🏾‍♂️ [9468, 97, 121, 9468, 237, 122, 102470, 17245, 224, 31643]
N: 🧚🏽‍♂️ [9468, 100, 248, 9468, 237, 121, 102470, 17245, 224, 31643]

O: 👩🏼‍❤️‍💋‍👩🏼 [9468, 239, 102, 9468, 237, 120, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 120]
N: 🤽🏾‍♂️ [9468, 97, 121, 9468, 237, 122, 102470, 17245, 224, 31643]

O: 👩🏾‍❤️‍💋‍👩🏿 [9468, 239, 102, 9468, 237, 122, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 123]
N: 👩🏾‍❤️‍💋‍👩🏿 [9468, 239, 102, 9468, 237, 122, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 123]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.59s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.89s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.79s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.10s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.72s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 1, 7, 8, 9):   4%|▍         | 4/100 [01:46<34:51, 21.79s/it]2025-01-22 03:47:50.717 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the office.
2025-01-22 03:47:50.717 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 37) -->  journeyed to the office.
2025-01-22 03:47:50.718 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary picked up the apple.
2025-01-22 03:47:50.722 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (790, 795) -->  Mary picked up the apple
2025-01-22 03:47:50.722 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bathroom.
2025-01-22 03:47:50.751 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5616, 5622) --> . Mary journeyed to the
2025-01-22 03:47:50.751 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary dropped the apple.
2025-01-22 03:47:50.788 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6623, 6627) -->  Mary dropped the apple
2025-01-22 03:47:50.789 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel went back to the hallway.
2025-01-22 03:47:50.802 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (2744, 2750) --> . Daniel went back to the
2025-01-22 03:47:50.803 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra journeyed to the bedroom.
2025-01-22 03:47:50.806 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (614, 620) --> . Sandra journeyed to the
2025-01-22 03:47:50.806 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the bedroom.
2025-01-22 03:47:50.835 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5621, 5627) -->  the bathroom. John went back
2025-01-22 03:47:50.835 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the office.
2025-01-22 03:47:50.835 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (31, 37) -->  journeyed to the office.
2025-01-22 03:47:50.835 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went back to the kitchen.
2025-01-22 03:47:50.852 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2744, 2750) --> . Daniel went back to the
2025-01-22 03:47:50.852 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John moved to the bedroom.
2025-01-22 03:47:50.888 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7108, 7113) -->  John moved to the bedroom
2025-01-22 03:47:50.888 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John took the milk.
2025-01-22 03:47:50.896 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (1572, 1576) -->  John took the milk
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 03:47:55.018 | INFO     | test_jbb_embedding:begin_test:693 - Mary picked up the apple.<|eot_id|>
2025-01-22 03:47:55.018 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8181])
2025-01-22 03:47:57.693 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [720.5092592592592, 68.25053464499572, 465.0719696969697, 64.4703927120522, 100.119921875], 'topk_indices': array([6623, 8026, 8155, 8160, 6622, 8166, 8060, 8070,  786, 8161, 6626,
       8168,   31, 6624,   14,   24, 6627, 8177, 8176,    0]), 'topk_tokens': [' Mary', ' context', ':', ' prior', '.', ' apple', '.\n\n', ' location', '�', ' to', ' apple', ' discarded', ' journey', ' dropped', '\n', '\n\n', '.', '<|start_header_id|>', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [1048.0833333333333, 796.3, 277.8333333333333, 1610.0, 179.45833333333334]}, 'weight': {'score': [22.358796296296298, 23.252270331785407, 22.338541666666668, 23.25895220361935, 29.13125], 'topk_indices': array([3344, 3317, 3189, 3237, 7405, 7443, 1531, 1469, 4324, 4340, 5202,
       5141, 7119, 7175, 3526, 3500, 4918, 4995, 4966, 4943]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.541666666666668, 26.7078125, 20.052083333333332, 26.755859375, 20.927083333333332]}, 'saliency': {'score': [4.419560185185185, 0.3850108396886075, 2.699092980587121, 0.3621993731149206, 0.729901123046875], 'topk_indices': array([  24,   30, 8164, 5443,  786,    0,  784, 8174, 8154,  615, 8070,
       8026,  620, 6623, 8160, 6624, 8166, 6626,   31, 8168]), 'topk_tokens': ['\n\n', 'Mary', ' where', ' office', '�', '<|begin_of_text|>', '�', 'Answer', 'Question', ' Sandra', ' location', ' context', ' bedroom', ' Mary', ' prior', ' dropped', ' apple', ' apple', ' journey', ' discarded'], 'evidence_proportions': [5.73583984375, 5.43671875, 1.4112955729166667, 10.8486328125, 0.9778645833333334]}}, 'pred_res': 'Mary picked up the apple.<|eot_id|>', 'score': 0}
2025-01-22 03:47:57.698 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 03:47:57.699 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-3_pid-4_0-1-7-8-9.pkl | len: 3 |  size: 2.09 KB
Processing depth (0, 1, 7, 8, 9):   5%|▌         | 5/100 [01:53<35:33, 22.46s/it]Processing depth (0, 1, 7, 8, 9):   5%|▌         | 5/100 [01:53<35:53, 22.66s/it]
2025-01-22 03:47:57.761 | INFO     | __main__:<module>:82 - Selected idx: 4
2025-01-22 03:47:57.761 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the apple before the garden? 
2025-01-22 03:47:57.761 | INFO     | __main__:<module>:84 - Answer: bathroom
2025-01-22 03:47:57.761 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 03:47:57.761 | INFO     | __main__:<module>:86 - Needle: [' Mary got the football there.', ' Daniel journeyed to the bathroom.', ' Mary moved to the bathroom.', ' John went back to the bedroom.', ' Daniel went to the garden.', ' Sandra journeyed to the bedroom.', ' Daniel left the apple.', ' Mary journeyed to the office.']
2025-01-22 03:47:57.761 | INFO     | __main__:<module>:87 - Real Needle: [' Daniel journeyed to the bathroom.', ' Daniel went to the garden.', ' Daniel left the apple.', ' Mary journeyed to the office.']
2025-01-22 03:47:57.762 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['🍐', '✊🏿', '\U0001faf1🏻\u200d\U0001faf2🏿', '🙆🏻\u200d♂', '🚋', '🤶', '👼🏾', '💪🏽', '🙅🏻\u200d♀', '✋🏻']
emoji:
O: 🍐 [9468, 235, 238]
N: 🙆🏻‍♂ [9468, 247, 228, 9468, 237, 119, 102470, 17245, 224]

O: ✊🏿 [38798, 232, 9468, 237, 123]
N: 🍐 [9468, 235, 238]

O: 🫱🏻‍🫲🏿 [9468, 104, 109, 9468, 237, 119, 102470, 9468, 104, 110, 9468, 237, 123]
N: 🫱🏻‍🫲🏿 [9468, 104, 109, 9468, 237, 119, 102470, 9468, 104, 110, 9468, 237, 123]

O: 🙆🏻‍♂ [9468, 247, 228, 9468, 237, 119, 102470, 17245, 224]
N: ✊🏿 [38798, 232, 9468, 237, 123]

O: 🚋 [9468, 248, 233]
N: 🙅🏻‍♀ [9468, 247, 227, 9468, 237, 119, 102470, 32990]

O: 🤶 [9468, 97, 114]
N: 👼🏾 [9468, 239, 120, 9468, 237, 122]

O: 👼🏾 [9468, 239, 120, 9468, 237, 122]
N: 🤶 [9468, 97, 114]

O: 💪🏽 [93273, 103, 9468, 237, 121]
N: 🚋 [9468, 248, 233]

O: 🙅🏻‍♀ [9468, 247, 227, 9468, 237, 119, 102470, 32990]
N: 💪🏽 [93273, 103, 9468, 237, 121]

O: ✋🏻 [38798, 233, 9468, 237, 119]
N: ✋🏻 [38798, 233, 9468, 237, 119]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.14s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.90s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.93s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.44s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.93s/it]
Processing depth (0, 3, 5, 7):   0%|          | 0/100 [00:17<?, ?it/s]2025-01-22 03:48:15.225 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel journeyed to the bathroom.
2025-01-22 03:48:15.225 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 37) -->  journeyed to the bathroom.
2025-01-22 03:48:15.225 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the garden.
2025-01-22 03:48:15.241 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2834, 2839) --> . Daniel went to the
2025-01-22 03:48:15.241 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel left the apple.
2025-01-22 03:48:15.263 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4215, 4219) -->  left the apple.
2025-01-22 03:48:15.264 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary journeyed to the office.
2025-01-22 03:48:15.295 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5726, 5732) --> . Mary journeyed to the
2025-01-22 03:48:15.295 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the football there.
2025-01-22 03:48:15.299 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (658, 663) --> . Mary got the football
2025-01-22 03:48:15.299 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary moved to the bathroom.
2025-01-22 03:48:15.322 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3809, 3814) --> . Mary moved to the
2025-01-22 03:48:15.323 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the bedroom.
2025-01-22 03:48:15.344 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3608, 3614) --> . John went back to the
2025-01-22 03:48:15.345 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra journeyed to the bedroom.
2025-01-22 03:48:15.379 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6420, 6426) -->  Sandra journeyed to the bedroom
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 03:48:16.195 | INFO     | test_jbb_embedding:begin_test:693 - The bedroom.<|eot_id|>
2025-01-22 03:48:16.195 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8172])
2025-01-22 03:48:18.433 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [167.33184523809524, 18.93235282874618, 109.75852272727273, 18.3034097546729, 9.060867745535715], 'topk_indices': array([8145,    4, 8155, 8070, 8159, 8153,    9, 8166, 8160, 7923, 8060,
          1,   24, 3814, 3614,   14, 8170,    0, 8167, 8168]), 'topk_tokens': ['.', '\n\n', ':', ' location', ' apple', '.\n\n', ':', ':', ' before', ' Square', '.\n\n', '<|start_header_id|>', '\n\n', ' bathroom', ' bedroom', '\n', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [209.61458333333334, 141.675, 264.5625, 81.609375]}, 'weight': {'score': [20.283482142857142, 23.27206995412844, 22.234730113636363, 23.282594034370387, 29.246875], 'topk_indices': array([3319, 3292, 3212, 3164, 7391, 7429, 1500, 1438, 4305, 4289, 5181,
       5120, 7168, 7112, 3475, 3501, 4925, 4902, 4877, 4954]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.9375, 19.665625, 20.421875, 20.052083333333332]}, 'saliency': {'score': [0.9270193917410714, 0.10462562117737004, 0.6219593394886364, 0.10110230452898272, 0.06597813197544643], 'topk_indices': array([8153,   14,   35,  192, 8141, 8144,    8, 8060,   24, 8165, 8162,
       3958, 8070, 8154, 8160, 4217, 8159, 7923, 3814, 3614]), 'topk_tokens': ['.\n\n', '\n', ' bathroom', 'ION', ' return', ' directly', ' Date', '.\n\n', '\n\n', 'Answer', ' garden', 'burn', ' location', 'Question', ' before', ' apple', ' apple', ' Square', ' bathroom', ' bedroom'], 'evidence_proportions': [1.1833902994791667, 0.7899169921875, 1.473388671875, 0.420654296875]}}, 'pred_res': 'The bedroom.<|eot_id|>', 'score': 0}
2025-01-22 03:48:18.438 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 03:48:18.438 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-4_pid-0_0-3-5-7.pkl | len: 3 |  size: 2.02 KB
Processing depth (0, 3, 5, 7):   1%|          | 1/100 [00:20<33:58, 20.59s/it]is_0k: False
your chose emoji: ['🤔', '👩🏾\u200d🦼', '👮\u200d♀️', '👩🏾\u200d🎤', '👩🏾\u200d🦯\u200d➡️', '🏄🏽\u200d♀', '🩸', '\U0001facf', '🧑🏽\u200d🎄', '🕡']
emoji:
O: 🤔 [9468, 97, 242]
N: 🤔 [9468, 97, 242]

O: 👩🏾‍🦼 [9468, 239, 102, 9468, 237, 122, 102470, 9468, 99, 120]
N: 🧑🏽‍🎄 [9468, 100, 239, 9468, 237, 121, 102470, 9468, 236, 226]

O: 👮‍♀️ [9468, 239, 106, 102470, 32990, 31643]
N: 🏄🏽‍♀ [9468, 237, 226, 9468, 237, 121, 102470, 32990]

O: 👩🏾‍🎤 [9468, 239, 102, 9468, 237, 122, 102470, 9468, 236, 97]
N: 🫏 [9468, 104, 237]

O: 👩🏾‍🦯‍➡️ [9468, 239, 102, 9468, 237, 122, 102470, 9468, 99, 107, 102470, 98115, 94, 31643]
N: 👩🏾‍🦼 [9468, 239, 102, 9468, 237, 122, 102470, 9468, 99, 120]

O: 🏄🏽‍♀ [9468, 237, 226, 9468, 237, 121, 102470, 32990]
N: 👮‍♀️ [9468, 239, 106, 102470, 32990, 31643]

O: 🩸 [9468, 102, 116]
N: 👩🏾‍🎤 [9468, 239, 102, 9468, 237, 122, 102470, 9468, 236, 97]

O: 🫏 [9468, 104, 237]
N: 👩🏾‍🦯‍➡️ [9468, 239, 102, 9468, 237, 122, 102470, 9468, 99, 107, 102470, 98115, 94, 31643]

O: 🧑🏽‍🎄 [9468, 100, 239, 9468, 237, 121, 102470, 9468, 236, 226]
N: 🩸 [9468, 102, 116]

O: 🕡 [9468, 243, 94]
N: 🕡 [9468, 243, 94]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:11,  3.77s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.29s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.36s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.02s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.46s/it]
Processing depth (0, 1, 2, 5):   1%|          | 1/100 [00:36<33:58, 20.59s/it]2025-01-22 03:48:34.166 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel journeyed to the bathroom.
2025-01-22 03:48:34.167 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 37) -->  journeyed to the bathroom.
2025-01-22 03:48:34.167 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the garden.
2025-01-22 03:48:34.171 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (908, 913) --> . Daniel went to the
2025-01-22 03:48:34.172 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel left the apple.
2025-01-22 03:48:34.180 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1820, 1824) -->  left the apple.
2025-01-22 03:48:34.180 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary journeyed to the office.
2025-01-22 03:48:34.204 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4219, 4225) -->  Mary journeyed to the office
2025-01-22 03:48:34.204 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the football there.
2025-01-22 03:48:34.208 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (816, 821) --> . Mary got the football
2025-01-22 03:48:34.208 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary moved to the bathroom.
2025-01-22 03:48:34.229 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3834, 3839) --> . Mary moved to the
2025-01-22 03:48:34.229 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the bedroom.
2025-01-22 03:48:34.249 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3630, 3636) -->  Hon. John went back to
2025-01-22 03:48:34.249 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra journeyed to the bedroom.
2025-01-22 03:48:34.282 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6425, 6431) --> . Sandra journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 03:48:35.072 | INFO     | test_jbb_embedding:begin_test:693 - The bedroom.<|eot_id|>
2025-01-22 03:48:35.073 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8190])
2025-01-22 03:48:37.304 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [290.2247023809524, 24.22616105211766, 122.59517045454545, 23.275230061349692, 15.436387460443038], 'topk_indices': array([ 541,  453, 8188,  432,  543,  537,  545,  548, 8185,  454,   35,
        547,  540,  431, 8186,  549,  542,  425,    0,  426]), 'topk_tokens': ['000', 's', '<|end_header_id|>', ' per', ' ', ' setting', ',', 's', '<|eot_id|>', ' per', ' bathroom', ' em', ',', 's', '<|start_header_id|>', ' per', ' to', ' to', '<|begin_of_text|>', ' '], 'evidence_proportions': [575.25, 196.0, 357.65625, 38.765625]}, 'weight': {'score': [21.23921130952381, 23.29355471133895, 22.094105113636363, 23.302085889570552, 29.680181962025316], 'topk_indices': array([3320, 3293, 3213, 3165, 7455, 7417, 1510, 1448, 4312, 4296, 5147,
       5208, 7194, 7138, 3476, 3502, 5001, 4924, 4972, 4949]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.9375, 19.665625, 20.421875, 23.397135416666668]}, 'saliency': {'score': [1.6580403645833333, 0.13205802709820882, 0.7143110795454546, 0.12655432203796013, 0.11635705489146558], 'topk_indices': array([8177,  820,  548, 8088,  424,  452,   31,  433,  430,  541,  432,
        431,  426,  537,  454,  547,  425,  542,   35,  549]), 'topk_tokens': [' apple', ' football', 's', ' location', '000', ' em', ' journey', ' hour', ' em', '000', ' per', 's', ' ', ' setting', ' per', ' em', ' to', ' to', ' bathroom', ' per'], 'evidence_proportions': [3.48583984375, 0.98720703125, 1.899658203125, 0.22819010416666666]}}, 'pred_res': 'The bedroom.<|eot_id|>', 'score': 0}
2025-01-22 03:48:37.311 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 03:48:37.311 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-4_pid-1_0-1-2-5.pkl | len: 3 |  size: 1.95 KB
Processing depth (0, 1, 2, 5):   2%|▏         | 2/100 [00:39<31:58, 19.58s/it]is_0k: False
your chose emoji: ['🏃🏽\u200d♂️\u200d➡', '🖱️', '😚', '🆖', '🧑🏻\u200d🦽', '🧑🏼\u200d🔬', '👯\u200d♂', '🧘🏿\u200d♂️', '👨\u200d👨\u200d👧\u200d👦', '🙍\u200d♀️']
emoji:
O: 🏃🏽‍♂️‍➡ [9468, 237, 225, 9468, 237, 121, 102470, 17245, 224, 31643, 102470, 98115, 94]
N: 👨‍👨‍👧‍👦 [9468, 239, 101, 102470, 9468, 239, 101, 102470, 9468, 239, 100, 102470, 9468, 239, 99]

O: 🖱️ [9468, 244, 109, 31643]
N: 🆖 [9468, 228, 244]

O: 😚 [76460, 248]
N: 🖱️ [9468, 244, 109, 31643]

O: 🆖 [9468, 228, 244]
N: 😚 [76460, 248]

O: 🧑🏻‍🦽 [9468, 100, 239, 9468, 237, 119, 102470, 9468, 99, 121]
N: 🧘🏿‍♂️ [9468, 100, 246, 9468, 237, 123, 102470, 17245, 224, 31643]

O: 🧑🏼‍🔬 [9468, 100, 239, 9468, 237, 120, 102470, 9468, 242, 105]
N: 🧑🏻‍🦽 [9468, 100, 239, 9468, 237, 119, 102470, 9468, 99, 121]

O: 👯‍♂ [9468, 239, 107, 102470, 17245, 224]
N: 🏃🏽‍♂️‍➡ [9468, 237, 225, 9468, 237, 121, 102470, 17245, 224, 31643, 102470, 98115, 94]

O: 🧘🏿‍♂️ [9468, 100, 246, 9468, 237, 123, 102470, 17245, 224, 31643]
N: 👯‍♂ [9468, 239, 107, 102470, 17245, 224]

O: 👨‍👨‍👧‍👦 [9468, 239, 101, 102470, 9468, 239, 101, 102470, 9468, 239, 100, 102470, 9468, 239, 99]
N: 🧑🏼‍🔬 [9468, 100, 239, 9468, 237, 120, 102470, 9468, 242, 105]

O: 🙍‍♀️ [9468, 247, 235, 102470, 32990, 31643]
N: 🙍‍♀️ [9468, 247, 235, 102470, 32990, 31643]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.61s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.62s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.24s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.75s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.37s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (1, 3, 4, 6):   2%|▏         | 2/100 [00:54<31:58, 19.58s/it]2025-01-22 03:48:52.593 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel journeyed to the bathroom.
2025-01-22 03:48:52.597 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (688, 694) -->  Daniel journeyed to the bathroom
2025-01-22 03:48:52.597 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the garden.
2025-01-22 03:48:52.612 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2862, 2867) --> . Daniel went to the
2025-01-22 03:48:52.612 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel left the apple.
2025-01-22 03:48:52.632 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3605, 3609) -->  Daniel left the apple
2025-01-22 03:48:52.632 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary journeyed to the office.
2025-01-22 03:48:52.659 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4692, 4698) --> . Mary journeyed to the
2025-01-22 03:48:52.659 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the football there.
2025-01-22 03:48:52.662 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (647, 652) --> . Mary got the football
2025-01-22 03:48:52.662 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary moved to the bathroom.
2025-01-22 03:48:52.682 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3733, 3738) -->  Mary moved to the bathroom
2025-01-22 03:48:52.682 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the bedroom.
2025-01-22 03:48:52.701 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3608, 3614) -->  apple. John went back to
2025-01-22 03:48:52.701 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra journeyed to the bedroom.
2025-01-22 03:48:52.735 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6365, 6371) --> . Sandra journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 03:48:56.251 | INFO     | test_jbb_embedding:begin_test:693 - The bedroom.<|eot_id|>
2025-01-22 03:48:56.251 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8198])
2025-01-22 03:48:59.125 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [149.92782738095238, 14.34533707779539, 134.1818181818182, 13.673158249570973, 26.269601844879517], 'topk_indices': array([8186, 8179, 8188, 8197,    9, 8185,  693, 3608,   23, 8096,   28,
         14,    1, 7951,   24, 3615,    0, 8193, 8196, 8194]), 'topk_tokens': [' before', '.\n\n', ' garden', '\n\n', ':', ' apple', ' bathroom', ' apple', '4', ' location', '<|end_header_id|>', '\n', '<|start_header_id|>', ' Square', '\n\n', ' bedroom', '<|begin_of_text|>', '<|eot_id|>', '<|end_header_id|>', '<|start_header_id|>'], 'evidence_proportions': [195.66666666666666, 126.55, 269.5625, 43.9140625]}, 'weight': {'score': [22.611607142857142, 23.293815159736617, 23.266335227272727, 23.295645378769308, 29.392507530120483], 'topk_indices': array([3347, 3320, 3192, 3240, 7491, 7453, 1530, 1468, 4379, 4395, 5258,
       5197, 7174, 7230, 3549, 3523, 4974, 4999, 5022, 5051]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [25.01171875, 19.665625, 26.533203125, 20.052083333333332]}, 'saliency': {'score': [0.9856422061011905, 0.0800765844223456, 0.8269944624467329, 0.07573127045179004, 0.19076188788356552], 'topk_indices': array([3605, 2867, 8191,   20, 8170,   23, 7950, 8186, 3734, 8180, 8167,
       3737, 8188,   24, 8185, 8096, 3608,  693, 7951, 3615]), 'topk_tokens': [' Daniel', ' garden', 'Answer', ' Jul', ' directly', '4', 'Bridge', ' before', ' moved', 'Question', ' return', ' bathroom', ' garden', '\n\n', ' apple', ' location', ' apple', ' bathroom', ' Square', ' bedroom'], 'evidence_proportions': [1.4021402994791667, 0.673876953125, 1.8829345703125, 0.23075358072916666]}}, 'pred_res': 'The bedroom.<|eot_id|>', 'score': 0}
2025-01-22 03:48:59.133 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 03:48:59.133 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-4_pid-2_1-3-4-6.pkl | len: 3 |  size: 2.06 KB
Processing depth (1, 3, 4, 6):   3%|▎         | 3/100 [01:01<33:18, 20.60s/it]is_0k: False
your chose emoji: ['⏯️', '👩🏿\u200d🤝\u200d👩🏼', '👟', '👩\u200d🦼', '💆🏻\u200d♀️', '👨🏾\u200d🤝\u200d👨🏽', '💆🏿', '👰🏻\u200d♂️', '👨\u200d🦼\u200d➡', '😂']
emoji:
O: ⏯️ [158, 237, 107, 31643]
N: 👟 [9468, 239, 253]

O: 👩🏿‍🤝‍👩🏼 [9468, 239, 102, 9468, 237, 123, 102470, 9468, 97, 251, 102470, 9468, 239, 102, 9468, 237, 120]
N: 💆🏻‍♀️ [93273, 228, 9468, 237, 119, 102470, 32990, 31643]

O: 👟 [9468, 239, 253]
N: 👨🏾‍🤝‍👨🏽 [9468, 239, 101, 9468, 237, 122, 102470, 9468, 97, 251, 102470, 9468, 239, 101, 9468, 237, 121]

O: 👩‍🦼 [9468, 239, 102, 102470, 9468, 99, 120]
N: 👨‍🦼‍➡ [9468, 239, 101, 102470, 9468, 99, 120, 102470, 98115, 94]

O: 💆🏻‍♀️ [93273, 228, 9468, 237, 119, 102470, 32990, 31643]
N: 👰🏻‍♂️ [9468, 239, 108, 9468, 237, 119, 102470, 17245, 224, 31643]

O: 👨🏾‍🤝‍👨🏽 [9468, 239, 101, 9468, 237, 122, 102470, 9468, 97, 251, 102470, 9468, 239, 101, 9468, 237, 121]
N: 👩🏿‍🤝‍👩🏼 [9468, 239, 102, 9468, 237, 123, 102470, 9468, 97, 251, 102470, 9468, 239, 102, 9468, 237, 120]

O: 💆🏿 [93273, 228, 9468, 237, 123]
N: ⏯️ [158, 237, 107, 31643]

O: 👰🏻‍♂️ [9468, 239, 108, 9468, 237, 119, 102470, 17245, 224, 31643]
N: 👩‍🦼 [9468, 239, 102, 102470, 9468, 99, 120]

O: 👨‍🦼‍➡ [9468, 239, 101, 102470, 9468, 99, 120, 102470, 98115, 94]
N: 💆🏿 [93273, 228, 9468, 237, 123]

O: 😂 [76460, 224]
N: 😂 [76460, 224]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.41s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.79s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.64s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.25s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.76s/it]
Processing depth (3, 4, 5, 7):   3%|▎         | 3/100 [01:17<33:18, 20.60s/it]2025-01-22 03:49:15.938 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel journeyed to the bathroom.
2025-01-22 03:49:15.953 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2701, 2707) --> . Daniel journeyed to the
2025-01-22 03:49:15.954 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the garden.
2025-01-22 03:49:15.973 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3506, 3511) --> . Daniel went to the
2025-01-22 03:49:15.974 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel left the apple.
2025-01-22 03:49:15.998 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4122, 4126) -->  Daniel left the apple
2025-01-22 03:49:15.999 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary journeyed to the office.
2025-01-22 03:49:16.028 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5574, 5580) --> . Mary journeyed to the
2025-01-22 03:49:16.028 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the football there.
2025-01-22 03:49:16.032 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (640, 645) -->  Mary got the football there
2025-01-22 03:49:16.032 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary moved to the bathroom.
2025-01-22 03:49:16.053 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3663, 3668) --> . Mary moved to the
2025-01-22 03:49:16.053 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the bedroom.
2025-01-22 03:49:16.072 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3510, 3516) -->  the garden. John went back
2025-01-22 03:49:16.073 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra journeyed to the bedroom.
2025-01-22 03:49:16.105 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6365, 6371) --> . Sandra journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 03:49:16.909 | INFO     | test_jbb_embedding:begin_test:693 - The bedroom.<|eot_id|>
2025-01-22 03:49:16.909 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8142])
2025-01-22 03:49:19.166 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [140.76041666666666, 14.130220802639656, 101.42400568181819, 13.56496563348556, 13.178196022727272], 'topk_indices': array([8133, 8124, 4125, 8040, 8129, 8132,    3, 8125,   23, 2707, 8130,
       7879,   14,   24, 3518,    1,    0, 8140, 8137, 8138]), 'topk_tokens': ['?', 'Question', ' apple', ' location', ' apple', ' garden', '<|end_header_id|>', ':', '4', ' bathroom', ' before', ' Square', '\n', '\n\n', ' bedroom', '<|start_header_id|>', '<|begin_of_text|>', '<|end_header_id|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [169.88541666666666, 162.125, 244.6875, 24.546875]}, 'weight': {'score': [21.257068452380953, 23.24766919889503, 22.529474431818183, 23.25477891261417, 29.084943181818183], 'topk_indices': array([3315, 3288, 3208, 3160, 7419, 7381, 1423, 1485, 4307, 4291, 5167,
       5106, 7122, 7066, 3497, 3471, 4879, 4956, 4927, 4904]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.270833333333332, 19.665625, 26.533203125, 20.052083333333332]}, 'saliency': {'score': [0.8067801339285714, 0.07673873386184009, 0.5747514204545454, 0.07349420800323223, 0.09615367542613637], 'topk_indices': array([3511, 8133,    8, 8114,    0, 8111,   23,   16, 7878,   20, 8040,
         24, 4125, 8130, 8129, 8132, 8124, 2707, 7879, 3518]), 'topk_tokens': [' garden', '?', ' Date', ' directly', '<|begin_of_text|>', ' return', '4', ' Date', 'Bridge', ' Jul', ' location', '\n\n', ' apple', ' before', ' apple', ' garden', 'Question', ' bathroom', ' Square', ' bedroom'], 'evidence_proportions': [0.9059651692708334, 0.835302734375, 1.6466064453125, 0.12394205729166667]}}, 'pred_res': 'The bedroom.<|eot_id|>', 'score': 0}
2025-01-22 03:49:19.173 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 03:49:19.174 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-4_pid-3_3-4-5-7.pkl | len: 3 |  size: 2.06 KB
Processing depth (3, 4, 5, 7):   4%|▍         | 4/100 [01:21<32:36, 20.38s/it]is_0k: False
your chose emoji: ['🖐🏾', '🧛🏾\u200d♂', '🖲️', '😫', '👨\u200d🎨', '😲', '👠', '👷🏼\u200d♂', '🚛', '👨🏽\u200d🔧']
emoji:
O: 🖐🏾 [9468, 244, 238, 9468, 237, 122]
N: 🚛 [9468, 248, 249]

O: 🧛🏾‍♂ [9468, 100, 249, 9468, 237, 122, 102470, 17245, 224]
N: 🖲️ [9468, 244, 110, 31643]

O: 🖲️ [9468, 244, 110, 31643]
N: 😲 [76460, 110]

O: 😫 [76460, 104]
N: 🖐🏾 [9468, 244, 238, 9468, 237, 122]

O: 👨‍🎨 [9468, 239, 101, 102470, 9468, 236, 101]
N: 👠 [9468, 239, 254]

O: 😲 [76460, 110]
N: 👨‍🎨 [9468, 239, 101, 102470, 9468, 236, 101]

O: 👠 [9468, 239, 254]
N: 😫 [76460, 104]

O: 👷🏼‍♂ [9468, 239, 115, 9468, 237, 120, 102470, 17245, 224]
N: 🧛🏾‍♂ [9468, 100, 249, 9468, 237, 122, 102470, 17245, 224]

O: 🚛 [9468, 248, 249]
N: 👷🏼‍♂ [9468, 239, 115, 9468, 237, 120, 102470, 17245, 224]

O: 👨🏽‍🔧 [9468, 239, 101, 9468, 237, 121, 102470, 9468, 242, 100]
N: 👨🏽‍🔧 [9468, 239, 101, 9468, 237, 121, 102470, 9468, 242, 100]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:11,  3.86s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.03s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.17s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.97s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.37s/it]
Processing depth (0, 1, 3, 8):   4%|▍         | 4/100 [01:36<32:36, 20.38s/it]2025-01-22 03:49:34.395 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel journeyed to the bathroom.
2025-01-22 03:49:34.395 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 37) -->  journeyed to the bathroom.
2025-01-22 03:49:34.395 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the garden.
2025-01-22 03:49:34.399 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (794, 799) --> . Daniel went to the
2025-01-22 03:49:34.400 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel left the apple.
2025-01-22 03:49:34.415 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2841, 2845) -->  Daniel left the apple
2025-01-22 03:49:34.416 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary journeyed to the office.
2025-01-22 03:49:34.453 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6529, 6535) --> . Mary journeyed to the
2025-01-22 03:49:34.453 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the football there.
2025-01-22 03:49:34.457 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (662, 667) --> . Mary got the football
2025-01-22 03:49:34.457 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary moved to the bathroom.
2025-01-22 03:49:34.478 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3690, 3695) --> . Mary moved to the
2025-01-22 03:49:34.479 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the bedroom.
2025-01-22 03:49:34.500 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3573, 3579) --> . John went back to the
2025-01-22 03:49:34.500 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra journeyed to the bedroom.
2025-01-22 03:49:34.535 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6314, 6320) --> . Sandra journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 03:49:35.320 | INFO     | test_jbb_embedding:begin_test:693 - The bedroom.<|eot_id|>
2025-01-22 03:49:35.320 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8152])
2025-01-22 03:49:37.565 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [248.32254464285714, 20.55693784488044, 116.61363636363636, 19.706799147867358, 19.463102213541667], 'topk_indices': array([8133, 2844, 8040,  188, 8139, 8142,  173, 8140,    1,  191, 8050,
        172,   31,   14,   24, 8147,   35,  192, 8150,    0]), 'topk_tokens': ['.\n\n', ' apple', '.\n\n', 'G', ' apple', ' garden', 'E', ' before', '<|start_header_id|>', ' P', ' location', 'ION', ' journey', '\n', '\n\n', '<|eot_id|>', ' bathroom', 'ION', '<|end_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [467.1666666666667, 231.375, 285.875, 18.56640625]}, 'weight': {'score': [21.447544642857142, 23.258593270999388, 21.001420454545453, 23.26940316044132, 29.326822916666668], 'topk_indices': array([3297, 3324, 3169, 3217, 7405, 7443, 1514, 1452, 4359, 4343, 5154,
       5215, 7182, 7126, 3518, 3492, 4956, 4931, 4979, 5008]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.9375, 19.665625, 26.533203125, 20.052083333333332]}, 'saliency': {'score': [1.5106273832775297, 0.11585459098137646, 0.6513089266690341, 0.11079169354260085, 0.14529151916503907], 'topk_indices': array([8121,  173,  188,   30,  191, 8134,   39,   24, 8136,  666, 8140,
        799,  172, 2844, 8050, 8139, 8142,   31,  192,   35]), 'topk_tokens': [' return', 'E', 'G', 'Daniel', ' P', 'Question', '***', '\n\n', ' Where', ' football', ' before', ' garden', 'ION', ' apple', ' location', ' apple', ' garden', ' journey', 'ION', ' bathroom'], 'evidence_proportions': [2.8870442708333335, 1.2099609375, 1.945068359375, 0.0951385498046875]}}, 'pred_res': 'The bedroom.<|eot_id|>', 'score': 0}
2025-01-22 03:49:37.569 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 03:49:37.569 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-4_pid-4_0-1-3-8.pkl | len: 3 |  size: 2.0 KB
Processing depth (0, 1, 3, 8):   5%|▌         | 5/100 [01:39<31:08, 19.67s/it]Processing depth (0, 1, 3, 8):   5%|▌         | 5/100 [01:40<31:48, 20.09s/it]
2025-01-22 03:49:38.281 | INFO     | __main__:<module>:82 - Selected idx: 5
2025-01-22 03:49:38.281 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the location prior to the place where the milk was discarded, left or dropped?
2025-01-22 03:49:38.281 | INFO     | __main__:<module>:84 - Answer: bathroom
2025-01-22 03:49:38.281 | INFO     | __main__:<module>:85 - Tag: 4-hop
2025-01-22 03:49:38.281 | INFO     | __main__:<module>:86 - Needle: [' Sandra journeyed to the bedroom.', ' Mary got the football there.', ' Daniel journeyed to the bathroom.', ' John went back to the bedroom.', ' Daniel grabbed the milk.', ' Mary moved to the bathroom.', ' Daniel went to the garden.', ' Daniel left the milk.', ' Mary journeyed to the office.']
2025-01-22 03:49:38.281 | INFO     | __main__:<module>:87 - Real Needle: [' Daniel journeyed to the bathroom.', ' Daniel grabbed the milk.', ' Daniel went to the garden.', ' Daniel left the milk.', ' Mary journeyed to the office.']
2025-01-22 03:49:38.281 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['👩🏼\u200d❤\u200d👩🏾', '🐲', '🏧', '🚶🏾\u200d♀️\u200d➡', '🏌🏽', '🔹', '💏', '👨\u200d🏫', '🇧🇻', '\U0001fae3']
emoji:
O: 👩🏼‍❤‍👩🏾 [9468, 239, 102, 9468, 237, 120, 102470, 121643, 102470, 9468, 239, 102, 9468, 237, 122]
N: 🐲 [9468, 238, 110]

O: 🐲 [9468, 238, 110]
N: 🚶🏾‍♀️‍➡ [9468, 248, 114, 9468, 237, 122, 102470, 32990, 31643, 102470, 98115, 94]

O: 🏧 [9468, 237, 100]
N: 💏 [93273, 237]

O: 🚶🏾‍♀️‍➡ [9468, 248, 114, 9468, 237, 122, 102470, 32990, 31643, 102470, 98115, 94]
N: 👨‍🏫 [9468, 239, 101, 102470, 9468, 237, 104]

O: 🏌🏽 [9468, 237, 234, 9468, 237, 121]
N: 🏌🏽 [9468, 237, 234, 9468, 237, 121]

O: 🔹 [9468, 242, 117]
N: 🇧🇻 [9468, 229, 100, 9468, 229, 119]

O: 💏 [93273, 237]
N: 👩🏼‍❤‍👩🏾 [9468, 239, 102, 9468, 237, 120, 102470, 121643, 102470, 9468, 239, 102, 9468, 237, 122]

O: 👨‍🏫 [9468, 239, 101, 102470, 9468, 237, 104]
N: 🏧 [9468, 237, 100]

O: 🇧🇻 [9468, 229, 100, 9468, 229, 119]
N: 🔹 [9468, 242, 117]

O: 🫣 [9468, 104, 96]
N: 🫣 [9468, 104, 96]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.23s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.65s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.29s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.96s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.49s/it]
Processing depth (3, 5, 6, 7, 8):   0%|          | 0/100 [00:15<?, ?it/s]2025-01-22 03:49:53.950 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel journeyed to the bathroom.
2025-01-22 03:49:53.965 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2876, 2882) --> . Daniel journeyed to the
2025-01-22 03:49:53.965 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel grabbed the milk.
2025-01-22 03:49:53.985 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4127, 4131) -->  Daniel grabbed the milk
2025-01-22 03:49:53.985 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the garden.
2025-01-22 03:49:54.007 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4592, 4597) -->  Daniel went to the garden
2025-01-22 03:49:54.008 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the milk.
2025-01-22 03:49:54.033 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5442, 5446) -->  Daniel left the milk
2025-01-22 03:49:54.034 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary journeyed to the office.
2025-01-22 03:49:54.066 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6468, 6474) --> . Mary journeyed to the
2025-01-22 03:49:54.066 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra journeyed to the bedroom.
2025-01-22 03:49:54.086 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3954, 3960) -->  to the ground. Sandra journey
2025-01-22 03:49:54.086 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary got the football there.
2025-01-22 03:49:54.088 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (297, 302) --> . Mary got the football
2025-01-22 03:49:54.088 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the bedroom.
2025-01-22 03:49:54.089 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (303, 309) --> . John went back to the
2025-01-22 03:49:54.089 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the bathroom.
2025-01-22 03:49:54.114 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4896, 4901) -->  Mary moved to the bathroom
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 03:49:54.892 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 03:49:54.893 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8138])
2025-01-22 03:49:57.111 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [182.66625, 16.892953107726324, 112.015625, 16.122378459352607, 23.510529891304348], 'topk_indices': array([2879, 2883, 8137, 8112,    1, 3958, 2878, 8017, 4127, 2882,   14,
       2877, 4596,    3, 8027,   24, 8136,    0, 8133, 8134]), 'topk_tokens': ['ed', '.', '\n\n', ':', '<|start_header_id|>', ' Sandra', ' journey', '.\n\n', ' Daniel', ' bathroom', '\n', ' Daniel', ' garden', '<|end_header_id|>', ' location', '\n\n', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [276.2916666666667, 237.78125, 258.4, 133.53125, 21.942708333333332]}, 'weight': {'score': [23.2696875, 23.23469360336568, 22.77734375, 23.235828623054115, 29.10767663043478], 'topk_indices': array([3273, 3300, 3145, 3193, 7382, 7420, 1502, 1440, 4312, 4296, 5145,
       5206, 7159, 7103, 3476, 3502, 4947, 4922, 4970, 4999]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.270833333333332, 28.263671875, 24.1796875, 26.462890625, 20.052083333333332]}, 'saliency': {'score': [1.1702587890625, 0.09379731517885932, 0.7055691805752841, 0.08880960602568261, 0.16923257578974185], 'topk_indices': array([8026, 8123, 8117, 4130, 4128, 7983, 4592, 8131,  309, 8111,   24,
       3871, 8125, 2878, 4127, 2877, 4596, 3958, 8027, 2882]), 'topk_tokens': [' first', ' milk', ' prior', ' milk', ' grabbed', ' context', ' Daniel', 'Answer', ' bedroom', 'Question', '\n\n', 'fax', ' discarded', ' journey', ' Daniel', ' Daniel', ' garden', ' Sandra', ' location', ' bathroom'], 'evidence_proportions': [1.57177734375, 1.81243896484375, 1.67607421875, 0.87774658203125, 0.11411539713541667]}}, 'pred_res': 'The garden.<|eot_id|>', 'score': 0}
2025-01-22 03:49:57.119 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 03:49:57.119 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-5_pid-0_3-5-6-7-8.pkl | len: 3 |  size: 2.12 KB
Processing depth (3, 5, 6, 7, 8):   1%|          | 1/100 [00:18<30:55, 18.74s/it]is_0k: False
your chose emoji: ['🧜🏼\u200d♂️', '😣', '🐯', '🤷🏽\u200d♀', '🔸', '🤭', '🏄', '🧔🏼\u200d♀', '🐦', '🌯']
emoji:
O: 🧜🏼‍♂️ [9468, 100, 250, 9468, 237, 120, 102470, 17245, 224, 31643]
N: 🏄 [9468, 237, 226]

O: 😣 [76460, 96]
N: 🤷🏽‍♀ [9468, 97, 115, 9468, 237, 121, 102470, 32990]

O: 🐯 [9468, 238, 107]
N: 🐦 [9468, 238, 99]

O: 🤷🏽‍♀ [9468, 97, 115, 9468, 237, 121, 102470, 32990]
N: 🧜🏼‍♂️ [9468, 100, 250, 9468, 237, 120, 102470, 17245, 224, 31643]

O: 🔸 [9468, 242, 116]
N: 🤭 [9468, 97, 255]

O: 🤭 [9468, 97, 255]
N: 🐯 [9468, 238, 107]

O: 🏄 [9468, 237, 226]
N: 🧔🏼‍♀ [9468, 100, 242, 9468, 237, 120, 102470, 32990]

O: 🧔🏼‍♀ [9468, 100, 242, 9468, 237, 120, 102470, 32990]
N: 🔸 [9468, 242, 116]

O: 🐦 [9468, 238, 99]
N: 😣 [76460, 96]

O: 🌯 [9468, 234, 107]
N: 🌯 [9468, 234, 107]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.38s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.77s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.62s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  2.96s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.57s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (1, 4, 6, 7, 8):   1%|          | 1/100 [00:34<30:55, 18.74s/it]2025-01-22 03:50:13.272 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel journeyed to the bathroom.
2025-01-22 03:50:13.277 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (908, 914) --> . Daniel journeyed to the
2025-01-22 03:50:13.277 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel grabbed the milk.
2025-01-22 03:50:13.297 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3724, 3728) -->  Daniel grabbed the milk
2025-01-22 03:50:13.297 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the garden.
2025-01-22 03:50:13.322 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4869, 4874) --> . Daniel went to the
2025-01-22 03:50:13.323 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the milk.
2025-01-22 03:50:13.352 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5814, 5818) -->  Daniel left the milk
2025-01-22 03:50:13.352 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary journeyed to the office.
2025-01-22 03:50:13.388 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6652, 6658) --> . Mary journeyed to the
2025-01-22 03:50:13.388 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra journeyed to the bedroom.
2025-01-22 03:50:13.410 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4064, 4070) --> . Sandra journeyed to the
2025-01-22 03:50:13.410 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary got the football there.
2025-01-22 03:50:13.412 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (297, 302) --> . Mary got the football
2025-01-22 03:50:13.412 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the bedroom.
2025-01-22 03:50:13.413 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (303, 309) --> . John went back to the
2025-01-22 03:50:13.413 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the bathroom.
2025-01-22 03:50:13.443 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5213, 5218) --> . Mary moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 03:50:15.639 | INFO     | test_jbb_embedding:begin_test:693 - the garden<|eot_id|>
2025-01-22 03:50:15.640 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8206])
2025-01-22 03:50:18.374 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [207.84625, 17.864569375076137, 141.63636363636363, 16.949043586130852, 11.7943603515625], 'topk_indices': array([8178,  911,    1, 8198, 8186, 8180, 4873,  910, 8205, 8200,  914,
         24, 8085,   14, 8095, 8204, 4874,    0, 8201, 8202]), 'topk_tokens': ['.\n\n', 'ed', '<|start_header_id|>', '?\n', ' to', ':', ' the', ' journey', '\n\n', ':', ' bathroom', '\n\n', '.\n\n', '\n', ' location', '<|end_header_id|>', ' garden', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [321.7083333333333, 235.765625, 288.1, 185.546875, 23.359375]}, 'weight': {'score': [22.366875, 23.294332059325132, 21.001420454545453, 23.303353191619703, 29.671484375], 'topk_indices': array([3257, 3284, 3129, 3177, 7434, 7396, 1419, 1481, 4282, 4298, 5180,
       5119, 7155, 7099, 3440, 3466, 4921, 4944, 4973, 4896]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.270833333333332, 28.263671875, 19.665625, 26.462890625, 20.052083333333332]}, 'saliency': {'score': [1.21050537109375, 0.09833142864586505, 0.7690873579545454, 0.0931169004657636, 0.08938369750976563], 'topk_indices': array([8094, 5817, 4870, 3725, 8191,   24, 4070, 8179,  909, 3727, 8193,
       8085, 5218, 8199, 8185,  309,  910,  914, 8095, 4874]), 'topk_tokens': [' first', ' milk', ' Daniel', ' grabbed', ' milk', '\n\n', ' bedroom', 'Question', ' Daniel', ' milk', ' discarded', '.\n\n', ' bathroom', 'Answer', ' prior', ' bedroom', ' journey', ' bathroom', ' location', ' garden'], 'evidence_proportions': [1.6836751302083333, 1.7894287109375, 1.46640625, 1.2366943359375, 0.12067667643229167]}}, 'pred_res': 'the garden<|eot_id|>', 'score': 0}
2025-01-22 03:50:18.380 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 03:50:18.380 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-5_pid-1_1-4-6-7-8.pkl | len: 3 |  size: 2.09 KB
Processing depth (1, 4, 6, 7, 8):   2%|▏         | 2/100 [00:40<33:01, 20.22s/it]is_0k: False
your chose emoji: ['🧝🏿\u200d♀️', '🙍🏼\u200d♂', '♥️', '🏄🏽\u200d♂', '🧑\u200d🦯\u200d➡', '👦🏽', '💂🏻\u200d♂', '🧎🏾', '🤴🏿', '👨🏿\u200d❤\u200d👨🏽']
emoji:
O: 🧝🏿‍♀️ [9468, 100, 251, 9468, 237, 123, 102470, 32990, 31643]
N: 👦🏽 [9468, 239, 99, 9468, 237, 121]

O: 🙍🏼‍♂ [9468, 247, 235, 9468, 237, 120, 102470, 17245, 224]
N: 🏄🏽‍♂ [9468, 237, 226, 9468, 237, 121, 102470, 17245, 224]

O: ♥️ [77809, 31643]
N: 💂🏻‍♂ [93273, 224, 9468, 237, 119, 102470, 17245, 224]

O: 🏄🏽‍♂ [9468, 237, 226, 9468, 237, 121, 102470, 17245, 224]
N: 🧑‍🦯‍➡ [9468, 100, 239, 102470, 9468, 99, 107, 102470, 98115, 94]

O: 🧑‍🦯‍➡ [9468, 100, 239, 102470, 9468, 99, 107, 102470, 98115, 94]
N: ♥️ [77809, 31643]

O: 👦🏽 [9468, 239, 99, 9468, 237, 121]
N: 🧎🏾 [9468, 100, 236, 9468, 237, 122]

O: 💂🏻‍♂ [93273, 224, 9468, 237, 119, 102470, 17245, 224]
N: 🧝🏿‍♀️ [9468, 100, 251, 9468, 237, 123, 102470, 32990, 31643]

O: 🧎🏾 [9468, 100, 236, 9468, 237, 122]
N: 🙍🏼‍♂ [9468, 247, 235, 9468, 237, 120, 102470, 17245, 224]

O: 🤴🏿 [9468, 97, 112, 9468, 237, 123]
N: 🤴🏿 [9468, 97, 112, 9468, 237, 123]

O: 👨🏿‍❤‍👨🏽 [9468, 239, 101, 9468, 237, 123, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 121]
N: 👨🏿‍❤‍👨🏽 [9468, 239, 101, 9468, 237, 123, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 121]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.92s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.80s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.62s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.23s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.79s/it]
Processing depth (2, 3, 5, 6, 8):   2%|▏         | 2/100 [00:56<33:01, 20.22s/it]2025-01-22 03:50:35.307 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel journeyed to the bathroom.
2025-01-22 03:50:35.317 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1800, 1806) --> . Daniel journeyed to the
2025-01-22 03:50:35.317 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel grabbed the milk.
2025-01-22 03:50:35.331 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2886, 2890) -->  Daniel grabbed the milk
2025-01-22 03:50:35.331 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the garden.
2025-01-22 03:50:35.352 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4202, 4207) -->  Daniel went to the garden
2025-01-22 03:50:35.352 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the milk.
2025-01-22 03:50:35.379 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4768, 4772) -->  Daniel left the milk
2025-01-22 03:50:35.379 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary journeyed to the office.
2025-01-22 03:50:35.411 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6545, 6551) -->  Mary journeyed to the office
2025-01-22 03:50:35.412 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra journeyed to the bedroom.
2025-01-22 03:50:35.431 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4020, 4026) --> . Sandra journeyed to the
2025-01-22 03:50:35.431 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary got the football there.
2025-01-22 03:50:35.433 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (297, 302) --> . Mary got the football
2025-01-22 03:50:35.433 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the bedroom.
2025-01-22 03:50:35.435 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (303, 309) --> . John went back to the
2025-01-22 03:50:35.435 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the bathroom.
2025-01-22 03:50:35.459 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5044, 5049) --> . Mary moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 03:50:36.200 | INFO     | test_jbb_embedding:begin_test:693 - the garden<|eot_id|>
2025-01-22 03:50:36.200 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8190])
2025-01-22 03:50:38.435 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [342.810625, 26.924893964359818, 176.0340909090909, 25.55274252700712, 16.329725477430557], 'topk_indices': array([8175,   14, 2308,   24, 8169, 1800, 2406, 8188, 2890, 8170, 2887,
       1802, 3547, 2886, 1801, 1806, 2889, 8185,    0, 8186]), 'topk_tokens': [' milk', '\n', ' time', '\n\n', ' prior', '.', 'little', '<|end_header_id|>', '.', ' to', ' grabbed', ' journey', '�', ' Daniel', ' Daniel', ' bathroom', ' milk', '<|eot_id|>', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [483.7916666666667, 640.9375, 306.475, 333.9375, 39.2734375]}, 'weight': {'score': [24.0725, 23.277454839497132, 21.001420454545453, 23.281161766511172, 29.41970486111111], 'topk_indices': array([3280, 3307, 3152, 3200, 7434, 7472, 1430, 1492, 4294, 4278, 5126,
       5187, 7135, 7191, 3463, 3489, 4922, 4945, 4897, 4974]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.270833333333332, 28.263671875, 24.1796875, 26.462890625, 23.397135416666668]}, 'saliency': {'score': [2.2591259765625, 0.15090393714527645, 0.9738547585227273, 0.14221126969429015, 0.12072478400336371], 'topk_indices': array([2308, 2307, 1799, 8163, 8177, 5049, 8079, 4771, 4206, 8175,  309,
       3547, 8169, 2406, 1802, 2887, 2886, 2889, 1801, 1806]), 'topk_tokens': [' time', 'little', ' Mr', 'Question', ' discarded', ' bathroom', ' location', ' milk', ' garden', ' milk', ' bedroom', '�', ' prior', 'little', ' journey', ' grabbed', ' Daniel', ' milk', ' Daniel', ' bathroom'], 'evidence_proportions': [2.8473307291666665, 4.826904296875, 1.9541015625, 2.2310791015625, 0.23195393880208334]}}, 'pred_res': 'the garden<|eot_id|>', 'score': 0}
2025-01-22 03:50:38.443 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 03:50:38.443 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-5_pid-2_2-3-5-6-8.pkl | len: 3 |  size: 2.09 KB
Processing depth (2, 3, 5, 6, 8):   3%|▎         | 3/100 [01:00<32:34, 20.15s/it]is_0k: False
your chose emoji: ['🍑', '🧑🏻\u200d🦳', '🚣🏻\u200d♂', '🌰', '👨🏾\u200d🌾', '🔵', '👩🏽\u200d❤️\u200d👨🏼', '🛂', '🏃🏿\u200d♂\u200d➡', '🥂']
emoji:
O: 🍑 [9468, 235, 239]
N: 🚣🏻‍♂ [9468, 248, 96, 9468, 237, 119, 102470, 17245, 224]

O: 🧑🏻‍🦳 [9468, 100, 239, 9468, 237, 119, 102470, 9468, 99, 111]
N: 🔵 [9468, 242, 113]

O: 🚣🏻‍♂ [9468, 248, 96, 9468, 237, 119, 102470, 17245, 224]
N: 🍑 [9468, 235, 239]

O: 🌰 [9468, 234, 108]
N: 🌰 [9468, 234, 108]

O: 👨🏾‍🌾 [9468, 239, 101, 9468, 237, 122, 102470, 9468, 234, 122]
N: 🧑🏻‍🦳 [9468, 100, 239, 9468, 237, 119, 102470, 9468, 99, 111]

O: 🔵 [9468, 242, 113]
N: 🛂 [9468, 249, 224]

O: 👩🏽‍❤️‍👨🏼 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 120]
N: 🏃🏿‍♂‍➡ [9468, 237, 225, 9468, 237, 123, 102470, 17245, 224, 102470, 98115, 94]

O: 🛂 [9468, 249, 224]
N: 👩🏽‍❤️‍👨🏼 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 120]

O: 🏃🏿‍♂‍➡ [9468, 237, 225, 9468, 237, 123, 102470, 17245, 224, 102470, 98115, 94]
N: 👨🏾‍🌾 [9468, 239, 101, 9468, 237, 122, 102470, 9468, 234, 122]

O: 🥂 [9468, 98, 224]
N: 🥂 [9468, 98, 224]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.11s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.64s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.25s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.77s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.35s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 1, 3, 5, 9):   3%|▎         | 3/100 [01:15<32:34, 20.15s/it]2025-01-22 03:50:53.717 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel journeyed to the bathroom.
2025-01-22 03:50:53.718 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 37) -->  journeyed to the bathroom.
2025-01-22 03:50:53.718 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel grabbed the milk.
2025-01-22 03:50:53.724 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (848, 852) -->  Daniel grabbed the milk
2025-01-22 03:50:53.724 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the garden.
2025-01-22 03:50:53.739 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2912, 2917) --> . Daniel went to the
2025-01-22 03:50:53.739 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the milk.
2025-01-22 03:50:53.761 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4136, 4140) -->  Daniel left the milk
2025-01-22 03:50:53.762 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary journeyed to the office.
2025-01-22 03:50:53.807 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7127, 7133) -->  Mary journeyed to the office
2025-01-22 03:50:53.808 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra journeyed to the bedroom.
2025-01-22 03:50:53.830 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3950, 3956) --> . Sandra journeyed to the
2025-01-22 03:50:53.830 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary got the football there.
2025-01-22 03:50:53.832 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (276, 281) --> . Mary got the football
2025-01-22 03:50:53.832 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the bedroom.
2025-01-22 03:50:53.833 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (282, 288) --> . John went back to the
2025-01-22 03:50:53.833 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the bathroom.
2025-01-22 03:50:53.858 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4974, 4979) --> . Mary moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 03:50:57.514 | INFO     | test_jbb_embedding:begin_test:693 - The bathroom.<|eot_id|>
2025-01-22 03:50:57.514 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8174])
2025-01-22 03:51:00.639 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [386.07375, 40.911260242142596, 261.65909090909093, 39.25252536900369, 21.515045166015625], 'topk_indices': array([  31,  483,  543,  463,  576,   35,  571,  461,  485,  484,  579,
        457,  456,  573,  462,  578,  580,    0, 8169, 8170]), 'topk_tokens': [' journey', ' em', ' an', ' per', ',', ' bathroom', ',', ' em', ' per', 's', 's', ' ', ' to', ' to', 's', ' em', ' per', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [895.5416666666666, 498.8125, 183.05, 282.125, 39.932291666666664]}, 'weight': {'score': [23.3296875, 23.265705255594963, 21.001420454545453, 23.27163572416974, 29.423828125], 'topk_indices': array([3353, 3326, 3246, 3198, 7456, 7418, 1538, 1476, 4367, 4351, 5174,
       5235, 7139, 7195, 3509, 3535, 4945, 4970, 4999, 5028]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.9375, 28.263671875, 19.665625, 26.462890625, 23.397135416666668]}, 'saliency': {'score': [2.4344970703125, 0.2211193911848783, 1.3746115944602273, 0.21119180564364237, 0.16553616523742676], 'topk_indices': array([ 546,  530,  543, 8147,  573,  456,  484,  579, 8161,  464,  288,
        483,   31,  463,  461,  485,  462,   35,  578,  580]), 'topk_tokens': [' instead', 'fect', ' an', 'Question', ' to', ' to', 's', 's', ' discarded', ' hour', ' bedroom', ' em', ' journey', ' per', ' em', ' per', 's', ' bathroom', ' em', ' per'], 'evidence_proportions': [5.3740234375, 3.8037109375, 0.918798828125, 1.84619140625, 0.23744710286458334]}}, 'pred_res': 'The bathroom.<|eot_id|>', 'score': 100}
2025-01-22 03:51:00.647 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 03:51:00.647 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-5_pid-3_0-1-3-5-9.pkl | len: 3 |  size: 2.0 KB
Processing depth (0, 1, 3, 5, 9):   4%|▍         | 4/100 [01:22<33:32, 20.96s/it]is_0k: False
your chose emoji: ['🏃🏿\u200d♀', '🙅🏾\u200d♀', '🧍🏾\u200d♀️', '🤽🏽', '🚴🏾\u200d♀️', '🧖🏼', '🚼', '🧖🏼\u200d♂', '📺', '🔸']
emoji:
O: 🏃🏿‍♀ [9468, 237, 225, 9468, 237, 123, 102470, 32990]
N: 🧍🏾‍♀️ [9468, 100, 235, 9468, 237, 122, 102470, 32990, 31643]

O: 🙅🏾‍♀ [9468, 247, 227, 9468, 237, 122, 102470, 32990]
N: 🙅🏾‍♀ [9468, 247, 227, 9468, 237, 122, 102470, 32990]

O: 🧍🏾‍♀️ [9468, 100, 235, 9468, 237, 122, 102470, 32990, 31643]
N: 🚴🏾‍♀️ [9468, 248, 112, 9468, 237, 122, 102470, 32990, 31643]

O: 🤽🏽 [9468, 97, 121, 9468, 237, 121]
N: 🧖🏼‍♂ [9468, 100, 244, 9468, 237, 120, 102470, 17245, 224]

O: 🚴🏾‍♀️ [9468, 248, 112, 9468, 237, 122, 102470, 32990, 31643]
N: 🏃🏿‍♀ [9468, 237, 225, 9468, 237, 123, 102470, 32990]

O: 🧖🏼 [9468, 100, 244, 9468, 237, 120]
N: 🤽🏽 [9468, 97, 121, 9468, 237, 121]

O: 🚼 [9468, 248, 120]
N: 🚼 [9468, 248, 120]

O: 🧖🏼‍♂ [9468, 100, 244, 9468, 237, 120, 102470, 17245, 224]
N: 📺 [9468, 241, 118]

O: 📺 [9468, 241, 118]
N: 🧖🏼 [9468, 100, 244, 9468, 237, 120]

O: 🔸 [9468, 242, 116]
N: 🔸 [9468, 242, 116]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:05<00:15,  5.01s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:10<00:10,  5.02s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.87s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.34s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.93s/it]
Processing depth (0, 2, 4, 6, 8):   4%|▍         | 4/100 [01:39<33:32, 20.96s/it]2025-01-22 03:51:18.176 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel journeyed to the bathroom.
2025-01-22 03:51:18.177 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 37) -->  journeyed to the bathroom.
2025-01-22 03:51:18.177 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel grabbed the milk.
2025-01-22 03:51:18.187 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1872, 1876) -->  Daniel grabbed the milk
2025-01-22 03:51:18.187 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the garden.
2025-01-22 03:51:18.209 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3608, 3613) --> . Daniel went to the
2025-01-22 03:51:18.210 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the milk.
2025-01-22 03:51:18.238 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4734, 4738) -->  Daniel left the milk
2025-01-22 03:51:18.239 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary journeyed to the office.
2025-01-22 03:51:18.274 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6616, 6622) --> . Mary journeyed to the
2025-01-22 03:51:18.274 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra journeyed to the bedroom.
2025-01-22 03:51:18.297 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3969, 3975) -->  to the ground. Sandra journey
2025-01-22 03:51:18.297 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary got the football there.
2025-01-22 03:51:18.299 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (304, 309) --> . Mary got the football
2025-01-22 03:51:18.299 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the bedroom.
2025-01-22 03:51:18.301 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (310, 316) --> . John went back to the
2025-01-22 03:51:18.301 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the bathroom.
2025-01-22 03:51:18.328 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5014, 5019) --> . Mary moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 03:51:19.087 | INFO     | test_jbb_embedding:begin_test:693 - the garden<|eot_id|>
2025-01-22 03:51:19.087 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8170])
2025-01-22 03:51:21.328 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [312.075, 24.95633488315184, 170.4325284090909, 23.67914525904504, 15.947391633064516], 'topk_indices': array([1873, 8143, 8155, 8157, 8049, 4738,   32, 8149, 1875,   14, 8144,
       1876,   24,   31, 8150,   35, 3613, 8166, 8165,    0]), 'topk_tokens': [' grabbed', 'Question', ' milk', ' discarded', '.\n\n', '.', 'ed', ' prior', ' milk', '\n', ':', '.', '\n\n', ' journey', ' to', ' bathroom', ' garden', '<|start_header_id|>', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [479.75, 409.125, 323.4, 320.375, 64.72916666666667]}, 'weight': {'score': [22.526875, 23.264007631836535, 21.484375, 23.27109355771597, 29.510584677419356], 'topk_indices': array([3292, 3319, 3212, 3164, 7446, 7408, 1497, 1435, 4320, 4336, 5156,
       5217, 7165, 7109, 3475, 3501, 4938, 4975, 4913, 5004]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.9375, 28.263671875, 19.665625, 26.462890625, 20.052083333333332]}, 'saliency': {'score': [1.91122802734375, 0.13907532089272606, 0.9731195623224432, 0.1313651571008568, 0.11806168094758064], 'topk_indices': array([   0,   24, 1872, 8145,  308, 8015,  316,   39,  306, 8059, 4737,
       8155, 1873, 1875, 8149, 8143, 8157,   31,   35, 3613]), 'topk_tokens': ['<|begin_of_text|>', '\n\n', ' Daniel', ' Where', ' football', ' context', ' bedroom', '***', ' got', ' location', ' milk', ' milk', ' grabbed', ' milk', ' prior', 'Question', ' discarded', ' journey', ' bathroom', ' garden'], 'evidence_proportions': [2.8802083333333335, 3.057861328125, 1.5583984375, 2.077392578125, 0.3610738118489583]}}, 'pred_res': 'the garden<|eot_id|>', 'score': 0}
2025-01-22 03:51:21.335 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 03:51:21.335 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-5_pid-4_0-2-4-6-8.pkl | len: 3 |  size: 2.08 KB
Processing depth (0, 2, 4, 6, 8):   5%|▌         | 5/100 [01:42<33:01, 20.86s/it]Processing depth (0, 2, 4, 6, 8):   5%|▌         | 5/100 [01:43<32:38, 20.61s/it]
2025-01-22 03:51:21.446 | INFO     | __main__:<module>:82 - Selected idx: 6
2025-01-22 03:51:21.447 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the apple before the garden? 
2025-01-22 03:51:21.447 | INFO     | __main__:<module>:84 - Answer: bathroom
2025-01-22 03:51:21.447 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 03:51:21.447 | INFO     | __main__:<module>:86 - Needle: [' John went back to the bedroom.', ' Mary journeyed to the office.', ' Daniel journeyed to the bathroom.', ' Mary moved to the bathroom.', ' Mary got the football there.', ' John journeyed to the office.', ' Daniel went to the garden.', ' Sandra journeyed to the bedroom.', ' Daniel left the apple.', ' John moved to the bedroom.']
2025-01-22 03:51:21.447 | INFO     | __main__:<module>:87 - Real Needle: [' Daniel journeyed to the bathroom.', ' Daniel went to the garden.', ' Daniel left the apple.', ' John moved to the bedroom.']
2025-01-22 03:51:21.447 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['🥝', '👮🏿\u200d♀', '🧑🏻\u200d🔬', '🧑\u200d🏫', '🧩', '🧔\u200d♀', '💃🏾', '🏃🏻\u200d♂️', '🙅🏻\u200d♀', '⛸']
emoji:
O: 🥝 [9468, 98, 251]
N: 👮🏿‍♀ [9468, 239, 106, 9468, 237, 123, 102470, 32990]

O: 👮🏿‍♀ [9468, 239, 106, 9468, 237, 123, 102470, 32990]
N: 🧔‍♀ [9468, 100, 242, 102470, 32990]

O: 🧑🏻‍🔬 [9468, 100, 239, 9468, 237, 119, 102470, 9468, 242, 105]
N: 🥝 [9468, 98, 251]

O: 🧑‍🏫 [9468, 100, 239, 102470, 9468, 237, 104]
N: 💃🏾 [93273, 225, 9468, 237, 122]

O: 🧩 [9468, 100, 102]
N: 🙅🏻‍♀ [9468, 247, 227, 9468, 237, 119, 102470, 32990]

O: 🧔‍♀ [9468, 100, 242, 102470, 32990]
N: 🧑🏻‍🔬 [9468, 100, 239, 9468, 237, 119, 102470, 9468, 242, 105]

O: 💃🏾 [93273, 225, 9468, 237, 122]
N: 🧑‍🏫 [9468, 100, 239, 102470, 9468, 237, 104]

O: 🏃🏻‍♂️ [9468, 237, 225, 9468, 237, 119, 102470, 17245, 224, 31643]
N: 🏃🏻‍♂️ [9468, 237, 225, 9468, 237, 119, 102470, 17245, 224, 31643]

O: 🙅🏻‍♀ [9468, 247, 227, 9468, 237, 119, 102470, 32990]
N: 🧩 [9468, 100, 102]

O: ⛸ [158, 249, 116]
N: ⛸ [158, 249, 116]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:11,  3.96s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:09,  4.57s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.47s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.90s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.45s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (1, 3, 4, 6):   0%|          | 0/100 [00:15<?, ?it/s]2025-01-22 03:51:37.009 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel journeyed to the bathroom.
2025-01-22 03:51:37.014 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (909, 915) --> . Daniel journeyed to the
2025-01-22 03:51:37.015 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the garden.
2025-01-22 03:51:37.031 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2987, 2992) -->  tragedy. Daniel went to
2025-01-22 03:51:37.031 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel left the apple.
2025-01-22 03:51:37.050 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3655, 3659) -->  Daniel left the apple
2025-01-22 03:51:37.050 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John moved to the bedroom.
2025-01-22 03:51:37.078 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4810, 4815) -->  the senate. John moved
2025-01-22 03:51:37.078 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the bedroom.
2025-01-22 03:51:37.102 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4531, 4537) --> . John went back to the
2025-01-22 03:51:37.103 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the office.
2025-01-22 03:51:37.106 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (626, 632) -->  John journeyed to the office
2025-01-22 03:51:37.106 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary moved to the bathroom.
2025-01-22 03:51:37.112 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1128, 1133) --> . Mary moved to the
2025-01-22 03:51:37.113 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary got the football there.
2025-01-22 03:51:37.134 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4326, 4331) -->  Mary got the football there
2025-01-22 03:51:37.134 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John journeyed to the office.
2025-01-22 03:51:37.137 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (625, 631) --> . John journeyed to the
2025-01-22 03:51:37.137 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra journeyed to the bedroom.
2025-01-22 03:51:37.142 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (816, 822) --> . Sandra journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 03:51:40.693 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's hand.<|eot_id|>
2025-01-22 03:51:40.693 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8211])
2025-01-22 03:51:43.525 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [182.96171875, 23.48577124421719, 102.0560661764706, 22.76752259497549, 37.70124246987952], 'topk_indices': array([8200, 8099, 8192, 3659,    1, 8195, 3658,   24, 8196, 8193,   14,
       8194, 8202, 8201, 8198, 8199, 8209,    0, 8206, 8207]), 'topk_tokens': [' the', '.\n\n', '.\n\n', '.', '<|start_header_id|>', ' Where', ' apple', '\n\n', ' was', 'Question', '\n', ':', '?', ' garden', ' apple', ' before', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [144.1875, 164.79375, 376.625, 92.728125]}, 'weight': {'score': [23.65859375, 23.299834885561236, 21.479319852941178, 23.306541053921567, 29.846573795180724], 'topk_indices': array([3319, 3292, 3164, 3212, 7442, 7480, 1438, 1500, 4336, 4352, 5198,
       5259, 7219, 7163, 3501, 3475, 4962, 4937, 5014, 4985]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.270833333333332, 25.4734375, 26.533203125, 23.609375]}, 'saliency': {'score': [1.1332305908203124, 0.12837863101963873, 0.5803761201746324, 0.12403243569766774, 0.2909531191170934], 'topk_indices': array([5919, 8099,  915, 6055,    0, 5927, 8194, 8192,   24, 7948, 3014,
       8196, 3013, 8202, 8195, 3658, 8193, 8201, 8198, 8199]), 'topk_tokens': [' time', '.\n\n', ' bathroom', 'this', '<|begin_of_text|>', '-day', ':', '.\n\n', '\n\n', ' Square', '�', ' was', '\u200d', '?', ' Where', ' apple', 'Question', ' garden', ' apple', ' before'], 'evidence_proportions': [0.7913004557291666, 0.9462890625, 2.570556640625, 0.58062744140625]}}, 'pred_res': "Daniel's hand.<|eot_id|>", 'score': 0}
2025-01-22 03:51:43.542 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 03:51:43.543 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-6_pid-0_1-3-4-6.pkl | len: 3 |  size: 2.01 KB
Processing depth (1, 3, 4, 6):   1%|          | 1/100 [00:22<36:19, 22.01s/it]is_0k: False
your chose emoji: ['🔤', '🏔️', '🏠', '👨🏽\u200d❤️\u200d💋\u200d👨🏾', '💂🏿\u200d♀️', '🧔\u200d♀️', '🧗🏻\u200d♀', '👩\u200d👩\u200d👦', '👨🏻\u200d⚖️', '👩🏽\u200d🦽']
emoji:
O: 🔤 [9468, 242, 97]
N: 🧔‍♀️ [9468, 100, 242, 102470, 32990, 31643]

O: 🏔️ [9468, 237, 242, 31643]
N: 👩‍👩‍👦 [9468, 239, 102, 102470, 9468, 239, 102, 102470, 9468, 239, 99]

O: 🏠 [9468, 237, 254]
N: 💂🏿‍♀️ [93273, 224, 9468, 237, 123, 102470, 32990, 31643]

O: 👨🏽‍❤️‍💋‍👨🏾 [9468, 239, 101, 9468, 237, 121, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 122]
N: 🧗🏻‍♀ [9468, 100, 245, 9468, 237, 119, 102470, 32990]

O: 💂🏿‍♀️ [93273, 224, 9468, 237, 123, 102470, 32990, 31643]
N: 👨🏻‍⚖️ [9468, 239, 101, 9468, 237, 119, 102470, 158, 248, 244, 31643]

O: 🧔‍♀️ [9468, 100, 242, 102470, 32990, 31643]
N: 👨🏽‍❤️‍💋‍👨🏾 [9468, 239, 101, 9468, 237, 121, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 122]

O: 🧗🏻‍♀ [9468, 100, 245, 9468, 237, 119, 102470, 32990]
N: 🏠 [9468, 237, 254]

O: 👩‍👩‍👦 [9468, 239, 102, 102470, 9468, 239, 102, 102470, 9468, 239, 99]
N: 🔤 [9468, 242, 97]

O: 👨🏻‍⚖️ [9468, 239, 101, 9468, 237, 119, 102470, 158, 248, 244, 31643]
N: 🏔️ [9468, 237, 242, 31643]

O: 👩🏽‍🦽 [9468, 239, 102, 9468, 237, 121, 102470, 9468, 99, 121]
N: 👩🏽‍🦽 [9468, 239, 102, 9468, 237, 121, 102470, 9468, 99, 121]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:11,  3.81s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.20s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.36s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.04s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.46s/it]
Processing depth (1, 4, 7, 9):   1%|          | 1/100 [00:37<36:19, 22.01s/it]2025-01-22 03:51:59.082 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel journeyed to the bathroom.
2025-01-22 03:51:59.086 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (831, 837) --> . Daniel journeyed to the
2025-01-22 03:51:59.087 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the garden.
2025-01-22 03:51:59.109 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3576, 3581) --> . Daniel went to the
2025-01-22 03:51:59.109 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel left the apple.
2025-01-22 03:51:59.138 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5728, 5732) -->  Daniel left the apple
2025-01-22 03:51:59.138 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John moved to the bedroom.
2025-01-22 03:51:59.177 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7359, 7364) --> . John moved to the
2025-01-22 03:51:59.178 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the bedroom.
2025-01-22 03:51:59.202 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4498, 4504) --> . John went back to the
2025-01-22 03:51:59.202 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the office.
2025-01-22 03:51:59.205 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (598, 604) -->  John journeyed to the office
2025-01-22 03:51:59.205 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary moved to the bathroom.
2025-01-22 03:51:59.212 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1124, 1129) --> . Mary moved to the
2025-01-22 03:51:59.212 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary got the football there.
2025-01-22 03:51:59.236 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4292, 4297) --> . Mary got the football
2025-01-22 03:51:59.236 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John journeyed to the office.
2025-01-22 03:51:59.239 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (597, 603) --> . John journeyed to the
2025-01-22 03:51:59.239 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra journeyed to the bedroom.
2025-01-22 03:51:59.243 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (766, 772) --> . Sandra journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 03:52:00.037 | INFO     | test_jbb_embedding:begin_test:693 - The bedroom.<|eot_id|>
2025-01-22 03:52:00.037 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8193])
2025-01-22 03:52:02.275 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [153.0203125, 15.520032637872132, 96.23253676470588, 14.845231515598133, 9.01392261402027], 'topk_indices': array([8178, 5732, 8184, 5731, 8175,   23, 8187, 8180, 8176, 8183,   14,
          1,  837, 4504, 8181,   24, 8191,    0, 8188, 8189]), 'topk_tokens': [' was', '.', '?', ' apple', 'Question', '4', ':', ' apple', ':', ' garden', '\n', '<|start_header_id|>', ' bathroom', ' bedroom', ' before', '\n\n', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [154.03125, 157.875, 292.75, 35.16875]}, 'weight': {'score': [21.024609375, 23.282624527208394, 21.031479779411764, 23.29757161938099, 29.689611486486488], 'topk_indices': array([3302, 3329, 3222, 3174, 7386, 7424, 1440, 1502, 4319, 4303, 5121,
       5182, 7090, 7146, 3495, 3521, 4946, 4923, 4975, 4898]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.270833333333332, 19.665625, 26.533203125, 18.88125]}, 'saliency': {'score': [0.913641357421875, 0.08412451904654328, 0.5321368049172794, 0.08021605006016258, 0.06791532361829603], 'topk_indices': array([8190, 8177, 8184, 8171,   20,   23, 7934, 8162, 8186, 5728, 8091,
         24,  772, 5731, 8175, 8180, 8181, 8183, 4504,  837]), 'topk_tokens': ['assistant', ' Where', '?', ' else', ' Jul', '4', ' Square', ' return', 'Answer', ' Daniel', ' location', '\n\n', ' bedroom', ' apple', 'Question', ' apple', ' before', ' garden', ' bedroom', ' bathroom'], 'evidence_proportions': [0.8524576822916666, 0.830615234375, 2.026123046875, 0.1801025390625]}}, 'pred_res': 'The bedroom.<|eot_id|>', 'score': 0}
2025-01-22 03:52:02.299 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 03:52:02.299 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-6_pid-1_1-4-7-9.pkl | len: 3 |  size: 2.03 KB
Processing depth (1, 4, 7, 9):   2%|▏         | 2/100 [00:40<32:49, 20.10s/it]is_0k: False
your chose emoji: ['👨🏽\u200d❤\u200d👨🏻', '👨🏽\u200d🦯', '🗞️', '💚', '🇧🇴', '🚶🏿\u200d♂', '🚵🏿\u200d♀️', '🧾', '👳🏽\u200d♀️', '🧔🏻\u200d♀']
emoji:
O: 👨🏽‍❤‍👨🏻 [9468, 239, 101, 9468, 237, 121, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 119]
N: 🗞️ [9468, 245, 252, 31643]

O: 👨🏽‍🦯 [9468, 239, 101, 9468, 237, 121, 102470, 9468, 99, 107]
N: 🧾 [9468, 100, 122]

O: 🗞️ [9468, 245, 252, 31643]
N: 🚵🏿‍♀️ [9468, 248, 113, 9468, 237, 123, 102470, 32990, 31643]

O: 💚 [93273, 248]
N: 👳🏽‍♀️ [9468, 239, 111, 9468, 237, 121, 102470, 32990, 31643]

O: 🇧🇴 [9468, 229, 100, 9468, 114783]
N: 🇧🇴 [9468, 229, 100, 9468, 114783]

O: 🚶🏿‍♂ [9468, 248, 114, 9468, 237, 123, 102470, 17245, 224]
N: 🚶🏿‍♂ [9468, 248, 114, 9468, 237, 123, 102470, 17245, 224]

O: 🚵🏿‍♀️ [9468, 248, 113, 9468, 237, 123, 102470, 32990, 31643]
N: 💚 [93273, 248]

O: 🧾 [9468, 100, 122]
N: 👨🏽‍❤‍👨🏻 [9468, 239, 101, 9468, 237, 121, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 119]

O: 👳🏽‍♀️ [9468, 239, 111, 9468, 237, 121, 102470, 32990, 31643]
N: 👨🏽‍🦯 [9468, 239, 101, 9468, 237, 121, 102470, 9468, 99, 107]

O: 🧔🏻‍♀ [9468, 100, 242, 9468, 237, 119, 102470, 32990]
N: 🧔🏻‍♀ [9468, 100, 242, 9468, 237, 119, 102470, 32990]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.52s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.70s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.30s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.79s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.41s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (4, 6, 7, 8):   2%|▏         | 2/100 [00:56<32:49, 20.10s/it]2025-01-22 03:52:17.771 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel journeyed to the bathroom.
2025-01-22 03:52:17.790 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3620, 3626) -->  Hon. Daniel journeyed to
2025-01-22 03:52:17.790 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the garden.
2025-01-22 03:52:17.814 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4881, 4886) --> . Daniel went to the
2025-01-22 03:52:17.814 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel left the apple.
2025-01-22 03:52:17.842 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5750, 5754) -->  Daniel left the apple
2025-01-22 03:52:17.842 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John moved to the bedroom.
2025-01-22 03:52:17.875 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6644, 6649) --> . John moved to the
2025-01-22 03:52:17.875 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the bedroom.
2025-01-22 03:52:17.898 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4549, 4555) -->  John went back to the bedroom
2025-01-22 03:52:17.898 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the office.
2025-01-22 03:52:17.901 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (626, 632) -->  John journeyed to the office
2025-01-22 03:52:17.901 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary moved to the bathroom.
2025-01-22 03:52:17.907 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1228, 1233) -->  Republican. Mary moved to
2025-01-22 03:52:17.907 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary got the football there.
2025-01-22 03:52:17.929 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4346, 4351) --> . Mary got the football
2025-01-22 03:52:17.929 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John journeyed to the office.
2025-01-22 03:52:17.932 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (625, 631) --> . John journeyed to the
2025-01-22 03:52:17.932 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra journeyed to the bedroom.
2025-01-22 03:52:17.936 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (816, 822) --> . Sandra journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 03:52:21.129 | INFO     | test_jbb_embedding:begin_test:693 - The bedroom.<|eot_id|>
2025-01-22 03:52:21.129 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8219])
2025-01-22 03:52:24.144 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [190.846875, 17.107852788251034, 114.13970588235294, 16.278535519711067, 14.705976113505747], 'topk_indices': array([4882, 8117, 8192, 8218, 8200, 5750, 4554, 8206,   23, 8107, 8207,
       8213, 5753,    1,   14,   24, 8217,    0, 8215, 8214]), 'topk_tokens': [' Daniel', ' location', '.', '\n\n', '.\n\n', ' Daniel', ' bedroom', ' apple', '4', '.\n\n', ' before', ':', ' apple', '<|start_header_id|>', '\n', '\n\n', '<|end_header_id|>', '<|begin_of_text|>', '<|start_header_id|>', '<|eot_id|>'], 'evidence_proportions': [181.70833333333334, 202.5875, 328.46875, 79.975]}, 'weight': {'score': [22.2265625, 23.304066072731697, 22.542049632352942, 23.30987638497796, 29.745510057471265], 'topk_indices': array([3273, 3300, 3193, 3145, 7424, 7462, 1481, 1419, 4269, 4285, 5143,
       5204, 7201, 7145, 3456, 3482, 4968, 4997, 4933, 4908]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [24.27734375, 19.665625, 26.533203125, 18.88125]}, 'saliency': {'score': [1.216534423828125, 0.09401569074158887, 0.7106215533088235, 0.08870043927378565, 0.10856023328057651], 'topk_indices': array([  23,  627, 8197,    8, 8107, 8188, 8191, 8216, 8201, 8212, 3622,
       8117, 8209, 8207,   24, 4882, 8206, 5750, 4554, 5753]), 'topk_tokens': ['4', ' journey', ' else', ' Date', '.\n\n', ' return', ' directly', 'assistant', 'Question', 'Answer', ' Daniel', ' location', ' garden', ' before', '\n\n', ' Daniel', ' apple', ' Daniel', ' bedroom', ' apple'], 'evidence_proportions': [1.1714680989583333, 1.182177734375, 2.3282470703125, 0.4156005859375]}}, 'pred_res': 'The bedroom.<|eot_id|>', 'score': 0}
2025-01-22 03:52:24.164 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 03:52:24.165 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-6_pid-2_4-6-7-8.pkl | len: 3 |  size: 2.03 KB
Processing depth (4, 6, 7, 8):   3%|▎         | 3/100 [01:02<33:47, 20.90s/it]is_0k: False
your chose emoji: ['🧏\u200d♀', '🏄🏻\u200d♀️', '💁🏻', '🧑🏼\u200d🤝\u200d🧑🏼', '🍠', '👨🏼\u200d❤️\u200d👨🏽', '🧎🏿\u200d♂\u200d➡️', '♠️', '👲🏼', '👨🏾\u200d⚖️']
emoji:
O: 🧏‍♀ [9468, 100, 237, 102470, 32990]
N: 💁🏻 [93273, 223, 9468, 237, 119]

O: 🏄🏻‍♀️ [9468, 237, 226, 9468, 237, 119, 102470, 32990, 31643]
N: 🏄🏻‍♀️ [9468, 237, 226, 9468, 237, 119, 102470, 32990, 31643]

O: 💁🏻 [93273, 223, 9468, 237, 119]
N: 🧏‍♀ [9468, 100, 237, 102470, 32990]

O: 🧑🏼‍🤝‍🧑🏼 [9468, 100, 239, 9468, 237, 120, 102470, 9468, 97, 251, 102470, 9468, 100, 239, 9468, 237, 120]
N: 👨🏼‍❤️‍👨🏽 [9468, 239, 101, 9468, 237, 120, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 121]

O: 🍠 [9468, 235, 254]
N: 👲🏼 [9468, 239, 110, 9468, 237, 120]

O: 👨🏼‍❤️‍👨🏽 [9468, 239, 101, 9468, 237, 120, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 121]
N: ♠️ [121324, 31643]

O: 🧎🏿‍♂‍➡️ [9468, 100, 236, 9468, 237, 123, 102470, 17245, 224, 102470, 98115, 94, 31643]
N: 🧑🏼‍🤝‍🧑🏼 [9468, 100, 239, 9468, 237, 120, 102470, 9468, 97, 251, 102470, 9468, 100, 239, 9468, 237, 120]

O: ♠️ [121324, 31643]
N: 🧎🏿‍♂‍➡️ [9468, 100, 236, 9468, 237, 123, 102470, 17245, 224, 102470, 98115, 94, 31643]

O: 👲🏼 [9468, 239, 110, 9468, 237, 120]
N: 🍠 [9468, 235, 254]

O: 👨🏾‍⚖️ [9468, 239, 101, 9468, 237, 122, 102470, 158, 248, 244, 31643]
N: 👨🏾‍⚖️ [9468, 239, 101, 9468, 237, 122, 102470, 158, 248, 244, 31643]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.54s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.64s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.47s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.11s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.64s/it]
Processing depth (4, 5, 6, 8):   3%|▎         | 3/100 [01:18<33:47, 20.90s/it]2025-01-22 03:52:40.525 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel journeyed to the bathroom.
2025-01-22 03:52:40.545 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3619, 3625) --> . Daniel journeyed to the
2025-01-22 03:52:40.545 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the garden.
2025-01-22 03:52:40.571 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4219, 4224) -->  Daniel went to the garden
2025-01-22 03:52:40.571 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel left the apple.
2025-01-22 03:52:40.594 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4746, 4750) -->  Daniel left the apple
2025-01-22 03:52:40.594 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John moved to the bedroom.
2025-01-22 03:52:40.627 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6620, 6625) --> . John moved to the
2025-01-22 03:52:40.627 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the bedroom.
2025-01-22 03:52:40.655 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4475, 4481) -->  John went back to the bedroom
2025-01-22 03:52:40.655 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the office.
2025-01-22 03:52:40.659 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (602, 608) -->  John journeyed to the office
2025-01-22 03:52:40.659 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary moved to the bathroom.
2025-01-22 03:52:40.666 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1121, 1126) --> . Mary moved to the
2025-01-22 03:52:40.666 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary got the football there.
2025-01-22 03:52:40.687 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4302, 4307) --> . Mary got the football
2025-01-22 03:52:40.687 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John journeyed to the office.
2025-01-22 03:52:40.690 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (601, 607) --> . John journeyed to the
2025-01-22 03:52:40.690 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra journeyed to the bedroom.
2025-01-22 03:52:40.694 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (770, 776) --> . Sandra journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 03:52:41.496 | INFO     | test_jbb_embedding:begin_test:693 - The bedroom.<|eot_id|>
2025-01-22 03:52:41.496 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8211])
2025-01-22 03:52:43.741 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [129.84375, 14.728435255356708, 62.431525735294116, 14.247526999080883, 14.374035203313253], 'topk_indices': array([8099, 4749, 8196, 8205,   23, 8184, 8193, 8192, 8201, 8202, 8198,
       8194,   14,   24,    1, 8199, 8209,    0, 8206, 8207]), 'topk_tokens': ['.\n\n', ' apple', ' was', ':', '4', '.', 'Question', '.\n\n', ' garden', '?', ' apple', ':', '\n', '\n\n', '<|start_header_id|>', ' before', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [100.64583333333333, 142.0875, 270.15625, 40.3875]}, 'weight': {'score': [22.153125, 23.294677912710007, 21.829503676470587, 23.303580729166665, 29.591302710843372], 'topk_indices': array([3297, 3324, 3217, 3169, 7454, 7416, 1431, 1493, 4329, 4313, 5209,
       5148, 7193, 7137, 3480, 3506, 4925, 4973, 5002, 4950]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.270833333333332, 24.1796875, 26.533203125, 18.88125]}, 'saliency': {'score': [0.8323822021484375, 0.07898435181644906, 0.3651266659007353, 0.07594552881577436, 0.10505281011742282], 'topk_indices': array([8065, 8188, 8196,    8, 8183,    0, 8192, 8180, 8189, 8109, 8204,
       8202, 7950, 8195,   24, 4749, 8193, 8201, 8198, 8199]), 'topk_tokens': [' context', ' anything', ' was', ' Date', ' directly', '<|begin_of_text|>', '.\n\n', ' return', ' else', ' location', 'Answer', '?', ' Square', ' Where', '\n\n', ' apple', 'Question', ' garden', ' apple', ' before'], 'evidence_proportions': [0.5930582682291666, 0.935595703125, 1.8380126953125, 0.21185302734375]}}, 'pred_res': 'The bedroom.<|eot_id|>', 'score': 0}
2025-01-22 03:52:43.756 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 03:52:43.757 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-6_pid-3_4-5-6-8.pkl | len: 3 |  size: 2.03 KB
Processing depth (4, 5, 6, 8):   4%|▍         | 4/100 [01:22<32:37, 20.39s/it]is_0k: False
your chose emoji: ['🇱🇮', '👩🏽\u200d❤\u200d💋\u200d👩🏼', '👩🏼\u200d❤\u200d💋\u200d👩🏻', '🇬🇬', '😖', '🏄🏾', '🇹🇨', '🔳', '💆🏼\u200d♂️', '🦹🏼\u200d♂']
emoji:
O: 🇱🇮 [9468, 229, 109, 9468, 229, 106]
N: 🏄🏾 [9468, 237, 226, 9468, 237, 122]

O: 👩🏽‍❤‍💋‍👩🏼 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 120]
N: 👩🏽‍❤‍💋‍👩🏼 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 120]

O: 👩🏼‍❤‍💋‍👩🏻 [9468, 239, 102, 9468, 237, 120, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 119]
N: 😖 [76460, 244]

O: 🇬🇬 [9468, 229, 105, 9468, 229, 105]
N: 🔳 [9468, 242, 111]

O: 😖 [76460, 244]
N: 🇹🇨 [9468, 229, 117, 9468, 229, 101]

O: 🏄🏾 [9468, 237, 226, 9468, 237, 122]
N: 🇱🇮 [9468, 229, 109, 9468, 229, 106]

O: 🇹🇨 [9468, 229, 117, 9468, 229, 101]
N: 🇬🇬 [9468, 229, 105, 9468, 229, 105]

O: 🔳 [9468, 242, 111]
N: 💆🏼‍♂️ [93273, 228, 9468, 237, 120, 102470, 17245, 224, 31643]

O: 💆🏼‍♂️ [93273, 228, 9468, 237, 120, 102470, 17245, 224, 31643]
N: 👩🏼‍❤‍💋‍👩🏻 [9468, 239, 102, 9468, 237, 120, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 119]

O: 🦹🏼‍♂ [9468, 99, 117, 9468, 237, 120, 102470, 17245, 224]
N: 🦹🏼‍♂ [9468, 99, 117, 9468, 237, 120, 102470, 17245, 224]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.57s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.22s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:03,  3.95s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  2.59s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  3.17s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 6, 7, 9):   4%|▍         | 4/100 [01:36<32:37, 20.39s/it]2025-01-22 03:52:58.227 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel journeyed to the bathroom.
2025-01-22 03:52:58.228 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 37) -->  journeyed to the bathroom.
2025-01-22 03:52:58.228 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the garden.
2025-01-22 03:52:58.256 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4759, 4764) -->  the senate. Daniel went
2025-01-22 03:52:58.257 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel left the apple.
2025-01-22 03:52:58.286 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5642, 5646) -->  Daniel left the apple
2025-01-22 03:52:58.286 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John moved to the bedroom.
2025-01-22 03:52:58.329 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7266, 7271) -->  cold. John moved to
2025-01-22 03:52:58.329 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the bedroom.
2025-01-22 03:52:58.353 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4527, 4533) -->  John went back to the bedroom
2025-01-22 03:52:58.353 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the office.
2025-01-22 03:52:58.357 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (633, 639) -->  John journeyed to the office
2025-01-22 03:52:58.357 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary moved to the bathroom.
2025-01-22 03:52:58.365 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1235, 1240) -->  Republican. Mary moved to
2025-01-22 03:52:58.365 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary got the football there.
2025-01-22 03:52:58.389 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4338, 4343) --> . Mary got the football
2025-01-22 03:52:58.389 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John journeyed to the office.
2025-01-22 03:52:58.393 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (632, 638) --> . John journeyed to the
2025-01-22 03:52:58.393 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra journeyed to the bedroom.
2025-01-22 03:52:58.398 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (823, 829) --> . Sandra journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 03:53:02.927 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's house.<|eot_id|>
2025-01-22 03:53:02.927 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8151])
2025-01-22 03:53:05.910 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [134.4921875, 17.09296817512877, 56.67555147058823, 16.636944444444445, 10.081404775943396], 'topk_indices': array([8039,   23,    4, 5937, 8138, 8132,    9, 6072, 5645, 6080, 6073,
       5944, 8139,   24,    1,   14, 8149,    0, 8146, 8147]), 'topk_tokens': ['.\n\n', '4', '\n\n', ' way', ' apple', '.\n\n', ':', '\n', ' apple', ' the', 'the', ' office', ' before', '\n\n', '<|start_header_id|>', '\n', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [146.625, 99.621875, 297.65625, 24.271875]}, 'weight': {'score': [23.41171875, 23.2415570578857, 22.542049632352942, 23.2440731095679, 29.053360849056602], 'topk_indices': array([3297, 3270, 3142, 3190, 7430, 7392, 1426, 1488, 4261, 4277, 5170,
       5109, 7103, 7159, 3491, 3465, 4963, 4934, 4911, 4886]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.9375, 24.39375, 26.533203125, 22.9015625]}, 'saliency': {'score': [0.8412994384765625, 0.09249673580930372, 0.3291661879595588, 0.08965441291714892, 0.07550106408461085], 'topk_indices': array([8123, 5642,   14, 8120,   20, 8144, 8132, 8135,    8,    0, 5937,
       7896, 8133,   24, 8141, 6073, 8138, 8139, 5645, 5944]), 'topk_tokens': [' directly', ' Daniel', '\n', ' return', ' Jul', 'Answer', '.\n\n', ' Where', ' Date', '<|begin_of_text|>', ' way', ' Square', 'Question', '\n\n', ' garden', 'the', ' apple', ' before', ' apple', ' office'], 'evidence_proportions': [0.8317057291666666, 0.6052490234375, 2.034912109375, 0.13397216796875]}}, 'pred_res': "Daniel's house.<|eot_id|>", 'score': 0}
2025-01-22 03:53:05.922 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 03:53:05.922 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-6_pid-4_0-6-7-9.pkl | len: 3 |  size: 2.02 KB
Processing depth (0, 6, 7, 9):   5%|▌         | 5/100 [01:44<33:17, 21.03s/it]Processing depth (0, 6, 7, 9):   5%|▌         | 5/100 [01:44<33:05, 20.90s/it]
2025-01-22 03:53:06.029 | INFO     | __main__:<module>:82 - Selected idx: 7
2025-01-22 03:53:06.029 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the location prior to the place where the milk was discarded, left or dropped?
2025-01-22 03:53:06.029 | INFO     | __main__:<module>:84 - Answer: bathroom
2025-01-22 03:53:06.029 | INFO     | __main__:<module>:85 - Tag: 4-hop
2025-01-22 03:53:06.029 | INFO     | __main__:<module>:86 - Needle: [' John journeyed to the office.', ' Daniel journeyed to the bathroom.', ' John went back to the bedroom.', ' Daniel grabbed the milk.', ' Mary moved to the bathroom.', ' Daniel went to the garden.', ' Sandra journeyed to the bedroom.', ' Mary got the football there.', ' Mary journeyed to the office.', ' Daniel left the milk.', ' John moved to the bedroom.']
2025-01-22 03:53:06.029 | INFO     | __main__:<module>:87 - Real Needle: [' Daniel journeyed to the bathroom.', ' Daniel grabbed the milk.', ' Daniel went to the garden.', ' Daniel left the milk.', ' John moved to the bedroom.']
2025-01-22 03:53:06.029 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['🙅🏾', '😩', '👷🏼\u200d♀', '🈸', '🕵\u200d♂', '🙌🏻', '🍲', '🐆', '👨🏼\u200d🦰', '👨\u200d🍼']
emoji:
O: 🙅🏾 [9468, 247, 227, 9468, 237, 122]
N: 🐆 [9468, 238, 228]

O: 😩 [76460, 102]
N: 🕵‍♂ [9468, 243, 113, 102470, 17245, 224]

O: 👷🏼‍♀ [9468, 239, 115, 9468, 237, 120, 102470, 32990]
N: 🙅🏾 [9468, 247, 227, 9468, 237, 122]

O: 🈸 [9468, 230, 116]
N: 🙌🏻 [9468, 247, 234, 9468, 237, 119]

O: 🕵‍♂ [9468, 243, 113, 102470, 17245, 224]
N: 🍲 [9468, 235, 110]

O: 🙌🏻 [9468, 247, 234, 9468, 237, 119]
N: 👷🏼‍♀ [9468, 239, 115, 9468, 237, 120, 102470, 32990]

O: 🍲 [9468, 235, 110]
N: 👨🏼‍🦰 [9468, 239, 101, 9468, 237, 120, 102470, 9468, 99, 108]

O: 🐆 [9468, 238, 228]
N: 😩 [76460, 102]

O: 👨🏼‍🦰 [9468, 239, 101, 9468, 237, 120, 102470, 9468, 99, 108]
N: 🈸 [9468, 230, 116]

O: 👨‍🍼 [9468, 239, 101, 102470, 9468, 104247]
N: 👨‍🍼 [9468, 239, 101, 102470, 9468, 104247]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.69s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:08,  4.47s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.17s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.91s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.45s/it]
Processing depth (0, 2, 4, 6, 7):   0%|          | 0/100 [00:15<?, ?it/s]2025-01-22 03:53:21.544 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel journeyed to the bathroom.
2025-01-22 03:53:21.544 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 37) -->  journeyed to the bathroom.
2025-01-22 03:53:21.544 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel grabbed the milk.
2025-01-22 03:53:21.556 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2007, 2011) -->  Daniel grabbed the milk
2025-01-22 03:53:21.556 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the garden.
2025-01-22 03:53:21.574 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3675, 3680) --> . Daniel went to the
2025-01-22 03:53:21.574 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the milk.
2025-01-22 03:53:21.597 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4798, 4802) -->  left the milk.
2025-01-22 03:53:21.597 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John moved to the bedroom.
2025-01-22 03:53:21.628 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5677, 5682) --> . John moved to the
2025-01-22 03:53:21.628 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John journeyed to the office.
2025-01-22 03:53:21.644 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2741, 2747) -->  Mary journeyed to the office
2025-01-22 03:53:21.644 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the bedroom.
2025-01-22 03:53:21.663 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3829, 3835) --> . John went back to the
2025-01-22 03:53:21.663 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary moved to the bathroom.
2025-01-22 03:53:21.673 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2054, 2059) -->  Mary moved to the bathroom
2025-01-22 03:53:21.673 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra journeyed to the bedroom.
2025-01-22 03:53:21.684 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2155, 2161) --> . Sandra journeyed to the
2025-01-22 03:53:21.684 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary got the football there.
2025-01-22 03:53:21.694 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (2011, 2016) --> . Mary got the football
2025-01-22 03:53:21.694 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary journeyed to the office.
2025-01-22 03:53:21.708 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (2739, 2745) -->  first. Mary journeyed to
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 03:53:22.516 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 03:53:22.516 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8199])
2025-01-22 03:53:24.746 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [620.4348958333334, 51.84975844306267, 173.11580882352942, 49.667895843565816, 45.64361049107143], 'topk_indices': array([ 431,   29,   32, 4378, 2011,   33,   31,  549, 4356, 4354, 4355,
        542,  425,   35,  426, 4379,    0, 4380, 8194, 8195]), 'topk_tokens': ['s', '\n\n', 'ed', ' Min', '.', ' to', ' journey', ' per', 'ian', 'nes', 'ot', ' to', ' to', ' bathroom', ' ', 'nes', '<|begin_of_text|>', 'ot', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [1172.9166666666667, 603.4375, 552.85, 592.625, 60.8875]}, 'weight': {'score': [21.367513020833332, 23.271279108753962, 22.544806985294116, 23.27992233546169, 29.4015625], 'topk_indices': array([3313, 3340, 3233, 3185, 7423, 7461, 1468, 1406, 4321, 4305, 5143,
       5204, 7200, 7144, 3522, 3496, 4997, 4945, 4968, 4920]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.9375, 28.263671875, 19.665625, 20.3515625, 18.88125]}, 'saliency': {'score': [3.7035954793294272, 0.2830563786843148, 0.9537999770220589, 0.2701759488268779, 0.33030809674944195], 'topk_indices': array([2008, 8172, 4800,   30,  547, 2010, 8186,    0, 3680,  425,  542,
       4378, 4356, 4355,  549,   31, 4354,   35, 4379, 4380]), 'topk_tokens': [' grabbed', 'Question', ' milk', 'Daniel', ' em', ' milk', ' discarded', '<|begin_of_text|>', ' garden', ' to', ' to', ' Min', 'ian', 'ot', ' per', ' journey', 'nes', ' bathroom', 'nes', 'ot'], 'evidence_proportions': [7.173990885416667, 4.4384765625, 2.8697265625, 3.0322265625, 0.32218017578125]}}, 'pred_res': 'The garden.<|eot_id|>', 'score': 0}
2025-01-22 03:53:24.769 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 03:53:24.769 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-7_pid-0_0-2-4-6-7.pkl | len: 3 |  size: 2.03 KB
Processing depth (0, 2, 4, 6, 7):   1%|          | 1/100 [00:18<30:46, 18.66s/it]is_0k: False
your chose emoji: ['👨🏻\u200d🍳', '🎊', '⛓️\u200d💥', '⛹🏽', '🧙🏿\u200d♂', '\U0001fac5🏽', '☸', '🚴🏻', '👩🏻\u200d❤\u200d💋\u200d👨🏾', '⏺']
emoji:
O: 👨🏻‍🍳 [9468, 239, 101, 9468, 237, 119, 102470, 9468, 235, 111]
N: 👩🏻‍❤‍💋‍👨🏾 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 122]

O: 🎊 [9468, 236, 232]
N: ⛓️‍💥 [158, 249, 241, 31643, 102470, 93273, 98]

O: ⛓️‍💥 [158, 249, 241, 31643, 102470, 93273, 98]
N: 🎊 [9468, 236, 232]

O: ⛹🏽 [158, 249, 117, 9468, 237, 121]
N: 🚴🏻 [9468, 248, 112, 9468, 237, 119]

O: 🧙🏿‍♂ [9468, 100, 247, 9468, 237, 123, 102470, 17245, 224]
N: ☸ [18107, 116]

O: 🫅🏽 [9468, 104, 227, 9468, 237, 121]
N: 🧙🏿‍♂ [9468, 100, 247, 9468, 237, 123, 102470, 17245, 224]

O: ☸ [18107, 116]
N: ⛹🏽 [158, 249, 117, 9468, 237, 121]

O: 🚴🏻 [9468, 248, 112, 9468, 237, 119]
N: 🫅🏽 [9468, 104, 227, 9468, 237, 121]

O: 👩🏻‍❤‍💋‍👨🏾 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 122]
N: 👨🏻‍🍳 [9468, 239, 101, 9468, 237, 119, 102470, 9468, 235, 111]

O: ⏺ [158, 237, 118]
N: ⏺ [158, 237, 118]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.69s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.99s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.43s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  2.83s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.51s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 2, 5, 7, 9):   1%|          | 1/100 [00:34<30:46, 18.66s/it]2025-01-22 03:53:40.616 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel journeyed to the bathroom.
2025-01-22 03:53:40.617 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 37) -->  journeyed to the bathroom.
2025-01-22 03:53:40.617 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel grabbed the milk.
2025-01-22 03:53:40.625 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1755, 1759) -->  Daniel grabbed the milk
2025-01-22 03:53:40.626 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the garden.
2025-01-22 03:53:40.646 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4192, 4197) --> . Daniel went to the
2025-01-22 03:53:40.647 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the milk.
2025-01-22 03:53:40.674 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5753, 5757) -->  Daniel left the milk
2025-01-22 03:53:40.674 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John moved to the bedroom.
2025-01-22 03:53:40.710 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7372, 7377) --> . John moved to the
2025-01-22 03:53:40.710 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John journeyed to the office.
2025-01-22 03:53:40.723 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2587, 2593) -->  Mary journeyed to the office
2025-01-22 03:53:40.723 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the bedroom.
2025-01-22 03:53:40.742 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3701, 3707) --> . John went back to the
2025-01-22 03:53:40.742 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary moved to the bathroom.
2025-01-22 03:53:40.751 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1827, 1832) --> . Mary moved to the
2025-01-22 03:53:40.751 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra journeyed to the bedroom.
2025-01-22 03:53:40.761 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1905, 1911) --> . Sandra journeyed to the
2025-01-22 03:53:40.761 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary got the football there.
2025-01-22 03:53:40.769 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1759, 1764) --> . Mary got the football
2025-01-22 03:53:40.769 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary journeyed to the office.
2025-01-22 03:53:40.783 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (2586, 2592) --> . Mary journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 03:53:44.058 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 03:53:44.058 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8207])
2025-01-22 03:53:47.042 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [380.69921875, 27.360655831303287, 138.89613970588235, 25.855217661310107, 16.183963260135137], 'topk_indices': array([8187,  186, 8086,   14, 1758, 5753, 8192, 8201, 8181,   32, 8199,
       5756, 5757, 8194, 1759,   31,   35,    0, 8202, 8203]), 'topk_tokens': [' to', 'ION', '.\n\n', '\n', ' milk', ' Daniel', ' milk', ':', ':', 'ed', '?\n', ' milk', '.', ' discarded', '.', ' journey', ' bathroom', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [613.0416666666666, 441.5625, 203.875, 590.625, 62.08125]}, 'weight': {'score': [22.386067708333332, 23.279076583434836, 21.256663602941178, 23.29014064800049, 29.50274493243243], 'topk_indices': array([3309, 3336, 3229, 3181, 7395, 7433, 1452, 1514, 4335, 4351, 5207,
       5146, 7166, 7110, 3522, 3548, 5000, 4948, 4971, 4923]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.9375, 28.263671875, 19.665625, 26.462890625, 18.88125]}, 'saliency': {'score': [2.419855753580729, 0.1483822338183237, 0.7157987706801471, 0.13932831738952098, 0.11884493441195101], 'topk_indices': array([  32,   68, 8199, 8182, 8096,   30, 4197,  186, 5754, 8180, 1756,
       8186, 8200, 1758, 5753, 8192, 5756,   31, 8194,   35]), 'topk_tokens': ['ed', 'ION', '?\n', ' Where', ' location', 'Daniel', ' garden', 'ION', ' left', 'Question', ' grabbed', ' prior', 'Answer', ' milk', ' Daniel', ' milk', ' milk', ' journey', ' discarded', ' bathroom'], 'evidence_proportions': [3.7576497395833335, 3.24169921875, 0.98056640625, 4.02392578125, 0.3130615234375]}}, 'pred_res': 'The garden.<|eot_id|>', 'score': 0}
2025-01-22 03:53:47.066 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 03:53:47.066 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-7_pid-1_0-2-5-7-9.pkl | len: 3 |  size: 2.05 KB
Processing depth (0, 2, 5, 7, 9):   2%|▏         | 2/100 [00:40<33:58, 20.80s/it]is_0k: False
your chose emoji: ['🚶🏻', '🤾🏾\u200d♂️', '👱🏽\u200d♀', '🚣🏼\u200d♀', '🦈', '👩\u200d🏭', '😟', '👩🏻\u200d❤\u200d👨🏽', '🚣🏾\u200d♀️', '🥷🏼']
emoji:
O: 🚶🏻 [9468, 248, 114, 9468, 237, 119]
N: 🚣🏼‍♀ [9468, 248, 96, 9468, 237, 120, 102470, 32990]

O: 🤾🏾‍♂️ [9468, 97, 122, 9468, 237, 122, 102470, 17245, 224, 31643]
N: 👱🏽‍♀ [9468, 239, 109, 9468, 237, 121, 102470, 32990]

O: 👱🏽‍♀ [9468, 239, 109, 9468, 237, 121, 102470, 32990]
N: 👩‍🏭 [9468, 239, 102, 102470, 9468, 237, 255]

O: 🚣🏼‍♀ [9468, 248, 96, 9468, 237, 120, 102470, 32990]
N: 👩🏻‍❤‍👨🏽 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 121]

O: 🦈 [9468, 99, 230]
N: 😟 [76460, 253]

O: 👩‍🏭 [9468, 239, 102, 102470, 9468, 237, 255]
N: 🦈 [9468, 99, 230]

O: 😟 [76460, 253]
N: 🤾🏾‍♂️ [9468, 97, 122, 9468, 237, 122, 102470, 17245, 224, 31643]

O: 👩🏻‍❤‍👨🏽 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 121]
N: 🚣🏾‍♀️ [9468, 248, 96, 9468, 237, 122, 102470, 32990, 31643]

O: 🚣🏾‍♀️ [9468, 248, 96, 9468, 237, 122, 102470, 32990, 31643]
N: 🚶🏻 [9468, 248, 114, 9468, 237, 119]

O: 🥷🏼 [9468, 98, 115, 9468, 237, 120]
N: 🥷🏼 [9468, 98, 115, 9468, 237, 120]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.90s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.76s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.57s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.16s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.73s/it]
Processing depth (1, 2, 4, 6, 8):   2%|▏         | 2/100 [00:57<33:58, 20.80s/it]2025-01-22 03:54:03.648 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel journeyed to the bathroom.
2025-01-22 03:54:03.653 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (895, 901) --> . Daniel journeyed to the
2025-01-22 03:54:03.653 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel grabbed the milk.
2025-01-22 03:54:03.665 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2007, 2011) -->  Daniel grabbed the milk
2025-01-22 03:54:03.665 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the garden.
2025-01-22 03:54:03.687 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3646, 3651) -->  Daniel went to the garden
2025-01-22 03:54:03.687 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the milk.
2025-01-22 03:54:03.712 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4797, 4801) -->  Daniel left the milk
2025-01-22 03:54:03.712 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John moved to the bedroom.
2025-01-22 03:54:03.746 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6673, 6678) --> . John moved to the
2025-01-22 03:54:03.746 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John journeyed to the office.
2025-01-22 03:54:03.762 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2825, 2831) -->  Mary journeyed to the office
2025-01-22 03:54:03.763 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the bedroom.
2025-01-22 03:54:03.784 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3697, 3703) --> . John went back to the
2025-01-22 03:54:03.784 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary moved to the bathroom.
2025-01-22 03:54:03.795 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2113, 2118) --> . Mary moved to the
2025-01-22 03:54:03.795 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra journeyed to the bedroom.
2025-01-22 03:54:03.805 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2140, 2146) -->  Sandra journeyed to the bedroom
2025-01-22 03:54:03.806 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary got the football there.
2025-01-22 03:54:03.816 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (2011, 2016) --> . Mary got the football
2025-01-22 03:54:03.816 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary journeyed to the office.
2025-01-22 03:54:03.830 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (2824, 2830) --> . Mary journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 03:54:04.614 | INFO     | test_jbb_embedding:begin_test:693 - The bathroom.<|eot_id|>
2025-01-22 03:54:04.615 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8219])
2025-01-22 03:54:06.858 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [397.3111979166667, 24.307395554609585, 99.33088235294117, 22.8984183610975, 25.495068359375], 'topk_indices': array([  24,  895,  896, 2008, 8098,  898,   14, 3650, 8204, 8217,  257,
        902,  897, 2011, 4800, 2010,  901,    0, 8214, 8215]), 'topk_tokens': ['\n\n', '.', ' Daniel', ' grabbed', '.\n\n', 'ed', '\n', ' garden', ' milk', '<|end_header_id|>', 'hue', '.', ' journey', '.', ' milk', ' milk', ' bathroom', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [548.6666666666666, 567.375, 348.6, 468.75, 71.19375]}, 'weight': {'score': [23.159830729166668, 23.293902791291657, 22.0546875, 23.29945779489221, 29.8083984375], 'topk_indices': array([3318, 3291, 3163, 3211, 7483, 7445, 1468, 1406, 4327, 4343, 5143,
       5204, 7152, 7208, 3500, 3474, 4968, 4945, 4920, 4997]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.270833333333332, 28.263671875, 24.1796875, 26.462890625, 18.88125]}, 'saliency': {'score': [2.4922053019205728, 0.13516245001976404, 0.5225650562959558, 0.12661998100224692, 0.18361310958862304], 'topk_indices': array([8202,   24, 8192, 8212,  898, 8098, 4798, 8064, 8198, 2007, 8206,
        896, 3650, 2008, 8204,  257,  897, 4800, 2010,  901]), 'topk_tokens': [' where', '\n\n', 'Question', 'Answer', 'ed', '.\n\n', ' left', ' context', ' prior', ' Daniel', ' discarded', ' Daniel', ' garden', ' grabbed', ' milk', 'hue', ' journey', ' milk', ' milk', ' bathroom'], 'evidence_proportions': [2.8937174479166665, 4.2373046875, 2.22783203125, 3.140380859375, 0.36014404296875]}}, 'pred_res': 'The bathroom.<|eot_id|>', 'score': 100}
2025-01-22 03:54:06.879 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 03:54:06.879 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-7_pid-2_1-2-4-6-8.pkl | len: 3 |  size: 2.07 KB
Processing depth (1, 2, 4, 6, 8):   3%|▎         | 3/100 [01:00<32:53, 20.35s/it]is_0k: False
your chose emoji: ['🧑🏽\u200d❤️\u200d💋\u200d🧑🏼', '🧔\u200d♂️', '🧎🏼\u200d♀️\u200d➡️', '🛣', '⛸️', '👩🏽\u200d✈️', '🇧🇯', '🧘🏽', '💘', '👨🏼\u200d🎓']
emoji:
O: 🧑🏽‍❤️‍💋‍🧑🏼 [9468, 100, 239, 9468, 237, 121, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 100, 239, 9468, 237, 120]
N: 👩🏽‍✈️ [9468, 239, 102, 9468, 237, 121, 102470, 38798, 230, 31643]

O: 🧔‍♂️ [9468, 100, 242, 102470, 17245, 224, 31643]
N: ⛸️ [158, 249, 116, 31643]

O: 🧎🏼‍♀️‍➡️ [9468, 100, 236, 9468, 237, 120, 102470, 32990, 31643, 102470, 98115, 94, 31643]
N: 🧎🏼‍♀️‍➡️ [9468, 100, 236, 9468, 237, 120, 102470, 32990, 31643, 102470, 98115, 94, 31643]

O: 🛣 [9468, 249, 96]
N: 🧘🏽 [9468, 100, 246, 9468, 237, 121]

O: ⛸️ [158, 249, 116, 31643]
N: 🛣 [9468, 249, 96]

O: 👩🏽‍✈️ [9468, 239, 102, 9468, 237, 121, 102470, 38798, 230, 31643]
N: 🧑🏽‍❤️‍💋‍🧑🏼 [9468, 100, 239, 9468, 237, 121, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 100, 239, 9468, 237, 120]

O: 🇧🇯 [9468, 229, 100, 9468, 229, 107]
N: 🇧🇯 [9468, 229, 100, 9468, 229, 107]

O: 🧘🏽 [9468, 100, 246, 9468, 237, 121]
N: 🧔‍♂️ [9468, 100, 242, 102470, 17245, 224, 31643]

O: 💘 [93273, 246]
N: 💘 [93273, 246]

O: 👨🏼‍🎓 [9468, 239, 101, 9468, 237, 120, 102470, 9468, 236, 241]
N: 👨🏼‍🎓 [9468, 239, 101, 9468, 237, 120, 102470, 9468, 236, 241]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.01s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:09,  4.57s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.11s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  2.65s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  3.24s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (1, 4, 6, 8, 9):   3%|▎         | 3/100 [01:15<32:53, 20.35s/it]2025-01-22 03:54:21.544 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel journeyed to the bathroom.
2025-01-22 03:54:21.548 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (841, 847) --> . Daniel journeyed to the
2025-01-22 03:54:21.549 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel grabbed the milk.
2025-01-22 03:54:21.566 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3639, 3643) -->  Daniel grabbed the milk
2025-01-22 03:54:21.566 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the garden.
2025-01-22 03:54:21.590 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4774, 4779) --> . Daniel went to the
2025-01-22 03:54:21.591 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the milk.
2025-01-22 03:54:21.623 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6659, 6663) -->  Daniel left the milk
2025-01-22 03:54:21.623 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John moved to the bedroom.
2025-01-22 03:54:21.659 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7175, 7180) -->  John moved to the bedroom
2025-01-22 03:54:21.659 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John journeyed to the office.
2025-01-22 03:54:21.672 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2582, 2588) -->  Mary journeyed to the office
2025-01-22 03:54:21.672 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the bedroom.
2025-01-22 03:54:21.691 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3689, 3695) --> . John went back to the
2025-01-22 03:54:21.691 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary moved to the bathroom.
2025-01-22 03:54:21.701 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1888, 1893) --> . Mary moved to the
2025-01-22 03:54:21.701 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra journeyed to the bedroom.
2025-01-22 03:54:21.711 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2057, 2063) -->  cable. Sandra journeyed to
2025-01-22 03:54:21.711 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary got the football there.
2025-01-22 03:54:21.720 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1810, 1815) --> . Mary got the football
2025-01-22 03:54:21.721 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary journeyed to the office.
2025-01-22 03:54:21.734 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (2581, 2587) --> . Mary journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 03:54:24.909 | INFO     | test_jbb_embedding:begin_test:693 - the garden<|eot_id|>
2025-01-22 03:54:24.909 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8243])
2025-01-22 03:54:27.854 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [189.07291666666666, 19.386825809483387, 109.23161764705883, 18.516382587322912, 16.390646229619566], 'topk_indices': array([8162, 4779, 3643,    9, 8242, 6662, 8150, 8088,    1, 8222, 8217,
       8132, 8223,   24, 8241,   14, 8122,    0, 8238, 8239]), 'topk_tokens': [' the', ' garden', '.', ':', '\n\n', ' milk', ' a', ' context', '<|start_header_id|>', ' prior', ':', ' location', ' to', '\n\n', '<|end_header_id|>', '\n', '.\n\n', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [195.64583333333334, 243.6875, 152.4875, 330.4375, 60.9875]}, 'weight': {'score': [23.349934895833332, 23.320304920567548, 21.907628676470587, 23.326084094101123, 30.141983695652176], 'topk_indices': array([3349, 3322, 3176, 3224, 7465, 7503, 1438, 1500, 4355, 4339, 5239,
       5178, 7186, 7242, 3505, 3531, 5032, 4955, 4980, 5003]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.270833333333332, 28.263671875, 19.665625, 26.462890625, 24.3078125]}, 'saliency': {'score': [1.1947123209635417, 0.10820217164951189, 0.6352144129136029, 0.1028291062139335, 0.12342875936756963], 'topk_indices': array([ 843, 1815, 8131, 6660, 6659, 8228, 1814, 3642,   24, 8236,  847,
       1893, 8216, 4779, 8088, 6662, 8230, 8122, 8132, 8222]), 'topk_tokens': [' journey', ' there', ' first', ' left', ' Daniel', ' milk', ' football', ' milk', '\n\n', 'Answer', ' bathroom', ' bathroom', 'Question', ' garden', ' context', ' milk', ' discarded', '.\n\n', ' location', ' prior'], 'evidence_proportions': [1.0885823567708333, 1.81640625, 0.784423828125, 2.261962890625, 0.381201171875]}}, 'pred_res': 'the garden<|eot_id|>', 'score': 0}
2025-01-22 03:54:27.861 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 03:54:27.861 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-7_pid-3_1-4-6-8-9.pkl | len: 3 |  size: 2.08 KB
Processing depth (1, 4, 6, 8, 9):   4%|▍         | 4/100 [01:21<32:57, 20.60s/it]is_0k: False
your chose emoji: ['🙆🏿\u200d♀️', '🧛🏼\u200d♀️', '🚶\u200d♂️\u200d➡️', '👩🏿\u200d❤️\u200d👩🏻', '㊗️', '🥇', '🍃', '👩🏼\u200d🏫', '🚶🏾\u200d♂️\u200d➡', '👩🏼\u200d🦼\u200d➡️']
emoji:
O: 🙆🏿‍♀️ [9468, 247, 228, 9468, 237, 123, 102470, 32990, 31643]
N: 👩🏿‍❤️‍👩🏻 [9468, 239, 102, 9468, 237, 123, 102470, 121643, 31643, 102470, 9468, 239, 102, 9468, 237, 119]

O: 🧛🏼‍♀️ [9468, 100, 249, 9468, 237, 120, 102470, 32990, 31643]
N: ㊗️ [159, 232, 245, 31643]

O: 🚶‍♂️‍➡️ [9468, 248, 114, 102470, 17245, 224, 31643, 102470, 98115, 94, 31643]
N: 🍃 [9468, 235, 225]

O: 👩🏿‍❤️‍👩🏻 [9468, 239, 102, 9468, 237, 123, 102470, 121643, 31643, 102470, 9468, 239, 102, 9468, 237, 119]
N: 🧛🏼‍♀️ [9468, 100, 249, 9468, 237, 120, 102470, 32990, 31643]

O: ㊗️ [159, 232, 245, 31643]
N: 🚶🏾‍♂️‍➡ [9468, 248, 114, 9468, 237, 122, 102470, 17245, 224, 31643, 102470, 98115, 94]

O: 🥇 [9468, 98, 229]
N: 🚶‍♂️‍➡️ [9468, 248, 114, 102470, 17245, 224, 31643, 102470, 98115, 94, 31643]

O: 🍃 [9468, 235, 225]
N: 👩🏼‍🏫 [9468, 239, 102, 9468, 237, 120, 102470, 9468, 237, 104]

O: 👩🏼‍🏫 [9468, 239, 102, 9468, 237, 120, 102470, 9468, 237, 104]
N: 🙆🏿‍♀️ [9468, 247, 228, 9468, 237, 123, 102470, 32990, 31643]

O: 🚶🏾‍♂️‍➡ [9468, 248, 114, 9468, 237, 122, 102470, 17245, 224, 31643, 102470, 98115, 94]
N: 🥇 [9468, 98, 229]

O: 👩🏼‍🦼‍➡️ [9468, 239, 102, 9468, 237, 120, 102470, 9468, 99, 120, 102470, 98115, 94, 31643]
N: 👩🏼‍🦼‍➡️ [9468, 239, 102, 9468, 237, 120, 102470, 9468, 99, 120, 102470, 98115, 94, 31643]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:05<00:16,  5.55s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.83s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.56s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.10s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.75s/it]
Processing depth (0, 2, 5, 6, 7):   4%|▍         | 4/100 [01:38<32:57, 20.60s/it]2025-01-22 03:54:44.742 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel journeyed to the bathroom.
2025-01-22 03:54:44.743 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 37) -->  journeyed to the bathroom.
2025-01-22 03:54:44.743 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel grabbed the milk.
2025-01-22 03:54:44.753 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1799, 1803) -->  Daniel grabbed the milk
2025-01-22 03:54:44.753 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the garden.
2025-01-22 03:54:44.775 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4199, 4204) -->  Daniel went to the garden
2025-01-22 03:54:44.775 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the milk.
2025-01-22 03:54:44.799 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4713, 4717) -->  Daniel left the milk
2025-01-22 03:54:44.799 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John moved to the bedroom.
2025-01-22 03:54:44.831 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5683, 5688) --> . John moved to the
2025-01-22 03:54:44.831 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John journeyed to the office.
2025-01-22 03:54:44.845 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2587, 2593) -->  Mary journeyed to the office
2025-01-22 03:54:44.845 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the bedroom.
2025-01-22 03:54:44.865 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3699, 3705) --> . John went back to the
2025-01-22 03:54:44.865 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary moved to the bathroom.
2025-01-22 03:54:44.875 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1881, 1886) --> . Mary moved to the
2025-01-22 03:54:44.875 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra journeyed to the bedroom.
2025-01-22 03:54:44.885 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2050, 2056) -->  cable. Sandra journeyed to
2025-01-22 03:54:44.886 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary got the football there.
2025-01-22 03:54:44.896 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1803, 1808) --> . Mary got the football
2025-01-22 03:54:44.896 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary journeyed to the office.
2025-01-22 03:54:44.910 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (2586, 2592) --> . Mary journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 03:54:45.687 | INFO     | test_jbb_embedding:begin_test:693 - the bathroom<|eot_id|>
2025-01-22 03:54:45.687 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8235])
2025-01-22 03:54:47.923 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [534.2890625, 41.905510287691186, 174.50367647058823, 39.909722646699265, 44.24966708096591], 'topk_indices': array([4716,   79, 1802, 8215,   31, 4717,  121,   35,  122,   83,   84,
        123,   88,   85,    0,   86, 8230,  124,   87, 8231]), 'topk_tokens': [' milk', '\n\n\n\n', ' milk', ' to', ' journey', '.', 'ENCES', ' bathroom', ' OF', 'ENCES', ' OF', ' P', 'ER', ' P', '<|begin_of_text|>', 'ION', '<|eot_id|>', 'ION', 'E', '<|start_header_id|>'], 'evidence_proportions': [892.3333333333334, 696.75, 301.875, 719.5625, 58.8625]}, 'weight': {'score': [23.326497395833332, 23.30016008133042, 21.907628676470587, 23.305870835880196, 29.499467329545453], 'topk_indices': array([3364, 3337, 3257, 3209, 7517, 7479, 1424, 1486, 4399, 4415, 5215,
       5276, 7256, 7200, 3520, 3546, 5017, 4992, 5069, 5040]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.9375, 28.263671875, 24.1796875, 26.462890625, 18.88125]}, 'saliency': {'score': [3.4098943074544272, 0.23024545823755008, 0.9377513212316176, 0.21797568174329537, 0.32696169072931464], 'topk_indices': array([  71, 8220, 4716,   82,   79,  122, 1802,  120,   31,  121,    0,
         84,   35,   83,  123,   88,   85,   87,  124,   86]), 'topk_tokens': [' Gutenberg', ' milk', ' milk', 'ISC', '\n\n\n\n', ' OF', ' milk', 'ISC', ' journey', 'ENCES', '<|begin_of_text|>', ' OF', ' bathroom', 'ENCES', ' P', 'ER', ' P', 'E', 'ION', 'ION'], 'evidence_proportions': [5.388671875, 5.030517578125, 1.86826171875, 4.65673828125, 0.28302001953125]}}, 'pred_res': 'the bathroom<|eot_id|>', 'score': 100}
2025-01-22 03:54:47.930 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 03:54:47.930 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-7_pid-4_0-2-5-6-7.pkl | len: 3 |  size: 2.03 KB
Processing depth (0, 2, 5, 6, 7):   5%|▌         | 5/100 [01:41<32:18, 20.41s/it]Processing depth (0, 2, 5, 6, 7):   5%|▌         | 5/100 [01:41<32:15, 20.37s/it]
2025-01-22 03:54:47.987 | INFO     | __main__:<module>:82 - Selected idx: 8
2025-01-22 03:54:47.987 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the milk before the kitchen? 
2025-01-22 03:54:47.987 | INFO     | __main__:<module>:84 - Answer: hallway
2025-01-22 03:54:47.987 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 03:54:47.987 | INFO     | __main__:<module>:86 - Needle: [' Mary journeyed to the office.', ' Daniel went back to the kitchen.', ' John moved to the bedroom.', ' Sandra picked up the milk.', ' Mary moved to the bathroom.', ' John went back to the bedroom.', ' John journeyed to the office.', ' Sandra travelled to the hallway.', ' Mary got the football there.', ' Sandra went to the kitchen.', ' Daniel went back to the hallway.']
2025-01-22 03:54:47.987 | INFO     | __main__:<module>:87 - Real Needle: [' Sandra picked up the milk.', ' Sandra travelled to the hallway.', ' Sandra went to the kitchen.', ' Daniel went back to the hallway.']
2025-01-22 03:54:47.988 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['👩🏻\u200d🎨', '🧜🏾\u200d♂', '🧑🏻\u200d❤\u200d🧑🏾', '🙅🏽\u200d♂', '🧑🏽\u200d🦼\u200d➡', '👩🏾\u200d🔧', '🏊\u200d♀', '🏟️', '🧖🏽\u200d♂️', '🧷']
emoji:
O: 👩🏻‍🎨 [9468, 239, 102, 9468, 237, 119, 102470, 9468, 236, 101]
N: 🧜🏾‍♂ [9468, 100, 250, 9468, 237, 122, 102470, 17245, 224]

O: 🧜🏾‍♂ [9468, 100, 250, 9468, 237, 122, 102470, 17245, 224]
N: 🏊‍♀ [9468, 237, 232, 102470, 32990]

O: 🧑🏻‍❤‍🧑🏾 [9468, 100, 239, 9468, 237, 119, 102470, 121643, 102470, 9468, 100, 239, 9468, 237, 122]
N: 🧑🏽‍🦼‍➡ [9468, 100, 239, 9468, 237, 121, 102470, 9468, 99, 120, 102470, 98115, 94]

O: 🙅🏽‍♂ [9468, 247, 227, 9468, 237, 121, 102470, 17245, 224]
N: 👩🏻‍🎨 [9468, 239, 102, 9468, 237, 119, 102470, 9468, 236, 101]

O: 🧑🏽‍🦼‍➡ [9468, 100, 239, 9468, 237, 121, 102470, 9468, 99, 120, 102470, 98115, 94]
N: 👩🏾‍🔧 [9468, 239, 102, 9468, 237, 122, 102470, 9468, 242, 100]

O: 👩🏾‍🔧 [9468, 239, 102, 9468, 237, 122, 102470, 9468, 242, 100]
N: 🧖🏽‍♂️ [9468, 100, 244, 9468, 237, 121, 102470, 17245, 224, 31643]

O: 🏊‍♀ [9468, 237, 232, 102470, 32990]
N: 🧑🏻‍❤‍🧑🏾 [9468, 100, 239, 9468, 237, 119, 102470, 121643, 102470, 9468, 100, 239, 9468, 237, 122]

O: 🏟️ [9468, 237, 253, 31643]
N: 🙅🏽‍♂ [9468, 247, 227, 9468, 237, 121, 102470, 17245, 224]

O: 🧖🏽‍♂️ [9468, 100, 244, 9468, 237, 121, 102470, 17245, 224, 31643]
N: 🏟️ [9468, 237, 253, 31643]

O: 🧷 [9468, 100, 115]
N: 🧷 [9468, 100, 115]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.37s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.99s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.49s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  2.91s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.55s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 2, 7, 9):   0%|          | 0/100 [00:15<?, ?it/s]2025-01-22 03:55:03.916 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra picked up the milk.
2025-01-22 03:55:03.916 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (32, 37) -->  picked up the milk.
2025-01-22 03:55:03.917 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra travelled to the hallway.
2025-01-22 03:55:03.925 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1807, 1812) -->  Sandra travelled to the hallway
2025-01-22 03:55:03.926 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went to the kitchen.
2025-01-22 03:55:03.939 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2711, 2716) -->  back to the kitchen.
2025-01-22 03:55:03.939 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went back to the hallway.
2025-01-22 03:55:03.953 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2708, 2714) --> . Daniel went back to the
2025-01-22 03:55:03.953 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the office.
2025-01-22 03:55:03.980 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5318, 5324) --> . Mary journeyed to the
2025-01-22 03:55:03.980 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went back to the kitchen.
2025-01-22 03:55:03.996 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2708, 2714) --> . Daniel went back to the
2025-01-22 03:55:03.996 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the bedroom.
2025-01-22 03:55:04.029 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6693, 6698) --> . John moved to the
2025-01-22 03:55:04.029 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the bathroom.
2025-01-22 03:55:04.029 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (35, 40) -->  milk. Mary moved to
2025-01-22 03:55:04.029 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went back to the bedroom.
2025-01-22 03:55:04.053 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4546, 4552) -->  John went back to the bedroom
2025-01-22 03:55:04.053 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John journeyed to the office.
2025-01-22 03:55:04.083 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (5319, 5325) -->  Mary journeyed to the office
2025-01-22 03:55:04.083 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Mary got the football there.
2025-01-22 03:55:04.112 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (5030, 5035) --> . Mary got the football
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 03:55:07.434 | INFO     | test_jbb_embedding:begin_test:693 - The hallway.<|eot_id|>
2025-01-22 03:55:07.434 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8179])
2025-01-22 03:55:10.338 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [383.1547619047619, 33.989458567587384, 142.40464743589743, 32.566082091849296, 40.10094246031746], 'topk_indices': array([  70, 8077, 8166, 6086,   71,   36,   14,   72, 8169, 8175,   24,
         73,    1, 8167, 1811,   74,   75, 8174,  112,    0]), 'topk_tokens': ['ISC', ' location', ' milk', 'the', 'ENCES', '.', '\n', ' OF', ' kitchen', '<|start_header_id|>', '\n\n', ' P', '<|start_header_id|>', ' before', ' hallway', 'ION', 'E', '<|eot_id|>', 'ION', '<|begin_of_text|>'], 'evidence_proportions': [528.55, 510.45, 308.2, 218.375]}, 'weight': {'score': [22.501116071428573, 23.27166149780005, 22.14483173076923, 23.279064577690225, 29.87921626984127], 'topk_indices': array([3314, 3287, 3159, 3207, 7426, 7464, 1480, 1418, 4288, 4272, 5173,
       5112, 7203, 7147, 3496, 3470, 4908, 4960, 4883, 4931]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.025, 28.2453125, 19.121875, 20.927083333333332]}, 'saliency': {'score': [2.298246837797619, 0.19260132164163712, 0.7869575696113782, 0.18430306388368398, 0.29540264795696924], 'topk_indices': array([  35,   69,   32, 5957, 6086, 8161, 8077,   73,   41,   31, 1807,
         70, 8166,   71,   75, 8167,   74, 8169,  112, 1811]), 'topk_tokens': [' milk', 'MIN', ' picked', ' office', 'the', 'Question', ' location', ' P', ' bathroom', 'andra', ' Sandra', 'ISC', ' milk', 'ENCES', 'E', ' before', 'ION', ' kitchen', 'ION', ' hallway'], 'evidence_proportions': [2.738671875, 3.9921875, 1.52529296875, 1.1637369791666667]}}, 'pred_res': 'The hallway.<|eot_id|>', 'score': 100}
2025-01-22 03:55:10.345 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 03:55:10.345 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-8_pid-0_0-2-7-9.pkl | len: 3 |  size: 2.0 KB
Processing depth (0, 2, 7, 9):   1%|          | 1/100 [00:22<36:44, 22.27s/it]is_0k: False
your chose emoji: ['🧗🏾\u200d♀️', '🚶🏾\u200d♂\u200d➡', '⛲', '👩🏻\u200d❤️\u200d👨🏽', '⛰️', '🫀', '\U0001f6dd', '🇹🇴', '🕝', '🧞\u200d♂']
emoji:
O: 🧗🏾‍♀️ [9468, 100, 245, 9468, 237, 122, 102470, 32990, 31643]
N: �� [251, 9468, 243]

O: 🚶🏾‍♂‍➡ [9468, 248, 114, 9468, 237, 122, 102470, 17245, 224, 102470, 98115, 94]
N: �🚶🏾‍♂‍� [94, 9468, 248, 114, 9468, 237, 122, 102470, 17245, 224, 102470, 98115]

O: ⛲ [158, 249, 110]
N: �� [251, 9468, 249]

O: 👩🏻‍❤️‍👨🏽 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 121]
N: ️⛰ [31643, 158, 120388]

O: ⛰️ [158, 120388, 31643]
N: �� [110, 158, 249]

O: 🫀 [9468, 104, 222]
N: ��🇹� [114783, 9468, 229, 117, 9468]

O: 🛝 [9468, 249, 251]
N: ️🧗🏾‍♀ [31643, 9468, 100, 245, 9468, 237, 122, 102470, 32990]

O: 🇹🇴 [9468, 229, 117, 9468, 114783]
N: �👩🏻‍❤️‍👨� [121, 9468, 239, 102, 9468, 237, 119, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237]

O: 🕝 [9468, 243, 251]
N: �� [222, 9468, 104]

O: 🧞‍♂ [9468, 100, 252, 102470, 17245, 224]
N: �🧞‍� [224, 9468, 100, 252, 102470, 17245]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.15s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.61s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.84s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.36s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.82s/it]
Processing depth (0, 3, 5, 9):   1%|          | 1/100 [00:39<36:44, 22.27s/it]2025-01-22 03:55:27.471 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra picked up the milk.
2025-01-22 03:55:27.472 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (32, 37) -->  picked up the milk.
2025-01-22 03:55:27.472 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra travelled to the hallway.
2025-01-22 03:55:27.488 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2866, 2871) -->  Sandra travelled to the hallway
2025-01-22 03:55:27.488 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went to the kitchen.
2025-01-22 03:55:27.502 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2585, 2590) -->  back to the kitchen.
2025-01-22 03:55:27.502 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went back to the hallway.
2025-01-22 03:55:27.518 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2582, 2588) --> . Daniel went back to the
2025-01-22 03:55:27.518 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the office.
2025-01-22 03:55:27.547 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5550, 5556) --> . Mary journeyed to the
2025-01-22 03:55:27.547 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went back to the kitchen.
2025-01-22 03:55:27.560 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2582, 2588) --> . Daniel went back to the
2025-01-22 03:55:27.561 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the bedroom.
2025-01-22 03:55:27.599 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6817, 6822) --> . John moved to the
2025-01-22 03:55:27.599 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the bathroom.
2025-01-22 03:55:27.599 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (35, 40) -->  milk. Mary moved to
2025-01-22 03:55:27.599 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went back to the bedroom.
2025-01-22 03:55:27.624 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4582, 4588) -->  John went back to the bedroom
2025-01-22 03:55:27.624 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John journeyed to the office.
2025-01-22 03:55:27.657 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (5551, 5557) -->  Mary journeyed to the office
2025-01-22 03:55:27.657 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Mary got the football there.
2025-01-22 03:55:27.687 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (5220, 5225) --> . Mary got the football
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 03:55:28.633 | INFO     | test_jbb_embedding:begin_test:693 - Sandra picked up the milk.<|eot_id|>
2025-01-22 03:55:28.633 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8211])
2025-01-22 03:55:30.882 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [667.1190476190476, 45.13653518383248, 250.69070512820514, 42.55151612705421, 42.662109375], 'topk_indices': array([8199, 1241, 1260,   29, 8206, 2866,   24,  386,   40,   71, 2870,
         72,  358,   74,   73,   36,   75, 1261,  112,    0]), 'topk_tokens': [' before', 'nes', 'Min', '\n\n', '<|eot_id|>', ' Sandra', '\n\n', ' past', ' the', 'ENCES', ' hallway', ' OF', ' century', 'ION', ' P', '.', 'E', 'nes', 'ION', '<|begin_of_text|>'], 'evidence_proportions': [981.2, 818.1, 532.8, 391.5]}, 'weight': {'score': [22.501116071428573, 23.2826024926954, 22.14483173076923, 23.290057027225902, 29.109770569620252], 'topk_indices': array([3350, 3323, 3243, 3195, 7464, 7502, 1472, 1534, 4308, 4324, 5126,
       5187, 7222, 7166, 3532, 3506, 4903, 4928, 4980, 4951]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.025, 28.2453125, 19.121875, 20.927083333333332]}, 'saliency': {'score': [4.0009765625, 0.25757290691768625, 1.3840112930689104, 0.24254438425063618, 0.3011576978466179], 'topk_indices': array([4244,   31,   32,  357,   35, 1241, 4247,   73,   75, 8198,  386,
       1260,   70,   74,   71,  358, 2866, 2870, 1261,  112]), 'topk_tokens': ['ree', 'andra', ' picked', ' past', ' milk', 'nes', 'outs', ' P', 'E', ' milk', ' past', 'Min', 'ISC', 'ION', 'ENCES', ' century', ' Sandra', ' hallway', 'nes', 'ION'], 'evidence_proportions': [5.16796875, 6.445703125, 2.6470703125, 2.1194661458333335]}}, 'pred_res': 'Sandra picked up the milk.<|eot_id|>', 'score': 0}
2025-01-22 03:55:30.889 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 03:55:30.889 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-8_pid-1_0-3-5-9.pkl | len: 3 |  size: 1.96 KB
Processing depth (0, 3, 5, 9):   2%|▏         | 2/100 [00:42<34:42, 21.25s/it]is_0k: False
your chose emoji: ['🧺', '🇻🇺', '🙋🏾\u200d♂', '👩🏻\u200d🎓', '🧕🏻', '🦻🏿', '🤾🏼\u200d♂️', '🧑🏽\u200d❤️\u200d🧑🏻', '👩🏽\u200d🦰', '⚡']
emoji:
O: 🧺 [9468, 100, 118]
N: ️🤾🏼‍♂ [31643, 9468, 97, 122, 9468, 237, 120, 102470, 17245, 224]

O: 🇻🇺 [9468, 229, 119, 9468, 229, 118]
N: �👩🏻‍� [241, 9468, 239, 102, 9468, 237, 119, 102470, 9468, 236]

O: 🙋🏾‍♂ [9468, 247, 233, 9468, 237, 122, 102470, 17245, 224]
N: �👩🏽‍� [108, 9468, 239, 102, 9468, 237, 121, 102470, 9468, 99]

O: 👩🏻‍🎓 [9468, 239, 102, 9468, 237, 119, 102470, 9468, 236, 241]
N: �🧕� [119, 9468, 100, 243, 9468, 237]

O: 🧕🏻 [9468, 100, 243, 9468, 237, 119]
N: �� [118, 9468, 100]

O: 🦻🏿 [9468, 99, 119, 9468, 237, 123]
N: �🧑🏽‍❤️‍🧑� [119, 9468, 100, 239, 9468, 237, 121, 102470, 121643, 31643, 102470, 9468, 100, 239, 9468, 237]

O: 🤾🏼‍♂️ [9468, 97, 122, 9468, 237, 120, 102470, 17245, 224, 31643]
N: �🙋🏾‍� [224, 9468, 247, 233, 9468, 237, 122, 102470, 17245]

O: 🧑🏽‍❤️‍🧑🏻 [9468, 100, 239, 9468, 237, 121, 102470, 121643, 31643, 102470, 9468, 100, 239, 9468, 237, 119]
N: �🇻� [118, 9468, 229, 119, 9468, 229]

O: 👩🏽‍🦰 [9468, 239, 102, 9468, 237, 121, 102470, 9468, 99, 108]
N: �🦻� [123, 9468, 99, 119, 9468, 237]

O: ⚡ [158, 248, 94]
N: �� [94, 158, 248]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.06s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.37s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.17s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.70s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.25s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (1, 5, 7, 9):   2%|▏         | 2/100 [00:57<34:42, 21.25s/it]2025-01-22 03:55:45.649 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra picked up the milk.
2025-01-22 03:55:45.654 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (901, 906) --> . Sandra picked up the
2025-01-22 03:55:45.654 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra travelled to the hallway.
2025-01-22 03:55:45.675 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4205, 4210) -->  Sandra travelled to the hallway
2025-01-22 03:55:45.675 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went to the kitchen.
2025-01-22 03:55:45.688 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2700, 2705) -->  back to the kitchen.
2025-01-22 03:55:45.689 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went back to the hallway.
2025-01-22 03:55:45.704 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2697, 2703) --> . Daniel went back to the
2025-01-22 03:55:45.704 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the office.
2025-01-22 03:55:45.733 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5118, 5124) -->  Mary journeyed to the office
2025-01-22 03:55:45.733 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went back to the kitchen.
2025-01-22 03:55:45.747 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2697, 2703) --> . Daniel went back to the
2025-01-22 03:55:45.747 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the bedroom.
2025-01-22 03:55:45.785 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6656, 6661) --> . John moved to the
2025-01-22 03:55:45.785 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the bathroom.
2025-01-22 03:55:45.786 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (31, 36) -->  moved to the bathroom.
2025-01-22 03:55:45.786 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went back to the bedroom.
2025-01-22 03:55:45.809 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4494, 4500) --> . John went back to the
2025-01-22 03:55:45.809 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John journeyed to the office.
2025-01-22 03:55:45.840 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (5119, 5125) -->  journeyed to the office.
2025-01-22 03:55:45.840 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Mary got the football there.
2025-01-22 03:55:45.866 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (4993, 4998) --> . Mary got the football
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 03:55:52.435 | INFO     | test_jbb_embedding:begin_test:693 - The milk was in the kitchen.<|eot_id|>
2025-01-22 03:55:52.435 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8170])
2025-01-22 03:55:55.304 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [222.03571428571428, 19.907366481096293, 100.45352564102564, 18.996976303463576, 28.759020789194917], 'topk_indices': array([  23,    1,    9,   68, 8024, 8161,   67,  907, 4209,    3, 7362,
       8160, 8158,   28, 8168,   24,   14, 8165, 8166,    0]), 'topk_tokens': ['4', '<|start_header_id|>', ':', 'E', ' context', '?', 'ION', '.', ' hallway', '<|end_header_id|>', 'nes', ' kitchen', ' before', '<|end_header_id|>', '<|end_header_id|>', '\n\n', '\n', '<|eot_id|>', '<|start_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [267.925, 282.1, 213.9, 140.52083333333334]}, 'weight': {'score': [22.850818452380953, 23.250118530527345, 20.965745192307693, 23.262133304572906, 28.76800847457627], 'topk_indices': array([3276, 3303, 3148, 3196, 7447, 7409, 1437, 1499, 4303, 4287, 5213,
       5152, 7130, 7186, 3485, 3459, 4906, 4931, 4983, 4954]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [23.49375, 28.2453125, 19.121875, 20.927083333333332]}, 'saliency': {'score': [1.3480864025297619, 0.11192818579468983, 0.5527656750801282, 0.10660931674087884, 0.2100453780869306], 'topk_indices': array([7361,    0,  185,  105, 8152, 8068,   38, 8161,  906,   24,  902,
       8157,  908,   67, 8024,   34, 7362, 8158, 8160, 4209]), 'topk_tokens': [' Min', '<|begin_of_text|>', 'ION', 'ION', 'Question', ' location', '***', '?', ' milk', '\n\n', ' Sandra', ' milk', '�', 'ION', ' context', ' bathroom', 'nes', ' before', ' kitchen', ' hallway'], 'evidence_proportions': [1.64130859375, 2.12529296875, 1.039111328125, 0.7135416666666666]}}, 'pred_res': 'The milk was in the kitchen.<|eot_id|>', 'score': 0}
2025-01-22 03:55:55.308 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 03:55:55.308 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-8_pid-2_1-5-7-9.pkl | len: 3 |  size: 2.05 KB
Processing depth (1, 5, 7, 9):   3%|▎         | 3/100 [01:07<36:41, 22.70s/it]is_0k: False
your chose emoji: ['🇸🇸', '👨🏼\u200d⚖', '🚵🏿\u200d♂️', '\U0001faad', '🤸🏼', '👬', '🌠', '✋🏻', '🌚', '🧑🏻\u200d🏭']
emoji:
O: 🇸🇸 [9468, 229, 116, 9468, 229, 116]
N: 🚵🏿‍♂️ [9468, 248, 113, 9468, 237, 123, 102470, 17245, 224, 31643]

O: 👨🏼‍⚖ [9468, 239, 101, 9468, 237, 120, 102470, 158, 248, 244]
N: 🪭 [9468, 103, 255]

O: 🚵🏿‍♂️ [9468, 248, 113, 9468, 237, 123, 102470, 17245, 224, 31643]
N: 🌚 [9468, 234, 248]

O: 🪭 [9468, 103, 255]
N: 👨🏼‍⚖ [9468, 239, 101, 9468, 237, 120, 102470, 158, 248, 244]

O: 🤸🏼 [9468, 97, 116, 9468, 237, 120]
N: 🌠 [9468, 234, 254]

O: 👬 [9468, 239, 105]
N: 🤸🏼 [9468, 97, 116, 9468, 237, 120]

O: 🌠 [9468, 234, 254]
N: 🇸🇸 [9468, 229, 116, 9468, 229, 116]

O: ✋🏻 [38798, 233, 9468, 237, 119]
N: ✋🏻 [38798, 233, 9468, 237, 119]

O: 🌚 [9468, 234, 248]
N: 👬 [9468, 239, 105]

O: 🧑🏻‍🏭 [9468, 100, 239, 9468, 237, 119, 102470, 9468, 237, 255]
N: 🧑🏻‍🏭 [9468, 100, 239, 9468, 237, 119, 102470, 9468, 237, 255]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.96s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.72s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.52s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.15s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.71s/it]
Processing depth (2, 3, 6, 8):   3%|▎         | 3/100 [01:23<36:41, 22.70s/it]2025-01-22 03:56:11.938 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra picked up the milk.
2025-01-22 03:56:11.947 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1781, 1786) --> . Sandra picked up the
2025-01-22 03:56:11.948 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra travelled to the hallway.
2025-01-22 03:56:11.961 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2734, 2739) --> . Sandra travelled to the
2025-01-22 03:56:11.961 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went to the kitchen.
2025-01-22 03:56:11.979 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2524, 2529) -->  back to the kitchen.
2025-01-22 03:56:11.979 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went back to the hallway.
2025-01-22 03:56:11.994 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2521, 2527) --> . Daniel went back to the
2025-01-22 03:56:11.995 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the office.
2025-01-22 03:56:12.021 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5129, 5135) --> . Mary journeyed to the
2025-01-22 03:56:12.021 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went back to the kitchen.
2025-01-22 03:56:12.033 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2521, 2527) --> . Daniel went back to the
2025-01-22 03:56:12.033 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the bedroom.
2025-01-22 03:56:12.067 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6667, 6672) --> . John moved to the
2025-01-22 03:56:12.067 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the bathroom.
2025-01-22 03:56:12.068 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (31, 36) -->  moved to the bathroom.
2025-01-22 03:56:12.068 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went back to the bedroom.
2025-01-22 03:56:12.092 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4469, 4475) -->  execution. John went back to
2025-01-22 03:56:12.092 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John journeyed to the office.
2025-01-22 03:56:12.121 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (5130, 5136) -->  Mary journeyed to the office
2025-01-22 03:56:12.121 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Mary got the football there.
2025-01-22 03:56:12.147 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (4957, 4962) --> . Mary got the football
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 03:56:12.956 | INFO     | test_jbb_embedding:begin_test:693 - The hallway.<|eot_id|>
2025-01-22 03:56:12.957 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8168])
2025-01-22 03:56:15.167 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [426.42857142857144, 35.43161026802105, 195.08653846153845, 33.65162279620269, 17.071373248922413], 'topk_indices': array([1787, 1206,  425,   14,   24, 1166,  185, 1782, 8158, 8156,   35,
         34, 2739, 7288, 7317, 7365, 8163, 8164, 7366,    0]), 'topk_tokens': ['.', 'nes', ' ', '\n', '\n\n', 'nes', 'ION', ' Sandra', ' kitchen', ' before', '.', ' bathroom', ' hallway', 'nes', 'nes', ' Min', '<|eot_id|>', '<|start_header_id|>', 'nes', '<|begin_of_text|>'], 'evidence_proportions': [590.95, 380.8, 437.4, 318.2083333333333]}, 'weight': {'score': [21.399553571428573, 23.259159680577653, 21.615785256410255, 23.271876155837752, 29.5], 'topk_indices': array([3306, 3333, 3226, 3178, 7413, 7451, 1479, 1417, 4337, 4321, 5164,
       5225, 7134, 7190, 3489, 3515, 5011, 4953, 4982, 4928]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [23.49375, 22.15, 19.121875, 20.927083333333332]}, 'saliency': {'score': [2.4044596354166665, 0.19922802740350784, 1.0908453525641026, 0.18923136368145882, 0.12435689465752964], 'topk_indices': array([1146, 8022, 2736,   31, 2527,  185, 1206, 8155, 1786, 1783, 1166,
       8156, 8158, 7288, 7317, 1782,   34, 7365, 2739, 7366]), 'topk_tokens': ['nes', ' context', ' travelled', ' moved', ' kitchen', 'ION', 'nes', ' milk', ' milk', ' picked', 'nes', ' before', ' kitchen', 'nes', 'nes', ' Sandra', ' bathroom', ' Min', ' hallway', 'nes'], 'evidence_proportions': [3.71796875, 2.23515625, 2.12724609375, 1.6819661458333333]}}, 'pred_res': 'The hallway.<|eot_id|>', 'score': 100}
2025-01-22 03:56:15.175 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 03:56:15.175 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-8_pid-3_2-3-6-8.pkl | len: 3 |  size: 1.99 KB
Processing depth (2, 3, 6, 8):   4%|▍         | 4/100 [01:27<34:31, 21.58s/it]is_0k: False
your chose emoji: ['♍', '🚢', '🚣🏽\u200d♂', '👗', '\U0001faf5🏻', '🧎🏽\u200d♀️\u200d➡️', '🧝🏽\u200d♀️', '\U0001faf8', '📻', '👨\u200d👧']
emoji:
O: ♍ [17245, 235]
N: 🚢 [9468, 248, 95]

O: 🚢 [9468, 248, 95]
N: 📻 [9468, 241, 119]

O: 🚣🏽‍♂ [9468, 248, 96, 9468, 237, 121, 102470, 17245, 224]
N: 🫵🏻 [9468, 104, 113, 9468, 237, 119]

O: 👗 [9468, 239, 245]
N: 🫸 [9468, 104, 116]

O: 🫵🏻 [9468, 104, 113, 9468, 237, 119]
N: 🧎🏽‍♀️‍➡️ [9468, 100, 236, 9468, 237, 121, 102470, 32990, 31643, 102470, 98115, 94, 31643]

O: 🧎🏽‍♀️‍➡️ [9468, 100, 236, 9468, 237, 121, 102470, 32990, 31643, 102470, 98115, 94, 31643]
N: 🧝🏽‍♀️ [9468, 100, 251, 9468, 237, 121, 102470, 32990, 31643]

O: 🧝🏽‍♀️ [9468, 100, 251, 9468, 237, 121, 102470, 32990, 31643]
N: 🚣🏽‍♂ [9468, 248, 96, 9468, 237, 121, 102470, 17245, 224]

O: 🫸 [9468, 104, 116]
N: 👗 [9468, 239, 245]

O: 📻 [9468, 241, 119]
N: ♍ [17245, 235]

O: 👨‍👧 [9468, 239, 101, 102470, 9468, 239, 100]
N: 👨‍👧 [9468, 239, 101, 102470, 9468, 239, 100]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:11,  3.87s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:09,  4.59s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.72s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.30s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.74s/it]
Processing depth (3, 5, 6, 7):   4%|▍         | 4/100 [01:43<34:31, 21.58s/it]2025-01-22 03:56:31.773 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra picked up the milk.
2025-01-22 03:56:31.787 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2915, 2920) -->  Sandra picked up the milk
2025-01-22 03:56:31.788 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra travelled to the hallway.
2025-01-22 03:56:31.808 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4225, 4230) -->  Sandra travelled to the hallway
2025-01-22 03:56:31.809 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went to the kitchen.
2025-01-22 03:56:31.822 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2716, 2721) -->  back to the kitchen.
2025-01-22 03:56:31.823 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went back to the hallway.
2025-01-22 03:56:31.836 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2713, 2719) --> . Daniel went back to the
2025-01-22 03:56:31.836 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the office.
2025-01-22 03:56:31.863 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5363, 5369) --> . Mary journeyed to the
2025-01-22 03:56:31.863 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went back to the kitchen.
2025-01-22 03:56:31.877 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2713, 2719) --> . Daniel went back to the
2025-01-22 03:56:31.877 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the bedroom.
2025-01-22 03:56:31.911 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6711, 6716) --> . John moved to the
2025-01-22 03:56:31.911 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the bathroom.
2025-01-22 03:56:31.911 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (31, 36) -->  moved to the bathroom.
2025-01-22 03:56:31.911 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went back to the bedroom.
2025-01-22 03:56:31.939 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4575, 4581) -->  John went back to the bedroom
2025-01-22 03:56:31.939 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John journeyed to the office.
2025-01-22 03:56:31.966 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (5364, 5370) -->  Mary journeyed to the office
2025-01-22 03:56:31.966 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Mary got the football there.
2025-01-22 03:56:31.995 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (5113, 5118) --> . Mary got the football
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 03:56:32.743 | INFO     | test_jbb_embedding:begin_test:693 - the hallway<|eot_id|>
2025-01-22 03:56:32.744 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8190])
2025-01-22 03:56:34.977 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [367.36309523809524, 28.457135664591725, 170.35016025641025, 26.90163915529325, 43.295120018115945], 'topk_indices': array([5113, 2899, 4248, 8088, 4251, 8044, 2920, 5114, 2919, 8178,   14,
       4239, 4249, 4229, 4238, 8185, 4240, 4237,    0, 8186]), 'topk_tokens': ['.', '�', ' B', ' location', ' Cl', ' context', '.', ' Mary', ' milk', ' before', '\n', ' Cl', 'ree', ' hallway', 'ch', '<|eot_id|>', 'outs', 'ree', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [526.55, 582.2, 228.4625, 171.42708333333334]}, 'weight': {'score': [23.93452380952381, 23.278343555474184, 21.739983974358974, 23.28402611275052, 29.644021739130434], 'topk_indices': array([3316, 3343, 3236, 3188, 7469, 7431, 1497, 1435, 4301, 4317, 5147,
       5208, 7152, 7208, 3525, 3499, 4966, 4943, 4918, 4995]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.0453125, 28.2453125, 19.121875, 20.927083333333332]}, 'saliency': {'score': [2.4766787574404763, 0.1619816727360628, 1.0078375400641026, 0.15194884135716372, 0.32602857506793476], 'topk_indices': array([2916, 2897, 5117, 4226, 8177, 8088, 8180, 8172, 8178, 2915, 8044,
       4251, 5114, 2919, 4239, 4249, 4238, 4229, 4240, 4237]), 'topk_tokens': [' picked', '�', ' football', ' travelled', ' milk', ' location', ' kitchen', 'Question', ' before', ' Sandra', ' context', ' Cl', ' Mary', ' milk', ' Cl', 'ree', 'ch', ' hallway', 'outs', 'ree'], 'evidence_proportions': [3.8173828125, 4.30625, 1.15322265625, 0.9376627604166666]}}, 'pred_res': 'the hallway<|eot_id|>', 'score': 100}
2025-01-22 03:56:34.983 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 03:56:34.984 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-8_pid-4_3-5-6-7.pkl | len: 3 |  size: 1.99 KB
Processing depth (3, 5, 6, 7):   5%|▌         | 5/100 [01:46<33:09, 20.94s/it]Processing depth (3, 5, 6, 7):   5%|▌         | 5/100 [01:46<33:52, 21.40s/it]
2025-01-22 03:56:35.052 | INFO     | __main__:<module>:82 - Selected idx: 9
2025-01-22 03:56:35.052 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the location prior to the place where the milk was discarded, left or dropped?
2025-01-22 03:56:35.052 | INFO     | __main__:<module>:84 - Answer: hallway
2025-01-22 03:56:35.053 | INFO     | __main__:<module>:85 - Tag: 4-hop
2025-01-22 03:56:35.053 | INFO     | __main__:<module>:86 - Needle: [' Mary got the football there.', ' Sandra travelled to the hallway.', ' Mary moved to the bathroom.', ' Daniel went back to the kitchen.', ' Sandra picked up the milk.', ' John went back to the bedroom.', ' John moved to the bedroom.', ' Sandra went to the kitchen.', ' Mary journeyed to the office.', ' John journeyed to the office.', ' Sandra left the milk.', ' Daniel went back to the hallway.']
2025-01-22 03:56:35.053 | INFO     | __main__:<module>:87 - Real Needle: [' Sandra travelled to the hallway.', ' Sandra picked up the milk.', ' Sandra went to the kitchen.', ' Sandra left the milk.', ' Daniel went back to the hallway.']
2025-01-22 03:56:35.053 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['👨\u200d⚖️', '🚣🏽\u200d♀️', '❤\u200d🔥', '👩🏾\u200d❤\u200d👩🏼', '👕', '👷🏿\u200d♀', '🔚', '✂️', '🤹🏻\u200d♂', '🇨🇺']
emoji:
O: 👨‍⚖️ [9468, 239, 101, 102470, 158, 248, 244, 31643]
N: 👩🏾‍❤‍👩🏼 [9468, 239, 102, 9468, 237, 122, 102470, 121643, 102470, 9468, 239, 102, 9468, 237, 120]

O: 🚣🏽‍♀️ [9468, 248, 96, 9468, 237, 121, 102470, 32990, 31643]
N: 🤹🏻‍♂ [9468, 97, 117, 9468, 237, 119, 102470, 17245, 224]

O: ❤‍🔥 [121643, 102470, 9468, 242, 98]
N: 🚣🏽‍♀️ [9468, 248, 96, 9468, 237, 121, 102470, 32990, 31643]

O: 👩🏾‍❤‍👩🏼 [9468, 239, 102, 9468, 237, 122, 102470, 121643, 102470, 9468, 239, 102, 9468, 237, 120]
N: 👕 [9468, 239, 243]

O: 👕 [9468, 239, 243]
N: 👨‍⚖️ [9468, 239, 101, 102470, 158, 248, 244, 31643]

O: 👷🏿‍♀ [9468, 239, 115, 9468, 237, 123, 102470, 32990]
N: ❤‍🔥 [121643, 102470, 9468, 242, 98]

O: 🔚 [9468, 242, 248]
N: 👷🏿‍♀ [9468, 239, 115, 9468, 237, 123, 102470, 32990]

O: ✂️ [38798, 224, 31643]
N: ✂️ [38798, 224, 31643]

O: 🤹🏻‍♂ [9468, 97, 117, 9468, 237, 119, 102470, 17245, 224]
N: 🔚 [9468, 242, 248]

O: 🇨🇺 [9468, 229, 101, 9468, 229, 118]
N: 🇨🇺 [9468, 229, 101, 9468, 229, 118]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:11,  3.86s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.20s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:11<00:03,  3.96s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  2.58s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  3.11s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 1, 2, 5, 8):   0%|          | 0/100 [00:14<?, ?it/s]2025-01-22 03:56:49.314 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra travelled to the hallway.
2025-01-22 03:56:49.315 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (32, 37) -->  travelled to the hallway.
2025-01-22 03:56:49.315 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra picked up the milk.
2025-01-22 03:56:49.320 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (828, 833) --> . Sandra picked up the
2025-01-22 03:56:49.320 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went to the kitchen.
2025-01-22 03:56:49.329 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1747, 1752) -->  Sandra went to the kitchen
2025-01-22 03:56:49.329 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra left the milk.
2025-01-22 03:56:49.349 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4152, 4156) -->  Sandra left the milk
2025-01-22 03:56:49.350 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel went back to the hallway.
2025-01-22 03:56:49.383 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6604, 6610) --> . Daniel went back to the
2025-01-22 03:56:49.383 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the football there.
2025-01-22 03:56:49.392 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1814, 1819) --> . Mary got the football
2025-01-22 03:56:49.392 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary moved to the bathroom.
2025-01-22 03:56:49.426 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5827, 5832) -->  Mary moved to the bathroom
2025-01-22 03:56:49.426 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the kitchen.
2025-01-22 03:56:49.461 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6604, 6610) --> . Daniel went back to the
2025-01-22 03:56:49.462 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the bedroom.
2025-01-22 03:56:49.475 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2452, 2458) --> . John went back to the
2025-01-22 03:56:49.475 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John moved to the bedroom.
2025-01-22 03:56:49.477 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (368, 373) --> . John moved to the
2025-01-22 03:56:49.477 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary journeyed to the office.
2025-01-22 03:56:49.512 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (6669, 6675) --> . Mary journeyed to the
2025-01-22 03:56:49.512 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  John journeyed to the office.
2025-01-22 03:56:49.548 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (6670, 6676) -->  Mary journeyed to the office
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 03:56:52.881 | INFO     | test_jbb_embedding:begin_test:693 - kitchen<|eot_id|>
2025-01-22 03:56:52.881 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8183])
2025-01-22 03:56:56.039 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [504.095, 38.2212084656731, 130.6073717948718, 36.34360379216942, 89.75700431034483], 'topk_indices': array([ 828, 8062,   36, 4155, 8157, 4156, 8162,  554,  555,  833, 8168,
       8163,   32, 8178,   14, 8170,  834,   35, 8179,    0]), 'topk_tokens': ['.', '.\n\n', '.', ' milk', ':', '.', ' prior', ' to', ' ', ' milk', ' milk', ' to', ' travelled', '<|eot_id|>', '\n', ' discarded', '.', ' hallway', '<|start_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [864.45, 637.0, 373.575, 601.375, 136.95833333333334]}, 'weight': {'score': [23.74375, 23.25784113119961, 21.637419871794872, 23.26412636973652, 29.51966594827586], 'topk_indices': array([3344, 3317, 3189, 3237, 7415, 7453, 1432, 1494, 4337, 4321, 5132,
       5193, 7192, 7136, 3526, 3500, 4957, 4986, 4909, 4934]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.225, 23.49375, 25.5859375, 27.876953125, 20.927083333333332]}, 'saliency': {'score': [3.2889892578125, 0.21469822298073693, 0.7260429186698718, 0.20278001084054112, 0.6420803727774784], 'topk_indices': array([8072, 1405,   40,   39, 7368, 1747, 1751, 4152,  373,  830, 8156,
        829,   31, 4155, 8162,  833, 8168,   32, 8170,   35]), 'topk_tokens': [' location', '�', '\n\n\n', '***', 'nes', ' Sandra', ' kitchen', ' Sandra', ' bedroom', ' picked', 'Question', ' Sandra', 'andra', ' milk', ' prior', ' milk', ' milk', ' travelled', ' discarded', ' hallway'], 'evidence_proportions': [5.5775390625, 3.8283203125, 2.70693359375, 4.206787109375, 0.80560302734375]}}, 'pred_res': 'kitchen<|eot_id|>', 'score': 0}
2025-01-22 03:56:56.046 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 03:56:56.046 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-9_pid-0_0-1-2-5-8.pkl | len: 3 |  size: 2.05 KB
Processing depth (0, 1, 2, 5, 8):   1%|          | 1/100 [00:20<34:29, 20.91s/it]is_0k: False
your chose emoji: ['👎', '🤾🏾\u200d♂️', '☄️', '🏚️', '👋🏾', '⏭', '⛹🏾', '🤾🏿', '🙍🏻\u200d♀', '🧖🏽\u200d♂']
emoji:
O: 👎 [9468, 239, 236]
N: �� [236, 9468, 239]

O: 🤾🏾‍♂️ [9468, 97, 122, 9468, 237, 122, 102470, 17245, 224, 31643]
N: ️🏚 [31643, 9468, 237, 248]

O: ☄️ [18107, 226, 31643]
N: �⛹� [122, 158, 249, 117, 9468, 237]

O: 🏚️ [9468, 237, 248, 31643]
N: �🤾� [123, 9468, 97, 122, 9468, 237]

O: 👋🏾 [9468, 239, 233, 9468, 237, 122]
N: ♀🙍🏻‍ [32990, 9468, 247, 235, 9468, 237, 119, 102470]

O: ⏭ [158, 237, 255]
N: ️🤾🏾‍♂ [31643, 9468, 97, 122, 9468, 237, 122, 102470, 17245, 224]

O: ⛹🏾 [158, 249, 117, 9468, 237, 122]
N: ️☄ [31643, 18107, 226]

O: 🤾🏿 [9468, 97, 122, 9468, 237, 123]
N: �👋� [122, 9468, 239, 233, 9468, 237]

O: 🙍🏻‍♀ [9468, 247, 235, 9468, 237, 119, 102470, 32990]
N: �� [255, 158, 237]

O: 🧖🏽‍♂ [9468, 100, 244, 9468, 237, 121, 102470, 17245, 224]
N: �🧖🏽‍� [224, 9468, 100, 244, 9468, 237, 121, 102470, 17245]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.43s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.29s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.11s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.89s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.39s/it]
Processing depth (0, 1, 2, 5, 7):   1%|          | 1/100 [00:36<34:29, 20.91s/it]2025-01-22 03:57:11.726 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra travelled to the hallway.
2025-01-22 03:57:11.726 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (32, 37) -->  travelled to the hallway.
2025-01-22 03:57:11.726 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra picked up the milk.
2025-01-22 03:57:11.731 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (834, 839) --> . Sandra picked up the
2025-01-22 03:57:11.731 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went to the kitchen.
2025-01-22 03:57:11.742 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1866, 1871) --> . Sandra went to the
2025-01-22 03:57:11.742 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra left the milk.
2025-01-22 03:57:11.764 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4213, 4217) -->  left the milk.
2025-01-22 03:57:11.764 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel went back to the hallway.
2025-01-22 03:57:11.797 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5596, 5602) --> . Daniel went back to the
2025-01-22 03:57:11.797 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the football there.
2025-01-22 03:57:11.808 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2036, 2041) --> . Mary got the football
2025-01-22 03:57:11.808 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary moved to the bathroom.
2025-01-22 03:57:11.842 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5823, 5828) --> . Mary moved to the
2025-01-22 03:57:11.842 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the kitchen.
2025-01-22 03:57:11.874 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5596, 5602) --> . Daniel went back to the
2025-01-22 03:57:11.875 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the bedroom.
2025-01-22 03:57:11.888 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2702, 2708) --> . John went back to the
2025-01-22 03:57:11.889 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John moved to the bedroom.
2025-01-22 03:57:11.891 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (374, 379) --> . John moved to the
2025-01-22 03:57:11.891 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary journeyed to the office.
2025-01-22 03:57:11.924 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (6637, 6643) --> . Mary journeyed to the
2025-01-22 03:57:11.924 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  John journeyed to the office.
2025-01-22 03:57:11.962 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (6638, 6644) -->  Mary journeyed to the office
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 03:57:12.737 | INFO     | test_jbb_embedding:begin_test:693 - kitchen<|eot_id|>
2025-01-22 03:57:12.737 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8169])
2025-01-22 03:57:14.957 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [421.7525, 33.95184777288301, 132.09935897435898, 32.28401732856438, 36.630821078431374], 'topk_indices': array([  36, 8048, 1871,   32,  839, 8154, 8150, 8142,   14,  840, 8143,
       8161,   35, 8014, 8156, 8148, 8149,    0, 8164, 8165]), 'topk_tokens': ['.', '.\n\n', ' kitchen', ' travelled', ' milk', ' milk', ' the', 'Question', '\n', '.', ':', '?\n', ' hallway', ' context', ' discarded', ' prior', ' to', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [713.05, 497.25, 318.6, 554.5625, 113.51041666666667]}, 'weight': {'score': [21.581875, 23.242386349730786, 20.908052884615383, 23.258734621669955, 29.14093137254902], 'topk_indices': array([3285, 3312, 3205, 3157, 7429, 7391, 1492, 1430, 4287, 4303, 5118,
       5179, 7105, 7161, 3506, 3480, 4972, 4920, 4943, 4895]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.225, 23.49375, 20.796875, 20.3515625, 20.927083333333332]}, 'saliency': {'score': [2.481064453125, 0.18873516275085658, 0.7026695838341346, 0.17919499567123134, 0.24963767855775124], 'topk_indices': array([ 379, 4269, 1867, 8152, 8161, 8144, 4215,  835,   31, 8147, 8149,
       1871,  839, 8154,   32, 8014, 8142, 8148,   35, 8156]), 'topk_tokens': [' bedroom', 'nes', ' Sandra', ' where', '?\n', ' Where', ' milk', ' Sandra', 'andra', ' location', ' to', ' kitchen', ' milk', ' milk', ' travelled', ' context', 'Question', ' prior', ' hallway', ' discarded'], 'evidence_proportions': [4.476953125, 2.99296875, 1.87353515625, 2.919677734375, 0.6051025390625]}}, 'pred_res': 'kitchen<|eot_id|>', 'score': 0}
2025-01-22 03:57:14.964 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 03:57:14.964 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-9_pid-1_0-1-2-5-7.pkl | len: 3 |  size: 2.07 KB
Processing depth (0, 1, 2, 5, 7):   2%|▏         | 2/100 [00:39<32:14, 19.74s/it]is_0k: False
your chose emoji: ['☣', '✊🏻', '🧔🏾\u200d♂️', '👰🏽\u200d♀', '💇', '👵', '🧓🏻', '🇧🇧', '🌵', '🇬🇺']
emoji:
O: ☣ [18107, 96]
N: �🧓� [119, 9468, 100, 241, 9468, 237]

O: ✊🏻 [38798, 232, 9468, 237, 119]
N: �✊� [119, 38798, 232, 9468, 237]

O: 🧔🏾‍♂️ [9468, 100, 242, 9468, 237, 122, 102470, 17245, 224, 31643]
N: �🇧� [100, 9468, 229, 100, 9468, 229]

O: 👰🏽‍♀ [9468, 239, 108, 9468, 237, 121, 102470, 32990]
N: �� [113, 9468, 234]

O: 💇 [93273, 229]
N: ️🧔🏾‍♂ [31643, 9468, 100, 242, 9468, 237, 122, 102470, 17245, 224]

O: 👵 [9468, 239, 113]
N: �� [229, 93273]

O: 🧓🏻 [9468, 100, 241, 9468, 237, 119]
N: �� [113, 9468, 239]

O: 🇧🇧 [9468, 229, 100, 9468, 229, 100]
N: �� [96, 18107]

O: 🌵 [9468, 234, 113]
N: ♀👰🏽‍ [32990, 9468, 239, 108, 9468, 237, 121, 102470]

O: 🇬🇺 [9468, 229, 105, 9468, 229, 118]
N: �🇬� [118, 9468, 229, 105, 9468, 229]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:05<00:15,  5.18s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.80s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.50s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.05s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.67s/it]
Processing depth (2, 3, 4, 5, 8):   2%|▏         | 2/100 [00:56<32:14, 19.74s/it]2025-01-22 03:57:31.391 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra travelled to the hallway.
2025-01-22 03:57:31.400 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1731, 1736) --> . Sandra travelled to the
2025-01-22 03:57:31.400 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra picked up the milk.
2025-01-22 03:57:31.416 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2842, 2847) --> . Sandra picked up the
2025-01-22 03:57:31.416 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went to the kitchen.
2025-01-22 03:57:31.434 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3616, 3621) --> . Sandra went to the
2025-01-22 03:57:31.434 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra left the milk.
2025-01-22 03:57:31.457 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4216, 4220) -->  left the milk.
2025-01-22 03:57:31.457 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel went back to the hallway.
2025-01-22 03:57:31.492 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6625, 6631) --> . Daniel went back to the
2025-01-22 03:57:31.493 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the football there.
2025-01-22 03:57:31.503 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1799, 1804) --> . Mary got the football
2025-01-22 03:57:31.503 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary moved to the bathroom.
2025-01-22 03:57:31.535 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6104, 6109) -->  Mary moved to the bathroom
2025-01-22 03:57:31.535 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the kitchen.
2025-01-22 03:57:31.567 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6625, 6631) --> . Daniel went back to the
2025-01-22 03:57:31.568 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the bedroom.
2025-01-22 03:57:31.580 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2515, 2521) --> . John went back to the
2025-01-22 03:57:31.580 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John moved to the bedroom.
2025-01-22 03:57:31.586 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (361, 366) --> . John moved to the
2025-01-22 03:57:31.586 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary journeyed to the office.
2025-01-22 03:57:31.620 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (6690, 6696) --> . Mary journeyed to the
2025-01-22 03:57:31.620 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  John journeyed to the office.
2025-01-22 03:57:31.653 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (6691, 6697) -->  Mary journeyed to the office
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 03:57:32.417 | INFO     | test_jbb_embedding:begin_test:693 - the kitchen<|eot_id|>
2025-01-22 03:57:32.417 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8200])
2025-01-22 03:57:34.692 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [215.1325, 23.73994651347068, 101.19991987179488, 22.780891003194494, 15.550227378731343], 'topk_indices': array([2710, 4219, 8174,    3, 3621, 3139,   14, 8187, 8044, 8181, 1736,
       3119,   24, 8179, 8045, 8180, 3120,    0, 8195, 8196]), 'topk_tokens': ['pl', '.', ':', '<|end_header_id|>', ' kitchen', 'ern', '\n', ' discarded', ' you', ' the', ' hallway', ' const', '\n\n', ' prior', ' context', ' to', 'ern', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [253.275, 177.325, 166.85, 346.4375, 167.55208333333334]}, 'weight': {'score': [21.566875, 23.26860980738754, 21.637419871794872, 23.28165315149281, 29.28544776119403], 'topk_indices': array([3327, 3300, 3172, 3220, 7482, 7444, 1491, 1429, 4326, 4310, 5141,
       5202, 7152, 7208, 3509, 3483, 4966, 4943, 4918, 4995]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.15, 23.49375, 20.796875, 20.3515625, 20.927083333333332]}, 'saliency': {'score': [1.222451171875, 0.13091942055783706, 0.5779278094951923, 0.12542468890143138, 0.11428388908727845], 'topk_indices': array([3102, 8175, 1732, 7397,   24, 8173, 8044, 8043, 8180, 2710, 3139,
       8185, 6631, 3621, 8187, 3119, 1736, 8179, 8045, 3120]), 'topk_tokens': [' Fourth', ' Where', ' Sandra', 'nes', '\n\n', 'Question', ' you', ' provided', ' to', 'pl', 'ern', ' milk', ' hallway', ' kitchen', ' discarded', ' const', ' hallway', ' prior', ' context', 'ern'], 'evidence_proportions': [1.56591796875, 1.034716796875, 0.9515625, 1.722900390625, 0.9847819010416666]}}, 'pred_res': 'the kitchen<|eot_id|>', 'score': 0}
2025-01-22 03:57:34.704 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 03:57:34.704 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-9_pid-2_2-3-4-5-8.pkl | len: 3 |  size: 2.07 KB
Processing depth (2, 3, 4, 5, 8):   3%|▎         | 3/100 [00:59<31:54, 19.74s/it]is_0k: False
your chose emoji: ['👨🏾\u200d🚒', '👱🏼\u200d♂️', '🐃', '🤥', '🧑🏻\u200d⚖', '👩\u200d❤️\u200d👩', '\U0001fa75', '🇬🇱', '🧍🏾\u200d♀️', '⚧']
emoji:
O: 👨🏾‍🚒 [9468, 239, 101, 9468, 237, 122, 102470, 9468, 248, 240]
N: 🩵 [9468, 102, 113]

O: 👱🏼‍♂️ [9468, 239, 109, 9468, 237, 120, 102470, 17245, 224, 31643]
N: 🐃 [9468, 238, 225]

O: 🐃 [9468, 238, 225]
N: 🇬🇱 [9468, 229, 105, 9468, 229, 109]

O: 🤥 [9468, 97, 98]
N: 👩‍❤️‍👩 [9468, 239, 102, 102470, 121643, 31643, 102470, 9468, 239, 102]

O: 🧑🏻‍⚖ [9468, 100, 239, 9468, 237, 119, 102470, 158, 248, 244]
N: 👱🏼‍♂️ [9468, 239, 109, 9468, 237, 120, 102470, 17245, 224, 31643]

O: 👩‍❤️‍👩 [9468, 239, 102, 102470, 121643, 31643, 102470, 9468, 239, 102]
N: 👨🏾‍🚒 [9468, 239, 101, 9468, 237, 122, 102470, 9468, 248, 240]

O: 🩵 [9468, 102, 113]
N: 🧍🏾‍♀️ [9468, 100, 235, 9468, 237, 122, 102470, 32990, 31643]

O: 🇬🇱 [9468, 229, 105, 9468, 229, 109]
N: 🧑🏻‍⚖ [9468, 100, 239, 9468, 237, 119, 102470, 158, 248, 244]

O: 🧍🏾‍♀️ [9468, 100, 235, 9468, 237, 122, 102470, 32990, 31643]
N: 🤥 [9468, 97, 98]

O: ⚧ [158, 248, 100]
N: ⚧ [158, 248, 100]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.14s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.71s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.28s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.77s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.37s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (2, 3, 7, 8, 9):   3%|▎         | 3/100 [01:15<31:54, 19.74s/it]2025-01-22 03:57:50.307 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra travelled to the hallway.
2025-01-22 03:57:50.315 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1609, 1614) --> . Sandra travelled to the
2025-01-22 03:57:50.315 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra picked up the milk.
2025-01-22 03:57:50.332 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2858, 2863) --> . Sandra picked up the
2025-01-22 03:57:50.332 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went to the kitchen.
2025-01-22 03:57:50.363 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5648, 5653) --> . Sandra went to the
2025-01-22 03:57:50.363 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra left the milk.
2025-01-22 03:57:50.400 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6561, 6565) -->  Sandra left the milk
2025-01-22 03:57:50.400 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel went back to the hallway.
2025-01-22 03:57:50.437 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7152, 7158) -->  went back to the kitchen.
2025-01-22 03:57:50.437 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the football there.
2025-01-22 03:57:50.445 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1773, 1778) --> . Mary got the football
2025-01-22 03:57:50.446 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary moved to the bathroom.
2025-01-22 03:57:50.480 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5799, 5804) -->  Mary moved to the bathroom
2025-01-22 03:57:50.480 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the kitchen.
2025-01-22 03:57:50.515 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (7151, 7157) -->  Daniel went back to the kitchen
2025-01-22 03:57:50.516 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the bedroom.
2025-01-22 03:57:50.528 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2531, 2537) --> . John went back to the
2025-01-22 03:57:50.530 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John moved to the bedroom.
2025-01-22 03:57:50.533 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (589, 594) --> . John moved to the
2025-01-22 03:57:50.533 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary journeyed to the office.
2025-01-22 03:57:50.572 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (6695, 6701) --> . Mary journeyed to the
2025-01-22 03:57:50.572 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  John journeyed to the office.
2025-01-22 03:57:50.605 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (6696, 6702) -->  Mary journeyed to the office
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 03:57:54.015 | INFO     | test_jbb_embedding:begin_test:693 - the kitchen<|eot_id|>
2025-01-22 03:57:54.015 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8238])
2025-01-22 03:57:57.149 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [164.0925, 20.686110226307488, 99.0536858974359, 19.87389361929803, 19.999330032703487], 'topk_indices': array([8214, 8236, 8223, 8225, 8212, 8081, 8127, 5653, 8117, 1614, 8082,
       8219,   14, 8217,   24, 8218, 8083,    0, 8233, 8234]), 'topk_tokens': [' was', '<|end_header_id|>', ' milk', ' discarded', ':', ' provided', ' location', ' kitchen', '.\n\n', ' hallway', ' you', ' the', '\n', ' prior', '\n\n', ' to', ' context', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [250.2, 133.4, 168.45, 205.25, 86.84375]}, 'weight': {'score': [22.7509375, 23.306787328600898, 22.251402243589745, 23.31352039256451, 29.78542877906977], 'topk_indices': array([3316, 3343, 3188, 3236, 7456, 7494, 1429, 1491, 4367, 4351, 5162,
       5223, 7219, 7163, 3535, 3561, 4939, 4964, 5016, 4987]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.15, 23.49375, 20.796875, 27.876953125, 20.84375]}, 'saliency': {'score': [0.999609375, 0.11390882857056182, 0.5772924178685898, 0.10899083008170785, 0.14955077060433322], 'topk_indices': array([8117, 8213, 8216, 7692, 8218, 1610, 8211,  594, 1611, 8082, 8127,
       8081, 8223,   24, 7275, 5653, 8225, 1614, 8217, 8083]), 'topk_tokens': ['.\n\n', ' Where', ' location', 'nes', ' to', ' Sandra', 'Question', ' bedroom', ' travelled', ' you', ' location', ' provided', ' milk', '\n\n', ' hallway', ' kitchen', ' discarded', ' hallway', ' prior', ' context'], 'evidence_proportions': [1.55556640625, 0.82255859375, 0.9513671875, 1.3668212890625, 0.479248046875]}}, 'pred_res': 'the kitchen<|eot_id|>', 'score': 0}
2025-01-22 03:57:57.154 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 03:57:57.154 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-9_pid-3_2-3-7-8-9.pkl | len: 3 |  size: 2.1 KB
Processing depth (2, 3, 7, 8, 9):   4%|▍         | 4/100 [01:22<33:17, 20.81s/it]is_0k: False
your chose emoji: ['👨🏾\u200d🌾', '🙉', '👩🏻\u200d❤️\u200d👩🏼', '😼', '👩🏻\u200d❤\u200d💋\u200d👨🏻', '🇨🇵', '⚱', '👩🏾\u200d💻', '🏋🏻\u200d♀️', '🧝🏼\u200d♂️']
emoji:
O: 👨🏾‍🌾 [9468, 239, 101, 9468, 237, 122, 102470, 9468, 234, 122]
N: ⚱ [158, 248, 109]

O: 🙉 [9468, 247, 231]
N: 👩🏾‍💻 [9468, 239, 102, 9468, 237, 122, 102470, 93273, 119]

O: 👩🏻‍❤️‍👩🏼 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 31643, 102470, 9468, 239, 102, 9468, 237, 120]
N: 👩🏻‍❤️‍👩🏼 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 31643, 102470, 9468, 239, 102, 9468, 237, 120]

O: 😼 [76460, 120]
N: 😼 [76460, 120]

O: 👩🏻‍❤‍💋‍👨🏻 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 119]
N: 👩🏻‍❤‍💋‍👨🏻 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 119]

O: 🇨🇵 [9468, 229, 101, 9468, 229, 113]
N: 👨🏾‍🌾 [9468, 239, 101, 9468, 237, 122, 102470, 9468, 234, 122]

O: ⚱ [158, 248, 109]
N: 🏋🏻‍♀️ [9468, 237, 233, 9468, 237, 119, 102470, 32990, 31643]

O: 👩🏾‍💻 [9468, 239, 102, 9468, 237, 122, 102470, 93273, 119]
N: 🙉 [9468, 247, 231]

O: 🏋🏻‍♀️ [9468, 237, 233, 9468, 237, 119, 102470, 32990, 31643]
N: 🇨🇵 [9468, 229, 101, 9468, 229, 113]

O: 🧝🏼‍♂️ [9468, 100, 251, 9468, 237, 120, 102470, 17245, 224, 31643]
N: 🧝🏼‍♂️ [9468, 100, 251, 9468, 237, 120, 102470, 17245, 224, 31643]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.89s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.72s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.53s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.11s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.68s/it]
Processing depth (1, 3, 4, 5, 9):   4%|▍         | 4/100 [01:38<33:17, 20.81s/it]2025-01-22 03:58:13.619 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra travelled to the hallway.
2025-01-22 03:58:13.624 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (822, 827) -->  Sandra travelled to the hallway
2025-01-22 03:58:13.625 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra picked up the milk.
2025-01-22 03:58:13.640 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2934, 2939) --> . Sandra picked up the
2025-01-22 03:58:13.641 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went to the kitchen.
2025-01-22 03:58:13.660 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3617, 3622) -->  Hon. Sandra went to
2025-01-22 03:58:13.660 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra left the milk.
2025-01-22 03:58:13.682 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4220, 4224) -->  left the milk.
2025-01-22 03:58:13.682 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel went back to the hallway.
2025-01-22 03:58:13.720 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7084, 7090) -->  went back to the kitchen.
2025-01-22 03:58:13.720 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the football there.
2025-01-22 03:58:13.729 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1865, 1870) --> . Mary got the football
2025-01-22 03:58:13.729 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary moved to the bathroom.
2025-01-22 03:58:13.764 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6151, 6156) --> . Mary moved to the
2025-01-22 03:58:13.764 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the kitchen.
2025-01-22 03:58:13.802 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (7083, 7089) -->  Daniel went back to the kitchen
2025-01-22 03:58:13.802 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the bedroom.
2025-01-22 03:58:13.816 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2545, 2551) --> . John went back to the
2025-01-22 03:58:13.817 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John moved to the bedroom.
2025-01-22 03:58:13.820 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (589, 594) --> . John moved to the
2025-01-22 03:58:13.820 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary journeyed to the office.
2025-01-22 03:58:13.856 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (6743, 6749) --> . Mary journeyed to the
2025-01-22 03:58:13.856 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  John journeyed to the office.
2025-01-22 03:58:13.891 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (6744, 6750) -->  Mary journeyed to the office
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 03:58:14.651 | INFO     | test_jbb_embedding:begin_test:693 - the kitchen<|eot_id|>
2025-01-22 03:58:14.651 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8182])
2025-01-22 03:58:16.875 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [332.775, 24.72903558338424, 112.40464743589743, 23.359684767885728, 26.242254849137932], 'topk_indices': array([2939, 3623, 8061, 2935,  823, 8167,   14, 8161, 8169,   24, 4222,
        818, 8162, 4223, 8027, 2940,  826,    0, 8177, 8178]), 'topk_tokens': [' milk', ' kitchen', '.\n\n', ' Sandra', ' travelled', ' milk', '\n', ' prior', ' discarded', '\n\n', ' milk', '�', ' to', '.', ' context', '.', ' hallway', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [585.65, 397.85, 193.1875, 515.75, 62.15625]}, 'weight': {'score': [23.7275, 23.248657987171654, 21.522035256410255, 23.255475772688094, 28.811422413793103], 'topk_indices': array([3307, 3280, 3152, 3200, 7426, 7388, 1491, 1429, 4286, 4270, 5087,
       5148, 7095, 7151, 3463, 3489, 4889, 4941, 4864, 4912]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.2453125, 23.49375, 25.6046875, 20.3515625, 20.84375]}, 'saliency': {'score': [2.1566796875, 0.13798783383284974, 0.6209309895833334, 0.1294541459353066, 0.18371976655105066], 'topk_indices': array([8071, 2942, 2936,   24, 4220, 8155,  818,  594,  816, 2939,  822,
       8167, 3623, 8161, 4222,  823, 2935, 8027, 8169,  826]), 'topk_tokens': [' location', 'ible', ' picked', '\n\n', ' left', 'Question', '�', ' bedroom', '�', ' milk', ' Sandra', ' milk', ' kitchen', ' prior', ' milk', ' travelled', ' Sandra', ' context', ' discarded', ' hallway'], 'evidence_proportions': [4.5646484375, 2.45458984375, 1.243017578125, 2.6640625, 0.3249104817708333]}}, 'pred_res': 'the kitchen<|eot_id|>', 'score': 0}
2025-01-22 03:58:16.888 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 03:58:16.889 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-9_pid-4_1-3-4-5-9.pkl | len: 3 |  size: 2.08 KB
Processing depth (1, 3, 4, 5, 9):   5%|▌         | 5/100 [01:41<32:20, 20.42s/it]Processing depth (1, 3, 4, 5, 9):   5%|▌         | 5/100 [01:41<32:14, 20.36s/it]
2025-01-22 03:58:16.952 | INFO     | __main__:<module>:82 - Selected idx: 10
2025-01-22 03:58:16.952 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the apple before the bedroom? 
2025-01-22 03:58:16.952 | INFO     | __main__:<module>:84 - Answer: bathroom
2025-01-22 03:58:16.952 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 03:58:16.952 | INFO     | __main__:<module>:86 - Needle: [' Daniel picked up the apple.', ' Mary moved to the bathroom.', ' John moved to the garden.', ' John went back to the office.', ' Daniel took the football.', ' Sandra moved to the kitchen.', ' Daniel left the apple.', ' Mary journeyed to the bedroom.', ' Sandra journeyed to the office.', ' Mary left the apple.', ' Daniel dropped the football.']
2025-01-22 03:58:16.952 | INFO     | __main__:<module>:87 - Real Needle: [' Mary moved to the bathroom.', ' Mary journeyed to the bedroom.', ' Mary left the apple.', ' Daniel dropped the football.']
2025-01-22 03:58:16.952 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['🪚', '🇩🇬', '🗳️', '🖕', '🍌', '👆🏽', '🤵\u200d♀', '🇮🇹', '👨🏽\u200d❤\u200d👨🏿', '🐕\u200d🦺']
emoji:
O: 🪚 [9468, 103, 248]
N: 🪚 [9468, 103, 248]

O: 🇩🇬 [9468, 229, 102, 9468, 229, 105]
N: 👆🏽 [9468, 239, 228, 9468, 237, 121]

O: 🗳️ [9468, 245, 111, 31643]
N: 🖕 [9468, 244, 243]

O: 🖕 [9468, 244, 243]
N: 🍌 [9468, 235, 234]

O: 🍌 [9468, 235, 234]
N: 🤵‍♀ [9468, 97, 113, 102470, 32990]

O: 👆🏽 [9468, 239, 228, 9468, 237, 121]
N: 🗳️ [9468, 245, 111, 31643]

O: 🤵‍♀ [9468, 97, 113, 102470, 32990]
N: 🇮🇹 [9468, 229, 106, 9468, 229, 117]

O: 🇮🇹 [9468, 229, 106, 9468, 229, 117]
N: 🇩🇬 [9468, 229, 102, 9468, 229, 105]

O: 👨🏽‍❤‍👨🏿 [9468, 239, 101, 9468, 237, 121, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 123]
N: 👨🏽‍❤‍👨🏿 [9468, 239, 101, 9468, 237, 121, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 123]

O: 🐕‍🦺 [9468, 238, 243, 102470, 9468, 99, 118]
N: 🐕‍🦺 [9468, 238, 243, 102470, 9468, 99, 118]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.84s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.97s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.43s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  2.85s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.53s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 2, 5, 7):   0%|          | 0/100 [00:15<?, ?it/s]2025-01-22 03:58:32.897 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bathroom.
2025-01-22 03:58:32.898 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  moved to the bathroom.
2025-01-22 03:58:32.898 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the bedroom.
2025-01-22 03:58:32.907 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1804, 1810) --> . Mary journeyed to the
2025-01-22 03:58:32.907 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary left the apple.
2025-01-22 03:58:32.927 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4097, 4101) -->  left the apple.
2025-01-22 03:58:32.927 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel dropped the football.
2025-01-22 03:58:32.953 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5588, 5592) -->  Daniel dropped the football
2025-01-22 03:58:32.954 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the apple.
2025-01-22 03:58:32.986 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6724, 6729) --> . Daniel picked up the
2025-01-22 03:58:32.986 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John moved to the garden.
2025-01-22 03:58:32.987 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (32, 37) -->  to the bathroom. John
2025-01-22 03:58:32.987 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the office.
2025-01-22 03:58:32.987 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (33, 39) -->  the bathroom. John went back
2025-01-22 03:58:32.987 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel took the football.
2025-01-22 03:58:33.006 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3921, 3925) -->  Daniel took the football
2025-01-22 03:58:33.006 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra moved to the kitchen.
2025-01-22 03:58:33.015 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1897, 1902) --> . Sandra moved to the
2025-01-22 03:58:33.015 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel left the apple.
2025-01-22 03:58:33.029 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (2904, 2908) -->  Daniel left the apple
2025-01-22 03:58:33.029 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Sandra journeyed to the office.
2025-01-22 03:58:33.051 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (4422, 4428) --> . Sandra journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 03:58:37.176 | INFO     | test_jbb_embedding:begin_test:693 - The apple was in the kitchen.<|eot_id|>
2025-01-22 03:58:37.176 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8164])
2025-01-22 03:58:39.834 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [719.8486842105264, 57.238888208644546, 484.12857142857143, 53.84547947738198, 80.21941207627118], 'topk_indices': array([2908, 8156,   14, 8153,   34,   25, 8145, 8146, 1811, 8150, 8147,
       8154, 8155, 8151, 8148, 8149,    0, 8152, 8159, 8160]), 'topk_tokens': ['.', ' \n', '\n', ' the', ' bathroom', '<|eot_id|>', '.\n\n', 'Question', '.', ' the', ':', ' bedroom', '?', ' apple', ' Where', ' was', '<|begin_of_text|>', ' before', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [1027.4, 721.2916666666666, 847.75, 205.34375]}, 'weight': {'score': [21.837582236842106, 23.255010637320925, 22.978571428571428, 23.259522718168373, 29.17981991525424], 'topk_indices': array([3328, 3355, 3182, 3230, 7455, 7417, 1440, 1502, 4345, 4361, 5163,
       5224, 7138, 7194, 3537, 3511, 4988, 4965, 4940, 5017]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.709375, 20.052083333333332, 20.421875, 27.341796875]}, 'saliency': {'score': [3.9862253289473686, 0.3092687463649443, 2.9373953683035716, 0.2893197007792278, 0.5871819964909958], 'topk_indices': array([2907, 6729, 4099, 8150,   31, 8018, 8145,   27, 8156, 8157, 8147,
       1810, 8155,   34, 8146, 8149, 8148, 8154, 8151, 8152]), 'topk_tokens': [' apple', ' apple', ' apple', ' the', ' moved', ' context', '.\n\n', 'user', ' \n', 'Answer', ':', ' bedroom', '?', ' bathroom', 'Question', ' was', ' Where', ' bedroom', ' apple', ' before'], 'evidence_proportions': [6.1107421875, 3.6848958333333335, 4.32275390625, 1.446044921875]}}, 'pred_res': 'The apple was in the kitchen.<|eot_id|>', 'score': 0}
2025-01-22 03:58:39.841 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 03:58:39.841 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-10_pid-0_0-2-5-7.pkl | len: 3 |  size: 2.01 KB
Processing depth (0, 2, 5, 7):   1%|          | 1/100 [00:22<37:37, 22.80s/it]is_0k: False
your chose emoji: ['🙇🏻\u200d♀', '👷🏽', '🧱', '🧎\u200d♀\u200d➡️', '🧚🏻\u200d♀', '👦🏽', '👠', '🇯🇪', '🧑\u200d🍳', '👾']
emoji:
O: 🙇🏻‍♀ [9468, 247, 229, 9468, 237, 119, 102470, 32990]
N: 🇯🇪 [9468, 229, 107, 9468, 229, 103]

O: 👷🏽 [9468, 239, 115, 9468, 237, 121]
N: 🧚🏻‍♀ [9468, 100, 248, 9468, 237, 119, 102470, 32990]

O: 🧱 [9468, 100, 109]
N: 🧑‍🍳 [9468, 100, 239, 102470, 9468, 235, 111]

O: 🧎‍♀‍➡️ [9468, 100, 236, 102470, 32990, 102470, 98115, 94, 31643]
N: 👷🏽 [9468, 239, 115, 9468, 237, 121]

O: 🧚🏻‍♀ [9468, 100, 248, 9468, 237, 119, 102470, 32990]
N: 🧎‍♀‍➡️ [9468, 100, 236, 102470, 32990, 102470, 98115, 94, 31643]

O: 👦🏽 [9468, 239, 99, 9468, 237, 121]
N: 👠 [9468, 239, 254]

O: 👠 [9468, 239, 254]
N: 🙇🏻‍♀ [9468, 247, 229, 9468, 237, 119, 102470, 32990]

O: 🇯🇪 [9468, 229, 107, 9468, 229, 103]
N: 🧱 [9468, 100, 109]

O: 🧑‍🍳 [9468, 100, 239, 102470, 9468, 235, 111]
N: 👦🏽 [9468, 239, 99, 9468, 237, 121]

O: 👾 [9468, 239, 122]
N: 👾 [9468, 239, 122]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.43s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.94s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.90s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.36s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.89s/it]
Processing depth (0, 3, 4, 8):   1%|          | 1/100 [00:40<37:37, 22.80s/it]2025-01-22 03:58:57.143 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bathroom.
2025-01-22 03:58:57.143 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  moved to the bathroom.
2025-01-22 03:58:57.143 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the bedroom.
2025-01-22 03:58:57.160 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3050, 3056) --> . Mary journeyed to the
2025-01-22 03:58:57.160 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary left the apple.
2025-01-22 03:58:57.177 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3649, 3653) -->  Mary left the apple
2025-01-22 03:58:57.177 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel dropped the football.
2025-01-22 03:58:57.212 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6580, 6584) -->  Daniel dropped the football
2025-01-22 03:58:57.212 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the apple.
2025-01-22 03:58:57.246 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6774, 6779) --> . Daniel picked up the
2025-01-22 03:58:57.246 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John moved to the garden.
2025-01-22 03:58:57.247 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (32, 37) -->  to the bathroom. John
2025-01-22 03:58:57.247 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the office.
2025-01-22 03:58:57.247 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (33, 39) -->  the bathroom. John went back
2025-01-22 03:58:57.247 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel took the football.
2025-01-22 03:58:57.266 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4092, 4096) -->  Daniel took the football
2025-01-22 03:58:57.267 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra moved to the kitchen.
2025-01-22 03:58:57.278 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (2182, 2187) --> . Sandra moved to the
2025-01-22 03:58:57.278 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel left the apple.
2025-01-22 03:58:57.293 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (3058, 3062) -->  Daniel left the apple
2025-01-22 03:58:57.294 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Sandra journeyed to the office.
2025-01-22 03:58:57.316 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (4595, 4601) -->  Sandra journeyed to the office
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 03:58:58.125 | INFO     | test_jbb_embedding:begin_test:693 - The office.<|eot_id|>
2025-01-22 03:58:58.125 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8244])
2025-01-22 03:59:00.359 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [136.98190789473685, 15.925897295986418, 107.86339285714286, 15.252410594409863, 9.886403093434344], 'topk_indices': array([7985, 8225,    4,    9, 8132,   23,    3, 8235, 3057, 3056, 4289,
          1, 8232, 8234,   24,   14, 8240, 8242,    0, 8239]), 'topk_tokens': [' Square', '.\n\n', '\n\n', ':', '.\n\n', '4', '<|end_header_id|>', '?', '.', ' bedroom', 'nes', '<|start_header_id|>', ' before', ' bedroom', '\n\n', '\n', '<|start_header_id|>', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [196.1875, 183.96875, 89.8046875, 39.671875]}, 'weight': {'score': [23.055098684210527, 23.3198530526252, 23.55200892857143, 23.31947527615037, 29.486742424242426], 'topk_indices': array([3297, 3270, 3176, 3128, 7525, 7487, 1412, 1474, 4335, 4319, 5165,
       5226, 7264, 7208, 3453, 3479, 4990, 4942, 5019, 4967]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.709375, 20.052083333333332, 26.205078125, 27.341796875]}, 'saliency': {'score': [0.7550209446957237, 0.08811111237419668, 0.6751063755580358, 0.08405690499893201, 0.07593204999210859], 'topk_indices': array([  22,   20,   14,   16, 4268, 8132,   23,    8, 3061, 8231, 8235,
       8228,   34, 7985, 8226,   24, 4289, 8232, 3056, 8234]), 'topk_tokens': ['202', ' Jul', '\n', ' Date', 'nes', '.\n\n', '4', ' Date', ' apple', ' apple', '?', ' Where', ' bathroom', ' Square', 'Question', '\n\n', 'nes', ' before', ' bedroom', ' bedroom'], 'evidence_proportions': [1.167724609375, 0.8434244791666666, 0.587066650390625, 0.2744903564453125]}}, 'pred_res': 'The office.<|eot_id|>', 'score': 0}
2025-01-22 03:59:00.366 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 03:59:00.366 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-10_pid-1_0-3-4-8.pkl | len: 3 |  size: 2.0 KB
Processing depth (0, 3, 4, 8):   2%|▏         | 2/100 [00:43<35:03, 21.46s/it]is_0k: False
your chose emoji: ['🧑🏾\u200d❤️\u200d🧑🏽', '🧑🏼\u200d🤝\u200d🧑🏿', '🧜🏼\u200d♀', '🙍\u200d♂️', '🚣🏿\u200d♂️', '🤹🏾', '👨🏾\u200d🦽\u200d➡️', '🇨🇬', '👨\u200d🦱', '💇🏼\u200d♂']
emoji:
O: 🧑🏾‍❤️‍🧑🏽 [9468, 100, 239, 9468, 237, 122, 102470, 121643, 31643, 102470, 9468, 100, 239, 9468, 237, 121]
N: 🙍‍♂️ [9468, 247, 235, 102470, 17245, 224, 31643]

O: 🧑🏼‍🤝‍🧑🏿 [9468, 100, 239, 9468, 237, 120, 102470, 9468, 97, 251, 102470, 9468, 100, 239, 9468, 237, 123]
N: 🧜🏼‍♀ [9468, 100, 250, 9468, 237, 120, 102470, 32990]

O: 🧜🏼‍♀ [9468, 100, 250, 9468, 237, 120, 102470, 32990]
N: 🧑🏾‍❤️‍🧑🏽 [9468, 100, 239, 9468, 237, 122, 102470, 121643, 31643, 102470, 9468, 100, 239, 9468, 237, 121]

O: 🙍‍♂️ [9468, 247, 235, 102470, 17245, 224, 31643]
N: 🤹🏾 [9468, 97, 117, 9468, 237, 122]

O: 🚣🏿‍♂️ [9468, 248, 96, 9468, 237, 123, 102470, 17245, 224, 31643]
N: 👨🏾‍🦽‍➡️ [9468, 239, 101, 9468, 237, 122, 102470, 9468, 99, 121, 102470, 98115, 94, 31643]

O: 🤹🏾 [9468, 97, 117, 9468, 237, 122]
N: 🇨🇬 [9468, 229, 101, 9468, 229, 105]

O: 👨🏾‍🦽‍➡️ [9468, 239, 101, 9468, 237, 122, 102470, 9468, 99, 121, 102470, 98115, 94, 31643]
N: 👨‍🦱 [9468, 239, 101, 102470, 9468, 99, 109]

O: 🇨🇬 [9468, 229, 101, 9468, 229, 105]
N: 🚣🏿‍♂️ [9468, 248, 96, 9468, 237, 123, 102470, 17245, 224, 31643]

O: 👨‍🦱 [9468, 239, 101, 102470, 9468, 99, 109]
N: 🧑🏼‍🤝‍🧑🏿 [9468, 100, 239, 9468, 237, 120, 102470, 9468, 97, 251, 102470, 9468, 100, 239, 9468, 237, 123]

O: 💇🏼‍♂ [93273, 229, 9468, 237, 120, 102470, 17245, 224]
N: 💇🏼‍♂ [93273, 229, 9468, 237, 120, 102470, 17245, 224]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:11,  3.89s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.39s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.30s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.80s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.33s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (1, 2, 6, 7):   2%|▏         | 2/100 [00:58<35:03, 21.46s/it]2025-01-22 03:59:15.404 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bathroom.
2025-01-22 03:59:15.409 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (902, 907) --> . Mary moved to the
2025-01-22 03:59:15.409 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the bedroom.
2025-01-22 03:59:15.419 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1858, 1864) --> . Mary journeyed to the
2025-01-22 03:59:15.419 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary left the apple.
2025-01-22 03:59:15.447 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4729, 4733) -->  Mary left the apple
2025-01-22 03:59:15.447 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel dropped the football.
2025-01-22 03:59:15.474 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5618, 5622) -->  Daniel dropped the football
2025-01-22 03:59:15.475 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the apple.
2025-01-22 03:59:15.510 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6710, 6715) --> . Daniel picked up the
2025-01-22 03:59:15.510 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John moved to the garden.
2025-01-22 03:59:15.539 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5439, 5444) --> . John moved to the
2025-01-22 03:59:15.539 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the office.
2025-01-22 03:59:15.539 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (31, 37) -->  went back to the office.
2025-01-22 03:59:15.540 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel took the football.
2025-01-22 03:59:15.563 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4043, 4047) -->  Daniel took the football
2025-01-22 03:59:15.563 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra moved to the kitchen.
2025-01-22 03:59:15.575 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (2125, 2130) --> . Sandra moved to the
2025-01-22 03:59:15.575 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel left the apple.
2025-01-22 03:59:15.589 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (2946, 2950) -->  Daniel left the apple
2025-01-22 03:59:15.590 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Sandra journeyed to the office.
2025-01-22 03:59:15.615 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (4503, 4509) --> . Sandra journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 03:59:19.814 | INFO     | test_jbb_embedding:begin_test:693 - The bathroom.<|eot_id|>
2025-01-22 03:59:19.815 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8158])
2025-01-22 03:59:22.938 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [475.95394736842104, 35.7482615488298, 206.31517857142856, 33.98019073023313, 18.114013671875], 'topk_indices': array([8139,  904,  905,   14, 8156, 8140, 1865,  906, 8144, 8141,  907,
       8149, 8148, 8143, 8142, 8145, 8146,    0, 8153, 8154]), 'topk_tokens': ['.\n\n', ' moved', ' to', '\n', '<|end_header_id|>', 'Question', '.', ' the', ' the', ':', ' bathroom', '?', ' bedroom', ' was', ' Where', ' apple', ' before', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [832.5, 430.7083333333333, 464.875, 109.21875]}, 'weight': {'score': [22.77549342105263, 23.25157188150962, 22.095089285714284, 23.25768047674849, 29.234375], 'topk_indices': array([3284, 3311, 3156, 3204, 7449, 7411, 1412, 1474, 4324, 4308, 5204,
       5143, 7132, 7188, 3479, 3505, 4908, 4985, 4933, 4956]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.646875, 20.052083333333332, 26.205078125, 27.341796875]}, 'saliency': {'score': [2.4819464432565788, 0.1940865317420506, 1.2089285714285714, 0.18434324696250154, 0.1360934121268136], 'topk_indices': array([   0, 8139, 8144, 1869,   27, 2949, 8150, 8141, 4732, 8151,  904,
       1864, 8149, 8143, 8140, 8142,  907, 8145, 8148, 8146]), 'topk_tokens': ['<|begin_of_text|>', '.\n\n', ' the', '      ', 'user', ' apple', ' \n', ':', ' apple', 'Answer', ' moved', ' bedroom', '?', ' was', 'Question', ' Where', ' bathroom', ' apple', ' bedroom', ' before'], 'evidence_proportions': [3.876953125, 2.09619140625, 3.06640625, 0.73236083984375]}}, 'pred_res': 'The bathroom.<|eot_id|>', 'score': 100}
2025-01-22 03:59:22.945 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 03:59:22.945 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-10_pid-2_1-2-6-7.pkl | len: 3 |  size: 2.01 KB
Processing depth (1, 2, 6, 7):   3%|▎         | 3/100 [01:05<35:31, 21.97s/it]is_0k: False
your chose emoji: ['😕', '🤸🏻\u200d♀️', '✋🏾', '🙅🏿', '🤵🏼', '⛷', '🥷🏾', '🤽🏻', '🧛🏻\u200d♂️', '🍊']
emoji:
O: 😕 [76460, 243]
N: ✋🏾 [38798, 233, 9468, 237, 122]

O: 🤸🏻‍♀️ [9468, 97, 116, 9468, 237, 119, 102470, 32990, 31643]
N: 🤸🏻‍♀️ [9468, 97, 116, 9468, 237, 119, 102470, 32990, 31643]

O: ✋🏾 [38798, 233, 9468, 237, 122]
N: 🤵🏼 [9468, 97, 113, 9468, 237, 120]

O: 🙅🏿 [9468, 247, 227, 9468, 237, 123]
N: 🥷🏾 [9468, 98, 115, 9468, 237, 122]

O: 🤵🏼 [9468, 97, 113, 9468, 237, 120]
N: 😕 [76460, 243]

O: ⛷ [158, 249, 115]
N: 🙅🏿 [9468, 247, 227, 9468, 237, 123]

O: 🥷🏾 [9468, 98, 115, 9468, 237, 122]
N: 🤽🏻 [9468, 97, 121, 9468, 237, 119]

O: 🤽🏻 [9468, 97, 121, 9468, 237, 119]
N: ⛷ [158, 249, 115]

O: 🧛🏻‍♂️ [9468, 100, 249, 9468, 237, 119, 102470, 17245, 224, 31643]
N: 🧛🏻‍♂️ [9468, 100, 249, 9468, 237, 119, 102470, 17245, 224, 31643]

O: 🍊 [9468, 235, 232]
N: 🍊 [9468, 235, 232]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.62s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.44s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.39s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.57s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.89s/it]
Processing depth (4, 5, 6, 9):   3%|▎         | 3/100 [01:23<35:31, 21.97s/it]2025-01-22 03:59:40.215 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bathroom.
2025-01-22 03:59:40.232 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3559, 3564) --> . Mary moved to the
2025-01-22 03:59:40.233 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the bedroom.
2025-01-22 03:59:40.255 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4166, 4172) --> . Mary journeyed to the
2025-01-22 03:59:40.255 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary left the apple.
2025-01-22 03:59:40.279 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4689, 4693) -->  Mary left the apple
2025-01-22 03:59:40.279 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel dropped the football.
2025-01-22 03:59:40.319 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7274, 7278) -->  Daniel dropped the football
2025-01-22 03:59:40.319 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the apple.
2025-01-22 03:59:40.358 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6837, 6842) --> . Daniel picked up the
2025-01-22 03:59:40.358 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John moved to the garden.
2025-01-22 03:59:40.387 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5487, 5492) --> . John moved to the
2025-01-22 03:59:40.387 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the office.
2025-01-22 03:59:40.387 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (31, 37) -->  went back to the office.
2025-01-22 03:59:40.387 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel took the football.
2025-01-22 03:59:40.407 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3944, 3948) -->  Daniel took the football
2025-01-22 03:59:40.407 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra moved to the kitchen.
2025-01-22 03:59:40.420 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (2047, 2052) -->  cable. Sandra moved to
2025-01-22 03:59:40.420 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel left the apple.
2025-01-22 03:59:40.435 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (2867, 2871) -->  Daniel left the apple
2025-01-22 03:59:40.435 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Sandra journeyed to the office.
2025-01-22 03:59:40.462 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (4518, 4524) -->  Sandra journeyed to the office
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 03:59:41.392 | INFO     | test_jbb_embedding:begin_test:693 - The apple was in the office.<|eot_id|>
2025-01-22 03:59:41.393 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8226])
2025-01-22 03:59:44.720 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [171.1875, 17.451273696682463, 104.11294642857143, 16.7229376911315, 15.308723958333333], 'topk_indices': array([   9,   23, 8207, 8215, 8211, 3564, 4172,    3, 8210,    1, 8217,
       4173,   14, 8222,   24, 8216, 8214, 8224,    0, 8221]), 'topk_tokens': [':', '4', '.\n\n', ' the', ' was', ' bathroom', ' bedroom', '<|end_header_id|>', ' Where', '<|start_header_id|>', '?', '.', '\n', '<|start_header_id|>', '\n\n', ' bedroom', ' before', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [193.1, 238.60416666666666, 148.1875, 65.671875]}, 'weight': {'score': [22.77549342105263, 23.31151263823065, 23.300892857142856, 23.312803899082567, 29.71440972222222], 'topk_indices': array([3350, 3323, 3195, 3243, 7451, 7489, 1510, 1448, 4354, 4338, 5191,
       5252, 7223, 7167, 3524, 3550, 5045, 5016, 4968, 4993]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.646875, 20.052083333333332, 26.205078125, 27.341796875]}, 'saliency': {'score': [0.8963173314144737, 0.09601374491840974, 0.6363978794642857, 0.09184014089975152, 0.11333279079861111], 'topk_indices': array([  20, 7404,    0,   16,   23,    8, 2870, 8207, 8219, 8211, 7967,
       8208, 8217, 8213,   24, 8210, 4172, 3564, 8214, 8216]), 'topk_tokens': [' Jul', 'nes', '<|begin_of_text|>', ' Date', '4', ' Date', ' apple', '.\n\n', 'Answer', ' was', ' Square', 'Question', '?', ' apple', '\n\n', ' Where', ' bedroom', ' bathroom', ' before', ' bedroom'], 'evidence_proportions': [0.94990234375, 1.0867513020833333, 0.99493408203125, 0.445068359375]}}, 'pred_res': 'The apple was in the office.<|eot_id|>', 'score': 0}
2025-01-22 03:59:44.727 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 03:59:44.727 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-10_pid-3_4-5-6-9.pkl | len: 3 |  size: 2.05 KB
Processing depth (4, 5, 6, 9):   4%|▍         | 4/100 [01:27<35:02, 21.90s/it]is_0k: False
your chose emoji: ['🎻', '👮🏾\u200d♀️', '👩🏽\u200d❤️\u200d👩🏼', '🤰🏻', '👆', '🛫', '👨🏽\u200d❤\u200d💋\u200d👨🏽', '🚣🏿\u200d♂', '👨🏼\u200d❤\u200d👨🏼', '🧎\u200d♀\u200d➡']
emoji:
O: 🎻 [9468, 236, 119]
N: 👆 [9468, 239, 228]

O: 👮🏾‍♀️ [9468, 239, 106, 9468, 237, 122, 102470, 32990, 31643]
N: 👨🏽‍❤‍💋‍👨🏽 [9468, 239, 101, 9468, 237, 121, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 121]

O: 👩🏽‍❤️‍👩🏼 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 31643, 102470, 9468, 239, 102, 9468, 237, 120]
N: 🛫 [9468, 249, 104]

O: 🤰🏻 [9468, 97, 108, 9468, 237, 119]
N: 👩🏽‍❤️‍👩🏼 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 31643, 102470, 9468, 239, 102, 9468, 237, 120]

O: 👆 [9468, 239, 228]
N: 🎻 [9468, 236, 119]

O: 🛫 [9468, 249, 104]
N: 🤰🏻 [9468, 97, 108, 9468, 237, 119]

O: 👨🏽‍❤‍💋‍👨🏽 [9468, 239, 101, 9468, 237, 121, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 121]
N: 👨🏼‍❤‍👨🏼 [9468, 239, 101, 9468, 237, 120, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 120]

O: 🚣🏿‍♂ [9468, 248, 96, 9468, 237, 123, 102470, 17245, 224]
N: 👮🏾‍♀️ [9468, 239, 106, 9468, 237, 122, 102470, 32990, 31643]

O: 👨🏼‍❤‍👨🏼 [9468, 239, 101, 9468, 237, 120, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 120]
N: 🚣🏿‍♂ [9468, 248, 96, 9468, 237, 123, 102470, 17245, 224]

O: 🧎‍♀‍➡ [9468, 100, 236, 102470, 32990, 102470, 98115, 94]
N: 🧎‍♀‍➡ [9468, 100, 236, 102470, 32990, 102470, 98115, 94]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.30s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:09,  4.52s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.25s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.75s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.34s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (3, 5, 7, 9):   4%|▍         | 4/100 [01:42<35:02, 21.90s/it]2025-01-22 04:00:00.048 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bathroom.
2025-01-22 04:00:00.063 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2888, 2893) --> . Mary moved to the
2025-01-22 04:00:00.063 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the bedroom.
2025-01-22 04:00:00.084 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4160, 4166) --> . Mary journeyed to the
2025-01-22 04:00:00.084 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary left the apple.
2025-01-22 04:00:00.111 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5627, 5631) -->  Mary left the apple
2025-01-22 04:00:00.112 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel dropped the football.
2025-01-22 04:00:00.150 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7228, 7232) -->  Daniel dropped the football
2025-01-22 04:00:00.150 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the apple.
2025-01-22 04:00:00.187 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6803, 6808) --> . Daniel picked up the
2025-01-22 04:00:00.187 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John moved to the garden.
2025-01-22 04:00:00.217 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5448, 5453) --> . John moved to the
2025-01-22 04:00:00.217 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the office.
2025-01-22 04:00:00.217 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (31, 37) -->  went back to the office.
2025-01-22 04:00:00.217 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel took the football.
2025-01-22 04:00:00.236 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3972, 3976) -->  Daniel took the football
2025-01-22 04:00:00.236 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra moved to the kitchen.
2025-01-22 04:00:00.247 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (2118, 2123) --> . Sandra moved to the
2025-01-22 04:00:00.247 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel left the apple.
2025-01-22 04:00:00.262 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (2895, 2899) -->  Daniel left the apple
2025-01-22 04:00:00.262 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Sandra journeyed to the office.
2025-01-22 04:00:00.285 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (4482, 4488) -->  execution. Sandra journeyed to
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:00:06.721 | INFO     | test_jbb_embedding:begin_test:693 - The apple was in the office.<|eot_id|>
2025-01-22 04:00:06.722 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8162])
2025-01-22 04:00:09.625 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [145.0797697368421, 17.518015156154316, 89.03214285714286, 16.910609434718285, 14.123518318965518], 'topk_indices': array([8050, 7506, 8147, 7551, 4167,    9, 2893, 8153, 7909,    1, 8146,
         23, 8152,   14, 8150,   24, 8158, 8160,    0, 8157]), 'topk_tokens': ['.\n\n', 'nes', ' was', 'nes', '.', ':', ' bathroom', '?', ' Square', '<|start_header_id|>', ' Where', '4', ' bedroom', '\n', ' before', '\n\n', '<|start_header_id|>', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [175.575, 195.5, 137.5, 38.91015625]}, 'weight': {'score': [22.77549342105263, 23.265158067973054, 22.731919642857143, 23.268606098199974, 29.984375], 'topk_indices': array([3289, 3316, 3161, 3209, 7443, 7405, 1422, 1484, 4314, 4330, 5152,
       5213, 7121, 7177, 3472, 3498, 4929, 5006, 4977, 4954]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.646875, 20.052083333333332, 26.205078125, 27.341796875]}, 'saliency': {'score': [0.7630037006578947, 0.09689167721170774, 0.5338335309709822, 0.09344585137925156, 0.10798618711274245], 'topk_indices': array([8050,   16,   20,    8, 8147, 8144, 8153, 8155,   23, 8149, 7550,
       7506, 7551, 4166, 7909,   24, 8146, 2893, 8150, 8152]), 'topk_tokens': ['.\n\n', ' Date', ' Jul', ' Date', ' was', 'Question', '?', 'Answer', '4', ' apple', ' Min', 'nes', 'nes', ' bedroom', ' Square', '\n\n', ' Where', ' bathroom', ' before', ' bedroom'], 'evidence_proportions': [0.87626953125, 0.8975016276041666, 0.916015625, 0.26666259765625]}}, 'pred_res': 'The apple was in the office.<|eot_id|>', 'score': 0}
2025-01-22 04:00:09.633 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:00:09.634 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-10_pid-4_3-5-7-9.pkl | len: 3 |  size: 2.01 KB
Processing depth (3, 5, 7, 9):   5%|▌         | 5/100 [01:52<36:23, 22.98s/it]Processing depth (3, 5, 7, 9):   5%|▌         | 5/100 [01:52<35:42, 22.55s/it]
2025-01-22 04:00:09.804 | INFO     | __main__:<module>:82 - Selected idx: 11
2025-01-22 04:00:09.804 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the location prior to the place where the milk was discarded, left or dropped?
2025-01-22 04:00:09.804 | INFO     | __main__:<module>:84 - Answer: bathroom
2025-01-22 04:00:09.804 | INFO     | __main__:<module>:85 - Tag: 4-hop
2025-01-22 04:00:09.804 | INFO     | __main__:<module>:86 - Needle: [' Mary moved to the bathroom.', ' Mary picked up the milk.', ' John moved to the garden.', ' John went back to the office.', ' Daniel took the football.', ' Daniel left the apple.', ' Mary journeyed to the bedroom.', ' Sandra journeyed to the office.', ' Daniel picked up the apple.', ' Sandra moved to the kitchen.', ' Mary left the milk.', ' Daniel dropped the football.']
2025-01-22 04:00:09.804 | INFO     | __main__:<module>:87 - Real Needle: [' Mary moved to the bathroom.', ' Mary picked up the milk.', ' Mary journeyed to the bedroom.', ' Mary left the milk.', ' Daniel dropped the football.']
2025-01-22 04:00:09.804 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['👁️\u200d🗨', '👩🏿\u200d🏫', '👩🏾\u200d🍼', '🛍', '👷🏾\u200d♂️', '😵\u200d💫', '🛹', '🔊', '✌', '🇫🇴']
emoji:
O: 👁️‍🗨 [9468, 239, 223, 31643, 102470, 9468, 245, 101]
N: 👁️‍🗨 [9468, 239, 223, 31643, 102470, 9468, 245, 101]

O: 👩🏿‍🏫 [9468, 239, 102, 9468, 237, 123, 102470, 9468, 237, 104]
N: 👩🏾‍🍼 [9468, 239, 102, 9468, 237, 122, 102470, 9468, 104247]

O: 👩🏾‍🍼 [9468, 239, 102, 9468, 237, 122, 102470, 9468, 104247]
N: 🛍 [9468, 249, 235]

O: 🛍 [9468, 249, 235]
N: ✌ [38798, 234]

O: 👷🏾‍♂️ [9468, 239, 115, 9468, 237, 122, 102470, 17245, 224, 31643]
N: 👷🏾‍♂️ [9468, 239, 115, 9468, 237, 122, 102470, 17245, 224, 31643]

O: 😵‍💫 [76460, 113, 102470, 93273, 104]
N: 😵‍💫 [76460, 113, 102470, 93273, 104]

O: 🛹 [9468, 249, 117]
N: 👩🏿‍🏫 [9468, 239, 102, 9468, 237, 123, 102470, 9468, 237, 104]

O: 🔊 [9468, 242, 232]
N: 🛹 [9468, 249, 117]

O: ✌ [38798, 234]
N: 🔊 [9468, 242, 232]

O: 🇫🇴 [9468, 229, 104, 9468, 114783]
N: 🇫🇴 [9468, 229, 104, 9468, 114783]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.65s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.96s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.69s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.30s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.84s/it]
Processing depth (0, 4, 5, 6, 9):   0%|          | 0/100 [00:17<?, ?it/s]2025-01-22 04:00:27.014 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bathroom.
2025-01-22 04:00:27.014 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  moved to the bathroom.
2025-01-22 04:00:27.015 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary picked up the milk.
2025-01-22 04:00:27.034 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3557, 3562) --> . Mary picked up the
2025-01-22 04:00:27.034 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bedroom.
2025-01-22 04:00:27.057 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4119, 4125) --> . Mary journeyed to the
2025-01-22 04:00:27.058 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary left the milk.
2025-01-22 04:00:27.084 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4623, 4627) -->  Mary left the milk
2025-01-22 04:00:27.084 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel dropped the football.
2025-01-22 04:00:27.122 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7220, 7224) -->  Daniel dropped the football
2025-01-22 04:00:27.122 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John moved to the garden.
2025-01-22 04:00:27.154 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5434, 5439) --> . John moved to the
2025-01-22 04:00:27.154 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the office.
2025-01-22 04:00:27.182 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5665, 5671) --> . John went back to the
2025-01-22 04:00:27.182 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel took the football.
2025-01-22 04:00:27.219 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6983, 6987) -->  Daniel took the football
2025-01-22 04:00:27.219 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the apple.
2025-01-22 04:00:27.247 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5441, 5445) -->  Daniel left the apple
2025-01-22 04:00:27.247 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra journeyed to the office.
2025-01-22 04:00:27.273 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5225, 5231) --> . Sandra journeyed to the
2025-01-22 04:00:27.273 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel picked up the apple.
2025-01-22 04:00:27.304 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (6119, 6124) -->  Daniel picked up the apple
2025-01-22 04:00:27.304 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Sandra moved to the kitchen.
2025-01-22 04:00:27.328 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (4381, 4386) -->  Sandra moved to the kitchen
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:00:28.100 | INFO     | test_jbb_embedding:begin_test:693 - the bathroom<|eot_id|>
2025-01-22 04:00:28.100 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8159])
2025-01-22 04:00:30.331 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [917.8723958333334, 63.8786525974026, 211.30535714285713, 60.71244446501296, 53.98294005102041], 'topk_indices': array([  29, 8144, 8143, 8004, 4627, 8142, 8138, 3563,   33, 8140,   32,
       4626, 4273,   31,   35, 8139,   34,    0, 8154, 8155]), 'topk_tokens': ['\n\n', ' milk', ' the', ' context', '.', ' where', ' prior', '.', ' the', ' the', ' to', ' milk', 'nes', ' moved', '.', ' to', ' bathroom', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [1892.8, 844.8, 611.75, 1032.6875, 134.921875]}, 'weight': {'score': [22.844401041666668, 23.23685218083803, 23.415625, 23.237242379365668, 28.982461734693878], 'topk_indices': array([3293, 3320, 3183, 3135, 7403, 7441, 1431, 1493, 4291, 4307, 5131,
       5192, 7113, 7169, 3476, 3502, 4902, 4979, 4950, 4927]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.709375, 22.1, 20.052083333333332, 26.134765625, 27.341796875]}, 'saliency': {'score': [5.376546223958333, 0.3503998258890284, 1.3696254185267858, 0.3311106232115035, 0.3973930514588648], 'topk_indices': array([  36,   37, 8139,  199, 3559, 4252, 1174, 8141, 8142,   30, 3562,
       8004, 8144, 4125, 8146, 8138, 4273, 4626,   31,   34]), 'topk_tokens': [' PA', 'UL', ' to', 'ION', ' picked', 'nes', 'nes', ' place', ' where', 'Mary', ' milk', ' context', ' milk', ' bedroom', ' discarded', ' prior', 'nes', ' milk', ' moved', ' bathroom'], 'evidence_proportions': [10.9765625, 4.772265625, 3.20751953125, 6.82080078125, 0.941162109375]}}, 'pred_res': 'the bathroom<|eot_id|>', 'score': 100}
2025-01-22 04:00:30.337 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:00:30.338 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-11_pid-0_0-4-5-6-9.pkl | len: 3 |  size: 2.04 KB
Processing depth (0, 4, 5, 6, 9):   1%|          | 1/100 [00:20<33:43, 20.44s/it]is_0k: False
your chose emoji: ['🗡', '🏛', '\U0001fa89', '👎🏽', '🧫', '👂', '🍵', '💇🏽\u200d♀', '👨🏿\u200d❤\u200d👨🏻', '🐔']
emoji:
O: 🗡 [9468, 245, 94]
N: 💇🏽‍♀ [93273, 229, 9468, 237, 121, 102470, 32990]

O: 🏛 [9468, 237, 249]
N: 🗡 [9468, 245, 94]

O: 🪉 [9468, 103, 231]
N: 🧫 [9468, 100, 104]

O: 👎🏽 [9468, 239, 236, 9468, 237, 121]
N: 🏛 [9468, 237, 249]

O: 🧫 [9468, 100, 104]
N: 👨🏿‍❤‍👨🏻 [9468, 239, 101, 9468, 237, 123, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 119]

O: 👂 [9468, 239, 224]
N: 🍵 [9468, 235, 113]

O: 🍵 [9468, 235, 113]
N: 👎🏽 [9468, 239, 236, 9468, 237, 121]

O: 💇🏽‍♀ [93273, 229, 9468, 237, 121, 102470, 32990]
N: 👂 [9468, 239, 224]

O: 👨🏿‍❤‍👨🏻 [9468, 239, 101, 9468, 237, 123, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 119]
N: 🪉 [9468, 103, 231]

O: 🐔 [9468, 238, 242]
N: 🐔 [9468, 238, 242]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.07s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.18s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.53s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.20s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.61s/it]
Processing depth (3, 5, 6, 7, 9):   1%|          | 1/100 [00:36<33:43, 20.44s/it]2025-01-22 04:00:46.707 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bathroom.
2025-01-22 04:00:46.722 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2869, 2874) --> . Mary moved to the
2025-01-22 04:00:46.722 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary picked up the milk.
2025-01-22 04:00:46.746 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4111, 4116) --> . Mary picked up the
2025-01-22 04:00:46.746 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bedroom.
2025-01-22 04:00:46.773 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4701, 4707) --> . Mary journeyed to the
2025-01-22 04:00:46.773 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary left the milk.
2025-01-22 04:00:46.802 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5569, 5573) -->  Mary left the milk
2025-01-22 04:00:46.803 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel dropped the football.
2025-01-22 04:00:46.839 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7119, 7123) -->  dropped the football.
2025-01-22 04:00:46.839 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John moved to the garden.
2025-01-22 04:00:46.867 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5435, 5440) --> . John moved to the
2025-01-22 04:00:46.868 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the office.
2025-01-22 04:00:46.902 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5671, 5677) --> . John went back to the
2025-01-22 04:00:46.902 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel took the football.
2025-01-22 04:00:46.949 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6941, 6945) -->  Daniel took the football
2025-01-22 04:00:46.949 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the apple.
2025-01-22 04:00:46.977 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5442, 5446) -->  Daniel left the apple
2025-01-22 04:00:46.977 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra journeyed to the office.
2025-01-22 04:00:47.008 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5226, 5232) --> . Sandra journeyed to the
2025-01-22 04:00:47.008 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel picked up the apple.
2025-01-22 04:00:47.064 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (6125, 6130) -->  Daniel picked up the apple
2025-01-22 04:00:47.065 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Sandra moved to the kitchen.
2025-01-22 04:00:47.089 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (4430, 4435) -->  execution. Sandra moved to
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:00:47.852 | INFO     | test_jbb_embedding:begin_test:693 - the kitchen<|eot_id|>
2025-01-22 04:00:47.852 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8177])
2025-01-22 04:00:50.076 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [309.1432291666667, 29.068633481051346, 127.55357142857143, 27.81647695788696, 25.141534213362068], 'topk_indices': array([8164, 4116, 8159, 2872, 8169, 8157, 5569, 5572, 8162,   14,   24,
       4117, 8150, 2873, 8151, 2871, 2874,    0, 8172, 8173]), 'topk_tokens': [' discarded', ' milk', ' place', ' to', '?\n', ' to', ' Mary', ' milk', ' milk', '\n', '\n\n', '.', 'Question', ' the', ':', ' moved', ' bathroom', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [555.0, 283.1, 153.89583333333334, 494.9375, 81.453125]}, 'weight': {'score': [21.6044921875, 23.25614685207824, 23.368303571428573, 23.26054461427164, 29.459321120689655], 'topk_indices': array([3304, 3277, 3185, 3137, 7445, 7407, 1477, 1415, 4298, 4282, 5193,
       5132, 7184, 7128, 3486, 3460, 4883, 4937, 4908, 4966]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.646875, 22.1, 20.052083333333332, 26.134765625, 21.23046875]}, 'saliency': {'score': [1.7400156656901042, 0.1618364627903423, 0.7959372384207589, 0.15443961166158243, 0.18575023782664332], 'topk_indices': array([8149,   20, 8066,   24, 5570, 8160, 4436, 4707, 8159, 8156, 2870,
       4432, 4116, 5572, 8162, 5569, 8164, 2871, 8150, 2874]), 'topk_tokens': ['.\n\n', ' Jul', ' location', '\n\n', ' left', ' where', ' kitchen', ' bedroom', ' place', ' prior', ' Mary', ' Sandra', ' milk', ' milk', ' milk', ' Mary', ' discarded', ' moved', 'Question', ' bathroom'], 'evidence_proportions': [2.776171875, 1.5619140625, 0.7985432942708334, 3.3251953125, 0.494476318359375]}}, 'pred_res': 'the kitchen<|eot_id|>', 'score': 0}
2025-01-22 04:00:50.083 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:00:50.083 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-11_pid-1_3-5-6-7-9.pkl | len: 3 |  size: 2.06 KB
Processing depth (3, 5, 6, 7, 9):   2%|▏         | 2/100 [00:40<32:43, 20.03s/it]is_0k: False
your chose emoji: ['👩\u200d🦲', '🏃🏿\u200d♂️', '🧏🏾\u200d♀', '⛺', '🤸\u200d♂', '🧕🏻', '💚', '🎰', '\U0001faf4', '👩🏾\u200d✈️']
emoji:
O: 👩‍🦲 [9468, 239, 102, 102470, 9468, 99, 110]
N: 🧏🏾‍♀ [9468, 100, 237, 9468, 237, 122, 102470, 32990]

O: 🏃🏿‍♂️ [9468, 237, 225, 9468, 237, 123, 102470, 17245, 224, 31643]
N: 🫴 [9468, 104, 112]

O: 🧏🏾‍♀ [9468, 100, 237, 9468, 237, 122, 102470, 32990]
N: 🧕🏻 [9468, 100, 243, 9468, 237, 119]

O: ⛺ [158, 249, 118]
N: 🤸‍♂ [9468, 97, 116, 102470, 17245, 224]

O: 🤸‍♂ [9468, 97, 116, 102470, 17245, 224]
N: 👩‍🦲 [9468, 239, 102, 102470, 9468, 99, 110]

O: 🧕🏻 [9468, 100, 243, 9468, 237, 119]
N: ⛺ [158, 249, 118]

O: 💚 [93273, 248]
N: 🎰 [9468, 236, 108]

O: 🎰 [9468, 236, 108]
N: 🏃🏿‍♂️ [9468, 237, 225, 9468, 237, 123, 102470, 17245, 224, 31643]

O: 🫴 [9468, 104, 112]
N: 💚 [93273, 248]

O: 👩🏾‍✈️ [9468, 239, 102, 9468, 237, 122, 102470, 38798, 230, 31643]
N: 👩🏾‍✈️ [9468, 239, 102, 9468, 237, 122, 102470, 38798, 230, 31643]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.05s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.18s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.17s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.93s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.37s/it]
Processing depth (1, 3, 4, 6, 7):   2%|▏         | 2/100 [00:55<32:43, 20.03s/it]2025-01-22 04:01:05.391 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bathroom.
2025-01-22 04:01:05.396 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (815, 820) --> . Mary moved to the
2025-01-22 04:01:05.396 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary picked up the milk.
2025-01-22 04:01:05.411 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2871, 2876) --> . Mary picked up the
2025-01-22 04:01:05.411 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bedroom.
2025-01-22 04:01:05.429 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3551, 3557) --> . Mary journeyed to the
2025-01-22 04:01:05.430 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary left the milk.
2025-01-22 04:01:05.454 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4749, 4753) -->  Mary left the milk
2025-01-22 04:01:05.455 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel dropped the football.
2025-01-22 04:01:05.485 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5636, 5640) -->  Daniel dropped the football
2025-01-22 04:01:05.485 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John moved to the garden.
2025-01-22 04:01:05.513 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5576, 5581) --> . John moved to the
2025-01-22 04:01:05.513 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the office.
2025-01-22 04:01:05.545 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5812, 5818) --> . John went back to the
2025-01-22 04:01:05.545 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel took the football.
2025-01-22 04:01:05.583 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (7024, 7028) -->  Daniel took the football
2025-01-22 04:01:05.583 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the apple.
2025-01-22 04:01:05.610 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5583, 5587) -->  Daniel left the apple
2025-01-22 04:01:05.610 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra journeyed to the office.
2025-01-22 04:01:05.638 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5397, 5403) --> . Sandra journeyed to the
2025-01-22 04:01:05.638 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel picked up the apple.
2025-01-22 04:01:05.670 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (6217, 6222) --> . Daniel picked up the
2025-01-22 04:01:05.670 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Sandra moved to the kitchen.
2025-01-22 04:01:05.693 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (4468, 4473) --> . Sandra moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:01:06.470 | INFO     | test_jbb_embedding:begin_test:693 - the kitchen<|eot_id|>
2025-01-22 04:01:06.470 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8179])
2025-01-22 04:01:08.693 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [561.7838541666666, 45.05261549743339, 134.14732142857142, 43.142008032746524, 41.68094544491525], 'topk_indices': array([7537, 8058,   24,  816, 4753,  821, 7492, 8153, 2876, 8164,   14,
       2877,  815,  818,  817,  819,  820,    0, 8174, 8175]), 'topk_tokens': ['nes', '.\n\n', '\n\n', ' Mary', '.', '.', 'nes', ':', ' milk', ' milk', '\n', '.', '.', ' to', ' moved', ' the', ' bathroom', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [1292.9, 470.5, 331.875, 532.375, 136.265625]}, 'weight': {'score': [22.623046875, 23.254869683451478, 22.073214285714286, 23.261827911485906, 29.265625], 'topk_indices': array([3314, 3287, 3207, 3159, 7429, 7391, 1429, 1491, 4289, 4273, 5162,
       5101, 7156, 7100, 3496, 3470, 4897, 4926, 4872, 4955]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.646875, 22.1, 20.052083333333332, 26.134765625, 27.341796875]}, 'saliency': {'score': [2.99249267578125, 0.24909782549537093, 0.8233843122209822, 0.23851780537444794, 0.3142638125662076], 'topk_indices': array([ 263, 8162,   54, 3557, 7332,  818,  819, 8158, 4469, 7537, 7536,
       4752, 8152, 7492, 8166,  816, 2876, 8164,  817,  820]), 'topk_tokens': ['hue', ' where', '\n\n\n\n', ' bedroom', 'nes', ' to', ' the', ' prior', ' Sandra', 'nes', ' Min', ' milk', 'Question', 'nes', ' discarded', ' Mary', ' milk', ' milk', ' moved', ' bathroom'], 'evidence_proportions': [6.152734375, 2.5642578125, 1.7281901041666667, 3.48486328125, 0.9815673828125]}}, 'pred_res': 'the kitchen<|eot_id|>', 'score': 0}
2025-01-22 04:01:08.712 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:01:08.712 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-11_pid-2_1-3-4-6-7.pkl | len: 3 |  size: 2.02 KB
Processing depth (1, 3, 4, 6, 7):   3%|▎         | 3/100 [00:58<31:20, 19.39s/it]is_0k: False
your chose emoji: ['🕟', '🚣\u200d♂', '🥷🏿', '🗞️', '↙️', '🇦🇶', '🧘🏾\u200d♂', '🙇🏾\u200d♀️', '🈷', '👨🏼\u200d🏭']
emoji:
O: 🕟 [9468, 243, 253]
N: 🈷 [9468, 230, 115]

O: 🚣‍♂ [9468, 248, 96, 102470, 17245, 224]
N: 🧘🏾‍♂ [9468, 100, 246, 9468, 237, 122, 102470, 17245, 224]

O: 🥷🏿 [9468, 98, 115, 9468, 237, 123]
N: 🕟 [9468, 243, 253]

O: 🗞️ [9468, 245, 252, 31643]
N: 🚣‍♂ [9468, 248, 96, 102470, 17245, 224]

O: ↙️ [27017, 247, 31643]
N: 🗞️ [9468, 245, 252, 31643]

O: 🇦🇶 [9468, 229, 99, 9468, 229, 114]
N: ↙️ [27017, 247, 31643]

O: 🧘🏾‍♂ [9468, 100, 246, 9468, 237, 122, 102470, 17245, 224]
N: 🥷🏿 [9468, 98, 115, 9468, 237, 123]

O: 🙇🏾‍♀️ [9468, 247, 229, 9468, 237, 122, 102470, 32990, 31643]
N: 🇦🇶 [9468, 229, 99, 9468, 229, 114]

O: 🈷 [9468, 230, 115]
N: 🙇🏾‍♀️ [9468, 247, 229, 9468, 237, 122, 102470, 32990, 31643]

O: 👨🏼‍🏭 [9468, 239, 101, 9468, 237, 120, 102470, 9468, 237, 255]
N: 👨🏼‍🏭 [9468, 239, 101, 9468, 237, 120, 102470, 9468, 237, 255]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.77s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.74s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.48s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.10s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.66s/it]
Processing depth (0, 1, 2, 3, 8):   3%|▎         | 3/100 [01:15<31:20, 19.39s/it]2025-01-22 04:01:24.997 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bathroom.
2025-01-22 04:01:24.997 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  moved to the bathroom.
2025-01-22 04:01:24.997 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary picked up the milk.
2025-01-22 04:01:25.002 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (901, 906) --> . Mary picked up the
2025-01-22 04:01:25.002 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bedroom.
2025-01-22 04:01:25.012 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1853, 1859) --> . Mary journeyed to the
2025-01-22 04:01:25.012 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary left the milk.
2025-01-22 04:01:25.026 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2879, 2883) -->  Mary left the milk
2025-01-22 04:01:25.026 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel dropped the football.
2025-01-22 04:01:25.060 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6521, 6525) -->  Daniel dropped the football
2025-01-22 04:01:25.061 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John moved to the garden.
2025-01-22 04:01:25.089 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5578, 5583) --> . John moved to the
2025-01-22 04:01:25.090 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the office.
2025-01-22 04:01:25.118 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5745, 5751) --> . John went back to the
2025-01-22 04:01:25.118 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel took the football.
2025-01-22 04:01:25.156 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6984, 6988) -->  Daniel took the football
2025-01-22 04:01:25.156 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the apple.
2025-01-22 04:01:25.186 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5585, 5589) -->  Daniel left the apple
2025-01-22 04:01:25.186 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra journeyed to the office.
2025-01-22 04:01:25.216 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5399, 5405) --> . Sandra journeyed to the
2025-01-22 04:01:25.216 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel picked up the apple.
2025-01-22 04:01:25.246 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (6200, 6205) --> . Daniel picked up the
2025-01-22 04:01:25.246 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Sandra moved to the kitchen.
2025-01-22 04:01:25.272 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (4506, 4511) -->  Sandra moved to the kitchen
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:01:26.045 | INFO     | test_jbb_embedding:begin_test:693 - The bathroom.<|eot_id|>
2025-01-22 04:01:26.046 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8167])
2025-01-22 04:01:28.244 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [46.489420572916664, 4.873850596695227, 8.913895089285715, 4.733279121332141, 4.126893241450472], 'topk_indices': array([8160,   25,    1,   28,    4, 8139, 8159,   23, 8161,    9, 8012,
         34, 8046,   24, 8166,   14, 8165, 8163,    0, 8162]), 'topk_tokens': ['Answer', '<|eot_id|>', '<|start_header_id|>', '<|end_header_id|>', '\n\n', '.\n\n', '?\n', '4', ':', ':', ' context', ' bathroom', '.\n\n', '\n\n', '\n\n', '\n', '<|end_header_id|>', '<|start_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [125.6375, 37.93125, 20.583333333333332, 31.32421875, 12.2763671875]}, 'weight': {'score': [22.844401041666668, 23.24389152386781, 22.75736607142857, 23.247173013500184, 29.09139150943396], 'topk_indices': array([3273, 3300, 3145, 3193, 7431, 7393, 1473, 1411, 4258, 4274, 5164,
       5103, 7170, 7114, 3456, 3482, 4880, 4905, 4928, 4957]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.709375, 22.1, 20.052083333333332, 26.134765625, 27.341796875]}, 'saliency': {'score': [0.26988855997721356, 0.026452957956414475, 0.05411267961774554, 0.025613290257407474, 0.030822466004569577], 'topk_indices': array([8127, 8159, 8139,   14,   16,  105, 8154,   23, 8056,    8,   31,
       8140, 8046, 8164,   24,   20, 8166, 8160, 8012,   34]), 'topk_tokens': [' return', '?\n', '.\n\n', '\n', ' Date', 'ION', ' discarded', '4', ' location', ' Date', ' moved', 'Question', '.\n\n', 'assistant', '\n\n', ' Jul', '\n\n', 'Answer', ' context', ' bathroom'], 'evidence_proportions': [0.74287109375, 0.205859375, 0.101531982421875, 0.199066162109375, 0.08205413818359375]}}, 'pred_res': 'The bathroom.<|eot_id|>', 'score': 100}
2025-01-22 04:01:28.250 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:01:28.250 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-11_pid-3_0-1-2-3-8.pkl | len: 3 |  size: 2.07 KB
Processing depth (0, 1, 2, 3, 8):   4%|▍         | 4/100 [01:18<31:07, 19.45s/it]is_0k: False
your chose emoji: ['🙋🏿\u200d♀', '🧑🏽\u200d🍼', '🧏\u200d♂', '📣', '🇲🇰', '🚞', '🦓', '🗒️', '🚚', '👨\u200d⚕️']
emoji:
O: 🙋🏿‍♀ [9468, 247, 233, 9468, 237, 123, 102470, 32990]
N: 📣 [9468, 241, 96]

O: 🧑🏽‍🍼 [9468, 100, 239, 9468, 237, 121, 102470, 9468, 104247]
N: 🧏‍♂ [9468, 100, 237, 102470, 17245, 224]

O: 🧏‍♂ [9468, 100, 237, 102470, 17245, 224]
N: 🚞 [9468, 248, 252]

O: 📣 [9468, 241, 96]
N: 🚚 [9468, 248, 248]

O: 🇲🇰 [9468, 229, 110, 9468, 229, 108]
N: 🇲🇰 [9468, 229, 110, 9468, 229, 108]

O: 🚞 [9468, 248, 252]
N: 🙋🏿‍♀ [9468, 247, 233, 9468, 237, 123, 102470, 32990]

O: 🦓 [9468, 99, 241]
N: 🧑🏽‍🍼 [9468, 100, 239, 9468, 237, 121, 102470, 9468, 104247]

O: 🗒️ [9468, 245, 240, 31643]
N: 🦓 [9468, 99, 241]

O: 🚚 [9468, 248, 248]
N: 🗒️ [9468, 245, 240, 31643]

O: 👨‍⚕️ [9468, 239, 101, 102470, 158, 248, 243, 31643]
N: 👨‍⚕️ [9468, 239, 101, 102470, 158, 248, 243, 31643]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.19s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.71s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.62s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.15s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.67s/it]
Processing depth (1, 5, 6, 7, 9):   4%|▍         | 4/100 [01:34<31:07, 19.45s/it]2025-01-22 04:01:44.596 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bathroom.
2025-01-22 04:01:44.600 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (697, 702) --> . Mary moved to the
2025-01-22 04:01:44.600 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary picked up the milk.
2025-01-22 04:01:44.621 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4244, 4249) -->  Mary picked up the milk
2025-01-22 04:01:44.621 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bedroom.
2025-01-22 04:01:44.645 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4775, 4781) --> . Mary journeyed to the
2025-01-22 04:01:44.645 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary left the milk.
2025-01-22 04:01:44.673 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5662, 5666) -->  left the milk.
2025-01-22 04:01:44.673 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel dropped the football.
2025-01-22 04:01:44.708 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7318, 7322) -->  Daniel dropped the football
2025-01-22 04:01:44.708 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John moved to the garden.
2025-01-22 04:01:44.736 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5637, 5642) --> . John moved to the
2025-01-22 04:01:44.736 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the office.
2025-01-22 04:01:44.765 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5763, 5769) --> . John went back to the
2025-01-22 04:01:44.765 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel took the football.
2025-01-22 04:01:44.799 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (7081, 7085) -->  Daniel took the football
2025-01-22 04:01:44.799 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the apple.
2025-01-22 04:01:44.826 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5644, 5648) -->  Daniel left the apple
2025-01-22 04:01:44.827 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra journeyed to the office.
2025-01-22 04:01:44.854 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5418, 5424) --> . Sandra journeyed to the
2025-01-22 04:01:44.854 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel picked up the apple.
2025-01-22 04:01:44.884 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (6217, 6222) -->  Daniel picked up the apple
2025-01-22 04:01:44.884 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Sandra moved to the kitchen.
2025-01-22 04:01:44.907 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (4506, 4511) -->  Sandra moved to the kitchen
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:01:45.715 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 04:01:45.715 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8281])
2025-01-22 04:01:47.966 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [451.921875, 38.79169558788025, 195.69241071428573, 36.9185467325228, 61.28103693181818], 'topk_indices': array([8170, 8273, 8264, 4248, 4249, 8255,   14, 8160, 8260, 8261, 8266,
       8268,  263,  699,  701,  700,  702,    0, 8276, 8277]), 'topk_tokens': [' location', '?\n', ' where', ' milk', '.', ':', '\n', '.\n\n', ' prior', ' to', ' milk', ' discarded', 'hue', ' moved', ' the', ' to', ' bathroom', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [852.6, 486.25, 264.7083333333333, 513.9375, 126.96875]}, 'weight': {'score': [22.607421875, 23.35412202740222, 23.415625, 23.3560391337386, 30.21619318181818], 'topk_indices': array([3335, 3362, 3207, 3255, 7551, 7513, 1571, 1509, 4338, 4354, 5212,
       5273, 7267, 7211, 3518, 3544, 5066, 5014, 5037, 4989]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.646875, 26.6515625, 20.052083333333332, 20.3515625, 27.341796875]}, 'saliency': {'score': [2.543614705403646, 0.21945547032966412, 1.2237252371651786, 0.20840024072710867, 0.4729696100408381], 'topk_indices': array([8274, 8256, 4244, 8160,  700, 4257, 8263,  698, 5664, 4781, 8264,
       8170, 8254, 4248, 8260, 8266,  699,  263, 8268,  702]), 'topk_tokens': ['Answer', ' Where', ' Mary', '.\n\n', ' to', '�', ' place', ' Mary', ' milk', ' bedroom', ' where', ' location', 'Question', ' milk', ' prior', ' milk', ' moved', 'hue', ' discarded', ' bathroom'], 'evidence_proportions': [4.191796875, 3.3671875, 1.4666341145833333, 2.7109375, 0.902069091796875]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 0}
2025-01-22 04:01:47.991 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:01:47.991 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-11_pid-4_1-5-6-7-9.pkl | len: 3 |  size: 2.06 KB
Processing depth (1, 5, 6, 7, 9):   5%|▌         | 5/100 [01:38<30:57, 19.55s/it]Processing depth (1, 5, 6, 7, 9):   5%|▌         | 5/100 [01:38<31:05, 19.63s/it]
2025-01-22 04:01:48.056 | INFO     | __main__:<module>:82 - Selected idx: 12
2025-01-22 04:01:48.056 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the apple before the bedroom? 
2025-01-22 04:01:48.056 | INFO     | __main__:<module>:84 - Answer: bathroom
2025-01-22 04:01:48.056 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 04:01:48.056 | INFO     | __main__:<module>:86 - Needle: [' John moved to the garden.', ' Sandra journeyed to the office.', ' Daniel picked up the apple.', ' Sandra moved to the kitchen.', ' Mary moved to the bathroom.', ' John went back to the office.', ' Daniel left the apple.', ' Mary journeyed to the bedroom.', ' Mary left the apple.', ' Daniel journeyed to the kitchen.']
2025-01-22 04:01:48.056 | INFO     | __main__:<module>:87 - Real Needle: [' Mary moved to the bathroom.', ' Mary journeyed to the bedroom.', ' Mary left the apple.', ' Daniel journeyed to the kitchen.']
2025-01-22 04:01:48.056 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['🆖', '🙋🏽\u200d♀️', '🕵🏼\u200d♂', '🏃\u200d♀️', '🧑🏾\u200d❤️\u200d🧑🏽', '👱🏿\u200d♂', '🧎🏽\u200d♂️\u200d➡️', '👨🏿\u200d❤️\u200d👨🏿', '👩🏻\u200d❤️\u200d💋\u200d👩🏼', '👰🏼\u200d♂']
emoji:
O: 🆖 [9468, 228, 244]
N: 🆖 [9468, 228, 244]

O: 🙋🏽‍♀️ [9468, 247, 233, 9468, 237, 121, 102470, 32990, 31643]
N: 👩🏻‍❤️‍💋‍👩🏼 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 120]

O: 🕵🏼‍♂ [9468, 243, 113, 9468, 237, 120, 102470, 17245, 224]
N: 🧎🏽‍♂️‍➡️ [9468, 100, 236, 9468, 237, 121, 102470, 17245, 224, 31643, 102470, 98115, 94, 31643]

O: 🏃‍♀️ [9468, 237, 225, 102470, 32990, 31643]
N: 👨🏿‍❤️‍👨🏿 [9468, 239, 101, 9468, 237, 123, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 123]

O: 🧑🏾‍❤️‍🧑🏽 [9468, 100, 239, 9468, 237, 122, 102470, 121643, 31643, 102470, 9468, 100, 239, 9468, 237, 121]
N: 🕵🏼‍♂ [9468, 243, 113, 9468, 237, 120, 102470, 17245, 224]

O: 👱🏿‍♂ [9468, 239, 109, 9468, 237, 123, 102470, 17245, 224]
N: 👱🏿‍♂ [9468, 239, 109, 9468, 237, 123, 102470, 17245, 224]

O: 🧎🏽‍♂️‍➡️ [9468, 100, 236, 9468, 237, 121, 102470, 17245, 224, 31643, 102470, 98115, 94, 31643]
N: 🧑🏾‍❤️‍🧑🏽 [9468, 100, 239, 9468, 237, 122, 102470, 121643, 31643, 102470, 9468, 100, 239, 9468, 237, 121]

O: 👨🏿‍❤️‍👨🏿 [9468, 239, 101, 9468, 237, 123, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 123]
N: 🏃‍♀️ [9468, 237, 225, 102470, 32990, 31643]

O: 👩🏻‍❤️‍💋‍👩🏼 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 120]
N: 🙋🏽‍♀️ [9468, 247, 233, 9468, 237, 121, 102470, 32990, 31643]

O: 👰🏼‍♂ [9468, 239, 108, 9468, 237, 120, 102470, 17245, 224]
N: 👰🏼‍♂ [9468, 239, 108, 9468, 237, 120, 102470, 17245, 224]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.62s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.69s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:03,  3.98s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  2.56s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  3.22s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 4, 5, 9):   0%|          | 0/100 [00:14<?, ?it/s]2025-01-22 04:02:02.846 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bathroom.
2025-01-22 04:02:02.846 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  moved to the bathroom.
2025-01-22 04:02:02.846 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the bedroom.
2025-01-22 04:02:02.867 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3635, 3641) -->  Mary journeyed to the bedroom
2025-01-22 04:02:02.867 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary left the apple.
2025-01-22 04:02:02.889 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4241, 4245) -->  left the apple.
2025-01-22 04:02:02.890 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the kitchen.
2025-01-22 04:02:02.928 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7290, 7296) -->  cold. Daniel journeyed to
2025-01-22 04:02:02.928 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John moved to the garden.
2025-01-22 04:02:02.946 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3500, 3505) --> . John moved to the
2025-01-22 04:02:02.947 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra journeyed to the office.
2025-01-22 04:02:02.985 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (7226, 7232) --> . Sandra journeyed to the
2025-01-22 04:02:02.985 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel picked up the apple.
2025-01-22 04:02:02.991 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1128, 1133) --> . Daniel picked up the
2025-01-22 04:02:02.991 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra moved to the kitchen.
2025-01-22 04:02:03.015 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4059, 4064) --> . Sandra moved to the
2025-01-22 04:02:03.015 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went back to the office.
2025-01-22 04:02:03.057 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7562, 7568) --> . John went back to the
2025-01-22 04:02:03.057 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel left the apple.
2025-01-22 04:02:03.060 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (618, 622) -->  Daniel left the apple
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:02:07.191 | INFO     | test_jbb_embedding:begin_test:693 - The bathroom.<|eot_id|>
2025-01-22 04:02:07.191 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8189])
2025-01-22 04:02:10.317 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [200.40550595238096, 18.06484603881836, 100.63155241935483, 17.279990786240788, 16.92939319349315], 'topk_indices': array([8173, 8176,   25,  622, 8172, 8179, 8180,   28, 8077, 8043, 8177,
        185,   24,   14,    1, 8187,   34, 8185, 8184,    0]), 'topk_tokens': [' Where', ' apple', '<|eot_id|>', '.', ':', ' bedroom', '?', '<|end_header_id|>', '.\n\n', ' context', ' before', 'ION', '\n\n', '\n', '<|start_header_id|>', '<|end_header_id|>', ' bathroom', '<|start_header_id|>', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [448.75, 204.25, 137.546875, 31.513020833333332]}, 'weight': {'score': [22.59077380952381, 23.27760887145996, 21.459929435483872, 23.286303171068795, 29.386772260273972], 'topk_indices': array([3282, 3309, 3154, 3202, 7413, 7451, 1500, 1438, 4331, 4315, 5126,
       5187, 7120, 7176, 3465, 3491, 4903, 4980, 4928, 4951]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.709375, 24.57421875, 20.421875, 23.62109375]}, 'saliency': {'score': [1.2637270972842263, 0.10019469261169434, 0.6032793598790323, 0.09527702612724585, 0.1253595221532534], 'topk_indices': array([ 285,   27, 8182, 8180, 8077,   31,  621,   24,  618,    0, 8173,
       8171, 8176,  536, 3640, 8177, 8043,  185, 8179,   34]), 'topk_tokens': ['hue', 'user', 'Answer', '?', '.\n\n', ' moved', ' apple', '\n\n', ' Daniel', '<|begin_of_text|>', ' Where', 'Question', ' apple', ' instead', ' bedroom', ' before', ' context', 'ION', ' bedroom', ' bathroom'], 'evidence_proportions': [2.8259765625, 1.370849609375, 0.7781982421875, 0.17841593424479166]}}, 'pred_res': 'The bathroom.<|eot_id|>', 'score': 100}
2025-01-22 04:02:10.324 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:02:10.324 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-12_pid-0_0-4-5-9.pkl | len: 3 |  size: 2.05 KB
Processing depth (0, 4, 5, 9):   1%|          | 1/100 [00:22<36:28, 22.11s/it]is_0k: False
your chose emoji: ['👨🏻\u200d🦽', '🤵🏿\u200d♀', '👦🏻', '👩🏽\u200d❤\u200d👨🏿', '🦵🏾', '🤸🏻\u200d♀️', '🐈', '🧎🏻\u200d♀\u200d➡', '👝', '❇']
emoji:
O: 👨🏻‍🦽 [9468, 239, 101, 9468, 237, 119, 102470, 9468, 99, 121]
N: 🧎🏻‍♀‍➡ [9468, 100, 236, 9468, 237, 119, 102470, 32990, 102470, 98115, 94]

O: 🤵🏿‍♀ [9468, 97, 113, 9468, 237, 123, 102470, 32990]
N: 👦🏻 [9468, 239, 99, 9468, 237, 119]

O: 👦🏻 [9468, 239, 99, 9468, 237, 119]
N: 👝 [9468, 239, 251]

O: 👩🏽‍❤‍👨🏿 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 123]
N: 👩🏽‍❤‍👨🏿 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 123]

O: 🦵🏾 [9468, 99, 113, 9468, 237, 122]
N: 🤵🏿‍♀ [9468, 97, 113, 9468, 237, 123, 102470, 32990]

O: 🤸🏻‍♀️ [9468, 97, 116, 9468, 237, 119, 102470, 32990, 31643]
N: 👨🏻‍🦽 [9468, 239, 101, 9468, 237, 119, 102470, 9468, 99, 121]

O: 🐈 [9468, 238, 230]
N: 🦵🏾 [9468, 99, 113, 9468, 237, 122]

O: 🧎🏻‍♀‍➡ [9468, 100, 236, 9468, 237, 119, 102470, 32990, 102470, 98115, 94]
N: 🐈 [9468, 238, 230]

O: 👝 [9468, 239, 251]
N: 🤸🏻‍♀️ [9468, 97, 116, 9468, 237, 119, 102470, 32990, 31643]

O: ❇ [49633, 229]
N: ❇ [49633, 229]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:05<00:15,  5.17s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:10<00:10,  5.11s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.50s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.10s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.74s/it]
Processing depth (0, 4, 5, 6):   1%|          | 1/100 [00:38<36:28, 22.11s/it]2025-01-22 04:02:27.029 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bathroom.
2025-01-22 04:02:27.029 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  moved to the bathroom.
2025-01-22 04:02:27.029 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the bedroom.
2025-01-22 04:02:27.048 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3635, 3641) -->  Mary journeyed to the bedroom
2025-01-22 04:02:27.048 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary left the apple.
2025-01-22 04:02:27.068 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4233, 4237) -->  left the apple.
2025-01-22 04:02:27.068 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the kitchen.
2025-01-22 04:02:27.095 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4746, 4752) --> . Daniel journeyed to the
2025-01-22 04:02:27.095 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John moved to the garden.
2025-01-22 04:02:27.112 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3544, 3549) --> . John moved to the
2025-01-22 04:02:27.113 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra journeyed to the office.
2025-01-22 04:02:27.148 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (7119, 7125) --> . Sandra journeyed to the
2025-01-22 04:02:27.148 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel picked up the apple.
2025-01-22 04:02:27.154 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1225, 1230) -->  Republican. Daniel picked up
2025-01-22 04:02:27.154 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra moved to the kitchen.
2025-01-22 04:02:27.174 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4071, 4076) --> . Sandra moved to the
2025-01-22 04:02:27.174 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went back to the office.
2025-01-22 04:02:27.211 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7426, 7432) --> . John went back to the
2025-01-22 04:02:27.211 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel left the apple.
2025-01-22 04:02:27.214 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (632, 636) -->  Daniel left the apple
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:02:28.032 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 04:02:28.032 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8197])
2025-01-22 04:02:30.269 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [320.9144345238095, 24.22278963414634, 130.92086693548387, 23.052175380461463, 14.830382508116884], 'topk_indices': array([8179,   24,  636,   14, 3641, 8195,   67, 8180, 8188, 8184,  105,
       8182, 8181, 8187,   34,   68, 8185,    0, 8192, 8193]), 'topk_tokens': ['Question', '\n\n', '.', '\n', '.', '<|end_header_id|>', 'ION', ':', '?', ' apple', 'ION', ' was', ' Where', ' bedroom', ' bathroom', 'E', ' before', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [643.9, 374.9583333333333, 258.40625, 39.388020833333336]}, 'weight': {'score': [21.633556547619047, 23.275958460365853, 22.241431451612904, 23.284127431578302, 28.98153409090909], 'topk_indices': array([3280, 3307, 3152, 3200, 7450, 7488, 1478, 1416, 4307, 4323, 5232,
       5171, 7164, 7220, 3489, 3463, 4996, 4948, 5025, 4973]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.709375, 24.57421875, 20.421875, 20.270833333333332]}, 'saliency': {'score': [1.9317132859002977, 0.13233194490758385, 0.8197710590977823, 0.12507892322118924, 0.111354382007153], 'topk_indices': array([ 263,   27, 8190, 8180,  632,   66,   31,  635, 8188, 8182, 8179,
         68, 3640,   67,  105, 8184, 8181, 8187, 8185,   34]), 'topk_tokens': ['hue', 'user', 'Answer', ':', ' Daniel', ' P', ' moved', ' apple', '?', ' was', 'Question', 'E', ' bedroom', 'ION', 'ION', ' apple', ' Where', ' bedroom', ' before', ' bathroom'], 'evidence_proportions': [3.895703125, 2.3909505208333335, 1.3609619140625, 0.21631876627604166]}}, 'pred_res': 'The garden.<|eot_id|>', 'score': 0}
2025-01-22 04:02:30.274 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:02:30.274 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-12_pid-1_0-4-5-6.pkl | len: 3 |  size: 1.98 KB
Processing depth (0, 4, 5, 6):   2%|▏         | 2/100 [00:42<34:02, 20.84s/it]is_0k: False
your chose emoji: ['🇬🇱', '🧑\u200d🦯', '🙅\u200d♀', '👦', '🧑🏿\u200d🦽\u200d➡️', '👩🏾\u200d🦼\u200d➡', '👩🏻\u200d🦲', '🧑🏽\u200d🦽', '🤾🏾', '🍖']
emoji:
O: 🇬🇱 [9468, 229, 105, 9468, 229, 109]
N: 🤾🏾 [9468, 97, 122, 9468, 237, 122]

O: 🧑‍🦯 [9468, 100, 239, 102470, 9468, 99, 107]
N: 👩🏾‍🦼‍➡ [9468, 239, 102, 9468, 237, 122, 102470, 9468, 99, 120, 102470, 98115, 94]

O: 🙅‍♀ [9468, 247, 227, 102470, 32990]
N: 🙅‍♀ [9468, 247, 227, 102470, 32990]

O: 👦 [9468, 239, 99]
N: 🧑‍🦯 [9468, 100, 239, 102470, 9468, 99, 107]

O: 🧑🏿‍🦽‍➡️ [9468, 100, 239, 9468, 237, 123, 102470, 9468, 99, 121, 102470, 98115, 94, 31643]
N: 👦 [9468, 239, 99]

O: 👩🏾‍🦼‍➡ [9468, 239, 102, 9468, 237, 122, 102470, 9468, 99, 120, 102470, 98115, 94]
N: 🧑🏽‍🦽 [9468, 100, 239, 9468, 237, 121, 102470, 9468, 99, 121]

O: 👩🏻‍🦲 [9468, 239, 102, 9468, 237, 119, 102470, 9468, 99, 110]
N: 👩🏻‍🦲 [9468, 239, 102, 9468, 237, 119, 102470, 9468, 99, 110]

O: 🧑🏽‍🦽 [9468, 100, 239, 9468, 237, 121, 102470, 9468, 99, 121]
N: 🧑🏿‍🦽‍➡️ [9468, 100, 239, 9468, 237, 123, 102470, 9468, 99, 121, 102470, 98115, 94, 31643]

O: 🤾🏾 [9468, 97, 122, 9468, 237, 122]
N: 🇬🇱 [9468, 229, 105, 9468, 229, 109]

O: 🍖 [9468, 235, 244]
N: 🍖 [9468, 235, 244]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.21s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.73s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.45s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.88s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.48s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (2, 3, 5, 6):   2%|▏         | 2/100 [00:57<34:02, 20.84s/it]2025-01-22 04:02:45.919 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bathroom.
2025-01-22 04:02:45.929 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2009, 2014) -->  cable. Mary moved to
2025-01-22 04:02:45.930 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the bedroom.
2025-01-22 04:02:45.947 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2993, 2999) -->  tragedy. Mary journeyed to
2025-01-22 04:02:45.948 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary left the apple.
2025-01-22 04:02:45.971 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4276, 4280) -->  Mary left the apple
2025-01-22 04:02:45.971 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the kitchen.
2025-01-22 04:02:46.000 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4877, 4883) -->  Daniel journeyed to the kitchen
2025-01-22 04:02:46.001 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John moved to the garden.
2025-01-22 04:02:46.018 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3593, 3598) --> . John moved to the
2025-01-22 04:02:46.018 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra journeyed to the office.
2025-01-22 04:02:46.060 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (7221, 7227) --> . Sandra journeyed to the
2025-01-22 04:02:46.061 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel picked up the apple.
2025-01-22 04:02:46.067 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1219, 1224) -->  Republican. Daniel picked up
2025-01-22 04:02:46.067 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra moved to the kitchen.
2025-01-22 04:02:46.088 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4109, 4114) --> . Sandra moved to the
2025-01-22 04:02:46.088 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went back to the office.
2025-01-22 04:02:46.128 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7472, 7478) --> . John went back to the
2025-01-22 04:02:46.128 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel left the apple.
2025-01-22 04:02:46.132 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (626, 630) -->  Daniel left the apple
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:02:49.785 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 04:02:49.785 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8173])
2025-01-22 04:02:52.738 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [138.25967261904762, 19.38281823324364, 109.21748991935483, 18.73273345180945, 9.953695913461539], 'topk_indices': array([ 627,  257, 8154, 8089,   14,  625, 8061, 8101, 8071, 8161,  983,
         24,    1, 8169,  629,  630, 8171, 2015, 8168,    0]), 'topk_tokens': [' left', 'hue', '.\n\n', ' a', '\n', '.', '.\n\n', ' the', ' location', ' before', ' election', '\n\n', '<|start_header_id|>', '<|start_header_id|>', ' apple', '.', '<|end_header_id|>', ' bathroom', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [237.00625, 150.39583333333334, 140.984375, 42.018229166666664]}, 'weight': {'score': [24.767113095238095, 23.27058425574853, 22.241431451612904, 23.270642925283113, 29.703846153846154], 'topk_indices': array([3304, 3277, 3197, 3149, 7451, 7413, 1472, 1410, 4285, 4301, 5188,
       5127, 7115, 7171, 3460, 3486, 4904, 4981, 4952, 4929]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [24.0734375, 24.891927083333332, 26.205078125, 24.26171875]}, 'saliency': {'score': [0.7993367513020834, 0.10803778064227618, 0.6951215190272177, 0.1040105927700717, 0.0740802471454327], 'topk_indices': array([8067, 8154, 8061, 8070, 8166,   24, 2012, 8155, 8160,  627,   35,
       8071, 8161,  626, 3000,  257, 8163,  983,  629, 2015]), 'topk_tokens': [' item', '.\n\n', '.\n\n', ' first', 'Answer', '\n\n', ' moved', 'Question', ' apple', ' left', '-text', ' location', ' before', ' Daniel', ' bedroom', 'hue', ' bedroom', ' election', ' apple', ' bathroom'], 'evidence_proportions': [1.325146484375, 0.81103515625, 0.9393310546875, 0.256134033203125]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 0}
2025-01-22 04:02:52.743 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:02:52.743 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-12_pid-2_2-3-5-6.pkl | len: 3 |  size: 2.03 KB
Processing depth (2, 3, 5, 6):   3%|▎         | 3/100 [01:04<34:53, 21.58s/it]is_0k: False
your chose emoji: ['🙎🏻', '🙅\u200d♀️', '🧑🏻\u200d🦼\u200d➡️', '🧝🏿', '🇶🇦', '🗓️', '🙎🏿\u200d♀️', '🙇🏼\u200d♂', '🛖', '💴']
emoji:
O: 🙎🏻 [9468, 247, 236, 9468, 237, 119]
N: 🧑🏻‍🦼‍➡️ [9468, 100, 239, 9468, 237, 119, 102470, 9468, 99, 120, 102470, 98115, 94, 31643]

O: 🙅‍♀️ [9468, 247, 227, 102470, 32990, 31643]
N: 🙅‍♀️ [9468, 247, 227, 102470, 32990, 31643]

O: 🧑🏻‍🦼‍➡️ [9468, 100, 239, 9468, 237, 119, 102470, 9468, 99, 120, 102470, 98115, 94, 31643]
N: 🛖 [9468, 249, 244]

O: 🧝🏿 [9468, 100, 251, 9468, 237, 123]
N: 🙇🏼‍♂ [9468, 247, 229, 9468, 237, 120, 102470, 17245, 224]

O: 🇶🇦 [9468, 229, 114, 9468, 229, 99]
N: 🙎🏿‍♀️ [9468, 247, 236, 9468, 237, 123, 102470, 32990, 31643]

O: 🗓️ [9468, 245, 241, 31643]
N: 🧝🏿 [9468, 100, 251, 9468, 237, 123]

O: 🙎🏿‍♀️ [9468, 247, 236, 9468, 237, 123, 102470, 32990, 31643]
N: 🇶🇦 [9468, 229, 114, 9468, 229, 99]

O: 🙇🏼‍♂ [9468, 247, 229, 9468, 237, 120, 102470, 17245, 224]
N: 🙎🏻 [9468, 247, 236, 9468, 237, 119]

O: 🛖 [9468, 249, 244]
N: 🗓️ [9468, 245, 241, 31643]

O: 💴 [93273, 112]
N: 💴 [93273, 112]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.79s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.77s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.59s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.21s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.75s/it]
Processing depth (1, 3, 7, 9):   3%|▎         | 3/100 [01:21<34:53, 21.58s/it]2025-01-22 04:03:09.472 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bathroom.
2025-01-22 04:03:09.477 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (900, 905) --> . Mary moved to the
2025-01-22 04:03:09.477 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the bedroom.
2025-01-22 04:03:09.492 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2902, 2908) --> . Mary journeyed to the
2025-01-22 04:03:09.493 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary left the apple.
2025-01-22 04:03:09.523 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5636, 5640) -->  Mary left the apple
2025-01-22 04:03:09.523 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the kitchen.
2025-01-22 04:03:09.562 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7208, 7214) -->  Daniel journeyed to the kitchen
2025-01-22 04:03:09.562 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John moved to the garden.
2025-01-22 04:03:09.580 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3353, 3358) --> . John moved to the
2025-01-22 04:03:09.580 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra journeyed to the office.
2025-01-22 04:03:09.620 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (7181, 7187) -->  Sandra journeyed to the office
2025-01-22 04:03:09.621 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel picked up the apple.
2025-01-22 04:03:09.627 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1225, 1230) -->  Republican. Daniel picked up
2025-01-22 04:03:09.627 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra moved to the kitchen.
2025-01-22 04:03:09.647 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3971, 3976) -->  the ground. Sandra moved
2025-01-22 04:03:09.647 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went back to the office.
2025-01-22 04:03:09.690 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7388, 7394) --> . John went back to the
2025-01-22 04:03:09.690 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel left the apple.
2025-01-22 04:03:09.693 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (626, 630) -->  Daniel left the apple
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:03:10.511 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 04:03:10.512 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8161])
2025-01-22 04:03:12.754 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [198.56994047619048, 17.332630297648212, 109.76360887096774, 16.510225976947734, 14.98634467690678], 'topk_indices': array([  23, 2908,  626, 8148, 8151,  628,  902, 8155, 8049,   14, 8059,
       8149,   24,  630,    1,  629, 8156, 8159,  905,    0]), 'topk_tokens': ['4', ' bedroom', ' Daniel', ' apple', ' bedroom', ' the', ' moved', ':', '.\n\n', '\n', ' location', ' before', '\n\n', '.', '<|start_header_id|>', ' apple', '<|eot_id|>', '<|end_header_id|>', ' bathroom', '<|begin_of_text|>'], 'evidence_proportions': [400.45, 173.90625, 213.625, 44.963541666666664]}, 'weight': {'score': [22.330357142857142, 23.26470059100931, 23.411542338709676, 23.266558223927515, 29.951006355932204], 'topk_indices': array([3336, 3309, 3229, 3181, 7412, 7450, 1478, 1416, 4300, 4316, 5180,
       5119, 7126, 7070, 3524, 3498, 4913, 4965, 4936, 4888]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.646875, 20.052083333333332, 26.205078125, 24.26171875]}, 'saliency': {'score': [1.0950927734375, 0.09650020048000367, 0.7146212670110887, 0.09155293752455852, 0.1096303907491393], 'topk_indices': array([8143, 1231, 8154, 8145, 8049, 8055,   24, 8053,  627,  901,  902,
       8148,  257, 8149,  626, 2908, 8059, 8151,  629,  905]), 'topk_tokens': ['Question', ' apple', 'Answer', ' Where', '.\n\n', ' item', '\n\n', ' obtained', ' left', ' Mary', ' moved', ' apple', 'hue', ' before', ' Daniel', ' bedroom', ' location', ' bedroom', ' apple', ' bathroom'], 'evidence_proportions': [2.0470703125, 0.8811442057291666, 1.45526123046875, 0.2756144205729167]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 0}
2025-01-22 04:03:12.761 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:03:12.761 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-12_pid-3_1-3-7-9.pkl | len: 3 |  size: 2.03 KB
Processing depth (1, 3, 7, 9):   4%|▍         | 4/100 [01:24<33:32, 20.97s/it]is_0k: False
your chose emoji: ['👱🏿\u200d♀️', '👩🏻\u200d❤️\u200d💋\u200d👨🏽', '⏮', '🤶', '♥️', '🗣️', '💠', '🍺', '🙆🏼\u200d♂️', '8⃣']
emoji:
O: 👱🏿‍♀️ [9468, 239, 109, 9468, 237, 123, 102470, 32990, 31643]
N: 🤶 [9468, 97, 114]

O: 👩🏻‍❤️‍💋‍👨🏽 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 121]
N: 👩🏻‍❤️‍💋‍👨🏽 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 121]

O: ⏮ [158, 237, 106]
N: 🍺 [9468, 235, 118]

O: 🤶 [9468, 97, 114]
N: ⏮ [158, 237, 106]

O: ♥️ [77809, 31643]
N: 💠 [93273, 254]

O: 🗣️ [9468, 245, 96, 31643]
N: 🗣️ [9468, 245, 96, 31643]

O: 💠 [93273, 254]
N: ♥️ [77809, 31643]

O: 🍺 [9468, 235, 118]
N: 🙆🏼‍♂️ [9468, 247, 228, 9468, 237, 120, 102470, 17245, 224, 31643]

O: 🙆🏼‍♂️ [9468, 247, 228, 9468, 237, 120, 102470, 17245, 224, 31643]
N: 👱🏿‍♀️ [9468, 239, 109, 9468, 237, 123, 102470, 32990, 31643]

O: 8⃣ [23, 158, 225, 96]
N: 8⃣ [23, 158, 225, 96]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.31s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.44s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.38s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.03s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.53s/it]
Processing depth (4, 5, 7, 8):   4%|▍         | 4/100 [01:40<33:32, 20.97s/it]2025-01-22 04:03:28.642 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bathroom.
2025-01-22 04:03:28.662 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3609, 3614) -->  Hon. Mary moved to
2025-01-22 04:03:28.662 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the bedroom.
2025-01-22 04:03:28.685 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4217, 4223) -->  Mary journeyed to the bedroom
2025-01-22 04:03:28.688 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary left the apple.
2025-01-22 04:03:28.718 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5734, 5738) -->  Mary left the apple
2025-01-22 04:03:28.719 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the kitchen.
2025-01-22 04:03:28.751 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6605, 6611) -->  Daniel journeyed to the kitchen
2025-01-22 04:03:28.751 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John moved to the garden.
2025-01-22 04:03:28.770 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3484, 3489) --> . John moved to the
2025-01-22 04:03:28.770 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra journeyed to the office.
2025-01-22 04:03:28.805 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (7102, 7108) -->  Sandra journeyed to the office
2025-01-22 04:03:28.805 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel picked up the apple.
2025-01-22 04:03:28.810 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1106, 1111) --> . Daniel picked up the
2025-01-22 04:03:28.810 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra moved to the kitchen.
2025-01-22 04:03:28.830 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4046, 4051) --> . Sandra moved to the
2025-01-22 04:03:28.830 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went back to the office.
2025-01-22 04:03:28.867 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7452, 7458) --> . John went back to the
2025-01-22 04:03:28.867 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel left the apple.
2025-01-22 04:03:28.870 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (626, 630) -->  Daniel left the apple
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:03:29.653 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 04:03:29.653 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8179])
2025-01-22 04:03:31.877 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [110.29166666666667, 11.953615787704718, 61.47820060483871, 11.51076693188807, 10.333697150735293], 'topk_indices': array([8148, 3615, 8166, 8169,    4, 8067, 8173, 8178, 8162,    9, 8160,
       8167,   14,   23,    1,   24, 8175,    0, 8177, 8174]), 'topk_tokens': [' return', ' bathroom', ' apple', ' bedroom', '\n\n', '.\n\n', ':', '\n\n', ':', ':', '.\n\n', ' before', '\n', '4', '<|start_header_id|>', '\n\n', '<|start_header_id|>', '<|begin_of_text|>', '<|end_header_id|>', '<|eot_id|>'], 'evidence_proportions': [166.9625, 125.828125, 111.265625, 46.880208333333336]}, 'weight': {'score': [24.767113095238095, 23.270786864458568, 22.10735887096774, 23.271358010455106, 29.432215073529413], 'topk_indices': array([3266, 3293, 3138, 3186, 7393, 7431, 1416, 1478, 4286, 4270, 5188,
       5127, 7170, 7114, 3449, 3475, 4952, 4904, 4929, 4981]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [24.4546875, 24.57421875, 26.205078125, 24.26171875]}, 'saliency': {'score': [0.6822393508184523, 0.06585326342791341, 0.3704937350365423, 0.06309951650847075, 0.07622673932243795], 'topk_indices': array([  16,   32,   22, 8160, 8172, 8077, 3612,    8, 2259, 8176, 8148,
       4222,   20,   23, 8161, 8166,   24, 8169, 8167, 3615]), 'topk_tokens': [' Date', '***', '202', '.\n\n', 'Answer', ' location', ' moved', ' Date', ' Bench', 'assistant', ' return', ' bedroom', ' Jul', '4', 'Question', ' apple', '\n\n', ' bedroom', ' before', ' bathroom'], 'evidence_proportions': [0.959521484375, 0.8009033203125, 0.75689697265625, 0.2827351888020833]}}, 'pred_res': 'The garden.<|eot_id|>', 'score': 0}
2025-01-22 04:03:31.884 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:03:31.884 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-12_pid-4_4-5-7-8.pkl | len: 3 |  size: 2.01 KB
Processing depth (4, 5, 7, 8):   5%|▌         | 5/100 [01:43<32:08, 20.30s/it]Processing depth (4, 5, 7, 8):   5%|▌         | 5/100 [01:43<32:51, 20.75s/it]
2025-01-22 04:03:31.958 | INFO     | __main__:<module>:82 - Selected idx: 13
2025-01-22 04:03:31.958 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the location prior to the place where the football was discarded, left or dropped?
2025-01-22 04:03:31.958 | INFO     | __main__:<module>:84 - Answer: bathroom
2025-01-22 04:03:31.958 | INFO     | __main__:<module>:85 - Tag: 4-hop
2025-01-22 04:03:31.958 | INFO     | __main__:<module>:86 - Needle: [' Daniel picked up the apple.', ' Sandra moved to the kitchen.', ' Mary moved to the bathroom.', ' John moved to the garden.', ' Mary got the football.', ' Sandra journeyed to the office.', ' Daniel left the apple.', ' Mary journeyed to the bedroom.', ' John went back to the office.', ' Mary left the football.', ' Daniel journeyed to the kitchen.']
2025-01-22 04:03:31.958 | INFO     | __main__:<module>:87 - Real Needle: [' Mary moved to the bathroom.', ' Mary got the football.', ' Mary journeyed to the bedroom.', ' Mary left the football.', ' Daniel journeyed to the kitchen.']
2025-01-22 04:03:31.958 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['🧏🏼\u200d♂', '🇮🇨', '🏌\u200d♀', '🤱🏻', '🟢', '👩🏼\u200d🦽\u200d➡', '👩🏿\u200d🦽', '⚱️', '🔔', '🧎🏾\u200d♂️']
emoji:
O: 🧏🏼‍♂ [9468, 100, 237, 9468, 237, 120, 102470, 17245, 224]
N: 🟢 [9468, 253, 95]

O: 🇮🇨 [9468, 229, 106, 9468, 229, 101]
N: 🤱🏻 [9468, 97, 109, 9468, 237, 119]

O: 🏌‍♀ [9468, 237, 234, 102470, 32990]
N: 🇮🇨 [9468, 229, 106, 9468, 229, 101]

O: 🤱🏻 [9468, 97, 109, 9468, 237, 119]
N: 👩🏿‍🦽 [9468, 239, 102, 9468, 237, 123, 102470, 9468, 99, 121]

O: 🟢 [9468, 253, 95]
N: 👩🏼‍🦽‍➡ [9468, 239, 102, 9468, 237, 120, 102470, 9468, 99, 121, 102470, 98115, 94]

O: 👩🏼‍🦽‍➡ [9468, 239, 102, 9468, 237, 120, 102470, 9468, 99, 121, 102470, 98115, 94]
N: ⚱️ [158, 248, 109, 31643]

O: 👩🏿‍🦽 [9468, 239, 102, 9468, 237, 123, 102470, 9468, 99, 121]
N: 🔔 [9468, 101065]

O: ⚱️ [158, 248, 109, 31643]
N: 🏌‍♀ [9468, 237, 234, 102470, 32990]

O: 🔔 [9468, 101065]
N: 🧏🏼‍♂ [9468, 100, 237, 9468, 237, 120, 102470, 17245, 224]

O: 🧎🏾‍♂️ [9468, 100, 236, 9468, 237, 122, 102470, 17245, 224, 31643]
N: 🧎🏾‍♂️ [9468, 100, 236, 9468, 237, 122, 102470, 17245, 224, 31643]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.24s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.63s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.69s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.23s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.73s/it]
Processing depth (0, 1, 2, 3, 8):   0%|          | 0/100 [00:16<?, ?it/s]2025-01-22 04:03:48.660 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bathroom.
2025-01-22 04:03:48.660 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  moved to the bathroom.
2025-01-22 04:03:48.660 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary got the football.
2025-01-22 04:03:48.665 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (840, 844) -->  got the football.
2025-01-22 04:03:48.665 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bedroom.
2025-01-22 04:03:48.676 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1869, 1875) --> . Mary journeyed to the
2025-01-22 04:03:48.676 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary left the football.
2025-01-22 04:03:48.691 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2907, 2911) -->  Mary left the football
2025-01-22 04:03:48.691 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel journeyed to the kitchen.
2025-01-22 04:03:48.734 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6609, 6615) --> . Daniel journeyed to the
2025-01-22 04:03:48.734 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the apple.
2025-01-22 04:03:48.772 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6706, 6711) --> . Daniel picked up the
2025-01-22 04:03:48.772 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the kitchen.
2025-01-22 04:03:48.773 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (111, 116) --> . Sandra moved to the
2025-01-22 04:03:48.773 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the garden.
2025-01-22 04:03:48.774 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (155, 160) --> . John moved to the
2025-01-22 04:03:48.774 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra journeyed to the office.
2025-01-22 04:03:48.777 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (607, 613) --> . Sandra journeyed to the
2025-01-22 04:03:48.777 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel left the apple.
2025-01-22 04:03:48.799 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4055, 4059) -->  Daniel left the apple
2025-01-22 04:03:48.799 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John went back to the office.
2025-01-22 04:03:48.817 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (2910, 2916) -->  football. John went back to
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:03:49.595 | INFO     | test_jbb_embedding:begin_test:693 - the bathroom<|eot_id|>
2025-01-22 04:03:49.596 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8171])
2025-01-22 04:03:51.832 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [326.53875, 28.384437316491315, 186.8266129032258, 26.86120927260409, 19.515556469298247], 'topk_indices': array([  33,  112,   27, 8156, 8158,  843,  437,   24,   14,   35,   29,
         32,   31,  553,  551,  554,   34,    0, 8166, 8167]), 'topk_tokens': [' the', ' Sandra', 'user', ' football', ' discarded', '.', ' ', '\n\n', '\n', '.', '\n\n', ' to', ' moved', ' to', ',', ' ', ' bathroom', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [871.0, 484.8125, 77.54166666666667, 226.359375, 83.08854166666667]}, 'weight': {'score': [21.3859375, 23.257890873501346, 22.18296370967742, 23.267760493656073, 29.789747807017545], 'topk_indices': array([3335, 3308, 3180, 3228, 7387, 7425, 1433, 1495, 4312, 4328, 5190,
       5129, 7108, 7164, 3517, 3491, 4983, 4931, 4906, 4954]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.709375, 20.828125, 20.052083333333332, 26.462890625, 20.270833333333332]}, 'saliency': {'score': [1.87080322265625, 0.1529039532741008, 1.087583480342742, 0.14404431456091016, 0.14813580429344847], 'topk_indices': array([   0, 7262,   24,  608,  835,   29,  113,  553,   39,   38, 7340,
       8150,   30,   27,  842, 8156, 8158,  112,   31,   34]), 'topk_tokens': ['<|begin_of_text|>', 'nes', '\n\n', ' Sandra', '�', '\n\n', ' moved', ' to', '\n\n\n', '***', 'nes', ' prior', 'Mary', 'user', ' football', ' football', ' discarded', ' Sandra', ' moved', ' bathroom'], 'evidence_proportions': [5.0541015625, 2.559326171875, 0.4022216796875, 1.4984130859375, 0.4758809407552083]}}, 'pred_res': 'the bathroom<|eot_id|>', 'score': 100}
2025-01-22 04:03:51.840 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:03:51.840 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-13_pid-0_0-1-2-3-8.pkl | len: 3 |  size: 2.04 KB
Processing depth (0, 1, 2, 3, 8):   1%|          | 1/100 [00:19<32:39, 19.79s/it]is_0k: False
your chose emoji: ['💦', '🌡️', '🇮🇱', '🤵🏻', '🙆🏼\u200d♀', '❤\u200d🔥', '🙍🏾\u200d♂️', '🍒', '🙆🏽\u200d♂️', '🏏']
emoji:
O: 💦 [93273, 99]
N: 💦 [93273, 99]

O: 🌡️ [9468, 234, 94, 31643]
N: ❤‍🔥 [121643, 102470, 9468, 242, 98]

O: 🇮🇱 [9468, 229, 106, 9468, 229, 109]
N: 🙆🏽‍♂️ [9468, 247, 228, 9468, 237, 121, 102470, 17245, 224, 31643]

O: 🤵🏻 [9468, 97, 113, 9468, 237, 119]
N: 🇮🇱 [9468, 229, 106, 9468, 229, 109]

O: 🙆🏼‍♀ [9468, 247, 228, 9468, 237, 120, 102470, 32990]
N: 🌡️ [9468, 234, 94, 31643]

O: ❤‍🔥 [121643, 102470, 9468, 242, 98]
N: 🍒 [9468, 235, 240]

O: 🙍🏾‍♂️ [9468, 247, 235, 9468, 237, 122, 102470, 17245, 224, 31643]
N: 🙍🏾‍♂️ [9468, 247, 235, 9468, 237, 122, 102470, 17245, 224, 31643]

O: 🍒 [9468, 235, 240]
N: 🤵🏻 [9468, 97, 113, 9468, 237, 119]

O: 🙆🏽‍♂️ [9468, 247, 228, 9468, 237, 121, 102470, 17245, 224, 31643]
N: 🙆🏼‍♀ [9468, 247, 228, 9468, 237, 120, 102470, 32990]

O: 🏏 [9468, 237, 237]
N: 🏏 [9468, 237, 237]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:11,  3.69s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.09s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.43s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.13s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.51s/it]
Processing depth (2, 3, 4, 6, 7):   1%|          | 1/100 [00:35<32:39, 19.79s/it]2025-01-22 04:04:07.514 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bathroom.
2025-01-22 04:04:07.523 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1778, 1783) --> . Mary moved to the
2025-01-22 04:04:07.523 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary got the football.
2025-01-22 04:04:07.538 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2869, 2873) -->  Mary got the football
2025-01-22 04:04:07.538 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bedroom.
2025-01-22 04:04:07.558 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3648, 3654) --> . Mary journeyed to the
2025-01-22 04:04:07.558 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary left the football.
2025-01-22 04:04:07.582 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4801, 4805) -->  Mary left the football
2025-01-22 04:04:07.583 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel journeyed to the kitchen.
2025-01-22 04:04:07.612 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5675, 5681) --> . Daniel journeyed to the
2025-01-22 04:04:07.612 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the apple.
2025-01-22 04:04:07.649 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6700, 6705) --> . Daniel picked up the
2025-01-22 04:04:07.649 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the kitchen.
2025-01-22 04:04:07.650 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (105, 110) --> . Sandra moved to the
2025-01-22 04:04:07.650 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the garden.
2025-01-22 04:04:07.651 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (146, 151) -->  John moved to the garden
2025-01-22 04:04:07.651 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra journeyed to the office.
2025-01-22 04:04:07.653 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (355, 361) --> . Sandra journeyed to the
2025-01-22 04:04:07.653 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel left the apple.
2025-01-22 04:04:07.672 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4074, 4078) -->  Daniel left the apple
2025-01-22 04:04:07.672 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John went back to the office.
2025-01-22 04:04:07.686 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (2872, 2878) -->  football. John went back to
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:04:08.495 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 04:04:08.495 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8187])
2025-01-22 04:04:10.729 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [208.5075, 22.705244581807083, 193.87600806451613, 21.48181821674453, 29.67596153846154], 'topk_indices': array([   1, 8181, 8076, 8186, 7652, 3152, 8172,    9, 8066, 3654, 2873,
         24, 4074,   14, 2872, 8185, 8183, 1783,    0, 8182]), 'topk_tokens': ['<|start_header_id|>', ':', ' location', '\n\n', ' or', 'ern', ' football', ':', '.\n\n', ' bedroom', '.', '\n\n', ' Daniel', '\n', ' football', '<|end_header_id|>', '<|start_header_id|>', ' bathroom', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [298.95, 379.9375, 112.22916666666667, 199.90625, 120.86458333333333]}, 'weight': {'score': [22.09875, 23.257360347985347, 22.911038306451612, 23.26224124815589, 28.959375], 'topk_indices': array([3359, 3332, 3204, 3252, 7469, 7431, 1476, 1538, 4323, 4339, 5208,
       5147, 7208, 7152, 3515, 3541, 4924, 4972, 4949, 5001]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.646875, 26.611328125, 20.052083333333332, 26.462890625, 20.270833333333332]}, 'saliency': {'score': [1.2263671875, 0.12810756138392856, 1.183318107358871, 0.1207104606243853, 0.21467942457932693], 'topk_indices': array([8180, 8174, 3151, 8032, 8066, 8166,  110, 4804,   24,  107, 1780,
       5681, 8076, 3152,  106, 8172, 3654, 4074, 2872, 1783]), 'topk_tokens': ['Answer', ' discarded', ' const', ' context', '.\n\n', ' prior', ' kitchen', ' football', '\n\n', ' moved', ' moved', ' kitchen', ' location', 'ern', ' Sandra', ' football', ' bedroom', ' Daniel', ' football', ' bathroom'], 'evidence_proportions': [1.48935546875, 2.597412109375, 0.5803426106770834, 1.319091796875, 0.6773885091145834]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 0}
2025-01-22 04:04:10.754 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:04:10.754 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-13_pid-1_2-3-4-6-7.pkl | len: 3 |  size: 2.11 KB
Processing depth (2, 3, 4, 6, 7):   2%|▏         | 2/100 [00:38<31:28, 19.27s/it]is_0k: False
your chose emoji: ['🇵🇷', '🧔🏼\u200d♂', '🆘', '🧒🏿', '🇨🇳', '💁\u200d♂', '👩🏽\u200d🤝\u200d👩🏻', '🙆🏾', '🏵️', '⏹']
emoji:
O: 🇵🇷 [9468, 229, 113, 9468, 229, 115]
N: 👩🏽‍🤝‍👩🏻 [9468, 239, 102, 9468, 237, 121, 102470, 9468, 97, 251, 102470, 9468, 239, 102, 9468, 237, 119]

O: 🧔🏼‍♂ [9468, 100, 242, 9468, 237, 120, 102470, 17245, 224]
N: 🧒🏿 [9468, 100, 240, 9468, 237, 123]

O: 🆘 [9468, 228, 246]
N: 🇨🇳 [9468, 229, 101, 9468, 229, 111]

O: 🧒🏿 [9468, 100, 240, 9468, 237, 123]
N: 🇵🇷 [9468, 229, 113, 9468, 229, 115]

O: 🇨🇳 [9468, 229, 101, 9468, 229, 111]
N: 🏵️ [9468, 237, 113, 31643]

O: 💁‍♂ [93273, 223, 102470, 17245, 224]
N: 🙆🏾 [9468, 247, 228, 9468, 237, 122]

O: 👩🏽‍🤝‍👩🏻 [9468, 239, 102, 9468, 237, 121, 102470, 9468, 97, 251, 102470, 9468, 239, 102, 9468, 237, 119]
N: 💁‍♂ [93273, 223, 102470, 17245, 224]

O: 🙆🏾 [9468, 247, 228, 9468, 237, 122]
N: 🆘 [9468, 228, 246]

O: 🏵️ [9468, 237, 113, 31643]
N: 🧔🏼‍♂ [9468, 100, 242, 9468, 237, 120, 102470, 17245, 224]

O: ⏹ [158, 237, 117]
N: ⏹ [158, 237, 117]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.79s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.53s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:03,  3.97s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  2.57s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  3.22s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (1, 2, 4, 6, 8):   2%|▏         | 2/100 [00:53<31:28, 19.27s/it]2025-01-22 04:04:25.405 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bathroom.
2025-01-22 04:04:25.410 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (914, 919) --> . Mary moved to the
2025-01-22 04:04:25.410 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary got the football.
2025-01-22 04:04:25.419 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1815, 1819) -->  Mary got the football
2025-01-22 04:04:25.419 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bedroom.
2025-01-22 04:04:25.439 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3630, 3636) --> . Mary journeyed to the
2025-01-22 04:04:25.439 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary left the football.
2025-01-22 04:04:25.462 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4767, 4771) -->  Mary left the football
2025-01-22 04:04:25.462 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel journeyed to the kitchen.
2025-01-22 04:04:25.495 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6549, 6555) --> . Daniel journeyed to the
2025-01-22 04:04:25.495 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the apple.
2025-01-22 04:04:25.529 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6712, 6717) --> . Daniel picked up the
2025-01-22 04:04:25.529 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the kitchen.
2025-01-22 04:04:25.529 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (105, 110) --> . Sandra moved to the
2025-01-22 04:04:25.529 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the garden.
2025-01-22 04:04:25.530 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (149, 154) --> . John moved to the
2025-01-22 04:04:25.530 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra journeyed to the office.
2025-01-22 04:04:25.533 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (601, 607) --> . Sandra journeyed to the
2025-01-22 04:04:25.533 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel left the apple.
2025-01-22 04:04:25.552 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3966, 3970) -->  Daniel left the apple
2025-01-22 04:04:25.553 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John went back to the office.
2025-01-22 04:04:25.568 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (2855, 2861) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:04:29.173 | INFO     | test_jbb_embedding:begin_test:693 - the bedroom<|eot_id|>
2025-01-22 04:04:29.174 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8195])
2025-01-22 04:04:32.331 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [229.454375, 19.992238960722126, 144.81048387096774, 18.87385048206829, 16.31629302536232], 'topk_indices': array([ 105,  916,    1,  915,  914, 1819,  918,  917,    9, 8180,   24,
       8193, 8074, 1818,   14, 3636, 8190,  919,    0, 8191]), 'topk_tokens': ['.', ' moved', '<|start_header_id|>', ' Mary', '.', '.', ' the', ' to', ':', ' football', '\n\n', '<|end_header_id|>', '.\n\n', ' football', '\n', ' bedroom', '<|eot_id|>', ' bathroom', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [390.5, 341.59375, 194.5625, 253.8125, 39.143229166666664]}, 'weight': {'score': [22.09875, 23.265724109538912, 21.459929435483872, 23.276182717698354, 29.125679347826086], 'topk_indices': array([3314, 3341, 3186, 3234, 7425, 7463, 1498, 1436, 4353, 4369, 5230,
       5169, 7202, 7146, 3497, 3523, 4946, 5023, 4994, 4971]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.646875, 26.611328125, 20.052083333333332, 26.462890625, 20.270833333333332]}, 'saliency': {'score': [1.322333984375, 0.1103771365133836, 0.8339115265877016, 0.10390102655405613, 0.11940997579823369], 'topk_indices': array([8188,  110,    8, 8174,   24, 8084, 8168,  107, 8074, 8182,  557,
        916, 4770,  915,  602,  106, 8180, 1818, 3636,  919]), 'topk_tokens': ['Answer', ' kitchen', ' Date', ' prior', '\n\n', ' location', 'Question', ' moved', '.\n\n', ' discarded', ' instead', ' moved', ' football', ' Mary', ' Sandra', ' Sandra', ' football', ' football', ' bedroom', ' bathroom'], 'evidence_proportions': [1.922265625, 2.36279296875, 1.0015462239583333, 1.6656494140625, 0.22066243489583334]}}, 'pred_res': 'the bedroom<|eot_id|>', 'score': 0}
2025-01-22 04:04:32.341 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:04:32.341 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-13_pid-2_1-2-4-6-8.pkl | len: 3 |  size: 2.1 KB
Processing depth (1, 2, 4, 6, 8):   3%|▎         | 3/100 [01:00<32:52, 20.33s/it]is_0k: False
your chose emoji: ['🧑\u200d🎤', '🥥', '🗼', '🤴🏿', '👩🏽\u200d❤️\u200d💋\u200d👩🏼', '🇲🇾', '🚵🏽', '👯\u200d♀', '🐈\u200d⬛', '👩\u200d🍳']
emoji:
O: 🧑‍🎤 [9468, 100, 239, 102470, 9468, 236, 97]
N: 🤴🏿 [9468, 97, 112, 9468, 237, 123]

O: 🥥 [9468, 98, 98]
N: 🐈‍⬛ [9468, 238, 230, 102470, 158, 105, 249]

O: 🗼 [9468, 245, 120]
N: 🧑‍🎤 [9468, 100, 239, 102470, 9468, 236, 97]

O: 🤴🏿 [9468, 97, 112, 9468, 237, 123]
N: 🚵🏽 [9468, 248, 113, 9468, 237, 121]

O: 👩🏽‍❤️‍💋‍👩🏼 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 120]
N: 👩🏽‍❤️‍💋‍👩🏼 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 120]

O: 🇲🇾 [9468, 229, 110, 9468, 229, 122]
N: 👯‍♀ [9468, 239, 107, 102470, 32990]

O: 🚵🏽 [9468, 248, 113, 9468, 237, 121]
N: 🥥 [9468, 98, 98]

O: 👯‍♀ [9468, 239, 107, 102470, 32990]
N: 🇲🇾 [9468, 229, 110, 9468, 229, 122]

O: 🐈‍⬛ [9468, 238, 230, 102470, 158, 105, 249]
N: 🗼 [9468, 245, 120]

O: 👩‍🍳 [9468, 239, 102, 102470, 9468, 235, 111]
N: 👩‍🍳 [9468, 239, 102, 102470, 9468, 235, 111]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.37s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.54s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.15s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.90s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.42s/it]
Processing depth (0, 2, 4, 6, 8):   3%|▎         | 3/100 [01:15<32:52, 20.33s/it]2025-01-22 04:04:47.788 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bathroom.
2025-01-22 04:04:47.789 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  moved to the bathroom.
2025-01-22 04:04:47.789 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary got the football.
2025-01-22 04:04:47.800 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2025, 2029) -->  Mary got the football
2025-01-22 04:04:47.800 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bedroom.
2025-01-22 04:04:47.820 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3635, 3641) -->  Hon. Mary journeyed to
2025-01-22 04:04:47.820 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary left the football.
2025-01-22 04:04:47.848 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4809, 4813) -->  Mary left the football
2025-01-22 04:04:47.848 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel journeyed to the kitchen.
2025-01-22 04:04:47.885 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6633, 6639) --> . Daniel journeyed to the
2025-01-22 04:04:47.885 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the apple.
2025-01-22 04:04:47.918 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6730, 6735) --> . Daniel picked up the
2025-01-22 04:04:47.918 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the kitchen.
2025-01-22 04:04:47.918 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (111, 116) --> . Sandra moved to the
2025-01-22 04:04:47.918 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the garden.
2025-01-22 04:04:47.919 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (155, 160) --> . John moved to the
2025-01-22 04:04:47.919 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra journeyed to the office.
2025-01-22 04:04:47.922 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (607, 613) --> . Sandra journeyed to the
2025-01-22 04:04:47.923 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel left the apple.
2025-01-22 04:04:47.946 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4074, 4078) -->  Daniel left the apple
2025-01-22 04:04:47.946 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John went back to the office.
2025-01-22 04:04:47.961 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (2945, 2951) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:04:48.779 | INFO     | test_jbb_embedding:begin_test:693 - The bedroom.<|eot_id|>
2025-01-22 04:04:48.779 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8221])
2025-01-22 04:04:51.017 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [468.2075, 44.40393208900778, 179.27520161290323, 42.59490924951029, 48.10556402439025], 'topk_indices': array([  28,   31, 7309, 8208, 4812, 8206, 8216, 7409,  553,   34, 7338,
        554, 2029, 7337, 7385, 7308, 2028, 8217, 7386,    0]), 'topk_tokens': ['<|end_header_id|>', ' moved', 'ot', ' discarded', ' football', ' football', '<|eot_id|>', ' tele', ' to', ' bathroom', 'ot', ' ', '.', 'nes', ' Min', 'nes', ' football', '<|start_header_id|>', 'nes', '<|begin_of_text|>'], 'evidence_proportions': [715.8, 864.625, 259.5625, 611.6875, 110.59375]}, 'weight': {'score': [23.2728125, 23.29176229632782, 21.459929435483872, 23.298772649363368, 29.496760670731707], 'topk_indices': array([3298, 3325, 3170, 3218, 7433, 7471, 1424, 1486, 4327, 4343, 5173,
       5234, 7144, 7200, 3481, 3507, 5027, 4975, 4950, 4998]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.709375, 26.611328125, 24.05859375, 26.462890625, 20.270833333333332]}, 'saliency': {'score': [2.964140625, 0.25037755112703675, 1.0264183782762097, 0.23912616247761845, 0.3507578780011433], 'topk_indices': array([  30, 8200, 7669,  112, 7361,   31,  128, 7338, 7360, 3642, 4812,
       8206, 8208, 7409,   34, 7337, 7308, 7385, 2028, 7386]), 'topk_tokens': ['Mary', ' prior', 'nes', ' Sandra', 'graph', ' moved', ' Published', 'ot', ' tele', ' bedroom', ' football', ' football', ' discarded', ' tele', ' bathroom', 'nes', 'nes', ' Min', ' football', 'nes'], 'evidence_proportions': [4.3025390625, 5.89794921875, 1.4889322916666667, 4.07080078125, 0.63037109375]}}, 'pred_res': 'The bedroom.<|eot_id|>', 'score': 0}
2025-01-22 04:04:51.042 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:04:51.043 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-13_pid-3_0-2-4-6-8.pkl | len: 3 |  size: 2.08 KB
Processing depth (0, 2, 4, 6, 8):   4%|▍         | 4/100 [01:18<31:29, 19.69s/it]is_0k: False
your chose emoji: ['\U0001faf8🏿', '🧗🏼\u200d♀️', '🤘', '👩🏼\u200d❤️\u200d💋\u200d👩🏻', '🇹🇲', '🦵🏾', '🇵🇦', '👡', '💇🏽', '👩🏽\u200d❤️\u200d💋\u200d👩🏾']
emoji:
O: 🫸🏿 [9468, 104, 116, 9468, 237, 123]
N: 🧗🏼‍♀️ [9468, 100, 245, 9468, 237, 120, 102470, 32990, 31643]

O: 🧗🏼‍♀️ [9468, 100, 245, 9468, 237, 120, 102470, 32990, 31643]
N: 🤘 [9468, 97, 246]

O: 🤘 [9468, 97, 246]
N: 🦵🏾 [9468, 99, 113, 9468, 237, 122]

O: 👩🏼‍❤️‍💋‍👩🏻 [9468, 239, 102, 9468, 237, 120, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 119]
N: 👩🏼‍❤️‍💋‍👩🏻 [9468, 239, 102, 9468, 237, 120, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 119]

O: 🇹🇲 [9468, 229, 117, 9468, 229, 110]
N: 🇵🇦 [9468, 229, 113, 9468, 229, 99]

O: 🦵🏾 [9468, 99, 113, 9468, 237, 122]
N: 🫸🏿 [9468, 104, 116, 9468, 237, 123]

O: 🇵🇦 [9468, 229, 113, 9468, 229, 99]
N: 👡 [9468, 239, 94]

O: 👡 [9468, 239, 94]
N: 🇹🇲 [9468, 229, 117, 9468, 229, 110]

O: 💇🏽 [93273, 229, 9468, 237, 121]
N: 💇🏽 [93273, 229, 9468, 237, 121]

O: 👩🏽‍❤️‍💋‍👩🏾 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 122]
N: 👩🏽‍❤️‍💋‍👩🏾 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 122]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.48s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.30s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.03s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  2.62s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  3.21s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 2, 4, 6, 7):   4%|▍         | 4/100 [01:33<31:29, 19.69s/it]2025-01-22 04:05:05.677 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bathroom.
2025-01-22 04:05:05.677 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  moved to the bathroom.
2025-01-22 04:05:05.678 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary got the football.
2025-01-22 04:05:05.687 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1877, 1881) -->  Mary got the football
2025-01-22 04:05:05.687 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bedroom.
2025-01-22 04:05:05.706 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3656, 3662) --> . Mary journeyed to the
2025-01-22 04:05:05.706 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary left the football.
2025-01-22 04:05:05.733 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4881, 4885) -->  Mary left the football
2025-01-22 04:05:05.733 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel journeyed to the kitchen.
2025-01-22 04:05:05.762 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5753, 5759) --> . Daniel journeyed to the
2025-01-22 04:05:05.762 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the apple.
2025-01-22 04:05:05.800 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6800, 6805) --> . Daniel picked up the
2025-01-22 04:05:05.800 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the kitchen.
2025-01-22 04:05:05.800 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (111, 116) --> . Sandra moved to the
2025-01-22 04:05:05.801 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the garden.
2025-01-22 04:05:05.801 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (155, 160) --> . John moved to the
2025-01-22 04:05:05.801 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra journeyed to the office.
2025-01-22 04:05:05.805 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (607, 613) --> . Sandra journeyed to the
2025-01-22 04:05:05.805 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel left the apple.
2025-01-22 04:05:05.824 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4116, 4120) -->  Daniel left the apple
2025-01-22 04:05:05.824 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John went back to the office.
2025-01-22 04:05:05.839 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (2953, 2959) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:05:09.354 | INFO     | test_jbb_embedding:begin_test:693 - bedroom<|eot_id|>
2025-01-22 04:05:09.354 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8179])
2025-01-22 04:05:12.512 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [484.62, 47.71767675996089, 223.7641129032258, 45.70192514767413, 22.405001280737704], 'topk_indices': array([3662,   34,  554, 2116, 1881,  145,  146, 2069, 8175, 8174, 2070,
        127, 1880, 2072,  128, 2117, 2119, 2118,    0, 2071]), 'topk_tokens': [' bedroom', ' bathroom', ' ', ' from', '.', ' for', ' and', '\n', '<|start_header_id|>', '<|eot_id|>', 'P', ' and', ' football', 'irie', ' Published', '\n', 'ra', 'P', '<|begin_of_text|>', 'ra'], 'evidence_proportions': [718.2, 899.625, 319.5, 616.125, 90.75]}, 'weight': {'score': [22.31125, 23.26612151674407, 21.459929435483872, 23.275949690807284, 29.91342213114754], 'topk_indices': array([3321, 3294, 3166, 3214, 7455, 7417, 1502, 1440, 4301, 4285, 5190,
       5129, 7174, 7118, 3477, 3503, 4983, 4954, 4906, 4931]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.709375, 26.611328125, 20.052083333333332, 26.462890625, 20.270833333333332]}, 'saliency': {'score': [3.0481982421875, 0.26628139274856394, 1.3284675844254032, 0.2536705518455421, 0.1666534924116291], 'topk_indices': array([2116,    0, 2117, 2107,   67,  127,  112,  131, 2070, 8166, 8164,
       4884, 3662,   34, 2118, 2119, 1880, 2072,  128, 2071]), 'topk_tokens': [' from', '<|begin_of_text|>', '\n', "'clock", 'ION', ' and', ' Sandra', ' Daily', 'P', ' discarded', ' football', ' football', ' bedroom', ' bathroom', 'P', 'ra', ' football', 'irie', ' Published', 'ra'], 'evidence_proportions': [4.2521484375, 6.21923828125, 1.6861165364583333, 4.185302734375, 0.5348917643229166]}}, 'pred_res': 'bedroom<|eot_id|>', 'score': 0}
2025-01-22 04:05:12.525 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:05:12.525 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-13_pid-4_0-2-4-6-7.pkl | len: 3 |  size: 2.04 KB
Processing depth (0, 2, 4, 6, 7):   5%|▌         | 5/100 [01:40<32:11, 20.33s/it]Processing depth (0, 2, 4, 6, 7):   5%|▌         | 5/100 [01:40<31:52, 20.13s/it]
2025-01-22 04:05:12.691 | INFO     | __main__:<module>:82 - Selected idx: 14
2025-01-22 04:05:12.691 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the apple before the bedroom? 
2025-01-22 04:05:12.691 | INFO     | __main__:<module>:84 - Answer: bathroom
2025-01-22 04:05:12.691 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 04:05:12.691 | INFO     | __main__:<module>:86 - Needle: [' Daniel picked up the apple.', ' Sandra moved to the kitchen.', ' Mary moved to the bathroom.', ' John moved to the garden.', ' Daniel took the football.', ' Mary journeyed to the bedroom.', ' Sandra journeyed to the office.', ' John went back to the office.', ' Mary left the apple.', ' Daniel left the apple.']
2025-01-22 04:05:12.691 | INFO     | __main__:<module>:87 - Real Needle: [' Mary moved to the bathroom.', ' Mary journeyed to the bedroom.', ' Mary left the apple.', ' Daniel left the apple.']
2025-01-22 04:05:12.691 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['🧗🏾\u200d♀', '🚛', '‼️', '👩🏿\u200d💼', '🏌🏾\u200d♀', '👮🏽\u200d♂️', '\U0001fabb', '🧎\u200d♂️\u200d➡️', '⛑', '🔸']
emoji:
O: 🧗🏾‍♀ [9468, 100, 245, 9468, 237, 122, 102470, 32990]
N: 🧗🏾‍♀ [9468, 100, 245, 9468, 237, 122, 102470, 32990]

O: 🚛 [9468, 248, 249]
N: 🏌🏾‍♀ [9468, 237, 234, 9468, 237, 122, 102470, 32990]

O: ‼️ [378, 120, 31643]
N: 🪻 [9468, 103, 119]

O: 👩🏿‍💼 [9468, 239, 102, 9468, 237, 123, 102470, 93273, 120]
N: 🧎‍♂️‍➡️ [9468, 100, 236, 102470, 17245, 224, 31643, 102470, 98115, 94, 31643]

O: 🏌🏾‍♀ [9468, 237, 234, 9468, 237, 122, 102470, 32990]
N: 👩🏿‍💼 [9468, 239, 102, 9468, 237, 123, 102470, 93273, 120]

O: 👮🏽‍♂️ [9468, 239, 106, 9468, 237, 121, 102470, 17245, 224, 31643]
N: 🚛 [9468, 248, 249]

O: 🪻 [9468, 103, 119]
N: ⛑ [158, 249, 239]

O: 🧎‍♂️‍➡️ [9468, 100, 236, 102470, 17245, 224, 31643, 102470, 98115, 94, 31643]
N: 👮🏽‍♂️ [9468, 239, 106, 9468, 237, 121, 102470, 17245, 224, 31643]

O: ⛑ [158, 249, 239]
N: ‼️ [378, 120, 31643]

O: 🔸 [9468, 242, 116]
N: 🔸 [9468, 242, 116]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.65s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.54s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.20s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.92s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.47s/it]
Processing depth (0, 4, 5, 7):   0%|          | 0/100 [00:15<?, ?it/s]2025-01-22 04:05:28.325 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bathroom.
2025-01-22 04:05:28.326 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  moved to the bathroom.
2025-01-22 04:05:28.326 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the bedroom.
2025-01-22 04:05:28.346 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3622, 3628) --> . Mary journeyed to the
2025-01-22 04:05:28.347 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary left the apple.
2025-01-22 04:05:28.369 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4233, 4237) -->  left the apple.
2025-01-22 04:05:28.370 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the apple.
2025-01-22 04:05:28.399 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5807, 5811) -->  Daniel left the apple
2025-01-22 04:05:28.399 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the apple.
2025-01-22 04:05:28.417 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3591, 3596) -->  Hon. Daniel picked up
2025-01-22 04:05:28.417 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the kitchen.
2025-01-22 04:05:28.437 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4122, 4127) -->  Sandra moved to the kitchen
2025-01-22 04:05:28.437 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the garden.
2025-01-22 04:05:28.442 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (965, 970) --> . John moved to the
2025-01-22 04:05:28.442 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel took the football.
2025-01-22 04:05:28.448 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1228, 1232) -->  Daniel took the football
2025-01-22 04:05:28.448 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra journeyed to the office.
2025-01-22 04:05:28.484 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7305, 7311) -->  cold. Sandra journeyed to
2025-01-22 04:05:28.484 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John went back to the office.
2025-01-22 04:05:28.520 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (7064, 7070) -->  John went back to the office
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:05:29.428 | INFO     | test_jbb_embedding:begin_test:693 - The apple was in the kitchen.<|eot_id|>
2025-01-22 04:05:29.428 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8207])
2025-01-22 04:05:31.664 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [159.36019736842104, 14.8435806181486, 75.26436491935483, 14.277543849571078, 12.079372176204819], 'topk_indices': array([3628, 8188, 3629, 8095,    1,   66,   23,    9, 8198, 8197, 8195,
         14,   67,   24,  105,   68, 8202, 8203, 8205,    0]), 'topk_tokens': [' bedroom', '.\n\n', '.', '.\n\n', '<|start_header_id|>', ' P', '4', ':', '?', ' bedroom', ' before', '\n', 'ION', '\n\n', 'ION', 'E', '<|eot_id|>', '<|start_header_id|>', '<|end_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [210.65, 205.5625, 119.53125, 65.7734375]}, 'weight': {'score': [21.66735197368421, 23.29611373325213, 24.341481854838708, 23.295934819240195, 29.516001506024097], 'topk_indices': array([3281, 3254, 3126, 3174, 7428, 7466, 1416, 1478, 4323, 4307, 5179,
       5118, 7142, 7198, 3463, 3437, 4943, 4920, 4895, 4972]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.709375, 20.052083333333332, 20.421875, 26.533203125]}, 'saliency': {'score': [0.865465666118421, 0.08214552922312729, 0.4658606744581653, 0.0788638806810566, 0.0889486289886107], 'topk_indices': array([8200, 8204, 8188, 8095,    0,   23,    8,   66,   34, 8194, 8191,
       8198,   24, 8189, 3628, 8195,   68,   67,  105, 8197]), 'topk_tokens': ['Answer', 'assistant', '.\n\n', '.\n\n', '<|begin_of_text|>', '4', ' Date', ' P', ' bathroom', ' apple', ' Where', '?', '\n\n', 'Question', ' bedroom', ' before', 'E', 'ION', 'ION', ' bedroom'], 'evidence_proportions': [1.206640625, 1.0116373697916667, 0.64544677734375, 0.43975830078125]}}, 'pred_res': 'The apple was in the kitchen.<|eot_id|>', 'score': 0}
2025-01-22 04:05:31.669 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:05:31.669 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-14_pid-0_0-4-5-7.pkl | len: 3 |  size: 2.01 KB
Processing depth (0, 4, 5, 7):   1%|          | 1/100 [00:18<31:09, 18.89s/it]is_0k: False
your chose emoji: ['\U0001faf1🏿', '🌥', '🤚🏻', '🛡', '👩🏿\u200d⚖️', '👨🏿\u200d❤️\u200d💋\u200d👨🏾', '👩🏾\u200d🦼', '🌦️', '👳\u200d♂', '👩🏿\u200d❤\u200d👨🏾']
emoji:
O: 🫱🏿 [9468, 104, 109, 9468, 237, 123]
N: 🛡 [9468, 249, 94]

O: 🌥 [9468, 234, 98]
N: 🌥 [9468, 234, 98]

O: 🤚🏻 [9468, 97, 248, 9468, 237, 119]
N: 🤚🏻 [9468, 97, 248, 9468, 237, 119]

O: 🛡 [9468, 249, 94]
N: 👨🏿‍❤️‍💋‍👨🏾 [9468, 239, 101, 9468, 237, 123, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 122]

O: 👩🏿‍⚖️ [9468, 239, 102, 9468, 237, 123, 102470, 158, 248, 244, 31643]
N: 👩🏿‍⚖️ [9468, 239, 102, 9468, 237, 123, 102470, 158, 248, 244, 31643]

O: 👨🏿‍❤️‍💋‍👨🏾 [9468, 239, 101, 9468, 237, 123, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 122]
N: 👳‍♂ [9468, 239, 111, 102470, 17245, 224]

O: 👩🏾‍🦼 [9468, 239, 102, 9468, 237, 122, 102470, 9468, 99, 120]
N: 👩🏾‍🦼 [9468, 239, 102, 9468, 237, 122, 102470, 9468, 99, 120]

O: 🌦️ [9468, 234, 99, 31643]
N: 🫱🏿 [9468, 104, 109, 9468, 237, 123]

O: 👳‍♂ [9468, 239, 111, 102470, 17245, 224]
N: 🌦️ [9468, 234, 99, 31643]

O: 👩🏿‍❤‍👨🏾 [9468, 239, 102, 9468, 237, 123, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 122]
N: 👩🏿‍❤‍👨🏾 [9468, 239, 102, 9468, 237, 123, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 122]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.66s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:10<00:10,  5.11s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.32s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.78s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.47s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (3, 4, 6, 9):   1%|          | 1/100 [00:35<31:09, 18.89s/it]2025-01-22 04:05:48.242 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bathroom.
2025-01-22 04:05:48.256 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2856, 2861) --> . Mary moved to the
2025-01-22 04:05:48.256 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the bedroom.
2025-01-22 04:05:48.274 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3602, 3608) --> . Mary journeyed to the
2025-01-22 04:05:48.274 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary left the apple.
2025-01-22 04:05:48.297 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4755, 4759) -->  left the apple.
2025-01-22 04:05:48.297 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the apple.
2025-01-22 04:05:48.339 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7248, 7252) -->  Daniel left the apple
2025-01-22 04:05:48.340 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the apple.
2025-01-22 04:05:48.357 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3551, 3556) -->  Daniel picked up the apple
2025-01-22 04:05:48.357 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the kitchen.
2025-01-22 04:05:48.377 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4113, 4118) --> . Sandra moved to the
2025-01-22 04:05:48.378 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the garden.
2025-01-22 04:05:48.382 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (901, 906) --> . John moved to the
2025-01-22 04:05:48.382 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel took the football.
2025-01-22 04:05:48.388 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1065, 1069) -->  took the football.
2025-01-22 04:05:48.388 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra journeyed to the office.
2025-01-22 04:05:48.425 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7309, 7315) -->  cold. Sandra journeyed to
2025-01-22 04:05:48.425 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John went back to the office.
2025-01-22 04:05:48.463 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (7062, 7068) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:05:51.750 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 04:05:51.750 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8205])
2025-01-22 04:05:54.669 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [135.45723684210526, 19.615188687865498, 131.94959677419354, 18.918527059328266, 21.90939405487805], 'topk_indices': array([2861, 3134, 7578, 7608, 8199, 8201,  901, 7607,    1, 7623,   14,
         24, 7667,  907, 7653, 7609, 7668, 8203,    0, 8200]), 'topk_tokens': [' bathroom', 'ern', 'nes', ' or', ':', '<|start_header_id|>', '.', ' two', '<|start_header_id|>', 'nes', '\n', '\n\n', ' Min', '.', ' or', ' three', 'nes', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [156.0, 152.19791666666666, 124.65625, 95.46875]}, 'weight': {'score': [21.387746710526315, 23.29615162037037, 22.100806451612904, 23.30513855264771, 29.599275914634145], 'topk_indices': array([3341, 3314, 3234, 3186, 7432, 7470, 1446, 1508, 4330, 4346, 5156,
       5217, 7197, 7141, 3523, 3497, 4981, 5010, 4958, 4933]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.646875, 20.052083333333332, 20.421875, 26.533203125]}, 'saliency': {'score': [0.7232473273026315, 0.11010301229317053, 0.7517247353830645, 0.10623686674267208, 0.16078586113162158], 'topk_indices': array([7608, 7622, 8193, 8187, 8202,  903, 3134, 8198,   24, 7607,  906,
       7578, 8195, 3608, 7623, 2861, 7653, 7667, 7609, 7668]), 'topk_tokens': [' or', ' Min', ' before', 'Question', 'assistant', ' moved', 'ern', 'Answer', '\n\n', ' two', ' garden', 'nes', ' bedroom', ' bedroom', 'nes', ' bathroom', ' or', ' Min', ' three', 'nes'], 'evidence_proportions': [0.7900390625, 0.7628580729166666, 0.66131591796875, 0.64227294921875]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 0}
2025-01-22 04:05:54.676 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:05:54.676 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-14_pid-1_3-4-6-9.pkl | len: 3 |  size: 2.0 KB
Processing depth (3, 4, 6, 9):   2%|▏         | 2/100 [00:41<34:48, 21.31s/it]is_0k: False
your chose emoji: ['🧎🏿\u200d➡️', '👨🏿\u200d✈️', '👨🏼\u200d❤\u200d💋\u200d👨🏽', '👳🏼\u200d♂', '🏄🏻', '🧗🏽\u200d♂', '💂\u200d♂', '🧝🏿', '📢', '🙌🏾']
emoji:
O: 🧎🏿‍➡️ [9468, 100, 236, 9468, 237, 123, 102470, 98115, 94, 31643]
N: 📢 [9468, 241, 95]

O: 👨🏿‍✈️ [9468, 239, 101, 9468, 237, 123, 102470, 38798, 230, 31643]
N: 🏄🏻 [9468, 237, 226, 9468, 237, 119]

O: 👨🏼‍❤‍💋‍👨🏽 [9468, 239, 101, 9468, 237, 120, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 121]
N: 🧗🏽‍♂ [9468, 100, 245, 9468, 237, 121, 102470, 17245, 224]

O: 👳🏼‍♂ [9468, 239, 111, 9468, 237, 120, 102470, 17245, 224]
N: 👨🏼‍❤‍💋‍👨🏽 [9468, 239, 101, 9468, 237, 120, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 121]

O: 🏄🏻 [9468, 237, 226, 9468, 237, 119]
N: 👳🏼‍♂ [9468, 239, 111, 9468, 237, 120, 102470, 17245, 224]

O: 🧗🏽‍♂ [9468, 100, 245, 9468, 237, 121, 102470, 17245, 224]
N: 💂‍♂ [93273, 224, 102470, 17245, 224]

O: 💂‍♂ [93273, 224, 102470, 17245, 224]
N: 🧝🏿 [9468, 100, 251, 9468, 237, 123]

O: 🧝🏿 [9468, 100, 251, 9468, 237, 123]
N: 🧎🏿‍➡️ [9468, 100, 236, 9468, 237, 123, 102470, 98115, 94, 31643]

O: 📢 [9468, 241, 95]
N: 👨🏿‍✈️ [9468, 239, 101, 9468, 237, 123, 102470, 38798, 230, 31643]

O: 🙌🏾 [9468, 247, 234, 9468, 237, 122]
N: 🙌🏾 [9468, 247, 234, 9468, 237, 122]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:05<00:15,  5.22s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.78s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.53s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.17s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.75s/it]
Processing depth (0, 1, 3, 4):   2%|▏         | 2/100 [00:58<34:48, 21.31s/it]2025-01-22 04:06:11.435 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bathroom.
2025-01-22 04:06:11.435 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  moved to the bathroom.
2025-01-22 04:06:11.436 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the bedroom.
2025-01-22 04:06:11.440 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (901, 907) --> . Mary journeyed to the
2025-01-22 04:06:11.440 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary left the apple.
2025-01-22 04:06:11.455 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2940, 2944) -->  Mary left the apple
2025-01-22 04:06:11.455 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the apple.
2025-01-22 04:06:11.472 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3635, 3639) -->  Daniel left the apple
2025-01-22 04:06:11.472 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the apple.
2025-01-22 04:06:11.492 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3606, 3611) --> . Daniel picked up the
2025-01-22 04:06:11.492 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the kitchen.
2025-01-22 04:06:11.518 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4121, 4126) --> . Sandra moved to the
2025-01-22 04:06:11.518 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the garden.
2025-01-22 04:06:11.523 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (972, 977) --> . John moved to the
2025-01-22 04:06:11.523 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel took the football.
2025-01-22 04:06:11.528 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1127, 1131) -->  Daniel took the football
2025-01-22 04:06:11.528 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra journeyed to the office.
2025-01-22 04:06:11.568 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7370, 7376) --> . Sandra journeyed to the
2025-01-22 04:06:11.568 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John went back to the office.
2025-01-22 04:06:11.606 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (7063, 7069) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:06:12.399 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 04:06:12.399 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8179])
2025-01-22 04:06:14.617 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [199.14802631578948, 17.28162811659741, 67.30040322580645, 16.666030035661585, 11.518738677536232], 'topk_indices': array([8170,    9, 8107,    1,  907, 2990, 2963, 2962,   68,   67, 8167,
         34, 8067,   14,   24, 2991, 8177, 8174,    0, 8175]), 'topk_tokens': ['?', ':', ' the', '<|start_header_id|>', ' bedroom', '\n', 'ching', 'lyn', 'E', 'ION', ' before', ' bathroom', '.\n\n', '\n', '\n\n', 'lyn', '<|end_header_id|>', '<|eot_id|>', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [332.65, 175.45833333333334, 179.21875, 87.734375]}, 'weight': {'score': [22.88486842105263, 23.26186293082376, 21.497731854838708, 23.269468803799803, 28.747282608695652], 'topk_indices': array([3305, 3278, 3150, 3198, 7406, 7444, 1435, 1497, 4292, 4308, 5115,
       5176, 7164, 7108, 3473, 3499, 4940, 4917, 4892, 4969]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.709375, 20.052083333333332, 26.205078125, 26.533203125]}, 'saliency': {'score': [1.171007658305921, 0.0959752991274673, 0.38416265672253025, 0.09236494215380307, 0.08500195931697237], 'topk_indices': array([8170, 8161, 8172, 2943,  105,   68, 8166,   31, 8067, 8077,    0,
       8169,   24,   67, 8167, 2963, 2962,  907,   34, 2991]), 'topk_tokens': ['?', 'Question', 'Answer', ' apple', 'ION', 'E', ' apple', ' moved', '.\n\n', ' location', '<|begin_of_text|>', ' bedroom', '\n\n', 'ION', ' before', 'ching', 'lyn', ' bedroom', ' bathroom', 'lyn'], 'evidence_proportions': [1.95927734375, 0.8857421875, 1.213134765625, 0.571441650390625]}}, 'pred_res': 'The garden.<|eot_id|>', 'score': 0}
2025-01-22 04:06:14.624 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:06:14.624 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-14_pid-2_0-1-3-4.pkl | len: 3 |  size: 2.0 KB
Processing depth (0, 1, 3, 4):   3%|▎         | 3/100 [01:01<33:26, 20.69s/it]is_0k: False
your chose emoji: ['🕴🏿', '🤲🏼', '🚤', '🧝🏻', '👨🏽\u200d⚕', '🙎🏿\u200d♂️', '🚶🏻\u200d♂️', '🇦🇫', '🧗🏾', '\U0001faf6🏿']
emoji:
O: 🕴🏿 [9468, 243, 112, 9468, 237, 123]
N: 🤲🏼 [9468, 97, 110, 9468, 237, 120]

O: 🤲🏼 [9468, 97, 110, 9468, 237, 120]
N: 🧗🏾 [9468, 100, 245, 9468, 237, 122]

O: 🚤 [9468, 248, 97]
N: 🕴🏿 [9468, 243, 112, 9468, 237, 123]

O: 🧝🏻 [9468, 100, 251, 9468, 237, 119]
N: 🚤 [9468, 248, 97]

O: 👨🏽‍⚕ [9468, 239, 101, 9468, 237, 121, 102470, 158, 248, 243]
N: 🇦🇫 [9468, 229, 99, 9468, 229, 104]

O: 🙎🏿‍♂️ [9468, 247, 236, 9468, 237, 123, 102470, 17245, 224, 31643]
N: 🙎🏿‍♂️ [9468, 247, 236, 9468, 237, 123, 102470, 17245, 224, 31643]

O: 🚶🏻‍♂️ [9468, 248, 114, 9468, 237, 119, 102470, 17245, 224, 31643]
N: 👨🏽‍⚕ [9468, 239, 101, 9468, 237, 121, 102470, 158, 248, 243]

O: 🇦🇫 [9468, 229, 99, 9468, 229, 104]
N: 🧝🏻 [9468, 100, 251, 9468, 237, 119]

O: 🧗🏾 [9468, 100, 245, 9468, 237, 122]
N: 🚶🏻‍♂️ [9468, 248, 114, 9468, 237, 119, 102470, 17245, 224, 31643]

O: 🫶🏿 [9468, 104, 114, 9468, 237, 123]
N: 🫶🏿 [9468, 104, 114, 9468, 237, 123]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:11,  3.97s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:09,  4.52s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.48s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.11s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.58s/it]
Processing depth (1, 4, 7, 8):   3%|▎         | 3/100 [01:17<33:26, 20.69s/it]2025-01-22 04:06:30.621 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bathroom.
2025-01-22 04:06:30.626 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (815, 820) --> . Mary moved to the
2025-01-22 04:06:30.626 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the bedroom.
2025-01-22 04:06:30.644 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3578, 3584) --> . Mary journeyed to the
2025-01-22 04:06:30.644 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary left the apple.
2025-01-22 04:06:30.671 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5619, 5623) -->  left the apple.
2025-01-22 04:06:30.671 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the apple.
2025-01-22 04:06:30.703 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6529, 6533) -->  Daniel left the apple
2025-01-22 04:06:30.703 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the apple.
2025-01-22 04:06:30.720 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3527, 3532) -->  Daniel picked up the apple
2025-01-22 04:06:30.721 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the kitchen.
2025-01-22 04:06:30.741 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4089, 4094) --> . Sandra moved to the
2025-01-22 04:06:30.741 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the garden.
2025-01-22 04:06:30.746 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (907, 912) --> . John moved to the
2025-01-22 04:06:30.746 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel took the football.
2025-01-22 04:06:30.751 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1074, 1078) -->  Daniel took the football
2025-01-22 04:06:30.751 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra journeyed to the office.
2025-01-22 04:06:30.788 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7274, 7280) --> . Sandra journeyed to the
2025-01-22 04:06:30.788 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John went back to the office.
2025-01-22 04:06:30.824 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (7035, 7041) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:06:31.639 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 04:06:31.640 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8201])
2025-01-22 04:06:33.882 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [218.50986842105263, 20.286304698927353, 115.1617943548387, 19.46371604427275, 20.65087890625], 'topk_indices': array([8189,    4,    9, 8200,  817, 8089,  819,   23, 6015, 6152, 6017,
         14,    1, 6153,   24,  820, 8199, 8196,    0, 8197]), 'topk_tokens': [' before', '\n\n', ':', '\n\n', ' moved', '.\n\n', ' the', '4', '\n', '\n', ' way', '\n', '<|start_header_id|>', 'the', '\n\n', ' bathroom', '<|end_header_id|>', '<|eot_id|>', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [333.5, 149.73958333333334, 200.25, 196.1875]}, 'weight': {'score': [21.387746710526315, 23.2961950725256, 22.24092741935484, 23.304653965844984, 29.758984375], 'topk_indices': array([3284, 3311, 3204, 3156, 7492, 7454, 1438, 1500, 4306, 4322, 5173,
       5234, 7224, 7168, 3485, 3511, 4962, 4914, 4939, 4991]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.646875, 20.052083333333332, 20.421875, 26.533203125]}, 'saliency': {'score': [1.197471217105263, 0.1126042686399165, 0.7338591544858871, 0.10771447547311902, 0.15150699615478516], 'topk_indices': array([  23, 8198,   20, 8185, 6024, 8189, 8099, 6529, 8194, 3531, 8188,
       1074, 7952,  817, 3584, 8191,   24, 6017, 6153,  820]), 'topk_tokens': ['4', 'assistant', ' Jul', ' Where', ' office', ' before', ' location', ' Daniel', 'Answer', ' apple', ' apple', ' Daniel', ' Square', ' moved', ' bedroom', ' bedroom', '\n\n', ' way', 'the', ' bathroom'], 'evidence_proportions': [1.638671875, 0.7870279947916666, 1.0462646484375, 1.412841796875]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 0}
2025-01-22 04:06:33.901 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:06:33.902 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-14_pid-3_1-4-7-8.pkl | len: 3 |  size: 2.01 KB
Processing depth (1, 4, 7, 8):   4%|▍         | 4/100 [01:21<32:12, 20.13s/it]is_0k: False
your chose emoji: ['🏹', '💁🏽\u200d♀️', '🎥', '👩🏾\u200d❤\u200d💋\u200d👩🏿', '👆', '👩🏾\u200d🦼\u200d➡', '🧑🏼\u200d🎤', '🙎🏼\u200d♂️', '👩\u200d❤\u200d👩', '🕠']
emoji:
O: 🏹 [9468, 237, 117]
N: 🏹 [9468, 237, 117]

O: 💁🏽‍♀️ [93273, 223, 9468, 237, 121, 102470, 32990, 31643]
N: 💁🏽‍♀️ [93273, 223, 9468, 237, 121, 102470, 32990, 31643]

O: 🎥 [9468, 236, 98]
N: 🙎🏼‍♂️ [9468, 247, 236, 9468, 237, 120, 102470, 17245, 224, 31643]

O: 👩🏾‍❤‍💋‍👩🏿 [9468, 239, 102, 9468, 237, 122, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 123]
N: 👩‍❤‍👩 [9468, 239, 102, 102470, 121643, 102470, 9468, 239, 102]

O: 👆 [9468, 239, 228]
N: 👆 [9468, 239, 228]

O: 👩🏾‍🦼‍➡ [9468, 239, 102, 9468, 237, 122, 102470, 9468, 99, 120, 102470, 98115, 94]
N: 🧑🏼‍🎤 [9468, 100, 239, 9468, 237, 120, 102470, 9468, 236, 97]

O: 🧑🏼‍🎤 [9468, 100, 239, 9468, 237, 120, 102470, 9468, 236, 97]
N: 👩🏾‍❤‍💋‍👩🏿 [9468, 239, 102, 9468, 237, 122, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 123]

O: 🙎🏼‍♂️ [9468, 247, 236, 9468, 237, 120, 102470, 17245, 224, 31643]
N: 👩🏾‍🦼‍➡ [9468, 239, 102, 9468, 237, 122, 102470, 9468, 99, 120, 102470, 98115, 94]

O: 👩‍❤‍👩 [9468, 239, 102, 102470, 121643, 102470, 9468, 239, 102]
N: 🎥 [9468, 236, 98]

O: 🕠 [9468, 243, 254]
N: 🕠 [9468, 243, 254]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.15s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.36s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.24s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.77s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.32s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (2, 3, 8, 9):   4%|▍         | 4/100 [01:36<32:12, 20.13s/it]2025-01-22 04:06:49.001 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bathroom.
2025-01-22 04:06:49.010 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1740, 1745) --> . Mary moved to the
2025-01-22 04:06:49.011 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the bedroom.
2025-01-22 04:06:49.028 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2830, 2836) --> . Mary journeyed to the
2025-01-22 04:06:49.028 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary left the apple.
2025-01-22 04:06:49.061 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6484, 6488) -->  Mary left the apple
2025-01-22 04:06:49.061 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the apple.
2025-01-22 04:06:49.100 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7186, 7190) -->  Daniel left the apple
2025-01-22 04:06:49.100 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the apple.
2025-01-22 04:06:49.121 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3553, 3558) --> . Daniel picked up the
2025-01-22 04:06:49.121 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the kitchen.
2025-01-22 04:06:49.142 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4069, 4074) --> . Sandra moved to the
2025-01-22 04:06:49.142 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the garden.
2025-01-22 04:06:49.146 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (779, 784) --> . John moved to the
2025-01-22 04:06:49.146 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel took the football.
2025-01-22 04:06:49.151 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (994, 998) -->  Daniel took the football
2025-01-22 04:06:49.151 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra journeyed to the office.
2025-01-22 04:06:49.192 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7247, 7253) -->  cold. Sandra journeyed to
2025-01-22 04:06:49.193 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John went back to the office.
2025-01-22 04:06:49.231 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (7000, 7006) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:06:52.670 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 04:06:52.670 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8137])
2025-01-22 04:06:55.471 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [142.66447368421052, 16.475756296068795, 104.95224294354838, 15.8403599157911, 14.036661783854166], 'topk_indices': array([7888, 8127,    4, 8136, 8025, 8131, 2836, 8125,    3, 1621,    9,
       8133,   23,    1, 1745,   14,   24,    0, 8135, 8132]), 'topk_tokens': [' Square', ' bedroom', '\n\n', '\n\n', '.\n\n', ':', ' bedroom', ' before', '<|end_header_id|>', ' time', ':', '<|start_header_id|>', '4', '<|start_header_id|>', ' bathroom', '\n', '\n\n', '<|begin_of_text|>', '<|end_header_id|>', '<|eot_id|>'], 'evidence_proportions': [194.975, 128.84375, 141.78125, 98.890625]}, 'weight': {'score': [22.605263157894736, 23.235461455773954, 22.146169354838708, 23.241115574783684, 28.91796875], 'topk_indices': array([3289, 3316, 3161, 3209, 7408, 7370, 1438, 1500, 4302, 4286, 5101,
       5162, 7079, 7135, 3498, 3472, 4955, 4903, 4878, 4926]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.646875, 20.052083333333332, 26.205078125, 26.533203125]}, 'saliency': {'score': [0.8004600123355263, 0.0913336976447328, 0.6200748566658266, 0.08764218022708398, 0.10159778594970703], 'topk_indices': array([1699, 1620,    8,   16, 8134,   20, 8124, 8109, 8119, 8106,   23,
       8035, 1621, 8130, 7888, 8125,   24, 8127, 2836, 1745]), 'topk_tokens': [' some', ' some', ' Date', ' Date', 'assistant', ' Jul', ' apple', ' directly', 'Question', ' return', '4', ' location', ' time', 'Answer', ' Square', ' before', '\n\n', ' bedroom', ' bedroom', ' bathroom'], 'evidence_proportions': [1.006787109375, 0.6326497395833334, 0.92205810546875, 0.67266845703125]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 0}
2025-01-22 04:06:55.478 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:06:55.478 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-14_pid-4_2-3-8-9.pkl | len: 3 |  size: 2.04 KB
Processing depth (2, 3, 8, 9):   5%|▌         | 5/100 [01:42<32:41, 20.65s/it]Processing depth (2, 3, 8, 9):   5%|▌         | 5/100 [01:42<32:33, 20.56s/it]
2025-01-22 04:06:55.582 | INFO     | __main__:<module>:82 - Selected idx: 15
2025-01-22 04:06:55.583 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the location prior to the place where the milk was discarded, left or dropped?
2025-01-22 04:06:55.583 | INFO     | __main__:<module>:84 - Answer: bathroom
2025-01-22 04:06:55.583 | INFO     | __main__:<module>:85 - Tag: 4-hop
2025-01-22 04:06:55.583 | INFO     | __main__:<module>:86 - Needle: [' John moved to the garden.', ' Sandra journeyed to the office.', ' Mary moved to the bathroom.', ' Daniel picked up the apple.', ' Daniel took the football.', ' Mary got the milk.', ' Sandra moved to the kitchen.', ' Mary journeyed to the bedroom.', ' John went back to the office.', ' Mary left the milk.', ' Daniel left the apple.']
2025-01-22 04:06:55.583 | INFO     | __main__:<module>:87 - Real Needle: [' Mary moved to the bathroom.', ' Mary got the milk.', ' Mary journeyed to the bedroom.', ' Mary left the milk.', ' Daniel left the apple.']
2025-01-22 04:06:55.583 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['🇸🇩', '🗓', '👩\u200d✈️', '😬', '🧑🏻\u200d🔬', '🏄🏾', '😥', '🫖', '👬🏾', '🐖']
emoji:
O: 🇸🇩 [9468, 229, 116, 9468, 229, 102]
N: 😥 [76460, 98]

O: 🗓 [9468, 245, 241]
N: 🇸🇩 [9468, 229, 116, 9468, 229, 102]

O: 👩‍✈️ [9468, 239, 102, 102470, 38798, 230, 31643]
N: 🏄🏾 [9468, 237, 226, 9468, 237, 122]

O: 😬 [76460, 105]
N: 👬🏾 [9468, 239, 105, 9468, 237, 122]

O: 🧑🏻‍🔬 [9468, 100, 239, 9468, 237, 119, 102470, 9468, 242, 105]
N: 🗓 [9468, 245, 241]

O: 🏄🏾 [9468, 237, 226, 9468, 237, 122]
N: 😬 [76460, 105]

O: 😥 [76460, 98]
N: 👩‍✈️ [9468, 239, 102, 102470, 38798, 230, 31643]

O: 🫖 [9468, 104, 244]
N: 🫖 [9468, 104, 244]

O: 👬🏾 [9468, 239, 105, 9468, 237, 122]
N: 🧑🏻‍🔬 [9468, 100, 239, 9468, 237, 119, 102470, 9468, 242, 105]

O: 🐖 [9468, 238, 244]
N: 🐖 [9468, 238, 244]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.96s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:10<00:10,  5.29s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.78s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.31s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.93s/it]
Processing depth (0, 4, 6, 8, 9):   0%|          | 0/100 [00:17<?, ?it/s]2025-01-22 04:07:13.047 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bathroom.
2025-01-22 04:07:13.048 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  moved to the bathroom.
2025-01-22 04:07:13.048 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary got the milk.
2025-01-22 04:07:13.068 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3621, 3625) -->  Mary got the milk
2025-01-22 04:07:13.069 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bedroom.
2025-01-22 04:07:13.095 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4797, 4803) -->  the senate. Mary journeyed
2025-01-22 04:07:13.095 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary left the milk.
2025-01-22 04:07:13.126 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6563, 6567) -->  Mary left the milk
2025-01-22 04:07:13.127 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel left the apple.
2025-01-22 04:07:13.166 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7151, 7155) -->  left the apple.
2025-01-22 04:07:13.166 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John moved to the garden.
2025-01-22 04:07:13.186 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3563, 3568) -->  John moved to the garden
2025-01-22 04:07:13.186 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra journeyed to the office.
2025-01-22 04:07:13.210 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4320, 4326) --> . Sandra journeyed to the
2025-01-22 04:07:13.210 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel picked up the apple.
2025-01-22 04:07:13.238 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5120, 5125) --> . Daniel picked up the
2025-01-22 04:07:13.238 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel took the football.
2025-01-22 04:07:13.261 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4243, 4247) -->  took the football.
2025-01-22 04:07:13.261 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra moved to the kitchen.
2025-01-22 04:07:13.296 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6141, 6146) -->  Sandra moved to the kitchen
2025-01-22 04:07:13.296 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John went back to the office.
2025-01-22 04:07:13.310 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (2708, 2714) -->  first. John went back to
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:07:14.109 | INFO     | test_jbb_embedding:begin_test:693 - the kitchen<|eot_id|>
2025-01-22 04:07:14.109 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8211])
2025-01-22 04:07:16.350 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [408.04755434782606, 40.11937697832968, 212.4647177419355, 38.42758118872549, 39.39998998397436], 'topk_indices': array([  67, 3625,   24, 7585, 7540,  425,   68,   29,   30,   14, 1468,
       1528,   35,   32, 1529,   31,   34,    0, 8206, 8207]), 'topk_tokens': ['ION', '.', '\n\n', 'nes', 'nes', ' ', 'E', '\n\n', 'Mary', '\n', ' right', ' of', '.', ' to', ' the', ' moved', ' bathroom', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [948.7, 445.8125, 117.93229166666667, 443.625, 94.0625]}, 'weight': {'score': [23.42866847826087, 23.287651037862187, 22.704889112903224, 23.289467486213237, 29.57051282051282], 'topk_indices': array([3282, 3309, 3202, 3154, 7477, 7439, 1449, 1511, 4293, 4309, 5215,
       5154, 7216, 7160, 3491, 3465, 5002, 4973, 4950, 4925]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.709375, 26.283203125, 23.9921875, 26.134765625, 20.421875]}, 'saliency': {'score': [2.5089933975883154, 0.22418122236996288, 1.2963020570816532, 0.21366817997951135, 0.30003083057892627], 'topk_indices': array([1178,  105, 1527,   67, 8196, 3564, 3567, 8190, 7584, 6566, 3624,
       7585, 8184, 7540, 8198, 4805, 1468,   30,   31,   34]), 'topk_tokens': ['nes', 'ION', ' question', 'ION', ' milk', ' moved', ' garden', ' prior', ' Min', ' milk', ' milk', 'nes', 'Question', 'nes', ' discarded', ' bedroom', ' right', 'Mary', ' moved', ' bathroom'], 'evidence_proportions': [5.5341796875, 3.092529296875, 0.7068379720052084, 2.861572265625, 0.49462890625]}}, 'pred_res': 'the kitchen<|eot_id|>', 'score': 0}
2025-01-22 04:07:16.357 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:07:16.357 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-15_pid-0_0-4-6-8-9.pkl | len: 3 |  size: 2.03 KB
Processing depth (0, 4, 6, 8, 9):   1%|          | 1/100 [00:20<34:07, 20.69s/it]is_0k: False
your chose emoji: ['🧑🏿\u200d❤\u200d🧑🏻', '🧖🏾\u200d♀', '🧇', '🤷\u200d♀️', '💜', '🤽🏻\u200d♀', '💆🏾\u200d♂️', '🤱🏽', '🧑🏾\u200d🎨', '👨🏽\u200d⚕️']
emoji:
O: 🧑🏿‍❤‍🧑🏻 [9468, 100, 239, 9468, 237, 123, 102470, 121643, 102470, 9468, 100, 239, 9468, 237, 119]
N: 🤷‍♀️ [9468, 97, 115, 102470, 32990, 31643]

O: 🧖🏾‍♀ [9468, 100, 244, 9468, 237, 122, 102470, 32990]
N: 🤱🏽 [9468, 97, 109, 9468, 237, 121]

O: 🧇 [9468, 100, 229]
N: 🧑🏾‍🎨 [9468, 100, 239, 9468, 237, 122, 102470, 9468, 236, 101]

O: 🤷‍♀️ [9468, 97, 115, 102470, 32990, 31643]
N: 🤽🏻‍♀ [9468, 97, 121, 9468, 237, 119, 102470, 32990]

O: 💜 [93273, 250]
N: 🧑🏿‍❤‍🧑🏻 [9468, 100, 239, 9468, 237, 123, 102470, 121643, 102470, 9468, 100, 239, 9468, 237, 119]

O: 🤽🏻‍♀ [9468, 97, 121, 9468, 237, 119, 102470, 32990]
N: 💆🏾‍♂️ [93273, 228, 9468, 237, 122, 102470, 17245, 224, 31643]

O: 💆🏾‍♂️ [93273, 228, 9468, 237, 122, 102470, 17245, 224, 31643]
N: 🧇 [9468, 100, 229]

O: 🤱🏽 [9468, 97, 109, 9468, 237, 121]
N: 🧖🏾‍♀ [9468, 100, 244, 9468, 237, 122, 102470, 32990]

O: 🧑🏾‍🎨 [9468, 100, 239, 9468, 237, 122, 102470, 9468, 236, 101]
N: 💜 [93273, 250]

O: 👨🏽‍⚕️ [9468, 239, 101, 9468, 237, 121, 102470, 158, 248, 243, 31643]
N: 👨🏽‍⚕️ [9468, 239, 101, 9468, 237, 121, 102470, 158, 248, 243, 31643]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:11,  3.94s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.17s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.29s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.78s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.30s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (2, 4, 5, 7, 8):   1%|          | 1/100 [00:35<34:07, 20.69s/it]2025-01-22 04:07:31.283 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bathroom.
2025-01-22 04:07:31.295 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1998, 2003) -->  cable. Mary moved to
2025-01-22 04:07:31.296 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary got the milk.
2025-01-22 04:07:31.315 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3593, 3597) -->  Mary got the milk
2025-01-22 04:07:31.315 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bedroom.
2025-01-22 04:07:31.341 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4163, 4169) --> . Mary journeyed to the
2025-01-22 04:07:31.342 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary left the milk.
2025-01-22 04:07:31.380 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5681, 5685) -->  Mary left the milk
2025-01-22 04:07:31.380 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel left the apple.
2025-01-22 04:07:31.412 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6654, 6658) -->  Daniel left the apple
2025-01-22 04:07:31.412 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John moved to the garden.
2025-01-22 04:07:31.430 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3540, 3545) --> . John moved to the
2025-01-22 04:07:31.430 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra journeyed to the office.
2025-01-22 04:07:31.454 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4294, 4300) -->  Sandra journeyed to the office
2025-01-22 04:07:31.455 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel picked up the apple.
2025-01-22 04:07:31.482 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5082, 5087) --> . Daniel picked up the
2025-01-22 04:07:31.482 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel took the football.
2025-01-22 04:07:31.506 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4199, 4203) -->  Daniel took the football
2025-01-22 04:07:31.506 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra moved to the kitchen.
2025-01-22 04:07:31.539 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6223, 6228) --> . Sandra moved to the
2025-01-22 04:07:31.539 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John went back to the office.
2025-01-22 04:07:31.553 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (2825, 2831) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:07:34.633 | INFO     | test_jbb_embedding:begin_test:693 - the garden<|eot_id|>
2025-01-22 04:07:34.633 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8211])
2025-01-22 04:07:37.737 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [201.55027173913044, 19.32046658144631, 98.09072580645162, 18.507578890931374, 16.196814903846153], 'topk_indices': array([8190, 8209, 8195, 8205, 8184, 8185,   14, 8100, 5680, 8196, 3548,
       3596, 8191, 5681,   24, 8207, 4169, 2004, 8206,    0]), 'topk_tokens': [' prior', '<|end_header_id|>', ' the', ':', 'Question', ':', '\n', ' location', '.', ' milk', ' Ramsey', ' milk', ' to', ' Mary', '\n\n', '<|start_header_id|>', ' bedroom', ' bathroom', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [193.63125, 261.625, 158.95833333333334, 321.96875, 94.84375]}, 'weight': {'score': [24.194972826086957, 23.286056960676895, 22.14516129032258, 23.287829350490195, 29.49238782051282], 'topk_indices': array([3310, 3337, 3214, 3166, 7487, 7449, 1461, 1399, 4347, 4363, 5225,
       5164, 7206, 7150, 3505, 3531, 4983, 4935, 4960, 5012]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [24.0734375, 26.283203125, 20.052083333333332, 26.134765625, 26.533203125]}, 'saliency': {'score': [1.2740584663722827, 0.1090442405758271, 0.5537207818800404, 0.10407116459865196, 0.11943836701221955], 'topk_indices': array([5682, 2001,   24, 5679, 8193, 8189, 3545, 8204, 8194, 5684, 8198,
       8100, 8190, 8196, 3596, 8184, 5681, 3548, 4169, 2004]), 'topk_tokens': [' left', ' moved', '\n\n', ' St', ' place', ' location', ' garden', 'Answer', ' where', ' milk', ' discarded', ' location', ' prior', ' milk', ' milk', 'Question', ' Mary', ' Ramsey', ' bedroom', ' bathroom'], 'evidence_proportions': [1.097705078125, 1.7882080078125, 0.84033203125, 2.2540283203125, 0.650970458984375]}}, 'pred_res': 'the garden<|eot_id|>', 'score': 0}
2025-01-22 04:07:37.745 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:07:37.745 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-15_pid-1_2-4-5-7-8.pkl | len: 3 |  size: 2.08 KB
Processing depth (2, 4, 5, 7, 8):   2%|▏         | 2/100 [00:42<34:27, 21.10s/it]is_0k: False
your chose emoji: ['📡', '🏊🏽\u200d♀️', '💁🏿', '🧑🏾\u200d🎄', '🧗🏽\u200d♂️', '👰🏿\u200d♀', '👰🏽\u200d♀', '👨🏻\u200d🦯\u200d➡', '👨\u200d💻', '🛀🏻']
emoji:
O: 📡 [9468, 241, 94]
N: 👨🏻‍🦯‍➡ [9468, 239, 101, 9468, 237, 119, 102470, 9468, 99, 107, 102470, 98115, 94]

O: 🏊🏽‍♀️ [9468, 237, 232, 9468, 237, 121, 102470, 32990, 31643]
N: 🧑🏾‍🎄 [9468, 100, 239, 9468, 237, 122, 102470, 9468, 236, 226]

O: 💁🏿 [93273, 223, 9468, 237, 123]
N: 💁🏿 [93273, 223, 9468, 237, 123]

O: 🧑🏾‍🎄 [9468, 100, 239, 9468, 237, 122, 102470, 9468, 236, 226]
N: 👰🏽‍♀ [9468, 239, 108, 9468, 237, 121, 102470, 32990]

O: 🧗🏽‍♂️ [9468, 100, 245, 9468, 237, 121, 102470, 17245, 224, 31643]
N: 👨‍💻 [9468, 239, 101, 102470, 93273, 119]

O: 👰🏿‍♀ [9468, 239, 108, 9468, 237, 123, 102470, 32990]
N: 👰🏿‍♀ [9468, 239, 108, 9468, 237, 123, 102470, 32990]

O: 👰🏽‍♀ [9468, 239, 108, 9468, 237, 121, 102470, 32990]
N: 🏊🏽‍♀️ [9468, 237, 232, 9468, 237, 121, 102470, 32990, 31643]

O: 👨🏻‍🦯‍➡ [9468, 239, 101, 9468, 237, 119, 102470, 9468, 99, 107, 102470, 98115, 94]
N: 📡 [9468, 241, 94]

O: 👨‍💻 [9468, 239, 101, 102470, 93273, 119]
N: 🧗🏽‍♂️ [9468, 100, 245, 9468, 237, 121, 102470, 17245, 224, 31643]

O: 🛀🏻 [9468, 249, 222, 9468, 237, 119]
N: 🛀🏻 [9468, 249, 222, 9468, 237, 119]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.24s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.17s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.12s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.91s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.37s/it]
Processing depth (0, 1, 6, 8, 9):   2%|▏         | 2/100 [00:57<34:27, 21.10s/it]2025-01-22 04:07:53.029 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bathroom.
2025-01-22 04:07:53.030 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  moved to the bathroom.
2025-01-22 04:07:53.030 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary got the milk.
2025-01-22 04:07:53.035 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (832, 836) -->  Mary got the milk
2025-01-22 04:07:53.035 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bedroom.
2025-01-22 04:07:53.063 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4913, 4919) --> . Mary journeyed to the
2025-01-22 04:07:53.063 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary left the milk.
2025-01-22 04:07:53.095 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6666, 6670) -->  left the milk.
2025-01-22 04:07:53.095 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel left the apple.
2025-01-22 04:07:53.134 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7320, 7324) -->  Daniel left the apple
2025-01-22 04:07:53.135 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John moved to the garden.
2025-01-22 04:07:53.153 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3615, 3620) --> . John moved to the
2025-01-22 04:07:53.153 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra journeyed to the office.
2025-01-22 04:07:53.179 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4366, 4372) --> . Sandra journeyed to the
2025-01-22 04:07:53.179 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel picked up the apple.
2025-01-22 04:07:53.206 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5320, 5325) --> . Daniel picked up the
2025-01-22 04:07:53.206 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel took the football.
2025-01-22 04:07:53.228 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4280, 4284) -->  Daniel took the football
2025-01-22 04:07:53.228 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra moved to the kitchen.
2025-01-22 04:07:53.265 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6234, 6239) --> . Sandra moved to the
2025-01-22 04:07:53.265 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John went back to the office.
2025-01-22 04:07:53.282 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (2832, 2838) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:07:54.093 | INFO     | test_jbb_embedding:begin_test:693 - The bathroom.<|eot_id|>
2025-01-22 04:07:54.094 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8213])
2025-01-22 04:07:56.337 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [67.14622961956522, 5.518088276685735, 13.563256048387096, 5.313867809666748, 4.963304736946203], 'topk_indices': array([   4,    9, 8207,   20, 8177, 8185,    1,    3,   25, 8092,   28,
         23, 8212,   24,   14,   34, 8211,    0, 8209, 8208]), 'topk_tokens': ['\n\n', ':', ':', ' Jul', '.', '.\n\n', '<|start_header_id|>', '<|end_header_id|>', '<|eot_id|>', '.\n\n', '<|end_header_id|>', '4', '\n\n', '\n\n', '\n', ' bathroom', '<|end_header_id|>', '<|begin_of_text|>', '<|start_header_id|>', '<|eot_id|>'], 'evidence_proportions': [172.725, 65.2109375, 16.08984375, 70.046875, 10.7919921875]}, 'weight': {'score': [22.45788043478261, 23.291407391066212, 21.497731854838708, 23.300568756125948, 29.68631329113924], 'topk_indices': array([3318, 3291, 3211, 3163, 7445, 7483, 1426, 1488, 4305, 4289, 5114,
       5175, 7211, 7155, 3500, 3474, 4909, 4939, 4884, 4968]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.709375, 26.283203125, 20.052083333333332, 20.3515625, 26.533203125]}, 'saliency': {'score': [0.40993068529211957, 0.029626317010301925, 0.07558022775957661, 0.0283801063139396, 0.03697446026379549], 'topk_indices': array([8102, 8185, 8176, 8058,    8,   19, 8173, 8186, 8092,   31, 8200,
         16, 8192,   23, 8210, 8212, 8206,   24,   20,   34]), 'topk_tokens': [' location', '.\n\n', ' directly', ' context', ' Date', '26', ' return', 'Question', '.\n\n', ' moved', ' discarded', ' Date', ' prior', '4', 'assistant', '\n\n', 'Answer', '\n\n', ' Jul', ' bathroom'], 'evidence_proportions': [1.090478515625, 0.436737060546875, 0.0818023681640625, 0.36376953125, 0.07079315185546875]}}, 'pred_res': 'The bathroom.<|eot_id|>', 'score': 100}
2025-01-22 04:07:56.343 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:07:56.343 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-15_pid-2_0-1-6-8-9.pkl | len: 3 |  size: 2.09 KB
Processing depth (0, 1, 6, 8, 9):   3%|▎         | 3/100 [01:00<32:15, 19.96s/it]is_0k: False
your chose emoji: ['🏄🏽\u200d♀', '👩🏼\u200d❤️\u200d👩🏾', '👩🏿\u200d❤\u200d👩🏻', '🦸\u200d♂️', '⛏️', '🅿', '👱🏾\u200d♂', '🇸🇬', '👮🏿\u200d♀', '🚐']
emoji:
O: 🏄🏽‍♀ [9468, 237, 226, 9468, 237, 121, 102470, 32990]
N: 🏄🏽‍♀ [9468, 237, 226, 9468, 237, 121, 102470, 32990]

O: 👩🏼‍❤️‍👩🏾 [9468, 239, 102, 9468, 237, 120, 102470, 121643, 31643, 102470, 9468, 239, 102, 9468, 237, 122]
N: 👩🏼‍❤️‍👩🏾 [9468, 239, 102, 9468, 237, 120, 102470, 121643, 31643, 102470, 9468, 239, 102, 9468, 237, 122]

O: 👩🏿‍❤‍👩🏻 [9468, 239, 102, 9468, 237, 123, 102470, 121643, 102470, 9468, 239, 102, 9468, 237, 119]
N: ⛏️ [158, 249, 237, 31643]

O: 🦸‍♂️ [9468, 99, 116, 102470, 17245, 224, 31643]
N: 🦸‍♂️ [9468, 99, 116, 102470, 17245, 224, 31643]

O: ⛏️ [158, 249, 237, 31643]
N: 👩🏿‍❤‍👩🏻 [9468, 239, 102, 9468, 237, 123, 102470, 121643, 102470, 9468, 239, 102, 9468, 237, 119]

O: 🅿 [9468, 227, 123]
N: 👮🏿‍♀ [9468, 239, 106, 9468, 237, 123, 102470, 32990]

O: 👱🏾‍♂ [9468, 239, 109, 9468, 237, 122, 102470, 17245, 224]
N: 👱🏾‍♂ [9468, 239, 109, 9468, 237, 122, 102470, 17245, 224]

O: 🇸🇬 [9468, 229, 116, 9468, 229, 105]
N: 🅿 [9468, 227, 123]

O: 👮🏿‍♀ [9468, 239, 106, 9468, 237, 123, 102470, 32990]
N: 🇸🇬 [9468, 229, 116, 9468, 229, 105]

O: 🚐 [9468, 248, 238]
N: 🚐 [9468, 248, 238]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.67s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.70s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.21s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.71s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.36s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (2, 4, 6, 8, 9):   3%|▎         | 3/100 [01:15<32:15, 19.96s/it]2025-01-22 04:08:11.660 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bathroom.
2025-01-22 04:08:11.668 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1647, 1652) --> . Mary moved to the
2025-01-22 04:08:11.669 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary got the milk.
2025-01-22 04:08:11.686 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3655, 3659) -->  Mary got the milk
2025-01-22 04:08:11.687 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bedroom.
2025-01-22 04:08:11.714 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4812, 4818) -->  Mary journeyed to the bedroom
2025-01-22 04:08:11.714 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary left the milk.
2025-01-22 04:08:11.747 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6603, 6607) -->  Mary left the milk
2025-01-22 04:08:11.747 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel left the apple.
2025-01-22 04:08:11.782 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7298, 7302) -->  Daniel left the apple
2025-01-22 04:08:11.782 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John moved to the garden.
2025-01-22 04:08:11.800 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3602, 3607) --> . John moved to the
2025-01-22 04:08:11.800 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra journeyed to the office.
2025-01-22 04:08:11.821 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4374, 4380) --> . Sandra journeyed to the
2025-01-22 04:08:11.821 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel picked up the apple.
2025-01-22 04:08:11.846 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5140, 5145) --> . Daniel picked up the
2025-01-22 04:08:11.846 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel took the football.
2025-01-22 04:08:11.867 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4305, 4309) -->  took the football.
2025-01-22 04:08:11.867 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra moved to the kitchen.
2025-01-22 04:08:11.896 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5922, 5927) --> . Sandra moved to the
2025-01-22 04:08:11.896 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John went back to the office.
2025-01-22 04:08:11.909 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (2633, 2639) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:08:14.686 | INFO     | test_jbb_embedding:begin_test:693 - the garden<|eot_id|>
2025-01-22 04:08:14.686 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8243])
2025-01-22 04:08:17.734 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [140.36684782608697, 12.547166808149406, 91.88734879032258, 11.888060569763184, 11.515012051196809], 'topk_indices': array([8207, 4375,    4, 8237, 8222,    9, 8132, 8242, 8223, 8122, 1652,
       8239,    3,    1,   24,   14, 8241, 4817, 8238,    0]), 'topk_tokens': ['.', ' Sandra', '\n\n', ':', ' prior', ':', ' location', '\n\n', ' to', '.\n\n', ' bathroom', '<|start_header_id|>', '<|end_header_id|>', '<|start_header_id|>', '\n\n', '\n', '<|end_header_id|>', ' bedroom', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [187.8, 147.125, 187.85416666666666, 113.609375, 29.84375]}, 'weight': {'score': [24.41236413043478, 23.293515416565608, 20.709173387096776, 23.300153732299805, 28.76313164893617], 'topk_indices': array([3384, 3411, 3256, 3304, 7513, 7475, 1545, 1607, 4386, 4402, 5228,
       5289, 7191, 7247, 3593, 3567, 5041, 5070, 5018, 4993]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.646875, 26.283203125, 24.57421875, 26.134765625, 26.533203125]}, 'saliency': {'score': [0.8983817722486414, 0.07030748158671629, 0.5222561743951613, 0.0662723109126091, 0.08090818689224567], 'topk_indices': array([1648, 5927,    0,    8, 8088, 3610, 8236, 8122, 8240, 8216, 3658,
       1649, 3607,   24, 8230, 8132, 8222, 4375, 1652, 4817]), 'topk_tokens': [' Mary', ' kitchen', '<|begin_of_text|>', ' Date', ' context', ' Ramsey', 'Answer', '.\n\n', 'assistant', 'Question', ' milk', ' moved', ' garden', '\n\n', ' discarded', ' location', ' prior', ' Sandra', ' bathroom', ' bedroom'], 'evidence_proportions': [0.973779296875, 1.0084228515625, 1.3221842447916667, 0.75982666015625, 0.1969451904296875]}}, 'pred_res': 'the garden<|eot_id|>', 'score': 0}
2025-01-22 04:08:17.740 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:08:17.740 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-15_pid-3_2-4-6-8-9.pkl | len: 3 |  size: 2.11 KB
Processing depth (2, 4, 6, 8, 9):   4%|▍         | 4/100 [01:22<32:50, 20.53s/it]is_0k: False
your chose emoji: ['👨🏼\u200d🤝\u200d👨🏻', '👩🏾\u200d🤝\u200d👩🏽', '⛹', '🇵🇷', '🧑🏼\u200d🤝\u200d🧑🏻', '🧍🏾', '🤝', '👨🏼\u200d❤️\u200d👨🏿', '🈲', '🇮🇲']
emoji:
O: 👨🏼‍🤝‍👨🏻 [9468, 239, 101, 9468, 237, 120, 102470, 9468, 97, 251, 102470, 9468, 239, 101, 9468, 237, 119]
N: 🧑🏼‍🤝‍🧑🏻 [9468, 100, 239, 9468, 237, 120, 102470, 9468, 97, 251, 102470, 9468, 100, 239, 9468, 237, 119]

O: 👩🏾‍🤝‍👩🏽 [9468, 239, 102, 9468, 237, 122, 102470, 9468, 97, 251, 102470, 9468, 239, 102, 9468, 237, 121]
N: 👨🏼‍🤝‍👨🏻 [9468, 239, 101, 9468, 237, 120, 102470, 9468, 97, 251, 102470, 9468, 239, 101, 9468, 237, 119]

O: ⛹ [158, 249, 117]
N: 👩🏾‍🤝‍👩🏽 [9468, 239, 102, 9468, 237, 122, 102470, 9468, 97, 251, 102470, 9468, 239, 102, 9468, 237, 121]

O: 🇵🇷 [9468, 229, 113, 9468, 229, 115]
N: 👨🏼‍❤️‍👨🏿 [9468, 239, 101, 9468, 237, 120, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 123]

O: 🧑🏼‍🤝‍🧑🏻 [9468, 100, 239, 9468, 237, 120, 102470, 9468, 97, 251, 102470, 9468, 100, 239, 9468, 237, 119]
N: 🧍🏾 [9468, 100, 235, 9468, 237, 122]

O: 🧍🏾 [9468, 100, 235, 9468, 237, 122]
N: 🇵🇷 [9468, 229, 113, 9468, 229, 115]

O: 🤝 [9468, 97, 251]
N: ⛹ [158, 249, 117]

O: 👨🏼‍❤️‍👨🏿 [9468, 239, 101, 9468, 237, 120, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 123]
N: 🈲 [9468, 230, 110]

O: 🈲 [9468, 230, 110]
N: 🤝 [9468, 97, 251]

O: 🇮🇲 [9468, 229, 106, 9468, 229, 110]
N: 🇮🇲 [9468, 229, 106, 9468, 229, 110]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:05<00:15,  5.09s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.80s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.60s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.18s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.76s/it]
Processing depth (1, 3, 6, 7, 9):   4%|▍         | 4/100 [01:38<32:50, 20.53s/it]2025-01-22 04:08:34.598 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bathroom.
2025-01-22 04:08:34.602 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (821, 826) --> . Mary moved to the
2025-01-22 04:08:34.602 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary got the milk.
2025-01-22 04:08:34.617 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2975, 2979) -->  Mary got the milk
2025-01-22 04:08:34.617 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bedroom.
2025-01-22 04:08:34.642 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4861, 4867) --> . Mary journeyed to the
2025-01-22 04:08:34.642 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary left the milk.
2025-01-22 04:08:34.669 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5663, 5667) -->  Mary left the milk
2025-01-22 04:08:34.669 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel left the apple.
2025-01-22 04:08:34.705 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7280, 7284) -->  Daniel left the apple
2025-01-22 04:08:34.705 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John moved to the garden.
2025-01-22 04:08:34.723 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3617, 3622) --> . John moved to the
2025-01-22 04:08:34.723 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra journeyed to the office.
2025-01-22 04:08:34.748 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4405, 4411) -->  execution. Sandra journeyed to
2025-01-22 04:08:34.749 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel picked up the apple.
2025-01-22 04:08:34.774 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5206, 5211) --> . Daniel picked up the
2025-01-22 04:08:34.774 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel took the football.
2025-01-22 04:08:34.794 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4280, 4284) -->  Daniel took the football
2025-01-22 04:08:34.795 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra moved to the kitchen.
2025-01-22 04:08:34.830 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6205, 6210) --> . Sandra moved to the
2025-01-22 04:08:34.831 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John went back to the office.
2025-01-22 04:08:34.845 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (2853, 2859) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:08:35.639 | INFO     | test_jbb_embedding:begin_test:693 - the bathroom<|eot_id|>
2025-01-22 04:08:35.639 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8207])
2025-01-22 04:08:37.912 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [537.8913043478261, 41.6496422046285, 177.95262096774192, 39.732164204266795, 37.22273334703947], 'topk_indices': array([8180, 8086, 5630, 8181, 8190,   24, 5663,  827, 2978, 5665, 8192,
       5664,  826,   14, 2979, 5666, 5667, 8202,    0, 8203]), 'topk_tokens': ['Question', '.\n\n', ' left', ':', ' where', '\n\n', ' Mary', '.', ' milk', ' the', ' milk', ' left', ' bathroom', '\n', '.', ' milk', '.', '<|eot_id|>', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [567.7, 661.625, 215.22916666666666, 1163.625, 235.15625]}, 'weight': {'score': [23.23267663043478, 23.280859850791717, 22.21673387096774, 23.285040346064246, 29.375], 'topk_indices': array([3255, 3282, 3175, 3127, 7399, 7437, 1479, 1417, 4252, 4268, 5173,
       5112, 7115, 7171, 3464, 3438, 4937, 4889, 4966, 4914]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.646875, 26.283203125, 20.052083333333332, 26.134765625, 26.533203125]}, 'saliency': {'score': [3.282884680706522, 0.23141209629072776, 1.0310806766633065, 0.21976746713021855, 0.27217905144942434], 'topk_indices': array([8116, 2976, 8096,  269, 5667, 8186, 8189,    0,  823, 8190, 8194,
       5630, 5629, 8180, 5663, 2978, 5664, 8192, 5666,  826]), 'topk_tokens': [' left', ' got', ' location', 'hue', '.', ' prior', ' place', '<|begin_of_text|>', ' moved', ' where', ' discarded', ' left', 'stage', 'Question', ' Mary', ' milk', ' left', ' milk', ' milk', ' bathroom'], 'evidence_proportions': [2.8333984375, 4.38232421875, 1.16943359375, 7.66748046875, 1.5308837890625]}}, 'pred_res': 'the bathroom<|eot_id|>', 'score': 100}
2025-01-22 04:08:37.919 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:08:37.920 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-15_pid-4_1-3-6-7-9.pkl | len: 3 |  size: 2.05 KB
Processing depth (1, 3, 6, 7, 9):   5%|▌         | 5/100 [01:42<32:18, 20.40s/it]Processing depth (1, 3, 6, 7, 9):   5%|▌         | 5/100 [01:42<32:24, 20.46s/it]
2025-01-22 04:08:37.988 | INFO     | __main__:<module>:82 - Selected idx: 16
2025-01-22 04:08:37.988 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the apple before the garden? 
2025-01-22 04:08:37.989 | INFO     | __main__:<module>:84 - Answer: hallway
2025-01-22 04:08:37.989 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 04:08:37.989 | INFO     | __main__:<module>:86 - Needle: [' John went back to the office.', ' John journeyed to the bedroom.', ' Daniel grabbed the apple.', ' John moved to the garden.', ' Sandra journeyed to the office.', ' Sandra moved to the kitchen.', ' Sandra went back to the hallway.', ' Daniel travelled to the hallway.', ' Daniel went back to the garden.', ' Mary travelled to the bedroom.']
2025-01-22 04:08:37.989 | INFO     | __main__:<module>:87 - Real Needle: [' Daniel grabbed the apple.', ' Daniel travelled to the hallway.', ' Daniel went back to the garden.', ' Mary travelled to the bedroom.']
2025-01-22 04:08:37.989 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['🖕🏻', '🧔\u200d♀️', '🔈', '🚴\u200d♂️', '🧔🏾\u200d♀️', '🇻🇬', '👨🏼', '👩\u200d👧\u200d👧', '🇲🇿', '👩🏽\u200d❤️\u200d👨🏽']
emoji:
O: 🖕🏻 [9468, 244, 243, 9468, 237, 119]
N: 🧔‍♀️ [9468, 100, 242, 102470, 32990, 31643]

O: 🧔‍♀️ [9468, 100, 242, 102470, 32990, 31643]
N: 🇲🇿 [9468, 229, 110, 9468, 229, 123]

O: 🔈 [9468, 242, 230]
N: 🖕🏻 [9468, 244, 243, 9468, 237, 119]

O: 🚴‍♂️ [9468, 248, 112, 102470, 17245, 224, 31643]
N: 🧔🏾‍♀️ [9468, 100, 242, 9468, 237, 122, 102470, 32990, 31643]

O: 🧔🏾‍♀️ [9468, 100, 242, 9468, 237, 122, 102470, 32990, 31643]
N: 🔈 [9468, 242, 230]

O: 🇻🇬 [9468, 229, 119, 9468, 229, 105]
N: 👩‍👧‍👧 [9468, 239, 102, 102470, 9468, 239, 100, 102470, 9468, 239, 100]

O: 👨🏼 [9468, 239, 101, 9468, 237, 120]
N: 🇻🇬 [9468, 229, 119, 9468, 229, 105]

O: 👩‍👧‍👧 [9468, 239, 102, 102470, 9468, 239, 100, 102470, 9468, 239, 100]
N: 🚴‍♂️ [9468, 248, 112, 102470, 17245, 224, 31643]

O: 🇲🇿 [9468, 229, 110, 9468, 229, 123]
N: 👨🏼 [9468, 239, 101, 9468, 237, 120]

O: 👩🏽‍❤️‍👨🏽 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 121]
N: 👩🏽‍❤️‍👨🏽 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 121]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.36s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.66s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.13s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.68s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.30s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (2, 3, 5, 6):   0%|          | 0/100 [00:14<?, ?it/s]2025-01-22 04:08:52.947 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel grabbed the apple.
2025-01-22 04:08:52.956 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1868, 1872) -->  Daniel grabbed the apple
2025-01-22 04:08:52.956 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel travelled to the hallway.
2025-01-22 04:08:52.970 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2940, 2945) --> . Daniel travelled to the
2025-01-22 04:08:52.970 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the garden.
2025-01-22 04:08:52.995 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4190, 4196) --> . Daniel went back to the
2025-01-22 04:08:52.996 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary travelled to the bedroom.
2025-01-22 04:08:53.019 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4679, 4684) --> . Mary travelled to the
2025-01-22 04:08:53.019 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the office.
2025-01-22 04:08:53.037 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3708, 3714) -->  John went back to the office
2025-01-22 04:08:53.037 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bedroom.
2025-01-22 04:08:53.058 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3344, 3350) --> . John journeyed to the
2025-01-22 04:08:53.058 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the garden.
2025-01-22 04:08:53.076 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3649, 3654) --> . John moved to the
2025-01-22 04:08:53.076 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra journeyed to the office.
2025-01-22 04:08:53.083 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1390, 1396) --> . Sandra journeyed to the
2025-01-22 04:08:53.083 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra moved to the kitchen.
2025-01-22 04:08:53.088 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1046, 1051) --> . Sandra moved to the
2025-01-22 04:08:53.088 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra went back to the hallway.
2025-01-22 04:08:53.093 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (895, 901) --> . Sandra went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:08:58.045 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's hand.<|eot_id|>
2025-01-22 04:08:58.045 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8187])
2025-01-22 04:09:01.115 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [267.990625, 32.37912851037851, 186.81801470588235, 31.154552298426744, 19.111410651408452], 'topk_indices': array([8075,   14, 1875, 8085, 1876, 6169, 6171, 8041, 8169, 8172, 2945,
       8176, 8170, 8174, 8178, 8177, 8182, 8175,    0, 8183]), 'topk_tokens': ['.\n\n', '\n', ' *', ' location', '      ', '      ', '      ', ' context', 'Question', ' was', ' hallway', ' the', ':', ' apple', '?', ' garden', '<|eot_id|>', ' before', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [540.4375, 434.8, 141.5, 35.0125]}, 'weight': {'score': [22.388671875, 23.28552731990232, 21.031939338235293, 23.297149628195672, 29.882042253521128], 'topk_indices': array([3300, 3327, 3172, 3220, 7468, 7430, 1419, 1481, 4362, 4378, 5244,
       5183, 7151, 7207, 3516, 3542, 4985, 5037, 5008, 4960]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.333984375, 21.01875, 20.927083333333332, 20.75625]}, 'saliency': {'score': [1.643035888671875, 0.17940830328525642, 0.9915412454044118, 0.17241652947259864, 0.14513751822458187], 'topk_indices': array([1869,  896, 6170, 1871, 8172, 8171, 1875, 1876, 6169, 6171, 1868,
       8085,  901, 8041, 8178, 8169, 8174, 2945, 8175, 8177]), 'topk_tokens': [' grabbed', ' Sandra', ' *', ' apple', ' was', ' Where', ' *', '      ', '      ', '      ', ' Daniel', ' location', ' hallway', ' context', '?', 'Question', ' apple', ' hallway', ' before', ' garden'], 'evidence_proportions': [4.0714111328125, 2.284765625, 0.6896158854166666, 0.2027099609375]}}, 'pred_res': "Daniel's hand.<|eot_id|>", 'score': 0}
2025-01-22 04:09:01.124 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:09:01.124 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-16_pid-0_2-3-5-6.pkl | len: 3 |  size: 2.02 KB
Processing depth (2, 3, 5, 6):   1%|          | 1/100 [00:23<38:00, 23.04s/it]is_0k: False
your chose emoji: ['💕', '🏙️', '👨🏽\u200d🔧', '🚶🏻\u200d♂\u200d➡️', '👷🏿', '🦻🏻', '🤷🏻\u200d♂️', '✍🏼', '⛹️\u200d♀️', '🙎🏿\u200d♀']
emoji:
O: 💕 [93273, 243]
N: 🦻🏻 [9468, 99, 119, 9468, 237, 119]

O: 🏙️ [9468, 237, 247, 31643]
N: 👷🏿 [9468, 239, 115, 9468, 237, 123]

O: 👨🏽‍🔧 [9468, 239, 101, 9468, 237, 121, 102470, 9468, 242, 100]
N: 🤷🏻‍♂️ [9468, 97, 115, 9468, 237, 119, 102470, 17245, 224, 31643]

O: 🚶🏻‍♂‍➡️ [9468, 248, 114, 9468, 237, 119, 102470, 17245, 224, 102470, 98115, 94, 31643]
N: 🚶🏻‍♂‍➡️ [9468, 248, 114, 9468, 237, 119, 102470, 17245, 224, 102470, 98115, 94, 31643]

O: 👷🏿 [9468, 239, 115, 9468, 237, 123]
N: 👨🏽‍🔧 [9468, 239, 101, 9468, 237, 121, 102470, 9468, 242, 100]

O: 🦻🏻 [9468, 99, 119, 9468, 237, 119]
N: ✍🏼 [38798, 235, 9468, 237, 120]

O: 🤷🏻‍♂️ [9468, 97, 115, 9468, 237, 119, 102470, 17245, 224, 31643]
N: 💕 [93273, 243]

O: ✍🏼 [38798, 235, 9468, 237, 120]
N: 🏙️ [9468, 237, 247, 31643]

O: ⛹️‍♀️ [158, 249, 117, 31643, 102470, 32990, 31643]
N: ⛹️‍♀️ [158, 249, 117, 31643, 102470, 32990, 31643]

O: 🙎🏿‍♀ [9468, 247, 236, 9468, 237, 123, 102470, 32990]
N: 🙎🏿‍♀ [9468, 247, 236, 9468, 237, 123, 102470, 32990]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.71s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.81s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.44s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.04s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.62s/it]
Processing depth (2, 6, 8, 9):   1%|          | 1/100 [00:39<38:00, 23.04s/it]2025-01-22 04:09:17.300 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel grabbed the apple.
2025-01-22 04:09:17.308 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1797, 1801) -->  grabbed the apple.
2025-01-22 04:09:17.309 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel travelled to the hallway.
2025-01-22 04:09:17.331 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4731, 4736) -->  Daniel travelled to the hallway
2025-01-22 04:09:17.332 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the garden.
2025-01-22 04:09:17.368 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6528, 6534) --> . Daniel went back to the
2025-01-22 04:09:17.369 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary travelled to the bedroom.
2025-01-22 04:09:17.403 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7118, 7123) -->  Mary travelled to the bedroom
2025-01-22 04:09:17.403 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the office.
2025-01-22 04:09:17.424 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3753, 3759) --> . John went back to the
2025-01-22 04:09:17.424 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bedroom.
2025-01-22 04:09:17.442 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3312, 3318) --> . John journeyed to the
2025-01-22 04:09:17.442 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the garden.
2025-01-22 04:09:17.461 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3597, 3602) --> . John moved to the
2025-01-22 04:09:17.461 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra journeyed to the office.
2025-01-22 04:09:17.470 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1390, 1396) --> . Sandra journeyed to the
2025-01-22 04:09:17.470 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra moved to the kitchen.
2025-01-22 04:09:17.476 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1046, 1051) --> . Sandra moved to the
2025-01-22 04:09:17.476 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra went back to the hallway.
2025-01-22 04:09:17.482 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (895, 901) --> . Sandra went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:09:18.266 | INFO     | test_jbb_embedding:begin_test:693 - The hallway.<|eot_id|>
2025-01-22 04:09:18.266 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8167])
2025-01-22 04:09:20.482 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [171.54609375, 22.36200275397797, 109.4986213235294, 21.629335571710204, 37.90061475409836], 'topk_indices': array([1799,  901, 8152,    1,   24, 1790, 8021, 8150, 8154, 1792, 8055,
       8065, 8158, 8165, 8157,   14, 8155,    0, 8162, 8163]), 'topk_tokens': [' apple', ' hallway', ' was', '<|start_header_id|>', '\n\n', '�', ' context', ':', ' apple', '�', '.\n\n', ' location', '?', '<|end_header_id|>', ' garden', '\n', ' before', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [437.40625, 148.2375, 127.5625, 34.946875]}, 'weight': {'score': [24.046875, 23.262270501835985, 20.441636029411764, 23.27215338528832, 29.405993852459016], 'topk_indices': array([3268, 3295, 3140, 3188, 7408, 7446, 1481, 1419, 4273, 4289, 5146,
       5207, 7185, 7129, 3490, 3464, 5000, 4948, 4971, 4923]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.22265625, 27.1140625, 20.927083333333332, 26.1828125]}, 'saliency': {'score': [1.03597412109375, 0.12377677179754437, 0.6012465533088235, 0.11952862991024674, 0.27039549780673666], 'topk_indices': array([   8, 8152, 1791, 8160, 8151, 8136, 8055, 8158, 1792, 1797, 8149,
       1796, 1799, 8021, 8065, 8154, 1790,  901, 8157, 8155]), 'topk_tokens': [' Date', ' was', '�', 'Answer', ' Where', ' return', '.\n\n', '?', '�', ' grabbed', 'Question', ' Daniel', ' apple', ' context', ' location', ' apple', '�', ' hallway', ' garden', ' before'], 'evidence_proportions': [2.5560302734375, 1.1298828125, 0.6088460286458334, 0.23857421875]}}, 'pred_res': 'The hallway.<|eot_id|>', 'score': 100}
2025-01-22 04:09:20.489 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:09:20.489 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-16_pid-1_2-6-8-9.pkl | len: 3 |  size: 2.03 KB
Processing depth (2, 6, 8, 9):   2%|▏         | 2/100 [00:42<34:06, 20.88s/it]is_0k: False
your chose emoji: ['🏝', '👩\u200d❤️\u200d👨', '🇹🇹', '👭🏾', '👨🏽\u200d❤️\u200d👨🏽', '🩹', '🦷', '🩺', '😳', '👩🏾\u200d💼']
emoji:
O: 🏝 [9468, 237, 251]
N: 🏝 [9468, 237, 251]

O: 👩‍❤️‍👨 [9468, 239, 102, 102470, 121643, 31643, 102470, 9468, 239, 101]
N: 🩺 [9468, 102, 118]

O: 🇹🇹 [9468, 229, 117, 9468, 229, 117]
N: 🦷 [9468, 99, 115]

O: 👭🏾 [9468, 239, 255, 9468, 237, 122]
N: 🩹 [9468, 102, 117]

O: 👨🏽‍❤️‍👨🏽 [9468, 239, 101, 9468, 237, 121, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 121]
N: 👨🏽‍❤️‍👨🏽 [9468, 239, 101, 9468, 237, 121, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 121]

O: 🩹 [9468, 102, 117]
N: 🇹🇹 [9468, 229, 117, 9468, 229, 117]

O: 🦷 [9468, 99, 115]
N: 👭🏾 [9468, 239, 255, 9468, 237, 122]

O: 🩺 [9468, 102, 118]
N: 👩‍❤️‍👨 [9468, 239, 102, 102470, 121643, 31643, 102470, 9468, 239, 101]

O: 😳 [76460, 111]
N: 😳 [76460, 111]

O: 👩🏾‍💼 [9468, 239, 102, 9468, 237, 122, 102470, 93273, 120]
N: 👩🏾‍💼 [9468, 239, 102, 9468, 237, 122, 102470, 93273, 120]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.51s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.81s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.48s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.10s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.65s/it]
Processing depth (0, 1, 5, 6):   2%|▏         | 2/100 [00:58<34:06, 20.88s/it]2025-01-22 04:09:36.792 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel grabbed the apple.
2025-01-22 04:09:36.833 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel travelled to the hallway.
2025-01-22 04:09:36.837 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (900, 905) --> . Daniel travelled to the
2025-01-22 04:09:36.837 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the garden.
2025-01-22 04:09:36.859 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4271, 4277) -->  Daniel went back to the garden
2025-01-22 04:09:36.859 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary travelled to the bedroom.
2025-01-22 04:09:36.887 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4821, 4826) -->  the senate. Mary travelled
2025-01-22 04:09:36.887 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the office.
2025-01-22 04:09:36.906 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3821, 3827) --> . John went back to the
2025-01-22 04:09:36.906 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bedroom.
2025-01-22 04:09:36.923 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3350, 3356) --> . John journeyed to the
2025-01-22 04:09:36.923 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the garden.
2025-01-22 04:09:36.941 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3665, 3670) --> . John moved to the
2025-01-22 04:09:36.941 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra journeyed to the office.
2025-01-22 04:09:36.949 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1401, 1407) --> . Sandra journeyed to the
2025-01-22 04:09:36.949 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra moved to the kitchen.
2025-01-22 04:09:36.956 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1057, 1062) --> . Sandra moved to the
2025-01-22 04:09:36.956 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra went back to the hallway.
2025-01-22 04:09:36.961 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (903, 909) -->  to the hallway. Sandra went
2025-01-22 04:09:36.962 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 04:09:36.964 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 04:09:36.971 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 04:09:36.971 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['🏃🏻\u200d➡', '🐸', '🧑🏾\u200d🦽', '👨🏽\u200d❤\u200d💋\u200d👨🏻', '🍬', '🩰', '💆', '🚶🏻\u200d♀️\u200d➡️', '👷', '👱🏼\u200d♀']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:05<00:17,  5.70s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:10<00:10,  5.42s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:15<00:05,  5.06s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:16<00:00,  3.50s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:16<00:00,  4.17s/it]
Processing depth (1, 4, 5, 8):   2%|▏         | 2/100 [01:17<34:06, 20.88s/it]2025-01-22 04:09:55.318 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel grabbed the apple.
2025-01-22 04:09:55.322 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (668, 672) -->  Daniel grabbed the apple
2025-01-22 04:09:55.322 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel travelled to the hallway.
2025-01-22 04:09:55.345 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3595, 3600) --> . Daniel travelled to the
2025-01-22 04:09:55.346 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the garden.
2025-01-22 04:09:55.368 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4172, 4178) --> . Daniel went back to the
2025-01-22 04:09:55.368 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary travelled to the bedroom.
2025-01-22 04:09:55.403 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6587, 6592) --> . Mary travelled to the
2025-01-22 04:09:55.404 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the office.
2025-01-22 04:09:55.424 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3708, 3714) -->  Hon. John went back to
2025-01-22 04:09:55.424 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bedroom.
2025-01-22 04:09:55.442 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3264, 3270) --> . John journeyed to the
2025-01-22 04:09:55.443 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the garden.
2025-01-22 04:09:55.464 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3599, 3604) -->  the hallway. John moved
2025-01-22 04:09:55.464 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra journeyed to the office.
2025-01-22 04:09:55.470 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1051, 1057) --> . Sandra journeyed to the
2025-01-22 04:09:55.470 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra moved to the kitchen.
2025-01-22 04:09:55.474 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (826, 831) -->  Sandra moved to the kitchen
2025-01-22 04:09:55.474 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra went back to the hallway.
2025-01-22 04:09:55.478 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (671, 677) -->  apple. Sandra went back to
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:09:56.317 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's house.<|eot_id|>
2025-01-22 04:09:56.317 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8213])
2025-01-22 04:09:58.563 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [263.871875, 33.18290911027264, 205.53676470588235, 31.89966843298211, 26.082101004464285], 'topk_indices': array([ 669, 8207, 8194, 8101, 8195, 8198,  672,  671,  668, 8200, 8067,
       7692, 8203, 8204, 8111, 8196, 8201,    0, 8208, 8209]), 'topk_tokens': [' grabbed', ':', '.\n\n', '.\n\n', 'Question', ' was', '.', ' apple', ' Daniel', ' apple', ' context', 'nes', ' garden', '?', ' location', ':', ' before', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [835.1875, 159.8875, 148.38541666666666, 49.3875]}, 'weight': {'score': [22.388671875, 23.300726098466406, 23.255284926470587, 23.303150269541778, 29.604352678571427], 'topk_indices': array([3358, 3331, 3244, 3196, 7456, 7494, 1498, 1560, 4390, 4406, 5286,
       5225, 7177, 7233, 3540, 3514, 5002, 5079, 5050, 5027]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.333984375, 21.01875, 20.927083333333332, 20.75625]}, 'saliency': {'score': [1.790350341796875, 0.18374378237775377, 1.2156300264246322, 0.17550851363406642, 0.19638025192987352], 'topk_indices': array([8196, 8206, 8110, 7602, 8198, 7691,  299, 8197, 8204,  669,  678,
       8195,  671, 8067, 7692, 8200, 8111,  668, 8203, 8201]), 'topk_tokens': [':', 'Answer', ' first', 'nes', ' was', ' Min', 'hue', ' Where', '?', ' grabbed', ' hallway', 'Question', ' apple', ' context', 'nes', ' apple', ' location', ' Daniel', ' garden', ' before'], 'evidence_proportions': [6.317626953125, 0.9228515625, 0.759765625, 0.2727294921875]}}, 'pred_res': "Daniel's house.<|eot_id|>", 'score': 0}
2025-01-22 04:09:58.571 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:09:58.571 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-16_pid-2_1-4-5-8.pkl | len: 3 |  size: 2.0 KB
Processing depth (1, 4, 5, 8):   3%|▎         | 3/100 [01:20<46:27, 28.73s/it]is_0k: False
your chose emoji: ['✋', '🚶🏿\u200d➡️', '🥜', '🚶🏾\u200d♂\u200d➡', '🇩🇯', '👨🏿\u200d🦼\u200d➡', '👩🏿\u200d🦼\u200d➡️', '👨🏽\u200d🏭', '🧎\u200d♀️\u200d➡', '✊🏼']
emoji:
O: ✋ [38798, 233]
N: ✋ [38798, 233]

O: 🚶🏿‍➡️ [9468, 248, 114, 9468, 237, 123, 102470, 98115, 94, 31643]
N: 🚶🏿‍➡️ [9468, 248, 114, 9468, 237, 123, 102470, 98115, 94, 31643]

O: 🥜 [9468, 98, 250]
N: 🧎‍♀️‍➡ [9468, 100, 236, 102470, 32990, 31643, 102470, 98115, 94]

O: 🚶🏾‍♂‍➡ [9468, 248, 114, 9468, 237, 122, 102470, 17245, 224, 102470, 98115, 94]
N: 👨🏽‍🏭 [9468, 239, 101, 9468, 237, 121, 102470, 9468, 237, 255]

O: 🇩🇯 [9468, 229, 102, 9468, 229, 107]
N: 🇩🇯 [9468, 229, 102, 9468, 229, 107]

O: 👨🏿‍🦼‍➡ [9468, 239, 101, 9468, 237, 123, 102470, 9468, 99, 120, 102470, 98115, 94]
N: 👩🏿‍🦼‍➡️ [9468, 239, 102, 9468, 237, 123, 102470, 9468, 99, 120, 102470, 98115, 94, 31643]

O: 👩🏿‍🦼‍➡️ [9468, 239, 102, 9468, 237, 123, 102470, 9468, 99, 120, 102470, 98115, 94, 31643]
N: 👨🏿‍🦼‍➡ [9468, 239, 101, 9468, 237, 123, 102470, 9468, 99, 120, 102470, 98115, 94]

O: 👨🏽‍🏭 [9468, 239, 101, 9468, 237, 121, 102470, 9468, 237, 255]
N: 🚶🏾‍♂‍➡ [9468, 248, 114, 9468, 237, 122, 102470, 17245, 224, 102470, 98115, 94]

O: 🧎‍♀️‍➡ [9468, 100, 236, 102470, 32990, 31643, 102470, 98115, 94]
N: 🥜 [9468, 98, 250]

O: ✊🏼 [38798, 232, 9468, 237, 120]
N: ✊🏼 [38798, 232, 9468, 237, 120]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.55s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.46s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.14s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.85s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.39s/it]
Processing depth (0, 1, 3, 4):   3%|▎         | 3/100 [01:35<46:27, 28.73s/it]2025-01-22 04:10:13.934 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel grabbed the apple.
2025-01-22 04:10:13.973 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel travelled to the hallway.
2025-01-22 04:10:13.977 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (900, 905) --> . Daniel travelled to the
2025-01-22 04:10:13.977 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the garden.
2025-01-22 04:10:13.992 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2942, 2948) --> . Daniel went back to the
2025-01-22 04:10:13.992 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary travelled to the bedroom.
2025-01-22 04:10:14.010 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3632, 3637) --> . Mary travelled to the
2025-01-22 04:10:14.010 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the office.
2025-01-22 04:10:14.028 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3711, 3717) -->  John went back to the office
2025-01-22 04:10:14.028 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bedroom.
2025-01-22 04:10:14.045 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3347, 3353) --> . John journeyed to the
2025-01-22 04:10:14.045 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the garden.
2025-01-22 04:10:14.063 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3636, 3641) -->  the bedroom. John moved
2025-01-22 04:10:14.063 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra journeyed to the office.
2025-01-22 04:10:14.070 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1401, 1407) --> . Sandra journeyed to the
2025-01-22 04:10:14.070 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra moved to the kitchen.
2025-01-22 04:10:14.075 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1057, 1062) --> . Sandra moved to the
2025-01-22 04:10:14.075 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra went back to the hallway.
2025-01-22 04:10:14.080 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (903, 909) -->  to the hallway. Sandra went
2025-01-22 04:10:14.080 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 04:10:14.080 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 04:10:14.080 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 04:10:14.080 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['👩\u200d👩\u200d👧\u200d👦', '🛬', '💁🏾\u200d♀', '🔮', '🧑🏿\u200d🦼', '🧑🏾\u200d❤️\u200d💋\u200d🧑🏻', '\U0001fae5', '👨🏿\u200d🔬', '🧊', '🖕🏻']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.99s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.86s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.74s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.28s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.85s/it]
Processing depth (3, 5, 7, 8):   3%|▎         | 3/100 [01:53<46:27, 28.73s/it]2025-01-22 04:10:31.473 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel grabbed the apple.
2025-01-22 04:10:31.489 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2932, 2936) -->  Daniel grabbed the apple
2025-01-22 04:10:31.489 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel travelled to the hallway.
2025-01-22 04:10:31.510 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4166, 4171) --> . Daniel travelled to the
2025-01-22 04:10:31.510 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the garden.
2025-01-22 04:10:31.540 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5654, 5660) --> . Daniel went back to the
2025-01-22 04:10:31.540 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary travelled to the bedroom.
2025-01-22 04:10:31.576 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6637, 6642) --> . Mary travelled to the
2025-01-22 04:10:31.576 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the office.
2025-01-22 04:10:31.597 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3771, 3777) --> . John went back to the
2025-01-22 04:10:31.597 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bedroom.
2025-01-22 04:10:31.621 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3436, 3442) --> . John journeyed to the
2025-01-22 04:10:31.621 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the garden.
2025-01-22 04:10:31.639 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3618, 3623) -->  Hon. John moved to
2025-01-22 04:10:31.639 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra journeyed to the office.
2025-01-22 04:10:31.646 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1390, 1396) --> . Sandra journeyed to the
2025-01-22 04:10:31.646 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra moved to the kitchen.
2025-01-22 04:10:31.651 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1046, 1051) --> . Sandra moved to the
2025-01-22 04:10:31.651 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra went back to the hallway.
2025-01-22 04:10:31.655 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (895, 901) --> . Sandra went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:10:32.452 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's hand<|eot_id|>
2025-01-22 04:10:32.452 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8161])
2025-01-22 04:10:34.690 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [407.8640625, 48.57703025477707, 255.72794117647058, 46.82254546855734, 29.710061961206897], 'topk_indices': array([7528, 7527, 8147,  901, 7483, 8145, 8143, 8144, 8015, 2935, 8150,
       2936, 8146, 8152, 8148, 8151, 8149,    0, 8156, 8157]), 'topk_tokens': ['nes', ' Min', ' the', ' hallway', 'nes', ' Where', 'Question', ':', ' context', ' apple', ' the', '.', ' was', '?', ' apple', ' garden', ' before', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [1145.625, 253.5, 328.5, 67.25625]}, 'weight': {'score': [22.388671875, 23.26465274375306, 21.148667279411764, 23.275683954993834, 29.89143318965517], 'topk_indices': array([3270, 3297, 3142, 3190, 7382, 7420, 1419, 1481, 4325, 4309, 5138,
       5199, 7097, 7153, 3464, 3490, 4974, 4945, 4897, 4922]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.333984375, 21.01875, 20.927083333333332, 20.75625]}, 'saliency': {'score': [2.69481201171875, 0.2704247676058764, 1.4321217256433822, 0.2595757612611745, 0.2290820417733028], 'topk_indices': array([8014, 8142, 8154,  896, 8059, 7528, 2933, 2932, 7527, 8146, 7483,
       8145, 8152, 8015, 8143,  901, 2935, 8148, 8149, 8151]), 'topk_tokens': [' you', '.\n\n', 'Answer', ' Sandra', ' location', 'nes', ' grabbed', ' Daniel', ' Min', ' was', 'nes', ' Where', '?', ' context', 'Question', ' hallway', ' apple', ' apple', ' before', ' garden'], 'evidence_proportions': [8.53955078125, 1.48603515625, 1.7265625, 0.389697265625]}}, 'pred_res': "Daniel's hand<|eot_id|>", 'score': 0}
2025-01-22 04:10:34.696 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:10:34.696 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-16_pid-3_3-5-7-8.pkl | len: 3 |  size: 2.0 KB
Processing depth (3, 5, 7, 8):   4%|▍         | 4/100 [01:56<50:38, 31.65s/it]is_0k: False
your chose emoji: ['👰🏾\u200d♀️', '🧍🏼\u200d♀️', '👪', '🤏🏽', '⛴️', '❗', '🐐', '🚵🏼\u200d♂️', '🙏🏾', '🏋️\u200d♀']
emoji:
O: 👰🏾‍♀️ [9468, 239, 108, 9468, 237, 122, 102470, 32990, 31643]
N: ⛴️ [158, 249, 112, 31643]

O: 🧍🏼‍♀️ [9468, 100, 235, 9468, 237, 120, 102470, 32990, 31643]
N: 🤏🏽 [9468, 97, 237, 9468, 237, 121]

O: 👪 [9468, 239, 103]
N: ❗ [49633, 245]

O: 🤏🏽 [9468, 97, 237, 9468, 237, 121]
N: 🧍🏼‍♀️ [9468, 100, 235, 9468, 237, 120, 102470, 32990, 31643]

O: ⛴️ [158, 249, 112, 31643]
N: 🙏🏾 [9468, 247, 237, 9468, 237, 122]

O: ❗ [49633, 245]
N: 👰🏾‍♀️ [9468, 239, 108, 9468, 237, 122, 102470, 32990, 31643]

O: 🐐 [9468, 238, 238]
N: 👪 [9468, 239, 103]

O: 🚵🏼‍♂️ [9468, 248, 113, 9468, 237, 120, 102470, 17245, 224, 31643]
N: 🚵🏼‍♂️ [9468, 248, 113, 9468, 237, 120, 102470, 17245, 224, 31643]

O: 🙏🏾 [9468, 247, 237, 9468, 237, 122]
N: 🐐 [9468, 238, 238]

O: 🏋️‍♀ [9468, 237, 233, 31643, 102470, 32990]
N: 🏋️‍♀ [9468, 237, 233, 31643, 102470, 32990]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.03s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.65s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.62s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.21s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.69s/it]
Processing depth (0, 1, 6, 7):   4%|▍         | 4/100 [02:13<50:38, 31.65s/it]2025-01-22 04:10:51.174 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel grabbed the apple.
2025-01-22 04:10:51.220 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel travelled to the hallway.
2025-01-22 04:10:51.224 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (826, 831) --> . Daniel travelled to the
2025-01-22 04:10:51.224 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the garden.
2025-01-22 04:10:51.250 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4734, 4740) --> . Daniel went back to the
2025-01-22 04:10:51.250 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary travelled to the bedroom.
2025-01-22 04:10:51.290 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5629, 5634) --> . Mary travelled to the
2025-01-22 04:10:51.291 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the office.
2025-01-22 04:10:51.309 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3686, 3692) -->  John went back to the office
2025-01-22 04:10:51.309 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bedroom.
2025-01-22 04:10:51.326 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3328, 3334) --> . John journeyed to the
2025-01-22 04:10:51.326 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the garden.
2025-01-22 04:10:51.345 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3613, 3618) --> . John moved to the
2025-01-22 04:10:51.345 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra journeyed to the office.
2025-01-22 04:10:51.353 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1295, 1301) --> . Sandra journeyed to the
2025-01-22 04:10:51.353 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra moved to the kitchen.
2025-01-22 04:10:51.359 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (989, 994) --> . Sandra moved to the
2025-01-22 04:10:51.359 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra went back to the hallway.
2025-01-22 04:10:51.363 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (829, 835) -->  to the hallway. Sandra went
2025-01-22 04:10:51.363 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 04:10:51.363 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 04:10:51.363 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 04:10:51.363 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['✉️', '🧑🏿\u200d✈️', '👋🏽', '👨\u200d👨\u200d👧', '🇵🇦', '🇱🇻', '🥀', '♋', '🤴🏾', '🇵🇾']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.44s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.24s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.25s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.96s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.45s/it]
Processing depth (2, 4, 6, 7):   4%|▍         | 4/100 [02:28<50:38, 31.65s/it]2025-01-22 04:11:07.006 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel grabbed the apple.
2025-01-22 04:11:07.020 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2020, 2024) -->  Daniel grabbed the apple
2025-01-22 04:11:07.021 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel travelled to the hallway.
2025-01-22 04:11:07.038 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3625, 3630) --> . Daniel travelled to the
2025-01-22 04:11:07.039 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the garden.
2025-01-22 04:11:07.062 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4758, 4764) --> . Daniel went back to the
2025-01-22 04:11:07.062 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary travelled to the bedroom.
2025-01-22 04:11:07.090 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5647, 5652) --> . Mary travelled to the
2025-01-22 04:11:07.090 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the office.
2025-01-22 04:11:07.109 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3787, 3793) --> . John went back to the
2025-01-22 04:11:07.109 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bedroom.
2025-01-22 04:11:07.125 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3324, 3330) --> . John journeyed to the
2025-01-22 04:11:07.125 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the garden.
2025-01-22 04:11:07.143 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3629, 3634) -->  the hallway. John moved
2025-01-22 04:11:07.143 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra journeyed to the office.
2025-01-22 04:11:07.150 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1390, 1396) --> . Sandra journeyed to the
2025-01-22 04:11:07.150 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra moved to the kitchen.
2025-01-22 04:11:07.155 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1046, 1051) --> . Sandra moved to the
2025-01-22 04:11:07.155 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra went back to the hallway.
2025-01-22 04:11:07.161 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (895, 901) --> . Sandra went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:11:08.017 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's hand.<|eot_id|>
2025-01-22 04:11:08.017 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8239])
2025-01-22 04:11:10.446 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [217.2984375, 27.455085234166464, 168.22886029411765, 26.406822484123108, 17.211984536082475], 'topk_indices': array([ 901, 8093, 2364, 8220, 8237, 2023, 8127, 2024, 8228, 8224,   14,
       8221, 8222, 8226, 8230, 8229, 8227,    0, 8234, 8235]), 'topk_tokens': [' hallway', ' context', 'nes', '.\n\n', '<|end_header_id|>', ' apple', '.\n\n', '.', ' the', ' was', '\n', 'Question', ':', ' apple', '?', ' garden', ' before', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [555.625, 200.4, 138.6875, 57.86875]}, 'weight': {'score': [22.388671875, 23.329637830623636, 21.215073529411764, 23.34071678828774, 29.98791881443299], 'topk_indices': array([3307, 3280, 3146, 3194, 7426, 7464, 1481, 1419, 4345, 4361, 5163,
       5224, 7147, 7203, 3518, 3492, 4988, 4940, 4965, 5017]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [28.333984375, 21.01875, 20.927083333333332, 20.75625]}, 'saliency': {'score': [1.397125244140625, 0.15148813219447646, 0.9902720731847426, 0.14496255864384236, 0.12826420105609698], 'topk_indices': array([8220, 8208, 8127, 3630, 2020, 2378, 8224,  896, 8137, 8223, 2021,
       8093, 2364, 8230, 2023,  901, 8221, 8226, 8227, 8229]), 'topk_tokens': ['.\n\n', ' return', '.\n\n', ' hallway', ' Daniel', 'nes', ' was', ' Sandra', ' location', ' Where', ' grabbed', ' context', 'nes', '?', ' apple', ' hallway', 'Question', ' apple', ' before', ' garden'], 'evidence_proportions': [4.143310546875, 1.122900390625, 0.6591796875, 0.3599365234375]}}, 'pred_res': "Daniel's hand.<|eot_id|>", 'score': 0}
2025-01-22 04:11:10.455 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:11:10.455 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-16_pid-4_2-4-6-7.pkl | len: 3 |  size: 2.02 KB
Processing depth (2, 4, 6, 7):   5%|▌         | 5/100 [02:32<52:27, 33.13s/it]Processing depth (2, 4, 6, 7):   5%|▌         | 5/100 [02:32<48:16, 30.49s/it]
2025-01-22 04:11:10.537 | INFO     | __main__:<module>:82 - Selected idx: 17
2025-01-22 04:11:10.537 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the location prior to the place where the apple was discarded, left or dropped?
2025-01-22 04:11:10.537 | INFO     | __main__:<module>:84 - Answer: hallway
2025-01-22 04:11:10.537 | INFO     | __main__:<module>:85 - Tag: 4-hop
2025-01-22 04:11:10.537 | INFO     | __main__:<module>:86 - Needle: [' John moved to the garden.', ' Sandra journeyed to the office.', ' Daniel travelled to the hallway.', ' Daniel grabbed the apple.', ' John went back to the office.', ' Sandra went back to the hallway.', ' Daniel went back to the garden.', ' Sandra moved to the kitchen.', ' John journeyed to the bedroom.', ' Daniel put down the apple.', ' Mary travelled to the bedroom.']
2025-01-22 04:11:10.537 | INFO     | __main__:<module>:87 - Real Needle: [' Daniel travelled to the hallway.', ' Daniel grabbed the apple.', ' Daniel went back to the garden.', ' Daniel put down the apple.', ' Mary travelled to the bedroom.']
2025-01-22 04:11:10.537 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['🎳', '🧟\u200d♀', '🐶', '🧑🏾\u200d❤️\u200d💋\u200d🧑🏻', '👩\u200d🦽\u200d➡️', '💂🏼\u200d♀️', '🧑🏽\u200d🦯\u200d➡️', '🤽🏼\u200d♀️', '💁🏼\u200d♀️', '👨🏿\u200d🤝\u200d👨🏻']
emoji:
O: 🎳 [9468, 236, 111]
N: 🤽🏼‍♀️ [9468, 97, 121, 9468, 237, 120, 102470, 32990, 31643]

O: 🧟‍♀ [9468, 100, 253, 102470, 32990]
N: 🎳 [9468, 236, 111]

O: 🐶 [9468, 238, 114]
N: 🐶 [9468, 238, 114]

O: 🧑🏾‍❤️‍💋‍🧑🏻 [9468, 100, 239, 9468, 237, 122, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 100, 239, 9468, 237, 119]
N: 👩‍🦽‍➡️ [9468, 239, 102, 102470, 9468, 99, 121, 102470, 98115, 94, 31643]

O: 👩‍🦽‍➡️ [9468, 239, 102, 102470, 9468, 99, 121, 102470, 98115, 94, 31643]
N: 🧑🏽‍🦯‍➡️ [9468, 100, 239, 9468, 237, 121, 102470, 9468, 99, 107, 102470, 98115, 94, 31643]

O: 💂🏼‍♀️ [93273, 224, 9468, 237, 120, 102470, 32990, 31643]
N: 🧟‍♀ [9468, 100, 253, 102470, 32990]

O: 🧑🏽‍🦯‍➡️ [9468, 100, 239, 9468, 237, 121, 102470, 9468, 99, 107, 102470, 98115, 94, 31643]
N: 💁🏼‍♀️ [93273, 223, 9468, 237, 120, 102470, 32990, 31643]

O: 🤽🏼‍♀️ [9468, 97, 121, 9468, 237, 120, 102470, 32990, 31643]
N: 💂🏼‍♀️ [93273, 224, 9468, 237, 120, 102470, 32990, 31643]

O: 💁🏼‍♀️ [93273, 223, 9468, 237, 120, 102470, 32990, 31643]
N: 🧑🏾‍❤️‍💋‍🧑🏻 [9468, 100, 239, 9468, 237, 122, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 100, 239, 9468, 237, 119]

O: 👨🏿‍🤝‍👨🏻 [9468, 239, 101, 9468, 237, 123, 102470, 9468, 97, 251, 102470, 9468, 239, 101, 9468, 237, 119]
N: 👨🏿‍🤝‍👨🏻 [9468, 239, 101, 9468, 237, 123, 102470, 9468, 97, 251, 102470, 9468, 239, 101, 9468, 237, 119]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.25s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.66s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.63s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.21s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.70s/it]
Processing depth (2, 3, 4, 6, 7):   0%|          | 0/100 [00:16<?, ?it/s]2025-01-22 04:11:27.334 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel travelled to the hallway.
2025-01-22 04:11:27.344 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1845, 1850) --> . Daniel travelled to the
2025-01-22 04:11:27.344 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel grabbed the apple.
2025-01-22 04:11:27.360 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2919, 2923) -->  Daniel grabbed the apple
2025-01-22 04:11:27.360 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the garden.
2025-01-22 04:11:27.378 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3626, 3632) --> . Daniel went back to the
2025-01-22 04:11:27.378 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel put down the apple.
2025-01-22 04:11:27.418 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4754, 4759) --> . Daniel put down the
2025-01-22 04:11:27.418 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary travelled to the bedroom.
2025-01-22 04:11:27.448 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5674, 5679) --> . Mary travelled to the
2025-01-22 04:11:27.448 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John moved to the garden.
2025-01-22 04:11:27.484 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6324, 6329) --> . John moved to the
2025-01-22 04:11:27.484 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra journeyed to the office.
2025-01-22 04:11:27.517 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6328, 6334) -->  the garden. Sandra journeyed
2025-01-22 04:11:27.518 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the office.
2025-01-22 04:11:27.537 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3594, 3600) -->  Hon. John went back to
2025-01-22 04:11:27.537 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the hallway.
2025-01-22 04:11:27.563 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4608, 4614) -->  Sandra went back to the hallway
2025-01-22 04:11:27.563 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra moved to the kitchen.
2025-01-22 04:11:27.600 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6327, 6332) -->  to the garden. Sandra
2025-01-22 04:11:27.600 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John journeyed to the bedroom.
2025-01-22 04:11:27.612 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (2111, 2117) --> . John journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:11:28.383 | INFO     | test_jbb_embedding:begin_test:693 - the hallway<|eot_id|>
2025-01-22 04:11:28.383 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8198])
2025-01-22 04:11:30.806 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [277.17125, 26.72983858675771, 137.72610294117646, 25.497351694915253, 16.441972373188406], 'topk_indices': array([2923, 2918, 8185, 1742, 8192, 4613,   24, 8077, 2920, 3632, 8196,
       1847, 2919, 1846, 2922, 2890, 1850,    0, 8193, 8194]), 'topk_tokens': ['.', '.', ' discarded', '.', ':', ' hallway', '\n\n', '.\n\n', ' grabbed', ' garden', '<|end_header_id|>', ' travelled', ' Daniel', ' Daniel', ' apple', '.', ' hallway', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [442.5, 496.6875, 218.16666666666666, 230.775, 53.43125]}, 'weight': {'score': [22.3178125, 23.278517863675162, 22.631433823529413, 23.284169852309017, 29.69836956521739], 'topk_indices': array([3284, 3257, 3129, 3177, 7468, 7430, 1461, 1399, 4330, 4314, 5158,
       5219, 7207, 7151, 3466, 3440, 4983, 5012, 4935, 4960]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.01875, 28.333984375, 20.927083333333332, 22.034375, 20.75625]}, 'saliency': {'score': [1.73419921875, 0.147919285400599, 0.8490851907169118, 0.14012063161596505, 0.12239317963088768], 'topk_indices': array([2917, 8077, 4608, 2654, 4759, 8191, 8171, 3477, 8183, 8177, 2889,
       8185, 3632, 2920, 4613, 2919, 1846, 2922, 1847, 1850]), 'topk_tokens': [' Gov', '.\n\n', ' Sandra', ' ne', ' apple', 'Answer', 'Question', ' Ramsey', ' apple', ' prior', ' Gov', ' discarded', ' garden', ' grabbed', ' hallway', ' Daniel', ' Daniel', ' apple', ' travelled', ' hallway'], 'evidence_proportions': [2.67109375, 3.7835693359375, 1.1080729166666667, 1.32392578125, 0.31943359375]}}, 'pred_res': 'the hallway<|eot_id|>', 'score': 100}
2025-01-22 04:11:30.822 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:11:30.828 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-17_pid-0_2-3-4-6-7.pkl | len: 3 |  size: 2.09 KB
Processing depth (2, 3, 4, 6, 7):   1%|          | 1/100 [00:20<33:20, 20.20s/it]is_0k: False
your chose emoji: ['💙', '💆🏽', '👮🏾\u200d♀', '🧑🏼\u200d❤️\u200d🧑🏿', '👨\u200d✈', '🔬', '🧝🏼\u200d♂️', '🤸🏼\u200d♂️', '👐', '🧑\u200d⚖']
emoji:
O: 💙 [93273, 247]
N: 💆🏽 [93273, 228, 9468, 237, 121]

O: 💆🏽 [93273, 228, 9468, 237, 121]
N: 💙 [93273, 247]

O: 👮🏾‍♀ [9468, 239, 106, 9468, 237, 122, 102470, 32990]
N: 🧑🏼‍❤️‍🧑🏿 [9468, 100, 239, 9468, 237, 120, 102470, 121643, 31643, 102470, 9468, 100, 239, 9468, 237, 123]

O: 🧑🏼‍❤️‍🧑🏿 [9468, 100, 239, 9468, 237, 120, 102470, 121643, 31643, 102470, 9468, 100, 239, 9468, 237, 123]
N: 👨‍✈ [9468, 239, 101, 102470, 38798, 230]

O: 👨‍✈ [9468, 239, 101, 102470, 38798, 230]
N: 🧝🏼‍♂️ [9468, 100, 251, 9468, 237, 120, 102470, 17245, 224, 31643]

O: 🔬 [9468, 242, 105]
N: 🤸🏼‍♂️ [9468, 97, 116, 9468, 237, 120, 102470, 17245, 224, 31643]

O: 🧝🏼‍♂️ [9468, 100, 251, 9468, 237, 120, 102470, 17245, 224, 31643]
N: 🔬 [9468, 242, 105]

O: 🤸🏼‍♂️ [9468, 97, 116, 9468, 237, 120, 102470, 17245, 224, 31643]
N: 👮🏾‍♀ [9468, 239, 106, 9468, 237, 122, 102470, 32990]

O: 👐 [9468, 80010]
N: 👐 [9468, 80010]

O: 🧑‍⚖ [9468, 100, 239, 102470, 158, 248, 244]
N: 🧑‍⚖ [9468, 100, 239, 102470, 158, 248, 244]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.59s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.54s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.48s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.10s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.62s/it]
Processing depth (0, 3, 5, 7, 8):   1%|          | 1/100 [00:36<33:20, 20.20s/it]2025-01-22 04:11:47.073 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel travelled to the hallway.
2025-01-22 04:11:47.073 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  travelled to the hallway.
2025-01-22 04:11:47.074 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel grabbed the apple.
2025-01-22 04:11:47.088 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2742, 2746) -->  grabbed the apple.
2025-01-22 04:11:47.088 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the garden.
2025-01-22 04:11:47.109 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4160, 4166) --> . Daniel went back to the
2025-01-22 04:11:47.109 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel put down the apple.
2025-01-22 04:11:47.139 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5588, 5593) --> . Daniel put down the
2025-01-22 04:11:47.139 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary travelled to the bedroom.
2025-01-22 04:11:47.173 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6551, 6556) --> . Mary travelled to the
2025-01-22 04:11:47.174 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John moved to the garden.
2025-01-22 04:11:47.204 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6262, 6267) --> . John moved to the
2025-01-22 04:11:47.204 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra journeyed to the office.
2025-01-22 04:11:47.240 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6266, 6272) -->  the garden. Sandra journeyed
2025-01-22 04:11:47.241 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the office.
2025-01-22 04:11:47.258 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3529, 3535) --> . John went back to the
2025-01-22 04:11:47.258 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the hallway.
2025-01-22 04:11:47.281 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4588, 4594) -->  Sandra went back to the hallway
2025-01-22 04:11:47.282 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra moved to the kitchen.
2025-01-22 04:11:47.321 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6265, 6270) -->  to the garden. Sandra
2025-01-22 04:11:47.322 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John journeyed to the bedroom.
2025-01-22 04:11:47.332 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (1885, 1891) --> . John journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:11:48.141 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's hand.<|eot_id|>
2025-01-22 04:11:48.141 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8188])
2025-01-22 04:11:50.373 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [418.80875, 42.17625289952387, 206.7316176470588, 40.330373063207084, 35.85394287109375], 'topk_indices': array([5593, 3349, 8167, 8173, 8162, 2745, 8067, 7046, 8168, 7072, 4593,
         24,   14, 8175, 4286, 8183,   25,   34, 8184,    0]), 'topk_tokens': [' apple', ' a', ' prior', ' apple', ':', '.', '.\n\n', ' be', ' to', ' to', ' hallway', '\n\n', '\n', ' discarded', 'nes', '<|eot_id|>', '<|eot_id|>', ' hallway', '<|start_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [676.65, 575.8125, 241.39583333333334, 579.15, 87.91875]}, 'weight': {'score': [21.58125, 23.26665700158711, 21.924402573529413, 23.27745038889572, 29.427734375], 'topk_indices': array([3338, 3311, 3183, 3231, 7464, 7426, 1499, 1437, 4322, 4338, 5170,
       5231, 7147, 7203, 3494, 3520, 4935, 5012, 4983, 4960]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.225, 22.22265625, 20.927083333333332, 22.034375, 20.75625]}, 'saliency': {'score': [2.4222998046875, 0.2377196609893862, 1.2578986672794117, 0.22673828004911153, 0.2674551010131836], 'topk_indices': array([3348, 3327, 1891, 5591, 4588, 7572, 3321, 8077, 5589, 4166, 2744,
       8161, 5593, 8167, 8173,   31, 4286, 8175, 4593,   34]), 'topk_tokens': ['iring', ' enemy', ' bedroom', ' down', ' Sandra', 'nes', 'iring', ' location', ' Daniel', ' garden', ' apple', 'Question', ' apple', ' prior', ' apple', ' travelled', 'nes', ' discarded', ' hallway', ' hallway'], 'evidence_proportions': [4.1517578125, 3.265625, 1.2889811197916667, 3.3267578125, 0.4737060546875]}}, 'pred_res': "Daniel's hand.<|eot_id|>", 'score': 0}
2025-01-22 04:11:50.380 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:11:50.381 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-17_pid-1_0-3-5-7-8.pkl | len: 3 |  size: 2.08 KB
Processing depth (0, 3, 5, 7, 8):   2%|▏         | 2/100 [00:39<32:22, 19.82s/it]is_0k: False
your chose emoji: ['🧏🏻\u200d♀️', '🇸🇻', '🚴\u200d♂', '🤵🏾\u200d♀️', '🇳🇺', '👨🏽\u200d🔧', '🏖', '🙏🏽', '🧎\u200d♂', '🛒']
emoji:
O: 🧏🏻‍♀️ [9468, 100, 237, 9468, 237, 119, 102470, 32990, 31643]
N: 🇳🇺 [9468, 229, 111, 9468, 229, 118]

O: 🇸🇻 [9468, 229, 116, 9468, 229, 119]
N: 👨🏽‍🔧 [9468, 239, 101, 9468, 237, 121, 102470, 9468, 242, 100]

O: 🚴‍♂ [9468, 248, 112, 102470, 17245, 224]
N: 🇸🇻 [9468, 229, 116, 9468, 229, 119]

O: 🤵🏾‍♀️ [9468, 97, 113, 9468, 237, 122, 102470, 32990, 31643]
N: 🚴‍♂ [9468, 248, 112, 102470, 17245, 224]

O: 🇳🇺 [9468, 229, 111, 9468, 229, 118]
N: 🧎‍♂ [9468, 100, 236, 102470, 17245, 224]

O: 👨🏽‍🔧 [9468, 239, 101, 9468, 237, 121, 102470, 9468, 242, 100]
N: 🤵🏾‍♀️ [9468, 97, 113, 9468, 237, 122, 102470, 32990, 31643]

O: 🏖 [9468, 237, 244]
N: 🧏🏻‍♀️ [9468, 100, 237, 9468, 237, 119, 102470, 32990, 31643]

O: 🙏🏽 [9468, 247, 237, 9468, 237, 121]
N: 🙏🏽 [9468, 247, 237, 9468, 237, 121]

O: 🧎‍♂ [9468, 100, 236, 102470, 17245, 224]
N: 🏖 [9468, 237, 244]

O: 🛒 [9468, 249, 240]
N: 🛒 [9468, 249, 240]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.51s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.77s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.40s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.02s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.58s/it]
Processing depth (0, 2, 5, 7, 8):   2%|▏         | 2/100 [00:55<32:22, 19.82s/it]2025-01-22 04:12:06.442 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel travelled to the hallway.
2025-01-22 04:12:06.442 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  travelled to the hallway.
2025-01-22 04:12:06.442 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel grabbed the apple.
2025-01-22 04:12:06.451 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1756, 1760) -->  Daniel grabbed the apple
2025-01-22 04:12:06.451 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the garden.
2025-01-22 04:12:06.472 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4219, 4225) -->  Daniel went back to the garden
2025-01-22 04:12:06.472 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel put down the apple.
2025-01-22 04:12:06.500 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5668, 5673) --> . Daniel put down the
2025-01-22 04:12:06.500 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary travelled to the bedroom.
2025-01-22 04:12:06.533 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6679, 6684) --> . Mary travelled to the
2025-01-22 04:12:06.533 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John moved to the garden.
2025-01-22 04:12:06.564 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6360, 6365) --> . John moved to the
2025-01-22 04:12:06.564 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra journeyed to the office.
2025-01-22 04:12:06.596 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6364, 6370) -->  the garden. Sandra journeyed
2025-01-22 04:12:06.596 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the office.
2025-01-22 04:12:06.614 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3607, 3613) --> . John went back to the
2025-01-22 04:12:06.614 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the hallway.
2025-01-22 04:12:06.637 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4647, 4653) --> . Sandra went back to the
2025-01-22 04:12:06.637 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra moved to the kitchen.
2025-01-22 04:12:06.668 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6363, 6368) -->  to the garden. Sandra
2025-01-22 04:12:06.668 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John journeyed to the bedroom.
2025-01-22 04:12:06.677 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (1894, 1900) --> . John journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:12:07.514 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's hand.<|eot_id|>
2025-01-22 04:12:07.514 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8274])
2025-01-22 04:12:09.760 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [437.77375, 39.15316917361363, 158.51470588235293, 37.446694755414946, 31.010367990654206], 'topk_indices': array([8163,   14, 8253, 8247, 8248, 4653, 8257, 8153,   34, 8259,   25,
       5673, 8254, 8260, 8261, 1759, 1760, 8269,    0, 8270]), 'topk_tokens': [' location', '\n', ' prior', 'Question', ':', ' hallway', ' where', '.\n\n', ' hallway', ' apple', '<|eot_id|>', ' apple', ' to', ' was', ' discarded', ' apple', '.', '<|eot_id|>', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [618.4, 609.6875, 469.125, 426.95, 92.81875]}, 'weight': {'score': [23.461875, 23.33403180500181, 21.028033088235293, 23.343183408371868, 29.557681074766354], 'topk_indices': array([3318, 3291, 3163, 3211, 7476, 7514, 1515, 1453, 4334, 4350, 5166,
       5227, 7233, 7177, 3474, 3500, 5006, 4954, 4929, 4977]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.225, 28.333984375, 24.688802083333332, 22.034375, 20.75625]}, 'saliency': {'score': [2.772861328125, 0.22058459423987406, 0.8605562097886029, 0.2101725775355926, 0.23799090519129673], 'topk_indices': array([4278, 4235, 5671, 8249, 8256, 4232, 8260, 8163, 8257, 4224, 1757,
         31, 8253, 8247, 8259, 5673, 1759, 4653,   34, 8261]), 'topk_tokens': ['nes', 'outs', ' down', ' Where', ' place', 'ree', ' was', ' location', ' where', ' garden', ' grabbed', ' travelled', ' prior', 'Question', ' apple', ' apple', ' apple', ' hallway', ' hallway', ' discarded'], 'evidence_proportions': [3.810546875, 4.46923828125, 2.9143880208333335, 2.41669921875, 0.564404296875]}}, 'pred_res': "Daniel's hand.<|eot_id|>", 'score': 0}
2025-01-22 04:12:09.767 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:12:09.767 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-17_pid-2_0-2-5-7-8.pkl | len: 3 |  size: 2.09 KB
Processing depth (0, 2, 5, 7, 8):   3%|▎         | 3/100 [00:59<31:43, 19.62s/it]is_0k: False
your chose emoji: ['🧑🏿\u200d🎤', '👰🏻\u200d♀', '🤳🏻', '🇲🇵', '💇🏽\u200d♀', '👩🏻\u200d🤝\u200d👩🏾', '👩🏽\u200d❤️\u200d💋\u200d👩🏿', '🇧🇶', '🤸🏽\u200d♂️', '👨🏻\u200d❤\u200d💋\u200d👨🏾']
emoji:
O: 🧑🏿‍🎤 [9468, 100, 239, 9468, 237, 123, 102470, 9468, 236, 97]
N: 🤸🏽‍♂️ [9468, 97, 116, 9468, 237, 121, 102470, 17245, 224, 31643]

O: 👰🏻‍♀ [9468, 239, 108, 9468, 237, 119, 102470, 32990]
N: 👰🏻‍♀ [9468, 239, 108, 9468, 237, 119, 102470, 32990]

O: 🤳🏻 [9468, 97, 111, 9468, 237, 119]
N: 🇧🇶 [9468, 229, 100, 9468, 229, 114]

O: 🇲🇵 [9468, 229, 110, 9468, 229, 113]
N: 🇲🇵 [9468, 229, 110, 9468, 229, 113]

O: 💇🏽‍♀ [93273, 229, 9468, 237, 121, 102470, 32990]
N: 👩🏽‍❤️‍💋‍👩🏿 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 123]

O: 👩🏻‍🤝‍👩🏾 [9468, 239, 102, 9468, 237, 119, 102470, 9468, 97, 251, 102470, 9468, 239, 102, 9468, 237, 122]
N: 💇🏽‍♀ [93273, 229, 9468, 237, 121, 102470, 32990]

O: 👩🏽‍❤️‍💋‍👩🏿 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 123]
N: 👩🏻‍🤝‍👩🏾 [9468, 239, 102, 9468, 237, 119, 102470, 9468, 97, 251, 102470, 9468, 239, 102, 9468, 237, 122]

O: 🇧🇶 [9468, 229, 100, 9468, 229, 114]
N: 🧑🏿‍🎤 [9468, 100, 239, 9468, 237, 123, 102470, 9468, 236, 97]

O: 🤸🏽‍♂️ [9468, 97, 116, 9468, 237, 121, 102470, 17245, 224, 31643]
N: 🤳🏻 [9468, 97, 111, 9468, 237, 119]

O: 👨🏻‍❤‍💋‍👨🏾 [9468, 239, 101, 9468, 237, 119, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 122]
N: 👨🏻‍❤‍💋‍👨🏾 [9468, 239, 101, 9468, 237, 119, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 122]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.75s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.95s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.76s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.04s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.70s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 1, 3, 6, 7):   3%|▎         | 3/100 [01:15<31:43, 19.62s/it]2025-01-22 04:12:26.425 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel travelled to the hallway.
2025-01-22 04:12:26.425 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  travelled to the hallway.
2025-01-22 04:12:26.426 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel grabbed the apple.
2025-01-22 04:12:26.430 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (902, 906) -->  Daniel grabbed the apple
2025-01-22 04:12:26.430 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the garden.
2025-01-22 04:12:26.446 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2976, 2982) -->  tragedy. Daniel went back to
2025-01-22 04:12:26.446 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel put down the apple.
2025-01-22 04:12:26.472 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4723, 4728) -->  Daniel put down the apple
2025-01-22 04:12:26.473 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary travelled to the bedroom.
2025-01-22 04:12:26.504 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5642, 5647) --> . Mary travelled to the
2025-01-22 04:12:26.504 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John moved to the garden.
2025-01-22 04:12:26.540 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6304, 6309) --> . John moved to the
2025-01-22 04:12:26.540 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra journeyed to the office.
2025-01-22 04:12:26.572 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6308, 6314) -->  the garden. Sandra journeyed
2025-01-22 04:12:26.572 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the office.
2025-01-22 04:12:26.593 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3622, 3628) --> . John went back to the
2025-01-22 04:12:26.593 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the hallway.
2025-01-22 04:12:26.618 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4599, 4605) --> . Sandra went back to the
2025-01-22 04:12:26.618 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra moved to the kitchen.
2025-01-22 04:12:26.651 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6307, 6312) -->  to the garden. Sandra
2025-01-22 04:12:26.652 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John journeyed to the bedroom.
2025-01-22 04:12:26.662 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (2116, 2122) --> . John journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:12:29.812 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 04:12:29.813 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8202])
2025-01-22 04:12:32.670 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [262.443125, 19.487395262035346, 62.796875, 18.561000030689907, 13.997909330985916], 'topk_indices': array([  29, 8181, 8176,   32,   24, 8182,   28,   35, 8187, 8081,   31,
       8189, 2983,  905,   14,  906,   34,    0, 8197, 8198]), 'topk_tokens': ['\n\n', ' prior', ':', ' to', '\n\n', ' to', '<|end_header_id|>', '.', ' apple', '.\n\n', ' travelled', ' discarded', ' garden', ' apple', '\n', '.', ' hallway', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [488.0, 397.9375, 157.13802083333334, 262.55, 54.75]}, 'weight': {'score': [24.6421875, 23.2804654174284, 21.028033088235293, 23.285687569052296, 29.618177816901408], 'topk_indices': array([3287, 3260, 3180, 3132, 7466, 7428, 1420, 1482, 4290, 4274, 5187,
       5126, 7149, 7205, 3443, 3469, 4951, 4903, 4980, 4928]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.225, 28.333984375, 25.766927083333332, 26.6421875, 20.75625]}, 'saliency': {'score': [1.71505615234375, 0.10897499470359157, 0.34373922909007354, 0.10306608076912749, 0.10782548071632922], 'topk_indices': array([8047, 8175, 1219, 8185,   38,   39, 8081, 8091,  902, 4605, 4727,
         30, 8181,  903, 8187, 2983,   31,  905, 8189,   34]), 'topk_tokens': [' context', 'Question', 'nes', ' where', '***', '\n\n\n', '.\n\n', ' location', ' Daniel', ' hallway', ' apple', 'Daniel', ' prior', ' grabbed', ' apple', ' garden', ' travelled', ' apple', ' discarded', ' hallway'], 'evidence_proportions': [3.1021484375, 2.9019775390625, 0.90966796875, 1.72958984375, 0.33035888671875]}}, 'pred_res': 'The garden.<|eot_id|>', 'score': 0}
2025-01-22 04:12:32.674 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:12:32.674 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-17_pid-3_0-1-3-6-7.pkl | len: 3 |  size: 2.08 KB
Processing depth (0, 1, 3, 6, 7):   4%|▍         | 4/100 [01:22<33:28, 20.92s/it]is_0k: False
your chose emoji: ['🧑🏿\u200d🤝\u200d🧑🏾', '🧖🏿\u200d♂', '🟪', '🖱', '👩\u200d❤\u200d👨', '💁\u200d♂', '🙇\u200d♀', '🧍🏽\u200d♀', '🪐', '🏌🏻\u200d♀️']
emoji:
O: 🧑🏿‍🤝‍🧑🏾 [9468, 100, 239, 9468, 237, 123, 102470, 9468, 97, 251, 102470, 9468, 100, 239, 9468, 237, 122]
N: 💁‍♂ [93273, 223, 102470, 17245, 224]

O: 🧖🏿‍♂ [9468, 100, 244, 9468, 237, 123, 102470, 17245, 224]
N: 🙇‍♀ [9468, 247, 229, 102470, 32990]

O: 🟪 [9468, 253, 103]
N: 🧖🏿‍♂ [9468, 100, 244, 9468, 237, 123, 102470, 17245, 224]

O: 🖱 [9468, 244, 109]
N: 🟪 [9468, 253, 103]

O: 👩‍❤‍👨 [9468, 239, 102, 102470, 121643, 102470, 9468, 239, 101]
N: 🖱 [9468, 244, 109]

O: 💁‍♂ [93273, 223, 102470, 17245, 224]
N: 🧍🏽‍♀ [9468, 100, 235, 9468, 237, 121, 102470, 32990]

O: 🙇‍♀ [9468, 247, 229, 102470, 32990]
N: 👩‍❤‍👨 [9468, 239, 102, 102470, 121643, 102470, 9468, 239, 101]

O: 🧍🏽‍♀ [9468, 100, 235, 9468, 237, 121, 102470, 32990]
N: 🧑🏿‍🤝‍🧑🏾 [9468, 100, 239, 9468, 237, 123, 102470, 9468, 97, 251, 102470, 9468, 100, 239, 9468, 237, 122]

O: 🪐 [9468, 103, 238]
N: 🪐 [9468, 103, 238]

O: 🏌🏻‍♀️ [9468, 237, 234, 9468, 237, 119, 102470, 32990, 31643]
N: 🏌🏻‍♀️ [9468, 237, 234, 9468, 237, 119, 102470, 32990, 31643]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.55s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:10,  5.06s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.77s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.28s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.85s/it]
Processing depth (2, 3, 4, 6, 8):   4%|▍         | 4/100 [01:39<33:28, 20.92s/it]2025-01-22 04:12:49.743 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel travelled to the hallway.
2025-01-22 04:12:49.754 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1855, 1860) --> . Daniel travelled to the
2025-01-22 04:12:49.755 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel grabbed the apple.
2025-01-22 04:12:49.770 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2929, 2933) -->  Daniel grabbed the apple
2025-01-22 04:12:49.770 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the garden.
2025-01-22 04:12:49.788 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3636, 3642) --> . Daniel went back to the
2025-01-22 04:12:49.788 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel put down the apple.
2025-01-22 04:12:49.813 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4872, 4877) --> . Daniel put down the
2025-01-22 04:12:49.813 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary travelled to the bedroom.
2025-01-22 04:12:49.850 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6633, 6638) --> . Mary travelled to the
2025-01-22 04:12:49.850 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John moved to the garden.
2025-01-22 04:12:49.888 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6315, 6320) -->  John moved to the garden
2025-01-22 04:12:49.889 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra journeyed to the office.
2025-01-22 04:12:49.929 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6318, 6324) -->  the garden. Sandra journeyed
2025-01-22 04:12:49.929 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the office.
2025-01-22 04:12:49.951 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3604, 3610) -->  Hon. John went back to
2025-01-22 04:12:49.951 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the hallway.
2025-01-22 04:12:49.980 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4711, 4717) --> . Sandra went back to the
2025-01-22 04:12:49.980 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra moved to the kitchen.
2025-01-22 04:12:50.019 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6317, 6322) -->  to the garden. Sandra
2025-01-22 04:12:50.020 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John journeyed to the bedroom.
2025-01-22 04:12:50.037 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (2121, 2127) --> . John journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:12:50.831 | INFO     | test_jbb_embedding:begin_test:693 - the hallway<|eot_id|>
2025-01-22 04:12:50.831 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8196])
2025-01-22 04:12:53.064 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [221.15125, 20.872425371996584, 91.93290441176471, 19.960505605036854, 26.48556698069853], 'topk_indices': array([8188, 1856, 8170, 4717, 8190,   14, 1857, 2932, 3642,   24, 8195,
       8075,    3, 4877, 2933, 8194, 1860,    0, 8191, 8192]), 'topk_tokens': ['?\n', ' Daniel', ':', ' hallway', ':', '\n', ' travelled', ' apple', ' garden', '\n\n', '\n\n', '.\n\n', '<|end_header_id|>', ' apple', '.', '<|end_header_id|>', ' hallway', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [320.35, 317.40625, 197.47916666666666, 270.075, 24.43125]}, 'weight': {'score': [22.3178125, 23.282503963898037, 22.39889705882353, 23.28915751689189, 30.033088235294116], 'topk_indices': array([3294, 3267, 3187, 3139, 7472, 7434, 1461, 1399, 4314, 4298, 5140,
       5201, 7155, 7211, 3450, 3476, 4917, 4942, 4965, 4994]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.01875, 28.333984375, 20.927083333333332, 22.034375, 20.75625]}, 'saliency': {'score': [1.31365478515625, 0.11458637057491768, 0.5287403779871324, 0.10917384642055052, 0.20171591814826517], 'topk_indices': array([4886, 8195,   24, 8156, 8189, 8075, 2930, 4875, 8169, 8181, 2929,
       8175, 1856, 8183, 2932, 3642, 1857, 4717, 4877, 1860]), 'topk_tokens': ['�', '\n\n', '\n\n', ' return', 'Answer', '.\n\n', ' grabbed', ' down', 'Question', ' apple', ' Daniel', ' prior', ' Daniel', ' discarded', ' apple', ' garden', ' travelled', ' hallway', ' apple', ' hallway'], 'evidence_proportions': [1.86904296875, 2.3681640625, 0.9855143229166666, 1.477880859375, 0.14420166015625]}}, 'pred_res': 'the hallway<|eot_id|>', 'score': 100}
2025-01-22 04:12:53.079 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:12:53.079 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-17_pid-4_2-3-4-6-8.pkl | len: 3 |  size: 2.09 KB
Processing depth (2, 3, 4, 6, 8):   5%|▌         | 5/100 [01:42<32:49, 20.73s/it]Processing depth (2, 3, 4, 6, 8):   5%|▌         | 5/100 [01:42<32:28, 20.51s/it]
2025-01-22 04:12:53.153 | INFO     | __main__:<module>:82 - Selected idx: 18
2025-01-22 04:12:53.153 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the apple before the bathroom? 
2025-01-22 04:12:53.153 | INFO     | __main__:<module>:84 - Answer: hallway
2025-01-22 04:12:53.153 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 04:12:53.153 | INFO     | __main__:<module>:86 - Needle: [' John went back to the office.', ' Sandra moved to the kitchen.', ' Daniel went to the hallway.', ' John moved to the garden.', ' John journeyed to the bedroom.', ' Sandra went back to the hallway.', ' Daniel travelled to the bathroom.', ' Sandra journeyed to the office.', ' Daniel dropped the apple there.', ' Mary travelled to the bedroom.']
2025-01-22 04:12:53.153 | INFO     | __main__:<module>:87 - Real Needle: [' Daniel went to the hallway.', ' Daniel travelled to the bathroom.', ' Daniel dropped the apple there.', ' Mary travelled to the bedroom.']
2025-01-22 04:12:53.153 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['🏋\u200d♂️', '🧑🏽\u200d🚒', '🧗🏿\u200d♂', '🌽', '🏃🏾\u200d♀️\u200d➡️', '🧔\u200d♂', '◽', '💼', '🧎🏼\u200d♂️', '🇳🇿']
emoji:
O: 🏋‍♂️ [9468, 237, 233, 102470, 17245, 224, 31643]
N: 🧑🏽‍🚒 [9468, 100, 239, 9468, 237, 121, 102470, 9468, 248, 240]

O: 🧑🏽‍🚒 [9468, 100, 239, 9468, 237, 121, 102470, 9468, 248, 240]
N: 💼 [93273, 120]

O: 🧗🏿‍♂ [9468, 100, 245, 9468, 237, 123, 102470, 17245, 224]
N: 🏃🏾‍♀️‍➡️ [9468, 237, 225, 9468, 237, 122, 102470, 32990, 31643, 102470, 98115, 94, 31643]

O: 🌽 [9468, 234, 121]
N: 🧔‍♂ [9468, 100, 242, 102470, 17245, 224]

O: 🏃🏾‍♀️‍➡️ [9468, 237, 225, 9468, 237, 122, 102470, 32990, 31643, 102470, 98115, 94, 31643]
N: 🧗🏿‍♂ [9468, 100, 245, 9468, 237, 123, 102470, 17245, 224]

O: 🧔‍♂ [9468, 100, 242, 102470, 17245, 224]
N: 🌽 [9468, 234, 121]

O: ◽ [41832, 121]
N: 🏋‍♂️ [9468, 237, 233, 102470, 17245, 224, 31643]

O: 💼 [93273, 120]
N: ◽ [41832, 121]

O: 🧎🏼‍♂️ [9468, 100, 236, 9468, 237, 120, 102470, 17245, 224, 31643]
N: 🧎🏼‍♂️ [9468, 100, 236, 9468, 237, 120, 102470, 17245, 224, 31643]

O: 🇳🇿 [9468, 229, 111, 9468, 229, 123]
N: 🇳🇿 [9468, 229, 111, 9468, 229, 123]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.06s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.45s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.09s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  2.64s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  3.21s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 5, 6, 7):   0%|          | 0/100 [00:14<?, ?it/s]2025-01-22 04:13:07.760 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went to the hallway.
2025-01-22 04:13:07.761 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  went to the hallway.
2025-01-22 04:13:07.761 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel travelled to the bathroom.
2025-01-22 04:13:07.782 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4225, 4230) -->  Daniel travelled to the bathroom
2025-01-22 04:13:07.782 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel dropped the apple there.
2025-01-22 04:13:07.806 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4780, 4785) --> . Daniel dropped the apple
2025-01-22 04:13:07.806 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary travelled to the bedroom.
2025-01-22 04:13:07.837 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5650, 5655) --> . Mary travelled to the
2025-01-22 04:13:07.837 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the office.
2025-01-22 04:13:07.838 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (211, 217) -->  John went back to the office
2025-01-22 04:13:07.838 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the kitchen.
2025-01-22 04:13:07.861 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4255, 4260) -->  Sandra moved to the kitchen
2025-01-22 04:13:07.861 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the garden.
2025-01-22 04:13:07.884 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3856, 3861) --> . John moved to the
2025-01-22 04:13:07.884 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the bedroom.
2025-01-22 04:13:07.899 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2563, 2569) --> . John journeyed to the
2025-01-22 04:13:07.899 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra went back to the hallway.
2025-01-22 04:13:07.933 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6678, 6684) --> . Sandra went back to the
2025-01-22 04:13:07.933 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra journeyed to the office.
2025-01-22 04:13:07.934 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (111, 117) --> . Sandra journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:13:12.516 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's hand.<|eot_id|>
2025-01-22 04:13:12.516 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8179])
2025-01-22 04:13:15.472 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [361.6765625, 30.41644387069176, 148.7077205882353, 29.106514517716537, 26.91105993470149], 'topk_indices': array([8170, 4229,    9, 8076,    4, 4782,    1, 8175,   24, 4230, 8177,
       8067, 8167, 8169, 8077, 4785, 4784,   14, 8174,    0]), 'topk_tokens': ['?', ' bathroom', ':', ' first', '\n\n', ' dropped', '<|start_header_id|>', '<|start_header_id|>', '\n\n', '.', '<|end_header_id|>', '.\n\n', ' before', ' bathroom', ' location', ' there', ' apple', '\n', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [308.4, 444.75, 626.0, 67.55625]}, 'weight': {'score': [22.983203125, 23.280701921901734, 21.736213235294116, 23.287894661970963, 29.93586753731343], 'topk_indices': array([3286, 3313, 3206, 3158, 7422, 7460, 1453, 1515, 4323, 4307, 5195,
       5134, 7123, 7179, 3495, 3469, 4905, 4953, 4982, 4930]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.871875, 26.7078125, 23.596875, 20.75625]}, 'saliency': {'score': [2.29034423828125, 0.17005456790630347, 0.8388492359834558, 0.16203970421017624, 0.20914880553288245], 'topk_indices': array([  24,   31,    0,    8,   38, 2569, 4237, 8161, 8076, 8067, 4240,
       4226, 4782, 8166, 4229, 8167, 4785, 8077, 8169, 4784]), 'topk_tokens': ['\n\n', ' went', '<|begin_of_text|>', ' Date', '***', ' bedroom', 'ree', 'Question', ' first', '.\n\n', 'outs', ' travelled', ' dropped', ' apple', ' bathroom', ' before', ' there', ' location', ' bathroom', ' apple'], 'evidence_proportions': [1.68466796875, 3.2091796875, 3.873828125, 0.393701171875]}}, 'pred_res': "Daniel's hand.<|eot_id|>", 'score': 0}
2025-01-22 04:13:15.480 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:13:15.481 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-18_pid-0_0-5-6-7.pkl | len: 3 |  size: 2.05 KB
Processing depth (0, 5, 6, 7):   1%|          | 1/100 [00:22<36:41, 22.24s/it]is_0k: False
your chose emoji: ['⏏', '🙇🏼\u200d♂️', '📍', '💪🏻', '🧎🏾\u200d♂', '🫐', '👩\u200d🦲', '🙋🏽\u200d♂️', '👨🏽\u200d🏫', '💆🏽\u200d♀️']
emoji:
O: ⏏ [158, 237, 237]
N: 👩‍🦲 [9468, 239, 102, 102470, 9468, 99, 110]

O: 🙇🏼‍♂️ [9468, 247, 229, 9468, 237, 120, 102470, 17245, 224, 31643]
N: 🙋🏽‍♂️ [9468, 247, 233, 9468, 237, 121, 102470, 17245, 224, 31643]

O: 📍 [9468, 35529]
N: 🫐 [9468, 104, 238]

O: 💪🏻 [93273, 103, 9468, 237, 119]
N: 🧎🏾‍♂ [9468, 100, 236, 9468, 237, 122, 102470, 17245, 224]

O: 🧎🏾‍♂ [9468, 100, 236, 9468, 237, 122, 102470, 17245, 224]
N: 📍 [9468, 35529]

O: 🫐 [9468, 104, 238]
N: ⏏ [158, 237, 237]

O: 👩‍🦲 [9468, 239, 102, 102470, 9468, 99, 110]
N: 👨🏽‍🏫 [9468, 239, 101, 9468, 237, 121, 102470, 9468, 237, 104]

O: 🙋🏽‍♂️ [9468, 247, 233, 9468, 237, 121, 102470, 17245, 224, 31643]
N: 💪🏻 [93273, 103, 9468, 237, 119]

O: 👨🏽‍🏫 [9468, 239, 101, 9468, 237, 121, 102470, 9468, 237, 104]
N: 🙇🏼‍♂️ [9468, 247, 229, 9468, 237, 120, 102470, 17245, 224, 31643]

O: 💆🏽‍♀️ [93273, 228, 9468, 237, 121, 102470, 32990, 31643]
N: 💆🏽‍♀️ [93273, 228, 9468, 237, 121, 102470, 32990, 31643]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.50s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.66s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.64s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.21s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.73s/it]
Processing depth (1, 2, 3, 5):   1%|          | 1/100 [00:38<36:41, 22.24s/it]2025-01-22 04:13:32.186 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went to the hallway.
2025-01-22 04:13:32.191 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (909, 914) --> . Daniel went to the
2025-01-22 04:13:32.192 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel travelled to the bathroom.
2025-01-22 04:13:32.203 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1861, 1866) --> . Daniel travelled to the
2025-01-22 04:13:32.203 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel dropped the apple there.
2025-01-22 04:13:32.219 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2988, 2993) --> . Daniel dropped the apple
2025-01-22 04:13:32.220 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary travelled to the bedroom.
2025-01-22 04:13:32.241 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4264, 4269) --> . Mary travelled to the
2025-01-22 04:13:32.241 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the office.
2025-01-22 04:13:32.242 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (238, 244) --> . John went back to the
2025-01-22 04:13:32.242 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the kitchen.
2025-01-22 04:13:32.263 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4302, 4307) --> . Sandra moved to the
2025-01-22 04:13:32.263 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the garden.
2025-01-22 04:13:32.285 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3866, 3871) --> . John moved to the
2025-01-22 04:13:32.285 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the bedroom.
2025-01-22 04:13:32.300 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2691, 2697) --> . John journeyed to the
2025-01-22 04:13:32.300 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra went back to the hallway.
2025-01-22 04:13:32.336 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6674, 6680) --> . Sandra went back to the
2025-01-22 04:13:32.336 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra journeyed to the office.
2025-01-22 04:13:32.336 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (105, 111) --> . Sandra journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:13:33.146 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 04:13:33.146 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8173])
2025-01-22 04:13:35.371 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [256.0875, 25.552206916585128, 187.55514705882354, 24.306355423541, 8.230026245117188], 'topk_indices': array([8160, 8146, 3871,  910, 8161, 8169,  915, 8163, 7066,    3, 2993,
       7040,   24, 2992, 1866,   14,    1,  914, 8168,    0]), 'topk_tokens': [' apple', '.', ' garden', ' Daniel', ' before', '<|start_header_id|>', '.', ' bathroom', ' to', '<|end_header_id|>', ' there', ' be', '\n\n', ' apple', ' bathroom', '\n', '<|start_header_id|>', ' hallway', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [328.2, 247.875, 393.55, 54.725]}, 'weight': {'score': [21.259375, 23.26486247859589, 20.441636029411764, 23.28161936715095, 29.249267578125], 'topk_indices': array([3270, 3297, 3190, 3142, 7426, 7464, 1481, 1419, 4291, 4275, 5193,
       5132, 7197, 7141, 3453, 3479, 4962, 4933, 4910, 4885]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.665625, 21.01875, 23.596875, 20.75625]}, 'saliency': {'score': [1.4778533935546876, 0.14352193037357816, 1.0351131663602942, 0.1365038644677458, 0.06040835380554199], 'topk_indices': array([ 239,   24,   54, 8071,    0, 1863, 2990, 2697, 7040, 3871, 8160,
       8161, 2993, 8155,  106,  910, 2992, 8163, 1866,  914]), 'topk_tokens': [' John', '\n\n', '\n\n\n\n', ' location', '<|begin_of_text|>', ' travelled', ' dropped', ' bedroom', ' be', ' garden', ' apple', ' before', ' there', 'Question', ' Sandra', ' Daniel', ' apple', ' bathroom', ' bathroom', ' hallway'], 'evidence_proportions': [1.75810546875, 1.41318359375, 2.4283203125, 0.31180419921875]}}, 'pred_res': 'The garden.<|eot_id|>', 'score': 0}
2025-01-22 04:13:35.378 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:13:35.378 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-18_pid-1_1-2-3-5.pkl | len: 3 |  size: 2.06 KB
Processing depth (1, 2, 3, 5):   2%|▏         | 2/100 [00:42<34:04, 20.86s/it]is_0k: False
your chose emoji: ['👷\u200d♂️', '🧑🏼\u200d⚖', '🧮', '\U0001fab7', '👩🏽\u200d❤️\u200d👨🏿', '🧗', '🤦🏼\u200d♂', '🧚🏻\u200d♀', '💚', '👦']
emoji:
O: 👷‍♂️ [9468, 239, 115, 102470, 17245, 224, 31643]
N: 🪷 [9468, 103, 115]

O: 🧑🏼‍⚖ [9468, 100, 239, 9468, 237, 120, 102470, 158, 248, 244]
N: 👷‍♂️ [9468, 239, 115, 102470, 17245, 224, 31643]

O: 🧮 [9468, 100, 106]
N: 🧚🏻‍♀ [9468, 100, 248, 9468, 237, 119, 102470, 32990]

O: 🪷 [9468, 103, 115]
N: 🧑🏼‍⚖ [9468, 100, 239, 9468, 237, 120, 102470, 158, 248, 244]

O: 👩🏽‍❤️‍👨🏿 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 123]
N: 💚 [93273, 248]

O: 🧗 [9468, 100, 245]
N: 🧮 [9468, 100, 106]

O: 🤦🏼‍♂ [9468, 97, 99, 9468, 237, 120, 102470, 17245, 224]
N: 🤦🏼‍♂ [9468, 97, 99, 9468, 237, 120, 102470, 17245, 224]

O: 🧚🏻‍♀ [9468, 100, 248, 9468, 237, 119, 102470, 32990]
N: 👩🏽‍❤️‍👨🏿 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 123]

O: 💚 [93273, 248]
N: 🧗 [9468, 100, 245]

O: 👦 [9468, 239, 99]
N: 👦 [9468, 239, 99]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:11,  3.99s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.48s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.64s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.18s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.65s/it]
Processing depth (1, 4, 6, 7):   2%|▏         | 2/100 [00:58<34:04, 20.86s/it]2025-01-22 04:13:51.651 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went to the hallway.
2025-01-22 04:13:51.655 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (807, 812) --> . Daniel went to the
2025-01-22 04:13:51.656 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel travelled to the bathroom.
2025-01-22 04:13:51.673 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3540, 3545) --> . Daniel travelled to the
2025-01-22 04:13:51.673 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel dropped the apple there.
2025-01-22 04:13:51.695 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4640, 4645) --> . Daniel dropped the apple
2025-01-22 04:13:51.696 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary travelled to the bedroom.
2025-01-22 04:13:51.723 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5612, 5617) --> . Mary travelled to the
2025-01-22 04:13:51.723 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the office.
2025-01-22 04:13:51.724 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (192, 198) --> . John went back to the
2025-01-22 04:13:51.724 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the kitchen.
2025-01-22 04:13:51.744 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4157, 4162) -->  Sandra moved to the kitchen
2025-01-22 04:13:51.744 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the garden.
2025-01-22 04:13:51.762 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3690, 3695) --> . John moved to the
2025-01-22 04:13:51.762 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the bedroom.
2025-01-22 04:13:51.774 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2451, 2457) --> . John journeyed to the
2025-01-22 04:13:51.774 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra went back to the hallway.
2025-01-22 04:13:51.807 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6646, 6652) --> . Sandra went back to the
2025-01-22 04:13:51.807 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra journeyed to the office.
2025-01-22 04:13:51.808 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (105, 111) --> . Sandra journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:13:52.560 | INFO     | test_jbb_embedding:begin_test:693 - the bedroom<|eot_id|>
2025-01-22 04:13:52.560 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8167])
2025-01-22 04:13:54.785 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [246.021875, 27.55605875152999, 230.7316176470588, 26.166546020206997, 33.93269723360656], 'topk_indices': array([8021,  106,    3,  812, 3545, 8055, 8154,   29, 8165,   24, 4644,
       4309, 8157, 4645,   14, 8155, 6652, 8163, 8162,    0]), 'topk_tokens': [' context', ' Sandra', '<|end_header_id|>', ' hallway', ' bathroom', '.\n\n', ' apple', '\n\n', '<|end_header_id|>', '\n\n', ' apple', 'nes', ' bathroom', ' there', '\n', ' before', ' hallway', '<|start_header_id|>', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [238.95, 237.125, 363.0, 145.0125]}, 'weight': {'score': [21.259375, 23.26796779375765, 21.145909926470587, 23.281807348139477, 29.7515368852459], 'topk_indices': array([3316, 3343, 3188, 3236, 7462, 7424, 1533, 1471, 4343, 4327, 5205,
       5144, 7145, 7201, 3505, 3531, 4969, 4921, 4946, 4998]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.665625, 21.01875, 23.596875, 20.75625]}, 'saliency': {'score': [1.4388671875, 0.1565278182852662, 1.3122055951286764, 0.14852636044926687, 0.25380956931192367], 'topk_indices': array([3692, 8151, 8160,  808,   36, 4642, 8021, 8149, 4645, 2457, 8154,
       4157, 4309,  106, 3545, 8155, 4644,  812, 8157, 6652]), 'topk_tokens': [' moved', ' Where', 'Answer', ' Daniel', ' prepared', ' dropped', ' context', 'Question', ' there', ' bedroom', ' apple', ' Sandra', 'nes', ' Sandra', ' bathroom', ' before', ' apple', ' hallway', ' bathroom', ' hallway'], 'evidence_proportions': [1.304736328125, 1.32822265625, 2.2625, 0.860009765625]}}, 'pred_res': 'the bedroom<|eot_id|>', 'score': 0}
2025-01-22 04:13:54.793 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:13:54.794 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-18_pid-2_1-4-6-7.pkl | len: 3 |  size: 2.07 KB
Processing depth (1, 4, 6, 7):   3%|▎         | 3/100 [01:01<32:39, 20.20s/it]is_0k: False
your chose emoji: ['🏌️', '👩🏽\u200d❤️\u200d💋\u200d👨🏼', '👨🏽\u200d🦼\u200d➡', '😒', '🖐', '♒', '🚶🏾\u200d♀', '🕵🏻', '🤳', '♥']
emoji:
O: 🏌️ [9468, 237, 234, 31643]
N: 👨🏽‍🦼‍➡ [9468, 239, 101, 9468, 237, 121, 102470, 9468, 99, 120, 102470, 98115, 94]

O: 👩🏽‍❤️‍💋‍👨🏼 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 120]
N: 🚶🏾‍♀ [9468, 248, 114, 9468, 237, 122, 102470, 32990]

O: 👨🏽‍🦼‍➡ [9468, 239, 101, 9468, 237, 121, 102470, 9468, 99, 120, 102470, 98115, 94]
N: 🤳 [9468, 97, 111]

O: 😒 [76460, 240]
N: ♒ [17245, 240]

O: 🖐 [9468, 244, 238]
N: 🕵🏻 [9468, 243, 113, 9468, 237, 119]

O: ♒ [17245, 240]
N: 🖐 [9468, 244, 238]

O: 🚶🏾‍♀ [9468, 248, 114, 9468, 237, 122, 102470, 32990]
N: 🏌️ [9468, 237, 234, 31643]

O: 🕵🏻 [9468, 243, 113, 9468, 237, 119]
N: 😒 [76460, 240]

O: 🤳 [9468, 97, 111]
N: 👩🏽‍❤️‍💋‍👨🏼 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 120]

O: ♥ [77809]
N: ♥ [77809]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.47s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.41s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.24s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.97s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.47s/it]
Processing depth (2, 3, 6, 9):   3%|▎         | 3/100 [01:17<32:39, 20.20s/it]2025-01-22 04:14:10.407 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went to the hallway.
2025-01-22 04:14:10.418 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1757, 1762) --> . Daniel went to the
2025-01-22 04:14:10.418 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel travelled to the bathroom.
2025-01-22 04:14:10.433 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2860, 2865) --> . Daniel travelled to the
2025-01-22 04:14:10.433 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel dropped the apple there.
2025-01-22 04:14:10.457 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4876, 4881) --> . Daniel dropped the apple
2025-01-22 04:14:10.457 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary travelled to the bedroom.
2025-01-22 04:14:10.495 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7245, 7250) --> . Mary travelled to the
2025-01-22 04:14:10.495 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the office.
2025-01-22 04:14:10.496 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (181, 187) -->  John went back to the office
2025-01-22 04:14:10.496 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the kitchen.
2025-01-22 04:14:10.518 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4257, 4262) -->  Sandra moved to the kitchen
2025-01-22 04:14:10.518 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the garden.
2025-01-22 04:14:10.538 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3828, 3833) --> . John moved to the
2025-01-22 04:14:10.538 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the bedroom.
2025-01-22 04:14:10.552 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2543, 2549) --> . John journeyed to the
2025-01-22 04:14:10.552 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra went back to the hallway.
2025-01-22 04:14:10.589 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6674, 6680) --> . Sandra went back to the
2025-01-22 04:14:10.589 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra journeyed to the office.
2025-01-22 04:14:10.590 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (48, 54) -->  Sandra journeyed to the office
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:14:11.415 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's hand.<|eot_id|>
2025-01-22 04:14:11.415 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8189])
2025-01-22 04:14:13.649 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [522.3125, 47.444149017333984, 346.3382352941176, 45.02835079257803, 50.248046875], 'topk_indices': array([8172, 6680, 8175, 4882, 4879, 4895, 8174, 8077, 4876, 8184,   14,
       8185, 4896, 8179, 4878, 8177, 8087, 4881, 4880,    0]), 'topk_tokens': [':', ' hallway', ' the', '.', ' the', ' supposed', ' was', '.\n\n', '.', '<|eot_id|>', '\n', '<|start_header_id|>', ' for', ' bathroom', ' dropped', ' before', ' location', ' there', ' apple', '<|begin_of_text|>'], 'evidence_proportions': [487.45, 448.75, 1055.5, 97.55]}, 'weight': {'score': [21.259375, 23.284944534301758, 22.32651654411765, 23.29392683245269, 29.723307291666668], 'topk_indices': array([3345, 3318, 3238, 3190, 7462, 7424, 1455, 1517, 4325, 4309, 5207,
       5146, 7139, 7195, 3527, 3501, 4980, 4928, 4903, 4951]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.665625, 21.01875, 23.596875, 20.75625]}, 'saliency': {'score': [3.075537109375, 0.26913982629776, 2.0579115923713234, 0.25476944220977205, 0.37221399943033856], 'topk_indices': array([2545, 4877, 1758, 8043, 2862, 2718, 8171, 2626, 8176, 2549, 1762,
       4895, 8177, 2865, 4878, 6680, 4881, 8179, 8087, 4880]), 'topk_tokens': [' journey', ' Daniel', ' Daniel', ' context', ' travelled', ' ne', 'Question', 'engers', ' apple', ' bedroom', ' hallway', ' supposed', ' before', ' bathroom', ' dropped', ' hallway', ' there', ' bathroom', ' location', ' apple'], 'evidence_proportions': [2.66640625, 2.66953125, 6.454296875, 0.5119140625]}}, 'pred_res': "Daniel's hand.<|eot_id|>", 'score': 0}
2025-01-22 04:14:13.660 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:14:13.661 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-18_pid-3_2-3-6-9.pkl | len: 3 |  size: 2.04 KB
Processing depth (2, 3, 6, 9):   4%|▍         | 4/100 [01:20<31:28, 19.67s/it]is_0k: False
your chose emoji: ['🙇🏼\u200d♀️', '♥️', '👱🏿', '\U0001f9cc', '🧑🏾\u200d🏭', '🏊🏿', '👩🏿\u200d❤\u200d👩🏾', '🇱🇰', '🧝🏼\u200d♂', '🤷\u200d♀️']
emoji:
O: 🙇🏼‍♀️ [9468, 247, 229, 9468, 237, 120, 102470, 32990, 31643]
N: 🧝🏼‍♂ [9468, 100, 251, 9468, 237, 120, 102470, 17245, 224]

O: ♥️ [77809, 31643]
N: 🏊🏿 [9468, 237, 232, 9468, 237, 123]

O: 👱🏿 [9468, 239, 109, 9468, 237, 123]
N: 👱🏿 [9468, 239, 109, 9468, 237, 123]

O: 🧌 [9468, 100, 234]
N: 🙇🏼‍♀️ [9468, 247, 229, 9468, 237, 120, 102470, 32990, 31643]

O: 🧑🏾‍🏭 [9468, 100, 239, 9468, 237, 122, 102470, 9468, 237, 255]
N: 🧑🏾‍🏭 [9468, 100, 239, 9468, 237, 122, 102470, 9468, 237, 255]

O: 🏊🏿 [9468, 237, 232, 9468, 237, 123]
N: 🧌 [9468, 100, 234]

O: 👩🏿‍❤‍👩🏾 [9468, 239, 102, 9468, 237, 123, 102470, 121643, 102470, 9468, 239, 102, 9468, 237, 122]
N: ♥️ [77809, 31643]

O: 🇱🇰 [9468, 229, 109, 9468, 229, 108]
N: 👩🏿‍❤‍👩🏾 [9468, 239, 102, 9468, 237, 123, 102470, 121643, 102470, 9468, 239, 102, 9468, 237, 122]

O: 🧝🏼‍♂ [9468, 100, 251, 9468, 237, 120, 102470, 17245, 224]
N: 🇱🇰 [9468, 229, 109, 9468, 229, 108]

O: 🤷‍♀️ [9468, 97, 115, 102470, 32990, 31643]
N: 🤷‍♀️ [9468, 97, 115, 102470, 32990, 31643]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.50s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.74s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.35s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  2.98s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.54s/it]
Processing depth (0, 2, 4, 9):   4%|▍         | 4/100 [01:36<31:28, 19.67s/it]2025-01-22 04:14:29.554 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went to the hallway.
2025-01-22 04:14:29.554 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  went to the hallway.
2025-01-22 04:14:29.554 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel travelled to the bathroom.
2025-01-22 04:14:29.563 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1831, 1836) --> . Daniel travelled to the
2025-01-22 04:14:29.563 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel dropped the apple there.
2025-01-22 04:14:29.581 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3668, 3673) --> . Daniel dropped the apple
2025-01-22 04:14:29.581 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary travelled to the bedroom.
2025-01-22 04:14:29.616 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7160, 7165) -->  Mary travelled to the bedroom
2025-01-22 04:14:29.616 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the office.
2025-01-22 04:14:29.617 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (244, 250) --> . John went back to the
2025-01-22 04:14:29.617 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the kitchen.
2025-01-22 04:14:29.638 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4312, 4317) --> . Sandra moved to the
2025-01-22 04:14:29.638 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the garden.
2025-01-22 04:14:29.657 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3882, 3887) --> . John moved to the
2025-01-22 04:14:29.657 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the bedroom.
2025-01-22 04:14:29.674 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2583, 2589) --> . John journeyed to the
2025-01-22 04:14:29.674 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra went back to the hallway.
2025-01-22 04:14:29.709 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6698, 6704) --> . Sandra went back to the
2025-01-22 04:14:29.709 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra journeyed to the office.
2025-01-22 04:14:29.710 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (111, 117) --> . Sandra journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:14:30.468 | INFO     | test_jbb_embedding:begin_test:693 - the bedroom<|eot_id|>
2025-01-22 04:14:30.468 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8211])
2025-01-22 04:14:32.715 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [273.4125, 26.539714968346725, 147.53033088235293, 25.43050704656863, 16.127329631024097], 'topk_indices': array([3670, 8099, 3650, 8209, 2589, 1836, 6136, 8109, 3673,   24, 8199,
       3672, 6137, 3668, 3648,  601, 8206,   14, 8207,    0]), 'topk_tokens': [' dropped', '.\n\n', '.', '<|end_header_id|>', ' bedroom', ' bathroom', '\n', ' location', ' there', '\n\n', ' before', ' apple', 'the', '.', '\n', ',', '<|eot_id|>', '\n', '<|start_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [302.15, 242.9, 508.4, 40.2]}, 'weight': {'score': [22.917578125, 23.292817521913804, 20.441636029411764, 23.30561714920343, 29.252447289156628], 'topk_indices': array([3306, 3333, 3178, 3226, 7488, 7450, 1467, 1529, 4339, 4323, 5170,
       5231, 7171, 7227, 3489, 3515, 5012, 4983, 4948, 4923]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.871875, 21.01875, 23.596875, 26.1828125]}, 'saliency': {'score': [1.5789337158203125, 0.14757293188458728, 0.8165767894071692, 0.1412771785960478, 0.11840130909379706], 'topk_indices': array([3648,   24, 6045, 3669, 8193, 3667,  112, 1833, 3670, 3673,   34,
       8198, 8109, 8199, 6137, 8201, 6704, 2589, 1836, 3672]), 'topk_tokens': ['\n', '\n\n', 'this', ' Daniel', 'Question', ' Hon', ' Sandra', ' travelled', ' dropped', ' there', ' hallway', ' apple', ' location', ' before', 'the', ' bathroom', ' hallway', ' bedroom', ' bathroom', ' apple'], 'evidence_proportions': [1.747509765625, 1.438671875, 2.85869140625, 0.27086181640625]}}, 'pred_res': 'the bedroom<|eot_id|>', 'score': 0}
2025-01-22 04:14:32.725 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:14:32.725 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-18_pid-4_0-2-4-9.pkl | len: 3 |  size: 2.01 KB
Processing depth (0, 2, 4, 9):   5%|▌         | 5/100 [01:39<30:48, 19.45s/it]Processing depth (0, 2, 4, 9):   5%|▌         | 5/100 [01:39<31:31, 19.91s/it]
2025-01-22 04:14:32.791 | INFO     | __main__:<module>:82 - Selected idx: 19
2025-01-22 04:14:32.791 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the location prior to the place where the football was discarded, left or dropped?
2025-01-22 04:14:32.791 | INFO     | __main__:<module>:84 - Answer: hallway
2025-01-22 04:14:32.791 | INFO     | __main__:<module>:85 - Tag: 4-hop
2025-01-22 04:14:32.791 | INFO     | __main__:<module>:86 - Needle: [' Sandra journeyed to the office.', ' Sandra moved to the kitchen.', ' Daniel went to the hallway.', ' John journeyed to the bedroom.', ' Sandra went back to the hallway.', ' Daniel got the football.', ' John went back to the office.', ' Daniel travelled to the bathroom.', ' John moved to the garden.', ' Daniel dropped the football there.', ' Mary travelled to the bedroom.']
2025-01-22 04:14:32.791 | INFO     | __main__:<module>:87 - Real Needle: [' Daniel went to the hallway.', ' Daniel got the football.', ' Daniel travelled to the bathroom.', ' Daniel dropped the football there.', ' Mary travelled to the bedroom.']
2025-01-22 04:14:32.791 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['\U0001faf5🏻', '👩🏽\u200d🏫', '🇸🇧', '\U0001faf6🏾', '🚴🏻', '🧎🏻\u200d♀️\u200d➡', '🛀', '👩🏽\u200d❤\u200d👨🏿', '🤸🏾\u200d♀️', '🧑🏾\u200d🦯']
emoji:
O: 🫵🏻 [9468, 104, 113, 9468, 237, 119]
N: 👩🏽‍❤‍👨🏿 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 123]

O: 👩🏽‍🏫 [9468, 239, 102, 9468, 237, 121, 102470, 9468, 237, 104]
N: 🤸🏾‍♀️ [9468, 97, 116, 9468, 237, 122, 102470, 32990, 31643]

O: 🇸🇧 [9468, 229, 116, 9468, 229, 100]
N: 👩🏽‍🏫 [9468, 239, 102, 9468, 237, 121, 102470, 9468, 237, 104]

O: 🫶🏾 [9468, 104, 114, 9468, 237, 122]
N: 🫵🏻 [9468, 104, 113, 9468, 237, 119]

O: 🚴🏻 [9468, 248, 112, 9468, 237, 119]
N: 🫶🏾 [9468, 104, 114, 9468, 237, 122]

O: 🧎🏻‍♀️‍➡ [9468, 100, 236, 9468, 237, 119, 102470, 32990, 31643, 102470, 98115, 94]
N: 🚴🏻 [9468, 248, 112, 9468, 237, 119]

O: 🛀 [9468, 249, 222]
N: 🧎🏻‍♀️‍➡ [9468, 100, 236, 9468, 237, 119, 102470, 32990, 31643, 102470, 98115, 94]

O: 👩🏽‍❤‍👨🏿 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 123]
N: 🇸🇧 [9468, 229, 116, 9468, 229, 100]

O: 🤸🏾‍♀️ [9468, 97, 116, 9468, 237, 122, 102470, 32990, 31643]
N: 🛀 [9468, 249, 222]

O: 🧑🏾‍🦯 [9468, 100, 239, 9468, 237, 122, 102470, 9468, 99, 107]
N: 🧑🏾‍🦯 [9468, 100, 239, 9468, 237, 122, 102470, 9468, 99, 107]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.75s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:10<00:10,  5.21s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.90s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.13s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.81s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (3, 4, 6, 8, 9):   0%|          | 0/100 [00:16<?, ?it/s]2025-01-22 04:14:49.815 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went to the hallway.
2025-01-22 04:14:49.817 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (307, 312) -->  back to the hallway.
2025-01-22 04:14:49.817 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel got the football.
2025-01-22 04:14:49.835 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3626, 3630) -->  Daniel got the football
2025-01-22 04:14:49.835 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel travelled to the bathroom.
2025-01-22 04:14:49.861 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4769, 4774) -->  the senate. Daniel travelled
2025-01-22 04:14:49.861 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel dropped the football there.
2025-01-22 04:14:49.894 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6658, 6663) --> . Daniel dropped the football
2025-01-22 04:14:49.894 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary travelled to the bedroom.
2025-01-22 04:14:49.931 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7293, 7298) -->  cold. Mary travelled to
2025-01-22 04:14:49.931 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra journeyed to the office.
2025-01-22 04:14:49.964 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6405, 6411) --> . Sandra journeyed to the
2025-01-22 04:14:49.964 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the kitchen.
2025-01-22 04:14:49.975 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2115, 2120) --> . Sandra moved to the
2025-01-22 04:14:49.975 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the bedroom.
2025-01-22 04:14:49.998 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4221, 4227) -->  John journeyed to the bedroom
2025-01-22 04:14:49.998 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the hallway.
2025-01-22 04:14:50.000 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (304, 310) --> . Sandra went back to the
2025-01-22 04:14:50.000 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went back to the office.
2025-01-22 04:14:50.000 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (105, 111) --> . John went back to the
2025-01-22 04:14:50.000 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John moved to the garden.
2025-01-22 04:14:50.028 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (5415, 5420) --> . John moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:14:52.709 | INFO     | test_jbb_embedding:begin_test:693 - the bathroom<|eot_id|>
2025-01-22 04:14:52.709 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8189])
2025-01-22 04:14:55.608 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [198.25065104166666, 26.111162185668945, 187.14430147058823, 24.93013508114089, 30.434044471153847], 'topk_indices': array([6662, 3629,    3, 8068,  106, 8187, 8168, 8163, 8078, 8170,   24,
       6663,   14,  105, 8034, 2980, 8169,    0, 8184, 8185]), 'topk_tokens': [' football', ' football', '<|end_header_id|>', '.\n\n', ' John', '<|end_header_id|>', ' prior', ':', ' location', ' the', '\n\n', ' there', '\n', '.', ' context', ' hallway', ' to', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [272.3, 325.5, 84.153125, 312.975, 21.775]}, 'weight': {'score': [24.23046875, 23.25555419921875, 21.239659926470587, 23.26110404628719, 28.658653846153847], 'topk_indices': array([3284, 3257, 3177, 3129, 7453, 7415, 1481, 1419, 4274, 4290, 5180,
       5119, 7130, 7186, 3472, 3446, 4944, 4896, 4973, 4921]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.428125, 26.939453125, 25.746875, 23.803125, 24.7765625]}, 'saliency': {'score': [1.2658322652180989, 0.14598576724529266, 1.0702676212086397, 0.1388180884911617, 0.2151726355919471], 'topk_indices': array([6660, 2976,  306, 8169,   24, 8032, 8176, 8174, 8162, 6663,  106,
       8182, 6662,  305, 8078, 3629,  310, 8168, 8034, 2980]), 'topk_tokens': [' dropped', ' Daniel', ' went', ' to', '\n\n', ' provided', ' discarded', ' football', 'Question', ' there', ' John', 'Answer', ' football', ' Sandra', ' location', ' football', ' hallway', ' prior', ' context', ' hallway'], 'evidence_proportions': [1.5072265625, 2.28271484375, 0.60166015625, 2.00439453125, 0.136541748046875]}}, 'pred_res': 'the bathroom<|eot_id|>', 'score': 0}
2025-01-22 04:14:55.615 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:14:55.616 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-19_pid-0_3-4-6-8-9.pkl | len: 3 |  size: 2.12 KB
Processing depth (3, 4, 6, 8, 9):   1%|          | 1/100 [00:22<37:29, 22.72s/it]is_0k: False
your chose emoji: ['👨🏽\u200d🤝\u200d👨🏾', '🧗🏻\u200d♂️', '👬🏽', '🇦🇹', '🍆', '🇸🇻', '🧐', '🕵🏻\u200d♀', '🚷', '🟡']
emoji:
O: 👨🏽‍🤝‍👨🏾 [9468, 239, 101, 9468, 237, 121, 102470, 9468, 97, 251, 102470, 9468, 239, 101, 9468, 237, 122]
N: 🚷 [9468, 248, 115]

O: 🧗🏻‍♂️ [9468, 100, 245, 9468, 237, 119, 102470, 17245, 224, 31643]
N: 🍆 [9468, 235, 228]

O: 👬🏽 [9468, 239, 105, 9468, 237, 121]
N: 🧗🏻‍♂️ [9468, 100, 245, 9468, 237, 119, 102470, 17245, 224, 31643]

O: 🇦🇹 [9468, 229, 99, 9468, 229, 117]
N: 👬🏽 [9468, 239, 105, 9468, 237, 121]

O: 🍆 [9468, 235, 228]
N: 🕵🏻‍♀ [9468, 243, 113, 9468, 237, 119, 102470, 32990]

O: 🇸🇻 [9468, 229, 116, 9468, 229, 119]
N: 👨🏽‍🤝‍👨🏾 [9468, 239, 101, 9468, 237, 121, 102470, 9468, 97, 251, 102470, 9468, 239, 101, 9468, 237, 122]

O: 🧐 [9468, 100, 238]
N: 🇸🇻 [9468, 229, 116, 9468, 229, 119]

O: 🕵🏻‍♀ [9468, 243, 113, 9468, 237, 119, 102470, 32990]
N: 🧐 [9468, 100, 238]

O: 🚷 [9468, 248, 115]
N: 🇦🇹 [9468, 229, 99, 9468, 229, 117]

O: 🟡 [9468, 253, 94]
N: 🟡 [9468, 253, 94]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.32s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.76s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.79s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.36s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.85s/it]
Processing depth (0, 2, 4, 7, 9):   1%|          | 1/100 [00:39<37:29, 22.72s/it]2025-01-22 04:15:12.810 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went to the hallway.
2025-01-22 04:15:12.811 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  went to the hallway.
2025-01-22 04:15:12.811 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel got the football.
2025-01-22 04:15:12.821 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1616, 1620) -->  Daniel got the football
2025-01-22 04:15:12.821 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel travelled to the bathroom.
2025-01-22 04:15:12.839 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3550, 3555) --> . Daniel travelled to the
2025-01-22 04:15:12.839 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel dropped the football there.
2025-01-22 04:15:12.869 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5613, 5618) --> . Daniel dropped the football
2025-01-22 04:15:12.869 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary travelled to the bedroom.
2025-01-22 04:15:12.909 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7149, 7154) -->  Mary travelled to the bedroom
2025-01-22 04:15:12.909 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra journeyed to the office.
2025-01-22 04:15:12.942 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6305, 6311) --> . Sandra journeyed to the
2025-01-22 04:15:12.942 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the kitchen.
2025-01-22 04:15:12.952 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1840, 1845) --> . Sandra moved to the
2025-01-22 04:15:12.952 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the bedroom.
2025-01-22 04:15:12.973 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4110, 4116) --> . John journeyed to the
2025-01-22 04:15:12.973 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the hallway.
2025-01-22 04:15:12.975 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (310, 316) --> . Sandra went back to the
2025-01-22 04:15:12.975 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went back to the office.
2025-01-22 04:15:12.975 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (111, 117) --> . John went back to the
2025-01-22 04:15:12.976 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John moved to the garden.
2025-01-22 04:15:13.004 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (5233, 5238) --> . John moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:15:13.817 | INFO     | test_jbb_embedding:begin_test:693 - St. Paul<|eot_id|>
2025-01-22 04:15:13.817 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8223])
2025-01-22 04:15:16.059 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [592.7747395833334, 51.05766776075857, 235.17279411764707, 48.69954777791381, 23.477610518292682], 'topk_indices': array([8196, 8102, 8142, 5616, 8112, 1619,   14,   24, 8210, 8197, 8203,
       8068, 8208, 1620, 5615, 5618, 8219, 5617, 8218,    0]), 'topk_tokens': ['Question', '.\n\n', ' the', ' the', ' location', ' football', '\n', '\n\n', ' discarded', ':', ' to', ' context', ' football', '.', ' dropped', ' there', '<|start_header_id|>', ' football', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [612.45, 691.4375, 393.05, 1226.0, 60.66875]}, 'weight': {'score': [23.630859375, 23.290686542669583, 20.441636029411764, 23.301546431194907, 29.290396341463413], 'topk_indices': array([3332, 3359, 3204, 3252, 7477, 7439, 1467, 1529, 4344, 4328, 5139,
       5200, 7160, 7216, 3541, 3515, 4964, 4916, 4993, 4941]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.871875, 26.939453125, 21.01875, 23.803125, 26.1828125]}, 'saliency': {'score': [3.6980667114257812, 0.2844815540568776, 1.2959487017463236, 0.27024111248020094, 0.17152218702362804], 'topk_indices': array([  24, 8140,   31, 8111, 5624, 8102, 3555, 8206, 8198,   34, 8112,
       8202, 1619, 8068, 8196, 5618, 8208, 8210, 5615, 5617]), 'topk_tokens': ['\n\n', ' moved', ' went', ' first', ' m', '.\n\n', ' bathroom', ' where', ' Where', ' hallway', ' location', ' prior', ' football', ' context', 'Question', ' there', ' football', ' discarded', ' dropped', ' football'], 'evidence_proportions': [3.491015625, 4.70556640625, 2.034375, 8.0447265625, 0.41614990234375]}}, 'pred_res': 'St. Paul<|eot_id|>', 'score': 0}
2025-01-22 04:15:16.066 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:15:16.066 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-19_pid-1_0-2-4-7-9.pkl | len: 3 |  size: 2.09 KB
Processing depth (0, 2, 4, 7, 9):   2%|▏         | 2/100 [00:43<34:55, 21.39s/it]is_0k: False
your chose emoji: ['♻', '🤤', '👨🏻\u200d❤\u200d💋\u200d👨🏽', '🈷', '👩🏾\u200d🎨', '🧑🏾\u200d✈', '👍', '👩🏽\u200d❤\u200d👩🏿', '😾', '👩🏼\u200d🤝\u200d👨🏾']
emoji:
O: ♻ [17245, 119]
N: 👨🏻‍❤‍💋‍👨🏽 [9468, 239, 101, 9468, 237, 119, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 121]

O: 🤤 [9468, 97, 97]
N: 🤤 [9468, 97, 97]

O: 👨🏻‍❤‍💋‍👨🏽 [9468, 239, 101, 9468, 237, 119, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 121]
N: 👍 [9468, 239, 235]

O: 🈷 [9468, 230, 115]
N: ♻ [17245, 119]

O: 👩🏾‍🎨 [9468, 239, 102, 9468, 237, 122, 102470, 9468, 236, 101]
N: 🈷 [9468, 230, 115]

O: 🧑🏾‍✈ [9468, 100, 239, 9468, 237, 122, 102470, 38798, 230]
N: 🧑🏾‍✈ [9468, 100, 239, 9468, 237, 122, 102470, 38798, 230]

O: 👍 [9468, 239, 235]
N: 😾 [76460, 122]

O: 👩🏽‍❤‍👩🏿 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 102470, 9468, 239, 102, 9468, 237, 123]
N: 👩🏽‍❤‍👩🏿 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 102470, 9468, 239, 102, 9468, 237, 123]

O: 😾 [76460, 122]
N: 👩🏾‍🎨 [9468, 239, 102, 9468, 237, 122, 102470, 9468, 236, 101]

O: 👩🏼‍🤝‍👨🏾 [9468, 239, 102, 9468, 237, 120, 102470, 9468, 97, 251, 102470, 9468, 239, 101, 9468, 237, 122]
N: 👩🏼‍🤝‍👨🏾 [9468, 239, 102, 9468, 237, 120, 102470, 9468, 97, 251, 102470, 9468, 239, 101, 9468, 237, 122]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.08s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.42s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.23s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.71s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.28s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (1, 4, 5, 6, 9):   2%|▏         | 2/100 [00:58<34:55, 21.39s/it]2025-01-22 04:15:30.993 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went to the hallway.
2025-01-22 04:15:30.995 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (307, 312) -->  back to the hallway.
2025-01-22 04:15:30.995 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel got the football.
2025-01-22 04:15:31.018 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3548, 3552) -->  Daniel got the football
2025-01-22 04:15:31.019 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel travelled to the bathroom.
2025-01-22 04:15:31.040 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4148, 4153) --> . Daniel travelled to the
2025-01-22 04:15:31.040 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel dropped the football there.
2025-01-22 04:15:31.064 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4645, 4650) --> . Daniel dropped the football
2025-01-22 04:15:31.065 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary travelled to the bedroom.
2025-01-22 04:15:31.101 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7222, 7227) --> . Mary travelled to the
2025-01-22 04:15:31.101 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra journeyed to the office.
2025-01-22 04:15:31.137 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6249, 6255) --> . Sandra journeyed to the
2025-01-22 04:15:31.137 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the kitchen.
2025-01-22 04:15:31.149 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1903, 1908) --> . Sandra moved to the
2025-01-22 04:15:31.149 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the bedroom.
2025-01-22 04:15:31.172 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4152, 4158) -->  the bathroom. John journeyed
2025-01-22 04:15:31.172 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the hallway.
2025-01-22 04:15:31.173 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (304, 310) --> . Sandra went back to the
2025-01-22 04:15:31.174 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went back to the office.
2025-01-22 04:15:31.174 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (105, 111) --> . John went back to the
2025-01-22 04:15:31.174 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John moved to the garden.
2025-01-22 04:15:31.200 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (5129, 5134) --> . John moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:15:34.933 | INFO     | test_jbb_embedding:begin_test:693 - The bathroom.<|eot_id|>
2025-01-22 04:15:34.933 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8195])
2025-01-22 04:15:37.797 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [168.68619791666666, 20.943747712856794, 150.5652573529412, 19.96672681203931, 18.361040900735293], 'topk_indices': array([8169, 8182,    9, 8188, 8183, 8083,    3, 8082, 8175, 8081, 8113,
       8040,   24, 8074, 8114, 8191, 8084,   14, 8190,    0]), 'topk_tokens': [':', ' discarded', ':', 'Answer', ',', ' first', '<|end_header_id|>', ' the', ' to', ' in', ' to', ' context', '\n\n', '.\n\n', ' the', '<|start_header_id|>', ' location', '\n', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [212.775, 231.28125, 146.7, 220.25, 44.94375]}, 'weight': {'score': [22.407877604166668, 23.281726488167845, 21.155330882352942, 23.29318469748157, 29.997931985294116], 'topk_indices': array([3350, 3323, 3175, 3223, 7421, 7459, 1467, 1529, 4326, 4342, 5224,
       5163, 7172, 7116, 3512, 3538, 4926, 5011, 4951, 4982]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.428125, 26.939453125, 21.01875, 23.803125, 20.75625]}, 'saliency': {'score': [1.0401967366536458, 0.11678588003552695, 0.8548709644990808, 0.11098038207108031, 0.13890928380629597], 'topk_indices': array([8038, 5977, 4649, 8080,   24,  800,  106, 8168, 3551, 8074, 8174,
       8112, 8083,  310, 8180, 8188, 4153, 8182, 8040, 8084]), 'topk_tokens': [' provided', ' office', ' football', ' item', '\n\n', ' hallway', ' John', 'Question', ' football', '.\n\n', ' prior', ' moved', ' first', ' hallway', ' football', 'Answer', ' bathroom', ' discarded', ' context', ' location'], 'evidence_proportions': [1.2220703125, 1.6375732421875, 0.815625, 1.3943359375, 0.2508544921875]}}, 'pred_res': 'The bathroom.<|eot_id|>', 'score': 0}
2025-01-22 04:15:37.805 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:15:37.805 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-19_pid-2_1-4-5-6-9.pkl | len: 3 |  size: 2.09 KB
Processing depth (1, 4, 5, 6, 9):   3%|▎         | 3/100 [01:04<34:50, 21.55s/it]is_0k: False
your chose emoji: ['🧺', '🚶🏻\u200d➡️', '🗃', '🚶🏿\u200d♀\u200d➡️', '🅿️', '🚵🏻\u200d♂️', '🤽🏼\u200d♀️', '🔻', '◽', '🚶🏼\u200d♀\u200d➡️']
emoji:
O: 🧺 [9468, 100, 118]
N: 🧺 [9468, 100, 118]

O: 🚶🏻‍➡️ [9468, 248, 114, 9468, 237, 119, 102470, 98115, 94, 31643]
N: 🚶🏿‍♀‍➡️ [9468, 248, 114, 9468, 237, 123, 102470, 32990, 102470, 98115, 94, 31643]

O: 🗃 [9468, 245, 225]
N: 🤽🏼‍♀️ [9468, 97, 121, 9468, 237, 120, 102470, 32990, 31643]

O: 🚶🏿‍♀‍➡️ [9468, 248, 114, 9468, 237, 123, 102470, 32990, 102470, 98115, 94, 31643]
N: ◽ [41832, 121]

O: 🅿️ [9468, 227, 123, 31643]
N: 🚵🏻‍♂️ [9468, 248, 113, 9468, 237, 119, 102470, 17245, 224, 31643]

O: 🚵🏻‍♂️ [9468, 248, 113, 9468, 237, 119, 102470, 17245, 224, 31643]
N: 🗃 [9468, 245, 225]

O: 🤽🏼‍♀️ [9468, 97, 121, 9468, 237, 120, 102470, 32990, 31643]
N: 🔻 [9468, 242, 119]

O: 🔻 [9468, 242, 119]
N: 🅿️ [9468, 227, 123, 31643]

O: ◽ [41832, 121]
N: 🚶🏻‍➡️ [9468, 248, 114, 9468, 237, 119, 102470, 98115, 94, 31643]

O: 🚶🏼‍♀‍➡️ [9468, 248, 114, 9468, 237, 120, 102470, 32990, 102470, 98115, 94, 31643]
N: 🚶🏼‍♀‍➡️ [9468, 248, 114, 9468, 237, 120, 102470, 32990, 102470, 98115, 94, 31643]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.89s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.69s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.55s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.15s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.70s/it]
Processing depth (1, 5, 7, 8, 9):   3%|▎         | 3/100 [01:21<34:50, 21.55s/it]2025-01-22 04:15:54.479 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went to the hallway.
2025-01-22 04:15:54.481 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (307, 312) -->  back to the hallway.
2025-01-22 04:15:54.481 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel got the football.
2025-01-22 04:15:54.502 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4140, 4144) -->  Daniel got the football
2025-01-22 04:15:54.502 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel travelled to the bathroom.
2025-01-22 04:15:54.530 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5649, 5654) --> . Daniel travelled to the
2025-01-22 04:15:54.531 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel dropped the football there.
2025-01-22 04:15:54.567 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6624, 6629) --> . Daniel dropped the football
2025-01-22 04:15:54.567 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary travelled to the bedroom.
2025-01-22 04:15:54.605 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7242, 7247) --> . Mary travelled to the
2025-01-22 04:15:54.605 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra journeyed to the office.
2025-01-22 04:15:54.640 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6311, 6317) --> . Sandra journeyed to the
2025-01-22 04:15:54.641 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the kitchen.
2025-01-22 04:15:54.650 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1880, 1885) -->  Sandra moved to the kitchen
2025-01-22 04:15:54.651 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the bedroom.
2025-01-22 04:15:54.675 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4143, 4149) -->  football. John journeyed to
2025-01-22 04:15:54.675 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the hallway.
2025-01-22 04:15:54.676 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (304, 310) --> . Sandra went back to the
2025-01-22 04:15:54.677 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went back to the office.
2025-01-22 04:15:54.677 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (105, 111) --> . John went back to the
2025-01-22 04:15:54.677 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John moved to the garden.
2025-01-22 04:15:54.705 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (5333, 5338) --> . John moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:15:55.489 | INFO     | test_jbb_embedding:begin_test:693 - the hallway<|eot_id|>
2025-01-22 04:15:55.489 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8211])
2025-01-22 04:15:57.726 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [256.921875, 26.002539490504017, 175.71783088235293, 24.698912227194704, 13.898694490131579], 'topk_indices': array([5814,    9, 8184, 7939,  310, 6629,   23, 8209, 8185, 6626,    3,
       8130, 8090, 8100,   24,   14, 6628,    0, 8206, 8207]), 'topk_tokens': [' a', ':', 'Question', ' Square', ' hallway', ' there', '4', '<|end_header_id|>', ':', ' dropped', '<|end_header_id|>', ' the', '.\n\n', ' location', '\n\n', '\n', ' football', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [330.375, 240.8125, 156.425, 523.35, 30.425]}, 'weight': {'score': [22.407877604166668, 23.288284483808134, 21.80514705882353, 23.29705795579941, 29.64535361842105], 'topk_indices': array([3295, 3322, 3215, 3167, 7459, 7421, 1425, 1487, 4316, 4332, 5188,
       5127, 7136, 7192, 3528, 3502, 4904, 4981, 4929, 4952]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.428125, 26.939453125, 21.01875, 23.803125, 20.75625]}, 'saliency': {'score': [1.6397425333658855, 0.14349170551992027, 0.9851181927849265, 0.1355803126269196, 0.10547637939453125], 'topk_indices': array([8196, 8099, 8204,  910, 4143, 8128,  305, 6629, 8090,   24,    0,
       7939, 6625, 8198, 8184,  914, 6626, 8100,  310, 6628]), 'topk_tokens': [' football', ' first', 'Answer', ' Daniel', ' football', ' moved', ' Sandra', ' there', '.\n\n', '\n\n', '<|begin_of_text|>', ' Square', ' Daniel', ' discarded', 'Question', ' hallway', ' dropped', ' location', ' hallway', ' football'], 'evidence_proportions': [1.90185546875, 1.7103271484375, 0.98173828125, 3.45263671875, 0.16627197265625]}}, 'pred_res': 'the hallway<|eot_id|>', 'score': 100}
2025-01-22 04:15:57.745 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:15:57.746 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-19_pid-3_1-5-7-8-9.pkl | len: 3 |  size: 2.12 KB
Processing depth (1, 5, 7, 8, 9):   4%|▍         | 4/100 [01:24<33:27, 20.91s/it]is_0k: False
your chose emoji: ['👩🏻\u200d💻', '🍹', '🌞', '🧑🏼\u200d🔧', '🧑🏿\u200d🎄', '🧎🏻\u200d♀️\u200d➡', '🏊\u200d♀️', '🎪', '🧑🏿\u200d🦽', '🤸🏼\u200d♂️']
emoji:
O: 👩🏻‍💻 [9468, 239, 102, 9468, 237, 119, 102470, 93273, 119]
N: 🎪 [9468, 236, 103]

O: 🍹 [9468, 235, 117]
N: 🍹 [9468, 235, 117]

O: 🌞 [9468, 234, 252]
N: 🏊‍♀️ [9468, 237, 232, 102470, 32990, 31643]

O: 🧑🏼‍🔧 [9468, 100, 239, 9468, 237, 120, 102470, 9468, 242, 100]
N: 🧑🏼‍🔧 [9468, 100, 239, 9468, 237, 120, 102470, 9468, 242, 100]

O: 🧑🏿‍🎄 [9468, 100, 239, 9468, 237, 123, 102470, 9468, 236, 226]
N: 🧎🏻‍♀️‍➡ [9468, 100, 236, 9468, 237, 119, 102470, 32990, 31643, 102470, 98115, 94]

O: 🧎🏻‍♀️‍➡ [9468, 100, 236, 9468, 237, 119, 102470, 32990, 31643, 102470, 98115, 94]
N: 🌞 [9468, 234, 252]

O: 🏊‍♀️ [9468, 237, 232, 102470, 32990, 31643]
N: 👩🏻‍💻 [9468, 239, 102, 9468, 237, 119, 102470, 93273, 119]

O: 🎪 [9468, 236, 103]
N: 🧑🏿‍🎄 [9468, 100, 239, 9468, 237, 123, 102470, 9468, 236, 226]

O: 🧑🏿‍🦽 [9468, 100, 239, 9468, 237, 123, 102470, 9468, 99, 121]
N: 🧑🏿‍🦽 [9468, 100, 239, 9468, 237, 123, 102470, 9468, 99, 121]

O: 🤸🏼‍♂️ [9468, 97, 116, 9468, 237, 120, 102470, 17245, 224, 31643]
N: 🤸🏼‍♂️ [9468, 97, 116, 9468, 237, 120, 102470, 17245, 224, 31643]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:11,  3.76s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:09,  4.58s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.54s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.96s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.49s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 3, 6, 7, 8):   4%|▍         | 4/100 [01:40<33:27, 20.91s/it]2025-01-22 04:16:13.416 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went to the hallway.
2025-01-22 04:16:13.417 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  went to the hallway.
2025-01-22 04:16:13.417 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel got the football.
2025-01-22 04:16:13.434 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2996, 3000) -->  Daniel got the football
2025-01-22 04:16:13.434 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel travelled to the bathroom.
2025-01-22 04:16:13.458 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4737, 4742) --> . Daniel travelled to the
2025-01-22 04:16:13.458 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel dropped the football there.
2025-01-22 04:16:13.486 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5663, 5668) --> . Daniel dropped the football
2025-01-22 04:16:13.486 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary travelled to the bedroom.
2025-01-22 04:16:13.523 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6624, 6629) --> . Mary travelled to the
2025-01-22 04:16:13.523 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra journeyed to the office.
2025-01-22 04:16:13.556 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6311, 6317) --> . Sandra journeyed to the
2025-01-22 04:16:13.556 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the kitchen.
2025-01-22 04:16:13.567 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2189, 2194) --> . Sandra moved to the
2025-01-22 04:16:13.567 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the bedroom.
2025-01-22 04:16:13.588 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4168, 4174) --> . John journeyed to the
2025-01-22 04:16:13.588 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the hallway.
2025-01-22 04:16:13.590 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (310, 316) --> . Sandra went back to the
2025-01-22 04:16:13.590 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went back to the office.
2025-01-22 04:16:13.591 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (111, 117) --> . John went back to the
2025-01-22 04:16:13.591 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John moved to the garden.
2025-01-22 04:16:13.617 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (5347, 5352) --> . John moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:16:17.477 | INFO     | test_jbb_embedding:begin_test:693 - St. Paul<|eot_id|>
2025-01-22 04:16:17.477 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8205])
2025-01-22 04:16:20.342 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [543.60546875, 65.5447429337232, 239.484375, 63.41131901840491, 22.77215325342466], 'topk_indices': array([5133, 5962, 8200, 5134, 6007, 5667, 5964, 6093, 6098, 8201, 6015,
       5668, 5880, 6008, 6016, 5872, 5135, 6099,    0, 6100]), 'topk_tokens': ['\n', '\n', '<|eot_id|>', 'tele', '\n', ' football', ' way', ' the', ' on', '<|start_header_id|>', ' true', ' there', '-day', 'this', ' to', ' time', 'graph', '\n', '<|begin_of_text|>', 'the'], 'evidence_proportions': [569.7, 578.75, 310.15, 1218.1, 48.35625]}, 'weight': {'score': [22.500325520833332, 23.291350663986353, 20.441636029411764, 23.305568443251534, 30.06742294520548], 'topk_indices': array([3335, 3308, 3154, 3202, 7421, 7459, 1481, 1419, 4328, 4312, 5141,
       5202, 7198, 7142, 3491, 3517, 4918, 4943, 4966, 4995]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.871875, 26.939453125, 21.01875, 23.803125, 20.75625]}, 'saliency': {'score': [3.3454437255859375, 0.36527518408107945, 1.3009661506204044, 0.35259573158310964, 0.1726987655848673], 'topk_indices': array([6097, 6016, 5713, 5963, 6099, 5871, 8190, 5132, 5665, 5964, 8192,
       5668, 5134, 5667, 5872, 5880, 6015, 6008, 6100, 5135]), 'topk_tokens': [' meet', ' to', ' St', 'the', '\n', 'this', ' football', 'low', ' dropped', ' way', ' discarded', ' there', 'tele', ' football', ' time', '-day', ' true', 'this', 'the', 'graph'], 'evidence_proportions': [3.121484375, 3.978759765625, 1.6974609375, 7.7734375, 0.2827392578125]}}, 'pred_res': 'St. Paul<|eot_id|>', 'score': 0}
2025-01-22 04:16:20.349 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:16:20.349 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-19_pid-4_0-3-6-7-8.pkl | len: 3 |  size: 2.02 KB
Processing depth (0, 3, 6, 7, 8):   5%|▌         | 5/100 [01:47<34:04, 21.52s/it]Processing depth (0, 3, 6, 7, 8):   5%|▌         | 5/100 [01:47<34:03, 21.51s/it]
2025-01-22 04:16:20.427 | INFO     | __main__:<module>:82 - Selected idx: 20
2025-01-22 04:16:20.428 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the apple before the garden? 
2025-01-22 04:16:20.428 | INFO     | __main__:<module>:84 - Answer: kitchen
2025-01-22 04:16:20.428 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 04:16:20.428 | INFO     | __main__:<module>:86 - Needle: [' John grabbed the football.', ' Sandra moved to the kitchen.', ' John went to the kitchen.', ' Sandra went back to the garden.', ' Daniel went back to the bathroom.', ' John went back to the bedroom.', ' Sandra discarded the apple.', ' Daniel journeyed to the hallway.']
2025-01-22 04:16:20.428 | INFO     | __main__:<module>:87 - Real Needle: [' Sandra moved to the kitchen.', ' Sandra went back to the garden.', ' Sandra discarded the apple.', ' Daniel journeyed to the hallway.']
2025-01-22 04:16:20.428 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['⏰', '🧑🏼\u200d⚖️', '👩\u200d🍼', '🦻🏻', '🔊', '🏃🏿\u200d♀️\u200d➡️', '🏃🏼\u200d♂️\u200d➡', '🤦🏽\u200d♂️', '✌', '🇻🇮']
emoji:
O: ⏰ [158, 237, 108]
N: 🤦🏽‍♂️ [9468, 97, 99, 9468, 237, 121, 102470, 17245, 224, 31643]

O: 🧑🏼‍⚖️ [9468, 100, 239, 9468, 237, 120, 102470, 158, 248, 244, 31643]
N: 🔊 [9468, 242, 232]

O: 👩‍🍼 [9468, 239, 102, 102470, 9468, 104247]
N: 🏃🏿‍♀️‍➡️ [9468, 237, 225, 9468, 237, 123, 102470, 32990, 31643, 102470, 98115, 94, 31643]

O: 🦻🏻 [9468, 99, 119, 9468, 237, 119]
N: ⏰ [158, 237, 108]

O: 🔊 [9468, 242, 232]
N: 🦻🏻 [9468, 99, 119, 9468, 237, 119]

O: 🏃🏿‍♀️‍➡️ [9468, 237, 225, 9468, 237, 123, 102470, 32990, 31643, 102470, 98115, 94, 31643]
N: 👩‍🍼 [9468, 239, 102, 102470, 9468, 104247]

O: 🏃🏼‍♂️‍➡ [9468, 237, 225, 9468, 237, 120, 102470, 17245, 224, 31643, 102470, 98115, 94]
N: ✌ [38798, 234]

O: 🤦🏽‍♂️ [9468, 97, 99, 9468, 237, 121, 102470, 17245, 224, 31643]
N: 🏃🏼‍♂️‍➡ [9468, 237, 225, 9468, 237, 120, 102470, 17245, 224, 31643, 102470, 98115, 94]

O: ✌ [38798, 234]
N: 🧑🏼‍⚖️ [9468, 100, 239, 9468, 237, 120, 102470, 158, 248, 244, 31643]

O: 🇻🇮 [9468, 229, 119, 9468, 229, 106]
N: 🇻🇮 [9468, 229, 119, 9468, 229, 106]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.05s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.40s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.65s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.23s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.68s/it]
Processing depth (0, 4, 5, 8):   0%|          | 0/100 [00:16<?, ?it/s]2025-01-22 04:16:37.277 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the kitchen.
2025-01-22 04:16:37.278 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (32, 37) -->  moved to the kitchen.
2025-01-22 04:16:37.278 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the garden.
2025-01-22 04:16:37.299 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3630, 3636) --> . Sandra went back to the
2025-01-22 04:16:37.299 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra discarded the apple.
2025-01-22 04:16:37.323 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4168, 4172) -->  Sandra discarded the apple
2025-01-22 04:16:37.323 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the hallway.
2025-01-22 04:16:37.359 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6558, 6564) --> . Daniel journeyed to the
2025-01-22 04:16:37.359 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John grabbed the football.
2025-01-22 04:16:37.374 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3098, 3102) -->  John grabbed the football
2025-01-22 04:16:37.374 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went to the kitchen.
2025-01-22 04:16:37.401 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5278, 5283) --> . John went to the
2025-01-22 04:16:37.401 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the bathroom.
2025-01-22 04:16:37.414 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2540, 2546) --> . Daniel went back to the
2025-01-22 04:16:37.415 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the bedroom.
2025-01-22 04:16:37.448 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6721, 6727) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:16:38.256 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 04:16:38.256 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8198])
2025-01-22 04:16:40.486 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [130.80357142857142, 18.958972228996466, 64.4546130952381, 18.55400286493443, 19.578925075301203], 'topk_indices': array([  24, 8188, 8185, 1627,   14, 6925, 6875, 7630, 8186, 7627, 6876,
       1706, 7671, 8196, 1628, 7674, 8193, 7675,    0, 8194]), 'topk_tokens': ['\n\n', ' garden', ' apple', "'s", '\n', ' sound', ' sound', 'nes', ' before', ' of', ' of', "'s", ' use', '<|end_header_id|>', ' work', ' Min', '<|eot_id|>', 'nes', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [198.5125, 140.22916666666666, 177.15625, 34.052083333333336]}, 'weight': {'score': [22.588169642857142, 23.304570326789417, 21.352306547619047, 23.311439055031254, 29.788968373493976], 'topk_indices': array([3314, 3341, 3216, 3168, 7473, 7435, 1406, 1468, 4373, 4389, 5184,
       5245, 7212, 7156, 3523, 3497, 5038, 4961, 5009, 4986]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.809375, 21.869791666666668, 30.615234375, 20.270833333333332]}, 'saliency': {'score': [0.7847319103422619, 0.1064560146771354, 0.38306971958705355, 0.10399827701172593, 0.1401782667780497], 'topk_indices': array([7629, 7625, 8182, 7626, 1626, 8052, 1627, 1705, 1706, 8188, 8186,
       6925, 8185, 7670, 7630, 6875, 7671, 1628, 7674, 7675]), 'topk_tokens': [' Min', ' especial', ' Where', ' use', ' summer', ' context', "'s", ' summer', "'s", ' garden', ' before', ' sound', ' apple', ' especial', 'nes', ' sound', ' use', ' work', ' Min', 'nes'], 'evidence_proportions': [1.018310546875, 0.7845052083333334, 1.3792724609375, 0.19394938151041666]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 100}
2025-01-22 04:16:40.496 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:16:40.496 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-20_pid-0_0-4-5-8.pkl | len: 3 |  size: 2.0 KB
Processing depth (0, 4, 5, 8):   1%|          | 1/100 [00:19<32:56, 19.97s/it]is_0k: False
your chose emoji: ['🏃🏽\u200d♀️\u200d➡️', '🌯', '⛹🏽\u200d♂', '🛏', '🔆', '💡', '🧑🏾\u200d🦼\u200d➡', '👨🏾\u200d🎨', '👨🏽\u200d❤\u200d💋\u200d👨🏼', '🧘🏾\u200d♀️']
emoji:
O: 🏃🏽‍♀️‍➡️ [9468, 237, 225, 9468, 237, 121, 102470, 32990, 31643, 102470, 98115, 94, 31643]
N: �� [228, 9468, 242]

O: 🌯 [9468, 234, 107]
N: �👨🏾‍� [101, 9468, 239, 101, 9468, 237, 122, 102470, 9468, 236]

O: ⛹🏽‍♂ [158, 249, 117, 9468, 237, 121, 102470, 17245, 224]
N: �🧑🏾‍🦼‍� [94, 9468, 100, 239, 9468, 237, 122, 102470, 9468, 99, 120, 102470, 98115]

O: 🛏 [9468, 249, 237]
N: �⛹🏽‍� [224, 158, 249, 117, 9468, 237, 121, 102470, 17245]

O: 🔆 [9468, 242, 228]
N: �� [237, 9468, 249]

O: 💡 [93273, 94]
N: ️🏃🏽‍♀️‍➡ [31643, 9468, 237, 225, 9468, 237, 121, 102470, 32990, 31643, 102470, 98115, 94]

O: 🧑🏾‍🦼‍➡ [9468, 100, 239, 9468, 237, 122, 102470, 9468, 99, 120, 102470, 98115, 94]
N: �👨🏽‍❤‍💋‍👨� [120, 9468, 239, 101, 9468, 237, 121, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237]

O: 👨🏾‍🎨 [9468, 239, 101, 9468, 237, 122, 102470, 9468, 236, 101]
N: �� [107, 9468, 234]

O: 👨🏽‍❤‍💋‍👨🏼 [9468, 239, 101, 9468, 237, 121, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 120]
N: �� [94, 93273]

O: 🧘🏾‍♀️ [9468, 100, 246, 9468, 237, 122, 102470, 32990, 31643]
N: ️🧘🏾‍♀ [31643, 9468, 100, 246, 9468, 237, 122, 102470, 32990]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.53s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:03,  3.96s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  2.57s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  3.22s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (4, 6, 7, 8):   1%|          | 1/100 [00:34<32:56, 19.97s/it]2025-01-22 04:16:55.220 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the kitchen.
2025-01-22 04:16:55.238 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3608, 3613) -->  Hon. Sandra moved to
2025-01-22 04:16:55.238 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the garden.
2025-01-22 04:16:55.262 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4721, 4727) --> . Sandra went back to the
2025-01-22 04:16:55.262 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra discarded the apple.
2025-01-22 04:16:55.288 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5603, 5607) -->  Sandra discarded the apple
2025-01-22 04:16:55.288 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the hallway.
2025-01-22 04:16:55.321 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6507, 6513) --> . Daniel journeyed to the
2025-01-22 04:16:55.321 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John grabbed the football.
2025-01-22 04:16:55.336 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3093, 3097) -->  John grabbed the football
2025-01-22 04:16:55.336 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went to the kitchen.
2025-01-22 04:16:55.362 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5222, 5227) --> . John went to the
2025-01-22 04:16:55.362 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the bathroom.
2025-01-22 04:16:55.375 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2525, 2531) --> . Daniel went back to the
2025-01-22 04:16:55.375 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the bedroom.
2025-01-22 04:16:55.408 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6670, 6676) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:16:58.723 | INFO     | test_jbb_embedding:begin_test:693 - Discarded<|eot_id|>
2025-01-22 04:16:58.723 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8155])
2025-01-22 04:17:02.014 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [449.0729166666667, 34.96276277886737, 182.65178571428572, 33.50911779201577, 24.422757056451612], 'topk_indices': array([8141, 5604, 8136, 3609, 8139, 4728, 3611, 5607, 8144, 8140, 8137,
       8138, 8153, 8142, 8146, 8145, 8143,    0, 8150, 8151]), 'topk_tokens': [' the', ' discarded', '.\n\n', '.', ' Where', '.', ' moved', '.', ' the', ' was', 'Question', ':', '<|end_header_id|>', ' apple', '?', ' garden', ' before', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [739.7, 428.3333333333333, 665.625, 83.25520833333333]}, 'weight': {'score': [24.026041666666668, 23.26502742706546, 21.352306547619047, 23.268007446710204, 29.327116935483872], 'topk_indices': array([3253, 3280, 3125, 3173, 7384, 7422, 1415, 1477, 4306, 4290, 5128,
       5189, 7161, 7105, 3454, 3480, 4982, 4930, 4905, 4953]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [25.8484375, 21.869791666666668, 30.615234375, 20.270833333333332]}, 'saliency': {'score': [2.964779808407738, 0.19157309040014403, 1.0330694289434523, 0.18222011304829966, 0.18349186066658266], 'topk_indices': array([3599, 8148, 4727, 8136, 8138, 5603, 8009, 2531, 8053, 8140, 5606,
       8139, 3611, 3610, 8146, 5604, 8137, 8142, 8143, 8145]), 'topk_tokens': [' Among', 'Answer', ' garden', '.\n\n', ':', ' Sandra', ' context', ' bathroom', ' location', ' was', ' apple', ' Where', ' moved', ' Sandra', '?', ' discarded', 'Question', ' apple', ' before', ' garden'], 'evidence_proportions': [4.7822265625, 2.35205078125, 5.360595703125, 0.46575927734375]}}, 'pred_res': 'Discarded<|eot_id|>', 'score': 0}
2025-01-22 04:17:02.022 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:17:02.022 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-20_pid-1_4-6-7-8.pkl | len: 3 |  size: 2.01 KB
Processing depth (4, 6, 7, 8):   2%|▏         | 2/100 [00:41<34:06, 20.88s/it]is_0k: False
your chose emoji: ['😂', '🧎🏼\u200d➡', '🇧🇾', '🩰', '✔', '🤵🏿\u200d♂', '🧎🏽', '🧜🏼\u200d♂', '🚣🏻\u200d♀', '🤹🏼\u200d♂']
emoji:
O: 😂 [76460, 224]
N: 🧎🏽 [9468, 100, 236, 9468, 237, 121]

O: 🧎🏼‍➡ [9468, 100, 236, 9468, 237, 120, 102470, 98115, 94]
N: 😂 [76460, 224]

O: 🇧🇾 [9468, 229, 100, 9468, 229, 122]
N: 🤵🏿‍♂ [9468, 97, 113, 9468, 237, 123, 102470, 17245, 224]

O: 🩰 [9468, 102, 108]
N: 🧜🏼‍♂ [9468, 100, 250, 9468, 237, 120, 102470, 17245, 224]

O: ✔ [75351]
N: 🚣🏻‍♀ [9468, 248, 96, 9468, 237, 119, 102470, 32990]

O: 🤵🏿‍♂ [9468, 97, 113, 9468, 237, 123, 102470, 17245, 224]
N: 🧎🏼‍➡ [9468, 100, 236, 9468, 237, 120, 102470, 98115, 94]

O: 🧎🏽 [9468, 100, 236, 9468, 237, 121]
N: ✔ [75351]

O: 🧜🏼‍♂ [9468, 100, 250, 9468, 237, 120, 102470, 17245, 224]
N: 🩰 [9468, 102, 108]

O: 🚣🏻‍♀ [9468, 248, 96, 9468, 237, 119, 102470, 32990]
N: 🇧🇾 [9468, 229, 100, 9468, 229, 122]

O: 🤹🏼‍♂ [9468, 97, 117, 9468, 237, 120, 102470, 17245, 224]
N: 🤹🏼‍♂ [9468, 97, 117, 9468, 237, 120, 102470, 17245, 224]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:05<00:15,  5.17s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:10<00:09,  4.98s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.42s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.08s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.70s/it]
Processing depth (1, 3, 5, 9):   2%|▏         | 2/100 [00:58<34:06, 20.88s/it]2025-01-22 04:17:18.628 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the kitchen.
2025-01-22 04:17:18.632 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (829, 834) --> . Sandra moved to the
2025-01-22 04:17:18.632 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the garden.
2025-01-22 04:17:18.648 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2858, 2864) --> . Sandra went back to the
2025-01-22 04:17:18.648 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra discarded the apple.
2025-01-22 04:17:18.668 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4175, 4179) -->  Sandra discarded the apple
2025-01-22 04:17:18.668 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the hallway.
2025-01-22 04:17:18.704 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7137, 7143) -->  Daniel journeyed to the hallway
2025-01-22 04:17:18.704 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John grabbed the football.
2025-01-22 04:17:18.720 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3042, 3046) -->  John grabbed the football
2025-01-22 04:17:18.720 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went to the kitchen.
2025-01-22 04:17:18.746 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5261, 5266) --> . John went to the
2025-01-22 04:17:18.746 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the bathroom.
2025-01-22 04:17:18.759 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2531, 2537) --> . Daniel went back to the
2025-01-22 04:17:18.759 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the bedroom.
2025-01-22 04:17:18.797 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6723, 6729) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:17:19.574 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 04:17:19.574 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8175])
2025-01-22 04:17:21.781 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [125.51488095238095, 10.304945432868672, 41.01971726190476, 9.92829611449115, 10.64267306857639], 'topk_indices': array([ 834, 4178, 8073, 8174,  831,   28,  830, 8028, 8158,    1, 8165,
         24,    3, 8169,   14, 8163, 8029,    0, 8173, 8170]), 'topk_tokens': [' kitchen', ' apple', ' location', '\n\n', ' moved', '<|end_header_id|>', ' Sandra', ' you', ':', '<|start_header_id|>', ' garden', '\n\n', '<|end_header_id|>', ':', '\n', ' before', ' context', '<|begin_of_text|>', '<|end_header_id|>', '<|eot_id|>'], 'evidence_proportions': [234.95, 83.47395833333333, 183.671875, 37.588541666666664]}, 'weight': {'score': [24.332589285714285, 23.29254937026168, 21.352306547619047, 23.294872902839234, 30.048177083333332], 'topk_indices': array([3349, 3322, 3242, 3194, 7466, 7428, 1495, 1433, 4372, 4356, 5167,
       5228, 7205, 7149, 3505, 3531, 4969, 5021, 4992, 4944]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.040625, 21.869791666666668, 30.615234375, 25.350260416666668]}, 'saliency': {'score': [0.8109654017857143, 0.05741470348109066, 0.23814319428943453, 0.05500321589857193, 0.07830323113335504], 'topk_indices': array([  23,   20, 8159, 4182,   24, 8027, 8144, 8028, 8073, 8168, 8157,
       8162, 4178,  831,  834, 4176, 8165, 8163,  830, 8029]), 'topk_tokens': ['4', ' Jul', ' Where', '�', '\n\n', ' provided', ' return', ' you', ' location', 'Answer', 'Question', ' apple', ' apple', ' moved', ' kitchen', ' discarded', ' garden', ' before', ' Sandra', ' context'], 'evidence_proportions': [1.3630859375, 0.4785359700520833, 1.466064453125, 0.24656168619791666]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 100}
2025-01-22 04:17:21.788 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:17:21.789 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-20_pid-2_1-3-5-9.pkl | len: 3 |  size: 2.05 KB
Processing depth (1, 3, 5, 9):   3%|▎         | 3/100 [01:01<32:56, 20.37s/it]is_0k: False
your chose emoji: ['🧖🏽', '👨\u200d🦼\u200d➡️', '💂🏾\u200d♀️', '🗑️', '🏃🏻\u200d♀️\u200d➡️', '👨', '💁\u200d♀️', '🧑🏽\u200d🦽', '🧙🏻\u200d♂', '🪔']
emoji:
O: 🧖🏽 [9468, 100, 244, 9468, 237, 121]
N: 🧑🏽‍🦽 [9468, 100, 239, 9468, 237, 121, 102470, 9468, 99, 121]

O: 👨‍🦼‍➡️ [9468, 239, 101, 102470, 9468, 99, 120, 102470, 98115, 94, 31643]
N: 🗑️ [9468, 245, 239, 31643]

O: 💂🏾‍♀️ [93273, 224, 9468, 237, 122, 102470, 32990, 31643]
N: 🧙🏻‍♂ [9468, 100, 247, 9468, 237, 119, 102470, 17245, 224]

O: 🗑️ [9468, 245, 239, 31643]
N: 🏃🏻‍♀️‍➡️ [9468, 237, 225, 9468, 237, 119, 102470, 32990, 31643, 102470, 98115, 94, 31643]

O: 🏃🏻‍♀️‍➡️ [9468, 237, 225, 9468, 237, 119, 102470, 32990, 31643, 102470, 98115, 94, 31643]
N: 👨‍🦼‍➡️ [9468, 239, 101, 102470, 9468, 99, 120, 102470, 98115, 94, 31643]

O: 👨 [9468, 239, 101]
N: 💂🏾‍♀️ [93273, 224, 9468, 237, 122, 102470, 32990, 31643]

O: 💁‍♀️ [93273, 223, 102470, 32990, 31643]
N: 🧖🏽 [9468, 100, 244, 9468, 237, 121]

O: 🧑🏽‍🦽 [9468, 100, 239, 9468, 237, 121, 102470, 9468, 99, 121]
N: 💁‍♀️ [93273, 223, 102470, 32990, 31643]

O: 🧙🏻‍♂ [9468, 100, 247, 9468, 237, 119, 102470, 17245, 224]
N: 👨 [9468, 239, 101]

O: 🪔 [9468, 103, 242]
N: 🪔 [9468, 103, 242]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.42s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.89s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.68s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.25s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.78s/it]
Processing depth (1, 3, 4, 9):   3%|▎         | 3/100 [01:18<32:56, 20.37s/it]2025-01-22 04:17:38.690 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the kitchen.
2025-01-22 04:17:38.694 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (822, 827) -->  Sandra moved to the kitchen
2025-01-22 04:17:38.694 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the garden.
2025-01-22 04:17:38.713 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2973, 2979) -->  tragedy. Sandra went back to
2025-01-22 04:17:38.713 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra discarded the apple.
2025-01-22 04:17:38.732 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3628, 3632) -->  discarded the apple.
2025-01-22 04:17:38.732 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the hallway.
2025-01-22 04:17:38.772 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7228, 7234) --> . Daniel journeyed to the
2025-01-22 04:17:38.772 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John grabbed the football.
2025-01-22 04:17:38.787 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3123, 3127) -->  grabbed the football.
2025-01-22 04:17:38.787 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went to the kitchen.
2025-01-22 04:17:38.815 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5337, 5342) --> . John went to the
2025-01-22 04:17:38.815 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the bathroom.
2025-01-22 04:17:38.829 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2677, 2683) --> . Daniel went back to the
2025-01-22 04:17:38.830 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the bedroom.
2025-01-22 04:17:38.867 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6707, 6713) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:17:39.683 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 04:17:39.683 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8179])
2025-01-22 04:17:41.913 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [256.20238095238096, 19.487732217061843, 104.93675595238095, 18.656597435503684, 40.58588471283784], 'topk_indices': array([   1, 8067, 8170, 3631, 3621,   24, 8169, 8162, 3628, 3622,   14,
       8166, 3630, 3623, 8033, 8167, 8177,    0, 8174, 8175]), 'topk_tokens': ['<|start_header_id|>', '.\n\n', '?', '.', '�', '\n\n', ' garden', ':', ' discarded', '�', '\n', ' apple', ' apple', '�', ' context', ' before', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [352.8, 179.734375, 550.4375, 56.015625]}, 'weight': {'score': [23.970982142857142, 23.282120813981912, 20.433035714285715, 23.287693872850124, 29.2890625], 'topk_indices': array([3282, 3309, 3202, 3154, 7414, 7452, 1479, 1417, 4316, 4300, 5192,
       5131, 7122, 7178, 3465, 3491, 4908, 4956, 4933, 4985]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [25.8296875, 26.709635416666668, 23.08984375, 20.270833333333332]}, 'saliency': {'score': [1.6571568080357142, 0.10804071568591879, 0.5550319126674107, 0.10289105314587492, 0.28854122677364863], 'topk_indices': array([8172,   24, 8170, 8032, 2980,  810,  823,  822,  826, 3622, 8161,
       3627, 8169, 3621, 3623, 8166, 8167, 8033, 3628, 3630]), 'topk_tokens': ['Answer', '\n\n', '?', ' you', ' garden', '�', ' moved', ' Sandra', ' kitchen', '�', 'Question', ' Sandra', ' garden', '�', '�', ' apple', ' before', ' context', ' discarded', ' apple'], 'evidence_proportions': [2.42861328125, 1.1400960286458333, 3.49169921875, 0.3083089192708333]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 100}
2025-01-22 04:17:41.917 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:17:41.917 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-20_pid-3_1-3-4-9.pkl | len: 3 |  size: 2.02 KB
Processing depth (1, 3, 4, 9):   4%|▍         | 4/100 [01:21<32:26, 20.28s/it]is_0k: False
your chose emoji: ['🦫', '🧛🏾\u200d♀', '👴🏿', '🇦🇿', '🦹🏽\u200d♂️', '👯\u200d♂', '🚯', '👨🏾\u200d🦽', '👩🏻\u200d🔬', '🚶🏿\u200d♀️\u200d➡']
emoji:
O: 🦫 [9468, 99, 104]
N: 🇦🇿 [9468, 229, 99, 9468, 229, 123]

O: 🧛🏾‍♀ [9468, 100, 249, 9468, 237, 122, 102470, 32990]
N: 👩🏻‍🔬 [9468, 239, 102, 9468, 237, 119, 102470, 9468, 242, 105]

O: 👴🏿 [9468, 239, 112, 9468, 237, 123]
N: 🦫 [9468, 99, 104]

O: 🇦🇿 [9468, 229, 99, 9468, 229, 123]
N: 🧛🏾‍♀ [9468, 100, 249, 9468, 237, 122, 102470, 32990]

O: 🦹🏽‍♂️ [9468, 99, 117, 9468, 237, 121, 102470, 17245, 224, 31643]
N: 👯‍♂ [9468, 239, 107, 102470, 17245, 224]

O: 👯‍♂ [9468, 239, 107, 102470, 17245, 224]
N: 👨🏾‍🦽 [9468, 239, 101, 9468, 237, 122, 102470, 9468, 99, 121]

O: 🚯 [9468, 248, 107]
N: 🦹🏽‍♂️ [9468, 99, 117, 9468, 237, 121, 102470, 17245, 224, 31643]

O: 👨🏾‍🦽 [9468, 239, 101, 9468, 237, 122, 102470, 9468, 99, 121]
N: 👴🏿 [9468, 239, 112, 9468, 237, 123]

O: 👩🏻‍🔬 [9468, 239, 102, 9468, 237, 119, 102470, 9468, 242, 105]
N: 🚯 [9468, 248, 107]

O: 🚶🏿‍♀️‍➡ [9468, 248, 114, 9468, 237, 123, 102470, 32990, 31643, 102470, 98115, 94]
N: 🚶🏿‍♀️‍➡ [9468, 248, 114, 9468, 237, 123, 102470, 32990, 31643, 102470, 98115, 94]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.42s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.73s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.43s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.11s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.63s/it]
Processing depth (0, 2, 6, 8):   4%|▍         | 4/100 [01:37<32:26, 20.28s/it]2025-01-22 04:17:58.149 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the kitchen.
2025-01-22 04:17:58.149 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (32, 37) -->  moved to the kitchen.
2025-01-22 04:17:58.149 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the garden.
2025-01-22 04:17:58.160 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1804, 1810) --> . Sandra went back to the
2025-01-22 04:17:58.160 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra discarded the apple.
2025-01-22 04:17:58.184 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4774, 4778) -->  Sandra discarded the apple
2025-01-22 04:17:58.184 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the hallway.
2025-01-22 04:17:58.222 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6604, 6610) --> . Daniel journeyed to the
2025-01-22 04:17:58.223 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John grabbed the football.
2025-01-22 04:17:58.240 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3125, 3129) -->  John grabbed the football
2025-01-22 04:17:58.240 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went to the kitchen.
2025-01-22 04:17:58.270 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5332, 5337) --> . John went to the
2025-01-22 04:17:58.270 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the bathroom.
2025-01-22 04:17:58.284 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2557, 2563) --> . Daniel went back to the
2025-01-22 04:17:58.284 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the bedroom.
2025-01-22 04:17:58.321 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6701, 6707) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:17:59.120 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 04:17:59.120 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8180])
2025-01-22 04:18:01.379 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [180.8422619047619, 16.872853782231456, 58.194940476190474, 16.34329704581747, 11.595280827702704], 'topk_indices': array([ 700,   23,   33, 8176, 1739,   29, 1661,   35,    1,   32,   24,
         14,   36,  549, 1662, 1740,   28, 8178, 8175,    0]), 'topk_tokens': [' stere', '4', ' to', '<|start_header_id|>', ' summer', '\n\n', "'s", ' kitchen', '<|start_header_id|>', ' moved', '\n\n', '\n', '.', ' instead', ' work', "'s", '<|end_header_id|>', '<|end_header_id|>', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [392.775, 141.97916666666666, 204.4375, 27.364583333333332]}, 'weight': {'score': [22.588169642857142, 23.28996280398387, 21.352306547619047, 23.296771357941285, 29.77005912162162], 'topk_indices': array([3285, 3312, 3205, 3157, 7401, 7439, 1440, 1502, 4304, 4288, 5187,
       5126, 7104, 7160, 3468, 3494, 4928, 4903, 4980, 4951]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.809375, 21.869791666666668, 30.615234375, 20.270833333333332]}, 'saliency': {'score': [1.0788138253348214, 0.09400480667332427, 0.3088873000372024, 0.09091015960877043, 0.08637567468591638], 'topk_indices': array([8167,  432,   20, 1805, 4777, 1810,   24, 1661, 4775, 8168, 1660,
       8170,   31, 1740, 1739,  700,   35, 1662,   32,  549]), 'topk_tokens': [' apple', ' instead', ' Jul', ' Sandra', ' apple', ' garden', '\n\n', "'s", ' discarded', ' before', ' summer', ' garden', 'andra', "'s", ' summer', ' stere', ' kitchen', ' work', ' moved', ' instead'], 'evidence_proportions': [2.0103515625, 0.864013671875, 1.6292724609375, 0.150360107421875]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 100}
2025-01-22 04:18:01.392 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:18:01.392 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-20_pid-4_0-2-6-8.pkl | len: 3 |  size: 2.04 KB
Processing depth (0, 2, 6, 8):   5%|▌         | 5/100 [01:40<31:38, 19.99s/it]Processing depth (0, 2, 6, 8):   5%|▌         | 5/100 [01:40<31:58, 20.19s/it]
2025-01-22 04:18:01.480 | INFO     | __main__:<module>:82 - Selected idx: 21
2025-01-22 04:18:01.480 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the location prior to the place where the milk was discarded, left or dropped?
2025-01-22 04:18:01.480 | INFO     | __main__:<module>:84 - Answer: kitchen
2025-01-22 04:18:01.480 | INFO     | __main__:<module>:85 - Tag: 4-hop
2025-01-22 04:18:01.480 | INFO     | __main__:<module>:86 - Needle: [' John went to the kitchen.', ' John grabbed the football.', ' Sandra moved to the kitchen.', ' Sandra grabbed the milk.', ' Daniel went back to the bathroom.', ' John went back to the bedroom.', ' Sandra went back to the garden.', ' Sandra discarded the milk.', ' Daniel journeyed to the hallway.']
2025-01-22 04:18:01.480 | INFO     | __main__:<module>:87 - Real Needle: [' Sandra moved to the kitchen.', ' Sandra grabbed the milk.', ' Sandra went back to the garden.', ' Sandra discarded the milk.', ' Daniel journeyed to the hallway.']
2025-01-22 04:18:01.480 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['👨🏻\u200d💻', '🎺', '🏋️\u200d♂️', '🧗🏽\u200d♀', '👉🏿', '🖇', '🥉', '🤹🏼\u200d♂', '🧛🏽', '👩🏾\u200d❤️\u200d💋\u200d👨🏻']
emoji:
O: 👨🏻‍💻 [9468, 239, 101, 9468, 237, 119, 102470, 93273, 119]
N: ♀🧗🏽‍ [32990, 9468, 100, 245, 9468, 237, 121, 102470]

O: 🎺 [9468, 236, 118]
N: �🤹🏼‍� [224, 9468, 97, 117, 9468, 237, 120, 102470, 17245]

O: 🏋️‍♂️ [9468, 237, 233, 31643, 102470, 17245, 224, 31643]
N: �👨🏻‍� [119, 9468, 239, 101, 9468, 237, 119, 102470, 93273]

O: 🧗🏽‍♀ [9468, 100, 245, 9468, 237, 121, 102470, 32990]
N: �� [229, 9468, 244]

O: 👉🏿 [9468, 239, 231, 9468, 237, 123]
N: ️🏋️‍♂ [31643, 9468, 237, 233, 31643, 102470, 17245, 224]

O: 🖇 [9468, 244, 229]
N: �� [118, 9468, 236]

O: 🥉 [9468, 98, 231]
N: �👉� [123, 9468, 239, 231, 9468, 237]

O: 🤹🏼‍♂ [9468, 97, 117, 9468, 237, 120, 102470, 17245, 224]
N: �� [231, 9468, 98]

O: 🧛🏽 [9468, 100, 249, 9468, 237, 121]
N: �🧛� [121, 9468, 100, 249, 9468, 237]

O: 👩🏾‍❤️‍💋‍👨🏻 [9468, 239, 102, 9468, 237, 122, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 119]
N: �👩🏾‍❤️‍💋‍👨� [119, 9468, 239, 102, 9468, 237, 122, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.77s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.45s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.12s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.68s/it]
Processing depth (0, 2, 3, 5, 6):   0%|          | 0/100 [00:16<?, ?it/s]2025-01-22 04:18:18.014 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the kitchen.
2025-01-22 04:18:18.014 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (32, 37) -->  moved to the kitchen.
2025-01-22 04:18:18.014 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra grabbed the milk.
2025-01-22 04:18:18.024 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1759, 1763) -->  Sandra grabbed the milk
2025-01-22 04:18:18.024 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the garden.
2025-01-22 04:18:18.041 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2897, 2903) --> . Sandra went back to the
2025-01-22 04:18:18.041 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra discarded the milk.
2025-01-22 04:18:18.062 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4160, 4164) -->  Sandra discarded the milk
2025-01-22 04:18:18.063 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel journeyed to the hallway.
2025-01-22 04:18:18.089 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4726, 4732) --> . Daniel journeyed to the
2025-01-22 04:18:18.089 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went to the kitchen.
2025-01-22 04:18:18.095 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1139, 1144) --> . John went to the
2025-01-22 04:18:18.095 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John grabbed the football.
2025-01-22 04:18:18.115 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3651, 3655) -->  John grabbed the football
2025-01-22 04:18:18.115 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the bathroom.
2025-01-22 04:18:18.118 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (362, 368) --> . Daniel went back to the
2025-01-22 04:18:18.118 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the bedroom.
2025-01-22 04:18:18.127 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1593, 1599) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:18:18.897 | INFO     | test_jbb_embedding:begin_test:693 - the garden<|eot_id|>
2025-01-22 04:18:18.897 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8168])
2025-01-22 04:18:21.101 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [223.1425, 24.372215763064496, 148.6577380952381, 23.439384615384615, 37.82335425204918], 'topk_indices': array([8158, 8167,    4, 8155,  332, 8047,  408, 8166,   36, 8057,   24,
         29,   35, 2718,   32,   14,  537, 8164, 8163,    0]), 'topk_tokens': [' or', '\n\n', '\n\n', ' discarded', ' century', '.\n\n', 'ing', '<|end_header_id|>', '.', ' location', '\n\n', '\n\n', ' kitchen', "'s", ' moved', '\n', ' an', '<|start_header_id|>', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [475.1, 288.9375, 171.46875, 203.03125, 34.395833333333336]}, 'weight': {'score': [23.71125, 23.256973978093257, 21.352306547619047, 23.26049903846154, 28.921875], 'topk_indices': array([3327, 3300, 3172, 3220, 7396, 7434, 1449, 1511, 4317, 4301, 5198,
       5137, 7173, 7117, 3483, 3509, 4933, 4956, 4908, 4985]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.809375, 29.677734375, 21.869791666666668, 30.544921875, 20.270833333333332]}, 'saliency': {'score': [1.41313720703125, 0.13771183554070798, 0.7965146019345238, 0.13208469801682693, 0.2704888015496926], 'topk_indices': array([2642, 2718,   64,  360, 1759, 8147, 1599, 8161, 1762,  524, 1144,
         31,  332,  368,  537, 8057, 2717, 8155,   32,   35]), 'topk_tokens': [' clerk', "'s", 'ISC', ' past', ' Sandra', ' prior', ' bedroom', 'Answer', ' milk', 'fect', ' kitchen', 'andra', ' century', ' bathroom', ' an', ' location', ' clerk', ' discarded', ' moved', ' kitchen'], 'evidence_proportions': [2.5505859375, 2.28485107421875, 0.9837646484375, 1.608642578125, 0.18315633138020834]}}, 'pred_res': 'the garden<|eot_id|>', 'score': 0}
2025-01-22 04:18:21.108 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:18:21.108 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-21_pid-0_0-2-3-5-6.pkl | len: 3 |  size: 2.07 KB
Processing depth (0, 2, 3, 5, 6):   1%|          | 1/100 [00:19<32:12, 19.52s/it]is_0k: False
your chose emoji: ['👳🏽', '🇷🇸', '🕵🏼', '🤌', '🐢', '🚣🏼\u200d♂', '🙁', '👩🏼\u200d⚖️', '🛏', '🧎🏼\u200d♀\u200d➡']
emoji:
O: 👳🏽 [9468, 239, 111, 9468, 237, 121]
N: �🚣🏼‍� [224, 9468, 248, 96, 9468, 237, 120, 102470, 17245]

O: 🇷🇸 [9468, 229, 115, 9468, 229, 116]
N: �� [237, 9468, 249]

O: 🕵🏼 [9468, 243, 113, 9468, 237, 120]
N: �� [234, 9468, 97]

O: 🤌 [9468, 97, 234]
N: �� [95, 9468, 238]

O: 🐢 [9468, 238, 95]
N: �🇷� [116, 9468, 229, 115, 9468, 229]

O: 🚣🏼‍♂ [9468, 248, 96, 9468, 237, 120, 102470, 17245, 224]
N: �🕵� [120, 9468, 243, 113, 9468, 237]

O: 🙁 [9468, 247, 223]
N: �� [223, 9468, 247]

O: 👩🏼‍⚖️ [9468, 239, 102, 9468, 237, 120, 102470, 158, 248, 244, 31643]
N: ️👩🏼‍⚖ [31643, 9468, 239, 102, 9468, 237, 120, 102470, 158, 248, 244]

O: 🛏 [9468, 249, 237]
N: �👳� [121, 9468, 239, 111, 9468, 237]

O: 🧎🏼‍♀‍➡ [9468, 100, 236, 9468, 237, 120, 102470, 32990, 102470, 98115, 94]
N: �🧎🏼‍♀‍� [94, 9468, 100, 236, 9468, 237, 120, 102470, 32990, 102470, 98115]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.53s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.91s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.63s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.23s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.77s/it]
Processing depth (0, 4, 5, 7, 9):   1%|          | 1/100 [00:36<32:12, 19.52s/it]2025-01-22 04:18:37.840 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the kitchen.
2025-01-22 04:18:37.840 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (32, 37) -->  moved to the kitchen.
2025-01-22 04:18:37.840 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra grabbed the milk.
2025-01-22 04:18:37.858 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3591, 3595) -->  Sandra grabbed the milk
2025-01-22 04:18:37.858 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the garden.
2025-01-22 04:18:37.882 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4123, 4129) -->  Sandra went back to the garden
2025-01-22 04:18:37.882 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra discarded the milk.
2025-01-22 04:18:37.910 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5588, 5592) -->  Sandra discarded the milk
2025-01-22 04:18:37.910 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel journeyed to the hallway.
2025-01-22 04:18:37.947 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7143, 7149) -->  Daniel journeyed to the hallway
2025-01-22 04:18:37.948 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went to the kitchen.
2025-01-22 04:18:37.955 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1262, 1267) -->  Republican. John went to
2025-01-22 04:18:37.955 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John grabbed the football.
2025-01-22 04:18:37.974 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3670, 3674) -->  John grabbed the football
2025-01-22 04:18:37.974 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the bathroom.
2025-01-22 04:18:37.976 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (362, 368) --> . Daniel went back to the
2025-01-22 04:18:37.976 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the bedroom.
2025-01-22 04:18:37.985 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1755, 1761) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:18:38.764 | INFO     | test_jbb_embedding:begin_test:693 - the garden<|eot_id|>
2025-01-22 04:18:38.764 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8196])
2025-01-22 04:18:41.034 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [279.14, 32.938830192706426, 155.5, 31.868204188642217, 30.820390625], 'topk_indices': array([8170, 8083,   32, 3595,  438,  555,   24, 8084, 8041, 8176,  547,
        554, 8115, 8075,   14,  556, 8085, 8191, 8192,    0]), 'topk_tokens': [':', ' the', ' moved', '.', 's', 's', '\n\n', ' first', ' context', ' to', ',', ' em', ' the', '.\n\n', '\n', ' per', ' location', '<|eot_id|>', '<|start_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [458.0, 367.4375, 275.4166666666667, 274.28125, 78.1875]}, 'weight': {'score': [25.833125, 23.281385306134894, 22.50595238095238, 23.275558076781554, 29.19875], 'topk_indices': array([3326, 3353, 3246, 3198, 7434, 7472, 1515, 1453, 4356, 4340, 5169,
       5230, 7211, 7155, 3509, 3535, 5023, 4946, 4994, 4971]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.809375, 29.677734375, 25.631510416666668, 30.544921875, 25.350260416666668]}, 'saliency': {'score': [1.8438525390625, 0.1836627281385306, 0.8769763764880952, 0.17678620024837483, 0.2176910400390625], 'topk_indices': array([ 368, 8169, 4128, 8113,   31,   64, 5589, 8075, 3594, 8183, 1268,
       8175, 8189, 8084,   32,   35, 8041,  554,  556, 8085]), 'topk_tokens': [' bathroom', 'Question', ' garden', ' moved', 'andra', 'ISC', ' discarded', '.\n\n', ' milk', ' discarded', ' kitchen', ' prior', 'Answer', ' first', ' moved', ' kitchen', ' context', ' em', ' per', ' location'], 'evidence_proportions': [2.418359375, 2.8077392578125, 1.745361328125, 2.23974609375, 0.55706787109375]}}, 'pred_res': 'the garden<|eot_id|>', 'score': 0}
2025-01-22 04:18:41.050 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:18:41.051 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-21_pid-1_0-4-5-7-9.pkl | len: 3 |  size: 2.05 KB
Processing depth (0, 4, 5, 7, 9):   2%|▏         | 2/100 [00:39<32:17, 19.77s/it]is_0k: False
your chose emoji: ['🇪🇪', '🚏', '🧑🏾\u200d🦯\u200d➡️', '💁🏼', '🤾🏾\u200d♂', '👩🏿\u200d⚖️', '⛹🏼\u200d♀️', '🏌🏾', '🇵🇭', '👼🏼']
emoji:
O: 🇪🇪 [9468, 229, 103, 9468, 229, 103]
N: ️👩🏿‍⚖ [31643, 9468, 239, 102, 9468, 237, 123, 102470, 158, 248, 244]

O: 🚏 [9468, 248, 237]
N: �🇪� [103, 9468, 229, 103, 9468, 229]

O: 🧑🏾‍🦯‍➡️ [9468, 100, 239, 9468, 237, 122, 102470, 9468, 99, 107, 102470, 98115, 94, 31643]
N: �🏌� [122, 9468, 237, 234, 9468, 237]

O: 💁🏼 [93273, 223, 9468, 237, 120]
N: �💁� [120, 93273, 223, 9468, 237]

O: 🤾🏾‍♂ [9468, 97, 122, 9468, 237, 122, 102470, 17245, 224]
N: �🤾🏾‍� [224, 9468, 97, 122, 9468, 237, 122, 102470, 17245]

O: 👩🏿‍⚖️ [9468, 239, 102, 9468, 237, 123, 102470, 158, 248, 244, 31643]
N: �🇵� [255, 9468, 229, 113, 9468, 229]

O: ⛹🏼‍♀️ [158, 249, 117, 9468, 237, 120, 102470, 32990, 31643]
N: �� [237, 9468, 248]

O: 🏌🏾 [9468, 237, 234, 9468, 237, 122]
N: ️⛹🏼‍♀ [31643, 158, 249, 117, 9468, 237, 120, 102470, 32990]

O: 🇵🇭 [9468, 229, 113, 9468, 229, 255]
N: ️🧑🏾‍🦯‍➡ [31643, 9468, 100, 239, 9468, 237, 122, 102470, 9468, 99, 107, 102470, 98115, 94]

O: 👼🏼 [9468, 239, 120, 9468, 237, 120]
N: �👼� [120, 9468, 239, 120, 9468, 237]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.02s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:09,  4.55s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.16s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.70s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.28s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (3, 4, 6, 7, 9):   2%|▏         | 2/100 [00:54<32:17, 19.77s/it]2025-01-22 04:18:55.918 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the kitchen.
2025-01-22 04:18:55.932 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2907, 2912) --> . Sandra moved to the
2025-01-22 04:18:55.932 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra grabbed the milk.
2025-01-22 04:18:55.950 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3642, 3646) -->  Sandra grabbed the milk
2025-01-22 04:18:55.950 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the garden.
2025-01-22 04:18:55.980 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4879, 4885) --> . Sandra went back to the
2025-01-22 04:18:55.981 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra discarded the milk.
2025-01-22 04:18:56.009 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5693, 5697) -->  Sandra discarded the milk
2025-01-22 04:18:56.009 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel journeyed to the hallway.
2025-01-22 04:18:56.057 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7328, 7334) -->  cold. Daniel journeyed to
2025-01-22 04:18:56.058 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went to the kitchen.
2025-01-22 04:18:56.064 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1253, 1258) -->  Republican. John went to
2025-01-22 04:18:56.064 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John grabbed the football.
2025-01-22 04:18:56.084 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3775, 3779) -->  John grabbed the football
2025-01-22 04:18:56.084 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the bathroom.
2025-01-22 04:18:56.086 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (310, 316) -->  Daniel went back to the bathroom
2025-01-22 04:18:56.086 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the bedroom.
2025-01-22 04:18:56.094 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1746, 1752) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:18:59.568 | INFO     | test_jbb_embedding:begin_test:693 - the kitchen<|eot_id|>
2025-01-22 04:18:59.568 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8257])
2025-01-22 04:19:03.044 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [82.3271875, 9.114161811440677, 56.752232142857146, 8.769539810080351, 9.483831441627359], 'topk_indices': array([8217, 8249, 8221, 8230, 2912, 8251,    4, 8231,   23, 8102,   24,
       8229,    9, 8136, 8256,   14, 8255, 8252,    0, 8253]), 'topk_tokens': [' return', '?\n', '.', 'Question', ' kitchen', ':', '\n\n', ':', '4', ' context', '\n\n', '.\n\n', ':', '.\n\n', '\n\n', '\n', '<|end_header_id|>', '<|eot_id|>', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [114.8, 120.046875, 69.53645833333333, 111.09375, 23.733072916666668]}, 'weight': {'score': [24.7615625, 23.33631582929782, 23.860491071428573, 23.330637859142925, 29.57532429245283], 'topk_indices': array([3330, 3303, 3223, 3175, 7451, 7489, 1444, 1506, 4312, 4328, 5237,
       5176, 7221, 7165, 3486, 3512, 5030, 5001, 4919, 4944]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.040625, 29.677734375, 21.869791666666668, 30.544921875, 23.62109375]}, 'saliency': {'score': [0.55291748046875, 0.05046790540939959, 0.3594447544642857, 0.04814872435185925, 0.07120380761488429], 'topk_indices': array([3645,   24,    8, 8236, 8217, 8242,   23, 8229,   20, 8136, 8254,
       2908, 8256, 8250,  315, 5694, 8244, 2912, 8230, 8102]), 'topk_tokens': [' milk', '\n\n', ' Date', ' prior', ' return', ' milk', '4', '.\n\n', ' Jul', '.\n\n', 'assistant', ' Sandra', '\n\n', 'Answer', ' bathroom', ' discarded', ' discarded', ' kitchen', 'Question', ' context'], 'evidence_proportions': [0.66376953125, 0.9288330078125, 0.3882242838541667, 0.9166259765625, 0.13215128580729166]}}, 'pred_res': 'the kitchen<|eot_id|>', 'score': 100}
2025-01-22 04:19:03.067 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:19:03.067 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-21_pid-2_3-4-6-7-9.pkl | len: 3 |  size: 2.04 KB
Processing depth (3, 4, 6, 7, 9):   3%|▎         | 3/100 [01:01<33:37, 20.80s/it]is_0k: False
your chose emoji: ['♉', '👩🏽\u200d🎓', '👂🏽', '👩🏾\u200d❤️\u200d💋\u200d👩🏽', '👭🏻', '🏌🏻\u200d♂️', '👨🏻\u200d🤝\u200d👨🏼', '👩\u200d🦼\u200d➡', '👩🏻\u200d❤️\u200d👨🏻', '👨🏽\u200d🚒']
emoji:
O: ♉ [17245, 231]
N: 👭🏻 [9468, 239, 255, 9468, 237, 119]

O: 👩🏽‍🎓 [9468, 239, 102, 9468, 237, 121, 102470, 9468, 236, 241]
N: 👩‍🦼‍➡ [9468, 239, 102, 102470, 9468, 99, 120, 102470, 98115, 94]

O: 👂🏽 [9468, 239, 224, 9468, 237, 121]
N: 🏌🏻‍♂️ [9468, 237, 234, 9468, 237, 119, 102470, 17245, 224, 31643]

O: 👩🏾‍❤️‍💋‍👩🏽 [9468, 239, 102, 9468, 237, 122, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 121]
N: 👩🏽‍🎓 [9468, 239, 102, 9468, 237, 121, 102470, 9468, 236, 241]

O: 👭🏻 [9468, 239, 255, 9468, 237, 119]
N: 👂🏽 [9468, 239, 224, 9468, 237, 121]

O: 🏌🏻‍♂️ [9468, 237, 234, 9468, 237, 119, 102470, 17245, 224, 31643]
N: 👨🏻‍🤝‍👨🏼 [9468, 239, 101, 9468, 237, 119, 102470, 9468, 97, 251, 102470, 9468, 239, 101, 9468, 237, 120]

O: 👨🏻‍🤝‍👨🏼 [9468, 239, 101, 9468, 237, 119, 102470, 9468, 97, 251, 102470, 9468, 239, 101, 9468, 237, 120]
N: 👩🏾‍❤️‍💋‍👩🏽 [9468, 239, 102, 9468, 237, 122, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 121]

O: 👩‍🦼‍➡ [9468, 239, 102, 102470, 9468, 99, 120, 102470, 98115, 94]
N: ♉ [17245, 231]

O: 👩🏻‍❤️‍👨🏻 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 119]
N: 👩🏻‍❤️‍👨🏻 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 119]

O: 👨🏽‍🚒 [9468, 239, 101, 9468, 237, 121, 102470, 9468, 248, 240]
N: 👨🏽‍🚒 [9468, 239, 101, 9468, 237, 121, 102470, 9468, 248, 240]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:05<00:15,  5.19s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.66s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.33s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.04s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.62s/it]
Processing depth (0, 4, 5, 6, 9):   3%|▎         | 3/100 [01:17<33:37, 20.80s/it]2025-01-22 04:19:19.470 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the kitchen.
2025-01-22 04:19:19.470 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (32, 37) -->  moved to the kitchen.
2025-01-22 04:19:19.470 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra grabbed the milk.
2025-01-22 04:19:19.487 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3571, 3575) -->  Sandra grabbed the milk
2025-01-22 04:19:19.487 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the garden.
2025-01-22 04:19:19.509 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4101, 4107) -->  Sandra went back to the garden
2025-01-22 04:19:19.509 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra discarded the milk.
2025-01-22 04:19:19.532 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4632, 4636) -->  Sandra discarded the milk
2025-01-22 04:19:19.532 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel journeyed to the hallway.
2025-01-22 04:19:19.567 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7097, 7103) -->  Daniel journeyed to the hallway
2025-01-22 04:19:19.567 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went to the kitchen.
2025-01-22 04:19:19.573 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1103, 1108) --> . John went to the
2025-01-22 04:19:19.573 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John grabbed the football.
2025-01-22 04:19:19.592 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3650, 3654) -->  John grabbed the football
2025-01-22 04:19:19.592 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the bathroom.
2025-01-22 04:19:19.594 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (276, 282) --> . Daniel went back to the
2025-01-22 04:19:19.594 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the bedroom.
2025-01-22 04:19:19.602 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1571, 1577) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:19:20.409 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 04:19:20.409 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8152])
2025-01-22 04:19:22.642 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [226.67, 25.48590205395463, 135.97916666666666, 24.579506566777656, 45.766325176886795], 'topk_indices': array([8126, 7995,    4, 1108, 8131, 8151, 8132,    9, 8041,   24, 8139,
       7996, 8031, 8150, 4300, 8148,   14, 7997, 8147,    0]), 'topk_tokens': [':', ' provided', '\n\n', ' kitchen', ' prior', '\n\n', ' to', ':', ' location', '\n\n', ' discarded', ' you', '.\n\n', '<|end_header_id|>', 'nes', '<|start_header_id|>', '\n', ' context', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [348.85, 294.78125, 244.0625, 224.40625, 63.5625]}, 'weight': {'score': [25.833125, 23.255247930717353, 21.352306547619047, 23.252228426748058, 29.644162735849058], 'topk_indices': array([3306, 3333, 3178, 3226, 7426, 7388, 1531, 1469, 4334, 4318, 5138,
       5199, 7109, 7165, 3515, 3489, 4959, 4911, 4988, 4936]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.809375, 29.677734375, 25.631510416666668, 30.544921875, 25.350260416666668]}, 'saliency': {'score': [1.503916015625, 0.14299380771957387, 0.7288992745535714, 0.13728076418755394, 0.33679976553287144], 'topk_indices': array([3574,   32, 4633, 4299, 8137, 4106, 8127, 8125, 4279,   35, 8031,
       7996, 7995, 8145, 1108, 8041, 8131, 8139, 4300, 7997]), 'topk_tokens': [' milk', ' moved', ' discarded', ' Min', ' milk', ' garden', ' Where', 'Question', 'nes', ' kitchen', '.\n\n', ' you', ' provided', 'Answer', ' kitchen', ' location', ' prior', ' discarded', 'nes', ' context'], 'evidence_proportions': [1.8931640625, 2.253173828125, 1.5692545572916667, 1.789306640625, 0.4244384765625]}}, 'pred_res': 'The garden.<|eot_id|>', 'score': 0}
2025-01-22 04:19:22.648 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:19:22.648 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-21_pid-3_0-4-5-6-9.pkl | len: 3 |  size: 2.08 KB
Processing depth (0, 4, 5, 6, 9):   4%|▍         | 4/100 [01:21<32:30, 20.32s/it]is_0k: False
your chose emoji: ['🤲🏻', '🚶🏽\u200d♂', '🍼', '👨🏻\u200d🦯\u200d➡', '↙️', '🧲', '✋', '♉', '🤌🏻', '💇🏻\u200d♀']
emoji:
O: 🤲🏻 [9468, 97, 110, 9468, 237, 119]
N: �� [110, 9468, 100]

O: 🚶🏽‍♂ [9468, 248, 114, 9468, 237, 121, 102470, 17245, 224]
N: �🤌� [119, 9468, 97, 234, 9468, 237]

O: 🍼 [9468, 104247]
N: �👨🏻‍🦯‍� [94, 9468, 239, 101, 9468, 237, 119, 102470, 9468, 99, 107, 102470, 98115]

O: 👨🏻‍🦯‍➡ [9468, 239, 101, 9468, 237, 119, 102470, 9468, 99, 107, 102470, 98115, 94]
N: ️↙ [31643, 27017, 247]

O: ↙️ [27017, 247, 31643]
N: �� [233, 38798]

O: 🧲 [9468, 100, 110]
N: �🤲� [119, 9468, 97, 110, 9468, 237]

O: ✋ [38798, 233]
N: �� [231, 17245]

O: ♉ [17245, 231]
N: ��� [104247, 9468]

O: 🤌🏻 [9468, 97, 234, 9468, 237, 119]
N: �🚶🏽‍� [224, 9468, 248, 114, 9468, 237, 121, 102470, 17245]

O: 💇🏻‍♀ [93273, 229, 9468, 237, 119, 102470, 32990]
N: ♀💇🏻‍ [32990, 93273, 229, 9468, 237, 119, 102470]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.82s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:10<00:10,  5.15s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:15<00:05,  5.43s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:16<00:00,  3.68s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:16<00:00,  4.24s/it]
Processing depth (1, 4, 6, 7, 9):   4%|▍         | 4/100 [01:39<32:30, 20.32s/it]2025-01-22 04:19:41.472 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the kitchen.
2025-01-22 04:19:41.481 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (902, 907) --> . Sandra moved to the
2025-01-22 04:19:41.481 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra grabbed the milk.
2025-01-22 04:19:41.503 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3668, 3672) -->  Sandra grabbed the milk
2025-01-22 04:19:41.503 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the garden.
2025-01-22 04:19:41.531 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4785, 4791) --> . Sandra went back to the
2025-01-22 04:19:41.531 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra discarded the milk.
2025-01-22 04:19:41.559 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5707, 5711) -->  Sandra discarded the milk
2025-01-22 04:19:41.559 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel journeyed to the hallway.
2025-01-22 04:19:41.595 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7277, 7283) --> . Daniel journeyed to the
2025-01-22 04:19:41.595 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went to the kitchen.
2025-01-22 04:19:41.602 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1298, 1303) --> . John went to the
2025-01-22 04:19:41.602 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John grabbed the football.
2025-01-22 04:19:41.619 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3719, 3723) -->  John grabbed the football
2025-01-22 04:19:41.620 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the bathroom.
2025-01-22 04:19:41.621 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (355, 361) --> . Daniel went back to the
2025-01-22 04:19:41.621 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the bedroom.
2025-01-22 04:19:41.631 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1808, 1814) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:19:42.425 | INFO     | test_jbb_embedding:begin_test:693 - the garden<|eot_id|>
2025-01-22 04:19:42.425 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8239])
2025-01-22 04:19:45.379 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [235.983125, 21.581567732346517, 135.625, 20.635380444729137, 12.749033505154639], 'topk_indices': array([ 902, 8118, 8219,  907, 5708, 8128, 3671, 5707,   24,  362, 3672,
         14, 8238,  361,  903, 8237, 4791, 8235,    0, 8234]), 'topk_tokens': ['.', '.\n\n', ' to', ' kitchen', ' discarded', ' location', ' milk', ' Sandra', '\n\n', '.', '.', '\n', '\n\n', ' bathroom', ' Sandra', '<|end_header_id|>', ' garden', '<|start_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [360.725, 302.25, 228.72916666666666, 320.0, 39.096354166666664]}, 'weight': {'score': [23.9575, 23.330909897476342, 21.352306547619047, 23.33406825738165, 29.924613402061855], 'topk_indices': array([3351, 3378, 3203, 3251, 7465, 7503, 1444, 1506, 4372, 4388, 5251,
       5190, 7171, 7227, 3560, 3534, 5044, 5015, 4992, 4967]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.040625, 29.677734375, 21.869791666666668, 30.544921875, 20.270833333333332]}, 'saliency': {'score': [1.591142578125, 0.12109218746445417, 0.7391648065476191, 0.11502449776615499, 0.09458223323232119], 'topk_indices': array([8238,  257, 8218, 8232, 4786,    0, 8224, 3668, 3669, 8226,  904,
        356, 8128,  907, 3671, 5708, 5707, 4791,  361,  903]), 'topk_tokens': ['\n\n', 'hue', ' prior', 'Answer', ' Sandra', '<|begin_of_text|>', ' milk', ' Sandra', ' grabbed', ' discarded', ' moved', ' Daniel', ' location', ' kitchen', ' milk', ' discarded', ' Sandra', ' garden', ' bathroom', ' Sandra'], 'evidence_proportions': [2.1328125, 2.33154296875, 1.2887369791666667, 2.6885986328125, 0.2169189453125]}}, 'pred_res': 'the garden<|eot_id|>', 'score': 0}
2025-01-22 04:19:45.384 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:19:45.385 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-21_pid-4_1-4-6-7-9.pkl | len: 3 |  size: 2.1 KB
Processing depth (1, 4, 6, 7, 9):   5%|▌         | 5/100 [01:43<33:32, 21.19s/it]Processing depth (1, 4, 6, 7, 9):   5%|▌         | 5/100 [01:43<32:55, 20.79s/it]
2025-01-22 04:19:45.560 | INFO     | __main__:<module>:82 - Selected idx: 22
2025-01-22 04:19:45.561 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the apple before the garden? 
2025-01-22 04:19:45.561 | INFO     | __main__:<module>:84 - Answer: kitchen
2025-01-22 04:19:45.561 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 04:19:45.561 | INFO     | __main__:<module>:86 - Needle: [' John went back to the bedroom.', ' Daniel journeyed to the hallway.', ' John grabbed the apple.', ' Daniel went back to the kitchen.', ' Sandra moved to the kitchen.', ' Sandra went back to the garden.', ' Daniel went back to the bathroom.', ' John went to the kitchen.', ' Mary took the milk.', ' Sandra discarded the apple.', ' Mary journeyed to the garden.']
2025-01-22 04:19:45.561 | INFO     | __main__:<module>:87 - Real Needle: [' Sandra moved to the kitchen.', ' Sandra went back to the garden.', ' Sandra discarded the apple.', ' Mary journeyed to the garden.']
2025-01-22 04:19:45.561 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['🚶🏾\u200d♀️\u200d➡️', '🧑🏾\u200d❤\u200d💋\u200d🧑🏿', '👨🏼\u200d✈️', '🏌\u200d♀', '⛸️', '👩🏼', '👩\u200d❤\u200d👩', '👨🏽\u200d⚕', '🤷🏼\u200d♂️', '🚶🏾\u200d♂\u200d➡']
emoji:
O: 🚶🏾‍♀️‍➡️ [9468, 248, 114, 9468, 237, 122, 102470, 32990, 31643, 102470, 98115, 94, 31643]
N: 🚶🏾‍♀️‍➡️ [9468, 248, 114, 9468, 237, 122, 102470, 32990, 31643, 102470, 98115, 94, 31643]

O: 🧑🏾‍❤‍💋‍🧑🏿 [9468, 100, 239, 9468, 237, 122, 102470, 121643, 102470, 93273, 233, 102470, 9468, 100, 239, 9468, 237, 123]
N: 🧑🏾‍❤‍💋‍🧑🏿 [9468, 100, 239, 9468, 237, 122, 102470, 121643, 102470, 93273, 233, 102470, 9468, 100, 239, 9468, 237, 123]

O: 👨🏼‍✈️ [9468, 239, 101, 9468, 237, 120, 102470, 38798, 230, 31643]
N: 👩‍❤‍👩 [9468, 239, 102, 102470, 121643, 102470, 9468, 239, 102]

O: 🏌‍♀ [9468, 237, 234, 102470, 32990]
N: 👨🏽‍⚕ [9468, 239, 101, 9468, 237, 121, 102470, 158, 248, 243]

O: ⛸️ [158, 249, 116, 31643]
N: 🤷🏼‍♂️ [9468, 97, 115, 9468, 237, 120, 102470, 17245, 224, 31643]

O: 👩🏼 [9468, 239, 102, 9468, 237, 120]
N: 👩🏼 [9468, 239, 102, 9468, 237, 120]

O: 👩‍❤‍👩 [9468, 239, 102, 102470, 121643, 102470, 9468, 239, 102]
N: 👨🏼‍✈️ [9468, 239, 101, 9468, 237, 120, 102470, 38798, 230, 31643]

O: 👨🏽‍⚕ [9468, 239, 101, 9468, 237, 121, 102470, 158, 248, 243]
N: 🏌‍♀ [9468, 237, 234, 102470, 32990]

O: 🤷🏼‍♂️ [9468, 97, 115, 9468, 237, 120, 102470, 17245, 224, 31643]
N: ⛸️ [158, 249, 116, 31643]

O: 🚶🏾‍♂‍➡ [9468, 248, 114, 9468, 237, 122, 102470, 17245, 224, 102470, 98115, 94]
N: 🚶🏾‍♂‍➡ [9468, 248, 114, 9468, 237, 122, 102470, 17245, 224, 102470, 98115, 94]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:11,  3.99s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.60s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.39s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.84s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.40s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (3, 5, 7, 9):   0%|          | 0/100 [00:15<?, ?it/s]2025-01-22 04:20:00.961 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the kitchen.
2025-01-22 04:20:00.977 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2922, 2927) --> . Sandra moved to the
2025-01-22 04:20:00.978 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the garden.
2025-01-22 04:20:01.000 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4215, 4221) -->  Sandra went back to the garden
2025-01-22 04:20:01.000 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra discarded the apple.
2025-01-22 04:20:01.029 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5616, 5620) -->  Sandra discarded the apple
2025-01-22 04:20:01.029 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary journeyed to the garden.
2025-01-22 04:20:01.068 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7247, 7253) --> . Mary journeyed to the
2025-01-22 04:20:01.068 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the bedroom.
2025-01-22 04:20:01.104 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6828, 6834) --> . John went back to the
2025-01-22 04:20:01.104 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the hallway.
2025-01-22 04:20:01.119 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2533, 2539) --> . Daniel journeyed to the
2025-01-22 04:20:01.119 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John grabbed the apple.
2025-01-22 04:20:01.132 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2387, 2391) -->  John grabbed the apple
2025-01-22 04:20:01.132 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went back to the kitchen.
2025-01-22 04:20:01.164 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5840, 5846) --> . Daniel went back to the
2025-01-22 04:20:01.165 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel went back to the bathroom.
2025-01-22 04:20:01.196 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5840, 5846) --> . Daniel went back to the
2025-01-22 04:20:01.196 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John went to the kitchen.
2025-01-22 04:20:01.212 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (2985, 2990) -->  tragedy. John went to
2025-01-22 04:20:01.212 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Mary took the milk.
2025-01-22 04:20:01.221 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (1717, 1721) -->  took the milk.
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:20:05.242 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 04:20:05.242 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8184])
2025-01-22 04:20:08.135 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [92.6860119047619, 13.574192507939417, 65.16722972972973, 13.134988351888301, 13.641543260261194], 'topk_indices': array([8165, 8174, 8037, 8153,    4, 8167, 8072,    9, 8178, 8172,   28,
         23,    1, 8038, 8180,   24,   14,    0, 8182, 8179]), 'topk_tokens': ['.\n\n', ' garden', ' you', ' return', '\n\n', ':', '.\n\n', ':', ':', ' before', '<|end_header_id|>', '4', '<|start_header_id|>', ' context', '<|start_header_id|>', '\n\n', '\n', '<|begin_of_text|>', '<|end_header_id|>', '<|eot_id|>'], 'evidence_proportions': [130.1, 84.921875, 106.859375, 59.822916666666664]}, 'weight': {'score': [23.89360119047619, 23.272049056430927, 21.76055743243243, 23.277323087095585, 29.43097014925373], 'topk_indices': array([3300, 3327, 3172, 3220, 7465, 7427, 1461, 1399, 4292, 4308, 5208,
       5147, 7197, 7141, 3509, 3483, 4949, 5001, 4924, 4972]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.040625, 25.631510416666668, 30.615234375, 20.052083333333332]}, 'saliency': {'score': [0.6089099702380952, 0.0749136352911819, 0.3727614944045608, 0.07217845337199379, 0.09982869162488339], 'topk_indices': array([1712, 8072, 8037, 8181, 2390, 8166,   16,   19, 8036,    8, 8177,
       8171, 8082,   23, 8153,   24,   20, 8174, 8172, 8038]), 'topk_tokens': ['�', '.\n\n', ' you', 'assistant', ' apple', 'Question', ' Date', '26', ' provided', ' Date', 'Answer', ' apple', ' location', '4', ' return', '\n\n', ' Jul', ' garden', ' before', ' context'], 'evidence_proportions': [0.7769775390625, 0.6190999348958334, 0.866302490234375, 0.2870686848958333]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 100}
2025-01-22 04:20:08.143 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:20:08.144 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-22_pid-0_3-5-7-9.pkl | len: 3 |  size: 2.02 KB
Processing depth (3, 5, 7, 9):   1%|          | 1/100 [00:22<37:06, 22.49s/it]is_0k: False
your chose emoji: ['🧰', '🤥', '🧎🏻\u200d♀\u200d➡', '🔛', '👨🏽\u200d🏫', '👩🏼\u200d❤️\u200d👨🏽', '👮🏾\u200d♂', '🍙', '⛑️', '💆🏿']
emoji:
O: 🧰 [9468, 100, 108]
N: ⛑️ [158, 249, 239, 31643]

O: 🤥 [9468, 97, 98]
N: 🍙 [9468, 235, 247]

O: 🧎🏻‍♀‍➡ [9468, 100, 236, 9468, 237, 119, 102470, 32990, 102470, 98115, 94]
N: 👩🏼‍❤️‍👨🏽 [9468, 239, 102, 9468, 237, 120, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 121]

O: 🔛 [9468, 242, 249]
N: 🤥 [9468, 97, 98]

O: 👨🏽‍🏫 [9468, 239, 101, 9468, 237, 121, 102470, 9468, 237, 104]
N: 👨🏽‍🏫 [9468, 239, 101, 9468, 237, 121, 102470, 9468, 237, 104]

O: 👩🏼‍❤️‍👨🏽 [9468, 239, 102, 9468, 237, 120, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 121]
N: 🔛 [9468, 242, 249]

O: 👮🏾‍♂ [9468, 239, 106, 9468, 237, 122, 102470, 17245, 224]
N: 👮🏾‍♂ [9468, 239, 106, 9468, 237, 122, 102470, 17245, 224]

O: 🍙 [9468, 235, 247]
N: 🧎🏻‍♀‍➡ [9468, 100, 236, 9468, 237, 119, 102470, 32990, 102470, 98115, 94]

O: ⛑️ [158, 249, 239, 31643]
N: 🧰 [9468, 100, 108]

O: 💆🏿 [93273, 228, 9468, 237, 123]
N: 💆🏿 [93273, 228, 9468, 237, 123]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.79s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.65s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.52s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.17s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.70s/it]
Processing depth (0, 2, 3, 5):   1%|          | 1/100 [00:38<37:06, 22.49s/it]2025-01-22 04:20:24.625 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the kitchen.
2025-01-22 04:20:24.626 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (32, 37) -->  moved to the kitchen.
2025-01-22 04:20:24.626 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the garden.
2025-01-22 04:20:24.637 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1853, 1859) --> . Sandra went back to the
2025-01-22 04:20:24.637 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra discarded the apple.
2025-01-22 04:20:24.652 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2859, 2863) -->  Sandra discarded the apple
2025-01-22 04:20:24.652 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary journeyed to the garden.
2025-01-22 04:20:24.676 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4185, 4191) --> . Mary journeyed to the
2025-01-22 04:20:24.676 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the bedroom.
2025-01-22 04:20:24.713 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6848, 6854) --> . John went back to the
2025-01-22 04:20:24.714 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the hallway.
2025-01-22 04:20:24.728 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2543, 2549) --> . Daniel journeyed to the
2025-01-22 04:20:24.728 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John grabbed the apple.
2025-01-22 04:20:24.742 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2405, 2409) -->  John grabbed the apple
2025-01-22 04:20:24.742 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went back to the kitchen.
2025-01-22 04:20:24.777 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5876, 5882) --> . Daniel went back to the
2025-01-22 04:20:24.777 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel went back to the bathroom.
2025-01-22 04:20:24.809 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5876, 5882) --> . Daniel went back to the
2025-01-22 04:20:24.809 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John went to the kitchen.
2025-01-22 04:20:24.826 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (2894, 2899) -->  John went to the kitchen
2025-01-22 04:20:24.826 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Mary took the milk.
2025-01-22 04:20:24.836 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (1777, 1781) -->  Mary took the milk
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:20:25.621 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 04:20:25.622 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8205])
2025-01-22 04:20:27.852 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [103.05952380952381, 13.262716252436647, 75.015625, 12.750987346625767, 20.141969358766232], 'topk_indices': array([   4, 8199, 8196, 4338, 8093,    1, 4318, 8059,   23, 8193,    9,
         24, 2898,   28,   14, 4339, 8203, 8200,    0, 8201]), 'topk_tokens': ['\n\n', ':', '?', ' Min', '.\n\n', '<|start_header_id|>', 'nes', ' context', '4', ' before', ':', '\n\n', ' kitchen', '<|end_header_id|>', '\n', 'nes', '<|end_header_id|>', '<|eot_id|>', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [149.275, 111.03125, 88.0703125, 66.56770833333333]}, 'weight': {'score': [22.525669642857142, 23.279987892909357, 22.24809966216216, 23.286616180981596, 29.099837662337663], 'topk_indices': array([3378, 3351, 3271, 3223, 7440, 7478, 1474, 1412, 4373, 4357, 5168,
       5229, 7161, 7217, 3560, 3534, 4970, 5022, 4945, 4993]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.809375, 21.869791666666668, 30.615234375, 20.052083333333332]}, 'saliency': {'score': [0.5938604445684523, 0.07281860738237467, 0.47106603673986486, 0.0696680511287385, 0.14527001318993507], 'topk_indices': array([8177,   20, 8196, 8093,   14,   23, 8198,    8,   24, 8174, 8192,
       8189, 8187, 8195, 4338, 8193, 4318, 8059, 2898, 4339]), 'topk_tokens': [' directly', ' Jul', '?', '.\n\n', '\n', '4', 'Answer', ' Date', '\n\n', ' return', ' apple', ' Where', 'Question', ' garden', ' Min', ' before', 'nes', ' context', ' kitchen', 'nes'], 'evidence_proportions': [0.8060546875, 0.6223958333333334, 0.704742431640625, 0.3145751953125]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 100}
2025-01-22 04:20:27.876 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:20:27.876 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-22_pid-1_0-2-3-5.pkl | len: 3 |  size: 2.0 KB
Processing depth (0, 2, 3, 5):   2%|▏         | 2/100 [00:42<34:05, 20.87s/it]is_0k: False
your chose emoji: ['🧏🏼\u200d♀', '👩🏾\u200d❤\u200d👨🏾', '👨🏻\u200d🚀', '🌩', '🇹🇨', '\U0001faf2🏽', '🧑🏻\u200d🦳', '🕣', '👮🏻\u200d♂️', '🏋🏽']
emoji:
O: 🧏🏼‍♀ [9468, 100, 237, 9468, 237, 120, 102470, 32990]
N: �� [102, 9468, 234]

O: 👩🏾‍❤‍👨🏾 [9468, 239, 102, 9468, 237, 122, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 122]
N: �🫲� [121, 9468, 104, 110, 9468, 237]

O: 👨🏻‍🚀 [9468, 239, 101, 9468, 237, 119, 102470, 9468, 248, 222]
N: ️👮🏻‍♂ [31643, 9468, 239, 106, 9468, 237, 119, 102470, 17245, 224]

O: 🌩 [9468, 234, 102]
N: ♀🧏🏼‍ [32990, 9468, 100, 237, 9468, 237, 120, 102470]

O: 🇹🇨 [9468, 229, 117, 9468, 229, 101]
N: �👩🏾‍❤‍👨� [122, 9468, 239, 102, 9468, 237, 122, 102470, 121643, 102470, 9468, 239, 101, 9468, 237]

O: 🫲🏽 [9468, 104, 110, 9468, 237, 121]
N: �🧑🏻‍� [111, 9468, 100, 239, 9468, 237, 119, 102470, 9468, 99]

O: 🧑🏻‍🦳 [9468, 100, 239, 9468, 237, 119, 102470, 9468, 99, 111]
N: �👨🏻‍� [222, 9468, 239, 101, 9468, 237, 119, 102470, 9468, 248]

O: 🕣 [9468, 243, 96]
N: �� [96, 9468, 243]

O: 👮🏻‍♂️ [9468, 239, 106, 9468, 237, 119, 102470, 17245, 224, 31643]
N: �🇹� [101, 9468, 229, 117, 9468, 229]

O: 🏋🏽 [9468, 237, 233, 9468, 237, 121]
N: �🏋� [121, 9468, 237, 233, 9468, 237]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.16s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.61s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.21s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.70s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.30s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 3, 7, 8):   2%|▏         | 2/100 [00:57<34:05, 20.87s/it]2025-01-22 04:20:42.801 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the kitchen.
2025-01-22 04:20:42.801 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (32, 37) -->  moved to the kitchen.
2025-01-22 04:20:42.801 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the garden.
2025-01-22 04:20:42.819 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3055, 3061) --> . Sandra went back to the
2025-01-22 04:20:42.819 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra discarded the apple.
2025-01-22 04:20:42.846 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5646, 5650) -->  discarded the apple.
2025-01-22 04:20:42.846 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary journeyed to the garden.
2025-01-22 04:20:42.882 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6608, 6614) --> . Mary journeyed to the
2025-01-22 04:20:42.882 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the bedroom.
2025-01-22 04:20:42.917 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6740, 6746) --> . John went back to the
2025-01-22 04:20:42.917 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the hallway.
2025-01-22 04:20:42.933 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2790, 2796) --> . Daniel journeyed to the
2025-01-22 04:20:42.933 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John grabbed the apple.
2025-01-22 04:20:42.945 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2494, 2498) -->  John grabbed the apple
2025-01-22 04:20:42.945 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went back to the kitchen.
2025-01-22 04:20:42.975 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6097, 6103) -->  went back to the bathroom.
2025-01-22 04:20:42.975 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel went back to the bathroom.
2025-01-22 04:20:43.006 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6096, 6102) -->  Daniel went back to the bathroom
2025-01-22 04:20:43.006 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John went to the kitchen.
2025-01-22 04:20:43.021 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (3099, 3104) -->  ranks. John went to
2025-01-22 04:20:43.021 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Mary took the milk.
2025-01-22 04:20:43.030 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (1843, 1847) -->  Mary took the milk
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:20:46.863 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 04:20:46.863 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8169])
2025-01-22 04:20:49.934 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [94.92261904761905, 10.093820744615762, 43.466638513513516, 9.722092987429134, 11.415287341101696], 'topk_indices': array([8168,    4, 8155, 8152, 8153,   23, 8154,    9, 8160, 8023,    1,
       8156,   28,   24,   14, 8157, 8167,    0, 8165, 8164]), 'topk_tokens': ['\n\n', '\n\n', ' the', ':', ' Where', '4', ' was', ':', '?', ' context', '<|start_header_id|>', ' apple', '<|end_header_id|>', '\n\n', '\n', ' before', '<|end_header_id|>', '<|begin_of_text|>', '<|start_header_id|>', '<|eot_id|>'], 'evidence_proportions': [125.7625, 77.421875, 130.796875, 62.807291666666664]}, 'weight': {'score': [21.092261904761905, 23.266519823788546, 23.12837837837838, 23.272776990386987, 29.942531779661017], 'topk_indices': array([3262, 3289, 3182, 3134, 7460, 7422, 1406, 1468, 4283, 4299, 5120,
       5181, 7199, 7143, 3471, 3445, 4945, 4897, 4974, 4922]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.809375, 21.869791666666668, 23.08984375, 20.052083333333332]}, 'saliency': {'score': [0.5194149925595238, 0.05473860910110362, 0.26463606550886826, 0.052578834644643906, 0.08662996453753972], 'topk_indices': array([  19, 8166,   27,   16,   14, 8162, 8138,   23,    8, 8154,   20,
       8160, 8151, 3105, 8159,   24, 8153, 8023, 8156, 8157]), 'topk_tokens': ['26', 'assistant', 'user', ' Date', '\n', 'Answer', ' return', '4', ' Date', ' was', ' Jul', '?', 'Question', ' kitchen', ' garden', '\n\n', ' Where', ' context', ' apple', ' before'], 'evidence_proportions': [0.6670654296875, 0.4458821614583333, 0.74951171875, 0.3165079752604167]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 100}
2025-01-22 04:20:49.941 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:20:49.941 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-22_pid-2_0-3-7-8.pkl | len: 3 |  size: 2.0 KB
Processing depth (0, 3, 7, 8):   3%|▎         | 3/100 [01:04<34:37, 21.41s/it]is_0k: False
your chose emoji: ['🧑🏻\u200d✈️', '🛋️', '⚰️', '🕵\u200d♀', '🚴🏼\u200d♀', '🏵️', '🦹🏼\u200d♀', '🙍🏻\u200d♂️', '🗓', '🌔']
emoji:
O: 🧑🏻‍✈️ [9468, 100, 239, 9468, 237, 119, 102470, 38798, 230, 31643]
N: ️🧑🏻‍✈ [31643, 9468, 100, 239, 9468, 237, 119, 102470, 38798, 230]

O: 🛋️ [9468, 249, 233, 31643]
N: ♀🦹🏼‍ [32990, 9468, 99, 117, 9468, 237, 120, 102470]

O: ⚰️ [158, 248, 108, 31643]
N: �� [241, 9468, 245]

O: 🕵‍♀ [9468, 243, 113, 102470, 32990]
N: ♀🕵‍ [32990, 9468, 243, 113, 102470]

O: 🚴🏼‍♀ [9468, 248, 112, 9468, 237, 120, 102470, 32990]
N: ♀🚴🏼‍ [32990, 9468, 248, 112, 9468, 237, 120, 102470]

O: 🏵️ [9468, 237, 113, 31643]
N: ️⚰ [31643, 158, 248, 108]

O: 🦹🏼‍♀ [9468, 99, 117, 9468, 237, 120, 102470, 32990]
N: ️🛋 [31643, 9468, 249, 233]

O: 🙍🏻‍♂️ [9468, 247, 235, 9468, 237, 119, 102470, 17245, 224, 31643]
N: ️🏵 [31643, 9468, 237, 113]

O: 🗓 [9468, 245, 241]
N: ️🙍🏻‍♂ [31643, 9468, 247, 235, 9468, 237, 119, 102470, 17245, 224]

O: 🌔 [9468, 234, 242]
N: �� [242, 9468, 234]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.57s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.95s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.82s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.33s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.87s/it]
Processing depth (1, 2, 3, 6):   3%|▎         | 3/100 [01:21<34:37, 21.41s/it]2025-01-22 04:21:07.177 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the kitchen.
2025-01-22 04:21:07.182 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (895, 900) --> . Sandra moved to the
2025-01-22 04:21:07.183 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the garden.
2025-01-22 04:21:07.193 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2009, 2015) -->  cable. Sandra went back to
2025-01-22 04:21:07.193 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra discarded the apple.
2025-01-22 04:21:07.208 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3062, 3066) -->  Sandra discarded the apple
2025-01-22 04:21:07.208 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary journeyed to the garden.
2025-01-22 04:21:07.234 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4936, 4942) --> . Mary journeyed to the
2025-01-22 04:21:07.234 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the bedroom.
2025-01-22 04:21:07.270 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6813, 6819) --> . John went back to the
2025-01-22 04:21:07.270 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the hallway.
2025-01-22 04:21:07.284 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2796, 2802) --> . Daniel journeyed to the
2025-01-22 04:21:07.284 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John grabbed the apple.
2025-01-22 04:21:07.296 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2500, 2504) -->  John grabbed the apple
2025-01-22 04:21:07.296 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went back to the kitchen.
2025-01-22 04:21:07.331 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6173, 6179) -->  went back to the bathroom.
2025-01-22 04:21:07.331 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel went back to the bathroom.
2025-01-22 04:21:07.362 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6172, 6178) -->  Daniel went back to the bathroom
2025-01-22 04:21:07.362 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John went to the kitchen.
2025-01-22 04:21:07.377 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (3103, 3108) -->  ranks. John went to
2025-01-22 04:21:07.377 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Mary took the milk.
2025-01-22 04:21:07.386 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (1842, 1846) -->  Mary took the milk
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:21:08.182 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 04:21:08.183 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8182])
2025-01-22 04:21:10.385 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [63.584449404761905, 10.07141875381796, 44.55215371621622, 9.776160868094008, 7.5134055397727275], 'topk_indices': array([   9, 8155, 8163, 8070, 8034, 8151, 8176,   28, 8181,   23,    1,
       8035, 3109, 8178,   24,   14, 8036,    0, 8180, 8177]), 'topk_tokens': [':', '.', '.\n\n', '.\n\n', ' provided', ' return', ':', '<|end_header_id|>', '\n\n', '4', '<|start_header_id|>', ' you', ' kitchen', '<|start_header_id|>', '\n\n', '\n', ' context', '<|begin_of_text|>', '<|end_header_id|>', '<|eot_id|>'], 'evidence_proportions': [98.0375, 52.516927083333336, 59.765625, 48.486979166666664]}, 'weight': {'score': [23.872767857142858, 23.27994616676848, 23.12837837837838, 23.279104374307863, 30.013967803030305], 'topk_indices': array([3266, 3293, 3138, 3186, 7405, 7443, 1405, 1467, 4261, 4277, 5079,
       5140, 7126, 7182, 3475, 3449, 4897, 4849, 4926, 4874]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.040625, 25.55859375, 30.615234375, 20.052083333333332]}, 'saliency': {'score': [0.3831758045014881, 0.05502120608153253, 0.27164851008234797, 0.05318701673554394, 0.05688534360943419], 'topk_indices': array([8070, 2734, 8169,   14, 8179, 8154,    8, 8175, 8181, 8170,   20,
       8172, 8164,   23,   24, 8151, 8034, 8035, 3109, 8036]), 'topk_tokens': ['.\n\n', ' kids', ' apple', '\n', 'assistant', ' directly', ' Date', 'Answer', '\n\n', ' before', ' Jul', ' garden', 'Question', '4', '\n\n', ' return', ' provided', ' you', ' kitchen', ' context'], 'evidence_proportions': [0.55283203125, 0.328094482421875, 0.47845458984375, 0.23335774739583334]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 100}
2025-01-22 04:21:10.440 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:21:10.440 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-22_pid-3_1-2-3-6.pkl | len: 3 |  size: 2.02 KB
Processing depth (1, 2, 3, 6):   4%|▍         | 4/100 [01:24<33:41, 21.05s/it]is_0k: False
your chose emoji: ['💁🏿\u200d♂️', '🙎🏾\u200d♀️', '👩\u200d✈️', '🧘\u200d♀', '🐒', '🈳', '✒', '👩🏿\u200d❤\u200d👨🏻', '🧍🏿\u200d♂️', '👽']
emoji:
O: 💁🏿‍♂️ [93273, 223, 9468, 237, 123, 102470, 17245, 224, 31643]
N: 🈳 [9468, 230, 111]

O: 🙎🏾‍♀️ [9468, 247, 236, 9468, 237, 122, 102470, 32990, 31643]
N: 🧘‍♀ [9468, 100, 246, 102470, 32990]

O: 👩‍✈️ [9468, 239, 102, 102470, 38798, 230, 31643]
N: 🙎🏾‍♀️ [9468, 247, 236, 9468, 237, 122, 102470, 32990, 31643]

O: 🧘‍♀ [9468, 100, 246, 102470, 32990]
N: 👩‍✈️ [9468, 239, 102, 102470, 38798, 230, 31643]

O: 🐒 [9468, 238, 240]
N: 🐒 [9468, 238, 240]

O: 🈳 [9468, 230, 111]
N: 🧍🏿‍♂️ [9468, 100, 235, 9468, 237, 123, 102470, 17245, 224, 31643]

O: ✒ [38798, 240]
N: 💁🏿‍♂️ [93273, 223, 9468, 237, 123, 102470, 17245, 224, 31643]

O: 👩🏿‍❤‍👨🏻 [9468, 239, 102, 9468, 237, 123, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 119]
N: ✒ [38798, 240]

O: 🧍🏿‍♂️ [9468, 100, 235, 9468, 237, 123, 102470, 17245, 224, 31643]
N: 👩🏿‍❤‍👨🏻 [9468, 239, 102, 9468, 237, 123, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 119]

O: 👽 [9468, 239, 121]
N: 👽 [9468, 239, 121]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.08s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:09,  4.52s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.55s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.20s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.65s/it]
Processing depth (2, 4, 5, 9):   4%|▍         | 4/100 [01:40<33:41, 21.05s/it]2025-01-22 04:21:26.723 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the kitchen.
2025-01-22 04:21:26.735 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2003, 2008) -->  cable. Sandra moved to
2025-01-22 04:21:26.735 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the garden.
2025-01-22 04:21:26.753 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3635, 3641) -->  Hon. Sandra went back to
2025-01-22 04:21:26.754 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra discarded the apple.
2025-01-22 04:21:26.782 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4239, 4243) -->  discarded the apple.
2025-01-22 04:21:26.782 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary journeyed to the garden.
2025-01-22 04:21:26.822 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7168, 7174) -->  Mary journeyed to the garden
2025-01-22 04:21:26.822 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the bedroom.
2025-01-22 04:21:26.862 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6770, 6776) --> . John went back to the
2025-01-22 04:21:26.862 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the hallway.
2025-01-22 04:21:26.877 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2693, 2699) --> . Daniel journeyed to the
2025-01-22 04:21:26.877 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John grabbed the apple.
2025-01-22 04:21:26.889 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2483, 2487) -->  John grabbed the apple
2025-01-22 04:21:26.889 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went back to the kitchen.
2025-01-22 04:21:26.923 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5882, 5888) --> . Daniel went back to the
2025-01-22 04:21:26.923 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel went back to the bathroom.
2025-01-22 04:21:26.954 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5882, 5888) --> . Daniel went back to the
2025-01-22 04:21:26.954 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John went to the kitchen.
2025-01-22 04:21:26.970 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (3072, 3077) --> . John went to the
2025-01-22 04:21:26.970 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Mary took the milk.
2025-01-22 04:21:26.981 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (1836, 1840) -->  Mary took the milk
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:21:27.782 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 04:21:27.782 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8206])
2025-01-22 04:21:30.134 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [74.61235119047619, 13.263033522658057, 45.7426097972973, 12.957539719052876, 11.431590544871796], 'topk_indices': array([8194, 8059, 8094, 8055,   28, 8205, 8175,    9, 7680,   23,   24,
       7560, 8060, 7604,   14, 7605, 8202, 8201,    0, 8204]), 'topk_tokens': [' before', ' you', '.\n\n', '\n', '<|end_header_id|>', '\n\n', ' return', ':', ' or', '4', '\n\n', 'nes', ' context', ' Min', '\n', 'nes', '<|start_header_id|>', '<|eot_id|>', '<|begin_of_text|>', '<|end_header_id|>'], 'evidence_proportions': [91.134375, 73.921875, 63.0234375, 69.26041666666667]}, 'weight': {'score': [24.658854166666668, 23.290487193933487, 21.600929054054053, 23.294631218562138, 29.532652243589745], 'topk_indices': array([3325, 3298, 3198, 3150, 7497, 7459, 1399, 1461, 4357, 4373, 5255,
       5194, 7236, 7180, 3481, 3507, 4996, 5019, 5048, 4971]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [25.4671875, 25.876302083333332, 23.08984375, 23.813802083333332]}, 'saliency': {'score': [0.46478852771577384, 0.07390946258013309, 0.27311335383234797, 0.07199816282008151, 0.0854954352745643], 'topk_indices': array([8188, 8059, 7671, 7559,   23,    8, 8178,   20,   24, 7680, 8196,
       8104, 8058, 8194, 3077, 8175, 7560, 8060, 7604, 7605]), 'topk_tokens': ['Question', ' you', ' tele', ' Min', '4', ' Date', ' directly', ' Jul', '\n\n', ' or', ' garden', ' location', ' provided', ' before', ' kitchen', ' return', 'nes', ' context', ' Min', 'nes'], 'evidence_proportions': [0.59544677734375, 0.4502766927083333, 0.391265869140625, 0.41943359375]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 100}
2025-01-22 04:21:30.143 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:21:30.144 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-22_pid-4_2-4-5-9.pkl | len: 3 |  size: 2.0 KB
Processing depth (2, 4, 5, 9):   5%|▌         | 5/100 [01:44<32:33, 20.57s/it]Processing depth (2, 4, 5, 9):   5%|▌         | 5/100 [01:44<33:06, 20.91s/it]
2025-01-22 04:21:30.216 | INFO     | __main__:<module>:82 - Selected idx: 23
2025-01-22 04:21:30.216 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the location prior to the place where the football was discarded, left or dropped?
2025-01-22 04:21:30.216 | INFO     | __main__:<module>:84 - Answer: kitchen
2025-01-22 04:21:30.216 | INFO     | __main__:<module>:85 - Tag: 4-hop
2025-01-22 04:21:30.216 | INFO     | __main__:<module>:86 - Needle: [' Sandra moved to the kitchen.', ' John went to the kitchen.', ' John grabbed the apple.', ' Mary took the milk.', ' Sandra took the football.', ' Daniel went back to the bathroom.', ' John went back to the bedroom.', ' Daniel journeyed to the hallway.', ' Daniel went back to the kitchen.', ' Sandra went back to the garden.', ' Sandra discarded the football.', ' Mary journeyed to the garden.']
2025-01-22 04:21:30.216 | INFO     | __main__:<module>:87 - Real Needle: [' Sandra moved to the kitchen.', ' Sandra took the football.', ' Sandra went back to the garden.', ' Sandra discarded the football.', ' Mary journeyed to the garden.']
2025-01-22 04:21:30.216 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['👅', '🙊', '🧑🏽\u200d🌾', '🖥', '👩🏾\u200d❤️\u200d👩🏿', '💂🏿\u200d♂️', '🦷', '👨🏽\u200d❤\u200d💋\u200d👨🏻', '🧑🏼\u200d🚒', '⛱']
emoji:
O: 👅 [9468, 239, 227]
N: 💂🏿‍♂️ [93273, 224, 9468, 237, 123, 102470, 17245, 224, 31643]

O: 🙊 [9468, 247, 232]
N: 🦷 [9468, 99, 115]

O: 🧑🏽‍🌾 [9468, 100, 239, 9468, 237, 121, 102470, 9468, 234, 122]
N: 🧑🏽‍🌾 [9468, 100, 239, 9468, 237, 121, 102470, 9468, 234, 122]

O: 🖥 [9468, 244, 98]
N: 👩🏾‍❤️‍👩🏿 [9468, 239, 102, 9468, 237, 122, 102470, 121643, 31643, 102470, 9468, 239, 102, 9468, 237, 123]

O: 👩🏾‍❤️‍👩🏿 [9468, 239, 102, 9468, 237, 122, 102470, 121643, 31643, 102470, 9468, 239, 102, 9468, 237, 123]
N: 👨🏽‍❤‍💋‍👨🏻 [9468, 239, 101, 9468, 237, 121, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 119]

O: 💂🏿‍♂️ [93273, 224, 9468, 237, 123, 102470, 17245, 224, 31643]
N: 🧑🏼‍🚒 [9468, 100, 239, 9468, 237, 120, 102470, 9468, 248, 240]

O: 🦷 [9468, 99, 115]
N: 👅 [9468, 239, 227]

O: 👨🏽‍❤‍💋‍👨🏻 [9468, 239, 101, 9468, 237, 121, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 119]
N: 🖥 [9468, 244, 98]

O: 🧑🏼‍🚒 [9468, 100, 239, 9468, 237, 120, 102470, 9468, 248, 240]
N: 🙊 [9468, 247, 232]

O: ⛱ [158, 249, 109]
N: ⛱ [158, 249, 109]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.00s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.23s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:11<00:03,  3.86s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  2.51s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  3.07s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (1, 5, 6, 8, 9):   0%|          | 0/100 [00:13<?, ?it/s]2025-01-22 04:21:44.325 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the kitchen.
2025-01-22 04:21:44.330 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (829, 834) --> . Sandra moved to the
2025-01-22 04:21:44.330 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra took the football.
2025-01-22 04:21:44.352 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4227, 4231) -->  took the football.
2025-01-22 04:21:44.353 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the garden.
2025-01-22 04:21:44.382 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4776, 4782) -->  the senate. Sandra went back
2025-01-22 04:21:44.382 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra discarded the football.
2025-01-22 04:21:44.414 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6658, 6662) -->  Sandra discarded the football
2025-01-22 04:21:44.415 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary journeyed to the garden.
2025-01-22 04:21:44.456 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7378, 7384) --> . Mary journeyed to the
2025-01-22 04:21:44.456 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went to the kitchen.
2025-01-22 04:21:44.480 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4897, 4902) -->  John went back to the
2025-01-22 04:21:44.480 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John grabbed the apple.
2025-01-22 04:21:44.509 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5677, 5681) -->  John grabbed the apple
2025-01-22 04:21:44.510 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary took the milk.
2025-01-22 04:21:44.515 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (836, 840) -->  Mary took the milk
2025-01-22 04:21:44.515 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went back to the bathroom.
2025-01-22 04:21:44.520 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (926, 932) --> . Daniel went back to the
2025-01-22 04:21:44.520 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went back to the bedroom.
2025-01-22 04:21:44.545 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4896, 4902) --> . John went back to the
2025-01-22 04:21:44.545 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel journeyed to the hallway.
2025-01-22 04:21:44.570 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (4792, 4798) -->  Daniel journeyed to the hallway
2025-01-22 04:21:44.570 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Daniel went back to the kitchen.
2025-01-22 04:21:44.576 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (926, 932) --> . Daniel went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:21:47.871 | INFO     | test_jbb_embedding:begin_test:693 - the garden<|eot_id|>
2025-01-22 04:21:47.871 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8206])
2025-01-22 04:21:51.147 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [274.37375, 20.819382689730784, 101.85135135135135, 19.673311495028845, 15.199108714788732], 'topk_indices': array([  23, 6661, 8186, 4784, 8085,  831,    9, 8193, 8205,  834, 8095,
         14, 6659,  830,   24, 8204, 4229, 8202,    0, 8201]), 'topk_tokens': ['4', ' football', ' to', ' garden', '.\n\n', ' moved', ':', ' discarded', '\n\n', ' kitchen', ' location', '\n', ' discarded', ' Sandra', '\n\n', '<|end_header_id|>', ' football', '<|start_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [443.25, 433.625, 147.94270833333334, 406.78125, 65.63541666666667]}, 'weight': {'score': [23.4690625, 23.2767827232306, 22.89991554054054, 23.277904251564994, 29.360915492957748], 'topk_indices': array([3320, 3293, 3165, 3213, 7402, 7440, 1499, 1437, 4293, 4277, 5215,
       5154, 7172, 7116, 3502, 3476, 4949, 4924, 4972, 5001]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.040625, 20.71484375, 25.809895833333332, 30.873046875, 20.052083333333332]}, 'saliency': {'score': [1.79020263671875, 0.11663253287883345, 0.5985734269425675, 0.10930823366730084, 0.11021616761113556], 'topk_indices': array([8085, 8166, 8051, 8189, 8181, 8185,   24, 8199, 8179, 6658, 8191,
       6661,  831, 4784, 8095,  834, 8193, 6659, 4229,  830]), 'topk_tokens': ['.\n\n', ' return', ' context', ' where', ' Where', ' prior', '\n\n', 'Answer', 'Question', ' Sandra', ' football', ' football', ' moved', ' garden', ' location', ' kitchen', ' discarded', ' discarded', ' football', ' Sandra'], 'evidence_proportions': [2.6486328125, 2.4898681640625, 1.0010782877604167, 3.35009765625, 0.3575948079427083]}}, 'pred_res': 'the garden<|eot_id|>', 'score': 0}
2025-01-22 04:21:51.153 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:21:51.154 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-23_pid-0_1-5-6-8-9.pkl | len: 3 |  size: 2.11 KB
Processing depth (1, 5, 6, 8, 9):   1%|          | 1/100 [00:20<34:20, 20.81s/it]is_0k: False
your chose emoji: ['🧑🏼\u200d🦼', '🇧🇾', '🔵', '🧘\u200d♀️', '🦸🏼\u200d♂️', '👩\u200d✈', '👩🏿\u200d❤\u200d👨🏿', '🤩', '🕵🏽\u200d♀️', '🍯']
emoji:
O: 🧑🏼‍🦼 [9468, 100, 239, 9468, 237, 120, 102470, 9468, 99, 120]
N: 🧑🏼‍🦼 [9468, 100, 239, 9468, 237, 120, 102470, 9468, 99, 120]

O: 🇧🇾 [9468, 229, 100, 9468, 229, 122]
N: 👩‍✈ [9468, 239, 102, 102470, 38798, 230]

O: 🔵 [9468, 242, 113]
N: 🕵🏽‍♀️ [9468, 243, 113, 9468, 237, 121, 102470, 32990, 31643]

O: 🧘‍♀️ [9468, 100, 246, 102470, 32990, 31643]
N: 🇧🇾 [9468, 229, 100, 9468, 229, 122]

O: 🦸🏼‍♂️ [9468, 99, 116, 9468, 237, 120, 102470, 17245, 224, 31643]
N: 🦸🏼‍♂️ [9468, 99, 116, 9468, 237, 120, 102470, 17245, 224, 31643]

O: 👩‍✈ [9468, 239, 102, 102470, 38798, 230]
N: 🔵 [9468, 242, 113]

O: 👩🏿‍❤‍👨🏿 [9468, 239, 102, 9468, 237, 123, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 123]
N: 👩🏿‍❤‍👨🏿 [9468, 239, 102, 9468, 237, 123, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 123]

O: 🤩 [9468, 97, 102]
N: 🤩 [9468, 97, 102]

O: 🕵🏽‍♀️ [9468, 243, 113, 9468, 237, 121, 102470, 32990, 31643]
N: 🧘‍♀️ [9468, 100, 246, 102470, 32990, 31643]

O: 🍯 [9468, 235, 107]
N: 🍯 [9468, 235, 107]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.79s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.45s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.11s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.68s/it]
Processing depth (2, 3, 5, 6, 7):   1%|          | 1/100 [00:37<34:20, 20.81s/it]2025-01-22 04:22:07.660 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the kitchen.
2025-01-22 04:22:07.669 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1793, 1798) --> . Sandra moved to the
2025-01-22 04:22:07.670 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra took the football.
2025-01-22 04:22:07.685 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2888, 2892) -->  Sandra took the football
2025-01-22 04:22:07.685 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the garden.
2025-01-22 04:22:07.709 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4148, 4154) --> . Sandra went back to the
2025-01-22 04:22:07.709 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra discarded the football.
2025-01-22 04:22:07.731 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4630, 4634) -->  Sandra discarded the football
2025-01-22 04:22:07.731 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary journeyed to the garden.
2025-01-22 04:22:07.759 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5627, 5633) --> . Mary journeyed to the
2025-01-22 04:22:07.759 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went to the kitchen.
2025-01-22 04:22:07.787 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4795, 4800) -->  the senate. John went
2025-01-22 04:22:07.787 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John grabbed the apple.
2025-01-22 04:22:07.814 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5635, 5639) -->  John grabbed the apple
2025-01-22 04:22:07.814 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary took the milk.
2025-01-22 04:22:07.818 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (896, 900) -->  Mary took the milk
2025-01-22 04:22:07.818 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went back to the bathroom.
2025-01-22 04:22:07.823 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (964, 970) --> . Daniel went back to the
2025-01-22 04:22:07.823 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went back to the bedroom.
2025-01-22 04:22:07.847 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4795, 4801) -->  the senate. John went back
2025-01-22 04:22:07.847 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel journeyed to the hallway.
2025-01-22 04:22:07.874 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (4734, 4740) --> . Daniel journeyed to the
2025-01-22 04:22:07.874 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Daniel went back to the kitchen.
2025-01-22 04:22:07.880 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (964, 970) --> . Daniel went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:22:08.672 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 04:22:08.673 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8176])
2025-01-22 04:22:10.900 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [236.3925, 19.776149284753636, 120.84755067567568, 18.648263290008625, 27.022844587053573], 'topk_indices': array([   3, 8065,  970,   23, 2891, 8175,    9,  899,   24, 8055,  900,
       2894, 1795,   14, 8174, 1798, 8171, 1794, 8172,    0]), 'topk_tokens': ['<|end_header_id|>', ' location', ' bathroom', '4', ' football', '\n\n', ':', ' milk', '\n\n', '.\n\n', '.', '��', ' moved', '\n', '<|end_header_id|>', ' kitchen', '<|eot_id|>', ' Sandra', '<|start_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [492.75, 265.65625, 201.64583333333334, 176.359375, 78.02083333333333]}, 'weight': {'score': [23.7275, 23.2634777326079, 22.878800675675677, 23.26380205125046, 30.018973214285715], 'topk_indices': array([3306, 3333, 3226, 3178, 7412, 7450, 1485, 1423, 4316, 4332, 5214,
       5153, 7133, 7189, 3489, 3515, 4971, 4923, 5000, 4948]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.040625, 28.240234375, 21.869791666666668, 30.873046875, 20.052083333333332]}, 'saliency': {'score': [1.5340576171875, 0.11057289049843731, 0.714381862331081, 0.10343625749054838, 0.2022536141531808], 'topk_indices': array([1792, 8173,  897, 2888,   24, 8163, 8149, 8165, 8055, 8161, 4154,
       8065, 8169, 2891, 2894,  970,  899, 1795, 1798, 1794]), 'topk_tokens': [' Mr', 'assistant', ' took', ' Sandra', '\n\n', ' discarded', 'Question', ' left', '.\n\n', ' football', ' garden', ' location', 'Answer', ' football', '��', ' bathroom', ' milk', ' moved', ' kitchen', ' Sandra'], 'evidence_proportions': [3.1529296875, 1.99072265625, 1.0626627604166667, 1.43035888671875, 0.42108154296875]}}, 'pred_res': 'The garden.<|eot_id|>', 'score': 0}
2025-01-22 04:22:10.907 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:22:10.908 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-23_pid-1_2-3-5-6-7.pkl | len: 3 |  size: 2.1 KB
Processing depth (2, 3, 5, 6, 7):   2%|▏         | 2/100 [00:40<32:58, 20.19s/it]is_0k: False
your chose emoji: ['✌🏻', '🏥', '🤦🏿', '\U0001faf0🏼', '💁🏾\u200d♀', '🇼🇫', '🏋\u200d♀️', '▫️', '🧙🏻\u200d♀', '🚶\u200d➡️']
emoji:
O: ✌🏻 [38798, 234, 9468, 237, 119]
N: 🤦🏿 [9468, 97, 99, 9468, 237, 123]

O: 🏥 [9468, 237, 98]
N: ▫️ [10634, 104, 31643]

O: 🤦🏿 [9468, 97, 99, 9468, 237, 123]
N: 🧙🏻‍♀ [9468, 100, 247, 9468, 237, 119, 102470, 32990]

O: 🫰🏼 [9468, 104, 108, 9468, 237, 120]
N: 🇼🇫 [9468, 110771, 9468, 229, 104]

O: 💁🏾‍♀ [93273, 223, 9468, 237, 122, 102470, 32990]
N: 💁🏾‍♀ [93273, 223, 9468, 237, 122, 102470, 32990]

O: 🇼🇫 [9468, 110771, 9468, 229, 104]
N: 🏋‍♀️ [9468, 237, 233, 102470, 32990, 31643]

O: 🏋‍♀️ [9468, 237, 233, 102470, 32990, 31643]
N: 🫰🏼 [9468, 104, 108, 9468, 237, 120]

O: ▫️ [10634, 104, 31643]
N: ✌🏻 [38798, 234, 9468, 237, 119]

O: 🧙🏻‍♀ [9468, 100, 247, 9468, 237, 119, 102470, 32990]
N: 🏥 [9468, 237, 98]

O: 🚶‍➡️ [9468, 248, 114, 102470, 98115, 94, 31643]
N: 🚶‍➡️ [9468, 248, 114, 102470, 98115, 94, 31643]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.24s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.66s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.52s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.13s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.64s/it]
Processing depth (2, 5, 6, 8, 9):   2%|▏         | 2/100 [00:56<32:58, 20.19s/it]2025-01-22 04:22:27.159 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the kitchen.
2025-01-22 04:22:27.168 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1759, 1764) --> . Sandra moved to the
2025-01-22 04:22:27.168 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra took the football.
2025-01-22 04:22:27.188 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4235, 4239) -->  took the football.
2025-01-22 04:22:27.188 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the garden.
2025-01-22 04:22:27.214 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4784, 4790) -->  the senate. Sandra went back
2025-01-22 04:22:27.214 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra discarded the football.
2025-01-22 04:22:27.252 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6559, 6563) -->  discarded the football.
2025-01-22 04:22:27.252 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary journeyed to the garden.
2025-01-22 04:22:27.290 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7252, 7258) --> . Mary journeyed to the
2025-01-22 04:22:27.290 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went to the kitchen.
2025-01-22 04:22:27.317 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4949, 4954) -->  John went back to the
2025-01-22 04:22:27.317 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John grabbed the apple.
2025-01-22 04:22:27.344 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5695, 5699) -->  John grabbed the apple
2025-01-22 04:22:27.344 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary took the milk.
2025-01-22 04:22:27.348 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (820, 824) -->  Mary took the milk
2025-01-22 04:22:27.348 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went back to the bathroom.
2025-01-22 04:22:27.353 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (910, 916) --> . Daniel went back to the
2025-01-22 04:22:27.353 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went back to the bedroom.
2025-01-22 04:22:27.380 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4948, 4954) --> . John went back to the
2025-01-22 04:22:27.380 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel journeyed to the hallway.
2025-01-22 04:22:27.407 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (4891, 4897) --> . Daniel journeyed to the
2025-01-22 04:22:27.407 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Daniel went back to the kitchen.
2025-01-22 04:22:27.412 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (910, 916) --> . Daniel went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:22:28.189 | INFO     | test_jbb_embedding:begin_test:693 - the garden<|eot_id|>
2025-01-22 04:22:28.189 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8214])
2025-01-22 04:22:30.425 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [206.30625, 19.67341335037118, 105.49535472972973, 18.711888795217657, 19.838723958333333], 'topk_indices': array([8202, 8186, 8103, 8059, 8188, 8194,   23, 4237, 4792, 8203, 8213,
       8204, 1640, 8093,   24,   14, 1764, 8212, 8209,    0]), 'topk_tokens': [',', '.\n\n', ' location', ' context', ':', ' to', '4', ' football', ' garden', ' left', '\n\n', ' or', ' time', '.\n\n', '\n\n', '\n', ' kitchen', '<|end_header_id|>', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [295.825, 356.25, 138.13541666666666, 291.6875, 42.994791666666664]}, 'weight': {'score': [22.265, 23.287876886333212, 22.07622466216216, 23.296510001532802, 29.644166666666667], 'topk_indices': array([3352, 3325, 3197, 3245, 7486, 7448, 1519, 1457, 4309, 4325, 5156,
       5217, 7146, 7202, 3534, 3508, 4944, 5003, 4919, 4974]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.040625, 20.71484375, 25.809895833333332, 23.34765625, 20.052083333333332]}, 'saliency': {'score': [1.2373193359375, 0.11024803225686838, 0.5971300279771959, 0.10458384875795142, 0.14681884765625], 'topk_indices': array([1718, 8193, 1639, 8187, 6559,   24, 8204, 8093, 8201, 8103,  916,
       8059, 1640, 8199, 8207, 8203, 4792, 1760, 4237, 1764]), 'topk_tokens': [' some', ' prior', ' some', 'Question', ' discarded', '\n\n', ' or', '.\n\n', ' discarded', ' location', ' bathroom', ' context', ' time', ' football', 'Answer', ' left', ' garden', ' Sandra', ' football', ' kitchen'], 'evidence_proportions': [1.79443359375, 1.9842529296875, 0.9403483072916666, 1.743896484375, 0.23435465494791666]}}, 'pred_res': 'the garden<|eot_id|>', 'score': 0}
2025-01-22 04:22:30.437 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:22:30.437 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-23_pid-2_2-5-6-8-9.pkl | len: 3 |  size: 2.07 KB
Processing depth (2, 5, 6, 8, 9):   3%|▎         | 3/100 [01:00<32:09, 19.89s/it]is_0k: False
your chose emoji: ['🐉', '🇬🇧', '🚶🏽\u200d♀\u200d➡️', '🚵🏾\u200d♀', '🤷🏿\u200d♀', '🕰️', '👩🏻\u200d❤\u200d💋\u200d👩🏽', '🥰', '💂🏼', '🧖🏾\u200d♀']
emoji:
O: 🐉 [9468, 238, 231]
N: 💂🏼 [93273, 224, 9468, 237, 120]

O: 🇬🇧 [9468, 229, 105, 9468, 229, 100]
N: 🚶🏽‍♀‍➡️ [9468, 248, 114, 9468, 237, 121, 102470, 32990, 102470, 98115, 94, 31643]

O: 🚶🏽‍♀‍➡️ [9468, 248, 114, 9468, 237, 121, 102470, 32990, 102470, 98115, 94, 31643]
N: 🇬🇧 [9468, 229, 105, 9468, 229, 100]

O: 🚵🏾‍♀ [9468, 248, 113, 9468, 237, 122, 102470, 32990]
N: 👩🏻‍❤‍💋‍👩🏽 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 121]

O: 🤷🏿‍♀ [9468, 97, 115, 9468, 237, 123, 102470, 32990]
N: 🕰️ [9468, 243, 108, 31643]

O: 🕰️ [9468, 243, 108, 31643]
N: 🚵🏾‍♀ [9468, 248, 113, 9468, 237, 122, 102470, 32990]

O: 👩🏻‍❤‍💋‍👩🏽 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 121]
N: 🐉 [9468, 238, 231]

O: 🥰 [9468, 98, 108]
N: 🥰 [9468, 98, 108]

O: 💂🏼 [93273, 224, 9468, 237, 120]
N: 🤷🏿‍♀ [9468, 97, 115, 9468, 237, 123, 102470, 32990]

O: 🧖🏾‍♀ [9468, 100, 244, 9468, 237, 122, 102470, 32990]
N: 🧖🏾‍♀ [9468, 100, 244, 9468, 237, 122, 102470, 32990]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.23s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.65s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.13s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.65s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.26s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (3, 4, 6, 7, 9):   3%|▎         | 3/100 [01:14<32:09, 19.89s/it]2025-01-22 04:22:45.256 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the kitchen.
2025-01-22 04:22:45.270 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2869, 2874) --> . Sandra moved to the
2025-01-22 04:22:45.270 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra took the football.
2025-01-22 04:22:45.287 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3535, 3539) -->  took the football.
2025-01-22 04:22:45.288 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the garden.
2025-01-22 04:22:45.311 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4618, 4624) --> . Sandra went back to the
2025-01-22 04:22:45.311 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra discarded the football.
2025-01-22 04:22:45.338 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5619, 5623) -->  Sandra discarded the football
2025-01-22 04:22:45.338 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary journeyed to the garden.
2025-01-22 04:22:45.375 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7226, 7232) --> . Mary journeyed to the
2025-01-22 04:22:45.375 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went to the kitchen.
2025-01-22 04:22:45.399 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4786, 4791) -->  the senate. John went
2025-01-22 04:22:45.399 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John grabbed the apple.
2025-01-22 04:22:45.426 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5624, 5628) -->  John grabbed the apple
2025-01-22 04:22:45.426 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary took the milk.
2025-01-22 04:22:45.430 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (896, 900) -->  Mary took the milk
2025-01-22 04:22:45.431 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went back to the bathroom.
2025-01-22 04:22:45.435 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (964, 970) --> . Daniel went back to the
2025-01-22 04:22:45.436 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went back to the bedroom.
2025-01-22 04:22:45.460 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4786, 4792) -->  the senate. John went back
2025-01-22 04:22:45.460 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel journeyed to the hallway.
2025-01-22 04:22:45.484 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (4725, 4731) --> . Daniel journeyed to the
2025-01-22 04:22:45.484 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Daniel went back to the kitchen.
2025-01-22 04:22:45.489 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (964, 970) --> . Daniel went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:22:48.712 | INFO     | test_jbb_embedding:begin_test:693 - the garden<|eot_id|>
2025-01-22 04:22:48.712 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8194])
2025-01-22 04:22:51.734 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [221.23875, 18.390701247407588, 100.91934121621621, 17.391959895513214, 30.04627403846154], 'topk_indices': array([8188, 2872, 8154, 4624, 8166, 3538, 3537, 8073, 2871,   23,   24,
         14, 2873, 2870, 8193, 8039, 8192, 2874, 8189,    0]), 'topk_tokens': [':', ' to', ' return', ' garden', '.\n\n', '.', ' football', '.\n\n', ' moved', '4', '\n\n', '\n', ' the', ' Sandra', '\n\n', ' context', '<|end_header_id|>', ' kitchen', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [408.75, 297.1875, 161.84375, 241.21875, 60.421875]}, 'weight': {'score': [22.5234375, 23.270464804196656, 22.878800675675677, 23.274541909956977, 29.52403846153846], 'topk_indices': array([3292, 3265, 3185, 3137, 7426, 7464, 1479, 1417, 4321, 4305, 5205,
       5144, 7176, 7120, 3474, 3500, 4939, 4914, 4991, 4962]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.040625, 20.71484375, 21.869791666666668, 30.873046875, 20.052083333333332]}, 'saliency': {'score': [1.3093603515625, 0.10461469712861794, 0.593906711887669, 0.09868692258566379, 0.22960439828725962], 'topk_indices': array([  20, 8181,   23, 8187, 8173, 8193, 8191, 8154, 5622,  899, 8167,
       8179, 4624,  970, 5620, 2871, 3537, 8039, 2870, 2874]), 'topk_tokens': [' Jul', ' discarded', '4', 'Answer', ' prior', '\n\n', 'assistant', ' return', ' football', ' milk', 'Question', ' football', ' garden', ' bathroom', ' discarded', ' moved', ' football', ' context', ' Sandra', ' kitchen'], 'evidence_proportions': [2.2474609375, 1.573486328125, 0.9137776692708334, 1.9364013671875, 0.3290812174479167]}}, 'pred_res': 'the garden<|eot_id|>', 'score': 0}
2025-01-22 04:22:51.743 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:22:51.743 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-23_pid-3_3-4-6-7-9.pkl | len: 3 |  size: 2.07 KB
Processing depth (3, 4, 6, 7, 9):   4%|▍         | 4/100 [01:21<32:43, 20.45s/it]is_0k: False
your chose emoji: ['\U0001faf4', '🐹', '🐑', '🗂', '💂🏼', '🧍🏿\u200d♂️', '🏃🏻\u200d♂\u200d➡', '🤾\u200d♂️', '👨🏿\u200d🦽', '🦹🏾\u200d♂']
emoji:
O: 🫴 [9468, 104, 112]
N: 🐑 [9468, 238, 239]

O: 🐹 [9468, 238, 117]
N: 💂🏼 [93273, 224, 9468, 237, 120]

O: 🐑 [9468, 238, 239]
N: 🫴 [9468, 104, 112]

O: 🗂 [9468, 245, 224]
N: 🗂 [9468, 245, 224]

O: 💂🏼 [93273, 224, 9468, 237, 120]
N: 👨🏿‍🦽 [9468, 239, 101, 9468, 237, 123, 102470, 9468, 99, 121]

O: 🧍🏿‍♂️ [9468, 100, 235, 9468, 237, 123, 102470, 17245, 224, 31643]
N: 🏃🏻‍♂‍➡ [9468, 237, 225, 9468, 237, 119, 102470, 17245, 224, 102470, 98115, 94]

O: 🏃🏻‍♂‍➡ [9468, 237, 225, 9468, 237, 119, 102470, 17245, 224, 102470, 98115, 94]
N: 🐹 [9468, 238, 117]

O: 🤾‍♂️ [9468, 97, 122, 102470, 17245, 224, 31643]
N: 🤾‍♂️ [9468, 97, 122, 102470, 17245, 224, 31643]

O: 👨🏿‍🦽 [9468, 239, 101, 9468, 237, 123, 102470, 9468, 99, 121]
N: 🧍🏿‍♂️ [9468, 100, 235, 9468, 237, 123, 102470, 17245, 224, 31643]

O: 🦹🏾‍♂ [9468, 99, 117, 9468, 237, 122, 102470, 17245, 224]
N: 🦹🏾‍♂ [9468, 99, 117, 9468, 237, 122, 102470, 17245, 224]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:05<00:16,  5.35s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:10<00:09,  4.98s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.69s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.20s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.83s/it]
Processing depth (0, 3, 5, 7, 9):   4%|▍         | 4/100 [01:38<32:43, 20.45s/it]2025-01-22 04:23:08.852 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the kitchen.
2025-01-22 04:23:08.852 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (32, 37) -->  moved to the kitchen.
2025-01-22 04:23:08.853 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra took the football.
2025-01-22 04:23:08.867 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2987, 2991) -->  Sandra took the football
2025-01-22 04:23:08.867 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the garden.
2025-01-22 04:23:08.888 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4226, 4232) -->  Sandra went back to the garden
2025-01-22 04:23:08.888 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra discarded the football.
2025-01-22 04:23:08.917 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6081, 6085) -->  discarded the football.
2025-01-22 04:23:08.918 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary journeyed to the garden.
2025-01-22 04:23:08.953 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7232, 7238) -->  Mary journeyed to the garden
2025-01-22 04:23:08.954 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went to the kitchen.
2025-01-22 04:23:08.978 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5022, 5027) -->  John went back to the
2025-01-22 04:23:08.978 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John grabbed the apple.
2025-01-22 04:23:09.007 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6085, 6089) -->  John grabbed the apple
2025-01-22 04:23:09.007 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary took the milk.
2025-01-22 04:23:09.011 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (903, 907) -->  Mary took the milk
2025-01-22 04:23:09.011 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went back to the bathroom.
2025-01-22 04:23:09.016 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (971, 977) --> . Daniel went back to the
2025-01-22 04:23:09.016 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went back to the bedroom.
2025-01-22 04:23:09.041 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5021, 5027) --> . John went back to the
2025-01-22 04:23:09.041 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel journeyed to the hallway.
2025-01-22 04:23:09.066 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (4954, 4960) --> . Daniel journeyed to the
2025-01-22 04:23:09.066 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Daniel went back to the kitchen.
2025-01-22 04:23:09.071 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (971, 977) --> . Daniel went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:23:09.830 | INFO     | test_jbb_embedding:begin_test:693 - the garden<|eot_id|>
2025-01-22 04:23:09.830 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8201])
2025-01-22 04:23:12.064 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [272.74375, 27.097001081789372, 136.64864864864865, 25.844903356055024, 19.998133042279413], 'topk_indices': array([8180,    3, 8183, 8080,   32, 8090, 8176, 8174, 8181,    9, 8200,
       6084, 8188, 8175,   24, 8199,   14, 8196,    0, 8197]), 'topk_tokens': [' prior', '<|end_header_id|>', ' place', '.\n\n', ' moved', ' location', ' Where', 'Question', ' to', ':', '\n\n', '.', ' discarded', ':', '\n\n', '<|end_header_id|>', '\n', '<|eot_id|>', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [392.8, 308.9375, 262.1666666666667, 419.875, 61.057291666666664]}, 'weight': {'score': [24.0828125, 23.27309277486592, 22.07622466216216, 23.276045504789977, 29.458180147058822], 'topk_indices': array([3294, 3267, 3139, 3187, 7411, 7449, 1436, 1498, 4295, 4279, 5165,
       5104, 7119, 7175, 3476, 3450, 4867, 4892, 4915, 4944]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.809375, 28.240234375, 25.631510416666668, 23.34765625, 23.813802083333332]}, 'saliency': {'score': [1.7068603515625, 0.15098157387021574, 0.7871753589527027, 0.14331317059210727, 0.13937097437241497], 'topk_indices': array([8184, 2372, 6083,   31, 2386, 4231, 2987, 8183, 8194, 5316, 8090,
         32,   35, 8176, 8186, 2990, 8180, 6081, 8174, 8188]), 'topk_tokens': [' where', 'nes', ' football', 'andra', 'nes', ' garden', ' Sandra', ' place', 'Answer', ' kitchen', ' location', ' moved', ' kitchen', ' Where', ' football', ' football', ' prior', ' discarded', 'Question', ' discarded'], 'evidence_proportions': [2.1208984375, 2.37646484375, 1.7311197916666667, 2.4796142578125, 0.3759969075520833]}}, 'pred_res': 'the garden<|eot_id|>', 'score': 0}
2025-01-22 04:23:12.078 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:23:12.079 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-23_pid-4_0-3-5-7-9.pkl | len: 3 |  size: 2.1 KB
Processing depth (0, 3, 5, 7, 9):   5%|▌         | 5/100 [01:41<32:18, 20.41s/it]Processing depth (0, 3, 5, 7, 9):   5%|▌         | 5/100 [01:41<32:14, 20.36s/it]
2025-01-22 04:23:12.138 | INFO     | __main__:<module>:82 - Selected idx: 24
2025-01-22 04:23:12.138 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the football before the office? 
2025-01-22 04:23:12.138 | INFO     | __main__:<module>:84 - Answer: kitchen
2025-01-22 04:23:12.138 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 04:23:12.138 | INFO     | __main__:<module>:86 - Needle: [' Daniel went back to the bathroom.', ' John went to the kitchen.', ' Mary went to the kitchen.', ' John went back to the bedroom.', ' Mary travelled to the office.', ' John grabbed the football.', ' Daniel journeyed to the hallway.', ' Mary discarded the football.', ' John left the football.']
2025-01-22 04:23:12.138 | INFO     | __main__:<module>:87 - Real Needle: [' Mary went to the kitchen.', ' Mary travelled to the office.', ' Mary discarded the football.', ' John left the football.']
2025-01-22 04:23:12.138 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['⚒', '🏵️', '♒', '👩🏼\u200d🦼\u200d➡️', '👩🏻\u200d🤝\u200d👩🏼', '👩🏿\u200d🚒', '🫂', '▫️', '🤦🏾\u200d♀️', '🥓']
emoji:
O: ⚒ [158, 248, 240]
N: ️🤦🏾‍♀ [31643, 9468, 97, 99, 9468, 237, 122, 102470, 32990]

O: 🏵️ [9468, 237, 113, 31643]
N: �� [240, 158, 248]

O: ♒ [17245, 240]
N: �👩🏿‍� [240, 9468, 239, 102, 9468, 237, 123, 102470, 9468, 248]

O: 👩🏼‍🦼‍➡️ [9468, 239, 102, 9468, 237, 120, 102470, 9468, 99, 120, 102470, 98115, 94, 31643]
N: ️👩🏼‍🦼‍➡ [31643, 9468, 239, 102, 9468, 237, 120, 102470, 9468, 99, 120, 102470, 98115, 94]

O: 👩🏻‍🤝‍👩🏼 [9468, 239, 102, 9468, 237, 119, 102470, 9468, 97, 251, 102470, 9468, 239, 102, 9468, 237, 120]
N: ️🏵 [31643, 9468, 237, 113]

O: 👩🏿‍🚒 [9468, 239, 102, 9468, 237, 123, 102470, 9468, 248, 240]
N: �� [224, 9468, 104]

O: 🫂 [9468, 104, 224]
N: �� [240, 17245]

O: ▫️ [10634, 104, 31643]
N: ️▫ [31643, 10634, 104]

O: 🤦🏾‍♀️ [9468, 97, 99, 9468, 237, 122, 102470, 32990, 31643]
N: �👩🏻‍🤝‍👩� [120, 9468, 239, 102, 9468, 237, 119, 102470, 9468, 97, 251, 102470, 9468, 239, 102, 9468, 237]

O: 🥓 [9468, 98, 241]
N: �� [241, 9468, 98]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.39s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.88s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.88s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.17s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.76s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (1, 4, 6, 8):   0%|          | 0/100 [00:17<?, ?it/s]2025-01-22 04:23:29.332 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary went to the kitchen.
2025-01-22 04:23:29.336 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (657, 662) --> . Mary went to the
2025-01-22 04:23:29.336 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the office.
2025-01-22 04:23:29.356 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3559, 3564) --> . Mary travelled to the
2025-01-22 04:23:29.356 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary discarded the football.
2025-01-22 04:23:29.378 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4622, 4626) -->  Mary discarded the football
2025-01-22 04:23:29.378 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John left the football.
2025-01-22 04:23:29.411 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6512, 6516) -->  John left the football
2025-01-22 04:23:29.411 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went back to the bathroom.
2025-01-22 04:23:29.436 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4575, 4581) -->  Daniel went back to the bathroom
2025-01-22 04:23:29.436 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went to the kitchen.
2025-01-22 04:23:29.440 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (658, 663) -->  Mary went to the kitchen
2025-01-22 04:23:29.440 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the bedroom.
2025-01-22 04:23:29.470 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5348, 5354) --> . John went back to the
2025-01-22 04:23:29.470 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John grabbed the football.
2025-01-22 04:23:29.505 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6923, 6927) -->  John grabbed the football
2025-01-22 04:23:29.505 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel journeyed to the hallway.
2025-01-22 04:23:29.525 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3672, 3678) -->  Daniel journeyed to the hallway
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:23:32.011 | INFO     | test_jbb_embedding:begin_test:693 - the boat landing<|eot_id|>
2025-01-22 04:23:32.012 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8149])
2025-01-22 04:23:34.587 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [257.8854166666667, 26.372360693694798, 165.4247685185185, 25.395223649315408, 36.43311403508772], 'topk_indices': array([8132,  663, 8047,    9, 8037,  662, 8140, 8130, 8142, 8143, 8136,
         24, 1744,   14, 8137, 8147, 8139, 8145, 8144,    0]), 'topk_tokens': [':', '.', ' location', ':', '.\n\n', ' kitchen', '?', '.\n\n', 'Answer', ':', ' football', '\n\n', ' kitchen', '\n', ' before', '<|end_header_id|>', ' office', '<|start_header_id|>', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [301.325, 214.525, 278.578125, 237.09375]}, 'weight': {'score': [23.296875, 23.254230173577035, 24.322916666666668, 23.25057627667448, 29.322916666666668], 'topk_indices': array([3316, 3289, 3161, 3209, 7384, 7422, 1499, 1437, 4301, 4317, 5142,
       5203, 7161, 7105, 3504, 3478, 4919, 4967, 4996, 4944]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.403125, 20.75625, 29.130859375, 25.505859375]}, 'saliency': {'score': [1.6089952256944444, 0.14857661104061887, 1.0965259693287037, 0.1421769357306957, 0.26971114309210525], 'topk_indices': array([8133, 4623, 8003, 1741, 8037, 4702, 8130,   24, 8140,  659, 6515,
       8131, 8047, 4625,  662, 8137, 8142, 8136, 1744, 8139]), 'topk_tokens': [' Where', ' discarded', ' context', ' went', '.\n\n', 'ush', '.\n\n', '\n\n', '?', ' went', ' football', 'Question', ' location', ' football', ' kitchen', ' before', 'Answer', ' football', ' kitchen', ' office'], 'evidence_proportions': [1.62744140625, 1.2109375, 2.09619140625, 1.5963134765625]}}, 'pred_res': 'the boat landing<|eot_id|>', 'score': 0}
2025-01-22 04:23:34.594 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:23:34.594 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-24_pid-0_1-4-6-8.pkl | len: 3 |  size: 2.02 KB
Processing depth (1, 4, 6, 8):   1%|          | 1/100 [00:22<36:54, 22.37s/it]is_0k: False
your chose emoji: ['☘', '🧜🏾\u200d♀', '🍯', '🗑️', '🚣🏾\u200d♀️', '🤦🏾\u200d♀️', '🤞🏻', '📞', '🧑🏾\u200d🔧', '👓']
emoji:
O: ☘ [18107, 246]
N: 🧜🏾‍♀ [9468, 100, 250, 9468, 237, 122, 102470, 32990]

O: 🧜🏾‍♀ [9468, 100, 250, 9468, 237, 122, 102470, 32990]
N: 🤞🏻 [9468, 97, 252, 9468, 237, 119]

O: 🍯 [9468, 235, 107]
N: ☘ [18107, 246]

O: 🗑️ [9468, 245, 239, 31643]
N: 🧑🏾‍🔧 [9468, 100, 239, 9468, 237, 122, 102470, 9468, 242, 100]

O: 🚣🏾‍♀️ [9468, 248, 96, 9468, 237, 122, 102470, 32990, 31643]
N: 📞 [9468, 241, 252]

O: 🤦🏾‍♀️ [9468, 97, 99, 9468, 237, 122, 102470, 32990, 31643]
N: 🗑️ [9468, 245, 239, 31643]

O: 🤞🏻 [9468, 97, 252, 9468, 237, 119]
N: 🍯 [9468, 235, 107]

O: 📞 [9468, 241, 252]
N: 🚣🏾‍♀️ [9468, 248, 96, 9468, 237, 122, 102470, 32990, 31643]

O: 🧑🏾‍🔧 [9468, 100, 239, 9468, 237, 122, 102470, 9468, 242, 100]
N: 🤦🏾‍♀️ [9468, 97, 99, 9468, 237, 122, 102470, 32990, 31643]

O: 👓 [9468, 239, 241]
N: 👓 [9468, 239, 241]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.67s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.84s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.83s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.33s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.87s/it]
Processing depth (1, 2, 3, 7):   1%|          | 1/100 [00:39<36:54, 22.37s/it]2025-01-22 04:23:51.786 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary went to the kitchen.
2025-01-22 04:23:51.790 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (809, 814) --> . Mary went to the
2025-01-22 04:23:51.790 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the office.
2025-01-22 04:23:51.800 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1657, 1662) --> . Mary travelled to the
2025-01-22 04:23:51.800 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary discarded the football.
2025-01-22 04:23:51.817 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2900, 2904) -->  Mary discarded the football
2025-01-22 04:23:51.817 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John left the football.
2025-01-22 04:23:51.844 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5720, 5724) -->  John left the football
2025-01-22 04:23:51.844 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went back to the bathroom.
2025-01-22 04:23:51.868 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4761, 4767) --> . Daniel went back to the
2025-01-22 04:23:51.868 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went to the kitchen.
2025-01-22 04:23:51.872 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (810, 815) -->  Mary went to the kitchen
2025-01-22 04:23:51.872 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the bedroom.
2025-01-22 04:23:51.903 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5634, 5640) --> . John went back to the
2025-01-22 04:23:51.903 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John grabbed the football.
2025-01-22 04:23:51.940 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7047, 7051) -->  John grabbed the football
2025-01-22 04:23:51.940 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel journeyed to the hallway.
2025-01-22 04:23:51.963 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3866, 3872) --> . Daniel journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:23:52.747 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 04:23:52.747 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8233])
2025-01-22 04:23:54.987 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [409.47222222222223, 37.130331016270034, 211.95138888888889, 35.73583429984129, 35.654099589646464], 'topk_indices': array([7050, 2904, 8217, 8224, 1668, 8216, 8121,   14, 8229, 8226, 2903,
       8220, 8214,   24, 8227, 8231, 8221, 8223, 8228,    0]), 'topk_tokens': [' football', '.', ' Where', '?', ' kitchen', ':', '.\n\n', '\n', '<|start_header_id|>', 'Answer', ' football', ' football', '.\n\n', '\n\n', ':', '<|end_header_id|>', ' before', ' office', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [350.95, 333.8, 461.0, 525.6875]}, 'weight': {'score': [23.296875, 23.332905840213694, 22.140625, 23.33691513551459, 30.020991161616163], 'topk_indices': array([3383, 3356, 3276, 3228, 7472, 7510, 1513, 1575, 4342, 4358, 5227,
       5166, 7249, 7193, 3539, 3565, 4968, 4943, 5020, 4991]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.403125, 20.75625, 29.130859375, 25.505859375]}, 'saliency': {'score': [2.5562065972222223, 0.209422529756936, 1.3446090133101851, 0.20052347612852522, 0.2660288184580177], 'topk_indices': array([8131, 5723, 4658, 2901, 5720,   24, 5721, 1662, 8087, 8214, 8217,
        814, 7050, 8215, 1668, 8226, 2903, 8221, 8220, 8223]), 'topk_tokens': [' location', ' football', '�', ' discarded', ' John', '\n\n', ' left', ' office', ' context', '.\n\n', ' Where', ' kitchen', ' football', 'Question', ' kitchen', 'Answer', ' football', ' before', ' football', ' office'], 'evidence_proportions': [1.79287109375, 1.8072265625, 3.4576416015625, 3.545166015625]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 100}
2025-01-22 04:23:54.993 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:23:54.993 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-24_pid-1_1-2-3-7.pkl | len: 3 |  size: 2.04 KB
Processing depth (1, 2, 3, 7):   2%|▏         | 2/100 [00:42<34:38, 21.21s/it]is_0k: False
your chose emoji: ['🥍', '👨🏿\u200d❤\u200d👨🏿', '👩🏻\u200d❤\u200d👩🏼', '👩🏻\u200d❤️\u200d💋\u200d👩🏽', '🏃🏼\u200d♂️\u200d➡️', '\U0001fac6', '🤹🏾\u200d♀️', '💁🏾\u200d♀️', '\U0001faf1🏽', '👨\u200d🦼']
emoji:
O: 🥍 [9468, 98, 235]
N: 🏃🏼‍♂️‍➡️ [9468, 237, 225, 9468, 237, 120, 102470, 17245, 224, 31643, 102470, 98115, 94, 31643]

O: 👨🏿‍❤‍👨🏿 [9468, 239, 101, 9468, 237, 123, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 123]
N: 👨🏿‍❤‍👨🏿 [9468, 239, 101, 9468, 237, 123, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 123]

O: 👩🏻‍❤‍👩🏼 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 102470, 9468, 239, 102, 9468, 237, 120]
N: 🫱🏽 [9468, 104, 109, 9468, 237, 121]

O: 👩🏻‍❤️‍💋‍👩🏽 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 121]
N: 👩🏻‍❤️‍💋‍👩🏽 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 121]

O: 🏃🏼‍♂️‍➡️ [9468, 237, 225, 9468, 237, 120, 102470, 17245, 224, 31643, 102470, 98115, 94, 31643]
N: 🥍 [9468, 98, 235]

O: 🫆 [9468, 104, 228]
N: 👩🏻‍❤‍👩🏼 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 102470, 9468, 239, 102, 9468, 237, 120]

O: 🤹🏾‍♀️ [9468, 97, 117, 9468, 237, 122, 102470, 32990, 31643]
N: 🤹🏾‍♀️ [9468, 97, 117, 9468, 237, 122, 102470, 32990, 31643]

O: 💁🏾‍♀️ [93273, 223, 9468, 237, 122, 102470, 32990, 31643]
N: 💁🏾‍♀️ [93273, 223, 9468, 237, 122, 102470, 32990, 31643]

O: 🫱🏽 [9468, 104, 109, 9468, 237, 121]
N: 🫆 [9468, 104, 228]

O: 👨‍🦼 [9468, 239, 101, 102470, 9468, 99, 120]
N: 👨‍🦼 [9468, 239, 101, 102470, 9468, 99, 120]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.35s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.60s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.15s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.69s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.29s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (1, 3, 4, 5):   2%|▏         | 2/100 [00:57<34:38, 21.21s/it]2025-01-22 04:24:09.966 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary went to the kitchen.
2025-01-22 04:24:09.971 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (819, 824) --> . Mary went to the
2025-01-22 04:24:09.971 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the office.
2025-01-22 04:24:09.986 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2881, 2886) --> . Mary travelled to the
2025-01-22 04:24:09.986 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary discarded the football.
2025-01-22 04:24:10.004 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3600, 3604) -->  Mary discarded the football
2025-01-22 04:24:10.004 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John left the football.
2025-01-22 04:24:10.024 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4158, 4162) -->  John left the football
2025-01-22 04:24:10.024 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went back to the bathroom.
2025-01-22 04:24:10.048 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4712, 4718) --> . Daniel went back to the
2025-01-22 04:24:10.048 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went to the kitchen.
2025-01-22 04:24:10.052 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (820, 825) -->  Mary went to the kitchen
2025-01-22 04:24:10.052 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the bedroom.
2025-01-22 04:24:10.080 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5435, 5441) --> . John went back to the
2025-01-22 04:24:10.080 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John grabbed the football.
2025-01-22 04:24:10.118 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6911, 6915) -->  John grabbed the football
2025-01-22 04:24:10.118 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel journeyed to the hallway.
2025-01-22 04:24:10.138 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3798, 3804) --> . Daniel journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:24:14.154 | INFO     | test_jbb_embedding:begin_test:693 - The hallway.<|eot_id|>
2025-01-22 04:24:14.154 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8179])
2025-01-22 04:24:17.558 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [248.64236111111111, 25.51150009166463, 144.32175925925927, 24.62367503379624, 43.76453993055556], 'topk_indices': array([4161,    9, 8106, 8160, 3603, 8172, 8067,   23, 8166, 8167, 8169,
       8175,    3, 8173,   24, 8107,   14, 8177, 8174,    0]), 'topk_tokens': [' football', ':', ' to', '.\n\n', ' football', 'Answer', '.\n\n', '4', ' football', ' before', ' office', '<|start_header_id|>', '<|end_header_id|>', ':', '\n\n', ' the', '\n', '<|end_header_id|>', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [241.775, 148.0875, 332.5, 299.0625]}, 'weight': {'score': [23.296875, 23.28361609325348, 22.140625, 23.28737940887305, 29.72829861111111], 'topk_indices': array([3283, 3310, 3155, 3203, 7438, 7400, 1477, 1415, 4315, 4299, 5196,
       5135, 7177, 7121, 3466, 3492, 4912, 4960, 4937, 4989]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.403125, 20.75625, 29.130859375, 25.505859375]}, 'saliency': {'score': [1.5900065104166667, 0.14358709237884992, 0.9298864293981481, 0.13777836291784443, 0.32836490207248265], 'topk_indices': array([  20, 8148, 8160,   23, 8067, 4727,   24, 8033, 8161, 6914, 8105,
       3601, 1796, 8167,  824, 4161, 8169, 3603, 8166, 8172]), 'topk_tokens': [' Jul', ' return', '.\n\n', '4', '.\n\n', '�', '\n\n', ' context', 'Question', ' football', ' moved', ' discarded', ' kitchen', ' before', ' kitchen', ' football', ' office', ' football', ' football', 'Answer'], 'evidence_proportions': [1.2609375, 0.79384765625, 2.55078125, 2.0357666015625]}}, 'pred_res': 'The hallway.<|eot_id|>', 'score': 0}
2025-01-22 04:24:17.565 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:24:17.565 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-24_pid-2_1-3-4-5.pkl | len: 3 |  size: 2.03 KB
Processing depth (1, 3, 4, 5):   3%|▎         | 3/100 [01:05<35:17, 21.83s/it]is_0k: False
your chose emoji: ['☕', '🏌🏿\u200d♂', '🧔\u200d♂', '🤶🏻', '👩🏾\u200d⚕', '✌️', '👨🏽\u200d🌾', '☝', '🇵🇼', '👩🏽\u200d❤️\u200d💋\u200d👩🏻']
emoji:
O: ☕ [18107, 243]
N: 🇵🇼 [9468, 229, 113, 9468, 110771]

O: 🏌🏿‍♂ [9468, 237, 234, 9468, 237, 123, 102470, 17245, 224]
N: 🧔‍♂ [9468, 100, 242, 102470, 17245, 224]

O: 🧔‍♂ [9468, 100, 242, 102470, 17245, 224]
N: 🤶🏻 [9468, 97, 114, 9468, 237, 119]

O: 🤶🏻 [9468, 97, 114, 9468, 237, 119]
N: ✌️ [38798, 234, 31643]

O: 👩🏾‍⚕ [9468, 239, 102, 9468, 237, 122, 102470, 158, 248, 243]
N: 👨🏽‍🌾 [9468, 239, 101, 9468, 237, 121, 102470, 9468, 234, 122]

O: ✌️ [38798, 234, 31643]
N: 🏌🏿‍♂ [9468, 237, 234, 9468, 237, 123, 102470, 17245, 224]

O: 👨🏽‍🌾 [9468, 239, 101, 9468, 237, 121, 102470, 9468, 234, 122]
N: ☕ [18107, 243]

O: ☝ [18107, 251]
N: 👩🏾‍⚕ [9468, 239, 102, 9468, 237, 122, 102470, 158, 248, 243]

O: 🇵🇼 [9468, 229, 113, 9468, 110771]
N: ☝ [18107, 251]

O: 👩🏽‍❤️‍💋‍👩🏻 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 119]
N: 👩🏽‍❤️‍💋‍👩🏻 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 119]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.53s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.83s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.83s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.35s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.87s/it]
Processing depth (0, 3, 6, 9):   3%|▎         | 3/100 [01:22<35:17, 21.83s/it]2025-01-22 04:24:34.731 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary went to the kitchen.
2025-01-22 04:24:34.732 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  went to the kitchen.
2025-01-22 04:24:34.732 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the office.
2025-01-22 04:24:34.747 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2925, 2930) --> . Mary travelled to the
2025-01-22 04:24:34.747 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary discarded the football.
2025-01-22 04:24:34.771 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4726, 4730) -->  Mary discarded the football
2025-01-22 04:24:34.771 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John left the football.
2025-01-22 04:24:34.808 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7114, 7118) -->  left the football.
2025-01-22 04:24:34.809 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went back to the bathroom.
2025-01-22 04:24:34.835 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4618, 4624) --> . Daniel went back to the
2025-01-22 04:24:34.835 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went to the kitchen.
2025-01-22 04:24:34.836 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (31, 36) -->  went to the kitchen.
2025-01-22 04:24:34.836 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the bedroom.
2025-01-22 04:24:34.864 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5436, 5442) --> . John went back to the
2025-01-22 04:24:34.864 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John grabbed the football.
2025-01-22 04:24:34.898 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6968, 6972) -->  John grabbed the football
2025-01-22 04:24:34.899 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel journeyed to the hallway.
2025-01-22 04:24:34.920 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3805, 3811) --> . Daniel journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:24:36.284 | INFO     | test_jbb_embedding:begin_test:693 - John grabbed the football. 
In the fall of 1860 the first telegraph line was completed to St.<|eot_id|>
2025-01-22 04:24:36.284 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8149])
2025-01-22 04:24:39.516 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [160.03993055555554, 19.108186641315015, 130.74884259259258, 18.42346120636487, 19.115165844298247], 'topk_indices': array([  25, 8136, 8145, 8037, 8130, 4730,    4,   23, 6090,    9,    1,
       4729, 6968, 8144, 6971,   24,    3,   14, 8147,    0]), 'topk_tokens': ['<|eot_id|>', ' football', '<|start_header_id|>', '.\n\n', '.\n\n', '.', '\n\n', '4', 'the', ':', '<|start_header_id|>', ' football', ' John', '<|eot_id|>', ' football', '\n\n', '<|end_header_id|>', '\n', '<|end_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [134.8, 125.54375, 255.78125, 138.96875]}, 'weight': {'score': [22.26953125, 23.24737602735525, 21.283854166666668, 23.25608656099667, 28.82483552631579], 'topk_indices': array([3310, 3283, 3155, 3203, 7402, 7440, 1417, 1479, 4293, 4309, 5201,
       5140, 7123, 7179, 3504, 3478, 4930, 4905, 4982, 4953]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.565625, 20.75625, 29.130859375, 20.6796875]}, 'saliency': {'score': [0.97271728515625, 0.10684834518657231, 0.8122965494791666, 0.1025763897856405, 0.14011985377261513], 'topk_indices': array([8037, 8121,   20, 8118,   16, 8142,   14, 8130,   23, 5954,    8,
       8003, 6090,   24, 4727, 6969, 8136, 6968, 4729, 6971]), 'topk_tokens': ['.\n\n', ' directly', ' Jul', ' return', ' Date', 'Answer', '\n', '.\n\n', '4', ' way', ' Date', ' context', 'the', '\n\n', ' discarded', ' grabbed', ' football', ' John', ' football', ' football'], 'evidence_proportions': [0.683447265625, 0.6855224609375, 1.949951171875, 0.716064453125]}}, 'pred_res': 'John grabbed the football. \nIn the fall of 1860 the first telegraph line was completed to St.<|eot_id|>', 'score': 0}
2025-01-22 04:24:39.523 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:24:39.523 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-24_pid-3_0-3-6-9.pkl | len: 3 |  size: 2.11 KB
Processing depth (0, 3, 6, 9):   4%|▍         | 4/100 [01:27<35:00, 21.88s/it]is_0k: False
your chose emoji: ['🇽🇰', '🤲🏽', '🦸🏿\u200d♀️', '🧖🏽\u200d♀', '◀', '\U0001faf7🏾', '🙌🏿', '🚵🏽', '7️⃣', '🚆']
emoji:
O: 🇽🇰 [9468, 229, 121, 9468, 229, 108]
N: 🙌🏿 [9468, 247, 234, 9468, 237, 123]

O: 🤲🏽 [9468, 97, 110, 9468, 237, 121]
N: 7️⃣ [22, 31643, 158, 225, 96]

O: 🦸🏿‍♀️ [9468, 99, 116, 9468, 237, 123, 102470, 32990, 31643]
N: 🦸🏿‍♀️ [9468, 99, 116, 9468, 237, 123, 102470, 32990, 31643]

O: 🧖🏽‍♀ [9468, 100, 244, 9468, 237, 121, 102470, 32990]
N: 🚵🏽 [9468, 248, 113, 9468, 237, 121]

O: ◀ [41832, 222]
N: 🤲🏽 [9468, 97, 110, 9468, 237, 121]

O: 🫷🏾 [9468, 104, 115, 9468, 237, 122]
N: 🫷🏾 [9468, 104, 115, 9468, 237, 122]

O: 🙌🏿 [9468, 247, 234, 9468, 237, 123]
N: 🇽🇰 [9468, 229, 121, 9468, 229, 108]

O: 🚵🏽 [9468, 248, 113, 9468, 237, 121]
N: ◀ [41832, 222]

O: 7️⃣ [22, 31643, 158, 225, 96]
N: 🧖🏽‍♀ [9468, 100, 244, 9468, 237, 121, 102470, 32990]

O: 🚆 [9468, 248, 228]
N: 🚆 [9468, 248, 228]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.30s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.73s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.68s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.28s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.77s/it]
Processing depth (3, 5, 6, 9):   4%|▍         | 4/100 [01:44<35:00, 21.88s/it]2025-01-22 04:24:56.531 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary went to the kitchen.
2025-01-22 04:24:56.542 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1750, 1755) -->  John went to the kitchen
2025-01-22 04:24:56.542 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the office.
2025-01-22 04:24:56.564 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4146, 4151) --> . Mary travelled to the
2025-01-22 04:24:56.565 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary discarded the football.
2025-01-22 04:24:56.590 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4730, 4734) -->  Mary discarded the football
2025-01-22 04:24:56.590 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John left the football.
2025-01-22 04:24:56.630 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7126, 7130) -->  left the football.
2025-01-22 04:24:56.630 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went back to the bathroom.
2025-01-22 04:24:56.657 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4622, 4628) --> . Daniel went back to the
2025-01-22 04:24:56.657 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went to the kitchen.
2025-01-22 04:24:56.666 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1749, 1754) --> . John went to the
2025-01-22 04:24:56.666 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the bedroom.
2025-01-22 04:24:56.697 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5550, 5556) --> . John went back to the
2025-01-22 04:24:56.697 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John grabbed the football.
2025-01-22 04:24:56.736 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6920, 6924) -->  John grabbed the football
2025-01-22 04:24:56.737 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel journeyed to the hallway.
2025-01-22 04:24:56.758 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3763, 3769) --> . Daniel journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:24:57.563 | INFO     | test_jbb_embedding:begin_test:693 - The boat landing.<|eot_id|>
2025-01-22 04:24:57.563 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8169])
2025-01-22 04:24:59.794 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [373.24305555555554, 39.91141626896721, 293.125, 38.331899070997906, 31.714785447761194], 'topk_indices': array([   9, 8022, 7129, 8163, 8057,   24, 4734, 8067, 4733, 8157, 8159,
       8023,   14, 2730, 8156, 8167, 6923, 8165, 8164,    0]), 'topk_tokens': [':', ' you', '.', ':', '.\n\n', '\n\n', '.', ' location', ' football', ' before', ' office', ' context', '\n', ' kitchen', ' football', '<|end_header_id|>', ' football', '<|start_header_id|>', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [255.75, 304.625, 505.5, 473.625]}, 'weight': {'score': [23.34201388888889, 23.27017751162506, 21.111979166666668, 23.27718849975391, 29.389692164179106], 'topk_indices': array([3324, 3297, 3217, 3169, 7452, 7414, 1435, 1497, 4289, 4305, 5193,
       5132, 7191, 7135, 3480, 3506, 4934, 4909, 4957, 4986]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [23.4265625, 20.75625, 29.130859375, 20.6796875]}, 'saliency': {'score': [2.3031412760416665, 0.2249743610518386, 1.7796314380787037, 0.21520658136074197, 0.23676766922224812], 'topk_indices': array([8021, 8057, 8066, 8153, 7128, 8151, 8022, 6920, 4148, 4731, 8157,
       8162, 6921, 8067, 8159, 4733, 8023, 2730, 8156, 6923]), 'topk_tokens': [' provided', '.\n\n', ' first', ' Where', ' football', 'Question', ' you', ' John', ' travelled', ' discarded', ' before', 'Answer', ' grabbed', ' location', ' office', ' football', ' context', ' kitchen', ' football', ' football'], 'evidence_proportions': [1.63642578125, 1.7302734375, 3.772216796875, 2.383544921875]}}, 'pred_res': 'The boat landing.<|eot_id|>', 'score': 0}
2025-01-22 04:24:59.803 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:24:59.803 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-24_pid-4_3-5-6-9.pkl | len: 3 |  size: 2.06 KB
Processing depth (3, 5, 6, 9):   5%|▌         | 5/100 [01:47<33:43, 21.30s/it]Processing depth (3, 5, 6, 9):   5%|▌         | 5/100 [01:47<34:05, 21.53s/it]
2025-01-22 04:24:59.891 | INFO     | __main__:<module>:82 - Selected idx: 25
2025-01-22 04:24:59.891 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the location prior to the place where the milk was discarded, left or dropped?
2025-01-22 04:24:59.891 | INFO     | __main__:<module>:84 - Answer: kitchen
2025-01-22 04:24:59.891 | INFO     | __main__:<module>:85 - Tag: 4-hop
2025-01-22 04:24:59.891 | INFO     | __main__:<module>:86 - Needle: [' Mary went to the kitchen.', ' Daniel went back to the bathroom.', ' John grabbed the football.', ' Mary took the milk.', ' John went to the kitchen.', ' John went back to the bedroom.', ' Mary travelled to the office.', ' Daniel journeyed to the hallway.', ' Mary discarded the milk.', ' John left the football.']
2025-01-22 04:24:59.891 | INFO     | __main__:<module>:87 - Real Needle: [' Mary went to the kitchen.', ' Mary took the milk.', ' Mary travelled to the office.', ' Mary discarded the milk.', ' John left the football.']
2025-01-22 04:24:59.891 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['🖐🏽', '🧛🏿\u200d♂️', '🧑🏿\u200d❤️\u200d🧑🏼', '🇺🇿', '↙', '🖲️', '🧑🏼\u200d🔧', '🚑', '🍦', '🙆\u200d♂️']
emoji:
O: 🖐🏽 [9468, 244, 238, 9468, 237, 121]
N: ↙ [27017, 247]

O: 🧛🏿‍♂️ [9468, 100, 249, 9468, 237, 123, 102470, 17245, 224, 31643]
N: 🧑🏿‍❤️‍🧑🏼 [9468, 100, 239, 9468, 237, 123, 102470, 121643, 31643, 102470, 9468, 100, 239, 9468, 237, 120]

O: 🧑🏿‍❤️‍🧑🏼 [9468, 100, 239, 9468, 237, 123, 102470, 121643, 31643, 102470, 9468, 100, 239, 9468, 237, 120]
N: 🖐🏽 [9468, 244, 238, 9468, 237, 121]

O: 🇺🇿 [9468, 229, 118, 9468, 229, 123]
N: 🍦 [9468, 235, 99]

O: ↙ [27017, 247]
N: 🚑 [9468, 248, 239]

O: 🖲️ [9468, 244, 110, 31643]
N: 🧛🏿‍♂️ [9468, 100, 249, 9468, 237, 123, 102470, 17245, 224, 31643]

O: 🧑🏼‍🔧 [9468, 100, 239, 9468, 237, 120, 102470, 9468, 242, 100]
N: 🖲️ [9468, 244, 110, 31643]

O: 🚑 [9468, 248, 239]
N: 🇺🇿 [9468, 229, 118, 9468, 229, 123]

O: 🍦 [9468, 235, 99]
N: 🧑🏼‍🔧 [9468, 100, 239, 9468, 237, 120, 102470, 9468, 242, 100]

O: 🙆‍♂️ [9468, 247, 228, 102470, 17245, 224, 31643]
N: 🙆‍♂️ [9468, 247, 228, 102470, 17245, 224, 31643]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.33s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.66s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.81s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.33s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.81s/it]
Processing depth (1, 3, 5, 7, 9):   0%|          | 0/100 [00:16<?, ?it/s]2025-01-22 04:25:16.888 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary went to the kitchen.
2025-01-22 04:25:16.892 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (752, 757) -->  John went to the kitchen
2025-01-22 04:25:16.892 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary took the milk.
2025-01-22 04:25:16.910 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2926, 2930) -->  Mary took the milk
2025-01-22 04:25:16.911 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary travelled to the office.
2025-01-22 04:25:16.931 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4206, 4211) -->  Mary travelled to the office
2025-01-22 04:25:16.931 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary discarded the milk.
2025-01-22 04:25:16.959 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5661, 5665) -->  Mary discarded the milk
2025-01-22 04:25:16.959 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John left the football.
2025-01-22 04:25:16.993 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7240, 7244) -->  John left the football
2025-01-22 04:25:16.993 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went back to the bathroom.
2025-01-22 04:25:17.020 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5343, 5349) --> . Daniel went back to the
2025-01-22 04:25:17.020 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John grabbed the football.
2025-01-22 04:25:17.054 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6985, 6989) -->  John grabbed the football
2025-01-22 04:25:17.054 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went to the kitchen.
2025-01-22 04:25:17.057 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (751, 756) --> . John went to the
2025-01-22 04:25:17.057 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the bedroom.
2025-01-22 04:25:17.076 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3742, 3748) --> . John went back to the
2025-01-22 04:25:17.076 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel journeyed to the hallway.
2025-01-22 04:25:17.113 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6475, 6481) --> . Daniel journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:25:17.950 | INFO     | test_jbb_embedding:begin_test:693 - Mary's kitchen.<|eot_id|>
2025-01-22 04:25:17.950 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8197])
2025-01-22 04:25:20.237 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [1398.3522727272727, 110.10221036585367, 417.19444444444446, 105.60791620660042, 56.87447212837838], 'topk_indices': array([2930, 5659, 8083, 8180, 8182, 5664, 8076, 8086, 8102, 8184, 8114,
       8183, 8106, 5661, 8193, 8115, 5660, 5662, 8116,    0]), 'topk_tokens': ['.', ' St', ' in', ' where', ' milk', ' milk', '.\n\n', ' location', '.\n', ' discarded', ' moved', ' was', ' left', ' Mary', '<|start_header_id|>', ' to', '.', ' discarded', ' the', '<|begin_of_text|>'], 'evidence_proportions': [856.3, 1441.625, 640.05, 3350.0, 1028.875]}, 'weight': {'score': [25.586292613636363, 23.28137766768293, 21.111979166666668, 23.282342657342657, 29.50506756756757], 'topk_indices': array([3276, 3303, 3136, 3184, 7455, 7417, 1485, 1423, 4298, 4282, 5105,
       5166, 7133, 7189, 3459, 3485, 4959, 4930, 4907, 4882]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [23.4265625, 26.169921875, 24.7703125, 28.802734375, 25.505859375]}, 'saliency': {'score': [9.850053267045455, 0.6154196241425305, 2.261736834490741, 0.5850414490936695, 0.41444025812922297], 'topk_indices': array([8179, 8091, 8085, 8115, 8076, 8042, 8080, 8116, 8183, 5659, 8180,
       2929, 8086, 8182, 5664, 8106, 8114, 5661, 8184, 5662]), 'topk_tokens': [' place', ' second', ' first', ' to', '.\n\n', ' context', ' obtained', ' the', ' was', ' St', ' where', ' milk', ' location', ' milk', ' milk', ' left', ' moved', ' Mary', ' discarded', ' discarded'], 'evidence_proportions': [5.2828125, 9.78369140625, 4.54140625, 25.953125, 6.158203125]}}, 'pred_res': "Mary's kitchen.<|eot_id|>", 'score': 100}
2025-01-22 04:25:20.251 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:25:20.251 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-25_pid-0_1-3-5-7-9.pkl | len: 3 |  size: 2.06 KB
Processing depth (1, 3, 5, 7, 9):   1%|          | 1/100 [00:20<33:26, 20.27s/it]is_0k: False
your chose emoji: ['🏃🏼\u200d♀️\u200d➡', '👨\u200d🚀', '🤙🏼', '🧑🏻\u200d❤️\u200d🧑🏼', '🇧🇲', '💁\u200d♀', '⛹🏾\u200d♀️', '💇🏿', '🇾🇪', '🚽']
emoji:
O: 🏃🏼‍♀️‍➡ [9468, 237, 225, 9468, 237, 120, 102470, 32990, 31643, 102470, 98115, 94]
N: 🤙🏼 [9468, 97, 247, 9468, 237, 120]

O: 👨‍🚀 [9468, 239, 101, 102470, 9468, 248, 222]
N: 💇🏿 [93273, 229, 9468, 237, 123]

O: 🤙🏼 [9468, 97, 247, 9468, 237, 120]
N: 🇾🇪 [9468, 229, 122, 9468, 229, 103]

O: 🧑🏻‍❤️‍🧑🏼 [9468, 100, 239, 9468, 237, 119, 102470, 121643, 31643, 102470, 9468, 100, 239, 9468, 237, 120]
N: 👨‍🚀 [9468, 239, 101, 102470, 9468, 248, 222]

O: 🇧🇲 [9468, 229, 100, 9468, 229, 110]
N: 🇧🇲 [9468, 229, 100, 9468, 229, 110]

O: 💁‍♀ [93273, 223, 102470, 32990]
N: 🧑🏻‍❤️‍🧑🏼 [9468, 100, 239, 9468, 237, 119, 102470, 121643, 31643, 102470, 9468, 100, 239, 9468, 237, 120]

O: ⛹🏾‍♀️ [158, 249, 117, 9468, 237, 122, 102470, 32990, 31643]
N: 💁‍♀ [93273, 223, 102470, 32990]

O: 💇🏿 [93273, 229, 9468, 237, 123]
N: ⛹🏾‍♀️ [158, 249, 117, 9468, 237, 122, 102470, 32990, 31643]

O: 🇾🇪 [9468, 229, 122, 9468, 229, 103]
N: 🏃🏼‍♀️‍➡ [9468, 237, 225, 9468, 237, 120, 102470, 32990, 31643, 102470, 98115, 94]

O: 🚽 [9468, 248, 121]
N: 🚽 [9468, 248, 121]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.55s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.55s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.23s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.75s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.36s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (1, 2, 4, 5, 6):   1%|          | 1/100 [00:35<33:26, 20.27s/it]2025-01-22 04:25:35.572 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary went to the kitchen.
2025-01-22 04:25:35.576 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (752, 757) -->  John went to the kitchen
2025-01-22 04:25:35.576 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary took the milk.
2025-01-22 04:25:35.585 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2012, 2016) -->  Mary took the milk
2025-01-22 04:25:35.586 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary travelled to the office.
2025-01-22 04:25:35.604 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3630, 3635) --> . Mary travelled to the
2025-01-22 04:25:35.604 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary discarded the milk.
2025-01-22 04:25:35.634 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4231, 4235) -->  discarded the milk.
2025-01-22 04:25:35.635 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John left the football.
2025-01-22 04:25:35.663 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4813, 4817) -->  John left the football
2025-01-22 04:25:35.663 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went back to the bathroom.
2025-01-22 04:25:35.693 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5455, 5461) --> . Daniel went back to the
2025-01-22 04:25:35.694 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John grabbed the football.
2025-01-22 04:25:35.730 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (7046, 7050) -->  John grabbed the football
2025-01-22 04:25:35.730 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went to the kitchen.
2025-01-22 04:25:35.734 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (751, 756) --> . John went to the
2025-01-22 04:25:35.735 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the bedroom.
2025-01-22 04:25:35.757 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3784, 3790) --> . John went back to the
2025-01-22 04:25:35.758 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel journeyed to the hallway.
2025-01-22 04:25:35.792 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6542, 6548) --> . Daniel journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:25:38.936 | INFO     | test_jbb_embedding:begin_test:693 - the office<|eot_id|>
2025-01-22 04:25:38.937 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8249])
2025-01-22 04:25:42.004 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [196.24644886363637, 18.691256665050897, 85.85648148148148, 17.993990384615383, 9.131220703125], 'topk_indices': array([   1, 2352,    4,    3, 8248, 8243, 8241, 8223, 8222, 8228,  757,
       8229,   23,   14,  906,  756,   24, 8244, 8247,    0]), 'topk_tokens': ['<|start_header_id|>', 'nes', '\n\n', '<|end_header_id|>', '\n\n', ':', '?\n', ':', 'Question', ' prior', '.', ' to', '4', '\n', ' kitchen', ' kitchen', '\n\n', '<|eot_id|>', '<|end_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [306.425, 160.484375, 258.575, 175.8125, 36.80859375]}, 'weight': {'score': [23.622514204545453, 23.328793398570042, 21.111979166666668, 23.335302252224796, 29.84328125], 'topk_indices': array([3289, 3262, 3134, 3182, 7499, 7461, 1473, 1411, 4305, 4321, 5220,
       5159, 7182, 7238, 3445, 3471, 4961, 5013, 4936, 4984]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [23.4265625, 26.169921875, 20.75625, 23.01953125, 25.505859375]}, 'saliency': {'score': [1.2003340287642046, 0.10445690663532325, 0.4482354058159722, 0.10038628416004435, 0.068345947265625], 'topk_indices': array([2015,   19, 8094, 2338, 3635, 8236,   20,   23, 8138,  753, 2366,
       4231, 8242, 2352,   24, 3632, 8228, 8222,  906,  756]), 'topk_tokens': [' milk', '26', ' context', 'nes', ' office', ' discarded', ' Jul', '4', ' location', ' went', 'nes', ' discarded', 'Answer', 'nes', '\n\n', ' travelled', ' prior', 'Question', ' kitchen', ' kitchen'], 'evidence_proportions': [1.93583984375, 1.088623046875, 1.3826171875, 1.12200927734375, 0.243133544921875]}}, 'pred_res': 'the office<|eot_id|>', 'score': 0}
2025-01-22 04:25:42.016 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:25:42.017 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-25_pid-1_1-2-4-5-6.pkl | len: 3 |  size: 2.06 KB
Processing depth (1, 2, 4, 5, 6):   2%|▏         | 2/100 [00:42<34:32, 21.15s/it]is_0k: False
your chose emoji: ['👨🏾\u200d🌾', '👩🏽\u200d❤️\u200d💋\u200d👩🏻', '👨🏼\u200d❤️\u200d💋\u200d👨🏼', '🐈\u200d⬛', '💅', '🙀', '➡️', '👩🏿\u200d❤\u200d💋\u200d👨🏼', '🧑🏾\u200d🔧', '🕵🏻\u200d♀️']
emoji:
O: 👨🏾‍🌾 [9468, 239, 101, 9468, 237, 122, 102470, 9468, 234, 122]
N: 🧑🏾‍🔧 [9468, 100, 239, 9468, 237, 122, 102470, 9468, 242, 100]

O: 👩🏽‍❤️‍💋‍👩🏻 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 119]
N: ➡️ [98115, 94, 31643]

O: 👨🏼‍❤️‍💋‍👨🏼 [9468, 239, 101, 9468, 237, 120, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 120]
N: 💅 [93273, 227]

O: 🐈‍⬛ [9468, 238, 230, 102470, 158, 105, 249]
N: 👩🏿‍❤‍💋‍👨🏼 [9468, 239, 102, 9468, 237, 123, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 120]

O: 💅 [93273, 227]
N: 👩🏽‍❤️‍💋‍👩🏻 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 119]

O: 🙀 [9468, 247, 222]
N: 🐈‍⬛ [9468, 238, 230, 102470, 158, 105, 249]

O: ➡️ [98115, 94, 31643]
N: 👨🏼‍❤️‍💋‍👨🏼 [9468, 239, 101, 9468, 237, 120, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 120]

O: 👩🏿‍❤‍💋‍👨🏼 [9468, 239, 102, 9468, 237, 123, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 120]
N: 🙀 [9468, 247, 222]

O: 🧑🏾‍🔧 [9468, 100, 239, 9468, 237, 122, 102470, 9468, 242, 100]
N: 👨🏾‍🌾 [9468, 239, 101, 9468, 237, 122, 102470, 9468, 234, 122]

O: 🕵🏻‍♀️ [9468, 243, 113, 9468, 237, 119, 102470, 32990, 31643]
N: 🕵🏻‍♀️ [9468, 243, 113, 9468, 237, 119, 102470, 32990, 31643]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.68s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.55s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.45s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.04s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.59s/it]
Processing depth (1, 3, 4, 6, 8):   2%|▏         | 2/100 [00:58<34:32, 21.15s/it]2025-01-22 04:25:58.085 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary went to the kitchen.
2025-01-22 04:25:58.089 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (660, 665) -->  John went to the kitchen
2025-01-22 04:25:58.090 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary took the milk.
2025-01-22 04:25:58.112 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2872, 2876) -->  Mary took the milk
2025-01-22 04:25:58.112 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary travelled to the office.
2025-01-22 04:25:58.130 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3596, 3601) --> . Mary travelled to the
2025-01-22 04:25:58.131 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary discarded the milk.
2025-01-22 04:25:58.155 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4746, 4750) -->  Mary discarded the milk
2025-01-22 04:25:58.156 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John left the football.
2025-01-22 04:25:58.191 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6635, 6639) -->  John left the football
2025-01-22 04:25:58.191 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went back to the bathroom.
2025-01-22 04:25:58.219 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5354, 5360) --> . Daniel went back to the
2025-01-22 04:25:58.220 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John grabbed the football.
2025-01-22 04:25:58.257 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (7000, 7004) -->  John grabbed the football
2025-01-22 04:25:58.257 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went to the kitchen.
2025-01-22 04:25:58.261 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (659, 664) --> . John went to the
2025-01-22 04:25:58.261 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the bedroom.
2025-01-22 04:25:58.281 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3675, 3681) -->  Hon. John went back to
2025-01-22 04:25:58.282 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel journeyed to the hallway.
2025-01-22 04:25:58.315 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6485, 6491) --> . Daniel journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:25:59.085 | INFO     | test_jbb_embedding:begin_test:693 - the kitchen<|eot_id|>
2025-01-22 04:25:59.085 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8185])
2025-01-22 04:26:01.301 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [81.55681818181819, 10.426306981253052, 46.46527777777778, 10.114484465229143, 5.8295754825367645], 'topk_indices': array([   9,   25, 8074, 8149,    1, 8164, 8179, 8157, 8064, 8165,   23,
         24,  854, 7376,   14, 8184, 8183,    0, 8180, 8181]), 'topk_tokens': [':', '<|eot_id|>', ' location', '.', '<|start_header_id|>', ' prior', ':', '.\n\n', '.\n\n', ' to', '4', '\n\n', ' kitchen', 'nes', '\n', '\n\n', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [110.63125, 97.7734375, 77.06875, 79.03125, 37.1328125]}, 'weight': {'score': [24.674005681818183, 23.268172554347824, 22.002314814814813, 23.268571845435556, 29.259191176470587], 'topk_indices': array([3332, 3359, 3204, 3252, 7461, 7423, 1463, 1525, 4332, 4348, 5209,
       5148, 7144, 7200, 3541, 3515, 4925, 4950, 4973, 5002]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [23.4265625, 26.169921875, 20.75625, 28.802734375, 25.505859375]}, 'saliency': {'score': [0.5318270596590909, 0.056027977537631286, 0.24968239113136573, 0.054099454503634126, 0.04277588339412913], 'topk_indices': array([8167, 8157, 7327, 2875,   20, 8158, 8064,   23,  664,   24, 7375,
       7298, 8182, 8178, 8074, 8172, 8184, 8164, 7376,  854]), 'topk_tokens': [' place', '.\n\n', 'nes', ' milk', ' Jul', 'Question', '.\n\n', '4', ' kitchen', '\n\n', ' Min', 'nes', 'assistant', 'Answer', ' location', ' discarded', '\n\n', ' prior', 'nes', ' kitchen'], 'evidence_proportions': [0.7190673828125, 0.6693115234375, 0.4051513671875, 0.60357666015625, 0.24688720703125]}}, 'pred_res': 'the kitchen<|eot_id|>', 'score': 100}
2025-01-22 04:26:01.310 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:26:01.313 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-25_pid-2_1-3-4-6-8.pkl | len: 3 |  size: 2.05 KB
Processing depth (1, 3, 4, 6, 8):   3%|▎         | 3/100 [01:01<32:49, 20.30s/it]is_0k: False
your chose emoji: ['🤵🏻', '💂🏼', '🧖🏾\u200d♀️', '🌤', '👨🏼\u200d🤝\u200d👨🏿', '☁', '🧑🏾\u200d🦼\u200d➡️', '🌶️', '◽', '🇮🇲']
emoji:
O: 🤵🏻 [9468, 97, 113, 9468, 237, 119]
N: 👨🏼‍🤝‍👨🏿 [9468, 239, 101, 9468, 237, 120, 102470, 9468, 97, 251, 102470, 9468, 239, 101, 9468, 237, 123]

O: 💂🏼 [93273, 224, 9468, 237, 120]
N: 🧖🏾‍♀️ [9468, 100, 244, 9468, 237, 122, 102470, 32990, 31643]

O: 🧖🏾‍♀️ [9468, 100, 244, 9468, 237, 122, 102470, 32990, 31643]
N: 🧑🏾‍🦼‍➡️ [9468, 100, 239, 9468, 237, 122, 102470, 9468, 99, 120, 102470, 98115, 94, 31643]

O: 🌤 [9468, 234, 97]
N: 🌤 [9468, 234, 97]

O: 👨🏼‍🤝‍👨🏿 [9468, 239, 101, 9468, 237, 120, 102470, 9468, 97, 251, 102470, 9468, 239, 101, 9468, 237, 123]
N: ◽ [41832, 121]

O: ☁ [18107, 223]
N: 🌶️ [9468, 234, 114, 31643]

O: 🧑🏾‍🦼‍➡️ [9468, 100, 239, 9468, 237, 122, 102470, 9468, 99, 120, 102470, 98115, 94, 31643]
N: 🤵🏻 [9468, 97, 113, 9468, 237, 119]

O: 🌶️ [9468, 234, 114, 31643]
N: 💂🏼 [93273, 224, 9468, 237, 120]

O: ◽ [41832, 121]
N: ☁ [18107, 223]

O: 🇮🇲 [9468, 229, 106, 9468, 229, 110]
N: 🇮🇲 [9468, 229, 106, 9468, 229, 110]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.70s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.72s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.42s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.86s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.49s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 5, 6, 8, 9):   3%|▎         | 3/100 [01:16<32:49, 20.30s/it]2025-01-22 04:26:17.051 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary went to the kitchen.
2025-01-22 04:26:17.051 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  went to the kitchen.
2025-01-22 04:26:17.051 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary took the milk.
2025-01-22 04:26:17.073 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4194, 4198) -->  took the milk.
2025-01-22 04:26:17.073 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary travelled to the office.
2025-01-22 04:26:17.098 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4823, 4828) --> . Mary travelled to the
2025-01-22 04:26:17.098 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary discarded the milk.
2025-01-22 04:26:17.134 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6596, 6600) -->  Mary discarded the milk
2025-01-22 04:26:17.134 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John left the football.
2025-01-22 04:26:17.171 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7256, 7260) -->  John left the football
2025-01-22 04:26:17.171 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went back to the bathroom.
2025-01-22 04:26:17.201 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5308, 5314) -->  Daniel went back to the bathroom
2025-01-22 04:26:17.202 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John grabbed the football.
2025-01-22 04:26:17.236 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6961, 6965) -->  John grabbed the football
2025-01-22 04:26:17.236 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went to the kitchen.
2025-01-22 04:26:17.237 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (31, 36) -->  went to the kitchen.
2025-01-22 04:26:17.237 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the bedroom.
2025-01-22 04:26:17.255 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3719, 3725) --> . John went back to the
2025-01-22 04:26:17.255 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel journeyed to the hallway.
2025-01-22 04:26:17.289 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6446, 6452) --> . Daniel journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:26:19.835 | INFO     | test_jbb_embedding:begin_test:693 - the office<|eot_id|>
2025-01-22 04:26:19.835 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8153])
2025-01-22 04:26:22.573 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [355.5724431818182, 51.29840378249142, 208.81712962962962, 49.948084988281735, 32.80972055288461], 'topk_indices': array([ 675, 5913,   38, 5019, 5914, 8042, 7526, 6043, 7527, 7482,   39,
       7998, 6044, 7191, 5915, 6073, 5020, 6050, 6051,    0]), 'topk_tokens': [' stere', '\n', '***', '185', 'the', ' location', ' Min', ' by', 'nes', 'nes', '\n\n\n', ' context', ' the', ' it', ' way', '�', '4', '\n', 'the', '<|begin_of_text|>'], 'evidence_proportions': [493.05, 429.4375, 233.9, 539.75, 77.7734375]}, 'weight': {'score': [22.74502840909091, 23.244522820622855, 22.33738425925926, 23.248899485012952, 29.239182692307693], 'topk_indices': array([3253, 3280, 3167, 3119, 7419, 7381, 1415, 1477, 4260, 4244, 5144,
       5083, 7147, 7091, 3462, 3436, 4898, 4875, 4850, 4927]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.565625, 20.38671875, 20.75625, 28.802734375, 25.505859375]}, 'saliency': {'score': [2.074862393465909, 0.289263954929653, 1.149707935474537, 0.28155269883954454, 0.24123676006610578], 'topk_indices': array([8132, 6042,    0, 5914, 6597, 8042, 7191, 8140,   38, 7527, 5019,
       7526, 7482,   39,  675, 5915, 5020, 7998, 6073, 6051]), 'topk_tokens': [' prior', ' asked', '<|begin_of_text|>', 'the', ' discarded', ' location', ' it', ' discarded', '***', 'nes', '185', ' Min', 'nes', '\n\n\n', ' stere', ' way', '4', ' context', '�', 'the'], 'evidence_proportions': [2.51171875, 2.1719970703125, 1.27412109375, 4.015380859375, 0.4920654296875]}}, 'pred_res': 'the office<|eot_id|>', 'score': 0}
2025-01-22 04:26:22.578 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:26:22.579 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-25_pid-3_0-5-6-8-9.pkl | len: 3 |  size: 2.01 KB
Processing depth (0, 5, 6, 8, 9):   4%|▍         | 4/100 [01:22<33:05, 20.68s/it]is_0k: False
your chose emoji: ['🧕', '🪢', '👩🏻\u200d🦲', '🇲🇴', '🔏', '🤽🏽\u200d♂', '💆🏻\u200d♀️', '😷', '🇵🇳', '\U0001faf2']
emoji:
O: 🧕 [9468, 100, 243]
N: 😷 [76460, 115]

O: 🪢 [9468, 103, 95]
N: 🪢 [9468, 103, 95]

O: 👩🏻‍🦲 [9468, 239, 102, 9468, 237, 119, 102470, 9468, 99, 110]
N: 🧕 [9468, 100, 243]

O: 🇲🇴 [9468, 229, 110, 9468, 114783]
N: 🇵🇳 [9468, 229, 113, 9468, 229, 111]

O: 🔏 [9468, 242, 237]
N: 🇲🇴 [9468, 229, 110, 9468, 114783]

O: 🤽🏽‍♂ [9468, 97, 121, 9468, 237, 121, 102470, 17245, 224]
N: 🤽🏽‍♂ [9468, 97, 121, 9468, 237, 121, 102470, 17245, 224]

O: 💆🏻‍♀️ [93273, 228, 9468, 237, 119, 102470, 32990, 31643]
N: 👩🏻‍🦲 [9468, 239, 102, 9468, 237, 119, 102470, 9468, 99, 110]

O: 😷 [76460, 115]
N: 🔏 [9468, 242, 237]

O: 🇵🇳 [9468, 229, 113, 9468, 229, 111]
N: 💆🏻‍♀️ [93273, 228, 9468, 237, 119, 102470, 32990, 31643]

O: 🫲 [9468, 104, 110]
N: 🫲 [9468, 104, 110]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.73s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.61s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.44s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.14s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.66s/it]
Processing depth (1, 2, 3, 6, 8):   4%|▍         | 4/100 [01:38<33:05, 20.68s/it]2025-01-22 04:26:38.978 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary went to the kitchen.
2025-01-22 04:26:38.982 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (752, 757) -->  John went to the kitchen
2025-01-22 04:26:38.983 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary took the milk.
2025-01-22 04:26:38.994 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1794, 1798) -->  Mary took the milk
2025-01-22 04:26:38.994 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary travelled to the office.
2025-01-22 04:26:39.011 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2926, 2931) --> . Mary travelled to the
2025-01-22 04:26:39.012 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary discarded the milk.
2025-01-22 04:26:39.039 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4756, 4760) -->  Mary discarded the milk
2025-01-22 04:26:39.039 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John left the football.
2025-01-22 04:26:39.071 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6581, 6585) -->  John left the football
2025-01-22 04:26:39.072 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went back to the bathroom.
2025-01-22 04:26:39.103 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5265, 5271) -->  Daniel went back to the bathroom
2025-01-22 04:26:39.103 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John grabbed the football.
2025-01-22 04:26:39.143 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6976, 6980) -->  John grabbed the football
2025-01-22 04:26:39.144 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went to the kitchen.
2025-01-22 04:26:39.147 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (751, 756) --> . John went to the
2025-01-22 04:26:39.147 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the bedroom.
2025-01-22 04:26:39.166 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3768, 3774) --> . John went back to the
2025-01-22 04:26:39.166 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel journeyed to the hallway.
2025-01-22 04:26:39.203 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6491, 6497) --> . Daniel journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:26:39.967 | INFO     | test_jbb_embedding:begin_test:693 - the office<|eot_id|>
2025-01-22 04:26:39.967 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8233])
2025-01-22 04:26:42.212 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [259.9105113636364, 18.02203360247693, 85.93923611111111, 17.14804911750336, 10.372877038043478], 'topk_indices': array([8122, 8225, 8227, 1797, 8220,   23, 8205, 8212, 8232, 2928, 8213,
       8207,   14, 8206,   24,  756, 8228, 8231, 8229,    0]), 'topk_tokens': [' location', '?\n', ':', ' milk', ' discarded', '4', '.\n\n', ' prior', '\n\n', ' travelled', ' to', ':', '\n', 'Question', '\n\n', ' kitchen', '<|eot_id|>', '<|end_header_id|>', '<|start_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [308.525, 300.3125, 374.0, 218.53125, 57.5078125]}, 'weight': {'score': [24.674005681818183, 23.306351308280718, 22.16550925925926, 23.306438561133504, 29.40523097826087], 'topk_indices': array([3302, 3329, 3138, 3186, 7465, 7503, 1491, 1429, 4320, 4304, 5158,
       5219, 7242, 7186, 3511, 3485, 5012, 4983, 4960, 4935]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [23.4265625, 26.169921875, 20.75625, 28.802734375, 25.505859375]}, 'saliency': {'score': [1.6780561967329546, 0.10015680165821166, 0.4504111961082176, 0.094761582977157, 0.07650673907736073], 'topk_indices': array([1795, 8193, 8230,   23, 8205, 8232, 2931,  826,   24, 4757, 8218,
       8122, 8226, 2927, 1797, 8212, 8220, 2928,  756, 8206]), 'topk_tokens': [' took', ' return', 'assistant', '4', '.\n\n', '\n\n', ' office', ' kitchen', '\n\n', ' discarded', ' milk', ' location', 'Answer', ' Mary', ' milk', ' prior', ' discarded', ' travelled', ' kitchen', 'Question'], 'evidence_proportions': [1.98818359375, 2.0921630859375, 2.1654296875, 1.5936279296875, 0.35150146484375]}}, 'pred_res': 'the office<|eot_id|>', 'score': 0}
2025-01-22 04:26:42.219 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:26:42.219 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-25_pid-4_1-2-3-6-8.pkl | len: 3 |  size: 2.07 KB
Processing depth (1, 2, 3, 6, 8):   5%|▌         | 5/100 [01:42<32:09, 20.31s/it]Processing depth (1, 2, 3, 6, 8):   5%|▌         | 5/100 [01:42<32:23, 20.46s/it]
2025-01-22 04:26:42.292 | INFO     | __main__:<module>:82 - Selected idx: 26
2025-01-22 04:26:42.292 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the football before the office? 
2025-01-22 04:26:42.292 | INFO     | __main__:<module>:84 - Answer: kitchen
2025-01-22 04:26:42.292 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 04:26:42.292 | INFO     | __main__:<module>:86 - Needle: [' Daniel journeyed to the hallway.', ' Mary went to the kitchen.', ' John went to the kitchen.', ' John grabbed the football.', ' John left the football.', ' Mary travelled to the office.', ' Daniel went back to the bathroom.', ' John went back to the bedroom.', ' Mary discarded the football.', ' John got the football there.']
2025-01-22 04:26:42.292 | INFO     | __main__:<module>:87 - Real Needle: [' Mary went to the kitchen.', ' Mary travelled to the office.', ' Mary discarded the football.', ' John got the football there.']
2025-01-22 04:26:42.293 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['🤙🏿', '🤘🏻', '👃🏽', '🖱', '😦', '👨🏾\u200d❤\u200d💋\u200d👨🏼', '👨🏻\u200d🤝\u200d👨🏽', '🧑🏿\u200d❤️\u200d💋\u200d🧑🏽', '⛹🏼', '🧏🏼\u200d♀️']
emoji:
O: 🤙🏿 [9468, 97, 247, 9468, 237, 123]
N: 🖱 [9468, 244, 109]

O: 🤘🏻 [9468, 97, 246, 9468, 237, 119]
N: 🤙🏿 [9468, 97, 247, 9468, 237, 123]

O: 👃🏽 [9468, 239, 225, 9468, 237, 121]
N: 👨🏾‍❤‍💋‍👨🏼 [9468, 239, 101, 9468, 237, 122, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 120]

O: 🖱 [9468, 244, 109]
N: 😦 [76460, 99]

O: 😦 [76460, 99]
N: ⛹🏼 [158, 249, 117, 9468, 237, 120]

O: 👨🏾‍❤‍💋‍👨🏼 [9468, 239, 101, 9468, 237, 122, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 120]
N: 🧑🏿‍❤️‍💋‍🧑🏽 [9468, 100, 239, 9468, 237, 123, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 100, 239, 9468, 237, 121]

O: 👨🏻‍🤝‍👨🏽 [9468, 239, 101, 9468, 237, 119, 102470, 9468, 97, 251, 102470, 9468, 239, 101, 9468, 237, 121]
N: 👃🏽 [9468, 239, 225, 9468, 237, 121]

O: 🧑🏿‍❤️‍💋‍🧑🏽 [9468, 100, 239, 9468, 237, 123, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 100, 239, 9468, 237, 121]
N: 👨🏻‍🤝‍👨🏽 [9468, 239, 101, 9468, 237, 119, 102470, 9468, 97, 251, 102470, 9468, 239, 101, 9468, 237, 121]

O: ⛹🏼 [158, 249, 117, 9468, 237, 120]
N: 🤘🏻 [9468, 97, 246, 9468, 237, 119]

O: 🧏🏼‍♀️ [9468, 100, 237, 9468, 237, 120, 102470, 32990, 31643]
N: 🧏🏼‍♀️ [9468, 100, 237, 9468, 237, 120, 102470, 32990, 31643]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.35s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.81s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.37s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.83s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.45s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (2, 3, 6, 9):   0%|          | 0/100 [00:15<?, ?it/s]2025-01-22 04:26:57.927 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary went to the kitchen.
2025-01-22 04:26:57.937 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1847, 1852) --> . Mary went to the
2025-01-22 04:26:57.937 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the office.
2025-01-22 04:26:57.952 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2971, 2976) -->  tragedy. Mary travelled to
2025-01-22 04:26:57.952 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary discarded the football.
2025-01-22 04:26:57.975 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4758, 4762) -->  discarded the football.
2025-01-22 04:26:57.975 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John got the football there.
2025-01-22 04:26:58.016 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7250, 7255) --> . John got the football
2025-01-22 04:26:58.016 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel journeyed to the hallway.
2025-01-22 04:26:58.039 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4568, 4574) --> . Daniel journeyed to the
2025-01-22 04:26:58.039 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went to the kitchen.
2025-01-22 04:26:58.048 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1848, 1853) -->  Mary went to the kitchen
2025-01-22 04:26:58.048 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John grabbed the football.
2025-01-22 04:26:58.072 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4576, 4580) -->  John grabbed the football
2025-01-22 04:26:58.072 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John left the football.
2025-01-22 04:26:58.083 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2018, 2022) -->  John left the football
2025-01-22 04:26:58.084 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel went back to the bathroom.
2025-01-22 04:26:58.123 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7256, 7262) --> . Daniel went back to the
2025-01-22 04:26:58.123 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John went back to the bedroom.
2025-01-22 04:26:58.158 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (6575, 6581) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:27:05.305 | INFO     | test_jbb_embedding:begin_test:693 - The football was in the hallway.<|eot_id|>
2025-01-22 04:27:05.305 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8147])
2025-01-22 04:27:08.525 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [131.63569078947367, 19.72217791411043, 148.92237903225808, 18.965194830246915, 15.542158018867925], 'topk_indices': array([8120, 8129, 8140, 8143, 8130, 7001,   23, 8134,    9, 8141, 8138,
         24, 8035, 8128,   14, 8135, 8137, 8142, 8145,    0]), 'topk_tokens': ['.', 'Question', 'Answer', '<|start_header_id|>', ':', ' kitchen', '4', ' football', ':', ':', '?', '\n\n', '.\n\n', '.\n\n', '\n', ' before', ' office', '<|eot_id|>', '<|end_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [130.375, 101.440625, 138.265625, 157.7875]}, 'weight': {'score': [22.92064144736842, 23.253784509202454, 22.57484879032258, 23.257164351851852, 29.769162735849058], 'topk_indices': array([3254, 3281, 3174, 3126, 7416, 7378, 1411, 1473, 4255, 4271, 5176,
       5115, 7086, 7142, 3437, 3463, 4880, 4957, 4928, 4905]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.403125, 26.5640625, 23.34765625, 22.453125]}, 'saliency': {'score': [0.7843531558388158, 0.11042824961656442, 0.9367508426789315, 0.10568496892481674, 0.1169105385834316], 'topk_indices': array([  23,   20, 7999, 8001,    8,   24, 8131, 8116, 2021, 4579, 8045,
       8138, 8035, 8128, 8129, 8140, 7001, 8134, 8135, 8137]), 'topk_tokens': ['4', ' Jul', ' provided', ' context', ' Date', '\n\n', ' Where', ' return', ' football', ' football', ' location', '?', '.\n\n', '.\n\n', 'Question', 'Answer', ' kitchen', ' football', ' before', ' office'], 'evidence_proportions': [0.66826171875, 0.6354736328125, 0.8997802734375, 0.956982421875]}}, 'pred_res': 'The football was in the hallway.<|eot_id|>', 'score': 0}
2025-01-22 04:27:08.531 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:27:08.531 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-26_pid-0_2-3-6-9.pkl | len: 3 |  size: 2.02 KB
Processing depth (2, 3, 6, 9):   1%|          | 1/100 [00:26<43:08, 26.14s/it]is_0k: False
your chose emoji: ['🇱🇸', '😣', '🇾🇹', '🏄🏼', '✅', '🙅🏿\u200d♂️', '🏃\u200d♀️\u200d➡️', '🦸🏾', '🦌', '💐']
emoji:
O: 🇱🇸 [9468, 229, 109, 9468, 229, 116]
N: 🇱🇸 [9468, 229, 109, 9468, 229, 116]

O: 😣 [76460, 96]
N: 🏄🏼 [9468, 237, 226, 9468, 237, 120]

O: 🇾🇹 [9468, 229, 122, 9468, 229, 117]
N: 🦌 [9468, 99, 234]

O: 🏄🏼 [9468, 237, 226, 9468, 237, 120]
N: ✅ [38798, 227]

O: ✅ [38798, 227]
N: 🙅🏿‍♂️ [9468, 247, 227, 9468, 237, 123, 102470, 17245, 224, 31643]

O: 🙅🏿‍♂️ [9468, 247, 227, 9468, 237, 123, 102470, 17245, 224, 31643]
N: 🇾🇹 [9468, 229, 122, 9468, 229, 117]

O: 🏃‍♀️‍➡️ [9468, 237, 225, 102470, 32990, 31643, 102470, 98115, 94, 31643]
N: 🦸🏾 [9468, 99, 116, 9468, 237, 122]

O: 🦸🏾 [9468, 99, 116, 9468, 237, 122]
N: 😣 [76460, 96]

O: 🦌 [9468, 99, 234]
N: 🏃‍♀️‍➡️ [9468, 237, 225, 102470, 32990, 31643, 102470, 98115, 94, 31643]

O: 💐 [93273, 238]
N: 💐 [93273, 238]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.51s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.56s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.48s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.17s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.67s/it]
Processing depth (0, 2, 3, 6):   1%|          | 1/100 [00:42<43:08, 26.14s/it]2025-01-22 04:27:24.930 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary went to the kitchen.
2025-01-22 04:27:24.931 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  went to the kitchen.
2025-01-22 04:27:24.931 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the office.
2025-01-22 04:27:24.948 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1867, 1872) --> . Mary travelled to the
2025-01-22 04:27:24.948 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary discarded the football.
2025-01-22 04:27:24.964 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2993, 2997) -->  Mary discarded the football
2025-01-22 04:27:24.964 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John got the football there.
2025-01-22 04:27:24.989 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4738, 4743) -->  John got the football there
2025-01-22 04:27:24.989 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel journeyed to the hallway.
2025-01-22 04:27:25.012 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4613, 4619) --> . Daniel journeyed to the
2025-01-22 04:27:25.012 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went to the kitchen.
2025-01-22 04:27:25.012 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (31, 36) -->  went to the kitchen.
2025-01-22 04:27:25.012 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John grabbed the football.
2025-01-22 04:27:25.038 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4621, 4625) -->  John grabbed the football
2025-01-22 04:27:25.039 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John left the football.
2025-01-22 04:27:25.049 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2038, 2042) -->  John left the football
2025-01-22 04:27:25.049 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel went back to the bathroom.
2025-01-22 04:27:25.084 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7147, 7153) -->  Daniel went back to the bathroom
2025-01-22 04:27:25.084 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John went back to the bedroom.
2025-01-22 04:27:25.122 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (6495, 6501) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:27:26.013 | INFO     | test_jbb_embedding:begin_test:693 - Mary travelled to the office.<|eot_id|>
2025-01-22 04:27:26.013 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8189])
2025-01-22 04:27:28.254 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [303.35855263157896, 36.967002868652344, 265.84274193548384, 35.473931466470155, 23.18433277027027], 'topk_indices': array([2674, 2042, 1704, 8179, 6945, 8184, 2996,   24, 8077, 8176, 8183,
       8177, 1626, 2041, 8187, 8043,   14, 1705, 1627,    0]), 'topk_tokens': [' ne', '.', ' summer', ' office', ' kitchen', '<|eot_id|>', ' football', '\n\n', '.\n\n', ' football', ':', ' before', "'s", ' football', '<|end_header_id|>', ' context', '\n', "'s", ' work', '<|begin_of_text|>'], 'evidence_proportions': [345.625, 253.575, 460.375, 185.2625]}, 'weight': {'score': [23.45394736842105, 23.29062271118164, 22.746219758064516, 23.292314349975435, 29.953125], 'topk_indices': array([3285, 3312, 3145, 3193, 7476, 7438, 1405, 1467, 4264, 4280, 5238,
       5177, 7215, 7159, 3494, 3468, 4995, 4918, 4943, 4966]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.565625, 20.75625, 29.130859375, 25.4984375]}, 'saliency': {'score': [1.8864103618421053, 0.20956140756607056, 1.6053880260836693, 0.20033385225959915, 0.1736798673062711], 'topk_indices': array([8087,    0,   39, 1625, 2600, 1626, 4624, 8182, 2674, 8179, 8177,
       1704, 1705, 2994, 6945, 2996, 8176, 8043, 2041, 1627]), 'topk_tokens': [' location', '<|begin_of_text|>', '\n\n\n', ' summer', 'ared', "'s", ' football', 'Answer', ' ne', ' office', ' before', ' summer', "'s", ' discarded', ' kitchen', ' football', ' football', ' context', ' football', ' work'], 'evidence_proportions': [1.72998046875, 1.38642578125, 3.554931640625, 1.2080078125]}}, 'pred_res': 'Mary travelled to the office.<|eot_id|>', 'score': 0}
2025-01-22 04:27:28.262 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:27:28.263 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-26_pid-1_0-2-3-6.pkl | len: 3 |  size: 2.05 KB
Processing depth (0, 2, 3, 6):   2%|▏         | 2/100 [00:45<36:32, 22.37s/it]is_0k: False
your chose emoji: ['🙍🏿', '👳🏻\u200d♀️', '👨🏼\u200d✈', '🐊', '🚶🏽\u200d♀️\u200d➡️', '👰🏼\u200d♀️', '👳🏼\u200d♂', '🧎🏼\u200d♀', '\U0001faf6', '🙇\u200d♀']
emoji:
O: 🙍🏿 [9468, 247, 235, 9468, 237, 123]
N: 🚶🏽‍♀️‍➡️ [9468, 248, 114, 9468, 237, 121, 102470, 32990, 31643, 102470, 98115, 94, 31643]

O: 👳🏻‍♀️ [9468, 239, 111, 9468, 237, 119, 102470, 32990, 31643]
N: 🙍🏿 [9468, 247, 235, 9468, 237, 123]

O: 👨🏼‍✈ [9468, 239, 101, 9468, 237, 120, 102470, 38798, 230]
N: 👨🏼‍✈ [9468, 239, 101, 9468, 237, 120, 102470, 38798, 230]

O: 🐊 [9468, 238, 232]
N: 👳🏻‍♀️ [9468, 239, 111, 9468, 237, 119, 102470, 32990, 31643]

O: 🚶🏽‍♀️‍➡️ [9468, 248, 114, 9468, 237, 121, 102470, 32990, 31643, 102470, 98115, 94, 31643]
N: 🫶 [9468, 104, 114]

O: 👰🏼‍♀️ [9468, 239, 108, 9468, 237, 120, 102470, 32990, 31643]
N: 🐊 [9468, 238, 232]

O: 👳🏼‍♂ [9468, 239, 111, 9468, 237, 120, 102470, 17245, 224]
N: 👰🏼‍♀️ [9468, 239, 108, 9468, 237, 120, 102470, 32990, 31643]

O: 🧎🏼‍♀ [9468, 100, 236, 9468, 237, 120, 102470, 32990]
N: 👳🏼‍♂ [9468, 239, 111, 9468, 237, 120, 102470, 17245, 224]

O: 🫶 [9468, 104, 114]
N: 🧎🏼‍♀ [9468, 100, 236, 9468, 237, 120, 102470, 32990]

O: 🙇‍♀ [9468, 247, 229, 102470, 32990]
N: 🙇‍♀ [9468, 247, 229, 102470, 32990]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.48s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.26s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.04s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.85s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.35s/it]
Processing depth (3, 6, 7, 9):   2%|▏         | 2/100 [01:00<36:32, 22.37s/it]2025-01-22 04:27:43.421 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary went to the kitchen.
2025-01-22 04:27:43.438 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2818, 2823) --> . Mary went to the
2025-01-22 04:27:43.438 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the office.
2025-01-22 04:27:43.462 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4764, 4769) -->  the senate. Mary travelled
2025-01-22 04:27:43.462 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary discarded the football.
2025-01-22 04:27:43.490 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5721, 5725) -->  Mary discarded the football
2025-01-22 04:27:43.490 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John got the football there.
2025-01-22 04:27:43.528 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7242, 7247) --> . John got the football
2025-01-22 04:27:43.528 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel journeyed to the hallway.
2025-01-22 04:27:43.552 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4559, 4565) -->  Daniel journeyed to the hallway
2025-01-22 04:27:43.552 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went to the kitchen.
2025-01-22 04:27:43.566 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2819, 2824) -->  Mary went to the kitchen
2025-01-22 04:27:43.566 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John grabbed the football.
2025-01-22 04:27:43.589 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4566, 4570) -->  John grabbed the football
2025-01-22 04:27:43.589 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John left the football.
2025-01-22 04:27:43.600 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1849, 1853) -->  left the football.
2025-01-22 04:27:43.600 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel went back to the bathroom.
2025-01-22 04:27:43.645 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7248, 7254) --> . Daniel went back to the
2025-01-22 04:27:43.645 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John went back to the bedroom.
2025-01-22 04:27:43.681 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (6503, 6509) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:27:44.471 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 04:27:44.472 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8187])
2025-01-22 04:27:46.711 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [97.02220394736842, 14.889308608058608, 112.9304435483871, 14.32422258906634, 27.3974609375], 'topk_indices': array([8160, 8178, 8186, 8180, 2823, 8168,    1,   23, 8177, 8041, 8075,
       8175, 8181, 6957,   24,   14, 8183, 8182, 8185,    0]), 'topk_tokens': ['.', '?', '\n\n', 'Answer', ' kitchen', '.\n\n', '<|start_header_id|>', '4', ' office', ' context', '.\n\n', ' before', ':', ' kitchen', '\n\n', '\n', '<|start_header_id|>', '<|eot_id|>', '<|end_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [99.5, 76.803125, 117.8828125, 98.075]}, 'weight': {'score': [23.854029605263158, 23.276011141636143, 22.935231854838708, 23.275959766584766, 29.227525684931507], 'topk_indices': array([3306, 3333, 3178, 3226, 7472, 7434, 1405, 1467, 4301, 4285, 5175,
       5114, 7192, 7136, 3515, 3489, 4891, 4968, 4916, 4939]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.403125, 25.484375, 29.130859375, 22.453125]}, 'saliency': {'score': [0.6216286107113487, 0.08330741388602717, 0.7060192477318549, 0.07967938322399992, 0.204067491505244], 'topk_indices': array([8040,   20,    8, 8159, 8168,   23, 8156, 8075, 4569, 8085, 8039,
         24, 8169, 8174, 8180, 8175, 8177, 8041, 2823, 6957]), 'topk_tokens': [' you', ' Jul', ' Date', ' directly', '.\n\n', '4', ' return', '.\n\n', ' football', ' location', ' provided', '\n\n', 'Question', ' football', 'Answer', ' before', ' office', ' context', ' kitchen', ' kitchen'], 'evidence_proportions': [0.492822265625, 0.541143798828125, 0.92120361328125, 0.591259765625]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 100}
2025-01-22 04:27:46.730 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:27:46.738 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-26_pid-2_3-6-7-9.pkl | len: 3 |  size: 2.03 KB
Processing depth (3, 6, 7, 9):   3%|▎         | 3/100 [01:04<33:17, 20.59s/it]is_0k: False
your chose emoji: ['🎨', '🤸🏾\u200d♀', '🦋', '🧑\u200d🧑\u200d🧒\u200d🧒', '🇲🇻', '💇🏾\u200d♀️', '🚰', '⛽', '👩🏿\u200d❤\u200d💋\u200d👨🏾', '🤟🏿']
emoji:
O: 🎨 [9468, 236, 101]
N: ⛽ [158, 249, 121]

O: 🤸🏾‍♀ [9468, 97, 116, 9468, 237, 122, 102470, 32990]
N: 🎨 [9468, 236, 101]

O: 🦋 [9468, 99, 233]
N: 🇲🇻 [9468, 229, 110, 9468, 229, 119]

O: 🧑‍🧑‍🧒‍🧒 [9468, 100, 239, 102470, 9468, 100, 239, 102470, 9468, 100, 240, 102470, 9468, 100, 240]
N: 💇🏾‍♀️ [93273, 229, 9468, 237, 122, 102470, 32990, 31643]

O: 🇲🇻 [9468, 229, 110, 9468, 229, 119]
N: 🧑‍🧑‍🧒‍🧒 [9468, 100, 239, 102470, 9468, 100, 239, 102470, 9468, 100, 240, 102470, 9468, 100, 240]

O: 💇🏾‍♀️ [93273, 229, 9468, 237, 122, 102470, 32990, 31643]
N: 🤸🏾‍♀ [9468, 97, 116, 9468, 237, 122, 102470, 32990]

O: 🚰 [9468, 248, 108]
N: 🦋 [9468, 99, 233]

O: ⛽ [158, 249, 121]
N: 👩🏿‍❤‍💋‍👨🏾 [9468, 239, 102, 9468, 237, 123, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 122]

O: 👩🏿‍❤‍💋‍👨🏾 [9468, 239, 102, 9468, 237, 123, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 122]
N: 🚰 [9468, 248, 108]

O: 🤟🏿 [9468, 97, 253, 9468, 237, 123]
N: 🤟🏿 [9468, 97, 253, 9468, 237, 123]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.70s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.80s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.35s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.81s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.46s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (1, 3, 4, 8):   3%|▎         | 3/100 [01:19<33:17, 20.59s/it]2025-01-22 04:28:02.404 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary went to the kitchen.
2025-01-22 04:28:02.408 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (815, 820) --> . Mary went to the
2025-01-22 04:28:02.408 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the office.
2025-01-22 04:28:02.422 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2864, 2869) --> . Mary travelled to the
2025-01-22 04:28:02.423 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary discarded the football.
2025-01-22 04:28:02.443 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3599, 3603) -->  Mary discarded the football
2025-01-22 04:28:02.443 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John got the football there.
2025-01-22 04:28:02.481 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6568, 6573) --> . John got the football
2025-01-22 04:28:02.481 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel journeyed to the hallway.
2025-01-22 04:28:02.505 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4514, 4520) -->  Daniel journeyed to the hallway
2025-01-22 04:28:02.505 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went to the kitchen.
2025-01-22 04:28:02.509 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (816, 821) -->  Mary went to the kitchen
2025-01-22 04:28:02.509 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John grabbed the football.
2025-01-22 04:28:02.531 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4521, 4525) -->  John grabbed the football
2025-01-22 04:28:02.531 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John left the football.
2025-01-22 04:28:02.540 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1788, 1792) -->  John left the football
2025-01-22 04:28:02.540 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel went back to the bathroom.
2025-01-22 04:28:02.580 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7186, 7192) --> . Daniel went back to the
2025-01-22 04:28:02.581 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John went back to the bedroom.
2025-01-22 04:28:02.616 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (6463, 6469) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:28:06.711 | INFO     | test_jbb_embedding:begin_test:693 - The boat landing.<|eot_id|>
2025-01-22 04:28:06.712 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8125])
2025-01-22 04:28:09.658 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [426.20394736842104, 37.83440345103347, 294.6491935483871, 35.935383913097304, 26.294549851190474], 'topk_indices': array([3600, 8013, 8109, 8107, 8121, 3602, 8108, 8110, 8119, 1792, 8114,
       8123, 8106, 8116, 1791, 8112, 8120, 8115, 8113,    0]), 'topk_tokens': [' discarded', '.\n\n', ' Where', 'Question', '<|start_header_id|>', ' football', ':', ' was', ':', '.', ' the', '<|end_header_id|>', '.\n\n', '?', ' football', ' football', '<|eot_id|>', ' office', ' before', '<|begin_of_text|>'], 'evidence_proportions': [364.75, 258.575, 697.5, 438.25]}, 'weight': {'score': [22.609786184210527, 23.222375584399607, 23.55796370967742, 23.22252858845011, 28.436383928571427], 'topk_indices': array([3260, 3287, 3132, 3180, 7366, 7404, 1485, 1423, 4282, 4266, 5162,
       5101, 7136, 7080, 3443, 3469, 4926, 4903, 4878, 4955]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.403125, 20.75625, 29.130859375, 22.453125]}, 'saliency': {'score': [2.7066714638157894, 0.21281853623277558, 1.9456629599294355, 0.20030289092964687, 0.18851216634114584], 'topk_indices': array([8094, 1789, 8013, 6572, 6573, 4524, 8023, 8110, 8106, 8116, 8109,
        820, 8118, 8107, 3602, 3600, 1791, 8112, 8113, 8115]), 'topk_tokens': [' return', ' left', '.\n\n', ' football', ' there', ' football', ' location', ' was', '.\n\n', '?', ' Where', ' kitchen', 'Answer', 'Question', ' football', ' discarded', ' football', ' football', ' before', ' office'], 'evidence_proportions': [1.90537109375, 1.42119140625, 5.4033203125, 2.6361328125]}}, 'pred_res': 'The boat landing.<|eot_id|>', 'score': 0}
2025-01-22 04:28:09.683 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:28:09.683 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-26_pid-3_1-3-4-8.pkl | len: 3 |  size: 2.04 KB
Processing depth (1, 3, 4, 8):   4%|▍         | 4/100 [01:27<34:26, 21.52s/it]is_0k: False
your chose emoji: ['👨\u200d⚕', '😰', '👩\u200d🔧', '🪂', '🇦🇬', '🚸', '\U0001faf8🏿', '🖌', '💎', '\U0001fa76']
emoji:
O: 👨‍⚕ [9468, 239, 101, 102470, 158, 248, 243]
N: 🚸 [9468, 248, 116]

O: 😰 [76460, 108]
N: 🖌 [9468, 244, 234]

O: 👩‍🔧 [9468, 239, 102, 102470, 9468, 242, 100]
N: 🪂 [9468, 103, 224]

O: 🪂 [9468, 103, 224]
N: 😰 [76460, 108]

O: 🇦🇬 [9468, 229, 99, 9468, 229, 105]
N: 💎 [93273, 236]

O: 🚸 [9468, 248, 116]
N: 👨‍⚕ [9468, 239, 101, 102470, 158, 248, 243]

O: 🫸🏿 [9468, 104, 116, 9468, 237, 123]
N: 🫸🏿 [9468, 104, 116, 9468, 237, 123]

O: 🖌 [9468, 244, 234]
N: 👩‍🔧 [9468, 239, 102, 102470, 9468, 242, 100]

O: 💎 [93273, 236]
N: 🇦🇬 [9468, 229, 99, 9468, 229, 105]

O: 🩶 [9468, 102, 114]
N: 🩶 [9468, 102, 114]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.94s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.83s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.58s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.21s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.78s/it]
Processing depth (3, 4, 5, 8):   4%|▍         | 4/100 [01:43<34:26, 21.52s/it]2025-01-22 04:28:26.445 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary went to the kitchen.
2025-01-22 04:28:26.460 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2959, 2964) -->  tragedy. Mary went to
2025-01-22 04:28:26.461 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the office.
2025-01-22 04:28:26.479 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3628, 3633) --> . Mary travelled to the
2025-01-22 04:28:26.479 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary discarded the football.
2025-01-22 04:28:26.501 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4247, 4251) -->  Mary discarded the football
2025-01-22 04:28:26.501 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John got the football there.
2025-01-22 04:28:26.534 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6648, 6653) --> . John got the football
2025-01-22 04:28:26.535 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel journeyed to the hallway.
2025-01-22 04:28:26.560 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4675, 4681) --> . Daniel journeyed to the
2025-01-22 04:28:26.560 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went to the kitchen.
2025-01-22 04:28:26.578 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2961, 2966) -->  Mary went to the kitchen
2025-01-22 04:28:26.578 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John grabbed the football.
2025-01-22 04:28:26.603 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4683, 4687) -->  John grabbed the football
2025-01-22 04:28:26.603 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John left the football.
2025-01-22 04:28:26.614 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2006, 2010) -->  John left the football
2025-01-22 04:28:26.614 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel went back to the bathroom.
2025-01-22 04:28:26.654 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7195, 7201) -->  Daniel went back to the bathroom
2025-01-22 04:28:26.655 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John went back to the bedroom.
2025-01-22 04:28:26.691 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (6609, 6615) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:28:27.524 | INFO     | test_jbb_embedding:begin_test:693 - The boat landing.<|eot_id|>
2025-01-22 04:28:27.524 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8149])
2025-01-22 04:28:29.747 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [234.73190789473685, 24.907756532139352, 148.4445564516129, 23.94301947050111, 28.60517939814815], 'topk_indices': array([8142, 4250, 8132, 8148, 3630, 8037, 8140,   23, 8130, 8143,   14,
         24, 2965, 8136, 8137, 8139, 8145, 8144, 8147,    0]), 'topk_tokens': ['Answer', ' football', ':', '\n\n', ' travelled', '.\n\n', '?', '4', '.\n\n', ':', '\n', '\n\n', ' kitchen', ' football', ' before', ' office', '<|start_header_id|>', '<|eot_id|>', '<|end_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [181.75625, 323.0, 263.875, 176.125]}, 'weight': {'score': [24.138157894736842, 23.25205471050049, 23.492439516129032, 23.24905694581585, 29.517939814814813], 'topk_indices': array([3266, 3293, 3138, 3186, 7374, 7412, 1461, 1399, 4256, 4272, 5152,
       5091, 7076, 7132, 3449, 3475, 4868, 4893, 4916, 4945]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [25.2109375, 20.75625, 29.130859375, 22.453125]}, 'saliency': {'score': [1.4710757606907894, 0.14048373266338016, 0.9705751480594758, 0.13418725248443672, 0.2146979437934028], 'topk_indices': array([8037,   20, 8118,   23,   24, 4305, 8140, 8133, 8130, 3633, 8131,
       2009, 4330, 4250, 8142, 3630, 8137, 8139, 2965, 8136]), 'topk_tokens': ['.\n\n', ' Jul', ' return', '4', '\n\n', 'nes', '?', ' Where', '.\n\n', ' office', 'Question', ' football', 'nes', ' football', 'Answer', ' travelled', ' before', ' office', ' kitchen', ' football'], 'evidence_proportions': [1.069091796875, 1.84033203125, 2.0234375, 1.0619140625]}}, 'pred_res': 'The boat landing.<|eot_id|>', 'score': 0}
2025-01-22 04:28:29.755 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:28:29.755 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-26_pid-4_3-4-5-8.pkl | len: 3 |  size: 2.01 KB
Processing depth (3, 4, 5, 8):   5%|▌         | 5/100 [01:47<33:14, 21.00s/it]Processing depth (3, 4, 5, 8):   5%|▌         | 5/100 [01:47<34:01, 21.49s/it]
2025-01-22 04:28:29.854 | INFO     | __main__:<module>:82 - Selected idx: 27
2025-01-22 04:28:29.854 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the location prior to the place where the apple was discarded, left or dropped?
2025-01-22 04:28:29.854 | INFO     | __main__:<module>:84 - Answer: kitchen
2025-01-22 04:28:29.854 | INFO     | __main__:<module>:85 - Tag: 4-hop
2025-01-22 04:28:29.854 | INFO     | __main__:<module>:86 - Needle: [' John went back to the bedroom.', ' Daniel journeyed to the hallway.', ' Mary went to the kitchen.', ' Daniel went back to the bathroom.', ' John went to the kitchen.', ' Mary picked up the apple.', ' John left the football.', ' Mary travelled to the office.', ' John grabbed the football.', ' Mary discarded the apple.', ' John got the football there.']
2025-01-22 04:28:29.854 | INFO     | __main__:<module>:87 - Real Needle: [' Mary went to the kitchen.', ' Mary picked up the apple.', ' Mary travelled to the office.', ' Mary discarded the apple.', ' John got the football there.']
2025-01-22 04:28:29.854 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['🗂', '😽', '🍮', '🍠', '🧎🏿', '▪', '🏃🏾\u200d♀\u200d➡️', '👯\u200d♀', '🕺', '👩🏾\u200d❤\u200d👨🏽']
emoji:
O: 🗂 [9468, 245, 224]
N: 🗂 [9468, 245, 224]

O: 😽 [76460, 121]
N: 🏃🏾‍♀‍➡️ [9468, 237, 225, 9468, 237, 122, 102470, 32990, 102470, 98115, 94, 31643]

O: 🍮 [9468, 235, 106]
N: 🍠 [9468, 235, 254]

O: 🍠 [9468, 235, 254]
N: 🍮 [9468, 235, 106]

O: 🧎🏿 [9468, 100, 236, 9468, 237, 123]
N: 👯‍♀ [9468, 239, 107, 102470, 32990]

O: ▪ [10634, 103]
N: 🕺 [9468, 243, 118]

O: 🏃🏾‍♀‍➡️ [9468, 237, 225, 9468, 237, 122, 102470, 32990, 102470, 98115, 94, 31643]
N: ▪ [10634, 103]

O: 👯‍♀ [9468, 239, 107, 102470, 32990]
N: 🧎🏿 [9468, 100, 236, 9468, 237, 123]

O: 🕺 [9468, 243, 118]
N: 😽 [76460, 121]

O: 👩🏾‍❤‍👨🏽 [9468, 239, 102, 9468, 237, 122, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 121]
N: 👩🏾‍❤‍👨🏽 [9468, 239, 102, 9468, 237, 122, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 121]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.60s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.36s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.41s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.06s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.56s/it]
Processing depth (3, 4, 6, 7, 8):   0%|          | 0/100 [00:15<?, ?it/s]2025-01-22 04:28:45.848 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary went to the kitchen.
2025-01-22 04:28:45.852 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (660, 665) -->  went to the kitchen.
2025-01-22 04:28:45.852 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary picked up the apple.
2025-01-22 04:28:45.870 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3638, 3643) -->  Hon. Mary picked up
2025-01-22 04:28:45.870 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary travelled to the office.
2025-01-22 04:28:45.897 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4869, 4874) --> . Mary travelled to the
2025-01-22 04:28:45.897 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary discarded the apple.
2025-01-22 04:28:45.929 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5753, 5757) -->  Mary discarded the apple
2025-01-22 04:28:45.930 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John got the football there.
2025-01-22 04:28:45.966 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6665, 6670) --> . John got the football
2025-01-22 04:28:45.966 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the bedroom.
2025-01-22 04:28:45.970 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (589, 595) --> . John went back to the
2025-01-22 04:28:45.970 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the hallway.
2025-01-22 04:28:45.981 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2208, 2214) --> . Daniel journeyed to the
2025-01-22 04:28:45.981 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the bathroom.
2025-01-22 04:28:46.017 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (7012, 7018) -->  Daniel went back to the bathroom
2025-01-22 04:28:46.017 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the kitchen.
2025-01-22 04:28:46.020 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (590, 595) -->  John went back to the
2025-01-22 04:28:46.020 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John left the football.
2025-01-22 04:28:46.052 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5658, 5662) -->  John left the football
2025-01-22 04:28:46.053 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John grabbed the football.
2025-01-22 04:28:46.089 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (7019, 7023) -->  John grabbed the football
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:28:46.978 | INFO     | test_jbb_embedding:begin_test:693 - Mary travelled to the office.<|eot_id|>
2025-01-22 04:28:46.978 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8196])
2025-01-22 04:28:49.247 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [302.0729166666667, 33.2737681424564, 167.28225806451613, 31.971528118860512, 29.192159598214285], 'topk_indices': array([8172, 3644,   14, 8170, 8177, 5757, 8180, 8183, 5756, 3645, 8178,
       8175, 5754, 8176, 8191, 8192, 8181, 8179, 8182,    0]), 'topk_tokens': [' was', ' apple', '\n', ':', ' the', '.', ' the', ' discarded', ' apple', '.', ' place', ' prior', ' discarded', ' to', '<|eot_id|>', '<|start_header_id|>', ' apple', ' where', ' was', '<|begin_of_text|>'], 'evidence_proportions': [178.025, 358.675, 219.65, 737.9375, 103.25]}, 'weight': {'score': [23.49609375, 23.27705932125869, 23.163810483870968, 23.276844916502945, 29.582142857142856], 'topk_indices': array([3328, 3301, 3221, 3173, 7472, 7434, 1500, 1438, 4302, 4318, 5119,
       5180, 7149, 7205, 3484, 3510, 4896, 4921, 4944, 4973]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.565625, 26.9078125, 20.75625, 28.873046875, 22.453125]}, 'saliency': {'score': [2.0445404052734375, 0.18794269284935664, 1.0289503528225807, 0.17927010167090035, 0.21974748883928572], 'topk_indices': array([8189, 8176, 8172, 8174, 5658, 8171, 3641, 8085, 3000, 5753, 3644,
       8169, 8178, 5756, 8175, 8183, 5754, 8182, 8181, 8179]), 'topk_tokens': ['Answer', ' to', ' was', ' location', ' John', ' Where', ' picked', ' location', ' kitchen', ' Mary', ' apple', 'Question', ' place', ' apple', ' prior', ' discarded', ' discarded', ' was', ' apple', ' where'], 'evidence_proportions': [0.965576171875, 2.37333984375, 1.3427734375, 5.6240234375, 0.6328857421875]}}, 'pred_res': 'Mary travelled to the office.<|eot_id|>', 'score': 0}
2025-01-22 04:28:49.296 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:28:49.299 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-27_pid-0_3-4-6-7-8.pkl | len: 3 |  size: 2.09 KB
Processing depth (3, 4, 6, 7, 8):   1%|          | 1/100 [00:19<31:54, 19.34s/it]is_0k: False
your chose emoji: ['🚶🏻\u200d♀️', '👩\u200d👦\u200d👦', '🏌🏼', '🏃🏼\u200d♂\u200d➡️', '\U0001f9cc', '🤾', '👩🏻\u200d⚖️', '🧔🏻\u200d♀', '🥒', '\U0001fae7']
emoji:
O: 🚶🏻‍♀️ [9468, 248, 114, 9468, 237, 119, 102470, 32990, 31643]
N: 🏃🏼‍♂‍➡️ [9468, 237, 225, 9468, 237, 120, 102470, 17245, 224, 102470, 98115, 94, 31643]

O: 👩‍👦‍👦 [9468, 239, 102, 102470, 9468, 239, 99, 102470, 9468, 239, 99]
N: 🚶🏻‍♀️ [9468, 248, 114, 9468, 237, 119, 102470, 32990, 31643]

O: 🏌🏼 [9468, 237, 234, 9468, 237, 120]
N: 🤾 [9468, 97, 122]

O: 🏃🏼‍♂‍➡️ [9468, 237, 225, 9468, 237, 120, 102470, 17245, 224, 102470, 98115, 94, 31643]
N: 🧔🏻‍♀ [9468, 100, 242, 9468, 237, 119, 102470, 32990]

O: 🧌 [9468, 100, 234]
N: 👩🏻‍⚖️ [9468, 239, 102, 9468, 237, 119, 102470, 158, 248, 244, 31643]

O: 🤾 [9468, 97, 122]
N: 👩‍👦‍👦 [9468, 239, 102, 102470, 9468, 239, 99, 102470, 9468, 239, 99]

O: 👩🏻‍⚖️ [9468, 239, 102, 9468, 237, 119, 102470, 158, 248, 244, 31643]
N: 🏌🏼 [9468, 237, 234, 9468, 237, 120]

O: 🧔🏻‍♀ [9468, 100, 242, 9468, 237, 119, 102470, 32990]
N: 🥒 [9468, 98, 240]

O: 🥒 [9468, 98, 240]
N: 🧌 [9468, 100, 234]

O: 🫧 [9468, 104, 100]
N: 🫧 [9468, 104, 100]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  5.00s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.95s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.26s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.75s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.45s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 2, 3, 4, 9):   1%|          | 1/100 [00:34<31:54, 19.34s/it]2025-01-22 04:29:04.809 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary went to the kitchen.
2025-01-22 04:29:04.810 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  went to the kitchen.
2025-01-22 04:29:04.810 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary picked up the apple.
2025-01-22 04:29:04.819 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1800, 1805) --> . Mary picked up the
2025-01-22 04:29:04.819 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary travelled to the office.
2025-01-22 04:29:04.836 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2897, 2902) --> . Mary travelled to the
2025-01-22 04:29:04.836 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary discarded the apple.
2025-01-22 04:29:04.856 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3628, 3632) -->  Mary discarded the apple
2025-01-22 04:29:04.856 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John got the football there.
2025-01-22 04:29:04.893 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7132, 7137) -->  John got the football there
2025-01-22 04:29:04.893 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the bedroom.
2025-01-22 04:29:04.895 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (373, 379) --> . John went back to the
2025-01-22 04:29:04.895 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the hallway.
2025-01-22 04:29:04.905 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2053, 2059) -->  cable. Daniel journeyed to
2025-01-22 04:29:04.905 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the bathroom.
2025-01-22 04:29:04.944 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6919, 6925) --> . Daniel went back to the
2025-01-22 04:29:04.944 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the kitchen.
2025-01-22 04:29:04.944 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (31, 36) -->  went to the kitchen.
2025-01-22 04:29:04.944 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John left the football.
2025-01-22 04:29:04.971 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5563, 5567) -->  John left the football
2025-01-22 04:29:04.971 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John grabbed the football.
2025-01-22 04:29:05.007 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (6927, 6931) -->  John grabbed the football
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:29:07.475 | INFO     | test_jbb_embedding:begin_test:693 - the office<|eot_id|>
2025-01-22 04:29:07.476 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8184])
2025-01-22 04:29:10.299 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [246.11848958333334, 27.41359014290949, 175.56678427419354, 26.20335076703148, 18.61248779296875], 'topk_indices': array([  34, 8063, 1806, 8157, 8170, 4302, 8163,   35, 8179, 8182, 4282,
       8158, 8180,   24,   14, 8171, 8164,  655, 4303,    0]), 'topk_tokens': [' kitchen', '.\n\n', '.', 'Question', ' was', ' Min', ' prior', '.', '<|eot_id|>', '<|end_header_id|>', 'nes', ':', '<|start_header_id|>', '\n\n', '\n', ' discarded', ' to', ' kitchen', 'nes', '<|begin_of_text|>'], 'evidence_proportions': [465.95, 232.55, 184.975, 328.3125, 35.24375]}, 'weight': {'score': [23.12890625, 23.260804094906558, 22.542590725806452, 23.26393126690851, 29.12646484375], 'topk_indices': array([3311, 3338, 3183, 3231, 7460, 7422, 1436, 1498, 4321, 4337, 5144,
       5205, 7199, 7143, 3494, 3520, 4998, 4969, 4921, 4946]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.565625, 22.1, 20.75625, 28.873046875, 25.4984375]}, 'saliency': {'score': [1.4479726155598958, 0.15408583515596372, 0.9362438571068549, 0.14728551771742807, 0.13672864437103271], 'topk_indices': array([8166, 8164,   24,   39, 8029, 8073, 8167, 8159,   38, 1805, 8169,
         34, 4302, 4282, 8163, 3629, 8157, 8171,  655, 4303]), 'topk_tokens': [' place', ' to', '\n\n', '\n\n\n', ' context', ' location', ' where', ' Where', '***', ' apple', ' apple', ' kitchen', ' Min', 'nes', ' prior', ' discarded', 'Question', ' discarded', ' kitchen', 'nes'], 'evidence_proportions': [2.3404296875, 1.29775390625, 1.010498046875, 2.602294921875, 0.2197509765625]}}, 'pred_res': 'the office<|eot_id|>', 'score': 0}
2025-01-22 04:29:10.305 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:29:10.306 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-27_pid-1_0-2-3-4-9.pkl | len: 3 |  size: 2.06 KB
Processing depth (0, 2, 3, 4, 9):   2%|▏         | 2/100 [00:40<33:11, 20.32s/it]is_0k: False
your chose emoji: ['🤹🏼\u200d♂', '🔤', '🤹\u200d♀️', '🎙', '👯\u200d♂', '🧚🏽', '🧑🏻\u200d💼', '👩🏾\u200d🎨', '🇹🇬', '\U0001faf4🏻']
emoji:
O: 🤹🏼‍♂ [9468, 97, 117, 9468, 237, 120, 102470, 17245, 224]
N: 🤹‍♀️ [9468, 97, 117, 102470, 32990, 31643]

O: 🔤 [9468, 242, 97]
N: 🎙 [9468, 236, 247]

O: 🤹‍♀️ [9468, 97, 117, 102470, 32990, 31643]
N: 🇹🇬 [9468, 229, 117, 9468, 229, 105]

O: 🎙 [9468, 236, 247]
N: 🧑🏻‍💼 [9468, 100, 239, 9468, 237, 119, 102470, 93273, 120]

O: 👯‍♂ [9468, 239, 107, 102470, 17245, 224]
N: 👩🏾‍🎨 [9468, 239, 102, 9468, 237, 122, 102470, 9468, 236, 101]

O: 🧚🏽 [9468, 100, 248, 9468, 237, 121]
N: 🔤 [9468, 242, 97]

O: 🧑🏻‍💼 [9468, 100, 239, 9468, 237, 119, 102470, 93273, 120]
N: 🧚🏽 [9468, 100, 248, 9468, 237, 121]

O: 👩🏾‍🎨 [9468, 239, 102, 9468, 237, 122, 102470, 9468, 236, 101]
N: 👯‍♂ [9468, 239, 107, 102470, 17245, 224]

O: 🇹🇬 [9468, 229, 117, 9468, 229, 105]
N: 🤹🏼‍♂ [9468, 97, 117, 9468, 237, 120, 102470, 17245, 224]

O: 🫴🏻 [9468, 104, 112, 9468, 237, 119]
N: 🫴🏻 [9468, 104, 112, 9468, 237, 119]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.95s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:10<00:10,  5.14s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.90s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.31s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.93s/it]
Processing depth (0, 1, 2, 7, 8):   2%|▏         | 2/100 [00:57<33:11, 20.32s/it]2025-01-22 04:29:27.724 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary went to the kitchen.
2025-01-22 04:29:27.725 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  went to the kitchen.
2025-01-22 04:29:27.725 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary picked up the apple.
2025-01-22 04:29:27.729 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (914, 919) --> . Mary picked up the
2025-01-22 04:29:27.729 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary travelled to the office.
2025-01-22 04:29:27.742 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2023, 2028) -->  cable. Mary travelled to
2025-01-22 04:29:27.742 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary discarded the apple.
2025-01-22 04:29:27.771 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5663, 5667) -->  Mary discarded the apple
2025-01-22 04:29:27.771 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John got the football there.
2025-01-22 04:29:27.803 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6659, 6664) --> . John got the football
2025-01-22 04:29:27.803 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the bedroom.
2025-01-22 04:29:27.806 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (595, 601) --> . John went back to the
2025-01-22 04:29:27.806 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the hallway.
2025-01-22 04:29:27.818 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2398, 2404) --> . Daniel journeyed to the
2025-01-22 04:29:27.818 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the bathroom.
2025-01-22 04:29:27.853 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6997, 7003) --> . Daniel went back to the
2025-01-22 04:29:27.853 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the kitchen.
2025-01-22 04:29:27.853 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (31, 36) -->  went to the kitchen.
2025-01-22 04:29:27.853 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John left the football.
2025-01-22 04:29:27.880 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5608, 5612) -->  John left the football
2025-01-22 04:29:27.880 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John grabbed the football.
2025-01-22 04:29:27.913 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (7005, 7009) -->  John grabbed the football
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:29:28.710 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 04:29:28.710 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8248])
2025-01-22 04:29:30.946 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [97.79817708333333, 13.991006771906436, 75.66456653225806, 13.512327850475842, 7.268280029296875], 'topk_indices': array([8127, 8212,    1, 8220, 8242,    9, 8241, 8221, 8247,   28, 8222,
       8240, 8244,   14,   24,   23, 8246,  769, 8243,    0]), 'topk_tokens': ['.\n\n', '.', '<|start_header_id|>', '.\n\n', ':', ':', 'Answer', 'Question', '\n\n', '<|end_header_id|>', ':', '?\n', '<|start_header_id|>', '\n', '\n\n', '4', '<|end_header_id|>', ' kitchen', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [187.875, 104.3375, 49.84375, 125.828125, 26.7125]}, 'weight': {'score': [23.416666666666668, 23.32670661131984, 21.828629032258064, 23.332109413128354, 30.003255208333332], 'topk_indices': array([3350, 3323, 3211, 3163, 7504, 7466, 1486, 1424, 4352, 4368, 5189,
       5250, 7187, 7243, 3532, 3506, 5017, 4988, 4965, 4940]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.565625, 22.1, 25.1828125, 28.873046875, 22.453125]}, 'saliency': {'score': [0.5836601257324219, 0.07726811848327096, 0.4131016885080645, 0.07451503785311624, 0.056401729583740234], 'topk_indices': array([8211,   16, 8208, 8227, 8247,    8, 8245, 8220,   22, 8235,   34,
       8093,   19, 8240,   24,   20,   23, 8241, 8221,  769]), 'topk_tokens': [' directly', ' Date', ' return', ' prior', '\n\n', ' Date', 'assistant', '.\n\n', '202', ' discarded', ' kitchen', ' context', '26', '?\n', '\n\n', ' Jul', '4', 'Answer', 'Question', ' kitchen'], 'evidence_proportions': [0.987109375, 0.5751953125, 0.3000244140625, 0.974456787109375, 0.159674072265625]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 100}
2025-01-22 04:29:30.953 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:29:30.953 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-27_pid-2_0-1-2-7-8.pkl | len: 3 |  size: 2.06 KB
Processing depth (0, 1, 2, 7, 8):   3%|▎         | 3/100 [01:00<33:05, 20.47s/it]is_0k: False
your chose emoji: ['⛹\u200d♂', '👨\u200d❤\u200d💋\u200d👨', '🤸🏾\u200d♀', '👨🏽\u200d❤️\u200d👨🏻', '🔴', '🚶🏻\u200d♀️\u200d➡', '🏌🏽', '🚶🏻\u200d♀️\u200d➡️', '🧑🏼\u200d⚕', '🧏🏿\u200d♂️']
emoji:
O: ⛹‍♂ [158, 249, 117, 102470, 17245, 224]
N: ⛹‍♂ [158, 249, 117, 102470, 17245, 224]

O: 👨‍❤‍💋‍👨 [9468, 239, 101, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101]
N: 🤸🏾‍♀ [9468, 97, 116, 9468, 237, 122, 102470, 32990]

O: 🤸🏾‍♀ [9468, 97, 116, 9468, 237, 122, 102470, 32990]
N: 👨🏽‍❤️‍👨🏻 [9468, 239, 101, 9468, 237, 121, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 119]

O: 👨🏽‍❤️‍👨🏻 [9468, 239, 101, 9468, 237, 121, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 119]
N: 🔴 [9468, 242, 112]

O: 🔴 [9468, 242, 112]
N: 🧑🏼‍⚕ [9468, 100, 239, 9468, 237, 120, 102470, 158, 248, 243]

O: 🚶🏻‍♀️‍➡ [9468, 248, 114, 9468, 237, 119, 102470, 32990, 31643, 102470, 98115, 94]
N: 🚶🏻‍♀️‍➡ [9468, 248, 114, 9468, 237, 119, 102470, 32990, 31643, 102470, 98115, 94]

O: 🏌🏽 [9468, 237, 234, 9468, 237, 121]
N: 🚶🏻‍♀️‍➡️ [9468, 248, 114, 9468, 237, 119, 102470, 32990, 31643, 102470, 98115, 94, 31643]

O: 🚶🏻‍♀️‍➡️ [9468, 248, 114, 9468, 237, 119, 102470, 32990, 31643, 102470, 98115, 94, 31643]
N: 👨‍❤‍💋‍👨 [9468, 239, 101, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101]

O: 🧑🏼‍⚕ [9468, 100, 239, 9468, 237, 120, 102470, 158, 248, 243]
N: 🏌🏽 [9468, 237, 234, 9468, 237, 121]

O: 🧏🏿‍♂️ [9468, 100, 237, 9468, 237, 123, 102470, 17245, 224, 31643]
N: 🧏🏿‍♂️ [9468, 100, 237, 9468, 237, 123, 102470, 17245, 224, 31643]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.17s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.25s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.42s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.86s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.39s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 2, 3, 5, 7):   3%|▎         | 3/100 [01:16<33:05, 20.47s/it]2025-01-22 04:29:46.193 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary went to the kitchen.
2025-01-22 04:29:46.194 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  went to the kitchen.
2025-01-22 04:29:46.194 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary picked up the apple.
2025-01-22 04:29:46.203 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1748, 1753) --> . Mary picked up the
2025-01-22 04:29:46.203 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary travelled to the office.
2025-01-22 04:29:46.217 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2895, 2900) --> . Mary travelled to the
2025-01-22 04:29:46.217 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary discarded the apple.
2025-01-22 04:29:46.237 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4203, 4207) -->  discarded the apple.
2025-01-22 04:29:46.237 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John got the football there.
2025-01-22 04:29:46.264 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5585, 5590) --> . John got the football
2025-01-22 04:29:46.264 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the bedroom.
2025-01-22 04:29:46.267 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (595, 601) --> . John went back to the
2025-01-22 04:29:46.268 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the hallway.
2025-01-22 04:29:46.279 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2051, 2057) -->  cable. Daniel journeyed to
2025-01-22 04:29:46.279 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the bathroom.
2025-01-22 04:29:46.316 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6893, 6899) --> . Daniel went back to the
2025-01-22 04:29:46.316 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the kitchen.
2025-01-22 04:29:46.316 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (31, 36) -->  went to the kitchen.
2025-01-22 04:29:46.317 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John left the football.
2025-01-22 04:29:46.344 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5531, 5535) -->  John left the football
2025-01-22 04:29:46.344 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John grabbed the football.
2025-01-22 04:29:46.378 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (6901, 6905) -->  John grabbed the football
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:29:54.365 | INFO     | test_jbb_embedding:begin_test:693 - Mary travelled to the office.<|eot_id|>
2025-01-22 04:29:54.365 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8162])
2025-01-22 04:29:57.686 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [266.857421875, 26.526913655848134, 187.6335685483871, 25.199880548705302, 16.154333726415093], 'topk_indices': array([  29, 4203, 8160, 8147, 8141,   14, 8135,   35,   24, 8146, 8145,
       8148, 8149, 8136, 8142,  769,  185, 8157,    0, 8158]), 'topk_tokens': ['\n\n', ' discarded', '<|end_header_id|>', ' apple', ' prior', '\n', 'Question', '.', '\n\n', ' the', ' where', ' was', ' discarded', ':', ' to', ' kitchen', 'ION', '<|eot_id|>', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [471.65, 237.5, 193.375, 424.3125, 38.940625]}, 'weight': {'score': [21.530598958333332, 23.25162086650337, 22.542590725806452, 23.25942412916153, 29.636497641509433], 'topk_indices': array([3320, 3293, 3213, 3165, 7390, 7428, 1500, 1438, 4299, 4283, 5112,
       5173, 7167, 7111, 3502, 3476, 4937, 4889, 4914, 4966]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.565625, 22.1, 20.75625, 23.08984375, 22.453125]}, 'saliency': {'score': [1.464978535970052, 0.14865278628291487, 1.0195056546118952, 0.14142858691045007, 0.1223274087006191], 'topk_indices': array([  24,   31, 4205,   38, 8137, 8144, 4216, 8148, 8051, 1753, 4213,
         34, 8145, 8147, 8141, 4203, 8135,  185, 8149,  769]), 'topk_tokens': ['\n\n', ' went', ' apple', '***', ' Where', ' place', 'outs', ' was', ' location', ' apple', 'ree', ' kitchen', ' where', ' apple', ' prior', ' discarded', 'Question', 'ION', ' discarded', ' kitchen'], 'evidence_proportions': [2.33427734375, 1.264453125, 1.106884765625, 2.611328125, 0.23721923828125]}}, 'pred_res': 'Mary travelled to the office.<|eot_id|>', 'score': 0}
2025-01-22 04:29:57.693 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:29:57.694 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-27_pid-3_0-2-3-5-7.pkl | len: 3 |  size: 2.09 KB
Processing depth (0, 2, 3, 5, 7):   4%|▍         | 4/100 [01:27<36:42, 22.95s/it]is_0k: False
your chose emoji: ['⬇️', '📅', '🏘️', '💂🏻', '✔', '🛌🏽', '🏵', '🇼🇫', '🧑\u200d🧑\u200d🧒', '🏃🏼\u200d♀\u200d➡']
emoji:
O: ⬇️ [158, 105, 229, 31643]
N: 🇼🇫 [9468, 110771, 9468, 229, 104]

O: 📅 [9468, 241, 227]
N: 💂🏻 [93273, 224, 9468, 237, 119]

O: 🏘️ [9468, 237, 246, 31643]
N: ⬇️ [158, 105, 229, 31643]

O: 💂🏻 [93273, 224, 9468, 237, 119]
N: ✔ [75351]

O: ✔ [75351]
N: 📅 [9468, 241, 227]

O: 🛌🏽 [9468, 249, 234, 9468, 237, 121]
N: 🛌🏽 [9468, 249, 234, 9468, 237, 121]

O: 🏵 [9468, 237, 113]
N: 🏵 [9468, 237, 113]

O: 🇼🇫 [9468, 110771, 9468, 229, 104]
N: 🏘️ [9468, 237, 246, 31643]

O: 🧑‍🧑‍🧒 [9468, 100, 239, 102470, 9468, 100, 239, 102470, 9468, 100, 240]
N: 🧑‍🧑‍🧒 [9468, 100, 239, 102470, 9468, 100, 239, 102470, 9468, 100, 240]

O: 🏃🏼‍♀‍➡ [9468, 237, 225, 9468, 237, 120, 102470, 32990, 102470, 98115, 94]
N: 🏃🏼‍♀‍➡ [9468, 237, 225, 9468, 237, 120, 102470, 32990, 102470, 98115, 94]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.34s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.44s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.45s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.16s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.62s/it]
Processing depth (0, 1, 5, 6, 7):   4%|▍         | 4/100 [01:43<36:42, 22.95s/it]2025-01-22 04:30:13.881 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary went to the kitchen.
2025-01-22 04:30:13.881 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  went to the kitchen.
2025-01-22 04:30:13.881 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary picked up the apple.
2025-01-22 04:30:13.888 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (680, 685) --> . Mary picked up the
2025-01-22 04:30:13.888 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary travelled to the office.
2025-01-22 04:30:13.909 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4127, 4132) --> . Mary travelled to the
2025-01-22 04:30:13.909 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary discarded the apple.
2025-01-22 04:30:13.936 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4593, 4597) -->  discarded the apple.
2025-01-22 04:30:13.936 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John got the football there.
2025-01-22 04:30:13.968 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5557, 5562) --> . John got the football
2025-01-22 04:30:13.968 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the bedroom.
2025-01-22 04:30:13.971 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (379, 385) --> . John went back to the
2025-01-22 04:30:13.971 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the hallway.
2025-01-22 04:30:13.982 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2059, 2065) -->  cable. Daniel journeyed to
2025-01-22 04:30:13.982 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the bathroom.
2025-01-22 04:30:14.023 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6905, 6911) --> . Daniel went back to the
2025-01-22 04:30:14.023 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the kitchen.
2025-01-22 04:30:14.024 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (31, 36) -->  went to the kitchen.
2025-01-22 04:30:14.024 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John left the football.
2025-01-22 04:30:14.053 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5431, 5435) -->  John left the football
2025-01-22 04:30:14.053 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John grabbed the football.
2025-01-22 04:30:14.101 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (6913, 6917) -->  John grabbed the football
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:30:15.014 | INFO     | test_jbb_embedding:begin_test:693 - Mary picked up the apple.<|eot_id|>
2025-01-22 04:30:15.014 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8164])
2025-01-22 04:30:17.244 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [92.52994791666667, 10.780517249295947, 59.779485887096776, 10.351405518059664, 15.001591435185185], 'topk_indices': array([   1,   34, 8137, 8136, 8158, 8043,    9, 8163, 8138, 8156,   28,
       8009,   14,   24,   23, 8162,  637, 8159, 8160,    0]), 'topk_tokens': ['<|start_header_id|>', ' kitchen', 'Question', '.\n\n', ':', '.\n\n', ':', '\n\n', ':', '?\n', '<|end_header_id|>', ' context', '\n', '\n\n', '4', '<|end_header_id|>', ' kitchen', '<|eot_id|>', '<|start_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [165.475, 86.225, 62.0375, 131.6875, 25.05625]}, 'weight': {'score': [21.530598958333332, 23.25422623056202, 22.542590725806452, 23.262045233912723, 29.71527777777778], 'topk_indices': array([3340, 3313, 3185, 3233, 7440, 7402, 1522, 1460, 4324, 4308, 5134,
       5195, 7123, 7179, 3496, 3522, 4988, 4959, 4936, 4911]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.565625, 22.1, 20.75625, 23.08984375, 22.453125]}, 'saliency': {'score': [0.5227101643880209, 0.060033991358133344, 0.32569196147303425, 0.05764991527008117, 0.11332561351634839], 'topk_indices': array([8156, 8124, 8147, 8043,    8,   19, 4593,   63, 8143,   24, 8053,
       8151,   64,   20,   23, 8157,   34, 8137, 8009,  637]), 'topk_tokens': ['?\n', ' return', ' where', '.\n\n', ' Date', '26', ' discarded', 'ISC', ' prior', '\n\n', ' location', ' discarded', 'ENCES', ' Jul', '4', 'Answer', ' kitchen', 'Question', ' context', ' kitchen'], 'evidence_proportions': [0.899169921875, 0.480615234375, 0.3285400390625, 0.8240966796875, 0.14140625]}}, 'pred_res': 'Mary picked up the apple.<|eot_id|>', 'score': 0}
2025-01-22 04:30:17.258 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:30:17.258 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-27_pid-4_0-1-5-6-7.pkl | len: 3 |  size: 2.09 KB
Processing depth (0, 1, 5, 6, 7):   5%|▌         | 5/100 [01:47<34:23, 21.73s/it]Processing depth (0, 1, 5, 6, 7):   5%|▌         | 5/100 [01:47<34:00, 21.48s/it]
2025-01-22 04:30:17.333 | INFO     | __main__:<module>:82 - Selected idx: 28
2025-01-22 04:30:17.334 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the milk before the bathroom? 
2025-01-22 04:30:17.334 | INFO     | __main__:<module>:84 - Answer: office
2025-01-22 04:30:17.334 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 04:30:17.334 | INFO     | __main__:<module>:86 - Needle: [' Daniel went back to the bathroom.', ' Daniel journeyed to the hallway.', ' Mary journeyed to the garden.', ' Mary dropped the milk.', ' John travelled to the office.', ' John went to the bathroom.', ' Daniel went back to the kitchen.', ' Mary took the milk.', ' John left the milk.', ' Sandra travelled to the garden.']
2025-01-22 04:30:17.334 | INFO     | __main__:<module>:87 - Real Needle: [' John travelled to the office.', ' John went to the bathroom.', ' John left the milk.', ' Sandra travelled to the garden.']
2025-01-22 04:30:17.334 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['💒', '🏃🏼\u200d➡️', '🧖\u200d♀', '😒', '💅🏼', '\U0001faf4🏻', '🧙🏿', '🦸🏾\u200d♂', '\U0001faf5', '🧞\u200d♀️']
emoji:
O: 💒 [93273, 240]
N: 🦸🏾‍♂ [9468, 99, 116, 9468, 237, 122, 102470, 17245, 224]

O: 🏃🏼‍➡️ [9468, 237, 225, 9468, 237, 120, 102470, 98115, 94, 31643]
N: 🧙🏿 [9468, 100, 247, 9468, 237, 123]

O: 🧖‍♀ [9468, 100, 244, 102470, 32990]
N: 🫵 [9468, 104, 113]

O: 😒 [76460, 240]
N: 💒 [93273, 240]

O: 💅🏼 [93273, 227, 9468, 237, 120]
N: 🫴🏻 [9468, 104, 112, 9468, 237, 119]

O: 🫴🏻 [9468, 104, 112, 9468, 237, 119]
N: 😒 [76460, 240]

O: 🧙🏿 [9468, 100, 247, 9468, 237, 123]
N: 💅🏼 [93273, 227, 9468, 237, 120]

O: 🦸🏾‍♂ [9468, 99, 116, 9468, 237, 122, 102470, 17245, 224]
N: 🧖‍♀ [9468, 100, 244, 102470, 32990]

O: 🫵 [9468, 104, 113]
N: 🏃🏼‍➡️ [9468, 237, 225, 9468, 237, 120, 102470, 98115, 94, 31643]

O: 🧞‍♀️ [9468, 100, 252, 102470, 32990, 31643]
N: 🧞‍♀️ [9468, 100, 252, 102470, 32990, 31643]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:11,  3.79s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.33s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.40s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.07s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.50s/it]
Processing depth (2, 7, 8, 9):   0%|          | 0/100 [00:15<?, ?it/s]2025-01-22 04:30:33.104 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the office.
2025-01-22 04:30:33.114 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2003, 2008) -->  cable. John travelled to
2025-01-22 04:30:33.114 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went to the bathroom.
2025-01-22 04:30:33.148 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5685, 5690) --> . John went to the
2025-01-22 04:30:33.148 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John left the milk.
2025-01-22 04:30:33.182 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6598, 6602) -->  John left the milk
2025-01-22 04:30:33.182 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra travelled to the garden.
2025-01-22 04:30:33.221 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7234, 7239) -->  cold. Sandra travelled to
2025-01-22 04:30:33.222 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went back to the bathroom.
2025-01-22 04:30:33.251 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5773, 5779) --> . Daniel went back to the
2025-01-22 04:30:33.251 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the hallway.
2025-01-22 04:30:33.278 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4936, 4942) --> . Daniel journeyed to the
2025-01-22 04:30:33.278 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the garden.
2025-01-22 04:30:33.319 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (7238, 7244) -->  to the garden. Mary journey
2025-01-22 04:30:33.319 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary dropped the milk.
2025-01-22 04:30:33.354 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6761, 6765) -->  Mary dropped the milk
2025-01-22 04:30:33.355 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel went back to the kitchen.
2025-01-22 04:30:33.388 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5773, 5779) --> . Daniel went back to the
2025-01-22 04:30:33.388 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary took the milk.
2025-01-22 04:30:33.392 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (752, 756) -->  Mary took the milk
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:30:34.164 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 04:30:34.164 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8178])
2025-01-22 04:30:36.377 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [337.9292763157895, 40.87874388753056, 289.7734375, 39.20466462664535, 31.59438189338235], 'topk_indices': array([8078,   13, 8079, 8177, 8075,    8,   23,    1, 8174,    4, 8027,
         24, 8080, 8076,    9, 8176, 8066, 8173,   14,    0]), 'topk_tokens': [' traveled', '3', ' to', '\n\n', ' first', ' Date', '4', '<|start_header_id|>', '<|start_header_id|>', '\n\n', '\n', '\n\n', ' the', ' location', ':', '<|end_header_id|>', '.\n\n', '<|eot_id|>', '\n', '<|begin_of_text|>'], 'evidence_proportions': [326.4125, 341.875, 448.125, 257.34375]}, 'weight': {'score': [23.51768092105263, 23.266467374694376, 22.41552734375, 23.26922995602165, 29.105238970588236], 'topk_indices': array([3236, 3263, 3156, 3108, 7401, 7363, 1466, 1404, 4249, 4233, 5140,
       5079, 7127, 7071, 3445, 3419, 4897, 4868, 4843, 4926]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [24.4171875, 18.6375, 25.177734375, 26.1703125]}, 'saliency': {'score': [2.0495990953947367, 0.22692454741461643, 1.71405029296875, 0.2168102848645667, 0.23540384629193475], 'topk_indices': array([8166,   23,   12, 4937, 6601,   20, 5779,    4,  755,    9, 8032,
         24, 8075, 8168,   14,    8, 8078, 5690, 8066, 8076]), 'topk_tokens': [' before', '4', '202', ' Daniel', ' milk', ' Jul', ' kitchen', '\n\n', ' milk', ':', ' context', '\n\n', ' first', ' bathroom', '\n', ' Date', ' traveled', ' bathroom', '.\n\n', ' location'], 'evidence_proportions': [1.93603515625, 1.77666015625, 2.994873046875, 1.6798828125]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 0}
2025-01-22 04:30:36.381 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:30:36.381 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-28_pid-0_2-7-8-9.pkl | len: 3 |  size: 1.99 KB
Processing depth (2, 7, 8, 9):   1%|          | 1/100 [00:18<31:16, 18.95s/it]is_0k: False
your chose emoji: ['🤷🏿\u200d♂', '🗓', '💂🏾', '🤣', '🎡', '👩🏽\u200d🤝\u200d👩🏼', '🧙', '🇳🇴', '👦🏿', '🧑🏽\u200d🦼\u200d➡️']
emoji:
O: 🤷🏿‍♂ [9468, 97, 115, 9468, 237, 123, 102470, 17245, 224]
N: 🤷🏿‍♂ [9468, 97, 115, 9468, 237, 123, 102470, 17245, 224]

O: 🗓 [9468, 245, 241]
N: 🎡 [9468, 236, 94]

O: 💂🏾 [93273, 224, 9468, 237, 122]
N: 🇳🇴 [9468, 229, 111, 9468, 114783]

O: 🤣 [9468, 97, 96]
N: 🗓 [9468, 245, 241]

O: 🎡 [9468, 236, 94]
N: 🤣 [9468, 97, 96]

O: 👩🏽‍🤝‍👩🏼 [9468, 239, 102, 9468, 237, 121, 102470, 9468, 97, 251, 102470, 9468, 239, 102, 9468, 237, 120]
N: 🧙 [9468, 100, 247]

O: 🧙 [9468, 100, 247]
N: 💂🏾 [93273, 224, 9468, 237, 122]

O: 🇳🇴 [9468, 229, 111, 9468, 114783]
N: 👦🏿 [9468, 239, 99, 9468, 237, 123]

O: 👦🏿 [9468, 239, 99, 9468, 237, 123]
N: 👩🏽‍🤝‍👩🏼 [9468, 239, 102, 9468, 237, 121, 102470, 9468, 97, 251, 102470, 9468, 239, 102, 9468, 237, 120]

O: 🧑🏽‍🦼‍➡️ [9468, 100, 239, 9468, 237, 121, 102470, 9468, 99, 120, 102470, 98115, 94, 31643]
N: 🧑🏽‍🦼‍➡️ [9468, 100, 239, 9468, 237, 121, 102470, 9468, 99, 120, 102470, 98115, 94, 31643]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.15s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.50s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.57s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.18s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.65s/it]
Processing depth (0, 6, 7, 9):   1%|          | 1/100 [00:35<31:16, 18.95s/it]2025-01-22 04:30:52.706 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the office.
2025-01-22 04:30:52.706 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  travelled to the office.
2025-01-22 04:30:52.706 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went to the bathroom.
2025-01-22 04:30:52.732 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4710, 4715) --> . John went to the
2025-01-22 04:30:52.732 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John left the milk.
2025-01-22 04:30:52.761 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5638, 5642) -->  John left the milk
2025-01-22 04:30:52.762 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra travelled to the garden.
2025-01-22 04:30:52.800 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7237, 7242) --> . Sandra travelled to the
2025-01-22 04:30:52.800 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went back to the bathroom.
2025-01-22 04:30:52.836 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5732, 5738) --> . Daniel went back to the
2025-01-22 04:30:52.836 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the hallway.
2025-01-22 04:30:52.865 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4920, 4926) --> . Daniel journeyed to the
2025-01-22 04:30:52.865 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the garden.
2025-01-22 04:30:52.903 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (7240, 7246) -->  to the garden. Mary journey
2025-01-22 04:30:52.903 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary dropped the milk.
2025-01-22 04:30:52.937 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6731, 6735) -->  Mary dropped the milk
2025-01-22 04:30:52.937 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel went back to the kitchen.
2025-01-22 04:30:52.968 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5732, 5738) --> . Daniel went back to the
2025-01-22 04:30:52.968 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary took the milk.
2025-01-22 04:30:52.972 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (758, 762) -->  Mary took the milk
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:30:53.864 | INFO     | test_jbb_embedding:begin_test:693 - Mary took the milk.<|eot_id|>
2025-01-22 04:30:53.864 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8216])
2025-01-22 04:30:56.115 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [348.7631578947368, 41.25144499878316, 260.91015625, 39.675370393045185, 24.078169899425287], 'topk_indices': array([   4,  762, 8114, 1586, 8104,   67,    9,    1, 8203,  105,   68,
         24, 8204, 1588, 1595,   14, 8214,    0, 8211, 8212]), 'topk_tokens': ['\n\n', '.', ' location', ' on', '.\n\n', 'ION', ':', '<|start_header_id|>', ' milk', 'ION', 'E', '\n\n', ' before', ' part', 'ern', '\n', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [449.95, 271.1, 460.5, 235.85]}, 'weight': {'score': [21.33511513157895, 23.302641685933317, 22.41552734375, 23.310694907860903, 29.52550287356322], 'topk_indices': array([3333, 3306, 3226, 3178, 7423, 7461, 1438, 1500, 4313, 4297, 5182,
       5121, 7131, 7187, 3515, 3489, 4891, 4916, 4946, 4975]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.14375, 18.6375, 25.177734375, 22.15]}, 'saliency': {'score': [1.964573910361842, 0.22736596863877312, 1.5735015869140625, 0.21805002757381076, 0.18278819117052802], 'topk_indices': array([   8, 8209, 4715, 8104, 8198, 1674,   24, 8070, 1594, 8200, 8114,
         68,  761,   67,  105, 8206, 8203, 8204, 1588, 1595]), 'topk_tokens': [' Date', 'Answer', ' bathroom', '.\n\n', 'Question', 'ern', '\n\n', ' context', ' const', ' Where', ' location', 'E', ' milk', 'ION', 'ION', ' bathroom', ' milk', ' before', ' part', 'ern'], 'evidence_proportions': [2.4056640625, 1.26318359375, 3.029052734375, 1.373291015625]}}, 'pred_res': 'Mary took the milk.<|eot_id|>', 'score': 0}
2025-01-22 04:30:56.122 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:30:56.122 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-28_pid-1_0-6-7-9.pkl | len: 3 |  size: 2.01 KB
Processing depth (0, 6, 7, 9):   2%|▏         | 2/100 [00:38<31:42, 19.42s/it]is_0k: False
your chose emoji: ['🚶\u200d♂️\u200d➡', '👩🏿', '👩🏻\u200d🤝\u200d👩🏼', '💇🏼\u200d♀️', '👈🏿', '🧑🏾\u200d⚕', '☁', '🙆🏻\u200d♂️', '🙇🏽\u200d♂', '👮🏾\u200d♂']
emoji:
O: 🚶‍♂️‍➡ [9468, 248, 114, 102470, 17245, 224, 31643, 102470, 98115, 94]
N: 👩🏿 [9468, 239, 102, 9468, 237, 123]

O: 👩🏿 [9468, 239, 102, 9468, 237, 123]
N: 💇🏼‍♀️ [93273, 229, 9468, 237, 120, 102470, 32990, 31643]

O: 👩🏻‍🤝‍👩🏼 [9468, 239, 102, 9468, 237, 119, 102470, 9468, 97, 251, 102470, 9468, 239, 102, 9468, 237, 120]
N: 🙆🏻‍♂️ [9468, 247, 228, 9468, 237, 119, 102470, 17245, 224, 31643]

O: 💇🏼‍♀️ [93273, 229, 9468, 237, 120, 102470, 32990, 31643]
N: ☁ [18107, 223]

O: 👈🏿 [9468, 239, 230, 9468, 237, 123]
N: 🙇🏽‍♂ [9468, 247, 229, 9468, 237, 121, 102470, 17245, 224]

O: 🧑🏾‍⚕ [9468, 100, 239, 9468, 237, 122, 102470, 158, 248, 243]
N: 👈🏿 [9468, 239, 230, 9468, 237, 123]

O: ☁ [18107, 223]
N: 🧑🏾‍⚕ [9468, 100, 239, 9468, 237, 122, 102470, 158, 248, 243]

O: 🙆🏻‍♂️ [9468, 247, 228, 9468, 237, 119, 102470, 17245, 224, 31643]
N: 🚶‍♂️‍➡ [9468, 248, 114, 102470, 17245, 224, 31643, 102470, 98115, 94]

O: 🙇🏽‍♂ [9468, 247, 229, 9468, 237, 121, 102470, 17245, 224]
N: 👩🏻‍🤝‍👩🏼 [9468, 239, 102, 9468, 237, 119, 102470, 9468, 97, 251, 102470, 9468, 239, 102, 9468, 237, 120]

O: 👮🏾‍♂ [9468, 239, 106, 9468, 237, 122, 102470, 17245, 224]
N: 👮🏾‍♂ [9468, 239, 106, 9468, 237, 122, 102470, 17245, 224]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.21s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.40s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:03,  3.98s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  2.60s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  3.18s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 5, 8, 9):   2%|▏         | 2/100 [00:53<31:42, 19.42s/it]2025-01-22 04:31:10.748 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the office.
2025-01-22 04:31:10.749 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  travelled to the office.
2025-01-22 04:31:10.749 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went to the bathroom.
2025-01-22 04:31:10.772 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4207, 4212) -->  John went to the bathroom
2025-01-22 04:31:10.772 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John left the milk.
2025-01-22 04:31:10.807 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6502, 6506) -->  John left the milk
2025-01-22 04:31:10.808 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra travelled to the garden.
2025-01-22 04:31:10.847 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7134, 7139) -->  Sandra travelled to the garden
2025-01-22 04:31:10.848 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went back to the bathroom.
2025-01-22 04:31:10.879 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5627, 5633) -->  went back to the kitchen.
2025-01-22 04:31:10.879 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the hallway.
2025-01-22 04:31:10.908 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4888, 4894) --> . Daniel journeyed to the
2025-01-22 04:31:10.908 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the garden.
2025-01-22 04:31:10.950 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (7136, 7142) -->  to the garden. Mary journey
2025-01-22 04:31:10.950 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary dropped the milk.
2025-01-22 04:31:10.987 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6707, 6711) -->  Mary dropped the milk
2025-01-22 04:31:10.987 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel went back to the kitchen.
2025-01-22 04:31:11.016 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5626, 5632) -->  Daniel went back to the kitchen
2025-01-22 04:31:11.016 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary took the milk.
2025-01-22 04:31:11.020 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (758, 762) -->  Mary took the milk
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:31:14.724 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 04:31:14.724 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8192])
2025-01-22 04:31:17.807 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [347.39473684210526, 35.515758481815965, 214.990234375, 34.082762802406975, 32.6509375], 'topk_indices': array([8103, 8041,  762, 8094, 8191,   68,  105,    4,   23,    9, 8120,
       8090, 8080,    1, 8188,   24,   14, 8190, 8187,    0]), 'topk_tokens': [' the', '\n', '.', ' the', '\n\n', 'E', 'ION', '\n\n', '4', ':', ' the', ' location', '.\n\n', '<|start_header_id|>', '<|start_header_id|>', '\n\n', '\n', '<|end_header_id|>', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [392.45, 350.35, 373.03125, 278.875]}, 'weight': {'score': [24.02014802631579, 23.274606419331217, 23.148193359375, 23.273363625199558, 28.989583333333332], 'topk_indices': array([3254, 3281, 3126, 3174, 7469, 7431, 1472, 1410, 4267, 4283, 5200,
       5139, 7208, 7152, 3437, 3463, 4993, 4964, 4941, 4916]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.14375, 24.3265625, 25.177734375, 26.6640625]}, 'saliency': {'score': [2.190378289473684, 0.1978040513161307, 1.3070144653320312, 0.1887958671366511, 0.23815775553385415], 'topk_indices': array([  68, 8161, 8179, 8046, 8185, 8118, 7929, 8089,   20,   67,   23,
        761,   14,    8, 8182,  105, 8080, 4211,   24, 8090]), 'topk_tokens': ['E', ' return', ' milk', ' context', 'Answer', ' moved', ' Square', ' first', ' Jul', 'ION', '4', ' milk', '\n', ' Date', ' bathroom', 'ION', '.\n\n', ' bathroom', '\n\n', ' location'], 'evidence_proportions': [2.18408203125, 2.41611328125, 2.380126953125, 1.819140625]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 0}
2025-01-22 04:31:17.816 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:31:17.816 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-28_pid-2_0-5-8-9.pkl | len: 3 |  size: 1.98 KB
Processing depth (0, 5, 8, 9):   3%|▎         | 3/100 [01:00<33:04, 20.46s/it]is_0k: False
your chose emoji: ['🇸🇾', '🧙🏽\u200d♂', '🧑🏽\u200d🦰', '🦄', '👩🏽\u200d❤\u200d💋\u200d👨🏿', '📫', '🤷🏻', '🖐🏽', '⛑️', '👩🏿\u200d🦰']
emoji:
O: 🇸🇾 [9468, 229, 116, 9468, 229, 122]
N: 🇸🇾 [9468, 229, 116, 9468, 229, 122]

O: 🧙🏽‍♂ [9468, 100, 247, 9468, 237, 121, 102470, 17245, 224]
N: 📫 [9468, 241, 104]

O: 🧑🏽‍🦰 [9468, 100, 239, 9468, 237, 121, 102470, 9468, 99, 108]
N: 🧑🏽‍🦰 [9468, 100, 239, 9468, 237, 121, 102470, 9468, 99, 108]

O: 🦄 [9468, 99, 226]
N: ⛑️ [158, 249, 239, 31643]

O: 👩🏽‍❤‍💋‍👨🏿 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 123]
N: 🦄 [9468, 99, 226]

O: 📫 [9468, 241, 104]
N: 👩🏽‍❤‍💋‍👨🏿 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 123]

O: 🤷🏻 [9468, 97, 115, 9468, 237, 119]
N: 🤷🏻 [9468, 97, 115, 9468, 237, 119]

O: 🖐🏽 [9468, 244, 238, 9468, 237, 121]
N: 🧙🏽‍♂ [9468, 100, 247, 9468, 237, 121, 102470, 17245, 224]

O: ⛑️ [158, 249, 239, 31643]
N: 🖐🏽 [9468, 244, 238, 9468, 237, 121]

O: 👩🏿‍🦰 [9468, 239, 102, 9468, 237, 123, 102470, 9468, 99, 108]
N: 👩🏿‍🦰 [9468, 239, 102, 9468, 237, 123, 102470, 9468, 99, 108]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:05<00:15,  5.17s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.62s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.38s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.04s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.62s/it]
Processing depth (0, 1, 7, 8):   3%|▎         | 3/100 [01:16<33:04, 20.46s/it]2025-01-22 04:31:34.057 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the office.
2025-01-22 04:31:34.057 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  travelled to the office.
2025-01-22 04:31:34.059 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went to the bathroom.
2025-01-22 04:31:34.064 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (906, 911) --> . John went to the
2025-01-22 04:31:34.065 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John left the milk.
2025-01-22 04:31:34.093 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5700, 5704) -->  John left the milk
2025-01-22 04:31:34.094 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra travelled to the garden.
2025-01-22 04:31:34.131 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6668, 6673) --> . Sandra travelled to the
2025-01-22 04:31:34.131 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went back to the bathroom.
2025-01-22 04:31:34.159 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5712, 5718) -->  went back to the kitchen.
2025-01-22 04:31:34.159 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the hallway.
2025-01-22 04:31:34.184 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4982, 4988) --> . Daniel journeyed to the
2025-01-22 04:31:34.184 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the garden.
2025-01-22 04:31:34.226 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (7190, 7196) -->  Mary journeyed to the garden
2025-01-22 04:31:34.226 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary dropped the milk.
2025-01-22 04:31:34.258 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6784, 6788) -->  dropped the milk.
2025-01-22 04:31:34.258 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel went back to the kitchen.
2025-01-22 04:31:34.286 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5711, 5717) -->  Daniel went back to the kitchen
2025-01-22 04:31:34.287 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary took the milk.
2025-01-22 04:31:34.290 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (758, 762) -->  Mary took the milk
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:31:35.119 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 04:31:35.119 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8242])
2025-01-22 04:31:37.370 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [371.0986842105263, 48.2497801431344, 325.97265625, 46.41635389967045, 30.041015625], 'topk_indices': array([ 762, 5875,  761, 5866, 5868, 8232, 8230,    1, 5869, 5836,   24,
       7627, 7626,   14, 8240, 7582, 5876, 8238, 8237,    0]), 'topk_tokens': ['.', ' required', ' milk', '\n', ' with', ' bathroom', ' before', '<|start_header_id|>', ' the', ' week', '\n\n', 'nes', ' Min', '\n', '<|end_header_id|>', 'nes', ' a', '<|start_header_id|>', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [448.175, 277.775, 445.5625, 327.775]}, 'weight': {'score': [21.33511513157895, 23.326330134036876, 22.730224609375, 23.333276119858414, 29.69296875], 'topk_indices': array([3339, 3312, 3232, 3184, 7481, 7519, 1478, 1416, 4297, 4313, 5244,
       5183, 7202, 7258, 3521, 3495, 5008, 4953, 5037, 4978]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.14375, 18.6375, 25.177734375, 22.15]}, 'saliency': {'score': [2.179122121710526, 0.26844926044699174, 2.0253143310546875, 0.2571563925569083, 0.22261260986328124], 'topk_indices': array([7513, 8226, 7574, 5867, 7434, 8140, 7619,   24, 5876, 7581, 5875,
        911, 8229, 8230,  761, 5836, 8232, 7627, 7626, 7582]), 'topk_tokens': ['nes', ' Where', ' perpet', 'out', 'nes', ' location', ' perpet', '\n\n', ' a', ' Min', ' required', ' bathroom', ' milk', ' before', ' milk', ' week', ' bathroom', 'nes', ' Min', 'nes'], 'evidence_proportions': [2.41259765625, 1.30068359375, 2.95751953125, 2.2013671875]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 0}
2025-01-22 04:31:37.386 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:31:37.386 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-28_pid-3_0-1-7-8.pkl | len: 3 |  size: 2.01 KB
Processing depth (0, 1, 7, 8):   4%|▍         | 4/100 [01:19<32:10, 20.11s/it]is_0k: False
your chose emoji: ['👩🏼\u200d❤️\u200d💋\u200d👨🏻', '🧎🏻\u200d♀️', '🚎', '👞', '🧑\u200d🦯\u200d➡', '👨🏾\u200d❤️\u200d💋\u200d👨🏻', '👩🏼\u200d❤\u200d👨🏻', '👧🏽', '🤹🏿', '🧑🏿\u200d🌾']
emoji:
O: 👩🏼‍❤️‍💋‍👨🏻 [9468, 239, 102, 9468, 237, 120, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 119]
N: 👨🏾‍❤️‍💋‍👨🏻 [9468, 239, 101, 9468, 237, 122, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 119]

O: 🧎🏻‍♀️ [9468, 100, 236, 9468, 237, 119, 102470, 32990, 31643]
N: 🧑‍🦯‍➡ [9468, 100, 239, 102470, 9468, 99, 107, 102470, 98115, 94]

O: 🚎 [9468, 248, 236]
N: 🤹🏿 [9468, 97, 117, 9468, 237, 123]

O: 👞 [9468, 239, 252]
N: 👞 [9468, 239, 252]

O: 🧑‍🦯‍➡ [9468, 100, 239, 102470, 9468, 99, 107, 102470, 98115, 94]
N: 👩🏼‍❤️‍💋‍👨🏻 [9468, 239, 102, 9468, 237, 120, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 119]

O: 👨🏾‍❤️‍💋‍👨🏻 [9468, 239, 101, 9468, 237, 122, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 119]
N: 👩🏼‍❤‍👨🏻 [9468, 239, 102, 9468, 237, 120, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 119]

O: 👩🏼‍❤‍👨🏻 [9468, 239, 102, 9468, 237, 120, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 119]
N: 🚎 [9468, 248, 236]

O: 👧🏽 [9468, 239, 100, 9468, 237, 121]
N: 🧎🏻‍♀️ [9468, 100, 236, 9468, 237, 119, 102470, 32990, 31643]

O: 🤹🏿 [9468, 97, 117, 9468, 237, 123]
N: 👧🏽 [9468, 239, 100, 9468, 237, 121]

O: 🧑🏿‍🌾 [9468, 100, 239, 9468, 237, 123, 102470, 9468, 234, 122]
N: 🧑🏿‍🌾 [9468, 100, 239, 9468, 237, 123, 102470, 9468, 234, 122]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.30s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:10,  5.06s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.68s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  2.99s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.63s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (2, 3, 5, 8):   4%|▍         | 4/100 [01:36<32:10, 20.11s/it]2025-01-22 04:31:53.765 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the office.
2025-01-22 04:31:53.774 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1846, 1851) --> . John travelled to the
2025-01-22 04:31:53.774 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went to the bathroom.
2025-01-22 04:31:53.789 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2965, 2970) -->  tragedy. John went to
2025-01-22 04:31:53.789 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John left the milk.
2025-01-22 04:31:53.809 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4117, 4121) -->  John left the milk
2025-01-22 04:31:53.809 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra travelled to the garden.
2025-01-22 04:31:53.841 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6610, 6615) --> . Sandra travelled to the
2025-01-22 04:31:53.841 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went back to the bathroom.
2025-01-22 04:31:53.870 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5710, 5716) --> . Daniel went back to the
2025-01-22 04:31:53.870 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the hallway.
2025-01-22 04:31:53.895 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4903, 4909) --> . Daniel journeyed to the
2025-01-22 04:31:53.895 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the garden.
2025-01-22 04:31:53.932 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (7118, 7124) -->  Mary journeyed to the garden
2025-01-22 04:31:53.933 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary dropped the milk.
2025-01-22 04:31:53.967 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6865, 6869) -->  Mary dropped the milk
2025-01-22 04:31:53.967 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel went back to the kitchen.
2025-01-22 04:31:53.996 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5710, 5716) --> . Daniel went back to the
2025-01-22 04:31:53.996 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary took the milk.
2025-01-22 04:31:54.000 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (752, 756) -->  Mary took the milk
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:31:56.400 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 04:31:56.400 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8162])
2025-01-22 04:31:59.015 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [364.94736842105266, 51.40564521068104, 370.69140625, 49.41200080118329, 45.804752604166666], 'topk_indices': array([  23,    9, 1410, 2302,  756, 2339, 2336,   24, 2353, 2365, 2351,
         14, 2337, 8160, 8158, 8157, 2366,    0, 2352, 2338]), 'topk_tokens': ['4', ':', ' injunction', 'u', '.', 'ot', ' the', '\n\n', 'ot', ' Min', ' Min', '\n', ' Min', '<|end_header_id|>', '<|start_header_id|>', '<|eot_id|>', 'nes', '<|begin_of_text|>', 'nes', 'nes'], 'evidence_proportions': [487.75, 290.025, 353.125, 326.525]}, 'weight': {'score': [22.823190789473685, 23.25989672648212, 22.720458984375, 23.263047154258597, 29.43671875], 'topk_indices': array([3293, 3266, 3168, 3120, 7409, 7447, 1472, 1410, 4302, 4286, 5104,
       5165, 7186, 7130, 3481, 3455, 4958, 4929, 4874, 4899]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.990625, 24.4453125, 25.177734375, 22.15]}, 'saliency': {'score': [2.0994808799342106, 0.29007387137891966, 2.38525390625, 0.27757239297655, 0.3276163736979167], 'topk_indices': array([1848, 6865,   24, 1234, 2334, 8150, 2971, 8149,  755, 2339, 8144,
       2353, 8152, 1410, 2351, 2365, 2337, 2366, 2352, 2338]), 'topk_tokens': [' travelled', ' Mary', '\n\n', 'pend', ' messenger', ' before', ' bathroom', ' milk', ' milk', 'ot', 'Question', 'ot', ' bathroom', ' injunction', ' Min', ' Min', ' Min', 'nes', 'nes', 'nes'], 'evidence_proportions': [2.62060546875, 1.52958984375, 2.254150390625, 2.02451171875]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 0}
2025-01-22 04:31:59.022 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:31:59.022 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-28_pid-4_2-3-5-8.pkl | len: 3 |  size: 1.98 KB
Processing depth (2, 3, 5, 8):   5%|▌         | 5/100 [01:41<32:42, 20.66s/it]Processing depth (2, 3, 5, 8):   5%|▌         | 5/100 [01:41<32:12, 20.34s/it]
2025-01-22 04:31:59.117 | INFO     | __main__:<module>:82 - Selected idx: 29
2025-01-22 04:31:59.117 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the location prior to the place where the apple was discarded, left or dropped?
2025-01-22 04:31:59.117 | INFO     | __main__:<module>:84 - Answer: office
2025-01-22 04:31:59.117 | INFO     | __main__:<module>:85 - Tag: 4-hop
2025-01-22 04:31:59.117 | INFO     | __main__:<module>:86 - Needle: [' Daniel went back to the bathroom.', ' Daniel went back to the kitchen.', ' Mary journeyed to the garden.', ' Mary dropped the milk.', ' John travelled to the office.', ' John got the apple.', ' John went to the bathroom.', ' Daniel journeyed to the hallway.', ' Mary took the milk.', ' John left the apple.', ' Sandra travelled to the garden.']
2025-01-22 04:31:59.117 | INFO     | __main__:<module>:87 - Real Needle: [' John travelled to the office.', ' John got the apple.', ' John went to the bathroom.', ' John left the apple.', ' Sandra travelled to the garden.']
2025-01-22 04:31:59.117 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['🧑🏾\u200d❤\u200d💋\u200d🧑🏽', '🧛🏼\u200d♂', '🎎', '🐶', '🏃🏻\u200d➡️', '🪄', '😔', '🙃', '👛', '🇰🇪']
emoji:
O: 🧑🏾‍❤‍💋‍🧑🏽 [9468, 100, 239, 9468, 237, 122, 102470, 121643, 102470, 93273, 233, 102470, 9468, 100, 239, 9468, 237, 121]
N: 🙃 [9468, 247, 225]

O: 🧛🏼‍♂ [9468, 100, 249, 9468, 237, 120, 102470, 17245, 224]
N: 🧛🏼‍♂ [9468, 100, 249, 9468, 237, 120, 102470, 17245, 224]

O: 🎎 [9468, 236, 236]
N: 🎎 [9468, 236, 236]

O: 🐶 [9468, 238, 114]
N: 🏃🏻‍➡️ [9468, 237, 225, 9468, 237, 119, 102470, 98115, 94, 31643]

O: 🏃🏻‍➡️ [9468, 237, 225, 9468, 237, 119, 102470, 98115, 94, 31643]
N: 🐶 [9468, 238, 114]

O: 🪄 [9468, 103, 226]
N: 😔 [76460, 242]

O: 😔 [76460, 242]
N: 🧑🏾‍❤‍💋‍🧑🏽 [9468, 100, 239, 9468, 237, 122, 102470, 121643, 102470, 93273, 233, 102470, 9468, 100, 239, 9468, 237, 121]

O: 🙃 [9468, 247, 225]
N: 👛 [9468, 239, 249]

O: 👛 [9468, 239, 249]
N: 🪄 [9468, 103, 226]

O: 🇰🇪 [9468, 229, 108, 9468, 229, 103]
N: 🇰🇪 [9468, 229, 108, 9468, 229, 103]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.63s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:10,  5.00s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.69s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.27s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.83s/it]
Processing depth (0, 1, 3, 4, 9):   0%|          | 0/100 [00:16<?, ?it/s]2025-01-22 04:32:16.236 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the office.
2025-01-22 04:32:16.236 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  travelled to the office.
2025-01-22 04:32:16.237 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John got the apple.
2025-01-22 04:32:16.241 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (836, 840) -->  John got the apple
2025-01-22 04:32:16.241 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went to the bathroom.
2025-01-22 04:32:16.256 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2909, 2914) --> . John went to the
2025-01-22 04:32:16.256 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John left the apple.
2025-01-22 04:32:16.276 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3654, 3658) -->  John left the apple
2025-01-22 04:32:16.277 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra travelled to the garden.
2025-01-22 04:32:16.315 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7269, 7274) --> . Sandra travelled to the
2025-01-22 04:32:16.315 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went back to the bathroom.
2025-01-22 04:32:16.323 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1532, 1538) --> . Daniel went back to the
2025-01-22 04:32:16.323 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went back to the kitchen.
2025-01-22 04:32:16.330 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1532, 1538) --> . Daniel went back to the
2025-01-22 04:32:16.331 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the garden.
2025-01-22 04:32:16.346 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2971, 2977) --> . Mary journeyed to the
2025-01-22 04:32:16.346 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary dropped the milk.
2025-01-22 04:32:16.384 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7101, 7105) -->  Mary dropped the milk
2025-01-22 04:32:16.384 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel journeyed to the hallway.
2025-01-22 04:32:16.421 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6213, 6219) --> . Daniel journeyed to the
2025-01-22 04:32:16.421 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary took the milk.
2025-01-22 04:32:16.436 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (3037, 3041) -->  Mary took the milk
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:32:17.280 | INFO     | test_jbb_embedding:begin_test:693 - John got the apple.<|eot_id|>
2025-01-22 04:32:17.280 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8246])
2025-01-22 04:32:19.541 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [679.0326086956521, 84.88732116876818, 183.248046875, 82.83521756377395, 125.3828947368421], 'topk_indices': array([ 588, 8135,   14,   38, 7594,  589, 6636,   64,   39,   24,  145,
         34, 7124, 8241,  590,   68,   69,   67, 8242,    0]), 'topk_tokens': [' em', ' location', '\n', '***', 'nes', 's', ' ', 'ENCES', '\n\n\n', '\n\n', ' Daily', ' office', '�', '<|eot_id|>', ' per', 'E', 'ER', 'ION', '<|start_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [1502.8, 835.875, 277.525, 635.4375, 166.175]}, 'weight': {'score': [22.05366847826087, 23.315146474903006, 22.01513671875, 23.323765333211277, 29.647697368421053], 'topk_indices': array([3344, 3317, 3189, 3237, 7486, 7448, 1430, 1492, 4357, 4341, 5159,
       5220, 7163, 7219, 3520, 3546, 4954, 5006, 4977, 4929]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.14375, 25.396484375, 18.6375, 25.248046875, 22.15]}, 'saliency': {'score': [3.9596849524456523, 0.4837800700264458, 1.0487785339355469, 0.4718154950062172, 0.9437596371299342], 'topk_indices': array([ 119, 7113, 7549, 8233, 7593, 7124, 8135,   68,  588,   69, 7594,
         39,   38,   31, 7123,   34,   64,  145,  590,   67]), 'topk_tokens': ['�', '�', 'nes', ' discarded', ' Min', '�', ' location', 'E', ' em', 'ER', 'nes', '\n\n\n', '***', ' travelled', '�', ' office', 'ENCES', ' Daily', ' per', 'ION'], 'evidence_proportions': [8.10625, 5.550537109375, 1.3150390625, 4.107666015625, 1.06669921875]}}, 'pred_res': 'John got the apple.<|eot_id|>', 'score': 0}
2025-01-22 04:32:19.548 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:32:19.549 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-29_pid-0_0-1-3-4-9.pkl | len: 3 |  size: 2.02 KB
Processing depth (0, 1, 3, 4, 9):   1%|          | 1/100 [00:20<33:32, 20.33s/it]is_0k: False
your chose emoji: ['🤽🏽\u200d♂', '🚣🏾\u200d♀️', '🚲', '🧖🏼\u200d♂️', '👨🏼\u200d❤️\u200d💋\u200d👨🏿', '👨🏾\u200d⚕', '🤷🏿\u200d♂️', '👩🏽\u200d🎨', '👩🏼\u200d🍳', '🙎\u200d♀']
emoji:
O: 🤽🏽‍♂ [9468, 97, 121, 9468, 237, 121, 102470, 17245, 224]
N: 🧖🏼‍♂️ [9468, 100, 244, 9468, 237, 120, 102470, 17245, 224, 31643]

O: 🚣🏾‍♀️ [9468, 248, 96, 9468, 237, 122, 102470, 32990, 31643]
N: 🤽🏽‍♂ [9468, 97, 121, 9468, 237, 121, 102470, 17245, 224]

O: 🚲 [9468, 248, 110]
N: 🚣🏾‍♀️ [9468, 248, 96, 9468, 237, 122, 102470, 32990, 31643]

O: 🧖🏼‍♂️ [9468, 100, 244, 9468, 237, 120, 102470, 17245, 224, 31643]
N: 🤷🏿‍♂️ [9468, 97, 115, 9468, 237, 123, 102470, 17245, 224, 31643]

O: 👨🏼‍❤️‍💋‍👨🏿 [9468, 239, 101, 9468, 237, 120, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 123]
N: 👩🏽‍🎨 [9468, 239, 102, 9468, 237, 121, 102470, 9468, 236, 101]

O: 👨🏾‍⚕ [9468, 239, 101, 9468, 237, 122, 102470, 158, 248, 243]
N: 👩🏼‍🍳 [9468, 239, 102, 9468, 237, 120, 102470, 9468, 235, 111]

O: 🤷🏿‍♂️ [9468, 97, 115, 9468, 237, 123, 102470, 17245, 224, 31643]
N: 🚲 [9468, 248, 110]

O: 👩🏽‍🎨 [9468, 239, 102, 9468, 237, 121, 102470, 9468, 236, 101]
N: 👨🏾‍⚕ [9468, 239, 101, 9468, 237, 122, 102470, 158, 248, 243]

O: 👩🏼‍🍳 [9468, 239, 102, 9468, 237, 120, 102470, 9468, 235, 111]
N: 👨🏼‍❤️‍💋‍👨🏿 [9468, 239, 101, 9468, 237, 120, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 123]

O: 🙎‍♀ [9468, 247, 236, 102470, 32990]
N: 🙎‍♀ [9468, 247, 236, 102470, 32990]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.17s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:09,  4.50s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.40s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.04s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.53s/it]
Processing depth (2, 4, 7, 8, 9):   1%|          | 1/100 [00:36<33:32, 20.33s/it]2025-01-22 04:32:35.429 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the office.
2025-01-22 04:32:35.439 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2005, 2010) -->  cable. John travelled to
2025-01-22 04:32:35.439 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John got the apple.
2025-01-22 04:32:35.459 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3637, 3641) -->  John got the apple
2025-01-22 04:32:35.459 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went to the bathroom.
2025-01-22 04:32:35.486 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5050, 5055) -->  back to the bathroom.
2025-01-22 04:32:35.486 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John left the apple.
2025-01-22 04:32:35.520 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6648, 6652) -->  John left the apple
2025-01-22 04:32:35.520 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra travelled to the garden.
2025-01-22 04:32:35.563 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7280, 7285) -->  cold. Sandra travelled to
2025-01-22 04:32:35.563 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went back to the bathroom.
2025-01-22 04:32:35.572 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1543, 1549) --> . Daniel went back to the
2025-01-22 04:32:35.572 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went back to the kitchen.
2025-01-22 04:32:35.582 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1543, 1549) --> . Daniel went back to the
2025-01-22 04:32:35.582 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the garden.
2025-01-22 04:32:35.601 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3064, 3070) --> . Mary journeyed to the
2025-01-22 04:32:35.601 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary dropped the milk.
2025-01-22 04:32:35.643 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7075, 7079) -->  Mary dropped the milk
2025-01-22 04:32:35.643 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel journeyed to the hallway.
2025-01-22 04:32:35.681 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6190, 6196) --> . Daniel journeyed to the
2025-01-22 04:32:35.681 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary took the milk.
2025-01-22 04:32:35.696 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (3110, 3114) -->  Mary took the milk
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:32:36.580 | INFO     | test_jbb_embedding:begin_test:693 - John left the apple.<|eot_id|>
2025-01-22 04:32:36.580 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8208])
2025-01-22 04:32:38.846 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [350.71942934782606, 41.78686814859927, 152.046875, 40.4829111741263, 24.313527960526315], 'topk_indices': array([   1, 6649, 8097, 8181, 8180, 8087, 8200, 6566,   24, 6651, 8187,
       6652, 8182, 8188,   14, 8189, 3641,    0, 8203, 8204]), 'topk_tokens': ['<|start_header_id|>', ' left', ' location', 'Question', '.\n\n', '.\n\n', '?\n', '.', '\n\n', ' apple', ' prior', '.', ':', ' to', '\n', ' the', '.', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [197.325, 668.125, 139.3375, 857.625, 56.046875]}, 'weight': {'score': [24.157608695652176, 23.28236335261876, 22.01513671875, 23.284867412630287, 29.475123355263158], 'topk_indices': array([3270, 3297, 3142, 3190, 7440, 7402, 1399, 1461, 4292, 4308, 5130,
       5191, 7117, 7173, 3453, 3479, 4948, 4900, 4977, 4925]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [24.4171875, 25.396484375, 20.021875, 25.248046875, 26.1703125]}, 'saliency': {'score': [2.2435063901154892, 0.22304958106539283, 0.8822021484375, 0.21476467747691216, 0.17729026392886513], 'topk_indices': array([8201, 6565, 8053, 3641, 8188, 8186, 8200,   24, 8180, 8087, 3638,
       8193, 6649, 8097,    0, 3640, 8195, 8181, 6651, 8187]), 'topk_tokens': ['Answer', ' St', ' context', '.', ' to', ' location', '?\n', '\n\n', '.\n\n', '.\n\n', ' got', ' apple', ' left', ' location', '<|begin_of_text|>', ' apple', ' discarded', 'Question', ' apple', ' prior'], 'evidence_proportions': [1.11796875, 4.3408203125, 0.84365234375, 5.60546875, 0.40147705078125]}}, 'pred_res': 'John left the apple.<|eot_id|>', 'score': 0}
2025-01-22 04:32:38.854 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:32:38.855 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-29_pid-1_2-4-7-8-9.pkl | len: 3 |  size: 2.06 KB
Processing depth (2, 4, 7, 8, 9):   2%|▏         | 2/100 [00:39<32:13, 19.73s/it]is_0k: False
your chose emoji: ['👌🏾', '💩', '👨🏾\u200d⚖️', '👩🏼\u200d❤️\u200d💋\u200d👩🏿', '🪴', '🇳🇵', '\U0001fac3🏿', '👩🏻\u200d🎤', '🧏🏾\u200d♂️', '\U0001faba']
emoji:
O: 👌🏾 [9468, 239, 234, 9468, 237, 122]
N: 👩🏻‍🎤 [9468, 239, 102, 9468, 237, 119, 102470, 9468, 236, 97]

O: 💩 [93273, 102]
N: 💩 [93273, 102]

O: 👨🏾‍⚖️ [9468, 239, 101, 9468, 237, 122, 102470, 158, 248, 244, 31643]
N: 👨🏾‍⚖️ [9468, 239, 101, 9468, 237, 122, 102470, 158, 248, 244, 31643]

O: 👩🏼‍❤️‍💋‍👩🏿 [9468, 239, 102, 9468, 237, 120, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 123]
N: 🇳🇵 [9468, 229, 111, 9468, 229, 113]

O: 🪴 [9468, 103, 112]
N: 🧏🏾‍♂️ [9468, 100, 237, 9468, 237, 122, 102470, 17245, 224, 31643]

O: 🇳🇵 [9468, 229, 111, 9468, 229, 113]
N: 👌🏾 [9468, 239, 234, 9468, 237, 122]

O: 🫃🏿 [9468, 104, 225, 9468, 237, 123]
N: 🪴 [9468, 103, 112]

O: 👩🏻‍🎤 [9468, 239, 102, 9468, 237, 119, 102470, 9468, 236, 97]
N: 👩🏼‍❤️‍💋‍👩🏿 [9468, 239, 102, 9468, 237, 120, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 123]

O: 🧏🏾‍♂️ [9468, 100, 237, 9468, 237, 122, 102470, 17245, 224, 31643]
N: 🫃🏿 [9468, 104, 225, 9468, 237, 123]

O: 🪺 [9468, 103, 118]
N: 🪺 [9468, 103, 118]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.41s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.97s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.53s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  2.94s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.57s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 1, 4, 7, 9):   2%|▏         | 2/100 [00:55<32:13, 19.73s/it]2025-01-22 04:32:54.889 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the office.
2025-01-22 04:32:54.889 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  travelled to the office.
2025-01-22 04:32:54.889 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John got the apple.
2025-01-22 04:32:54.894 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (828, 832) -->  John got the apple
2025-01-22 04:32:54.894 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went to the bathroom.
2025-01-22 04:32:54.912 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3617, 3622) --> . John went to the
2025-01-22 04:32:54.912 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John left the apple.
2025-01-22 04:32:54.947 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5610, 5614) -->  left the apple.
2025-01-22 04:32:54.947 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra travelled to the garden.
2025-01-22 04:32:54.983 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7114, 7119) -->  Sandra travelled to the garden
2025-01-22 04:32:54.984 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went back to the bathroom.
2025-01-22 04:32:54.991 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1410, 1416) --> . Daniel went back to the
2025-01-22 04:32:54.991 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went back to the kitchen.
2025-01-22 04:32:54.998 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1410, 1416) --> . Daniel went back to the
2025-01-22 04:32:54.998 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the garden.
2025-01-22 04:32:55.014 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2899, 2905) --> . Mary journeyed to the
2025-01-22 04:32:55.015 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary dropped the milk.
2025-01-22 04:32:55.050 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6989, 6993) -->  Mary dropped the milk
2025-01-22 04:32:55.050 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel journeyed to the hallway.
2025-01-22 04:32:55.085 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5833, 5839) --> . Daniel journeyed to the
2025-01-22 04:32:55.085 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary took the milk.
2025-01-22 04:32:55.100 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (2963, 2967) -->  Mary took the milk
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:33:00.140 | INFO     | test_jbb_embedding:begin_test:693 - John travelled to the office.<|eot_id|>
2025-01-22 04:33:00.140 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8174])
2025-01-22 04:33:03.003 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [809.8233695652174, 98.29956580234834, 211.6796875, 95.83765084349218, 75.67981991525424], 'topk_indices': array([  14,   34, 6104,  103,   24,   64,  441, 6105,  580,   65,  442,
        104,   66,   69, 8169,  105,   67,   68,    0, 8170]), 'topk_tokens': ['\n', ' office', '\n', ' OF', '\n\n', 'ENCES', ' em', 'the', ' em', ' OF', 's', ' P', ' P', 'ER', '<|eot_id|>', 'ION', 'ION', 'E', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [1412.0, 964.875, 254.65, 1411.75, 157.2375]}, 'weight': {'score': [22.195652173913043, 23.24904637047456, 22.01513671875, 23.25689185445142, 28.93167372881356], 'topk_indices': array([3301, 3328, 3221, 3173, 7442, 7404, 1439, 1501, 4314, 4298, 5134,
       5195, 7125, 7181, 3510, 3484, 4886, 4952, 4911, 4981]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.14375, 25.396484375, 18.6375, 20.421875, 26.6640625]}, 'saliency': {'score': [4.507483440896739, 0.545254044803388, 1.1962127685546875, 0.531467324538619, 0.5364390227754238], 'topk_indices': array([  38,   31,  463,   34,   52,  102, 6105,  442,   65, 8161,  441,
        104,   64,  580,    0,   66,   69,  105,   68,   67]), 'topk_tokens': ['***', ' travelled', ' em', ' office', ' Gutenberg', 'ENCES', 'the', 's', ' OF', ' discarded', ' em', ' P', 'ENCES', ' em', '<|begin_of_text|>', ' P', 'ER', 'ION', 'E', 'ION'], 'evidence_proportions': [7.598828125, 6.18212890625, 1.2599609375, 7.30615234375, 1.085009765625]}}, 'pred_res': 'John travelled to the office.<|eot_id|>', 'score': 100}
2025-01-22 04:33:03.008 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:33:03.008 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-29_pid-2_0-1-4-7-9.pkl | len: 3 |  size: 2.02 KB
Processing depth (0, 1, 4, 7, 9):   3%|▎         | 3/100 [01:03<35:09, 21.75s/it]is_0k: False
your chose emoji: ['🛎', '\U0001f7f0', '👧🏽', '🧝\u200d♀', '🤚🏼', '🇨🇴', '🤵🏼\u200d♂', '🤌🏿', '🏂🏼', '👩🏼\u200d🎤']
emoji:
O: 🛎 [9468, 249, 236]
N: 🤌🏿 [9468, 97, 234, 9468, 237, 123]

O: 🟰 [9468, 253, 108]
N: 🇨🇴 [9468, 229, 101, 9468, 114783]

O: 👧🏽 [9468, 239, 100, 9468, 237, 121]
N: 👧🏽 [9468, 239, 100, 9468, 237, 121]

O: 🧝‍♀ [9468, 100, 251, 102470, 32990]
N: 🏂🏼 [9468, 237, 224, 9468, 237, 120]

O: 🤚🏼 [9468, 97, 248, 9468, 237, 120]
N: 🤚🏼 [9468, 97, 248, 9468, 237, 120]

O: 🇨🇴 [9468, 229, 101, 9468, 114783]
N: 🤵🏼‍♂ [9468, 97, 113, 9468, 237, 120, 102470, 17245, 224]

O: 🤵🏼‍♂ [9468, 97, 113, 9468, 237, 120, 102470, 17245, 224]
N: 🟰 [9468, 253, 108]

O: 🤌🏿 [9468, 97, 234, 9468, 237, 123]
N: 🧝‍♀ [9468, 100, 251, 102470, 32990]

O: 🏂🏼 [9468, 237, 224, 9468, 237, 120]
N: 🛎 [9468, 249, 236]

O: 👩🏼‍🎤 [9468, 239, 102, 9468, 237, 120, 102470, 9468, 236, 97]
N: 👩🏼‍🎤 [9468, 239, 102, 9468, 237, 120, 102470, 9468, 236, 97]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.82s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:10<00:10,  5.05s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.78s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.31s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.89s/it]
Processing depth (0, 2, 4, 5, 6):   3%|▎         | 3/100 [01:21<35:09, 21.75s/it]2025-01-22 04:33:20.369 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the office.
2025-01-22 04:33:20.369 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  travelled to the office.
2025-01-22 04:33:20.370 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John got the apple.
2025-01-22 04:33:20.378 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1761, 1765) -->  John got the apple
2025-01-22 04:33:20.379 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went to the bathroom.
2025-01-22 04:33:20.400 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3637, 3642) --> . John went to the
2025-01-22 04:33:20.400 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John left the apple.
2025-01-22 04:33:20.423 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4237, 4241) -->  left the apple.
2025-01-22 04:33:20.423 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra travelled to the garden.
2025-01-22 04:33:20.447 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4878, 4883) --> . Sandra travelled to the
2025-01-22 04:33:20.447 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went back to the bathroom.
2025-01-22 04:33:20.454 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1409, 1415) --> . Daniel went back to the
2025-01-22 04:33:20.454 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went back to the kitchen.
2025-01-22 04:33:20.461 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1409, 1415) --> . Daniel went back to the
2025-01-22 04:33:20.461 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the garden.
2025-01-22 04:33:20.477 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2920, 2926) -->  Mary journeyed to the garden
2025-01-22 04:33:20.477 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary dropped the milk.
2025-01-22 04:33:20.516 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7103, 7107) -->  Mary dropped the milk
2025-01-22 04:33:20.516 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel journeyed to the hallway.
2025-01-22 04:33:20.551 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6221, 6227) --> . Daniel journeyed to the
2025-01-22 04:33:20.551 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary took the milk.
2025-01-22 04:33:20.565 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (2983, 2987) -->  Mary took the milk
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:33:21.419 | INFO     | test_jbb_embedding:begin_test:693 - John left the apple.<|eot_id|>
2025-01-22 04:33:21.419 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8206])
2025-01-22 04:33:23.659 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [582.320652173913, 74.86245888157895, 233.498046875, 72.80826076290936, 32.185625], 'topk_indices': array([  14, 4248, 7572, 7391, 5942, 7555, 7470, 7537, 4250, 5940, 7582,
       6077, 8202, 4247, 6078, 7538,    0, 7583, 7584, 7539]), 'topk_tokens': ['\n', 'ch', '\n', 'nes', ' way', '.\n', 'nes', ' the', 'outs', '\n', ' the', '\n', '<|start_header_id|>', 'ree', 'the', ' Min', '<|begin_of_text|>', ' Min', 'nes', 'nes'], 'evidence_proportions': [892.7, 693.0625, 262.775, 948.375, 210.05]}, 'weight': {'score': [21.214334239130434, 23.282295093201753, 22.720458984375, 23.290334079479948, 29.53875], 'topk_indices': array([3321, 3348, 3241, 3193, 7476, 7438, 1500, 1438, 4327, 4311, 5135,
       5196, 7201, 7145, 3530, 3504, 4982, 4905, 4930, 4953]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.14375, 25.396484375, 18.6375, 20.421875, 22.15]}, 'saliency': {'score': [3.1870435631793477, 0.4228206285026803, 1.35980224609375, 0.41134503188051946, 0.245279541015625], 'topk_indices': array([7535, 7532,   39,   31, 7531, 4248, 7342,    0,   38, 5942, 7576,
       7391, 7470, 4250, 6078, 4247, 7538, 7584, 7583, 7539]), 'topk_tokens': [' joke', 'rate', '\n\n\n', ' travelled', ' perpet', 'ch', 'nes', '<|begin_of_text|>', '***', ' way', ' perpet', 'nes', 'nes', 'outs', 'the', 'ree', ' Min', 'nes', ' Min', 'nes'], 'evidence_proportions': [4.7607421875, 4.453369140625, 1.291015625, 4.88720703125, 1.136181640625]}}, 'pred_res': 'John left the apple.<|eot_id|>', 'score': 0}
2025-01-22 04:33:23.666 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:33:23.666 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-29_pid-3_0-2-4-5-6.pkl | len: 3 |  size: 2.0 KB
Processing depth (0, 2, 4, 5, 6):   4%|▍         | 4/100 [01:24<34:06, 21.32s/it]is_0k: False
your chose emoji: ['🙎🏻\u200d♂️', '🤵🏽\u200d♂️', '👱🏻\u200d♀️', '🤎', '🧙🏻\u200d♂️', '👩🏿\u200d⚕️', '🧗🏻', '🤘🏾', '👨\u200d👧', '🧊']
emoji:
O: 🙎🏻‍♂️ [9468, 247, 236, 9468, 237, 119, 102470, 17245, 224, 31643]
N: 🤎 [9468, 97, 236]

O: 🤵🏽‍♂️ [9468, 97, 113, 9468, 237, 121, 102470, 17245, 224, 31643]
N: 🧙🏻‍♂️ [9468, 100, 247, 9468, 237, 119, 102470, 17245, 224, 31643]

O: 👱🏻‍♀️ [9468, 239, 109, 9468, 237, 119, 102470, 32990, 31643]
N: 🙎🏻‍♂️ [9468, 247, 236, 9468, 237, 119, 102470, 17245, 224, 31643]

O: 🤎 [9468, 97, 236]
N: 🤵🏽‍♂️ [9468, 97, 113, 9468, 237, 121, 102470, 17245, 224, 31643]

O: 🧙🏻‍♂️ [9468, 100, 247, 9468, 237, 119, 102470, 17245, 224, 31643]
N: 👱🏻‍♀️ [9468, 239, 109, 9468, 237, 119, 102470, 32990, 31643]

O: 👩🏿‍⚕️ [9468, 239, 102, 9468, 237, 123, 102470, 158, 248, 243, 31643]
N: 👩🏿‍⚕️ [9468, 239, 102, 9468, 237, 123, 102470, 158, 248, 243, 31643]

O: 🧗🏻 [9468, 100, 245, 9468, 237, 119]
N: 🧗🏻 [9468, 100, 245, 9468, 237, 119]

O: 🤘🏾 [9468, 97, 246, 9468, 237, 122]
N: 👨‍👧 [9468, 239, 101, 102470, 9468, 239, 100]

O: 👨‍👧 [9468, 239, 101, 102470, 9468, 239, 100]
N: 🤘🏾 [9468, 97, 246, 9468, 237, 122]

O: 🧊 [9468, 100, 232]
N: 🧊 [9468, 100, 232]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.26s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.49s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.57s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.20s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.67s/it]
Processing depth (3, 6, 7, 8, 9):   4%|▍         | 4/100 [01:40<34:06, 21.32s/it]2025-01-22 04:33:40.050 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the office.
2025-01-22 04:33:40.066 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2844, 2849) --> . John travelled to the
2025-01-22 04:33:40.066 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John got the apple.
2025-01-22 04:33:40.092 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4676, 4680) -->  got the apple.
2025-01-22 04:33:40.093 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went to the bathroom.
2025-01-22 04:33:40.117 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4986, 4991) -->  back to the bathroom.
2025-01-22 04:33:40.117 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John left the apple.
2025-01-22 04:33:40.151 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6565, 6569) -->  left the apple.
2025-01-22 04:33:40.151 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra travelled to the garden.
2025-01-22 04:33:40.188 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7263, 7268) --> . Sandra travelled to the
2025-01-22 04:33:40.188 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went back to the bathroom.
2025-01-22 04:33:40.195 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1399, 1405) --> . Daniel went back to the
2025-01-22 04:33:40.195 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went back to the kitchen.
2025-01-22 04:33:40.202 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1399, 1405) --> . Daniel went back to the
2025-01-22 04:33:40.203 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the garden.
2025-01-22 04:33:40.222 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2912, 2918) --> . Mary journeyed to the
2025-01-22 04:33:40.222 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary dropped the milk.
2025-01-22 04:33:40.263 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7081, 7085) -->  Mary dropped the milk
2025-01-22 04:33:40.263 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel journeyed to the hallway.
2025-01-22 04:33:40.292 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5878, 5884) --> . Daniel journeyed to the
2025-01-22 04:33:40.292 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary took the milk.
2025-01-22 04:33:40.309 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (2976, 2980) -->  Mary took the milk
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:33:41.127 | INFO     | test_jbb_embedding:begin_test:693 - The hallway.<|eot_id|>
2025-01-22 04:33:41.127 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8204])
2025-01-22 04:33:43.383 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [334.5217391304348, 31.9339469595418, 115.6826171875, 30.751334192123664, 42.18992820945946], 'topk_indices': array([   3,   19, 8189,   20, 8168, 6568, 8184, 8190, 8093, 8203, 8049,
          9, 8083, 8202,   14,   24,   23,    0, 8199, 8200]), 'topk_tokens': ['<|end_header_id|>', '26', ' apple', ' Jul', '.', '.', ' to', ' was', ' location', '\n\n', ' context', ':', '.\n\n', '<|end_header_id|>', '\n', '\n\n', '4', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [273.55, 507.125, 232.85, 652.875, 104.4]}, 'weight': {'score': [20.64266304347826, 23.284734493053865, 22.01513671875, 23.2971740430622, 29.774070945945947], 'topk_indices': array([3370, 3397, 3204, 3252, 7486, 7448, 1518, 1456, 4365, 4349, 5245,
       5184, 7157, 7213, 3553, 3579, 5009, 4954, 5038, 4979]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.990625, 20.5703125, 20.021875, 20.421875, 22.15]}, 'saliency': {'score': [1.799894913383152, 0.17540422440040063, 0.646484375, 0.16897092165646854, 0.31398835053315033], 'topk_indices': array([8197, 8177, 4989, 6565,   16,   22, 8201, 4678, 8183, 8083,   19,
          0, 6567, 8093, 8189, 6560,   24,   20,   23, 8049]), 'topk_tokens': ['Answer', 'Question', ' bathroom', ' left', ' Date', '202', 'assistant', ' apple', ' prior', '.\n\n', '26', '<|begin_of_text|>', ' apple', ' location', ' apple', '�', '\n\n', ' Jul', '4', ' context'], 'evidence_proportions': [1.47529296875, 2.58203125, 1.421875, 3.34130859375, 0.6436767578125]}}, 'pred_res': 'The hallway.<|eot_id|>', 'score': 0}
2025-01-22 04:33:43.390 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:33:43.390 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-29_pid-4_3-6-7-8-9.pkl | len: 3 |  size: 2.06 KB
Processing depth (3, 6, 7, 8, 9):   5%|▌         | 5/100 [01:44<32:50, 20.74s/it]Processing depth (3, 6, 7, 8, 9):   5%|▌         | 5/100 [01:44<33:00, 20.85s/it]
2025-01-22 04:33:43.470 | INFO     | __main__:<module>:82 - Selected idx: 30
2025-01-22 04:33:43.470 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the football before the kitchen? 
2025-01-22 04:33:43.470 | INFO     | __main__:<module>:84 - Answer: garden
2025-01-22 04:33:43.471 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 04:33:43.471 | INFO     | __main__:<module>:86 - Needle: [' Sandra went to the garden.', ' Mary got the football.', ' Sandra picked up the milk.', ' Mary journeyed to the garden.', ' Daniel travelled to the garden.', ' John moved to the office.', ' Daniel journeyed to the office.', ' John went to the kitchen.', ' Mary went to the kitchen.', ' Daniel travelled to the garden.']
2025-01-22 04:33:43.471 | INFO     | __main__:<module>:87 - Real Needle: [' Mary got the football.', ' Mary journeyed to the garden.', ' Mary went to the kitchen.', ' Daniel travelled to the garden.']
2025-01-22 04:33:43.471 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['👃🏼', '👩🏿\u200d🦽\u200d➡️', '🤽🏿\u200d♀', '👩🏾\u200d❤️\u200d💋\u200d👨🏾', '☝', '🍻', '🙍\u200d♂️', '🦆', '🙋🏿\u200d♂', '🧆']
emoji:
O: 👃🏼 [9468, 239, 225, 9468, 237, 120]
N: 🦆 [9468, 99, 228]

O: 👩🏿‍🦽‍➡️ [9468, 239, 102, 9468, 237, 123, 102470, 9468, 99, 121, 102470, 98115, 94, 31643]
N: 🤽🏿‍♀ [9468, 97, 121, 9468, 237, 123, 102470, 32990]

O: 🤽🏿‍♀ [9468, 97, 121, 9468, 237, 123, 102470, 32990]
N: 👩🏿‍🦽‍➡️ [9468, 239, 102, 9468, 237, 123, 102470, 9468, 99, 121, 102470, 98115, 94, 31643]

O: 👩🏾‍❤️‍💋‍👨🏾 [9468, 239, 102, 9468, 237, 122, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 122]
N: 🙍‍♂️ [9468, 247, 235, 102470, 17245, 224, 31643]

O: ☝ [18107, 251]
N: 🙋🏿‍♂ [9468, 247, 233, 9468, 237, 123, 102470, 17245, 224]

O: 🍻 [9468, 235, 119]
N: 👩🏾‍❤️‍💋‍👨🏾 [9468, 239, 102, 9468, 237, 122, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 122]

O: 🙍‍♂️ [9468, 247, 235, 102470, 17245, 224, 31643]
N: 👃🏼 [9468, 239, 225, 9468, 237, 120]

O: 🦆 [9468, 99, 228]
N: ☝ [18107, 251]

O: 🙋🏿‍♂ [9468, 247, 233, 9468, 237, 123, 102470, 17245, 224]
N: 🍻 [9468, 235, 119]

O: 🧆 [9468, 100, 228]
N: 🧆 [9468, 100, 228]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.16s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.22s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.15s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  2.69s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  3.24s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (1, 3, 8, 9):   0%|          | 0/100 [00:14<?, ?it/s]2025-01-22 04:33:58.349 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the football.
2025-01-22 04:33:58.353 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (682, 686) -->  Mary got the football
2025-01-22 04:33:58.354 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 04:33:58.368 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2638, 2644) --> . Mary journeyed to the
2025-01-22 04:33:58.368 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the kitchen.
2025-01-22 04:33:58.375 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1205, 1210) -->  John went to the kitchen
2025-01-22 04:33:58.375 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel travelled to the garden.
2025-01-22 04:33:58.424 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7133, 7138) -->  Daniel travelled to the garden
2025-01-22 04:33:58.425 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went to the garden.
2025-01-22 04:33:58.459 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6334, 6339) --> . Sandra went to the
2025-01-22 04:33:58.459 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra picked up the milk.
2025-01-22 04:33:58.466 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1198, 1203) --> . Sandra picked up the
2025-01-22 04:33:58.466 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the office.
2025-01-22 04:33:58.467 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (105, 110) --> . John moved to the
2025-01-22 04:33:58.467 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the office.
2025-01-22 04:33:58.493 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5025, 5031) --> . Daniel journeyed to the
2025-01-22 04:33:58.493 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went to the kitchen.
2025-01-22 04:33:58.499 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1203, 1208) -->  milk. John went to
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:34:03.243 | INFO     | test_jbb_embedding:begin_test:693 - Mary got the football.<|eot_id|>
2025-01-22 04:34:03.244 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8170])
2025-01-22 04:34:06.116 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [335.8828125, 30.51689824727762, 234.52403846153845, 29.112751092038884, 46.34159281716418], 'topk_indices': array([ 681, 8067, 1210, 8164, 8023,  683, 8168,   24, 8058,   14, 8160,
       8157, 8158, 8024,  686, 8165, 8068,  685, 8166,    0]), 'topk_tokens': ['.', ' first', '.', ':', ' you', ' got', '<|end_header_id|>', '\n\n', '.\n\n', '\n', ' kitchen', ' football', ' before', ' context', '.', '<|eot_id|>', ' location', ' football', '<|start_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [852.75, 194.16666666666666, 344.6, 83.73125]}, 'weight': {'score': [23.577734375, 23.262309968799705, 21.22205528846154, 23.26806093884582, 29.104477611940297], 'topk_indices': array([3388, 3361, 3233, 3281, 7423, 7461, 1576, 1514, 4346, 4362, 5229,
       5168, 7144, 7200, 3544, 3570, 4959, 5015, 4934, 4986]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.611328125, 20.052083333333332, 23.4265625, 25.5328125]}, 'saliency': {'score': [2.171160888671875, 0.17088194837422, 1.2944711538461537, 0.16236479590120123, 0.343809668697528], 'topk_indices': array([8163, 8062,   24, 8029, 8023,  329, 8152, 8058, 8064,  682, 8139,
       1209, 8067,  683, 8158, 8024, 8160, 8157, 8068,  685]), 'topk_tokens': ['Answer', ' obtained', '\n\n', ' locations', ' you', 'hue', 'Question', '.\n\n', ' item', ' Mary', ' return', ' kitchen', ' first', ' got', ' before', ' context', ' kitchen', ' football', ' location', ' football'], 'evidence_proportions': [5.88720703125, 1.0633138020833333, 2.1361328125, 0.5627685546875]}}, 'pred_res': 'Mary got the football.<|eot_id|>', 'score': 0}
2025-01-22 04:34:06.123 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:34:06.123 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-30_pid-0_1-3-8-9.pkl | len: 3 |  size: 2.04 KB
Processing depth (1, 3, 8, 9):   1%|          | 1/100 [00:22<37:10, 22.53s/it]is_0k: False
your chose emoji: ['🪔', '👩\u200d🦽', '🥇', '♂', '🧙🏾\u200d♂️', '🇸🇮', '👩🏿\u200d🤝\u200d👩🏽', '👰🏼\u200d♂️', '🏇🏾', '🔡']
emoji:
O: 🪔 [9468, 103, 242]
N: 🧙🏾‍♂️ [9468, 100, 247, 9468, 237, 122, 102470, 17245, 224, 31643]

O: 👩‍🦽 [9468, 239, 102, 102470, 9468, 99, 121]
N: 👩🏿‍🤝‍👩🏽 [9468, 239, 102, 9468, 237, 123, 102470, 9468, 97, 251, 102470, 9468, 239, 102, 9468, 237, 121]

O: 🥇 [9468, 98, 229]
N: 🇸🇮 [9468, 229, 116, 9468, 229, 106]

O: ♂ [17245, 224]
N: 👰🏼‍♂️ [9468, 239, 108, 9468, 237, 120, 102470, 17245, 224, 31643]

O: 🧙🏾‍♂️ [9468, 100, 247, 9468, 237, 122, 102470, 17245, 224, 31643]
N: 🥇 [9468, 98, 229]

O: 🇸🇮 [9468, 229, 116, 9468, 229, 106]
N: 👩‍🦽 [9468, 239, 102, 102470, 9468, 99, 121]

O: 👩🏿‍🤝‍👩🏽 [9468, 239, 102, 9468, 237, 123, 102470, 9468, 97, 251, 102470, 9468, 239, 102, 9468, 237, 121]
N: 🪔 [9468, 103, 242]

O: 👰🏼‍♂️ [9468, 239, 108, 9468, 237, 120, 102470, 17245, 224, 31643]
N: ♂ [17245, 224]

O: 🏇🏾 [9468, 237, 229, 9468, 237, 122]
N: 🏇🏾 [9468, 237, 229, 9468, 237, 122]

O: 🔡 [9468, 242, 94]
N: 🔡 [9468, 242, 94]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.76s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.45s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.06s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.64s/it]
Processing depth (1, 3, 4, 5):   1%|          | 1/100 [00:38<37:10, 22.53s/it]2025-01-22 04:34:22.538 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the football.
2025-01-22 04:34:22.542 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (822, 826) -->  Mary got the football
2025-01-22 04:34:22.542 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 04:34:22.557 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2900, 2906) --> . Mary journeyed to the
2025-01-22 04:34:22.557 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the kitchen.
2025-01-22 04:34:22.565 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1525, 1530) -->  John went to the kitchen
2025-01-22 04:34:22.565 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel travelled to the garden.
2025-01-22 04:34:22.587 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4224, 4229) -->  Daniel travelled to the garden
2025-01-22 04:34:22.587 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went to the garden.
2025-01-22 04:34:22.619 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6480, 6485) --> . Sandra went to the
2025-01-22 04:34:22.620 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra picked up the milk.
2025-01-22 04:34:22.627 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1518, 1523) --> . Sandra picked up the
2025-01-22 04:34:22.627 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the office.
2025-01-22 04:34:22.628 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (105, 110) --> . John moved to the
2025-01-22 04:34:22.628 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the office.
2025-01-22 04:34:22.657 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5241, 5247) --> . Daniel journeyed to the
2025-01-22 04:34:22.657 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went to the kitchen.
2025-01-22 04:34:22.666 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1523, 1528) -->  milk. John went to
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:34:23.460 | INFO     | test_jbb_embedding:begin_test:693 - Mary's location<|eot_id|>
2025-01-22 04:34:23.460 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8190])
2025-01-22 04:34:25.705 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [296.5375, 23.587372604662516, 145.08052884615384, 22.529581441021236, 17.2751369724026], 'topk_indices': array([ 822,  821, 8078,    1, 8189,   23,  823, 8178,  824, 8177, 8088,
        826,   24,    9, 8188,   14, 8185,  825, 8186,    0]), 'topk_tokens': [' Mary', '.', '.\n\n', '<|start_header_id|>', '\n\n', '4', ' got', ' before', ' the', ' football', ' location', '.', '\n\n', ':', '<|end_header_id|>', '\n', '<|eot_id|>', ' football', '<|start_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [878.0, 160.61458333333334, 144.0625, 146.95]}, 'weight': {'score': [23.577734375, 23.287083867325766, 21.22205528846154, 23.292960598993496, 29.663758116883116], 'topk_indices': array([3309, 3336, 3217, 3169, 7423, 7461, 1478, 1416, 4352, 4336, 5208,
       5147, 7188, 7132, 3492, 3518, 5001, 4972, 4949, 4924]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.611328125, 20.052083333333332, 23.4265625, 25.5328125]}, 'saliency': {'score': [1.96014404296875, 0.1311284571242219, 0.8070960411658654, 0.12448116745907235, 0.1254597453327922], 'topk_indices': array([  20,    0, 8174,   23, 8187, 8172,    9, 8159,   32,    8,  263,
         24, 8044, 8178, 8180,  822,  823, 8088, 8177,  825]), 'topk_tokens': [' Jul', '<|begin_of_text|>', ' Where', '4', 'assistant', 'Question', ':', ' return', '***', ' Date', 'hue', '\n\n', ' context', ' before', ' kitchen', ' Mary', ' got', ' location', ' football', ' football'], 'evidence_proportions': [6.13720703125, 0.8282877604166666, 0.87861328125, 1.058251953125]}}, 'pred_res': "Mary's location<|eot_id|>", 'score': 0}
2025-01-22 04:34:25.721 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:34:25.721 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-30_pid-1_1-3-4-5.pkl | len: 3 |  size: 2.03 KB
Processing depth (1, 3, 4, 5):   2%|▏         | 2/100 [00:42<33:58, 20.80s/it]is_0k: False
your chose emoji: ['🇹🇦', '🐵', '⏲', '🏃\u200d♂️\u200d➡️', '🦹\u200d♂', '👨\u200d🦰', '🖍️', '👨🏼\u200d❤\u200d💋\u200d👨🏻', '🧚🏿\u200d♂', '🧑🏾\u200d🍳']
emoji:
O: 🇹🇦 [9468, 229, 117, 9468, 229, 99]
N: 🐵 [9468, 238, 113]

O: 🐵 [9468, 238, 113]
N: 👨‍🦰 [9468, 239, 101, 102470, 9468, 99, 108]

O: ⏲ [158, 237, 110]
N: 🏃‍♂️‍➡️ [9468, 237, 225, 102470, 17245, 224, 31643, 102470, 98115, 94, 31643]

O: 🏃‍♂️‍➡️ [9468, 237, 225, 102470, 17245, 224, 31643, 102470, 98115, 94, 31643]
N: 🇹🇦 [9468, 229, 117, 9468, 229, 99]

O: 🦹‍♂ [9468, 99, 117, 102470, 17245, 224]
N: 👨🏼‍❤‍💋‍👨🏻 [9468, 239, 101, 9468, 237, 120, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 119]

O: 👨‍🦰 [9468, 239, 101, 102470, 9468, 99, 108]
N: 🖍️ [9468, 244, 235, 31643]

O: 🖍️ [9468, 244, 235, 31643]
N: 🧚🏿‍♂ [9468, 100, 248, 9468, 237, 123, 102470, 17245, 224]

O: 👨🏼‍❤‍💋‍👨🏻 [9468, 239, 101, 9468, 237, 120, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 119]
N: 🦹‍♂ [9468, 99, 117, 102470, 17245, 224]

O: 🧚🏿‍♂ [9468, 100, 248, 9468, 237, 123, 102470, 17245, 224]
N: ⏲ [158, 237, 110]

O: 🧑🏾‍🍳 [9468, 100, 239, 9468, 237, 122, 102470, 9468, 235, 111]
N: 🧑🏾‍🍳 [9468, 100, 239, 9468, 237, 122, 102470, 9468, 235, 111]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.20s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.56s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:05,  5.12s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.49s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.95s/it]
Processing depth (1, 3, 5, 7):   2%|▏         | 2/100 [00:59<33:58, 20.80s/it]2025-01-22 04:34:43.250 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the football.
2025-01-22 04:34:43.255 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (782, 786) -->  Mary got the football
2025-01-22 04:34:43.256 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 04:34:43.271 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2844, 2850) --> . Mary journeyed to the
2025-01-22 04:34:43.271 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the kitchen.
2025-01-22 04:34:43.278 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1419, 1424) -->  John went to the kitchen
2025-01-22 04:34:43.278 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel travelled to the garden.
2025-01-22 04:34:43.308 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5626, 5631) --> . Daniel travelled to the
2025-01-22 04:34:43.309 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went to the garden.
2025-01-22 04:34:43.345 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6444, 6449) --> . Sandra went to the
2025-01-22 04:34:43.345 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra picked up the milk.
2025-01-22 04:34:43.353 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1412, 1417) --> . Sandra picked up the
2025-01-22 04:34:43.353 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the office.
2025-01-22 04:34:43.354 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (105, 110) --> . John moved to the
2025-01-22 04:34:43.354 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the office.
2025-01-22 04:34:43.379 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5075, 5081) --> . Daniel journeyed to the
2025-01-22 04:34:43.379 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went to the kitchen.
2025-01-22 04:34:43.386 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1417, 1422) -->  milk. John went to
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:34:44.251 | INFO     | test_jbb_embedding:begin_test:693 - Mary got the football.<|eot_id|>
2025-01-22 04:34:44.251 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8184])
2025-01-22 04:34:46.463 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [288.4328125, 22.729880450714546, 150.57451923076923, 21.668829075052205, 28.083667652027028], 'topk_indices': array([8183,  782, 8172,    4,    1, 8072, 8171,  781,  783,    9, 8082,
         24, 8182,  784,   14,  786, 8179,  785,    0, 8180]), 'topk_tokens': ['\n\n', ' Mary', ' before', '\n\n', '<|start_header_id|>', '.\n\n', ' football', '.', ' got', ':', ' location', '\n\n', '<|end_header_id|>', ' the', '\n', '.', '<|eot_id|>', ' football', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [1017.25, 142.85416666666666, 113.8625, 54.64375]}, 'weight': {'score': [22.44921875, 23.28024039636008, 21.22205528846154, 23.28885521588257, 29.54370777027027], 'topk_indices': array([3303, 3330, 3223, 3175, 7419, 7457, 1508, 1446, 4328, 4344, 5158,
       5219, 7196, 7140, 3512, 3486, 4928, 4953, 5005, 4976]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.611328125, 20.052083333333332, 23.4265625, 21.01875]}, 'saliency': {'score': [1.858673095703125, 0.1258502725834402, 0.83929443359375, 0.1193147112704981, 0.20954090840107686], 'topk_indices': array([ 640, 8181,    9,   14, 8072,  269, 8153, 8081, 8166,    8, 8078,
       8172,   24, 8174, 8038,  782,  783, 8171, 8082,  785]), 'topk_tokens': ['�', 'assistant', ':', '\n', '.\n\n', 'hue', ' return', ' first', 'Question', ' Date', ' item', ' before', '\n\n', ' kitchen', ' context', ' Mary', ' got', ' football', ' location', ' football'], 'evidence_proportions': [6.92236328125, 0.74755859375, 0.696484375, 0.3032470703125]}}, 'pred_res': 'Mary got the football.<|eot_id|>', 'score': 0}
2025-01-22 04:34:46.470 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:34:46.470 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-30_pid-2_1-3-5-7.pkl | len: 3 |  size: 2.02 KB
Processing depth (1, 3, 5, 7):   3%|▎         | 3/100 [01:02<33:35, 20.78s/it]is_0k: False
your chose emoji: ['🎅🏻', '🇲🇩', '🐒', '🕵🏼\u200d♂️', '🙇🏾\u200d♂️', '🇭🇺', '🚶\u200d♂', '🏃🏽\u200d➡', '🤽🏿', '🏃🏽\u200d♀\u200d➡️']
emoji:
O: 🎅🏻 [9468, 236, 227, 9468, 237, 119]
N: 🐒 [9468, 238, 240]

O: 🇲🇩 [9468, 229, 110, 9468, 229, 102]
N: 🏃🏽‍➡ [9468, 237, 225, 9468, 237, 121, 102470, 98115, 94]

O: 🐒 [9468, 238, 240]
N: 🇭🇺 [9468, 229, 255, 9468, 229, 118]

O: 🕵🏼‍♂️ [9468, 243, 113, 9468, 237, 120, 102470, 17245, 224, 31643]
N: 🚶‍♂ [9468, 248, 114, 102470, 17245, 224]

O: 🙇🏾‍♂️ [9468, 247, 229, 9468, 237, 122, 102470, 17245, 224, 31643]
N: 🙇🏾‍♂️ [9468, 247, 229, 9468, 237, 122, 102470, 17245, 224, 31643]

O: 🇭🇺 [9468, 229, 255, 9468, 229, 118]
N: 🕵🏼‍♂️ [9468, 243, 113, 9468, 237, 120, 102470, 17245, 224, 31643]

O: 🚶‍♂ [9468, 248, 114, 102470, 17245, 224]
N: 🤽🏿 [9468, 97, 121, 9468, 237, 123]

O: 🏃🏽‍➡ [9468, 237, 225, 9468, 237, 121, 102470, 98115, 94]
N: 🇲🇩 [9468, 229, 110, 9468, 229, 102]

O: 🤽🏿 [9468, 97, 121, 9468, 237, 123]
N: 🎅🏻 [9468, 236, 227, 9468, 237, 119]

O: 🏃🏽‍♀‍➡️ [9468, 237, 225, 9468, 237, 121, 102470, 32990, 102470, 98115, 94, 31643]
N: 🏃🏽‍♀‍➡️ [9468, 237, 225, 9468, 237, 121, 102470, 32990, 102470, 98115, 94, 31643]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.42s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.34s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.10s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  2.64s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  3.23s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (4, 6, 7, 8):   3%|▎         | 3/100 [01:17<33:35, 20.78s/it]2025-01-22 04:35:01.110 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the football.
2025-01-22 04:35:01.128 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3616, 3620) -->  Mary got the football
2025-01-22 04:35:01.129 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 04:35:01.153 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4860, 4866) --> . Mary journeyed to the
2025-01-22 04:35:01.154 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the kitchen.
2025-01-22 04:35:01.161 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1520, 1525) -->  John went to the kitchen
2025-01-22 04:35:01.161 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel travelled to the garden.
2025-01-22 04:35:01.194 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6598, 6603) --> . Daniel travelled to the
2025-01-22 04:35:01.194 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went to the garden.
2025-01-22 04:35:01.226 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6446, 6451) --> . Sandra went to the
2025-01-22 04:35:01.227 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra picked up the milk.
2025-01-22 04:35:01.234 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1514, 1519) -->  Sandra picked up the milk
2025-01-22 04:35:01.234 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the office.
2025-01-22 04:35:01.235 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (105, 110) --> . John moved to the
2025-01-22 04:35:01.235 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the office.
2025-01-22 04:35:01.262 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5271, 5277) --> . Daniel journeyed to the
2025-01-22 04:35:01.262 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went to the kitchen.
2025-01-22 04:35:01.271 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1518, 1523) -->  milk. John went to
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:35:04.993 | INFO     | test_jbb_embedding:begin_test:693 - Mary got the football.<|eot_id|>
2025-01-22 04:35:04.994 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8114])
2025-01-22 04:35:07.821 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [355.10625, 31.44338656523346, 185.42668269230768, 30.145304175442945, 56.06280048076923], 'topk_indices': array([   4, 7968, 3615, 3620, 3616, 8102, 1509,   24, 8101, 8012, 3617,
       8002, 1510,    9, 3619, 8109,   14, 8110, 8112,    0]), 'topk_tokens': ['\n\n', ' context', '.', '.', ' Mary', ' before', '�', '\n\n', ' football', ' location', ' got', '.\n\n', '�', ':', ' football', '<|eot_id|>', '\n', '<|start_header_id|>', '<|end_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [934.0, 307.9375, 196.375, 107.325]}, 'weight': {'score': [22.44921875, 23.222363172970308, 22.09735576923077, 23.227903140874737, 29.141826923076923], 'topk_indices': array([3280, 3253, 3173, 3125, 7363, 7401, 1467, 1405, 4237, 4253, 5126,
       5065, 7120, 7064, 3436, 3462, 4831, 4886, 4915, 4856]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.611328125, 20.052083333333332, 23.4265625, 21.01875]}, 'saliency': {'score': [2.297821044921875, 0.17460346774131452, 1.1123985877403846, 0.1663210957101428, 0.3968646709735577], 'topk_indices': array([  24,    9, 8083, 8104, 8107,    8,   14, 1509, 8002, 4862, 1508,
       1510, 8102, 7968, 8096, 8012, 3617, 3616, 8101, 3619]), 'topk_tokens': ['\n\n', ':', ' return', ' kitchen', 'Answer', ' Date', '\n', '�', '.\n\n', ' journey', '�', '�', ' before', ' context', 'Question', ' location', ' got', ' Mary', ' football', ' football'], 'evidence_proportions': [6.49072265625, 1.7906087239583333, 1.219482421875, 0.6304931640625]}}, 'pred_res': 'Mary got the football.<|eot_id|>', 'score': 0}
2025-01-22 04:35:07.828 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:35:07.828 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-30_pid-3_4-6-7-8.pkl | len: 3 |  size: 2.01 KB
Processing depth (4, 6, 7, 8):   4%|▍         | 4/100 [01:24<33:36, 21.01s/it]is_0k: False
your chose emoji: ['🧘🏽\u200d♂️', '🆗', '🛷', '👩', '\U0001f7f0', '🥫', '🧔🏻\u200d♀', '🌒', '😺', '↕']
emoji:
O: 🧘🏽‍♂️ [9468, 100, 246, 9468, 237, 121, 102470, 17245, 224, 31643]
N: 🟰 [9468, 253, 108]

O: 🆗 [9468, 228, 245]
N: 😺 [76460, 118]

O: 🛷 [9468, 249, 115]
N: 🥫 [9468, 98, 104]

O: 👩 [9468, 239, 102]
N: 🌒 [9468, 102032]

O: 🟰 [9468, 253, 108]
N: 🆗 [9468, 228, 245]

O: 🥫 [9468, 98, 104]
N: 🧔🏻‍♀ [9468, 100, 242, 9468, 237, 119, 102470, 32990]

O: 🧔🏻‍♀ [9468, 100, 242, 9468, 237, 119, 102470, 32990]
N: 🛷 [9468, 249, 115]

O: 🌒 [9468, 102032]
N: 🧘🏽‍♂️ [9468, 100, 246, 9468, 237, 121, 102470, 17245, 224, 31643]

O: 😺 [76460, 118]
N: 👩 [9468, 239, 102]

O: ↕ [27017, 243]
N: ↕ [27017, 243]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.98s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.97s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.50s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.10s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.71s/it]
Processing depth (1, 2, 3, 9):   4%|▍         | 4/100 [01:40<33:36, 21.01s/it]2025-01-22 04:35:24.350 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the football.
2025-01-22 04:35:24.355 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (790, 794) -->  Mary got the football
2025-01-22 04:35:24.356 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 04:35:24.367 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1624, 1630) --> . Mary journeyed to the
2025-01-22 04:35:24.367 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the kitchen.
2025-01-22 04:35:24.376 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1291, 1296) -->  John went to the kitchen
2025-01-22 04:35:24.376 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel travelled to the garden.
2025-01-22 04:35:24.414 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7218, 7223) --> . Daniel travelled to the
2025-01-22 04:35:24.414 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went to the garden.
2025-01-22 04:35:24.448 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6412, 6417) --> . Sandra went to the
2025-01-22 04:35:24.448 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra picked up the milk.
2025-01-22 04:35:24.456 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1283, 1288) -->  Republican. Sandra picked up
2025-01-22 04:35:24.456 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the office.
2025-01-22 04:35:24.457 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (105, 110) --> . John moved to the
2025-01-22 04:35:24.457 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the office.
2025-01-22 04:35:24.485 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5113, 5119) --> . Daniel journeyed to the
2025-01-22 04:35:24.485 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went to the kitchen.
2025-01-22 04:35:24.492 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1289, 1294) -->  milk. John went to
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:35:25.356 | INFO     | test_jbb_embedding:begin_test:693 - Mary got the football.<|eot_id|>
2025-01-22 04:35:25.357 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8196])
2025-01-22 04:35:27.595 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [323.465625, 22.812286559336503, 157.31310096153845, 21.645833972157487, 23.226806640625], 'topk_indices': array([   1, 8179, 8186, 8183, 8195, 8094,  790, 8184,    9,  789,  791,
         24, 8194,   14, 8191,  792,  794,    0,  793, 8192]), 'topk_tokens': ['<|start_header_id|>', ':', ' kitchen', ' football', '\n\n', ' location', ' Mary', ' before', ':', '.', ' got', '\n\n', '<|end_header_id|>', '\n', '<|eot_id|>', ' the', '.', '<|begin_of_text|>', ' football', '<|start_header_id|>'], 'evidence_proportions': [1155.375, 100.96875, 210.525, 37.875]}, 'weight': {'score': [22.44921875, 23.283641678863276, 22.153846153846153, 23.289291518459464, 29.2482421875], 'topk_indices': array([3351, 3378, 3271, 3223, 7435, 7397, 1542, 1480, 4346, 4330, 5148,
       5209, 7112, 7168, 3560, 3534, 4943, 4918, 4966, 4995]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.611328125, 20.052083333333332, 23.4265625, 21.01875]}, 'saliency': {'score': [2.124871826171875, 0.12627689209431028, 0.8856741098257211, 0.11895244387370829, 0.1733469009399414], 'topk_indices': array([8084,    0, 8189,    9, 8195, 8090, 8180,  263, 8165, 8193,    8,
         24, 8178, 8094, 8184, 8186, 8183,  790,  791,  793]), 'topk_tokens': ['.\n\n', '<|begin_of_text|>', 'Answer', ':', '\n\n', ' item', ' Where', 'hue', ' return', 'assistant', ' Date', '\n\n', 'Question', ' location', ' before', ' kitchen', ' football', ' Mary', ' got', ' football'], 'evidence_proportions': [7.91357421875, 0.5374348958333334, 1.3083984375, 0.2153076171875]}}, 'pred_res': 'Mary got the football.<|eot_id|>', 'score': 0}
2025-01-22 04:35:27.602 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:35:27.602 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-30_pid-4_1-2-3-9.pkl | len: 3 |  size: 2.04 KB
Processing depth (1, 2, 3, 9):   5%|▌         | 5/100 [01:44<32:33, 20.56s/it]Processing depth (1, 2, 3, 9):   5%|▌         | 5/100 [01:44<32:57, 20.82s/it]
2025-01-22 04:35:27.678 | INFO     | __main__:<module>:82 - Selected idx: 31
2025-01-22 04:35:27.678 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the location prior to the place where the football was discarded, left or dropped?
2025-01-22 04:35:27.678 | INFO     | __main__:<module>:84 - Answer: garden
2025-01-22 04:35:27.678 | INFO     | __main__:<module>:85 - Tag: 4-hop
2025-01-22 04:35:27.678 | INFO     | __main__:<module>:86 - Needle: [' Mary journeyed to the garden.', ' Mary got the football.', ' Sandra went to the garden.', ' Daniel journeyed to the office.', ' Mary went to the kitchen.', ' Daniel travelled to the garden.', ' John moved to the office.', ' Sandra picked up the milk.', ' John went to the kitchen.', ' Mary put down the football.', ' Daniel travelled to the garden.']
2025-01-22 04:35:27.678 | INFO     | __main__:<module>:87 - Real Needle: [' Mary journeyed to the garden.', ' Mary got the football.', ' Mary went to the kitchen.', ' Mary put down the football.', ' Daniel travelled to the garden.']
2025-01-22 04:35:27.678 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['🇰🇿', '💂🏿\u200d♀', '⚗', '🚵🏾', '🕶', '🚵🏾\u200d♂️', '👩🏽\u200d⚖️', '🤛🏽', '👩🏽\u200d🚒', '👩🏿\u200d❤\u200d💋\u200d👩🏻']
emoji:
O: 🇰🇿 [9468, 229, 108, 9468, 229, 123]
N: 🚵🏾‍♂️ [9468, 248, 113, 9468, 237, 122, 102470, 17245, 224, 31643]

O: 💂🏿‍♀ [93273, 224, 9468, 237, 123, 102470, 32990]
N: 🚵🏾 [9468, 248, 113, 9468, 237, 122]

O: ⚗ [158, 248, 245]
N: 💂🏿‍♀ [93273, 224, 9468, 237, 123, 102470, 32990]

O: 🚵🏾 [9468, 248, 113, 9468, 237, 122]
N: 🇰🇿 [9468, 229, 108, 9468, 229, 123]

O: 🕶 [9468, 243, 114]
N: 🤛🏽 [9468, 97, 249, 9468, 237, 121]

O: 🚵🏾‍♂️ [9468, 248, 113, 9468, 237, 122, 102470, 17245, 224, 31643]
N: 👩🏽‍🚒 [9468, 239, 102, 9468, 237, 121, 102470, 9468, 248, 240]

O: 👩🏽‍⚖️ [9468, 239, 102, 9468, 237, 121, 102470, 158, 248, 244, 31643]
N: 🕶 [9468, 243, 114]

O: 🤛🏽 [9468, 97, 249, 9468, 237, 121]
N: ⚗ [158, 248, 245]

O: 👩🏽‍🚒 [9468, 239, 102, 9468, 237, 121, 102470, 9468, 248, 240]
N: 👩🏽‍⚖️ [9468, 239, 102, 9468, 237, 121, 102470, 158, 248, 244, 31643]

O: 👩🏿‍❤‍💋‍👩🏻 [9468, 239, 102, 9468, 237, 123, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 119]
N: 👩🏿‍❤‍💋‍👩🏻 [9468, 239, 102, 9468, 237, 123, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 119]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.50s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.94s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.37s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.84s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.49s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (1, 2, 5, 6, 7):   0%|          | 0/100 [00:15<?, ?it/s]2025-01-22 04:35:43.825 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the garden.
2025-01-22 04:35:43.830 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (830, 836) --> . Mary journeyed to the
2025-01-22 04:35:43.830 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary got the football.
2025-01-22 04:35:43.839 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1798, 1802) -->  Mary got the football
2025-01-22 04:35:43.839 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the kitchen.
2025-01-22 04:35:43.839 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (113, 118) -->  John went to the kitchen
2025-01-22 04:35:43.840 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary put down the football.
2025-01-22 04:35:43.866 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4782, 4787) --> . Mary put down the
2025-01-22 04:35:43.866 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel travelled to the garden.
2025-01-22 04:35:43.898 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5672, 5677) --> . Daniel travelled to the
2025-01-22 04:35:43.898 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went to the garden.
2025-01-22 04:35:43.921 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4611, 4616) -->  Sandra went to the garden
2025-01-22 04:35:43.921 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the office.
2025-01-22 04:35:43.922 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (31, 37) -->  journeyed to the office.
2025-01-22 04:35:43.922 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the office.
2025-01-22 04:35:43.925 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (640, 645) --> . John moved to the
2025-01-22 04:35:43.925 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra picked up the milk.
2025-01-22 04:35:43.965 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7000, 7005) --> . Sandra picked up the
2025-01-22 04:35:43.965 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went to the kitchen.
2025-01-22 04:35:43.966 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (112, 117) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:35:47.166 | INFO     | test_jbb_embedding:begin_test:693 - the garden<|eot_id|>
2025-01-22 04:35:47.166 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8249])
2025-01-22 04:35:50.323 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [106.780625, 12.062798223158023, 103.54086538461539, 11.484042532922814, 7.177132654671717], 'topk_indices': array([8213,    1, 8241, 1801, 8209, 8243, 4321,    4, 8221, 8128,    9,
         23, 8248,  836,   24,   14, 8245, 8247, 8244,    0]), 'topk_tokens': ['.', '<|start_header_id|>', '?\n', ' football', ' return', ':', 'nes', '\n\n', '.\n\n', '.\n\n', ':', '4', '\n\n', ' garden', '\n\n', '\n', '<|start_header_id|>', '<|end_header_id|>', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [126.08333333333333, 162.671875, 117.0, 103.55, 31.915625]}, 'weight': {'score': [22.31375, 23.3189586615366, 21.110276442307693, 23.329025233203268, 29.604166666666668], 'topk_indices': array([3381, 3354, 3226, 3274, 7501, 7463, 1433, 1495, 4339, 4355, 5186,
       5247, 7240, 7184, 3537, 3563, 5040, 4988, 4963, 5011]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.052083333333332, 26.611328125, 23.4265625, 21.771875, 21.01875]}, 'saliency': {'score': [0.644305419921875, 0.06727233235834873, 0.5918673001802884, 0.06385015258119246, 0.05371317237314552], 'topk_indices': array([8128,   14,    8, 8222, 8234, 8138, 8242, 8246,   20,   23, 8209,
       4611, 8248, 4615,   24,   39, 4321, 4201, 1801,  836]), 'topk_tokens': ['.\n\n', '\n', ' Date', 'Question', ' football', ' location', 'Answer', 'assistant', ' Jul', '4', ' return', ' Sandra', '\n\n', ' garden', '\n\n', '***', 'nes', ' kitchen', ' football', ' garden'], 'evidence_proportions': [0.6735026041666666, 1.14666748046875, 0.729345703125, 0.585791015625, 0.180853271484375]}}, 'pred_res': 'the garden<|eot_id|>', 'score': 100}
2025-01-22 04:35:50.327 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:35:50.327 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-31_pid-0_1-2-5-6-7.pkl | len: 3 |  size: 2.05 KB
Processing depth (1, 2, 5, 6, 7):   1%|          | 1/100 [00:22<37:11, 22.54s/it]is_0k: False
your chose emoji: ['🍤', '🚶🏿\u200d♀\u200d➡️', '👩🏽\u200d💻', '🧑🏽\u200d🌾', '🧑🏻\u200d❤\u200d💋\u200d🧑🏼', '👩🏼\u200d🤝\u200d👨🏽', '🌪', '🚶🏾\u200d♀\u200d➡', '✔', '👩🏼\u200d❤\u200d👨🏽']
emoji:
O: 🍤 [9468, 235, 97]
N: ✔ [75351]

O: 🚶🏿‍♀‍➡️ [9468, 248, 114, 9468, 237, 123, 102470, 32990, 102470, 98115, 94, 31643]
N: 🍤 [9468, 235, 97]

O: 👩🏽‍💻 [9468, 239, 102, 9468, 237, 121, 102470, 93273, 119]
N: 🧑🏻‍❤‍💋‍🧑🏼 [9468, 100, 239, 9468, 237, 119, 102470, 121643, 102470, 93273, 233, 102470, 9468, 100, 239, 9468, 237, 120]

O: 🧑🏽‍🌾 [9468, 100, 239, 9468, 237, 121, 102470, 9468, 234, 122]
N: 👩🏼‍🤝‍👨🏽 [9468, 239, 102, 9468, 237, 120, 102470, 9468, 97, 251, 102470, 9468, 239, 101, 9468, 237, 121]

O: 🧑🏻‍❤‍💋‍🧑🏼 [9468, 100, 239, 9468, 237, 119, 102470, 121643, 102470, 93273, 233, 102470, 9468, 100, 239, 9468, 237, 120]
N: 🧑🏽‍🌾 [9468, 100, 239, 9468, 237, 121, 102470, 9468, 234, 122]

O: 👩🏼‍🤝‍👨🏽 [9468, 239, 102, 9468, 237, 120, 102470, 9468, 97, 251, 102470, 9468, 239, 101, 9468, 237, 121]
N: 🚶🏿‍♀‍➡️ [9468, 248, 114, 9468, 237, 123, 102470, 32990, 102470, 98115, 94, 31643]

O: 🌪 [9468, 234, 103]
N: 👩🏽‍💻 [9468, 239, 102, 9468, 237, 121, 102470, 93273, 119]

O: 🚶🏾‍♀‍➡ [9468, 248, 114, 9468, 237, 122, 102470, 32990, 102470, 98115, 94]
N: 🚶🏾‍♀‍➡ [9468, 248, 114, 9468, 237, 122, 102470, 32990, 102470, 98115, 94]

O: ✔ [75351]
N: 🌪 [9468, 234, 103]

O: 👩🏼‍❤‍👨🏽 [9468, 239, 102, 9468, 237, 120, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 121]
N: 👩🏼‍❤‍👨🏽 [9468, 239, 102, 9468, 237, 120, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 121]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.73s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.60s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.60s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.21s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.73s/it]
Processing depth (2, 3, 5, 7, 9):   1%|          | 1/100 [00:39<37:11, 22.54s/it]2025-01-22 04:36:07.032 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the garden.
2025-01-22 04:36:07.041 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1798, 1804) --> . Mary journeyed to the
2025-01-22 04:36:07.042 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary got the football.
2025-01-22 04:36:07.056 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2934, 2938) -->  Mary got the football
2025-01-22 04:36:07.056 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the kitchen.
2025-01-22 04:36:07.056 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (48, 53) -->  went to the kitchen.
2025-01-22 04:36:07.056 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary put down the football.
2025-01-22 04:36:07.084 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5642, 5647) --> . Mary put down the
2025-01-22 04:36:07.084 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel travelled to the garden.
2025-01-22 04:36:07.121 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7155, 7160) -->  Daniel travelled to the garden
2025-01-22 04:36:07.121 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went to the garden.
2025-01-22 04:36:07.144 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4585, 4590) -->  Sandra went to the garden
2025-01-22 04:36:07.144 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the office.
2025-01-22 04:36:07.144 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (31, 37) -->  journeyed to the office.
2025-01-22 04:36:07.144 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the office.
2025-01-22 04:36:07.148 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (648, 653) --> . John moved to the
2025-01-22 04:36:07.148 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra picked up the milk.
2025-01-22 04:36:07.184 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6948, 6953) --> . Sandra picked up the
2025-01-22 04:36:07.184 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went to the kitchen.
2025-01-22 04:36:07.185 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (47, 52) -->  John went to the kitchen
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:36:07.967 | INFO     | test_jbb_embedding:begin_test:693 - the garden<|eot_id|>
2025-01-22 04:36:07.967 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8201])
2025-01-22 04:36:10.203 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [138.00625, 16.956863648829838, 111.27884615384616, 16.28488938120937, 10.702578125], 'topk_indices': array([8193, 8175, 8041, 1804,    8,   20, 8200, 8090, 2937,    4, 8046,
       8080, 8197,   24,   23,    9, 8199,   14, 8196,    0]), 'topk_tokens': ['?\n', ':', '\n', ' garden', ' Date', ' Jul', '\n\n', ' location', ' football', '\n\n', ' context', '.\n\n', '<|start_header_id|>', '\n\n', '4', ':', '<|end_header_id|>', '\n', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [147.11458333333334, 229.5625, 127.75, 146.0375, 56.05625]}, 'weight': {'score': [22.444375, 23.277857980862994, 22.03125, 23.284389181896234, 29.3675], 'topk_indices': array([3305, 3278, 3144, 3192, 7483, 7445, 1496, 1434, 4309, 4293, 5174,
       5235, 7222, 7166, 3487, 3461, 4976, 4951, 5028, 4999]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.052083333333332, 26.611328125, 19.565625, 21.771875, 25.5328125]}, 'saliency': {'score': [0.8022265625, 0.09482985505355619, 0.6474891075721154, 0.09089828897338403, 0.07927073160807292], 'topk_indices': array([8188, 5994, 4221,   14,    9, 8161, 8194,   19, 1243,   24, 4589,
          8, 8080, 8090, 1804, 8174,   20,   23, 2937, 8046]), 'topk_tokens': [' discarded', ' office', ' kitchen', '\n', ':', ' return', 'Answer', '26', 'nes', '\n\n', ' garden', ' Date', '.\n\n', ' location', ' garden', 'Question', ' Jul', '4', ' football', ' context'], 'evidence_proportions': [0.810546875, 1.5977783203125, 0.592724609375, 0.789990234375, 0.3775390625]}}, 'pred_res': 'the garden<|eot_id|>', 'score': 100}
2025-01-22 04:36:10.218 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:36:10.219 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-31_pid-1_2-3-5-7-9.pkl | len: 3 |  size: 2.04 KB
Processing depth (2, 3, 5, 7, 9):   2%|▏         | 2/100 [00:42<34:16, 20.98s/it]is_0k: False
your chose emoji: ['👨🏻\u200d❤️\u200d💋\u200d👨🏽', '📼', '👩\u200d🦯', '🦵', '🍋\u200d🟩', '👩🏽\u200d🦱', '👩🏻\u200d❤\u200d👨🏻', '🤽\u200d♀', '🌳', '⚔']
emoji:
O: 👨🏻‍❤️‍💋‍👨🏽 [9468, 239, 101, 9468, 237, 119, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 121]
N: 🤽‍♀ [9468, 97, 121, 102470, 32990]

O: 📼 [9468, 241, 120]
N: 🦵 [9468, 99, 113]

O: 👩‍🦯 [9468, 239, 102, 102470, 9468, 99, 107]
N: 📼 [9468, 241, 120]

O: 🦵 [9468, 99, 113]
N: 👩🏻‍❤‍👨🏻 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 119]

O: 🍋‍🟩 [9468, 235, 233, 102470, 9468, 253, 102]
N: 👨🏻‍❤️‍💋‍👨🏽 [9468, 239, 101, 9468, 237, 119, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 121]

O: 👩🏽‍🦱 [9468, 239, 102, 9468, 237, 121, 102470, 9468, 99, 109]
N: 🌳 [9468, 234, 111]

O: 👩🏻‍❤‍👨🏻 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 119]
N: 👩🏽‍🦱 [9468, 239, 102, 9468, 237, 121, 102470, 9468, 99, 109]

O: 🤽‍♀ [9468, 97, 121, 102470, 32990]
N: 🍋‍🟩 [9468, 235, 233, 102470, 9468, 253, 102]

O: 🌳 [9468, 234, 111]
N: 👩‍🦯 [9468, 239, 102, 102470, 9468, 99, 107]

O: ⚔ [158, 248, 242]
N: ⚔ [158, 248, 242]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:10,  3.56s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.32s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.17s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  2.71s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  3.22s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 1, 3, 8, 9):   2%|▏         | 2/100 [00:57<34:16, 20.98s/it]2025-01-22 04:36:24.921 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the garden.
2025-01-22 04:36:24.922 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 37) -->  journeyed to the garden.
2025-01-22 04:36:24.922 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary got the football.
2025-01-22 04:36:24.928 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (922, 926) -->  Mary got the football
2025-01-22 04:36:24.928 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the kitchen.
2025-01-22 04:36:24.929 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (120, 125) -->  John went to the kitchen
2025-01-22 04:36:24.929 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary put down the football.
2025-01-22 04:36:24.964 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6532, 6537) --> . Mary put down the
2025-01-22 04:36:24.964 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel travelled to the garden.
2025-01-22 04:36:24.965 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (33, 38) -->  to the garden. Daniel
2025-01-22 04:36:24.965 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went to the garden.
2025-01-22 04:36:24.987 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4611, 4616) -->  Sandra went to the garden
2025-01-22 04:36:24.987 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the office.
2025-01-22 04:36:24.987 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (32, 38) --> ed to the garden. Daniel
2025-01-22 04:36:24.988 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the office.
2025-01-22 04:36:24.991 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (771, 776) --> . John moved to the
2025-01-22 04:36:24.992 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra picked up the milk.
2025-01-22 04:36:25.030 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6944, 6949) --> . Sandra picked up the
2025-01-22 04:36:25.030 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went to the kitchen.
2025-01-22 04:36:25.031 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (119, 124) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:36:28.058 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 04:36:28.058 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8205])
2025-01-22 04:36:31.030 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [208.95375, 14.614401536610623, 153.72115384615384, 13.57538483051367, 6.639255275974026], 'topk_indices': array([  30, 6116,   25, 8084,   29, 7389, 5980,    9, 2941,   23,   31,
       8204, 8201, 8203, 4615,   35,   24,   14, 8200,    0]), 'topk_tokens': ['Mary', ' the', '<|eot_id|>', '.\n\n', '\n\n', ' tele', ' office', ':', ' kitchen', '4', ' journey', '\n\n', '<|start_header_id|>', '<|end_header_id|>', ' garden', ' garden', '\n\n', '\n', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [308.9166666666667, 170.3125, 169.65, 103.64375, 264.525]}, 'weight': {'score': [22.13125, 23.28393983004386, 21.235276442307693, 23.294002658759347, 29.538555194805195], 'topk_indices': array([3365, 3338, 3210, 3258, 7433, 7471, 1442, 1504, 4337, 4353, 5215,
       5154, 7128, 7184, 3521, 3547, 4956, 4979, 4931, 5008]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.958333333333332, 26.611328125, 23.4265625, 21.771875, 20.21875]}, 'saliency': {'score': [1.1991796875, 0.08183516117564418, 0.87249755859375, 0.07589047127850312, 0.04953914493709415], 'topk_indices': array([7341, 8204, 4611,    0,   47,  925,  120,   44, 7340,   24,   46,
       5980, 8190,   30, 8178, 2941, 7389,   31, 4615,   35]), 'topk_tokens': ['graph', '\n\n', ' Sandra', '<|begin_of_text|>', '\n\n\n', ' football', ' John', ' PA', ' tele', '\n\n', '***', ' office', ' football', 'Mary', 'Question', ' kitchen', ' tele', ' journey', ' garden', ' garden'], 'evidence_proportions': [1.7146809895833333, 1.1435546875, 1.06845703125, 0.56201171875, 1.39296875]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 0}
2025-01-22 04:36:31.036 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:36:31.036 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-31_pid-2_0-1-3-8-9.pkl | len: 3 |  size: 2.08 KB
Processing depth (0, 1, 3, 8, 9):   3%|▎         | 3/100 [01:03<33:48, 20.91s/it]is_0k: False
your chose emoji: ['🪴', '👩🏻\u200d✈️', '🧑🏾\u200d✈️', '📺', '👭🏼', '〰', '🧑🏼\u200d🍳', '👩🏼\u200d❤️\u200d💋\u200d👨🏻', '🍤', '👨\u200d🦽\u200d➡️']
emoji:
O: 🪴 [9468, 103, 112]
N: 👭🏼 [9468, 239, 255, 9468, 237, 120]

O: 👩🏻‍✈️ [9468, 239, 102, 9468, 237, 119, 102470, 38798, 230, 31643]
N: 👩🏼‍❤️‍💋‍👨🏻 [9468, 239, 102, 9468, 237, 120, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 119]

O: 🧑🏾‍✈️ [9468, 100, 239, 9468, 237, 122, 102470, 38798, 230, 31643]
N: 👩🏻‍✈️ [9468, 239, 102, 9468, 237, 119, 102470, 38798, 230, 31643]

O: 📺 [9468, 241, 118]
N: 🪴 [9468, 103, 112]

O: 👭🏼 [9468, 239, 255, 9468, 237, 120]
N: 🧑🏼‍🍳 [9468, 100, 239, 9468, 237, 120, 102470, 9468, 235, 111]

O: 〰 [1300, 108]
N: 🍤 [9468, 235, 97]

O: 🧑🏼‍🍳 [9468, 100, 239, 9468, 237, 120, 102470, 9468, 235, 111]
N: 📺 [9468, 241, 118]

O: 👩🏼‍❤️‍💋‍👨🏻 [9468, 239, 102, 9468, 237, 120, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 119]
N: 〰 [1300, 108]

O: 🍤 [9468, 235, 97]
N: 🧑🏾‍✈️ [9468, 100, 239, 9468, 237, 122, 102470, 38798, 230, 31643]

O: 👨‍🦽‍➡️ [9468, 239, 101, 102470, 9468, 99, 121, 102470, 98115, 94, 31643]
N: 👨‍🦽‍➡️ [9468, 239, 101, 102470, 9468, 99, 121, 102470, 98115, 94, 31643]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.89s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.82s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.58s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.19s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.75s/it]
Processing depth (0, 1, 2, 5, 9):   3%|▎         | 3/100 [01:20<33:48, 20.91s/it]2025-01-22 04:36:47.869 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the garden.
2025-01-22 04:36:47.870 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 37) -->  journeyed to the garden.
2025-01-22 04:36:47.870 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary got the football.
2025-01-22 04:36:47.875 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (922, 926) -->  Mary got the football
2025-01-22 04:36:47.875 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the kitchen.
2025-01-22 04:36:47.876 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (120, 125) -->  John went to the kitchen
2025-01-22 04:36:47.876 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary put down the football.
2025-01-22 04:36:47.899 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4235, 4240) -->  Mary put down the football
2025-01-22 04:36:47.899 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel travelled to the garden.
2025-01-22 04:36:47.899 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (33, 38) -->  to the garden. Daniel
2025-01-22 04:36:47.900 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went to the garden.
2025-01-22 04:36:47.925 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4632, 4637) --> . Sandra went to the
2025-01-22 04:36:47.925 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the office.
2025-01-22 04:36:47.926 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (32, 38) --> ed to the garden. Daniel
2025-01-22 04:36:47.926 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the office.
2025-01-22 04:36:47.930 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (771, 776) --> . John moved to the
2025-01-22 04:36:47.931 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra picked up the milk.
2025-01-22 04:36:47.968 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6998, 7003) --> . Sandra picked up the
2025-01-22 04:36:47.968 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went to the kitchen.
2025-01-22 04:36:47.969 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (119, 124) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:36:48.802 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 04:36:48.803 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8227])
2025-01-22 04:36:51.047 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [192.0025, 14.52841832472661, 131.14873798076923, 13.615228405061744, 10.319369229403408], 'topk_indices': array([  47, 8219, 8200,   46,    4, 8226,   31, 8201, 8225,   23, 8072,
         35, 8106,    9,   24, 4637, 8222,   14,    0, 8223]), 'topk_tokens': ['\n\n\n', '?\n', 'Question', '***', '\n\n', '\n\n', ' journey', ':', '<|end_header_id|>', '4', ' context', ' garden', '.\n\n', ':', '\n\n', ' garden', '<|eot_id|>', '\n', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [273.1875, 168.1875, 167.2, 89.3875, 241.05]}, 'weight': {'score': [23.0940625, 23.31260062272175, 20.3671875, 23.32263170161389, 30.096946022727273], 'topk_indices': array([3282, 3309, 3154, 3202, 7459, 7497, 1492, 1430, 4287, 4303, 5136,
       5197, 7236, 7180, 3465, 3491, 4938, 4913, 4961, 4990]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.958333333333332, 26.611328125, 23.4265625, 26.5859375, 20.21875]}, 'saliency': {'score': [1.138017578125, 0.08110703831020276, 0.7016777625450721, 0.0759037613416887, 0.077296950600364], 'topk_indices': array([  20,    0,   14, 4633, 7790, 8212,  925,   23,    8, 8106,   30,
         47,   24, 2035,   46,   31, 8200, 8072,   35, 4637]), 'topk_tokens': [' Jul', '<|begin_of_text|>', '\n', ' Sandra', 'inen', ' football', ' football', '4', ' Date', '.\n\n', 'Mary', '\n\n\n', '\n\n', ' kitchen', '***', ' journey', 'Question', ' context', ' garden', ' garden'], 'evidence_proportions': [1.5177408854166667, 1.1717529296875, 1.04736328125, 0.616259765625, 1.2677734375]}}, 'pred_res': 'The garden.<|eot_id|>', 'score': 100}
2025-01-22 04:36:51.059 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:36:51.059 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-31_pid-3_0-1-2-5-9.pkl | len: 3 |  size: 2.05 KB
Processing depth (0, 1, 2, 5, 9):   4%|▍         | 4/100 [01:23<32:53, 20.56s/it]is_0k: False
your chose emoji: ['🐀', '🧑🏿\u200d🦰', '🎟️', '👩🏼\u200d❤️\u200d👩🏿', '🇫🇮', '↘️', '👩🏽\u200d❤️\u200d💋\u200d👩🏻', '🅾️', '🧎🏿\u200d♂️\u200d➡️', '🧛🏻\u200d♀️']
emoji:
O: 🐀 [9468, 238, 222]
N: 🅾️ [9468, 227, 122, 31643]

O: 🧑🏿‍🦰 [9468, 100, 239, 9468, 237, 123, 102470, 9468, 99, 108]
N: 🇫🇮 [9468, 229, 104, 9468, 229, 106]

O: 🎟️ [9468, 236, 253, 31643]
N: 🧑🏿‍🦰 [9468, 100, 239, 9468, 237, 123, 102470, 9468, 99, 108]

O: 👩🏼‍❤️‍👩🏿 [9468, 239, 102, 9468, 237, 120, 102470, 121643, 31643, 102470, 9468, 239, 102, 9468, 237, 123]
N: 👩🏼‍❤️‍👩🏿 [9468, 239, 102, 9468, 237, 120, 102470, 121643, 31643, 102470, 9468, 239, 102, 9468, 237, 123]

O: 🇫🇮 [9468, 229, 104, 9468, 229, 106]
N: 🎟️ [9468, 236, 253, 31643]

O: ↘️ [27017, 246, 31643]
N: ↘️ [27017, 246, 31643]

O: 👩🏽‍❤️‍💋‍👩🏻 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 119]
N: 🧎🏿‍♂️‍➡️ [9468, 100, 236, 9468, 237, 123, 102470, 17245, 224, 31643, 102470, 98115, 94, 31643]

O: 🅾️ [9468, 227, 122, 31643]
N: 👩🏽‍❤️‍💋‍👩🏻 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 119]

O: 🧎🏿‍♂️‍➡️ [9468, 100, 236, 9468, 237, 123, 102470, 17245, 224, 31643, 102470, 98115, 94, 31643]
N: 🐀 [9468, 238, 222]

O: 🧛🏻‍♀️ [9468, 100, 249, 9468, 237, 119, 102470, 32990, 31643]
N: 🧛🏻‍♀️ [9468, 100, 249, 9468, 237, 119, 102470, 32990, 31643]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.27s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.66s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.41s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.84s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.44s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (1, 2, 5, 6, 9):   4%|▍         | 4/100 [01:38<32:53, 20.56s/it]2025-01-22 04:37:06.539 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the garden.
2025-01-22 04:37:06.543 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (684, 690) --> . Mary journeyed to the
2025-01-22 04:37:06.543 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary got the football.
2025-01-22 04:37:06.551 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1768, 1772) -->  Mary got the football
2025-01-22 04:37:06.552 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the kitchen.
2025-01-22 04:37:06.552 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (62, 67) -->  went to the kitchen.
2025-01-22 04:37:06.552 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary put down the football.
2025-01-22 04:37:06.578 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4750, 4755) --> . Mary put down the
2025-01-22 04:37:06.579 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel travelled to the garden.
2025-01-22 04:37:06.620 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7145, 7150) -->  Daniel travelled to the garden
2025-01-22 04:37:06.620 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went to the garden.
2025-01-22 04:37:06.643 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4579, 4584) -->  Sandra went to the garden
2025-01-22 04:37:06.643 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the office.
2025-01-22 04:37:06.643 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (31, 37) -->  journeyed to the office.
2025-01-22 04:37:06.643 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the office.
2025-01-22 04:37:06.648 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (408, 413) --> . John moved to the
2025-01-22 04:37:06.648 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra picked up the milk.
2025-01-22 04:37:06.686 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6947, 6952) -->  Sandra picked up the milk
2025-01-22 04:37:06.686 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went to the kitchen.
2025-01-22 04:37:06.686 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (61, 66) -->  John went to the kitchen
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:37:10.334 | INFO     | test_jbb_embedding:begin_test:693 - the garden<|eot_id|>
2025-01-22 04:37:10.334 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8203])
2025-01-22 04:37:13.430 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [111.8325, 13.400994699000732, 80.50961538461539, 12.88528510116493, 17.56875770970395], 'topk_indices': array([8177,   11, 1771, 8092, 8195, 8197, 8048,    8, 8202,   23,    4,
         24,  690, 8082, 8201,    9, 8198,   14, 8199,    0]), 'topk_tokens': [':', ' ', ' football', ' location', '?\n', ':', ' context', ' Date', '\n\n', '4', '\n\n', '\n\n', ' garden', '.\n\n', '<|end_header_id|>', ':', '<|eot_id|>', '\n', '<|start_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [133.15625, 180.578125, 102.95, 114.3625, 37.6]}, 'weight': {'score': [22.444375, 23.28878259809895, 22.90655048076923, 23.292589860515022, 29.87705592105263], 'topk_indices': array([3302, 3329, 3222, 3174, 7473, 7435, 1465, 1527, 4305, 4321, 5154,
       5215, 7156, 7212, 3511, 3485, 4931, 5008, 4956, 4979]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.052083333333332, 26.611328125, 19.565625, 21.771875, 25.5328125]}, 'saliency': {'score': [0.636240234375, 0.07412907160871238, 0.4720318134014423, 0.07113725672756362, 0.13604164123535156], 'topk_indices': array([  12,    4, 8200, 8163, 8202, 8182, 8196,   24, 8176,   23,   20,
       8092,    9, 8188, 8048,   14, 1771,    8, 8082,  690]), 'topk_tokens': ['202', '\n\n', 'assistant', ' return', '\n\n', ' prior', 'Answer', '\n\n', 'Question', '4', ' Jul', ' location', ':', ' football', ' context', '\n', ' football', ' Date', '.\n\n', ' garden'], 'evidence_proportions': [0.6768798828125, 1.253173828125, 0.5094970703125, 0.606640625, 0.2502685546875]}}, 'pred_res': 'the garden<|eot_id|>', 'score': 100}
2025-01-22 04:37:13.437 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:37:13.437 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-31_pid-4_1-2-5-6-9.pkl | len: 3 |  size: 2.03 KB
Processing depth (1, 2, 5, 6, 9):   5%|▌         | 5/100 [01:45<33:35, 21.21s/it]Processing depth (1, 2, 5, 6, 9):   5%|▌         | 5/100 [01:45<33:28, 21.15s/it]
2025-01-22 04:37:13.511 | INFO     | __main__:<module>:82 - Selected idx: 32
2025-01-22 04:37:13.511 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the football before the kitchen? 
2025-01-22 04:37:13.511 | INFO     | __main__:<module>:84 - Answer: garden
2025-01-22 04:37:13.511 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 04:37:13.511 | INFO     | __main__:<module>:86 - Needle: [' Mary got the football.', ' Sandra went to the garden.', ' John moved to the office.', ' Mary journeyed to the garden.', ' Daniel travelled to the garden.', ' Sandra picked up the milk.', ' Mary went to the kitchen.', ' Daniel journeyed to the office.']
2025-01-22 04:37:13.511 | INFO     | __main__:<module>:87 - Real Needle: [' Mary got the football.', ' Mary journeyed to the garden.', ' Mary went to the kitchen.', ' Daniel journeyed to the office.']
2025-01-22 04:37:13.511 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['👢', '🙅🏾\u200d♂️', '🏃🏻\u200d♀️\u200d➡', '\U0001faf1🏼\u200d\U0001faf2🏿', '🏄🏿\u200d♂', '🤸🏼\u200d♂', '🏞', '🏄\u200d♀', '🥕', '💁🏾\u200d♂️']
emoji:
O: 👢 [9468, 239, 95]
N: 🏃🏻‍♀️‍➡ [9468, 237, 225, 9468, 237, 119, 102470, 32990, 31643, 102470, 98115, 94]

O: 🙅🏾‍♂️ [9468, 247, 227, 9468, 237, 122, 102470, 17245, 224, 31643]
N: 👢 [9468, 239, 95]

O: 🏃🏻‍♀️‍➡ [9468, 237, 225, 9468, 237, 119, 102470, 32990, 31643, 102470, 98115, 94]
N: 🏄‍♀ [9468, 237, 226, 102470, 32990]

O: 🫱🏼‍🫲🏿 [9468, 104, 109, 9468, 237, 120, 102470, 9468, 104, 110, 9468, 237, 123]
N: 🏞 [9468, 237, 252]

O: 🏄🏿‍♂ [9468, 237, 226, 9468, 237, 123, 102470, 17245, 224]
N: 🏄🏿‍♂ [9468, 237, 226, 9468, 237, 123, 102470, 17245, 224]

O: 🤸🏼‍♂ [9468, 97, 116, 9468, 237, 120, 102470, 17245, 224]
N: 🫱🏼‍🫲🏿 [9468, 104, 109, 9468, 237, 120, 102470, 9468, 104, 110, 9468, 237, 123]

O: 🏞 [9468, 237, 252]
N: 🤸🏼‍♂ [9468, 97, 116, 9468, 237, 120, 102470, 17245, 224]

O: 🏄‍♀ [9468, 237, 226, 102470, 32990]
N: 🥕 [9468, 98, 243]

O: 🥕 [9468, 98, 243]
N: 🙅🏾‍♂️ [9468, 247, 227, 9468, 237, 122, 102470, 17245, 224, 31643]

O: 💁🏾‍♂️ [93273, 223, 9468, 237, 122, 102470, 17245, 224, 31643]
N: 💁🏾‍♂️ [93273, 223, 9468, 237, 122, 102470, 17245, 224, 31643]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:11,  3.80s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.27s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.61s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.26s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.65s/it]
Processing depth (1, 2, 3, 9):   0%|          | 0/100 [00:16<?, ?it/s]2025-01-22 04:37:29.819 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the football.
2025-01-22 04:37:29.824 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (828, 832) -->  Mary got the football
2025-01-22 04:37:29.824 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 04:37:29.833 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1808, 1814) --> . Mary journeyed to the
2025-01-22 04:37:29.834 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the kitchen.
2025-01-22 04:37:29.850 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2925, 2930) --> . Mary went to the
2025-01-22 04:37:29.851 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the office.
2025-01-22 04:37:29.890 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7271, 7277) --> . Daniel journeyed to the
2025-01-22 04:37:29.890 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went to the garden.
2025-01-22 04:37:29.907 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1566, 1571) --> . Sandra went to the
2025-01-22 04:37:29.908 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John moved to the office.
2025-01-22 04:37:29.926 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3186, 3191) -->  John moved to the office
2025-01-22 04:37:29.926 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel travelled to the garden.
2025-01-22 04:37:29.962 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6367, 6372) --> . Daniel travelled to the
2025-01-22 04:37:29.962 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra picked up the milk.
2025-01-22 04:37:29.990 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4670, 4675) -->  Sandra picked up the milk
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:37:30.855 | INFO     | test_jbb_embedding:begin_test:693 - Mary got the football.<|eot_id|>
2025-01-22 04:37:30.856 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8218])
2025-01-22 04:37:33.099 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [349.05059523809524, 26.463983244130883, 110.446875, 25.430489761613693, 14.29422581449468], 'topk_indices': array([8072,  828, 8201,  827, 8115, 8208, 8205, 8206,    9,  829,  830,
         24,   14,  832, 8116, 8216, 8213, 8214,  831,    0]), 'topk_tokens': [' context', ' Mary', ':', '.', ' first', ' kitchen', ' football', ' before', ':', ' got', ' the', '\n\n', '\n', '.', ' location', '<|end_header_id|>', '<|eot_id|>', '<|start_header_id|>', ' football', '<|begin_of_text|>'], 'evidence_proportions': [1067.625, 209.04166666666666, 257.25, 86.51041666666667]}, 'weight': {'score': [21.209449404761905, 23.320663164456878, 23.1890625, 23.32640491289731, 29.91007313829787], 'topk_indices': array([3394, 3367, 3267, 3219, 7451, 7489, 1484, 1422, 4378, 4362, 5274,
       5213, 7221, 7165, 3576, 3550, 4990, 5067, 5038, 5015]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.611328125, 20.052083333333332, 19.403125, 20.270833333333332]}, 'saliency': {'score': [2.1179082961309526, 0.1481211506498221, 0.6441131591796875, 0.14185154548775597, 0.10748518274185505], 'topk_indices': array([   0, 8209, 8211, 8215, 8112, 8187,    8,  257, 2930,   24, 8200,
       8115, 8072, 8206,  828,  829, 8208, 8205, 8116,  831]), 'topk_tokens': ['<|begin_of_text|>', '?', 'Answer', 'assistant', ' item', ' return', ' Date', 'hue', ' kitchen', '\n\n', 'Question', ' first', ' context', ' before', ' Mary', ' got', ' kitchen', ' football', ' location', ' football'], 'evidence_proportions': [7.36669921875, 1.1278483072916667, 1.14599609375, 0.418701171875]}}, 'pred_res': 'Mary got the football.<|eot_id|>', 'score': 0}
2025-01-22 04:37:33.103 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:37:33.103 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-32_pid-0_1-2-3-9.pkl | len: 3 |  size: 2.04 KB
Processing depth (1, 2, 3, 9):   1%|          | 1/100 [00:19<32:10, 19.50s/it]is_0k: False
your chose emoji: ['👨🏿\u200d🎓', '🧍🏿\u200d♀', '👩🏿\u200d❤️\u200d💋\u200d👨🏾', '🧚🏻\u200d♀', '🇹🇱', '🚶🏻\u200d♀\u200d➡', '👱🏾\u200d♀️', '🤽🏾\u200d♂️', '🧛\u200d♂️', '🙏🏽']
emoji:
O: 👨🏿‍🎓 [9468, 239, 101, 9468, 237, 123, 102470, 9468, 236, 241]
N: 👱🏾‍♀️ [9468, 239, 109, 9468, 237, 122, 102470, 32990, 31643]

O: 🧍🏿‍♀ [9468, 100, 235, 9468, 237, 123, 102470, 32990]
N: 🧍🏿‍♀ [9468, 100, 235, 9468, 237, 123, 102470, 32990]

O: 👩🏿‍❤️‍💋‍👨🏾 [9468, 239, 102, 9468, 237, 123, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 122]
N: 👩🏿‍❤️‍💋‍👨🏾 [9468, 239, 102, 9468, 237, 123, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 122]

O: 🧚🏻‍♀ [9468, 100, 248, 9468, 237, 119, 102470, 32990]
N: 🤽🏾‍♂️ [9468, 97, 121, 9468, 237, 122, 102470, 17245, 224, 31643]

O: 🇹🇱 [9468, 229, 117, 9468, 229, 109]
N: 👨🏿‍🎓 [9468, 239, 101, 9468, 237, 123, 102470, 9468, 236, 241]

O: 🚶🏻‍♀‍➡ [9468, 248, 114, 9468, 237, 119, 102470, 32990, 102470, 98115, 94]
N: 🧚🏻‍♀ [9468, 100, 248, 9468, 237, 119, 102470, 32990]

O: 👱🏾‍♀️ [9468, 239, 109, 9468, 237, 122, 102470, 32990, 31643]
N: 🇹🇱 [9468, 229, 117, 9468, 229, 109]

O: 🤽🏾‍♂️ [9468, 97, 121, 9468, 237, 122, 102470, 17245, 224, 31643]
N: 🚶🏻‍♀‍➡ [9468, 248, 114, 9468, 237, 119, 102470, 32990, 102470, 98115, 94]

O: 🧛‍♂️ [9468, 100, 249, 102470, 17245, 224, 31643]
N: 🧛‍♂️ [9468, 100, 249, 102470, 17245, 224, 31643]

O: 🙏🏽 [9468, 247, 237, 9468, 237, 121]
N: 🙏🏽 [9468, 247, 237, 9468, 237, 121]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.47s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.46s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.08s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  2.64s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  3.25s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (2, 3, 4, 9):   1%|          | 1/100 [00:34<32:10, 19.50s/it]2025-01-22 04:37:47.867 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the football.
2025-01-22 04:37:47.877 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1818, 1822) -->  Mary got the football
2025-01-22 04:37:47.877 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 04:37:47.891 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2906, 2912) --> . Mary journeyed to the
2025-01-22 04:37:47.892 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the kitchen.
2025-01-22 04:37:47.912 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3637, 3642) --> . Mary went to the
2025-01-22 04:37:47.912 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the office.
2025-01-22 04:37:47.953 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7227, 7233) --> . Daniel journeyed to the
2025-01-22 04:37:47.953 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went to the garden.
2025-01-22 04:37:47.960 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1549, 1554) --> . Sandra went to the
2025-01-22 04:37:47.960 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John moved to the office.
2025-01-22 04:37:47.978 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3243, 3248) --> . John moved to the
2025-01-22 04:37:47.978 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel travelled to the garden.
2025-01-22 04:37:48.011 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6421, 6426) --> . Daniel travelled to the
2025-01-22 04:37:48.012 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra picked up the milk.
2025-01-22 04:37:48.034 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4737, 4742) --> . Sandra picked up the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:37:50.769 | INFO     | test_jbb_embedding:begin_test:693 - the garden<|eot_id|>
2025-01-22 04:37:50.770 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8184])
2025-01-22 04:37:53.697 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [126.62723214285714, 16.368430896543302, 76.11875, 15.937490409403388, 16.95698051948052], 'topk_indices': array([1714, 8153, 8183,    3, 8082, 8072, 8180,   23, 8037, 1821,  654,
         24,    9, 1636, 8038, 8182,   14,  655,    0, 8179]), 'topk_tokens': [' some', ' return', '\n\n', '<|end_header_id|>', ' location', '.\n\n', '<|start_header_id|>', '4', ' you', ' football', '�', '\n\n', ':', ' time', ' context', '<|end_header_id|>', '\n', '�', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [310.84375, 133.88541666666666, 91.6625, 25.6953125]}, 'weight': {'score': [21.209449404761905, 23.291328859777696, 21.04765625, 23.302204494537197, 29.805397727272727], 'topk_indices': array([3309, 3336, 3223, 3175, 7427, 7465, 1509, 1447, 4340, 4324, 5202,
       5141, 7177, 7121, 3504, 3530, 4966, 4943, 4995, 4918]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.611328125, 20.052083333333332, 19.403125, 20.270833333333332]}, 'saliency': {'score': [0.7522117978050595, 0.09120891865056645, 0.43804931640625, 0.0886533246882097, 0.12444186520266842], 'topk_indices': array([  14,   23,   24, 8172, 1550,   20, 8037, 1635, 8036, 1714, 8153,
       2912, 8171, 8082,  654, 1636,  653, 1821, 8038,  655]), 'topk_tokens': ['\n', '4', '\n\n', ' before', ' Sandra', ' Jul', ' you', ' some', ' provided', ' some', ' return', ' garden', ' football', ' location', '�', ' time', '�', ' football', ' context', '�'], 'evidence_proportions': [2.1370849609375, 0.7109781901041666, 0.4313720703125, 0.13756306966145834]}}, 'pred_res': 'the garden<|eot_id|>', 'score': 100}
2025-01-22 04:37:53.713 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:37:53.713 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-32_pid-1_2-3-4-9.pkl | len: 3 |  size: 2.01 KB
Processing depth (2, 3, 4, 9):   2%|▏         | 2/100 [00:40<32:55, 20.15s/it]is_0k: False
your chose emoji: ['\U0001fae7', '🏵️', '🧎🏻\u200d➡️', '🤱🏾', '🧏\u200d♀️', '🧑🏾\u200d🦯\u200d➡️', '🧍🏼\u200d♂️', '🧑🏿\u200d🎤', '🇭🇹', '🏌🏻\u200d♀']
emoji:
O: 🫧 [9468, 104, 100]
N: 🧑🏿‍🎤 [9468, 100, 239, 9468, 237, 123, 102470, 9468, 236, 97]

O: 🏵️ [9468, 237, 113, 31643]
N: 🧑🏾‍🦯‍➡️ [9468, 100, 239, 9468, 237, 122, 102470, 9468, 99, 107, 102470, 98115, 94, 31643]

O: 🧎🏻‍➡️ [9468, 100, 236, 9468, 237, 119, 102470, 98115, 94, 31643]
N: 🤱🏾 [9468, 97, 109, 9468, 237, 122]

O: 🤱🏾 [9468, 97, 109, 9468, 237, 122]
N: 🇭🇹 [9468, 229, 255, 9468, 229, 117]

O: 🧏‍♀️ [9468, 100, 237, 102470, 32990, 31643]
N: 🫧 [9468, 104, 100]

O: 🧑🏾‍🦯‍➡️ [9468, 100, 239, 9468, 237, 122, 102470, 9468, 99, 107, 102470, 98115, 94, 31643]
N: 🧏‍♀️ [9468, 100, 237, 102470, 32990, 31643]

O: 🧍🏼‍♂️ [9468, 100, 235, 9468, 237, 120, 102470, 17245, 224, 31643]
N: 🧍🏼‍♂️ [9468, 100, 235, 9468, 237, 120, 102470, 17245, 224, 31643]

O: 🧑🏿‍🎤 [9468, 100, 239, 9468, 237, 123, 102470, 9468, 236, 97]
N: 🏵️ [9468, 237, 113, 31643]

O: 🇭🇹 [9468, 229, 255, 9468, 229, 117]
N: 🧎🏻‍➡️ [9468, 100, 236, 9468, 237, 119, 102470, 98115, 94, 31643]

O: 🏌🏻‍♀ [9468, 237, 234, 9468, 237, 119, 102470, 32990]
N: 🏌🏻‍♀ [9468, 237, 234, 9468, 237, 119, 102470, 32990]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.69s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.68s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.57s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.16s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.70s/it]
Processing depth (0, 2, 3, 4):   2%|▏         | 2/100 [00:56<32:55, 20.15s/it]2025-01-22 04:38:10.261 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the football.
2025-01-22 04:38:10.303 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 04:38:10.314 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1852, 1858) --> . Mary journeyed to the
2025-01-22 04:38:10.314 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the kitchen.
2025-01-22 04:38:10.330 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2972, 2977) -->  tragedy. Mary went to
2025-01-22 04:38:10.330 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the office.
2025-01-22 04:38:10.349 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3639, 3645) --> . Daniel journeyed to the
2025-01-22 04:38:10.349 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went to the garden.
2025-01-22 04:38:10.357 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1554, 1559) --> . Sandra went to the
2025-01-22 04:38:10.357 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John moved to the office.
2025-01-22 04:38:10.373 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3299, 3304) --> . John moved to the
2025-01-22 04:38:10.373 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel travelled to the garden.
2025-01-22 04:38:10.409 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6468, 6473) --> . Daniel travelled to the
2025-01-22 04:38:10.410 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra picked up the milk.
2025-01-22 04:38:10.433 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4938, 4943) --> . Sandra picked up the
2025-01-22 04:38:10.434 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 04:38:10.434 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 04:38:10.434 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 04:38:10.434 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['🍴', '🤝🏼', '💌', '🤏', '🙋🏾\u200d♂️', '⚔', '♟️', '🧑🏾\u200d🤝\u200d🧑🏾', '🕵️\u200d♂️', '👨🏿\u200d🦼\u200d➡']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.67s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.33s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.29s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  2.99s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.50s/it]
Processing depth (1, 2, 4, 6):   2%|▏         | 2/100 [01:12<32:55, 20.15s/it]2025-01-22 04:38:26.189 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the football.
2025-01-22 04:38:26.194 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (896, 900) -->  Mary got the football
2025-01-22 04:38:26.194 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 04:38:26.206 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2009, 2015) -->  cable. Mary journeyed to
2025-01-22 04:38:26.206 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the kitchen.
2025-01-22 04:38:26.228 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3675, 3680) --> . Mary went to the
2025-01-22 04:38:26.228 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the office.
2025-01-22 04:38:26.255 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4875, 4881) --> . Daniel journeyed to the
2025-01-22 04:38:26.255 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went to the garden.
2025-01-22 04:38:26.263 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1706, 1711) --> . Sandra went to the
2025-01-22 04:38:26.264 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John moved to the office.
2025-01-22 04:38:26.282 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3313, 3318) --> . John moved to the
2025-01-22 04:38:26.282 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel travelled to the garden.
2025-01-22 04:38:26.314 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6466, 6471) --> . Daniel travelled to the
2025-01-22 04:38:26.314 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra picked up the milk.
2025-01-22 04:38:26.338 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4881, 4886) -->  office. Sandra picked up
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:38:27.150 | INFO     | test_jbb_embedding:begin_test:693 - Mary's garden.<|eot_id|>
2025-01-22 04:38:27.150 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8200])
2025-01-22 04:38:29.380 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [295.296875, 22.236917895891747, 94.04375, 21.358408248591033, 11.89772518382353], 'topk_indices': array([8088, 8194, 8199,    3,  895, 8183, 8187, 8098, 8188,  898, 8054,
        896,  900,   24,   14, 8198, 8196, 8195,  899,    0]), 'topk_tokens': ['.\n\n', ':', '\n\n', '<|end_header_id|>', '.', ':', ' football', ' location', ' before', ' the', ' context', ' Mary', '.', '\n\n', '\n', '<|end_header_id|>', '<|start_header_id|>', '<|eot_id|>', ' football', '<|begin_of_text|>'], 'evidence_proportions': [864.625, 162.72135416666666, 265.275, 73.33854166666667]}, 'weight': {'score': [22.263392857142858, 23.301457926977935, 21.968359375, 23.307395361124723, 29.681066176470587], 'topk_indices': array([3269, 3296, 3189, 3141, 7491, 7453, 1466, 1404, 4318, 4302, 5209,
       5148, 7230, 7174, 3484, 3458, 4909, 4934, 4957, 4986]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.611328125, 23.740885416666668, 19.403125, 20.270833333333332]}, 'saliency': {'score': [1.832275390625, 0.12299727602992046, 0.53892822265625, 0.11758028762768775, 0.08852826286764706], 'topk_indices': array([8192, 8199, 8088,  257, 8184, 8169, 1707, 3680, 8197,   24, 8193,
        897, 8190, 8182, 8188, 8098, 8187, 8054,  896,  899]), 'topk_tokens': [' \n', '\n\n', '.\n\n', 'hue', ' Where', ' return', ' Sandra', ' kitchen', 'assistant', '\n\n', 'Answer', ' got', ' kitchen', 'Question', ' before', ' location', ' football', ' context', ' Mary', ' football'], 'evidence_proportions': [6.056884765625, 0.9515787760416666, 1.23466796875, 0.3945719401041667]}}, 'pred_res': "Mary's garden.<|eot_id|>", 'score': 100}
2025-01-22 04:38:29.389 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:38:29.389 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-32_pid-2_1-2-4-6.pkl | len: 3 |  size: 2.03 KB
Processing depth (1, 2, 4, 6):   3%|▎         | 3/100 [01:15<44:02, 27.24s/it]is_0k: False
your chose emoji: ['👨\u200d🦽\u200d➡️', '🍺', '🤸🏼\u200d♀', '😿', '🏃🏿\u200d♀️\u200d➡️', '👨🏿\u200d🤝\u200d👨🏾', '👝', '👩🏼\u200d❤️\u200d💋\u200d👨🏼', '🇬🇦', '🥾']
emoji:
O: 👨‍🦽‍➡️ [9468, 239, 101, 102470, 9468, 99, 121, 102470, 98115, 94, 31643]
N: 🏃🏿‍♀️‍➡️ [9468, 237, 225, 9468, 237, 123, 102470, 32990, 31643, 102470, 98115, 94, 31643]

O: 🍺 [9468, 235, 118]
N: 👩🏼‍❤️‍💋‍👨🏼 [9468, 239, 102, 9468, 237, 120, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 120]

O: 🤸🏼‍♀ [9468, 97, 116, 9468, 237, 120, 102470, 32990]
N: 😿 [76460, 123]

O: 😿 [76460, 123]
N: 👝 [9468, 239, 251]

O: 🏃🏿‍♀️‍➡️ [9468, 237, 225, 9468, 237, 123, 102470, 32990, 31643, 102470, 98115, 94, 31643]
N: 🤸🏼‍♀ [9468, 97, 116, 9468, 237, 120, 102470, 32990]

O: 👨🏿‍🤝‍👨🏾 [9468, 239, 101, 9468, 237, 123, 102470, 9468, 97, 251, 102470, 9468, 239, 101, 9468, 237, 122]
N: 👨🏿‍🤝‍👨🏾 [9468, 239, 101, 9468, 237, 123, 102470, 9468, 97, 251, 102470, 9468, 239, 101, 9468, 237, 122]

O: 👝 [9468, 239, 251]
N: 👨‍🦽‍➡️ [9468, 239, 101, 102470, 9468, 99, 121, 102470, 98115, 94, 31643]

O: 👩🏼‍❤️‍💋‍👨🏼 [9468, 239, 102, 9468, 237, 120, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 120]
N: 🍺 [9468, 235, 118]

O: 🇬🇦 [9468, 229, 105, 9468, 229, 99]
N: 🇬🇦 [9468, 229, 105, 9468, 229, 99]

O: 🥾 [9468, 98, 122]
N: 🥾 [9468, 98, 122]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.35s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.71s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.54s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.13s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.65s/it]
Processing depth (1, 4, 7, 8):   3%|▎         | 3/100 [01:32<44:02, 27.24s/it]2025-01-22 04:38:45.832 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the football.
2025-01-22 04:38:45.837 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (797, 801) -->  got the football.
2025-01-22 04:38:45.837 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 04:38:45.859 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3637, 3643) -->  Mary journeyed to the garden
2025-01-22 04:38:45.859 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the kitchen.
2025-01-22 04:38:45.888 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5731, 5736) --> . Mary went to the
2025-01-22 04:38:45.888 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the office.
2025-01-22 04:38:45.925 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6641, 6647) --> . Daniel journeyed to the
2025-01-22 04:38:45.925 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went to the garden.
2025-01-22 04:38:45.933 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1550, 1555) --> . Sandra went to the
2025-01-22 04:38:45.933 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John moved to the office.
2025-01-22 04:38:45.949 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3270, 3275) --> . John moved to the
2025-01-22 04:38:45.950 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel travelled to the garden.
2025-01-22 04:38:45.981 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6423, 6428) --> . Daniel travelled to the
2025-01-22 04:38:45.981 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra picked up the milk.
2025-01-22 04:38:46.007 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4776, 4781) -->  senate. Sandra picked up
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:38:46.844 | INFO     | test_jbb_embedding:begin_test:693 - Mary got the football.<|eot_id|>
2025-01-22 04:38:46.844 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8192])
2025-01-22 04:38:49.114 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [182.87127976190476, 14.460116687004271, 62.6720703125, 13.908133182333824, 29.49148823302469], 'topk_indices': array([   8, 8180,    1, 8089, 8186, 8173,    4, 8179,  800, 8046, 8080,
         23,  799,   24,    9, 8090,   14, 8190, 8187,    0]), 'topk_tokens': [' Date', ' before', '<|start_header_id|>', ' first', ':', '.\n\n', '\n\n', ' football', '.', ' context', '.\n\n', '4', ' football', '\n\n', ':', ' location', '\n', '<|end_header_id|>', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [382.1875, 168.90625, 218.15, 34.559895833333336]}, 'weight': {'score': [21.18266369047619, 23.286363636363635, 22.355859375, 23.29406387969095, 29.23244598765432], 'topk_indices': array([3313, 3286, 3200, 3152, 7437, 7399, 1448, 1510, 4290, 4306, 5186,
       5125, 7176, 7120, 3469, 3495, 4950, 4902, 4979, 4927]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.828125, 23.813802083333332, 19.403125, 20.270833333333332]}, 'saliency': {'score': [0.9905715215773809, 0.08082617991868137, 0.365667724609375, 0.07778454598826114, 0.21266974931881752], 'topk_indices': array([  16,   19,  752,   14, 8185, 8174,    9, 8180, 8161, 8089, 8182,
       8080,   20,   24,   23,    8, 8046, 8179,  799, 8090]), 'topk_tokens': [' Date', '26', '�', '\n', 'Answer', 'Question', ':', ' before', ' return', ' first', ' kitchen', '.\n\n', ' Jul', '\n\n', '4', ' Date', ' context', ' football', ' football', ' location'], 'evidence_proportions': [2.0980224609375, 0.9471842447916666, 1.11748046875, 0.18990071614583334]}}, 'pred_res': 'Mary got the football.<|eot_id|>', 'score': 0}
2025-01-22 04:38:49.119 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:38:49.119 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-32_pid-3_1-4-7-8.pkl | len: 3 |  size: 2.0 KB
Processing depth (1, 4, 7, 8):   4%|▍         | 4/100 [01:35<38:50, 24.28s/it]is_0k: False
your chose emoji: ['👩🏿\u200d❤️\u200d👨🏿', '🚣🏾', '🧑🏻\u200d✈', '🇹🇷', '👨🏽\u200d⚕️', '🇦🇱', '🏌🏻\u200d♀️', '🚶', '🧑🏼', '👰🏼\u200d♂']
emoji:
O: 👩🏿‍❤️‍👨🏿 [9468, 239, 102, 9468, 237, 123, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 123]
N: 👩🏿‍❤️‍👨🏿 [9468, 239, 102, 9468, 237, 123, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 123]

O: 🚣🏾 [9468, 248, 96, 9468, 237, 122]
N: 🧑🏼 [9468, 100, 239, 9468, 237, 120]

O: 🧑🏻‍✈ [9468, 100, 239, 9468, 237, 119, 102470, 38798, 230]
N: 🚣🏾 [9468, 248, 96, 9468, 237, 122]

O: 🇹🇷 [9468, 229, 117, 9468, 229, 115]
N: 🚶 [9468, 248, 114]

O: 👨🏽‍⚕️ [9468, 239, 101, 9468, 237, 121, 102470, 158, 248, 243, 31643]
N: 🏌🏻‍♀️ [9468, 237, 234, 9468, 237, 119, 102470, 32990, 31643]

O: 🇦🇱 [9468, 229, 99, 9468, 229, 109]
N: 🇹🇷 [9468, 229, 117, 9468, 229, 115]

O: 🏌🏻‍♀️ [9468, 237, 234, 9468, 237, 119, 102470, 32990, 31643]
N: 🧑🏻‍✈ [9468, 100, 239, 9468, 237, 119, 102470, 38798, 230]

O: 🚶 [9468, 248, 114]
N: 👨🏽‍⚕️ [9468, 239, 101, 9468, 237, 121, 102470, 158, 248, 243, 31643]

O: 🧑🏼 [9468, 100, 239, 9468, 237, 120]
N: 🇦🇱 [9468, 229, 99, 9468, 229, 109]

O: 👰🏼‍♂ [9468, 239, 108, 9468, 237, 120, 102470, 17245, 224]
N: 👰🏼‍♂ [9468, 239, 108, 9468, 237, 120, 102470, 17245, 224]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.67s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:10<00:10,  5.12s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.74s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.03s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.70s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (1, 3, 4, 6):   4%|▍         | 4/100 [01:52<38:50, 24.28s/it]2025-01-22 04:39:05.689 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the football.
2025-01-22 04:39:05.693 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (669, 673) -->  got the football.
2025-01-22 04:39:05.693 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the garden.
2025-01-22 04:39:05.706 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2586, 2592) --> . Mary journeyed to the
2025-01-22 04:39:05.706 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the kitchen.
2025-01-22 04:39:05.724 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3533, 3538) --> . Mary went to the
2025-01-22 04:39:05.724 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the office.
2025-01-22 04:39:05.748 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4625, 4631) --> . Daniel journeyed to the
2025-01-22 04:39:05.748 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went to the garden.
2025-01-22 04:39:05.754 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1310, 1315) --> . Sandra went to the
2025-01-22 04:39:05.755 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John moved to the office.
2025-01-22 04:39:05.770 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3032, 3037) -->  tragedy. John moved to
2025-01-22 04:39:05.770 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel travelled to the garden.
2025-01-22 04:39:05.802 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6388, 6393) --> . Daniel travelled to the
2025-01-22 04:39:05.802 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra picked up the milk.
2025-01-22 04:39:05.825 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4631, 4636) -->  office. Sandra picked up
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:39:08.894 | INFO     | test_jbb_embedding:begin_test:693 - Mary's garden.<|eot_id|>
2025-01-22 04:39:08.894 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8154])
2025-01-22 04:39:11.555 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [185.48958333333334, 16.045076314821625, 60.4693359375, 15.497168498182603, 33.46459173387097], 'topk_indices': array([8051,  669,   20,    3, 8042,  670, 8141,  672,    1, 8008,    9,
        652,   23,   24,   14, 8052, 8149, 8152,  671,    0]), 'topk_tokens': [' first', ' got', ' Jul', '<|end_header_id|>', '.\n\n', ' the', ' football', '.', '<|start_header_id|>', ' context', ':', '�', '4', '\n\n', '\n', ' location', '<|eot_id|>', '<|end_header_id|>', ' football', '<|begin_of_text|>'], 'evidence_proportions': [571.125, 101.89583333333333, 160.8375, 32.536458333333336]}, 'weight': {'score': [20.107886904761905, 23.264954563565038, 23.4203125, 23.27274057417447, 29.64642137096774], 'topk_indices': array([3342, 3315, 3235, 3187, 7411, 7373, 1532, 1470, 4312, 4328, 5197,
       5136, 7094, 7150, 3524, 3498, 4961, 4913, 4938, 4990]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.828125, 20.052083333333332, 19.403125, 20.270833333333332]}, 'saliency': {'score': [1.0145292736235119, 0.09017670848753372, 0.36187286376953126, 0.08711543113742337, 0.25071814752394156], 'topk_indices': array([1311,  668,  651,    8, 8142, 8051,   19, 8123,  650, 8144,  669,
         24, 1315,   23,   20,  652, 8141, 8008, 8052,  671]), 'topk_tokens': [' Sandra', ' Mary', '�', ' Date', ' before', ' first', '26', ' return', '�', ' kitchen', ' got', '\n\n', ' garden', '4', ' Jul', '�', ' football', ' context', ' location', ' football'], 'evidence_proportions': [3.314453125, 0.57861328125, 0.710302734375, 0.170684814453125]}}, 'pred_res': "Mary's garden.<|eot_id|>", 'score': 100}
2025-01-22 04:39:11.562 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:39:11.562 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-32_pid-4_1-3-4-6.pkl | len: 3 |  size: 2.02 KB
Processing depth (1, 3, 4, 6):   5%|▌         | 5/100 [01:57<37:23, 23.62s/it]Processing depth (1, 3, 4, 6):   5%|▌         | 5/100 [01:58<37:22, 23.61s/it]
2025-01-22 04:39:11.645 | INFO     | __main__:<module>:82 - Selected idx: 33
2025-01-22 04:39:11.645 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the location prior to the place where the football was discarded, left or dropped?
2025-01-22 04:39:11.645 | INFO     | __main__:<module>:84 - Answer: garden
2025-01-22 04:39:11.645 | INFO     | __main__:<module>:85 - Tag: 4-hop
2025-01-22 04:39:11.645 | INFO     | __main__:<module>:86 - Needle: [' Daniel travelled to the garden.', ' Mary journeyed to the garden.', ' John moved to the office.', ' Sandra picked up the milk.', ' Mary got the football.', ' Mary went to the kitchen.', ' Sandra went to the garden.', ' Mary put down the football.', ' Daniel journeyed to the office.']
2025-01-22 04:39:11.645 | INFO     | __main__:<module>:87 - Real Needle: [' Mary journeyed to the garden.', ' Mary got the football.', ' Mary went to the kitchen.', ' Mary put down the football.', ' Daniel journeyed to the office.']
2025-01-22 04:39:11.645 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['🧖\u200d♂️', '➖', '🥔', '🥇', '📘', '🔨', '🧎\u200d♂', '👨🏼\u200d🌾', '🦸🏾\u200d♀️', '👨🏻\u200d🤝\u200d👨🏿']
emoji:
O: 🧖‍♂️ [9468, 100, 244, 102470, 17245, 224, 31643]
N: 👨🏼‍🌾 [9468, 239, 101, 9468, 237, 120, 102470, 9468, 234, 122]

O: ➖ [98115, 244]
N: ➖ [98115, 244]

O: 🥔 [9468, 98, 242]
N: 🦸🏾‍♀️ [9468, 99, 116, 9468, 237, 122, 102470, 32990, 31643]

O: 🥇 [9468, 98, 229]
N: 📘 [9468, 68995]

O: 📘 [9468, 68995]
N: 🧖‍♂️ [9468, 100, 244, 102470, 17245, 224, 31643]

O: 🔨 [9468, 242, 101]
N: 🥔 [9468, 98, 242]

O: 🧎‍♂ [9468, 100, 236, 102470, 17245, 224]
N: 🧎‍♂ [9468, 100, 236, 102470, 17245, 224]

O: 👨🏼‍🌾 [9468, 239, 101, 9468, 237, 120, 102470, 9468, 234, 122]
N: 🥇 [9468, 98, 229]

O: 🦸🏾‍♀️ [9468, 99, 116, 9468, 237, 122, 102470, 32990, 31643]
N: 🔨 [9468, 242, 101]

O: 👨🏻‍🤝‍👨🏿 [9468, 239, 101, 9468, 237, 119, 102470, 9468, 97, 251, 102470, 9468, 239, 101, 9468, 237, 123]
N: 👨🏻‍🤝‍👨🏿 [9468, 239, 101, 9468, 237, 119, 102470, 9468, 97, 251, 102470, 9468, 239, 101, 9468, 237, 123]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.22s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.65s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.66s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.23s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.72s/it]
Processing depth (1, 3, 4, 5, 6):   0%|          | 0/100 [00:16<?, ?it/s]2025-01-22 04:39:28.211 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the garden.
2025-01-22 04:39:28.215 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (771, 777) --> . Mary journeyed to the
2025-01-22 04:39:28.215 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary got the football.
2025-01-22 04:39:28.228 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2615, 2619) -->  Mary got the football
2025-01-22 04:39:28.228 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the kitchen.
2025-01-22 04:39:28.245 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3559, 3564) --> . Mary went to the
2025-01-22 04:39:28.246 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary put down the football.
2025-01-22 04:39:28.267 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4161, 4166) --> . Mary put down the
2025-01-22 04:39:28.267 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel journeyed to the office.
2025-01-22 04:39:28.294 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4751, 4757) --> . Daniel journeyed to the
2025-01-22 04:39:28.294 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel travelled to the garden.
2025-01-22 04:39:28.309 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3058, 3063) -->  tragedy. Daniel travelled to
2025-01-22 04:39:28.309 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John moved to the office.
2025-01-22 04:39:28.331 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4606, 4611) -->  John moved to the office
2025-01-22 04:39:28.331 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra picked up the milk.
2025-01-22 04:39:28.340 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1746, 1751) --> . Sandra picked up the
2025-01-22 04:39:28.340 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the garden.
2025-01-22 04:39:28.375 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6672, 6677) --> . Sandra went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:39:29.135 | INFO     | test_jbb_embedding:begin_test:693 - the kitchen<|eot_id|>
2025-01-22 04:39:29.135 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8213])
2025-01-22 04:39:31.376 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [246.51081730769232, 22.658895371835442, 119.8796875, 21.708520119339045, 15.916201636904763], 'topk_indices': array([8211, 2741, 8209, 8186, 8187, 3564, 8192, 4167,    9,   24, 4166,
       8193, 8102, 8092, 8208, 8198, 2619, 2618,   14,    0]), 'topk_tokens': ['<|end_header_id|>', ' ne', '<|start_header_id|>', 'Question', ':', ' kitchen', ' prior', '.', ':', '\n\n', ' football', ' to', ' location', '.\n\n', '<|eot_id|>', ' football', '.', ' football', '\n', '<|begin_of_text|>'], 'evidence_proportions': [244.22916666666666, 470.5625, 217.925, 314.1, 66.921875]}, 'weight': {'score': [21.317608173076923, 23.29849721579844, 23.503125, 23.304300221848226, 29.657738095238095], 'topk_indices': array([3341, 3368, 3261, 3213, 7481, 7443, 1444, 1506, 4348, 4332, 5188,
       5249, 7220, 7164, 3524, 3550, 5030, 4953, 4978, 5001]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.052083333333332, 26.611328125, 19.403125, 21.771875, 20.270833333333332]}, 'saliency': {'score': [1.4444908728966346, 0.12700609246154607, 0.744500732421875, 0.12130174765242503, 0.11761747087751116], 'topk_indices': array([2666, 7773, 2649,  777,   24,  773, 8188, 2667, 8092, 8058, 7774,
       2741, 8186, 3564, 8200, 8192, 8102, 4166, 8198, 2618]), 'topk_tokens': [' ne', ' genu', 'engers', ' garden', '\n\n', ' journey', ' Where', 'ared', '.\n\n', ' context', 'inen', ' ne', 'Question', ' kitchen', ' discarded', ' prior', ' location', ' football', ' football', ' football'], 'evidence_proportions': [1.3387044270833333, 3.319580078125, 1.08349609375, 1.7359375, 0.3581746419270833]}}, 'pred_res': 'the kitchen<|eot_id|>', 'score': 0}
2025-01-22 04:39:31.383 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:39:31.384 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-33_pid-0_1-3-4-5-6.pkl | len: 3 |  size: 2.08 KB
Processing depth (1, 3, 4, 5, 6):   1%|          | 1/100 [00:19<32:24, 19.65s/it]is_0k: False
your chose emoji: ['🎽', '💂🏻\u200d♂️', '✍️', '👨\u200d🚀', '🧑🏿\u200d🍳', '🏃🏻', '🏃🏾\u200d♂\u200d➡', '👨🏻\u200d❤\u200d💋\u200d👨🏼', '👌🏾', '🧑🏿\u200d🚀']
emoji:
O: 🎽 [9468, 236, 121]
N: ✍️ [38798, 235, 31643]

O: 💂🏻‍♂️ [93273, 224, 9468, 237, 119, 102470, 17245, 224, 31643]
N: 👨‍🚀 [9468, 239, 101, 102470, 9468, 248, 222]

O: ✍️ [38798, 235, 31643]
N: 🏃🏻 [9468, 237, 225, 9468, 237, 119]

O: 👨‍🚀 [9468, 239, 101, 102470, 9468, 248, 222]
N: 🎽 [9468, 236, 121]

O: 🧑🏿‍🍳 [9468, 100, 239, 9468, 237, 123, 102470, 9468, 235, 111]
N: 💂🏻‍♂️ [93273, 224, 9468, 237, 119, 102470, 17245, 224, 31643]

O: 🏃🏻 [9468, 237, 225, 9468, 237, 119]
N: 👨🏻‍❤‍💋‍👨🏼 [9468, 239, 101, 9468, 237, 119, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 120]

O: 🏃🏾‍♂‍➡ [9468, 237, 225, 9468, 237, 122, 102470, 17245, 224, 102470, 98115, 94]
N: 🧑🏿‍🍳 [9468, 100, 239, 9468, 237, 123, 102470, 9468, 235, 111]

O: 👨🏻‍❤‍💋‍👨🏼 [9468, 239, 101, 9468, 237, 119, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 120]
N: 👌🏾 [9468, 239, 234, 9468, 237, 122]

O: 👌🏾 [9468, 239, 234, 9468, 237, 122]
N: 🏃🏾‍♂‍➡ [9468, 237, 225, 9468, 237, 122, 102470, 17245, 224, 102470, 98115, 94]

O: 🧑🏿‍🚀 [9468, 100, 239, 9468, 237, 123, 102470, 9468, 248, 222]
N: 🧑🏿‍🚀 [9468, 100, 239, 9468, 237, 123, 102470, 9468, 248, 222]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:11,  3.87s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.17s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.53s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.91s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.41s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (3, 5, 6, 8, 9):   1%|          | 1/100 [00:35<32:24, 19.65s/it]2025-01-22 04:39:46.846 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the garden.
2025-01-22 04:39:46.861 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2923, 2929) --> . Mary journeyed to the
2025-01-22 04:39:46.862 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary got the football.
2025-01-22 04:39:46.885 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4190, 4194) -->  got the football.
2025-01-22 04:39:46.885 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the kitchen.
2025-01-22 04:39:46.909 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4632, 4637) -->  Mary went to the kitchen
2025-01-22 04:39:46.909 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary put down the football.
2025-01-22 04:39:46.941 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6481, 6486) --> . Mary put down the
2025-01-22 04:39:46.941 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel journeyed to the office.
2025-01-22 04:39:46.977 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7116, 7122) -->  Daniel journeyed to the office
2025-01-22 04:39:46.977 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel travelled to the garden.
2025-01-22 04:39:46.993 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3208, 3213) --> . Daniel travelled to the
2025-01-22 04:39:46.993 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John moved to the office.
2025-01-22 04:39:47.015 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4578, 4583) -->  John moved to the office
2025-01-22 04:39:47.015 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra picked up the milk.
2025-01-22 04:39:47.024 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1861, 1866) --> . Sandra picked up the
2025-01-22 04:39:47.025 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the garden.
2025-01-22 04:39:47.059 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6629, 6634) --> . Sandra went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:39:49.476 | INFO     | test_jbb_embedding:begin_test:693 - the office<|eot_id|>
2025-01-22 04:39:49.476 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8167])
2025-01-22 04:39:52.303 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [122.41045673076923, 17.299464504283964, 67.728125, 16.83892055945347, 34.515993212090166], 'topk_indices': array([7738,   16, 8166, 8127, 8141,    4,    8,   22, 8139, 8046, 8165,
         19,   20,   24,    9,   14,   23,    0, 8163, 8162]), 'topk_tokens': ['inen', ' Date', '\n\n', ' return', ':', '\n\n', ' Date', '202', '.\n\n', '.\n\n', '<|end_header_id|>', '26', ' Jul', '\n\n', ':', '\n', '4', '<|begin_of_text|>', '<|start_header_id|>', '<|eot_id|>'], 'evidence_proportions': [145.94791666666666, 203.28125, 40.790625, 169.225, 73.96354166666667]}, 'weight': {'score': [22.12079326923077, 23.258470394736843, 22.051171875, 23.265083587210732, 29.375], 'topk_indices': array([3274, 3301, 3188, 3140, 7407, 7445, 1487, 1425, 4284, 4300, 5135,
       5196, 7184, 7128, 3457, 3483, 4960, 4912, 4989, 4937]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.052083333333332, 20.828125, 24.1921875, 21.771875, 23.615885416666668]}, 'saliency': {'score': [0.6973923903245193, 0.0964369812385251, 0.409063720703125, 0.09374404974843058, 0.25546189605212605], 'topk_indices': array([4201,   14, 8056, 8012, 8139, 4192,   15, 8046, 8160, 8127,    9,
         24, 7738,   16,   22,    8, 8140,   19,   20,   23]), 'topk_tokens': ['�', '\n', ' location', ' context', '.\n\n', ' football', 'Today', '.\n\n', 'Answer', ' return', ':', '\n\n', 'inen', ' Date', '202', ' Date', 'Question', '26', ' Jul', '4'], 'evidence_proportions': [0.8153076171875, 1.14215087890625, 0.2689208984375, 0.938232421875, 0.4393310546875]}}, 'pred_res': 'the office<|eot_id|>', 'score': 0}
2025-01-22 04:39:52.317 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:39:52.320 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-33_pid-1_3-5-6-8-9.pkl | len: 3 |  size: 2.01 KB
Processing depth (3, 5, 6, 8, 9):   2%|▏         | 2/100 [00:40<33:19, 20.40s/it]is_0k: False
your chose emoji: ['🚣🏿\u200d♀', '🌧️', '🤙', '💠', '👨🏻\u200d🎤', '🧗🏼\u200d♂️', '🏋🏼', '👋', '🧑🏽\u200d🔬', '🇧🇴']
emoji:
O: 🚣🏿‍♀ [9468, 248, 96, 9468, 237, 123, 102470, 32990]
N: 👨🏻‍🎤 [9468, 239, 101, 9468, 237, 119, 102470, 9468, 236, 97]

O: 🌧️ [9468, 234, 100, 31643]
N: 👋 [9468, 239, 233]

O: 🤙 [9468, 97, 247]
N: 💠 [93273, 254]

O: 💠 [93273, 254]
N: 🤙 [9468, 97, 247]

O: 👨🏻‍🎤 [9468, 239, 101, 9468, 237, 119, 102470, 9468, 236, 97]
N: 🧗🏼‍♂️ [9468, 100, 245, 9468, 237, 120, 102470, 17245, 224, 31643]

O: 🧗🏼‍♂️ [9468, 100, 245, 9468, 237, 120, 102470, 17245, 224, 31643]
N: 🧑🏽‍🔬 [9468, 100, 239, 9468, 237, 121, 102470, 9468, 242, 105]

O: 🏋🏼 [9468, 237, 233, 9468, 237, 120]
N: 🌧️ [9468, 234, 100, 31643]

O: 👋 [9468, 239, 233]
N: 🏋🏼 [9468, 237, 233, 9468, 237, 120]

O: 🧑🏽‍🔬 [9468, 100, 239, 9468, 237, 121, 102470, 9468, 242, 105]
N: 🚣🏿‍♀ [9468, 248, 96, 9468, 237, 123, 102470, 32990]

O: 🇧🇴 [9468, 229, 100, 9468, 114783]
N: 🇧🇴 [9468, 229, 100, 9468, 114783]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.28s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.70s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.42s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.10s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.61s/it]
Processing depth (0, 3, 4, 6, 9):   2%|▏         | 2/100 [00:56<33:19, 20.40s/it]2025-01-22 04:40:08.490 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the garden.
2025-01-22 04:40:08.491 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 37) -->  journeyed to the garden.
2025-01-22 04:40:08.491 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary got the football.
2025-01-22 04:40:08.507 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2959, 2963) -->  Mary got the football
2025-01-22 04:40:08.508 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the kitchen.
2025-01-22 04:40:08.526 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3665, 3670) --> . Mary went to the
2025-01-22 04:40:08.526 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary put down the football.
2025-01-22 04:40:08.549 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4789, 4794) --> . Mary put down the
2025-01-22 04:40:08.550 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel journeyed to the office.
2025-01-22 04:40:08.586 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7320, 7326) -->  cold. Daniel journeyed to
2025-01-22 04:40:08.586 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel travelled to the garden.
2025-01-22 04:40:08.602 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3287, 3292) --> . Daniel travelled to the
2025-01-22 04:40:08.603 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John moved to the office.
2025-01-22 04:40:08.625 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4644, 4649) -->  John moved to the office
2025-01-22 04:40:08.625 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra picked up the milk.
2025-01-22 04:40:08.636 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2102, 2107) --> . Sandra picked up the
2025-01-22 04:40:08.636 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the garden.
2025-01-22 04:40:08.671 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6723, 6728) --> . Sandra went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:40:09.460 | INFO     | test_jbb_embedding:begin_test:693 - the kitchen<|eot_id|>
2025-01-22 04:40:09.461 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8235])
2025-01-22 04:40:11.724 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [258.61147836538464, 37.74614970259772, 121.2921875, 36.84119129180908, 14.448745888157895], 'topk_indices': array([  39,   14, 1602, 1681, 1620, 1589, 1703, 1704, 1695,  666,   40,
       1698, 1697, 1682, 1626,    0, 1705, 1627, 1706, 1628]), 'topk_tokens': ['***', '\n', '\n', '\n', ' courts', ' time', ' for', ' their', '\n', ' stere', '\n\n\n', ' the', ' of', 'in', ' summer', '<|begin_of_text|>', ' summer', "'s", "'s", ' work'], 'evidence_proportions': [499.875, 404.1875, 182.775, 179.825, 49.149739583333336]}, 'weight': {'score': [22.069110576923077, 23.302955814518086, 22.051171875, 23.309927940368652, 29.10986842105263], 'topk_indices': array([3330, 3303, 3169, 3217, 7463, 7501, 1406, 1468, 4338, 4354, 5193,
       5254, 7213, 7157, 3512, 3486, 5018, 4995, 4970, 5047]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.958333333333332, 26.611328125, 19.403125, 21.771875, 23.62109375]}, 'saliency': {'score': [1.4876169057992787, 0.21334438041507345, 0.727392578125, 0.20804505795240402, 0.10837659333881579], 'topk_indices': array([2962, 1588, 1697, 1641, 1642,   31, 1589, 1696, 1604, 1704,   39,
       1682,   40, 1620,  666, 1626, 1627, 1706, 1705, 1628]), 'topk_tokens': [' football', ' some', ' of', ' const', 'ern', ' journey', ' time', 'action', ' sight', ' their', '***', 'in', '\n\n\n', ' courts', ' stere', ' summer', "'s", "'s", ' summer', ' work'], 'evidence_proportions': [2.677734375, 2.836181640625, 0.935546875, 0.9828125, 0.2791849772135417]}}, 'pred_res': 'the kitchen<|eot_id|>', 'score': 0}
2025-01-22 04:40:11.729 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:40:11.729 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-33_pid-2_0-3-4-6-9.pkl | len: 3 |  size: 2.0 KB
Processing depth (0, 3, 4, 6, 9):   3%|▎         | 3/100 [00:59<32:15, 19.95s/it]is_0k: False
your chose emoji: ['🧑🏿\u200d🤝\u200d🧑🏼', '🤙🏽', '🧜🏿\u200d♂️', '🧑🏼\u200d🤝\u200d🧑🏾', '👱🏾\u200d♀', '🦸🏽\u200d♂️', '👨🏾\u200d⚖', '🧝🏿\u200d♀', '👍🏿', '🆔']
emoji:
O: 🧑🏿‍🤝‍🧑🏼 [9468, 100, 239, 9468, 237, 123, 102470, 9468, 97, 251, 102470, 9468, 100, 239, 9468, 237, 120]
N: 🧜🏿‍♂️ [9468, 100, 250, 9468, 237, 123, 102470, 17245, 224, 31643]

O: 🤙🏽 [9468, 97, 247, 9468, 237, 121]
N: 🧑🏿‍🤝‍🧑🏼 [9468, 100, 239, 9468, 237, 123, 102470, 9468, 97, 251, 102470, 9468, 100, 239, 9468, 237, 120]

O: 🧜🏿‍♂️ [9468, 100, 250, 9468, 237, 123, 102470, 17245, 224, 31643]
N: 🧝🏿‍♀ [9468, 100, 251, 9468, 237, 123, 102470, 32990]

O: 🧑🏼‍🤝‍🧑🏾 [9468, 100, 239, 9468, 237, 120, 102470, 9468, 97, 251, 102470, 9468, 100, 239, 9468, 237, 122]
N: 🧑🏼‍🤝‍🧑🏾 [9468, 100, 239, 9468, 237, 120, 102470, 9468, 97, 251, 102470, 9468, 100, 239, 9468, 237, 122]

O: 👱🏾‍♀ [9468, 239, 109, 9468, 237, 122, 102470, 32990]
N: 🦸🏽‍♂️ [9468, 99, 116, 9468, 237, 121, 102470, 17245, 224, 31643]

O: 🦸🏽‍♂️ [9468, 99, 116, 9468, 237, 121, 102470, 17245, 224, 31643]
N: 👍🏿 [9468, 239, 235, 9468, 237, 123]

O: 👨🏾‍⚖ [9468, 239, 101, 9468, 237, 122, 102470, 158, 248, 244]
N: 🤙🏽 [9468, 97, 247, 9468, 237, 121]

O: 🧝🏿‍♀ [9468, 100, 251, 9468, 237, 123, 102470, 32990]
N: 👨🏾‍⚖ [9468, 239, 101, 9468, 237, 122, 102470, 158, 248, 244]

O: 👍🏿 [9468, 239, 235, 9468, 237, 123]
N: 👱🏾‍♀ [9468, 239, 109, 9468, 237, 122, 102470, 32990]

O: 🆔 [9468, 228, 242]
N: 🆔 [9468, 228, 242]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.05s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.59s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.48s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.88s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.45s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (2, 4, 6, 8, 9):   3%|▎         | 3/100 [01:15<32:15, 19.95s/it]2025-01-22 04:40:27.210 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the garden.
2025-01-22 04:40:27.222 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1840, 1846) -->  Mary journeyed to the garden
2025-01-22 04:40:27.222 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary got the football.
2025-01-22 04:40:27.240 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3617, 3621) -->  Mary got the football
2025-01-22 04:40:27.240 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the kitchen.
2025-01-22 04:40:27.267 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4867, 4872) --> . Mary went to the
2025-01-22 04:40:27.267 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary put down the football.
2025-01-22 04:40:27.302 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6623, 6628) --> . Mary put down the
2025-01-22 04:40:27.302 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel journeyed to the office.
2025-01-22 04:40:27.342 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7317, 7323) --> . Daniel journeyed to the
2025-01-22 04:40:27.342 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel travelled to the garden.
2025-01-22 04:40:27.358 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3286, 3291) --> . Daniel travelled to the
2025-01-22 04:40:27.358 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John moved to the office.
2025-01-22 04:40:27.381 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4711, 4716) -->  the senate. John moved
2025-01-22 04:40:27.381 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra picked up the milk.
2025-01-22 04:40:27.393 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2009, 2014) -->  cable. Sandra picked up
2025-01-22 04:40:27.394 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the garden.
2025-01-22 04:40:27.429 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6819, 6824) --> . Sandra went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:40:30.815 | INFO     | test_jbb_embedding:begin_test:693 - the garden<|eot_id|>
2025-01-22 04:40:30.815 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8135])
2025-01-22 04:40:33.825 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [104.23257211538461, 14.388555234701402, 70.0796875, 13.962237008774098, 14.068381076388889], 'topk_indices': array([  20, 8129, 8109, 8093, 8127, 8014, 8099, 6824, 8096, 8095, 8107,
       8134,   24,    9,   23,   14, 8133,    0, 8130, 8131]), 'topk_tokens': [' Jul', ':', ':', '.\n\n', '?\n', '.\n\n', '.', ' garden', ' the', ' return', '.\n\n', '\n\n', '\n\n', ':', '4', '\n', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [128.53125, 180.296875, 73.3875, 133.175, 30.809895833333332]}, 'weight': {'score': [22.185697115384617, 23.229039306340624, 23.336328125, 23.23212644432773, 28.888541666666665], 'topk_indices': array([3242, 3269, 3114, 3162, 7341, 7379, 1399, 1461, 4260, 4244, 5134,
       5073, 7111, 7055, 3431, 3457, 4892, 4863, 4838, 4921]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [23.813802083333332, 26.611328125, 19.403125, 21.771875, 20.270833333333332]}, 'saliency': {'score': [0.6293229323167068, 0.07819005516654122, 0.440423583984375, 0.07552394970654852, 0.10055508083767362], 'topk_indices': array([8098,   16, 8094,    0,   19,    8, 8114, 8120,    9, 8132, 8107,
       8128, 7980, 8134,   24, 8108,   23,   20, 8095, 6824]), 'topk_tokens': [' directly', ' Date', 'Just', '<|begin_of_text|>', '26', ' Date', ' prior', ' football', ':', 'assistant', '.\n\n', 'Answer', ' context', '\n\n', '\n\n', 'Question', '4', ' Jul', ' return', ' garden'], 'evidence_proportions': [0.8206380208333334, 1.2132568359375, 0.373486328125, 0.742431640625, 0.16765848795572916]}}, 'pred_res': 'the garden<|eot_id|>', 'score': 100}
2025-01-22 04:40:33.831 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:40:33.831 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-33_pid-3_2-4-6-8-9.pkl | len: 3 |  size: 2.03 KB
Processing depth (2, 4, 6, 8, 9):   4%|▍         | 4/100 [01:22<33:16, 20.80s/it]is_0k: False
your chose emoji: ['🧗🏻\u200d♀', '🍚', '🤨', '🍐', '🤌🏿', '🕵🏻\u200d♀️', '😼', '🧓🏾', '😕', '🟤']
emoji:
O: 🧗🏻‍♀ [9468, 100, 245, 9468, 237, 119, 102470, 32990]
N: 😕 [76460, 243]

O: 🍚 [9468, 235, 248]
N: 🍐 [9468, 235, 238]

O: 🤨 [9468, 97, 101]
N: 🍚 [9468, 235, 248]

O: 🍐 [9468, 235, 238]
N: 🤨 [9468, 97, 101]

O: 🤌🏿 [9468, 97, 234, 9468, 237, 123]
N: 🤌🏿 [9468, 97, 234, 9468, 237, 123]

O: 🕵🏻‍♀️ [9468, 243, 113, 9468, 237, 119, 102470, 32990, 31643]
N: 🧓🏾 [9468, 100, 241, 9468, 237, 122]

O: 😼 [76460, 120]
N: 😼 [76460, 120]

O: 🧓🏾 [9468, 100, 241, 9468, 237, 122]
N: 🕵🏻‍♀️ [9468, 243, 113, 9468, 237, 119, 102470, 32990, 31643]

O: 😕 [76460, 243]
N: 🧗🏻‍♀ [9468, 100, 245, 9468, 237, 119, 102470, 32990]

O: 🟤 [9468, 253, 97]
N: 🟤 [9468, 253, 97]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.10s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.17s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.27s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.03s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.46s/it]
Processing depth (0, 4, 5, 6, 7):   4%|▍         | 4/100 [01:37<33:16, 20.80s/it]2025-01-22 04:40:49.600 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the garden.
2025-01-22 04:40:49.600 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 37) -->  journeyed to the garden.
2025-01-22 04:40:49.601 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary got the football.
2025-01-22 04:40:49.620 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3603, 3607) -->  Mary got the football
2025-01-22 04:40:49.621 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the kitchen.
2025-01-22 04:40:49.642 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4145, 4150) --> . Mary went to the
2025-01-22 04:40:49.642 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary put down the football.
2025-01-22 04:40:49.669 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4762, 4767) -->  senate. Mary put down
2025-01-22 04:40:49.669 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel journeyed to the office.
2025-01-22 04:40:49.700 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5599, 5605) --> . Daniel journeyed to the
2025-01-22 04:40:49.700 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel travelled to the garden.
2025-01-22 04:40:49.719 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3210, 3215) --> . Daniel travelled to the
2025-01-22 04:40:49.719 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John moved to the office.
2025-01-22 04:40:49.742 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4601, 4606) --> . John moved to the
2025-01-22 04:40:49.742 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra picked up the milk.
2025-01-22 04:40:49.752 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1868, 1873) --> . Sandra picked up the
2025-01-22 04:40:49.752 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the garden.
2025-01-22 04:40:49.792 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6640, 6645) --> . Sandra went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:40:50.571 | INFO     | test_jbb_embedding:begin_test:693 - the garden<|eot_id|>
2025-01-22 04:40:50.571 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8157])
2025-01-22 04:40:52.803 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [116.00901442307692, 15.643991268382353, 80.428125, 15.162702967093912, 11.582990373883929], 'topk_indices': array([8046, 8156, 8149, 8142, 8129,  106,   68, 8036, 4270,    9, 8130,
         69, 8155, 8131,   14,   24,   23, 8152,    0, 8153]), 'topk_tokens': [' location', '\n\n', '?\n', ' football', '.\n\n', 'ION', 'ION', '.\n\n', 'nes', ':', 'Question', 'E', '<|end_header_id|>', ':', '\n', '\n\n', '4', '<|eot_id|>', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [197.40625, 152.859375, 102.25, 85.265625, 47.130208333333336]}, 'weight': {'score': [22.302283653846153, 23.253333716299018, 21.04765625, 23.261817922726152, 29.538783482142858], 'topk_indices': array([3286, 3313, 3190, 3142, 7391, 7429, 1494, 1432, 4288, 4304, 5123,
       5184, 7112, 7168, 3495, 3469, 4888, 4913, 4936, 4965]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.958333333333332, 26.611328125, 19.403125, 27.0046875, 20.270833333333332]}, 'saliency': {'score': [0.6594566932091346, 0.08724746704101563, 0.471923828125, 0.08446573582311437, 0.08707972935267858], 'topk_indices': array([8117, 7722, 3606, 7536, 3215, 7537,   19, 7492,   69,   20, 8136,
       8150, 8046,  106,   24,   68, 8142,   23, 4270, 8130]), 'topk_tokens': [' return', 'inen', ' football', ' Min', ' garden', 'nes', '26', 'nes', 'E', ' Jul', ' prior', 'Answer', ' location', 'ION', '\n\n', 'ION', ' football', '4', 'nes', 'Question'], 'evidence_proportions': [1.0520426432291667, 1.06463623046875, 0.498876953125, 0.53388671875, 0.23520914713541666]}}, 'pred_res': 'the garden<|eot_id|>', 'score': 100}
2025-01-22 04:40:52.811 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:40:52.811 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-33_pid-4_0-4-5-6-7.pkl | len: 3 |  size: 2.02 KB
Processing depth (0, 4, 5, 6, 7):   5%|▌         | 5/100 [01:41<31:53, 20.14s/it]Processing depth (0, 4, 5, 6, 7):   5%|▌         | 5/100 [01:41<32:01, 20.23s/it]
2025-01-22 04:40:52.890 | INFO     | __main__:<module>:82 - Selected idx: 34
2025-01-22 04:40:52.890 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the milk before the hallway? 
2025-01-22 04:40:52.890 | INFO     | __main__:<module>:84 - Answer: bathroom
2025-01-22 04:40:52.890 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 04:40:52.890 | INFO     | __main__:<module>:86 - Needle: [' Sandra went to the garden.', ' Mary picked up the milk there.', ' John got the football.', ' John dropped the football.', ' Mary travelled to the bathroom.', ' Daniel travelled to the garden.', ' Mary went back to the hallway.', ' John moved to the office.']
2025-01-22 04:40:52.890 | INFO     | __main__:<module>:87 - Real Needle: [' Mary picked up the milk there.', ' Mary travelled to the bathroom.', ' Mary went back to the hallway.', ' John moved to the office.']
2025-01-22 04:40:52.890 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['🤵🏿\u200d♂️', '🚣', '🚣\u200d♀', '🇳🇪', '🧒🏾', '📓', '🗯️', '🚴\u200d♀', '🦹\u200d♀️', '🧔🏽\u200d♀']
emoji:
O: 🤵🏿‍♂️ [9468, 97, 113, 9468, 237, 123, 102470, 17245, 224, 31643]
N: 🚣 [9468, 248, 96]

O: 🚣 [9468, 248, 96]
N: 🤵🏿‍♂️ [9468, 97, 113, 9468, 237, 123, 102470, 17245, 224, 31643]

O: 🚣‍♀ [9468, 248, 96, 102470, 32990]
N: 📓 [9468, 241, 241]

O: 🇳🇪 [9468, 229, 111, 9468, 229, 103]
N: 🚴‍♀ [9468, 248, 112, 102470, 32990]

O: 🧒🏾 [9468, 100, 240, 9468, 237, 122]
N: 🧒🏾 [9468, 100, 240, 9468, 237, 122]

O: 📓 [9468, 241, 241]
N: 🇳🇪 [9468, 229, 111, 9468, 229, 103]

O: 🗯️ [9468, 245, 107, 31643]
N: 🗯️ [9468, 245, 107, 31643]

O: 🚴‍♀ [9468, 248, 112, 102470, 32990]
N: 🚣‍♀ [9468, 248, 96, 102470, 32990]

O: 🦹‍♀️ [9468, 99, 117, 102470, 32990, 31643]
N: 🦹‍♀️ [9468, 99, 117, 102470, 32990, 31643]

O: 🧔🏽‍♀ [9468, 100, 242, 9468, 237, 121, 102470, 32990]
N: 🧔🏽‍♀ [9468, 100, 242, 9468, 237, 121, 102470, 32990]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.70s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.33s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  2.98s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.56s/it]
Processing depth (0, 5, 6, 8):   0%|          | 0/100 [00:16<?, ?it/s]2025-01-22 04:41:09.317 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the milk there.
2025-01-22 04:41:09.317 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 37) -->  picked up the milk there.
2025-01-22 04:41:09.317 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the bathroom.
2025-01-22 04:41:09.338 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4200, 4205) -->  Mary travelled to the bathroom
2025-01-22 04:41:09.338 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the hallway.
2025-01-22 04:41:09.366 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4839, 4845) --> . Mary went back to the
2025-01-22 04:41:09.366 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John moved to the office.
2025-01-22 04:41:09.399 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6625, 6630) --> . John moved to the
2025-01-22 04:41:09.399 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went to the garden.
2025-01-22 04:41:09.420 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4076, 4081) -->  Sandra went to the garden
2025-01-22 04:41:09.420 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John got the football.
2025-01-22 04:41:09.446 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4910, 4914) -->  got the football.
2025-01-22 04:41:09.446 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John dropped the football.
2025-01-22 04:41:09.448 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (259, 263) -->  John dropped the football
2025-01-22 04:41:09.448 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel travelled to the garden.
2025-01-22 04:41:09.490 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7377, 7382) --> . Daniel travelled to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:41:10.229 | INFO     | test_jbb_embedding:begin_test:693 - there<|eot_id|>
2025-01-22 04:41:10.229 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8161])
2025-01-22 04:41:12.444 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [656.8806818181819, 43.46176812836845, 161.80902777777777, 41.53839703348105, 20.686197916666668], 'topk_indices': array([1568, 4204, 4845,   64,   86,   31, 4846,   34,   67, 8015, 1561,
        106,   68, 1640,   69, 8149, 8156, 8151,   35,    0]), 'topk_tokens': ['ern', ' bathroom', ' hallway', 'ISC', 'ol', ' picked', '.', ' milk', ' P', ' context', ' part', 'ION', 'ION', ' part', 'E', ' before', '<|eot_id|>', ' hallway', ' there', '<|begin_of_text|>'], 'evidence_proportions': [1148.6666666666667, 621.7, 461.875, 335.925]}, 'weight': {'score': [22.085582386363637, 23.28002893802058, 23.288194444444443, 23.28324543790005, 29.950994318181817], 'topk_indices': array([3237, 3264, 3109, 3157, 7438, 7400, 1473, 1411, 4252, 4268, 5168,
       5107, 7115, 7171, 3458, 3432, 4867, 4961, 4892, 4932]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.5, 26.4453125, 20.708333333333332, 18.88125]}, 'saliency': {'score': [3.8441938920454546, 0.2458107783361021, 1.0312567816840277, 0.23432598555399126, 0.15934984611742425], 'topk_indices': array([  67,   86, 1647, 8148, 1568,   65,   69, 1561,  106, 8015,   31,
         64,   34, 1640,   68, 4204, 8149, 4845,   35, 8151]), 'topk_tokens': [' P', 'ol', 'ern', ' milk', 'ern', 'ENCES', 'E', ' part', 'ION', ' context', ' picked', 'ISC', ' milk', ' part', 'ION', ' bathroom', ' before', ' hallway', ' there', ' hallway'], 'evidence_proportions': [6.815755208333333, 4.3662109375, 2.2490234375, 1.6705078125]}}, 'pred_res': 'there<|eot_id|>', 'score': 0}
2025-01-22 04:41:12.451 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:41:12.451 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-34_pid-0_0-5-6-8.pkl | len: 3 |  size: 1.97 KB
Processing depth (0, 5, 6, 8):   1%|          | 1/100 [00:19<32:05, 19.45s/it]is_0k: False
your chose emoji: ['🤾🏿', '🏃🏽\u200d♀️\u200d➡️', '🧛🏼\u200d♀', '👱🏼\u200d♂️', '🙅🏽\u200d♂', '👳🏼', '👧🏿', '⭐', '🗒️', '😽']
emoji:
O: 🤾🏿 [9468, 97, 122, 9468, 237, 123]
N: 🤾🏿 [9468, 97, 122, 9468, 237, 123]

O: 🏃🏽‍♀️‍➡️ [9468, 237, 225, 9468, 237, 121, 102470, 32990, 31643, 102470, 98115, 94, 31643]
N: ⭐ [158, 99834]

O: 🧛🏼‍♀ [9468, 100, 249, 9468, 237, 120, 102470, 32990]
N: 🗒️ [9468, 245, 240, 31643]

O: 👱🏼‍♂️ [9468, 239, 109, 9468, 237, 120, 102470, 17245, 224, 31643]
N: 👱🏼‍♂️ [9468, 239, 109, 9468, 237, 120, 102470, 17245, 224, 31643]

O: 🙅🏽‍♂ [9468, 247, 227, 9468, 237, 121, 102470, 17245, 224]
N: 👳🏼 [9468, 239, 111, 9468, 237, 120]

O: 👳🏼 [9468, 239, 111, 9468, 237, 120]
N: 🏃🏽‍♀️‍➡️ [9468, 237, 225, 9468, 237, 121, 102470, 32990, 31643, 102470, 98115, 94, 31643]

O: 👧🏿 [9468, 239, 100, 9468, 237, 123]
N: 👧🏿 [9468, 239, 100, 9468, 237, 123]

O: ⭐ [158, 99834]
N: 🙅🏽‍♂ [9468, 247, 227, 9468, 237, 121, 102470, 17245, 224]

O: 🗒️ [9468, 245, 240, 31643]
N: 🧛🏼‍♀ [9468, 100, 249, 9468, 237, 120, 102470, 32990]

O: 😽 [76460, 121]
N: 😽 [76460, 121]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.73s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.79s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.65s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.19s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.75s/it]
Processing depth (1, 2, 3, 7):   1%|          | 1/100 [00:36<32:05, 19.45s/it]2025-01-22 04:41:29.164 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the milk there.
2025-01-22 04:41:29.169 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (792, 798) --> . Mary picked up the milk
2025-01-22 04:41:29.170 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the bathroom.
2025-01-22 04:41:29.180 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1779, 1784) --> . Mary travelled to the
2025-01-22 04:41:29.180 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the hallway.
2025-01-22 04:41:29.196 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2867, 2873) --> . Mary went back to the
2025-01-22 04:41:29.196 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John moved to the office.
2025-01-22 04:41:29.226 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5679, 5684) --> . John moved to the
2025-01-22 04:41:29.226 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went to the garden.
2025-01-22 04:41:29.246 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4080, 4085) --> . Sandra went to the
2025-01-22 04:41:29.246 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John got the football.
2025-01-22 04:41:29.273 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4915, 4919) -->  John got the football
2025-01-22 04:41:29.273 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John dropped the football.
2025-01-22 04:41:29.274 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (263, 267) -->  dropped the football.
2025-01-22 04:41:29.274 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel travelled to the garden.
2025-01-22 04:41:29.313 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7491, 7496) --> . Daniel travelled to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:41:30.429 | INFO     | test_jbb_embedding:begin_test:693 - There is no information about the milk before the hallway in the text.<|eot_id|>
2025-01-22 04:41:30.430 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8227])
2025-01-22 04:41:32.669 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [131.78480113636363, 11.939463092345079, 77.30295138888889, 11.473878205128205, 13.531338778409092], 'topk_indices': array([ 794,  795, 8129,    9,    3, 8217, 8125, 8215, 8115, 1784,    4,
          1,   28,  797,   14,   24, 8225,  798, 8222,    0]), 'topk_tokens': [' picked', ' up', ' the', ':', '<|end_header_id|>', ' hallway', ' location', ' before', '.\n\n', ' bathroom', '\n\n', '<|start_header_id|>', '<|end_header_id|>', ' milk', '\n', '\n\n', '<|end_header_id|>', ' there', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [272.9583333333333, 115.2, 74.43229166666667, 47.784375]}, 'weight': {'score': [21.151988636363637, 23.32450637910085, 22.034288194444443, 23.333177846459098, 29.580650252525253], 'topk_indices': array([3373, 3346, 3246, 3198, 7432, 7470, 1539, 1477, 4331, 4347, 5224,
       5163, 7153, 7209, 3555, 3529, 4940, 4965, 4988, 5017]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [23.817708333333332, 20.75625, 20.708333333333332, 18.88125]}, 'saliency': {'score': [0.7526883212002841, 0.06634263401332777, 0.4343499077690972, 0.06369016318967491, 0.0998255026460898], 'topk_indices': array([8214,    4,   14, 8115,  795,  793,  265,   16,    8, 8127, 2873,
        586, 8215,  794, 8125,   24, 8217, 1784,  797,  798]), 'topk_tokens': [' milk', '\n\n', '\n', '.\n\n', ' up', ' Mary', ' football', ' Date', ' Date', ' traveled', ' hallway', ' instead', ' before', ' picked', ' location', '\n\n', ' hallway', ' bathroom', ' milk', ' there'], 'evidence_proportions': [1.68701171875, 0.6119140625, 0.3602091471354167, 0.24324951171875]}}, 'pred_res': 'There is no information about the milk before the hallway in the text.<|eot_id|>', 'score': 0}
2025-01-22 04:41:32.676 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:41:32.676 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-34_pid-1_1-2-3-7.pkl | len: 3 |  size: 2.1 KB
Processing depth (1, 2, 3, 7):   2%|▏         | 2/100 [00:39<32:30, 19.90s/it]is_0k: False
your chose emoji: ['👩🏻\u200d⚖', '🧑🏼\u200d❤\u200d🧑🏽', '9️⃣', '👩🏼\u200d❤️\u200d💋\u200d👨🏼', '🏋🏿\u200d♀️', '🙎🏻\u200d♀', '👨🏽\u200d❤\u200d👨🏻', '🧕🏾', '🐑', '🧑🏻\u200d✈']
emoji:
O: 👩🏻‍⚖ [9468, 239, 102, 9468, 237, 119, 102470, 158, 248, 244]
N: 👨🏽‍❤‍👨🏻 [9468, 239, 101, 9468, 237, 121, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 119]

O: 🧑🏼‍❤‍🧑🏽 [9468, 100, 239, 9468, 237, 120, 102470, 121643, 102470, 9468, 100, 239, 9468, 237, 121]
N: 🐑 [9468, 238, 239]

O: 9️⃣ [24, 31643, 158, 225, 96]
N: 🧑🏼‍❤‍🧑🏽 [9468, 100, 239, 9468, 237, 120, 102470, 121643, 102470, 9468, 100, 239, 9468, 237, 121]

O: 👩🏼‍❤️‍💋‍👨🏼 [9468, 239, 102, 9468, 237, 120, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 120]
N: 9️⃣ [24, 31643, 158, 225, 96]

O: 🏋🏿‍♀️ [9468, 237, 233, 9468, 237, 123, 102470, 32990, 31643]
N: 👩🏻‍⚖ [9468, 239, 102, 9468, 237, 119, 102470, 158, 248, 244]

O: 🙎🏻‍♀ [9468, 247, 236, 9468, 237, 119, 102470, 32990]
N: 🙎🏻‍♀ [9468, 247, 236, 9468, 237, 119, 102470, 32990]

O: 👨🏽‍❤‍👨🏻 [9468, 239, 101, 9468, 237, 121, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 119]
N: 👩🏼‍❤️‍💋‍👨🏼 [9468, 239, 102, 9468, 237, 120, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 120]

O: 🧕🏾 [9468, 100, 243, 9468, 237, 122]
N: 🏋🏿‍♀️ [9468, 237, 233, 9468, 237, 123, 102470, 32990, 31643]

O: 🐑 [9468, 238, 239]
N: 🧕🏾 [9468, 100, 243, 9468, 237, 122]

O: 🧑🏻‍✈ [9468, 100, 239, 9468, 237, 119, 102470, 38798, 230]
N: 🧑🏻‍✈ [9468, 100, 239, 9468, 237, 119, 102470, 38798, 230]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:11,  3.95s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.47s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.32s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.78s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.34s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (2, 7, 8, 9):   2%|▏         | 2/100 [00:54<32:30, 19.90s/it]2025-01-22 04:41:47.719 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the milk there.
2025-01-22 04:41:47.727 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1602, 1608) --> . Mary picked up the milk
2025-01-22 04:41:47.728 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the bathroom.
2025-01-22 04:41:47.755 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5546, 5551) --> . Mary travelled to the
2025-01-22 04:41:47.755 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the hallway.
2025-01-22 04:41:47.793 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6496, 6502) --> . Mary went back to the
2025-01-22 04:41:47.793 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John moved to the office.
2025-01-22 04:41:47.828 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7193, 7198) --> . John moved to the
2025-01-22 04:41:47.828 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went to the garden.
2025-01-22 04:41:47.851 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4029, 4034) --> . Sandra went to the
2025-01-22 04:41:47.851 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John got the football.
2025-01-22 04:41:47.876 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4860, 4864) -->  John got the football
2025-01-22 04:41:47.876 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John dropped the football.
2025-01-22 04:41:47.878 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (239, 243) -->  dropped the football.
2025-01-22 04:41:47.878 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel travelled to the garden.
2025-01-22 04:41:47.915 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7355, 7360) --> . Daniel travelled to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:41:50.725 | INFO     | test_jbb_embedding:begin_test:693 - the garden<|eot_id|>
2025-01-22 04:41:50.725 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8141])
2025-01-22 04:41:53.670 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [212.72798295454547, 17.04850580181729, 92.33767361111111, 16.35006632527147, 18.940638950892858], 'topk_indices': array([5547,   23, 8128, 8039,    4, 1602, 1603, 5551, 8129,    1, 1605,
       1607, 1604,   14, 8139, 8136,   24, 8137, 1608,    0]), 'topk_tokens': [' Mary', '4', ' milk', ' location', '\n\n', '.', ' Mary', ' bathroom', ' before', '<|start_header_id|>', ' up', ' milk', ' picked', '\n', '<|end_header_id|>', '<|eot_id|>', '\n\n', '<|start_header_id|>', ' there', '<|begin_of_text|>'], 'evidence_proportions': [448.2083333333333, 273.75, 78.625, 30.053125]}, 'weight': {'score': [21.151988636363637, 23.247148974705304, 22.034288194444443, 23.25553064073297, 28.759486607142858], 'topk_indices': array([3291, 3318, 3163, 3211, 7378, 7416, 1458, 1520, 4296, 4280, 5183,
       5122, 7143, 7087, 3504, 3478, 4976, 4910, 4885, 4947]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [23.817708333333332, 20.75625, 20.708333333333332, 18.88125]}, 'saliency': {'score': [1.2638466574928977, 0.09619582800125093, 0.5306447347005209, 0.09206103054698105, 0.1353179386683873], 'topk_indices': array([7886,   16,    4,   20, 8123, 8134, 7995, 1605, 8129, 8039, 5547,
       5548, 8128, 1603,   24, 8131, 1607, 5551, 1604, 1608]), 'topk_tokens': [' Square', ' Date', '\n\n', ' Jul', 'Question', 'Answer', ' context', ' up', ' before', ' location', ' Mary', ' travelled', ' milk', ' Mary', '\n\n', ' hallway', ' milk', ' bathroom', ' picked', ' there'], 'evidence_proportions': [2.7640787760416665, 1.619921875, 0.4022623697916667, 0.14139404296875]}}, 'pred_res': 'the garden<|eot_id|>', 'score': 0}
2025-01-22 04:41:53.676 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:41:53.676 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-34_pid-2_2-7-8-9.pkl | len: 3 |  size: 2.03 KB
Processing depth (2, 7, 8, 9):   3%|▎         | 3/100 [01:00<32:59, 20.40s/it]is_0k: False
your chose emoji: ['💁🏿', '🇹🇭', '🍧', '🧑\u200d🦽', '🐢', '📰', '🇾🇹', '🕔', '🧑🏼\u200d❤\u200d🧑🏾', '🇭🇷']
emoji:
O: 💁🏿 [93273, 223, 9468, 237, 123]
N: 🐢 [9468, 238, 95]

O: 🇹🇭 [9468, 229, 117, 9468, 229, 255]
N: 🧑🏼‍❤‍🧑🏾 [9468, 100, 239, 9468, 237, 120, 102470, 121643, 102470, 9468, 100, 239, 9468, 237, 122]

O: 🍧 [9468, 235, 100]
N: 🇹🇭 [9468, 229, 117, 9468, 229, 255]

O: 🧑‍🦽 [9468, 100, 239, 102470, 9468, 99, 121]
N: 🕔 [9468, 243, 242]

O: 🐢 [9468, 238, 95]
N: 📰 [9468, 105143]

O: 📰 [9468, 105143]
N: 🇾🇹 [9468, 229, 122, 9468, 229, 117]

O: 🇾🇹 [9468, 229, 122, 9468, 229, 117]
N: 🧑‍🦽 [9468, 100, 239, 102470, 9468, 99, 121]

O: 🕔 [9468, 243, 242]
N: 🍧 [9468, 235, 100]

O: 🧑🏼‍❤‍🧑🏾 [9468, 100, 239, 9468, 237, 120, 102470, 121643, 102470, 9468, 100, 239, 9468, 237, 122]
N: 💁🏿 [93273, 223, 9468, 237, 123]

O: 🇭🇷 [9468, 229, 255, 9468, 229, 115]
N: 🇭🇷 [9468, 229, 255, 9468, 229, 115]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.59s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.78s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.60s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.12s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.68s/it]
Processing depth (0, 1, 3, 4):   3%|▎         | 3/100 [01:17<32:59, 20.40s/it]2025-01-22 04:42:10.527 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the milk there.
2025-01-22 04:42:10.528 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 37) -->  picked up the milk there.
2025-01-22 04:42:10.528 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the bathroom.
2025-01-22 04:42:10.532 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (829, 834) --> . Mary travelled to the
2025-01-22 04:42:10.532 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the hallway.
2025-01-22 04:42:10.546 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2831, 2837) --> . Mary went back to the
2025-01-22 04:42:10.547 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John moved to the office.
2025-01-22 04:42:10.564 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3572, 3577) --> . John moved to the
2025-01-22 04:42:10.564 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went to the garden.
2025-01-22 04:42:10.584 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3979, 3984) -->  Sandra went to the garden
2025-01-22 04:42:10.584 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John got the football.
2025-01-22 04:42:10.607 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4781, 4785) -->  John got the football
2025-01-22 04:42:10.607 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John dropped the football.
2025-01-22 04:42:10.608 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (259, 263) -->  John dropped the football
2025-01-22 04:42:10.608 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel travelled to the garden.
2025-01-22 04:42:10.648 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7280, 7285) -->  Daniel travelled to the garden
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:42:11.367 | INFO     | test_jbb_embedding:begin_test:693 - there<|eot_id|>
2025-01-22 04:42:11.367 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8145])
2025-01-22 04:42:13.582 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [280.96590909090907, 19.968312776141385, 71.24565972222223, 19.1462926276517, 9.454438308189655], 'topk_indices': array([8072, 7997, 8043, 8143,   31, 8056,  834, 7998, 8135,   14,   34,
       8133, 8073,   24, 7898, 8141, 7999, 8140,   35,    0]), 'topk_tokens': [' to', ' provided', ' location', '<|end_header_id|>', ' picked', ' the', ' bathroom', ' you', ' hallway', '\n', ' milk', ' before', ' the', '\n\n', ' Square', '<|start_header_id|>', ' context', '<|eot_id|>', ' there', '<|begin_of_text|>'], 'evidence_proportions': [570.2916666666666, 234.375, 176.88541666666666, 105.2625]}, 'weight': {'score': [20.792613636363637, 23.26198146784487, 25.614583333333332, 23.263458929452394, 29.603448275862068], 'topk_indices': array([3317, 3290, 3162, 3210, 7400, 7438, 1437, 1499, 4311, 4327, 5204,
       5143, 7145, 7089, 3473, 3499, 4929, 4904, 4968, 4997]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.5, 20.75625, 20.708333333333332, 18.88125]}, 'saliency': {'score': [1.5578058416193181, 0.1110428897668523, 0.4737684461805556, 0.10631202581073476, 0.07106057528791757], 'topk_indices': array([  32, 8129,   42,  106, 7897,   30,   24, 7998, 8132, 8043, 2837,
       7997, 8133,   31,   34,  834, 7898, 8135,   35, 7999]), 'topk_tokens': [' up', ' Where', '-text', 'ION', 'Bridge', 'Mary', '\n\n', ' you', ' milk', ' location', ' hallway', ' provided', ' before', ' picked', ' milk', ' bathroom', ' Square', ' hallway', ' there', ' context'], 'evidence_proportions': [3.4296875, 1.2283203125, 0.8393961588541666, 0.503125]}}, 'pred_res': 'there<|eot_id|>', 'score': 0}
2025-01-22 04:42:13.589 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:42:13.589 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-34_pid-3_0-1-3-4.pkl | len: 3 |  size: 2.03 KB
Processing depth (0, 1, 3, 4):   4%|▍         | 4/100 [01:20<32:20, 20.21s/it]is_0k: False
your chose emoji: ['🧎🏾\u200d♀', '🏬', '👩🏻\u200d🦯\u200d➡', '🚶\u200d♀️\u200d➡', '🏞', '🧑🏿\u200d🎨', '🕵️', '🌞', '🦝', '♾']
emoji:
O: 🧎🏾‍♀ [9468, 100, 236, 9468, 237, 122, 102470, 32990]
N: 🕵️ [9468, 243, 113, 31643]

O: 🏬 [9468, 237, 105]
N: 🏬 [9468, 237, 105]

O: 👩🏻‍🦯‍➡ [9468, 239, 102, 9468, 237, 119, 102470, 9468, 99, 107, 102470, 98115, 94]
N: 🏞 [9468, 237, 252]

O: 🚶‍♀️‍➡ [9468, 248, 114, 102470, 32990, 31643, 102470, 98115, 94]
N: 🧑🏿‍🎨 [9468, 100, 239, 9468, 237, 123, 102470, 9468, 236, 101]

O: 🏞 [9468, 237, 252]
N: 🚶‍♀️‍➡ [9468, 248, 114, 102470, 32990, 31643, 102470, 98115, 94]

O: 🧑🏿‍🎨 [9468, 100, 239, 9468, 237, 123, 102470, 9468, 236, 101]
N: 🌞 [9468, 234, 252]

O: 🕵️ [9468, 243, 113, 31643]
N: 🦝 [9468, 99, 251]

O: 🌞 [9468, 234, 252]
N: 🧎🏾‍♀ [9468, 100, 236, 9468, 237, 122, 102470, 32990]

O: 🦝 [9468, 99, 251]
N: 👩🏻‍🦯‍➡ [9468, 239, 102, 9468, 237, 119, 102470, 9468, 99, 107, 102470, 98115, 94]

O: ♾ [17245, 122]
N: ♾ [17245, 122]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.45s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:10,  5.06s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.68s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.27s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.82s/it]
Processing depth (4, 7, 8, 9):   4%|▍         | 4/100 [01:37<32:20, 20.21s/it]2025-01-22 04:42:30.517 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary picked up the milk there.
2025-01-22 04:42:30.535 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3614, 3620) --> . Mary picked up the milk
2025-01-22 04:42:30.535 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the bathroom.
2025-01-22 04:42:30.576 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5642, 5647) --> . Mary travelled to the
2025-01-22 04:42:30.576 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the hallway.
2025-01-22 04:42:30.608 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6612, 6618) --> . Mary went back to the
2025-01-22 04:42:30.608 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John moved to the office.
2025-01-22 04:42:30.646 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7268, 7273) -->  cold. John moved to
2025-01-22 04:42:30.646 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went to the garden.
2025-01-22 04:42:30.668 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4054, 4059) -->  Sandra went to the garden
2025-01-22 04:42:30.668 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John got the football.
2025-01-22 04:42:30.693 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4878, 4882) -->  John got the football
2025-01-22 04:42:30.693 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John dropped the football.
2025-01-22 04:42:30.694 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (249, 253) -->  dropped the football.
2025-01-22 04:42:30.694 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel travelled to the garden.
2025-01-22 04:42:30.735 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7449, 7454) --> . Daniel travelled to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:42:31.464 | INFO     | test_jbb_embedding:begin_test:693 - there<|eot_id|>
2025-01-22 04:42:31.464 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8173])
2025-01-22 04:42:33.686 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [141.71484375, 11.170489466120353, 60.04340277777778, 10.709367510140117, 13.3302001953125], 'topk_indices': array([8071, 3618, 7541,    1, 7497, 5647,    3, 3617, 3292, 8161, 8163,
       3616, 3619, 8168,   14,   24, 8171, 3293, 3620,    0]), 'topk_tokens': [' location', ' the', ' Min', '<|start_header_id|>', 'nes', ' bathroom', '<|end_header_id|>', ' up', '�', ' before', ' hallway', ' picked', ' milk', '<|eot_id|>', '\n', '\n\n', '<|end_header_id|>', '�', ' there', '<|begin_of_text|>'], 'evidence_proportions': [301.4583333333333, 147.1125, 76.51041666666667, 22.8703125]}, 'weight': {'score': [22.065696022727273, 23.28278268713307, 23.288194444444443, 23.286061754854966, 29.557725694444443], 'topk_indices': array([3246, 3273, 3166, 3118, 7428, 7390, 1420, 1482, 4304, 4320, 5187,
       5126, 7105, 7161, 3461, 3435, 4928, 4903, 4980, 4951]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [23.817708333333332, 20.75625, 20.708333333333332, 22.9015625]}, 'saliency': {'score': [0.85137939453125, 0.06321821567363702, 0.3611958821614583, 0.06042776042146786, 0.0976758533053928], 'topk_indices': array([8155, 5643, 3291, 8071, 7542, 3615, 6618, 8160, 3617, 7541, 7497,
       3292, 8161,   24, 5647, 3619, 3616, 3293, 8163, 3620]), 'topk_tokens': ['Question', ' Mary', '�', ' location', 'nes', ' Mary', ' hallway', ' milk', ' up', ' Min', 'nes', '�', ' before', '\n\n', ' bathroom', ' milk', ' picked', '�', ' hallway', ' there'], 'evidence_proportions': [1.9056803385416667, 0.84501953125, 0.41021728515625, 0.12197265625]}}, 'pred_res': 'there<|eot_id|>', 'score': 0}
2025-01-22 04:42:33.693 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:42:33.693 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-34_pid-4_4-7-8-9.pkl | len: 3 |  size: 2.02 KB
Processing depth (4, 7, 8, 9):   5%|▌         | 5/100 [01:40<31:56, 20.17s/it]Processing depth (4, 7, 8, 9):   5%|▌         | 5/100 [01:40<31:54, 20.15s/it]
2025-01-22 04:42:33.763 | INFO     | __main__:<module>:82 - Selected idx: 35
2025-01-22 04:42:33.763 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the location prior to the place where the milk was discarded, left or dropped?
2025-01-22 04:42:33.763 | INFO     | __main__:<module>:84 - Answer: bathroom
2025-01-22 04:42:33.763 | INFO     | __main__:<module>:85 - Tag: 4-hop
2025-01-22 04:42:33.763 | INFO     | __main__:<module>:86 - Needle: [' John got the football.', ' Daniel travelled to the garden.', ' Mary travelled to the bathroom.', ' Mary picked up the milk there.', ' Mary went back to the hallway.', ' Sandra went to the garden.', ' John dropped the football.', ' Mary dropped the milk.', ' John moved to the office.']
2025-01-22 04:42:33.763 | INFO     | __main__:<module>:87 - Real Needle: [' Mary travelled to the bathroom.', ' Mary picked up the milk there.', ' Mary went back to the hallway.', ' Mary dropped the milk.', ' John moved to the office.']
2025-01-22 04:42:33.763 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['🤵🏿\u200d♀', '🚶🏾\u200d♀️', '🎴', '\U0001fae9', '👨🏿\u200d❤\u200d👨🏻', '👩🏼\u200d🌾', '🕉️', '🇨🇵', '🙋🏿\u200d♀️', '💂🏼']
emoji:
O: 🤵🏿‍♀ [9468, 97, 113, 9468, 237, 123, 102470, 32990]
N: 🤵🏿‍♀ [9468, 97, 113, 9468, 237, 123, 102470, 32990]

O: 🚶🏾‍♀️ [9468, 248, 114, 9468, 237, 122, 102470, 32990, 31643]
N: 🫩 [9468, 104, 102]

O: 🎴 [9468, 236, 112]
N: 👨🏿‍❤‍👨🏻 [9468, 239, 101, 9468, 237, 123, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 119]

O: 🫩 [9468, 104, 102]
N: 🇨🇵 [9468, 229, 101, 9468, 229, 113]

O: 👨🏿‍❤‍👨🏻 [9468, 239, 101, 9468, 237, 123, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 119]
N: 🚶🏾‍♀️ [9468, 248, 114, 9468, 237, 122, 102470, 32990, 31643]

O: 👩🏼‍🌾 [9468, 239, 102, 9468, 237, 120, 102470, 9468, 234, 122]
N: 🎴 [9468, 236, 112]

O: 🕉️ [9468, 243, 231, 31643]
N: 👩🏼‍🌾 [9468, 239, 102, 9468, 237, 120, 102470, 9468, 234, 122]

O: 🇨🇵 [9468, 229, 101, 9468, 229, 113]
N: 🙋🏿‍♀️ [9468, 247, 233, 9468, 237, 123, 102470, 32990, 31643]

O: 🙋🏿‍♀️ [9468, 247, 233, 9468, 237, 123, 102470, 32990, 31643]
N: 🕉️ [9468, 243, 231, 31643]

O: 💂🏼 [93273, 224, 9468, 237, 120]
N: 💂🏼 [93273, 224, 9468, 237, 120]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.02s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.24s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.61s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.26s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.66s/it]
Processing depth (0, 1, 4, 6, 9):   0%|          | 0/100 [00:16<?, ?it/s]2025-01-22 04:42:50.097 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the bathroom.
2025-01-22 04:42:50.098 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  travelled to the bathroom.
2025-01-22 04:42:50.098 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary picked up the milk there.
2025-01-22 04:42:50.103 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (901, 907) --> . Mary picked up the milk
2025-01-22 04:42:50.103 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the hallway.
2025-01-22 04:42:50.123 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3666, 3672) -->  Hon. Mary went back to
2025-01-22 04:42:50.123 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary dropped the milk.
2025-01-22 04:42:50.146 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4816, 4820) -->  Mary dropped the milk
2025-01-22 04:42:50.147 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John moved to the office.
2025-01-22 04:42:50.184 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7303, 7308) -->  cold. John moved to
2025-01-22 04:42:50.184 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John got the football.
2025-01-22 04:42:50.202 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3543, 3547) -->  John got the football
2025-01-22 04:42:50.202 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel travelled to the garden.
2025-01-22 04:42:50.212 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2049, 2054) -->  cable. Daniel travelled to
2025-01-22 04:42:50.212 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went to the garden.
2025-01-22 04:42:50.249 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (7484, 7489) --> . Sandra went to the
2025-01-22 04:42:50.249 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John dropped the football.
2025-01-22 04:42:50.268 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4001, 4005) -->  John dropped the football
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:42:51.040 | INFO     | test_jbb_embedding:begin_test:693 - the bathroom<|eot_id|>
2025-01-22 04:42:51.040 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8229])
2025-01-22 04:42:53.273 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [83.17247596153847, 6.362359731839164, 26.26974826388889, 6.074695343032486, 3.3079322076612905], 'topk_indices': array([  28,   38,   33, 8203, 8118,   23,    1, 8108,   32, 8228,   31,
        907,   24, 4328, 8225,   14, 8227,   34, 8224,    0]), 'topk_tokens': ['<|end_header_id|>', '***', ' the', ':', ' location', '4', '<|start_header_id|>', '.\n\n', ' to', '\n\n', ' travelled', ' there', '\n\n', 'nes', '<|start_header_id|>', '\n', '<|end_header_id|>', ' bathroom', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [223.775, 100.625, 31.295572916666668, 50.66796875, 9.8828125]}, 'weight': {'score': [23.905348557692307, 23.3226243622449, 24.33637152777778, 23.31854543234001, 29.989583333333332], 'topk_indices': array([3351, 3324, 3244, 3196, 7463, 7425, 1450, 1512, 4346, 4362, 5223,
       5162, 7196, 7140, 3533, 3507, 4964, 4939, 5016, 4987]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.81875, 23.817708333333332, 24.71484375, 26.685546875, 22.9015625]}, 'saliency': {'score': [0.5206295893742487, 0.035296819184565564, 0.1606572469075521, 0.033480119169428106, 0.02522610079857611], 'topk_indices': array([   8, 3673,   23,   20, 8226, 4327, 4307, 8228, 8108, 8216, 8222,
         24,  906, 8118,   38, 8202,  907, 4328,   31,   34]), 'topk_tokens': [' Date', ' hallway', '4', ' Jul', 'assistant', ' Min', 'nes', '\n\n', '.\n\n', ' discarded', 'Answer', '\n\n', ' milk', ' location', '***', 'Question', ' there', 'nes', ' travelled', ' bathroom'], 'evidence_proportions': [1.437451171875, 0.6019287109375, 0.18347676595052084, 0.342437744140625, 0.05338592529296875]}}, 'pred_res': 'the bathroom<|eot_id|>', 'score': 100}
2025-01-22 04:42:53.281 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:42:53.281 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-35_pid-0_0-1-4-6-9.pkl | len: 3 |  size: 2.08 KB
Processing depth (0, 1, 4, 6, 9):   1%|          | 1/100 [00:19<32:03, 19.43s/it]is_0k: False
your chose emoji: ['🧑🏿\u200d🌾', '👩🏼\u200d❤️\u200d💋\u200d👨🏻', '\U0001faf1🏿\u200d\U0001faf2🏾', '🚶\u200d♀️', '🧤', '🙍🏾\u200d♀', '🏃🏼\u200d➡️', '👩\u200d🍼', '👮🏿\u200d♂️', '💇🏾\u200d♂']
emoji:
O: 🧑🏿‍🌾 [9468, 100, 239, 9468, 237, 123, 102470, 9468, 234, 122]
N: 👩🏼‍❤️‍💋‍👨🏻 [9468, 239, 102, 9468, 237, 120, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 119]

O: 👩🏼‍❤️‍💋‍👨🏻 [9468, 239, 102, 9468, 237, 120, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 119]
N: 🙍🏾‍♀ [9468, 247, 235, 9468, 237, 122, 102470, 32990]

O: 🫱🏿‍🫲🏾 [9468, 104, 109, 9468, 237, 123, 102470, 9468, 104, 110, 9468, 237, 122]
N: 🫱🏿‍🫲🏾 [9468, 104, 109, 9468, 237, 123, 102470, 9468, 104, 110, 9468, 237, 122]

O: 🚶‍♀️ [9468, 248, 114, 102470, 32990, 31643]
N: 🧤 [9468, 100, 97]

O: 🧤 [9468, 100, 97]
N: 🧑🏿‍🌾 [9468, 100, 239, 9468, 237, 123, 102470, 9468, 234, 122]

O: 🙍🏾‍♀ [9468, 247, 235, 9468, 237, 122, 102470, 32990]
N: 👮🏿‍♂️ [9468, 239, 106, 9468, 237, 123, 102470, 17245, 224, 31643]

O: 🏃🏼‍➡️ [9468, 237, 225, 9468, 237, 120, 102470, 98115, 94, 31643]
N: 👩‍🍼 [9468, 239, 102, 102470, 9468, 104247]

O: 👩‍🍼 [9468, 239, 102, 102470, 9468, 104247]
N: 🏃🏼‍➡️ [9468, 237, 225, 9468, 237, 120, 102470, 98115, 94, 31643]

O: 👮🏿‍♂️ [9468, 239, 106, 9468, 237, 123, 102470, 17245, 224, 31643]
N: 🚶‍♀️ [9468, 248, 114, 102470, 32990, 31643]

O: 💇🏾‍♂ [93273, 229, 9468, 237, 122, 102470, 17245, 224]
N: 💇🏾‍♂ [93273, 229, 9468, 237, 122, 102470, 17245, 224]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.29s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.54s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:03,  3.89s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  2.52s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  3.13s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (1, 4, 5, 8, 9):   1%|          | 1/100 [00:33<32:03, 19.43s/it]2025-01-22 04:43:07.603 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the bathroom.
2025-01-22 04:43:07.607 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (825, 830) --> . Mary travelled to the
2025-01-22 04:43:07.608 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary picked up the milk there.
2025-01-22 04:43:07.626 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3618, 3624) --> . Mary picked up the milk
2025-01-22 04:43:07.626 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the hallway.
2025-01-22 04:43:07.648 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4162, 4168) --> . Mary went back to the
2025-01-22 04:43:07.648 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary dropped the milk.
2025-01-22 04:43:07.680 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6602, 6606) -->  Mary dropped the milk
2025-01-22 04:43:07.680 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John moved to the office.
2025-01-22 04:43:07.715 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7204, 7209) --> . John moved to the
2025-01-22 04:43:07.715 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John got the football.
2025-01-22 04:43:07.732 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3464, 3468) -->  John got the football
2025-01-22 04:43:07.732 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel travelled to the garden.
2025-01-22 04:43:07.742 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2020, 2025) -->  cable. Daniel travelled to
2025-01-22 04:43:07.742 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went to the garden.
2025-01-22 04:43:07.777 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (7273, 7278) -->  cold. Sandra went to
2025-01-22 04:43:07.777 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John dropped the football.
2025-01-22 04:43:07.796 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3912, 3916) -->  John dropped the football
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:43:11.094 | INFO     | test_jbb_embedding:begin_test:693 - the hallway<|eot_id|>
2025-01-22 04:43:11.094 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8165])
2025-01-22 04:43:14.446 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [308.2043269230769, 34.42668033790402, 167.21267361111111, 33.25627577240276, 26.117443647540984], 'topk_indices': array([8050, 3623, 8051, 8152, 3117,  627, 3624, 8066, 8052,   24, 8160,
        831, 8058,   14, 8044, 8053, 8067,  830, 8054,    0]), 'topk_tokens': [' item', ' milk', ' in', ' discarded', 'ern', '�', ' there', ' in', ' the', '\n\n', '<|eot_id|>', '.', ' the', '\n', '.\n\n', ' first', ' the', ' bathroom', ' location', '<|begin_of_text|>'], 'evidence_proportions': [497.0, 386.2916666666667, 115.22916666666667, 484.4375, 116.2875]}, 'weight': {'score': [22.00330528846154, 23.25996265915769, 25.453125, 23.259125161558345, 29.299180327868854], 'topk_indices': array([3297, 3324, 3169, 3217, 7395, 7433, 1483, 1421, 4322, 4306, 5117,
       5178, 7154, 7098, 3485, 3511, 4971, 4942, 4894, 4919]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.75625, 23.817708333333332, 20.708333333333332, 26.685546875, 18.88125]}, 'saliency': {'score': [1.8473604642427885, 0.19454997900534096, 1.0630459255642362, 0.1873360450252531, 0.19751476850665983], 'topk_indices': array([ 627, 8150, 8015, 8044, 3624, 2390,  626, 8144, 3117, 8138, 8050,
       8048, 8056, 6602, 3623,  827, 8053, 8152, 8054,  830]), 'topk_tokens': ['�', ' milk', ' locations', '.\n\n', ' there', 'little', '�', ' prior', 'ern', 'Question', ' item', ' obtained', ' traveled', ' Mary', ' milk', ' travelled', ' first', ' discarded', ' location', ' bathroom'], 'evidence_proportions': [2.748046875, 2.4202473958333335, 0.6101888020833334, 3.30908203125, 0.5744384765625]}}, 'pred_res': 'the hallway<|eot_id|>', 'score': 0}
2025-01-22 04:43:14.451 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:43:14.452 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-35_pid-1_1-4-5-8-9.pkl | len: 3 |  size: 2.06 KB
Processing depth (1, 4, 5, 8, 9):   2%|▏         | 2/100 [00:40<33:24, 20.45s/it]is_0k: False
your chose emoji: ['🙏🏾', '🇺🇿', '💁🏻\u200d♂', '\U0001faf5🏼', '🇨🇩', '🆚', '✳️', '🤷🏼\u200d♂️', '🥨', '🧑🏼\u200d✈️']
emoji:
O: 🙏🏾 [9468, 247, 237, 9468, 237, 122]
N: 💁🏻‍♂ [93273, 223, 9468, 237, 119, 102470, 17245, 224]

O: 🇺🇿 [9468, 229, 118, 9468, 229, 123]
N: 🙏🏾 [9468, 247, 237, 9468, 237, 122]

O: 💁🏻‍♂ [93273, 223, 9468, 237, 119, 102470, 17245, 224]
N: 🇨🇩 [9468, 229, 101, 9468, 229, 102]

O: 🫵🏼 [9468, 104, 113, 9468, 237, 120]
N: 🤷🏼‍♂️ [9468, 97, 115, 9468, 237, 120, 102470, 17245, 224, 31643]

O: 🇨🇩 [9468, 229, 101, 9468, 229, 102]
N: 🥨 [9468, 98, 101]

O: 🆚 [9468, 228, 248]
N: 🫵🏼 [9468, 104, 113, 9468, 237, 120]

O: ✳️ [38798, 111, 31643]
N: 🇺🇿 [9468, 229, 118, 9468, 229, 123]

O: 🤷🏼‍♂️ [9468, 97, 115, 9468, 237, 120, 102470, 17245, 224, 31643]
N: 🆚 [9468, 228, 248]

O: 🥨 [9468, 98, 101]
N: ✳️ [38798, 111, 31643]

O: 🧑🏼‍✈️ [9468, 100, 239, 9468, 237, 120, 102470, 38798, 230, 31643]
N: 🧑🏼‍✈️ [9468, 100, 239, 9468, 237, 120, 102470, 38798, 230, 31643]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:05<00:15,  5.16s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.96s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.46s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.08s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.70s/it]
Processing depth (0, 1, 5, 8, 9):   2%|▏         | 2/100 [00:57<33:24, 20.45s/it]2025-01-22 04:43:31.117 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the bathroom.
2025-01-22 04:43:31.117 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  travelled to the bathroom.
2025-01-22 04:43:31.117 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary picked up the milk there.
2025-01-22 04:43:31.121 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (769, 775) --> . Mary picked up the milk
2025-01-22 04:43:31.122 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the hallway.
2025-01-22 04:43:31.142 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4205, 4211) -->  Mary went back to the hallway
2025-01-22 04:43:31.142 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary dropped the milk.
2025-01-22 04:43:31.178 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6588, 6592) -->  Mary dropped the milk
2025-01-22 04:43:31.178 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John moved to the office.
2025-01-22 04:43:31.213 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7208, 7213) --> . John moved to the
2025-01-22 04:43:31.213 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John got the football.
2025-01-22 04:43:31.232 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3487, 3491) -->  John got the football
2025-01-22 04:43:31.232 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel travelled to the garden.
2025-01-22 04:43:31.241 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1800, 1805) --> . Daniel travelled to the
2025-01-22 04:43:31.242 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went to the garden.
2025-01-22 04:43:31.282 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (7370, 7375) --> . Sandra went to the
2025-01-22 04:43:31.282 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John dropped the football.
2025-01-22 04:43:31.303 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3950, 3954) -->  John dropped the football
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:43:32.068 | INFO     | test_jbb_embedding:begin_test:693 - the bathroom<|eot_id|>
2025-01-22 04:43:32.068 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8181])
2025-01-22 04:43:34.275 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [677.3882211538462, 37.25043911901271, 124.34027777777777, 35.013191031941034, 22.50280230978261], 'topk_indices': array([  35, 8067, 8173,  771,  346,   69,   66,   32,  773,  772,   31,
         67,  105,   68,   34,  774,    0,  775, 8176, 8177]), 'topk_tokens': ['.', ' in', '?\n', ' picked', ' he', 'ER', ' P', ' to', ' the', ' up', ' travelled', 'ION', 'ION', 'E', ' bathroom', ' milk', '<|begin_of_text|>', ' there', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [1265.5, 1255.5, 202.04166666666666, 547.8125, 69.61875]}, 'weight': {'score': [23.379807692307693, 23.27447229349951, 23.106770833333332, 23.27450667997543, 29.452898550724637], 'topk_indices': array([3295, 3268, 3140, 3188, 7431, 7393, 1436, 1498, 4298, 4282, 5115,
       5176, 7158, 7102, 3451, 3477, 4888, 4913, 4965, 4936]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.81875, 23.817708333333332, 25.787760416666668, 26.685546875, 18.88125]}, 'saliency': {'score': [4.3070209209735575, 0.2002695331592131, 0.7697550455729166, 0.18589284086110258, 0.16862288765285327], 'topk_indices': array([8166,  770, 8160,   30, 6591, 8154,   69,   57, 8168,  346,   66,
        772,  771,   68,  105,   67,   31,  774,   34,  775]), 'topk_tokens': [' milk', ' Mary', ' prior', 'Mary', ' milk', 'Question', 'ER', ' Proof', ' discarded', ' he', ' P', ' up', ' picked', 'E', 'ION', 'ION', ' travelled', ' milk', ' bathroom', ' there'], 'evidence_proportions': [8.3005859375, 7.694986979166667, 1.2784830729166667, 3.72998046875, 0.3437744140625]}}, 'pred_res': 'the bathroom<|eot_id|>', 'score': 100}
2025-01-22 04:43:34.283 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:43:34.284 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-35_pid-2_0-1-5-8-9.pkl | len: 3 |  size: 2.03 KB
Processing depth (0, 1, 5, 8, 9):   3%|▎         | 3/100 [01:00<32:36, 20.17s/it]is_0k: False
your chose emoji: ['📗', '🇱🇸', '\U0001fac5🏼', '🏃🏼\u200d♂\u200d➡', '↕', '🤷🏽\u200d♀️', '↘️', '🤾🏿\u200d♂', '🧙🏿\u200d♂', '🧑🏾\u200d🦳']
emoji:
O: 📗 [9468, 241, 245]
N: 📗 [9468, 241, 245]

O: 🇱🇸 [9468, 229, 109, 9468, 229, 116]
N: ↘️ [27017, 246, 31643]

O: 🫅🏼 [9468, 104, 227, 9468, 237, 120]
N: 🫅🏼 [9468, 104, 227, 9468, 237, 120]

O: 🏃🏼‍♂‍➡ [9468, 237, 225, 9468, 237, 120, 102470, 17245, 224, 102470, 98115, 94]
N: 🤷🏽‍♀️ [9468, 97, 115, 9468, 237, 121, 102470, 32990, 31643]

O: ↕ [27017, 243]
N: 🤾🏿‍♂ [9468, 97, 122, 9468, 237, 123, 102470, 17245, 224]

O: 🤷🏽‍♀️ [9468, 97, 115, 9468, 237, 121, 102470, 32990, 31643]
N: ↕ [27017, 243]

O: ↘️ [27017, 246, 31643]
N: 🇱🇸 [9468, 229, 109, 9468, 229, 116]

O: 🤾🏿‍♂ [9468, 97, 122, 9468, 237, 123, 102470, 17245, 224]
N: 🏃🏼‍♂‍➡ [9468, 237, 225, 9468, 237, 120, 102470, 17245, 224, 102470, 98115, 94]

O: 🧙🏿‍♂ [9468, 100, 247, 9468, 237, 123, 102470, 17245, 224]
N: 🧙🏿‍♂ [9468, 100, 247, 9468, 237, 123, 102470, 17245, 224]

O: 🧑🏾‍🦳 [9468, 100, 239, 9468, 237, 122, 102470, 9468, 99, 111]
N: 🧑🏾‍🦳 [9468, 100, 239, 9468, 237, 122, 102470, 9468, 99, 111]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.54s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.77s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.66s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.20s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.74s/it]
Processing depth (1, 2, 3, 6, 9):   3%|▎         | 3/100 [01:17<32:36, 20.17s/it]2025-01-22 04:43:51.013 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the bathroom.
2025-01-22 04:43:51.018 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (827, 832) --> . Mary travelled to the
2025-01-22 04:43:51.018 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary picked up the milk there.
2025-01-22 04:43:51.027 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1805, 1811) --> . Mary picked up the milk
2025-01-22 04:43:51.027 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the hallway.
2025-01-22 04:43:51.041 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2894, 2900) --> . Mary went back to the
2025-01-22 04:43:51.042 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary dropped the milk.
2025-01-22 04:43:51.067 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4860, 4864) -->  Mary dropped the milk
2025-01-22 04:43:51.067 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John moved to the office.
2025-01-22 04:43:51.106 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7204, 7209) --> . John moved to the
2025-01-22 04:43:51.106 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John got the football.
2025-01-22 04:43:51.124 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3470, 3474) -->  John got the football
2025-01-22 04:43:51.124 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel travelled to the garden.
2025-01-22 04:43:51.133 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1884, 1889) --> . Daniel travelled to the
2025-01-22 04:43:51.133 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went to the garden.
2025-01-22 04:43:51.172 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (7366, 7371) --> . Sandra went to the
2025-01-22 04:43:51.172 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John dropped the football.
2025-01-22 04:43:51.194 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3967, 3971) -->  John dropped the football
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:43:51.961 | INFO     | test_jbb_embedding:begin_test:693 - the bathroom<|eot_id|>
2025-01-22 04:43:51.962 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8167])
2025-01-22 04:43:54.182 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [48.54717548076923, 6.425366718941248, 16.944661458333332, 6.26729210251046, 6.722601121471774], 'topk_indices': array([   4,    9, 8160, 8140, 8056, 8131,  832, 8139, 8141, 8159,   23,
       8161,   24, 8046, 8166,   14, 8165,    0, 8162, 8163]), 'topk_tokens': ['\n\n', ':', 'Answer', 'Question', ' location', '.', ' bathroom', '.\n\n', ':', '?\n', '4', ':', '\n\n', '.\n\n', '\n\n', '\n', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [77.24375, 57.234375, 39.473958333333336, 57.984375, 12.7640625]}, 'weight': {'score': [22.00330528846154, 23.258984853121174, 23.106770833333332, 23.26333970434408, 29.13734879032258], 'topk_indices': array([3330, 3303, 3175, 3223, 7389, 7427, 1423, 1485, 4292, 4308, 5108,
       5169, 7098, 7154, 3491, 3517, 4933, 4910, 4885, 4962]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.75625, 23.817708333333332, 20.708333333333332, 26.685546875, 18.88125]}, 'saliency': {'score': [0.27770350529597354, 0.03307015501883798, 0.10150231255425347, 0.03213583974159911, 0.051539451845230594], 'topk_indices': array([  14, 8130, 8154, 8127, 8012,    8, 2900,   20, 8159, 8139,   23,
         24, 8146, 8046, 8164, 8166, 8056, 8140, 8160,  832]), 'topk_tokens': ['\n', ' directly', ' discarded', ' return', ' context', ' Date', ' hallway', ' Jul', '?\n', '.\n\n', '4', '\n\n', ' prior', '.\n\n', 'assistant', '\n\n', ' location', 'Question', 'Answer', ' bathroom'], 'evidence_proportions': [0.4021484375, 0.3618367513020833, 0.198333740234375, 0.38482666015625, 0.0618438720703125]}}, 'pred_res': 'the bathroom<|eot_id|>', 'score': 100}
2025-01-22 04:43:54.186 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:43:54.187 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-35_pid-3_1-2-3-6-9.pkl | len: 3 |  size: 2.04 KB
Processing depth (1, 2, 3, 6, 9):   4%|▍         | 4/100 [01:20<32:06, 20.06s/it]is_0k: False
your chose emoji: ['🇲🇱', '👩🏾\u200d🔧', '🦻🏼', '🏳️\u200d⚧️', '👨🏽\u200d✈', '👩🏿', '🦶', '✋', '🌪', '👳🏾\u200d♀']
emoji:
O: 🇲🇱 [9468, 229, 110, 9468, 229, 109]
N: 🏳️‍⚧️ [9468, 237, 111, 31643, 102470, 158, 248, 100, 31643]

O: 👩🏾‍🔧 [9468, 239, 102, 9468, 237, 122, 102470, 9468, 242, 100]
N: 👨🏽‍✈ [9468, 239, 101, 9468, 237, 121, 102470, 38798, 230]

O: 🦻🏼 [9468, 99, 119, 9468, 237, 120]
N: ✋ [38798, 233]

O: 🏳️‍⚧️ [9468, 237, 111, 31643, 102470, 158, 248, 100, 31643]
N: 🇲🇱 [9468, 229, 110, 9468, 229, 109]

O: 👨🏽‍✈ [9468, 239, 101, 9468, 237, 121, 102470, 38798, 230]
N: 🌪 [9468, 234, 103]

O: 👩🏿 [9468, 239, 102, 9468, 237, 123]
N: 👩🏾‍🔧 [9468, 239, 102, 9468, 237, 122, 102470, 9468, 242, 100]

O: 🦶 [9468, 99, 114]
N: 🦻🏼 [9468, 99, 119, 9468, 237, 120]

O: ✋ [38798, 233]
N: 🦶 [9468, 99, 114]

O: 🌪 [9468, 234, 103]
N: 👩🏿 [9468, 239, 102, 9468, 237, 123]

O: 👳🏾‍♀ [9468, 239, 111, 9468, 237, 122, 102470, 32990]
N: 👳🏾‍♀ [9468, 239, 111, 9468, 237, 122, 102470, 32990]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.06s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:09,  4.53s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.54s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.16s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.63s/it]
Processing depth (0, 1, 2, 4, 5):   4%|▍         | 4/100 [01:36<32:06, 20.06s/it]2025-01-22 04:44:10.390 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the bathroom.
2025-01-22 04:44:10.391 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  travelled to the bathroom.
2025-01-22 04:44:10.391 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary picked up the milk there.
2025-01-22 04:44:10.396 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (901, 907) --> . Mary picked up the milk
2025-01-22 04:44:10.396 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the hallway.
2025-01-22 04:44:10.406 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2011, 2017) -->  cable. Mary went back to
2025-01-22 04:44:10.406 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary dropped the milk.
2025-01-22 04:44:10.429 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3767, 3771) -->  Mary dropped the milk
2025-01-22 04:44:10.429 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John moved to the office.
2025-01-22 04:44:10.451 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4272, 4277) --> . John moved to the
2025-01-22 04:44:10.452 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John got the football.
2025-01-22 04:44:10.469 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3590, 3594) -->  John got the football
2025-01-22 04:44:10.469 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel travelled to the garden.
2025-01-22 04:44:10.480 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2115, 2120) --> . Daniel travelled to the
2025-01-22 04:44:10.480 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went to the garden.
2025-01-22 04:44:10.521 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (7370, 7375) --> . Sandra went to the
2025-01-22 04:44:10.521 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John dropped the football.
2025-01-22 04:44:10.543 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4088, 4092) -->  John dropped the football
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:44:11.326 | INFO     | test_jbb_embedding:begin_test:693 - the bathroom<|eot_id|>
2025-01-22 04:44:11.327 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8197])
2025-01-22 04:44:13.565 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [247.9044471153846, 13.986328125, 47.58203125, 13.16649073534821, 6.1945261769480515], 'topk_indices': array([  24,  903, 8195, 8189, 3767,   14,  904,   32,   69,   31,  905,
        105,   68,   67,  906,   34,  907,    0, 8192, 8193]), 'topk_tokens': ['\n\n', ' picked', '<|end_header_id|>', '?\n', ' Mary', '\n', ' up', ' to', 'ER', ' travelled', ' the', 'ION', 'E', 'ION', ' milk', ' bathroom', ' there', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [470.25, 406.5, 58.799479166666664, 299.71875, 20.71875]}, 'weight': {'score': [23.05889423076923, 23.282033155487806, 23.106770833333332, 23.28313128371751, 29.213474025974026], 'topk_indices': array([3278, 3251, 3171, 3123, 7431, 7393, 1412, 1474, 4283, 4299, 5122,
       5183, 7108, 7164, 3460, 3434, 4976, 4887, 4947, 4912]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.81875, 23.817708333333332, 24.397135416666668, 26.685546875, 18.88125]}, 'saliency': {'score': [1.5733759953425481, 0.07487868146198552, 0.2868211534288194, 0.06963396657033549, 0.04612424776151583], 'topk_indices': array([ 112, 8190, 8182, 3071, 2018, 8176, 8170,   69, 3770,  904,  903,
       3767, 8184,   68,  105,   31,   67,  906,  907,   34]), 'topk_tokens': [' PA', 'Answer', ' milk', 'ern', ' hallway', ' prior', 'Question', 'ER', ' milk', ' up', ' picked', ' Mary', ' discarded', 'E', 'ION', ' travelled', 'ION', ' milk', ' there', ' bathroom'], 'evidence_proportions': [3.0751953125, 2.4475911458333335, 0.337982177734375, 2.0775146484375, 0.10166015625]}}, 'pred_res': 'the bathroom<|eot_id|>', 'score': 100}
2025-01-22 04:44:13.571 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:44:13.572 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-35_pid-4_0-1-2-4-5.pkl | len: 3 |  size: 2.05 KB
Processing depth (0, 1, 2, 4, 5):   5%|▌         | 5/100 [01:39<31:22, 19.82s/it]Processing depth (0, 1, 2, 4, 5):   5%|▌         | 5/100 [01:39<31:35, 19.96s/it]
2025-01-22 04:44:13.639 | INFO     | __main__:<module>:82 - Selected idx: 36
2025-01-22 04:44:13.640 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the football before the garden? 
2025-01-22 04:44:13.640 | INFO     | __main__:<module>:84 - Answer: bathroom
2025-01-22 04:44:13.640 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 04:44:13.640 | INFO     | __main__:<module>:86 - Needle: [' Sandra went to the garden.', ' Mary moved to the bathroom.', ' John got the football.', ' Mary went to the garden.', ' Daniel travelled to the garden.', ' Mary discarded the football.', ' John dropped the football.']
2025-01-22 04:44:13.640 | INFO     | __main__:<module>:87 - Real Needle: [' Mary moved to the bathroom.', ' Mary went to the garden.', ' Mary discarded the football.', ' John dropped the football.']
2025-01-22 04:44:13.640 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['🤲🏽', '🇰🇮', '🧑🏻\u200d⚕️', '🤲🏿', '📮', '❄️', '👨🏿\u200d❤\u200d💋\u200d👨🏻', '🧜🏼\u200d♂️', '💪🏾', '👮🏿\u200d♂']
emoji:
O: 🤲🏽 [9468, 97, 110, 9468, 237, 121]
N: 🤲🏿 [9468, 97, 110, 9468, 237, 123]

O: 🇰🇮 [9468, 229, 108, 9468, 229, 106]
N: 🧜🏼‍♂️ [9468, 100, 250, 9468, 237, 120, 102470, 17245, 224, 31643]

O: 🧑🏻‍⚕️ [9468, 100, 239, 9468, 237, 119, 102470, 158, 248, 243, 31643]
N: 📮 [9468, 241, 106]

O: 🤲🏿 [9468, 97, 110, 9468, 237, 123]
N: 💪🏾 [93273, 103, 9468, 237, 122]

O: 📮 [9468, 241, 106]
N: 🇰🇮 [9468, 229, 108, 9468, 229, 106]

O: ❄️ [49633, 226, 31643]
N: 🤲🏽 [9468, 97, 110, 9468, 237, 121]

O: 👨🏿‍❤‍💋‍👨🏻 [9468, 239, 101, 9468, 237, 123, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 119]
N: 🧑🏻‍⚕️ [9468, 100, 239, 9468, 237, 119, 102470, 158, 248, 243, 31643]

O: 🧜🏼‍♂️ [9468, 100, 250, 9468, 237, 120, 102470, 17245, 224, 31643]
N: ❄️ [49633, 226, 31643]

O: 💪🏾 [93273, 103, 9468, 237, 122]
N: 👨🏿‍❤‍💋‍👨🏻 [9468, 239, 101, 9468, 237, 123, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 119]

O: 👮🏿‍♂ [9468, 239, 106, 9468, 237, 123, 102470, 17245, 224]
N: 👮🏿‍♂ [9468, 239, 106, 9468, 237, 123, 102470, 17245, 224]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.22s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.69s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.36s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.81s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.41s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (4, 7, 8, 9):   0%|          | 0/100 [00:15<?, ?it/s]2025-01-22 04:44:29.051 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bathroom.
2025-01-22 04:44:29.070 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3537, 3542) --> . Mary moved to the
2025-01-22 04:44:29.070 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went to the garden.
2025-01-22 04:44:29.101 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3480, 3485) -->  Sandra went to the garden
2025-01-22 04:44:29.101 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary discarded the football.
2025-01-22 04:44:29.133 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6591, 6595) -->  Mary discarded the football
2025-01-22 04:44:29.133 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John dropped the football.
2025-01-22 04:44:29.170 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7208, 7212) -->  John dropped the football
2025-01-22 04:44:29.171 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went to the garden.
2025-01-22 04:44:29.191 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3479, 3484) --> . Sandra went to the
2025-01-22 04:44:29.191 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John got the football.
2025-01-22 04:44:29.218 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5538, 5542) -->  John got the football
2025-01-22 04:44:29.218 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel travelled to the garden.
2025-01-22 04:44:29.219 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (281, 286) --> . Daniel travelled to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:44:33.762 | INFO     | test_jbb_embedding:begin_test:693 - John got the football.<|eot_id|>
2025-01-22 04:44:33.762 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8152])
2025-01-22 04:44:36.620 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [127.23090277777777, 14.78006207847946, 163.28125, 14.274936907546474, 9.795336174242424], 'topk_indices': array([  22,    8,  286,   16, 8040, 7903, 8148, 5538,    4, 8004,    1,
          9,   23, 8005,   14, 8147,   24, 8006, 8150,    0]), 'topk_tokens': ['202', ' Date', ' garden', ' Date', '.\n\n', ' Square', '<|start_header_id|>', ' John', '\n\n', ' provided', '<|start_header_id|>', ':', '4', ' you', '\n', '<|eot_id|>', '\n\n', ' context', '<|end_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [102.125, 105.8, 210.625, 102.0078125]}, 'weight': {'score': [24.75217013888889, 23.263984901900674, 22.263950892857142, 23.262410747260866, 28.99313446969697], 'topk_indices': array([3313, 3340, 3175, 3223, 7385, 7423, 1521, 1459, 4320, 4304, 5119,
       5180, 7157, 7101, 3502, 3528, 4940, 4917, 4892, 4969]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.646875, 25.3109375, 29.130859375, 26.056640625]}, 'saliency': {'score': [0.8740437825520834, 0.08304340074867796, 1.0074724469866072, 0.07969734467089976, 0.07112086902965199], 'topk_indices': array([4378, 8149, 6591, 5539,   19, 5541,   22,    8, 8139,   20,  286,
         16,   23, 7903, 5538, 6592, 8004, 8005,   24, 8006]), 'topk_tokens': ['nes', 'assistant', ' Mary', ' got', '26', ' football', '202', ' Date', ' football', ' Jul', ' garden', ' Date', '4', ' Square', ' John', ' discarded', ' provided', ' you', '\n\n', ' context'], 'evidence_proportions': [0.526904296875, 0.7420654296875, 1.6478271484375, 0.69915771484375]}}, 'pred_res': 'John got the football.<|eot_id|>', 'score': 0}
2025-01-22 04:44:36.633 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:44:36.634 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-36_pid-0_4-7-8-9.pkl | len: 3 |  size: 2.03 KB
Processing depth (4, 7, 8, 9):   1%|          | 1/100 [00:22<37:48, 22.91s/it]is_0k: False
your chose emoji: ['🧑🏻\u200d🦲', '🇦🇼', '🙌🏾', '🦹🏻', '🇹🇹', '🐹', '👨🏽\u200d🎤', '👩🏽\u200d❤\u200d👩🏼', '🌓', '\U0001fa88']
emoji:
O: 🧑🏻‍🦲 [9468, 100, 239, 9468, 237, 119, 102470, 9468, 99, 110]
N: 👩🏽‍❤‍👩🏼 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 102470, 9468, 239, 102, 9468, 237, 120]

O: 🇦🇼 [9468, 229, 99, 9468, 110771]
N: 🇹🇹 [9468, 229, 117, 9468, 229, 117]

O: 🙌🏾 [9468, 247, 234, 9468, 237, 122]
N: 🙌🏾 [9468, 247, 234, 9468, 237, 122]

O: 🦹🏻 [9468, 99, 117, 9468, 237, 119]
N: 🦹🏻 [9468, 99, 117, 9468, 237, 119]

O: 🇹🇹 [9468, 229, 117, 9468, 229, 117]
N: 🐹 [9468, 238, 117]

O: 🐹 [9468, 238, 117]
N: 🇦🇼 [9468, 229, 99, 9468, 110771]

O: 👨🏽‍🎤 [9468, 239, 101, 9468, 237, 121, 102470, 9468, 236, 97]
N: 🌓 [9468, 107569]

O: 👩🏽‍❤‍👩🏼 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 102470, 9468, 239, 102, 9468, 237, 120]
N: 🧑🏻‍🦲 [9468, 100, 239, 9468, 237, 119, 102470, 9468, 99, 110]

O: 🌓 [9468, 107569]
N: 👨🏽‍🎤 [9468, 239, 101, 9468, 237, 121, 102470, 9468, 236, 97]

O: 🪈 [9468, 103, 230]
N: 🪈 [9468, 103, 230]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.44s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.84s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.72s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.24s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.77s/it]
Processing depth (1, 2, 4, 8):   1%|          | 1/100 [00:39<37:48, 22.91s/it]2025-01-22 04:44:53.687 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bathroom.
2025-01-22 04:44:53.691 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (839, 844) --> . Mary moved to the
2025-01-22 04:44:53.692 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went to the garden.
2025-01-22 04:44:53.702 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1871, 1876) --> . Mary went to the
2025-01-22 04:44:53.702 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary discarded the football.
2025-01-22 04:44:53.723 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3740, 3744) -->  Mary discarded the football
2025-01-22 04:44:53.723 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John dropped the football.
2025-01-22 04:44:53.758 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6608, 6612) -->  John dropped the football
2025-01-22 04:44:53.758 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went to the garden.
2025-01-22 04:44:53.767 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1872, 1877) -->  Mary went to the garden
2025-01-22 04:44:53.768 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John got the football.
2025-01-22 04:44:53.796 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5699, 5703) -->  John got the football
2025-01-22 04:44:53.796 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel travelled to the garden.
2025-01-22 04:44:53.798 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (275, 280) --> . Daniel travelled to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:44:54.612 | INFO     | test_jbb_embedding:begin_test:693 - Mary's house.<|eot_id|>
2025-01-22 04:44:54.612 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8166])
2025-01-22 04:44:56.834 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [217.93055555555554, 23.566807442771452, 227.45982142857142, 22.786046761705787, 21.07991759417808], 'topk_indices': array([5699,  281,   23, 8039, 2363, 8018, 8054, 8153,    9,    1,  844,
       8019, 8162, 8154,   14, 8161,   24, 8020, 8164,    0]), 'topk_tokens': [' John', '.', '4', '.', 'nes', ' provided', '.\n\n', ' football', ':', '<|start_header_id|>', ' bathroom', ' you', '<|start_header_id|>', ' before', '\n', '<|eot_id|>', '\n\n', ' context', '<|end_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [303.825, 113.0125, 266.609375, 193.03125]}, 'weight': {'score': [23.11111111111111, 23.283512746358184, 23.378348214285715, 23.28373095121052, 29.53638698630137], 'topk_indices': array([3294, 3267, 3139, 3187, 7441, 7403, 1497, 1435, 4279, 4263, 5147,
       5086, 7180, 7124, 3476, 3450, 4911, 4940, 4876, 4851]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.646875, 19.403125, 29.130859375, 26.056640625]}, 'saliency': {'score': [1.3109673394097223, 0.13185225538239073, 1.4073311941964286, 0.12704940707762383, 0.1574098769932577], 'topk_indices': array([8156,    8, 3741, 8064,  841, 5702,  280,   16,  277, 5699, 2377,
       8019, 3743, 2363, 8018, 8154, 8153,   24,  844, 8020]), 'topk_tokens': [' garden', ' Date', ' discarded', ' location', ' moved', ' football', ' garden', ' Date', ' travelled', ' John', 'nes', ' you', ' football', 'nes', ' provided', ' before', ' football', '\n\n', ' bathroom', ' context'], 'evidence_proportions': [1.509375, 0.566357421875, 1.9923095703125, 1.3123779296875]}}, 'pred_res': "Mary's house.<|eot_id|>", 'score': 0}
2025-01-22 04:44:56.841 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:44:56.841 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-36_pid-1_1-2-4-8.pkl | len: 3 |  size: 2.04 KB
Processing depth (1, 2, 4, 8):   2%|▏         | 2/100 [00:43<34:49, 21.32s/it]is_0k: False
your chose emoji: ['🗯️', '👩🏾\u200d❤️\u200d💋\u200d👨🏿', '🎙', '🙅🏿', '🤫', '🏃🏼\u200d♂\u200d➡', '🪃', '\U0001faf4🏽', '👩🏼\u200d✈️', '👨\u200d🦲']
emoji:
O: 🗯️ [9468, 245, 107, 31643]
N: 🏃🏼‍♂‍➡ [9468, 237, 225, 9468, 237, 120, 102470, 17245, 224, 102470, 98115, 94]

O: 👩🏾‍❤️‍💋‍👨🏿 [9468, 239, 102, 9468, 237, 122, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 123]
N: 🎙 [9468, 236, 247]

O: 🎙 [9468, 236, 247]
N: 🙅🏿 [9468, 247, 227, 9468, 237, 123]

O: 🙅🏿 [9468, 247, 227, 9468, 237, 123]
N: 🪃 [9468, 103, 225]

O: 🤫 [9468, 97, 104]
N: 🤫 [9468, 97, 104]

O: 🏃🏼‍♂‍➡ [9468, 237, 225, 9468, 237, 120, 102470, 17245, 224, 102470, 98115, 94]
N: 🫴🏽 [9468, 104, 112, 9468, 237, 121]

O: 🪃 [9468, 103, 225]
N: 👩🏾‍❤️‍💋‍👨🏿 [9468, 239, 102, 9468, 237, 122, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 123]

O: 🫴🏽 [9468, 104, 112, 9468, 237, 121]
N: 👩🏼‍✈️ [9468, 239, 102, 9468, 237, 120, 102470, 38798, 230, 31643]

O: 👩🏼‍✈️ [9468, 239, 102, 9468, 237, 120, 102470, 38798, 230, 31643]
N: 🗯️ [9468, 245, 107, 31643]

O: 👨‍🦲 [9468, 239, 101, 102470, 9468, 99, 110]
N: 👨‍🦲 [9468, 239, 101, 102470, 9468, 99, 110]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:10,  3.50s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:07<00:08,  4.01s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.38s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.07s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.44s/it]
Processing depth (0, 1, 2, 3):   2%|▏         | 2/100 [00:58<34:49, 21.32s/it]2025-01-22 04:45:12.231 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bathroom.
2025-01-22 04:45:12.231 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  moved to the bathroom.
2025-01-22 04:45:12.231 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went to the garden.
2025-01-22 04:45:12.235 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (803, 808) --> . Mary went to the
2025-01-22 04:45:12.236 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary discarded the football.
2025-01-22 04:45:12.244 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1628, 1632) -->  Mary discarded the football
2025-01-22 04:45:12.244 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John dropped the football.
2025-01-22 04:45:12.260 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2863, 2867) -->  John dropped the football
2025-01-22 04:45:12.260 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went to the garden.
2025-01-22 04:45:12.264 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (804, 809) -->  Mary went to the garden
2025-01-22 04:45:12.265 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John got the football.
2025-01-22 04:45:12.295 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5562, 5566) -->  John got the football
2025-01-22 04:45:12.296 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel travelled to the garden.
2025-01-22 04:45:12.297 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (264, 269) -->  Daniel travelled to the garden
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:45:13.162 | INFO     | test_jbb_embedding:begin_test:693 - John dropped the football.<|eot_id|>
2025-01-22 04:45:13.162 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8176])
2025-01-22 04:45:15.395 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [139.97569444444446, 16.058893202102947, 152.79017857142858, 15.55014882778937, 15.950483273237179], 'topk_indices': array([8163, 8064, 7540,   16, 7541, 7496,    9,    4,    3,  260, 7921,
       8164, 8030,   23,    1,   14, 8171, 8174,   24,    0]), 'topk_tokens': [' football', '.\n\n', ' Min', ' Date', 'nes', 'nes', ':', '\n\n', '<|end_header_id|>', '�', ' Square', ' before', ' context', '4', '<|start_header_id|>', '\n', '<|eot_id|>', '<|end_header_id|>', '\n\n', '<|begin_of_text|>'], 'evidence_proportions': [203.4375, 77.4375, 126.75, 152.046875]}, 'weight': {'score': [23.40625, 23.29131961425602, 24.990513392857142, 23.28814575150362, 29.5390625], 'topk_indices': array([3335, 3362, 3255, 3207, 7395, 7433, 1483, 1545, 4336, 4320, 5204,
       5143, 7116, 7172, 3550, 3524, 4920, 4945, 4997, 4968]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.709375, 19.403125, 29.130859375, 26.056640625]}, 'saliency': {'score': [0.8851250542534722, 0.09066701194799563, 1.0054931640625, 0.08733967539575534, 0.11559677124023438], 'topk_indices': array([8074,   22,  268,    8,    0,   20, 8166,  260, 8158,   23, 7541,
         16, 8163, 7540, 7496, 8164,   34, 7921, 8030,   24]), 'topk_tokens': [' location', '202', ' garden', ' Date', '<|begin_of_text|>', ' Jul', ' garden', '�', 'Question', '4', 'nes', ' Date', ' football', ' Min', 'nes', ' before', ' bathroom', ' Square', ' context', '\n\n'], 'evidence_proportions': [1.1888671875, 0.3917724609375, 0.9478759765625, 1.05938720703125]}}, 'pred_res': 'John dropped the football.<|eot_id|>', 'score': 0}
2025-01-22 04:45:15.402 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:45:15.402 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-36_pid-2_0-1-2-3.pkl | len: 3 |  size: 2.04 KB
Processing depth (0, 1, 2, 3):   3%|▎         | 3/100 [01:01<32:25, 20.06s/it]is_0k: False
your chose emoji: ['↩️', '🥍', '🚶🏾\u200d♀\u200d➡', '🏃🏽\u200d♀\u200d➡', '👨🏿\u200d🦽\u200d➡️', '💏🏿', '🏂🏽', '👨🏽\u200d🤝\u200d👨🏼', '☎', '🤜🏿']
emoji:
O: ↩️ [27017, 102, 31643]
N: 🥍 [9468, 98, 235]

O: 🥍 [9468, 98, 235]
N: 👨🏽‍🤝‍👨🏼 [9468, 239, 101, 9468, 237, 121, 102470, 9468, 97, 251, 102470, 9468, 239, 101, 9468, 237, 120]

O: 🚶🏾‍♀‍➡ [9468, 248, 114, 9468, 237, 122, 102470, 32990, 102470, 98115, 94]
N: 🚶🏾‍♀‍➡ [9468, 248, 114, 9468, 237, 122, 102470, 32990, 102470, 98115, 94]

O: 🏃🏽‍♀‍➡ [9468, 237, 225, 9468, 237, 121, 102470, 32990, 102470, 98115, 94]
N: ☎ [18107, 236]

O: 👨🏿‍🦽‍➡️ [9468, 239, 101, 9468, 237, 123, 102470, 9468, 99, 121, 102470, 98115, 94, 31643]
N: ↩️ [27017, 102, 31643]

O: 💏🏿 [93273, 237, 9468, 237, 123]
N: 💏🏿 [93273, 237, 9468, 237, 123]

O: 🏂🏽 [9468, 237, 224, 9468, 237, 121]
N: 🏂🏽 [9468, 237, 224, 9468, 237, 121]

O: 👨🏽‍🤝‍👨🏼 [9468, 239, 101, 9468, 237, 121, 102470, 9468, 97, 251, 102470, 9468, 239, 101, 9468, 237, 120]
N: 🏃🏽‍♀‍➡ [9468, 237, 225, 9468, 237, 121, 102470, 32990, 102470, 98115, 94]

O: ☎ [18107, 236]
N: 👨🏿‍🦽‍➡️ [9468, 239, 101, 9468, 237, 123, 102470, 9468, 99, 121, 102470, 98115, 94, 31643]

O: 🤜🏿 [9468, 97, 250, 9468, 237, 123]
N: 🤜🏿 [9468, 97, 250, 9468, 237, 123]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.78s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.58s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.23s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  2.97s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.52s/it]
Processing depth (0, 3, 8, 9):   3%|▎         | 3/100 [01:17<32:25, 20.06s/it]2025-01-22 04:45:31.145 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bathroom.
2025-01-22 04:45:31.145 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  moved to the bathroom.
2025-01-22 04:45:31.145 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went to the garden.
2025-01-22 04:45:31.161 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2943, 2948) --> . Mary went to the
2025-01-22 04:45:31.161 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary discarded the football.
2025-01-22 04:45:31.197 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6503, 6507) -->  Mary discarded the football
2025-01-22 04:45:31.197 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John dropped the football.
2025-01-22 04:45:31.236 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7198, 7202) -->  John dropped the football
2025-01-22 04:45:31.236 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went to the garden.
2025-01-22 04:45:31.251 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2944, 2949) -->  Mary went to the garden
2025-01-22 04:45:31.251 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John got the football.
2025-01-22 04:45:31.287 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5548, 5552) -->  John got the football
2025-01-22 04:45:31.287 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel travelled to the garden.
2025-01-22 04:45:31.289 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (303, 308) --> . Daniel travelled to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:45:32.159 | INFO     | test_jbb_embedding:begin_test:693 - John got the football.<|eot_id|>
2025-01-22 04:45:32.159 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8154])
2025-01-22 04:45:34.381 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [195.02083333333334, 34.10158452862572, 211.89285714285714, 33.43873846153846, 35.010902518656714], 'topk_indices': array([6508, 7607, 7565, 7551, 8152,   24, 7550, 6509, 7521, 7520, 7608,
       7609, 7476, 7596, 7567, 7552, 7566,    0, 7610, 7611]), 'topk_tokens': [' *', ' use', ' Min', ' or', '<|end_header_id|>', '\n\n', ' two', '      ', 'nes', ' Min', ' of', ' the', 'nes', ' or', 'ot', ' three', 'nes', '<|begin_of_text|>', ' Min', 'nes'], 'evidence_proportions': [302.75, 158.075, 151.0, 150.5625]}, 'weight': {'score': [23.40625, 23.27325648216256, 23.378348214285715, 23.27278076923077, 29.465251865671643], 'topk_indices': array([3322, 3295, 3215, 3167, 7413, 7375, 1445, 1507, 4306, 4322, 5129,
       5190, 7091, 7147, 3478, 3504, 4931, 4906, 4983, 4954]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.709375, 19.403125, 29.130859375, 26.056640625]}, 'saliency': {'score': [1.1610378689236112, 0.19573517425600712, 1.3661934988839286, 0.19157986778846153, 0.2747415571070429], 'topk_indices': array([7551, 6508,   38, 7587, 7607, 7475, 7561, 7550, 7565,    0, 6509,
       7521, 7520, 7596, 7476, 7567, 7552, 7566, 7610, 7611]), 'topk_tokens': [' or', ' *', '***', ' tele', ' use', ' Min', ' especial', ' two', ' Min', '<|begin_of_text|>', '      ', 'nes', ' Min', ' or', 'nes', 'ot', ' three', 'nes', ' Min', 'nes'], 'evidence_proportions': [1.6583984375, 0.763720703125, 1.14117431640625, 1.05584716796875]}}, 'pred_res': 'John got the football.<|eot_id|>', 'score': 0}
2025-01-22 04:45:34.403 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:45:34.404 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-36_pid-3_0-3-8-9.pkl | len: 3 |  size: 1.96 KB
Processing depth (0, 3, 8, 9):   4%|▍         | 4/100 [01:20<31:25, 19.64s/it]is_0k: False
your chose emoji: ['🦹\u200d♂', '🔹', '🦃', '👩🏻\u200d🤝\u200d👨🏿', '👩\u200d💻', '🏃🏾\u200d♂', '🚶🏾', '⏏️', '🏰', '🧍🏼\u200d♂️']
emoji:
O: 🦹‍♂ [9468, 99, 117, 102470, 17245, 224]
N: 👩🏻‍🤝‍👨🏿 [9468, 239, 102, 9468, 237, 119, 102470, 9468, 97, 251, 102470, 9468, 239, 101, 9468, 237, 123]

O: 🔹 [9468, 242, 117]
N: 🦃 [9468, 99, 225]

O: 🦃 [9468, 99, 225]
N: 🦹‍♂ [9468, 99, 117, 102470, 17245, 224]

O: 👩🏻‍🤝‍👨🏿 [9468, 239, 102, 9468, 237, 119, 102470, 9468, 97, 251, 102470, 9468, 239, 101, 9468, 237, 123]
N: ⏏️ [158, 237, 237, 31643]

O: 👩‍💻 [9468, 239, 102, 102470, 93273, 119]
N: 🏰 [9468, 237, 108]

O: 🏃🏾‍♂ [9468, 237, 225, 9468, 237, 122, 102470, 17245, 224]
N: 👩‍💻 [9468, 239, 102, 102470, 93273, 119]

O: 🚶🏾 [9468, 248, 114, 9468, 237, 122]
N: 🚶🏾 [9468, 248, 114, 9468, 237, 122]

O: ⏏️ [158, 237, 237, 31643]
N: 🔹 [9468, 242, 117]

O: 🏰 [9468, 237, 108]
N: 🏃🏾‍♂ [9468, 237, 225, 9468, 237, 122, 102470, 17245, 224]

O: 🧍🏼‍♂️ [9468, 100, 235, 9468, 237, 120, 102470, 17245, 224, 31643]
N: 🧍🏼‍♂️ [9468, 100, 235, 9468, 237, 120, 102470, 17245, 224, 31643]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.72s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:10<00:10,  5.12s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.94s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.38s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.96s/it]
Processing depth (1, 4, 6, 7):   4%|▍         | 4/100 [01:38<31:25, 19.64s/it]2025-01-22 04:45:51.974 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bathroom.
2025-01-22 04:45:51.979 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (901, 906) --> . Mary moved to the
2025-01-22 04:45:51.979 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went to the garden.
2025-01-22 04:45:51.997 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3618, 3623) -->  Sandra went to the garden
2025-01-22 04:45:51.997 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary discarded the football.
2025-01-22 04:45:52.022 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4862, 4866) -->  Mary discarded the football
2025-01-22 04:45:52.023 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John dropped the football.
2025-01-22 04:45:52.056 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5656, 5660) -->  John dropped the football
2025-01-22 04:45:52.056 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went to the garden.
2025-01-22 04:45:52.074 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3616, 3621) -->  Hon. Sandra went to
2025-01-22 04:45:52.074 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John got the football.
2025-01-22 04:45:52.103 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5603, 5607) -->  John got the football
2025-01-22 04:45:52.103 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel travelled to the garden.
2025-01-22 04:45:52.105 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (297, 302) --> . Daniel travelled to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:45:52.854 | INFO     | test_jbb_embedding:begin_test:693 - John<|eot_id|>
2025-01-22 04:45:52.854 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8174])
2025-01-22 04:45:55.085 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [209.32986111111111, 19.136365720924545, 203.54464285714286, 18.399079189686926, 25.938235592532468], 'topk_indices': array([   4, 8164, 7638,  906,  303, 8118,    9,   23, 8161, 8027, 8162,
       4865, 4866,    1,   14, 8028,   24, 8169, 8172,    0]), 'topk_tokens': ['\n\n', ' garden', ' or', ' bathroom', '.', ' an', ':', '4', ' football', ' you', ' before', ' football', '.', '<|start_header_id|>', '\n', ' context', '\n\n', '<|eot_id|>', '<|end_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [219.15, 176.5125, 303.21875, 144.1875]}, 'weight': {'score': [24.75217013888889, 23.284519460070932, 23.981026785714285, 23.280078844383056, 29.265016233766232], 'topk_indices': array([3279, 3306, 3151, 3199, 7417, 7455, 1515, 1453, 4310, 4294, 5195,
       5134, 7126, 7182, 3488, 3462, 4964, 4887, 4912, 4935]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.646875, 25.3109375, 29.130859375, 26.056640625]}, 'saliency': {'score': [1.3774685329861112, 0.10776073693266938, 1.2786167689732142, 0.10294223174205801, 0.18977237057376217], 'topk_indices': array([   8,   20, 8026, 7585, 8117, 7915, 8066, 8027, 7629, 7563,    0,
       5606, 8162, 8164,   24, 4863, 8161,  906, 4865, 8028]), 'topk_tokens': [' Date', ' Jul', ' provided', 'graph', ' got', ' Square', ' obtained', ' you', ' tele', 'nes', '<|begin_of_text|>', ' football', ' before', ' garden', '\n\n', ' discarded', ' football', ' bathroom', ' football', ' context'], 'evidence_proportions': [1.098291015625, 1.2015625, 2.346923828125, 0.97686767578125]}}, 'pred_res': 'John<|eot_id|>', 'score': 0}
2025-01-22 04:45:55.092 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:45:55.093 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-36_pid-4_1-4-6-7.pkl | len: 3 |  size: 2.03 KB
Processing depth (1, 4, 6, 7):   5%|▌         | 5/100 [01:41<31:41, 20.02s/it]Processing depth (1, 4, 6, 7):   5%|▌         | 5/100 [01:41<32:07, 20.29s/it]
2025-01-22 04:45:55.162 | INFO     | __main__:<module>:82 - Selected idx: 37
2025-01-22 04:45:55.163 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the location prior to the place where the apple was discarded, left or dropped?
2025-01-22 04:45:55.163 | INFO     | __main__:<module>:84 - Answer: bathroom
2025-01-22 04:45:55.163 | INFO     | __main__:<module>:85 - Tag: 4-hop
2025-01-22 04:45:55.163 | INFO     | __main__:<module>:86 - Needle: [' Sandra went to the garden.', ' Mary moved to the bathroom.', ' Daniel travelled to the garden.', ' Mary picked up the apple.', ' John got the football.', ' Mary went to the garden.', ' Mary discarded the apple.', ' John dropped the football.']
2025-01-22 04:45:55.163 | INFO     | __main__:<module>:87 - Real Needle: [' Mary moved to the bathroom.', ' Mary picked up the apple.', ' Mary went to the garden.', ' Mary discarded the apple.', ' John dropped the football.']
2025-01-22 04:45:55.163 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['🦻🏾', '🛀🏽', '👧🏽', '🤲🏻', '☦', '📯', '🇪🇹', '👨🏻\u200d❤️\u200d👨🏻', '👩🏾\u200d❤\u200d💋\u200d👩🏿', '💇🏾\u200d♂']
emoji:
O: 🦻🏾 [9468, 99, 119, 9468, 237, 122]
N: 👩🏾‍❤‍💋‍👩🏿 [9468, 239, 102, 9468, 237, 122, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 123]

O: 🛀🏽 [9468, 249, 222, 9468, 237, 121]
N: 📯 [9468, 241, 107]

O: 👧🏽 [9468, 239, 100, 9468, 237, 121]
N: 🇪🇹 [9468, 229, 103, 9468, 229, 117]

O: 🤲🏻 [9468, 97, 110, 9468, 237, 119]
N: 👧🏽 [9468, 239, 100, 9468, 237, 121]

O: ☦ [18107, 99]
N: 🤲🏻 [9468, 97, 110, 9468, 237, 119]

O: 📯 [9468, 241, 107]
N: 🦻🏾 [9468, 99, 119, 9468, 237, 122]

O: 🇪🇹 [9468, 229, 103, 9468, 229, 117]
N: 👨🏻‍❤️‍👨🏻 [9468, 239, 101, 9468, 237, 119, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 119]

O: 👨🏻‍❤️‍👨🏻 [9468, 239, 101, 9468, 237, 119, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 119]
N: ☦ [18107, 99]

O: 👩🏾‍❤‍💋‍👩🏿 [9468, 239, 102, 9468, 237, 122, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 123]
N: 🛀🏽 [9468, 249, 222, 9468, 237, 121]

O: 💇🏾‍♂ [93273, 229, 9468, 237, 122, 102470, 17245, 224]
N: 💇🏾‍♂ [93273, 229, 9468, 237, 122, 102470, 17245, 224]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.64s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:08,  4.49s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.62s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.30s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.77s/it]
Processing depth (0, 1, 2, 6, 8):   0%|          | 0/100 [00:16<?, ?it/s]2025-01-22 04:46:12.002 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bathroom.
2025-01-22 04:46:12.002 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  moved to the bathroom.
2025-01-22 04:46:12.003 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary picked up the apple.
2025-01-22 04:46:12.008 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (901, 906) --> . Mary picked up the
2025-01-22 04:46:12.008 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the garden.
2025-01-22 04:46:12.017 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1806, 1811) --> . Mary went to the
2025-01-22 04:46:12.018 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary discarded the apple.
2025-01-22 04:46:12.043 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4769, 4773) -->  Mary discarded the apple
2025-01-22 04:46:12.044 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John dropped the football.
2025-01-22 04:46:12.080 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6564, 6568) -->  John dropped the football
2025-01-22 04:46:12.080 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went to the garden.
2025-01-22 04:46:12.090 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1807, 1812) -->  Mary went to the garden
2025-01-22 04:46:12.090 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel travelled to the garden.
2025-01-22 04:46:12.120 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5175, 5180) --> . Daniel travelled to the
2025-01-22 04:46:12.120 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John got the football.
2025-01-22 04:46:12.126 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1279, 1283) -->  got the football.
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:46:12.976 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 04:46:12.976 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8245])
2025-01-22 04:46:15.238 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [471.76358695652175, 33.52778703928225, 210.08035714285714, 31.999208379003775, 20.536700148809523], 'topk_indices': array([8224,  185, 4770, 8134,   29,   14,  424,  541,   32,  906,   24,
       8225, 8240,  425, 8232,  907,   35,   31,   34,    0]), 'topk_tokens': [' prior', 'ION', ' discarded', ' location', '\n\n', '\n', ' to', ' to', ' to', ' apple', '\n\n', ' to', '<|eot_id|>', ' ', ' discarded', '.', '.', ' moved', ' bathroom', '<|begin_of_text|>'], 'evidence_proportions': [979.15, 455.75, 195.575, 514.625, 159.921875]}, 'weight': {'score': [23.077445652173914, 23.33498840628031, 21.999441964285715, 23.337986961088784, 29.683630952380952], 'topk_indices': array([3357, 3330, 3202, 3250, 7513, 7475, 1504, 1442, 4371, 4355, 5209,
       5270, 7252, 7196, 3513, 3539, 4996, 5025, 4948, 4973]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.709375, 22.1, 19.403125, 28.873046875, 26.056640625]}, 'saliency': {'score': [2.9073114809782608, 0.18941930702424073, 1.2489536830357142, 0.17999962595432195, 0.15698721749441966], 'topk_indices': array([   0, 8228, 8218,  903,  105,  548,   24, 1811, 4772,  185, 8090,
       8230, 8134,   30, 8224,  906, 4770,   31, 8232,   34]), 'topk_tokens': ['<|begin_of_text|>', ' where', 'Question', ' picked', 'ION', ' per', '\n\n', ' garden', ' apple', 'ION', ' context', ' apple', ' location', 'Mary', ' prior', ' apple', ' discarded', ' moved', ' discarded', ' bathroom'], 'evidence_proportions': [5.875390625, 2.5041015625, 0.972607421875, 3.9794921875, 1.04742431640625]}}, 'pred_res': 'The garden.<|eot_id|>', 'score': 0}
2025-01-22 04:46:15.253 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:46:15.253 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-37_pid-0_0-1-2-6-8.pkl | len: 3 |  size: 2.06 KB
Processing depth (0, 1, 2, 6, 8):   1%|          | 1/100 [00:19<32:58, 19.98s/it]is_0k: False
your chose emoji: ['⛴️', '🧝🏾\u200d♂', '🧑🏼\u200d❤️\u200d🧑🏻', '👩🏼\u200d❤️\u200d👨🏾', '🕵🏻\u200d♂️', '🧑\u200d🍳', '👨🏾\u200d🦽\u200d➡️', '🥪', '🧑🏾\u200d❤️\u200d🧑🏼', '👩🏼\u200d⚖']
emoji:
O: ⛴️ [158, 249, 112, 31643]
N: 🥪 [9468, 98, 103]

O: 🧝🏾‍♂ [9468, 100, 251, 9468, 237, 122, 102470, 17245, 224]
N: 🕵🏻‍♂️ [9468, 243, 113, 9468, 237, 119, 102470, 17245, 224, 31643]

O: 🧑🏼‍❤️‍🧑🏻 [9468, 100, 239, 9468, 237, 120, 102470, 121643, 31643, 102470, 9468, 100, 239, 9468, 237, 119]
N: 🧝🏾‍♂ [9468, 100, 251, 9468, 237, 122, 102470, 17245, 224]

O: 👩🏼‍❤️‍👨🏾 [9468, 239, 102, 9468, 237, 120, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 122]
N: 🧑🏼‍❤️‍🧑🏻 [9468, 100, 239, 9468, 237, 120, 102470, 121643, 31643, 102470, 9468, 100, 239, 9468, 237, 119]

O: 🕵🏻‍♂️ [9468, 243, 113, 9468, 237, 119, 102470, 17245, 224, 31643]
N: 🧑‍🍳 [9468, 100, 239, 102470, 9468, 235, 111]

O: 🧑‍🍳 [9468, 100, 239, 102470, 9468, 235, 111]
N: 🧑🏾‍❤️‍🧑🏼 [9468, 100, 239, 9468, 237, 122, 102470, 121643, 31643, 102470, 9468, 100, 239, 9468, 237, 120]

O: 👨🏾‍🦽‍➡️ [9468, 239, 101, 9468, 237, 122, 102470, 9468, 99, 121, 102470, 98115, 94, 31643]
N: 👩🏼‍❤️‍👨🏾 [9468, 239, 102, 9468, 237, 120, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 122]

O: 🥪 [9468, 98, 103]
N: ⛴️ [158, 249, 112, 31643]

O: 🧑🏾‍❤️‍🧑🏼 [9468, 100, 239, 9468, 237, 122, 102470, 121643, 31643, 102470, 9468, 100, 239, 9468, 237, 120]
N: 👨🏾‍🦽‍➡️ [9468, 239, 101, 9468, 237, 122, 102470, 9468, 99, 121, 102470, 98115, 94, 31643]

O: 👩🏼‍⚖ [9468, 239, 102, 9468, 237, 120, 102470, 158, 248, 244]
N: 👩🏼‍⚖ [9468, 239, 102, 9468, 237, 120, 102470, 158, 248, 244]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.15s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.38s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.03s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  2.60s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  3.18s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 1, 3, 5, 9):   1%|          | 1/100 [00:34<32:58, 19.98s/it]2025-01-22 04:46:29.786 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bathroom.
2025-01-22 04:46:29.786 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  moved to the bathroom.
2025-01-22 04:46:29.786 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary picked up the apple.
2025-01-22 04:46:29.791 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (821, 826) --> . Mary picked up the
2025-01-22 04:46:29.791 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the garden.
2025-01-22 04:46:29.805 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2610, 2615) --> . Mary went to the
2025-01-22 04:46:29.806 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary discarded the apple.
2025-01-22 04:46:29.829 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4098, 4102) -->  discarded the apple.
2025-01-22 04:46:29.829 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John dropped the football.
2025-01-22 04:46:29.866 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7135, 7139) -->  dropped the football.
2025-01-22 04:46:29.866 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went to the garden.
2025-01-22 04:46:29.879 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2611, 2616) -->  Mary went to the garden
2025-01-22 04:46:29.879 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel travelled to the garden.
2025-01-22 04:46:29.908 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5051, 5056) --> . Daniel travelled to the
2025-01-22 04:46:29.909 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John got the football.
2025-01-22 04:46:29.915 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1246, 1250) -->  John got the football
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:46:33.994 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 04:46:33.995 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8185])
2025-01-22 04:46:37.155 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [446.48369565217394, 40.63676645701026, 140.35044642857142, 39.32030579070053, 27.644817708333335], 'topk_indices': array([ 459,  426,  428, 8165,  185, 8172,   32,  545,  546,  436,   31,
        542, 8180,   34,  554, 8181,  430,  547,    0,  431]), 'topk_tokens': [' per', ' ', ',', ' to', 'ION', ' discarded', ' to', ',', '000', 's', ' moved', ' setting', '<|eot_id|>', ' bathroom', ' per', '<|start_header_id|>', ' to', ' to', '<|begin_of_text|>', ' '], 'evidence_proportions': [1074.9, 289.075, 177.5, 464.1875, 176.25]}, 'weight': {'score': [21.23233695652174, 23.28059736809966, 23.378348214285715, 23.2862091307815, 29.254166666666666], 'topk_indices': array([3365, 3338, 3258, 3210, 7461, 7423, 1466, 1528, 4376, 4392, 5193,
       5254, 7200, 7144, 3547, 3521, 4964, 5012, 5041, 4989]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.709375, 22.1, 19.403125, 23.08984375, 21.23046875]}, 'saliency': {'score': [2.6848250679347827, 0.22342612187805325, 0.8858729771205357, 0.21534288893329806, 0.20779764811197918], 'topk_indices': array([ 436, 8168,  437,  438, 8164,   30,  185,  552,  429,  459, 4098,
        546,  542,   31,  431, 8172,  430,  547,  554,   34]), 'topk_tokens': ['s', ' where', ' per', ' hour', ' prior', 'Mary', 'ION', ' em', '000', ' per', ' discarded', '000', ' setting', ' moved', ' ', ' discarded', ' to', ' to', ' per', ' bathroom'], 'evidence_proportions': [6.6890625, 1.5953125, 0.89736328125, 2.97998046875, 0.9805908203125]}}, 'pred_res': 'The garden.<|eot_id|>', 'score': 0}
2025-01-22 04:46:37.160 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:46:37.160 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-37_pid-1_0-1-3-5-9.pkl | len: 3 |  size: 2.02 KB
Processing depth (0, 1, 3, 5, 9):   2%|▏         | 2/100 [00:41<34:29, 21.12s/it]is_0k: False
your chose emoji: ['💑🏽', '🚣🏾\u200d♀', '🕵🏼\u200d♂', '👨\u200d👨\u200d👧\u200d👦', '⚧️', '👩🏻\u200d🤝\u200d👩🏾', '🐠', '♎', '👱🏿', '🕵️\u200d♀']
emoji:
O: 💑🏽 [93273, 239, 9468, 237, 121]
N: 🐠 [9468, 238, 254]

O: 🚣🏾‍♀ [9468, 248, 96, 9468, 237, 122, 102470, 32990]
N: 👱🏿 [9468, 239, 109, 9468, 237, 123]

O: 🕵🏼‍♂ [9468, 243, 113, 9468, 237, 120, 102470, 17245, 224]
N: 🕵🏼‍♂ [9468, 243, 113, 9468, 237, 120, 102470, 17245, 224]

O: 👨‍👨‍👧‍👦 [9468, 239, 101, 102470, 9468, 239, 101, 102470, 9468, 239, 100, 102470, 9468, 239, 99]
N: ♎ [17245, 236]

O: ⚧️ [158, 248, 100, 31643]
N: 💑🏽 [93273, 239, 9468, 237, 121]

O: 👩🏻‍🤝‍👩🏾 [9468, 239, 102, 9468, 237, 119, 102470, 9468, 97, 251, 102470, 9468, 239, 102, 9468, 237, 122]
N: 👩🏻‍🤝‍👩🏾 [9468, 239, 102, 9468, 237, 119, 102470, 9468, 97, 251, 102470, 9468, 239, 102, 9468, 237, 122]

O: 🐠 [9468, 238, 254]
N: 🚣🏾‍♀ [9468, 248, 96, 9468, 237, 122, 102470, 32990]

O: ♎ [17245, 236]
N: ⚧️ [158, 248, 100, 31643]

O: 👱🏿 [9468, 239, 109, 9468, 237, 123]
N: 👨‍👨‍👧‍👦 [9468, 239, 101, 102470, 9468, 239, 101, 102470, 9468, 239, 100, 102470, 9468, 239, 99]

O: 🕵️‍♀ [9468, 243, 113, 31643, 102470, 32990]
N: 🕵️‍♀ [9468, 243, 113, 31643, 102470, 32990]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.91s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:10<00:10,  5.19s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.95s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.35s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.96s/it]
Processing depth (0, 1, 3, 5, 7):   2%|▏         | 2/100 [00:59<34:29, 21.12s/it]2025-01-22 04:46:54.762 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bathroom.
2025-01-22 04:46:54.762 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  moved to the bathroom.
2025-01-22 04:46:54.762 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary picked up the apple.
2025-01-22 04:46:54.767 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (901, 906) --> . Mary picked up the
2025-01-22 04:46:54.767 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the garden.
2025-01-22 04:46:54.782 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2936, 2941) --> . Mary went to the
2025-01-22 04:46:54.782 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary discarded the apple.
2025-01-22 04:46:54.802 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4161, 4165) -->  Mary discarded the apple
2025-01-22 04:46:54.802 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John dropped the football.
2025-01-22 04:46:54.831 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5592, 5596) -->  John dropped the football
2025-01-22 04:46:54.831 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went to the garden.
2025-01-22 04:46:54.846 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2937, 2942) -->  Mary went to the garden
2025-01-22 04:46:54.846 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel travelled to the garden.
2025-01-22 04:46:54.873 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5091, 5096) --> . Daniel travelled to the
2025-01-22 04:46:54.873 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John got the football.
2025-01-22 04:46:54.881 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1292, 1296) -->  John got the football
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:46:55.671 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 04:46:55.672 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8171])
2025-01-22 04:46:57.898 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [534.6086956521739, 38.309877355028135, 205.33258928571428, 36.619673251812706, 22.321088005514707], 'topk_indices': array([  30,   24, 8060,   67,   14, 8167,   68, 8050,   29, 8158,   32,
        907,   35, 8151, 8015,   31, 8166,   34, 8016,    0]), 'topk_tokens': ['Mary', '\n\n', ' location', 'ION', '\n', '<|start_header_id|>', 'E', '.\n\n', '\n\n', ' discarded', ' to', '.', '.', ' to', ' you', ' moved', '<|eot_id|>', ' bathroom', ' context', '<|begin_of_text|>'], 'evidence_proportions': [1055.15, 459.35, 267.675, 464.8125, 381.46875]}, 'weight': {'score': [23.077445652173914, 23.271898703205284, 23.378348214285715, 23.272265192945802, 29.346277573529413], 'topk_indices': array([3329, 3302, 3174, 3222, 7403, 7441, 1436, 1498, 4330, 4346, 5173,
       5234, 7124, 7180, 3515, 3541, 4969, 4944, 5021, 4992]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.709375, 22.1, 19.403125, 28.873046875, 26.056640625]}, 'saliency': {'score': [3.267195991847826, 0.21491870362104692, 1.3128487723214286, 0.2044021252025854, 0.16373510921702666], 'topk_indices': array([ 105, 8149, 2941, 8153,   68, 7356, 8144, 8156,  906,   67, 8014,
       8015, 8060, 4162, 8150,   30,   31, 8158, 8016,   34]), 'topk_tokens': ['ION', ' location', ' garden', ' place', 'E', 'nes', 'Question', ' apple', ' apple', 'ION', ' provided', ' you', ' location', ' discarded', ' prior', 'Mary', ' moved', ' discarded', ' context', ' bathroom'], 'evidence_proportions': [6.353125, 2.48046875, 1.3705078125, 3.551513671875, 2.479736328125]}}, 'pred_res': 'The garden.<|eot_id|>', 'score': 0}
2025-01-22 04:46:57.914 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:46:57.915 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-37_pid-2_0-1-3-5-7.pkl | len: 3 |  size: 2.06 KB
Processing depth (0, 1, 3, 5, 7):   3%|▎         | 3/100 [01:02<33:52, 20.95s/it]is_0k: False
your chose emoji: ['☹', '⛹️\u200d♀', '🧑\u200d🦼', '🧑🏻\u200d🏫', '🔴', '👨🏿\u200d🦽', '🛣️', '🚶🏿\u200d♂️', '🧑🏾\u200d🦼\u200d➡', '⚱']
emoji:
O: ☹ [18107, 117]
N: 🧑🏻‍🏫 [9468, 100, 239, 9468, 237, 119, 102470, 9468, 237, 104]

O: ⛹️‍♀ [158, 249, 117, 31643, 102470, 32990]
N: 🛣️ [9468, 249, 96, 31643]

O: 🧑‍🦼 [9468, 100, 239, 102470, 9468, 99, 120]
N: 👨🏿‍🦽 [9468, 239, 101, 9468, 237, 123, 102470, 9468, 99, 121]

O: 🧑🏻‍🏫 [9468, 100, 239, 9468, 237, 119, 102470, 9468, 237, 104]
N: ☹ [18107, 117]

O: 🔴 [9468, 242, 112]
N: 🧑🏾‍🦼‍➡ [9468, 100, 239, 9468, 237, 122, 102470, 9468, 99, 120, 102470, 98115, 94]

O: 👨🏿‍🦽 [9468, 239, 101, 9468, 237, 123, 102470, 9468, 99, 121]
N: 🧑‍🦼 [9468, 100, 239, 102470, 9468, 99, 120]

O: 🛣️ [9468, 249, 96, 31643]
N: 🔴 [9468, 242, 112]

O: 🚶🏿‍♂️ [9468, 248, 114, 9468, 237, 123, 102470, 17245, 224, 31643]
N: 🚶🏿‍♂️ [9468, 248, 114, 9468, 237, 123, 102470, 17245, 224, 31643]

O: 🧑🏾‍🦼‍➡ [9468, 100, 239, 9468, 237, 122, 102470, 9468, 99, 120, 102470, 98115, 94]
N: ⛹️‍♀ [158, 249, 117, 31643, 102470, 32990]

O: ⚱ [158, 248, 109]
N: ⚱ [158, 248, 109]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.43s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.80s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.72s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.33s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.83s/it]
Processing depth (0, 4, 6, 7, 9):   3%|▎         | 3/100 [01:19<33:52, 20.95s/it]2025-01-22 04:47:14.853 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bathroom.
2025-01-22 04:47:14.853 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  moved to the bathroom.
2025-01-22 04:47:14.853 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary picked up the apple.
2025-01-22 04:47:14.872 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3632, 3637) --> . Mary picked up the
2025-01-22 04:47:14.872 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the garden.
2025-01-22 04:47:14.889 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3227, 3232) -->  Sandra went to the garden
2025-01-22 04:47:14.889 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary discarded the apple.
2025-01-22 04:47:14.917 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5746, 5750) -->  discarded the apple.
2025-01-22 04:47:14.917 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John dropped the football.
2025-01-22 04:47:14.962 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7224, 7228) -->  John dropped the football
2025-01-22 04:47:14.962 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went to the garden.
2025-01-22 04:47:14.979 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3226, 3231) --> . Sandra went to the
2025-01-22 04:47:14.979 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel travelled to the garden.
2025-01-22 04:47:15.008 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5394, 5399) --> . Daniel travelled to the
2025-01-22 04:47:15.008 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John got the football.
2025-01-22 04:47:15.016 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1384, 1388) -->  John got the football
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:47:15.828 | INFO     | test_jbb_embedding:begin_test:693 - Mary's garden.<|eot_id|>
2025-01-22 04:47:15.829 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8173])
2025-01-22 04:47:18.043 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [176.08423913043478, 17.39822345890411, 92.1875, 16.821146639636318, 18.1639209692029], 'topk_indices': array([8152, 8146, 7328, 8147, 8153, 7329,   23,    1, 8169, 8062,   67,
         14, 7377, 8171,   34,   68, 8168,  105,   24,    0]), 'topk_tokens': [' prior', 'Question', ' tele', ':', ' to', 'graph', '4', '<|start_header_id|>', '<|start_header_id|>', ' location', 'ION', '\n', ' tele', '<|end_header_id|>', ' bathroom', 'E', '<|eot_id|>', 'ION', '\n\n', '<|begin_of_text|>'], 'evidence_proportions': [304.375, 159.1125, 117.2125, 188.375, 98.234375]}, 'weight': {'score': [23.355978260869566, 23.270930161448142, 22.263950892857142, 23.272421942191915, 29.200860507246375], 'topk_indices': array([3242, 3269, 3108, 3156, 7401, 7439, 1410, 1472, 4281, 4297, 5159,
       5098, 7173, 7117, 3447, 3473, 4952, 4900, 4923, 4875]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.709375, 22.1, 25.3109375, 23.08984375, 26.056640625]}, 'saliency': {'score': [1.0796641474184783, 0.09823541211988594, 0.5409894670758929, 0.09470040564719252, 0.13137153957201086], 'topk_indices': array([  23,   20,    0,   16, 5746, 3637, 7915,   31, 8160, 8152,   67,
       8062,   24,   68, 7328, 7329, 8146,  105, 7377,   34]), 'topk_tokens': ['4', ' Jul', '<|begin_of_text|>', ' Date', ' discarded', ' apple', ' Square', ' moved', ' discarded', ' prior', 'ION', ' location', '\n\n', 'E', ' tele', 'graph', 'Question', 'ION', ' tele', ' bathroom'], 'evidence_proportions': [1.86689453125, 0.908740234375, 0.78583984375, 1.12139892578125, 0.63482666015625]}}, 'pred_res': "Mary's garden.<|eot_id|>", 'score': 0}
2025-01-22 04:47:18.050 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:47:18.050 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-37_pid-3_0-4-6-7-9.pkl | len: 3 |  size: 2.08 KB
Processing depth (0, 4, 6, 7, 9):   4%|▍         | 4/100 [01:22<33:00, 20.63s/it]is_0k: False
your chose emoji: ['👩🏼\u200d🌾', '🍎', '🧯', '⁉️', '👩🏼\u200d⚕️', '🏊🏿\u200d♀', '💆🏻', '👌🏽', '👩🏽\u200d🤝\u200d👩🏿', '🐤']
emoji:
O: 👩🏼‍🌾 [9468, 239, 102, 9468, 237, 120, 102470, 9468, 234, 122]
N: 👩🏼‍⚕️ [9468, 239, 102, 9468, 237, 120, 102470, 158, 248, 243, 31643]

O: 🍎 [9468, 235, 236]
N: 🧯 [9468, 100, 107]

O: 🧯 [9468, 100, 107]
N: 👩🏼‍🌾 [9468, 239, 102, 9468, 237, 120, 102470, 9468, 234, 122]

O: ⁉️ [53233, 231, 31643]
N: 🍎 [9468, 235, 236]

O: 👩🏼‍⚕️ [9468, 239, 102, 9468, 237, 120, 102470, 158, 248, 243, 31643]
N: 👩🏽‍🤝‍👩🏿 [9468, 239, 102, 9468, 237, 121, 102470, 9468, 97, 251, 102470, 9468, 239, 102, 9468, 237, 123]

O: 🏊🏿‍♀ [9468, 237, 232, 9468, 237, 123, 102470, 32990]
N: ⁉️ [53233, 231, 31643]

O: 💆🏻 [93273, 228, 9468, 237, 119]
N: 💆🏻 [93273, 228, 9468, 237, 119]

O: 👌🏽 [9468, 239, 234, 9468, 237, 121]
N: 👌🏽 [9468, 239, 234, 9468, 237, 121]

O: 👩🏽‍🤝‍👩🏿 [9468, 239, 102, 9468, 237, 121, 102470, 9468, 97, 251, 102470, 9468, 239, 102, 9468, 237, 123]
N: 🏊🏿‍♀ [9468, 237, 232, 9468, 237, 123, 102470, 32990]

O: 🐤 [9468, 238, 97]
N: 🐤 [9468, 238, 97]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.23s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.67s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.39s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.01s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.54s/it]
Processing depth (2, 3, 4, 6, 9):   4%|▍         | 4/100 [01:38<33:00, 20.63s/it]2025-01-22 04:47:33.962 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bathroom.
2025-01-22 04:47:33.971 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1740, 1745) --> . Mary moved to the
2025-01-22 04:47:33.971 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary picked up the apple.
2025-01-22 04:47:33.985 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2825, 2830) -->  Mary picked up the apple
2025-01-22 04:47:33.985 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the garden.
2025-01-22 04:47:34.003 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3007, 3012) -->  Sandra went to the garden
2025-01-22 04:47:34.003 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary discarded the apple.
2025-01-22 04:47:34.026 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4725, 4729) -->  Mary discarded the apple
2025-01-22 04:47:34.026 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John dropped the football.
2025-01-22 04:47:34.061 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7214, 7218) -->  John dropped the football
2025-01-22 04:47:34.061 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went to the garden.
2025-01-22 04:47:34.075 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3005, 3010) -->  tragedy. Sandra went to
2025-01-22 04:47:34.075 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel travelled to the garden.
2025-01-22 04:47:34.103 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5221, 5226) --> . Daniel travelled to the
2025-01-22 04:47:34.103 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John got the football.
2025-01-22 04:47:34.109 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1130, 1134) -->  John got the football
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:47:34.887 | INFO     | test_jbb_embedding:begin_test:693 - the garden<|eot_id|>
2025-01-22 04:47:34.887 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8159])
2025-01-22 04:47:37.141 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [184.62771739130434, 17.927177775055135, 131.33370535714286, 17.259878846153846, 22.206621723790324], 'topk_indices': array([8048, 8146,   23, 8133,    4, 1133, 1743, 8138, 8038,    9, 8004,
       1742, 8139, 8157, 8154,    1,   14,   24, 1745,    0]), 'topk_tokens': [' location', ' discarded', '4', ':', '\n\n', ' football', ' to', ' prior', '.\n\n', ':', ' context', ' moved', ' to', '<|end_header_id|>', '<|eot_id|>', '<|start_header_id|>', '\n', '\n\n', ' bathroom', '<|begin_of_text|>'], 'evidence_proportions': [349.95, 133.3125, 128.775, 190.59375, 105.96875]}, 'weight': {'score': [25.132472826086957, 23.25917360940946, 24.338169642857142, 23.252011538461538, 29.103830645161292], 'topk_indices': array([3308, 3335, 3228, 3180, 7391, 7429, 1500, 1438, 4311, 4327, 5127,
       5188, 7107, 7163, 3491, 3517, 4904, 4929, 4952, 4981]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.646875, 26.7078125, 25.3109375, 28.873046875, 26.056640625]}, 'saliency': {'score': [1.156441066576087, 0.10129757063028363, 0.8503156389508929, 0.09702008713942308, 0.16176974388860887], 'topk_indices': array([8134,   20,    8,    0, 8141, 8038, 7895,   16, 8048, 8144, 4726,
       8152, 8132, 1133, 8146, 8004, 8138, 1742,   24, 1745]), 'topk_tokens': [' Where', ' Jul', ' Date', '<|begin_of_text|>', ' place', '.\n\n', ' Square', ' Date', ' location', ' apple', ' discarded', 'Answer', 'Question', ' football', ' discarded', ' context', ' prior', ' moved', '\n\n', ' bathroom'], 'evidence_proportions': [1.77919921875, 0.92802734375, 0.887451171875, 1.47662353515625, 0.6795654296875]}}, 'pred_res': 'the garden<|eot_id|>', 'score': 0}
2025-01-22 04:47:37.148 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:47:37.149 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-37_pid-4_2-3-4-6-9.pkl | len: 3 |  size: 2.09 KB
Processing depth (2, 3, 4, 6, 9):   5%|▌         | 5/100 [01:41<31:47, 20.08s/it]Processing depth (2, 3, 4, 6, 9):   5%|▌         | 5/100 [01:41<32:16, 20.39s/it]
2025-01-22 04:47:37.206 | INFO     | __main__:<module>:82 - Selected idx: 38
2025-01-22 04:47:37.206 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the football before the hallway? 
2025-01-22 04:47:37.206 | INFO     | __main__:<module>:84 - Answer: office
2025-01-22 04:47:37.206 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 04:47:37.206 | INFO     | __main__:<module>:86 - Needle: [' Daniel travelled to the garden.', ' John moved to the office.', ' Mary got the football.', ' Sandra went to the garden.', ' Mary travelled to the office.', ' Sandra picked up the milk.', ' Daniel journeyed to the office.', ' Mary journeyed to the hallway.', ' John went to the kitchen.']
2025-01-22 04:47:37.206 | INFO     | __main__:<module>:87 - Real Needle: [' Mary got the football.', ' Mary travelled to the office.', ' Mary journeyed to the hallway.', ' John went to the kitchen.']
2025-01-22 04:47:37.206 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['☦', '🧛\u200d♂️', '🧝🏾\u200d♀️', '👨\u200d🦱', '🈷', '🇬🇱', '🎺', '👨🏿\u200d⚕', '👩🏽\u200d💼', '🇬🇪']
emoji:
O: ☦ [18107, 99]
N: ☦ [18107, 99]

O: 🧛‍♂️ [9468, 100, 249, 102470, 17245, 224, 31643]
N: 👩🏽‍💼 [9468, 239, 102, 9468, 237, 121, 102470, 93273, 120]

O: 🧝🏾‍♀️ [9468, 100, 251, 9468, 237, 122, 102470, 32990, 31643]
N: 🇬🇱 [9468, 229, 105, 9468, 229, 109]

O: 👨‍🦱 [9468, 239, 101, 102470, 9468, 99, 109]
N: 🎺 [9468, 236, 118]

O: 🈷 [9468, 230, 115]
N: 👨🏿‍⚕ [9468, 239, 101, 9468, 237, 123, 102470, 158, 248, 243]

O: 🇬🇱 [9468, 229, 105, 9468, 229, 109]
N: 🧝🏾‍♀️ [9468, 100, 251, 9468, 237, 122, 102470, 32990, 31643]

O: 🎺 [9468, 236, 118]
N: 🧛‍♂️ [9468, 100, 249, 102470, 17245, 224, 31643]

O: 👨🏿‍⚕ [9468, 239, 101, 9468, 237, 123, 102470, 158, 248, 243]
N: 👨‍🦱 [9468, 239, 101, 102470, 9468, 99, 109]

O: 👩🏽‍💼 [9468, 239, 102, 9468, 237, 121, 102470, 93273, 120]
N: 🈷 [9468, 230, 115]

O: 🇬🇪 [9468, 229, 105, 9468, 229, 103]
N: 🇬🇪 [9468, 229, 105, 9468, 229, 103]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.95s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.84s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.69s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.23s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.81s/it]
Processing depth (1, 2, 8, 9):   0%|          | 0/100 [00:16<?, ?it/s]2025-01-22 04:47:54.206 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the football.
2025-01-22 04:47:54.211 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (896, 900) -->  Mary got the football
2025-01-22 04:47:54.211 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the office.
2025-01-22 04:47:54.222 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1821, 1826) --> . Mary travelled to the
2025-01-22 04:47:54.222 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the hallway.
2025-01-22 04:47:54.259 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6527, 6533) --> . Mary journeyed to the
2025-01-22 04:47:54.259 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the kitchen.
2025-01-22 04:47:54.304 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7224, 7229) --> . John went to the
2025-01-22 04:47:54.304 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel travelled to the garden.
2025-01-22 04:47:54.312 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1246, 1251) -->  Republican. Daniel travelled to
2025-01-22 04:47:54.312 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John moved to the office.
2025-01-22 04:47:54.329 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3491, 3496) --> . John moved to the
2025-01-22 04:47:54.330 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went to the garden.
2025-01-22 04:47:54.340 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2062, 2067) -->  cable. Sandra went to
2025-01-22 04:47:54.340 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra picked up the milk.
2025-01-22 04:47:54.374 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6439, 6444) --> . Sandra picked up the
2025-01-22 04:47:54.375 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel journeyed to the office.
2025-01-22 04:47:54.381 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1120, 1126) --> . Daniel journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:47:55.239 | INFO     | test_jbb_embedding:begin_test:693 - Mary got the football.<|eot_id|>
2025-01-22 04:47:55.239 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8154])
2025-01-22 04:47:57.479 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [345.39375, 42.24317986758215, 217.08233173076923, 40.93506280826141, 57.711069915254235], 'topk_indices': array([8141, 8150, 8142, 8148, 8042, 8068,  907,  908, 8007,   14,   24,
        900, 8152, 8081,  899, 8052, 8082, 8008, 8149,    0]), 'topk_tokens': [' football', '<|start_header_id|>', ' before', ':', '.\n\n', '.\n', '\u200d', '�', ' you', '\n', '\n\n', '.', '<|end_header_id|>', ' to', ' football', ' location', ' the', ' context', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [1006.5, 173.6, 234.14583333333334, 121.8]}, 'weight': {'score': [21.186328125, 23.25013027219225, 22.651442307692307, 23.257139141491987, 28.896186440677965], 'topk_indices': array([3325, 3352, 3239, 3191, 7441, 7403, 1519, 1457, 4328, 4344, 5220,
       5159, 7118, 7174, 3514, 3540, 4984, 4936, 4961, 5013]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.611328125, 20.75625, 20.052083333333332, 18.6375]}, 'saliency': {'score': [2.129150390625, 0.23608790571166932, 1.2178297776442308, 0.22827205634440506, 0.4193347995564089], 'topk_indices': array([8136,    0, 8042,  897,   24, 8006, 8051,  901, 8142, 8007,  896,
       8147, 8080, 8141, 8144,  908,  907, 8052,  899, 8008]), 'topk_tokens': ['Question', '<|begin_of_text|>', '.\n\n', ' got', '\n\n', ' provided', ' first', '�', ' before', ' you', ' Mary', 'Answer', ' moved', ' football', ' hallway', '�', '\u200d', ' location', ' football', ' context'], 'evidence_proportions': [7.03125, 0.969921875, 1.132080078125, 0.56318359375]}}, 'pred_res': 'Mary got the football.<|eot_id|>', 'score': 0}
2025-01-22 04:47:57.490 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:47:57.490 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-38_pid-0_1-2-8-9.pkl | len: 3 |  size: 2.03 KB
Processing depth (1, 2, 8, 9):   1%|          | 1/100 [00:20<33:17, 20.17s/it]is_0k: False
your chose emoji: ['👮🏼\u200d♀️', '🐦', '🤤', '🙃', '👦🏽', '👩🏻\u200d🎓', '\U0001fae9', '👨🏿\u200d⚖', '🧑🏻\u200d🦰', '😉']
emoji:
O: 👮🏼‍♀️ [9468, 239, 106, 9468, 237, 120, 102470, 32990, 31643]
N: 👨🏿‍⚖ [9468, 239, 101, 9468, 237, 123, 102470, 158, 248, 244]

O: 🐦 [9468, 238, 99]
N: 👩🏻‍🎓 [9468, 239, 102, 9468, 237, 119, 102470, 9468, 236, 241]

O: 🤤 [9468, 97, 97]
N: 👮🏼‍♀️ [9468, 239, 106, 9468, 237, 120, 102470, 32990, 31643]

O: 🙃 [9468, 247, 225]
N: 🤤 [9468, 97, 97]

O: 👦🏽 [9468, 239, 99, 9468, 237, 121]
N: 🫩 [9468, 104, 102]

O: 👩🏻‍🎓 [9468, 239, 102, 9468, 237, 119, 102470, 9468, 236, 241]
N: 🙃 [9468, 247, 225]

O: 🫩 [9468, 104, 102]
N: 👦🏽 [9468, 239, 99, 9468, 237, 121]

O: 👨🏿‍⚖ [9468, 239, 101, 9468, 237, 123, 102470, 158, 248, 244]
N: 🧑🏻‍🦰 [9468, 100, 239, 9468, 237, 119, 102470, 9468, 99, 108]

O: 🧑🏻‍🦰 [9468, 100, 239, 9468, 237, 119, 102470, 9468, 99, 108]
N: 🐦 [9468, 238, 99]

O: 😉 [76460, 231]
N: 😉 [76460, 231]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.34s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  5.00s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.77s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.29s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.83s/it]
Processing depth (1, 2, 5, 8):   1%|          | 1/100 [00:37<33:17, 20.17s/it]2025-01-22 04:48:14.521 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the football.
2025-01-22 04:48:14.527 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (770, 774) -->  Mary got the football
2025-01-22 04:48:14.527 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the office.
2025-01-22 04:48:14.537 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1799, 1804) --> . Mary travelled to the
2025-01-22 04:48:14.538 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the hallway.
2025-01-22 04:48:14.559 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4165, 4171) --> . Mary journeyed to the
2025-01-22 04:48:14.559 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the kitchen.
2025-01-22 04:48:14.592 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6526, 6531) --> . John went to the
2025-01-22 04:48:14.592 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel travelled to the garden.
2025-01-22 04:48:14.598 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1125, 1130) --> . Daniel travelled to the
2025-01-22 04:48:14.598 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John moved to the office.
2025-01-22 04:48:14.619 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3483, 3488) --> . John moved to the
2025-01-22 04:48:14.620 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went to the garden.
2025-01-22 04:48:14.631 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2040, 2045) -->  cable. Sandra went to
2025-01-22 04:48:14.631 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra picked up the milk.
2025-01-22 04:48:14.664 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6438, 6443) --> . Sandra picked up the
2025-01-22 04:48:14.664 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel journeyed to the office.
2025-01-22 04:48:14.669 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1062, 1068) --> . Daniel journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:48:15.532 | INFO     | test_jbb_embedding:begin_test:693 - Mary's house.<|eot_id|>
2025-01-22 04:48:15.532 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8162])
2025-01-22 04:48:17.756 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [414.03125, 42.766451800587944, 205.0330528846154, 41.33208033074649, 36.407831101190474], 'topk_indices': array([   1, 8145, 8150, 8050, 8060, 8015, 8155, 8152,   30,   24,   14,
       8156,  774, 8160, 8016,   31,  773, 8157,   32,    0]), 'topk_tokens': ['<|start_header_id|>', ':', ' before', '.\n\n', ' location', ' you', 'Answer', ' hallway', '�', '\n\n', '\n', ':', '.', '<|end_header_id|>', ' context', '�', ' football', '<|eot_id|>', '�', '<|begin_of_text|>'], 'evidence_proportions': [1225.0, 321.4, 257.4375, 45.8]}, 'weight': {'score': [21.186328125, 23.263718765311122, 21.719651442307693, 23.273782027593004, 29.41418650793651], 'topk_indices': array([3344, 3317, 3189, 3237, 7415, 7453, 1435, 1497, 4309, 4325, 5158,
       5219, 7192, 7136, 3506, 3532, 4977, 4954, 5006, 4929]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.611328125, 20.75625, 20.052083333333332, 18.6375]}, 'saliency': {'score': [2.5851318359375, 0.23794054763098665, 1.1633019080528846, 0.22919415429061962, 0.26058887300037203], 'topk_indices': array([8146, 8056, 8014, 8050, 4171,   24, 8015,  771, 8144, 8150,  770,
       8060, 8149, 8155,   31,   30, 8152, 8016,  773,   32]), 'topk_tokens': [' Where', ' item', ' provided', '.\n\n', ' hallway', '\n\n', ' you', ' got', 'Question', ' before', ' Mary', ' location', ' football', 'Answer', '�', '�', ' hallway', ' context', ' football', '�'], 'evidence_proportions': [8.6181640625, 1.73798828125, 1.2518717447916667, 0.20576171875]}}, 'pred_res': "Mary's house.<|eot_id|>", 'score': 0}
2025-01-22 04:48:17.763 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:48:17.764 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-38_pid-1_1-2-5-8.pkl | len: 3 |  size: 2.01 KB
Processing depth (1, 2, 5, 8):   2%|▏         | 2/100 [00:40<33:02, 20.23s/it]is_0k: False
your chose emoji: ['🟣', '🏌🏾\u200d♀️', '🥅', '🧑🏻\u200d🦱', '📮', '🤵\u200d♂️', '🍹', '👨🏿\u200d❤️\u200d👨🏾', '🇹🇻', '🤹']
emoji:
O: 🟣 [9468, 253, 96]
N: 🥅 [9468, 98, 227]

O: 🏌🏾‍♀️ [9468, 237, 234, 9468, 237, 122, 102470, 32990, 31643]
N: 🇹🇻 [9468, 229, 117, 9468, 229, 119]

O: 🥅 [9468, 98, 227]
N: 🟣 [9468, 253, 96]

O: 🧑🏻‍🦱 [9468, 100, 239, 9468, 237, 119, 102470, 9468, 99, 109]
N: 👨🏿‍❤️‍👨🏾 [9468, 239, 101, 9468, 237, 123, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 122]

O: 📮 [9468, 241, 106]
N: 📮 [9468, 241, 106]

O: 🤵‍♂️ [9468, 97, 113, 102470, 17245, 224, 31643]
N: 🤵‍♂️ [9468, 97, 113, 102470, 17245, 224, 31643]

O: 🍹 [9468, 235, 117]
N: 🏌🏾‍♀️ [9468, 237, 234, 9468, 237, 122, 102470, 32990, 31643]

O: 👨🏿‍❤️‍👨🏾 [9468, 239, 101, 9468, 237, 123, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 122]
N: 🍹 [9468, 235, 117]

O: 🇹🇻 [9468, 229, 117, 9468, 229, 119]
N: 🧑🏻‍🦱 [9468, 100, 239, 9468, 237, 119, 102470, 9468, 99, 109]

O: 🤹 [9468, 97, 117]
N: 🤹 [9468, 97, 117]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.25s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.55s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.39s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.87s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.44s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (1, 2, 3, 6):   2%|▏         | 2/100 [00:55<33:02, 20.23s/it]2025-01-22 04:48:33.319 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the football.
2025-01-22 04:48:33.324 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (776, 780) -->  Mary got the football
2025-01-22 04:48:33.324 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the office.
2025-01-22 04:48:33.333 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1609, 1614) --> . Mary travelled to the
2025-01-22 04:48:33.334 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the hallway.
2025-01-22 04:48:33.348 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2749, 2755) --> . Mary journeyed to the
2025-01-22 04:48:33.349 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the kitchen.
2025-01-22 04:48:33.372 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4619, 4624) -->  John went to the kitchen
2025-01-22 04:48:33.373 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel travelled to the garden.
2025-01-22 04:48:33.379 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1019, 1024) --> . Daniel travelled to the
2025-01-22 04:48:33.379 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John moved to the office.
2025-01-22 04:48:33.398 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3386, 3391) --> . John moved to the
2025-01-22 04:48:33.398 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went to the garden.
2025-01-22 04:48:33.408 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1835, 1840) --> . Sandra went to the
2025-01-22 04:48:33.408 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra picked up the milk.
2025-01-22 04:48:33.442 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6442, 6447) --> . Sandra picked up the
2025-01-22 04:48:33.442 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel journeyed to the office.
2025-01-22 04:48:33.448 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (949, 955) -->  Daniel journeyed to the office
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:48:36.657 | INFO     | test_jbb_embedding:begin_test:693 - Mary's house.<|eot_id|>
2025-01-22 04:48:36.657 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8160])
2025-01-22 04:48:39.414 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [483.525, 51.849569652046064, 269.3798076923077, 50.08893697634303, 83.15921118951613], 'topk_indices': array([8142, 8057, 8147, 8153, 8156, 8143,   24, 8158,   14, 8048, 8150,
        780, 8148, 8154, 8013,  779, 8058, 8155, 8014,    0]), 'topk_tokens': ['Question', ' first', ' football', 'Answer', '<|start_header_id|>', ':', '\n\n', '<|end_header_id|>', '\n', '.\n\n', ' hallway', '.', ' before', ':', ' you', ' football', ' location', '<|eot_id|>', ' context', '<|begin_of_text|>'], 'evidence_proportions': [1280.375, 396.05, 387.125, 49.2]}, 'weight': {'score': [22.38359375, 23.25124050477824, 21.64032451923077, 23.258539266572203, 28.69203629032258], 'topk_indices': array([3369, 3342, 3242, 3194, 7393, 7431, 1527, 1465, 4333, 4349, 5223,
       5162, 7170, 7114, 3531, 3557, 4964, 5016, 4987, 4939]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.611328125, 20.75625, 20.052083333333332, 23.4265625]}, 'saliency': {'score': [2.99300537109375, 0.290407696298395, 1.59674072265625, 0.27956286976054245, 0.6088626000189012], 'topk_indices': array([8154,   24, 8054, 8019,  777, 8144, 8048, 8057, 8012,  776, 8142,
       8013, 2755, 8148, 8147, 8153, 8058, 8150,  779, 8014]), 'topk_tokens': [':', '\n\n', ' item', ' locations', ' got', ' Where', '.\n\n', ' first', ' provided', ' Mary', 'Question', ' you', ' hallway', ' before', ' football', 'Answer', ' location', ' hallway', ' football', ' context'], 'evidence_proportions': [8.98681640625, 2.23955078125, 1.8771158854166667, 0.290478515625]}}, 'pred_res': "Mary's house.<|eot_id|>", 'score': 0}
2025-01-22 04:48:39.425 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:48:39.425 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-38_pid-2_1-2-3-6.pkl | len: 3 |  size: 2.03 KB
Processing depth (1, 2, 3, 6):   3%|▎         | 3/100 [01:02<33:45, 20.88s/it]is_0k: False
your chose emoji: ['🤸🏼\u200d♂', '👨🏾\u200d🏭', '🥷🏿', '🏃🏼', '🔣', '👩🏻\u200d🦳', '🇳🇪', '🙆🏾', '📡', '🧋']
emoji:
O: 🤸🏼‍♂ [9468, 97, 116, 9468, 237, 120, 102470, 17245, 224]
N: 🔣 [9468, 242, 96]

O: 👨🏾‍🏭 [9468, 239, 101, 9468, 237, 122, 102470, 9468, 237, 255]
N: 🤸🏼‍♂ [9468, 97, 116, 9468, 237, 120, 102470, 17245, 224]

O: 🥷🏿 [9468, 98, 115, 9468, 237, 123]
N: 🥷🏿 [9468, 98, 115, 9468, 237, 123]

O: 🏃🏼 [9468, 237, 225, 9468, 237, 120]
N: 🙆🏾 [9468, 247, 228, 9468, 237, 122]

O: 🔣 [9468, 242, 96]
N: 🇳🇪 [9468, 229, 111, 9468, 229, 103]

O: 👩🏻‍🦳 [9468, 239, 102, 9468, 237, 119, 102470, 9468, 99, 111]
N: 👩🏻‍🦳 [9468, 239, 102, 9468, 237, 119, 102470, 9468, 99, 111]

O: 🇳🇪 [9468, 229, 111, 9468, 229, 103]
N: 📡 [9468, 241, 94]

O: 🙆🏾 [9468, 247, 228, 9468, 237, 122]
N: 🏃🏼 [9468, 237, 225, 9468, 237, 120]

O: 📡 [9468, 241, 94]
N: 👨🏾‍🏭 [9468, 239, 101, 9468, 237, 122, 102470, 9468, 237, 255]

O: 🧋 [9468, 100, 233]
N: 🧋 [9468, 100, 233]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:05<00:15,  5.09s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.70s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.21s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.00s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.57s/it]
Processing depth (0, 2, 3, 4):   3%|▎         | 3/100 [01:18<33:45, 20.88s/it]2025-01-22 04:48:55.547 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the football.
2025-01-22 04:48:55.591 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the office.
2025-01-22 04:48:55.603 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1798, 1803) -->  Mary travelled to the office
2025-01-22 04:48:55.604 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the hallway.
2025-01-22 04:48:55.622 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2937, 2943) --> . Mary journeyed to the
2025-01-22 04:48:55.622 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the kitchen.
2025-01-22 04:48:55.640 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3630, 3635) --> . John went to the
2025-01-22 04:48:55.640 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel travelled to the garden.
2025-01-22 04:48:55.648 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1230, 1235) -->  Republican. Daniel travelled to
2025-01-22 04:48:55.648 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John moved to the office.
2025-01-22 04:48:55.667 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3554, 3559) --> . John moved to the
2025-01-22 04:48:55.668 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went to the garden.
2025-01-22 04:48:55.681 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2038, 2043) -->  cable. Sandra went to
2025-01-22 04:48:55.681 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra picked up the milk.
2025-01-22 04:48:55.717 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6468, 6473) --> . Sandra picked up the
2025-01-22 04:48:55.717 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel journeyed to the office.
2025-01-22 04:48:55.723 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1105, 1111) -->  Daniel journeyed to the office
2025-01-22 04:48:55.724 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 04:48:55.724 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 04:48:55.724 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 04:48:55.724 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['👏', '😼', '🤱🏿', '💌', '🏃🏿\u200d♀️', '🇳🇵', '🤾🏿', '🤽\u200d♂️', '👩\u200d🔧', '🧒']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.66s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.81s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.66s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.25s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.78s/it]
Processing depth (4, 6, 8, 9):   3%|▎         | 3/100 [01:35<33:45, 20.88s/it]2025-01-22 04:49:12.674 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the football.
2025-01-22 04:49:12.695 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3619, 3623) -->  Mary got the football
2025-01-22 04:49:12.696 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the office.
2025-01-22 04:49:12.722 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4755, 4760) -->  the senate. Mary travelled
2025-01-22 04:49:12.723 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the hallway.
2025-01-22 04:49:12.760 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6497, 6503) --> . Mary journeyed to the
2025-01-22 04:49:12.760 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the kitchen.
2025-01-22 04:49:12.800 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7194, 7199) --> . John went to the
2025-01-22 04:49:12.800 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel travelled to the garden.
2025-01-22 04:49:12.806 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1266, 1271) --> . Daniel travelled to the
2025-01-22 04:49:12.807 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John moved to the office.
2025-01-22 04:49:12.824 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3538, 3543) --> . John moved to the
2025-01-22 04:49:12.824 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went to the garden.
2025-01-22 04:49:12.835 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2182, 2187) --> . Sandra went to the
2025-01-22 04:49:12.835 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra picked up the milk.
2025-01-22 04:49:12.869 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6410, 6415) -->  Sandra picked up the milk
2025-01-22 04:49:12.869 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel journeyed to the office.
2025-01-22 04:49:12.876 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1214, 1220) -->  Republican. Daniel journeyed to
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:49:13.626 | INFO     | test_jbb_embedding:begin_test:693 - Mary<|eot_id|>
2025-01-22 04:49:13.626 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8144])
2025-01-22 04:49:15.867 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [332.890625, 37.363552663884114, 254.8028846153846, 35.93590277777778, 35.35734953703704], 'topk_indices': array([8042, 8134,    3, 8032, 3620, 3618, 3623, 8139, 8127, 7997,   24,
         14, 8138, 8132, 3622, 8140, 7998, 8131, 8142,    0]), 'topk_tokens': [' location', ' hallway', '<|end_header_id|>', '.\n\n', ' got', '.', '.', '<|eot_id|>', ':', ' you', '\n\n', '\n', ':', ' before', ' football', '<|start_header_id|>', ' context', ' football', '<|end_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [893.875, 249.8875, 265.8333333333333, 47.575]}, 'weight': {'score': [22.368359375, 23.249106156395776, 22.67548076923077, 23.25312210648148, 29.341724537037038], 'topk_indices': array([3274, 3301, 3170, 3122, 7423, 7385, 1412, 1474, 4292, 4276, 5172,
       5111, 7144, 7088, 3483, 3457, 4907, 4959, 4930, 4882]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.611328125, 25.484375, 20.052083333333332, 18.6375]}, 'saliency': {'score': [2.1077545166015623, 0.20897772152360053, 1.4123159555288463, 0.2004268165870949, 0.2639821370442708], 'topk_indices': array([4762, 8032, 4759, 3543,   24, 8113, 3619, 8128, 7996, 7997, 8042,
       8126, 3620, 8137, 6503, 8132, 8134, 7998, 3622, 8131]), 'topk_tokens': [' office', '.\n\n', ' travelled', ' office', '\n\n', ' return', ' Mary', ' Where', ' provided', ' you', ' location', 'Question', ' got', 'Answer', ' hallway', ' before', ' hallway', ' context', ' football', ' football'], 'evidence_proportions': [6.154296875, 1.71728515625, 1.308837890625, 0.21968994140625]}}, 'pred_res': 'Mary<|eot_id|>', 'score': 0}
2025-01-22 04:49:15.873 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:49:15.874 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-38_pid-3_4-6-8-9.pkl | len: 3 |  size: 2.04 KB
Processing depth (4, 6, 8, 9):   4%|▍         | 4/100 [01:38<43:14, 27.03s/it]is_0k: False
your chose emoji: ['📞', '☄️', '🟨', '🤽\u200d♀️', '👍🏻', '🚵🏽\u200d♂', '🤝🏿', '🥋', '\U0001faf2🏻', '🙆🏼\u200d♀️']
emoji:
O: 📞 [9468, 241, 252]
N: 📞 [9468, 241, 252]

O: ☄️ [18107, 226, 31643]
N: 🥋 [9468, 98, 233]

O: 🟨 [9468, 253, 101]
N: 🚵🏽‍♂ [9468, 248, 113, 9468, 237, 121, 102470, 17245, 224]

O: 🤽‍♀️ [9468, 97, 121, 102470, 32990, 31643]
N: 🤽‍♀️ [9468, 97, 121, 102470, 32990, 31643]

O: 👍🏻 [9468, 239, 235, 9468, 237, 119]
N: 👍🏻 [9468, 239, 235, 9468, 237, 119]

O: 🚵🏽‍♂ [9468, 248, 113, 9468, 237, 121, 102470, 17245, 224]
N: 🟨 [9468, 253, 101]

O: 🤝🏿 [9468, 97, 251, 9468, 237, 123]
N: ☄️ [18107, 226, 31643]

O: 🥋 [9468, 98, 233]
N: 🫲🏻 [9468, 104, 110, 9468, 237, 119]

O: 🫲🏻 [9468, 104, 110, 9468, 237, 119]
N: 🤝🏿 [9468, 97, 251, 9468, 237, 123]

O: 🙆🏼‍♀️ [9468, 247, 228, 9468, 237, 120, 102470, 32990, 31643]
N: 🙆🏼‍♀️ [9468, 247, 228, 9468, 237, 120, 102470, 32990, 31643]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.34s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.59s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.54s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.17s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.66s/it]
Processing depth (1, 2, 3, 7):   4%|▍         | 4/100 [01:54<43:14, 27.03s/it]2025-01-22 04:49:32.199 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary got the football.
2025-01-22 04:49:32.203 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (776, 780) -->  Mary got the football
2025-01-22 04:49:32.203 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the office.
2025-01-22 04:49:32.212 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1805, 1810) --> . Mary travelled to the
2025-01-22 04:49:32.213 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the hallway.
2025-01-22 04:49:32.227 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2901, 2907) --> . Mary journeyed to the
2025-01-22 04:49:32.227 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the kitchen.
2025-01-22 04:49:32.258 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5660, 5665) --> . John went to the
2025-01-22 04:49:32.258 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel travelled to the garden.
2025-01-22 04:49:32.264 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1131, 1136) --> . Daniel travelled to the
2025-01-22 04:49:32.264 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John moved to the office.
2025-01-22 04:49:32.289 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3536, 3541) --> . John moved to the
2025-01-22 04:49:32.289 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went to the garden.
2025-01-22 04:49:32.301 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2046, 2051) -->  cable. Sandra went to
2025-01-22 04:49:32.301 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra picked up the milk.
2025-01-22 04:49:32.335 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6506, 6511) --> . Sandra picked up the
2025-01-22 04:49:32.335 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel journeyed to the office.
2025-01-22 04:49:32.340 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1068, 1074) --> . Daniel journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:49:33.149 | INFO     | test_jbb_embedding:begin_test:693 - Mary's house.<|eot_id|>
2025-01-22 04:49:33.149 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8208])
2025-01-22 04:49:35.441 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [432.315625, 47.286651187576126, 218.35697115384616, 45.79860515678589, 27.444722020348838], 'topk_indices': array([ 776, 8198, 8195, 8106,    3, 8196, 8061, 1707,   24, 8096, 8191,
       8201, 8206,  780, 8202,   14, 8062,  779, 8203,    0]), 'topk_tokens': [' Mary', ' hallway', ' football', ' location', '<|end_header_id|>', ' before', ' you', ',', '\n\n', '.\n\n', ':', 'Answer', '<|end_header_id|>', '.', ':', '\n', ' context', ' football', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [1305.0, 331.45, 255.625, 47.0625]}, 'weight': {'score': [21.186328125, 23.29624314859927, 21.719651442307693, 23.306432967907888, 29.324672965116278], 'topk_indices': array([3318, 3345, 3238, 3190, 7461, 7499, 1441, 1503, 4319, 4303, 5144,
       5205, 7238, 7182, 3527, 3501, 4969, 4921, 4998, 4946]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.611328125, 20.75625, 20.052083333333332, 18.6375]}, 'saliency': {'score': [2.717681884765625, 0.2613624414776188, 1.22381591796875, 0.25227986195109625, 0.1968027159225109], 'topk_indices': array([8202, 8060,   24, 8200, 1696, 8192, 1621, 8096, 8061, 2907,  777,
       8196, 8106, 8190,  776, 8195, 8198, 8201, 8062,  779]), 'topk_tokens': [':', ' provided', '\n\n', ' \n', ' more', ' Where', 'pay', '.\n\n', ' you', ' hallway', ' got', ' before', ' location', 'Question', ' Mary', ' football', ' hallway', 'Answer', ' context', ' football'], 'evidence_proportions': [9.14013671875, 1.82333984375, 1.2361653645833333, 0.2518798828125]}}, 'pred_res': "Mary's house.<|eot_id|>", 'score': 0}
2025-01-22 04:49:35.448 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:49:35.449 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-38_pid-4_1-2-3-7.pkl | len: 3 |  size: 2.01 KB
Processing depth (1, 2, 3, 7):   5%|▌         | 5/100 [01:58<38:32, 24.34s/it]Processing depth (1, 2, 3, 7):   5%|▌         | 5/100 [01:58<37:26, 23.64s/it]
2025-01-22 04:49:35.541 | INFO     | __main__:<module>:82 - Selected idx: 39
2025-01-22 04:49:35.541 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the location prior to the place where the football was discarded, left or dropped?
2025-01-22 04:49:35.541 | INFO     | __main__:<module>:84 - Answer: office
2025-01-22 04:49:35.541 | INFO     | __main__:<module>:85 - Tag: 4-hop
2025-01-22 04:49:35.541 | INFO     | __main__:<module>:86 - Needle: [' Mary travelled to the office.', ' John moved to the office.', ' Daniel journeyed to the office.', ' Mary got the football.', ' Sandra went to the garden.', ' Daniel travelled to the garden.', ' Mary journeyed to the hallway.', ' Sandra picked up the milk.', ' Mary discarded the football.', ' John went to the kitchen.']
2025-01-22 04:49:35.541 | INFO     | __main__:<module>:87 - Real Needle: [' Mary travelled to the office.', ' Mary got the football.', ' Mary journeyed to the hallway.', ' Mary discarded the football.', ' John went to the kitchen.']
2025-01-22 04:49:35.541 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['👩🏼\u200d❤\u200d💋\u200d👨🏼', '🇿🇲', '\U0001faf8🏽', '🇧🇳', '⏮', '🧑🏿\u200d❤️\u200d💋\u200d🧑🏾', '👮🏼\u200d♀️', '🧑🏽\u200d🎨', '👂🏾', '🦚']
emoji:
O: 👩🏼‍❤‍💋‍👨🏼 [9468, 239, 102, 9468, 237, 120, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 120]
N: 🇿🇲 [9468, 229, 123, 9468, 229, 110]

O: 🇿🇲 [9468, 229, 123, 9468, 229, 110]
N: 🇧🇳 [9468, 229, 100, 9468, 229, 111]

O: 🫸🏽 [9468, 104, 116, 9468, 237, 121]
N: 👂🏾 [9468, 239, 224, 9468, 237, 122]

O: 🇧🇳 [9468, 229, 100, 9468, 229, 111]
N: 🧑🏽‍🎨 [9468, 100, 239, 9468, 237, 121, 102470, 9468, 236, 101]

O: ⏮ [158, 237, 106]
N: 👮🏼‍♀️ [9468, 239, 106, 9468, 237, 120, 102470, 32990, 31643]

O: 🧑🏿‍❤️‍💋‍🧑🏾 [9468, 100, 239, 9468, 237, 123, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 100, 239, 9468, 237, 122]
N: 🫸🏽 [9468, 104, 116, 9468, 237, 121]

O: 👮🏼‍♀️ [9468, 239, 106, 9468, 237, 120, 102470, 32990, 31643]
N: 🧑🏿‍❤️‍💋‍🧑🏾 [9468, 100, 239, 9468, 237, 123, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 100, 239, 9468, 237, 122]

O: 🧑🏽‍🎨 [9468, 100, 239, 9468, 237, 121, 102470, 9468, 236, 101]
N: 👩🏼‍❤‍💋‍👨🏼 [9468, 239, 102, 9468, 237, 120, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 120]

O: 👂🏾 [9468, 239, 224, 9468, 237, 122]
N: ⏮ [158, 237, 106]

O: 🦚 [9468, 99, 248]
N: 🦚 [9468, 99, 248]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:11,  3.75s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:10,  5.00s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:05,  5.02s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.43s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.92s/it]
Processing depth (0, 5, 6, 8, 9):   0%|          | 0/100 [00:17<?, ?it/s]2025-01-22 04:49:52.935 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the office.
2025-01-22 04:49:52.936 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  travelled to the office.
2025-01-22 04:49:52.936 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary got the football.
2025-01-22 04:49:52.958 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4177, 4181) -->  Mary got the football
2025-01-22 04:49:52.958 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the hallway.
2025-01-22 04:49:52.986 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4661, 4667) --> . Mary journeyed to the
2025-01-22 04:49:52.986 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary discarded the football.
2025-01-22 04:49:53.018 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6547, 6551) -->  Mary discarded the football
2025-01-22 04:49:53.018 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went to the kitchen.
2025-01-22 04:49:53.054 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7241, 7246) --> . John went to the
2025-01-22 04:49:53.054 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John moved to the office.
2025-01-22 04:49:53.056 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (315, 320) --> . John moved to the
2025-01-22 04:49:53.056 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the office.
2025-01-22 04:49:53.062 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (925, 931) --> . Daniel journeyed to the
2025-01-22 04:49:53.062 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went to the garden.
2025-01-22 04:49:53.066 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (613, 618) --> . Sandra went to the
2025-01-22 04:49:53.066 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel travelled to the garden.
2025-01-22 04:49:53.073 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1132, 1137) --> . Daniel travelled to the
2025-01-22 04:49:53.073 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra picked up the milk.
2025-01-22 04:49:53.084 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (2063, 2068) -->  cable. Sandra picked up
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:49:53.967 | INFO     | test_jbb_embedding:begin_test:693 - Mary got the football.<|eot_id|>
2025-01-22 04:49:53.967 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8218])
2025-01-22 04:49:56.208 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [410.4947916666667, 73.972924270073, 253.51802884615384, 72.41298577111382, 50.30152529761905], 'topk_indices': array([5966, 5889, 6017, 5970, 8107, 6024, 6101, 6106, 5881, 6025, 5972,
       6107, 6102, 8213, 5971, 5973, 6108,    0, 8214, 6109]), 'topk_tokens': [' people', '-day', 'this', ' on', ' location', ' true', ' by', ' meet', ' time', ' to', 'the', ' on', ' the', '<|eot_id|>', '\n', ' way', '\n', '<|begin_of_text|>', '<|start_header_id|>', 'the'], 'evidence_proportions': [578.0, 598.375, 334.0416666666667, 538.5, 82.025]}, 'weight': {'score': [22.3828125, 23.29539993917275, 21.719651442307693, 23.303095356487148, 29.464471726190474], 'topk_indices': array([3334, 3361, 3254, 3206, 7458, 7420, 1526, 1464, 4346, 4330, 5166,
       5227, 7135, 7191, 3517, 3543, 5020, 4943, 4968, 4991]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.14375, 26.611328125, 20.052083333333332, 29.130859375, 18.6375]}, 'saliency': {'score': [2.4734039306640625, 0.4101572598274027, 1.4054706280048077, 0.400928854971504, 0.3720227196103051], 'topk_indices': array([6000, 4667, 5971,  117, 4991, 8205, 6100, 6107, 5966, 5881, 5889,
       1015, 6017, 6108, 8107, 5972, 6024, 6106, 5973, 6109]), 'topk_tokens': [' *\n\n', ' hallway', '\n', 'ION', ' veto', ' discarded', ' asked', ' on', ' people', ' time', '-day', ' election', 'this', '\n', ' location', 'the', ' true', ' meet', ' way', 'the'], 'evidence_proportions': [2.96474609375, 4.038330078125, 1.77490234375, 3.956298828125, 0.3820068359375]}}, 'pred_res': 'Mary got the football.<|eot_id|>', 'score': 0}
2025-01-22 04:49:56.216 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:49:56.216 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-39_pid-0_0-5-6-8-9.pkl | len: 3 |  size: 2.04 KB
Processing depth (0, 5, 6, 8, 9):   1%|          | 1/100 [00:20<33:55, 20.57s/it]is_0k: False
your chose emoji: ['👩🏾\u200d❤\u200d💋\u200d👩🏽', '🧝🏼', '🤹🏼', '🙍🏻', '⚽', '👨🏿\u200d⚖️', '🙎🏽\u200d♂', '🧗🏻\u200d♂️', '🏊🏿\u200d♀️', '🤞🏼']
emoji:
O: 👩🏾‍❤‍💋‍👩🏽 [9468, 239, 102, 9468, 237, 122, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 121]
N: 🙍🏻 [9468, 247, 235, 9468, 237, 119]

O: 🧝🏼 [9468, 100, 251, 9468, 237, 120]
N: 👨🏿‍⚖️ [9468, 239, 101, 9468, 237, 123, 102470, 158, 248, 244, 31643]

O: 🤹🏼 [9468, 97, 117, 9468, 237, 120]
N: ⚽ [158, 248, 121]

O: 🙍🏻 [9468, 247, 235, 9468, 237, 119]
N: 🧗🏻‍♂️ [9468, 100, 245, 9468, 237, 119, 102470, 17245, 224, 31643]

O: ⚽ [158, 248, 121]
N: 🤹🏼 [9468, 97, 117, 9468, 237, 120]

O: 👨🏿‍⚖️ [9468, 239, 101, 9468, 237, 123, 102470, 158, 248, 244, 31643]
N: 🧝🏼 [9468, 100, 251, 9468, 237, 120]

O: 🙎🏽‍♂ [9468, 247, 236, 9468, 237, 121, 102470, 17245, 224]
N: 🏊🏿‍♀️ [9468, 237, 232, 9468, 237, 123, 102470, 32990, 31643]

O: 🧗🏻‍♂️ [9468, 100, 245, 9468, 237, 119, 102470, 17245, 224, 31643]
N: 🙎🏽‍♂ [9468, 247, 236, 9468, 237, 121, 102470, 17245, 224]

O: 🏊🏿‍♀️ [9468, 237, 232, 9468, 237, 123, 102470, 32990, 31643]
N: 👩🏾‍❤‍💋‍👩🏽 [9468, 239, 102, 9468, 237, 122, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 121]

O: 🤞🏼 [9468, 97, 252, 9468, 237, 120]
N: 🤞🏼 [9468, 97, 252, 9468, 237, 120]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:11,  3.91s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.45s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.69s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.27s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.70s/it]
Processing depth (2, 4, 5, 6, 9):   1%|          | 1/100 [00:36<33:55, 20.57s/it]2025-01-22 04:50:12.672 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the office.
2025-01-22 04:50:12.693 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2023, 2028) -->  cable. Mary travelled to
2025-01-22 04:50:12.693 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary got the football.
2025-01-22 04:50:12.711 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3637, 3641) -->  Mary got the football
2025-01-22 04:50:12.711 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the hallway.
2025-01-22 04:50:12.732 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4224, 4230) -->  Mary journeyed to the hallway
2025-01-22 04:50:12.732 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary discarded the football.
2025-01-22 04:50:12.758 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4865, 4869) -->  Mary discarded the football
2025-01-22 04:50:12.758 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went to the kitchen.
2025-01-22 04:50:12.796 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7247, 7252) --> . John went to the
2025-01-22 04:50:12.796 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John moved to the office.
2025-01-22 04:50:12.798 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (355, 360) --> . John moved to the
2025-01-22 04:50:12.798 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the office.
2025-01-22 04:50:12.803 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (971, 977) --> . Daniel journeyed to the
2025-01-22 04:50:12.803 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went to the garden.
2025-01-22 04:50:12.806 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (631, 636) --> . Sandra went to the
2025-01-22 04:50:12.806 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel travelled to the garden.
2025-01-22 04:50:12.812 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1233, 1238) -->  Republican. Daniel travelled to
2025-01-22 04:50:12.812 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra picked up the milk.
2025-01-22 04:50:12.823 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (2200, 2205) --> . Sandra picked up the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:50:13.736 | INFO     | test_jbb_embedding:begin_test:693 - Mary journeyed to the hallway.<|eot_id|>
2025-01-22 04:50:13.737 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8202])
2025-01-22 04:50:16.005 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [451.88671875, 50.95033672598732, 330.9639423076923, 48.87738763183714, 27.830283717105264], 'topk_indices': array([8184, 8187, 2029, 8183, 8090, 3640, 8089,    9, 8120, 8081, 8186,
         24, 8182,   14, 8121, 4229, 8091,    0, 8197, 8198]), 'topk_tokens': [' place', ' football', ' office', ' the', ' first', ' football', ' the', ':', ' to', '.\n\n', ' the', '\n\n', ' to', '\n', ' the', ' hallway', ' location', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [480.125, 650.4375, 533.0625, 551.4375, 87.75625]}, 'weight': {'score': [24.702473958333332, 23.28079100134081, 21.80018028846154, 23.281327607615893, 29.33120888157895], 'topk_indices': array([3274, 3301, 3194, 3146, 7446, 7484, 1486, 1424, 4293, 4277, 5125,
       5186, 7141, 7197, 3457, 3483, 4915, 4967, 4938, 4890]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [25.1828125, 26.611328125, 25.131510416666668, 29.130859375, 18.6375]}, 'saliency': {'score': [3.1243693033854165, 0.2793702005119454, 1.8140211838942308, 0.26610298147381656, 0.2045147544459293], 'topk_indices': array([8081, 8177, 1989, 8119, 8185, 2026, 8047, 8175, 4868, 8184, 8195,
       8090, 4866, 8189, 2029, 8181, 8187, 3640, 4229, 8091]), 'topk_tokens': ['.\n\n', ' Where', ' arrival', ' moved', ' where', ' travelled', ' context', 'Question', ' football', ' place', 'Answer', ' first', ' discarded', ' discarded', ' office', ' prior', ' football', ' football', ' hallway', ' location'], 'evidence_proportions': [2.92626953125, 4.521240234375, 3.8387044270833335, 4.290283203125, 0.4150390625]}}, 'pred_res': 'Mary journeyed to the hallway.<|eot_id|>', 'score': 0}
2025-01-22 04:50:16.012 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:50:16.012 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-39_pid-1_2-4-5-6-9.pkl | len: 3 |  size: 2.12 KB
Processing depth (2, 4, 5, 6, 9):   2%|▏         | 2/100 [00:40<32:51, 20.11s/it]is_0k: False
your chose emoji: ['🐋', '🙎🏿', '👩🏼\u200d🏭', '👨\u200d🦯\u200d➡', '👨🏿\u200d🎤', '🚶\u200d♀️', '👩🏻\u200d❤\u200d👩🏾', '👨🏻\u200d🍳', '📅', '🎏']
emoji:
O: 🐋 [9468, 238, 233]
N: 🐋 [9468, 238, 233]

O: 🙎🏿 [9468, 247, 236, 9468, 237, 123]
N: 📅 [9468, 241, 227]

O: 👩🏼‍🏭 [9468, 239, 102, 9468, 237, 120, 102470, 9468, 237, 255]
N: 🚶‍♀️ [9468, 248, 114, 102470, 32990, 31643]

O: 👨‍🦯‍➡ [9468, 239, 101, 102470, 9468, 99, 107, 102470, 98115, 94]
N: 👩🏼‍🏭 [9468, 239, 102, 9468, 237, 120, 102470, 9468, 237, 255]

O: 👨🏿‍🎤 [9468, 239, 101, 9468, 237, 123, 102470, 9468, 236, 97]
N: 🙎🏿 [9468, 247, 236, 9468, 237, 123]

O: 🚶‍♀️ [9468, 248, 114, 102470, 32990, 31643]
N: 👨‍🦯‍➡ [9468, 239, 101, 102470, 9468, 99, 107, 102470, 98115, 94]

O: 👩🏻‍❤‍👩🏾 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 102470, 9468, 239, 102, 9468, 237, 122]
N: 👩🏻‍❤‍👩🏾 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 102470, 9468, 239, 102, 9468, 237, 122]

O: 👨🏻‍🍳 [9468, 239, 101, 9468, 237, 119, 102470, 9468, 235, 111]
N: 👨🏿‍🎤 [9468, 239, 101, 9468, 237, 123, 102470, 9468, 236, 97]

O: 📅 [9468, 241, 227]
N: 👨🏻‍🍳 [9468, 239, 101, 9468, 237, 119, 102470, 9468, 235, 111]

O: 🎏 [9468, 236, 237]
N: 🎏 [9468, 236, 237]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:11,  3.79s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.27s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:11<00:03,  3.95s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  2.55s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  3.10s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (1, 4, 5, 6, 8):   2%|▏         | 2/100 [00:54<32:51, 20.11s/it]2025-01-22 04:50:30.169 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the office.
2025-01-22 04:50:30.173 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (841, 846) --> . Mary travelled to the
2025-01-22 04:50:30.173 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary got the football.
2025-01-22 04:50:30.191 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3623, 3627) -->  Mary got the football
2025-01-22 04:50:30.191 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the hallway.
2025-01-22 04:50:30.211 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4159, 4165) --> . Mary journeyed to the
2025-01-22 04:50:30.212 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary discarded the football.
2025-01-22 04:50:30.237 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4773, 4777) -->  Mary discarded the football
2025-01-22 04:50:30.237 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went to the kitchen.
2025-01-22 04:50:30.275 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6611, 6616) --> . John went to the
2025-01-22 04:50:30.275 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John moved to the office.
2025-01-22 04:50:30.277 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (318, 323) -->  John moved to the office
2025-01-22 04:50:30.277 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the office.
2025-01-22 04:50:30.282 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (933, 939) --> . Daniel journeyed to the
2025-01-22 04:50:30.282 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went to the garden.
2025-01-22 04:50:30.285 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (615, 620) --> . Sandra went to the
2025-01-22 04:50:30.285 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel travelled to the garden.
2025-01-22 04:50:30.291 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1140, 1145) --> . Daniel travelled to the
2025-01-22 04:50:30.291 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra picked up the milk.
2025-01-22 04:50:30.300 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1904, 1909) --> . Sandra picked up the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:50:37.878 | INFO     | test_jbb_embedding:begin_test:693 - Mary journeyed to the hallway.<|eot_id|>
2025-01-22 04:50:37.878 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8192])
2025-01-22 04:50:41.100 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [344.7734375, 43.49497345618745, 225.86298076923077, 42.024903303045186, 32.61069542253521], 'topk_indices': array([8185,  846, 8180, 8181, 8182, 8165, 8171, 8177, 8172,   23, 8166,
       8071,    9,   14, 8081, 4165,   24, 8187,    0, 8188]), 'topk_tokens': ['Answer', ' office', ',', ' left', ' or', 'Question', ' prior', ' football', ' to', '4', ':', '.\n\n', ':', '\n', ' location', ' hallway', '\n\n', '<|eot_id|>', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [464.6, 488.125, 304.6666666666667, 420.40625, 97.8875]}, 'weight': {'score': [22.510416666666668, 23.270640102514033, 21.64032451923077, 23.278085285179273, 29.171654929577464], 'topk_indices': array([3333, 3306, 3226, 3178, 7402, 7440, 1456, 1518, 4303, 4319, 5212,
       5151, 7123, 7179, 3489, 3515, 4973, 4944, 4921, 4896]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.75625, 26.611328125, 20.052083333333332, 29.130859375, 18.6375]}, 'saliency': {'score': [2.1407012939453125, 0.24315726922900904, 1.3067251352163463, 0.23416981575296997, 0.24630586865922094], 'topk_indices': array([4776,    0,   23, 8037, 8071, 8174, 8167,  843, 4774,  846,   24,
       8181, 3626, 8179, 8185, 8171, 8177, 8165, 8081, 4165]), 'topk_tokens': [' football', '<|begin_of_text|>', '4', ' context', '.\n\n', ' place', ' Where', ' travelled', ' discarded', ' office', '\n\n', ' left', ' football', ' discarded', 'Answer', ' prior', ' football', 'Question', ' location', ' hallway'], 'evidence_proportions': [2.603125, 3.3408203125, 1.551025390625, 3.276611328125, 0.5170654296875]}}, 'pred_res': 'Mary journeyed to the hallway.<|eot_id|>', 'score': 0}
2025-01-22 04:50:41.119 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:50:41.119 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-39_pid-2_1-4-5-6-8.pkl | len: 3 |  size: 2.1 KB
Processing depth (1, 4, 5, 6, 8):   3%|▎         | 3/100 [01:05<36:12, 22.39s/it]is_0k: False
your chose emoji: ['🌞', '🚱', '👨🏼\u200d🦽\u200d➡️', '🤜🏿', '🏃🏿\u200d♂️', '👳🏽\u200d♂️', '🧣', '🚶🏿', '👩🏼\u200d🔬', '🕴🏾']
emoji:
O: 🌞 [9468, 234, 252]
N: 🏃🏿‍♂️ [9468, 237, 225, 9468, 237, 123, 102470, 17245, 224, 31643]

O: 🚱 [9468, 248, 109]
N: 🌞 [9468, 234, 252]

O: 👨🏼‍🦽‍➡️ [9468, 239, 101, 9468, 237, 120, 102470, 9468, 99, 121, 102470, 98115, 94, 31643]
N: 🤜🏿 [9468, 97, 250, 9468, 237, 123]

O: 🤜🏿 [9468, 97, 250, 9468, 237, 123]
N: 🧣 [9468, 100, 96]

O: 🏃🏿‍♂️ [9468, 237, 225, 9468, 237, 123, 102470, 17245, 224, 31643]
N: 🚱 [9468, 248, 109]

O: 👳🏽‍♂️ [9468, 239, 111, 9468, 237, 121, 102470, 17245, 224, 31643]
N: 🚶🏿 [9468, 248, 114, 9468, 237, 123]

O: 🧣 [9468, 100, 96]
N: 👩🏼‍🔬 [9468, 239, 102, 9468, 237, 120, 102470, 9468, 242, 105]

O: 🚶🏿 [9468, 248, 114, 9468, 237, 123]
N: 👳🏽‍♂️ [9468, 239, 111, 9468, 237, 121, 102470, 17245, 224, 31643]

O: 👩🏼‍🔬 [9468, 239, 102, 9468, 237, 120, 102470, 9468, 242, 105]
N: 👨🏼‍🦽‍➡️ [9468, 239, 101, 9468, 237, 120, 102470, 9468, 99, 121, 102470, 98115, 94, 31643]

O: 🕴🏾 [9468, 243, 112, 9468, 237, 122]
N: 🕴🏾 [9468, 243, 112, 9468, 237, 122]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.05s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.29s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.33s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.02s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.48s/it]
Processing depth (0, 6, 7, 8, 9):   3%|▎         | 3/100 [01:21<36:12, 22.39s/it]2025-01-22 04:50:56.840 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the office.
2025-01-22 04:50:56.841 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  travelled to the office.
2025-01-22 04:50:56.841 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary got the football.
2025-01-22 04:50:56.867 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4753, 4757) -->  Mary got the football
2025-01-22 04:50:56.867 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the hallway.
2025-01-22 04:50:56.897 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5619, 5625) --> . Mary journeyed to the
2025-01-22 04:50:56.897 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary discarded the football.
2025-01-22 04:50:56.931 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6519, 6523) -->  Mary discarded the football
2025-01-22 04:50:56.931 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went to the kitchen.
2025-01-22 04:50:56.967 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7108, 7113) -->  John went to the kitchen
2025-01-22 04:50:56.967 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John moved to the office.
2025-01-22 04:50:56.969 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (361, 366) --> . John moved to the
2025-01-22 04:50:56.969 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the office.
2025-01-22 04:50:56.973 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (929, 935) --> . Daniel journeyed to the
2025-01-22 04:50:56.973 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went to the garden.
2025-01-22 04:50:56.977 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (637, 642) --> . Sandra went to the
2025-01-22 04:50:56.977 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel travelled to the garden.
2025-01-22 04:50:56.982 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1136, 1141) --> . Daniel travelled to the
2025-01-22 04:50:56.982 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra picked up the milk.
2025-01-22 04:50:56.994 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (2142, 2147) --> . Sandra picked up the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:50:57.818 | INFO     | test_jbb_embedding:begin_test:693 - Mary's home.<|eot_id|>
2025-01-22 04:50:57.818 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8154])
2025-01-22 04:51:00.043 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [383.8802083333333, 51.16832699852869, 266.75721153846155, 49.49174222797927, 36.90902944711539], 'topk_indices': array([6605, 8059, 4756, 5625, 8055,   23, 8071, 8042,   14, 8041, 8033,
       8040,   24, 8072, 8056, 8043, 8073, 8149,    0, 8150]), 'topk_tokens': [' ', '.\n', ' football', ' hallway', ' in', '4', ' moved', ' first', '\n', ' the', '.\n\n', ' in', '\n\n', ' to', ' the', ' location', ' the', '<|eot_id|>', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [482.9, 525.6875, 351.2916666666667, 499.125, 118.325]}, 'weight': {'score': [23.380533854166668, 23.255038468612064, 20.868389423076923, 23.26232208395016, 30.095552884615383], 'topk_indices': array([3313, 3286, 3198, 3150, 7398, 7436, 1508, 1446, 4293, 4277, 5099,
       5160, 7175, 7119, 3501, 3475, 4876, 4901, 4924, 4953]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.14375, 26.611328125, 20.052083333333332, 29.130859375, 23.4265625]}, 'saliency': {'score': [2.4074605305989585, 0.28280632164970576, 1.4570406400240385, 0.27274935233160624, 0.2729914738581731], 'topk_indices': array([  23, 8039, 7999, 8073, 8040,   38, 8147, 8141, 8033, 8127,   24,
       6520, 8139, 8133, 8042,    0, 4756, 8071, 5625, 8043]), 'topk_tokens': ['4', ' item', ' context', ' the', ' in', '***', 'Answer', ' discarded', '.\n\n', 'Question', '\n\n', ' discarded', ' football', ' prior', ' first', '<|begin_of_text|>', ' football', ' moved', ' hallway', ' location'], 'evidence_proportions': [2.469140625, 3.662841796875, 1.93212890625, 3.857421875, 0.751904296875]}}, 'pred_res': "Mary's home.<|eot_id|>", 'score': 0}
2025-01-22 04:51:00.050 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:51:00.050 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-39_pid-3_0-6-7-8-9.pkl | len: 3 |  size: 2.07 KB
Processing depth (0, 6, 7, 8, 9):   4%|▍         | 4/100 [01:24<33:38, 21.03s/it]is_0k: False
your chose emoji: ['👽', '♀️', '🤽🏼\u200d♀', '🧎🏾\u200d♂️\u200d➡️', '🪶', '🗑️', '🚶🏽\u200d♀️', '🔴', '☃️', '🔨']
emoji:
O: 👽 [9468, 239, 121]
N: 🤽🏼‍♀ [9468, 97, 121, 9468, 237, 120, 102470, 32990]

O: ♀️ [32990, 31643]
N: 🗑️ [9468, 245, 239, 31643]

O: 🤽🏼‍♀ [9468, 97, 121, 9468, 237, 120, 102470, 32990]
N: 🔴 [9468, 242, 112]

O: 🧎🏾‍♂️‍➡️ [9468, 100, 236, 9468, 237, 122, 102470, 17245, 224, 31643, 102470, 98115, 94, 31643]
N: ☃️ [18107, 225, 31643]

O: 🪶 [9468, 103, 114]
N: 🪶 [9468, 103, 114]

O: 🗑️ [9468, 245, 239, 31643]
N: ♀️ [32990, 31643]

O: 🚶🏽‍♀️ [9468, 248, 114, 9468, 237, 121, 102470, 32990, 31643]
N: 🚶🏽‍♀️ [9468, 248, 114, 9468, 237, 121, 102470, 32990, 31643]

O: 🔴 [9468, 242, 112]
N: 🧎🏾‍♂️‍➡️ [9468, 100, 236, 9468, 237, 122, 102470, 17245, 224, 31643, 102470, 98115, 94, 31643]

O: ☃️ [18107, 225, 31643]
N: 👽 [9468, 239, 121]

O: 🔨 [9468, 242, 101]
N: 🔨 [9468, 242, 101]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.71s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.98s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.91s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.36s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.92s/it]
Processing depth (0, 2, 4, 7, 8):   4%|▍         | 4/100 [01:41<33:38, 21.03s/it]2025-01-22 04:51:17.497 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the office.
2025-01-22 04:51:17.498 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  travelled to the office.
2025-01-22 04:51:17.498 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary got the football.
2025-01-22 04:51:17.508 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1595, 1599) -->  Mary got the football
2025-01-22 04:51:17.508 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the hallway.
2025-01-22 04:51:17.528 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3583, 3589) --> . Mary journeyed to the
2025-01-22 04:51:17.528 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary discarded the football.
2025-01-22 04:51:17.555 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5497, 5501) -->  Mary discarded the football
2025-01-22 04:51:17.555 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went to the kitchen.
2025-01-22 04:51:17.603 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6523, 6528) --> . John went to the
2025-01-22 04:51:17.603 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John moved to the office.
2025-01-22 04:51:17.605 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (282, 287) -->  John moved to the office
2025-01-22 04:51:17.605 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the office.
2025-01-22 04:51:17.609 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (800, 806) -->  Daniel journeyed to the office
2025-01-22 04:51:17.609 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went to the garden.
2025-01-22 04:51:17.611 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (391, 396) --> . Sandra went to the
2025-01-22 04:51:17.612 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel travelled to the garden.
2025-01-22 04:51:17.616 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (962, 967) --> . Daniel travelled to the
2025-01-22 04:51:17.617 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra picked up the milk.
2025-01-22 04:51:17.625 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1799, 1804) --> . Sandra picked up the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:51:18.495 | INFO     | test_jbb_embedding:begin_test:693 - Mary's location.<|eot_id|>
2025-01-22 04:51:18.495 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8204])
2025-01-22 04:51:20.774 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [412.875, 45.01612387277602, 343.7548076923077, 42.9813250980873, 43.49310064935065], 'topk_indices': array([  67, 8183, 8176, 1599, 1598, 8093, 8190,   68, 8178, 8083,  105,
       8184,   14,   23,  203, 8189,   24, 8199, 8200,    0]), 'topk_tokens': ['ION', ' prior', '.\n\n', '.', ' football', ' location', ' was', 'E', ':', '.\n\n', 'ION', ' to', '\n', '4', 'ION', ' football', '\n\n', '<|eot_id|>', '<|start_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [628.2, 579.0, 317.5625, 564.8125, 57.475]}, 'weight': {'score': [22.3828125, 23.281390902997806, 22.412259615384617, 23.286805725846, 29.278814935064936], 'topk_indices': array([3365, 3392, 3285, 3237, 7474, 7436, 1492, 1554, 4389, 4405, 5200,
       5261, 7157, 7213, 3574, 3548, 5002, 5025, 4977, 5054]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.14375, 26.611328125, 20.052083333333332, 29.130859375, 18.6375]}, 'saliency': {'score': [2.5545654296875, 0.2530043042057641, 1.9831824669471154, 0.24071616060070808, 0.31815011160714285], 'topk_indices': array([  68,   23, 8197,   39, 3589,   34,   67,   24, 5500, 8049,   31,
       8093,  105, 8177,  203, 5498, 8183, 8191, 1598, 8189]), 'topk_tokens': ['E', '4', 'Answer', '\n\n\n', ' hallway', ' office', 'ION', '\n\n', ' football', ' context', ' travelled', ' location', 'ION', 'Question', 'ION', ' discarded', ' prior', ' discarded', ' football', ' football'], 'evidence_proportions': [3.34140625, 3.9833984375, 1.6602376302083333, 4.347412109375, 0.26357421875]}}, 'pred_res': "Mary's location.<|eot_id|>", 'score': 0}
2025-01-22 04:51:20.782 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:51:20.782 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-39_pid-4_0-2-4-7-8.pkl | len: 3 |  size: 2.05 KB
Processing depth (0, 2, 4, 7, 8):   5%|▌         | 5/100 [01:45<33:07, 20.92s/it]Processing depth (0, 2, 4, 7, 8):   5%|▌         | 5/100 [01:45<33:18, 21.04s/it]
2025-01-22 04:51:20.840 | INFO     | __main__:<module>:82 - Selected idx: 40
2025-01-22 04:51:20.840 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the football before the office? 
2025-01-22 04:51:20.840 | INFO     | __main__:<module>:84 - Answer: kitchen
2025-01-22 04:51:20.841 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 04:51:20.841 | INFO     | __main__:<module>:86 - Needle: [' John travelled to the bathroom.', ' John went back to the garden.', ' John travelled to the kitchen.', ' Daniel moved to the kitchen.', ' Sandra went to the bathroom.', ' Daniel moved to the office.', ' Mary travelled to the bedroom.', ' Daniel left the football.', ' Sandra journeyed to the bedroom.']
2025-01-22 04:51:20.841 | INFO     | __main__:<module>:87 - Real Needle: [' Daniel moved to the kitchen.', ' Daniel moved to the office.', ' Daniel left the football.', ' Sandra journeyed to the bedroom.']
2025-01-22 04:51:20.841 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['🤽🏽\u200d♂️', '🧙🏻', '🐻', '🧎🏻', '🧑🏻\u200d🎤', '🤜', '👩🏾\u200d❤\u200d💋\u200d👨🏽', '🥸', '🤹🏻\u200d♂', '🧖🏼\u200d♂']
emoji:
O: 🤽🏽‍♂️ [9468, 97, 121, 9468, 237, 121, 102470, 17245, 224, 31643]
N: 🤹🏻‍♂ [9468, 97, 117, 9468, 237, 119, 102470, 17245, 224]

O: 🧙🏻 [9468, 100, 247, 9468, 237, 119]
N: 🐻 [9468, 238, 119]

O: 🐻 [9468, 238, 119]
N: 🤜 [9468, 97, 250]

O: 🧎🏻 [9468, 100, 236, 9468, 237, 119]
N: 🧎🏻 [9468, 100, 236, 9468, 237, 119]

O: 🧑🏻‍🎤 [9468, 100, 239, 9468, 237, 119, 102470, 9468, 236, 97]
N: 🧑🏻‍🎤 [9468, 100, 239, 9468, 237, 119, 102470, 9468, 236, 97]

O: 🤜 [9468, 97, 250]
N: 👩🏾‍❤‍💋‍👨🏽 [9468, 239, 102, 9468, 237, 122, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 121]

O: 👩🏾‍❤‍💋‍👨🏽 [9468, 239, 102, 9468, 237, 122, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 121]
N: 🥸 [9468, 98, 116]

O: 🥸 [9468, 98, 116]
N: 🤽🏽‍♂️ [9468, 97, 121, 9468, 237, 121, 102470, 17245, 224, 31643]

O: 🤹🏻‍♂ [9468, 97, 117, 9468, 237, 119, 102470, 17245, 224]
N: 🧙🏻 [9468, 100, 247, 9468, 237, 119]

O: 🧖🏼‍♂ [9468, 100, 244, 9468, 237, 120, 102470, 17245, 224]
N: 🧖🏼‍♂ [9468, 100, 244, 9468, 237, 120, 102470, 17245, 224]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:11,  3.75s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.41s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.32s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.79s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.32s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (1, 4, 5, 7):   0%|          | 0/100 [00:14<?, ?it/s]2025-01-22 04:51:35.895 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the kitchen.
2025-01-22 04:51:35.900 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (847, 852) --> . Daniel moved to the
2025-01-22 04:51:35.900 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the office.
2025-01-22 04:51:35.905 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (847, 852) --> . Daniel moved to the
2025-01-22 04:51:35.905 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel left the football.
2025-01-22 04:51:35.926 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4209, 4213) -->  Daniel left the football
2025-01-22 04:51:35.926 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra journeyed to the bedroom.
2025-01-22 04:51:35.959 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5665, 5671) --> . Sandra journeyed to the
2025-01-22 04:51:35.959 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the bathroom.
2025-01-22 04:51:35.990 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5487, 5492) --> . John travelled to the
2025-01-22 04:51:35.990 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the garden.
2025-01-22 04:51:36.012 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4173, 4179) --> . John went back to the
2025-01-22 04:51:36.012 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the kitchen.
2025-01-22 04:51:36.043 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5487, 5492) --> . John travelled to the
2025-01-22 04:51:36.043 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the bathroom.
2025-01-22 04:51:36.055 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2042, 2047) -->  cable. Sandra went to
2025-01-22 04:51:36.055 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary travelled to the bedroom.
2025-01-22 04:51:36.079 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4667, 4672) --> . Mary travelled to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:51:39.804 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 04:51:39.805 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8199])
2025-01-22 04:51:42.868 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [248.0890625, 18.504753032796877, 89.13341346153847, 17.716617750735654, 16.932783917682926], 'topk_indices': array([8198, 4211,    4, 8192, 8087, 8053, 8182,    1, 8097,    9,   24,
       8186, 8187, 8189,    3, 8197,   14, 4212,    0, 8194]), 'topk_tokens': ['\n\n', ' the', '\n\n', 'Answer', '.\n\n', ' context', ':', '<|start_header_id|>', ' location', ':', '\n\n', ' football', ' before', ' office', '<|end_header_id|>', '<|end_header_id|>', '\n', ' football', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [268.125, 268.125, 498.625, 47.671875]}, 'weight': {'score': [21.676953125, 23.297429361741038, 21.162560096153847, 23.308208680725848, 29.388147865853657], 'topk_indices': array([3380, 3353, 3273, 3225, 7436, 7474, 1505, 1443, 4354, 4370, 5191,
       5252, 7213, 7157, 3536, 3562, 4993, 4968, 5045, 5016]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.909375, 19.909375, 26.791015625, 21.213541666666668]}, 'saliency': {'score': [1.490081787109375, 0.10334818388188476, 0.5083359938401443, 0.09865662489175914, 0.11172448135003811], 'topk_indices': array([8087,    8,   14, 4209, 5815, 7543,   24, 4210, 7587,  849, 7588,
       8181,  852, 8053, 8187, 8192, 8097, 8186, 8189, 4212]), 'topk_tokens': ['.\n\n', ' Date', '\n', ' Daniel', ' kitchen', 'nes', '\n\n', ' left', ' Min', ' moved', 'nes', 'Question', ' kitchen', ' context', ' before', 'Answer', ' location', ' football', ' office', ' football'], 'evidence_proportions': [1.42490234375, 1.42490234375, 3.4658203125, 0.28155517578125]}}, 'pred_res': 'The garden.<|eot_id|>', 'score': 0}
2025-01-22 04:51:42.876 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:51:42.876 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-40_pid-0_1-4-5-7.pkl | len: 3 |  size: 2.03 KB
Processing depth (1, 4, 5, 7):   1%|          | 1/100 [00:21<36:12, 21.94s/it]is_0k: False
your chose emoji: ['©', '🏃🏾\u200d♂️', '👩🏾\u200d🎓', '🤚', '👩🏾\u200d🤝\u200d👩🏻', '💢', '🦹🏽\u200d♀️', '👨🏾\u200d❤️\u200d💋\u200d👨🏻', '🔝', '🕵🏻\u200d♀']
emoji:
O: © [20644]
N: 👨🏾‍❤️‍💋‍👨🏻 [9468, 239, 101, 9468, 237, 122, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 119]

O: 🏃🏾‍♂️ [9468, 237, 225, 9468, 237, 122, 102470, 17245, 224, 31643]
N: 👩🏾‍🤝‍👩🏻 [9468, 239, 102, 9468, 237, 122, 102470, 9468, 97, 251, 102470, 9468, 239, 102, 9468, 237, 119]

O: 👩🏾‍🎓 [9468, 239, 102, 9468, 237, 122, 102470, 9468, 236, 241]
N: 🏃🏾‍♂️ [9468, 237, 225, 9468, 237, 122, 102470, 17245, 224, 31643]

O: 🤚 [9468, 97, 248]
N: 🦹🏽‍♀️ [9468, 99, 117, 9468, 237, 121, 102470, 32990, 31643]

O: 👩🏾‍🤝‍👩🏻 [9468, 239, 102, 9468, 237, 122, 102470, 9468, 97, 251, 102470, 9468, 239, 102, 9468, 237, 119]
N: 🔝 [9468, 242, 251]

O: 💢 [93273, 95]
N: 💢 [93273, 95]

O: 🦹🏽‍♀️ [9468, 99, 117, 9468, 237, 121, 102470, 32990, 31643]
N: 👩🏾‍🎓 [9468, 239, 102, 9468, 237, 122, 102470, 9468, 236, 241]

O: 👨🏾‍❤️‍💋‍👨🏻 [9468, 239, 101, 9468, 237, 122, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 119]
N:  Married [65624]

O: 🔝 [9468, 242, 251]
N: �� This [97, 248, 1115]

O: 🕵🏻‍♀ [9468, 243, 113, 9468, 237, 119, 102470, 32990]
N: ��🏻‍♀
 [243, 113, 9468, 237, 119, 102470, 32990, 198]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.18s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.61s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.56s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.19s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.67s/it]
Processing depth (0, 4, 8, 9):   1%|          | 1/100 [00:38<36:12, 21.94s/it]2025-01-22 04:51:59.340 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the kitchen.
2025-01-22 04:51:59.340 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  moved to the kitchen.
2025-01-22 04:51:59.340 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the office.
2025-01-22 04:51:59.361 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3595, 3600) --> . Daniel moved to the
2025-01-22 04:51:59.361 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel left the football.
2025-01-22 04:51:59.395 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6599, 6603) -->  Daniel left the football
2025-01-22 04:51:59.396 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra journeyed to the bedroom.
2025-01-22 04:51:59.432 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7231, 7237) --> . Sandra journeyed to the
2025-01-22 04:51:59.432 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the bathroom.
2025-01-22 04:51:59.462 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5422, 5427) --> . John travelled to the
2025-01-22 04:51:59.462 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the garden.
2025-01-22 04:51:59.483 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4127, 4133) --> . John went back to the
2025-01-22 04:51:59.483 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the kitchen.
2025-01-22 04:51:59.509 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5422, 5427) --> . John travelled to the
2025-01-22 04:51:59.509 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the bathroom.
2025-01-22 04:51:59.519 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2016, 2021) -->  cable. Sandra went to
2025-01-22 04:51:59.519 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary travelled to the bedroom.
2025-01-22 04:51:59.543 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4610, 4615) --> . Mary travelled to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:52:00.332 | INFO     | test_jbb_embedding:begin_test:693 - The football.<|eot_id|>
2025-01-22 04:52:00.332 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8162])
2025-01-22 04:52:02.566 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [313.14375, 24.342731935088793, 117.54086538461539, 23.332857340805518, 13.72101314484127], 'topk_indices': array([   1,    9, 8057, 8076, 8016, 6600, 6599, 8088, 8050,   24, 6603,
       8160, 8060, 8080, 8089,   14, 8090, 8157, 6602,    0]), 'topk_tokens': ['<|start_header_id|>', ':', ' in', '.\n', ' context', ' left', ' Daniel', ' moved', '.\n\n', '\n\n', '.', '<|end_header_id|>', ' location', ' left', ' to', '\n', ' the', '<|eot_id|>', ' football', '<|begin_of_text|>'], 'evidence_proportions': [297.025, 264.05, 735.0, 86.25]}, 'weight': {'score': [21.651953125, 23.259420927740354, 21.162560096153847, 23.270095609065155, 29.09424603174603], 'topk_indices': array([3294, 3267, 3139, 3187, 7449, 7411, 1417, 1479, 4287, 4271, 5187,
       5126, 7125, 7181, 3462, 3488, 4939, 4968, 4916, 4891]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.809375, 19.909375, 26.791015625, 21.213541666666668]}, 'saliency': {'score': [1.927532958984375, 0.13490149456521738, 0.6643301156850961, 0.12879017870889273, 0.10061887710813493], 'topk_indices': array([8062,   14,    8,   34,   24, 8056, 8054, 8090, 8059, 4253, 8050,
       5743, 8149, 6600, 8016, 6599, 8088, 8080, 8060, 6602]), 'topk_tokens': [' traveled', '\n', ' Date', ' kitchen', '\n\n', ' item', ' obtained', ' the', ' first', 'nes', '.\n\n', ' kitchen', ' football', ' left', ' context', ' Daniel', ' moved', ' left', ' location', ' football'], 'evidence_proportions': [1.598974609375, 1.40185546875, 5.1708984375, 0.4771525065104167]}}, 'pred_res': 'The football.<|eot_id|>', 'score': 0}
2025-01-22 04:52:02.573 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:52:02.573 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-40_pid-1_0-4-8-9.pkl | len: 3 |  size: 2.02 KB
Processing depth (0, 4, 8, 9):   2%|▏         | 2/100 [00:41<33:41, 20.62s/it]is_0k: False
your chose emoji: ['🍂', '👶🏽', '🧎🏿', '👨🏽\u200d❤\u200d💋\u200d👨🏽', '🌇', '👨🏿\u200d🎤', '🤏🏽', '🇳🇷', '🥕', '🆒']
emoji:
O: 🍂 [9468, 235, 224]
N: 👶🏽 [9468, 239, 114, 9468, 237, 121]

O: 👶🏽 [9468, 239, 114, 9468, 237, 121]
N: 🇳🇷 [9468, 229, 111, 9468, 229, 115]

O: 🧎🏿 [9468, 100, 236, 9468, 237, 123]
N: 🍂 [9468, 235, 224]

O: 👨🏽‍❤‍💋‍👨🏽 [9468, 239, 101, 9468, 237, 121, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 121]
N: 🤏🏽 [9468, 97, 237, 9468, 237, 121]

O: 🌇 [9468, 234, 229]
N: 🌇 [9468, 234, 229]

O: 👨🏿‍🎤 [9468, 239, 101, 9468, 237, 123, 102470, 9468, 236, 97]
N: 👨🏿‍🎤 [9468, 239, 101, 9468, 237, 123, 102470, 9468, 236, 97]

O: 🤏🏽 [9468, 97, 237, 9468, 237, 121]
N: 🧎🏿 [9468, 100, 236, 9468, 237, 123]

O: 🇳🇷 [9468, 229, 111, 9468, 229, 115]
N: 👨🏽‍❤‍💋‍👨🏽 [9468, 239, 101, 9468, 237, 121, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 121]

O: 🥕 [9468, 98, 243]
N: 🥕 [9468, 98, 243]

O: 🆒 [9468, 101445]
N: 🆒 [9468, 101445]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.68s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.69s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.52s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.16s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.69s/it]
Processing depth (0, 5, 7, 9):   2%|▏         | 2/100 [00:58<33:41, 20.62s/it]2025-01-22 04:52:19.070 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the kitchen.
2025-01-22 04:52:19.070 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  moved to the kitchen.
2025-01-22 04:52:19.071 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the office.
2025-01-22 04:52:19.096 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4213, 4218) -->  Daniel moved to the office
2025-01-22 04:52:19.097 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel left the football.
2025-01-22 04:52:19.130 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5589, 5593) -->  Daniel left the football
2025-01-22 04:52:19.130 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra journeyed to the bedroom.
2025-01-22 04:52:19.191 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7233, 7239) --> . Sandra journeyed to the
2025-01-22 04:52:19.191 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the bathroom.
2025-01-22 04:52:19.218 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5370, 5375) --> . John travelled to the
2025-01-22 04:52:19.219 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the garden.
2025-01-22 04:52:19.243 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4139, 4145) --> . John went back to the
2025-01-22 04:52:19.244 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the kitchen.
2025-01-22 04:52:19.272 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5370, 5375) --> . John travelled to the
2025-01-22 04:52:19.272 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the bathroom.
2025-01-22 04:52:19.283 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2036, 2041) -->  cable. Sandra went to
2025-01-22 04:52:19.283 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary travelled to the bedroom.
2025-01-22 04:52:19.307 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4646, 4651) --> . Mary travelled to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:52:20.256 | INFO     | test_jbb_embedding:begin_test:693 - The football was left by Daniel.<|eot_id|>
2025-01-22 04:52:20.256 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8172])
2025-01-22 04:52:22.465 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [392.77109375, 28.868325688073394, 139.90324519230768, 27.617868895313077, 19.880572150735293], 'topk_indices': array([  68, 8162,    3,   67, 5527, 5591, 8155, 8168, 8025,   24, 8160,
         14, 8159, 8170, 5590, 5593, 8167, 8026, 5592,    0]), 'topk_tokens': ['E', ' office', '<|end_header_id|>', 'ION', '.', ' the', ':', '<|start_header_id|>', ' you', '\n\n', ' before', '\n', ' football', '<|end_header_id|>', ' left', '.', '<|eot_id|>', ' context', ' football', '<|begin_of_text|>'], 'evidence_proportions': [452.4, 399.8, 857.875, 27.153645833333332]}, 'weight': {'score': [22.65546875, 23.279608180428134, 21.162560096153847, 23.287914988005905, 29.878676470588236], 'topk_indices': array([3318, 3291, 3163, 3211, 7419, 7457, 1499, 1437, 4321, 4305, 5164,
       5225, 7127, 7183, 3480, 3506, 4927, 5004, 4975, 4952]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.809375, 23.9234375, 26.791015625, 21.213541666666668]}, 'saliency': {'score': [2.4168411254882813, 0.16134245986238532, 0.7510939378004807, 0.15390691899156378, 0.15143046659581802], 'topk_indices': array([  68,   24, 8156,  105, 8024,   34, 4217, 8070, 8025,   31, 5696,
         67, 5589, 8154, 8162, 8160, 5590, 8159, 8026, 5592]), 'topk_tokens': ['E', '\n\n', ' Where', 'ION', ' provided', ' kitchen', ' office', ' location', ' you', ' moved', ' kitchen', 'ION', ' Daniel', 'Question', ' office', ' before', ' left', ' football', ' context', ' football'], 'evidence_proportions': [2.379296875, 2.45234375, 5.813232421875, 0.1542816162109375]}}, 'pred_res': 'The football was left by Daniel.<|eot_id|>', 'score': 0}
2025-01-22 04:52:22.470 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:52:22.470 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-40_pid-2_0-5-7-9.pkl | len: 3 |  size: 2.05 KB
Processing depth (0, 5, 7, 9):   3%|▎         | 3/100 [01:01<32:48, 20.29s/it]is_0k: False
your chose emoji: ['🧑🏼\u200d🦼\u200d➡️', '♠', '👩\u200d🦯', '🌄', '🏙️', '🌇', '🛀🏻', '👩🏾\u200d❤️\u200d👨🏽', '🚣🏽\u200d♀', '🏃\u200d♀️']
emoji:
O: 🧑🏼‍🦼‍➡️ [9468, 100, 239, 9468, 237, 120, 102470, 9468, 99, 120, 102470, 98115, 94, 31643]
N: 👩🏾‍❤️‍👨🏽 [9468, 239, 102, 9468, 237, 122, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 121]

O: ♠ [121324]
N: 👩‍🦯 [9468, 239, 102, 102470, 9468, 99, 107]

O: 👩‍🦯 [9468, 239, 102, 102470, 9468, 99, 107]
N: 🏙️ [9468, 237, 247, 31643]

O: 🌄 [9468, 234, 226]
N: 🌄 [9468, 234, 226]

O: 🏙️ [9468, 237, 247, 31643]
N: 🚣🏽‍♀ [9468, 248, 96, 9468, 237, 121, 102470, 32990]

O: 🌇 [9468, 234, 229]
N: 🧑🏼‍🦼‍➡️ [9468, 100, 239, 9468, 237, 120, 102470, 9468, 99, 120, 102470, 98115, 94, 31643]

O: 🛀🏻 [9468, 249, 222, 9468, 237, 119]
N: ♠ [121324]

O: 👩🏾‍❤️‍👨🏽 [9468, 239, 102, 9468, 237, 122, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 121]
N: 🛀🏻 [9468, 249, 222, 9468, 237, 119]

O: 🚣🏽‍♀ [9468, 248, 96, 9468, 237, 121, 102470, 32990]
N: 🌇 [9468, 234, 229]

O: 🏃‍♀️ [9468, 237, 225, 102470, 32990, 31643]
N: 🏃‍♀️ [9468, 237, 225, 102470, 32990, 31643]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:11,  3.90s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.76s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.79s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.30s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.77s/it]
Processing depth (0, 3, 5, 7):   3%|▎         | 3/100 [01:18<32:48, 20.29s/it]2025-01-22 04:52:39.209 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the kitchen.
2025-01-22 04:52:39.210 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  moved to the kitchen.
2025-01-22 04:52:39.210 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the office.
2025-01-22 04:52:39.228 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2927, 2932) --> . Daniel moved to the
2025-01-22 04:52:39.228 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel left the football.
2025-01-22 04:52:39.253 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4207, 4211) -->  Daniel left the football
2025-01-22 04:52:39.253 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra journeyed to the bedroom.
2025-01-22 04:52:39.288 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5715, 5721) --> . Sandra journeyed to the
2025-01-22 04:52:39.288 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the bathroom.
2025-01-22 04:52:39.317 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5611, 5616) --> . John travelled to the
2025-01-22 04:52:39.317 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the garden.
2025-01-22 04:52:39.342 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4153, 4159) --> . John went back to the
2025-01-22 04:52:39.342 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the kitchen.
2025-01-22 04:52:39.374 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5611, 5616) --> . John travelled to the
2025-01-22 04:52:39.374 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the bathroom.
2025-01-22 04:52:39.384 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1886, 1891) -->  Sandra went to the bathroom
2025-01-22 04:52:39.384 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary travelled to the bedroom.
2025-01-22 04:52:39.407 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4689, 4694) --> . Mary travelled to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:52:40.211 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 04:52:40.211 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8242])
2025-01-22 04:52:42.454 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [185.61875, 19.645021604002427, 133.94471153846155, 18.87770040553726, 13.826096025485437], 'topk_indices': array([8235, 8224, 8140,   28, 8230, 8232,    9,   25, 8229, 5899, 8236,
       8225,    1, 4210,   14,    3,   24, 8240, 8237,    0]), 'topk_tokens': ['Answer', 'Question', ' location', '<|end_header_id|>', ' before', ' office', ':', '<|eot_id|>', ' football', ' kitchen', ':', ':', '<|start_header_id|>', ' football', '\n', '<|end_header_id|>', '\n\n', '<|end_header_id|>', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [261.5, 167.4, 279.9375, 74.6875]}, 'weight': {'score': [21.651953125, 23.330425636749546, 21.405348557692307, 23.34062461885596, 29.67020631067961], 'topk_indices': array([3362, 3335, 3243, 3195, 7463, 7501, 1467, 1405, 4376, 4392, 5254,
       5193, 7240, 7184, 3544, 3518, 4970, 4995, 5018, 5047]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.809375, 19.909375, 26.791015625, 21.213541666666668]}, 'saliency': {'score': [1.0939178466796875, 0.10979005386787447, 0.7789400540865384, 0.10526749552393966, 0.10405531207334648], 'topk_indices': array([8211, 8130,   14, 8214, 1627,   64,   34, 8168, 4159,   31, 8230,
       8140, 8096, 8232, 8235, 8224,   24, 8229, 5899, 4210]), 'topk_tokens': [' return', '.\n\n', '\n', ' directly', ' work', 'ENCES', ' kitchen', ' moved', ' garden', ' moved', ' before', ' location', ' context', ' office', 'Answer', 'Question', '\n\n', ' football', ' kitchen', ' football'], 'evidence_proportions': [1.35732421875, 0.8912109375, 1.970458984375, 0.4589742024739583]}}, 'pred_res': 'The garden.<|eot_id|>', 'score': 0}
2025-01-22 04:52:42.464 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:52:42.465 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-40_pid-3_0-3-5-7.pkl | len: 3 |  size: 2.06 KB
Processing depth (0, 3, 5, 7):   4%|▍         | 4/100 [01:21<32:16, 20.17s/it]is_0k: False
your chose emoji: ['🏳\u200d🌈', '🧑🏿\u200d❤\u200d💋\u200d🧑🏻', '👩🏾\u200d❤\u200d💋\u200d👩🏿', '🧙🏿', '👮🏼\u200d♀', '🧑🏻\u200d🚒', '👩🏽\u200d🦽\u200d➡️', '🆑', '👩🏼\u200d🦼\u200d➡', '🦹\u200d♀️']
emoji:
O: 🏳‍🌈 [9468, 237, 111, 102470, 9468, 234, 230]
N: 👮🏼‍♀ [9468, 239, 106, 9468, 237, 120, 102470, 32990]

O: 🧑🏿‍❤‍💋‍🧑🏻 [9468, 100, 239, 9468, 237, 123, 102470, 121643, 102470, 93273, 233, 102470, 9468, 100, 239, 9468, 237, 119]
N: 👩🏽‍🦽‍➡️ [9468, 239, 102, 9468, 237, 121, 102470, 9468, 99, 121, 102470, 98115, 94, 31643]

O: 👩🏾‍❤‍💋‍👩🏿 [9468, 239, 102, 9468, 237, 122, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 123]
N: 🧑🏿‍❤‍💋‍🧑🏻 [9468, 100, 239, 9468, 237, 123, 102470, 121643, 102470, 93273, 233, 102470, 9468, 100, 239, 9468, 237, 119]

O: 🧙🏿 [9468, 100, 247, 9468, 237, 123]
N: 🧙🏿 [9468, 100, 247, 9468, 237, 123]

O: 👮🏼‍♀ [9468, 239, 106, 9468, 237, 120, 102470, 32990]
N: 🏳‍🌈 [9468, 237, 111, 102470, 9468, 234, 230]

O: 🧑🏻‍🚒 [9468, 100, 239, 9468, 237, 119, 102470, 9468, 248, 240]
N: 👩🏾‍❤‍💋‍👩🏿 [9468, 239, 102, 9468, 237, 122, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 123]

O: 👩🏽‍🦽‍➡️ [9468, 239, 102, 9468, 237, 121, 102470, 9468, 99, 121, 102470, 98115, 94, 31643]
N: 🆑 [9468, 228, 239]

O: 🆑 [9468, 228, 239]
N: 🧑🏻‍🚒 [9468, 100, 239, 9468, 237, 119, 102470, 9468, 248, 240]

O: 👩🏼‍🦼‍➡ [9468, 239, 102, 9468, 237, 120, 102470, 9468, 99, 120, 102470, 98115, 94]
N: 👩🏼‍🦼‍➡ [9468, 239, 102, 9468, 237, 120, 102470, 9468, 99, 120, 102470, 98115, 94]

O: 🦹‍♀️ [9468, 99, 117, 102470, 32990, 31643]
N: 🦹‍♀️ [9468, 99, 117, 102470, 32990, 31643]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.12s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.46s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:03,  3.94s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  2.60s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  3.17s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (3, 4, 7, 8):   4%|▍         | 4/100 [01:35<32:16, 20.17s/it]2025-01-22 04:52:56.915 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the kitchen.
2025-01-22 04:52:56.932 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2903, 2908) --> . Daniel moved to the
2025-01-22 04:52:56.933 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the office.
2025-01-22 04:52:56.947 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2903, 2908) --> . Daniel moved to the
2025-01-22 04:52:56.947 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel left the football.
2025-01-22 04:52:56.974 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5665, 5669) -->  Daniel left the football
2025-01-22 04:52:56.975 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra journeyed to the bedroom.
2025-01-22 04:52:57.044 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6667, 6673) --> . Sandra journeyed to the
2025-01-22 04:52:57.045 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the bathroom.
2025-01-22 04:52:57.073 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5486, 5491) --> . John travelled to the
2025-01-22 04:52:57.074 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the garden.
2025-01-22 04:52:57.106 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4177, 4183) --> . John went back to the
2025-01-22 04:52:57.107 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the kitchen.
2025-01-22 04:52:57.138 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5486, 5491) --> . John travelled to the
2025-01-22 04:52:57.138 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the bathroom.
2025-01-22 04:52:57.149 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1885, 1890) --> . Sandra went to the
2025-01-22 04:52:57.149 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary travelled to the bedroom.
2025-01-22 04:52:57.176 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4746, 4751) --> . Mary travelled to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:53:06.835 | INFO     | test_jbb_embedding:begin_test:693 - The football was left by Daniel.<|eot_id|>
2025-01-22 04:53:06.835 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8210])
2025-01-22 04:53:10.211 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [291.73046875, 24.609945741507367, 174.06009615384616, 23.480018672707235, 13.39446390086207], 'topk_indices': array([8206,    1, 8198,    9, 8209,   23, 8200, 8121, 2908, 5669, 8098,
       8197, 8108,   24,    3,   14, 8208, 5668, 8205,    0]), 'topk_tokens': ['<|start_header_id|>', '<|start_header_id|>', ' before', ':', '\n\n', '4', ' office', ' the', ' kitchen', '.', '.\n\n', ' football', ' location', '\n\n', '<|end_header_id|>', '\n', '<|end_header_id|>', ' football', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [318.6, 318.6, 617.9375, 29.4765625]}, 'weight': {'score': [21.676953125, 23.300756042250093, 20.311298076923077, 23.314249609709808, 29.445402298850574], 'topk_indices': array([3329, 3356, 3201, 3249, 7499, 7461, 1449, 1511, 4349, 4333, 5156,
       5217, 7182, 7238, 3512, 3538, 4981, 4933, 4958, 5010]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.909375, 19.909375, 26.791015625, 21.213541666666668]}, 'saliency': {'score': [1.8094772338867187, 0.13698135054562888, 0.9655433067908654, 0.1302478463789584, 0.09938066855244253], 'topk_indices': array([8182, 8107, 5491, 8098, 6021, 8179, 8203, 1890, 8198, 5666,   24,
       3646, 8192, 2905, 5665, 8200, 2908, 8108, 8197, 5668]), 'topk_tokens': [' directly', ' first', ' bathroom', '.\n\n', ' office', ' return', 'Answer', ' bathroom', ' before', ' left', '\n\n', ' Daniel', 'Question', ' moved', ' Daniel', ' office', ' kitchen', ' location', ' football', ' football'], 'evidence_proportions': [1.7431640625, 1.7431640625, 4.40673828125, 0.1884918212890625]}}, 'pred_res': 'The football was left by Daniel.<|eot_id|>', 'score': 0}
2025-01-22 04:53:10.218 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:53:10.218 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-40_pid-4_3-4-7-8.pkl | len: 3 |  size: 2.08 KB
Processing depth (3, 4, 7, 8):   5%|▌         | 5/100 [01:49<36:16, 22.91s/it]Processing depth (3, 4, 7, 8):   5%|▌         | 5/100 [01:49<34:37, 21.87s/it]
2025-01-22 04:53:10.283 | INFO     | __main__:<module>:82 - Selected idx: 41
2025-01-22 04:53:10.283 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the location prior to the place where the milk was discarded, left or dropped?
2025-01-22 04:53:10.283 | INFO     | __main__:<module>:84 - Answer: kitchen
2025-01-22 04:53:10.283 | INFO     | __main__:<module>:85 - Tag: 4-hop
2025-01-22 04:53:10.283 | INFO     | __main__:<module>:86 - Needle: [' John went back to the garden.', ' Sandra went to the bathroom.', ' John travelled to the kitchen.', ' Daniel moved to the kitchen.', ' Mary travelled to the bedroom.', ' Daniel got the milk.', ' Daniel moved to the office.', ' John travelled to the bathroom.', ' Daniel left the milk.', ' Sandra journeyed to the bedroom.']
2025-01-22 04:53:10.283 | INFO     | __main__:<module>:87 - Real Needle: [' Daniel moved to the kitchen.', ' Daniel got the milk.', ' Daniel moved to the office.', ' Daniel left the milk.', ' Sandra journeyed to the bedroom.']
2025-01-22 04:53:10.283 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['💪🏼', '🤵\u200d♀️', '👨🏾\u200d❤\u200d👨🏾', '🚴🏿', '👌', '🙇🏽', '👩🏻\u200d❤️\u200d💋\u200d👨🏻', '🧑🏿\u200d🤝\u200d🧑🏻', '🇺🇲', '🎚️']
emoji:
O: 💪🏼 [93273, 103, 9468, 237, 120]
N: 🙇🏽 [9468, 247, 229, 9468, 237, 121]

O: 🤵‍♀️ [9468, 97, 113, 102470, 32990, 31643]
N: 👩🏻‍❤️‍💋‍👨🏻 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 119]

O: 👨🏾‍❤‍👨🏾 [9468, 239, 101, 9468, 237, 122, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 122]
N: 🇺🇲 [9468, 229, 118, 9468, 229, 110]

O: 🚴🏿 [9468, 248, 112, 9468, 237, 123]
N: 👨🏾‍❤‍👨🏾 [9468, 239, 101, 9468, 237, 122, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 122]

O: 👌 [9468, 239, 234]
N: 🤵‍♀️ [9468, 97, 113, 102470, 32990, 31643]

O: 🙇🏽 [9468, 247, 229, 9468, 237, 121]
N: 👌 [9468, 239, 234]

O: 👩🏻‍❤️‍💋‍👨🏻 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 119]
N: 🧑🏿‍🤝‍🧑🏻 [9468, 100, 239, 9468, 237, 123, 102470, 9468, 97, 251, 102470, 9468, 100, 239, 9468, 237, 119]

O: 🧑🏿‍🤝‍🧑🏻 [9468, 100, 239, 9468, 237, 123, 102470, 9468, 97, 251, 102470, 9468, 100, 239, 9468, 237, 119]
N: 🚴🏿 [9468, 248, 112, 9468, 237, 123]

O: 🇺🇲 [9468, 229, 118, 9468, 229, 110]
N: 💪🏼 [93273, 103, 9468, 237, 120]

O: 🎚️ [9468, 236, 248, 31643]
N: 🎚️ [9468, 236, 248, 31643]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.73s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.58s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.46s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.07s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.62s/it]
Processing depth (0, 2, 3, 6, 9):   0%|          | 0/100 [00:15<?, ?it/s]2025-01-22 04:53:26.423 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the kitchen.
2025-01-22 04:53:26.423 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  moved to the kitchen.
2025-01-22 04:53:26.423 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel got the milk.
2025-01-22 04:53:26.432 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1820, 1824) -->  Daniel got the milk
2025-01-22 04:53:26.433 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 04:53:26.449 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2903, 2908) -->  Daniel moved to the office
2025-01-22 04:53:26.449 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the milk.
2025-01-22 04:53:26.475 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4724, 4728) -->  Daniel left the milk
2025-01-22 04:53:26.475 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra journeyed to the bedroom.
2025-01-22 04:53:26.511 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7151, 7157) -->  Sandra journeyed to the bedroom
2025-01-22 04:53:26.511 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the garden.
2025-01-22 04:53:26.535 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4058, 4064) --> . John went back to the
2025-01-22 04:53:26.535 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went to the bathroom.
2025-01-22 04:53:26.566 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6101, 6106) -->  Sandra went to the bathroom
2025-01-22 04:53:26.566 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the kitchen.
2025-01-22 04:53:26.589 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4782, 4787) -->  the senate. John travelled
2025-01-22 04:53:26.589 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary travelled to the bedroom.
2025-01-22 04:53:26.628 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6912, 6917) --> . Mary travelled to the
2025-01-22 04:53:26.628 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John travelled to the bathroom.
2025-01-22 04:53:26.651 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4782, 4787) -->  the senate. John travelled
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:53:27.404 | INFO     | test_jbb_embedding:begin_test:693 - kitchen<|eot_id|>
2025-01-22 04:53:27.405 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8204])
2025-01-22 04:53:29.636 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [43.088948567708336, 4.030117677744609, 7.937274639423077, 3.9027426596788035, 4.186615386566558], 'topk_indices': array([  38,   25,   34,   35,   31, 8198,   29, 8176, 8083,  425,    1,
         23, 8203,   24,   14,   28, 8202, 8200,    0, 8199]), 'topk_tokens': ['***', '<|eot_id|>', ' kitchen', '.', ' moved', ':', '\n\n', '.\n\n', '.\n\n', ' ', '<|start_header_id|>', '4', '\n\n', '\n\n', '\n', '<|end_header_id|>', '<|end_header_id|>', '<|start_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [82.59375, 60.515625, 42.296875, 36.98046875, 3.2828776041666665]}, 'weight': {'score': [24.390625, 23.28767743999025, 23.223858173076923, 23.284635703996567, 29.59760551948052], 'topk_indices': array([3308, 3335, 3228, 3180, 7442, 7480, 1443, 1505, 4310, 4326, 5132,
       5193, 7163, 7219, 3517, 3491, 4986, 4934, 4957, 4909]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.809375, 26.611328125, 23.9234375, 26.462890625, 25.735677083333332]}, 'saliency': {'score': [0.2557174364725749, 0.02204276264200435, 0.04640681927020733, 0.021277572296991846, 0.03013311113630022], 'topk_indices': array([8049,    8, 8083,   27,   39,   14,   16, 8164, 8177,   23, 8183,
         20, 8201, 8197, 8203,   24,   31, 1823,   38,   34]), 'topk_tokens': [' context', ' Date', '.\n\n', 'user', '\n\n\n', '\n', ' Date', ' return', 'Question', '4', ' prior', ' Jul', 'assistant', 'Answer', '\n\n', '\n\n', ' moved', ' milk', '***', ' kitchen'], 'evidence_proportions': [0.438525390625, 0.413055419921875, 0.2406982421875, 0.2400054931640625, 0.021476109822591145]}}, 'pred_res': 'kitchen<|eot_id|>', 'score': 100}
2025-01-22 04:53:29.642 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:53:29.642 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-41_pid-0_0-2-3-6-9.pkl | len: 3 |  size: 2.05 KB
Processing depth (0, 2, 3, 6, 9):   1%|          | 1/100 [00:19<31:47, 19.27s/it]is_0k: False
your chose emoji: ['👌🏾', '🎀', '✊', '🧝🏼\u200d♀', '👨🏻\u200d❤️\u200d👨🏻', '👕', '🤘🏼', '💆🏿\u200d♂', '👩🏿\u200d❤️\u200d💋\u200d👨🏻', '🦻🏽']
emoji:
O: 👌🏾 [9468, 239, 234, 9468, 237, 122]
N: 👩🏿‍❤️‍💋‍👨🏻 [9468, 239, 102, 9468, 237, 123, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 119]

O: 🎀 [9468, 236, 222]
N: 👌🏾 [9468, 239, 234, 9468, 237, 122]

O: ✊ [38798, 232]
N: 👕 [9468, 239, 243]

O: 🧝🏼‍♀ [9468, 100, 251, 9468, 237, 120, 102470, 32990]
N: 🎀 [9468, 236, 222]

O: 👨🏻‍❤️‍👨🏻 [9468, 239, 101, 9468, 237, 119, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 119]
N: ✊ [38798, 232]

O: 👕 [9468, 239, 243]
N: 💆🏿‍♂ [93273, 228, 9468, 237, 123, 102470, 17245, 224]

O: 🤘🏼 [9468, 97, 246, 9468, 237, 120]
N: 🧝🏼‍♀ [9468, 100, 251, 9468, 237, 120, 102470, 32990]

O: 💆🏿‍♂ [93273, 228, 9468, 237, 123, 102470, 17245, 224]
N: 🤘🏼 [9468, 97, 246, 9468, 237, 120]

O: 👩🏿‍❤️‍💋‍👨🏻 [9468, 239, 102, 9468, 237, 123, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 119]
N: 👨🏻‍❤️‍👨🏻 [9468, 239, 101, 9468, 237, 119, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 119]

O: 🦻🏽 [9468, 99, 119, 9468, 237, 121]
N: 🦻🏽 [9468, 99, 119, 9468, 237, 121]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.61s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.81s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.21s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.70s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.36s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 1, 4, 7, 8):   1%|          | 1/100 [00:34<31:47, 19.27s/it]2025-01-22 04:53:44.913 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the kitchen.
2025-01-22 04:53:44.913 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  moved to the kitchen.
2025-01-22 04:53:44.914 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel got the milk.
2025-01-22 04:53:44.918 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (902, 906) -->  Daniel got the milk
2025-01-22 04:53:44.918 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 04:53:44.936 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3610, 3615) --> . Daniel moved to the
2025-01-22 04:53:44.936 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the milk.
2025-01-22 04:53:44.963 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5708, 5712) -->  Daniel left the milk
2025-01-22 04:53:44.963 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra journeyed to the bedroom.
2025-01-22 04:53:45.004 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6617, 6623) -->  Sandra journeyed to the bedroom
2025-01-22 04:53:45.004 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the garden.
2025-01-22 04:53:45.030 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4116, 4122) --> . John went back to the
2025-01-22 04:53:45.030 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went to the bathroom.
2025-01-22 04:53:45.068 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6166, 6171) --> . Sandra went to the
2025-01-22 04:53:45.068 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the kitchen.
2025-01-22 04:53:45.096 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4935, 4940) --> . John travelled to the
2025-01-22 04:53:45.096 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary travelled to the bedroom.
2025-01-22 04:53:45.129 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6905, 6910) --> . Mary travelled to the
2025-01-22 04:53:45.129 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John travelled to the bathroom.
2025-01-22 04:53:45.153 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4935, 4940) --> . John travelled to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:53:47.298 | INFO     | test_jbb_embedding:begin_test:693 - kitchen<|eot_id|>
2025-01-22 04:53:47.299 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8146])
2025-01-22 04:53:49.988 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [40.0419921875, 3.5856537228494294, 9.320387620192308, 3.45921154424929, 2.4336649576822915], 'topk_indices': array([  67,    9,    1, 8138, 8140, 8118, 8025,   68,   28,   23,   25,
        105,   24,   34,   14, 8145, 8144, 8142, 8141,    0]), 'topk_tokens': ['ION', ':', '<|start_header_id|>', '?\n', ':', '.\n\n', '.\n\n', 'E', '<|end_header_id|>', '4', '<|eot_id|>', 'ION', '\n\n', ' kitchen', '\n', '\n\n', '<|end_header_id|>', '<|start_header_id|>', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [107.3875, 44.375, 19.5203125, 29.734375, 5.005208333333333]}, 'weight': {'score': [23.554361979166668, 23.2373258988833, 20.311298076923077, 23.245779764477096, 29.1357421875], 'topk_indices': array([3269, 3242, 3114, 3162, 7372, 7410, 1472, 1410, 4276, 4260, 5138,
       5077, 7093, 7149, 3425, 3451, 4896, 4873, 4848, 4925]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.809375, 26.611328125, 19.909375, 26.462890625, 25.735677083333332]}, 'saliency': {'score': [0.24204476674397787, 0.019502071240647817, 0.0498651357797476, 0.018745130338055336, 0.017838319142659504], 'topk_indices': array([   8, 8109, 8118, 8025,   23, 8125,   68, 8106, 8035,   31,   67,
       7991,   24, 8143,   20, 8145, 8139, 8119,  105,   34]), 'topk_tokens': [' Date', ' directly', '.\n\n', '.\n\n', '4', ' prior', 'E', ' return', ' location', ' moved', 'ION', ' context', '\n\n', 'assistant', ' Jul', '\n\n', 'Answer', 'Question', 'ION', ' kitchen'], 'evidence_proportions': [0.6223388671875, 0.2993621826171875, 0.0954345703125, 0.2039642333984375, 0.03448359171549479]}}, 'pred_res': 'kitchen<|eot_id|>', 'score': 100}
2025-01-22 04:53:49.994 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:53:49.995 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-41_pid-1_0-1-4-7-8.pkl | len: 3 |  size: 2.05 KB
Processing depth (0, 1, 4, 7, 8):   2%|▏         | 2/100 [00:39<32:30, 19.91s/it]is_0k: False
your chose emoji: ['🈂', '🏌🏻\u200d♂️', '🇧🇸', '🇱🇦', '🚣🏻', '🖼', '😆', '🦃', '☑️', '🤴🏾']
emoji:
O: 🈂 [9468, 230, 224]
N: 🖼 [9468, 244, 120]

O: 🏌🏻‍♂️ [9468, 237, 234, 9468, 237, 119, 102470, 17245, 224, 31643]
N: 🈂 [9468, 230, 224]

O: 🇧🇸 [9468, 229, 100, 9468, 229, 116]
N: 🏌🏻‍♂️ [9468, 237, 234, 9468, 237, 119, 102470, 17245, 224, 31643]

O: 🇱🇦 [9468, 229, 109, 9468, 229, 99]
N: 🇧🇸 [9468, 229, 100, 9468, 229, 116]

O: 🚣🏻 [9468, 248, 96, 9468, 237, 119]
N: 🇱🇦 [9468, 229, 109, 9468, 229, 99]

O: 🖼 [9468, 244, 120]
N: ☑️ [18107, 239, 31643]

O: 😆 [76460, 228]
N: 🦃 [9468, 99, 225]

O: 🦃 [9468, 99, 225]
N: 😆 [76460, 228]

O: ☑️ [18107, 239, 31643]
N: 🚣🏻 [9468, 248, 96, 9468, 237, 119]

O: 🤴🏾 [9468, 97, 112, 9468, 237, 122]
N: 🤴🏾 [9468, 97, 112, 9468, 237, 122]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.37s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.50s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.46s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.17s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.64s/it]
Processing depth (0, 3, 4, 7, 9):   2%|▏         | 2/100 [00:55<32:30, 19.91s/it]2025-01-22 04:54:06.310 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the kitchen.
2025-01-22 04:54:06.311 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  moved to the kitchen.
2025-01-22 04:54:06.311 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel got the milk.
2025-01-22 04:54:06.327 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2824, 2828) -->  Daniel got the milk
2025-01-22 04:54:06.328 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 04:54:06.348 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3596, 3601) --> . Daniel moved to the
2025-01-22 04:54:06.348 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the milk.
2025-01-22 04:54:06.385 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5598, 5602) -->  Daniel left the milk
2025-01-22 04:54:06.386 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra journeyed to the bedroom.
2025-01-22 04:54:06.437 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7181, 7187) -->  Sandra journeyed to the bedroom
2025-01-22 04:54:06.437 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the garden.
2025-01-22 04:54:06.459 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4092, 4098) --> . John went back to the
2025-01-22 04:54:06.459 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went to the bathroom.
2025-01-22 04:54:06.493 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5796, 5801) --> . Sandra went to the
2025-01-22 04:54:06.493 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the kitchen.
2025-01-22 04:54:06.524 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4797, 4802) -->  the senate. John travelled
2025-01-22 04:54:06.524 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary travelled to the bedroom.
2025-01-22 04:54:06.558 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6936, 6941) --> . Mary travelled to the
2025-01-22 04:54:06.558 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John travelled to the bathroom.
2025-01-22 04:54:06.583 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4797, 4802) -->  the senate. John travelled
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:54:07.340 | INFO     | test_jbb_embedding:begin_test:693 - kitchen<|eot_id|>
2025-01-22 04:54:07.340 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8242])
2025-01-22 04:54:09.625 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [51.824625651041664, 6.392082322619769, 10.923076923076923, 6.244652560631483, 3.1383158365885415], 'topk_indices': array([1637, 1569,   25, 1639,   24, 1559,   34, 1646,   28,   14, 1562,
       8240, 1568, 8237, 8238, 1561, 1638,    0, 1647, 1640]), 'topk_tokens': ['action', 'ation', '<|eot_id|>', ' the', '\n\n', ' on', ' kitchen', ' const', '<|end_header_id|>', '\n', ' of', '<|end_header_id|>', 'ern', '<|eot_id|>', '<|start_header_id|>', ' part', ' on', '<|begin_of_text|>', 'ern', ' part'], 'evidence_proportions': [127.075, 62.6484375, 36.234375, 37.68359375, 4.3193359375]}, 'weight': {'score': [23.554361979166668, 23.32489766525167, 22.129807692307693, 23.32801727425259, 29.947102864583332], 'topk_indices': array([3280, 3307, 3152, 3200, 7472, 7510, 1411, 1473, 4326, 4310, 5179,
       5240, 7193, 7249, 3463, 3489, 5007, 4978, 4930, 4955]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.809375, 26.611328125, 19.909375, 26.462890625, 25.735677083333332]}, 'saliency': {'score': [0.31213919321695965, 0.034996603647096725, 0.06452472393329327, 0.03409127682865648, 0.02398991584777832], 'topk_indices': array([   8, 8241, 8235, 8215, 1562,   20,   24, 1559, 1569, 1558, 3939,
       1637, 1567, 1638,   34, 1646, 1568, 1561, 1647, 1640]), 'topk_tokens': [' Date', '\n\n', 'Answer', 'Question', ' of', ' Jul', '\n\n', ' on', 'ation', 'action', 'burn', 'action', ' const', ' on', ' kitchen', ' const', 'ern', ' part', 'ern', ' part'], 'evidence_proportions': [0.7380615234375, 0.430755615234375, 0.17799072265625, 0.251251220703125, 0.030508677164713543]}}, 'pred_res': 'kitchen<|eot_id|>', 'score': 100}
2025-01-22 04:54:09.631 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:54:09.631 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-41_pid-2_0-3-4-7-9.pkl | len: 3 |  size: 2.05 KB
Processing depth (0, 3, 4, 7, 9):   3%|▎         | 3/100 [00:59<31:59, 19.78s/it]is_0k: False
your chose emoji: ['🧑\u200d🦯\u200d➡', '👩🏻\u200d❤️\u200d💋\u200d👩🏻', '🇪🇦', '🙈', '👩🏾\u200d❤️\u200d💋\u200d👨🏾', '👮🏿\u200d♀️', '🛩️', '👩🏻\u200d🦯\u200d➡', '🥷', '🚶\u200d♂\u200d➡️']
emoji:
O: 🧑‍🦯‍➡ [9468, 100, 239, 102470, 9468, 99, 107, 102470, 98115, 94]
N: 🥷 [9468, 98, 115]

O: 👩🏻‍❤️‍💋‍👩🏻 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 119]
N: 🛩️ [9468, 249, 102, 31643]

O: 🇪🇦 [9468, 229, 103, 9468, 229, 99]
N: 🇪🇦 [9468, 229, 103, 9468, 229, 99]

O: 🙈 [9468, 247, 230]
N: 👮🏿‍♀️ [9468, 239, 106, 9468, 237, 123, 102470, 32990, 31643]

O: 👩🏾‍❤️‍💋‍👨🏾 [9468, 239, 102, 9468, 237, 122, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 122]
N: 👩🏾‍❤️‍💋‍👨🏾 [9468, 239, 102, 9468, 237, 122, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 122]

O: 👮🏿‍♀️ [9468, 239, 106, 9468, 237, 123, 102470, 32990, 31643]
N: 🧑‍🦯‍➡ [9468, 100, 239, 102470, 9468, 99, 107, 102470, 98115, 94]

O: 🛩️ [9468, 249, 102, 31643]
N: 🙈 [9468, 247, 230]

O: 👩🏻‍🦯‍➡ [9468, 239, 102, 9468, 237, 119, 102470, 9468, 99, 107, 102470, 98115, 94]
N: 👩🏻‍🦯‍➡ [9468, 239, 102, 9468, 237, 119, 102470, 9468, 99, 107, 102470, 98115, 94]

O: 🥷 [9468, 98, 115]
N: 👩🏻‍❤️‍💋‍👩🏻 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 119]

O: 🚶‍♂‍➡️ [9468, 248, 114, 102470, 17245, 224, 102470, 98115, 94, 31643]
N: 🚶‍♂‍➡️ [9468, 248, 114, 102470, 17245, 224, 102470, 98115, 94, 31643]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:11,  3.86s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:07<00:08,  4.02s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:11<00:03,  3.96s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  2.58s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  3.08s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 1, 2, 8, 9):   3%|▎         | 3/100 [01:13<31:59, 19.78s/it]2025-01-22 04:54:23.641 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the kitchen.
2025-01-22 04:54:23.641 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  moved to the kitchen.
2025-01-22 04:54:23.642 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel got the milk.
2025-01-22 04:54:23.650 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (832, 836) -->  Daniel got the milk
2025-01-22 04:54:23.650 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 04:54:23.661 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1808, 1813) --> . Daniel moved to the
2025-01-22 04:54:23.661 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the milk.
2025-01-22 04:54:23.695 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6504, 6508) -->  Daniel left the milk
2025-01-22 04:54:23.696 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra journeyed to the bedroom.
2025-01-22 04:54:23.733 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7137, 7143) -->  Sandra journeyed to the bedroom
2025-01-22 04:54:23.734 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the garden.
2025-01-22 04:54:23.753 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4052, 4058) --> . John went back to the
2025-01-22 04:54:23.754 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went to the bathroom.
2025-01-22 04:54:23.790 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5831, 5836) --> . Sandra went to the
2025-01-22 04:54:23.791 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the kitchen.
2025-01-22 04:54:23.819 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4771, 4776) -->  the senate. John travelled
2025-01-22 04:54:23.819 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary travelled to the bedroom.
2025-01-22 04:54:23.876 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6830, 6835) --> . Mary travelled to the
2025-01-22 04:54:23.876 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John travelled to the bathroom.
2025-01-22 04:54:23.901 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4771, 4776) -->  the senate. John travelled
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:54:28.192 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 04:54:28.193 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8190])
2025-01-22 04:54:31.254 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [56.84619140625, 5.322060371658733, 10.571138822115385, 5.153442517729952, 3.105873325892857], 'topk_indices': array([8164,   20, 8154,    9, 8184, 8162, 8069,    1,   25,   23,  105,
         28, 8189,   24,   14,   34, 8188, 8186,    0, 8185]), 'topk_tokens': [':', ' Jul', '.', ':', ':', '.\n\n', '.\n\n', '<|start_header_id|>', '<|eot_id|>', '4', 'ION', '<|end_header_id|>', '\n\n', '\n\n', '\n', ' kitchen', '<|end_header_id|>', '<|start_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [137.075, 64.9609375, 52.521875, 31.359375, 5.173828125]}, 'weight': {'score': [23.554361979166668, 23.27416506468937, 22.129807692307693, 23.276993084551147, 29.437723214285715], 'topk_indices': array([3327, 3300, 3220, 3172, 7428, 7466, 1506, 1444, 4320, 4304, 5198,
       5137, 7205, 7149, 3483, 3509, 4962, 4923, 4991, 4898]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.809375, 26.611328125, 19.909375, 26.462890625, 25.735677083333332]}, 'saliency': {'score': [0.34285704294840497, 0.028935301482830238, 0.0666339580829327, 0.027889705649995107, 0.023203114100864956], 'topk_indices': array([8153,    8,   67, 8162, 8150,   31,   19, 8069,   16, 8169, 8079,
       8187,   23, 8183, 8163,   24, 8189,   20,  105,   34]), 'topk_tokens': [' directly', ' Date', 'ION', '.\n\n', ' return', ' moved', '26', '.\n\n', ' Date', ' prior', ' location', 'assistant', '4', 'Answer', 'Question', '\n\n', '\n\n', ' Jul', 'ION', ' kitchen'], 'evidence_proportions': [0.817138671875, 0.451263427734375, 0.25701904296875, 0.2111663818359375, 0.03467686971028646]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 100}
2025-01-22 04:54:31.270 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:54:31.271 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-41_pid-3_0-1-2-8-9.pkl | len: 3 |  size: 2.05 KB
Processing depth (0, 1, 2, 8, 9):   4%|▍         | 4/100 [01:20<32:49, 20.52s/it]is_0k: False
your chose emoji: ['🏃🏽\u200d♀', '👫🏼', '👮🏾\u200d♀', '🧍🏼\u200d♂️', '🤞', '🍫', '👨🏼\u200d✈', '🚶🏿\u200d♀', '👩\u200d❤\u200d👨', '🇨🇳']
emoji:
O: 🏃🏽‍♀ [9468, 237, 225, 9468, 237, 121, 102470, 32990]
N: 🚶🏿‍♀ [9468, 248, 114, 9468, 237, 123, 102470, 32990]

O: 👫🏼 [9468, 239, 104, 9468, 237, 120]
N: 👨🏼‍✈ [9468, 239, 101, 9468, 237, 120, 102470, 38798, 230]

O: 👮🏾‍♀ [9468, 239, 106, 9468, 237, 122, 102470, 32990]
N: 🤞 [9468, 97, 252]

O: 🧍🏼‍♂️ [9468, 100, 235, 9468, 237, 120, 102470, 17245, 224, 31643]
N: 👩‍❤‍👨 [9468, 239, 102, 102470, 121643, 102470, 9468, 239, 101]

O: 🤞 [9468, 97, 252]
N: 🍫 [9468, 235, 104]

O: 🍫 [9468, 235, 104]
N: 👫🏼 [9468, 239, 104, 9468, 237, 120]

O: 👨🏼‍✈ [9468, 239, 101, 9468, 237, 120, 102470, 38798, 230]
N: 🏃🏽‍♀ [9468, 237, 225, 9468, 237, 121, 102470, 32990]

O: 🚶🏿‍♀ [9468, 248, 114, 9468, 237, 123, 102470, 32990]
N: 🧍🏼‍♂️ [9468, 100, 235, 9468, 237, 120, 102470, 17245, 224, 31643]

O: 👩‍❤‍👨 [9468, 239, 102, 102470, 121643, 102470, 9468, 239, 101]
N: 👮🏾‍♀ [9468, 239, 106, 9468, 237, 122, 102470, 32990]

O: 🇨🇳 [9468, 229, 101, 9468, 229, 111]
N: 🇨🇳 [9468, 229, 101, 9468, 229, 111]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.35s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.84s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.66s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.23s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.75s/it]
Processing depth (0, 2, 6, 8, 9):   4%|▍         | 4/100 [01:37<32:49, 20.52s/it]2025-01-22 04:54:48.036 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the kitchen.
2025-01-22 04:54:48.036 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  moved to the kitchen.
2025-01-22 04:54:48.036 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel got the milk.
2025-01-22 04:54:48.049 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1764, 1768) -->  Daniel got the milk
2025-01-22 04:54:48.049 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 04:54:48.072 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4592, 4597) -->  Daniel moved to the office
2025-01-22 04:54:48.072 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the milk.
2025-01-22 04:54:48.104 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6498, 6502) -->  Daniel left the milk
2025-01-22 04:54:48.104 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra journeyed to the bedroom.
2025-01-22 04:54:48.139 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7131, 7137) -->  Sandra journeyed to the bedroom
2025-01-22 04:54:48.139 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the garden.
2025-01-22 04:54:48.159 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3928, 3934) --> . John went back to the
2025-01-22 04:54:48.159 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went to the bathroom.
2025-01-22 04:54:48.187 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5689, 5694) --> . Sandra went to the
2025-01-22 04:54:48.188 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the kitchen.
2025-01-22 04:54:48.210 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4624, 4629) -->  John travelled to the kitchen
2025-01-22 04:54:48.210 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary travelled to the bedroom.
2025-01-22 04:54:48.244 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6824, 6829) --> . Mary travelled to the
2025-01-22 04:54:48.244 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John travelled to the bathroom.
2025-01-22 04:54:48.270 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4625, 4630) -->  travelled to the kitchen.
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:54:49.019 | INFO     | test_jbb_embedding:begin_test:693 - kitchen<|eot_id|>
2025-01-22 04:54:49.019 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8184])
2025-01-22 04:54:51.238 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [39.687337239583336, 4.671775280169781, 13.49579326923077, 4.540302015484823, 2.211447644589552], 'topk_indices': array([ 496,  588,  473,  586,   14,   24, 8183,  591,  558,  583, 8182,
        590,  474,  592,  585,  468,  469,    0, 8179, 8180]), 'topk_tokens': ['s', ',', ' em', ' ', '\n', '\n\n', '\n\n', 's', ' instead', ',', '<|end_header_id|>', ' em', 's', ' per', ' to', ' to', ' ', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [85.075, 48.77734375, 27.478125, 41.58984375, 4.710286458333333]}, 'weight': {'score': [24.390625, 23.264206974471723, 21.41075721153846, 23.266806908258573, 29.105410447761194], 'topk_indices': array([3310, 3337, 3230, 3182, 7460, 7422, 1523, 1461, 4360, 4344, 5228,
       5167, 7199, 7143, 3493, 3519, 4992, 4969, 5021, 4944]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.809375, 26.611328125, 23.9234375, 26.462890625, 25.735677083333332]}, 'saliency': {'score': [0.23937861124674478, 0.025191293438960014, 0.08483651968149039, 0.02436896684320081, 0.01626297964978574], 'topk_indices': array([ 467,  591, 1767, 8157,  476,  584,  580,  469,  441,  495,  475,
        497,  473,  474,   34,  585,  468,  558,  590,  592]), 'topk_tokens': ['000', 's', ' milk', 'Question', ' hour', '000', ' setting', ' ', ' instead', ' em', ' per', ' per', ' em', 's', ' kitchen', ' to', ' to', ' instead', ' em', ' per'], 'evidence_proportions': [0.4625732421875, 0.32904052734375, 0.1646728515625, 0.2736663818359375, 0.0330047607421875]}}, 'pred_res': 'kitchen<|eot_id|>', 'score': 100}
2025-01-22 04:54:51.245 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:54:51.246 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-41_pid-4_0-2-6-8-9.pkl | len: 3 |  size: 1.99 KB
Processing depth (0, 2, 6, 8, 9):   5%|▌         | 5/100 [01:40<32:10, 20.32s/it]Processing depth (0, 2, 6, 8, 9):   5%|▌         | 5/100 [01:40<31:57, 20.19s/it]
2025-01-22 04:54:51.317 | INFO     | __main__:<module>:82 - Selected idx: 42
2025-01-22 04:54:51.317 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the football before the office? 
2025-01-22 04:54:51.317 | INFO     | __main__:<module>:84 - Answer: kitchen
2025-01-22 04:54:51.317 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 04:54:51.317 | INFO     | __main__:<module>:86 - Needle: [' John travelled to the bathroom.', ' John went back to the garden.', ' Sandra journeyed to the bedroom.', ' Sandra went to the kitchen.', ' Daniel moved to the kitchen.', ' Mary travelled to the bedroom.', ' Sandra went to the bathroom.', ' John travelled to the kitchen.', ' Daniel moved to the office.', ' Daniel left the football.', ' John went back to the office.']
2025-01-22 04:54:51.317 | INFO     | __main__:<module>:87 - Real Needle: [' Daniel moved to the kitchen.', ' Daniel moved to the office.', ' Daniel left the football.', ' John went back to the office.']
2025-01-22 04:54:51.317 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['🕵🏻\u200d♂', '🇯🇲', '📽', '👩🏼\u200d❤️\u200d💋\u200d👨🏻', '🥻', '🔽', '🙅🏿', '🐳', '👩🏾\u200d💻', '👲🏿']
emoji:
O: 🕵🏻‍♂ [9468, 243, 113, 9468, 237, 119, 102470, 17245, 224]
N: 🥻 [9468, 98, 119]

O: 🇯🇲 [9468, 229, 107, 9468, 229, 110]
N: 👩🏼‍❤️‍💋‍👨🏻 [9468, 239, 102, 9468, 237, 120, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 119]

O: 📽 [9468, 241, 121]
N: 🙅🏿 [9468, 247, 227, 9468, 237, 123]

O: 👩🏼‍❤️‍💋‍👨🏻 [9468, 239, 102, 9468, 237, 120, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 119]
N: 🇯🇲 [9468, 229, 107, 9468, 229, 110]

O: 🥻 [9468, 98, 119]
N: 📽 [9468, 241, 121]

O: 🔽 [9468, 242, 121]
N: 🐳 [9468, 238, 111]

O: 🙅🏿 [9468, 247, 227, 9468, 237, 123]
N: 👩🏾‍💻 [9468, 239, 102, 9468, 237, 122, 102470, 93273, 119]

O: 🐳 [9468, 238, 111]
N: 🕵🏻‍♂ [9468, 243, 113, 9468, 237, 119, 102470, 17245, 224]

O: 👩🏾‍💻 [9468, 239, 102, 9468, 237, 122, 102470, 93273, 119]
N: 🔽 [9468, 242, 121]

O: 👲🏿 [9468, 239, 110, 9468, 237, 123]
N: 👲🏿 [9468, 239, 110, 9468, 237, 123]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.48s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.48s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.15s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.68s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.29s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (1, 7, 8, 9):   0%|          | 0/100 [00:14<?, ?it/s]2025-01-22 04:55:06.164 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the kitchen.
2025-01-22 04:55:06.170 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (836, 841) --> . Daniel moved to the
2025-01-22 04:55:06.170 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the office.
2025-01-22 04:55:06.175 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (836, 841) --> . Daniel moved to the
2025-01-22 04:55:06.175 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel left the football.
2025-01-22 04:55:06.209 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6614, 6618) -->  Daniel left the football
2025-01-22 04:55:06.209 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the office.
2025-01-22 04:55:06.232 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4616, 4622) --> . John went back to the
2025-01-22 04:55:06.232 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the bathroom.
2025-01-22 04:55:06.237 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (992, 997) --> . John travelled to the
2025-01-22 04:55:06.237 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the garden.
2025-01-22 04:55:06.265 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4616, 4622) --> . John went back to the
2025-01-22 04:55:06.265 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra journeyed to the bedroom.
2025-01-22 04:55:06.266 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (271, 277) --> . Sandra journeyed to the
2025-01-22 04:55:06.266 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the kitchen.
2025-01-22 04:55:06.286 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4080, 4085) --> . Sandra went to the
2025-01-22 04:55:06.286 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary travelled to the bedroom.
2025-01-22 04:55:06.312 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5215, 5220) --> . Mary travelled to the
2025-01-22 04:55:06.312 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra went to the bathroom.
2025-01-22 04:55:06.337 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (4080, 4085) --> . Sandra went to the
2025-01-22 04:55:06.337 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  John travelled to the kitchen.
2025-01-22 04:55:06.343 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (992, 997) --> . John travelled to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:55:10.811 | INFO     | test_jbb_embedding:begin_test:693 - the football was left by Daniel.<|eot_id|>
2025-01-22 04:55:10.812 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8150])
2025-01-22 04:55:13.666 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [285.575, 18.766594735066846, 105.7516891891892, 17.709947427742094, 17.84980085784314], 'topk_indices': array([8149, 8038, 8123,  841, 6614, 8048,    9,    1,    3, 6616,   24,
       8137, 6615,   14, 8146, 6618, 8148, 6617, 8145,    0]), 'topk_tokens': ['\n\n', '.\n\n', '.', ' kitchen', ' Daniel', ' location', ':', '<|start_header_id|>', '<|end_header_id|>', ' the', '\n\n', ' football', ' left', '\n', '<|start_header_id|>', '.', '<|end_header_id|>', ' football', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [248.0, 248.0, 721.0625, 57.875]}, 'weight': {'score': [21.333984375, 23.237086808536734, 20.52322635135135, 23.254190919898715, 28.573835784313726], 'topk_indices': array([3327, 3300, 3220, 3172, 7428, 7390, 1500, 1438, 4303, 4319, 5121,
       5182, 7160, 7104, 3495, 3521, 4898, 4975, 4923, 4946]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.909375, 19.909375, 26.791015625, 20.0703125]}, 'saliency': {'score': [1.735784912109375, 0.10288597396088862, 0.5842763539907094, 0.09665210256463454, 0.10484239166858149], 'topk_indices': array([8132, 8129,    8,    0, 8140, 6618, 8122, 8138,  837, 8128, 8119,
       8143, 5658,   24, 8048,  841, 6614, 6615, 8137, 6617]), 'topk_tokens': ['Question', ' after', ' Date', '<|begin_of_text|>', ' office', '.', ' directly', ' before', ' Daniel', ' else', ' return', 'Answer', ' Daniel', '\n\n', ' location', ' kitchen', ' Daniel', ' left', ' football', ' football'], 'evidence_proportions': [1.29599609375, 1.29599609375, 4.994140625, 0.2965291341145833]}}, 'pred_res': 'the football was left by Daniel.<|eot_id|>', 'score': 0}
2025-01-22 04:55:13.675 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:55:13.675 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-42_pid-0_1-7-8-9.pkl | len: 3 |  size: 2.08 KB
Processing depth (1, 7, 8, 9):   1%|          | 1/100 [00:22<36:44, 22.27s/it]is_0k: False
your chose emoji: ['👷🏼', '🙇🏼\u200d♂️', '🧑🏽\u200d🔧', '👌🏾', '\U0001fa77', '\U0001faf5🏽', '💩', '⏹️', '♀', '🦪']
emoji:
O: 👷🏼 [9468, 239, 115, 9468, 237, 120]
N: 🧑🏽‍🔧 [9468, 100, 239, 9468, 237, 121, 102470, 9468, 242, 100]

O: 🙇🏼‍♂️ [9468, 247, 229, 9468, 237, 120, 102470, 17245, 224, 31643]
N: 🫵🏽 [9468, 104, 113, 9468, 237, 121]

O: 🧑🏽‍🔧 [9468, 100, 239, 9468, 237, 121, 102470, 9468, 242, 100]
N: 💩 [93273, 102]

O: 👌🏾 [9468, 239, 234, 9468, 237, 122]
N: 🙇🏼‍♂️ [9468, 247, 229, 9468, 237, 120, 102470, 17245, 224, 31643]

O: 🩷 [9468, 102, 115]
N: 👷🏼 [9468, 239, 115, 9468, 237, 120]

O: 🫵🏽 [9468, 104, 113, 9468, 237, 121]
N: ⏹️ [158, 237, 117, 31643]

O: 💩 [93273, 102]
N: 🩷 [9468, 102, 115]

O: ⏹️ [158, 237, 117, 31643]
N: 👌🏾 [9468, 239, 234, 9468, 237, 122]

O: ♀ [32990]
N:  Good [7839]

O: 🦪 [9468, 99, 103]
N: ��
 [99, 103, 198]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.40s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.44s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.15s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.92s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.42s/it]
Processing depth (0, 4, 6, 7):   1%|          | 1/100 [00:37<36:44, 22.27s/it]2025-01-22 04:55:29.076 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the kitchen.
2025-01-22 04:55:29.077 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  moved to the kitchen.
2025-01-22 04:55:29.077 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the office.
2025-01-22 04:55:29.096 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3738, 3743) --> . Daniel moved to the
2025-01-22 04:55:29.096 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel left the football.
2025-01-22 04:55:29.119 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4898, 4902) -->  Daniel left the football
2025-01-22 04:55:29.119 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the office.
2025-01-22 04:55:29.147 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4736, 4742) --> . John went back to the
2025-01-22 04:55:29.147 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the bathroom.
2025-01-22 04:55:29.153 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1052, 1057) --> . John travelled to the
2025-01-22 04:55:29.153 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the garden.
2025-01-22 04:55:29.178 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4736, 4742) --> . John went back to the
2025-01-22 04:55:29.178 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra journeyed to the bedroom.
2025-01-22 04:55:29.180 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (303, 309) --> . Sandra journeyed to the
2025-01-22 04:55:29.180 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the kitchen.
2025-01-22 04:55:29.202 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4168, 4173) --> . Sandra went to the
2025-01-22 04:55:29.202 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary travelled to the bedroom.
2025-01-22 04:55:29.237 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5352, 5357) --> . Mary travelled to the
2025-01-22 04:55:29.238 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra went to the bathroom.
2025-01-22 04:55:29.261 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (4168, 4173) --> . Sandra went to the
2025-01-22 04:55:29.261 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  John travelled to the kitchen.
2025-01-22 04:55:29.266 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (1052, 1057) --> . John travelled to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:55:30.238 | INFO     | test_jbb_embedding:begin_test:693 - The football was left in the garden.<|eot_id|>
2025-01-22 04:55:30.239 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8243])
2025-01-22 04:55:32.500 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [236.11875, 23.832401694761096, 120.93412162162163, 22.87520416106973, 16.835957635309278], 'topk_indices': array([8141, 8233, 8231,    3, 8239, 7785, 4902,    1, 7599, 4305, 8230,
       8097, 7555, 7600,   24,   14, 4901, 8241, 8238,    0]), 'topk_tokens': [' location', ' office', ' before', '<|end_header_id|>', '<|start_header_id|>', 'inen', '.', '<|start_header_id|>', ' Min', 'nes', ' football', ' context', 'nes', 'nes', '\n\n', '\n', ' football', '<|end_header_id|>', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [278.475, 170.05, 481.125, 92.54166666666667]}, 'weight': {'score': [21.308984375, 23.31403483507155, 20.52322635135135, 23.331541358835022, 29.445876288659793], 'topk_indices': array([3244, 3271, 3116, 3164, 7492, 7454, 1480, 1418, 4339, 4323, 5207,
       5146, 7175, 7231, 3427, 3453, 4971, 4948, 4923, 5000]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.809375, 19.909375, 26.791015625, 20.0703125]}, 'saliency': {'score': [1.40638427734375, 0.1339625160352368, 0.670726879222973, 0.12842964063358622, 0.12364299026961179], 'topk_indices': array([8225, 8212, 4304, 4899, 1057, 4284, 7407,   24, 7784, 8231, 8141,
       8233, 7785, 4305, 8097, 7599, 7600, 7555, 8230, 4901]), 'topk_tokens': ['Question', ' return', ' Min', ' left', ' bathroom', 'nes', 'nes', '\n\n', ' genu', ' before', ' location', ' office', 'inen', 'nes', ' context', ' Min', 'nes', 'nes', ' football', ' football'], 'evidence_proportions': [1.45087890625, 0.921630859375, 3.34423828125, 0.4813639322916667]}}, 'pred_res': 'The football was left in the garden.<|eot_id|>', 'score': 0}
2025-01-22 04:55:32.507 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:55:32.507 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-42_pid-1_0-4-6-7.pkl | len: 3 |  size: 2.07 KB
Processing depth (0, 4, 6, 7):   2%|▏         | 2/100 [00:41<33:04, 20.25s/it]is_0k: False
your chose emoji: ['3⃣', '👨\u200d👨\u200d👦\u200d👦', '👈🏼', '💆🏼\u200d♀', '👩\u200d👩\u200d👧\u200d👧', '🈁', '🚵🏾\u200d♂', '🧔🏿\u200d♀️', '🧎🏼\u200d♂️\u200d➡️', '👩🏾\u200d❤\u200d👨🏼']
emoji:
O: 3⃣ [18, 158, 225, 96]
N: 🧎🏼‍♂️‍➡️ [9468, 100, 236, 9468, 237, 120, 102470, 17245, 224, 31643, 102470, 98115, 94, 31643]

O: 👨‍👨‍👦‍👦 [9468, 239, 101, 102470, 9468, 239, 101, 102470, 9468, 239, 99, 102470, 9468, 239, 99]
N: 👩‍👩‍👧‍👧 [9468, 239, 102, 102470, 9468, 239, 102, 102470, 9468, 239, 100, 102470, 9468, 239, 100]

O: 👈🏼 [9468, 239, 230, 9468, 237, 120]
N: 🚵🏾‍♂ [9468, 248, 113, 9468, 237, 122, 102470, 17245, 224]

O: 💆🏼‍♀ [93273, 228, 9468, 237, 120, 102470, 32990]
N: 🈁 [9468, 230, 223]

O: 👩‍👩‍👧‍👧 [9468, 239, 102, 102470, 9468, 239, 102, 102470, 9468, 239, 100, 102470, 9468, 239, 100]
N: 💆🏼‍♀ [93273, 228, 9468, 237, 120, 102470, 32990]

O: 🈁 [9468, 230, 223]
N: 3⃣ [18, 158, 225, 96]

O: 🚵🏾‍♂ [9468, 248, 113, 9468, 237, 122, 102470, 17245, 224]
N: 👨‍👨‍👦‍👦 [9468, 239, 101, 102470, 9468, 239, 101, 102470, 9468, 239, 99, 102470, 9468, 239, 99]

O: 🧔🏿‍♀️ [9468, 100, 242, 9468, 237, 123, 102470, 32990, 31643]
N: 👈🏼 [9468, 239, 230, 9468, 237, 120]

O: 🧎🏼‍♂️‍➡️ [9468, 100, 236, 9468, 237, 120, 102470, 17245, 224, 31643, 102470, 98115, 94, 31643]
N: 🧔🏿‍♀️ [9468, 100, 242, 9468, 237, 123, 102470, 32990, 31643]

O: 👩🏾‍❤‍👨🏼 [9468, 239, 102, 9468, 237, 122, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 120]
N: 👩🏾‍❤‍👨🏼 [9468, 239, 102, 9468, 237, 122, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 120]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.35s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.57s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.09s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.86s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.39s/it]
Processing depth (3, 6, 7, 9):   2%|▏         | 2/100 [00:56<33:04, 20.25s/it]2025-01-22 04:55:47.898 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the kitchen.
2025-01-22 04:55:47.913 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2942, 2947) --> . Daniel moved to the
2025-01-22 04:55:47.913 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the office.
2025-01-22 04:55:47.929 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2942, 2947) --> . Daniel moved to the
2025-01-22 04:55:47.929 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel left the football.
2025-01-22 04:55:47.960 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5642, 5646) -->  Daniel left the football
2025-01-22 04:55:47.960 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the office.
2025-01-22 04:55:47.985 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4698, 4704) --> . John went back to the
2025-01-22 04:55:47.985 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the bathroom.
2025-01-22 04:55:47.991 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (984, 989) --> . John travelled to the
2025-01-22 04:55:47.991 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the garden.
2025-01-22 04:55:48.014 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4698, 4704) --> . John went back to the
2025-01-22 04:55:48.014 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra journeyed to the bedroom.
2025-01-22 04:55:48.016 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (297, 303) --> . Sandra journeyed to the
2025-01-22 04:55:48.016 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the kitchen.
2025-01-22 04:55:48.036 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4130, 4135) --> . Sandra went to the
2025-01-22 04:55:48.036 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary travelled to the bedroom.
2025-01-22 04:55:48.064 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5107, 5112) --> . Mary travelled to the
2025-01-22 04:55:48.064 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra went to the bathroom.
2025-01-22 04:55:48.087 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (4130, 4135) --> . Sandra went to the
2025-01-22 04:55:48.087 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  John travelled to the kitchen.
2025-01-22 04:55:48.092 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (984, 989) --> . John travelled to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:55:49.057 | INFO     | test_jbb_embedding:begin_test:693 - the football was left in the football.<|eot_id|>
2025-01-22 04:55:49.058 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8199])
2025-01-22 04:55:51.297 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [336.89375, 26.83873407400634, 171.0608108108108, 25.42224332412523, 18.296979166666667], 'topk_indices': array([8053,    1, 8087,    9, 5641,    3, 8189,   24, 8187, 8097, 5643,
       5644,   14, 8186, 8195, 5646, 8197, 8194, 5645,    0]), 'topk_tokens': [' context', '<|start_header_id|>', '.\n\n', ':', '.', '<|end_header_id|>', ' office', '\n\n', ' before', ' location', ' left', ' the', '\n', ' football', '<|start_header_id|>', '.', '<|end_header_id|>', '<|eot_id|>', ' football', '<|begin_of_text|>'], 'evidence_proportions': [296.575, 296.575, 790.25, 101.85416666666667]}, 'weight': {'score': [21.333984375, 23.292354380029263, 20.52322635135135, 23.30974236494782, 30.070416666666667], 'topk_indices': array([3309, 3282, 3154, 3202, 7416, 7454, 1492, 1430, 4279, 4295, 5147,
       5208, 7186, 7130, 3465, 3491, 4963, 4934, 4911, 4886]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.909375, 19.909375, 26.791015625, 20.0703125]}, 'saliency': {'score': [2.059674072265625, 0.150289108101492, 0.9854142472550675, 0.14180693137565223, 0.13905008951822917], 'topk_indices': array([   0, 5118,   24,  303, 4861, 2944, 8181,  298, 4860, 2943, 8192,
       8053, 5642, 2947, 8187, 8189, 5643, 8097, 8186, 5645]), 'topk_tokens': ['<|begin_of_text|>', ' kitchen', '\n\n', ' bedroom', ' moved', ' moved', 'Question', ' Sandra', ' Daniel', ' Daniel', 'Answer', ' context', ' Daniel', ' kitchen', ' before', ' office', ' left', ' location', ' football', ' football'], 'evidence_proportions': [1.64921875, 1.64921875, 5.36181640625, 0.5423380533854166]}}, 'pred_res': 'the football was left in the football.<|eot_id|>', 'score': 0}
2025-01-22 04:55:51.303 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:55:51.303 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-42_pid-2_3-6-7-9.pkl | len: 3 |  size: 2.1 KB
Processing depth (3, 6, 7, 9):   3%|▎         | 3/100 [00:59<31:39, 19.58s/it]is_0k: False
your chose emoji: ['🍅', '🧎🏻\u200d♀\u200d➡️', '⛈️', '⬅', '👩🏾\u200d🦱', '👨🏼\u200d⚖', '🐵', '💁🏻\u200d♂️', '🧎🏾\u200d♀️\u200d➡️', '👰🏼\u200d♂']
emoji:
O: 🍅 [9468, 235, 227]
N: 💁🏻‍♂️ [93273, 223, 9468, 237, 119, 102470, 17245, 224, 31643]

O: 🧎🏻‍♀‍➡️ [9468, 100, 236, 9468, 237, 119, 102470, 32990, 102470, 98115, 94, 31643]
N: 👨🏼‍⚖ [9468, 239, 101, 9468, 237, 120, 102470, 158, 248, 244]

O: ⛈️ [158, 109147, 31643]
N: ⛈️ [158, 109147, 31643]

O: ⬅ [158, 105, 227]
N: 🍅 [9468, 235, 227]

O: 👩🏾‍🦱 [9468, 239, 102, 9468, 237, 122, 102470, 9468, 99, 109]
N: 👩🏾‍🦱 [9468, 239, 102, 9468, 237, 122, 102470, 9468, 99, 109]

O: 👨🏼‍⚖ [9468, 239, 101, 9468, 237, 120, 102470, 158, 248, 244]
N: 🐵 [9468, 238, 113]

O: 🐵 [9468, 238, 113]
N: 🧎🏾‍♀️‍➡️ [9468, 100, 236, 9468, 237, 122, 102470, 32990, 31643, 102470, 98115, 94, 31643]

O: 💁🏻‍♂️ [93273, 223, 9468, 237, 119, 102470, 17245, 224, 31643]
N: ⬅ [158, 105, 227]

O: 🧎🏾‍♀️‍➡️ [9468, 100, 236, 9468, 237, 122, 102470, 32990, 31643, 102470, 98115, 94, 31643]
N: 🧎🏻‍♀‍➡️ [9468, 100, 236, 9468, 237, 119, 102470, 32990, 102470, 98115, 94, 31643]

O: 👰🏼‍♂ [9468, 239, 108, 9468, 237, 120, 102470, 17245, 224]
N: 👰🏼‍♂ [9468, 239, 108, 9468, 237, 120, 102470, 17245, 224]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:11,  3.85s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.39s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.28s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.79s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.32s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (1, 4, 5, 7):   3%|▎         | 3/100 [01:14<31:39, 19.58s/it]2025-01-22 04:56:06.351 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the kitchen.
2025-01-22 04:56:06.355 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (794, 799) --> . Daniel moved to the
2025-01-22 04:56:06.355 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the office.
2025-01-22 04:56:06.359 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (794, 799) --> . Daniel moved to the
2025-01-22 04:56:06.360 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel left the football.
2025-01-22 04:56:06.379 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4159, 4163) -->  Daniel left the football
2025-01-22 04:56:06.380 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the office.
2025-01-22 04:56:06.403 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4609, 4615) -->  went back to the garden.
2025-01-22 04:56:06.403 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the bathroom.
2025-01-22 04:56:06.407 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (944, 949) --> . John travelled to the
2025-01-22 04:56:06.407 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the garden.
2025-01-22 04:56:06.434 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4608, 4614) -->  John went back to the garden
2025-01-22 04:56:06.435 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra journeyed to the bedroom.
2025-01-22 04:56:06.436 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (271, 277) --> . Sandra journeyed to the
2025-01-22 04:56:06.436 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the kitchen.
2025-01-22 04:56:06.458 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4072, 4077) --> . Sandra went to the
2025-01-22 04:56:06.458 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary travelled to the bedroom.
2025-01-22 04:56:06.488 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5124, 5129) --> . Mary travelled to the
2025-01-22 04:56:06.488 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra went to the bathroom.
2025-01-22 04:56:06.510 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (4072, 4077) --> . Sandra went to the
2025-01-22 04:56:06.510 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  John travelled to the kitchen.
2025-01-22 04:56:06.515 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (944, 949) --> . John travelled to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:56:10.302 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 04:56:10.302 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8197])
2025-01-22 04:56:13.341 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [232.56015625, 18.270962271341464, 119.41047297297297, 17.28509148962299, 17.08255912162162], 'topk_indices': array([8179, 8085, 8193,  799,   23, 8182, 8180,    1,    9,    3, 8187,
       4163, 8184, 8185,   24,   14, 8192, 8195, 4162,    0]), 'topk_tokens': ['Question', '.\n\n', '<|start_header_id|>', ' kitchen', '4', ' was', ':', '<|start_header_id|>', ':', '<|end_header_id|>', ' office', '.', ' football', ' before', '\n\n', '\n', '<|eot_id|>', '<|end_header_id|>', ' football', '<|begin_of_text|>'], 'evidence_proportions': [230.475, 230.475, 513.75, 48.575520833333336]}, 'weight': {'score': [21.497265625, 23.280028582317073, 21.1332347972973, 23.29416178005649, 29.479096283783782], 'topk_indices': array([3332, 3359, 3204, 3252, 7464, 7426, 1522, 1460, 4334, 4350, 5164,
       5225, 7147, 7203, 3541, 3515, 4977, 4929, 4954, 5006]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.909375, 19.909375, 26.791015625, 20.614583333333332]}, 'saliency': {'score': [1.4252243041992188, 0.10231622463319359, 0.6947763803842906, 0.0963750251546094, 0.12780101879222974], 'topk_indices': array([8188, 4168, 8169, 8182, 8175, 4160, 7757, 8181, 8166, 4073, 8095,
       8190,   24, 8051, 8179,  799, 8187, 8185, 8184, 4162]), 'topk_tokens': ['?', ' kitchen', ' directly', ' was', ' else', ' left', 'inen', ' Where', ' return', ' Sandra', ' location', 'Answer', '\n\n', ' context', 'Question', ' kitchen', ' office', ' before', ' football', ' football'], 'evidence_proportions': [1.23505859375, 1.23505859375, 3.593505859375, 0.2966461181640625]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 100}
2025-01-22 04:56:13.345 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:56:13.345 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-42_pid-3_1-4-5-7.pkl | len: 3 |  size: 2.05 KB
Processing depth (1, 4, 5, 7):   4%|▍         | 4/100 [01:21<32:53, 20.55s/it]is_0k: False
your chose emoji: ['🧰', '📸', '🦸🏻', '🙋🏼\u200d♂️', '⛹🏾\u200d♀️', '🧑🏿\u200d⚖️', '🚶🏽\u200d♀', '\U0001faf5🏿', '☀️', '🧑🏾\u200d❤\u200d🧑🏻']
emoji:
O: 🧰 [9468, 100, 108]
N: 🙋🏼‍♂️ [9468, 247, 233, 9468, 237, 120, 102470, 17245, 224, 31643]

O: 📸 [9468, 241, 116]
N: 🚶🏽‍♀ [9468, 248, 114, 9468, 237, 121, 102470, 32990]

O: 🦸🏻 [9468, 99, 116, 9468, 237, 119]
N: 📸 [9468, 241, 116]

O: 🙋🏼‍♂️ [9468, 247, 233, 9468, 237, 120, 102470, 17245, 224, 31643]
N: ☀️ [18107, 222, 31643]

O: ⛹🏾‍♀️ [158, 249, 117, 9468, 237, 122, 102470, 32990, 31643]
N: ⛹🏾‍♀️ [158, 249, 117, 9468, 237, 122, 102470, 32990, 31643]

O: 🧑🏿‍⚖️ [9468, 100, 239, 9468, 237, 123, 102470, 158, 248, 244, 31643]
N: 🧑🏿‍⚖️ [9468, 100, 239, 9468, 237, 123, 102470, 158, 248, 244, 31643]

O: 🚶🏽‍♀ [9468, 248, 114, 9468, 237, 121, 102470, 32990]
N: 🦸🏻 [9468, 99, 116, 9468, 237, 119]

O: 🫵🏿 [9468, 104, 113, 9468, 237, 123]
N: 🫵🏿 [9468, 104, 113, 9468, 237, 123]

O: ☀️ [18107, 222, 31643]
N: 🧰 [9468, 100, 108]

O: 🧑🏾‍❤‍🧑🏻 [9468, 100, 239, 9468, 237, 122, 102470, 121643, 102470, 9468, 100, 239, 9468, 237, 119]
N: 🧑🏾‍❤‍🧑🏻 [9468, 100, 239, 9468, 237, 122, 102470, 121643, 102470, 9468, 100, 239, 9468, 237, 119]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.11s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.62s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.70s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.26s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.73s/it]
Processing depth (0, 2, 5, 8):   4%|▍         | 4/100 [01:38<32:53, 20.55s/it]2025-01-22 04:56:29.986 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the kitchen.
2025-01-22 04:56:29.987 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  moved to the kitchen.
2025-01-22 04:56:29.987 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the office.
2025-01-22 04:56:29.997 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1750, 1755) --> . Daniel moved to the
2025-01-22 04:56:29.997 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel left the football.
2025-01-22 04:56:30.018 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4095, 4099) -->  Daniel left the football
2025-01-22 04:56:30.018 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the office.
2025-01-22 04:56:30.041 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4565, 4571) -->  went back to the garden.
2025-01-22 04:56:30.041 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the bathroom.
2025-01-22 04:56:30.045 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (853, 858) -->  John travelled to the bathroom
2025-01-22 04:56:30.045 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the garden.
2025-01-22 04:56:30.068 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4564, 4570) -->  John went back to the garden
2025-01-22 04:56:30.068 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra journeyed to the bedroom.
2025-01-22 04:56:30.070 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (269, 275) --> . Sandra journeyed to the
2025-01-22 04:56:30.070 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the kitchen.
2025-01-22 04:56:30.090 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3976, 3981) -->  the ground. Sandra went
2025-01-22 04:56:30.090 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary travelled to the bedroom.
2025-01-22 04:56:30.114 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5010, 5015) --> . Mary travelled to the
2025-01-22 04:56:30.114 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra went to the bathroom.
2025-01-22 04:56:30.134 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (3976, 3981) -->  the ground. Sandra went
2025-01-22 04:56:30.134 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  John travelled to the kitchen.
2025-01-22 04:56:30.139 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (854, 859) -->  travelled to the bathroom.
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:56:30.936 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 04:56:30.936 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8187])
2025-01-22 04:56:33.176 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [211.41875, 19.818791971916973, 116.53969594594595, 18.9076063568179, 27.13272758152174], 'topk_indices': array([  31,  116,   24,  455, 8041, 4099, 8175,   81, 4298, 8174, 8185,
         14,   78, 4098, 8182,  325,   79,  117,   80,    0]), 'topk_tokens': [' moved', ' P', '\n\n', 's', ' context', '.', ' before', 'ER', 'nes', ' football', '<|end_header_id|>', '\n', ' P', ' football', '<|eot_id|>', '�', 'ION', 'ION', 'E', '<|begin_of_text|>'], 'evidence_proportions': [303.875, 160.775, 388.4375, 58.5625]}, 'weight': {'score': [21.472265625, 23.27192651098901, 23.02491554054054, 23.277475831488996, 29.435235507246375], 'topk_indices': array([3316, 3343, 3236, 3188, 7448, 7410, 1448, 1510, 4316, 4332, 5219,
       5158, 7187, 7131, 3529, 3503, 4948, 4923, 5000, 4971]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.809375, 19.909375, 26.791015625, 20.614583333333332]}, 'saliency': {'score': [1.2469497680664063, 0.11195250943175748, 0.6882027290962838, 0.10653984457250745, 0.19509799238564313], 'topk_indices': array([   0, 4297, 4277,  593, 8085,   34,  324,   81,   31, 8175,  323,
       8041,   78,  325, 4298, 8174, 4098,   80,  117,   79]), 'topk_tokens': ['<|begin_of_text|>', ' Min', 'nes', ' em', ' location', ' kitchen', '�', 'ER', ' moved', ' before', '�', ' context', ' P', '�', 'nes', ' football', ' football', 'E', 'ION', 'ION'], 'evidence_proportions': [1.64375, 0.804736328125, 2.6612548828125, 0.3419240315755208]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 100}
2025-01-22 04:56:33.182 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:56:33.182 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-42_pid-4_0-2-5-8.pkl | len: 3 |  size: 1.98 KB
Processing depth (0, 2, 5, 8):   5%|▌         | 5/100 [01:41<32:08, 20.30s/it]Processing depth (0, 2, 5, 8):   5%|▌         | 5/100 [01:41<32:15, 20.37s/it]
2025-01-22 04:56:33.253 | INFO     | __main__:<module>:82 - Selected idx: 43
2025-01-22 04:56:33.253 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the location prior to the place where the milk was discarded, left or dropped?
2025-01-22 04:56:33.253 | INFO     | __main__:<module>:84 - Answer: kitchen
2025-01-22 04:56:33.253 | INFO     | __main__:<module>:85 - Tag: 4-hop
2025-01-22 04:56:33.253 | INFO     | __main__:<module>:86 - Needle: [' Daniel moved to the kitchen.', ' Mary travelled to the bedroom.', ' John went back to the garden.', ' Sandra went to the bathroom.', ' Daniel got the milk.', ' Sandra went to the kitchen.', ' Daniel moved to the office.', ' John travelled to the bathroom.', ' John travelled to the kitchen.', ' Sandra journeyed to the bedroom.', ' Daniel left the milk.', ' John went back to the office.']
2025-01-22 04:56:33.253 | INFO     | __main__:<module>:87 - Real Needle: [' Daniel moved to the kitchen.', ' Daniel got the milk.', ' Daniel moved to the office.', ' Daniel left the milk.', ' John went back to the office.']
2025-01-22 04:56:33.254 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['🙆🏿\u200d♂️', '🤸🏾\u200d♂️', '🕺🏿', '💨', '👧🏽', '🇺🇳', '🏈', '♦', '\U0001faf1🏾', '👩🏻\u200d❤\u200d💋\u200d👩🏿']
emoji:
O: 🙆🏿‍♂️ [9468, 247, 228, 9468, 237, 123, 102470, 17245, 224, 31643]
N: 👧🏽 [9468, 239, 100, 9468, 237, 121]

O: 🤸🏾‍♂️ [9468, 97, 116, 9468, 237, 122, 102470, 17245, 224, 31643]
N: 🏈 [9468, 237, 230]

O: 🕺🏿 [9468, 243, 118, 9468, 237, 123]
N: 🫱🏾 [9468, 104, 109, 9468, 237, 122]

O: 💨 [93273, 101]
N: 🤸🏾‍♂️ [9468, 97, 116, 9468, 237, 122, 102470, 17245, 224, 31643]

O: 👧🏽 [9468, 239, 100, 9468, 237, 121]
N: 💨 [93273, 101]

O: 🇺🇳 [9468, 229, 118, 9468, 229, 111]
N: 🕺🏿 [9468, 243, 118, 9468, 237, 123]

O: 🏈 [9468, 237, 230]
N: ♦ [17245, 99]

O: ♦ [17245, 99]
N: 🇺🇳 [9468, 229, 118, 9468, 229, 111]

O: 🫱🏾 [9468, 104, 109, 9468, 237, 122]
N: 🙆🏿‍♂️ [9468, 247, 228, 9468, 237, 123, 102470, 17245, 224, 31643]

O: 👩🏻‍❤‍💋‍👩🏿 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 123]
N: 👩🏻‍❤‍💋‍👩🏿 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 123]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:11,  3.81s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.10s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:11<00:03,  3.84s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  2.75s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  3.18s/it]
Processing depth (0, 2, 4, 7, 9):   0%|          | 0/100 [00:14<?, ?it/s]2025-01-22 04:56:47.662 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the kitchen.
2025-01-22 04:56:47.663 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  moved to the kitchen.
2025-01-22 04:56:47.663 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel got the milk.
2025-01-22 04:56:47.672 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1868, 1872) -->  Daniel got the milk
2025-01-22 04:56:47.672 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 04:56:47.695 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3617, 3622) -->  Hon. Daniel moved to
2025-01-22 04:56:47.695 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the milk.
2025-01-22 04:56:47.722 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5467, 5471) -->  left the milk.
2025-01-22 04:56:47.722 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went back to the office.
2025-01-22 04:56:47.760 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7088, 7094) --> . John went back to the
2025-01-22 04:56:47.760 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the bedroom.
2025-01-22 04:56:47.799 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6994, 6999) --> . Mary travelled to the
2025-01-22 04:56:47.799 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the garden.
2025-01-22 04:56:47.839 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (7088, 7094) --> . John went back to the
2025-01-22 04:56:47.839 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went to the bathroom.
2025-01-22 04:56:47.841 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (257, 262) --> . Sandra went to the
2025-01-22 04:56:47.841 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the kitchen.
2025-01-22 04:56:47.843 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (257, 262) --> . Sandra went to the
2025-01-22 04:56:47.843 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John travelled to the bathroom.
2025-01-22 04:56:47.863 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3979, 3984) -->  travelled to the kitchen.
2025-01-22 04:56:47.863 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John travelled to the kitchen.
2025-01-22 04:56:47.882 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (3978, 3983) -->  John travelled to the kitchen
2025-01-22 04:56:47.882 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Sandra journeyed to the bedroom.
2025-01-22 04:56:47.904 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (3902, 3908) --> . Sandra journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:56:48.662 | INFO     | test_jbb_embedding:begin_test:693 - kitchen<|eot_id|>
2025-01-22 04:56:48.662 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8205])
2025-01-22 04:56:50.924 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [30.771647135416668, 3.309969836973075, 16.43280194256757, 3.169473329906714, 2.7547487070862675], 'topk_indices': array([8197, 8177, 8094,   34,   23,    9, 8199,   28, 8084,   25,   24,
         67, 8204,  105,   68,   14, 8201, 8203,    0, 8200]), 'topk_tokens': ['?\n', '.\n\n', ' location', ' kitchen', '4', ':', ':', '<|end_header_id|>', '.\n\n', '<|eot_id|>', '\n\n', 'ION', '\n\n', 'ION', 'E', '\n', '<|start_header_id|>', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [78.30625, 28.7421875, 15.59921875, 27.71484375, 7.194010416666667]}, 'weight': {'score': [22.12109375, 23.26324546174464, 21.295819256756758, 23.275545254388117, 28.8243838028169], 'topk_indices': array([3295, 3268, 3188, 3140, 7457, 7419, 1431, 1493, 4358, 4342, 5165,
       5226, 7196, 7140, 3451, 3477, 5019, 4961, 4936, 4990]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.809375, 26.611328125, 24.7171875, 20.3515625, 20.0703125]}, 'saliency': {'score': [0.1746988296508789, 0.01811265666582431, 0.09347410459776183, 0.01730911650071777, 0.020304800758899098], 'topk_indices': array([  66,   23,    8,    0, 8184,   14, 8165,   31,   24,   20, 8084,
       8202, 8198, 8094, 8178, 8204,   34,   68,   67,  105]), 'topk_tokens': [' P', '4', ' Date', '<|begin_of_text|>', ' prior', '\n', ' return', ' moved', '\n\n', ' Jul', '.\n\n', 'assistant', 'Answer', ' location', 'Question', '\n\n', ' kitchen', 'E', 'ION', 'ION'], 'evidence_proportions': [0.4380615234375, 0.192474365234375, 0.090155029296875, 0.1412200927734375, 0.036151885986328125]}}, 'pred_res': 'kitchen<|eot_id|>', 'score': 100}
2025-01-22 04:56:50.932 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:56:50.932 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-43_pid-0_0-2-4-7-9.pkl | len: 3 |  size: 2.04 KB
Processing depth (0, 2, 4, 7, 9):   1%|          | 1/100 [00:17<28:59, 17.57s/it]is_0k: False
your chose emoji: ['👩🏿\u200d🍳', '🪆', '👨🏿\u200d🎓', '✡', '🇬🇾', '⚒', '🐚', '🧑🏼\u200d🦼', '🇨🇨', '👩🏿\u200d❤\u200d💋\u200d👩🏻']
emoji:
O: 👩🏿‍🍳 [9468, 239, 102, 9468, 237, 123, 102470, 9468, 235, 111]
N: 👨🏿‍🎓 [9468, 239, 101, 9468, 237, 123, 102470, 9468, 236, 241]

O: 🪆 [9468, 103, 228]
N: 🐚 [9468, 238, 248]

O: 👨🏿‍🎓 [9468, 239, 101, 9468, 237, 123, 102470, 9468, 236, 241]
N: 🇬🇾 [9468, 229, 105, 9468, 229, 122]

O: ✡ [38798, 94]
N: 👩🏿‍🍳 [9468, 239, 102, 9468, 237, 123, 102470, 9468, 235, 111]

O: 🇬🇾 [9468, 229, 105, 9468, 229, 122]
N: 🪆 [9468, 103, 228]

O: ⚒ [158, 248, 240]
N: 🧑🏼‍🦼 [9468, 100, 239, 9468, 237, 120, 102470, 9468, 99, 120]

O: 🐚 [9468, 238, 248]
N: 🇨🇨 [9468, 229, 101, 9468, 229, 101]

O: 🧑🏼‍🦼 [9468, 100, 239, 9468, 237, 120, 102470, 9468, 99, 120]
N: ⚒ [158, 248, 240]

O: 🇨🇨 [9468, 229, 101, 9468, 229, 101]
N: ✡ [38798, 94]

O: 👩🏿‍❤‍💋‍👩🏻 [9468, 239, 102, 9468, 237, 123, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 119]
N: 👩🏿‍❤‍💋‍👩🏻 [9468, 239, 102, 9468, 237, 123, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 119]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.29s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.35s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:03,  3.90s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  2.53s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  3.12s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (2, 4, 5, 7, 8):   1%|          | 1/100 [00:31<28:59, 17.57s/it]2025-01-22 04:57:05.255 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the kitchen.
2025-01-22 04:57:05.265 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1847, 1852) --> . Daniel moved to the
2025-01-22 04:57:05.265 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel got the milk.
2025-01-22 04:57:05.289 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3604, 3608) -->  Daniel got the milk
2025-01-22 04:57:05.289 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 04:57:05.299 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1847, 1852) --> . Daniel moved to the
2025-01-22 04:57:05.299 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the milk.
2025-01-22 04:57:05.331 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5628, 5632) -->  Daniel left the milk
2025-01-22 04:57:05.331 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went back to the office.
2025-01-22 04:57:05.364 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6576, 6582) --> . John went back to the
2025-01-22 04:57:05.364 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the bedroom.
2025-01-22 04:57:05.403 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (7049, 7054) --> . Mary travelled to the
2025-01-22 04:57:05.403 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the garden.
2025-01-22 04:57:05.439 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6576, 6582) --> . John went back to the
2025-01-22 04:57:05.439 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went to the bathroom.
2025-01-22 04:57:05.440 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (251, 256) --> . Sandra went to the
2025-01-22 04:57:05.440 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the kitchen.
2025-01-22 04:57:05.442 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (251, 256) --> . Sandra went to the
2025-01-22 04:57:05.442 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John travelled to the bathroom.
2025-01-22 04:57:05.465 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4007, 4012) -->  the ground. John travelled
2025-01-22 04:57:05.466 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John travelled to the kitchen.
2025-01-22 04:57:05.486 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (4007, 4012) -->  the ground. John travelled
2025-01-22 04:57:05.486 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Sandra journeyed to the bedroom.
2025-01-22 04:57:05.505 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (3914, 3920) --> . Sandra journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:57:09.114 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 04:57:09.114 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8223])
2025-01-22 04:57:12.280 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [194.52669270833334, 12.47644283369803, 97.71537162162163, 11.555065447030007, 5.22374267578125], 'topk_indices': array([5632, 3605, 1853,   28, 3608, 8208,   23, 8112, 8217, 5631,   24,
        257,   14, 3607, 8222, 1849, 8219, 8221, 8218,    0]), 'topk_tokens': ['.', ' got', '.', '<|end_header_id|>', '.', ' milk', '4', ' location', ':', ' milk', '\n\n', '.', '\n', ' milk', '\n\n', ' moved', '<|start_header_id|>', '<|end_header_id|>', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [247.05, 273.375, 247.05, 242.59375, 22.377604166666668]}, 'weight': {'score': [22.158854166666668, 23.288278020909313, 21.399070945945947, 23.300158833435393, 29.4962890625], 'topk_indices': array([3339, 3366, 3221, 3173, 7467, 7505, 1405, 1467, 4364, 4348, 5209,
       5270, 7188, 7244, 3548, 3522, 5034, 5063, 5005, 4980]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.909375, 26.611328125, 19.909375, 26.462890625, 20.0703125]}, 'saliency': {'score': [1.1917266845703125, 0.06905021639656272, 0.571315456081081, 0.06347421528149877, 0.03821775913238525], 'topk_indices': array([5629, 5628, 8220, 3559, 1852, 8202,  256, 8210, 8222,  252, 3605,
       8216, 8196, 3604, 1848, 8112, 8208, 5631, 3607, 1849]), 'topk_tokens': [' left', ' Daniel', 'assistant', ' Ramsey', ' kitchen', ' prior', ' kitchen', ' discarded', '\n\n', ' Sandra', ' got', 'Answer', 'Question', ' Daniel', ' Daniel', ' location', ' milk', ' milk', ' milk', ' moved'], 'evidence_proportions': [1.37265625, 1.9095458984375, 1.37265625, 1.6339111328125, 0.11684163411458333]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 100}
2025-01-22 04:57:12.290 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:57:12.291 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-43_pid-1_2-4-5-7-8.pkl | len: 3 |  size: 2.07 KB
Processing depth (2, 4, 5, 7, 8):   2%|▏         | 2/100 [00:38<32:20, 19.80s/it]is_0k: False
your chose emoji: ['🤽🏿\u200d♂️', '👨🏿\u200d❤️\u200d💋\u200d👨🏽', '📨', '👩🏽\u200d🚀', '🤹🏽\u200d♀️', '🗳️', '🗨', '👨🏼\u200d🤝\u200d👨🏽', '🌔', '👀']
emoji:
O: 🤽🏿‍♂️ [9468, 97, 121, 9468, 237, 123, 102470, 17245, 224, 31643]
N: 🌔 [9468, 234, 242]

O: 👨🏿‍❤️‍💋‍👨🏽 [9468, 239, 101, 9468, 237, 123, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 121]
N: 🤽🏿‍♂️ [9468, 97, 121, 9468, 237, 123, 102470, 17245, 224, 31643]

O: 📨 [9468, 119410]
N: 👨🏿‍❤️‍💋‍👨🏽 [9468, 239, 101, 9468, 237, 123, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 121]

O: 👩🏽‍🚀 [9468, 239, 102, 9468, 237, 121, 102470, 9468, 248, 222]
N: 👩🏽‍🚀 [9468, 239, 102, 9468, 237, 121, 102470, 9468, 248, 222]

O: 🤹🏽‍♀️ [9468, 97, 117, 9468, 237, 121, 102470, 32990, 31643]
N: 🤹🏽‍♀️ [9468, 97, 117, 9468, 237, 121, 102470, 32990, 31643]

O: 🗳️ [9468, 245, 111, 31643]
N: 📨 [9468, 119410]

O: 🗨 [9468, 245, 101]
N: 👨🏼‍🤝‍👨🏽 [9468, 239, 101, 9468, 237, 120, 102470, 9468, 97, 251, 102470, 9468, 239, 101, 9468, 237, 121]

O: 👨🏼‍🤝‍👨🏽 [9468, 239, 101, 9468, 237, 120, 102470, 9468, 97, 251, 102470, 9468, 239, 101, 9468, 237, 121]
N: 🗨 [9468, 245, 101]

O: 🌔 [9468, 234, 242]
N: 🗳️ [9468, 245, 111, 31643]

O: 👀 [9468, 239, 222]
N: 👀 [9468, 239, 222]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.77s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.70s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.50s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.14s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.68s/it]
Processing depth (0, 1, 2, 6, 8):   2%|▏         | 2/100 [00:55<32:20, 19.80s/it]2025-01-22 04:57:28.778 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the kitchen.
2025-01-22 04:57:28.779 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  moved to the kitchen.
2025-01-22 04:57:28.779 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel got the milk.
2025-01-22 04:57:28.784 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (908, 912) -->  Daniel got the milk
2025-01-22 04:57:28.784 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 04:57:28.795 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2015, 2020) -->  cable. Daniel moved to
2025-01-22 04:57:28.795 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the milk.
2025-01-22 04:57:28.822 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4802, 4806) -->  Daniel left the milk
2025-01-22 04:57:28.822 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went back to the office.
2025-01-22 04:57:28.856 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6650, 6656) --> . John went back to the
2025-01-22 04:57:28.856 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the bedroom.
2025-01-22 04:57:28.892 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (7107, 7112) --> . Mary travelled to the
2025-01-22 04:57:28.892 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the garden.
2025-01-22 04:57:28.928 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6650, 6656) --> . John went back to the
2025-01-22 04:57:28.928 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went to the bathroom.
2025-01-22 04:57:28.929 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (257, 262) --> . Sandra went to the
2025-01-22 04:57:28.929 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the kitchen.
2025-01-22 04:57:28.931 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (257, 262) --> . Sandra went to the
2025-01-22 04:57:28.931 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John travelled to the bathroom.
2025-01-22 04:57:28.951 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4063, 4068) --> . John travelled to the
2025-01-22 04:57:28.951 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John travelled to the kitchen.
2025-01-22 04:57:28.972 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (4063, 4068) --> . John travelled to the
2025-01-22 04:57:28.972 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Sandra journeyed to the bedroom.
2025-01-22 04:57:28.994 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (3918, 3924) --> . Sandra journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:57:29.752 | INFO     | test_jbb_embedding:begin_test:693 - kitchen<|eot_id|>
2025-01-22 04:57:29.752 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8245])
2025-01-22 04:57:32.024 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [40.982259114583336, 5.921426974721144, 28.88692989864865, 5.714857586722854, 3.335390195741758], 'topk_indices': array([  34, 8217, 7662, 8239, 7692,   23, 8134,    1, 8124,   25, 7706,
         24, 8241, 8244,   28,   14, 8243, 7707,    0, 8240]), 'topk_tokens': [' kitchen', '.\n\n', 'nes', ':', ' or', '4', ' location', '<|start_header_id|>', '.\n\n', '<|eot_id|>', ' Min', '\n\n', '<|start_header_id|>', '\n\n', '<|end_header_id|>', '\n', '<|end_header_id|>', 'nes', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [107.9375, 43.03125, 24.0484375, 24.681640625, 8.798828125]}, 'weight': {'score': [23.060221354166668, 23.314148126818623, 20.52322635135135, 23.32750568737022, 29.908997252747252], 'topk_indices': array([3309, 3282, 3154, 3202, 7471, 7509, 1416, 1478, 4332, 4348, 5241,
       5180, 7248, 7192, 3465, 3491, 5002, 4950, 4925, 4973]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.809375, 26.611328125, 24.3359375, 26.462890625, 20.0703125]}, 'saliency': {'score': [0.23647626241048178, 0.03283765036197222, 0.1517127784522804, 0.031703449014896905, 0.025264823829734717], 'topk_indices': array([8205, 4068, 7692,  262,   24,   20,    0, 8124, 7399, 8242, 8238,
       8218, 8244, 7662, 8134,  419, 7447,   34, 7706, 7707]), 'topk_tokens': [' return', ' kitchen', ' or', ' kitchen', '\n\n', ' Jul', '<|begin_of_text|>', '.\n\n', 'graph', 'assistant', 'Answer', 'Question', '\n\n', 'nes', ' location', 'otype', ' tele', ' kitchen', ' Min', 'nes'], 'evidence_proportions': [0.58203125, 0.296356201171875, 0.13201904296875, 0.1614837646484375, 0.045636494954427086]}}, 'pred_res': 'kitchen<|eot_id|>', 'score': 100}
2025-01-22 04:57:32.041 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:57:32.041 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-43_pid-2_0-1-2-6-8.pkl | len: 3 |  size: 2.08 KB
Processing depth (0, 1, 2, 6, 8):   3%|▎         | 3/100 [00:58<31:58, 19.78s/it]is_0k: False
your chose emoji: ['✌🏻', '🧎🏻\u200d♀️\u200d➡️', '🧗🏽', '👩🏼\u200d❤\u200d👩🏾', '✊', '👩🏿\u200d🦼', '😼', '🤸🏾\u200d♂️', '👨🏻\u200d❤\u200d💋\u200d👨🏽', '🚶🏽\u200d➡️']
emoji:
O: ✌🏻 [38798, 234, 9468, 237, 119]
N: 👩🏼‍❤‍👩🏾 [9468, 239, 102, 9468, 237, 120, 102470, 121643, 102470, 9468, 239, 102, 9468, 237, 122]

O: 🧎🏻‍♀️‍➡️ [9468, 100, 236, 9468, 237, 119, 102470, 32990, 31643, 102470, 98115, 94, 31643]
N: 😼 [76460, 120]

O: 🧗🏽 [9468, 100, 245, 9468, 237, 121]
N: 👩🏿‍🦼 [9468, 239, 102, 9468, 237, 123, 102470, 9468, 99, 120]

O: 👩🏼‍❤‍👩🏾 [9468, 239, 102, 9468, 237, 120, 102470, 121643, 102470, 9468, 239, 102, 9468, 237, 122]
N: 🤸🏾‍♂️ [9468, 97, 116, 9468, 237, 122, 102470, 17245, 224, 31643]

O: ✊ [38798, 232]
N: 🧗🏽 [9468, 100, 245, 9468, 237, 121]

O: 👩🏿‍🦼 [9468, 239, 102, 9468, 237, 123, 102470, 9468, 99, 120]
N: 🧎🏻‍♀️‍➡️ [9468, 100, 236, 9468, 237, 119, 102470, 32990, 31643, 102470, 98115, 94, 31643]

O: 😼 [76460, 120]
N: ✌🏻 [38798, 234, 9468, 237, 119]

O: 🤸🏾‍♂️ [9468, 97, 116, 9468, 237, 122, 102470, 17245, 224, 31643]
N: 👨🏻‍❤‍💋‍👨🏽 [9468, 239, 101, 9468, 237, 119, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 121]

O: 👨🏻‍❤‍💋‍👨🏽 [9468, 239, 101, 9468, 237, 119, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 121]
N: ✊ [38798, 232]

O: 🚶🏽‍➡️ [9468, 248, 114, 9468, 237, 121, 102470, 98115, 94, 31643]
N: 🚶🏽‍➡️ [9468, 248, 114, 9468, 237, 121, 102470, 98115, 94, 31643]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.03s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.43s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.05s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  2.61s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  3.19s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (1, 2, 4, 6, 7):   3%|▎         | 3/100 [01:13<31:58, 19.78s/it]2025-01-22 04:57:46.524 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the kitchen.
2025-01-22 04:57:46.529 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (901, 906) --> . Daniel moved to the
2025-01-22 04:57:46.529 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel got the milk.
2025-01-22 04:57:46.539 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2012, 2016) -->  Daniel got the milk
2025-01-22 04:57:46.539 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 04:57:46.543 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (901, 906) --> . Daniel moved to the
2025-01-22 04:57:46.544 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the milk.
2025-01-22 04:57:46.568 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5002, 5006) -->  Daniel left the milk
2025-01-22 04:57:46.568 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went back to the office.
2025-01-22 04:57:46.602 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6093, 6099) -->  John went back to the office
2025-01-22 04:57:46.602 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the bedroom.
2025-01-22 04:57:46.638 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (7134, 7139) -->  Mary travelled to the bedroom
2025-01-22 04:57:46.638 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the garden.
2025-01-22 04:57:46.671 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6094, 6100) -->  went back to the office.
2025-01-22 04:57:46.671 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went to the bathroom.
2025-01-22 04:57:46.672 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (251, 256) --> . Sandra went to the
2025-01-22 04:57:46.672 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the kitchen.
2025-01-22 04:57:46.674 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (251, 256) --> . Sandra went to the
2025-01-22 04:57:46.674 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John travelled to the bathroom.
2025-01-22 04:57:46.696 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4117, 4122) --> . John travelled to the
2025-01-22 04:57:46.696 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John travelled to the kitchen.
2025-01-22 04:57:46.717 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (4117, 4122) --> . John travelled to the
2025-01-22 04:57:46.718 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Sandra journeyed to the bedroom.
2025-01-22 04:57:46.738 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (4036, 4042) --> . Sandra journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:57:50.011 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 04:57:50.011 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8251])
2025-01-22 04:57:52.941 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [42.247721354166664, 5.280857671280591, 22.46927787162162, 5.0949457616257785, 2.342222822473404], 'topk_indices': array([  25, 8212, 8244, 8211, 8243, 8225,    1, 8223, 8130,   23, 8215,
       8245,   28,   24,   14, 8250, 8249,    0, 8247, 8246]), 'topk_tokens': ['<|eot_id|>', ' the', 'Answer', ' return', '?\n', ':', '<|start_header_id|>', '.\n\n', '.\n\n', '4', '.', ':', '<|end_header_id|>', '\n\n', '\n', '\n\n', '<|end_header_id|>', '<|begin_of_text|>', '<|start_header_id|>', '<|eot_id|>'], 'evidence_proportions': [67.08125, 44.4609375, 67.08125, 34.32421875, 4.665364583333333]}, 'weight': {'score': [22.9951171875, 23.299684244002908, 21.277238175675677, 23.30970988953985, 29.07247340425532], 'topk_indices': array([3289, 3262, 3134, 3182, 7473, 7511, 1411, 1473, 4276, 4260, 5143,
       5082, 7145, 7201, 3471, 3445, 4931, 4854, 4902, 4879]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.909375, 26.611328125, 19.909375, 26.462890625, 23.415364583333332]}, 'saliency': {'score': [0.2372430165608724, 0.02784625664154785, 0.11872781289590371, 0.026822438770258337, 0.017375743135492852], 'topk_indices': array([  14, 8213,   16,    8, 8219, 8230,   20,   23, 8223,  906, 8130,
       8214, 8220,   24, 8211, 8140, 8244, 8224, 8248, 8250]), 'topk_tokens': ['\n', ' location', ' Date', ' Date', ' anything', ' prior', ' Jul', '4', '.\n\n', ' kitchen', '.\n\n', ' directly', ' else', '\n\n', ' return', ' location', 'Answer', 'Question', 'assistant', '\n\n'], 'evidence_proportions': [0.3457275390625, 0.2997283935546875, 0.3457275390625, 0.2208404541015625, 0.025713602701822918]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 100}
2025-01-22 04:57:52.948 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:57:52.949 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-43_pid-3_1-2-4-6-7.pkl | len: 3 |  size: 2.07 KB
Processing depth (1, 2, 4, 6, 7):   4%|▍         | 4/100 [01:19<32:21, 20.22s/it]is_0k: False
your chose emoji: ['🧑\u200d🧑\u200d🧒\u200d🧒', '👨🏿\u200d🦲', '👩🏼\u200d⚖️', '👩🏿\u200d⚖️', '🧑🏼\u200d🚒', '🚋', '🥘', '🧑🏾\u200d🦽', '👩🏻\u200d❤\u200d💋\u200d👩🏽', '🤎']
emoji:
O: 🧑‍🧑‍🧒‍🧒 [9468, 100, 239, 102470, 9468, 100, 239, 102470, 9468, 100, 240, 102470, 9468, 100, 240]
N: 🧑🏼‍🚒 [9468, 100, 239, 9468, 237, 120, 102470, 9468, 248, 240]

O: 👨🏿‍🦲 [9468, 239, 101, 9468, 237, 123, 102470, 9468, 99, 110]
N: 🥘 [9468, 98, 246]

O: 👩🏼‍⚖️ [9468, 239, 102, 9468, 237, 120, 102470, 158, 248, 244, 31643]
N: 👩🏻‍❤‍💋‍👩🏽 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 121]

O: 👩🏿‍⚖️ [9468, 239, 102, 9468, 237, 123, 102470, 158, 248, 244, 31643]
N: 👨🏿‍🦲 [9468, 239, 101, 9468, 237, 123, 102470, 9468, 99, 110]

O: 🧑🏼‍🚒 [9468, 100, 239, 9468, 237, 120, 102470, 9468, 248, 240]
N: 🚋 [9468, 248, 233]

O: 🚋 [9468, 248, 233]
N: 🧑‍🧑‍🧒‍🧒 [9468, 100, 239, 102470, 9468, 100, 239, 102470, 9468, 100, 240, 102470, 9468, 100, 240]

O: 🥘 [9468, 98, 246]
N: 👩🏼‍⚖️ [9468, 239, 102, 9468, 237, 120, 102470, 158, 248, 244, 31643]

O: 🧑🏾‍🦽 [9468, 100, 239, 9468, 237, 122, 102470, 9468, 99, 121]
N: 🧑🏾‍🦽 [9468, 100, 239, 9468, 237, 122, 102470, 9468, 99, 121]

O: 👩🏻‍❤‍💋‍👩🏽 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 121]
N: 👩🏿‍⚖️ [9468, 239, 102, 9468, 237, 123, 102470, 158, 248, 244, 31643]

O: 🤎 [9468, 97, 236]
N: 🤎 [9468, 97, 236]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.94s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.83s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.52s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.14s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.72s/it]
Processing depth (0, 1, 4, 5, 8):   4%|▍         | 4/100 [01:36<32:21, 20.22s/it]2025-01-22 04:58:09.519 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the kitchen.
2025-01-22 04:58:09.520 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  moved to the kitchen.
2025-01-22 04:58:09.520 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel got the milk.
2025-01-22 04:58:09.523 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (672, 676) -->  Daniel got the milk
2025-01-22 04:58:09.523 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 04:58:09.540 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3542, 3547) --> . Daniel moved to the
2025-01-22 04:58:09.541 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the milk.
2025-01-22 04:58:09.561 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4136, 4140) -->  Daniel left the milk
2025-01-22 04:58:09.561 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went back to the office.
2025-01-22 04:58:09.600 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6522, 6528) --> . John went back to the
2025-01-22 04:58:09.600 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the bedroom.
2025-01-22 04:58:09.638 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (7031, 7036) --> . Mary travelled to the
2025-01-22 04:58:09.639 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the garden.
2025-01-22 04:58:09.691 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6522, 6528) --> . John went back to the
2025-01-22 04:58:09.691 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went to the bathroom.
2025-01-22 04:58:09.693 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (243, 248) --> . Sandra went to the
2025-01-22 04:58:09.693 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the kitchen.
2025-01-22 04:58:09.694 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (243, 248) --> . Sandra went to the
2025-01-22 04:58:09.694 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John travelled to the bathroom.
2025-01-22 04:58:09.718 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3931, 3936) --> . John travelled to the
2025-01-22 04:58:09.718 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  John travelled to the kitchen.
2025-01-22 04:58:09.737 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (3931, 3936) --> . John travelled to the
2025-01-22 04:58:09.737 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Sandra journeyed to the bedroom.
2025-01-22 04:58:09.756 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (3864, 3870) --> . Sandra journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:58:10.508 | INFO     | test_jbb_embedding:begin_test:693 - kitchen<|eot_id|>
2025-01-22 04:58:10.508 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8231])
2025-01-22 04:58:12.733 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [46.599609375, 4.928549877034248, 20.43897804054054, 4.735965603205678, 5.466759091331845], 'topk_indices': array([   9, 8223, 8191, 8203, 8195, 8225, 8120, 8110,   25,   23,    1,
         34,   28,   24,   14, 8230, 8229, 8227,    0, 8226]), 'topk_tokens': [':', '?\n', ' return', '.\n\n', '.', ':', ' location', '.\n\n', '<|eot_id|>', '4', '<|start_header_id|>', ' kitchen', '<|end_header_id|>', '\n\n', '\n', '\n\n', '<|end_header_id|>', '<|start_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [119.3625, 48.4375, 34.875, 26.630859375, 7.821614583333333]}, 'weight': {'score': [22.138020833333332, 23.295330337624485, 20.52322635135135, 23.311278370855256, 29.536272321428573], 'topk_indices': array([3324, 3351, 3196, 3244, 7487, 7449, 1520, 1458, 4369, 4385, 5204,
       5265, 7170, 7226, 3533, 3507, 5029, 5058, 5006, 4981]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.809375, 26.611328125, 19.909375, 26.462890625, 20.0703125]}, 'saliency': {'score': [0.27153968811035156, 0.02673038707823032, 0.11431018726245777, 0.025615022361285825, 0.04046440124511719], 'topk_indices': array([   8, 8203,   16, 8200, 8194,  248, 8204,  111, 8218, 8110, 8210,
         23, 8191,   20, 8224, 8228,   24, 8230, 8120,   34]), 'topk_tokens': [' Date', '.\n\n', ' Date', ' else', ' directly', ' kitchen', 'Question', 'ION', ' discarded', '.\n\n', ' prior', '4', ' return', ' Jul', 'Answer', 'assistant', '\n\n', '\n\n', ' location', ' kitchen'], 'evidence_proportions': [0.683740234375, 0.336212158203125, 0.16630859375, 0.174957275390625, 0.037005106608072914]}}, 'pred_res': 'kitchen<|eot_id|>', 'score': 100}
2025-01-22 04:58:12.737 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:58:12.738 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-43_pid-4_0-1-4-5-8.pkl | len: 3 |  size: 2.07 KB
Processing depth (0, 1, 4, 5, 8):   5%|▌         | 5/100 [01:39<31:46, 20.07s/it]Processing depth (0, 1, 4, 5, 8):   5%|▌         | 5/100 [01:39<31:29, 19.89s/it]
2025-01-22 04:58:12.784 | INFO     | __main__:<module>:82 - Selected idx: 44
2025-01-22 04:58:12.785 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the apple before the garden? 
2025-01-22 04:58:12.785 | INFO     | __main__:<module>:84 - Answer: bathroom
2025-01-22 04:58:12.785 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 04:58:12.785 | INFO     | __main__:<module>:86 - Needle: [' Mary travelled to the bedroom.', ' John went back to the garden.', ' Daniel travelled to the bathroom.', ' Daniel went to the garden.', ' John travelled to the bathroom.', ' Sandra went to the bathroom.', ' Daniel dropped the apple.', ' John travelled to the kitchen.']
2025-01-22 04:58:12.785 | INFO     | __main__:<module>:87 - Real Needle: [' Daniel travelled to the bathroom.', ' Daniel went to the garden.', ' Daniel dropped the apple.', ' John travelled to the kitchen.']
2025-01-22 04:58:12.785 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['🇵🇲', '🚶🏼\u200d♂\u200d➡', '🇪🇸', '🤹🏼\u200d♂', '👨🏽\u200d❤\u200d💋\u200d👨🏼', '🌦️', '🟡', '😳', '⛹🏾\u200d♀', '👩🏻\u200d❤️\u200d👨🏻']
emoji:
O: 🇵🇲 [9468, 229, 113, 9468, 229, 110]
N: 🟡 [9468, 253, 94]

O: 🚶🏼‍♂‍➡ [9468, 248, 114, 9468, 237, 120, 102470, 17245, 224, 102470, 98115, 94]
N: 🇵🇲 [9468, 229, 113, 9468, 229, 110]

O: 🇪🇸 [9468, 229, 103, 9468, 229, 116]
N: ⛹🏾‍♀ [158, 249, 117, 9468, 237, 122, 102470, 32990]

O: 🤹🏼‍♂ [9468, 97, 117, 9468, 237, 120, 102470, 17245, 224]
N: 🌦️ [9468, 234, 99, 31643]

O: 👨🏽‍❤‍💋‍👨🏼 [9468, 239, 101, 9468, 237, 121, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 120]
N: 😳 [76460, 111]

O: 🌦️ [9468, 234, 99, 31643]
N: 👨🏽‍❤‍💋‍👨🏼 [9468, 239, 101, 9468, 237, 121, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 120]

O: 🟡 [9468, 253, 94]
N: 🚶🏼‍♂‍➡ [9468, 248, 114, 9468, 237, 120, 102470, 17245, 224, 102470, 98115, 94]

O: 😳 [76460, 111]
N: 🇪🇸 [9468, 229, 103, 9468, 229, 116]

O: ⛹🏾‍♀ [158, 249, 117, 9468, 237, 122, 102470, 32990]
N: 🤹🏼‍♂ [9468, 97, 117, 9468, 237, 120, 102470, 17245, 224]

O: 👩🏻‍❤️‍👨🏻 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 119]
N: 👩🏻‍❤️‍👨🏻 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 119]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.31s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.70s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.34s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.84s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.43s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (1, 2, 7, 9):   0%|          | 0/100 [00:15<?, ?it/s]2025-01-22 04:58:28.258 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel travelled to the bathroom.
2025-01-22 04:58:28.262 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (835, 840) --> . Daniel travelled to the
2025-01-22 04:58:28.263 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the garden.
2025-01-22 04:58:28.272 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1811, 1816) --> . Daniel went to the
2025-01-22 04:58:28.273 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel dropped the apple.
2025-01-22 04:58:28.304 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5674, 5678) -->  dropped the apple.
2025-01-22 04:58:28.304 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John travelled to the kitchen.
2025-01-22 04:58:28.323 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3223, 3228) --> . John travelled to the
2025-01-22 04:58:28.324 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the bedroom.
2025-01-22 04:58:28.357 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6227, 6232) --> . Mary travelled to the
2025-01-22 04:58:28.357 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the garden.
2025-01-22 04:58:28.381 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4131, 4137) --> . John went back to the
2025-01-22 04:58:28.381 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the bathroom.
2025-01-22 04:58:28.386 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (836, 841) -->  Daniel travelled to the bathroom
2025-01-22 04:58:28.386 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the bathroom.
2025-01-22 04:58:28.418 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5676, 5681) -->  apple. Sandra went to
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:58:31.699 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's hand<|eot_id|>
2025-01-22 04:58:31.699 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8227])
2025-01-22 04:58:34.750 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [757.7894736842105, 55.53933778857837, 556.0535714285714, 52.62681623931624, 48.708767361111114], 'topk_indices': array([1817,   14, 8216, 8210, 8209, 8225, 7702,  840, 8125, 8212, 5507,
       5676, 1816, 8214, 8217, 8218, 8215, 8222,    0, 8223]), 'topk_tokens': ['.', '\n', ' the', ':', 'Question', '<|end_header_id|>', 'nes', ' bathroom', ' location', ' was', '.', ' apple', ' garden', ' apple', ' garden', '?', ' before', '<|eot_id|>', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [846.4, 802.0, 1043.0, 396.8]}, 'weight': {'score': [20.382401315789473, 23.336679829890645, 23.005208333333332, 23.344383394383396, 30.12121212121212], 'topk_indices': array([3289, 3316, 3155, 3203, 7504, 7466, 1509, 1447, 4275, 4291, 5211,
       5150, 7199, 7143, 3472, 3498, 5004, 4975, 4895, 4920]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.01875, 19.665625, 20.97265625, 19.990625]}, 'saliency': {'score': [4.185983758223684, 0.30905245552665556, 3.4742606026785716, 0.2919424352773962, 0.3649954747672033], 'topk_indices': array([5674, 3228, 4137, 7687, 7701, 7643, 8212, 8081, 8211, 8125, 7702,
       8218,  837, 1816, 8209, 5676, 8214,  840, 8215, 8217]), 'topk_tokens': [' dropped', ' bathroom', ' garden', ' or', ' Min', ' three', ' was', ' context', ' Where', ' location', 'nes', '?', ' travelled', ' garden', 'Question', ' apple', ' apple', ' bathroom', ' before', ' garden'], 'evidence_proportions': [4.89375, 4.0984375, 5.939453125, 2.16298828125]}}, 'pred_res': "Daniel's hand<|eot_id|>", 'score': 0}
2025-01-22 04:58:34.758 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:58:34.759 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-44_pid-0_1-2-7-9.pkl | len: 3 |  size: 2.03 KB
Processing depth (1, 2, 7, 9):   1%|          | 1/100 [00:21<36:07, 21.89s/it]is_0k: False
your chose emoji: ['👩🏽\u200d❤️\u200d💋\u200d👩🏾', '🏃🏿\u200d♀️\u200d➡️', '🧑🏻\u200d❤️\u200d🧑🏾', '😣', '👨🏻\u200d❤️\u200d👨🏾', '🙅🏼\u200d♂', '🦫', '👩\u200d⚕️', '🐯', '🤾🏽\u200d♂️']
emoji:
O: 👩🏽‍❤️‍💋‍👩🏾 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 122]
N: 🏃🏿‍♀️‍➡️ [9468, 237, 225, 9468, 237, 123, 102470, 32990, 31643, 102470, 98115, 94, 31643]

O: 🏃🏿‍♀️‍➡️ [9468, 237, 225, 9468, 237, 123, 102470, 32990, 31643, 102470, 98115, 94, 31643]
N: 👩‍⚕️ [9468, 239, 102, 102470, 158, 248, 243, 31643]

O: 🧑🏻‍❤️‍🧑🏾 [9468, 100, 239, 9468, 237, 119, 102470, 121643, 31643, 102470, 9468, 100, 239, 9468, 237, 122]
N: 😣 [76460, 96]

O: 😣 [76460, 96]
N: 🧑🏻‍❤️‍🧑🏾 [9468, 100, 239, 9468, 237, 119, 102470, 121643, 31643, 102470, 9468, 100, 239, 9468, 237, 122]

O: 👨🏻‍❤️‍👨🏾 [9468, 239, 101, 9468, 237, 119, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 122]
N: 👨🏻‍❤️‍👨🏾 [9468, 239, 101, 9468, 237, 119, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 122]

O: 🙅🏼‍♂ [9468, 247, 227, 9468, 237, 120, 102470, 17245, 224]
N: 🐯 [9468, 238, 107]

O: 🦫 [9468, 99, 104]
N: 🦫 [9468, 99, 104]

O: 👩‍⚕️ [9468, 239, 102, 102470, 158, 248, 243, 31643]
N: 🙅🏼‍♂ [9468, 247, 227, 9468, 237, 120, 102470, 17245, 224]

O: 🐯 [9468, 238, 107]
N: 👩🏽‍❤️‍💋‍👩🏾 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 122]

O: 🤾🏽‍♂️ [9468, 97, 122, 9468, 237, 121, 102470, 17245, 224, 31643]
N: 🤾🏽‍♂️ [9468, 97, 122, 9468, 237, 121, 102470, 17245, 224, 31643]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:11,  3.69s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.20s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.27s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.98s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.40s/it]
Processing depth (0, 3, 8, 9):   1%|          | 1/100 [00:37<36:07, 21.89s/it]2025-01-22 04:58:50.088 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel travelled to the bathroom.
2025-01-22 04:58:50.088 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  travelled to the bathroom.
2025-01-22 04:58:50.089 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the garden.
2025-01-22 04:58:50.104 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2723, 2728) --> . Daniel went to the
2025-01-22 04:58:50.104 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel dropped the apple.
2025-01-22 04:58:50.136 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6521, 6525) -->  Daniel dropped the apple
2025-01-22 04:58:50.137 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John travelled to the kitchen.
2025-01-22 04:58:50.152 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3101, 3106) --> . John travelled to the
2025-01-22 04:58:50.152 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the bedroom.
2025-01-22 04:58:50.187 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6182, 6187) --> . Mary travelled to the
2025-01-22 04:58:50.187 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the garden.
2025-01-22 04:58:50.211 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4041, 4047) --> . John went back to the
2025-01-22 04:58:50.211 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the bathroom.
2025-01-22 04:58:50.212 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (31, 36) -->  travelled to the bathroom.
2025-01-22 04:58:50.212 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the bathroom.
2025-01-22 04:58:50.242 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5590, 5595) --> . Sandra went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:58:51.044 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's hand.<|eot_id|>
2025-01-22 04:58:51.045 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8171])
2025-01-22 04:58:53.265 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [354.00657894736844, 25.25819289821385, 208.88095238095238, 24.01620896852717, 20.523877640845072], 'topk_indices': array([8156,   35, 8161, 8158,   24, 8159, 2383, 8069,   34, 8059,   31,
       2728, 3106, 8167, 2369,   14, 8169, 2370,    0, 8166]), 'topk_tokens': [' was', '.', ' garden', ' apple', '\n\n', ' before', 'nes', ' location', ' bathroom', '.\n\n', ' travelled', ' garden', ' bathroom', '<|start_header_id|>', 'nes', '\n', '<|end_header_id|>', 'ot', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [490.8, 333.1, 319.71875, 265.55]}, 'weight': {'score': [21.87952302631579, 23.283991160998287, 20.822916666666668, 23.293625714593066, 29.751980633802816], 'topk_indices': array([3307, 3334, 3221, 3173, 7438, 7400, 1477, 1415, 4311, 4327, 5122,
       5183, 7109, 7165, 3516, 3490, 4976, 4947, 4899, 4924]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.81875, 19.665625, 27.083984375, 19.990625]}, 'saliency': {'score': [2.1071134868421053, 0.14244141939189808, 1.2184477306547619, 0.13507420746442403, 0.1537415410431338], 'topk_indices': array([   8, 2724, 8164, 5595, 3103, 8059, 8025,   30, 6524, 8159, 2383,
       8161, 8069, 8158, 2728, 2369, 2370,   34,   31, 3106]), 'topk_tokens': [' Date', ' Daniel', 'Answer', ' bathroom', ' travelled', '.\n\n', ' context', 'Daniel', ' apple', ' before', 'nes', ' garden', ' location', ' apple', ' garden', 'nes', 'ot', ' bathroom', ' travelled', ' bathroom'], 'evidence_proportions': [3.09111328125, 1.701171875, 2.185791015625, 1.46611328125]}}, 'pred_res': "Daniel's hand.<|eot_id|>", 'score': 0}
2025-01-22 04:58:53.274 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:58:53.274 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-44_pid-1_0-3-8-9.pkl | len: 3 |  size: 2.04 KB
Processing depth (0, 3, 8, 9):   2%|▏         | 2/100 [00:40<32:30, 19.90s/it]is_0k: False
your chose emoji: ['🇫🇷', '✊🏽', '🚵🏻\u200d♀️', '®', '🧍🏻\u200d♀', '🐇', '🏃🏻\u200d♀️\u200d➡', '🧔🏾\u200d♂', '🏪', '👨\u200d👨\u200d👦\u200d👦']
emoji:
O: 🇫🇷 [9468, 229, 104, 9468, 229, 115]
N: ✊🏽 [38798, 232, 9468, 237, 121]

O: ✊🏽 [38798, 232, 9468, 237, 121]
N: 🇫🇷 [9468, 229, 104, 9468, 229, 115]

O: 🚵🏻‍♀️ [9468, 248, 113, 9468, 237, 119, 102470, 32990, 31643]
N: ® [12175]

O: ® [12175]
N: 🚵🏻‍♀️ [9468, 248, 113, 9468, 237, 119, 102470, 32990, 31643]

O: 🧍🏻‍♀ [9468, 100, 235, 9468, 237, 119, 102470, 32990]
N: 🧍🏻‍♀ [9468, 100, 235, 9468, 237, 119, 102470, 32990]

O: 🐇 [9468, 238, 229]
N: 🏪 [9468, 237, 103]

O: 🏃🏻‍♀️‍➡ [9468, 237, 225, 9468, 237, 119, 102470, 32990, 31643, 102470, 98115, 94]
N: 🧔🏾‍♂ [9468, 100, 242, 9468, 237, 122, 102470, 17245, 224]

O: 🧔🏾‍♂ [9468, 100, 242, 9468, 237, 122, 102470, 17245, 224]
N: 🏃🏻‍♀️‍➡ [9468, 237, 225, 9468, 237, 119, 102470, 32990, 31643, 102470, 98115, 94]

O: 🏪 [9468, 237, 103]
N: 🐇 [9468, 238, 229]

O: 👨‍👨‍👦‍👦 [9468, 239, 101, 102470, 9468, 239, 101, 102470, 9468, 239, 99, 102470, 9468, 239, 99]
N: 👨‍👨‍👦‍👦 [9468, 239, 101, 102470, 9468, 239, 101, 102470, 9468, 239, 99, 102470, 9468, 239, 99]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.43s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.15s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.19s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.93s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.41s/it]
Processing depth (2, 4, 5, 8):   2%|▏         | 2/100 [00:55<32:30, 19.90s/it]2025-01-22 04:59:08.785 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel travelled to the bathroom.
2025-01-22 04:59:08.795 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1775, 1780) --> . Daniel travelled to the
2025-01-22 04:59:08.795 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the garden.
2025-01-22 04:59:08.814 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3600, 3605) -->  Hon. Daniel went to
2025-01-22 04:59:08.814 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel dropped the apple.
2025-01-22 04:59:08.835 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4155, 4159) -->  Daniel dropped the apple
2025-01-22 04:59:08.836 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John travelled to the kitchen.
2025-01-22 04:59:08.853 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3233, 3238) --> . John travelled to the
2025-01-22 04:59:08.853 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the bedroom.
2025-01-22 04:59:08.885 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6201, 6206) --> . Mary travelled to the
2025-01-22 04:59:08.885 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the garden.
2025-01-22 04:59:08.907 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4073, 4079) --> . John went back to the
2025-01-22 04:59:08.907 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the bathroom.
2025-01-22 04:59:08.917 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1776, 1781) -->  Daniel travelled to the bathroom
2025-01-22 04:59:08.917 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the bathroom.
2025-01-22 04:59:08.945 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5647, 5652) --> . Sandra went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:59:09.757 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's pocket.<|eot_id|>
2025-01-22 04:59:09.757 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8155])
2025-01-22 04:59:11.970 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [358.1513157894737, 31.492135786957586, 232.19494047619048, 30.208410322739592, 19.934678819444443], 'topk_indices': array([4159,   14, 4158, 8141, 8136, 8139, 8137, 8140, 8138, 8153, 8142,
       8145, 7537, 8146, 7493, 7538, 8143,    0, 8150, 8151]), 'topk_tokens': ['.', '\n', ' apple', ' the', '.\n\n', ' Where', 'Question', ' was', ':', '<|end_header_id|>', ' apple', ' garden', ' Min', '?', 'nes', 'nes', ' before', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [325.75, 355.1, 526.75, 258.725]}, 'weight': {'score': [22.93421052631579, 23.274887380485414, 21.986979166666668, 23.279016344850948, 29.997271825396826], 'topk_indices': array([3276, 3249, 3115, 3163, 7430, 7392, 1473, 1411, 4320, 4336, 5192,
       5131, 7169, 7113, 3432, 3458, 4933, 4908, 4985, 4956]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.01875, 24.4734375, 27.083984375, 19.990625]}, 'saliency': {'score': [2.1865619860197367, 0.17176135400546244, 1.4042619977678572, 0.16385747059485864, 0.15430728972904265], 'topk_indices': array([8147, 1777, 3238, 8138, 3606, 8136, 7345, 1780, 8140, 7492, 4158,
       8139, 8146, 8137, 8142, 8145, 7537, 7493, 7538, 8143]), 'topk_tokens': [' \n', ' travelled', ' bathroom', ':', ' garden', '.\n\n', 'nes', ' bathroom', ' was', ' Min', ' apple', ' Where', '?', 'Question', ' apple', ' garden', ' Min', 'nes', 'nes', ' before'], 'evidence_proportions': [1.92890625, 2.1271484375, 3.6435546875, 1.338037109375]}}, 'pred_res': "Daniel's pocket.<|eot_id|>", 'score': 0}
2025-01-22 04:59:11.973 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:59:11.974 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-44_pid-2_2-4-5-8.pkl | len: 3 |  size: 2.0 KB
Processing depth (2, 4, 5, 8):   3%|▎         | 3/100 [00:59<31:17, 19.35s/it]is_0k: False
your chose emoji: ['☝️', '💅🏻', '💇🏻\u200d♀', '🕺', '🧑🏿\u200d❤\u200d🧑🏾', '⛑️', '🤐', '🚶🏾\u200d♀️\u200d➡', '🤞🏿', '🙂\u200d↔']
emoji:
O: ☝️ [18107, 251, 31643]
N: 🤐 [9468, 97, 238]

O: 💅🏻 [93273, 227, 9468, 237, 119]
N: ☝️ [18107, 251, 31643]

O: 💇🏻‍♀ [93273, 229, 9468, 237, 119, 102470, 32990]
N: 💇🏻‍♀ [93273, 229, 9468, 237, 119, 102470, 32990]

O: 🕺 [9468, 243, 118]
N: 🧑🏿‍❤‍🧑🏾 [9468, 100, 239, 9468, 237, 123, 102470, 121643, 102470, 9468, 100, 239, 9468, 237, 122]

O: 🧑🏿‍❤‍🧑🏾 [9468, 100, 239, 9468, 237, 123, 102470, 121643, 102470, 9468, 100, 239, 9468, 237, 122]
N: 🕺 [9468, 243, 118]

O: ⛑️ [158, 249, 239, 31643]
N: 🚶🏾‍♀️‍➡ [9468, 248, 114, 9468, 237, 122, 102470, 32990, 31643, 102470, 98115, 94]

O: 🤐 [9468, 97, 238]
N: 💅🏻 [93273, 227, 9468, 237, 119]

O: 🚶🏾‍♀️‍➡ [9468, 248, 114, 9468, 237, 122, 102470, 32990, 31643, 102470, 98115, 94]
N: ⛑️ [158, 249, 239, 31643]

O: 🤞🏿 [9468, 97, 252, 9468, 237, 123]
N: 🤞🏿 [9468, 97, 252, 9468, 237, 123]

O: 🙂‍↔ [9468, 19044, 102470, 27017, 242]
N: 🙂‍↔ [9468, 19044, 102470, 27017, 242]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.65s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.99s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.51s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.09s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.68s/it]
Processing depth (0, 4, 7, 8):   3%|▎         | 3/100 [01:15<31:17, 19.35s/it]2025-01-22 04:59:28.492 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel travelled to the bathroom.
2025-01-22 04:59:28.492 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  travelled to the bathroom.
2025-01-22 04:59:28.492 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the garden.
2025-01-22 04:59:28.510 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3617, 3622) --> . Daniel went to the
2025-01-22 04:59:28.510 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel dropped the apple.
2025-01-22 04:59:28.537 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5699, 5703) -->  Daniel dropped the apple
2025-01-22 04:59:28.537 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John travelled to the kitchen.
2025-01-22 04:59:28.553 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3239, 3244) --> . John travelled to the
2025-01-22 04:59:28.553 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the bedroom.
2025-01-22 04:59:28.584 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6257, 6262) --> . Mary travelled to the
2025-01-22 04:59:28.589 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the garden.
2025-01-22 04:59:28.610 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4170, 4176) -->  John went back to the garden
2025-01-22 04:59:28.610 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the bathroom.
2025-01-22 04:59:28.610 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (31, 36) -->  travelled to the bathroom.
2025-01-22 04:59:28.610 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the bathroom.
2025-01-22 04:59:28.638 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5702, 5707) -->  apple. Sandra went to
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:59:29.454 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's hand.<|eot_id|>
2025-01-22 04:59:29.454 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8129])
2025-01-22 04:59:31.666 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [476.04605263157896, 35.02532433595671, 341.0208333333333, 33.195702545724174, 18.9241015625], 'topk_indices': array([8120,   14, 8125,   31, 8114, 4184,   34,   24, 5699, 5702, 8116,
       4183, 4186, 3244, 7983, 8119, 8124, 8117, 8127,    0]), 'topk_tokens': ['?', '\n', '<|start_header_id|>', ' travelled', ' was', 'ch', ' bathroom', '\n\n', ' Daniel', ' apple', ' apple', 'ree', 'outs', ' bathroom', ' context', ' garden', '<|eot_id|>', ' before', '<|end_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [592.5, 315.775, 614.9375, 408.75]}, 'weight': {'score': [21.87952302631579, 23.23822168593212, 22.91592261904762, 23.242248323961938, 28.7465625], 'topk_indices': array([3282, 3255, 3169, 3121, 7408, 7370, 1479, 1417, 4263, 4247, 5080,
       5141, 7085, 7141, 3464, 3438, 4835, 4899, 4928, 4860]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.81875, 19.665625, 27.083984375, 19.990625]}, 'saliency': {'score': [2.8693719161184212, 0.197210399141701, 2.0500895182291665, 0.18612765935878028, 0.14305511474609375], 'topk_indices': array([4175, 5708, 7515,  105, 3241, 7471, 8111, 7516, 8027, 4183, 4186,
       5699, 5702, 8116,   31, 7983,   34, 8117, 8119, 3244]), 'topk_tokens': [' garden', ' bathroom', ' Min', 'ION', ' travelled', 'nes', 'Question', 'nes', ' location', 'ree', 'outs', ' Daniel', ' apple', ' apple', ' travelled', ' context', ' bathroom', ' before', ' garden', ' bathroom'], 'evidence_proportions': [3.5345703125, 1.6873046875, 4.3671875, 2.18798828125]}}, 'pred_res': "Daniel's hand.<|eot_id|>", 'score': 0}
2025-01-22 04:59:31.671 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:59:31.671 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-44_pid-3_0-4-7-8.pkl | len: 3 |  size: 2.05 KB
Processing depth (0, 4, 7, 8):   4%|▍         | 4/100 [01:18<31:11, 19.49s/it]is_0k: False
your chose emoji: ['👨🏼\u200d✈', '🍗', '👲🏻', '🤡', '🦹🏻\u200d♀', '🐿', '🌠', '🧛🏼', '🪂', '👷\u200d♂']
emoji:
O: 👨🏼‍✈ [9468, 239, 101, 9468, 237, 120, 102470, 38798, 230]
N: 🧛🏼 [9468, 100, 249, 9468, 237, 120]

O: 🍗 [9468, 235, 245]
N: 🌠 [9468, 234, 254]

O: 👲🏻 [9468, 239, 110, 9468, 237, 119]
N: 🦹🏻‍♀ [9468, 99, 117, 9468, 237, 119, 102470, 32990]

O: 🤡 [9468, 97, 94]
N: 🤡 [9468, 97, 94]

O: 🦹🏻‍♀ [9468, 99, 117, 9468, 237, 119, 102470, 32990]
N: 👲🏻 [9468, 239, 110, 9468, 237, 119]

O: 🐿 [9468, 238, 123]
N: 🐿 [9468, 238, 123]

O: 🌠 [9468, 234, 254]
N: 👨🏼‍✈ [9468, 239, 101, 9468, 237, 120, 102470, 38798, 230]

O: 🧛🏼 [9468, 100, 249, 9468, 237, 120]
N: 🪂 [9468, 103, 224]

O: 🪂 [9468, 103, 224]
N: 🍗 [9468, 235, 245]

O: 👷‍♂ [9468, 239, 115, 102470, 17245, 224]
N: 👷‍♂ [9468, 239, 115, 102470, 17245, 224]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.05s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.74s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.70s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.30s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.77s/it]
Processing depth (2, 3, 6, 9):   4%|▍         | 4/100 [01:35<31:11, 19.49s/it]2025-01-22 04:59:48.555 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel travelled to the bathroom.
2025-01-22 04:59:48.565 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1841, 1846) --> . Daniel travelled to the
2025-01-22 04:59:48.566 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the garden.
2025-01-22 04:59:48.582 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2871, 2876) --> . Daniel went to the
2025-01-22 04:59:48.582 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel dropped the apple.
2025-01-22 04:59:48.606 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4761, 4765) -->  Daniel dropped the apple
2025-01-22 04:59:48.606 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John travelled to the kitchen.
2025-01-22 04:59:48.623 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3122, 3127) -->  ranks. John travelled to
2025-01-22 04:59:48.623 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the bedroom.
2025-01-22 04:59:48.656 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6179, 6184) --> . Mary travelled to the
2025-01-22 04:59:48.656 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the garden.
2025-01-22 04:59:48.678 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4073, 4079) --> . John went back to the
2025-01-22 04:59:48.679 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the bathroom.
2025-01-22 04:59:48.688 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1842, 1847) -->  Daniel travelled to the bathroom
2025-01-22 04:59:48.688 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the bathroom.
2025-01-22 04:59:48.716 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5629, 5634) --> . Sandra went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 04:59:49.538 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's hand.<|eot_id|>
2025-01-22 04:59:49.539 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8125])
2025-01-22 04:59:51.749 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [603.8947368421053, 45.48460568405512, 393.4166666666667, 43.26942692878338, 44.233723958333336], 'topk_indices': array([2877, 2876, 8013, 4764, 4080, 8111, 8106, 4765, 8109, 8108, 8110,
       8107, 8114, 8112,    0, 8120, 8116, 8115, 8113, 8121]), 'topk_tokens': ['.', ' garden', '.\n\n', ' apple', '.', ' the', '.\n\n', '.', ' Where', ':', ' was', 'Question', ' the', ' apple', '<|begin_of_text|>', '<|eot_id|>', '?', ' garden', ' before', '<|start_header_id|>'], 'evidence_proportions': [633.05, 570.5, 946.0, 334.45]}, 'weight': {'score': [22.935855263157894, 23.242625799704726, 21.986979166666668, 23.246606662648368, 29.366536458333332], 'topk_indices': array([3312, 3285, 3157, 3205, 7366, 7404, 1467, 1405, 4307, 4291, 5113,
       5174, 7137, 7081, 3494, 3468, 4932, 4884, 4961, 4909]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.01875, 19.665625, 27.083984375, 24.8046875]}, 'saliency': {'score': [3.5799496299342106, 0.24817676994744248, 2.4149925595238093, 0.23472389953190684, 0.32654253641764325], 'topk_indices': array([8118, 4714, 4762, 7979, 8108, 1843, 4079, 8106, 8023, 3128, 2876,
       4764, 1846, 8110, 8109, 8116, 8107, 8112, 8113, 8115]), 'topk_tokens': ['Answer', ' house', ' dropped', ' context', ':', ' travelled', ' garden', '.\n\n', ' location', ' bathroom', ' garden', ' apple', ' bathroom', ' was', ' Where', '?', 'Question', ' apple', ' before', ' garden'], 'evidence_proportions': [3.5384765625, 2.930078125, 6.4833984375, 1.94853515625]}}, 'pred_res': "Daniel's hand.<|eot_id|>", 'score': 0}
2025-01-22 04:59:51.756 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 04:59:51.756 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-44_pid-4_2-3-6-9.pkl | len: 3 |  size: 2.0 KB
Processing depth (2, 3, 6, 9):   5%|▌         | 5/100 [01:38<31:11, 19.70s/it]Processing depth (2, 3, 6, 9):   5%|▌         | 5/100 [01:38<31:19, 19.79s/it]
2025-01-22 04:59:51.804 | INFO     | __main__:<module>:82 - Selected idx: 45
2025-01-22 04:59:51.804 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the location prior to the place where the football was discarded, left or dropped?
2025-01-22 04:59:51.804 | INFO     | __main__:<module>:84 - Answer: bathroom
2025-01-22 04:59:51.804 | INFO     | __main__:<module>:85 - Tag: 4-hop
2025-01-22 04:59:51.804 | INFO     | __main__:<module>:86 - Needle: [' John travelled to the bathroom.', ' Daniel travelled to the bathroom.', ' John went back to the garden.', ' Daniel picked up the football.', ' Mary travelled to the bedroom.', ' Daniel went to the garden.', ' Sandra went to the bathroom.', ' Daniel dropped the football.', ' John travelled to the kitchen.']
2025-01-22 04:59:51.804 | INFO     | __main__:<module>:87 - Real Needle: [' Daniel travelled to the bathroom.', ' Daniel picked up the football.', ' Daniel went to the garden.', ' Daniel dropped the football.', ' John travelled to the kitchen.']
2025-01-22 04:59:51.804 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['🧩', '🎅🏾', '👌🏾', '\U0001f6dc', '🙍🏾\u200d♀️', '💵', '⬛', '🏮', '🙅🏿\u200d♂️', '\U0001fa7b']
emoji:
O: 🧩 [9468, 100, 102]
N: 🏮 [9468, 237, 106]

O: 🎅🏾 [9468, 236, 227, 9468, 237, 122]
N: 🙍🏾‍♀️ [9468, 247, 235, 9468, 237, 122, 102470, 32990, 31643]

O: 👌🏾 [9468, 239, 234, 9468, 237, 122]
N: ⬛ [158, 105, 249]

O: 🛜 [9468, 249, 250]
N: 👌🏾 [9468, 239, 234, 9468, 237, 122]

O: 🙍🏾‍♀️ [9468, 247, 235, 9468, 237, 122, 102470, 32990, 31643]
N: 🙅🏿‍♂️ [9468, 247, 227, 9468, 237, 123, 102470, 17245, 224, 31643]

O: 💵 [93273, 113]
N: 🛜 [9468, 249, 250]

O: ⬛ [158, 105, 249]
N: 🧩 [9468, 100, 102]

O: 🏮 [9468, 237, 106]
N: 💵 [93273, 113]

O: 🙅🏿‍♂️ [9468, 247, 227, 9468, 237, 123, 102470, 17245, 224, 31643]
N: 🎅🏾 [9468, 236, 227, 9468, 237, 122]

O: 🩻 [9468, 102, 119]
N: 🩻 [9468, 102, 119]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.36s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.34s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.13s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.86s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.37s/it]
Processing depth (1, 4, 5, 8, 9):   0%|          | 0/100 [00:15<?, ?it/s]2025-01-22 05:00:06.967 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel travelled to the bathroom.
2025-01-22 05:00:06.972 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (902, 907) --> . Daniel travelled to the
2025-01-22 05:00:06.972 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel picked up the football.
2025-01-22 05:00:06.993 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3663, 3668) -->  Daniel picked up the football
2025-01-22 05:00:06.993 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the garden.
2025-01-22 05:00:06.994 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (108, 113) -->  back to the garden.
2025-01-22 05:00:06.994 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel dropped the football.
2025-01-22 05:00:07.025 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6637, 6641) -->  Daniel dropped the football
2025-01-22 05:00:07.025 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John travelled to the kitchen.
2025-01-22 05:00:07.045 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3611, 3616) -->  Hon. John travelled to
2025-01-22 05:00:07.045 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the bathroom.
2025-01-22 05:00:07.050 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (903, 908) -->  Daniel travelled to the bathroom
2025-01-22 05:00:07.050 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the garden.
2025-01-22 05:00:07.050 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (105, 111) --> . John went back to the
2025-01-22 05:00:07.050 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary travelled to the bedroom.
2025-01-22 05:00:07.072 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4184, 4189) --> . Mary travelled to the
2025-01-22 05:00:07.074 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the bathroom.
2025-01-22 05:00:07.081 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1272, 1277) --> . Sandra went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:00:07.860 | INFO     | test_jbb_embedding:begin_test:693 - the garden<|eot_id|>
2025-01-22 05:00:07.860 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8212])
2025-01-22 05:00:10.100 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [218.05729166666666, 20.86794925441266, 149.43303571428572, 19.958229421664626, 16.501790364583332], 'topk_indices': array([8055, 3617,    9, 8186, 8101, 8184, 7954, 8091,    1, 8176, 8056,
        907,   23,   14, 8210,   24, 8208, 8057, 8207,    0]), 'topk_tokens': [' provided', ' bathroom', ':', ':', ' location', '.\n\n', ' Square', '.\n\n', '<|start_header_id|>', '.', ' you', ' bathroom', '4', '\n', '<|end_header_id|>', '\n\n', '<|start_header_id|>', ' context', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [269.225, 202.0, 139.3625, 318.9375, 180.9375]}, 'weight': {'score': [23.6904296875, 23.295079503956178, 21.986979166666668, 23.297280446756425, 29.309151785714285], 'topk_indices': array([3301, 3274, 3146, 3194, 7464, 7426, 1480, 1418, 4333, 4349, 5205,
       5144, 7141, 7197, 3457, 3483, 4969, 4921, 4998, 4946]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.01875, 27.1765625, 18.846875, 27.341796875, 24.7984375]}, 'saliency': {'score': [1.3560689290364583, 0.118195980580493, 0.9645066034226191, 0.1123842946756426, 0.12350282214936756], 'topk_indices': array([8091,  903, 6640, 8197, 8056, 7757,   20,   23, 8055,  904, 8199,
       6637, 8101, 8191,   24, 8185, 7954, 3617,  907, 8057]), 'topk_tokens': ['.\n\n', ' Daniel', ' football', ' football', ' you', 'inen', ' Jul', '4', ' provided', ' travelled', ' discarded', ' Daniel', ' location', ' prior', '\n\n', 'Question', ' Square', ' bathroom', ' bathroom', ' context'], 'evidence_proportions': [1.53486328125, 1.441064453125, 0.68828125, 2.1707763671875, 1.10830078125]}}, 'pred_res': 'the garden<|eot_id|>', 'score': 0}
2025-01-22 05:00:10.108 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:00:10.108 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-45_pid-0_1-4-5-8-9.pkl | len: 3 |  size: 2.1 KB
Processing depth (1, 4, 5, 8, 9):   1%|          | 1/100 [00:18<30:03, 18.21s/it]is_0k: False
your chose emoji: ['💂🏽\u200d♀', '🏃\u200d♂️\u200d➡', '👡', '👨🏽\u200d🔬', '👨\u200d🏭', '👨🏽\u200d❤\u200d👨🏽', '👩\u200d👧\u200d👦', '🧑\u200d🧑\u200d🧒\u200d🧒', '🍆', '📺']
emoji:
O: 💂🏽‍♀ [93273, 224, 9468, 237, 121, 102470, 32990]
N: 👨🏽‍❤‍👨🏽 [9468, 239, 101, 9468, 237, 121, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 121]

O: 🏃‍♂️‍➡ [9468, 237, 225, 102470, 17245, 224, 31643, 102470, 98115, 94]
N: 🏃‍♂️‍➡ [9468, 237, 225, 102470, 17245, 224, 31643, 102470, 98115, 94]

O: 👡 [9468, 239, 94]
N: 👩‍👧‍👦 [9468, 239, 102, 102470, 9468, 239, 100, 102470, 9468, 239, 99]

O: 👨🏽‍🔬 [9468, 239, 101, 9468, 237, 121, 102470, 9468, 242, 105]
N: 💂🏽‍♀ [93273, 224, 9468, 237, 121, 102470, 32990]

O: 👨‍🏭 [9468, 239, 101, 102470, 9468, 237, 255]
N: 👡 [9468, 239, 94]

O: 👨🏽‍❤‍👨🏽 [9468, 239, 101, 9468, 237, 121, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 121]
N: 🍆 [9468, 235, 228]

O: 👩‍👧‍👦 [9468, 239, 102, 102470, 9468, 239, 100, 102470, 9468, 239, 99]
N: 👨🏽‍🔬 [9468, 239, 101, 9468, 237, 121, 102470, 9468, 242, 105]

O: 🧑‍🧑‍🧒‍🧒 [9468, 100, 239, 102470, 9468, 100, 239, 102470, 9468, 100, 240, 102470, 9468, 100, 240]
N: 👨‍🏭 [9468, 239, 101, 102470, 9468, 237, 255]

O: 🍆 [9468, 235, 228]
N: 🧑‍🧑‍🧒‍🧒 [9468, 100, 239, 102470, 9468, 100, 239, 102470, 9468, 100, 240, 102470, 9468, 100, 240]

O: 📺 [9468, 241, 118]
N: 📺 [9468, 241, 118]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:11,  3.98s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.48s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:03,  3.91s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  2.57s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  3.14s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 1, 4, 5, 8):   1%|          | 1/100 [00:32<30:03, 18.21s/it]2025-01-22 05:00:24.495 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel travelled to the bathroom.
2025-01-22 05:00:24.495 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  travelled to the bathroom.
2025-01-22 05:00:24.496 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel picked up the football.
2025-01-22 05:00:24.501 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (804, 809) --> . Daniel picked up the
2025-01-22 05:00:24.501 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the garden.
2025-01-22 05:00:24.502 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (114, 119) -->  back to the garden.
2025-01-22 05:00:24.502 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel dropped the football.
2025-01-22 05:00:24.526 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4159, 4163) -->  Daniel dropped the football
2025-01-22 05:00:24.526 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John travelled to the kitchen.
2025-01-22 05:00:24.543 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3400, 3405) --> . John travelled to the
2025-01-22 05:00:24.543 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the bathroom.
2025-01-22 05:00:24.543 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  travelled to the bathroom.
2025-01-22 05:00:24.543 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the garden.
2025-01-22 05:00:24.544 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (111, 117) --> . John went back to the
2025-01-22 05:00:24.544 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary travelled to the bedroom.
2025-01-22 05:00:24.566 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4118, 4123) --> . Mary travelled to the
2025-01-22 05:00:24.566 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the bathroom.
2025-01-22 05:00:24.572 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1154, 1159) --> . Sandra went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:00:27.889 | INFO     | test_jbb_embedding:begin_test:693 - the garden<|eot_id|>
2025-01-22 05:00:27.890 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8206])
2025-01-22 05:00:30.900 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [310.2239583333333, 23.553953739797784, 277.2291666666667, 22.058699013963743, 27.860484182098766], 'topk_indices': array([8186, 3585, 8202,  111, 8180, 8193, 8204,  809, 8050, 8191,  810,
        112, 8085,   24,   34, 3176, 8051,   14, 8201,    0]), 'topk_tokens': [' to', ' garden', '<|start_header_id|>', '.', ':', ' discarded', '<|end_header_id|>', ' football', ' you', ' football', '.', ' John', '.\n\n', '\n\n', ' bathroom', 'ern', ' context', '\n', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [444.25, 292.3, 281.525, 311.09375, 222.125]}, 'weight': {'score': [21.8525390625, 23.29686357960775, 20.822916666666668, 23.307473167258696, 29.611882716049383], 'topk_indices': array([3356, 3383, 3228, 3276, 7440, 7478, 1484, 1546, 4390, 4374, 5197,
       5258, 7161, 7217, 3571, 3545, 5051, 4974, 5022, 4999]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.81875, 22.3625, 18.846875, 27.341796875, 19.990625]}, 'saliency': {'score': [1.8176472981770833, 0.1328720406908576, 1.5789271763392858, 0.1241996051165942, 0.2095173023365162], 'topk_indices': array([8050, 1159,   24, 8179, 8185, 8199, 8085, 8095, 3405, 3175,   31,
       4162, 3585,  112,  809, 8191, 3176, 8193, 8051,   34]), 'topk_tokens': [' you', ' bathroom', '\n\n', 'Question', ' prior', 'Answer', '.\n\n', ' location', ' bathroom', ' const', ' travelled', ' football', ' garden', ' John', ' football', ' football', 'ern', ' discarded', ' context', ' bathroom'], 'evidence_proportions': [2.77333984375, 1.616015625, 1.34150390625, 2.1932373046875, 1.2392578125]}}, 'pred_res': 'the garden<|eot_id|>', 'score': 0}
2025-01-22 05:00:30.915 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:00:30.915 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-45_pid-1_0-1-4-5-8.pkl | len: 3 |  size: 2.09 KB
Processing depth (0, 1, 4, 5, 8):   2%|▏         | 2/100 [00:39<32:14, 19.74s/it]is_0k: False
your chose emoji: ['👏🏽', '👩🏾\u200d🤝\u200d👩🏽', '🦸\u200d♂️', '🧛\u200d♂', '🙋🏾\u200d♀', '🇭🇺', '🧗🏼\u200d♂️', '🖲', '🙋🏽\u200d♂️', '⛹🏾\u200d♀']
emoji:
O: 👏🏽 [9468, 239, 237, 9468, 237, 121]
N: 👩🏾‍🤝‍👩🏽 [9468, 239, 102, 9468, 237, 122, 102470, 9468, 97, 251, 102470, 9468, 239, 102, 9468, 237, 121]

O: 👩🏾‍🤝‍👩🏽 [9468, 239, 102, 9468, 237, 122, 102470, 9468, 97, 251, 102470, 9468, 239, 102, 9468, 237, 121]
N: 🖲 [9468, 244, 110]

O: 🦸‍♂️ [9468, 99, 116, 102470, 17245, 224, 31643]
N: 🧗🏼‍♂️ [9468, 100, 245, 9468, 237, 120, 102470, 17245, 224, 31643]

O: 🧛‍♂ [9468, 100, 249, 102470, 17245, 224]
N: 🦸‍♂️ [9468, 99, 116, 102470, 17245, 224, 31643]

O: 🙋🏾‍♀ [9468, 247, 233, 9468, 237, 122, 102470, 32990]
N: 🇭🇺 [9468, 229, 255, 9468, 229, 118]

O: 🇭🇺 [9468, 229, 255, 9468, 229, 118]
N: 🙋🏽‍♂️ [9468, 247, 233, 9468, 237, 121, 102470, 17245, 224, 31643]

O: 🧗🏼‍♂️ [9468, 100, 245, 9468, 237, 120, 102470, 17245, 224, 31643]
N: 🙋🏾‍♀ [9468, 247, 233, 9468, 237, 122, 102470, 32990]

O: 🖲 [9468, 244, 110]
N: 👏🏽 [9468, 239, 237, 9468, 237, 121]

O: 🙋🏽‍♂️ [9468, 247, 233, 9468, 237, 121, 102470, 17245, 224, 31643]
N: 🧛‍♂ [9468, 100, 249, 102470, 17245, 224]

O: ⛹🏾‍♀ [158, 249, 117, 9468, 237, 122, 102470, 32990]
N: ⛹🏾‍♀ [158, 249, 117, 9468, 237, 122, 102470, 32990]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.83s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.20s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.12s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.90s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.41s/it]
Processing depth (2, 3, 4, 7, 9):   2%|▏         | 2/100 [00:54<32:14, 19.74s/it]2025-01-22 05:00:46.361 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel travelled to the bathroom.
2025-01-22 05:00:46.372 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1795, 1800) -->  Daniel travelled to the bathroom
2025-01-22 05:00:46.372 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel picked up the football.
2025-01-22 05:00:46.389 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2928, 2933) --> . Daniel picked up the
2025-01-22 05:00:46.389 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the garden.
2025-01-22 05:00:46.390 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (108, 113) -->  back to the garden.
2025-01-22 05:00:46.390 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel dropped the football.
2025-01-22 05:00:46.418 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5789, 5793) -->  Daniel dropped the football
2025-01-22 05:00:46.418 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John travelled to the kitchen.
2025-01-22 05:00:46.435 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3544, 3549) --> . John travelled to the
2025-01-22 05:00:46.436 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the bathroom.
2025-01-22 05:00:46.445 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1796, 1801) -->  travelled to the bathroom.
2025-01-22 05:00:46.445 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the garden.
2025-01-22 05:00:46.445 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (105, 111) --> . John went back to the
2025-01-22 05:00:46.445 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary travelled to the bedroom.
2025-01-22 05:00:46.469 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4201, 4206) -->  Mary travelled to the bedroom
2025-01-22 05:00:46.469 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the bathroom.
2025-01-22 05:00:46.476 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1227, 1232) -->  Republican. Sandra went to
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:00:47.251 | INFO     | test_jbb_embedding:begin_test:693 - the bathroom<|eot_id|>
2025-01-22 05:00:47.251 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8158])
2025-01-22 05:00:49.464 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [121.18229166666667, 15.31606880284279, 112.87946428571429, 14.75056601158206, 15.839432565789474], 'topk_indices': array([  20,   19, 8047, 8130, 4225, 8157, 1233, 4216, 8122, 4214, 8037,
         24, 4213,   14, 8156,   23, 3549,    0, 8153, 8154]), 'topk_tokens': [' Jul', '26', ' location', '.\n\n', 'ree', '\n\n', ' bathroom', 'outs', '.', 'ch', '.\n\n', '\n\n', 'ree', '\n', '<|end_header_id|>', '4', ' bathroom', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [146.3375, 85.65, 97.85, 135.21875, 143.6625]}, 'weight': {'score': [22.87109375, 23.263756356451417, 23.26860119047619, 23.26490497166092, 29.915570175438596], 'topk_indices': array([3280, 3307, 3152, 3200, 7390, 7428, 1418, 1480, 4293, 4277, 5100,
       5161, 7105, 7161, 3463, 3489, 4942, 4913, 4890, 4865]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.7078125, 22.3625, 18.846875, 27.341796875, 19.990625]}, 'saliency': {'score': [0.7360382080078125, 0.08538713655026575, 0.6816929408482143, 0.08192015187736801, 0.12205612450315241], 'topk_indices': array([   8,   22, 8137, 1799, 8145, 8131, 8151, 8143,   24, 8037,   19,
       8047, 4214, 4225,   20,   23, 4216, 1233, 4213, 3549]), 'topk_tokens': [' Date', '202', ' prior', ' bathroom', ' discarded', 'Question', 'Answer', ' football', '\n\n', '.\n\n', '26', ' location', 'ch', 'ree', ' Jul', '4', 'outs', ' bathroom', 'ree', ' bathroom'], 'evidence_proportions': [1.07236328125, 0.4739990234375, 0.502734375, 0.9390869140625, 0.7326171875]}}, 'pred_res': 'the bathroom<|eot_id|>', 'score': 100}
2025-01-22 05:00:49.489 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:00:49.490 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-45_pid-2_2-3-4-7-9.pkl | len: 3 |  size: 2.05 KB
Processing depth (2, 3, 4, 7, 9):   3%|▎         | 3/100 [00:57<31:03, 19.21s/it]is_0k: False
your chose emoji: ['🧎🏾', '🏊🏾\u200d♂', '🙂\u200d↕', '🤟🏿', '🙇🏼', '👩\u200d✈️', '💆\u200d♂️', '🚵', '🎬', '🤽\u200d♀️']
emoji:
O: 🧎🏾 [9468, 100, 236, 9468, 237, 122]
N: 🚵 [9468, 248, 113]

O: 🏊🏾‍♂ [9468, 237, 232, 9468, 237, 122, 102470, 17245, 224]
N: 🧎🏾 [9468, 100, 236, 9468, 237, 122]

O: 🙂‍↕ [9468, 19044, 102470, 27017, 243]
N: 💆‍♂️ [93273, 228, 102470, 17245, 224, 31643]

O: 🤟🏿 [9468, 97, 253, 9468, 237, 123]
N: 🤟🏿 [9468, 97, 253, 9468, 237, 123]

O: 🙇🏼 [9468, 247, 229, 9468, 237, 120]
N: 🙂‍↕ [9468, 19044, 102470, 27017, 243]

O: 👩‍✈️ [9468, 239, 102, 102470, 38798, 230, 31643]
N: 👩‍✈️ [9468, 239, 102, 102470, 38798, 230, 31643]

O: 💆‍♂️ [93273, 228, 102470, 17245, 224, 31643]
N: 🏊🏾‍♂ [9468, 237, 232, 9468, 237, 122, 102470, 17245, 224]

O: 🚵 [9468, 248, 113]
N: 🙇🏼 [9468, 247, 229, 9468, 237, 120]

O: 🎬 [9468, 236, 105]
N: 🎬 [9468, 236, 105]

O: 🤽‍♀️ [9468, 97, 121, 102470, 32990, 31643]
N: 🤽‍♀️ [9468, 97, 121, 102470, 32990, 31643]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.24s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:09,  4.51s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.43s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.15s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.62s/it]
Processing depth (0, 1, 2, 4, 7):   3%|▎         | 3/100 [01:13<31:03, 19.21s/it]2025-01-22 05:01:05.739 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel travelled to the bathroom.
2025-01-22 05:01:05.739 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  travelled to the bathroom.
2025-01-22 05:01:05.739 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel picked up the football.
2025-01-22 05:01:05.744 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (834, 839) --> . Daniel picked up the
2025-01-22 05:01:05.744 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the garden.
2025-01-22 05:01:05.745 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (114, 119) -->  back to the garden.
2025-01-22 05:01:05.745 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel dropped the football.
2025-01-22 05:01:05.765 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3659, 3663) -->  Daniel dropped the football
2025-01-22 05:01:05.765 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John travelled to the kitchen.
2025-01-22 05:01:05.784 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3564, 3569) --> . John travelled to the
2025-01-22 05:01:05.784 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the bathroom.
2025-01-22 05:01:05.784 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  travelled to the bathroom.
2025-01-22 05:01:05.784 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the garden.
2025-01-22 05:01:05.785 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (111, 117) --> . John went back to the
2025-01-22 05:01:05.785 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary travelled to the bedroom.
2025-01-22 05:01:05.808 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4181, 4186) --> . Mary travelled to the
2025-01-22 05:01:05.808 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the bathroom.
2025-01-22 05:01:05.816 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1245, 1250) -->  Republican. Sandra went to
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:01:06.576 | INFO     | test_jbb_embedding:begin_test:693 - the bathroom<|eot_id|>
2025-01-22 05:01:06.577 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8220])
2025-01-22 05:01:08.826 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [149.74739583333334, 13.843242657789128, 126.09895833333333, 13.156146826852531, 10.528470126065342], 'topk_indices': array([  33, 7397, 8122, 8109, 8219,    9,   23,   28, 3139,   24, 8218,
       8099, 3119,  192,   34,   14, 3120, 8215, 8216,    0]), 'topk_tokens': [' the', 'nes', ' the', ' location', '\n\n', ':', '4', '<|end_header_id|>', 'ern', '\n\n', '<|end_header_id|>', '.\n\n', ' const', 'ION', ' bathroom', '\n', 'ern', '<|eot_id|>', '<|start_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [322.875, 97.1875, 106.55, 104.734375, 108.3875]}, 'weight': {'score': [21.8525390625, 23.306242779399245, 21.9765625, 23.313923407312302, 29.54776278409091], 'topk_indices': array([3300, 3327, 3172, 3220, 7482, 7444, 1436, 1498, 4368, 4352, 5193,
       5254, 7165, 7221, 3509, 3483, 5047, 4995, 4970, 5018]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.81875, 22.3625, 18.846875, 27.341796875, 19.990625]}, 'saliency': {'score': [0.8789774576822916, 0.0775304954590972, 0.7549990699404762, 0.07343883892235648, 0.0785780819979581], 'topk_indices': array([   0,  172,   23,   14, 3138, 8193,    8,   24, 8213,   20,   31,
       7397, 8109, 3569, 8099, 3139,  192, 3119, 3120,   34]), 'topk_tokens': ['<|begin_of_text|>', 'ION', '4', '\n', ' const', 'Question', ' Date', '\n\n', 'Answer', ' Jul', ' travelled', 'nes', ' location', ' bathroom', '.\n\n', 'ern', 'ION', ' const', 'ern', ' bathroom'], 'evidence_proportions': [2.057666015625, 0.5505859375, 0.48046875, 0.71734619140625, 0.556494140625]}}, 'pred_res': 'the bathroom<|eot_id|>', 'score': 100}
2025-01-22 05:01:08.834 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:01:08.834 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-45_pid-3_0-1-2-4-7.pkl | len: 3 |  size: 2.06 KB
Processing depth (0, 1, 2, 4, 7):   4%|▍         | 4/100 [01:16<30:49, 19.26s/it]is_0k: False
your chose emoji: ['👨🏽\u200d✈️', '🧑\u200d🔬', '🤞🏿', '🙍\u200d♀️', '🧑🏿\u200d🦰', '👩🏻\u200d❤\u200d💋\u200d👨🏾', '👨\u200d👧\u200d👦', '👩🏻\u200d✈️', '⛹️', '👏🏻']
emoji:
O: 👨🏽‍✈️ [9468, 239, 101, 9468, 237, 121, 102470, 38798, 230, 31643]
N: 🤞🏿 [9468, 97, 252, 9468, 237, 123]

O: 🧑‍🔬 [9468, 100, 239, 102470, 9468, 242, 105]
N: 👩🏻‍✈️ [9468, 239, 102, 9468, 237, 119, 102470, 38798, 230, 31643]

O: 🤞🏿 [9468, 97, 252, 9468, 237, 123]
N: 🙍‍♀️ [9468, 247, 235, 102470, 32990, 31643]

O: 🙍‍♀️ [9468, 247, 235, 102470, 32990, 31643]
N: 👩🏻‍❤‍💋‍👨🏾 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 122]

O: 🧑🏿‍🦰 [9468, 100, 239, 9468, 237, 123, 102470, 9468, 99, 108]
N: 👨🏽‍✈️ [9468, 239, 101, 9468, 237, 121, 102470, 38798, 230, 31643]

O: 👩🏻‍❤‍💋‍👨🏾 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 122]
N: ⛹️ [158, 249, 117, 31643]

O: 👨‍👧‍👦 [9468, 239, 101, 102470, 9468, 239, 100, 102470, 9468, 239, 99]
N: 👨‍👧‍👦 [9468, 239, 101, 102470, 9468, 239, 100, 102470, 9468, 239, 99]

O: 👩🏻‍✈️ [9468, 239, 102, 9468, 237, 119, 102470, 38798, 230, 31643]
N: 🧑🏿‍🦰 [9468, 100, 239, 9468, 237, 123, 102470, 9468, 99, 108]

O: ⛹️ [158, 249, 117, 31643]
N: 🧑‍🔬 [9468, 100, 239, 102470, 9468, 242, 105]

O: 👏🏻 [9468, 239, 237, 9468, 237, 119]
N: 👏🏻 [9468, 239, 237, 9468, 237, 119]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:10,  3.67s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:07<00:08,  4.04s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:11<00:03,  3.96s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  2.58s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  3.07s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 1, 3, 5, 9):   4%|▍         | 4/100 [01:30<30:49, 19.26s/it]2025-01-22 05:01:22.870 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel travelled to the bathroom.
2025-01-22 05:01:22.870 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  travelled to the bathroom.
2025-01-22 05:01:22.871 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel picked up the football.
2025-01-22 05:01:22.876 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (812, 817) --> . Daniel picked up the
2025-01-22 05:01:22.876 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the garden.
2025-01-22 05:01:22.877 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (114, 119) -->  back to the garden.
2025-01-22 05:01:22.877 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel dropped the football.
2025-01-22 05:01:22.902 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4272, 4276) -->  dropped the football.
2025-01-22 05:01:22.902 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John travelled to the kitchen.
2025-01-22 05:01:22.920 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3568, 3573) --> . John travelled to the
2025-01-22 05:01:22.920 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the bathroom.
2025-01-22 05:01:22.920 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  travelled to the bathroom.
2025-01-22 05:01:22.920 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the garden.
2025-01-22 05:01:22.921 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (111, 117) --> . John went back to the
2025-01-22 05:01:22.921 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary travelled to the bedroom.
2025-01-22 05:01:22.942 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4198, 4203) --> . Mary travelled to the
2025-01-22 05:01:22.942 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the bathroom.
2025-01-22 05:01:22.947 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1127, 1132) -->  Sandra went to the bathroom
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:01:25.749 | INFO     | test_jbb_embedding:begin_test:693 - the bathroom<|eot_id|>
2025-01-22 05:01:25.750 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8200])
2025-01-22 05:01:28.733 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [238.22395833333334, 19.247620916128245, 225.61904761904762, 18.072181830718314, 22.863018329326923], 'topk_indices': array([ 117, 8089,   33, 8199, 8079,   29, 2026,   32,   31,   23,   14,
        204, 8196, 8198,   24, 2027, 2108,   34, 8195,    0]), 'topk_tokens': [' garden', ' location', ' the', '\n\n', '.\n\n', '\n\n', ' the', ' to', ' travelled', '4', '\n', 'ION', '<|start_header_id|>', '<|end_header_id|>', '\n\n', ' news', ' the', ' bathroom', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [435.45, 138.825, 245.95, 188.1875, 172.7]}, 'weight': {'score': [20.833984375, 23.283737656954774, 22.177455357142858, 23.293792328082862, 29.164463141025642], 'topk_indices': array([3377, 3350, 3270, 3222, 7468, 7430, 1492, 1554, 4346, 4362, 5163,
       5224, 7207, 7151, 3533, 3559, 4965, 4988, 5017, 4940]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.81875, 22.3625, 18.846875, 21.23046875, 19.990625]}, 'saliency': {'score': [1.3799336751302083, 0.1083204080371701, 1.389892578125, 0.10128047987069824, 0.1649330334785657], 'topk_indices': array([8193, 4203, 3170, 8173,   20,  113, 2107, 8185, 4274,   24, 8089,
       2014,  117, 1131,  817,  204, 3573,   31, 2027,   34]), 'topk_tokens': ['Answer', ' bedroom', 'ern', 'Question', ' Jul', ' went', ' bring', ' football', ' football', '\n\n', ' location', 'fast', ' garden', ' bathroom', ' football', 'ION', ' bathroom', ' travelled', ' news', ' bathroom'], 'evidence_proportions': [2.8169921875, 0.768115234375, 1.26533203125, 1.11236572265625, 0.883349609375]}}, 'pred_res': 'the bathroom<|eot_id|>', 'score': 100}
2025-01-22 05:01:28.738 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:01:28.738 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-45_pid-4_0-1-3-5-9.pkl | len: 3 |  size: 2.08 KB
Processing depth (0, 1, 3, 5, 9):   5%|▌         | 5/100 [01:36<30:51, 19.49s/it]Processing depth (0, 1, 3, 5, 9):   5%|▌         | 5/100 [01:36<30:41, 19.38s/it]
2025-01-22 05:01:28.813 | INFO     | __main__:<module>:82 - Selected idx: 46
2025-01-22 05:01:28.813 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the apple before the office? 
2025-01-22 05:01:28.813 | INFO     | __main__:<module>:84 - Answer: kitchen
2025-01-22 05:01:28.813 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 05:01:28.813 | INFO     | __main__:<module>:86 - Needle: [' John travelled to the bathroom.', ' Mary travelled to the bedroom.', ' Daniel moved to the kitchen.', ' Daniel moved to the office.', ' John went back to the garden.', ' Daniel dropped the apple.', ' Sandra went to the bathroom.']
2025-01-22 05:01:28.813 | INFO     | __main__:<module>:87 - Real Needle: [' Daniel moved to the kitchen.', ' Daniel moved to the office.', ' Daniel dropped the apple.', ' Sandra went to the bathroom.']
2025-01-22 05:01:28.813 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['🆗', '👩🏾\u200d❤\u200d💋\u200d👩🏿', '🇧🇮', '🎢', '👨🏾\u200d⚕', '👩🏾\u200d🦼\u200d➡', '🧎🏼\u200d♂', '📌', '🏊', '🧑🏼\u200d🎄']
emoji:
O: 🆗 [9468, 228, 245]
N: 🇧🇮 [9468, 229, 100, 9468, 229, 106]

O: 👩🏾‍❤‍💋‍👩🏿 [9468, 239, 102, 9468, 237, 122, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 123]
N: 👩🏾‍❤‍💋‍👩🏿 [9468, 239, 102, 9468, 237, 122, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 123]

O: 🇧🇮 [9468, 229, 100, 9468, 229, 106]
N: 👨🏾‍⚕ [9468, 239, 101, 9468, 237, 122, 102470, 158, 248, 243]

O: 🎢 [9468, 236, 95]
N: 👩🏾‍🦼‍➡ [9468, 239, 102, 9468, 237, 122, 102470, 9468, 99, 120, 102470, 98115, 94]

O: 👨🏾‍⚕ [9468, 239, 101, 9468, 237, 122, 102470, 158, 248, 243]
N: 📌 [9468, 241, 234]

O: 👩🏾‍🦼‍➡ [9468, 239, 102, 9468, 237, 122, 102470, 9468, 99, 120, 102470, 98115, 94]
N: 🆗 [9468, 228, 245]

O: 🧎🏼‍♂ [9468, 100, 236, 9468, 237, 120, 102470, 17245, 224]
N: 🧎🏼‍♂ [9468, 100, 236, 9468, 237, 120, 102470, 17245, 224]

O: 📌 [9468, 241, 234]
N: 🏊 [9468, 237, 232]

O: 🏊 [9468, 237, 232]
N: 🎢 [9468, 236, 95]

O: 🧑🏼‍🎄 [9468, 100, 239, 9468, 237, 120, 102470, 9468, 236, 226]
N: 🧑🏼‍🎄 [9468, 100, 239, 9468, 237, 120, 102470, 9468, 236, 226]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.40s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.85s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.50s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.08s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.64s/it]
Processing depth (0, 1, 4, 8):   0%|          | 0/100 [00:16<?, ?it/s]2025-01-22 05:01:45.094 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the kitchen.
2025-01-22 05:01:45.095 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  moved to the kitchen.
2025-01-22 05:01:45.095 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the office.
2025-01-22 05:01:45.101 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (907, 912) --> . Daniel moved to the
2025-01-22 05:01:45.101 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel dropped the apple.
2025-01-22 05:01:45.120 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3609, 3613) -->  Daniel dropped the apple
2025-01-22 05:01:45.121 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the bathroom.
2025-01-22 05:01:45.173 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6625, 6630) --> . Sandra went to the
2025-01-22 05:01:45.173 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the bathroom.
2025-01-22 05:01:45.174 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (189, 194) --> . John travelled to the
2025-01-22 05:01:45.175 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the bedroom.
2025-01-22 05:01:45.210 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6629, 6634) -->  the bathroom. Mary travelled
2025-01-22 05:01:45.210 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the garden.
2025-01-22 05:01:45.226 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3307, 3313) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:01:46.064 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's hand.<|eot_id|>
2025-01-22 05:01:46.065 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8133])
2025-01-22 05:01:48.316 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [470.45723684210526, 36.62183505408063, 192.8984375, 35.29566565856067, 27.101526988636362], 'topk_indices': array([  14,  106,  105,  365, 8131, 8120, 3611, 8031,   31,   67, 3610,
       8021,  184,  337,  181, 8128, 3612, 7987,  185,    0]), 'topk_tokens': ['\n', 'E', 'ION', ' past', '<|end_header_id|>', ' apple', ' the', ' location', ' moved', 'ION', ' dropped', '.\n\n', ' P', ' century', 'G', '<|eot_id|>', ' apple', ' context', 'ION', '<|begin_of_text|>'], 'evidence_proportions': [671.2, 366.4, 835.375, 81.8375]}, 'weight': {'score': [21.62705592105263, 23.255321641470008, 21.7763671875, 23.262061589618565, 29.595170454545453], 'topk_indices': array([3263, 3290, 3183, 3135, 7406, 7368, 1421, 1483, 4292, 4308, 5164,
       5103, 7137, 7081, 3453, 3479, 4957, 4880, 4928, 4905]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.809375, 19.909375, 27.083984375, 20.796875]}, 'saliency': {'score': [2.7350688733552633, 0.2084752985861449, 1.030487060546875, 0.20092592614916369, 0.1938507080078125], 'topk_indices': array([ 105,  180,  112, 8123,  912,   30,  336,  181,  365,  194,   67,
       8031,   34, 8120,   31, 3610,  337, 7987, 3612,  185]), 'topk_tokens': ['ION', 'UG', ' PA', ' office', ' office', 'Daniel', ' past', 'G', ' past', ' bathroom', 'ION', ' location', ' kitchen', ' apple', ' moved', ' dropped', ' century', ' context', ' apple', 'ION'], 'evidence_proportions': [3.63828125, 1.85478515625, 5.5185546875, 0.4853515625]}}, 'pred_res': "Daniel's hand.<|eot_id|>", 'score': 0}
2025-01-22 05:01:48.323 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:01:48.324 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-46_pid-0_0-1-4-8.pkl | len: 3 |  size: 2.0 KB
Processing depth (0, 1, 4, 8):   1%|          | 1/100 [00:19<32:02, 19.42s/it]is_0k: False
your chose emoji: ['💏', '👩🏽', '\U0001fae0', '🇨🇨', '🛄', '💂🏻', '👨🏽\u200d❤️\u200d💋\u200d👨🏻', '☢', '🏎️', '🇨🇶']
emoji:
O: 💏 [93273, 237]
N: 💏 [93273, 237]

O: 👩🏽 [9468, 239, 102, 9468, 237, 121]
N: 🫠 [9468, 104, 254]

O: 🫠 [9468, 104, 254]
N: 💂🏻 [93273, 224, 9468, 237, 119]

O: 🇨🇨 [9468, 229, 101, 9468, 229, 101]
N: 👨🏽‍❤️‍💋‍👨🏻 [9468, 239, 101, 9468, 237, 121, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 119]

O: 🛄 [9468, 75309]
N: ☢ [18107, 95]

O: 💂🏻 [93273, 224, 9468, 237, 119]
N: 👩🏽 [9468, 239, 102, 9468, 237, 121]

O: 👨🏽‍❤️‍💋‍👨🏻 [9468, 239, 101, 9468, 237, 121, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 119]
N: 🛄 [9468, 75309]

O: ☢ [18107, 95]
N: 🏎️ [9468, 237, 236, 31643]

O: 🏎️ [9468, 237, 236, 31643]
N: 🇨🇨 [9468, 229, 101, 9468, 229, 101]

O: 🇨🇶 [9468, 229, 101, 9468, 229, 114]
N: 🇨🇶 [9468, 229, 101, 9468, 229, 114]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:11,  3.92s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.20s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.30s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.07s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.48s/it]
Processing depth (0, 4, 7, 8):   1%|          | 1/100 [00:34<32:02, 19.42s/it]2025-01-22 05:02:03.980 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the kitchen.
2025-01-22 05:02:03.981 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  moved to the kitchen.
2025-01-22 05:02:03.981 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the office.
2025-01-22 05:02:03.999 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3602, 3607) --> . Daniel moved to the
2025-01-22 05:02:03.999 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel dropped the apple.
2025-01-22 05:02:04.049 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5707, 5711) -->  Daniel dropped the apple
2025-01-22 05:02:04.050 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the bathroom.
2025-01-22 05:02:04.084 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6623, 6628) --> . Sandra went to the
2025-01-22 05:02:04.084 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the bathroom.
2025-01-22 05:02:04.085 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (189, 194) --> . John travelled to the
2025-01-22 05:02:04.085 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the bedroom.
2025-01-22 05:02:04.125 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6627, 6632) -->  the bathroom. Mary travelled
2025-01-22 05:02:04.125 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the garden.
2025-01-22 05:02:04.142 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3305, 3311) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:02:04.974 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's hand.<|eot_id|>
2025-01-22 05:02:04.974 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8143])
2025-01-22 05:02:07.188 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [449.88486842105266, 38.793410876503806, 296.44140625, 37.322185920355075, 15.210514322916667], 'topk_indices': array([ 180,   24,   32, 8069,   68,  166,   69, 5710,   31,  112, 3311,
        106,  165,  105,   14,   67,  184,  181,  185,    0]), 'topk_tokens': ['UG', '\n\n', ' to', ' moved', 'E', 'E', 'ER', ' apple', ' moved', ' PA', ' garden', 'E', 'ION', 'ION', '\n', 'ION', ' P', 'G', 'ION', '<|begin_of_text|>'], 'evidence_proportions': [794.1, 346.025, 599.5625, 89.7875]}, 'weight': {'score': [21.62705592105263, 23.26093136201817, 21.7763671875, 23.26768720718777, 29.44765625], 'topk_indices': array([3261, 3288, 3181, 3133, 7398, 7360, 1473, 1411, 4305, 4289, 5100,
       5161, 7119, 7063, 3451, 3477, 4954, 4877, 4925, 4902]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.809375, 19.909375, 27.083984375, 20.796875]}, 'saliency': {'score': [2.626027960526316, 0.2213595114262368, 1.5661163330078125, 0.21307387344347184, 0.11133982340494791], 'topk_indices': array([  69, 7997, 8131,  106,   74,  194,   30,  180, 8069,  184,   34,
        105,  165,  112,  181,   31, 5710, 3311,   67,  185]), 'topk_tokens': ['ER', ' context', ' before', 'E', ' PA', ' bathroom', 'Daniel', 'UG', ' moved', ' P', ' kitchen', 'ION', 'ION', ' PA', 'G', ' moved', ' apple', ' garden', 'ION', 'ION'], 'evidence_proportions': [4.2365234375, 1.8291015625, 4.23583984375, 0.524609375]}}, 'pred_res': "Daniel's hand.<|eot_id|>", 'score': 0}
2025-01-22 05:02:07.195 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:02:07.195 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-46_pid-1_0-4-7-8.pkl | len: 3 |  size: 1.92 KB
Processing depth (0, 4, 7, 8):   2%|▏         | 2/100 [00:38<31:11, 19.10s/it]is_0k: False
your chose emoji: ['🖥️', '\U0001faaf', '🚀', '🇩🇲', '🚵🏿\u200d♀️', '🙆🏻', '🧜🏻\u200d♀️', '🚵🏼\u200d♀', '🧙🏽\u200d♀️', '🎗']
emoji:
O: 🖥️ [9468, 244, 98, 31643]
N: 🪯 [9468, 103, 107]

O: 🪯 [9468, 103, 107]
N: 🙆🏻 [9468, 247, 228, 9468, 237, 119]

O: 🚀 [9468, 248, 222]
N: 🚀 [9468, 248, 222]

O: 🇩🇲 [9468, 229, 102, 9468, 229, 110]
N: 🧙🏽‍♀️ [9468, 100, 247, 9468, 237, 121, 102470, 32990, 31643]

O: 🚵🏿‍♀️ [9468, 248, 113, 9468, 237, 123, 102470, 32990, 31643]
N: 🚵🏿‍♀️ [9468, 248, 113, 9468, 237, 123, 102470, 32990, 31643]

O: 🙆🏻 [9468, 247, 228, 9468, 237, 119]
N: 🧜🏻‍♀️ [9468, 100, 250, 9468, 237, 119, 102470, 32990, 31643]

O: 🧜🏻‍♀️ [9468, 100, 250, 9468, 237, 119, 102470, 32990, 31643]
N: 🚵🏼‍♀ [9468, 248, 113, 9468, 237, 120, 102470, 32990]

O: 🚵🏼‍♀ [9468, 248, 113, 9468, 237, 120, 102470, 32990]
N: 🖥️ [9468, 244, 98, 31643]

O: 🧙🏽‍♀️ [9468, 100, 247, 9468, 237, 121, 102470, 32990, 31643]
N: 🇩🇲 [9468, 229, 102, 9468, 229, 110]

O: 🎗 [9468, 236, 245]
N: 🎗 [9468, 236, 245]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.08s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.19s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:11<00:03,  3.85s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  2.71s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  3.19s/it]
Processing depth (2, 4, 5, 6):   2%|▏         | 2/100 [00:52<31:11, 19.10s/it]2025-01-22 05:02:21.743 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the kitchen.
2025-01-22 05:02:21.753 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1845, 1850) --> . Daniel moved to the
2025-01-22 05:02:21.753 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the office.
2025-01-22 05:02:21.762 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1845, 1850) --> . Daniel moved to the
2025-01-22 05:02:21.762 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel dropped the apple.
2025-01-22 05:02:21.784 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4185, 4189) -->  Daniel dropped the apple
2025-01-22 05:02:21.784 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the bathroom.
2025-01-22 05:02:21.814 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4793, 4798) -->  the senate. Sandra went
2025-01-22 05:02:21.814 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the bathroom.
2025-01-22 05:02:21.815 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (183, 188) --> . John travelled to the
2025-01-22 05:02:21.815 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the bedroom.
2025-01-22 05:02:21.850 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6633, 6638) --> . Mary travelled to the
2025-01-22 05:02:21.850 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the garden.
2025-01-22 05:02:21.866 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3329, 3335) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:02:22.718 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's hand.<|eot_id|>
2025-01-22 05:02:22.718 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8201])
2025-01-22 05:02:24.954 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [274.00411184210526, 17.506515495490007, 129.716796875, 16.690158679152894, 11.773613061797754], 'topk_indices': array([   9, 8182,  189, 4187, 8089, 4186, 3632,    1,    3, 8189, 4188,
       8191, 1847,   14, 8099,   24, 8197, 8196, 8199,    0]), 'topk_tokens': [':', '.\n\n', '.', ' the', '.\n\n', ' dropped', ' moved', '<|start_header_id|>', '<|end_header_id|>', ' before', ' apple', ' office', ' moved', '\n', ' location', '\n\n', '<|start_header_id|>', '<|eot_id|>', '<|end_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [340.625, 340.625, 409.6875, 32.215625]}, 'weight': {'score': [22.89761513157895, 23.313892232447586, 20.259765625, 23.320842323111766, 29.882198033707866], 'topk_indices': array([3312, 3285, 3205, 3157, 7424, 7462, 1409, 1471, 4342, 4326, 5204,
       5143, 7145, 7201, 3475, 3501, 4997, 4920, 4945, 4968]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.909375, 19.909375, 27.083984375, 25.525]}, 'saliency': {'score': [1.6528223941200657, 0.09804238440756795, 0.698486328125, 0.09325013036374173, 0.09111108672752809], 'topk_indices': array([8198, 8185, 8089, 8170, 8098, 1850, 8183,  188, 1846, 8188,  185,
       8194,   24, 4186, 3632, 8189, 8191, 4188, 8099, 1847]), 'topk_tokens': ['assistant', ' Where', '.\n\n', ' return', ' first', ' kitchen', 'Question', ' bathroom', ' Daniel', ' apple', ' travelled', 'Answer', '\n\n', ' dropped', ' moved', ' before', ' office', ' apple', ' location', ' moved'], 'evidence_proportions': [1.9470703125, 1.9470703125, 2.710205078125, 0.21842041015625]}}, 'pred_res': "Daniel's hand.<|eot_id|>", 'score': 0}
2025-01-22 05:02:24.961 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:02:24.961 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-46_pid-2_2-4-5-6.pkl | len: 3 |  size: 2.06 KB
Processing depth (2, 4, 5, 6):   3%|▎         | 3/100 [00:56<29:53, 18.49s/it]is_0k: False
your chose emoji: ['🏃\u200d♀️\u200d➡', '✂', '👳🏻\u200d♂', '👰\u200d♂️', '🧑🏿\u200d✈️', '👩🏿\u200d🦼\u200d➡', '🤸🏽\u200d♀️', '🕴🏿', '👨\u200d👨\u200d👧\u200d👧', '🧖🏽\u200d♀️']
emoji:
O: 🏃‍♀️‍➡ [9468, 237, 225, 102470, 32990, 31643, 102470, 98115, 94]
N: ✂ [38798, 224]

O: ✂ [38798, 224]
N: 👨‍👨‍👧‍👧 [9468, 239, 101, 102470, 9468, 239, 101, 102470, 9468, 239, 100, 102470, 9468, 239, 100]

O: 👳🏻‍♂ [9468, 239, 111, 9468, 237, 119, 102470, 17245, 224]
N: 👰‍♂️ [9468, 239, 108, 102470, 17245, 224, 31643]

O: 👰‍♂️ [9468, 239, 108, 102470, 17245, 224, 31643]
N: 🏃‍♀️‍➡ [9468, 237, 225, 102470, 32990, 31643, 102470, 98115, 94]

O: 🧑🏿‍✈️ [9468, 100, 239, 9468, 237, 123, 102470, 38798, 230, 31643]
N: 👩🏿‍🦼‍➡ [9468, 239, 102, 9468, 237, 123, 102470, 9468, 99, 120, 102470, 98115, 94]

O: 👩🏿‍🦼‍➡ [9468, 239, 102, 9468, 237, 123, 102470, 9468, 99, 120, 102470, 98115, 94]
N: 🕴🏿 [9468, 243, 112, 9468, 237, 123]

O: 🤸🏽‍♀️ [9468, 97, 116, 9468, 237, 121, 102470, 32990, 31643]
N: 🤸🏽‍♀️ [9468, 97, 116, 9468, 237, 121, 102470, 32990, 31643]

O: 🕴🏿 [9468, 243, 112, 9468, 237, 123]
N: 🧑🏿‍✈️ [9468, 100, 239, 9468, 237, 123, 102470, 38798, 230, 31643]

O: 👨‍👨‍👧‍👧 [9468, 239, 101, 102470, 9468, 239, 101, 102470, 9468, 239, 100, 102470, 9468, 239, 100]
N: 👳🏻‍♂ [9468, 239, 111, 9468, 237, 119, 102470, 17245, 224]

O: 🧖🏽‍♀️ [9468, 100, 244, 9468, 237, 121, 102470, 32990, 31643]
N: 🧖🏽‍♀️ [9468, 100, 244, 9468, 237, 121, 102470, 32990, 31643]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.57s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.80s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.51s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  2.96s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.57s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (3, 4, 5, 6):   3%|▎         | 3/100 [01:12<29:53, 18.49s/it]2025-01-22 05:02:41.203 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the kitchen.
2025-01-22 05:02:41.217 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2960, 2965) -->  tragedy. Daniel moved to
2025-01-22 05:02:41.217 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the office.
2025-01-22 05:02:41.235 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2960, 2965) -->  tragedy. Daniel moved to
2025-01-22 05:02:41.236 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel dropped the apple.
2025-01-22 05:02:41.257 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4248, 4252) -->  dropped the apple.
2025-01-22 05:02:41.257 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the bathroom.
2025-01-22 05:02:41.280 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4797, 4802) -->  the senate. Sandra went
2025-01-22 05:02:41.281 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the bathroom.
2025-01-22 05:02:41.281 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (183, 188) --> . John travelled to the
2025-01-22 05:02:41.282 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the bedroom.
2025-01-22 05:02:41.314 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6646, 6651) --> . Mary travelled to the
2025-01-22 05:02:41.314 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the garden.
2025-01-22 05:02:41.332 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3345, 3351) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:02:45.640 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's hand.<|eot_id|>
2025-01-22 05:02:45.640 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8210])
2025-01-22 05:02:48.824 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [402.60567434210526, 30.381586356995008, 213.373046875, 29.15877869741991, 39.892391123670215], 'topk_indices': array([8098, 1704, 2966, 2962, 2965, 1626, 8198,   24,   14, 8200, 4251,
       8108, 4250, 2963, 1705, 8206, 1627, 8205, 8208,    0]), 'topk_tokens': ['.\n\n', ' summer', ' kitchen', ' Daniel', ' the', "'s", ' before', '\n\n', '\n', ' office', '.', ' location', ' apple', ' moved', "'s", '<|start_header_id|>', ' work', '<|eot_id|>', '<|end_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [500.4125, 500.4125, 613.125, 38.5765625]}, 'weight': {'score': [24.667763157894736, 23.316576996834286, 20.259765625, 23.319418332721938, 28.974900265957448], 'topk_indices': array([3328, 3301, 3199, 3151, 7397, 7435, 1405, 1467, 4318, 4334, 5208,
       5147, 7118, 7174, 3491, 3517, 4949, 4972, 5001, 4924]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [25.7171875, 25.7171875, 20.97265625, 25.525]}, 'saliency': {'score': [2.3854868035567436, 0.1735786633994886, 1.1359786987304688, 0.16655681756575377, 0.2776550942278923], 'topk_indices': array([8194,  148, 4254, 1626, 3647, 3648,  185, 1705, 8198, 8197, 4247,
       1704,  188, 2962, 2966, 8200, 8108, 1627, 2963, 4250]), 'topk_tokens': [' Where', 'ORE', '�', "'s", ' Daniel', ' moved', ' travelled', "'s", ' before', ' apple', ' Daniel', ' summer', ' bathroom', ' Daniel', ' kitchen', ' office', ' location', ' work', ' moved', ' apple'], 'evidence_proportions': [3.07802734375, 3.07802734375, 3.299072265625, 0.269537353515625]}}, 'pred_res': "Daniel's hand.<|eot_id|>", 'score': 0}
2025-01-22 05:02:48.851 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:02:48.851 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-46_pid-3_3-4-5-6.pkl | len: 3 |  size: 2.03 KB
Processing depth (3, 4, 5, 6):   4%|▍         | 4/100 [01:19<32:59, 20.62s/it]is_0k: False
your chose emoji: ['👩🏽\u200d❤\u200d💋\u200d👩🏻', '🧑🏽\u200d❤️\u200d🧑🏼', '*⃣', '\U0001faf4🏿', '🧛🏾\u200d♂️', '🛣', '🧑🏾\u200d⚖️', '🙎🏾', '🧑🏽\u200d🦰', '⛹🏿\u200d♂️']
emoji:
O: 👩🏽‍❤‍💋‍👩🏻 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 119]
N: 🛣 [9468, 249, 96]

O: 🧑🏽‍❤️‍🧑🏼 [9468, 100, 239, 9468, 237, 121, 102470, 121643, 31643, 102470, 9468, 100, 239, 9468, 237, 120]
N: 👩🏽‍❤‍💋‍👩🏻 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 119]

O: *⃣ [9, 158, 225, 96]
N: 🧑🏾‍⚖️ [9468, 100, 239, 9468, 237, 122, 102470, 158, 248, 244, 31643]

O: 🫴🏿 [9468, 104, 112, 9468, 237, 123]
N: 🧛🏾‍♂️ [9468, 100, 249, 9468, 237, 122, 102470, 17245, 224, 31643]

O: 🧛🏾‍♂️ [9468, 100, 249, 9468, 237, 122, 102470, 17245, 224, 31643]
N: 🙎🏾 [9468, 247, 236, 9468, 237, 122]

O: 🛣 [9468, 249, 96]
N: ⃣ Marshall [158, 225, 96, 30508]

O: 🧑🏾‍⚖️ [9468, 100, 239, 9468, 237, 122, 102470, 158, 248, 244, 31643]
N: ��🏿 The [104, 112, 9468, 237, 123, 578]

O: 🙎🏾 [9468, 247, 236, 9468, 237, 122]
N: ��🏽‍🦰 Among [100, 239, 9468, 237, 121, 102470, 9468, 99, 108, 22395]

O: 🧑🏽‍🦰 [9468, 100, 239, 9468, 237, 121, 102470, 9468, 99, 108]
N: ��🏽‍❤️‍🧑🏼 I [100, 239, 9468, 237, 121, 102470, 121643, 31643, 102470, 9468, 100, 239, 9468, 237, 120, 358]

O: ⛹🏿‍♂️ [158, 249, 117, 9468, 237, 123, 102470, 17245, 224, 31643]
N: ��🏿‍♂️
 [249, 117, 9468, 237, 123, 102470, 17245, 224, 31643, 198]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.77s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.74s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.64s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.27s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.79s/it]
Processing depth (0, 1, 2, 8):   4%|▍         | 4/100 [01:36<32:59, 20.62s/it]2025-01-22 05:03:05.761 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the kitchen.
2025-01-22 05:03:05.762 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  moved to the kitchen.
2025-01-22 05:03:05.762 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the office.
2025-01-22 05:03:05.771 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (907, 912) --> . Daniel moved to the
2025-01-22 05:03:05.771 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel dropped the apple.
2025-01-22 05:03:05.780 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1808, 1812) -->  Daniel dropped the apple
2025-01-22 05:03:05.780 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the bathroom.
2025-01-22 05:03:05.813 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6627, 6632) --> . Sandra went to the
2025-01-22 05:03:05.813 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the bathroom.
2025-01-22 05:03:05.814 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (189, 194) --> . John travelled to the
2025-01-22 05:03:05.814 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the bedroom.
2025-01-22 05:03:05.847 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6631, 6636) -->  the bathroom. Mary travelled
2025-01-22 05:03:05.847 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the garden.
2025-01-22 05:03:05.865 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3440, 3446) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:03:06.668 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's hand.<|eot_id|>
2025-01-22 05:03:06.668 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8141])
2025-01-22 05:03:08.898 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [266.7730263157895, 29.424994627946955, 177.0947265625, 28.577500693673695, 10.803909560381356], 'topk_indices': array([7364, 6071, 4229, 8136, 6072, 1811,  337, 7490,  194, 6079, 7995,
       5943, 7263, 7533, 7264,  195, 7489, 7534,    0, 7535]), 'topk_tokens': [' tele', '\n', 'outs', '<|eot_id|>', 'the', ' apple', ' century', 'ot', ' bathroom', ' the', ' context', ' office', 'nes', ' Min', 'ot', '.', 'nes', 'nes', '<|begin_of_text|>', 'ot'], 'evidence_proportions': [491.45, 177.925, 338.1875, 73.8125]}, 'weight': {'score': [21.62705592105263, 23.263359144769154, 21.7763671875, 23.270127134973485, 29.720074152542374], 'topk_indices': array([3301, 3274, 3194, 3146, 7426, 7388, 1443, 1505, 4290, 4306, 5162,
       5101, 7165, 7109, 3464, 3490, 4878, 4926, 4903, 4955]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.809375, 19.909375, 27.083984375, 20.796875]}, 'saliency': {'score': [1.512341951069079, 0.16844659891484529, 0.9139328002929688, 0.16382681954464176, 0.08117378364175053], 'topk_indices': array([7315, 7490, 6072,  365, 7488,  191,   34, 4229,  337, 1811, 7364,
       7264, 7995, 5943, 7263,  194, 7533, 7489, 7535, 7534]), 'topk_tokens': [' tele', 'ot', 'the', ' past', ' Min', ' travelled', ' kitchen', 'outs', ' century', ' apple', ' tele', 'ot', ' context', ' office', 'nes', ' bathroom', ' Min', 'nes', 'ot', 'nes'], 'evidence_proportions': [2.578125, 0.8634765625, 2.3565673828125, 0.4200439453125]}}, 'pred_res': "Daniel's hand.<|eot_id|>", 'score': 0}
2025-01-22 05:03:08.902 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:03:08.902 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-46_pid-4_0-1-2-8.pkl | len: 3 |  size: 1.97 KB
Processing depth (0, 1, 2, 8):   5%|▌         | 5/100 [01:39<32:19, 20.42s/it]Processing depth (0, 1, 2, 8):   5%|▌         | 5/100 [01:40<31:40, 20.01s/it]
2025-01-22 05:03:08.955 | INFO     | __main__:<module>:82 - Selected idx: 47
2025-01-22 05:03:08.955 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the location prior to the place where the milk was discarded, left or dropped?
2025-01-22 05:03:08.955 | INFO     | __main__:<module>:84 - Answer: kitchen
2025-01-22 05:03:08.955 | INFO     | __main__:<module>:85 - Tag: 4-hop
2025-01-22 05:03:08.955 | INFO     | __main__:<module>:86 - Needle: [' Daniel moved to the kitchen.', ' John travelled to the bathroom.', ' Daniel grabbed the milk.', ' Mary travelled to the bedroom.', ' John went back to the garden.', ' Daniel moved to the office.', ' Daniel dropped the milk.', ' Sandra went to the bathroom.']
2025-01-22 05:03:08.955 | INFO     | __main__:<module>:87 - Real Needle: [' Daniel moved to the kitchen.', ' Daniel grabbed the milk.', ' Daniel moved to the office.', ' Daniel dropped the milk.', ' Sandra went to the bathroom.']
2025-01-22 05:03:08.955 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['👩🏻\u200d✈', '🤍', '👩\u200d❤️\u200d👨', '◽', '👩🏻\u200d🦽\u200d➡️', '👉🏿', '🧖', 'ℹ️', '☀️', '\U0001faf1🏻']
emoji:
O: 👩🏻‍✈ [9468, 239, 102, 9468, 237, 119, 102470, 38798, 230]
N: 👩‍❤️‍👨 [9468, 239, 102, 102470, 121643, 31643, 102470, 9468, 239, 101]

O: 🤍 [9468, 97, 235]
N: 🤍 [9468, 97, 235]

O: 👩‍❤️‍👨 [9468, 239, 102, 102470, 121643, 31643, 102470, 9468, 239, 101]
N: 👩🏻‍✈ [9468, 239, 102, 9468, 237, 119, 102470, 38798, 230]

O: ◽ [41832, 121]
N: 👉🏿 [9468, 239, 231, 9468, 237, 123]

O: 👩🏻‍🦽‍➡️ [9468, 239, 102, 9468, 237, 119, 102470, 9468, 99, 121, 102470, 98115, 94, 31643]
N: 👩🏻‍🦽‍➡️ [9468, 239, 102, 9468, 237, 119, 102470, 9468, 99, 121, 102470, 98115, 94, 31643]

O: 👉🏿 [9468, 239, 231, 9468, 237, 123]
N: ☀️ [18107, 222, 31643]

O: 🧖 [9468, 100, 244]
N: 🧖 [9468, 100, 244]

O: ℹ️ [15284, 117, 31643]
N: ◽ [41832, 121]

O: ☀️ [18107, 222, 31643]
N: ℹ️ [15284, 117, 31643]

O: 🫱🏻 [9468, 104, 109, 9468, 237, 119]
N: 🫱🏻 [9468, 104, 109, 9468, 237, 119]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:11,  3.85s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.28s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.27s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.99s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.43s/it]
Processing depth (0, 2, 3, 7, 8):   0%|          | 0/100 [00:15<?, ?it/s]2025-01-22 05:03:24.377 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the kitchen.
2025-01-22 05:03:24.377 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  moved to the kitchen.
2025-01-22 05:03:24.378 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel grabbed the milk.
2025-01-22 05:03:24.385 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1621, 1625) -->  grabbed the milk.
2025-01-22 05:03:24.386 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 05:03:24.399 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2630, 2635) --> . Daniel moved to the
2025-01-22 05:03:24.399 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel dropped the milk.
2025-01-22 05:03:24.428 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5484, 5488) -->  Daniel dropped the milk
2025-01-22 05:03:24.428 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra went to the bathroom.
2025-01-22 05:03:24.463 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6510, 6515) --> . Sandra went to the
2025-01-22 05:03:24.463 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the bathroom.
2025-01-22 05:03:24.464 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (279, 284) --> . John travelled to the
2025-01-22 05:03:24.464 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the bedroom.
2025-01-22 05:03:24.478 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2596, 2601) --> . Mary travelled to the
2025-01-22 05:03:24.478 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the garden.
2025-01-22 05:03:24.500 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3685, 3691) -->  John went back to the garden
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:03:25.317 | INFO     | test_jbb_embedding:begin_test:693 - The office.<|eot_id|>
2025-01-22 05:03:25.317 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8193])
2025-01-22 05:03:27.544 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [1306.5665760869565, 64.62881283552953, 401.890625, 60.46542463528258, 54.87469951923077], 'topk_indices': array([  31, 2068,   32,  359, 2632, 2058, 2057, 8189, 8188, 1987, 1976,
       1977, 2633, 1623, 2069, 1988, 2634,    0, 1989, 2070]), 'topk_tokens': [' moved', ' to', ' to', ' century', ' moved', 'fast', '\n', '<|start_header_id|>', '<|eot_id|>', ' bring', 'fast', 'est', ' to', ' milk', ' bring', ' the', ' the', '<|begin_of_text|>', ' news', ' the'], 'evidence_proportions': [1615.9, 1878.25, 2165.7, 839.75, 54.20625]}, 'weight': {'score': [21.70618206521739, 23.2852916056613, 21.67041015625, 23.292911762903028, 29.301883012820515], 'topk_indices': array([3352, 3379, 3272, 3224, 7423, 7461, 1469, 1531, 4366, 4382, 5238,
       5177, 7144, 7200, 3561, 3535, 4954, 5031, 5002, 4979]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.809375, 22.15234375, 19.909375, 27.013671875, 20.796875]}, 'saliency': {'score': [7.060355808423913, 0.3572677530388299, 2.120941162109375, 0.3349078413287667, 0.39969811072716344], 'topk_indices': array([ 358, 2634, 2067,  355,  387, 2633,   34, 1988, 1621,   31,  359,
       2632, 2058, 1977, 1987, 2070, 1976, 1623, 2069, 1989]), 'topk_tokens': [' past', ' the', ' expected', ' half', ' past', ' to', ' kitchen', ' the', ' grabbed', ' moved', ' century', ' moved', 'fast', 'est', ' bring', ' the', 'fast', ' milk', ' bring', ' news'], 'evidence_proportions': [8.6015625, 11.439453125, 9.906640625, 5.66650390625, 0.28466796875]}}, 'pred_res': 'The office.<|eot_id|>', 'score': 0}
2025-01-22 05:03:27.551 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:03:27.552 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-47_pid-0_0-2-3-7-8.pkl | len: 3 |  size: 2.05 KB
Processing depth (0, 2, 3, 7, 8):   1%|          | 1/100 [00:18<30:32, 18.51s/it]is_0k: False
your chose emoji: ['🙅🏿', '🧑🏾\u200d⚕️', '📽', '🧎🏽\u200d♀\u200d➡', '🤷🏽\u200d♀️', '💏🏿', '🧝🏾\u200d♀', '🧑🏽', '🧜🏼\u200d♂', '🧑🏾\u200d🔬']
emoji:
O: 🙅🏿 [9468, 247, 227, 9468, 237, 123]
N: 🧎🏽‍♀‍➡ [9468, 100, 236, 9468, 237, 121, 102470, 32990, 102470, 98115, 94]

O: 🧑🏾‍⚕️ [9468, 100, 239, 9468, 237, 122, 102470, 158, 248, 243, 31643]
N: 🧜🏼‍♂ [9468, 100, 250, 9468, 237, 120, 102470, 17245, 224]

O: 📽 [9468, 241, 121]
N: 🤷🏽‍♀️ [9468, 97, 115, 9468, 237, 121, 102470, 32990, 31643]

O: 🧎🏽‍♀‍➡ [9468, 100, 236, 9468, 237, 121, 102470, 32990, 102470, 98115, 94]
N: 📽 [9468, 241, 121]

O: 🤷🏽‍♀️ [9468, 97, 115, 9468, 237, 121, 102470, 32990, 31643]
N: 🙅🏿 [9468, 247, 227, 9468, 237, 123]

O: 💏🏿 [93273, 237, 9468, 237, 123]
N: 🧑🏾‍⚕️ [9468, 100, 239, 9468, 237, 122, 102470, 158, 248, 243, 31643]

O: 🧝🏾‍♀ [9468, 100, 251, 9468, 237, 122, 102470, 32990]
N: 🧝🏾‍♀ [9468, 100, 251, 9468, 237, 122, 102470, 32990]

O: 🧑🏽 [9468, 100, 239, 9468, 237, 121]
N: 🧑🏽 [9468, 100, 239, 9468, 237, 121]

O: 🧜🏼‍♂ [9468, 100, 250, 9468, 237, 120, 102470, 17245, 224]
N: 💏🏿 [93273, 237, 9468, 237, 123]

O: 🧑🏾‍🔬 [9468, 100, 239, 9468, 237, 122, 102470, 9468, 242, 105]
N: 🧑🏾‍🔬 [9468, 100, 239, 9468, 237, 122, 102470, 9468, 242, 105]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.56s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.47s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.00s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  2.60s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  3.21s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 1, 2, 5, 7):   1%|          | 1/100 [00:33<30:32, 18.51s/it]2025-01-22 05:03:42.205 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the kitchen.
2025-01-22 05:03:42.205 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  moved to the kitchen.
2025-01-22 05:03:42.205 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel grabbed the milk.
2025-01-22 05:03:42.210 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (908, 912) -->  Daniel grabbed the milk
2025-01-22 05:03:42.210 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 05:03:42.220 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1862, 1867) --> . Daniel moved to the
2025-01-22 05:03:42.221 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel dropped the milk.
2025-01-22 05:03:42.243 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4247, 4251) -->  dropped the milk.
2025-01-22 05:03:42.243 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra went to the bathroom.
2025-01-22 05:03:42.273 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5692, 5697) --> . Sandra went to the
2025-01-22 05:03:42.273 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the bathroom.
2025-01-22 05:03:42.275 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (303, 308) --> . John travelled to the
2025-01-22 05:03:42.275 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the bedroom.
2025-01-22 05:03:42.289 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2880, 2885) --> . Mary travelled to the
2025-01-22 05:03:42.289 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the garden.
2025-01-22 05:03:42.310 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3810, 3816) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:03:46.718 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 05:03:46.718 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8205])
2025-01-22 05:03:49.931 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [137.5234375, 10.290723417702242, 56.140625, 9.842694179214103, 4.646641322544643], 'topk_indices': array([  68,   66,    9, 8179,    1,   25, 8204,  105,   28, 8184, 8185,
       8084,   34,   23,   24,   14, 8203,    0, 8200, 8201]), 'topk_tokens': ['E', ' P', ':', ':', '<|start_header_id|>', '<|eot_id|>', '\n\n', 'ION', '<|end_header_id|>', ' prior', ' to', '.\n\n', ' kitchen', '4', '\n\n', '\n', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [235.525, 140.171875, 118.6, 184.78125, 18.5203125]}, 'weight': {'score': [21.70618206521739, 23.295157925194932, 20.259765625, 23.30557691424899, 29.354352678571427], 'topk_indices': array([3303, 3276, 3148, 3196, 7449, 7487, 1478, 1416, 4313, 4297, 5237,
       5176, 7158, 7214, 3459, 3485, 5001, 5030, 4953, 4978]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.809375, 28.263671875, 19.909375, 20.90234375, 20.796875]}, 'saliency': {'score': [0.7815525220788043, 0.055655224746198446, 0.2992744445800781, 0.05313428639927814, 0.034523328145345054], 'topk_indices': array([ 308,   30,   19,    0, 8198, 8180,  305, 8178,   24, 8084,   23,
       4249, 8190, 8094,  105,   20,   31, 8192, 8184,   34]), 'topk_tokens': [' bathroom', 'Daniel', '26', '<|begin_of_text|>', 'Answer', ' Where', ' travelled', 'Question', '\n\n', '.\n\n', '4', ' milk', ' milk', ' location', 'ION', ' Jul', ' moved', ' discarded', ' prior', ' kitchen'], 'evidence_proportions': [1.303173828125, 0.99652099609375, 0.578662109375, 1.0020751953125, 0.1144287109375]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 100}
2025-01-22 05:03:49.937 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:03:49.937 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-47_pid-1_0-1-2-5-7.pkl | len: 3 |  size: 2.08 KB
Processing depth (0, 1, 2, 5, 7):   2%|▏         | 2/100 [00:40<33:57, 20.79s/it]is_0k: False
your chose emoji: ['👌🏽', '✍🏿', '👋🏼', '👨🏿\u200d❤\u200d👨🏽', '👩🏿\u200d❤\u200d💋\u200d👨🏿', '🧑\u200d💻', '\U0001fac5🏽', '👨🏻\u200d🎤', '🙅🏻\u200d♂', '🍘']
emoji:
O: 👌🏽 [9468, 239, 234, 9468, 237, 121]
N: ✍🏿 [38798, 235, 9468, 237, 123]

O: ✍🏿 [38798, 235, 9468, 237, 123]
N: 👌🏽 [9468, 239, 234, 9468, 237, 121]

O: 👋🏼 [9468, 239, 233, 9468, 237, 120]
N: 👨🏿‍❤‍👨🏽 [9468, 239, 101, 9468, 237, 123, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 121]

O: 👨🏿‍❤‍👨🏽 [9468, 239, 101, 9468, 237, 123, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 121]
N: 👩🏿‍❤‍💋‍👨🏿 [9468, 239, 102, 9468, 237, 123, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 123]

O: 👩🏿‍❤‍💋‍👨🏿 [9468, 239, 102, 9468, 237, 123, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 123]
N: 👨🏻‍🎤 [9468, 239, 101, 9468, 237, 119, 102470, 9468, 236, 97]

O: 🧑‍💻 [9468, 100, 239, 102470, 93273, 119]
N: 🫅🏽 [9468, 104, 227, 9468, 237, 121]

O: 🫅🏽 [9468, 104, 227, 9468, 237, 121]
N: 🙅🏻‍♂ [9468, 247, 227, 9468, 237, 119, 102470, 17245, 224]

O: 👨🏻‍🎤 [9468, 239, 101, 9468, 237, 119, 102470, 9468, 236, 97]
N: 🧑‍💻 [9468, 100, 239, 102470, 93273, 119]

O: 🙅🏻‍♂ [9468, 247, 227, 9468, 237, 119, 102470, 17245, 224]
N: 👋🏼 [9468, 239, 233, 9468, 237, 120]

O: 🍘 [9468, 235, 246]
N: 🍘 [9468, 235, 246]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.83s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.58s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.63s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.22s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.74s/it]
Processing depth (3, 4, 5, 6, 9):   2%|▏         | 2/100 [00:57<33:57, 20.79s/it]2025-01-22 05:04:06.703 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the kitchen.
2025-01-22 05:04:06.719 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2925, 2930) --> . Daniel moved to the
2025-01-22 05:04:06.720 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel grabbed the milk.
2025-01-22 05:04:06.739 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3610, 3614) -->  Daniel grabbed the milk
2025-01-22 05:04:06.739 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 05:04:06.755 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2925, 2930) --> . Daniel moved to the
2025-01-22 05:04:06.755 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel dropped the milk.
2025-01-22 05:04:06.782 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4723, 4727) -->  dropped the milk.
2025-01-22 05:04:06.782 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra went to the bathroom.
2025-01-22 05:04:06.817 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7145, 7150) -->  Sandra went to the bathroom
2025-01-22 05:04:06.817 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the bathroom.
2025-01-22 05:04:06.818 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (297, 302) --> . John travelled to the
2025-01-22 05:04:06.818 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the bedroom.
2025-01-22 05:04:06.833 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2863, 2868) --> . Mary travelled to the
2025-01-22 05:04:06.833 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the garden.
2025-01-22 05:04:06.869 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3745, 3751) -->  John went back to the garden
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:04:07.653 | INFO     | test_jbb_embedding:begin_test:693 - the office<|eot_id|>
2025-01-22 05:04:07.653 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8219])
2025-01-22 05:04:09.893 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [396.8172554347826, 24.792471798224277, 172.34375, 23.458316784797752, 28.201536744505493], 'topk_indices': array([2925, 8200, 4196, 2930, 4198, 3610, 4195, 4207, 2926, 8217, 3613,
       8198, 3611, 3614, 3609, 2927, 8199,    0, 8214, 8215]), 'topk_tokens': ['.', ' the', ' to', ' kitchen', ' office', ' Daniel', ' moved', '❤', ' Daniel', '<|end_header_id|>', ' milk', ' prior', ' grabbed', '.', '.', ' moved', ' to', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [537.45, 536.4375, 537.45, 362.9375, 30.959375]}, 'weight': {'score': [22.964673913043477, 23.314105828873753, 21.67041015625, 23.3183018529268, 29.753434065934066], 'topk_indices': array([3271, 3298, 3185, 3137, 7435, 7473, 1411, 1473, 4318, 4302, 5124,
       5185, 7212, 7156, 3454, 3480, 4926, 4949, 4978, 4901]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.909375, 28.263671875, 19.909375, 20.90234375, 26.4859375]}, 'saliency': {'score': [2.385007111922554, 0.13920475600903065, 0.9733123779296875, 0.1312615596095755, 0.20611136300223215], 'topk_indices': array([2898, 8206,  302, 3608, 4723, 4725, 2868, 4194, 8204, 4198, 4195,
       3491, 2930, 3610, 3613, 4207, 2926, 2927, 8198, 3611]), 'topk_tokens': [' During', ' discarded', ' bathroom', ' Hon', ' dropped', ' milk', ' bedroom', ' Daniel', ' milk', ' office', ' moved', ' Ramsey', ' kitchen', ' Daniel', ' milk', '❤', ' Daniel', ' moved', ' prior', ' grabbed'], 'evidence_proportions': [2.96328125, 4.006591796875, 2.96328125, 2.0069580078125, 0.23363037109375]}}, 'pred_res': 'the office<|eot_id|>', 'score': 0}
2025-01-22 05:04:09.908 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:04:09.908 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-47_pid-2_3-4-5-6-9.pkl | len: 3 |  size: 2.08 KB
Processing depth (3, 4, 5, 6, 9):   3%|▎         | 3/100 [01:00<33:00, 20.42s/it]is_0k: False
your chose emoji: ['♠', '🧑🏻\u200d❤\u200d💋\u200d🧑🏽', '✍️', '⛎', '🦾', '👨🏾\u200d❤️\u200d👨🏻', '🦟', '👨🏼\u200d❤️\u200d💋\u200d👨🏽', '🚴🏻\u200d♀', '👨🏼\u200d🤝\u200d👨🏾']
emoji:
O: ♠ [121324]
N: ✍️ [38798, 235, 31643]

O: 🧑🏻‍❤‍💋‍🧑🏽 [9468, 100, 239, 9468, 237, 119, 102470, 121643, 102470, 93273, 233, 102470, 9468, 100, 239, 9468, 237, 121]
N: 🚴🏻‍♀ [9468, 248, 112, 9468, 237, 119, 102470, 32990]

O: ✍️ [38798, 235, 31643]
N: 🦾 [9468, 99, 122]

O: ⛎ [158, 249, 236]
N: ♠ [121324]

O: 🦾 [9468, 99, 122]
N: 👨🏾‍❤️‍👨🏻 [9468, 239, 101, 9468, 237, 122, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 119]

O: 👨🏾‍❤️‍👨🏻 [9468, 239, 101, 9468, 237, 122, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 119]
N: 🦟 [9468, 99, 253]

O: 🦟 [9468, 99, 253]
N: 🧑🏻‍❤‍💋‍🧑🏽 [9468, 100, 239, 9468, 237, 119, 102470, 121643, 102470, 93273, 233, 102470, 9468, 100, 239, 9468, 237, 121]

O: 👨🏼‍❤️‍💋‍👨🏽 [9468, 239, 101, 9468, 237, 120, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 121]
N: 👨🏼‍❤️‍💋‍👨🏽 [9468, 239, 101, 9468, 237, 120, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 121]

O: 🚴🏻‍♀ [9468, 248, 112, 9468, 237, 119, 102470, 32990]
N: ⛎ [158, 249, 236]

O: 👨🏼‍🤝‍👨🏾 [9468, 239, 101, 9468, 237, 120, 102470, 9468, 97, 251, 102470, 9468, 239, 101, 9468, 237, 122]
N: 👨🏼‍🤝‍👨🏾 [9468, 239, 101, 9468, 237, 120, 102470, 9468, 97, 251, 102470, 9468, 239, 101, 9468, 237, 122]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:11,  3.70s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:07<00:08,  4.05s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:11<00:03,  3.95s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  2.61s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  3.09s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (1, 2, 5, 6, 8):   3%|▎         | 3/100 [01:14<33:00, 20.42s/it]2025-01-22 05:04:24.030 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the kitchen.
2025-01-22 05:04:24.036 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (822, 827) -->  Daniel moved to the kitchen
2025-01-22 05:04:24.036 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel grabbed the milk.
2025-01-22 05:04:24.047 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1854, 1858) -->  Daniel grabbed the milk
2025-01-22 05:04:24.047 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 05:04:24.052 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (823, 828) -->  moved to the kitchen.
2025-01-22 05:04:24.053 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel dropped the milk.
2025-01-22 05:04:24.076 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4648, 4652) -->  Daniel dropped the milk
2025-01-22 05:04:24.076 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra went to the bathroom.
2025-01-22 05:04:24.115 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6522, 6527) --> . Sandra went to the
2025-01-22 05:04:24.115 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the bathroom.
2025-01-22 05:04:24.117 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (297, 302) --> . John travelled to the
2025-01-22 05:04:24.117 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the bedroom.
2025-01-22 05:04:24.133 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2841, 2846) -->  Mary travelled to the bedroom
2025-01-22 05:04:24.134 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the garden.
2025-01-22 05:04:24.152 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3770, 3776) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:04:27.375 | INFO     | test_jbb_embedding:begin_test:693 - the kitchen<|eot_id|>
2025-01-22 05:04:27.375 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8161])
2025-01-22 05:04:30.356 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [247.8179347826087, 16.460704005389516, 119.029296875, 15.603803846153847, 20.130449848790324], 'topk_indices': array([8135,  824, 4651,  299,   24, 8160, 8146, 8141, 8148, 1857, 1858,
        826,  823, 8040,  302, 8159,   14, 8156,    0, 8157]), 'topk_tokens': [':', ' to', ' milk', ' travelled', '\n\n', '\n\n', ' milk', ' to', ' discarded', ' milk', '.', ' kitchen', ' moved', '.\n\n', ' bathroom', '<|end_header_id|>', '\n', '<|eot_id|>', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [358.15, 239.875, 347.15, 259.46875, 35.1875]}, 'weight': {'score': [23.810122282608695, 23.2648307355463, 21.95556640625, 23.265865384615385, 29.521169354838708], 'topk_indices': array([3325, 3298, 3170, 3218, 7433, 7395, 1479, 1417, 4324, 4308, 5211,
       5150, 7116, 7172, 3481, 3507, 5004, 4927, 4952, 4975]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [24.6984375, 28.263671875, 19.809375, 27.013671875, 20.796875]}, 'saliency': {'score': [1.5427591075067935, 0.09258894147036532, 0.7024765014648438, 0.08728283503605769, 0.1481781005859375], 'topk_indices': array([8154, 8136,  818, 8050, 3118, 8040, 1855, 4649,  816, 8140,  822,
       8134, 4651, 8146, 1857,  299,  826,  823, 8148,  302]), 'topk_tokens': ['Answer', ' Where', '�', ' location', 'ern', '.\n\n', ' grabbed', ' dropped', '�', ' prior', ' Daniel', 'Question', ' milk', ' milk', ' milk', ' travelled', ' kitchen', ' moved', ' discarded', ' bathroom'], 'evidence_proportions': [2.24697265625, 1.7503662109375, 1.83232421875, 1.7618408203125, 0.20762939453125]}}, 'pred_res': 'the kitchen<|eot_id|>', 'score': 100}
2025-01-22 05:04:30.362 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:04:30.363 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-47_pid-3_1-2-5-6-8.pkl | len: 3 |  size: 2.08 KB
Processing depth (1, 2, 5, 6, 8):   4%|▍         | 4/100 [01:21<32:41, 20.43s/it]is_0k: False
your chose emoji: ['🚶🏿\u200d♂\u200d➡️', '🪗', '💂', '🐉', '🧎\u200d♀', '🕉', '👏🏿', '🧑🏿\u200d❤️\u200d🧑🏼', '🔀', '🧍🏾\u200d♀']
emoji:
O: 🚶🏿‍♂‍➡️ [9468, 248, 114, 9468, 237, 123, 102470, 17245, 224, 102470, 98115, 94, 31643]
N: 🐉 [9468, 238, 231]

O: 🪗 [9468, 103, 245]
N: 👏🏿 [9468, 239, 237, 9468, 237, 123]

O: 💂 [93273, 224]
N: 🧑🏿‍❤️‍🧑🏼 [9468, 100, 239, 9468, 237, 123, 102470, 121643, 31643, 102470, 9468, 100, 239, 9468, 237, 120]

O: 🐉 [9468, 238, 231]
N: 🔀 [9468, 242, 222]

O: 🧎‍♀ [9468, 100, 236, 102470, 32990]
N: 🪗 [9468, 103, 245]

O: 🕉 [9468, 243, 231]
N: 🕉 [9468, 243, 231]

O: 👏🏿 [9468, 239, 237, 9468, 237, 123]
N: 🚶🏿‍♂‍➡️ [9468, 248, 114, 9468, 237, 123, 102470, 17245, 224, 102470, 98115, 94, 31643]

O: 🧑🏿‍❤️‍🧑🏼 [9468, 100, 239, 9468, 237, 123, 102470, 121643, 31643, 102470, 9468, 100, 239, 9468, 237, 120]
N: 🧎‍♀ [9468, 100, 236, 102470, 32990]

O: 🔀 [9468, 242, 222]
N: 💂 [93273, 224]

O: 🧍🏾‍♀ [9468, 100, 235, 9468, 237, 122, 102470, 32990]
N: 🧍🏾‍♀ [9468, 100, 235, 9468, 237, 122, 102470, 32990]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.76s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.22s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:03,  3.96s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.75s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.29s/it]
Processing depth (3, 5, 6, 8, 9):   4%|▍         | 4/100 [01:36<32:41, 20.43s/it]2025-01-22 05:04:45.315 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the kitchen.
2025-01-22 05:04:45.330 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2925, 2930) --> . Daniel moved to the
2025-01-22 05:04:45.330 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel grabbed the milk.
2025-01-22 05:04:45.350 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4244, 4248) -->  grabbed the milk.
2025-01-22 05:04:45.350 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 05:04:45.364 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2925, 2930) --> . Daniel moved to the
2025-01-22 05:04:45.365 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel dropped the milk.
2025-01-22 05:04:45.396 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6664, 6668) -->  Daniel dropped the milk
2025-01-22 05:04:45.396 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra went to the bathroom.
2025-01-22 05:04:45.431 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7250, 7255) --> . Sandra went to the
2025-01-22 05:04:45.431 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the bathroom.
2025-01-22 05:04:45.432 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (264, 269) -->  John travelled to the bathroom
2025-01-22 05:04:45.432 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the bedroom.
2025-01-22 05:04:45.446 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2863, 2868) --> . Mary travelled to the
2025-01-22 05:04:45.446 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the garden.
2025-01-22 05:04:45.465 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3799, 3805) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:04:46.279 | INFO     | test_jbb_embedding:begin_test:693 - the office<|eot_id|>
2025-01-22 05:04:46.279 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8217])
2025-01-22 05:04:48.505 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [423.6317934782609, 26.76552425486618, 189.619140625, 25.33127635680235, 42.265125868055556], 'topk_indices': array([8096, 8216,   14,  380,  269, 2929, 2925,   24, 2897, 8215, 8198,
       4247, 8196, 2927, 2930, 8197, 2926,    0, 8212, 8213]), 'topk_tokens': ['.\n\n', '\n\n', '\n', '�', '.', ' the', '.', '\n\n', '.', '<|end_header_id|>', ' the', '.', ' prior', ' moved', ' kitchen', ' to', ' Daniel', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [644.05, 466.125, 644.05, 311.09375, 38.83125]}, 'weight': {'score': [21.727921195652176, 23.3249486770073, 22.03759765625, 23.33195628590637, 30.320138888888888], 'topk_indices': array([3265, 3292, 3185, 3137, 7467, 7429, 1427, 1489, 4294, 4310, 5172,
       5111, 7200, 7144, 3474, 3448, 4965, 4907, 4936, 4882]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.909375, 22.15234375, 19.909375, 27.013671875, 20.796875]}, 'saliency': {'score': [2.3888762100883154, 0.14863780223540146, 1.15399169921875, 0.14037339131591112, 0.3150821261935764], 'topk_indices': array([ 379,  268,  265, 8197, 4244,  381, 8106, 3485, 4243, 8210, 6667,
       2924, 4916, 4246, 8202, 2868, 2927, 8196, 2930, 2926]), 'topk_tokens': ['�', ' bathroom', ' travelled', ' to', ' grabbed', '�', ' location', ' Ramsey', ' Daniel', 'Answer', ' milk', ' Gov', ' office', ' milk', ' milk', ' bedroom', ' moved', ' prior', ' kitchen', ' Daniel'], 'evidence_proportions': [3.55625, 2.4541015625, 3.55625, 2.112060546875, 0.22340087890625]}}, 'pred_res': 'the office<|eot_id|>', 'score': 0}
2025-01-22 05:04:48.511 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:04:48.511 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-47_pid-4_3-5-6-8-9.pkl | len: 3 |  size: 2.05 KB
Processing depth (3, 5, 6, 8, 9):   5%|▌         | 5/100 [01:39<31:02, 19.61s/it]Processing depth (3, 5, 6, 8, 9):   5%|▌         | 5/100 [01:39<31:30, 19.90s/it]
2025-01-22 05:04:48.560 | INFO     | __main__:<module>:82 - Selected idx: 48
2025-01-22 05:04:48.560 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the apple before the office? 
2025-01-22 05:04:48.560 | INFO     | __main__:<module>:84 - Answer: kitchen
2025-01-22 05:04:48.560 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 05:04:48.560 | INFO     | __main__:<module>:86 - Needle: [' Daniel moved to the kitchen.', ' Daniel moved to the office.', ' John travelled to the bathroom.', ' Mary travelled to the bedroom.', ' John went back to the garden.', ' Daniel dropped the apple.', ' Sandra went to the bathroom.']
2025-01-22 05:04:48.560 | INFO     | __main__:<module>:87 - Real Needle: [' Daniel moved to the kitchen.', ' Daniel moved to the office.', ' Daniel dropped the apple.', ' Sandra went to the bathroom.']
2025-01-22 05:04:48.560 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['🏄🏾\u200d♀', '🚶🏿\u200d♀️', '💁🏻\u200d♀', '🏃🏽\u200d♂', '🧑🏽\u200d❤️\u200d💋\u200d🧑🏻', '🏊🏿\u200d♀', '🛌🏻', '🧎\u200d♀\u200d➡', '💁🏻', '🏃🏾\u200d♀\u200d➡']
emoji:
O: 🏄🏾‍♀ [9468, 237, 226, 9468, 237, 122, 102470, 32990]
N: 🛌🏻 [9468, 249, 234, 9468, 237, 119]

O: 🚶🏿‍♀️ [9468, 248, 114, 9468, 237, 123, 102470, 32990, 31643]
N: 💁🏻 [93273, 223, 9468, 237, 119]

O: 💁🏻‍♀ [93273, 223, 9468, 237, 119, 102470, 32990]
N: 🧑🏽‍❤️‍💋‍🧑🏻 [9468, 100, 239, 9468, 237, 121, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 100, 239, 9468, 237, 119]

O: 🏃🏽‍♂ [9468, 237, 225, 9468, 237, 121, 102470, 17245, 224]
N: 🚶🏿‍♀️ [9468, 248, 114, 9468, 237, 123, 102470, 32990, 31643]

O: 🧑🏽‍❤️‍💋‍🧑🏻 [9468, 100, 239, 9468, 237, 121, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 100, 239, 9468, 237, 119]
N: 🧎‍♀‍➡ [9468, 100, 236, 102470, 32990, 102470, 98115, 94]

O: 🏊🏿‍♀ [9468, 237, 232, 9468, 237, 123, 102470, 32990]
N: 🏊🏿‍♀ [9468, 237, 232, 9468, 237, 123, 102470, 32990]

O: 🛌🏻 [9468, 249, 234, 9468, 237, 119]
N: 🏃🏽‍♂ [9468, 237, 225, 9468, 237, 121, 102470, 17245, 224]

O: 🧎‍♀‍➡ [9468, 100, 236, 102470, 32990, 102470, 98115, 94]
N: 💁🏻‍♀ [93273, 223, 9468, 237, 119, 102470, 32990]

O: 💁🏻 [93273, 223, 9468, 237, 119]
N: 🏄🏾‍♀ [9468, 237, 226, 9468, 237, 122, 102470, 32990]

O: 🏃🏾‍♀‍➡ [9468, 237, 225, 9468, 237, 122, 102470, 32990, 102470, 98115, 94]
N: 🏃🏾‍♀‍➡ [9468, 237, 225, 9468, 237, 122, 102470, 32990, 102470, 98115, 94]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.76s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.90s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.37s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.84s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.50s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (1, 4, 5, 6):   0%|          | 0/100 [00:15<?, ?it/s]2025-01-22 05:05:04.326 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the kitchen.
2025-01-22 05:05:04.330 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (829, 834) --> . Daniel moved to the
2025-01-22 05:05:04.330 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the office.
2025-01-22 05:05:04.334 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (829, 834) --> . Daniel moved to the
2025-01-22 05:05:04.335 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel dropped the apple.
2025-01-22 05:05:04.355 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4162, 4166) -->  Daniel dropped the apple
2025-01-22 05:05:04.355 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the bathroom.
2025-01-22 05:05:04.381 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4613, 4618) -->  Sandra went to the bathroom
2025-01-22 05:05:04.381 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the bathroom.
2025-01-22 05:05:04.389 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1595, 1600) --> . John travelled to the
2025-01-22 05:05:04.389 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the bedroom.
2025-01-22 05:05:04.412 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4658, 4663) --> . Mary travelled to the
2025-01-22 05:05:04.412 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the garden.
2025-01-22 05:05:04.437 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4918, 4924) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:05:09.815 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's hand.<|eot_id|>
2025-01-22 05:05:09.815 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8181])
2025-01-22 05:05:13.176 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [361.6019736842105, 26.808918316226784, 148.296875, 25.78979015830163, 25.34127768987342], 'topk_indices': array([8174, 8175, 8164,    1, 8168, 8172, 8162, 8177, 8069,  831,  834,
         24,   14, 8171, 4165, 8169, 8079, 8179, 8176,    0]), 'topk_tokens': ['Answer', ':', ':', '<|start_header_id|>', ' apple', '?', '.\n\n', '<|start_header_id|>', '.\n\n', ' moved', ' kitchen', '\n\n', '\n', ' office', ' apple', ' before', ' location', '<|end_header_id|>', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [455.4, 455.4, 468.4375, 88.5375]}, 'weight': {'score': [23.15049342105263, 23.294162008186706, 20.259765625, 23.300454810406183, 29.691653481012658], 'topk_indices': array([3283, 3310, 3155, 3203, 7460, 7422, 1513, 1451, 4333, 4349, 5169,
       5230, 7115, 7171, 3492, 3466, 4994, 4971, 5023, 4946]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.909375, 19.909375, 27.083984375, 26.4859375]}, 'saliency': {'score': [2.1497160259046053, 0.1508006285129521, 0.7817115783691406, 0.1449012583143829, 0.19217672227304192], 'topk_indices': array([  24, 1597, 8150, 2689, 8078, 8163, 8165, 3634, 8075,  830, 8168,
       1600,  277, 8174,  831, 8169, 8171,  834, 4165, 8079]), 'topk_tokens': ['\n\n', ' travelled', ' return', ' ne', ' first', 'Question', ' Where', ' office', ' item', ' Daniel', ' apple', ' bathroom', 'hue', 'Answer', ' moved', ' before', ' office', ' kitchen', ' apple', ' location'], 'evidence_proportions': [2.50244140625, 2.50244140625, 3.168212890625, 0.6294677734375]}}, 'pred_res': "Daniel's hand.<|eot_id|>", 'score': 0}
2025-01-22 05:05:13.198 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:05:13.198 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-48_pid-0_1-4-5-6.pkl | len: 3 |  size: 2.04 KB
Processing depth (1, 4, 5, 6):   1%|          | 1/100 [00:24<40:29, 24.54s/it]is_0k: False
your chose emoji: ['🍙', '👨🏼\u200d🦽\u200d➡', '⚱️', '⚠', '👩🏿\u200d🦽\u200d➡️', '🚣🏼\u200d♀️', '🧔🏼\u200d♂️', '🙎🏼\u200d♀', '👮🏿', '💂🏿\u200d♂️']
emoji:
O: 🍙 [9468, 235, 247]
N: 🧔🏼‍♂️ [9468, 100, 242, 9468, 237, 120, 102470, 17245, 224, 31643]

O: 👨🏼‍🦽‍➡ [9468, 239, 101, 9468, 237, 120, 102470, 9468, 99, 121, 102470, 98115, 94]
N: 👨🏼‍🦽‍➡ [9468, 239, 101, 9468, 237, 120, 102470, 9468, 99, 121, 102470, 98115, 94]

O: ⚱️ [158, 248, 109, 31643]
N: ⚱️ [158, 248, 109, 31643]

O: ⚠ [158, 248, 254]
N: ⚠ [158, 248, 254]

O: 👩🏿‍🦽‍➡️ [9468, 239, 102, 9468, 237, 123, 102470, 9468, 99, 121, 102470, 98115, 94, 31643]
N: 🙎🏼‍♀ [9468, 247, 236, 9468, 237, 120, 102470, 32990]

O: 🚣🏼‍♀️ [9468, 248, 96, 9468, 237, 120, 102470, 32990, 31643]
N: 👮🏿 [9468, 239, 106, 9468, 237, 123]

O: 🧔🏼‍♂️ [9468, 100, 242, 9468, 237, 120, 102470, 17245, 224, 31643]
N: 🚣🏼‍♀️ [9468, 248, 96, 9468, 237, 120, 102470, 32990, 31643]

O: 🙎🏼‍♀ [9468, 247, 236, 9468, 237, 120, 102470, 32990]
N: 🍙 [9468, 235, 247]

O: 👮🏿 [9468, 239, 106, 9468, 237, 123]
N: 👩🏿‍🦽‍➡️ [9468, 239, 102, 9468, 237, 123, 102470, 9468, 99, 121, 102470, 98115, 94, 31643]

O: 💂🏿‍♂️ [93273, 224, 9468, 237, 123, 102470, 17245, 224, 31643]
N: 💂🏿‍♂️ [93273, 224, 9468, 237, 123, 102470, 17245, 224, 31643]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:05<00:15,  5.27s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.64s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.35s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.06s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.64s/it]
Processing depth (3, 4, 6, 9):   1%|          | 1/100 [00:40<40:29, 24.54s/it]2025-01-22 05:05:29.552 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the kitchen.
2025-01-22 05:05:29.568 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2923, 2928) --> . Daniel moved to the
2025-01-22 05:05:29.569 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the office.
2025-01-22 05:05:29.586 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2923, 2928) --> . Daniel moved to the
2025-01-22 05:05:29.586 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel dropped the apple.
2025-01-22 05:05:29.610 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4632, 4636) -->  Daniel dropped the apple
2025-01-22 05:05:29.610 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the bathroom.
2025-01-22 05:05:29.655 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7098, 7103) -->  Sandra went to the bathroom
2025-01-22 05:05:29.656 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the bathroom.
2025-01-22 05:05:29.666 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1721, 1726) --> . John travelled to the
2025-01-22 05:05:29.667 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the bedroom.
2025-01-22 05:05:29.693 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4736, 4741) --> . Mary travelled to the
2025-01-22 05:05:29.693 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the garden.
2025-01-22 05:05:29.721 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4946, 4952) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:05:30.566 | INFO     | test_jbb_embedding:begin_test:693 - the doctor's hand<|eot_id|>
2025-01-22 05:05:30.566 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8149])
2025-01-22 05:05:32.805 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [215.33881578947367, 16.214818832801768, 78.63623046875, 15.625672777812, 19.049231150793652], 'topk_indices': array([8137,   24, 8136, 8003, 8132, 8130, 2928, 8148, 8037, 8142, 8047,
       4635,   14, 4680, 4681, 8143, 8145, 8147,    0, 8144]), 'topk_tokens': [' before', '\n\n', ' apple', ' context', ':', '.\n\n', ' kitchen', '\n\n', '.\n\n', 'Answer', ' location', ' apple', '\n', ' as', ' one', ':', '<|start_header_id|>', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [266.625, 266.625, 329.65625, 21.3125]}, 'weight': {'score': [23.15049342105263, 23.259704290358194, 20.259765625, 23.26587332142417, 29.087053571428573], 'topk_indices': array([3290, 3263, 3183, 3135, 7426, 7388, 1461, 1399, 4312, 4328, 5153,
       5214, 7165, 7109, 3472, 3446, 5007, 4978, 4942, 4917]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.909375, 19.909375, 27.083984375, 26.4859375]}, 'saliency': {'score': [1.2343332391036184, 0.09021741064069784, 0.41065216064453125, 0.08690767099047524, 0.13703482491629465], 'topk_indices': array([8001, 3609, 8148, 8130, 8133, 2925, 8139, 8037, 8137, 4632, 8131,
       4680, 8003, 8136, 4681, 1726, 8047, 2928, 8142, 4635]), 'topk_tokens': [' provided', ' moved', '\n\n', '.\n\n', ' Where', ' moved', ' office', '.\n\n', ' before', ' Daniel', 'Question', ' as', ' context', ' apple', ' one', ' bathroom', ' location', ' kitchen', 'Answer', ' apple'], 'evidence_proportions': [1.3359375, 1.3359375, 2.3280029296875, 0.15618896484375]}}, 'pred_res': "the doctor's hand<|eot_id|>", 'score': 0}
2025-01-22 05:05:32.812 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:05:32.812 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-48_pid-1_3-4-6-9.pkl | len: 3 |  size: 2.02 KB
Processing depth (3, 4, 6, 9):   2%|▏         | 2/100 [00:44<35:20, 21.64s/it]is_0k: False
your chose emoji: ['\U0001faaf', '🤷🏼\u200d♂️', '🐕', '🤷🏿\u200d♀️', '◾', '👨🏽\u200d🎨', '👨🏻\u200d🏫', '📂', '🍗', '🧑🏿\u200d🎨']
emoji:
O: 🪯 [9468, 103, 107]
N: 👨🏻‍🏫 [9468, 239, 101, 9468, 237, 119, 102470, 9468, 237, 104]

O: 🤷🏼‍♂️ [9468, 97, 115, 9468, 237, 120, 102470, 17245, 224, 31643]
N: 🍗 [9468, 235, 245]

O: 🐕 [9468, 238, 243]
N: 🪯 [9468, 103, 107]

O: 🤷🏿‍♀️ [9468, 97, 115, 9468, 237, 123, 102470, 32990, 31643]
N: 🤷🏼‍♂️ [9468, 97, 115, 9468, 237, 120, 102470, 17245, 224, 31643]

O: ◾ [41832, 122]
N: 🤷🏿‍♀️ [9468, 97, 115, 9468, 237, 123, 102470, 32990, 31643]

O: 👨🏽‍🎨 [9468, 239, 101, 9468, 237, 121, 102470, 9468, 236, 101]
N: 👨🏽‍🎨 [9468, 239, 101, 9468, 237, 121, 102470, 9468, 236, 101]

O: 👨🏻‍🏫 [9468, 239, 101, 9468, 237, 119, 102470, 9468, 237, 104]
N: 📂 [9468, 241, 224]

O: 📂 [9468, 241, 224]
N: 🐕 [9468, 238, 243]

O: 🍗 [9468, 235, 245]
N: ◾ [41832, 122]

O: 🧑🏿‍🎨 [9468, 100, 239, 9468, 237, 123, 102470, 9468, 236, 101]
N: 🧑🏿‍🎨 [9468, 100, 239, 9468, 237, 123, 102470, 9468, 236, 101]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:11,  3.73s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.33s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.48s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.13s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.55s/it]
Processing depth (1, 3, 4, 7):   2%|▏         | 2/100 [01:00<35:20, 21.64s/it]2025-01-22 05:05:48.738 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the kitchen.
2025-01-22 05:05:48.742 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (777, 782) --> . Daniel moved to the
2025-01-22 05:05:48.742 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the office.
2025-01-22 05:05:48.746 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (777, 782) --> . Daniel moved to the
2025-01-22 05:05:48.746 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel dropped the apple.
2025-01-22 05:05:48.765 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3614, 3618) -->  Daniel dropped the apple
2025-01-22 05:05:48.766 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the bathroom.
2025-01-22 05:05:48.799 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5749, 5754) --> . Sandra went to the
2025-01-22 05:05:48.800 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the bathroom.
2025-01-22 05:05:48.809 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1539, 1544) --> . John travelled to the
2025-01-22 05:05:48.809 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the bedroom.
2025-01-22 05:05:48.834 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4886, 4891) --> . Mary travelled to the
2025-01-22 05:05:48.835 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the garden.
2025-01-22 05:05:48.859 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5060, 5066) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:05:49.706 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's hand.<|eot_id|>
2025-01-22 05:05:49.706 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8177])
2025-01-22 05:05:51.934 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [397.80345394736844, 27.135576482273837, 120.2705078125, 26.087958486801718, 10.676605620941558], 'topk_indices': array([8164,   14, 2672, 2656,   24,  779, 8168, 3614, 2601, 8165, 3616,
       8075, 8167, 8173, 2675, 8175, 3615, 3617, 8172,    0]), 'topk_tokens': [' apple', '\n', 'as', ',', '\n\n', ' moved', '?', ' Daniel', 'ared', ' before', ' the', ' location', ' office', '<|start_header_id|>', ' ne', '<|end_header_id|>', ' dropped', ' apple', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [388.625, 388.625, 850.625, 53.903125]}, 'weight': {'score': [21.653371710526315, 23.27798937958435, 20.259765625, 23.287708141497852, 28.998782467532468], 'topk_indices': array([3275, 3302, 3147, 3195, 7412, 7450, 1437, 1499, 4301, 4285, 5204,
       5143, 7183, 7127, 3484, 3458, 4961, 4913, 4990, 4938]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.909375, 19.909375, 27.083984375, 20.796875]}, 'saliency': {'score': [2.4547247635690788, 0.15199107424262684, 0.6517601013183594, 0.14563769860967235, 0.07779326996245942], 'topk_indices': array([2672,  778, 8159, 8170, 8168, 2582, 2657, 1544, 2600, 8164, 2583,
        779, 8165, 2601, 8075, 3614, 8167, 2675, 3615, 3617]), 'topk_tokens': ['as', ' Daniel', 'Question', 'Answer', '?', ' mess', ' mess', ' bathroom', ' ne', ' apple', 'engers', ' moved', ' before', 'ared', ' location', ' Daniel', ' office', ' ne', ' dropped', ' apple'], 'evidence_proportions': [2.194921875, 2.194921875, 5.76025390625, 0.3299072265625]}}, 'pred_res': "Daniel's hand.<|eot_id|>", 'score': 0}
2025-01-22 05:05:51.941 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:05:51.941 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-48_pid-2_1-3-4-7.pkl | len: 3 |  size: 2.02 KB
Processing depth (1, 3, 4, 7):   3%|▎         | 3/100 [01:03<33:07, 20.49s/it]is_0k: False
your chose emoji: ['🤹🏾\u200d♀️', '👨🏼\u200d🍳', '🌥', '🇮🇶', '\U0001faf1🏿\u200d\U0001faf2🏽', '🏛️', '🧑🏼\u200d💼', '🪠', '👨🏿\u200d🤝\u200d👨🏼', '👵']
emoji:
O: 🤹🏾‍♀️ [9468, 97, 117, 9468, 237, 122, 102470, 32990, 31643]
N: 🏛️ [9468, 237, 249, 31643]

O: 👨🏼‍🍳 [9468, 239, 101, 9468, 237, 120, 102470, 9468, 235, 111]
N: 🧑🏼‍💼 [9468, 100, 239, 9468, 237, 120, 102470, 93273, 120]

O: 🌥 [9468, 234, 98]
N: 🪠 [9468, 103, 254]

O: 🇮🇶 [9468, 229, 106, 9468, 229, 114]
N: 🫱🏿‍🫲🏽 [9468, 104, 109, 9468, 237, 123, 102470, 9468, 104, 110, 9468, 237, 121]

O: 🫱🏿‍🫲🏽 [9468, 104, 109, 9468, 237, 123, 102470, 9468, 104, 110, 9468, 237, 121]
N: 👨🏿‍🤝‍👨🏼 [9468, 239, 101, 9468, 237, 123, 102470, 9468, 97, 251, 102470, 9468, 239, 101, 9468, 237, 120]

O: 🏛️ [9468, 237, 249, 31643]
N: 🇮🇶 [9468, 229, 106, 9468, 229, 114]

O: 🧑🏼‍💼 [9468, 100, 239, 9468, 237, 120, 102470, 93273, 120]
N: 👨🏼‍🍳 [9468, 239, 101, 9468, 237, 120, 102470, 9468, 235, 111]

O: 🪠 [9468, 103, 254]
N: 🌥 [9468, 234, 98]

O: 👨🏿‍🤝‍👨🏼 [9468, 239, 101, 9468, 237, 123, 102470, 9468, 97, 251, 102470, 9468, 239, 101, 9468, 237, 120]
N: 🤹🏾‍♀️ [9468, 97, 117, 9468, 237, 122, 102470, 32990, 31643]

O: 👵 [9468, 239, 113]
N: 👵 [9468, 239, 113]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.24s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.34s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.39s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.15s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.59s/it]
Processing depth (2, 4, 5, 8):   3%|▎         | 3/100 [01:19<33:07, 20.49s/it]2025-01-22 05:06:08.472 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the kitchen.
2025-01-22 05:06:08.482 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1791, 1796) --> . Daniel moved to the
2025-01-22 05:06:08.482 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the office.
2025-01-22 05:06:08.491 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1791, 1796) --> . Daniel moved to the
2025-01-22 05:06:08.491 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel dropped the apple.
2025-01-22 05:06:08.514 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4219, 4223) -->  dropped the apple.
2025-01-22 05:06:08.515 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the bathroom.
2025-01-22 05:06:08.554 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6636, 6641) -->  Sandra went to the bathroom
2025-01-22 05:06:08.554 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the bathroom.
2025-01-22 05:06:08.571 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1565, 1570) --> . John travelled to the
2025-01-22 05:06:08.571 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the bedroom.
2025-01-22 05:06:08.596 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4892, 4897) --> . Mary travelled to the
2025-01-22 05:06:08.596 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the garden.
2025-01-22 05:06:08.624 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5064, 5070) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:06:09.460 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's hand.<|eot_id|>
2025-01-22 05:06:09.460 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8175])
2025-01-22 05:06:11.675 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [227.1472039473684, 20.988081590853508, 136.830078125, 20.279436709443694, 12.339946546052632], 'topk_indices': array([8160,    3, 8102, 8158, 8156, 8063, 8162, 1570, 4221, 8103, 8166,
         24,   14, 8073, 8163, 8171, 8165, 8170,    0, 8173]), 'topk_tokens': [' was', '<|end_header_id|>', ' to', ':', '.\n\n', '.\n\n', ' apple', ' bathroom', ' apple', ' the', '?', '\n\n', '\n', ' location', ' before', '<|start_header_id|>', ' office', '<|eot_id|>', '<|begin_of_text|>', '<|end_header_id|>'], 'evidence_proportions': [256.825, 256.825, 396.5, 32.309375]}, 'weight': {'score': [21.86389802631579, 23.282554949254095, 20.259765625, 23.291804502333292, 29.31969572368421], 'topk_indices': array([3306, 3279, 3179, 3131, 7454, 7416, 1421, 1483, 4285, 4269, 5099,
       5160, 7175, 7119, 3462, 3488, 4863, 4888, 4946, 4917]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.909375, 19.909375, 20.97265625, 26.4859375]}, 'saliency': {'score': [1.2917448344983553, 0.1167171680714455, 0.7453651428222656, 0.11274026849412455, 0.09260659468801398], 'topk_indices': array([8072, 3619, 1796, 1792, 2396,   24, 1793, 1567, 8168, 8159, 8166,
       4218, 8157, 8029, 8162, 4221, 8073, 1570, 8163, 8165]), 'topk_tokens': [' first', ' moved', ' kitchen', ' Daniel', 'little', '\n\n', ' moved', ' travelled', 'Answer', ' Where', '?', ' Daniel', 'Question', ' context', ' apple', ' apple', ' location', ' bathroom', ' before', ' office'], 'evidence_proportions': [1.46865234375, 1.46865234375, 2.15673828125, 0.24593505859375]}}, 'pred_res': "Daniel's hand.<|eot_id|>", 'score': 0}
2025-01-22 05:06:11.682 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:06:11.682 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-48_pid-3_2-4-5-8.pkl | len: 3 |  size: 2.04 KB
Processing depth (2, 4, 5, 8):   4%|▍         | 4/100 [01:23<32:18, 20.20s/it]is_0k: False
your chose emoji: ['👳🏻\u200d♀️', '🤶🏿', '👩🏼\u200d🚒', '🐠', '🐔', '🧑🏾\u200d🏭', '🕵🏼\u200d♀️', '👮🏻\u200d♂', '👰🏼\u200d♀', '🧔🏿\u200d♂']
emoji:
O: 👳🏻‍♀️ [9468, 239, 111, 9468, 237, 119, 102470, 32990, 31643]
N: 👰🏼‍♀ [9468, 239, 108, 9468, 237, 120, 102470, 32990]

O: 🤶🏿 [9468, 97, 114, 9468, 237, 123]
N: 🐔 [9468, 238, 242]

O: 👩🏼‍🚒 [9468, 239, 102, 9468, 237, 120, 102470, 9468, 248, 240]
N: 🧑🏾‍🏭 [9468, 100, 239, 9468, 237, 122, 102470, 9468, 237, 255]

O: 🐠 [9468, 238, 254]
N: 🐠 [9468, 238, 254]

O: 🐔 [9468, 238, 242]
N: 👳🏻‍♀️ [9468, 239, 111, 9468, 237, 119, 102470, 32990, 31643]

O: 🧑🏾‍🏭 [9468, 100, 239, 9468, 237, 122, 102470, 9468, 237, 255]
N: 🕵🏼‍♀️ [9468, 243, 113, 9468, 237, 120, 102470, 32990, 31643]

O: 🕵🏼‍♀️ [9468, 243, 113, 9468, 237, 120, 102470, 32990, 31643]
N: 🤶🏿 [9468, 97, 114, 9468, 237, 123]

O: 👮🏻‍♂ [9468, 239, 106, 9468, 237, 119, 102470, 17245, 224]
N: 👩🏼‍🚒 [9468, 239, 102, 9468, 237, 120, 102470, 9468, 248, 240]

O: 👰🏼‍♀ [9468, 239, 108, 9468, 237, 120, 102470, 32990]
N: 👮🏻‍♂ [9468, 239, 106, 9468, 237, 119, 102470, 17245, 224]

O: 🧔🏿‍♂ [9468, 100, 242, 9468, 237, 123, 102470, 17245, 224]
N: 🧔🏿‍♂ [9468, 100, 242, 9468, 237, 123, 102470, 17245, 224]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:11,  3.76s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:07<00:07,  3.96s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:11<00:03,  3.87s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  2.77s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  3.18s/it]
Processing depth (0, 1, 2, 5):   4%|▍         | 4/100 [01:37<32:18, 20.20s/it]2025-01-22 05:06:26.444 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the kitchen.
2025-01-22 05:06:26.444 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  moved to the kitchen.
2025-01-22 05:06:26.444 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the office.
2025-01-22 05:06:26.449 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (901, 906) --> . Daniel moved to the
2025-01-22 05:06:26.449 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel dropped the apple.
2025-01-22 05:06:26.458 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1806, 1810) -->  Daniel dropped the apple
2025-01-22 05:06:26.458 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the bathroom.
2025-01-22 05:06:26.478 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4124, 4129) --> . Sandra went to the
2025-01-22 05:06:26.478 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the bathroom.
2025-01-22 05:06:26.488 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1579, 1584) --> . John travelled to the
2025-01-22 05:06:26.488 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the bedroom.
2025-01-22 05:06:26.519 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4762, 4767) -->  the senate. Mary travelled
2025-01-22 05:06:26.519 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the garden.
2025-01-22 05:06:26.544 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4976, 4982) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:06:27.381 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's hand.<|eot_id|>
2025-01-22 05:06:27.381 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8155])
2025-01-22 05:06:29.600 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [700.0740131578947, 42.7511185339544, 139.82275390625, 41.022412247630186, 14.002456202651516], 'topk_indices': array([ 547,  904, 8043,   35,  430, 1809,   14,   29,  548,   34,  185,
       8053,  541,  906,  424,  425,   32,   31, 8081,    0]), 'topk_tokens': ['s', ' to', '.\n\n', '.', 's', ' apple', '\n', '\n\n', ' per', ' kitchen', 'ION', ' location', ' to', ' office', ' to', ' ', ' to', ' moved', ' moved', '<|begin_of_text|>'], 'evidence_proportions': [1307.9, 792.9, 620.625, 62.98125]}, 'weight': {'score': [21.62705592105263, 23.26510595427801, 21.7373046875, 23.271946748430384, 29.143229166666668], 'topk_indices': array([3331, 3304, 3176, 3224, 7408, 7446, 1497, 1435, 4295, 4311, 5119,
       5180, 7185, 7129, 3487, 3513, 4914, 4937, 4966, 4889]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.809375, 19.909375, 27.083984375, 20.796875]}, 'saliency': {'score': [3.9058870014391447, 0.2395184127160456, 0.7607135772705078, 0.22991603356811868, 0.10056027499112216], 'topk_indices': array([8052,   32, 8055, 8047, 8009, 8073,   30, 8145,   27, 1584,  903,
        546,  185,  548, 1809, 8053,  906,   34,   31, 8081]), 'topk_tokens': [' first', ' to', ' traveled', ' obtained', ' context', ' left', 'Daniel', ' office', 'user', ' bathroom', ' moved', ' em', 'ION', ' per', ' apple', ' location', ' office', ' kitchen', ' moved', ' moved'], 'evidence_proportions': [7.161328125, 3.84140625, 4.3486328125, 0.36072998046875]}}, 'pred_res': "Daniel's hand.<|eot_id|>", 'score': 0}
2025-01-22 05:06:29.629 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:06:29.629 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-48_pid-4_0-1-2-5.pkl | len: 3 |  size: 1.98 KB
Processing depth (0, 1, 2, 5):   5%|▌         | 5/100 [01:40<30:41, 19.39s/it]Processing depth (0, 1, 2, 5):   5%|▌         | 5/100 [01:41<31:59, 20.20s/it]
2025-01-22 05:06:29.681 | INFO     | __main__:<module>:82 - Selected idx: 49
2025-01-22 05:06:29.681 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the location prior to the place where the football was discarded, left or dropped?
2025-01-22 05:06:29.681 | INFO     | __main__:<module>:84 - Answer: kitchen
2025-01-22 05:06:29.681 | INFO     | __main__:<module>:85 - Tag: 4-hop
2025-01-22 05:06:29.681 | INFO     | __main__:<module>:86 - Needle: [' John travelled to the bathroom.', ' Mary travelled to the bedroom.', ' Daniel moved to the kitchen.', ' Daniel picked up the football.', ' Daniel moved to the office.', ' John went back to the garden.', ' Daniel dropped the football.', ' Sandra went to the bathroom.']
2025-01-22 05:06:29.681 | INFO     | __main__:<module>:87 - Real Needle: [' Daniel moved to the kitchen.', ' Daniel picked up the football.', ' Daniel moved to the office.', ' Daniel dropped the football.', ' Sandra went to the bathroom.']
2025-01-22 05:06:29.681 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['👩🏽\u200d🎓', '🤌🏿', '🚴\u200d♂️', '🤷🏾', '🏡', '🧑🏽\u200d🦰', '👋🏻', '🚶🏾\u200d♀\u200d➡️', '🕑', '🚩']
emoji:
O: 👩🏽‍🎓 [9468, 239, 102, 9468, 237, 121, 102470, 9468, 236, 241]
N: 👋🏻 [9468, 239, 233, 9468, 237, 119]

O: 🤌🏿 [9468, 97, 234, 9468, 237, 123]
N: 🤷🏾 [9468, 97, 115, 9468, 237, 122]

O: 🚴‍♂️ [9468, 248, 112, 102470, 17245, 224, 31643]
N: 🤌🏿 [9468, 97, 234, 9468, 237, 123]

O: 🤷🏾 [9468, 97, 115, 9468, 237, 122]
N: 🕑 [9468, 243, 239]

O: 🏡 [9468, 237, 94]
N: 🚴‍♂️ [9468, 248, 112, 102470, 17245, 224, 31643]

O: 🧑🏽‍🦰 [9468, 100, 239, 9468, 237, 121, 102470, 9468, 99, 108]
N: 🏡 [9468, 237, 94]

O: 👋🏻 [9468, 239, 233, 9468, 237, 119]
N: 🧑🏽‍🦰 [9468, 100, 239, 9468, 237, 121, 102470, 9468, 99, 108]

O: 🚶🏾‍♀‍➡️ [9468, 248, 114, 9468, 237, 122, 102470, 32990, 102470, 98115, 94, 31643]
N: 👩🏽‍🎓 [9468, 239, 102, 9468, 237, 121, 102470, 9468, 236, 241]

O: 🕑 [9468, 243, 239]
N: 🚶🏾‍♀‍➡️ [9468, 248, 114, 9468, 237, 122, 102470, 32990, 102470, 98115, 94, 31643]

O: 🚩 [9468, 248, 102]
N: 🚩 [9468, 248, 102]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.69s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.54s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.29s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  2.96s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.51s/it]
Processing depth (2, 3, 4, 7, 9):   0%|          | 0/100 [00:15<?, ?it/s]2025-01-22 05:06:45.536 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the kitchen.
2025-01-22 05:06:45.545 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1785, 1790) --> . Daniel moved to the
2025-01-22 05:06:45.545 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel picked up the football.
2025-01-22 05:06:45.560 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2925, 2930) --> . Daniel picked up the
2025-01-22 05:06:45.560 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 05:06:45.569 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1785, 1790) --> . Daniel moved to the
2025-01-22 05:06:45.569 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel dropped the football.
2025-01-22 05:06:45.596 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5553, 5557) -->  Daniel dropped the football
2025-01-22 05:06:45.596 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra went to the bathroom.
2025-01-22 05:06:45.631 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7092, 7097) -->  Sandra went to the bathroom
2025-01-22 05:06:45.631 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the bathroom.
2025-01-22 05:06:45.666 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (7019, 7024) --> . John travelled to the
2025-01-22 05:06:45.666 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the bedroom.
2025-01-22 05:06:45.685 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2509, 2514) --> . Mary travelled to the
2025-01-22 05:06:45.685 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the garden.
2025-01-22 05:06:45.711 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4483, 4489) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:06:46.487 | INFO     | test_jbb_embedding:begin_test:693 - St. Paul<|eot_id|>
2025-01-22 05:06:46.487 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8152])
2025-01-22 05:06:48.732 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [1263.4192708333333, 90.79325567136726, 293.0, 86.92654805914972, 44.43009868421053], 'topk_indices': array([5553, 5907, 2496, 5908, 2930, 5554, 5560, 6044, 2495, 5909, 5557,
       2931, 8139, 8137, 8147, 5556, 6045, 5491,    0, 8148]), 'topk_tokens': [' Daniel', ',', ' There', ' in', ' football', ' dropped', ' or', ',', '.', ' which', '.', '.', ' discarded', ' football', '<|eot_id|>', ' football', ' in', '.', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [1168.3, 1374.0, 1168.3, 2848.75, 74.8125]}, 'weight': {'score': [23.029296875, 23.26246934396076, 20.259765625, 23.269079251386323, 29.88185307017544], 'topk_indices': array([3292, 3265, 3137, 3185, 7382, 7420, 1483, 1421, 4296, 4280, 5195,
       5134, 7159, 7103, 3448, 3474, 4960, 4908, 4883, 4931]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.909375, 22.3625, 19.909375, 27.341796875, 26.4859375]}, 'saliency': {'score': [7.837636311848958, 0.4966460975820049, 1.6332015991210938, 0.4726943227000539, 0.3363492196066338], 'topk_indices': array([8145, 5908, 2494, 8138, 5491, 5559, 1787, 6045, 8135, 5560, 2496,
       5490, 5909, 5889, 5553, 5554, 2930, 8137, 5556, 8139]), 'topk_tokens': ['Answer', ' in', 'St', ' was', '.', ' three', ' moved', ' in', ' where', ' or', ' There', ' St', ' which', 'ayers', ' Daniel', ' dropped', ' football', ' football', ' football', ' discarded'], 'evidence_proportions': [6.640234375, 7.526953125, 6.640234375, 20.3525390625, 0.531201171875]}}, 'pred_res': 'St. Paul<|eot_id|>', 'score': 0}
2025-01-22 05:06:48.737 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:06:48.737 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-49_pid-0_2-3-4-7-9.pkl | len: 3 |  size: 2.04 KB
Processing depth (2, 3, 4, 7, 9):   1%|          | 1/100 [00:18<31:17, 18.96s/it]is_0k: False
your chose emoji: ['💕', '🙅🏿\u200d♀', '㊗️', '🕵', '🔕', '🎵', '💆🏾\u200d♀️', '😫', '🧎🏼\u200d♂️\u200d➡️', '👨🏿\u200d🦼']
emoji:
O: 💕 [93273, 243]
N: 🕵 [9468, 243, 113]

O: 🙅🏿‍♀ [9468, 247, 227, 9468, 237, 123, 102470, 32990]
N: 🙅🏿‍♀ [9468, 247, 227, 9468, 237, 123, 102470, 32990]

O: ㊗️ [159, 232, 245, 31643]
N: 😫 [76460, 104]

O: 🕵 [9468, 243, 113]
N: 💕 [93273, 243]

O: 🔕 [9468, 242, 243]
N: 💆🏾‍♀️ [93273, 228, 9468, 237, 122, 102470, 32990, 31643]

O: 🎵 [9468, 236, 113]
N: 🔕 [9468, 242, 243]

O: 💆🏾‍♀️ [93273, 228, 9468, 237, 122, 102470, 32990, 31643]
N: ㊗️ [159, 232, 245, 31643]

O: 😫 [76460, 104]
N: 🧎🏼‍♂️‍➡️ [9468, 100, 236, 9468, 237, 120, 102470, 17245, 224, 31643, 102470, 98115, 94, 31643]

O: 🧎🏼‍♂️‍➡️ [9468, 100, 236, 9468, 237, 120, 102470, 17245, 224, 31643, 102470, 98115, 94, 31643]
N: 🎵 [9468, 236, 113]

O: 👨🏿‍🦼 [9468, 239, 101, 9468, 237, 123, 102470, 9468, 99, 120]
N: 👨🏿‍🦼 [9468, 239, 101, 9468, 237, 123, 102470, 9468, 99, 120]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.43s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.60s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.32s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  2.98s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.51s/it]
Processing depth (1, 2, 5, 6, 9):   1%|          | 1/100 [00:34<31:17, 18.96s/it]2025-01-22 05:07:04.452 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the kitchen.
2025-01-22 05:07:04.457 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (843, 848) --> . Daniel moved to the
2025-01-22 05:07:04.458 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel picked up the football.
2025-01-22 05:07:04.467 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1817, 1822) --> . Daniel picked up the
2025-01-22 05:07:04.468 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 05:07:04.472 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (843, 848) --> . Daniel moved to the
2025-01-22 05:07:04.472 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel dropped the football.
2025-01-22 05:07:04.500 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4877, 4881) -->  Daniel dropped the football
2025-01-22 05:07:04.501 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra went to the bathroom.
2025-01-22 05:07:04.537 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7246, 7251) -->  Sandra went to the bathroom
2025-01-22 05:07:04.537 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the bathroom.
2025-01-22 05:07:04.576 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (7108, 7113) -->  John travelled to the bathroom
2025-01-22 05:07:04.577 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the bedroom.
2025-01-22 05:07:04.589 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2541, 2546) --> . Mary travelled to the
2025-01-22 05:07:04.589 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the garden.
2025-01-22 05:07:04.612 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4615, 4621) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:07:05.415 | INFO     | test_jbb_embedding:begin_test:693 - The office.<|eot_id|>
2025-01-22 05:07:05.415 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8214])
2025-01-22 05:07:07.651 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [235.38020833333334, 23.5417598423999, 80.251953125, 22.809035633484164, 12.451105291193182], 'topk_indices': array([8186, 8201, 8133, 8199, 8058, 8208,   23, 8093, 8212, 8213, 8206,
         14, 8188, 8187, 8103, 4880, 8059,    0, 8209, 8210]), 'topk_tokens': ['.\n\n', ' discarded', ' the', ' football', ' you', ':', '4', '.\n\n', '<|end_header_id|>', '\n\n', '?\n', '\n', ':', 'Question', ' location', ' football', ' context', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [244.725, 225.95, 244.725, 471.8125, 36.975]}, 'weight': {'score': [23.029296875, 23.299269045880493, 22.03759765625, 23.302530153173535, 29.268110795454547], 'topk_indices': array([3344, 3317, 3237, 3189, 7424, 7462, 1453, 1515, 4318, 4302, 5125,
       5186, 7119, 7175, 3500, 3526, 4927, 4902, 4979, 4950]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.909375, 22.3625, 19.909375, 27.341796875, 26.4859375]}, 'saliency': {'score': [1.4361368815104167, 0.13084318215095228, 0.4737434387207031, 0.12634110891018635, 0.09089591286399147], 'topk_indices': array([  20, 8196,   23, 8093, 8206, 8058, 8189, 8057, 4894,  848, 4878,
       8193, 1822, 8207, 8199, 8201, 8103, 8187, 4880, 8059]), 'topk_tokens': [' Jul', ' place', '4', '.\n\n', '?\n', ' you', ' Where', ' provided', ' supposed', ' kitchen', ' dropped', ' prior', ' football', 'Answer', ' football', ' discarded', ' location', 'Question', ' football', ' context'], 'evidence_proportions': [1.33876953125, 1.2767578125, 1.33876953125, 3.3544921875, 0.25556640625]}}, 'pred_res': 'The office.<|eot_id|>', 'score': 0}
2025-01-22 05:07:07.658 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:07:07.658 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-49_pid-1_1-2-5-6-9.pkl | len: 3 |  size: 2.09 KB
Processing depth (1, 2, 5, 6, 9):   2%|▏         | 2/100 [00:37<30:55, 18.94s/it]is_0k: False
your chose emoji: ['👨🏾\u200d🔧', '🌪', '👩🏻\u200d❤\u200d👩🏽', '🏖️', '🧑🏿\u200d🤝\u200d🧑🏼', '💂🏿\u200d♀', '🤭', '🤹🏿\u200d♀️', '🦢', '👨🏻\u200d🤝\u200d👨🏿']
emoji:
O: 👨🏾‍🔧 [9468, 239, 101, 9468, 237, 122, 102470, 9468, 242, 100]
N: 🧑🏿‍🤝‍🧑🏼 [9468, 100, 239, 9468, 237, 123, 102470, 9468, 97, 251, 102470, 9468, 100, 239, 9468, 237, 120]

O: 🌪 [9468, 234, 103]
N: 💂🏿‍♀ [93273, 224, 9468, 237, 123, 102470, 32990]

O: 👩🏻‍❤‍👩🏽 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 102470, 9468, 239, 102, 9468, 237, 121]
N: 🏖️ [9468, 237, 244, 31643]

O: 🏖️ [9468, 237, 244, 31643]
N: 🤹🏿‍♀️ [9468, 97, 117, 9468, 237, 123, 102470, 32990, 31643]

O: 🧑🏿‍🤝‍🧑🏼 [9468, 100, 239, 9468, 237, 123, 102470, 9468, 97, 251, 102470, 9468, 100, 239, 9468, 237, 120]
N: 🌪 [9468, 234, 103]

O: 💂🏿‍♀ [93273, 224, 9468, 237, 123, 102470, 32990]
N: 👩🏻‍❤‍👩🏽 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 102470, 9468, 239, 102, 9468, 237, 121]

O: 🤭 [9468, 97, 255]
N: 🤭 [9468, 97, 255]

O: 🤹🏿‍♀️ [9468, 97, 117, 9468, 237, 123, 102470, 32990, 31643]
N: 👨🏾‍🔧 [9468, 239, 101, 9468, 237, 122, 102470, 9468, 242, 100]

O: 🦢 [9468, 99, 95]
N: 🦢 [9468, 99, 95]

O: 👨🏻‍🤝‍👨🏿 [9468, 239, 101, 9468, 237, 119, 102470, 9468, 97, 251, 102470, 9468, 239, 101, 9468, 237, 123]
N: 👨🏻‍🤝‍👨🏿 [9468, 239, 101, 9468, 237, 119, 102470, 9468, 97, 251, 102470, 9468, 239, 101, 9468, 237, 123]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.11s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.24s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.17s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.74s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.27s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (2, 3, 5, 6, 9):   2%|▏         | 2/100 [00:52<30:55, 18.94s/it]2025-01-22 05:07:22.500 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the kitchen.
2025-01-22 05:07:22.510 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1845, 1850) --> . Daniel moved to the
2025-01-22 05:07:22.510 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel picked up the football.
2025-01-22 05:07:22.524 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2925, 2930) --> . Daniel picked up the
2025-01-22 05:07:22.524 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 05:07:22.534 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1845, 1850) --> . Daniel moved to the
2025-01-22 05:07:22.534 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel dropped the football.
2025-01-22 05:07:22.560 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4779, 4783) -->  Daniel dropped the football
2025-01-22 05:07:22.560 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra went to the bathroom.
2025-01-22 05:07:22.611 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7154, 7159) -->  Sandra went to the bathroom
2025-01-22 05:07:22.611 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the bathroom.
2025-01-22 05:07:22.649 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (7079, 7084) --> . John travelled to the
2025-01-22 05:07:22.649 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the bedroom.
2025-01-22 05:07:22.663 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2509, 2514) --> . Mary travelled to the
2025-01-22 05:07:22.664 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the garden.
2025-01-22 05:07:22.689 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4595, 4601) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:07:25.800 | INFO     | test_jbb_embedding:begin_test:693 - the kitchen<|eot_id|>
2025-01-22 05:07:25.800 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8214])
2025-01-22 05:07:28.783 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [307.5748697916667, 24.041031550444202, 105.2705078125, 23.049899871591048, 16.951793323863637], 'topk_indices': array([  14,   24, 8213, 8188, 8206, 1846, 8207, 8208,   23, 4782, 2931,
       8194, 8199, 1850, 1847, 8212, 2930,    0, 8209, 8210]), 'topk_tokens': ['\n', '\n\n', '\n\n', ':', '?\n', ' Daniel', 'Answer', ':', '4', ' football', '.', ' to', ' football', ' kitchen', ' moved', '<|end_header_id|>', ' football', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [439.3, 348.65, 439.3, 293.53125, 14.284375]}, 'weight': {'score': [23.029296875, 23.306122216137275, 20.259765625, 23.312895545432312, 29.588068181818183], 'topk_indices': array([3292, 3265, 3137, 3185, 7482, 7444, 1409, 1471, 4298, 4282, 5143,
       5204, 7165, 7221, 3448, 3474, 4979, 4927, 4902, 4950]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.909375, 22.3625, 19.909375, 27.341796875, 26.4859375]}, 'saliency': {'score': [1.7948379516601562, 0.13403439159098515, 0.598663330078125, 0.12825068748710178, 0.12760821255770596], 'topk_indices': array([8103, 1592, 2927, 8196,   23, 8174,  960,   20, 8187, 8201, 8197,
       2926, 8193, 8207, 1846, 4782, 1850, 8199, 1847, 2930]), 'topk_tokens': [' location', ' time', ' picked', ' place', '4', ' return', '�', ' Jul', 'Question', ' discarded', ' where', ' Daniel', ' prior', 'Answer', ' Daniel', ' football', ' kitchen', ' football', ' moved', ' football'], 'evidence_proportions': [2.4546875, 1.9005859375, 2.4546875, 2.116455078125, 0.11209716796875]}}, 'pred_res': 'the kitchen<|eot_id|>', 'score': 100}
2025-01-22 05:07:28.789 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:07:28.789 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-49_pid-2_2-3-5-6-9.pkl | len: 3 |  size: 2.08 KB
Processing depth (2, 3, 5, 6, 9):   3%|▎         | 3/100 [00:59<32:14, 19.94s/it]is_0k: False
your chose emoji: ['🚣🏼\u200d♀️', '🧑🏾\u200d❤\u200d💋\u200d🧑🏻', '💏🏾', '🙋\u200d♂', '👩\u200d🦲', '🧑🏼\u200d🔧', '🃏', '🇺🇲', '👨🏽\u200d🦯\u200d➡️', '🤽🏼\u200d♂️']
emoji:
O: 🚣🏼‍♀️ [9468, 248, 96, 9468, 237, 120, 102470, 32990, 31643]
N: 💏🏾 [93273, 237, 9468, 237, 122]

O: 🧑🏾‍❤‍💋‍🧑🏻 [9468, 100, 239, 9468, 237, 122, 102470, 121643, 102470, 93273, 233, 102470, 9468, 100, 239, 9468, 237, 119]
N: 🙋‍♂ [9468, 247, 233, 102470, 17245, 224]

O: 💏🏾 [93273, 237, 9468, 237, 122]
N: 🚣🏼‍♀️ [9468, 248, 96, 9468, 237, 120, 102470, 32990, 31643]

O: 🙋‍♂ [9468, 247, 233, 102470, 17245, 224]
N: 👩‍🦲 [9468, 239, 102, 102470, 9468, 99, 110]

O: 👩‍🦲 [9468, 239, 102, 102470, 9468, 99, 110]
N: 🧑🏼‍🔧 [9468, 100, 239, 9468, 237, 120, 102470, 9468, 242, 100]

O: 🧑🏼‍🔧 [9468, 100, 239, 9468, 237, 120, 102470, 9468, 242, 100]
N: 🇺🇲 [9468, 229, 118, 9468, 229, 110]

O: 🃏 [9468, 225, 237]
N: 🃏 [9468, 225, 237]

O: 🇺🇲 [9468, 229, 118, 9468, 229, 110]
N: 👨🏽‍🦯‍➡️ [9468, 239, 101, 9468, 237, 121, 102470, 9468, 99, 107, 102470, 98115, 94, 31643]

O: 👨🏽‍🦯‍➡️ [9468, 239, 101, 9468, 237, 121, 102470, 9468, 99, 107, 102470, 98115, 94, 31643]
N: 🧑🏾‍❤‍💋‍🧑🏻 [9468, 100, 239, 9468, 237, 122, 102470, 121643, 102470, 93273, 233, 102470, 9468, 100, 239, 9468, 237, 119]

O: 🤽🏼‍♂️ [9468, 97, 121, 9468, 237, 120, 102470, 17245, 224, 31643]
N: 🤽🏼‍♂️ [9468, 97, 121, 9468, 237, 120, 102470, 17245, 224, 31643]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.23s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.33s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.49s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.19s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.63s/it]
Processing depth (0, 4, 5, 7, 8):   3%|▎         | 3/100 [01:15<32:14, 19.94s/it]2025-01-22 05:07:44.992 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the kitchen.
2025-01-22 05:07:44.992 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  moved to the kitchen.
2025-01-22 05:07:44.992 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel picked up the football.
2025-01-22 05:07:45.013 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3614, 3619) -->  Hon. Daniel picked up
2025-01-22 05:07:45.014 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 05:07:45.036 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4137, 4142) --> . Daniel moved to the
2025-01-22 05:07:45.037 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel dropped the football.
2025-01-22 05:07:45.065 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5565, 5569) -->  Daniel dropped the football
2025-01-22 05:07:45.065 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra went to the bathroom.
2025-01-22 05:07:45.101 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6513, 6518) --> . Sandra went to the
2025-01-22 05:07:45.101 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the bathroom.
2025-01-22 05:07:45.136 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (7065, 7070) --> . John travelled to the
2025-01-22 05:07:45.136 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the bedroom.
2025-01-22 05:07:45.149 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2533, 2538) --> . Mary travelled to the
2025-01-22 05:07:45.149 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the garden.
2025-01-22 05:07:45.172 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4546, 4552) -->  John went back to the garden
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:07:45.961 | INFO     | test_jbb_embedding:begin_test:693 - The office.<|eot_id|>
2025-01-22 05:07:45.961 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8192])
2025-01-22 05:07:48.201 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [503.9869791666667, 58.842510677242224, 118.5625, 57.41528969957081, 35.29811789772727], 'topk_indices': array([  68, 6049, 2049, 6055, 8188,   31,  185, 6051, 6054, 6036, 5899,
       5900, 5919, 6037, 5920, 5901, 6056, 5921,    0, 6057]), 'topk_tokens': ['E', ' the', 'ra', ' Charleston', '<|start_header_id|>', ' moved', 'ION', '\n', ' in', '\n', '\n', 'S', ',', 'S', ' in', 'ayers', ',', ' which', '<|begin_of_text|>', ' in'], 'evidence_proportions': [1019.0, 376.075, 448.4, 596.4375, 98.5125]}, 'weight': {'score': [22.824869791666668, 23.280430140329468, 21.67041015625, 23.284929682709993, 29.10734577922078], 'topk_indices': array([3277, 3304, 3127, 3175, 7460, 7422, 1485, 1423, 4298, 4314, 5177,
       5116, 7143, 7199, 3460, 3486, 4893, 4918, 4970, 4941]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.809375, 27.1703125, 19.909375, 27.341796875, 20.796875]}, 'saliency': {'score': [2.941095987955729, 0.32642626387088164, 0.6659698486328125, 0.3180651638421597, 0.254891333641944], 'topk_indices': array([2049, 8171, 2050, 6054, 5985, 8177,   30,   34, 5919, 8179,  185,
       5918,   31, 6055, 5920, 5900, 6037, 6057, 5921, 5901]), 'topk_tokens': ['ra', ' prior', 'irie', ' in', ' *\n\n', ' football', 'Daniel', ' kitchen', ',', ' discarded', 'ION', ' Charleston', ' moved', ' Charleston', ' in', 'S', 'S', ' in', ' which', 'ayers'], 'evidence_proportions': [5.484765625, 2.48671875, 2.22314453125, 4.209228515625, 0.5552490234375]}}, 'pred_res': 'The office.<|eot_id|>', 'score': 0}
2025-01-22 05:07:48.216 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:07:48.216 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-49_pid-3_0-4-5-7-8.pkl | len: 3 |  size: 2.0 KB
Processing depth (0, 4, 5, 7, 8):   4%|▍         | 4/100 [01:18<31:34, 19.74s/it]is_0k: False
your chose emoji: ['🏈', '👨🏾\u200d🤝\u200d👨🏼', '🇺🇦', '🦸🏾\u200d♂', '🍤', '☝🏾', '🏃🏼\u200d♂\u200d➡', '🏋🏻\u200d♂', '🤜', '👨🏿\u200d🦯']
emoji:
O: 🏈 [9468, 237, 230]
N: 🦸🏾‍♂ [9468, 99, 116, 9468, 237, 122, 102470, 17245, 224]

O: 👨🏾‍🤝‍👨🏼 [9468, 239, 101, 9468, 237, 122, 102470, 9468, 97, 251, 102470, 9468, 239, 101, 9468, 237, 120]
N: 🇺🇦 [9468, 229, 118, 9468, 229, 99]

O: 🇺🇦 [9468, 229, 118, 9468, 229, 99]
N: ☝🏾 [18107, 251, 9468, 237, 122]

O: 🦸🏾‍♂ [9468, 99, 116, 9468, 237, 122, 102470, 17245, 224]
N: 🤜 [9468, 97, 250]

O: 🍤 [9468, 235, 97]
N: 🏈 [9468, 237, 230]

O: ☝🏾 [18107, 251, 9468, 237, 122]
N: 🏋🏻‍♂ [9468, 237, 233, 9468, 237, 119, 102470, 17245, 224]

O: 🏃🏼‍♂‍➡ [9468, 237, 225, 9468, 237, 120, 102470, 17245, 224, 102470, 98115, 94]
N: 🏃🏼‍♂‍➡ [9468, 237, 225, 9468, 237, 120, 102470, 17245, 224, 102470, 98115, 94]

O: 🏋🏻‍♂ [9468, 237, 233, 9468, 237, 119, 102470, 17245, 224]
N: 🍤 [9468, 235, 97]

O: 🤜 [9468, 97, 250]
N: 👨🏾‍🤝‍👨🏼 [9468, 239, 101, 9468, 237, 122, 102470, 9468, 97, 251, 102470, 9468, 239, 101, 9468, 237, 120]

O: 👨🏿‍🦯 [9468, 239, 101, 9468, 237, 123, 102470, 9468, 99, 107]
N: 👨🏿‍🦯 [9468, 239, 101, 9468, 237, 123, 102470, 9468, 99, 107]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.33s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.35s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:03,  3.96s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  2.56s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  3.15s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 2, 3, 4, 8):   4%|▍         | 4/100 [01:33<31:34, 19.74s/it]2025-01-22 05:08:03.067 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the kitchen.
2025-01-22 05:08:03.067 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  moved to the kitchen.
2025-01-22 05:08:03.067 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel picked up the football.
2025-01-22 05:08:03.077 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1879, 1884) --> . Daniel picked up the
2025-01-22 05:08:03.077 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 05:08:03.092 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2967, 2972) --> . Daniel moved to the
2025-01-22 05:08:03.092 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel dropped the football.
2025-01-22 05:08:03.110 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3662, 3666) -->  Daniel dropped the football
2025-01-22 05:08:03.110 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra went to the bathroom.
2025-01-22 05:08:03.143 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6641, 6646) --> . Sandra went to the
2025-01-22 05:08:03.143 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the bathroom.
2025-01-22 05:08:03.176 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6645, 6650) -->  the bathroom. Senator John
2025-01-22 05:08:03.176 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary travelled to the bedroom.
2025-01-22 05:08:03.189 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2559, 2564) --> . Mary travelled to the
2025-01-22 05:08:03.189 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the garden.
2025-01-22 05:08:03.212 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4626, 4632) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:08:06.241 | INFO     | test_jbb_embedding:begin_test:693 - The office.<|eot_id|>
2025-01-22 05:08:06.242 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8204])
2025-01-22 05:08:09.227 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [743.4583333333334, 48.442929816010725, 112.3671875, 46.27528468225787, 19.27035485692771], 'topk_indices': array([ 430,  547,  546, 2969,  185,   69,   32, 2971,   31,  105,   66,
        548,  541,   67,  424,   68,  425, 8199, 8200,    0]), 'topk_tokens': ['s', 's', ' em', ' moved', 'ION', 'ER', ' to', ' the', ' moved', 'ION', ' P', ' per', ' to', 'ION', ' to', 'E', ' ', '<|eot_id|>', '<|start_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [1423.4, 438.15, 1195.4, 539.46875, 80.075]}, 'weight': {'score': [21.8232421875, 23.296815980260753, 21.7998046875, 23.304079106465043, 29.496234939759034], 'topk_indices': array([3307, 3334, 3227, 3179, 7456, 7418, 1443, 1505, 4329, 4313, 5198,
       5137, 7139, 7195, 3532, 3506, 4914, 4962, 4991, 4939]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.809375, 22.3625, 19.909375, 27.341796875, 20.796875]}, 'saliency': {'score': [3.9604339599609375, 0.2668280329006488, 0.61944580078125, 0.25528298251059905, 0.1404172598597515], 'topk_indices': array([ 431,  453,   69,  541,   63,  424,   64,   30, 8183,  185,  546,
         34, 1884,   66, 2969,  105,   68,   31,  548,   67]), 'topk_tokens': [' per', ' per', 'ER', ' to', 'ISC', ' to', 'ENCES', 'Daniel', ' prior', 'ION', ' em', ' kitchen', ' football', ' P', ' moved', 'ION', 'E', ' moved', ' per', 'ION'], 'evidence_proportions': [7.454296875, 2.3455078125, 5.78125, 3.646728515625, 0.5116455078125]}}, 'pred_res': 'The office.<|eot_id|>', 'score': 0}
2025-01-22 05:08:09.233 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:08:09.234 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-49_pid-4_0-2-3-4-8.pkl | len: 3 |  size: 2.0 KB
Processing depth (0, 2, 3, 4, 8):   5%|▌         | 5/100 [01:39<31:58, 20.20s/it]Processing depth (0, 2, 3, 4, 8):   5%|▌         | 5/100 [01:39<31:31, 19.91s/it]
2025-01-22 05:08:09.310 | INFO     | __main__:<module>:82 - Selected idx: 50
2025-01-22 05:08:09.310 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the apple before the kitchen? 
2025-01-22 05:08:09.310 | INFO     | __main__:<module>:84 - Answer: hallway
2025-01-22 05:08:09.310 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 05:08:09.310 | INFO     | __main__:<module>:86 - Needle: [' Sandra went back to the garden.', ' Daniel put down the football there.', ' Mary travelled to the hallway.', ' Daniel journeyed to the kitchen.', ' Daniel took the football.', ' Sandra picked up the apple.', ' Mary went to the kitchen.', ' Sandra moved to the hallway.', ' Sandra left the apple.', ' Mary put down the apple.', ' Daniel went to the garden.']
2025-01-22 05:08:09.311 | INFO     | __main__:<module>:87 - Real Needle: [' Mary travelled to the hallway.', ' Mary went to the kitchen.', ' Mary put down the apple.', ' Daniel went to the garden.']
2025-01-22 05:08:09.311 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['🈷', '👨🏿\u200d🔧', '🧗🏾\u200d♀️', '👨🏽\u200d❤️\u200d💋\u200d👨🏽', '🍺', '👩🏽\u200d🦽\u200d➡', '🚣🏿\u200d♀️', '🦸🏾\u200d♀', '🛥', '🇦🇸']
emoji:
O: 🈷 [9468, 230, 115]
N: 👨🏽‍❤️‍💋‍👨🏽 [9468, 239, 101, 9468, 237, 121, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 121]

O: 👨🏿‍🔧 [9468, 239, 101, 9468, 237, 123, 102470, 9468, 242, 100]
N: 👨🏿‍🔧 [9468, 239, 101, 9468, 237, 123, 102470, 9468, 242, 100]

O: 🧗🏾‍♀️ [9468, 100, 245, 9468, 237, 122, 102470, 32990, 31643]
N: 🦸🏾‍♀ [9468, 99, 116, 9468, 237, 122, 102470, 32990]

O: 👨🏽‍❤️‍💋‍👨🏽 [9468, 239, 101, 9468, 237, 121, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 121]
N: 🛥 [9468, 249, 98]

O: 🍺 [9468, 235, 118]
N: 🈷 [9468, 230, 115]

O: 👩🏽‍🦽‍➡ [9468, 239, 102, 9468, 237, 121, 102470, 9468, 99, 121, 102470, 98115, 94]
N: 🚣🏿‍♀️ [9468, 248, 96, 9468, 237, 123, 102470, 32990, 31643]

O: 🚣🏿‍♀️ [9468, 248, 96, 9468, 237, 123, 102470, 32990, 31643]
N: 👩🏽‍🦽‍➡ [9468, 239, 102, 9468, 237, 121, 102470, 9468, 99, 121, 102470, 98115, 94]

O: 🦸🏾‍♀ [9468, 99, 116, 9468, 237, 122, 102470, 32990]
N: 🍺 [9468, 235, 118]

O: 🛥 [9468, 249, 98]
N: 🧗🏾‍♀️ [9468, 100, 245, 9468, 237, 122, 102470, 32990, 31643]

O: 🇦🇸 [9468, 229, 99, 9468, 229, 116]
N: 🇦🇸 [9468, 229, 99, 9468, 229, 116]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:05<00:16,  5.53s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.87s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.41s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.06s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.70s/it]
Processing depth (0, 2, 3, 8):   0%|          | 0/100 [00:16<?, ?it/s]2025-01-22 05:08:25.872 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the hallway.
2025-01-22 05:08:25.872 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  travelled to the hallway.
2025-01-22 05:08:25.873 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went to the kitchen.
2025-01-22 05:08:25.882 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1864, 1869) --> . Mary went to the
2025-01-22 05:08:25.882 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary put down the apple.
2025-01-22 05:08:25.898 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2960, 2965) --> . Mary put down the
2025-01-22 05:08:25.899 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went to the garden.
2025-01-22 05:08:25.935 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6560, 6565) --> . Daniel went to the
2025-01-22 05:08:25.935 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went back to the garden.
2025-01-22 05:08:25.970 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6984, 6990) --> . Sandra went back to the
2025-01-22 05:08:25.970 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel put down the football there.
2025-01-22 05:08:26.016 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (7431, 7437) --> . Daniel put down the football
2025-01-22 05:08:26.016 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel journeyed to the kitchen.
2025-01-22 05:08:26.051 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4346, 4352) -->  Daniel journeyed to the kitchen
2025-01-22 05:08:26.051 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel took the football.
2025-01-22 05:08:26.053 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (202, 206) -->  Daniel took the football
2025-01-22 05:08:26.053 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra picked up the apple.
2025-01-22 05:08:26.063 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1724, 1729) --> . Sandra picked up the
2025-01-22 05:08:26.063 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra moved to the hallway.
2025-01-22 05:08:26.100 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (6454, 6459) --> . Sandra moved to the
2025-01-22 05:08:26.100 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Sandra left the apple.
2025-01-22 05:08:26.124 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (4193, 4197) -->  Sandra left the apple
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:08:26.913 | INFO     | test_jbb_embedding:begin_test:693 - The hallway.<|eot_id|>
2025-01-22 05:08:26.913 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8208])
2025-01-22 05:08:29.160 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [260.74375, 27.163439288758983, 207.65407986111111, 25.793817060085836, 23.304931640625], 'topk_indices': array([ 177, 8194, 6459,   24, 8189,  196,  193,   14, 8191, 8197, 8195,
       8193, 8190, 8199,  197, 8198, 8204, 8196, 8203,    0]), 'topk_tokens': ['ION', ' the', ' hallway', '\n\n', '.\n\n', ' P', 'G', '\n', ':', ' the', ' apple', ' was', 'Question', '?', 'ION', ' kitchen', '<|start_header_id|>', ' before', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [460.4, 305.425, 212.375, 64.775]}, 'weight': {'score': [20.76640625, 23.297659009255877, 23.95681423611111, 23.300957043225015, 29.53359375], 'topk_indices': array([3327, 3300, 3172, 3220, 7493, 7455, 1422, 1484, 4357, 4373, 5229,
       5168, 7225, 7169, 3509, 3483, 5022, 4993, 4945, 4970]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.225, 19.403125, 21.771875, 19.665625]}, 'saliency': {'score': [1.438299560546875, 0.15276594885576514, 1.3022121853298612, 0.1445390038224249, 0.17596149444580078], 'topk_indices': array([   0,   38,  196, 8189, 1725,   31,  177,  193, 4351, 8192, 1869,
       8193, 8199,   34, 6459, 8195, 8190,  197, 8196, 8198]), 'topk_tokens': ['<|begin_of_text|>', '***', ' P', '.\n\n', ' Sandra', ' travelled', 'ION', 'G', ' kitchen', ' Where', ' kitchen', ' was', '?', ' hallway', ' hallway', ' apple', 'Question', 'ION', ' before', ' kitchen'], 'evidence_proportions': [2.76064453125, 1.467578125, 1.205322265625, 0.3196533203125]}}, 'pred_res': 'The hallway.<|eot_id|>', 'score': 100}
2025-01-22 05:08:29.166 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:08:29.166 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-50_pid-0_0-2-3-8.pkl | len: 3 |  size: 1.99 KB
Processing depth (0, 2, 3, 8):   1%|          | 1/100 [00:19<32:36, 19.76s/it]is_0k: False
your chose emoji: ['💆🏼\u200d♂', '🥁', '🏇🏾', '👩🏼\u200d🤝\u200d👨🏻', '🇵🇪', '🚶🏻\u200d♀️\u200d➡️', '🧕🏿', '🤹🏻', '💂🏿\u200d♂️', '😶\u200d🌫']
emoji:
O: 💆🏼‍♂ [93273, 228, 9468, 237, 120, 102470, 17245, 224]
N: 🧕🏿 [9468, 100, 243, 9468, 237, 123]

O: 🥁 [9468, 98, 223]
N: 👩🏼‍🤝‍👨🏻 [9468, 239, 102, 9468, 237, 120, 102470, 9468, 97, 251, 102470, 9468, 239, 101, 9468, 237, 119]

O: 🏇🏾 [9468, 237, 229, 9468, 237, 122]
N: 🚶🏻‍♀️‍➡️ [9468, 248, 114, 9468, 237, 119, 102470, 32990, 31643, 102470, 98115, 94, 31643]

O: 👩🏼‍🤝‍👨🏻 [9468, 239, 102, 9468, 237, 120, 102470, 9468, 97, 251, 102470, 9468, 239, 101, 9468, 237, 119]
N: 🏇🏾 [9468, 237, 229, 9468, 237, 122]

O: 🇵🇪 [9468, 229, 113, 9468, 229, 103]
N: 🤹🏻 [9468, 97, 117, 9468, 237, 119]

O: 🚶🏻‍♀️‍➡️ [9468, 248, 114, 9468, 237, 119, 102470, 32990, 31643, 102470, 98115, 94, 31643]
N: 💆🏼‍♂ [93273, 228, 9468, 237, 120, 102470, 17245, 224]

O: 🧕🏿 [9468, 100, 243, 9468, 237, 123]
N: 🥁 [9468, 98, 223]

O: 🤹🏻 [9468, 97, 117, 9468, 237, 119]
N: 💂🏿‍♂️ [93273, 224, 9468, 237, 123, 102470, 17245, 224, 31643]

O: 💂🏿‍♂️ [93273, 224, 9468, 237, 123, 102470, 17245, 224, 31643]
N: 🇵🇪 [9468, 229, 113, 9468, 229, 103]

O: 😶‍🌫 [76460, 114, 102470, 9468, 234, 104]
N: 😶‍🌫 [76460, 114, 102470, 9468, 234, 104]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.19s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:09,  4.53s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.10s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  2.64s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  3.24s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (2, 5, 6, 9):   1%|          | 1/100 [00:34<32:36, 19.76s/it]2025-01-22 05:08:43.905 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the hallway.
2025-01-22 05:08:43.914 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1750, 1755) --> . Mary travelled to the
2025-01-22 05:08:43.914 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went to the kitchen.
2025-01-22 05:08:43.935 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4201, 4206) -->  Mary went to the kitchen
2025-01-22 05:08:43.935 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary put down the apple.
2025-01-22 05:08:43.959 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4856, 4861) --> . Mary put down the
2025-01-22 05:08:43.959 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went to the garden.
2025-01-22 05:08:43.994 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7087, 7092) -->  back to the garden.
2025-01-22 05:08:43.994 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went back to the garden.
2025-01-22 05:08:44.030 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (7085, 7091) -->  Sandra went back to the garden
2025-01-22 05:08:44.030 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel put down the football there.
2025-01-22 05:08:44.068 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (7547, 7553) --> . Daniel put down the football
2025-01-22 05:08:44.068 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel journeyed to the kitchen.
2025-01-22 05:08:44.090 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4359, 4365) --> . Daniel journeyed to the
2025-01-22 05:08:44.090 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel took the football.
2025-01-22 05:08:44.091 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (232, 236) -->  Daniel took the football
2025-01-22 05:08:44.091 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra picked up the apple.
2025-01-22 05:08:44.099 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1544, 1549) --> . Sandra picked up the
2025-01-22 05:08:44.099 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra moved to the hallway.
2025-01-22 05:08:44.132 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (6566, 6571) --> . Sandra moved to the
2025-01-22 05:08:44.132 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Sandra left the apple.
2025-01-22 05:08:44.152 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (4207, 4211) -->  Sandra left the apple
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:08:47.769 | INFO     | test_jbb_embedding:begin_test:693 - The hallway.<|eot_id|>
2025-01-22 05:08:47.770 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8170])
2025-01-22 05:08:50.729 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [173.1046875, 23.682798926342837, 192.84157986111111, 22.56438647283479, 23.428086577868854], 'topk_indices': array([8154, 8168, 1755, 2718,   24, 1549, 8160, 6047,    3, 6042, 5911,
       8161, 8158, 5913, 1550, 6048, 8165, 8166, 6049,    0]), 'topk_tokens': [' Where', '<|end_header_id|>', ' hallway', ' Hill', '\n\n', ' apple', ' kitchen', ' on', '<|end_header_id|>', ' the', '\n', '?', ' before', ' way', '.', '\n', '<|eot_id|>', '<|start_header_id|>', 'the', '<|begin_of_text|>'], 'evidence_proportions': [185.95, 216.9, 99.5375, 190.03125]}, 'weight': {'score': [21.391796875, 23.262330998409396, 23.918619791666668, 23.26402919797955, 29.116803278688526], 'topk_indices': array([3280, 3307, 3152, 3200, 7424, 7386, 1442, 1504, 4282, 4298, 5106,
       5167, 7101, 7157, 3501, 3475, 4908, 4883, 4960, 4931]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.75625, 24.1921875, 21.771875, 18.846875]}, 'saliency': {'score': [1.01092529296875, 0.1324875865559617, 1.2081332736545138, 0.12555251216101238, 0.17798026663358094], 'topk_indices': array([6046,   24, 6047, 1546,  235, 8152, 5912, 5906, 6571, 8157, 8161,
       8154, 2718, 1549, 5913, 1545, 8160, 8158, 1755, 6049]), 'topk_tokens': [' meet', '\n\n', ' on', ' picked', ' football', 'Question', 'the', ' people', ' hallway', ' apple', '?', ' Where', ' Hill', ' apple', ' way', ' Sandra', ' kitchen', ' before', ' hallway', 'the'], 'evidence_proportions': [1.055126953125, 1.34775390625, 0.5533935546875, 1.0874267578125]}}, 'pred_res': 'The hallway.<|eot_id|>', 'score': 100}
2025-01-22 05:08:50.740 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:08:50.740 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-50_pid-1_2-5-6-9.pkl | len: 3 |  size: 2.01 KB
Processing depth (2, 5, 6, 9):   2%|▏         | 2/100 [00:41<34:01, 20.83s/it]is_0k: False
your chose emoji: ['👩🏽\u200d❤️\u200d👨🏿', '🐾', '\U0001fac3🏽', '🧔🏼\u200d♀', '🇧🇦', '💳', '🧸', '🏳️\u200d⚧', '🐐', '🧔🏻']
emoji:
O: 👩🏽‍❤️‍👨🏿 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 123]
N: 🏳️‍⚧ [9468, 237, 111, 31643, 102470, 158, 248, 100]

O: 🐾 [9468, 238, 122]
N: 🐐 [9468, 238, 238]

O: 🫃🏽 [9468, 104, 225, 9468, 237, 121]
N: 🧔🏼‍♀ [9468, 100, 242, 9468, 237, 120, 102470, 32990]

O: 🧔🏼‍♀ [9468, 100, 242, 9468, 237, 120, 102470, 32990]
N: 🫃🏽 [9468, 104, 225, 9468, 237, 121]

O: 🇧🇦 [9468, 229, 100, 9468, 229, 99]
N: 👩🏽‍❤️‍👨🏿 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 123]

O: 💳 [93273, 111]
N: 💳 [93273, 111]

O: 🧸 [9468, 100, 116]
N: 🇧🇦 [9468, 229, 100, 9468, 229, 99]

O: 🏳️‍⚧ [9468, 237, 111, 31643, 102470, 158, 248, 100]
N: 🐾 [9468, 238, 122]

O: 🐐 [9468, 238, 238]
N: 🧸 [9468, 100, 116]

O: 🧔🏻 [9468, 100, 242, 9468, 237, 119]
N: 🧔🏻 [9468, 100, 242, 9468, 237, 119]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.44s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.44s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.35s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.03s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.54s/it]
Processing depth (1, 3, 4, 8):   2%|▏         | 2/100 [00:57<34:01, 20.83s/it]2025-01-22 05:09:06.632 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the hallway.
2025-01-22 05:09:06.636 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (782, 787) --> . Mary travelled to the
2025-01-22 05:09:06.636 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went to the kitchen.
2025-01-22 05:09:06.651 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2842, 2847) --> . Mary went to the
2025-01-22 05:09:06.651 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary put down the apple.
2025-01-22 05:09:06.672 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3560, 3565) --> . Mary put down the
2025-01-22 05:09:06.672 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went to the garden.
2025-01-22 05:09:06.707 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6622, 6627) --> . Daniel went to the
2025-01-22 05:09:06.707 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went back to the garden.
2025-01-22 05:09:06.743 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (7042, 7048) --> . Sandra went back to the
2025-01-22 05:09:06.743 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel put down the football there.
2025-01-22 05:09:06.783 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (7423, 7429) --> . Daniel put down the football
2025-01-22 05:09:06.783 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel journeyed to the kitchen.
2025-01-22 05:09:06.809 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4327, 4333) --> . Daniel journeyed to the
2025-01-22 05:09:06.809 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel took the football.
2025-01-22 05:09:06.810 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (200, 204) -->  Daniel took the football
2025-01-22 05:09:06.810 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra picked up the apple.
2025-01-22 05:09:06.820 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1580, 1585) --> . Sandra picked up the
2025-01-22 05:09:06.820 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra moved to the hallway.
2025-01-22 05:09:06.853 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (6436, 6441) --> . Sandra moved to the
2025-01-22 05:09:06.853 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Sandra left the apple.
2025-01-22 05:09:06.873 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (4163, 4167) -->  Sandra left the apple
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:09:07.676 | INFO     | test_jbb_embedding:begin_test:693 - The hallway.<|eot_id|>
2025-01-22 05:09:07.676 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8206])
2025-01-22 05:09:09.922 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [93.88046875, 12.766627139420148, 74.05533854166667, 12.297024484852201, 13.892615209651899], 'topk_indices': array([8195,    4, 8094, 8197,    9, 8192,   24, 8188, 8189,  787, 8190,
       8196, 8191, 8193,   14, 8204, 8194,    0, 8202, 8201]), 'topk_tokens': [' the', '\n\n', '.\n\n', '?', ':', ' the', '\n\n', 'Question', ':', ' hallway', ' Where', ' kitchen', ' was', ' apple', '\n', '<|end_header_id|>', ' before', '<|begin_of_text|>', '<|start_header_id|>', '<|eot_id|>'], 'evidence_proportions': [155.1375, 96.1, 99.1, 25.184375]}, 'weight': {'score': [20.39921875, 23.289468875624316, 23.291666666666668, 23.2965491996811, 29.19284018987342], 'topk_indices': array([3342, 3369, 3214, 3262, 7485, 7447, 1498, 1436, 4339, 4355, 5211,
       5150, 7121, 7177, 3551, 3525, 4952, 5004, 4975, 4927]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.75625, 19.403125, 21.771875, 19.665625]}, 'saliency': {'score': [0.48802337646484373, 0.07056865582934889, 0.4615669250488281, 0.06781813061107203, 0.10285500635074664], 'topk_indices': array([8175,   24,  784, 8094,    8, 8197, 8199, 7393, 8060, 1585, 8104,
       6441, 1581, 8191, 8190, 8188, 8196, 8193,  787, 8194]), 'topk_tokens': [' return', '\n\n', ' travelled', '.\n\n', ' Date', '?', 'Answer', 'nes', ' context', ' apple', ' location', ' hallway', ' Sandra', ' was', ' Where', 'Question', ' kitchen', ' apple', ' hallway', ' before'], 'evidence_proportions': [0.83759765625, 0.451123046875, 0.526611328125, 0.136761474609375]}}, 'pred_res': 'The hallway.<|eot_id|>', 'score': 100}
2025-01-22 05:09:09.926 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:09:09.926 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-50_pid-2_1-3-4-8.pkl | len: 3 |  size: 2.01 KB
Processing depth (1, 3, 4, 8):   3%|▎         | 3/100 [01:00<32:27, 20.08s/it]is_0k: False
your chose emoji: ['🙆🏻\u200d♀', '\U0001faf7🏼', '👩🏻\u200d❤\u200d👨🏼', '🪤', '\U0001faf1🏻', '👨🏽\u200d🏭', '👨\u200d🎓', '👨🏿\u200d🦲', '🧘\u200d♀', '🚶🏼\u200d♀️']
emoji:
O: 🙆🏻‍♀ [9468, 247, 228, 9468, 237, 119, 102470, 32990]
N: 🙆🏻‍♀ [9468, 247, 228, 9468, 237, 119, 102470, 32990]

O: 🫷🏼 [9468, 104, 115, 9468, 237, 120]
N: 🧘‍♀ [9468, 100, 246, 102470, 32990]

O: 👩🏻‍❤‍👨🏼 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 120]
N: 👨‍🎓 [9468, 239, 101, 102470, 9468, 236, 241]

O: 🪤 [9468, 103, 97]
N: 🫷🏼 [9468, 104, 115, 9468, 237, 120]

O: 🫱🏻 [9468, 104, 109, 9468, 237, 119]
N: 🫱🏻 [9468, 104, 109, 9468, 237, 119]

O: 👨🏽‍🏭 [9468, 239, 101, 9468, 237, 121, 102470, 9468, 237, 255]
N: 👩🏻‍❤‍👨🏼 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 120]

O: 👨‍🎓 [9468, 239, 101, 102470, 9468, 236, 241]
N: 🪤 [9468, 103, 97]

O: 👨🏿‍🦲 [9468, 239, 101, 9468, 237, 123, 102470, 9468, 99, 110]
N: 👨🏽‍🏭 [9468, 239, 101, 9468, 237, 121, 102470, 9468, 237, 255]

O: 🧘‍♀ [9468, 100, 246, 102470, 32990]
N: 👨🏿‍🦲 [9468, 239, 101, 9468, 237, 123, 102470, 9468, 99, 110]

O: 🚶🏼‍♀️ [9468, 248, 114, 9468, 237, 120, 102470, 32990, 31643]
N: 🚶🏼‍♀️ [9468, 248, 114, 9468, 237, 120, 102470, 32990, 31643]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.31s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.71s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.27s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.87s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.44s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (1, 3, 4, 7):   3%|▎         | 3/100 [01:16<32:27, 20.08s/it]2025-01-22 05:09:25.491 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the hallway.
2025-01-22 05:09:25.497 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (900, 905) --> . Mary travelled to the
2025-01-22 05:09:25.497 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went to the kitchen.
2025-01-22 05:09:25.512 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2942, 2947) --> . Mary went to the
2025-01-22 05:09:25.512 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary put down the apple.
2025-01-22 05:09:25.530 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3631, 3636) -->  Hon. Mary put down
2025-01-22 05:09:25.530 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went to the garden.
2025-01-22 05:09:25.560 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5746, 5751) --> . Daniel went to the
2025-01-22 05:09:25.560 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went back to the garden.
2025-01-22 05:09:25.598 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (7010, 7016) --> . Sandra went back to the
2025-01-22 05:09:25.598 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel put down the football there.
2025-01-22 05:09:25.639 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (7409, 7415) --> . Daniel put down the football
2025-01-22 05:09:25.639 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel journeyed to the kitchen.
2025-01-22 05:09:25.662 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4432, 4438) -->  execution. Daniel journeyed to
2025-01-22 05:09:25.662 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel took the football.
2025-01-22 05:09:25.663 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (232, 236) -->  Daniel took the football
2025-01-22 05:09:25.663 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra picked up the apple.
2025-01-22 05:09:25.672 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1729, 1734) -->  Sandra picked up the apple
2025-01-22 05:09:25.672 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra moved to the hallway.
2025-01-22 05:09:25.706 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (6508, 6513) --> . Sandra moved to the
2025-01-22 05:09:25.706 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Sandra left the apple.
2025-01-22 05:09:25.729 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (4234, 4238) -->  left the apple.
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:09:29.373 | INFO     | test_jbb_embedding:begin_test:693 - The hallway.<|eot_id|>
2025-01-22 05:09:29.373 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8200])
2025-01-22 05:09:32.416 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [158.83125, 19.466791874923807, 125.4375, 18.65640343071069, 14.080861944901315], 'topk_indices': array([2177, 2061, 8185, 2182,   24, 8187,   14, 8190, 2178, 2062,  905,
       2109, 8198, 8188, 2142, 2179, 2143, 8196,    0, 8195]), 'topk_tokens': ['\n', ' Ch', ' was', ' each', '\n\n', ' apple', '\n', ' kitchen', 'ab', 'ien', ' hallway', ' Ch', '<|end_header_id|>', ' before', 're', 're', 'ast', '<|start_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [266.725, 135.3375, 137.5625, 95.7]}, 'weight': {'score': [21.601171875, 23.298320736315983, 23.71462673611111, 23.300647477599117, 29.90357730263158], 'topk_indices': array([3321, 3294, 3166, 3214, 7471, 7433, 1472, 1410, 4284, 4300, 5169,
       5108, 7203, 7147, 3503, 3477, 4933, 4885, 4910, 4962]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.75625, 19.403125, 26.5796875, 19.665625]}, 'saliency': {'score': [0.8592529296875, 0.10885850403434719, 0.7732255723741319, 0.10408065906401513, 0.10607458415784334], 'topk_indices': array([2947, 8098, 8193, 8184, 2060,  902, 2061, 6513, 2182, 8182, 2178,
       8187, 2142, 2062, 8188, 2179, 8190, 2109, 2143,  905]), 'topk_tokens': [' kitchen', ' location', 'Answer', ' Where', ' du', ' travelled', ' Ch', ' hallway', ' each', 'Question', 'ab', ' apple', 're', 'ien', ' before', 're', ' kitchen', ' Ch', 'ast', ' hallway'], 'evidence_proportions': [1.4314453125, 0.66435546875, 0.814306640625, 0.526904296875]}}, 'pred_res': 'The hallway.<|eot_id|>', 'score': 100}
2025-01-22 05:09:32.423 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:09:32.423 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-50_pid-3_1-3-4-7.pkl | len: 3 |  size: 2.0 KB
Processing depth (1, 3, 4, 7):   4%|▍         | 4/100 [01:23<33:39, 21.03s/it]is_0k: False
your chose emoji: ['👨🏾\u200d❤️\u200d👨🏾', '🚶🏽\u200d♀️\u200d➡️', '🤵🏽\u200d♀', '👨🏿\u200d🍼', '⛰', '📆', '🍇', '🚶\u200d♀️', '🤏', '👨🏼\u200d🦼\u200d➡']
emoji:
O: 👨🏾‍❤️‍👨🏾 [9468, 239, 101, 9468, 237, 122, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 122]
N: 🤵🏽‍♀ [9468, 97, 113, 9468, 237, 121, 102470, 32990]

O: 🚶🏽‍♀️‍➡️ [9468, 248, 114, 9468, 237, 121, 102470, 32990, 31643, 102470, 98115, 94, 31643]
N: 👨🏿‍🍼 [9468, 239, 101, 9468, 237, 123, 102470, 9468, 104247]

O: 🤵🏽‍♀ [9468, 97, 113, 9468, 237, 121, 102470, 32990]
N: 🚶‍♀️ [9468, 248, 114, 102470, 32990, 31643]

O: 👨🏿‍🍼 [9468, 239, 101, 9468, 237, 123, 102470, 9468, 104247]
N: 🤏 [9468, 97, 237]

O: ⛰ [158, 120388]
N: 👨🏾‍❤️‍👨🏾 [9468, 239, 101, 9468, 237, 122, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 122]

O: 📆 [9468, 241, 228]
N: 🍇 [9468, 235, 229]

O: 🍇 [9468, 235, 229]
N: 📆 [9468, 241, 228]

O: 🚶‍♀️ [9468, 248, 114, 102470, 32990, 31643]
N: 🚶🏽‍♀️‍➡️ [9468, 248, 114, 9468, 237, 121, 102470, 32990, 31643, 102470, 98115, 94, 31643]

O: 🤏 [9468, 97, 237]
N: ⛰ [158, 120388]

O: 👨🏼‍🦼‍➡ [9468, 239, 101, 9468, 237, 120, 102470, 9468, 99, 120, 102470, 98115, 94]
N: 👨🏼‍🦼‍➡ [9468, 239, 101, 9468, 237, 120, 102470, 9468, 99, 120, 102470, 98115, 94]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.93s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:10<00:10,  5.34s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:15<00:05,  5.12s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:16<00:00,  3.56s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:16<00:00,  4.15s/it]
Processing depth (0, 3, 6, 8):   4%|▍         | 4/100 [01:42<33:39, 21.03s/it]2025-01-22 05:09:51.513 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the hallway.
2025-01-22 05:09:51.514 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  travelled to the hallway.
2025-01-22 05:09:51.514 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went to the kitchen.
2025-01-22 05:09:51.542 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2971, 2976) -->  tragedy. Mary went to
2025-01-22 05:09:51.542 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary put down the apple.
2025-01-22 05:09:51.570 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4759, 4764) -->  senate. Mary put down
2025-01-22 05:09:51.571 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went to the garden.
2025-01-22 05:09:51.603 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6598, 6603) --> . Daniel went to the
2025-01-22 05:09:51.603 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went back to the garden.
2025-01-22 05:09:51.640 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6976, 6982) --> . Sandra went back to the
2025-01-22 05:09:51.640 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel put down the football there.
2025-01-22 05:09:51.679 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (7386, 7392) -->  Daniel put down the football there
2025-01-22 05:09:51.679 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel journeyed to the kitchen.
2025-01-22 05:09:51.703 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4351, 4357) --> . Daniel journeyed to the
2025-01-22 05:09:51.703 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel took the football.
2025-01-22 05:09:51.704 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (238, 242) -->  Daniel took the football
2025-01-22 05:09:51.705 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra picked up the apple.
2025-01-22 05:09:51.714 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1718, 1723) --> . Sandra picked up the
2025-01-22 05:09:51.714 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra moved to the hallway.
2025-01-22 05:09:51.751 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (6432, 6437) --> . Sandra moved to the
2025-01-22 05:09:51.751 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Sandra left the apple.
2025-01-22 05:09:51.772 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (4212, 4216) -->  left the apple.
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:09:52.556 | INFO     | test_jbb_embedding:begin_test:693 - The hallway.<|eot_id|>
2025-01-22 05:09:52.556 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8162])
2025-01-22 05:09:54.773 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [230.8015625, 24.80168018983466, 219.76302083333334, 23.428069891478604, 22.57120339912281], 'topk_indices': array([7554,   24, 7555, 8143, 7510, 8151, 6437, 8148,   14, 8146, 8153,
       8145, 8144, 8147, 8152, 8149, 8150,    0, 8158, 8157]), 'topk_tokens': [' Min', '\n\n', 'nes', '.\n\n', 'nes', ' the', ' hallway', ' the', '\n', ' Where', '?', ':', 'Question', ' was', ' kitchen', ' apple', ' before', '<|begin_of_text|>', '<|start_header_id|>', '<|eot_id|>'], 'evidence_proportions': [431.7, 227.33125, 93.2375, 170.9375]}, 'weight': {'score': [23.5265625, 23.25767375995101, 22.87847222222222, 23.258694043655197, 29.18612938596491], 'topk_indices': array([3254, 3281, 3174, 3126, 7447, 7409, 1478, 1416, 4290, 4274, 5108,
       5169, 7109, 7165, 3463, 3437, 4910, 4933, 4962, 4885]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.225, 25.2109375, 27.0046875, 19.665625]}, 'saliency': {'score': [1.356268310546875, 0.13732543870560318, 1.2817043728298612, 0.12923856004420242, 0.1666337398060581], 'topk_indices': array([8145, 8155, 4357, 8016, 1719, 6433,   31, 2977, 8153, 7555, 7554,
       7510, 8147,   34, 8146, 6437, 8144, 8149, 8152, 8150]), 'topk_tokens': [':', 'Answer', ' kitchen', ' context', ' Sandra', ' Sandra', ' travelled', ' kitchen', '?', 'nes', ' Min', 'nes', ' was', ' hallway', ' Where', ' hallway', 'Question', ' apple', ' kitchen', ' before'], 'evidence_proportions': [2.5984375, 1.2505859375, 0.5929443359375, 0.98310546875]}}, 'pred_res': 'The hallway.<|eot_id|>', 'score': 100}
2025-01-22 05:09:54.780 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:09:54.780 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-50_pid-4_0-3-6-8.pkl | len: 3 |  size: 2.0 KB
Processing depth (0, 3, 6, 8):   5%|▌         | 5/100 [01:45<34:03, 21.51s/it]Processing depth (0, 3, 6, 8):   5%|▌         | 5/100 [01:45<33:23, 21.09s/it]
2025-01-22 05:09:54.832 | INFO     | __main__:<module>:82 - Selected idx: 51
2025-01-22 05:09:54.832 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the location prior to the place where the milk was discarded, left or dropped?
2025-01-22 05:09:54.832 | INFO     | __main__:<module>:84 - Answer: hallway
2025-01-22 05:09:54.832 | INFO     | __main__:<module>:85 - Tag: 4-hop
2025-01-22 05:09:54.832 | INFO     | __main__:<module>:86 - Needle: [' Daniel put down the football there.', ' Sandra picked up the apple.', ' Mary travelled to the hallway.', ' Sandra left the apple.', ' Mary got the milk.', ' Mary went to the kitchen.', ' Sandra moved to the hallway.', ' Sandra went back to the garden.', ' Daniel journeyed to the kitchen.', ' Daniel took the football.', ' Mary put down the milk.', ' Daniel went to the garden.']
2025-01-22 05:09:54.832 | INFO     | __main__:<module>:87 - Real Needle: [' Mary travelled to the hallway.', ' Mary got the milk.', ' Mary went to the kitchen.', ' Mary put down the milk.', ' Daniel went to the garden.']
2025-01-22 05:09:54.832 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['⛹🏼', '🧛🏻', '🤹🏾', '🌕', '⛅', '👮\u200d♀', '🤽\u200d♂️', '🤾🏽\u200d♀️', '🏋🏿', '👴🏼']
emoji:
O: ⛹🏼 [158, 249, 117, 9468, 237, 120]
N: ⛅ [158, 249, 227]

O: 🧛🏻 [9468, 100, 249, 9468, 237, 119]
N: ⛹🏼 [158, 249, 117, 9468, 237, 120]

O: 🤹🏾 [9468, 97, 117, 9468, 237, 122]
N: 🤹🏾 [9468, 97, 117, 9468, 237, 122]

O: 🌕 [9468, 234, 243]
N: 🏋🏿 [9468, 237, 233, 9468, 237, 123]

O: ⛅ [158, 249, 227]
N: 👮‍♀ [9468, 239, 106, 102470, 32990]

O: 👮‍♀ [9468, 239, 106, 102470, 32990]
N: 🌕 [9468, 234, 243]

O: 🤽‍♂️ [9468, 97, 121, 102470, 17245, 224, 31643]
N: 🤾🏽‍♀️ [9468, 97, 122, 9468, 237, 121, 102470, 32990, 31643]

O: 🤾🏽‍♀️ [9468, 97, 122, 9468, 237, 121, 102470, 32990, 31643]
N: 🧛🏻 [9468, 100, 249, 9468, 237, 119]

O: 🏋🏿 [9468, 237, 233, 9468, 237, 123]
N: 🤽‍♂️ [9468, 97, 121, 102470, 17245, 224, 31643]

O: 👴🏼 [9468, 239, 112, 9468, 237, 120]
N: 👴🏼 [9468, 239, 112, 9468, 237, 120]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:10,  3.63s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:07<00:07,  3.96s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.14s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.01s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.36s/it]
Processing depth (0, 3, 5, 6, 7):   0%|          | 0/100 [00:14<?, ?it/s]2025-01-22 05:10:09.979 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the hallway.
2025-01-22 05:10:09.979 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  travelled to the hallway.
2025-01-22 05:10:09.979 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary got the milk.
2025-01-22 05:10:09.996 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2841, 2845) -->  Mary got the milk
2025-01-22 05:10:09.996 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the kitchen.
2025-01-22 05:10:10.019 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4152, 4157) --> . Mary went to the
2025-01-22 05:10:10.020 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary put down the milk.
2025-01-22 05:10:10.045 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4739, 4744) --> . Mary put down the
2025-01-22 05:10:10.045 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel went to the garden.
2025-01-22 05:10:10.074 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3638, 3643) -->  back to the garden.
2025-01-22 05:10:10.074 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel put down the football there.
2025-01-22 05:10:10.095 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4158, 4164) --> . Daniel put down the football
2025-01-22 05:10:10.095 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra picked up the apple.
2025-01-22 05:10:10.126 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6509, 6514) --> . Sandra picked up the
2025-01-22 05:10:10.126 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra left the apple.
2025-01-22 05:10:10.140 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2516, 2520) -->  Sandra left the apple
2025-01-22 05:10:10.140 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra moved to the hallway.
2025-01-22 05:10:10.163 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4232, 4237) -->  Sandra moved to the hallway
2025-01-22 05:10:10.164 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra went back to the garden.
2025-01-22 05:10:10.182 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3634, 3640) -->  Hon. Sandra went back to
2025-01-22 05:10:10.182 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel journeyed to the kitchen.
2025-01-22 05:10:10.206 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (4744, 4750) -->  milk. Daniel journeyed to
2025-01-22 05:10:10.206 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Daniel took the football.
2025-01-22 05:10:10.234 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (5269, 5273) -->  Daniel took the football
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:10:11.044 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 05:10:11.044 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8204])
2025-01-22 05:10:13.319 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [233.88541666666666, 20.328309674667967, 172.47265625, 19.026902157235792, 14.43518926056338], 'topk_indices': array([8197, 4745, 8191, 8177,    9,   25, 8093, 8184, 8189, 8178,   34,
       4157, 8083,   24, 4236, 8199, 8049, 8200,   14,    0]), 'topk_tokens': ['Answer', '.', ' discarded', 'Question', ':', '<|eot_id|>', ' location', ' to', ' milk', ':', ' hallway', ' kitchen', '.\n\n', '\n\n', ' hallway', '<|eot_id|>', ' context', '<|start_header_id|>', '\n', '<|begin_of_text|>'], 'evidence_proportions': [392.8, 257.46875, 202.025, 181.225, 140.625]}, 'weight': {'score': [21.515299479166668, 23.291049180577556, 25.39214409722222, 23.28699598011538, 30.03125], 'topk_indices': array([3324, 3297, 3217, 3169, 7460, 7422, 1523, 1461, 4324, 4308, 5235,
       5174, 7199, 7143, 3480, 3506, 5004, 4975, 4927, 4952]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.225, 26.283203125, 19.403125, 21.771875, 18.846875]}, 'saliency': {'score': [1.3552449544270833, 0.11427130315108291, 1.1428070068359375, 0.10607065837837164, 0.11091205435739436], 'topk_indices': array([8186,   38, 3636, 8047, 4744,   24, 2844, 8083,   31, 8183, 8093,
       8197, 2516, 8189, 8177, 8191, 4157, 8049,   34, 4236]), 'topk_tokens': [' place', '***', ' Sandra', ' provided', ' milk', '\n\n', ' milk', '.\n\n', ' travelled', ' prior', ' location', 'Answer', ' Sandra', ' milk', 'Question', ' discarded', ' kitchen', ' context', ' hallway', ' hallway'], 'evidence_proportions': [2.42939453125, 1.7646484375, 0.9708984375, 0.9482421875, 0.744921875]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 0}
2025-01-22 05:10:13.325 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:10:13.325 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-51_pid-0_0-3-5-6-7.pkl | len: 3 |  size: 2.09 KB
Processing depth (0, 3, 5, 6, 7):   1%|          | 1/100 [00:18<30:22, 18.41s/it]is_0k: False
your chose emoji: ['🏂🏼', '👩🏽\u200d❤️\u200d👨🏼', '🧎🏻\u200d♀️\u200d➡', '🎙️', '💇', '🌃', '🙎🏼\u200d♂', '🛵', '👎🏼', '🧎🏻\u200d♂️']
emoji:
O: 🏂🏼 [9468, 237, 224, 9468, 237, 120]
N: 👩🏽‍❤️‍👨🏼 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 120]

O: 👩🏽‍❤️‍👨🏼 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 120]
N: 🎙️ [9468, 236, 247, 31643]

O: 🧎🏻‍♀️‍➡ [9468, 100, 236, 9468, 237, 119, 102470, 32990, 31643, 102470, 98115, 94]
N: 💇 [93273, 229]

O: 🎙️ [9468, 236, 247, 31643]
N: 👎🏼 [9468, 239, 236, 9468, 237, 120]

O: 💇 [93273, 229]
N: 🌃 [9468, 234, 225]

O: 🌃 [9468, 234, 225]
N: 🙎🏼‍♂ [9468, 247, 236, 9468, 237, 120, 102470, 17245, 224]

O: 🙎🏼‍♂ [9468, 247, 236, 9468, 237, 120, 102470, 17245, 224]
N: 🧎🏻‍♀️‍➡ [9468, 100, 236, 9468, 237, 119, 102470, 32990, 31643, 102470, 98115, 94]

O: 🛵 [9468, 249, 113]
N: 🛵 [9468, 249, 113]

O: 👎🏼 [9468, 239, 236, 9468, 237, 120]
N: 🏂🏼 [9468, 237, 224, 9468, 237, 120]

O: 🧎🏻‍♂️ [9468, 100, 236, 9468, 237, 119, 102470, 17245, 224, 31643]
N: 🧎🏻‍♂️ [9468, 100, 236, 9468, 237, 119, 102470, 17245, 224, 31643]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.64s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.41s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:11<00:03,  3.81s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  2.48s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  3.10s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 1, 4, 6, 8):   1%|          | 1/100 [00:32<30:22, 18.41s/it]2025-01-22 05:10:27.604 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the hallway.
2025-01-22 05:10:27.605 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  travelled to the hallway.
2025-01-22 05:10:27.605 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary got the milk.
2025-01-22 05:10:27.609 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (834, 838) -->  Mary got the milk
2025-01-22 05:10:27.610 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the kitchen.
2025-01-22 05:10:27.631 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3593, 3598) --> . Mary went to the
2025-01-22 05:10:27.632 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary put down the milk.
2025-01-22 05:10:27.657 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4768, 4773) -->  senate. Mary put down
2025-01-22 05:10:27.657 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel went to the garden.
2025-01-22 05:10:27.676 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3624, 3629) -->  back to the garden.
2025-01-22 05:10:27.677 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel put down the football there.
2025-01-22 05:10:27.700 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4151, 4157) -->  Daniel put down the football there
2025-01-22 05:10:27.700 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra picked up the apple.
2025-01-22 05:10:27.736 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6501, 6506) --> . Sandra picked up the
2025-01-22 05:10:27.736 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra left the apple.
2025-01-22 05:10:27.752 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2689, 2693) -->  Sandra left the apple
2025-01-22 05:10:27.752 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra moved to the hallway.
2025-01-22 05:10:27.778 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4224, 4229) -->  Sandra moved to the hallway
2025-01-22 05:10:27.779 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra went back to the garden.
2025-01-22 05:10:27.798 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3620, 3626) -->  Hon. Sandra went back to
2025-01-22 05:10:27.798 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel journeyed to the kitchen.
2025-01-22 05:10:27.824 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (4774, 4780) -->  milk. Daniel journeyed to
2025-01-22 05:10:27.824 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Daniel took the football.
2025-01-22 05:10:27.853 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (5337, 5341) -->  Daniel took the football
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:10:31.400 | INFO     | test_jbb_embedding:begin_test:693 - kitchen<|eot_id|>
2025-01-22 05:10:31.401 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8198])
2025-01-22 05:10:34.595 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [357.5390625, 30.569768549567126, 197.921875, 28.865808484829873, 22.732192095588236], 'topk_indices': array([8171, 4772, 8043, 8177, 8077, 8172, 8178,   24, 4775, 3598, 8185,
       4774,   34,   14, 8183,  837,  838, 8193,    0, 8194]), 'topk_tokens': ['Question', ' down', ' context', ' prior', '.\n\n', ':', ' to', '\n\n', '.', ' kitchen', ' discarded', ' milk', ' hallway', '\n', ' milk', ' milk', '.', '<|eot_id|>', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [505.2, 606.75, 276.15, 354.4375, 95.0]}, 'weight': {'score': [22.60546875, 23.279590522497255, 25.815104166666668, 23.270365664537525, 29.637637867647058], 'topk_indices': array([3277, 3304, 3149, 3197, 7394, 7432, 1490, 1428, 4300, 4316, 5191,
       5130, 7171, 7115, 3460, 3486, 4949, 4926, 4978, 4901]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.225, 26.283203125, 19.403125, 27.0046875, 18.846875]}, 'saliency': {'score': [2.2239990234375, 0.1717347999910453, 1.30511474609375, 0.16067276591385427, 0.1764068603515625], 'topk_indices': array([ 835, 8087, 4228, 2692, 7540,  834, 4772,    0,  839, 2689, 8043,
         31, 8171, 8177, 3598, 4774, 8185, 8183,  837,   34]), 'topk_tokens': [' got', ' location', ' hallway', ' apple', 'nes', ' Mary', ' down', '<|begin_of_text|>', ' Paul', ' Sandra', ' context', ' travelled', 'Question', ' prior', ' kitchen', ' milk', ' discarded', ' milk', ' milk', ' hallway'], 'evidence_proportions': [3.25380859375, 4.170166015625, 1.353515625, 2.25927734375, 0.4724609375]}}, 'pred_res': 'kitchen<|eot_id|>', 'score': 0}
2025-01-22 05:10:34.600 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:10:34.600 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-51_pid-1_0-1-4-6-8.pkl | len: 3 |  size: 2.08 KB
Processing depth (0, 1, 4, 6, 8):   2%|▏         | 2/100 [00:39<32:49, 20.09s/it]is_0k: False
your chose emoji: ['🦆', '👨🏽\u200d❤️\u200d💋\u200d👨🏽', '👨🏻\u200d✈', '💒', '🤹🏾\u200d♂', '🎨', '\U0001fa89', '🚡', '🤸🏻\u200d♂', '💂🏽\u200d♀️']
emoji:
O: 🦆 [9468, 99, 228]
N: 🤸🏻‍♂ [9468, 97, 116, 9468, 237, 119, 102470, 17245, 224]

O: 👨🏽‍❤️‍💋‍👨🏽 [9468, 239, 101, 9468, 237, 121, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 121]
N: 🚡 [9468, 248, 94]

O: 👨🏻‍✈ [9468, 239, 101, 9468, 237, 119, 102470, 38798, 230]
N: 🎨 [9468, 236, 101]

O: 💒 [93273, 240]
N: 🦆 [9468, 99, 228]

O: 🤹🏾‍♂ [9468, 97, 117, 9468, 237, 122, 102470, 17245, 224]
N: 👨🏻‍✈ [9468, 239, 101, 9468, 237, 119, 102470, 38798, 230]

O: 🎨 [9468, 236, 101]
N: 🪉 [9468, 103, 231]

O: 🪉 [9468, 103, 231]
N: 💒 [93273, 240]

O: 🚡 [9468, 248, 94]
N: 🤹🏾‍♂ [9468, 97, 117, 9468, 237, 122, 102470, 17245, 224]

O: 🤸🏻‍♂ [9468, 97, 116, 9468, 237, 119, 102470, 17245, 224]
N: 👨🏽‍❤️‍💋‍👨🏽 [9468, 239, 101, 9468, 237, 121, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 121]

O: 💂🏽‍♀️ [93273, 224, 9468, 237, 121, 102470, 32990, 31643]
N: 💂🏽‍♀️ [93273, 224, 9468, 237, 121, 102470, 32990, 31643]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.79s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.68s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.37s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.03s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.59s/it]
Processing depth (0, 1, 3, 4, 6):   2%|▏         | 2/100 [00:55<32:49, 20.09s/it]2025-01-22 05:10:50.742 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the hallway.
2025-01-22 05:10:50.743 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  travelled to the hallway.
2025-01-22 05:10:50.743 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary got the milk.
2025-01-22 05:10:50.747 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (902, 906) -->  Mary got the milk
2025-01-22 05:10:50.747 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the kitchen.
2025-01-22 05:10:50.762 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2895, 2900) --> . Mary went to the
2025-01-22 05:10:50.762 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary put down the milk.
2025-01-22 05:10:50.779 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3627, 3632) --> . Mary put down the
2025-01-22 05:10:50.779 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel went to the garden.
2025-01-22 05:10:50.797 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3658, 3663) -->  back to the garden.
2025-01-22 05:10:50.797 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel put down the football there.
2025-01-22 05:10:50.819 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4162, 4168) --> . Daniel put down the football
2025-01-22 05:10:50.819 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra picked up the apple.
2025-01-22 05:10:50.855 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6555, 6560) --> . Sandra picked up the
2025-01-22 05:10:50.855 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra left the apple.
2025-01-22 05:10:50.867 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2537, 2541) -->  Sandra left the apple
2025-01-22 05:10:50.867 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra moved to the hallway.
2025-01-22 05:10:50.887 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4197, 4202) --> . Sandra moved to the
2025-01-22 05:10:50.887 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra went back to the garden.
2025-01-22 05:10:50.906 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3654, 3660) -->  Hon. Sandra went back to
2025-01-22 05:10:50.906 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel journeyed to the kitchen.
2025-01-22 05:10:50.932 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (4681, 4687) -->  the garden. Daniel journeyed
2025-01-22 05:10:50.932 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Daniel took the football.
2025-01-22 05:10:50.957 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (5283, 5287) -->  Daniel took the football
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:10:51.788 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 05:10:51.788 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8216])
2025-01-22 05:10:54.027 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [313.3515625, 26.27239855821876, 100.78038194444444, 25.099192609388407, 10.770013189935066], 'topk_indices': array([8208, 8095,   63, 8196, 8190,   31,   24, 8201,   35,  905,   14,
       2537, 8061, 8211,   75, 8203,  906,   34, 8212,    0]), 'topk_tokens': ['?\n', '.\n\n', 'ISC', ' to', ':', ' travelled', '\n\n', ' milk', '.', ' milk', '\n', ' Sandra', ' context', '<|eot_id|>', 'UL', ' discarded', '.', ' hallway', '<|start_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [612.5, 496.3125, 195.15, 234.325, 65.0625]}, 'weight': {'score': [21.515299479166668, 23.30095092164497, 24.47026909722222, 23.301044092413285, 30.034496753246753], 'topk_indices': array([3338, 3311, 3183, 3231, 7460, 7498, 1410, 1472, 4340, 4356, 5249,
       5188, 7181, 7237, 3520, 3494, 4990, 4965, 5013, 5042]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.225, 26.283203125, 19.403125, 21.771875, 18.846875]}, 'saliency': {'score': [1.8983815511067708, 0.148768318121502, 0.6957312689887153, 0.1412083985452223, 0.0816350168996043], 'topk_indices': array([  38, 3632, 8105,   74,   62,    0,   30,   64, 8195, 2900, 8189,
         63, 8201,   75,   31,  905, 8061, 2537, 8203,   34]), 'topk_tokens': ['***', ' milk', ' location', ' PA', 'MIN', '<|begin_of_text|>', 'Mary', 'ENCES', ' prior', ' kitchen', 'Question', 'ISC', ' milk', 'UL', ' travelled', ' milk', ' context', ' Sandra', ' discarded', ' hallway'], 'evidence_proportions': [3.9130859375, 3.2275390625, 0.949951171875, 1.329443359375, 0.3377197265625]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 0}
2025-01-22 05:10:54.043 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:10:54.043 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-51_pid-2_0-1-3-4-6.pkl | len: 3 |  size: 2.06 KB
Processing depth (0, 1, 3, 4, 6):   3%|▎         | 3/100 [00:59<32:00, 19.80s/it]is_0k: False
your chose emoji: ['🧛🏻\u200d♂️', '🚶🏻\u200d♀️\u200d➡', '🙅🏽\u200d♀', '👩🏿\u200d🦰', '🙍🏽\u200d♂️', '💆🏼\u200d♂️', '🙆🏻\u200d♂️', '💹', '🪚', '🗃']
emoji:
O: 🧛🏻‍♂️ [9468, 100, 249, 9468, 237, 119, 102470, 17245, 224, 31643]
N: 💆🏼‍♂️ [93273, 228, 9468, 237, 120, 102470, 17245, 224, 31643]

O: 🚶🏻‍♀️‍➡ [9468, 248, 114, 9468, 237, 119, 102470, 32990, 31643, 102470, 98115, 94]
N: 👩🏿‍🦰 [9468, 239, 102, 9468, 237, 123, 102470, 9468, 99, 108]

O: 🙅🏽‍♀ [9468, 247, 227, 9468, 237, 121, 102470, 32990]
N: 🪚 [9468, 103, 248]

O: 👩🏿‍🦰 [9468, 239, 102, 9468, 237, 123, 102470, 9468, 99, 108]
N: 🙆🏻‍♂️ [9468, 247, 228, 9468, 237, 119, 102470, 17245, 224, 31643]

O: 🙍🏽‍♂️ [9468, 247, 235, 9468, 237, 121, 102470, 17245, 224, 31643]
N: 🧛🏻‍♂️ [9468, 100, 249, 9468, 237, 119, 102470, 17245, 224, 31643]

O: 💆🏼‍♂️ [93273, 228, 9468, 237, 120, 102470, 17245, 224, 31643]
N: 💹 [93273, 117]

O: 🙆🏻‍♂️ [9468, 247, 228, 9468, 237, 119, 102470, 17245, 224, 31643]
N: 🚶🏻‍♀️‍➡ [9468, 248, 114, 9468, 237, 119, 102470, 32990, 31643, 102470, 98115, 94]

O: 💹 [93273, 117]
N: 🙍🏽‍♂️ [9468, 247, 235, 9468, 237, 121, 102470, 17245, 224, 31643]

O: 🪚 [9468, 103, 248]
N: 🙅🏽‍♀ [9468, 247, 227, 9468, 237, 121, 102470, 32990]

O: 🗃 [9468, 245, 225]
N: 🗃 [9468, 245, 225]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.14s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.30s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.18s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.74s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.28s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (1, 5, 6, 7, 8):   3%|▎         | 3/100 [01:13<32:00, 19.80s/it]2025-01-22 05:11:08.904 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the hallway.
2025-01-22 05:11:08.909 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (815, 820) --> . Mary travelled to the
2025-01-22 05:11:08.909 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary got the milk.
2025-01-22 05:11:08.932 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4154, 4158) -->  Mary got the milk
2025-01-22 05:11:08.932 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the kitchen.
2025-01-22 05:11:08.957 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4731, 4736) --> . Mary went to the
2025-01-22 05:11:08.958 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary put down the milk.
2025-01-22 05:11:08.980 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4157, 4162) -->  milk. Daniel put down
2025-01-22 05:11:08.980 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel went to the garden.
2025-01-22 05:11:08.998 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3607, 3612) -->  back to the garden.
2025-01-22 05:11:08.999 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel put down the football there.
2025-01-22 05:11:09.020 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4158, 4164) --> . Daniel put down the football
2025-01-22 05:11:09.020 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra picked up the apple.
2025-01-22 05:11:09.052 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6613, 6618) --> . Sandra picked up the
2025-01-22 05:11:09.052 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra left the apple.
2025-01-22 05:11:09.069 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2528, 2532) -->  Sandra left the apple
2025-01-22 05:11:09.069 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra moved to the hallway.
2025-01-22 05:11:09.092 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4232, 4237) -->  Sandra moved to the hallway
2025-01-22 05:11:09.092 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra went back to the garden.
2025-01-22 05:11:09.110 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3603, 3609) -->  Hon. Sandra went back to
2025-01-22 05:11:09.110 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel journeyed to the kitchen.
2025-01-22 05:11:09.136 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (4734, 4740) -->  to the kitchen. Daniel journey
2025-01-22 05:11:09.136 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Daniel took the football.
2025-01-22 05:11:09.164 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (5349, 5353) -->  Daniel took the football
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:11:11.419 | INFO     | test_jbb_embedding:begin_test:693 - the kitchen<|eot_id|>
2025-01-22 05:11:11.419 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8190])
2025-01-22 05:11:14.158 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [278.8802083333333, 30.068299539240815, 217.59809027777777, 28.503986459486043, 34.109771728515625], 'topk_indices': array([  24, 7320, 8170, 8175, 8163, 7368, 4236, 8164, 4158, 4736, 7291,
       8079, 8186, 7573, 8035, 8185, 7529, 7574, 7369,    0]), 'topk_tokens': ['\n\n', 'nes', ' to', ' milk', 'Question', ' Min', ' hallway', ':', '.', ' kitchen', 'nes', ' location', '<|start_header_id|>', ' Min', ' context', '<|eot_id|>', 'nes', 'nes', 'nes', '<|begin_of_text|>'], 'evidence_proportions': [310.4, 358.125, 225.975, 344.95, 170.8]}, 'weight': {'score': [22.143229166666668, 23.270516752105454, 25.200086805555557, 23.26530224087053, 29.461181640625], 'topk_indices': array([3275, 3248, 3120, 3168, 7466, 7428, 1417, 1479, 4308, 4324, 5142,
       5203, 7137, 7193, 3475, 3449, 4919, 4944, 4996, 4967]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.75625, 26.283203125, 19.403125, 26.2546875, 18.846875]}, 'saliency': {'score': [1.583984375, 0.1705952358816215, 1.4505462646484375, 0.16075881926113134, 0.24836325645446777], 'topk_indices': array([7262, 7528, 4157, 8169, 7320, 2528, 8175, 8177, 7368, 8079, 7291,
       8163,  820, 4736, 8035, 7573, 4236, 7529, 7574, 7369]), 'topk_tokens': ['nes', ' Min', ' milk', ' prior', 'nes', ' Sandra', ' milk', ' discarded', ' Min', ' location', 'nes', 'Question', ' hallway', ' kitchen', ' context', ' Min', ' hallway', 'nes', 'nes', 'nes'], 'evidence_proportions': [1.68359375, 2.446044921875, 1.15751953125, 1.928515625, 0.87666015625]}}, 'pred_res': 'the kitchen<|eot_id|>', 'score': 0}
2025-01-22 05:11:14.163 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:11:14.163 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-51_pid-3_1-5-6-7-8.pkl | len: 3 |  size: 2.05 KB
Processing depth (1, 5, 6, 7, 8):   4%|▍         | 4/100 [01:19<31:52, 19.92s/it]is_0k: False
your chose emoji: ['👯', '🌄', '👎🏻', '🐓', '🇰🇳', '\U0001faf1🏾\u200d\U0001faf2🏻', '👩🏽\u200d❤️\u200d💋\u200d👩🏼', '🌴', '✌🏽', '◀️']
emoji:
O: 👯 [9468, 239, 107]
N: 🌄 [9468, 234, 226]

O: 🌄 [9468, 234, 226]
N: 🐓 [9468, 238, 241]

O: 👎🏻 [9468, 239, 236, 9468, 237, 119]
N: 🇰🇳 [9468, 229, 108, 9468, 229, 111]

O: 🐓 [9468, 238, 241]
N: 🌴 [9468, 234, 112]

O: 🇰🇳 [9468, 229, 108, 9468, 229, 111]
N: 👩🏽‍❤️‍💋‍👩🏼 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 120]

O: 🫱🏾‍🫲🏻 [9468, 104, 109, 9468, 237, 122, 102470, 9468, 104, 110, 9468, 237, 119]
N: ✌🏽 [38798, 234, 9468, 237, 121]

O: 👩🏽‍❤️‍💋‍👩🏼 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 120]
N: 🫱🏾‍🫲🏻 [9468, 104, 109, 9468, 237, 122, 102470, 9468, 104, 110, 9468, 237, 119]

O: 🌴 [9468, 234, 112]
N: 👎🏻 [9468, 239, 236, 9468, 237, 119]

O: ✌🏽 [38798, 234, 9468, 237, 121]
N: 👯 [9468, 239, 107]

O: ◀️ [41832, 222, 31643]
N: ◀️ [41832, 222, 31643]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.72s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.74s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.35s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.02s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.59s/it]
Processing depth (2, 3, 4, 6, 8):   4%|▍         | 4/100 [01:35<31:52, 19.92s/it]2025-01-22 05:11:30.382 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the hallway.
2025-01-22 05:11:30.390 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1591, 1596) --> . Mary travelled to the
2025-01-22 05:11:30.390 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary got the milk.
2025-01-22 05:11:30.403 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2725, 2729) -->  Mary got the milk
2025-01-22 05:11:30.404 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the kitchen.
2025-01-22 05:11:30.421 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3517, 3522) --> . Mary went to the
2025-01-22 05:11:30.421 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary put down the milk.
2025-01-22 05:11:30.443 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4628, 4633) -->  Mary put down the milk
2025-01-22 05:11:30.443 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel went to the garden.
2025-01-22 05:11:30.461 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3572, 3577) -->  back to the garden.
2025-01-22 05:11:30.461 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel put down the football there.
2025-01-22 05:11:30.481 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4096, 4102) --> . Daniel put down the football
2025-01-22 05:11:30.481 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra picked up the apple.
2025-01-22 05:11:30.513 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6501, 6506) --> . Sandra picked up the
2025-01-22 05:11:30.513 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra left the apple.
2025-01-22 05:11:30.524 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2428, 2432) -->  Sandra left the apple
2025-01-22 05:11:30.524 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra moved to the hallway.
2025-01-22 05:11:30.545 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4137, 4142) --> . Sandra moved to the
2025-01-22 05:11:30.545 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra went back to the garden.
2025-01-22 05:11:30.563 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3569, 3575) --> . Sandra went back to the
2025-01-22 05:11:30.563 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel journeyed to the kitchen.
2025-01-22 05:11:30.588 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (4632, 4638) -->  milk. Daniel journeyed to
2025-01-22 05:11:30.588 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Daniel took the football.
2025-01-22 05:11:30.617 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (5151, 5155) -->  Daniel took the football
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:11:31.404 | INFO     | test_jbb_embedding:begin_test:693 - the kitchen<|eot_id|>
2025-01-22 05:11:31.404 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8210])
2025-01-22 05:11:33.717 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [201.11197916666666, 18.628106736271764, 151.64973958333334, 17.50356463878327, 19.51705025337838], 'topk_indices': array([8189, 1596, 2729, 8209, 8184, 8190, 8195, 2728, 8089, 8197, 8055,
       2428,   24, 8208,   14, 8206, 4142, 3522, 8205,    0]), 'topk_tokens': [' prior', ' hallway', '.', '\n\n', ':', ' to', ' milk', ' milk', '.\n\n', ' discarded', ' context', ' Sandra', '\n\n', '<|end_header_id|>', '\n', '<|start_header_id|>', ' hallway', ' kitchen', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [192.825, 287.75, 214.575, 220.025, 107.7125]}, 'weight': {'score': [22.157552083333332, 23.28068877085109, 23.877821180555557, 23.281358280694224, 29.18918918918919], 'topk_indices': array([3326, 3299, 3171, 3219, 7426, 7464, 1497, 1435, 4354, 4370, 5183,
       5244, 7147, 7203, 3482, 3508, 4955, 4980, 5032, 5003]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.75625, 26.283203125, 19.403125, 26.3234375, 18.846875]}, 'saliency': {'score': [1.181396484375, 0.10564701754269147, 0.9721730550130209, 0.09865414074238393, 0.14385615168391047], 'topk_indices': array([2431, 4139, 1593, 8099, 7572, 4632,   24, 7571, 7527, 4138, 8189,
       8195, 2728, 8183, 8055, 1596, 8197, 2428, 3522, 4142]), 'topk_tokens': [' apple', ' moved', ' travelled', ' location', 'nes', ' milk', '\n\n', ' Min', 'nes', ' Sandra', ' prior', ' milk', ' milk', 'Question', ' context', ' hallway', ' discarded', ' Sandra', ' kitchen', ' hallway'], 'evidence_proportions': [1.0818359375, 1.8953857421875, 1.024267578125, 1.4619140625, 0.586376953125]}}, 'pred_res': 'the kitchen<|eot_id|>', 'score': 0}
2025-01-22 05:11:33.725 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:11:33.725 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-51_pid-4_2-3-4-6-8.pkl | len: 3 |  size: 2.09 KB
Processing depth (2, 3, 4, 6, 8):   5%|▌         | 5/100 [01:38<31:20, 19.79s/it]Processing depth (2, 3, 4, 6, 8):   5%|▌         | 5/100 [01:39<31:21, 19.80s/it]
2025-01-22 05:11:33.941 | INFO     | __main__:<module>:82 - Selected idx: 52
2025-01-22 05:11:33.941 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the apple before the kitchen? 
2025-01-22 05:11:33.941 | INFO     | __main__:<module>:84 - Answer: hallway
2025-01-22 05:11:33.941 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 05:11:33.941 | INFO     | __main__:<module>:86 - Needle: [' Sandra moved to the hallway.', ' Sandra went back to the garden.', ' Sandra left the apple.', ' Mary travelled to the hallway.', ' Daniel took the football.', ' Daniel put down the football there.', ' Sandra picked up the apple.', ' Mary went to the kitchen.', ' Daniel journeyed to the kitchen.', ' Mary put down the apple.', ' Daniel went to the garden.']
2025-01-22 05:11:33.941 | INFO     | __main__:<module>:87 - Real Needle: [' Mary travelled to the hallway.', ' Mary went to the kitchen.', ' Mary put down the apple.', ' Daniel went to the garden.']
2025-01-22 05:11:33.941 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['🚶\u200d♂\u200d➡', '🪁', '❤\u200d🩹', '👨🏻\u200d🤝\u200d👨🏽', '💇🏿\u200d♂', '⚙️', '🚣🏽', '👨', '💬', '👩🏿\u200d🤝\u200d👩🏽']
emoji:
O: 🚶‍♂‍➡ [9468, 248, 114, 102470, 17245, 224, 102470, 98115, 94]
N: ⚙️ [158, 248, 247, 31643]

O: 🪁 [9468, 103, 223]
N: ❤‍🩹 [121643, 102470, 9468, 102, 117]

O: ❤‍🩹 [121643, 102470, 9468, 102, 117]
N: 🚶‍♂‍➡ [9468, 248, 114, 102470, 17245, 224, 102470, 98115, 94]

O: 👨🏻‍🤝‍👨🏽 [9468, 239, 101, 9468, 237, 119, 102470, 9468, 97, 251, 102470, 9468, 239, 101, 9468, 237, 121]
N: 🚣🏽 [9468, 248, 96, 9468, 237, 121]

O: 💇🏿‍♂ [93273, 229, 9468, 237, 123, 102470, 17245, 224]
N: 🪁 [9468, 103, 223]

O: ⚙️ [158, 248, 247, 31643]
N: 💬 [93273, 105]

O: 🚣🏽 [9468, 248, 96, 9468, 237, 121]
N: 👨🏻‍🤝‍👨🏽 [9468, 239, 101, 9468, 237, 119, 102470, 9468, 97, 251, 102470, 9468, 239, 101, 9468, 237, 121]

O: 👨 [9468, 239, 101]
N: 💇🏿‍♂ [93273, 229, 9468, 237, 123, 102470, 17245, 224]

O: 💬 [93273, 105]
N: 👨 [9468, 239, 101]

O: 👩🏿‍🤝‍👩🏽 [9468, 239, 102, 9468, 237, 123, 102470, 9468, 97, 251, 102470, 9468, 239, 102, 9468, 237, 121]
N: 👩🏿‍🤝‍👩🏽 [9468, 239, 102, 9468, 237, 123, 102470, 9468, 97, 251, 102470, 9468, 239, 102, 9468, 237, 121]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.00s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.71s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.56s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  2.98s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.53s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (2, 4, 5, 7):   0%|          | 0/100 [00:15<?, ?it/s]2025-01-22 05:11:49.828 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the hallway.
2025-01-22 05:11:49.837 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1757, 1762) --> . Mary travelled to the
2025-01-22 05:11:49.837 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went to the kitchen.
2025-01-22 05:11:49.855 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3624, 3629) -->  Hon. Mary went to
2025-01-22 05:11:49.855 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary put down the apple.
2025-01-22 05:11:49.877 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4178, 4183) --> . Mary put down the
2025-01-22 05:11:49.877 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went to the garden.
2025-01-22 05:11:49.908 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5660, 5665) --> . Daniel went to the
2025-01-22 05:11:49.908 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the hallway.
2025-01-22 05:11:49.935 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4996, 5001) --> . Sandra moved to the
2025-01-22 05:11:49.935 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the garden.
2025-01-22 05:11:49.969 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6693, 6699) --> . Sandra went back to the
2025-01-22 05:11:49.969 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra left the apple.
2025-01-22 05:11:50.000 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6663, 6667) -->  Sandra left the apple
2025-01-22 05:11:50.000 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel took the football.
2025-01-22 05:11:50.022 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3772, 3776) -->  Daniel took the football
2025-01-22 05:11:50.022 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel put down the football there.
2025-01-22 05:11:50.023 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (231, 237) --> . Daniel put down the football
2025-01-22 05:11:50.023 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra picked up the apple.
2025-01-22 05:11:50.028 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (834, 839) --> . Sandra picked up the
2025-01-22 05:11:50.028 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Daniel journeyed to the kitchen.
2025-01-22 05:11:50.034 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (1257, 1263) -->  Republican. Daniel journeyed to
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:11:52.714 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 05:11:52.714 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8172])
2025-01-22 05:11:55.490 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [141.23125, 19.461043577981652, 216.98350694444446, 18.28525680502525, 21.169213079637096], 'topk_indices': array([ 835,  839, 8153, 1264, 8155,    3,  232,   14, 8157, 8170, 1762,
       8156,   24, 8159, 8162, 8163, 8160,    0, 8168, 8167]), 'topk_tokens': [' Sandra', ' apple', '.\n\n', ' kitchen', ':', '<|end_header_id|>', ' Daniel', '\n', ' was', '<|end_header_id|>', ' hallway', ' Where', '\n\n', ' apple', ' kitchen', '?', ' before', '<|begin_of_text|>', '<|start_header_id|>', '<|eot_id|>'], 'evidence_proportions': [162.4, 191.6, 113.8375, 97.0875]}, 'weight': {'score': [21.601171875, 23.263841743119265, 23.96462673611111, 23.26483018228846, 29.121975806451612], 'topk_indices': array([3314, 3287, 3207, 3159, 7463, 7425, 1511, 1449, 4321, 4337, 5205,
       5144, 7140, 7196, 3470, 3496, 4934, 4909, 4986, 4957]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.75625, 24.2109375, 21.771875, 19.665625]}, 'saliency': {'score': [0.781414794921875, 0.10828195181097094, 1.3349948459201388, 0.10118448647655191, 0.1544647216796875], 'topk_indices': array([4998,  843,   24, 8026,  836, 8157, 3630, 4997, 5001, 8154,  839,
       8163, 1264, 8156,  232,  835, 8159, 1762, 8160, 8162]), 'topk_tokens': [' moved', '�', '\n\n', ' context', ' picked', ' was', ' kitchen', ' Sandra', ' hallway', 'Question', ' apple', '?', ' kitchen', ' Where', ' Daniel', ' Sandra', ' apple', ' hallway', ' before', ' kitchen'], 'evidence_proportions': [0.8990234375, 1.05, 0.629931640625, 0.5467041015625]}}, 'pred_res': 'The garden.<|eot_id|>', 'score': 0}
2025-01-22 05:11:55.498 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:11:55.498 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-52_pid-0_2-4-5-7.pkl | len: 3 |  size: 2.04 KB
Processing depth (2, 4, 5, 7):   1%|          | 1/100 [00:21<35:24, 21.46s/it]is_0k: False
your chose emoji: ['🙆🏽', '🚶🏽\u200d♂️\u200d➡', '🥁', '🦕', '🏄🏼\u200d♂️', '🇰🇾', '🇺🇲', '🤷🏼\u200d♂', '🌷', '🍤']
emoji:
O: 🙆🏽 [9468, 247, 228, 9468, 237, 121]
N: 🤷🏼‍♂ [9468, 97, 115, 9468, 237, 120, 102470, 17245, 224]

O: 🚶🏽‍♂️‍➡ [9468, 248, 114, 9468, 237, 121, 102470, 17245, 224, 31643, 102470, 98115, 94]
N: 🙆🏽 [9468, 247, 228, 9468, 237, 121]

O: 🥁 [9468, 98, 223]
N: 🌷 [9468, 234, 115]

O: 🦕 [9468, 99, 243]
N: 🇺🇲 [9468, 229, 118, 9468, 229, 110]

O: 🏄🏼‍♂️ [9468, 237, 226, 9468, 237, 120, 102470, 17245, 224, 31643]
N: 🚶🏽‍♂️‍➡ [9468, 248, 114, 9468, 237, 121, 102470, 17245, 224, 31643, 102470, 98115, 94]

O: 🇰🇾 [9468, 229, 108, 9468, 229, 122]
N: 🦕 [9468, 99, 243]

O: 🇺🇲 [9468, 229, 118, 9468, 229, 110]
N: 🏄🏼‍♂️ [9468, 237, 226, 9468, 237, 120, 102470, 17245, 224, 31643]

O: 🤷🏼‍♂ [9468, 97, 115, 9468, 237, 120, 102470, 17245, 224]
N: 🇰🇾 [9468, 229, 108, 9468, 229, 122]

O: 🌷 [9468, 234, 115]
N: 🥁 [9468, 98, 223]

O: 🍤 [9468, 235, 97]
N: 🍤 [9468, 235, 97]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.38s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.41s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.55s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.20s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.66s/it]
Processing depth (1, 5, 7, 9):   1%|          | 1/100 [00:37<35:24, 21.46s/it]2025-01-22 05:12:11.786 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the hallway.
2025-01-22 05:12:11.792 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (902, 907) --> . Mary travelled to the
2025-01-22 05:12:11.792 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went to the kitchen.
2025-01-22 05:12:11.815 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4199, 4204) -->  Mary went to the kitchen
2025-01-22 05:12:11.815 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary put down the apple.
2025-01-22 05:12:11.847 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5662, 5667) --> . Mary put down the
2025-01-22 05:12:11.848 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went to the garden.
2025-01-22 05:12:11.883 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6680, 6685) -->  back to the garden.
2025-01-22 05:12:11.883 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the hallway.
2025-01-22 05:12:11.889 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (905, 910) -->  to the hallway. Sandra
2025-01-22 05:12:11.889 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the garden.
2025-01-22 05:12:11.929 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6677, 6683) --> . Sandra went back to the
2025-01-22 05:12:11.929 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra left the apple.
2025-01-22 05:12:11.966 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6641, 6645) -->  Sandra left the apple
2025-01-22 05:12:11.966 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel took the football.
2025-01-22 05:12:11.988 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3790, 3794) -->  Daniel took the football
2025-01-22 05:12:11.988 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel put down the football there.
2025-01-22 05:12:11.989 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (231, 237) --> . Daniel put down the football
2025-01-22 05:12:11.989 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra picked up the apple.
2025-01-22 05:12:11.995 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (907, 912) -->  hallway. Sandra picked up
2025-01-22 05:12:11.995 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Daniel journeyed to the kitchen.
2025-01-22 05:12:12.002 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (1292, 1298) --> . Daniel journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:12:12.796 | INFO     | test_jbb_embedding:begin_test:693 - the hallway<|eot_id|>
2025-01-22 05:12:12.796 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8192])
2025-01-22 05:12:15.025 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [157.39375, 16.09013308419768, 180.75477430555554, 15.014571046811648, 15.300726996527779], 'topk_indices': array([8174,   25,    9, 8178, 8080, 8175, 8183, 8190,  914, 8176,   24,
        907, 8182, 8177, 8179,   14, 8180,    0, 8187, 8188]), 'topk_tokens': ['Question', '<|eot_id|>', ':', ' the', '.\n\n', ':', '?', '<|end_header_id|>', '.', ' Where', '\n\n', ' hallway', ' kitchen', ' was', ' apple', '\n', ' before', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [246.025, 133.5625, 96.875, 153.1125]}, 'weight': {'score': [21.391796875, 23.29271659548505, 24.354817708333332, 23.292689903550805, 29.95160590277778], 'topk_indices': array([3306, 3279, 3199, 3151, 7477, 7439, 1501, 1439, 4291, 4275, 5146,
       5207, 7216, 7160, 3488, 3462, 4942, 4971, 4917, 5000]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.75625, 24.1921875, 21.771875, 18.846875]}, 'saliency': {'score': [0.8942611694335938, 0.08768454290440054, 1.1500820583767362, 0.08100339742122228, 0.1162812974717882], 'topk_indices': array([8080,    8,  232,   27,  904,   24, 8046, 8185,  913, 8183, 8090,
       1298, 4951, 8177, 8174, 8176, 8179, 8182,  907, 8180]), 'topk_tokens': ['.\n\n', ' Date', ' Daniel', 'user', ' travelled', '\n\n', ' context', 'Answer', ' apple', '?', ' location', ' kitchen', ' hallway', ' was', 'Question', ' Where', ' apple', ' kitchen', ' hallway', ' before'], 'evidence_proportions': [1.31591796875, 0.88212890625, 0.552734375, 0.826263427734375]}}, 'pred_res': 'the hallway<|eot_id|>', 'score': 100}
2025-01-22 05:12:15.035 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:12:15.036 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-52_pid-1_1-5-7-9.pkl | len: 3 |  size: 2.02 KB
Processing depth (1, 5, 7, 9):   2%|▏         | 2/100 [00:41<33:12, 20.33s/it]is_0k: False
your chose emoji: ['🏄🏼\u200d♂', '👩🏾\u200d❤️\u200d💋\u200d👩🏼', '🧎🏽\u200d♀', '🌪️', '🤹🏿\u200d♀', '🩺', '🦠', '🤼\u200d♀', '⛹️\u200d♀️', '🇸🇪']
emoji:
O: 🏄🏼‍♂ [9468, 237, 226, 9468, 237, 120, 102470, 17245, 224]
N: ⛹️‍♀️ [158, 249, 117, 31643, 102470, 32990, 31643]

O: 👩🏾‍❤️‍💋‍👩🏼 [9468, 239, 102, 9468, 237, 122, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 120]
N: 🌪️ [9468, 234, 103, 31643]

O: 🧎🏽‍♀ [9468, 100, 236, 9468, 237, 121, 102470, 32990]
N: 🩺 [9468, 102, 118]

O: 🌪️ [9468, 234, 103, 31643]
N: 🦠 [9468, 99, 254]

O: 🤹🏿‍♀ [9468, 97, 117, 9468, 237, 123, 102470, 32990]
N: 👩🏾‍❤️‍💋‍👩🏼 [9468, 239, 102, 9468, 237, 122, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 120]

O: 🩺 [9468, 102, 118]
N: 🧎🏽‍♀ [9468, 100, 236, 9468, 237, 121, 102470, 32990]

O: 🦠 [9468, 99, 254]
N: 🏄🏼‍♂ [9468, 237, 226, 9468, 237, 120, 102470, 17245, 224]

O: 🤼‍♀ [9468, 97, 120, 102470, 32990]
N: 🤼‍♀ [9468, 97, 120, 102470, 32990]

O: ⛹️‍♀️ [158, 249, 117, 31643, 102470, 32990, 31643]
N: 🤹🏿‍♀ [9468, 97, 117, 9468, 237, 123, 102470, 32990]

O: 🇸🇪 [9468, 229, 116, 9468, 229, 103]
N: 🇸🇪 [9468, 229, 116, 9468, 229, 103]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:11,  3.80s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.17s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:11<00:03,  3.80s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  2.48s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  3.01s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (3, 5, 8, 9):   2%|▏         | 2/100 [00:55<33:12, 20.33s/it]2025-01-22 05:12:29.613 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the hallway.
2025-01-22 05:12:29.627 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2888, 2893) -->  Mary travelled to the hallway
2025-01-22 05:12:29.627 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went to the kitchen.
2025-01-22 05:12:29.648 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4154, 4159) --> . Mary went to the
2025-01-22 05:12:29.648 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary put down the apple.
2025-01-22 05:12:29.685 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6608, 6613) --> . Mary put down the
2025-01-22 05:12:29.685 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went to the garden.
2025-01-22 05:12:29.721 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6680, 6685) -->  back to the garden.
2025-01-22 05:12:29.721 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the hallway.
2025-01-22 05:12:29.747 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4898, 4903) --> . Sandra moved to the
2025-01-22 05:12:29.747 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the garden.
2025-01-22 05:12:29.782 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6677, 6683) --> . Sandra went back to the
2025-01-22 05:12:29.783 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra left the apple.
2025-01-22 05:12:29.817 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6647, 6651) -->  Sandra left the apple
2025-01-22 05:12:29.817 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel took the football.
2025-01-22 05:12:29.839 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3678, 3682) -->  Daniel took the football
2025-01-22 05:12:29.839 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel put down the football there.
2025-01-22 05:12:29.841 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (231, 237) --> . Daniel put down the football
2025-01-22 05:12:29.841 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra picked up the apple.
2025-01-22 05:12:29.845 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (836, 841) --> . Sandra picked up the
2025-01-22 05:12:29.845 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Daniel journeyed to the kitchen.
2025-01-22 05:12:29.852 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (1292, 1298) --> . Daniel journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:12:32.698 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 05:12:32.698 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8186])
2025-01-22 05:12:35.504 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [212.575, 16.49022316522164, 178.3671875, 15.291493759990164, 14.345703125], 'topk_indices': array([ 231, 8040, 8170,    3,    1, 8171, 8177,  232, 3103, 8176, 8173,
        842, 8184,   14, 2892, 8174,   24, 8182,    0, 8181]), 'topk_tokens': ['.', ' context', ' Where', '<|end_header_id|>', '<|start_header_id|>', ' was', '?', ' Daniel', 'ern', ' kitchen', ' apple', '.', '<|end_header_id|>', '\n', ' hallway', ' before', '\n\n', '<|start_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [312.1, 108.675, 239.4, 190.125]}, 'weight': {'score': [21.718359375, 23.28979042007571, 23.291666666666668, 23.29364644811263, 30.067481884057973], 'topk_indices': array([3291, 3318, 3155, 3203, 7447, 7409, 1501, 1439, 4341, 4325, 5209,
       5148, 7124, 7180, 3474, 3500, 4950, 5002, 4925, 4973]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.8515625, 19.403125, 21.771875, 18.846875]}, 'saliency': {'score': [1.3412796020507813, 0.09201262596690302, 1.0502454969618056, 0.08469899964482087, 0.10825436357138814], 'topk_indices': array([   8, 1298, 8177,  837, 8168, 3102, 2889, 6683, 8040, 6609, 4903,
        841, 8170,   24, 3103, 8173,  232, 8176, 8174, 2892]), 'topk_tokens': [' Date', ' kitchen', '?', ' Sandra', 'Question', ' const', ' travelled', ' garden', ' context', ' Mary', ' hallway', ' apple', ' Where', '\n\n', 'ern', ' apple', ' Daniel', ' kitchen', ' before', ' hallway'], 'evidence_proportions': [2.34150390625, 0.576025390625, 1.39296875, 1.054620361328125]}}, 'pred_res': 'The garden.<|eot_id|>', 'score': 0}
2025-01-22 05:12:35.530 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:12:35.531 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-52_pid-2_3-5-8-9.pkl | len: 3 |  size: 2.05 KB
Processing depth (3, 5, 8, 9):   3%|▎         | 3/100 [01:01<32:59, 20.41s/it]is_0k: False
your chose emoji: ['🙅🏽', '🏎️', '🏋🏼\u200d♂️', '🐤', '🧝🏻\u200d♂️', '🧎🏽\u200d♀\u200d➡️', '⚱', '🥵', '⛹🏽\u200d♂️', '💂🏼\u200d♂']
emoji:
O: 🙅🏽 [9468, 247, 227, 9468, 237, 121]
N: 🧝🏻‍♂️ [9468, 100, 251, 9468, 237, 119, 102470, 17245, 224, 31643]

O: 🏎️ [9468, 237, 236, 31643]
N: 🥵 [9468, 98, 113]

O: 🏋🏼‍♂️ [9468, 237, 233, 9468, 237, 120, 102470, 17245, 224, 31643]
N: 🐤 [9468, 238, 97]

O: 🐤 [9468, 238, 97]
N: 🏎️ [9468, 237, 236, 31643]

O: 🧝🏻‍♂️ [9468, 100, 251, 9468, 237, 119, 102470, 17245, 224, 31643]
N: 🧎🏽‍♀‍➡️ [9468, 100, 236, 9468, 237, 121, 102470, 32990, 102470, 98115, 94, 31643]

O: 🧎🏽‍♀‍➡️ [9468, 100, 236, 9468, 237, 121, 102470, 32990, 102470, 98115, 94, 31643]
N: 🏋🏼‍♂️ [9468, 237, 233, 9468, 237, 120, 102470, 17245, 224, 31643]

O: ⚱ [158, 248, 109]
N: ⚱ [158, 248, 109]

O: 🥵 [9468, 98, 113]
N: 🙅🏽 [9468, 247, 227, 9468, 237, 121]

O: ⛹🏽‍♂️ [158, 249, 117, 9468, 237, 121, 102470, 17245, 224, 31643]
N: ⛹🏽‍♂️ [158, 249, 117, 9468, 237, 121, 102470, 17245, 224, 31643]

O: 💂🏼‍♂ [93273, 224, 9468, 237, 120, 102470, 17245, 224]
N: 💂🏼‍♂ [93273, 224, 9468, 237, 120, 102470, 17245, 224]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.90s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.61s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.30s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  2.97s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.54s/it]
Processing depth (1, 2, 3, 4):   3%|▎         | 3/100 [01:17<32:59, 20.41s/it]2025-01-22 05:12:51.399 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the hallway.
2025-01-22 05:12:51.402 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (664, 669) --> . Mary travelled to the
2025-01-22 05:12:51.402 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went to the kitchen.
2025-01-22 05:12:51.410 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1627, 1632) --> . Mary went to the
2025-01-22 05:12:51.410 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary put down the apple.
2025-01-22 05:12:51.426 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2755, 2760) --> . Mary put down the
2025-01-22 05:12:51.426 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went to the garden.
2025-01-22 05:12:51.452 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3591, 3596) --> . Daniel went to the
2025-01-22 05:12:51.452 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the hallway.
2025-01-22 05:12:51.456 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (667, 672) -->  to the hallway. Sandra
2025-01-22 05:12:51.456 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the garden.
2025-01-22 05:12:51.490 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6621, 6627) --> . Sandra went back to the
2025-01-22 05:12:51.490 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra left the apple.
2025-01-22 05:12:51.521 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6519, 6523) -->  Sandra left the apple
2025-01-22 05:12:51.521 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel took the football.
2025-01-22 05:12:51.538 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3696, 3700) -->  Daniel took the football
2025-01-22 05:12:51.538 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel put down the football there.
2025-01-22 05:12:51.539 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (203, 209) --> . Daniel put down the football
2025-01-22 05:12:51.540 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra picked up the apple.
2025-01-22 05:12:51.543 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (669, 674) -->  hallway. Sandra picked up
2025-01-22 05:12:51.543 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Daniel journeyed to the kitchen.
2025-01-22 05:12:51.549 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (1116, 1122) --> . Daniel journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:12:52.343 | INFO     | test_jbb_embedding:begin_test:693 - The hallway.<|eot_id|>
2025-01-22 05:12:52.343 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8140])
2025-01-22 05:12:54.555 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [91.840625, 10.675612873019771, 125.89496527777777, 9.961974078768394, 17.39847995923913], 'topk_indices': array([   3,    4, 8139, 8123, 7994, 8125, 7989, 8127, 8028, 8130, 8131,
          9,   24, 8138,  669,   14, 8128,    0, 8135, 8136]), 'topk_tokens': ['<|end_header_id|>', '\n\n', '\n\n', ':', ' context', ' was', '\n', ' apple', '.\n\n', ' kitchen', '?', ':', '\n\n', '<|end_header_id|>', ' hallway', '\n', ' before', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [198.775, 41.11875, 66.4875, 60.98125]}, 'weight': {'score': [20.39921875, 23.242858129681935, 24.354817708333332, 23.244940761407197, 29.302309782608695], 'topk_indices': array([3327, 3354, 3199, 3247, 7431, 7393, 1545, 1483, 4329, 4345, 5213,
       5152, 7114, 7170, 3536, 3510, 4948, 4971, 4923, 5000]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.75625, 19.403125, 21.771875, 19.665625]}, 'saliency': {'score': [0.4599639892578125, 0.05832796261935098, 0.80242919921875, 0.0540222417030226, 0.13295679507048233], 'topk_indices': array([8139, 8109, 1122,   20, 8133, 8125,  666,   24, 8028, 8038,    8,
       8131, 8124, 8122, 4901, 7994, 8127, 8130, 8128,  669]), 'topk_tokens': ['\n\n', ' return', ' kitchen', ' Jul', 'Answer', ' was', ' travelled', '\n\n', '.\n\n', ' location', ' Date', '?', ' Where', 'Question', ' hallway', ' context', ' apple', ' kitchen', ' before', ' hallway'], 'evidence_proportions': [0.98095703125, 0.19849853515625, 0.356494140625, 0.30390625]}}, 'pred_res': 'The hallway.<|eot_id|>', 'score': 100}
2025-01-22 05:12:54.562 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:12:54.562 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-52_pid-3_1-2-3-4.pkl | len: 3 |  size: 2.01 KB
Processing depth (1, 2, 3, 4):   4%|▍         | 4/100 [01:20<31:46, 19.86s/it]is_0k: False
your chose emoji: ['🪔', '📬', '😓', '👩🏽\u200d🦼\u200d➡', '🙆', '👩\u200d❤️\u200d👩', '💽', '👪', '🛏️', '⬛']
emoji:
O: 🪔 [9468, 103, 242]
N: 👩‍❤️‍👩 [9468, 239, 102, 102470, 121643, 31643, 102470, 9468, 239, 102]

O: 📬 [9468, 241, 105]
N: 😓 [76460, 241]

O: 😓 [76460, 241]
N: 🛏️ [9468, 249, 237, 31643]

O: 👩🏽‍🦼‍➡ [9468, 239, 102, 9468, 237, 121, 102470, 9468, 99, 120, 102470, 98115, 94]
N: 👩🏽‍🦼‍➡ [9468, 239, 102, 9468, 237, 121, 102470, 9468, 99, 120, 102470, 98115, 94]

O: 🙆 [9468, 247, 228]
N: 📬 [9468, 241, 105]

O: 👩‍❤️‍👩 [9468, 239, 102, 102470, 121643, 31643, 102470, 9468, 239, 102]
N: 🪔 [9468, 103, 242]

O: 💽 [93273, 121]
N: 🙆 [9468, 247, 228]

O: 👪 [9468, 239, 103]
N: 👪 [9468, 239, 103]

O: 🛏️ [9468, 249, 237, 31643]
N: 💽 [93273, 121]

O: ⬛ [158, 105, 249]
N: ⬛ [158, 105, 249]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.20s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.69s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.27s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.92s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.46s/it]
Processing depth (1, 4, 6, 7):   4%|▍         | 4/100 [01:36<31:46, 19.86s/it]2025-01-22 05:13:10.517 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the hallway.
2025-01-22 05:13:10.521 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (822, 827) --> . Mary travelled to the
2025-01-22 05:13:10.521 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went to the kitchen.
2025-01-22 05:13:10.539 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3565, 3570) --> . Mary went to the
2025-01-22 05:13:10.539 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary put down the apple.
2025-01-22 05:13:10.561 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4630, 4635) --> . Mary put down the
2025-01-22 05:13:10.562 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went to the garden.
2025-01-22 05:13:10.589 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5568, 5573) --> . Daniel went to the
2025-01-22 05:13:10.589 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the hallway.
2025-01-22 05:13:10.593 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (825, 830) -->  to the hallway. Sandra
2025-01-22 05:13:10.593 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the garden.
2025-01-22 05:13:10.626 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6653, 6659) --> . Sandra went back to the
2025-01-22 05:13:10.626 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra left the apple.
2025-01-22 05:13:10.660 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6617, 6621) -->  Sandra left the apple
2025-01-22 05:13:10.660 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel took the football.
2025-01-22 05:13:10.677 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3670, 3674) -->  Daniel took the football
2025-01-22 05:13:10.678 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel put down the football there.
2025-01-22 05:13:10.679 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (190, 196) -->  Daniel put down the football there
2025-01-22 05:13:10.679 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra picked up the apple.
2025-01-22 05:13:10.683 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (827, 832) -->  hallway. Sandra picked up
2025-01-22 05:13:10.683 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Daniel journeyed to the kitchen.
2025-01-22 05:13:10.689 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (1253, 1259) -->  Daniel journeyed to the kitchen
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:13:11.488 | INFO     | test_jbb_embedding:begin_test:693 - The hallway.<|eot_id|>
2025-01-22 05:13:11.489 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8146])
2025-01-22 05:13:13.712 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [78.9203125, 10.851597972143821, 130.77777777777777, 10.149915436179414, 14.212910554846939], 'topk_indices': array([ 834,    4, 4895, 8034, 8129, 8131,    1, 8133, 8128,    9,    3,
       8136,   24,  827, 8144,   14, 8134, 8142,    0, 8141]), 'topk_tokens': ['.', '\n\n', ' hallway', '.\n\n', ':', ' was', '<|start_header_id|>', ' apple', 'Question', ':', '<|end_header_id|>', ' kitchen', '\n\n', ' hallway', '<|end_header_id|>', '\n', ' before', '<|start_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [153.6875, 61.89375, 53.975, 46.125]}, 'weight': {'score': [20.39921875, 23.2538501656645, 25.44292534722222, 23.251167096564934, 29.8453443877551], 'topk_indices': array([3318, 3291, 3163, 3211, 7437, 7399, 1443, 1505, 4333, 4317, 5201,
       5140, 7114, 7170, 3500, 3474, 4965, 4917, 4994, 4942]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.75625, 19.403125, 21.771875, 19.665625]}, 'saliency': {'score': [0.4173858642578125, 0.05961022240674661, 0.8810102674696181, 0.05507223717762457, 0.10867122727997448], 'topk_indices': array([8139,  824, 8137, 8115,   20, 8034,  829, 8131,    8,   24, 1258,
       8044, 8130, 8000, 8133, 8128, 8136, 4895, 8134,  827]), 'topk_tokens': ['Answer', ' travelled', '?', ' return', ' Jul', '.\n\n', ' Sandra', ' was', ' Date', '\n\n', ' kitchen', ' location', ' Where', ' context', ' apple', 'Question', ' kitchen', ' hallway', ' before', ' hallway'], 'evidence_proportions': [0.8150390625, 0.3102294921875, 0.2887451171875, 0.25552978515625]}}, 'pred_res': 'The hallway.<|eot_id|>', 'score': 100}
2025-01-22 05:13:13.717 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:13:13.717 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-52_pid-4_1-4-6-7.pkl | len: 3 |  size: 2.04 KB
Processing depth (1, 4, 6, 7):   5%|▌         | 5/100 [01:39<31:02, 19.61s/it]Processing depth (1, 4, 6, 7):   5%|▌         | 5/100 [01:39<31:35, 19.95s/it]
2025-01-22 05:13:13.785 | INFO     | __main__:<module>:82 - Selected idx: 53
2025-01-22 05:13:13.786 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the location prior to the place where the milk was discarded, left or dropped?
2025-01-22 05:13:13.786 | INFO     | __main__:<module>:84 - Answer: hallway
2025-01-22 05:13:13.786 | INFO     | __main__:<module>:85 - Tag: 4-hop
2025-01-22 05:13:13.786 | INFO     | __main__:<module>:86 - Needle: [' Daniel put down the football there.', ' Mary travelled to the hallway.', ' Sandra left the apple.', ' Mary grabbed the milk.', ' Sandra went back to the garden.', ' Daniel journeyed to the kitchen.', ' Daniel took the football.', ' Sandra picked up the apple.', ' Mary went to the kitchen.', ' Sandra moved to the hallway.', ' Mary put down the milk.', ' Daniel went to the garden.']
2025-01-22 05:13:13.786 | INFO     | __main__:<module>:87 - Real Needle: [' Mary travelled to the hallway.', ' Mary grabbed the milk.', ' Mary went to the kitchen.', ' Mary put down the milk.', ' Daniel went to the garden.']
2025-01-22 05:13:13.786 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['🗑', '🔓', '💇\u200d♀️', '💁🏾\u200d♂', '☂️', '🧑🏿\u200d🏫', '🙎🏼', '🖕', '💃🏾', '☸️']
emoji:
O: 🗑 [9468, 245, 239]
N: ☂️ [18107, 224, 31643]

O: 🔓 [9468, 242, 241]
N: 🙎🏼 [9468, 247, 236, 9468, 237, 120]

O: 💇‍♀️ [93273, 229, 102470, 32990, 31643]
N: 🖕 [9468, 244, 243]

O: 💁🏾‍♂ [93273, 223, 9468, 237, 122, 102470, 17245, 224]
N: 💁🏾‍♂ [93273, 223, 9468, 237, 122, 102470, 17245, 224]

O: ☂️ [18107, 224, 31643]
N: 💃🏾 [93273, 225, 9468, 237, 122]

O: 🧑🏿‍🏫 [9468, 100, 239, 9468, 237, 123, 102470, 9468, 237, 104]
N: 🧑🏿‍🏫 [9468, 100, 239, 9468, 237, 123, 102470, 9468, 237, 104]

O: 🙎🏼 [9468, 247, 236, 9468, 237, 120]
N: 🗑 [9468, 245, 239]

O: 🖕 [9468, 244, 243]
N: 💇‍♀️ [93273, 229, 102470, 32990, 31643]

O: 💃🏾 [93273, 225, 9468, 237, 122]
N: 🔓 [9468, 242, 241]

O: ☸️ [18107, 116, 31643]
N: ☸️ [18107, 116, 31643]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.22s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.40s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.23s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.95s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.44s/it]
Processing depth (1, 2, 3, 4, 5):   0%|          | 0/100 [00:15<?, ?it/s]2025-01-22 05:13:29.318 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the hallway.
2025-01-22 05:13:29.322 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (829, 834) --> . Mary travelled to the
2025-01-22 05:13:29.323 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary grabbed the milk.
2025-01-22 05:13:29.331 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1821, 1825) -->  Mary grabbed the milk
2025-01-22 05:13:29.332 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the kitchen.
2025-01-22 05:13:29.346 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2901, 2906) --> . Mary went to the
2025-01-22 05:13:29.346 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary put down the milk.
2025-01-22 05:13:29.368 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3634, 3639) -->  Hon. Mary put down
2025-01-22 05:13:29.368 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel went to the garden.
2025-01-22 05:13:29.376 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1584, 1589) -->  back to the garden.
2025-01-22 05:13:29.376 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel put down the football there.
2025-01-22 05:13:29.381 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (985, 991) --> . Daniel put down the football
2025-01-22 05:13:29.381 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra left the apple.
2025-01-22 05:13:29.389 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1293, 1297) -->  Sandra left the apple
2025-01-22 05:13:29.389 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the garden.
2025-01-22 05:13:29.397 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1581, 1587) --> . Sandra went back to the
2025-01-22 05:13:29.397 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the kitchen.
2025-01-22 05:13:29.418 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3837, 3843) --> . Daniel journeyed to the
2025-01-22 05:13:29.418 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel took the football.
2025-01-22 05:13:29.439 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4362, 4366) -->  took the football.
2025-01-22 05:13:29.439 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra picked up the apple.
2025-01-22 05:13:29.462 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (3906, 3911) --> . Sandra picked up the
2025-01-22 05:13:29.462 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Sandra moved to the hallway.
2025-01-22 05:13:29.497 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (6453, 6458) --> . Sandra moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:13:30.283 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 05:13:30.283 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8202])
2025-01-22 05:13:32.527 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [314.2369791666667, 22.72686433577087, 135.50954861111111, 21.369415669122162, 16.624190848214287], 'topk_indices': array([  54, 8183, 3638,   24, 3640,  832, 3635, 8187, 8182,  835, 3624,
       2906,  831, 8189, 1824, 1825,  834,    0, 8197, 8198]), 'topk_tokens': ['\n\n\n\n', ' the', ' down', '\n\n', ' milk', ' to', '.', ' milk', ' to', '.', '.', ' kitchen', ' travelled', ' discarded', ' milk', '.', ' hallway', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [420.1, 436.6875, 208.175, 375.575, 155.1375]}, 'weight': {'score': [22.486328125, 23.289053930530166, 22.612630208333332, 23.294408954880296, 29.969866071428573], 'topk_indices': array([3297, 3324, 3169, 3217, 7434, 7472, 1437, 1499, 4317, 4301, 5149,
       5210, 7207, 7151, 3506, 3480, 4951, 4974, 5003, 4926]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.75625, 27.935546875, 19.403125, 26.5796875, 18.846875]}, 'saliency': {'score': [1.8597005208333333, 0.1267515341731414, 0.866973876953125, 0.11837353785393646, 0.12890657697405133], 'topk_indices': array([8175,   33, 1296, 8195, 1821, 3637,  830,   51, 3638, 8181,   54,
       1822, 3640, 8187, 1293, 2906, 1824,  831, 8189,  834]), 'topk_tokens': ['Question', '\n\n\n', ' apple', 'Answer', ' Mary', ' put', ' Mary', ' Proof', ' down', ' prior', '\n\n\n\n', ' grabbed', ' milk', ' milk', ' Sandra', ' kitchen', ' milk', ' travelled', ' discarded', ' hallway'], 'evidence_proportions': [2.28681640625, 3.148681640625, 1.019140625, 2.2857421875, 0.81591796875]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 0}
2025-01-22 05:13:32.534 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:13:32.535 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-53_pid-0_1-2-3-4-5.pkl | len: 3 |  size: 2.06 KB
Processing depth (1, 2, 3, 4, 5):   1%|          | 1/100 [00:18<30:47, 18.66s/it]is_0k: False
your chose emoji: ['⛄', '🚣🏽\u200d♂', '\U0001fabf', '🏓', '🧍🏼\u200d♂️', '👩🏿\u200d❤️\u200d👩🏽', '🤝🏻', '🚵🏻\u200d♂️', '☃', '💁🏼\u200d♂️']
emoji:
O: ⛄ [158, 75309]
N: 🧍🏼‍♂️ [9468, 100, 235, 9468, 237, 120, 102470, 17245, 224, 31643]

O: 🚣🏽‍♂ [9468, 248, 96, 9468, 237, 121, 102470, 17245, 224]
N: 🤝🏻 [9468, 97, 251, 9468, 237, 119]

O: 🪿 [9468, 103, 123]
N: ⛄ [158, 75309]

O: 🏓 [9468, 237, 241]
N: 👩🏿‍❤️‍👩🏽 [9468, 239, 102, 9468, 237, 123, 102470, 121643, 31643, 102470, 9468, 239, 102, 9468, 237, 121]

O: 🧍🏼‍♂️ [9468, 100, 235, 9468, 237, 120, 102470, 17245, 224, 31643]
N: 🚣🏽‍♂ [9468, 248, 96, 9468, 237, 121, 102470, 17245, 224]

O: 👩🏿‍❤️‍👩🏽 [9468, 239, 102, 9468, 237, 123, 102470, 121643, 31643, 102470, 9468, 239, 102, 9468, 237, 121]
N: 🪿 [9468, 103, 123]

O: 🤝🏻 [9468, 97, 251, 9468, 237, 119]
N: 🚵🏻‍♂️ [9468, 248, 113, 9468, 237, 119, 102470, 17245, 224, 31643]

O: 🚵🏻‍♂️ [9468, 248, 113, 9468, 237, 119, 102470, 17245, 224, 31643]
N: 🏓 [9468, 237, 241]

O: ☃ [18107, 225]
N: ☃ [18107, 225]

O: 💁🏼‍♂️ [93273, 223, 9468, 237, 120, 102470, 17245, 224, 31643]
N: 💁🏼‍♂️ [93273, 223, 9468, 237, 120, 102470, 17245, 224, 31643]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:11,  3.96s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.47s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.14s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  2.67s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  3.24s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 2, 6, 7, 9):   1%|          | 1/100 [00:33<30:47, 18.66s/it]2025-01-22 05:13:47.361 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the hallway.
2025-01-22 05:13:47.362 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  travelled to the hallway.
2025-01-22 05:13:47.362 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary grabbed the milk.
2025-01-22 05:13:47.371 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1879, 1883) -->  Mary grabbed the milk
2025-01-22 05:13:47.371 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the kitchen.
2025-01-22 05:13:47.395 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4731, 4736) --> . Mary went to the
2025-01-22 05:13:47.395 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary put down the milk.
2025-01-22 05:13:47.423 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5621, 5626) --> . Mary put down the
2025-01-22 05:13:47.423 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel went to the garden.
2025-01-22 05:13:47.431 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1582, 1587) -->  back to the garden.
2025-01-22 05:13:47.431 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel put down the football there.
2025-01-22 05:13:47.436 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (983, 989) --> . Daniel put down the football
2025-01-22 05:13:47.436 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra left the apple.
2025-01-22 05:13:47.443 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1291, 1295) -->  Sandra left the apple
2025-01-22 05:13:47.443 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the garden.
2025-01-22 05:13:47.450 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1579, 1585) --> . Sandra went back to the
2025-01-22 05:13:47.451 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the kitchen.
2025-01-22 05:13:47.470 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3819, 3825) --> . Daniel journeyed to the
2025-01-22 05:13:47.470 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel took the football.
2025-01-22 05:13:47.491 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4303, 4307) -->  Daniel took the football
2025-01-22 05:13:47.492 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra picked up the apple.
2025-01-22 05:13:47.513 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (3856, 3861) --> . Sandra picked up the
2025-01-22 05:13:47.513 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Sandra moved to the hallway.
2025-01-22 05:13:47.545 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (6411, 6416) --> . Sandra moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:13:50.395 | INFO     | test_jbb_embedding:begin_test:693 - kitchen<|eot_id|>
2025-01-22 05:13:50.395 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8212])
2025-01-22 05:13:53.282 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [241.15625, 22.833117772367622, 195.93229166666666, 21.426456161863886, 13.884348958333334], 'topk_indices': array([6102, 3825, 8056, 8185, 8197, 1882,   29, 8186,   34, 8199, 8192,
       8191,   14, 4736, 8057,   24, 6416, 8207,    0, 8208]), 'topk_tokens': ['the', ' kitchen', ' you', 'Question', ' milk', ' milk', '\n\n', ':', ' hallway', ' discarded', ' to', ' prior', '\n', ' kitchen', ' context', '\n\n', ' hallway', '<|eot_id|>', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [338.4, 300.09375, 211.1, 204.575, 163.4]}, 'weight': {'score': [21.790690104166668, 23.28688945526476, 23.291666666666668, 23.291271650827714, 29.4], 'topk_indices': array([3303, 3330, 3223, 3175, 7478, 7440, 1435, 1497, 4312, 4328, 5153,
       5214, 7167, 7111, 3486, 3512, 4960, 4937, 4912, 4989]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.225, 27.935546875, 19.403125, 21.771875, 18.846875]}, 'saliency': {'score': [1.432891845703125, 0.12877945438508065, 1.2145589192708333, 0.12014833750862201, 0.10186482747395834], 'topk_indices': array([  38, 8101, 5626, 3834, 1880,   24, 3820, 6412, 3825, 1882,   31,
       8197, 8185, 1291, 8191, 8057, 4736, 8199,   34, 6416]), 'topk_tokens': ['***', ' location', ' milk', ' streets', ' grabbed', '\n\n', ' Daniel', ' Sandra', ' kitchen', ' milk', ' travelled', ' milk', 'Question', ' Sandra', ' prior', ' context', ' kitchen', ' discarded', ' hallway', ' hallway'], 'evidence_proportions': [2.0912109375, 2.1944580078125, 1.002490234375, 1.1375, 0.89111328125]}}, 'pred_res': 'kitchen<|eot_id|>', 'score': 0}
2025-01-22 05:13:53.289 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:13:53.290 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-53_pid-1_0-2-6-7-9.pkl | len: 3 |  size: 2.09 KB
Processing depth (0, 2, 6, 7, 9):   2%|▏         | 2/100 [00:39<32:29, 19.89s/it]is_0k: False
your chose emoji: ['🕵🏻\u200d♂', '🇦🇿', '👩🏽\u200d❤️\u200d💋\u200d👩🏼', '🈶', '🧎🏼\u200d➡', '👮', '📈', '👮🏾\u200d♀️', '🏄', '👩\u200d👦\u200d👦']
emoji:
O: 🕵🏻‍♂ [9468, 243, 113, 9468, 237, 119, 102470, 17245, 224]
N: 🕵🏻‍♂ [9468, 243, 113, 9468, 237, 119, 102470, 17245, 224]

O: 🇦🇿 [9468, 229, 99, 9468, 229, 123]
N: 🇦🇿 [9468, 229, 99, 9468, 229, 123]

O: 👩🏽‍❤️‍💋‍👩🏼 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 120]
N: 👮🏾‍♀️ [9468, 239, 106, 9468, 237, 122, 102470, 32990, 31643]

O: 🈶 [9468, 230, 114]
N: 🈶 [9468, 230, 114]

O: 🧎🏼‍➡ [9468, 100, 236, 9468, 237, 120, 102470, 98115, 94]
N: 🏄 [9468, 237, 226]

O: 👮 [9468, 239, 106]
N: 📈 [9468, 241, 230]

O: 📈 [9468, 241, 230]
N: 🧎🏼‍➡ [9468, 100, 236, 9468, 237, 120, 102470, 98115, 94]

O: 👮🏾‍♀️ [9468, 239, 106, 9468, 237, 122, 102470, 32990, 31643]
N: 👮 [9468, 239, 106]

O: 🏄 [9468, 237, 226]
N: 👩🏽‍❤️‍💋‍👩🏼 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 120]

O: 👩‍👦‍👦 [9468, 239, 102, 102470, 9468, 239, 99, 102470, 9468, 239, 99]
N: 👩‍👦‍👦 [9468, 239, 102, 102470, 9468, 239, 99, 102470, 9468, 239, 99]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.19s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.29s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.56s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.22s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.65s/it]
Processing depth (0, 3, 4, 7, 8):   2%|▏         | 2/100 [00:55<32:29, 19.89s/it]2025-01-22 05:14:09.828 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the hallway.
2025-01-22 05:14:09.828 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  travelled to the hallway.
2025-01-22 05:14:09.828 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary grabbed the milk.
2025-01-22 05:14:09.843 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2935, 2939) -->  Mary grabbed the milk
2025-01-22 05:14:09.843 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the kitchen.
2025-01-22 05:14:09.861 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3639, 3644) --> . Mary went to the
2025-01-22 05:14:09.861 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary put down the milk.
2025-01-22 05:14:09.892 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5643, 5648) --> . Mary put down the
2025-01-22 05:14:09.892 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel went to the garden.
2025-01-22 05:14:09.905 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1570, 1575) -->  back to the garden.
2025-01-22 05:14:09.906 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel put down the football there.
2025-01-22 05:14:09.912 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1045, 1051) --> . Daniel put down the football
2025-01-22 05:14:09.912 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra left the apple.
2025-01-22 05:14:09.919 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1279, 1283) -->  Sandra left the apple
2025-01-22 05:14:09.920 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the garden.
2025-01-22 05:14:09.929 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1567, 1573) --> . Sandra went back to the
2025-01-22 05:14:09.929 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the kitchen.
2025-01-22 05:14:09.948 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3839, 3845) --> . Daniel journeyed to the
2025-01-22 05:14:09.949 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel took the football.
2025-01-22 05:14:09.970 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4349, 4353) -->  Daniel took the football
2025-01-22 05:14:09.970 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra picked up the apple.
2025-01-22 05:14:09.991 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (3906, 3911) --> . Sandra picked up the
2025-01-22 05:14:09.991 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Sandra moved to the hallway.
2025-01-22 05:14:10.027 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (6433, 6438) --> . Sandra moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:14:10.821 | INFO     | test_jbb_embedding:begin_test:693 - kitchen<|eot_id|>
2025-01-22 05:14:10.821 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8202])
2025-01-22 05:14:13.059 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [335.8046875, 30.67370886654479, 222.20138888888889, 28.928080877839164, 16.520368303571427], 'topk_indices': array([8176,  166,   14, 2938, 8187,   35, 2939,   24,  165, 3644,   34,
       8182,   25,  181,  184, 8197, 6438,  185, 8198,    0]), 'topk_tokens': [':', 'E', '\n', ' milk', ' milk', '.', '.', '\n\n', 'ION', ' kitchen', ' hallway', ' to', '<|eot_id|>', 'G', ' P', '<|eot_id|>', ' hallway', 'ION', '<|start_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [457.85, 457.8125, 261.65, 332.2, 193.9125]}, 'weight': {'score': [21.790690104166668, 23.273209932967703, 23.291666666666668, 23.277496738796806, 29.03482142857143], 'topk_indices': array([3338, 3311, 3183, 3231, 7432, 7470, 1485, 1423, 4321, 4337, 5236,
       5175, 7153, 7209, 3494, 3520, 5029, 4977, 4952, 5000]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.225, 27.935546875, 19.403125, 21.771875, 18.846875]}, 'saliency': {'score': [2.0080464680989585, 0.17419970673369897, 1.4289822048611112, 0.1632501067084868, 0.11838487897600447], 'topk_indices': array([1050, 6434,  184,  165,  181, 3907, 5648, 8181, 2935, 2986, 2936,
       2938, 8175, 8187,   31, 1279, 3644,   34,  185, 6438]), 'topk_tokens': [' football', ' Sandra', ' P', 'ION', 'G', ' Sandra', ' milk', ' prior', ' Mary', 'lyn', ' grabbed', ' milk', 'Question', ' milk', ' travelled', ' Sandra', ' kitchen', ' hallway', 'ION', ' hallway'], 'evidence_proportions': [2.7732421875, 3.352783203125, 1.3248046875, 1.82822265625, 1.030126953125]}}, 'pred_res': 'kitchen<|eot_id|>', 'score': 0}
2025-01-22 05:14:13.065 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:14:13.066 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-53_pid-2_0-3-4-7-8.pkl | len: 3 |  size: 2.04 KB
Processing depth (0, 3, 4, 7, 8):   3%|▎         | 3/100 [00:59<32:04, 19.84s/it]is_0k: False
your chose emoji: ['🪙', '👳🏻', '👩🏿\u200d🦽', '👩🏾\u200d❤️\u200d💋\u200d👨🏿', '⛸', '🗂️', '🧞', '\U0001faf8🏼', '🛀🏾', '👩🏾\u200d🔧']
emoji:
O: 🪙 [9468, 103, 247]
N: 🧞 [9468, 100, 252]

O: 👳🏻 [9468, 239, 111, 9468, 237, 119]
N: 🛀🏾 [9468, 249, 222, 9468, 237, 122]

O: 👩🏿‍🦽 [9468, 239, 102, 9468, 237, 123, 102470, 9468, 99, 121]
N: 👩🏾‍❤️‍💋‍👨🏿 [9468, 239, 102, 9468, 237, 122, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 123]

O: 👩🏾‍❤️‍💋‍👨🏿 [9468, 239, 102, 9468, 237, 122, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 123]
N: 👳🏻 [9468, 239, 111, 9468, 237, 119]

O: ⛸ [158, 249, 116]
N: 🪙 [9468, 103, 247]

O: 🗂️ [9468, 245, 224, 31643]
N: 🫸🏼 [9468, 104, 116, 9468, 237, 120]

O: 🧞 [9468, 100, 252]
N: 👩🏿‍🦽 [9468, 239, 102, 9468, 237, 123, 102470, 9468, 99, 121]

O: 🫸🏼 [9468, 104, 116, 9468, 237, 120]
N: ⛸ [158, 249, 116]

O: 🛀🏾 [9468, 249, 222, 9468, 237, 122]
N: 🗂️ [9468, 245, 224, 31643]

O: 👩🏾‍🔧 [9468, 239, 102, 9468, 237, 122, 102470, 9468, 242, 100]
N: 👩🏾‍🔧 [9468, 239, 102, 9468, 237, 122, 102470, 9468, 242, 100]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:11,  3.80s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:07<00:07,  3.90s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:11<00:03,  3.67s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:11<00:00,  2.38s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:11<00:00,  2.89s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 4, 6, 7, 8):   3%|▎         | 3/100 [01:12<32:04, 19.84s/it]2025-01-22 05:14:26.382 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the hallway.
2025-01-22 05:14:26.383 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  travelled to the hallway.
2025-01-22 05:14:26.383 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary grabbed the milk.
2025-01-22 05:14:26.400 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3617, 3621) -->  Mary grabbed the milk
2025-01-22 05:14:26.400 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the kitchen.
2025-01-22 05:14:26.427 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4659, 4664) --> . Mary went to the
2025-01-22 05:14:26.428 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary put down the milk.
2025-01-22 05:14:26.455 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5631, 5636) --> . Mary put down the
2025-01-22 05:14:26.455 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel went to the garden.
2025-01-22 05:14:26.462 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1548, 1553) -->  back to the garden.
2025-01-22 05:14:26.463 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel put down the football there.
2025-01-22 05:14:26.468 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (985, 991) --> . Daniel put down the football
2025-01-22 05:14:26.468 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra left the apple.
2025-01-22 05:14:26.474 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1255, 1259) -->  Sandra left the apple
2025-01-22 05:14:26.474 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the garden.
2025-01-22 05:14:26.481 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1545, 1551) --> . Sandra went back to the
2025-01-22 05:14:26.482 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the kitchen.
2025-01-22 05:14:26.504 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3777, 3783) --> . Daniel journeyed to the
2025-01-22 05:14:26.504 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel took the football.
2025-01-22 05:14:26.525 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4278, 4282) -->  took the football.
2025-01-22 05:14:26.525 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra picked up the apple.
2025-01-22 05:14:26.543 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (3852, 3857) --> . Sandra picked up the
2025-01-22 05:14:26.543 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Sandra moved to the hallway.
2025-01-22 05:14:26.576 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (6421, 6426) --> . Sandra moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:14:29.659 | INFO     | test_jbb_embedding:begin_test:693 - kitchen<|eot_id|>
2025-01-22 05:14:29.660 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8212])
2025-01-22 05:14:32.602 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [295.8229166666667, 26.698885423006693, 240.99826388888889, 24.96084074187615, 19.82921875], 'topk_indices': array([8191,   31, 3620, 8185,   34,   29,   14,   25, 8186, 8199,   35,
       8057,   24, 1255, 8192,  185, 8207, 8208, 6426,    0]), 'topk_tokens': [' prior', ' travelled', ' milk', 'Question', ' hallway', '\n\n', '\n', '<|eot_id|>', ':', ' discarded', '.', ' context', '\n\n', ' Sandra', ' to', 'ION', '<|eot_id|>', '<|start_header_id|>', ' hallway', '<|begin_of_text|>'], 'evidence_proportions': [437.775, 377.40625, 212.85, 300.05, 167.35]}, 'weight': {'score': [21.790690104166668, 23.29414561777237, 22.612630208333332, 23.301578786020848, 29.797291666666666], 'topk_indices': array([3303, 3276, 3148, 3196, 7470, 7432, 1505, 1443, 4328, 4344, 5224,
       5163, 7209, 7153, 3459, 3485, 4940, 4988, 4965, 5017]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.225, 27.935546875, 19.403125, 21.771875, 18.846875]}, 'saliency': {'score': [1.7703857421875, 0.15220671622983872, 1.5211452907986112, 0.1414013103061772, 0.1504364013671875], 'topk_indices': array([3783, 8194, 1546, 5636, 8101, 3618, 3617, 6422, 4664, 8197, 8191,
       3620, 8057,   31,  185, 8185, 8199,   34, 1255, 6426]), 'topk_tokens': [' kitchen', ' place', ' Sandra', ' milk', ' location', ' grabbed', ' Mary', ' Sandra', ' kitchen', ' milk', ' prior', ' milk', ' context', ' travelled', 'ION', 'Question', ' discarded', ' hallway', ' Sandra', ' hallway'], 'evidence_proportions': [2.58564453125, 2.786376953125, 1.1021484375, 1.720703125, 0.86025390625]}}, 'pred_res': 'kitchen<|eot_id|>', 'score': 0}
2025-01-22 05:14:32.614 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:14:32.615 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-53_pid-3_0-4-6-7-8.pkl | len: 3 |  size: 2.09 KB
Processing depth (0, 4, 6, 7, 8):   4%|▍         | 4/100 [01:18<31:33, 19.72s/it]is_0k: False
your chose emoji: ['🤽🏾\u200d♂', '🏄\u200d♂️', '🤽🏾\u200d♀️', '🦆', '📃', '🙍🏽\u200d♂️', '🐮', '🏊🏾\u200d♂️', '🧒🏼', '👩🏼\u200d❤\u200d👩🏾']
emoji:
O: 🤽🏾‍♂ [9468, 97, 121, 9468, 237, 122, 102470, 17245, 224]
N: 🏊🏾‍♂️ [9468, 237, 232, 9468, 237, 122, 102470, 17245, 224, 31643]

O: 🏄‍♂️ [9468, 237, 226, 102470, 17245, 224, 31643]
N: 🦆 [9468, 99, 228]

O: 🤽🏾‍♀️ [9468, 97, 121, 9468, 237, 122, 102470, 32990, 31643]
N: 📃 [9468, 241, 225]

O: 🦆 [9468, 99, 228]
N: 🤽🏾‍♀️ [9468, 97, 121, 9468, 237, 122, 102470, 32990, 31643]

O: 📃 [9468, 241, 225]
N: 🐮 [9468, 238, 106]

O: 🙍🏽‍♂️ [9468, 247, 235, 9468, 237, 121, 102470, 17245, 224, 31643]
N: 🙍🏽‍♂️ [9468, 247, 235, 9468, 237, 121, 102470, 17245, 224, 31643]

O: 🐮 [9468, 238, 106]
N: 🤽🏾‍♂ [9468, 97, 121, 9468, 237, 122, 102470, 17245, 224]

O: 🏊🏾‍♂️ [9468, 237, 232, 9468, 237, 122, 102470, 17245, 224, 31643]
N: 🏄‍♂️ [9468, 237, 226, 102470, 17245, 224, 31643]

O: 🧒🏼 [9468, 100, 240, 9468, 237, 120]
N: 🧒🏼 [9468, 100, 240, 9468, 237, 120]

O: 👩🏼‍❤‍👩🏾 [9468, 239, 102, 9468, 237, 120, 102470, 121643, 102470, 9468, 239, 102, 9468, 237, 122]
N: 👩🏼‍❤‍👩🏾 [9468, 239, 102, 9468, 237, 120, 102470, 121643, 102470, 9468, 239, 102, 9468, 237, 122]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.88s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.72s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.25s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  2.92s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.51s/it]
Processing depth (0, 2, 5, 6, 7):   4%|▍         | 4/100 [01:34<31:33, 19.72s/it]2025-01-22 05:14:48.785 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the hallway.
2025-01-22 05:14:48.785 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  travelled to the hallway.
2025-01-22 05:14:48.785 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary grabbed the milk.
2025-01-22 05:14:48.794 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1746, 1750) -->  grabbed the milk.
2025-01-22 05:14:48.794 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went to the kitchen.
2025-01-22 05:14:48.815 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4076, 4081) --> . Mary went to the
2025-01-22 05:14:48.816 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary put down the milk.
2025-01-22 05:14:48.840 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4606, 4611) -->  Mary put down the milk
2025-01-22 05:14:48.840 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel went to the garden.
2025-01-22 05:14:48.848 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1534, 1539) -->  back to the garden.
2025-01-22 05:14:48.848 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel put down the football there.
2025-01-22 05:14:48.854 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (914, 920) -->  Daniel put down the football there
2025-01-22 05:14:48.854 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra left the apple.
2025-01-22 05:14:48.861 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1241, 1245) -->  Sandra left the apple
2025-01-22 05:14:48.861 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the garden.
2025-01-22 05:14:48.869 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1531, 1537) --> . Sandra went back to the
2025-01-22 05:14:48.869 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel journeyed to the kitchen.
2025-01-22 05:14:48.888 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3673, 3679) --> . Daniel journeyed to the
2025-01-22 05:14:48.888 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel took the football.
2025-01-22 05:14:48.909 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4191, 4195) -->  Daniel took the football
2025-01-22 05:14:48.909 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra picked up the apple.
2025-01-22 05:14:48.929 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (3796, 3801) --> . Sandra picked up the
2025-01-22 05:14:48.929 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Sandra moved to the hallway.
2025-01-22 05:14:48.961 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (6309, 6314) --> . Sandra moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:14:49.759 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 05:14:49.759 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8174])
2025-01-22 05:14:51.976 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [209.36458333333334, 20.894418032285678, 183.47222222222223, 19.616102778119995, 36.44032505580357], 'topk_indices': array([ 910,  918, 1740, 8147, 8019, 4081,   14, 8153, 1739, 8159, 8161,
       8148, 7487, 8169,  919, 8154,   24, 6314, 8170,    0]), 'topk_tokens': ['�', ' football', '�', 'Question', ' context', ' kitchen', '\n', ' prior', '�', ' milk', ' discarded', ':', 'nes', '<|eot_id|>', ' there', ' to', '\n\n', ' hallway', '<|start_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [286.0, 289.6875, 143.475, 243.625, 100.1]}, 'weight': {'score': [21.775065104166668, 23.2552127919775, 23.71462673611111, 23.257551666256006, 29.161272321428573], 'topk_indices': array([3338, 3311, 3183, 3231, 7386, 7424, 1491, 1429, 4348, 4332, 5210,
       5149, 7107, 7163, 3494, 3520, 4974, 4926, 4951, 5003]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.225, 22.15234375, 19.403125, 26.3234375, 18.846875]}, 'saliency': {'score': [1.2243855794270833, 0.11850055080179162, 1.1573045518663194, 0.11062347987345232, 0.265178952898298], 'topk_indices': array([ 910, 1748, 1746,   24,  919, 7532, 8019,   31, 7531,  918, 7487,
       8159, 8153, 4081,   34, 8147, 1241, 1739, 8161, 6314]), 'topk_tokens': ['�', ' milk', ' grabbed', '\n\n', ' there', 'nes', ' context', ' travelled', ' Min', ' football', 'nes', ' milk', ' prior', ' kitchen', ' hallway', 'Question', ' Sandra', '�', ' discarded', ' hallway'], 'evidence_proportions': [1.7333984375, 1.6947021484375, 0.708154296875, 1.56943359375, 0.510302734375]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 0}
2025-01-22 05:14:51.982 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:14:51.982 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-53_pid-4_0-2-5-6-7.pkl | len: 3 |  size: 2.08 KB
Processing depth (0, 2, 5, 6, 7):   5%|▌         | 5/100 [01:38<31:01, 19.60s/it]Processing depth (0, 2, 5, 6, 7):   5%|▌         | 5/100 [01:38<31:05, 19.63s/it]
2025-01-22 05:14:52.046 | INFO     | __main__:<module>:82 - Selected idx: 54
2025-01-22 05:14:52.046 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the apple before the bedroom? 
2025-01-22 05:14:52.046 | INFO     | __main__:<module>:84 - Answer: office
2025-01-22 05:14:52.046 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 05:14:52.046 | INFO     | __main__:<module>:86 - Needle: [' Sandra went back to the garden.', ' Daniel picked up the apple.', ' Sandra went back to the bathroom.', ' Daniel moved to the office.', ' Sandra moved to the hallway.', ' Mary went back to the hallway.', ' John went back to the hallway.', ' Daniel went back to the bedroom.', ' John went to the garden.']
2025-01-22 05:14:52.046 | INFO     | __main__:<module>:87 - Real Needle: [' Daniel picked up the apple.', ' Daniel moved to the office.', ' Daniel went back to the bedroom.', ' John went to the garden.']
2025-01-22 05:14:52.046 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['⛺', '🙍🏼', '🚒', '↪️', '⏳', '🕊', '🚶🏻\u200d➡️', '🍈', '🕵🏽', '👩🏽\u200d❤️\u200d👩🏽']
emoji:
O: ⛺ [158, 249, 118]
N: 🚒 [9468, 248, 240]

O: 🙍🏼 [9468, 247, 235, 9468, 237, 120]
N: ⏳ [158, 237, 111]

O: 🚒 [9468, 248, 240]
N: ↪️ [27017, 103, 31643]

O: ↪️ [27017, 103, 31643]
N: ⛺ [158, 249, 118]

O: ⏳ [158, 237, 111]
N: 🕵🏽 [9468, 243, 113, 9468, 237, 121]

O: 🕊 [9468, 243, 232]
N: 🚶🏻‍➡️ [9468, 248, 114, 9468, 237, 119, 102470, 98115, 94, 31643]

O: 🚶🏻‍➡️ [9468, 248, 114, 9468, 237, 119, 102470, 98115, 94, 31643]
N: 🙍🏼 [9468, 247, 235, 9468, 237, 120]

O: 🍈 [9468, 235, 230]
N: 🕊 [9468, 243, 232]

O: 🕵🏽 [9468, 243, 113, 9468, 237, 121]
N: 🍈 [9468, 235, 230]

O: 👩🏽‍❤️‍👩🏽 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 31643, 102470, 9468, 239, 102, 9468, 237, 121]
N: 👩🏽‍❤️‍👩🏽 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 31643, 102470, 9468, 239, 102, 9468, 237, 121]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.28s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.69s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.41s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.06s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.58s/it]
Processing depth (0, 1, 5, 7):   0%|          | 0/100 [00:15<?, ?it/s]2025-01-22 05:15:08.063 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the apple.
2025-01-22 05:15:08.063 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the apple.
2025-01-22 05:15:08.063 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the office.
2025-01-22 05:15:08.067 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (821, 826) --> . Daniel moved to the
2025-01-22 05:15:08.068 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the bedroom.
2025-01-22 05:15:08.091 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4195, 4201) -->  Daniel went back to the bedroom
2025-01-22 05:15:08.091 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the garden.
2025-01-22 05:15:08.122 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5544, 5549) -->  back to the garden.
2025-01-22 05:15:08.123 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went back to the garden.
2025-01-22 05:15:08.141 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3441, 3447) --> . Sandra went back to the
2025-01-22 05:15:08.141 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the bathroom.
2025-01-22 05:15:08.158 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3441, 3447) --> . Sandra went back to the
2025-01-22 05:15:08.159 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the hallway.
2025-01-22 05:15:08.163 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (921, 926) --> . Sandra moved to the
2025-01-22 05:15:08.163 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary went back to the hallway.
2025-01-22 05:15:08.199 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6642, 6648) --> . Mary went back to the
2025-01-22 05:15:08.199 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went back to the hallway.
2025-01-22 05:15:08.234 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6643, 6649) -->  Mary went back to the hallway
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:15:09.023 | INFO     | test_jbb_embedding:begin_test:693 - the office<|eot_id|>
2025-01-22 05:15:09.023 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8174])
2025-01-22 05:15:11.242 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [220.95833333333334, 25.60295376712329, 58.88577586206897, 24.979317930100912, 28.239243236940297], 'topk_indices': array([8164, 8155,   25, 8168,   35,    9, 8072, 1731,   23, 8161, 1653,
       8062,   24, 8162,    1, 8172,   14, 8170,    0, 8169]), 'topk_tokens': [' bedroom', '.\n\n', '<|eot_id|>', ':', '.', ':', ' location', "'s", '4', ' apple', ' work', '.\n\n', '\n\n', ' before', '<|start_header_id|>', '<|end_header_id|>', '\n', '<|start_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [400.7, 261.2, 188.65625, 39.7375]}, 'weight': {'score': [21.756324404761905, 23.275635243395303, 22.297144396551722, 23.283053624169334, 29.53078358208955], 'topk_indices': array([3284, 3257, 3177, 3129, 7459, 7421, 1431, 1493, 4300, 4284, 5123,
       5184, 7142, 7198, 3465, 3491, 4977, 4900, 4925, 4948]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.08125, 19.909375, 25.44921875, 18.846875]}, 'saliency': {'score': [1.1827276320684523, 0.14089344718918176, 0.3354765793372845, 0.13750661126563268, 0.20390023758162312], 'topk_indices': array([ 828,   14, 1730,   23,   20, 1731, 8028,    8, 8143,   69, 8156,
       8062, 8158,   24, 8167, 1653, 8072, 8161, 8164, 8162]), 'topk_tokens': ['�', '\n', ' summer', '4', ' Jul', "'s", ' context', ' Date', ' return', 'ISC', 'Question', '.\n\n', ' Where', '\n\n', 'Answer', ' work', ' location', ' apple', ' bedroom', ' before'], 'evidence_proportions': [2.0361328125, 1.269677734375, 1.2139485677083333, 0.2049072265625]}}, 'pred_res': 'the office<|eot_id|>', 'score': 100}
2025-01-22 05:15:11.248 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:15:11.249 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-54_pid-0_0-1-5-7.pkl | len: 3 |  size: 2.0 KB
Processing depth (0, 1, 5, 7):   1%|          | 1/100 [00:19<31:32, 19.11s/it]is_0k: False
your chose emoji: ['💚', '🙎🏽\u200d♀️', '🐄', '🏳️\u200d⚧', '🧎🏽\u200d♂️\u200d➡', '⬅️', '👼🏻', '👩🏼\u200d🍳', '👌🏽', '🇨🇽']
emoji:
O: 💚 [93273, 248]
N: 🐄 [9468, 238, 226]

O: 🙎🏽‍♀️ [9468, 247, 236, 9468, 237, 121, 102470, 32990, 31643]
N: ⬅️ [158, 105, 227, 31643]

O: 🐄 [9468, 238, 226]
N: 🙎🏽‍♀️ [9468, 247, 236, 9468, 237, 121, 102470, 32990, 31643]

O: 🏳️‍⚧ [9468, 237, 111, 31643, 102470, 158, 248, 100]
N: 💚 [93273, 248]

O: 🧎🏽‍♂️‍➡ [9468, 100, 236, 9468, 237, 121, 102470, 17245, 224, 31643, 102470, 98115, 94]
N: 👼🏻 [9468, 239, 120, 9468, 237, 119]

O: ⬅️ [158, 105, 227, 31643]
N: 👌🏽 [9468, 239, 234, 9468, 237, 121]

O: 👼🏻 [9468, 239, 120, 9468, 237, 119]
N: 🏳️‍⚧ [9468, 237, 111, 31643, 102470, 158, 248, 100]

O: 👩🏼‍🍳 [9468, 239, 102, 9468, 237, 120, 102470, 9468, 235, 111]
N: 👩🏼‍🍳 [9468, 239, 102, 9468, 237, 120, 102470, 9468, 235, 111]

O: 👌🏽 [9468, 239, 234, 9468, 237, 121]
N: 🧎🏽‍♂️‍➡ [9468, 100, 236, 9468, 237, 121, 102470, 17245, 224, 31643, 102470, 98115, 94]

O: 🇨🇽 [9468, 229, 101, 9468, 229, 121]
N: 🇨🇽 [9468, 229, 101, 9468, 229, 121]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.07s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.17s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.02s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  2.63s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  3.16s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 1, 2, 6):   1%|          | 1/100 [00:33<31:32, 19.11s/it]2025-01-22 05:15:25.694 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the apple.
2025-01-22 05:15:25.694 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the apple.
2025-01-22 05:15:25.694 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the office.
2025-01-22 05:15:25.699 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (781, 786) --> . Daniel moved to the
2025-01-22 05:15:25.699 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the bedroom.
2025-01-22 05:15:25.709 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1805, 1811) --> . Daniel went back to the
2025-01-22 05:15:25.709 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the garden.
2025-01-22 05:15:25.736 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4730, 4735) -->  John went to the garden
2025-01-22 05:15:25.736 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went back to the garden.
2025-01-22 05:15:25.757 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3452, 3458) --> . Sandra went back to the
2025-01-22 05:15:25.757 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the bathroom.
2025-01-22 05:15:25.775 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3452, 3458) --> . Sandra went back to the
2025-01-22 05:15:25.775 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the hallway.
2025-01-22 05:15:25.780 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (931, 936) --> . Sandra moved to the
2025-01-22 05:15:25.780 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary went back to the hallway.
2025-01-22 05:15:25.830 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6658, 6664) --> . Mary went back to the
2025-01-22 05:15:25.830 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went back to the hallway.
2025-01-22 05:15:25.872 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6659, 6665) -->  Mary went back to the hallway
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:15:28.638 | INFO     | test_jbb_embedding:begin_test:693 - The office.<|eot_id|>
2025-01-22 05:15:28.639 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8170])
2025-01-22 05:15:31.432 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [239.203125, 32.00749892927068, 44.40032327586207, 31.427530934498893, 14.617548076923077], 'topk_indices': array([ 525,   24, 8158,   14, 8168, 4370,  352,  459,    1,  458, 7358,
        535, 8166, 4371,  421,  537,  422,    0,  538, 8165]), 'topk_tokens': [',\n', '\n\n', ' before', '\n', '<|end_header_id|>', 'nes', ' of', ' of', '<|start_header_id|>', ' instead', 'nes', ' an', '<|start_header_id|>', 'ot', ' instead', ',', ' of', '<|begin_of_text|>', ' instead', '<|eot_id|>'], 'evidence_proportions': [436.85, 274.175, 219.41666666666666, 30.328125]}, 'weight': {'score': [21.48921130952381, 23.266416574889867, 22.297144396551722, 23.274472497537552, 29.14375], 'topk_indices': array([3286, 3313, 3206, 3158, 7405, 7443, 1441, 1503, 4296, 4312, 5139,
       5200, 7182, 7126, 3480, 3506, 4916, 4964, 4941, 4993]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.08125, 19.909375, 20.927083333333332, 23.1515625]}, 'saliency': {'score': [1.2150355747767858, 0.17734190370892988, 0.25016521585398704, 0.1743988548115362, 0.10720543494591346], 'topk_indices': array([8163, 8157,  419,  379, 7309,    0,  351, 7357, 7280, 8158,  422,
       8160,  380,  535, 4370, 7358, 4371,  458,  421,  538]), 'topk_tokens': ['Answer', ' apple', ' hour', ' latter', 'nes', '<|begin_of_text|>', ' half', ' Min', 'nes', ' before', ' of', ' bedroom', ' half', ' an', 'nes', 'nes', 'ot', ' instead', ' instead', ' instead'], 'evidence_proportions': [2.24462890625, 1.3486328125, 1.1090494791666667, 0.1790283203125]}}, 'pred_res': 'The office.<|eot_id|>', 'score': 100}
2025-01-22 05:15:31.439 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:15:31.439 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-54_pid-1_0-1-2-6.pkl | len: 3 |  size: 2.02 KB
Processing depth (0, 1, 2, 6):   2%|▏         | 2/100 [00:39<32:15, 19.75s/it]is_0k: False
your chose emoji: ['🧑🏾\u200d🍳', '🍗', '🚷', '🚶🏽\u200d➡️', '🇳🇪', '⛹🏼\u200d♀️', '😥', '👩🏼\u200d💼', '👨🏾\u200d🔧', '🔁']
emoji:
O: 🧑🏾‍🍳 [9468, 100, 239, 9468, 237, 122, 102470, 9468, 235, 111]
N: 👩🏼‍💼 [9468, 239, 102, 9468, 237, 120, 102470, 93273, 120]

O: 🍗 [9468, 235, 245]
N: 🍗 [9468, 235, 245]

O: 🚷 [9468, 248, 115]
N: 🇳🇪 [9468, 229, 111, 9468, 229, 103]

O: 🚶🏽‍➡️ [9468, 248, 114, 9468, 237, 121, 102470, 98115, 94, 31643]
N: 😥 [76460, 98]

O: 🇳🇪 [9468, 229, 111, 9468, 229, 103]
N: 🚶🏽‍➡️ [9468, 248, 114, 9468, 237, 121, 102470, 98115, 94, 31643]

O: ⛹🏼‍♀️ [158, 249, 117, 9468, 237, 120, 102470, 32990, 31643]
N: 🧑🏾‍🍳 [9468, 100, 239, 9468, 237, 122, 102470, 9468, 235, 111]

O: 😥 [76460, 98]
N: 🚷 [9468, 248, 115]

O: 👩🏼‍💼 [9468, 239, 102, 9468, 237, 120, 102470, 93273, 120]
N: 👨🏾‍🔧 [9468, 239, 101, 9468, 237, 122, 102470, 9468, 242, 100]

O: 👨🏾‍🔧 [9468, 239, 101, 9468, 237, 122, 102470, 9468, 242, 100]
N: ⛹🏼‍♀️ [158, 249, 117, 9468, 237, 120, 102470, 32990, 31643]

O: 🔁 [9468, 242, 223]
N: 🔁 [9468, 242, 223]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.37s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.28s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.14s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.91s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.40s/it]
Processing depth (1, 2, 5, 9):   2%|▏         | 2/100 [00:54<32:15, 19.75s/it]2025-01-22 05:15:46.699 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the apple.
2025-01-22 05:15:46.705 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (822, 827) -->  Daniel picked up the apple
2025-01-22 05:15:46.705 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the office.
2025-01-22 05:15:46.721 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1859, 1864) --> . Daniel moved to the
2025-01-22 05:15:46.721 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the bedroom.
2025-01-22 05:15:46.742 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4231, 4237) -->  Daniel went back to the bedroom
2025-01-22 05:15:46.743 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the garden.
2025-01-22 05:15:46.770 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5622, 5627) -->  back to the garden.
2025-01-22 05:15:46.770 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went back to the garden.
2025-01-22 05:15:46.789 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3519, 3525) --> . Sandra went back to the
2025-01-22 05:15:46.789 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the bathroom.
2025-01-22 05:15:46.809 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3519, 3525) --> . Sandra went back to the
2025-01-22 05:15:46.809 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the hallway.
2025-01-22 05:15:46.814 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (977, 982) --> . Sandra moved to the
2025-01-22 05:15:46.814 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary went back to the hallway.
2025-01-22 05:15:46.847 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6676, 6682) --> . Mary went back to the
2025-01-22 05:15:46.847 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went back to the hallway.
2025-01-22 05:15:46.884 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6677, 6683) -->  Mary went back to the hallway
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:15:47.707 | INFO     | test_jbb_embedding:begin_test:693 - The hallway.<|eot_id|>
2025-01-22 05:15:47.707 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8202])
2025-01-22 05:15:49.967 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [415.8809523809524, 32.59640114578254, 188.64008620689654, 31.054306168751534, 36.810209297839506], 'topk_indices': array([  23, 1864, 8189,    9,  810,  823, 8201,  822, 8192,  981,   24,
       8200,  827,   14, 8190,  826,  982, 8198, 8197,    0]), 'topk_tokens': ['4', ' office', ' apple', ':', '�', ' picked', '\n\n', ' Daniel', ' bedroom', ' the', '\n\n', '<|end_header_id|>', '.', '\n', ' before', ' apple', ' hallway', '<|start_header_id|>', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [814.4, 542.05, 278.8333333333333, 55.65]}, 'weight': {'score': [22.920386904761905, 23.285539066309116, 22.297144396551722, 23.289994749509443, 28.961612654320987], 'topk_indices': array([3255, 3282, 3127, 3175, 7479, 7441, 1423, 1485, 4300, 4284, 5131,
       5192, 7218, 7162, 3438, 3464, 4956, 4933, 4908, 4985]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.9703125, 19.909375, 25.44921875, 18.846875]}, 'saliency': {'score': [2.5716552734375, 0.18148284421090322, 1.0455238079202587, 0.172254145540149, 0.26760110737364967], 'topk_indices': array([8171, 8184, 4236,  979,   24, 1861, 8195,  257, 8186, 8056, 1864,
       8189,  978,  823, 8190,  810,  822, 8192,  826,  982]), 'topk_tokens': [' return', 'Question', ' bedroom', ' moved', '\n\n', ' moved', 'Answer', 'hue', ' Where', ' context', ' office', ' apple', ' Sandra', ' picked', ' before', '�', ' Daniel', ' bedroom', ' apple', ' hallway'], 'evidence_proportions': [5.72578125, 2.651953125, 1.7861328125, 0.2798583984375]}}, 'pred_res': 'The hallway.<|eot_id|>', 'score': 0}
2025-01-22 05:15:49.971 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:15:49.972 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-54_pid-2_1-2-5-9.pkl | len: 3 |  size: 2.02 KB
Processing depth (1, 2, 5, 9):   3%|▎         | 3/100 [00:57<31:01, 19.19s/it]is_0k: False
your chose emoji: ['👨🏾\u200d⚕️', '👩🏿\u200d🏫', '👩🏿\u200d💼', '🧑🏼\u200d🔬', '👩\u200d🦼', '🧎🏽\u200d♂', '🌯', '\U0001faf0🏻', '🙅🏻', '🧑🏾\u200d🔬']
emoji:
O: 👨🏾‍⚕️ [9468, 239, 101, 9468, 237, 122, 102470, 158, 248, 243, 31643]
N: 🙅🏻 [9468, 247, 227, 9468, 237, 119]

O: 👩🏿‍🏫 [9468, 239, 102, 9468, 237, 123, 102470, 9468, 237, 104]
N: 👨🏾‍⚕️ [9468, 239, 101, 9468, 237, 122, 102470, 158, 248, 243, 31643]

O: 👩🏿‍💼 [9468, 239, 102, 9468, 237, 123, 102470, 93273, 120]
N: 👩‍🦼 [9468, 239, 102, 102470, 9468, 99, 120]

O: 🧑🏼‍🔬 [9468, 100, 239, 9468, 237, 120, 102470, 9468, 242, 105]
N: 🧎🏽‍♂ [9468, 100, 236, 9468, 237, 121, 102470, 17245, 224]

O: 👩‍🦼 [9468, 239, 102, 102470, 9468, 99, 120]
N: 👩🏿‍💼 [9468, 239, 102, 9468, 237, 123, 102470, 93273, 120]

O: 🧎🏽‍♂ [9468, 100, 236, 9468, 237, 121, 102470, 17245, 224]
N: 👩🏿‍🏫 [9468, 239, 102, 9468, 237, 123, 102470, 9468, 237, 104]

O: 🌯 [9468, 234, 107]
N: 🌯 [9468, 234, 107]

O: 🫰🏻 [9468, 104, 108, 9468, 237, 119]
N: 🧑🏼‍🔬 [9468, 100, 239, 9468, 237, 120, 102470, 9468, 242, 105]

O: 🙅🏻 [9468, 247, 227, 9468, 237, 119]
N: 🫰🏻 [9468, 104, 108, 9468, 237, 119]

O: 🧑🏾‍🔬 [9468, 100, 239, 9468, 237, 122, 102470, 9468, 242, 105]
N: 🧑🏾‍🔬 [9468, 100, 239, 9468, 237, 122, 102470, 9468, 242, 105]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:11,  3.95s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.22s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:11<00:03,  3.76s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  2.50s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  3.03s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (1, 2, 3, 8):   3%|▎         | 3/100 [01:11<31:01, 19.19s/it]2025-01-22 05:16:04.096 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the apple.
2025-01-22 05:16:04.101 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (895, 900) --> . Daniel picked up the
2025-01-22 05:16:04.102 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the office.
2025-01-22 05:16:04.116 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2010, 2015) -->  cable. Daniel moved to
2025-01-22 05:16:04.116 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the bedroom.
2025-01-22 05:16:04.138 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2978, 2984) -->  tragedy. Daniel went back to
2025-01-22 05:16:04.138 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the garden.
2025-01-22 05:16:04.169 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5654, 5659) -->  back to the garden.
2025-01-22 05:16:04.169 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went back to the garden.
2025-01-22 05:16:04.189 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3526, 3532) --> . Sandra went back to the
2025-01-22 05:16:04.189 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the bathroom.
2025-01-22 05:16:04.209 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3526, 3532) --> . Sandra went back to the
2025-01-22 05:16:04.209 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the hallway.
2025-01-22 05:16:04.215 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1045, 1050) --> . Sandra moved to the
2025-01-22 05:16:04.215 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary went back to the hallway.
2025-01-22 05:16:04.252 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6710, 6716) --> . Mary went back to the
2025-01-22 05:16:04.252 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went back to the hallway.
2025-01-22 05:16:04.291 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6711, 6717) -->  Mary went back to the hallway
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:16:10.790 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's hand.<|eot_id|>
2025-01-22 05:16:10.790 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8236])
2025-01-22 05:16:13.990 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [470.59747023809524, 38.74451095532896, 147.12553879310346, 37.25306469833903, 18.930245535714285], 'topk_indices': array([1050, 8133, 8124, 8235,  898,  257,   14,    1,   24,  895,  899,
       8134,  897,  896, 8234,  901, 8232, 8231,  900,    0]), 'topk_tokens': [' hallway', ' first', '.\n\n', '\n\n', ' up', 'hue', '\n', '<|start_header_id|>', '\n\n', '.', ' the', ' location', ' picked', ' Daniel', '<|end_header_id|>', '.', '<|start_header_id|>', '<|eot_id|>', ' apple', '<|begin_of_text|>'], 'evidence_proportions': [1340.0, 331.30625, 165.65885416666666, 106.4125]}, 'weight': {'score': [22.968005952380953, 23.328919716557415, 22.297144396551722, 23.33349967177577, 29.800223214285715], 'topk_indices': array([3262, 3289, 3182, 3134, 7399, 7437, 1473, 1411, 4298, 4314, 5135,
       5196, 7120, 7176, 3445, 3471, 4989, 4912, 4960, 4937]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.3625, 24.3359375, 25.766927083333332, 18.846875]}, 'saliency': {'score': [2.6878255208333335, 0.2154905833674739, 0.8408897662984913, 0.20693469548376817, 0.14666989384865275], 'topk_indices': array([   8,  901, 8224, 1047,    0, 8130, 8090, 2985, 8133, 2016,   24,
        898, 8226, 1046, 1050,  257, 8134,  897,  896,  900]), 'topk_tokens': [' Date', '.', ' before', ' moved', '<|begin_of_text|>', ' item', ' context', ' bedroom', ' first', ' office', '\n\n', ' up', ' bedroom', ' Sandra', ' hallway', 'hue', ' location', ' picked', ' Daniel', ' apple'], 'evidence_proportions': [7.6265625, 1.9326171875, 0.9442545572916666, 0.59658203125]}}, 'pred_res': "Daniel's hand.<|eot_id|>", 'score': 0}
2025-01-22 05:16:14.000 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:16:14.000 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-54_pid-3_1-2-3-8.pkl | len: 3 |  size: 2.04 KB
Processing depth (1, 2, 3, 8):   4%|▍         | 4/100 [01:21<33:45, 21.10s/it]is_0k: False
your chose emoji: ['👩🏿\u200d❤\u200d👩🏽', '👨🏾\u200d⚖', '⛱', '🧑🏻\u200d🏫', '👩🏼\u200d❤️\u200d💋\u200d👩🏿', '🙋\u200d♀️', '🖐🏼', '🧔🏻\u200d♀', '👩🏿\u200d❤\u200d👨🏾', '🧎\u200d♀️']
emoji:
O: 👩🏿‍❤‍👩🏽 [9468, 239, 102, 9468, 237, 123, 102470, 121643, 102470, 9468, 239, 102, 9468, 237, 121]
N: 🖐🏼 [9468, 244, 238, 9468, 237, 120]

O: 👨🏾‍⚖ [9468, 239, 101, 9468, 237, 122, 102470, 158, 248, 244]
N: 👩🏿‍❤‍👩🏽 [9468, 239, 102, 9468, 237, 123, 102470, 121643, 102470, 9468, 239, 102, 9468, 237, 121]

O: ⛱ [158, 249, 109]
N: 👨🏾‍⚖ [9468, 239, 101, 9468, 237, 122, 102470, 158, 248, 244]

O: 🧑🏻‍🏫 [9468, 100, 239, 9468, 237, 119, 102470, 9468, 237, 104]
N: 🧑🏻‍🏫 [9468, 100, 239, 9468, 237, 119, 102470, 9468, 237, 104]

O: 👩🏼‍❤️‍💋‍👩🏿 [9468, 239, 102, 9468, 237, 120, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 123]
N: ⛱ [158, 249, 109]

O: 🙋‍♀️ [9468, 247, 233, 102470, 32990, 31643]
N: 🙋‍♀️ [9468, 247, 233, 102470, 32990, 31643]

O: 🖐🏼 [9468, 244, 238, 9468, 237, 120]
N: 🧔🏻‍♀ [9468, 100, 242, 9468, 237, 119, 102470, 32990]

O: 🧔🏻‍♀ [9468, 100, 242, 9468, 237, 119, 102470, 32990]
N: 👩🏿‍❤‍👨🏾 [9468, 239, 102, 9468, 237, 123, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 122]

O: 👩🏿‍❤‍👨🏾 [9468, 239, 102, 9468, 237, 123, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 122]
N: 👩🏼‍❤️‍💋‍👩🏿 [9468, 239, 102, 9468, 237, 120, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 123]

O: 🧎‍♀️ [9468, 100, 236, 102470, 32990, 31643]
N: 🧎‍♀️ [9468, 100, 236, 102470, 32990, 31643]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.40s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.45s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.45s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.09s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.59s/it]
Processing depth (0, 1, 6, 7):   4%|▍         | 4/100 [01:37<33:45, 21.10s/it]2025-01-22 05:16:30.023 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel picked up the apple.
2025-01-22 05:16:30.024 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the apple.
2025-01-22 05:16:30.024 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the office.
2025-01-22 05:16:30.029 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (901, 906) --> . Daniel moved to the
2025-01-22 05:16:30.030 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the bedroom.
2025-01-22 05:16:30.054 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4750, 4756) -->  the senate. Daniel went back
2025-01-22 05:16:30.055 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the garden.
2025-01-22 05:16:30.097 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5620, 5625) -->  back to the garden.
2025-01-22 05:16:30.098 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went back to the garden.
2025-01-22 05:16:30.115 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3487, 3493) --> . Sandra went back to the
2025-01-22 05:16:30.115 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the bathroom.
2025-01-22 05:16:30.132 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3487, 3493) --> . Sandra went back to the
2025-01-22 05:16:30.132 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the hallway.
2025-01-22 05:16:30.137 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1051, 1056) --> . Sandra moved to the
2025-01-22 05:16:30.138 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary went back to the hallway.
2025-01-22 05:16:30.175 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6754, 6760) --> . Mary went back to the
2025-01-22 05:16:30.175 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went back to the hallway.
2025-01-22 05:16:30.211 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6755, 6761) -->  Mary went back to the hallway
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:16:30.975 | INFO     | test_jbb_embedding:begin_test:693 - the office<|eot_id|>
2025-01-22 05:16:30.976 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8176])
2025-01-22 05:16:33.195 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [213.48958333333334, 21.96441672780631, 62.77667025862069, 21.323965958722933, 14.188404756433824], 'topk_indices': array([  35, 8163, 8170, 8157,   23, 8167, 4759,   66, 8166,   24, 8174,
         14,    1, 8164,   67,  105,   68, 8172,    0, 8171]), 'topk_tokens': ['.', ' apple', ':', '.\n\n', '4', '?', '.', ' P', ' bedroom', '\n\n', '<|end_header_id|>', '\n', '<|start_header_id|>', ' before', 'ION', 'ION', 'E', '<|start_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [403.35, 287.7, 129.53125, 50.16875]}, 'weight': {'score': [21.590029761904763, 23.282430759354366, 22.297144396551722, 23.29031876691683, 29.847426470588236], 'topk_indices': array([3269, 3296, 3141, 3189, 7409, 7447, 1417, 1479, 4279, 4295, 5162,
       5101, 7186, 7130, 3452, 3478, 4878, 4955, 4903, 4926]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.08125, 19.909375, 24.8671875, 18.846875]}, 'saliency': {'score': [1.1016177222842263, 0.12077997645646094, 0.35362191035829743, 0.11741506396316168, 0.10724662331973805], 'topk_indices': array([  69, 8161, 8145, 8157,   23,   24, 8167, 8030, 8158, 8169,    0,
         66, 8160, 4758, 8163, 8166,   68,   67, 8164,  105]), 'topk_tokens': ['ER', ' was', ' return', '.\n\n', '4', '\n\n', '?', ' context', 'Question', 'Answer', '<|begin_of_text|>', ' P', ' Where', ' bedroom', ' apple', ' bedroom', 'E', 'ION', ' before', 'ION'], 'evidence_proportions': [2.0849609375, 1.364892578125, 0.7556966145833334, 0.27010498046875]}}, 'pred_res': 'the office<|eot_id|>', 'score': 100}
2025-01-22 05:16:33.215 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:16:33.216 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-54_pid-4_0-1-6-7.pkl | len: 3 |  size: 1.98 KB
Processing depth (0, 1, 6, 7):   5%|▌         | 5/100 [01:41<32:20, 20.42s/it]Processing depth (0, 1, 6, 7):   5%|▌         | 5/100 [01:41<32:01, 20.23s/it]
2025-01-22 05:16:33.291 | INFO     | __main__:<module>:82 - Selected idx: 55
2025-01-22 05:16:33.291 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the location prior to the place where the apple was discarded, left or dropped?
2025-01-22 05:16:33.291 | INFO     | __main__:<module>:84 - Answer: office
2025-01-22 05:16:33.292 | INFO     | __main__:<module>:85 - Tag: 4-hop
2025-01-22 05:16:33.292 | INFO     | __main__:<module>:86 - Needle: [' Daniel moved to the office.', ' Sandra moved to the hallway.', ' Daniel picked up the apple.', ' Mary went back to the hallway.', ' John went back to the hallway.', ' Sandra went back to the bathroom.', ' Daniel went back to the bedroom.', ' Sandra went back to the garden.', ' Daniel discarded the apple.', ' John went to the garden.']
2025-01-22 05:16:33.292 | INFO     | __main__:<module>:87 - Real Needle: [' Daniel moved to the office.', ' Daniel picked up the apple.', ' Daniel went back to the bedroom.', ' Daniel discarded the apple.', ' John went to the garden.']
2025-01-22 05:16:33.292 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['💇🏿\u200d♀', '🤽🏾\u200d♂️', '🤟', '🤾\u200d♂', '👱', '☎', '👨🏻\u200d❤️\u200d💋\u200d👨🏽', '🚶\u200d♀️', '😲', '🧑🏾\u200d⚕']
emoji:
O: 💇🏿‍♀ [93273, 229, 9468, 237, 123, 102470, 32990]
N: 🚶‍♀️ [9468, 248, 114, 102470, 32990, 31643]

O: 🤽🏾‍♂️ [9468, 97, 121, 9468, 237, 122, 102470, 17245, 224, 31643]
N: 💇🏿‍♀ [93273, 229, 9468, 237, 123, 102470, 32990]

O: 🤟 [9468, 97, 253]
N: 😲 [76460, 110]

O: 🤾‍♂ [9468, 97, 122, 102470, 17245, 224]
N: 🤽🏾‍♂️ [9468, 97, 121, 9468, 237, 122, 102470, 17245, 224, 31643]

O: 👱 [9468, 239, 109]
N: ☎ [18107, 236]

O: ☎ [18107, 236]
N: 👨🏻‍❤️‍💋‍👨🏽 [9468, 239, 101, 9468, 237, 119, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 121]

O: 👨🏻‍❤️‍💋‍👨🏽 [9468, 239, 101, 9468, 237, 119, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 121]
N: 🤟 [9468, 97, 253]

O: 🚶‍♀️ [9468, 248, 114, 102470, 32990, 31643]
N: 🤾‍♂ [9468, 97, 122, 102470, 17245, 224]

O: 😲 [76460, 110]
N: 👱 [9468, 239, 109]

O: 🧑🏾‍⚕ [9468, 100, 239, 9468, 237, 122, 102470, 158, 248, 243]
N: 🧑🏾‍⚕ [9468, 100, 239, 9468, 237, 122, 102470, 158, 248, 243]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.12s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.05s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:11<00:03,  3.83s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  2.65s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  3.14s/it]
Processing depth (0, 2, 5, 6, 7):   0%|          | 0/100 [00:14<?, ?it/s]2025-01-22 05:16:47.582 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the office.
2025-01-22 05:16:47.583 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  moved to the office.
2025-01-22 05:16:47.583 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel picked up the apple.
2025-01-22 05:16:47.592 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1860, 1865) --> . Daniel picked up the
2025-01-22 05:16:47.592 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the bedroom.
2025-01-22 05:16:47.614 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4229, 4235) -->  Daniel went back to the bedroom
2025-01-22 05:16:47.614 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel discarded the apple.
2025-01-22 05:16:47.639 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4678, 4682) -->  Daniel discarded the apple
2025-01-22 05:16:47.639 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went to the garden.
2025-01-22 05:16:47.670 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5516, 5521) --> . John went to the
2025-01-22 05:16:47.670 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the hallway.
2025-01-22 05:16:47.696 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5186, 5191) --> . Sandra moved to the
2025-01-22 05:16:47.696 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went back to the hallway.
2025-01-22 05:16:47.702 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1232, 1238) -->  Republican. Mary went back to
2025-01-22 05:16:47.702 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the hallway.
2025-01-22 05:16:47.709 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1234, 1240) -->  Mary went back to the hallway
2025-01-22 05:16:47.709 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the bathroom.
2025-01-22 05:16:47.739 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5914, 5920) --> . Sandra went back to the
2025-01-22 05:16:47.739 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra went back to the garden.
2025-01-22 05:16:47.774 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5914, 5920) --> . Sandra went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:16:48.544 | INFO     | test_jbb_embedding:begin_test:693 - bedroom<|eot_id|>
2025-01-22 05:16:48.544 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8264])
2025-01-22 05:16:50.983 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [267.7525, 31.89859439269296, 138.16379310344828, 30.805311586702388, 30.590792410714286], 'topk_indices': array([8153, 8256, 8243,   28, 8244, 8236, 8251, 8143, 8237, 1606, 8262,
       1685, 8238,   14,   24, 1607, 4234,    0, 8259, 8260]), 'topk_tokens': [' location', '?\n', ' prior', '<|end_header_id|>', ' to', '.\n\n', ' discarded', '.\n\n', 'Question', ' some', '<|end_header_id|>', ' some', ':', '\n', '\n\n', ' time', ' bedroom', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [262.6, 262.175, 423.4166666666667, 334.78125, 38.0625]}, 'weight': {'score': [22.786875, 23.342453272441325, 23.132543103448278, 23.344885913906477, 29.91279761904762], 'topk_indices': array([3321, 3294, 3166, 3214, 7510, 7472, 1486, 1424, 4362, 4346, 5220,
       5281, 7249, 7193, 3477, 3503, 5039, 4985, 5010, 5068]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.034375, 22.3625, 25.44921875, 29.201171875, 18.6375]}, 'saliency': {'score': [1.7455419921875, 0.17401687175345543, 0.8762164938038793, 0.16675287795775237, 0.23550211588541667], 'topk_indices': array([8143, 8236,    0, 1865, 8257, 8247, 8109, 1665, 8249, 4679, 8153,
       1239,   24, 8243, 1606, 1685, 1607, 8251, 8237, 4234]), 'topk_tokens': ['.\n\n', '.\n\n', '<|begin_of_text|>', ' apple', 'Answer', ' where', ' context', 'Min', ' apple', ' discarded', ' location', ' hallway', '\n\n', ' prior', ' some', ' some', ' time', ' discarded', 'Question', ' bedroom'], 'evidence_proportions': [1.311669921875, 1.48681640625, 3.078125, 2.5665283203125, 0.1822509765625]}}, 'pred_res': 'bedroom<|eot_id|>', 'score': 0}
2025-01-22 05:16:50.990 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:16:50.990 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-55_pid-0_0-2-5-6-7.pkl | len: 3 |  size: 2.1 KB
Processing depth (0, 2, 5, 6, 7):   1%|          | 1/100 [00:17<29:00, 17.58s/it]is_0k: False
your chose emoji: ['🚣🏾\u200d♀', '🛸', '🧎🏾', '👨🏾\u200d🎨', '🦹🏻\u200d♀️', '🧎\u200d♂️\u200d➡️', '👨🏼\u200d🦯\u200d➡', '🙋🏼\u200d♂️', '👩🏼\u200d🦯\u200d➡️', '🏴\U000e0067\U000e0062\U000e0077\U000e006c\U000e0073\U000e007f']
emoji:
O: 🚣🏾‍♀ [9468, 248, 96, 9468, 237, 122, 102470, 32990]
N: 🧎🏾 [9468, 100, 236, 9468, 237, 122]

O: 🛸 [9468, 249, 116]
N: 🧎‍♂️‍➡️ [9468, 100, 236, 102470, 17245, 224, 31643, 102470, 98115, 94, 31643]

O: 🧎🏾 [9468, 100, 236, 9468, 237, 122]
N: 🚣🏾‍♀ [9468, 248, 96, 9468, 237, 122, 102470, 32990]

O: 👨🏾‍🎨 [9468, 239, 101, 9468, 237, 122, 102470, 9468, 236, 101]
N: 👨🏼‍🦯‍➡ [9468, 239, 101, 9468, 237, 120, 102470, 9468, 99, 107, 102470, 98115, 94]

O: 🦹🏻‍♀️ [9468, 99, 117, 9468, 237, 119, 102470, 32990, 31643]
N: 👨🏾‍🎨 [9468, 239, 101, 9468, 237, 122, 102470, 9468, 236, 101]

O: 🧎‍♂️‍➡️ [9468, 100, 236, 102470, 17245, 224, 31643, 102470, 98115, 94, 31643]
N: 🙋🏼‍♂️ [9468, 247, 233, 9468, 237, 120, 102470, 17245, 224, 31643]

O: 👨🏼‍🦯‍➡ [9468, 239, 101, 9468, 237, 120, 102470, 9468, 99, 107, 102470, 98115, 94]
N: 🦹🏻‍♀️ [9468, 99, 117, 9468, 237, 119, 102470, 32990, 31643]

O: 🙋🏼‍♂️ [9468, 247, 233, 9468, 237, 120, 102470, 17245, 224, 31643]
N: 👩🏼‍🦯‍➡️ [9468, 239, 102, 9468, 237, 120, 102470, 9468, 99, 107, 102470, 98115, 94, 31643]

O: 👩🏼‍🦯‍➡️ [9468, 239, 102, 9468, 237, 120, 102470, 9468, 99, 107, 102470, 98115, 94, 31643]
N: 🛸 [9468, 249, 116]

O: 🏴󠁧󠁢󠁷󠁬󠁳󠁿 [9468, 237, 112, 175, 16050, 100, 175, 16050, 95, 175, 16050, 115, 175, 16050, 105, 175, 16050, 111, 175, 16050, 123]
N: 🏴󠁧󠁢󠁷󠁬󠁳󠁿 [9468, 237, 112, 175, 16050, 100, 175, 16050, 95, 175, 16050, 115, 175, 16050, 105, 175, 16050, 111, 175, 16050, 123]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.59s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:10,  5.04s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.07s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.64s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.33s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 3, 4, 5, 9):   1%|          | 1/100 [00:33<29:00, 17.58s/it]2025-01-22 05:17:06.654 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the office.
2025-01-22 05:17:06.654 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  moved to the office.
2025-01-22 05:17:06.655 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel picked up the apple.
2025-01-22 05:17:06.669 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2924, 2929) --> . Daniel picked up the
2025-01-22 05:17:06.669 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the bedroom.
2025-01-22 05:17:06.687 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3626, 3632) --> . Daniel went back to the
2025-01-22 05:17:06.687 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel discarded the apple.
2025-01-22 05:17:06.708 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4221, 4225) -->  discarded the apple.
2025-01-22 05:17:06.708 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went to the garden.
2025-01-22 05:17:06.738 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6161, 6166) -->  back to the garden.
2025-01-22 05:17:06.738 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the hallway.
2025-01-22 05:17:06.765 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5378, 5383) --> . Sandra moved to the
2025-01-22 05:17:06.765 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went back to the hallway.
2025-01-22 05:17:06.771 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1234, 1240) -->  Republican. Mary went back to
2025-01-22 05:17:06.771 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the hallway.
2025-01-22 05:17:06.777 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1236, 1242) -->  Mary went back to the hallway
2025-01-22 05:17:06.777 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the bathroom.
2025-01-22 05:17:06.808 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6160, 6166) -->  went back to the garden.
2025-01-22 05:17:06.808 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra went back to the garden.
2025-01-22 05:17:06.838 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6159, 6165) -->  Sandra went back to the garden
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:17:09.986 | INFO     | test_jbb_embedding:begin_test:693 - bedroom<|eot_id|>
2025-01-22 05:17:09.986 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8218])
2025-01-22 05:17:13.071 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [321.69, 31.59618309002433, 145.67133620689654, 30.302952026696058, 17.380335365853657], 'topk_indices': array([2929,   34,    4,   32, 8201, 8197, 8216,   31,    9, 8198,   29,
       8107, 8097, 2930,   14, 3632,   24,    0, 8213, 8214]), 'topk_tokens': [' apple', ' office', '\n\n', ' to', ' where', ' prior', '<|end_header_id|>', ' moved', ':', ' to', '\n\n', ' location', '.\n\n', '.', '\n', ' bedroom', '\n\n', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [520.05, 327.8, 315.1458333333333, 392.03125, 68.8]}, 'weight': {'score': [20.765625, 23.299714872262772, 23.651131465517242, 23.3062249341783, 29.61356707317073], 'topk_indices': array([3291, 3264, 3136, 3184, 7486, 7448, 1494, 1432, 4307, 4291, 5233,
       5172, 7219, 7163, 3473, 3447, 5004, 4927, 4952, 4975]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.034375, 22.3625, 20.927083333333332, 23.08984375, 18.846875]}, 'saliency': {'score': [1.727265625, 0.17319249805162712, 0.87109375, 0.16595627903617133, 0.13046739159560786], 'topk_indices': array([1241, 8211, 8063, 8097,   27, 2590, 8201, 8203, 2664,   34,    0,
       4221, 8191, 2929,   31, 8107, 8197, 8205,   24, 3632]), 'topk_tokens': [' hallway', 'Answer', ' context', '.\n\n', 'user', 'ared', ' where', ' apple', ' ne', ' office', '<|begin_of_text|>', ' discarded', 'Question', ' apple', ' moved', ' location', ' prior', ' discarded', '\n\n', ' bedroom'], 'evidence_proportions': [2.6525390625, 1.876171875, 1.599609375, 2.3248291015625, 0.32822265625]}}, 'pred_res': 'bedroom<|eot_id|>', 'score': 0}
2025-01-22 05:17:13.078 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:17:13.078 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-55_pid-1_0-3-4-5-9.pkl | len: 3 |  size: 2.08 KB
Processing depth (0, 3, 4, 5, 9):   2%|▏         | 2/100 [00:39<33:02, 20.23s/it]is_0k: False
your chose emoji: ['♋', '🧑\u200d🤝\u200d🧑', '👩🏻\u200d🦽\u200d➡️', '👩🏿\u200d🏫', '🧖🏼\u200d♂️', '👮🏾\u200d♀️', '👨\u200d🚒', '⚛', '👱🏽\u200d♀', '🙍🏾\u200d♀']
emoji:
O: ♋ [17245, 233]
N: 👨‍🚒 [9468, 239, 101, 102470, 9468, 248, 240]

O: 🧑‍🤝‍🧑 [9468, 100, 239, 102470, 9468, 97, 251, 102470, 9468, 100, 239]
N: ⚛ [158, 248, 249]

O: 👩🏻‍🦽‍➡️ [9468, 239, 102, 9468, 237, 119, 102470, 9468, 99, 121, 102470, 98115, 94, 31643]
N: 👱🏽‍♀ [9468, 239, 109, 9468, 237, 121, 102470, 32990]

O: 👩🏿‍🏫 [9468, 239, 102, 9468, 237, 123, 102470, 9468, 237, 104]
N: 👩🏿‍🏫 [9468, 239, 102, 9468, 237, 123, 102470, 9468, 237, 104]

O: 🧖🏼‍♂️ [9468, 100, 244, 9468, 237, 120, 102470, 17245, 224, 31643]
N: 👩🏻‍🦽‍➡️ [9468, 239, 102, 9468, 237, 119, 102470, 9468, 99, 121, 102470, 98115, 94, 31643]

O: 👮🏾‍♀️ [9468, 239, 106, 9468, 237, 122, 102470, 32990, 31643]
N: 🧖🏼‍♂️ [9468, 100, 244, 9468, 237, 120, 102470, 17245, 224, 31643]

O: 👨‍🚒 [9468, 239, 101, 102470, 9468, 248, 240]
N: 🧑‍🤝‍🧑 [9468, 100, 239, 102470, 9468, 97, 251, 102470, 9468, 100, 239]

O: ⚛ [158, 248, 249]
N: 👮🏾‍♀️ [9468, 239, 106, 9468, 237, 122, 102470, 32990, 31643]

O: 👱🏽‍♀ [9468, 239, 109, 9468, 237, 121, 102470, 32990]
N: ♋ [17245, 233]

O: 🙍🏾‍♀ [9468, 247, 235, 9468, 237, 122, 102470, 32990]
N: 🙍🏾‍♀ [9468, 247, 235, 9468, 237, 122, 102470, 32990]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.79s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.92s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.62s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.19s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.77s/it]
Processing depth (1, 4, 5, 6, 9):   2%|▏         | 2/100 [00:56<33:02, 20.23s/it]2025-01-22 05:17:29.904 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the office.
2025-01-22 05:17:29.908 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (813, 818) --> . Daniel moved to the
2025-01-22 05:17:29.908 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel picked up the apple.
2025-01-22 05:17:29.925 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3571, 3576) -->  Daniel picked up the apple
2025-01-22 05:17:29.926 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the bedroom.
2025-01-22 05:17:29.946 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4154, 4160) --> . Daniel went back to the
2025-01-22 05:17:29.946 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel discarded the apple.
2025-01-22 05:17:29.969 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4742, 4746) -->  Daniel discarded the apple
2025-01-22 05:17:29.969 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went to the garden.
2025-01-22 05:17:30.000 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6213, 6218) -->  back to the garden.
2025-01-22 05:17:30.000 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the hallway.
2025-01-22 05:17:30.028 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5356, 5361) --> . Sandra moved to the
2025-01-22 05:17:30.028 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went back to the hallway.
2025-01-22 05:17:30.034 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1123, 1129) --> . Mary went back to the
2025-01-22 05:17:30.034 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the hallway.
2025-01-22 05:17:30.039 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1124, 1130) -->  Mary went back to the hallway
2025-01-22 05:17:30.040 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the bathroom.
2025-01-22 05:17:30.070 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6210, 6216) --> . Sandra went back to the
2025-01-22 05:17:30.070 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra went back to the garden.
2025-01-22 05:17:30.103 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6210, 6216) --> . Sandra went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:17:30.873 | INFO     | test_jbb_embedding:begin_test:693 - bedroom<|eot_id|>
2025-01-22 05:17:30.873 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8222])
2025-01-22 05:17:33.132 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [278.11, 32.4291593202821, 145.00969827586206, 31.277769277845778, 52.91029575892857], 'topk_indices': array([  28, 6042,    9, 6061, 4169, 5926, 5906,    3, 3575, 4171, 6062,
       4174, 4172,   14,   24, 4160, 8217, 4173, 8218,    0]), 'topk_tokens': ['<|end_header_id|>', 'S', ':', ',', '❤', ' which', 'ayers', '<|end_header_id|>', ' apple', '�', ' in', '�', '�', '\n', '\n\n', ' bedroom', '<|eot_id|>', '�', '<|start_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [353.825, 433.0, 245.20833333333334, 305.90625, 64.75]}, 'weight': {'score': [22.84, 23.301659016293776, 22.297144396551722, 23.306637278151776, 29.56845238095238], 'topk_indices': array([3296, 3323, 3216, 3168, 7474, 7436, 1434, 1496, 4328, 4344, 5211,
       5150, 7151, 7207, 3479, 3505, 4969, 4998, 4921, 4946]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.909375, 26.9703125, 20.927083333333332, 29.201171875, 18.846875]}, 'saliency': {'score': [1.711103515625, 0.18151335957449233, 0.8664403455010776, 0.17440165376137928, 0.3851009550548735], 'topk_indices': array([8207, 1129, 3562, 8195, 4165, 4743, 5926, 8111, 8209, 4170, 8201,
         24, 3575, 5906, 4169, 4172, 4171, 4174, 4173, 4160]), 'topk_tokens': [' apple', ' hallway', '️', 'Question', '�', ' discarded', ' which', ' location', ' discarded', '\u200d', ' prior', '\n\n', ' apple', 'ayers', '❤', '�', '�', '�', '�', ' bedroom'], 'evidence_proportions': [1.81591796875, 3.03203125, 1.2262369791666667, 2.40673828125, 0.310693359375]}}, 'pred_res': 'bedroom<|eot_id|>', 'score': 0}
2025-01-22 05:17:33.145 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:17:33.146 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-55_pid-2_1-4-5-6-9.pkl | len: 3 |  size: 2.05 KB
Processing depth (1, 4, 5, 6, 9):   3%|▎         | 3/100 [00:59<32:35, 20.16s/it]is_0k: False
your chose emoji: ['7️⃣', '🤷🏼\u200d♂️', '👨🏼\u200d🦼\u200d➡️', '🧑🏼\u200d❤\u200d🧑🏿', '🚵🏻\u200d♀️', '😲', '🦿', '👨🏾\u200d❤\u200d👨🏾', '🧗🏾\u200d♀', '🥺']
emoji:
O: 7️⃣ [22, 31643, 158, 225, 96]
N: 😲 [76460, 110]

O: 🤷🏼‍♂️ [9468, 97, 115, 9468, 237, 120, 102470, 17245, 224, 31643]
N: 🚵🏻‍♀️ [9468, 248, 113, 9468, 237, 119, 102470, 32990, 31643]

O: 👨🏼‍🦼‍➡️ [9468, 239, 101, 9468, 237, 120, 102470, 9468, 99, 120, 102470, 98115, 94, 31643]
N: 🤷🏼‍♂️ [9468, 97, 115, 9468, 237, 120, 102470, 17245, 224, 31643]

O: 🧑🏼‍❤‍🧑🏿 [9468, 100, 239, 9468, 237, 120, 102470, 121643, 102470, 9468, 100, 239, 9468, 237, 123]
N: 🧗🏾‍♀ [9468, 100, 245, 9468, 237, 122, 102470, 32990]

O: 🚵🏻‍♀️ [9468, 248, 113, 9468, 237, 119, 102470, 32990, 31643]
N: 7️⃣ [22, 31643, 158, 225, 96]

O: 😲 [76460, 110]
N: 👨🏾‍❤‍👨🏾 [9468, 239, 101, 9468, 237, 122, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 122]

O: 🦿 [9468, 99, 123]
N: 🦿 [9468, 99, 123]

O: 👨🏾‍❤‍👨🏾 [9468, 239, 101, 9468, 237, 122, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 122]
N: 👨🏼‍🦼‍➡️ [9468, 239, 101, 9468, 237, 120, 102470, 9468, 99, 120, 102470, 98115, 94, 31643]

O: 🧗🏾‍♀ [9468, 100, 245, 9468, 237, 122, 102470, 32990]
N: 🧑🏼‍❤‍🧑🏿 [9468, 100, 239, 9468, 237, 120, 102470, 121643, 102470, 9468, 100, 239, 9468, 237, 123]

O: 🥺 [9468, 98, 118]
N: 🥺 [9468, 98, 118]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:11,  3.79s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.08s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:11<00:03,  3.91s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  2.56s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  3.07s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (2, 3, 5, 7, 9):   3%|▎         | 3/100 [01:13<32:35, 20.16s/it]2025-01-22 05:17:47.158 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the office.
2025-01-22 05:17:47.168 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1868, 1873) --> . Daniel moved to the
2025-01-22 05:17:47.168 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel picked up the apple.
2025-01-22 05:17:47.184 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2987, 2992) -->  tragedy. Daniel picked up
2025-01-22 05:17:47.184 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the bedroom.
2025-01-22 05:17:47.206 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4221, 4227) -->  Daniel went back to the bedroom
2025-01-22 05:17:47.206 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel discarded the apple.
2025-01-22 05:17:47.235 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5794, 5798) -->  Daniel discarded the apple
2025-01-22 05:17:47.235 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went to the garden.
2025-01-22 05:17:47.270 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6291, 6296) -->  back to the garden.
2025-01-22 05:17:47.270 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the hallway.
2025-01-22 05:17:47.298 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5567, 5572) --> . Sandra moved to the
2025-01-22 05:17:47.298 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went back to the hallway.
2025-01-22 05:17:47.305 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1240, 1246) -->  Republican. Mary went back to
2025-01-22 05:17:47.306 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the hallway.
2025-01-22 05:17:47.312 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1242, 1248) -->  Mary went back to the hallway
2025-01-22 05:17:47.312 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the bathroom.
2025-01-22 05:17:47.346 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6290, 6296) -->  went back to the garden.
2025-01-22 05:17:47.346 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra went back to the garden.
2025-01-22 05:17:47.378 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6289, 6295) -->  Sandra went back to the garden
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:17:51.343 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's hand.<|eot_id|>
2025-01-22 05:17:51.344 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8202])
2025-01-22 05:17:54.258 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [254.4125, 27.575548132008777, 157.17133620689654, 26.41859087423313, 21.57374366554054], 'topk_indices': array([   1, 8182, 8181, 8196, 8201, 8081, 8194, 8176, 1871,    9, 1870,
       8047,    3,   14, 8200,   23,   24,    0, 8197, 8198]), 'topk_tokens': ['<|start_header_id|>', ' to', ' prior', ':', '\n\n', '.\n\n', '?\n', ':', ' to', ':', ' moved', ' context', '<|end_header_id|>', '\n', '<|end_header_id|>', '4', '\n\n', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [486.9, 169.85, 216.22916666666666, 331.90625, 90.3125]}, 'weight': {'score': [24.1653125, 23.29342774865919, 23.651131465517242, 23.289480444785276, 29.95903716216216], 'topk_indices': array([3297, 3270, 3190, 3142, 7408, 7446, 1494, 1432, 4274, 4290, 5099,
       5160, 7179, 7123, 3497, 3471, 4876, 4901, 4924, 4953]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.909375, 28.1703125, 25.44921875, 29.201171875, 18.846875]}, 'saliency': {'score': [1.5454296875, 0.14873459628591998, 0.9761920797413793, 0.1415059282735813, 0.1623133066538218], 'topk_indices': array([  22, 8185, 2993, 8187,   16, 8091,   19, 8195, 8199,   20, 8175,
       5795, 4226,   23, 1870, 8181, 8189,   24, 1247, 8047]), 'topk_tokens': ['202', ' where', ' apple', ' apple', ' Date', ' location', '26', 'Answer', 'assistant', ' Jul', 'Question', ' discarded', ' bedroom', '4', ' moved', ' prior', ' discarded', '\n\n', ' hallway', ' context'], 'evidence_proportions': [2.3630859375, 1.059619140625, 1.5275472005208333, 2.527099609375, 0.44970703125]}}, 'pred_res': "Daniel's hand.<|eot_id|>", 'score': 0}
2025-01-22 05:17:54.265 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:17:54.265 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-55_pid-3_2-3-5-7-9.pkl | len: 3 |  size: 2.08 KB
Processing depth (2, 3, 5, 7, 9):   4%|▍         | 4/100 [01:20<32:51, 20.54s/it]is_0k: False
your chose emoji: ['🧖🏻\u200d♀', '🚶🏼\u200d♀️\u200d➡️', '\U0001fae6', '🙏🏾', '✍🏿', '🚶\u200d♂️', '🧎🏿\u200d♂\u200d➡', '👷🏻', '🤵🏽\u200d♂️', '🖨️']
emoji:
O: 🧖🏻‍♀ [9468, 100, 244, 9468, 237, 119, 102470, 32990]
N: 🚶🏼‍♀️‍➡️ [9468, 248, 114, 9468, 237, 120, 102470, 32990, 31643, 102470, 98115, 94, 31643]

O: 🚶🏼‍♀️‍➡️ [9468, 248, 114, 9468, 237, 120, 102470, 32990, 31643, 102470, 98115, 94, 31643]
N: 🙏🏾 [9468, 247, 237, 9468, 237, 122]

O: 🫦 [9468, 104, 99]
N: 🫦 [9468, 104, 99]

O: 🙏🏾 [9468, 247, 237, 9468, 237, 122]
N: 🚶‍♂️ [9468, 248, 114, 102470, 17245, 224, 31643]

O: ✍🏿 [38798, 235, 9468, 237, 123]
N: 🧎🏿‍♂‍➡ [9468, 100, 236, 9468, 237, 123, 102470, 17245, 224, 102470, 98115, 94]

O: 🚶‍♂️ [9468, 248, 114, 102470, 17245, 224, 31643]
N: ✍🏿 [38798, 235, 9468, 237, 123]

O: 🧎🏿‍♂‍➡ [9468, 100, 236, 9468, 237, 123, 102470, 17245, 224, 102470, 98115, 94]
N: 👷🏻 [9468, 239, 115, 9468, 237, 119]

O: 👷🏻 [9468, 239, 115, 9468, 237, 119]
N: 🤵🏽‍♂️ [9468, 97, 113, 9468, 237, 121, 102470, 17245, 224, 31643]

O: 🤵🏽‍♂️ [9468, 97, 113, 9468, 237, 121, 102470, 17245, 224, 31643]
N: 🧖🏻‍♀ [9468, 100, 244, 9468, 237, 119, 102470, 32990]

O: 🖨️ [9468, 244, 101, 31643]
N: 🖨️ [9468, 244, 101, 31643]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.91s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.70s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.42s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.08s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.64s/it]
Processing depth (0, 1, 2, 7, 9):   4%|▍         | 4/100 [01:37<32:51, 20.54s/it]2025-01-22 05:18:10.550 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the office.
2025-01-22 05:18:10.550 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  moved to the office.
2025-01-22 05:18:10.551 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel picked up the apple.
2025-01-22 05:18:10.555 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (828, 833) -->  Daniel picked up the apple
2025-01-22 05:18:10.556 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the bedroom.
2025-01-22 05:18:10.565 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1866, 1872) --> . Daniel went back to the
2025-01-22 05:18:10.566 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel discarded the apple.
2025-01-22 05:18:10.595 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5533, 5537) -->  Daniel discarded the apple
2025-01-22 05:18:10.596 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went to the garden.
2025-01-22 05:18:10.626 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6084, 6089) -->  back to the garden.
2025-01-22 05:18:10.626 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the hallway.
2025-01-22 05:18:10.655 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5203, 5208) -->  Sandra moved to the hallway
2025-01-22 05:18:10.655 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went back to the hallway.
2025-01-22 05:18:10.662 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1238, 1244) -->  Republican. Mary went back to
2025-01-22 05:18:10.662 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the hallway.
2025-01-22 05:18:10.670 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1240, 1246) -->  Mary went back to the hallway
2025-01-22 05:18:10.670 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the bathroom.
2025-01-22 05:18:10.702 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6083, 6089) -->  went back to the garden.
2025-01-22 05:18:10.702 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra went back to the garden.
2025-01-22 05:18:10.737 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6082, 6088) -->  Sandra went back to the garden
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:18:11.624 | INFO     | test_jbb_embedding:begin_test:693 - Daniel picked up the apple.<|eot_id|>
2025-01-22 05:18:11.624 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8149])
2025-01-22 05:18:13.847 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [634.1575, 60.160164397006504, 201.07650862068965, 57.88320905891071, 73.28214518229167], 'topk_indices': array([5868, 7541, 5537,  833,   34, 6005, 5889, 6024, 8129, 5869, 5534,
         31,   14,   24, 8136, 6025, 7348, 8144,    0, 8145]), 'topk_tokens': ['S', 'nes', '.', '.', ' office', 'S', ' which', ',', ' to', 'ayers', ' discarded', ' moved', '\n', '\n\n', ' discarded', ' in', 'nes', '<|eot_id|>', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [1145.0, 759.5, 226.27083333333334, 1136.875, 85.2625]}, 'weight': {'score': [22.665, 23.25468500797448, 24.702047413793103, 23.25132186303569, 29.392578125], 'topk_indices': array([3314, 3287, 3141, 3189, 7395, 7433, 1492, 1430, 4286, 4302, 5162,
       5101, 7116, 7172, 3470, 3496, 4955, 4926, 4878, 4903]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.034375, 26.9703125, 20.927083333333332, 29.201171875, 18.846875]}, 'saliency': {'score': [4.0668505859375, 0.33367625641217336, 1.2565118197737069, 0.3188446410514697, 0.5055020650227865], 'topk_indices': array([8132, 5536, 7496,   24, 8128, 7270, 5889, 7540, 7347, 8122,  832,
       7541, 8134, 5533,   34,   31, 5869, 7348, 5534, 8136]), 'topk_tokens': [' where', ' apple', 'nes', '\n\n', ' prior', 'nes', ' which', ' Min', ' Min', 'Question', ' apple', 'nes', ' apple', ' Daniel', ' office', ' moved', 'ayers', 'nes', ' discarded', ' discarded'], 'evidence_proportions': [6.120703125, 5.328125, 1.169189453125, 8.79345703125, 0.4476318359375]}}, 'pred_res': 'Daniel picked up the apple.<|eot_id|>', 'score': 0}
2025-01-22 05:18:13.851 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:18:13.851 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-55_pid-4_0-1-2-7-9.pkl | len: 3 |  size: 2.05 KB
Processing depth (0, 1, 2, 7, 9):   5%|▌         | 5/100 [01:40<31:58, 20.19s/it]Processing depth (0, 1, 2, 7, 9):   5%|▌         | 5/100 [01:40<31:49, 20.10s/it]
2025-01-22 05:18:13.910 | INFO     | __main__:<module>:82 - Selected idx: 56
2025-01-22 05:18:13.910 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the football before the office? 
2025-01-22 05:18:13.910 | INFO     | __main__:<module>:84 - Answer: hallway
2025-01-22 05:18:13.910 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 05:18:13.910 | INFO     | __main__:<module>:86 - Needle: [' Sandra moved to the hallway.', ' Sandra went back to the garden.', ' Mary went back to the hallway.', ' Sandra picked up the apple.', ' Daniel went to the hallway.', ' Daniel moved to the office.', ' Sandra left the apple.', ' Daniel dropped the football.', ' Sandra picked up the apple.']
2025-01-22 05:18:13.910 | INFO     | __main__:<module>:87 - Real Needle: [' Daniel went to the hallway.', ' Daniel moved to the office.', ' Daniel dropped the football.', ' Sandra picked up the apple.']
2025-01-22 05:18:13.910 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['#⃣', '😽', '😌', '🏃🏼\u200d♀️\u200d➡', '🍉', '🙍🏻\u200d♀️', '👈🏾', '🏋🏽', '♏', '♈']
emoji:
O: #⃣ [2, 158, 225, 96]
N: 👈🏾 [9468, 239, 230, 9468, 237, 122]

O: 😽 [76460, 121]
N: 🍉 [9468, 235, 231]

O: 😌 [76460, 234]
N: 🙍🏻‍♀️ [9468, 247, 235, 9468, 237, 119, 102470, 32990, 31643]

O: 🏃🏼‍♀️‍➡ [9468, 237, 225, 9468, 237, 120, 102470, 32990, 31643, 102470, 98115, 94]
N: ♏ [17245, 237]

O: 🍉 [9468, 235, 231]
N: 😌 [76460, 234]

O: 🙍🏻‍♀️ [9468, 247, 235, 9468, 237, 119, 102470, 32990, 31643]
N: 🏋🏽 [9468, 237, 233, 9468, 237, 121]

O: 👈🏾 [9468, 239, 230, 9468, 237, 122]
N: 😽 [76460, 121]

O: 🏋🏽 [9468, 237, 233, 9468, 237, 121]
N: ⃣ Sandra [158, 225, 96, 56786]

O: ♏ [17245, 237]
N: ��🏼‍♀️‍➡ The [237, 225, 9468, 237, 120, 102470, 32990, 31643, 102470, 98115, 94, 578]

O: ♈ [17245, 230]
N: �
 [230, 198]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.25s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.22s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.44s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.14s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.58s/it]
Processing depth (1, 2, 5, 7):   0%|          | 0/100 [00:15<?, ?it/s]2025-01-22 05:18:29.948 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went to the hallway.
2025-01-22 05:18:29.952 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (836, 841) -->  Daniel went to the hallway
2025-01-22 05:18:29.952 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the office.
2025-01-22 05:18:29.962 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1867, 1872) --> . Daniel moved to the
2025-01-22 05:18:29.962 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel dropped the football.
2025-01-22 05:18:29.989 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4229, 4233) -->  dropped the football.
2025-01-22 05:18:29.989 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra picked up the apple.
2025-01-22 05:18:30.022 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5607, 5612) --> . Sandra picked up the
2025-01-22 05:18:30.022 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the hallway.
2025-01-22 05:18:30.042 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4120, 4125) --> . Sandra moved to the
2025-01-22 05:18:30.042 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the garden.
2025-01-22 05:18:30.062 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4154, 4160) --> . Sandra went back to the
2025-01-22 05:18:30.062 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the hallway.
2025-01-22 05:18:30.083 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4033, 4039) --> . Mary went back to the
2025-01-22 05:18:30.083 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra left the apple.
2025-01-22 05:18:30.105 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4592, 4596) -->  left the apple.
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:18:30.978 | INFO     | test_jbb_embedding:begin_test:693 - Daniel dropped the football.<|eot_id|>
2025-01-22 05:18:30.978 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8177])
2025-01-22 05:18:33.194 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [387.55263157894734, 31.001528117359413, 151.89285714285714, 29.85740171990172, 23.883129222972972], 'topk_indices': array([8163, 7651, 8168, 4230, 8160,   14, 8162,   24, 4352, 8167, 8075,
       4229, 4232, 8165, 8164, 8173, 8175, 8172, 4231,    0]), 'topk_tokens': [' the', ' or', '?', ' the', ':', '\n', ' was', '\n\n', 'nes', ' office', ' location', ' dropped', '.', ' before', ' football', '<|start_header_id|>', '<|end_header_id|>', '<|eot_id|>', ' football', '<|begin_of_text|>'], 'evidence_proportions': [345.325, 276.85, 991.875, 57.025]}, 'weight': {'score': [22.67064144736842, 23.293811124694376, 21.064732142857142, 23.301016392813267, 29.809966216216218], 'topk_indices': array([3290, 3263, 3135, 3183, 7468, 7430, 1431, 1493, 4319, 4303, 5250,
       5189, 7207, 7151, 3446, 3472, 4951, 4926, 5009, 4980]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [25.7609375, 19.909375, 21.23046875, 23.49375]}, 'saliency': {'score': [2.3688129625822367, 0.1759594905638753, 0.8483537946428571, 0.16910635833365326, 0.18424059893633868], 'topk_indices': array([8074,   24, 4228, 8146, 7383, 8162, 8161, 8031, 7642, 8159, 4039,
       4376,  840, 4352, 8075, 8167, 8165, 4229, 8164, 4231]), 'topk_tokens': [' first', '\n\n', ' Daniel', ' return', 'nes', ' was', ' Where', ' context', ' tele', 'Question', ' hallway', ' Min', ' hallway', 'nes', ' location', ' office', ' before', ' dropped', ' football', ' football'], 'evidence_proportions': [2.4216796875, 1.416015625, 6.0224609375, 0.3458251953125]}}, 'pred_res': 'Daniel dropped the football.<|eot_id|>', 'score': 0}
2025-01-22 05:18:33.209 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:18:33.215 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-56_pid-0_1-2-5-7.pkl | len: 3 |  size: 2.04 KB
Processing depth (1, 2, 5, 7):   1%|          | 1/100 [00:19<31:41, 19.21s/it]is_0k: False
your chose emoji: ['🏬', '🏴\u200d☠️', '👩🏽\u200d🤝\u200d👨🏿', '👮🏾\u200d♀️', '🍊', '💁🏻\u200d♂', '🏃🏾\u200d♀️\u200d➡️', '🤳🏼', '💅🏼', '\U0001faaf']
emoji:
O: 🏬 [9468, 237, 105]
N: 🏃🏾‍♀️‍➡️ [9468, 237, 225, 9468, 237, 122, 102470, 32990, 31643, 102470, 98115, 94, 31643]

O: 🏴‍☠️ [9468, 237, 112, 102470, 18107, 254, 31643]
N: 👮🏾‍♀️ [9468, 239, 106, 9468, 237, 122, 102470, 32990, 31643]

O: 👩🏽‍🤝‍👨🏿 [9468, 239, 102, 9468, 237, 121, 102470, 9468, 97, 251, 102470, 9468, 239, 101, 9468, 237, 123]
N: 🏬 [9468, 237, 105]

O: 👮🏾‍♀️ [9468, 239, 106, 9468, 237, 122, 102470, 32990, 31643]
N: 🤳🏼 [9468, 97, 111, 9468, 237, 120]

O: 🍊 [9468, 235, 232]
N: 🏴‍☠️ [9468, 237, 112, 102470, 18107, 254, 31643]

O: 💁🏻‍♂ [93273, 223, 9468, 237, 119, 102470, 17245, 224]
N: 💁🏻‍♂ [93273, 223, 9468, 237, 119, 102470, 17245, 224]

O: 🏃🏾‍♀️‍➡️ [9468, 237, 225, 9468, 237, 122, 102470, 32990, 31643, 102470, 98115, 94, 31643]
N: 🍊 [9468, 235, 232]

O: 🤳🏼 [9468, 97, 111, 9468, 237, 120]
N: 👩🏽‍🤝‍👨🏿 [9468, 239, 102, 9468, 237, 121, 102470, 9468, 97, 251, 102470, 9468, 239, 101, 9468, 237, 123]

O: 💅🏼 [93273, 227, 9468, 237, 120]
N: 💅🏼 [93273, 227, 9468, 237, 120]

O: 🪯 [9468, 103, 107]
N: 🪯 [9468, 103, 107]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:11,  3.79s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:07<00:07,  3.93s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:11<00:03,  3.97s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  2.83s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  3.23s/it]
Processing depth (2, 4, 6, 9):   1%|          | 1/100 [00:33<31:41, 19.21s/it]2025-01-22 05:18:47.970 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went to the hallway.
2025-01-22 05:18:47.979 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1731, 1736) --> . Daniel went to the
2025-01-22 05:18:47.979 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the office.
2025-01-22 05:18:47.999 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3615, 3620) --> . Daniel moved to the
2025-01-22 05:18:47.999 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel dropped the football.
2025-01-22 05:18:48.026 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4773, 4777) -->  Daniel dropped the football
2025-01-22 05:18:48.026 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra picked up the apple.
2025-01-22 05:18:48.066 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7238, 7243) -->  Sandra picked up the apple
2025-01-22 05:18:48.066 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the hallway.
2025-01-22 05:18:48.086 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4093, 4098) -->  Sandra moved to the hallway
2025-01-22 05:18:48.087 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the garden.
2025-01-22 05:18:48.110 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4144, 4150) --> . Sandra went back to the
2025-01-22 05:18:48.110 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the hallway.
2025-01-22 05:18:48.130 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4039, 4045) --> . Mary went back to the
2025-01-22 05:18:48.130 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra left the apple.
2025-01-22 05:18:48.152 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4603, 4607) -->  left the apple.
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:18:49.009 | INFO     | test_jbb_embedding:begin_test:693 - Daniel dropped the football.<|eot_id|>
2025-01-22 05:18:49.009 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8179])
2025-01-22 05:18:51.236 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [251.82894736842104, 23.31042799743339, 99.57440476190476, 22.58046049803488, 17.396692708333333], 'topk_indices': array([8033, 3617, 8173, 8067, 8160, 8164, 8077,   24,   14, 8162, 4808,
       8175, 4776, 8167, 4780, 8166, 8177, 4781,    0, 8174]), 'topk_tokens': [' context', ' moved', ':', '.\n\n', '.\n\n', ' was', ' location', '\n\n', '\n', ':', 'super', '<|start_header_id|>', ' football', ' before', 'super', ' football', '<|end_header_id|>', 'human', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [204.725, 342.625, 433.5, 62.8]}, 'weight': {'score': [23.56578947368421, 23.29668785138108, 22.515997023809526, 23.29807345400393, 29.88], 'topk_indices': array([3288, 3261, 3181, 3133, 7458, 7420, 1479, 1417, 4370, 4354, 5236,
       5175, 7181, 7125, 3482, 3508, 5000, 5029, 4952, 4977]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.665625, 19.909375, 27.341796875, 28.1015625]}, 'saliency': {'score': [1.516383120888158, 0.13054969356800752, 0.5663074311755952, 0.1261918272441507, 0.129169921875], 'topk_indices': array([8176, 8148, 8164, 4774,   24, 8172, 8163, 8169, 8033, 3617, 1736,
       8161, 8077, 4045, 8167, 4808, 4776, 4780, 8166, 4781]), 'topk_tokens': ['assistant', ' return', ' was', ' dropped', '\n\n', 'Answer', ' Where', ' office', ' context', ' moved', ' hallway', 'Question', ' location', ' hallway', ' before', 'super', ' football', 'super', ' football', 'human'], 'evidence_proportions': [1.139794921875, 1.75322265625, 3.0186767578125, 0.454296875]}}, 'pred_res': 'Daniel dropped the football.<|eot_id|>', 'score': 0}
2025-01-22 05:18:51.255 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:18:51.256 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-56_pid-1_2-4-6-9.pkl | len: 3 |  size: 2.05 KB
Processing depth (2, 4, 6, 9):   2%|▏         | 2/100 [00:37<30:15, 18.52s/it]is_0k: False
your chose emoji: ['⛹🏽', '🧑🏼\u200d❤️\u200d💋\u200d🧑🏽', '🎮', '👩🏻\u200d❤️\u200d💋\u200d👨🏻', '😨', '👨\u200d⚖', '😒', '😓', '🤚🏻', '🙎🏿\u200d♀️']
emoji:
O: ⛹🏽 [158, 249, 117, 9468, 237, 121]
N: 👨‍⚖ [9468, 239, 101, 102470, 158, 248, 244]

O: 🧑🏼‍❤️‍💋‍🧑🏽 [9468, 100, 239, 9468, 237, 120, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 100, 239, 9468, 237, 121]
N: 😒 [76460, 240]

O: 🎮 [9468, 236, 106]
N: ⛹🏽 [158, 249, 117, 9468, 237, 121]

O: 👩🏻‍❤️‍💋‍👨🏻 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 119]
N: 👩🏻‍❤️‍💋‍👨🏻 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 119]

O: 😨 [76460, 101]
N: 🤚🏻 [9468, 97, 248, 9468, 237, 119]

O: 👨‍⚖ [9468, 239, 101, 102470, 158, 248, 244]
N: 🧑🏼‍❤️‍💋‍🧑🏽 [9468, 100, 239, 9468, 237, 120, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 100, 239, 9468, 237, 121]

O: 😒 [76460, 240]
N: 😓 [76460, 241]

O: 😓 [76460, 241]
N: 🎮 [9468, 236, 106]

O: 🤚🏻 [9468, 97, 248, 9468, 237, 119]
N: 😨 [76460, 101]

O: 🙎🏿‍♀️ [9468, 247, 236, 9468, 237, 123, 102470, 32990, 31643]
N: 🙎🏿‍♀️ [9468, 247, 236, 9468, 237, 123, 102470, 32990, 31643]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.20s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.23s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.02s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.78s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.28s/it]
Processing depth (5, 7, 8, 9):   2%|▏         | 2/100 [00:52<30:15, 18.52s/it]2025-01-22 05:19:06.633 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went to the hallway.
2025-01-22 05:19:06.653 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3930, 3935) -->  back to the hallway.
2025-01-22 05:19:06.653 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the office.
2025-01-22 05:19:06.681 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5612, 5617) --> . Daniel moved to the
2025-01-22 05:19:06.681 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel dropped the football.
2025-01-22 05:19:06.716 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6571, 6575) -->  Daniel dropped the football
2025-01-22 05:19:06.716 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra picked up the apple.
2025-01-22 05:19:06.751 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7224, 7229) -->  cold. Sandra picked up
2025-01-22 05:19:06.751 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the hallway.
2025-01-22 05:19:06.773 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4044, 4049) --> . Sandra moved to the
2025-01-22 05:19:06.773 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the garden.
2025-01-22 05:19:06.797 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4096, 4102) --> . Sandra went back to the
2025-01-22 05:19:06.797 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the hallway.
2025-01-22 05:19:06.818 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3925, 3931) -->  the ground. Mary went back
2025-01-22 05:19:06.818 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra left the apple.
2025-01-22 05:19:06.840 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4549, 4553) -->  left the apple.
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:19:07.610 | INFO     | test_jbb_embedding:begin_test:693 - St. Paul<|eot_id|>
2025-01-22 05:19:07.611 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8117])
2025-01-22 05:19:09.869 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [168.3488898026316, 15.36920797413793, 72.06361607142857, 14.862129196318069, 15.253750887784092], 'topk_indices': array([6571,    4,    9, 8107, 8103, 7971,   23,    1, 8113, 8105, 8115,
       6572,   24, 8104, 6575,   14,    3, 8112, 6574,    0]), 'topk_tokens': [' Daniel', '\n\n', ':', ' office', ' the', ' context', '4', '<|start_header_id|>', '<|start_header_id|>', ' before', '<|end_header_id|>', ' dropped', '\n\n', ' football', '.', '\n', '<|end_header_id|>', '<|eot_id|>', ' football', '<|begin_of_text|>'], 'evidence_proportions': [97.4375, 162.6375, 429.8125, 35.80078125]}, 'weight': {'score': [23.611842105263158, 23.236310806650245, 21.836309523809526, 23.239066367574257, 28.947088068181817], 'topk_indices': array([3251, 3278, 3171, 3123, 7404, 7366, 1471, 1409, 4274, 4290, 5151,
       5090, 7117, 7061, 3460, 3434, 4892, 4867, 4944, 4915]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.428125, 19.909375, 27.341796875, 27.5140625]}, 'saliency': {'score': [1.0989701120476973, 0.08612461184045951, 0.40772210984002977, 0.08290708560754757, 0.1055649844082919], 'topk_indices': array([6506,   20, 8015, 8114,   23,    8, 8009, 8099, 8086, 6282,   24,
       5613, 7870, 8107, 7971, 6571, 8105, 6572, 8104, 6574]), 'topk_tokens': ['186', ' Jul', ' location', 'assistant', '4', ' Date', ' obtained', 'Question', ' return', ' goods', '\n\n', ' Daniel', ' Square', ' office', ' context', ' Daniel', ' before', ' dropped', ' football', ' football'], 'evidence_proportions': [0.5525634765625, 0.917578125, 3.0682373046875, 0.25135498046875]}}, 'pred_res': 'St. Paul<|eot_id|>', 'score': 0}
2025-01-22 05:19:09.873 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:19:09.873 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-56_pid-2_5-7-8-9.pkl | len: 3 |  size: 2.05 KB
Processing depth (5, 7, 8, 9):   3%|▎         | 3/100 [00:55<30:00, 18.57s/it]is_0k: False
your chose emoji: ['📧', '🎒', '🛤️', '💂🏽', '👊🏼', '✍🏾', '🧑🏽\u200d🦽', '🌩', '🌻', '\U0001fad8']
emoji:
O: 📧 [9468, 241, 100]
N: ✍🏾 [38798, 235, 9468, 237, 122]

O: 🎒 [9468, 236, 240]
N: 📧 [9468, 241, 100]

O: 🛤️ [9468, 249, 97, 31643]
N: 💂🏽 [93273, 224, 9468, 237, 121]

O: 💂🏽 [93273, 224, 9468, 237, 121]
N: 🎒 [9468, 236, 240]

O: 👊🏼 [9468, 239, 232, 9468, 237, 120]
N: 👊🏼 [9468, 239, 232, 9468, 237, 120]

O: ✍🏾 [38798, 235, 9468, 237, 122]
N: 🌩 [9468, 234, 102]

O: 🧑🏽‍🦽 [9468, 100, 239, 9468, 237, 121, 102470, 9468, 99, 121]
N: 🛤️ [9468, 249, 97, 31643]

O: 🌩 [9468, 234, 102]
N: 🧑🏽‍🦽 [9468, 100, 239, 9468, 237, 121, 102470, 9468, 99, 121]

O: 🌻 [9468, 234, 119]
N: 🌻 [9468, 234, 119]

O: 🫘 [9468, 41519]
N: 🫘 [9468, 41519]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.36s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.62s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.41s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  2.98s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.53s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (2, 5, 7, 9):   3%|▎         | 3/100 [01:11<30:00, 18.57s/it]2025-01-22 05:19:25.866 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went to the hallway.
2025-01-22 05:19:25.875 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1795, 1800) --> . Daniel went to the
2025-01-22 05:19:25.875 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the office.
2025-01-22 05:19:25.895 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4191, 4196) --> . Daniel moved to the
2025-01-22 05:19:25.896 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel dropped the football.
2025-01-22 05:19:25.926 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5649, 5653) -->  Daniel dropped the football
2025-01-22 05:19:25.927 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra picked up the apple.
2025-01-22 05:19:25.962 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7287, 7292) --> . Sandra picked up the
2025-01-22 05:19:25.962 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the hallway.
2025-01-22 05:19:25.982 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4098, 4103) --> . Sandra moved to the
2025-01-22 05:19:25.983 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the garden.
2025-01-22 05:19:26.003 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4138, 4144) --> . Sandra went back to the
2025-01-22 05:19:26.003 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the hallway.
2025-01-22 05:19:26.023 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3953, 3959) --> . Mary went back to the
2025-01-22 05:19:26.023 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra left the apple.
2025-01-22 05:19:26.046 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4611, 4615) -->  left the apple.
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:19:30.848 | INFO     | test_jbb_embedding:begin_test:693 - Daniel dropped the football.<|eot_id|>
2025-01-22 05:19:30.848 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8235])
2025-01-22 05:19:33.660 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [194.64473684210526, 20.49246441794125, 108.86160714285714, 19.86247598499634, 12.724798998786408], 'topk_indices': array([   9,    3, 1800, 8231,   23, 5588, 8233, 5587, 8225, 5648,   24,
       5655,   14, 5653, 8223, 8222, 5652, 8230, 5656,    0]), 'topk_tokens': [':', '<|end_header_id|>', ' hallway', '<|start_header_id|>', '4', ' One', '<|end_header_id|>', '.', ' office', '.', '\n\n', ' three', '\n', '.', ' before', ' football', ' football', '<|eot_id|>', ' or', '<|begin_of_text|>'], 'evidence_proportions': [213.7, 116.25, 462.625, 39.6]}, 'weight': {'score': [22.353207236842106, 23.34414071983491, 21.064732142857142, 23.352276279275433, 29.98801577669903], 'topk_indices': array([3364, 3337, 3257, 3209, 7466, 7504, 1493, 1431, 4362, 4378, 5291,
       5230, 7181, 7237, 3520, 3546, 4971, 5019, 5048, 4996]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.665625, 19.909375, 27.341796875, 23.49375]}, 'saliency': {'score': [1.2383101613898027, 0.11472433358322333, 0.5849725632440477, 0.11091567981996371, 0.09729263157520479], 'topk_indices': array([  23, 8219, 3959, 8204, 5179, 8133, 8217,   24, 1796, 5650, 8089,
       5588, 5649, 5655, 8225, 1800, 8223, 5656, 8222, 5652]), 'topk_tokens': ['4', ' Where', ' hallway', ' return', ' *', ' location', 'Question', '\n\n', ' Daniel', ' dropped', ' context', ' One', ' Daniel', ' three', ' office', ' hallway', ' before', ' or', ' football', ' football'], 'evidence_proportions': [1.208984375, 0.6572998046875, 3.2509765625, 0.23851318359375]}}, 'pred_res': 'Daniel dropped the football.<|eot_id|>', 'score': 0}
2025-01-22 05:19:33.665 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:19:33.665 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-56_pid-3_2-5-7-9.pkl | len: 3 |  size: 2.04 KB
Processing depth (2, 5, 7, 9):   4%|▍         | 4/100 [01:19<33:00, 20.63s/it]is_0k: False
your chose emoji: ['🧚🏿\u200d♂️', '👩🏻\u200d❤\u200d💋\u200d👨🏽', '🤶🏾', '🏌🏾\u200d♀', '👩\u200d🦼', '🕵🏾\u200d♀', '💆🏿\u200d♂', '🚶🏾\u200d♂\u200d➡️', '🧑🏾\u200d❤\u200d💋\u200d🧑🏼', '👱\u200d♂️']
emoji:
O: 🧚🏿‍♂️ [9468, 100, 248, 9468, 237, 123, 102470, 17245, 224, 31643]
N: 🏌🏾‍♀ [9468, 237, 234, 9468, 237, 122, 102470, 32990]

O: 👩🏻‍❤‍💋‍👨🏽 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 121]
N: 💆🏿‍♂ [93273, 228, 9468, 237, 123, 102470, 17245, 224]

O: 🤶🏾 [9468, 97, 114, 9468, 237, 122]
N: 🤶🏾 [9468, 97, 114, 9468, 237, 122]

O: 🏌🏾‍♀ [9468, 237, 234, 9468, 237, 122, 102470, 32990]
N: 🚶🏾‍♂‍➡️ [9468, 248, 114, 9468, 237, 122, 102470, 17245, 224, 102470, 98115, 94, 31643]

O: 👩‍🦼 [9468, 239, 102, 102470, 9468, 99, 120]
N: 👩🏻‍❤‍💋‍👨🏽 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 121]

O: 🕵🏾‍♀ [9468, 243, 113, 9468, 237, 122, 102470, 32990]
N: 🧚🏿‍♂️ [9468, 100, 248, 9468, 237, 123, 102470, 17245, 224, 31643]

O: 💆🏿‍♂ [93273, 228, 9468, 237, 123, 102470, 17245, 224]
N: 🕵🏾‍♀ [9468, 243, 113, 9468, 237, 122, 102470, 32990]

O: 🚶🏾‍♂‍➡️ [9468, 248, 114, 9468, 237, 122, 102470, 17245, 224, 102470, 98115, 94, 31643]
N: 🧑🏾‍❤‍💋‍🧑🏼 [9468, 100, 239, 9468, 237, 122, 102470, 121643, 102470, 93273, 233, 102470, 9468, 100, 239, 9468, 237, 120]

O: 🧑🏾‍❤‍💋‍🧑🏼 [9468, 100, 239, 9468, 237, 122, 102470, 121643, 102470, 93273, 233, 102470, 9468, 100, 239, 9468, 237, 120]
N: 👩‍🦼 [9468, 239, 102, 102470, 9468, 99, 120]

O: 👱‍♂️ [9468, 239, 109, 102470, 17245, 224, 31643]
N: 👱‍♂️ [9468, 239, 109, 102470, 17245, 224, 31643]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.92s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.64s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.94s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.39s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.92s/it]
Processing depth (0, 1, 2, 7):   4%|▍         | 4/100 [01:37<33:00, 20.63s/it]2025-01-22 05:19:51.182 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went to the hallway.
2025-01-22 05:19:51.183 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  went to the hallway.
2025-01-22 05:19:51.183 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the office.
2025-01-22 05:19:51.187 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (825, 830) --> . Daniel moved to the
2025-01-22 05:19:51.187 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel dropped the football.
2025-01-22 05:19:51.196 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1792, 1796) -->  Daniel dropped the football
2025-01-22 05:19:51.196 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra picked up the apple.
2025-01-22 05:19:51.233 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5553, 5558) --> . Sandra picked up the
2025-01-22 05:19:51.234 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the hallway.
2025-01-22 05:19:51.253 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4037, 4042) --> . Sandra moved to the
2025-01-22 05:19:51.253 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the garden.
2025-01-22 05:19:51.273 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4077, 4083) --> . Sandra went back to the
2025-01-22 05:19:51.273 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the hallway.
2025-01-22 05:19:51.293 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3892, 3898) --> . Mary went back to the
2025-01-22 05:19:51.293 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra left the apple.
2025-01-22 05:19:51.314 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4509, 4513) -->  Sandra left the apple
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:19:52.097 | INFO     | test_jbb_embedding:begin_test:693 - The hallway.<|eot_id|>
2025-01-22 05:19:52.097 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8131])
2025-01-22 05:19:54.330 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [261.3326480263158, 17.461031626506024, 45.430059523809526, 16.815996996231778, 12.553979013480392], 'topk_indices': array([  23, 7984, 1793, 8019,  830,    1,  831, 8121, 8119, 8127, 8118,
         24,   14, 8029,   34, 7985, 1795, 8129, 8126,    0]), 'topk_tokens': ['4', ' you', ' dropped', '.\n\n', ' office', '<|start_header_id|>', '.', ' office', ' before', '<|start_header_id|>', ' football', '\n\n', '\n', ' location', ' hallway', ' context', ' football', '<|end_header_id|>', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [358.15, 264.9, 438.40625, 19.2890625]}, 'weight': {'score': [22.67064144736842, 23.250837533808703, 22.49813988095238, 23.254152381393624, 29.30514705882353], 'topk_indices': array([3297, 3270, 3142, 3190, 7384, 7422, 1427, 1489, 4313, 4329, 5135,
       5196, 7087, 7143, 3453, 3479, 4960, 4937, 4989, 4912]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.871875, 19.909375, 27.341796875, 23.49375]}, 'saliency': {'score': [1.5870072214226973, 0.09770750032175897, 0.25504993257068453, 0.09380326437190165, 0.0920571719898897], 'topk_indices': array([8019, 7983, 7984,    0, 3898, 8100,  827,   24,  185,   31, 8119,
        830, 1793, 8121, 8113, 8118, 8029, 7985,   34, 1795]), 'topk_tokens': ['.\n\n', ' provided', ' you', '<|begin_of_text|>', ' hallway', ' return', ' moved', '\n\n', 'ION', ' went', ' before', ' office', ' dropped', ' office', 'Question', ' football', ' location', ' context', ' hallway', ' football'], 'evidence_proportions': [2.17646484375, 1.32646484375, 3.00927734375, 0.12027587890625]}}, 'pred_res': 'The hallway.<|eot_id|>', 'score': 100}
2025-01-22 05:19:54.337 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:19:54.337 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-56_pid-4_0-1-2-7.pkl | len: 3 |  size: 2.07 KB
Processing depth (0, 1, 2, 7):   5%|▌         | 5/100 [01:40<32:41, 20.64s/it]Processing depth (0, 1, 2, 7):   5%|▌         | 5/100 [01:40<31:49, 20.10s/it]
2025-01-22 05:19:54.489 | INFO     | __main__:<module>:82 - Selected idx: 57
2025-01-22 05:19:54.490 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the location prior to the place where the milk was discarded, left or dropped?
2025-01-22 05:19:54.490 | INFO     | __main__:<module>:84 - Answer: hallway
2025-01-22 05:19:54.490 | INFO     | __main__:<module>:85 - Tag: 4-hop
2025-01-22 05:19:54.490 | INFO     | __main__:<module>:86 - Needle: [' Mary went back to the hallway.', ' Daniel went to the hallway.', ' Sandra moved to the hallway.', ' Sandra picked up the apple.', ' Daniel took the milk.', ' Sandra left the apple.', ' Daniel moved to the office.', ' Sandra went back to the garden.', ' Daniel dropped the milk.', ' Sandra picked up the apple.']
2025-01-22 05:19:54.490 | INFO     | __main__:<module>:87 - Real Needle: [' Daniel went to the hallway.', ' Daniel took the milk.', ' Daniel moved to the office.', ' Daniel dropped the milk.', ' Sandra picked up the apple.']
2025-01-22 05:19:54.490 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['🧗🏾\u200d♀️', '🧇', '🏳️', '🏣', '🦸🏼\u200d♂', '🉐', '👨🏼\u200d💻', '\U0001f6df', '🧚\u200d♀', '🧷']
emoji:
O: 🧗🏾‍♀️ [9468, 100, 245, 9468, 237, 122, 102470, 32990, 31643]
N: 🧚‍♀ [9468, 100, 248, 102470, 32990]

O: 🧇 [9468, 100, 229]
N: 🛟 [9468, 249, 253]

O: 🏳️ [9468, 237, 111, 31643]
N: 🏣 [9468, 237, 96]

O: 🏣 [9468, 237, 96]
N: 🉐 [9468, 231, 238]

O: 🦸🏼‍♂ [9468, 99, 116, 9468, 237, 120, 102470, 17245, 224]
N: 🏳️ [9468, 237, 111, 31643]

O: 🉐 [9468, 231, 238]
N: 👨🏼‍💻 [9468, 239, 101, 9468, 237, 120, 102470, 93273, 119]

O: 👨🏼‍💻 [9468, 239, 101, 9468, 237, 120, 102470, 93273, 119]
N: 🧗🏾‍♀️ [9468, 100, 245, 9468, 237, 122, 102470, 32990, 31643]

O: 🛟 [9468, 249, 253]
N: 🧇 [9468, 100, 229]

O: 🧚‍♀ [9468, 100, 248, 102470, 32990]
N: 🦸🏼‍♂ [9468, 99, 116, 9468, 237, 120, 102470, 17245, 224]

O: 🧷 [9468, 100, 115]
N: 🧷 [9468, 100, 115]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:11,  3.88s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.16s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.20s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.93s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.37s/it]
Processing depth (1, 3, 6, 7, 9):   0%|          | 0/100 [00:15<?, ?it/s]2025-01-22 05:20:09.747 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went to the hallway.
2025-01-22 05:20:09.752 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (821, 826) --> . Daniel went to the
2025-01-22 05:20:09.752 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel took the milk.
2025-01-22 05:20:09.768 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2884, 2888) -->  Daniel took the milk
2025-01-22 05:20:09.768 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 05:20:09.792 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4651, 4656) -->  Daniel moved to the office
2025-01-22 05:20:09.792 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel dropped the milk.
2025-01-22 05:20:09.818 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5613, 5617) -->  Daniel dropped the milk
2025-01-22 05:20:09.819 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra picked up the apple.
2025-01-22 05:20:09.855 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7171, 7176) -->  Sandra picked up the apple
2025-01-22 05:20:09.855 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary went back to the hallway.
2025-01-22 05:20:09.870 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2944, 2950) --> . Mary went back to the
2025-01-22 05:20:09.870 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the hallway.
2025-01-22 05:20:09.898 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5715, 5720) --> . Sandra moved to the
2025-01-22 05:20:09.898 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra left the apple.
2025-01-22 05:20:09.917 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4018, 4022) -->  Sandra left the apple
2025-01-22 05:20:09.918 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the garden.
2025-01-22 05:20:09.959 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7097, 7103) --> . Sandra went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:20:10.755 | INFO     | test_jbb_embedding:begin_test:693 - The office.<|eot_id|>
2025-01-22 05:20:10.755 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8215])
2025-01-22 05:20:12.997 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [488.23777173913044, 44.14486493064006, 326.58035714285717, 42.169665249571814, 47.244867369186046], 'topk_indices': array([ 822, 8189, 8211, 2888,  823, 7606, 8104, 4652, 8200, 7562,  827,
       7607,   14,   24, 5616, 8195, 8210,  826, 2950,    0]), 'topk_tokens': [' Daniel', ':', '<|start_header_id|>', '.', ' went', ' Min', ' location', ' moved', ' milk', 'nes', '.', 'nes', '\n', '\n\n', ' milk', ' to', '<|eot_id|>', ' hallway', ' hallway', '<|begin_of_text|>'], 'evidence_proportions': [642.9, 515.125, 618.5, 629.1875, 69.04375]}, 'weight': {'score': [24.891304347826086, 23.301403930396692, 22.49813988095238, 23.298993951859554, 29.32122093023256], 'topk_indices': array([3297, 3324, 3169, 3217, 7499, 7461, 1425, 1487, 4343, 4359, 5255,
       5194, 7238, 7182, 3506, 3480, 4996, 5048, 5019, 4971]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.665625, 26.498046875, 23.9234375, 27.013671875, 28.1015625]}, 'saliency': {'score': [3.0712890625, 0.24953610904607265, 1.9539736793154763, 0.23721735361359186, 0.339161895042242], 'topk_indices': array([2945, 4018, 8197, 8198,  257, 8188, 2887, 8104,  823, 4652, 8194,
       7606, 7607, 7562,  822, 8200, 8202, 5616,  826, 2950]), 'topk_tokens': [' Mary', ' Sandra', ' place', ' where', 'hue', 'Question', ' milk', ' location', ' went', ' moved', ' prior', ' Min', 'nes', 'nes', ' Daniel', ' milk', ' discarded', ' milk', ' hallway', ' hallway'], 'evidence_proportions': [3.6017578125, 3.6417236328125, 3.66953125, 4.32373046875, 0.48427734375]}}, 'pred_res': 'The office.<|eot_id|>', 'score': 0}
2025-01-22 05:20:13.019 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:20:13.019 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-57_pid-0_1-3-6-7-9.pkl | len: 3 |  size: 2.05 KB
Processing depth (1, 3, 6, 7, 9):   1%|          | 1/100 [00:18<30:24, 18.43s/it]is_0k: False
your chose emoji: ['🧚🏻', '🧗🏽\u200d♂', '⛹🏽\u200d♂', '🧵', '🧑🏽\u200d⚕️', '👨🏼\u200d❤️\u200d💋\u200d👨🏿', '🇭🇳', '🅱️', '🧑🏼\u200d🤝\u200d🧑🏾', '🦬']
emoji:
O: 🧚🏻 [9468, 100, 248, 9468, 237, 119]
N: 🧚🏻 [9468, 100, 248, 9468, 237, 119]

O: 🧗🏽‍♂ [9468, 100, 245, 9468, 237, 121, 102470, 17245, 224]
N: 🅱️ [9468, 227, 109, 31643]

O: ⛹🏽‍♂ [158, 249, 117, 9468, 237, 121, 102470, 17245, 224]
N: 🧑🏽‍⚕️ [9468, 100, 239, 9468, 237, 121, 102470, 158, 248, 243, 31643]

O: 🧵 [9468, 100, 113]
N: 🇭🇳 [9468, 229, 255, 9468, 229, 111]

O: 🧑🏽‍⚕️ [9468, 100, 239, 9468, 237, 121, 102470, 158, 248, 243, 31643]
N: ⛹🏽‍♂ [158, 249, 117, 9468, 237, 121, 102470, 17245, 224]

O: 👨🏼‍❤️‍💋‍👨🏿 [9468, 239, 101, 9468, 237, 120, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 123]
N: 🧵 [9468, 100, 113]

O: 🇭🇳 [9468, 229, 255, 9468, 229, 111]
N: 👨🏼‍❤️‍💋‍👨🏿 [9468, 239, 101, 9468, 237, 120, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 123]

O: 🅱️ [9468, 227, 109, 31643]
N: 🧑🏼‍🤝‍🧑🏾 [9468, 100, 239, 9468, 237, 120, 102470, 9468, 97, 251, 102470, 9468, 100, 239, 9468, 237, 122]

O: 🧑🏼‍🤝‍🧑🏾 [9468, 100, 239, 9468, 237, 120, 102470, 9468, 97, 251, 102470, 9468, 100, 239, 9468, 237, 122]
N: 🧗🏽‍♂ [9468, 100, 245, 9468, 237, 121, 102470, 17245, 224]

O: 🦬 [9468, 57923]
N: 🦬 [9468, 57923]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:11,  3.93s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.30s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.10s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  2.67s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  3.21s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (2, 3, 6, 8, 9):   1%|          | 1/100 [00:32<30:24, 18.43s/it]2025-01-22 05:20:27.628 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went to the hallway.
2025-01-22 05:20:27.638 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1855, 1860) --> . Daniel went to the
2025-01-22 05:20:27.638 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel took the milk.
2025-01-22 05:20:27.653 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2926, 2930) -->  Daniel took the milk
2025-01-22 05:20:27.653 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 05:20:27.677 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4758, 4763) -->  the senate. Daniel moved
2025-01-22 05:20:27.677 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel dropped the milk.
2025-01-22 05:20:27.714 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6515, 6519) -->  Daniel dropped the milk
2025-01-22 05:20:27.714 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra picked up the apple.
2025-01-22 05:20:27.754 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7131, 7136) -->  Sandra picked up the apple
2025-01-22 05:20:27.755 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary went back to the hallway.
2025-01-22 05:20:27.769 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2987, 2993) -->  tragedy. Mary went back to
2025-01-22 05:20:27.769 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the hallway.
2025-01-22 05:20:27.799 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5662, 5667) --> . Sandra moved to the
2025-01-22 05:20:27.799 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra left the apple.
2025-01-22 05:20:27.818 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4076, 4080) -->  Sandra left the apple
2025-01-22 05:20:27.818 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the garden.
2025-01-22 05:20:27.853 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7057, 7063) --> . Sandra went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:20:31.622 | INFO     | test_jbb_embedding:begin_test:693 - The office.<|eot_id|>
2025-01-22 05:20:31.622 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8183])
2025-01-22 05:20:34.686 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [447.7404891304348, 33.97672474346445, 174.05357142857142, 32.44661170474085, 22.428599330357144], 'topk_indices': array([2926,   14, 8176, 2897, 8177, 8175, 6516, 8028, 8168, 2925, 4762,
       8157, 8156, 6519, 6518, 2930, 2929,    0, 8178, 8179]), 'topk_tokens': [' Daniel', '\n', 'Answer', '.', ':', '?\n', ' dropped', ' context', ' milk', '.', ' moved', ':', 'Question', '.', ' milk', '.', ' milk', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [378.8, 766.5, 418.45, 756.0625, 44.30625]}, 'weight': {'score': [25.046535326086957, 23.279848979965795, 23.88095238095238, 23.273307963338247, 29.436830357142856], 'topk_indices': array([3298, 3271, 3191, 3143, 7421, 7459, 1399, 1461, 4291, 4307, 5114,
       5175, 7142, 7198, 3466, 3492, 4962, 4933, 4910, 4885]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.665625, 26.498046875, 24.6375, 27.013671875, 28.1015625]}, 'saliency': {'score': [2.952013098675272, 0.18975703325418397, 1.1159900483630953, 0.17956509235244336, 0.1667356218610491], 'topk_indices': array([2927, 2896, 6515, 4761, 2898, 8170, 4765, 2926, 8162, 2924, 8176,
       2994, 1860, 6516, 8028, 4762, 8168, 8156, 6518, 2929]), 'topk_tokens': [' took', ' Gov', ' Daniel', ' Daniel', ' During', ' discarded', ' office', ' Daniel', ' prior', ' Gov', 'Answer', ' hallway', ' hallway', ' dropped', ' context', ' moved', ' milk', 'Question', ' milk', ' milk'], 'evidence_proportions': [2.06416015625, 5.3291015625, 2.795947265625, 5.1728515625, 0.31759033203125]}}, 'pred_res': 'The office.<|eot_id|>', 'score': 0}
2025-01-22 05:20:34.692 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:20:34.692 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-57_pid-1_2-3-6-8-9.pkl | len: 3 |  size: 2.05 KB
Processing depth (2, 3, 6, 8, 9):   2%|▏         | 2/100 [00:40<33:13, 20.34s/it]is_0k: False
your chose emoji: ['🙋🏻\u200d♀️', '🧑\u200d🎨', '\U0001faf0', '🧑🏾\u200d🏭', '🛤️', '🧑🏽\u200d🦼\u200d➡', '🦶🏾', '🍆', '🙎🏻\u200d♀️', '🇳🇺']
emoji:
O: 🙋🏻‍♀️ [9468, 247, 233, 9468, 237, 119, 102470, 32990, 31643]
N: 🧑🏾‍🏭 [9468, 100, 239, 9468, 237, 122, 102470, 9468, 237, 255]

O: 🧑‍🎨 [9468, 100, 239, 102470, 9468, 236, 101]
N: 🛤️ [9468, 249, 97, 31643]

O: 🫰 [9468, 104, 108]
N: 🦶🏾 [9468, 99, 114, 9468, 237, 122]

O: 🧑🏾‍🏭 [9468, 100, 239, 9468, 237, 122, 102470, 9468, 237, 255]
N: 🙎🏻‍♀️ [9468, 247, 236, 9468, 237, 119, 102470, 32990, 31643]

O: 🛤️ [9468, 249, 97, 31643]
N: 🫰 [9468, 104, 108]

O: 🧑🏽‍🦼‍➡ [9468, 100, 239, 9468, 237, 121, 102470, 9468, 99, 120, 102470, 98115, 94]
N: 🍆 [9468, 235, 228]

O: 🦶🏾 [9468, 99, 114, 9468, 237, 122]
N: 🙋🏻‍♀️ [9468, 247, 233, 9468, 237, 119, 102470, 32990, 31643]

O: 🍆 [9468, 235, 228]
N: 🧑‍🎨 [9468, 100, 239, 102470, 9468, 236, 101]

O: 🙎🏻‍♀️ [9468, 247, 236, 9468, 237, 119, 102470, 32990, 31643]
N: 🧑🏽‍🦼‍➡ [9468, 100, 239, 9468, 237, 121, 102470, 9468, 99, 120, 102470, 98115, 94]

O: 🇳🇺 [9468, 229, 111, 9468, 229, 118]
N: 🇳🇺 [9468, 229, 111, 9468, 229, 118]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.11s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.27s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.35s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.07s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.51s/it]
Processing depth (1, 3, 4, 8, 9):   2%|▏         | 2/100 [00:55<33:13, 20.34s/it]2025-01-22 05:20:50.381 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went to the hallway.
2025-01-22 05:20:50.386 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (895, 900) --> . Daniel went to the
2025-01-22 05:20:50.386 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel took the milk.
2025-01-22 05:20:50.400 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2922, 2926) -->  Daniel took the milk
2025-01-22 05:20:50.400 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 05:20:50.419 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3616, 3621) -->  Hon. Daniel moved to
2025-01-22 05:20:50.420 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel dropped the milk.
2025-01-22 05:20:50.451 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6593, 6597) -->  Daniel dropped the milk
2025-01-22 05:20:50.451 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra picked up the apple.
2025-01-22 05:20:50.489 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7234, 7239) --> . Sandra picked up the
2025-01-22 05:20:50.489 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary went back to the hallway.
2025-01-22 05:20:50.504 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2939, 2945) -->  Mary went back to the hallway
2025-01-22 05:20:50.504 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the hallway.
2025-01-22 05:20:50.533 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6059, 6064) -->  Sandra moved to the hallway
2025-01-22 05:20:50.534 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra left the apple.
2025-01-22 05:20:50.553 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4112, 4116) -->  Sandra left the apple
2025-01-22 05:20:50.553 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the garden.
2025-01-22 05:20:50.588 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7083, 7089) --> . Sandra went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:20:51.387 | INFO     | test_jbb_embedding:begin_test:693 - The hallway.<|eot_id|>
2025-01-22 05:20:51.388 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8181])
2025-01-22 05:20:53.600 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [245.60326086956522, 19.52026438782991, 96.72619047619048, 18.682275030712532, 12.703889266304348], 'topk_indices': array([ 896, 2944,   24, 8160, 8175, 8153, 8165, 8060,  257, 8155, 8180,
       8161,  897, 8179, 3619,   14,  900,    0, 8176, 8177]), 'topk_tokens': [' Daniel', ' hallway', '\n\n', ' prior', ':', '.\n\n', ' the', '.\n\n', 'hue', ':', '\n\n', ' to', ' went', '<|end_header_id|>', ' moved', '\n', ' hallway', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [388.65, 233.71875, 316.825, 276.875, 15.825]}, 'weight': {'score': [24.062160326086957, 23.28011210899316, 25.400669642857142, 23.272431664619166, 29.541666666666668], 'topk_indices': array([3279, 3306, 3199, 3151, 7451, 7413, 1485, 1423, 4297, 4281, 5096,
       5157, 7128, 7184, 3488, 3462, 4950, 4898, 4873, 4921]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.665625, 26.498046875, 24.7171875, 27.013671875, 23.49375]}, 'saliency': {'score': [1.471129044242527, 0.10702936763521047, 0.6598917643229166, 0.10174872845923871, 0.09444958230723506], 'topk_indices': array([6593, 8180, 8153, 8060,   14, 8163, 8174, 2947, 2925, 6596, 8168,
       8026, 8154,  896, 8160,  897, 3619,  257, 2944,  900]), 'topk_tokens': [' Daniel', '\n\n', '.\n\n', '.\n\n', '\n', ' place', 'Answer', 'ible', ' milk', ' milk', ' discarded', ' context', 'Question', ' Daniel', ' prior', ' went', ' moved', 'hue', ' hallway', ' hallway'], 'evidence_proportions': [2.0904296875, 1.6287841796875, 1.78759765625, 1.867431640625, 0.092193603515625]}}, 'pred_res': 'The hallway.<|eot_id|>', 'score': 100}
2025-01-22 05:20:53.607 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:20:53.607 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-57_pid-2_1-3-4-8-9.pkl | len: 3 |  size: 2.05 KB
Processing depth (1, 3, 4, 8, 9):   3%|▎         | 3/100 [00:59<31:49, 19.69s/it]is_0k: False
your chose emoji: ['〽', '🤵🏼\u200d♀', '👨🏿\u200d❤️\u200d💋\u200d👨🏽', '👱', '🙋🏽', '🙍🏾', '🏋🏽\u200d♂', '\U0001faf1🏾', '👨🏼\u200d💻', '♠']
emoji:
O: 〽 [1300, 121]
N: 👨🏼‍💻 [9468, 239, 101, 9468, 237, 120, 102470, 93273, 119]

O: 🤵🏼‍♀ [9468, 97, 113, 9468, 237, 120, 102470, 32990]
N: 👱 [9468, 239, 109]

O: 👨🏿‍❤️‍💋‍👨🏽 [9468, 239, 101, 9468, 237, 123, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 121]
N: 🙋🏽 [9468, 247, 233, 9468, 237, 121]

O: 👱 [9468, 239, 109]
N: 🫱🏾 [9468, 104, 109, 9468, 237, 122]

O: 🙋🏽 [9468, 247, 233, 9468, 237, 121]
N: 〽 [1300, 121]

O: 🙍🏾 [9468, 247, 235, 9468, 237, 122]
N: 🙍🏾 [9468, 247, 235, 9468, 237, 122]

O: 🏋🏽‍♂ [9468, 237, 233, 9468, 237, 121, 102470, 17245, 224]
N: 🏋🏽‍♂ [9468, 237, 233, 9468, 237, 121, 102470, 17245, 224]

O: 🫱🏾 [9468, 104, 109, 9468, 237, 122]
N: 👨🏿‍❤️‍💋‍👨🏽 [9468, 239, 101, 9468, 237, 123, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 121]

O: 👨🏼‍💻 [9468, 239, 101, 9468, 237, 120, 102470, 93273, 119]
N: 🤵🏼‍♀ [9468, 97, 113, 9468, 237, 120, 102470, 32990]

O: ♠ [121324]
N: ♠ [121324]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.31s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.22s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.01s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.78s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.28s/it]
Processing depth (0, 2, 3, 5, 6):   3%|▎         | 3/100 [01:13<31:49, 19.69s/it]2025-01-22 05:21:08.489 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went to the hallway.
2025-01-22 05:21:08.489 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  went to the hallway.
2025-01-22 05:21:08.489 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel took the milk.
2025-01-22 05:21:08.498 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1854, 1858) -->  Daniel took the milk
2025-01-22 05:21:08.498 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 05:21:08.513 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2971, 2976) -->  tragedy. Daniel moved to
2025-01-22 05:21:08.513 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel dropped the milk.
2025-01-22 05:21:08.533 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4228, 4232) -->  dropped the milk.
2025-01-22 05:21:08.533 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra picked up the apple.
2025-01-22 05:21:08.557 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4895, 4900) --> . Sandra picked up the
2025-01-22 05:21:08.557 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary went back to the hallway.
2025-01-22 05:21:08.572 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3060, 3066) --> . Mary went back to the
2025-01-22 05:21:08.572 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the hallway.
2025-01-22 05:21:08.602 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6167, 6172) --> . Sandra moved to the
2025-01-22 05:21:08.602 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra left the apple.
2025-01-22 05:21:08.622 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4183, 4187) -->  left the apple.
2025-01-22 05:21:08.622 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the garden.
2025-01-22 05:21:08.657 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7092, 7098) -->  Sandra went back to the garden
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:21:09.423 | INFO     | test_jbb_embedding:begin_test:693 - The hallway.<|eot_id|>
2025-01-22 05:21:09.423 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8177])
2025-01-22 05:21:11.631 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [218.1351902173913, 20.855915724327627, 92.44270833333333, 20.11344449053589, 15.88075734608209], 'topk_indices': array([8175, 2974, 2970, 2975,   29,   23, 2977, 8150, 8149, 8151, 3066,
         34,   14,   24, 3081,   35, 2942, 8172,    0, 8173]), 'topk_tokens': ['<|end_header_id|>', ' moved', ' the', ' to', '\n\n', '4', ' office', 'Question', '.\n\n', ':', ' hallway', ' hallway', '\n', '\n\n', 'ern', '.', ' tragedy', '<|eot_id|>', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [360.55, 235.96875, 256.41875, 208.28125, 31.053125]}, 'weight': {'score': [23.478940217391305, 23.27989379584352, 22.139508928571427, 23.28227457442232, 29.70265858208955], 'topk_indices': array([3288, 3261, 3181, 3133, 7433, 7395, 1467, 1405, 4278, 4294, 5095,
       5156, 7160, 7104, 3444, 3470, 4891, 4949, 4920, 4866]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.871875, 26.498046875, 25.7171875, 20.90234375, 23.49375]}, 'saliency': {'score': [1.2638894786005435, 0.11726117495511156, 0.497802734375, 0.11303749947186885, 0.11897118411847014], 'topk_indices': array([  23, 8170,   36, 2939, 8149, 3080,   24,   39, 8164,   38,   31,
       8156, 2974, 1857, 2977, 3081, 8150, 3066,   34, 2942]), 'topk_tokens': ['4', 'Answer', ' PA', ' connected', '.\n\n', ' const', '\n\n', '\n\n\n', ' discarded', '***', ' went', ' prior', ' moved', ' milk', ' office', 'ern', 'Question', ' hallway', ' hallway', ' tragedy'], 'evidence_proportions': [2.03037109375, 1.611083984375, 1.42265625, 1.0938720703125, 0.1968994140625]}}, 'pred_res': 'The hallway.<|eot_id|>', 'score': 100}
2025-01-22 05:21:11.637 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:21:11.638 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-57_pid-3_0-2-3-5-6.pkl | len: 3 |  size: 2.06 KB
Processing depth (0, 2, 3, 5, 6):   4%|▍         | 4/100 [01:17<30:27, 19.03s/it]is_0k: False
your chose emoji: ['🧜🏾\u200d♂', '🧖🏽', '🚴\u200d♀️', '🧍\u200d♂️', '🧔🏽', '👨🏿\u200d🦼\u200d➡️', '👆', '🏌🏼\u200d♀', '👱\u200d♂', '☯']
emoji:
O: 🧜🏾‍♂ [9468, 100, 250, 9468, 237, 122, 102470, 17245, 224]
N: 🧔🏽 [9468, 100, 242, 9468, 237, 121]

O: 🧖🏽 [9468, 100, 244, 9468, 237, 121]
N: 🧖🏽 [9468, 100, 244, 9468, 237, 121]

O: 🚴‍♀️ [9468, 248, 112, 102470, 32990, 31643]
N: 🏌🏼‍♀ [9468, 237, 234, 9468, 237, 120, 102470, 32990]

O: 🧍‍♂️ [9468, 100, 235, 102470, 17245, 224, 31643]
N: 🧜🏾‍♂ [9468, 100, 250, 9468, 237, 122, 102470, 17245, 224]

O: 🧔🏽 [9468, 100, 242, 9468, 237, 121]
N: 👆 [9468, 239, 228]

O: 👨🏿‍🦼‍➡️ [9468, 239, 101, 9468, 237, 123, 102470, 9468, 99, 120, 102470, 98115, 94, 31643]
N: 🚴‍♀️ [9468, 248, 112, 102470, 32990, 31643]

O: 👆 [9468, 239, 228]
N: 🧍‍♂️ [9468, 100, 235, 102470, 17245, 224, 31643]

O: 🏌🏼‍♀ [9468, 237, 234, 9468, 237, 120, 102470, 32990]
N: 👱‍♂ [9468, 239, 109, 102470, 17245, 224]

O: 👱‍♂ [9468, 239, 109, 102470, 17245, 224]
N: 👨🏿‍🦼‍➡️ [9468, 239, 101, 9468, 237, 123, 102470, 9468, 99, 120, 102470, 98115, 94, 31643]

O: ☯ [18107, 107]
N: ☯ [18107, 107]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.40s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.77s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.48s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.06s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.61s/it]
Processing depth (0, 3, 4, 5, 9):   4%|▍         | 4/100 [01:33<30:27, 19.03s/it]2025-01-22 05:21:27.913 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went to the hallway.
2025-01-22 05:21:27.913 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  went to the hallway.
2025-01-22 05:21:27.914 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel took the milk.
2025-01-22 05:21:27.926 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2615, 2619) -->  took the milk.
2025-01-22 05:21:27.926 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 05:21:27.943 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3528, 3533) -->  Daniel moved to the office
2025-01-22 05:21:27.944 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel dropped the milk.
2025-01-22 05:21:27.963 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4141, 4145) -->  Daniel dropped the milk
2025-01-22 05:21:27.964 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra picked up the apple.
2025-01-22 05:21:27.998 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7155, 7160) -->  Sandra picked up the apple
2025-01-22 05:21:27.999 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary went back to the hallway.
2025-01-22 05:21:28.012 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2768, 2774) --> . Mary went back to the
2025-01-22 05:21:28.012 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the hallway.
2025-01-22 05:21:28.040 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5669, 5674) --> . Sandra moved to the
2025-01-22 05:21:28.040 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra left the apple.
2025-01-22 05:21:28.060 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4026, 4030) -->  Sandra left the apple
2025-01-22 05:21:28.060 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the garden.
2025-01-22 05:21:28.094 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7081, 7087) --> . Sandra went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:21:28.888 | INFO     | test_jbb_embedding:begin_test:693 - The hallway.<|eot_id|>
2025-01-22 05:21:28.888 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8207])
2025-01-22 05:21:31.120 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [298.9741847826087, 23.147636266747867, 100.21130952380952, 22.17257531227039, 35.0921660632622], 'topk_indices': array([4145,   34,   14, 2617,   25, 8179, 4144, 8192, 8186, 8194, 8201,
       2774, 2618, 8181, 8199, 8187,  549,    0, 8202, 8203]), 'topk_tokens': ['.', ' hallway', '\n', ' milk', '<|eot_id|>', '.\n\n', ' milk', ' milk', ' prior', ' discarded', ':', ' hallway', '.', ':', '?\n', ' to', ',', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [365.65, 438.5625, 321.025, 376.84375, 36.28125]}, 'weight': {'score': [24.09069293478261, 23.298235764311816, 22.49813988095238, 23.298061321332355, 29.44607469512195], 'topk_indices': array([3341, 3368, 3261, 3213, 7445, 7483, 1421, 1483, 4372, 4356, 5201,
       5262, 7222, 7166, 3576, 3550, 5055, 5026, 5003, 4978]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.871875, 20.38671875, 23.9234375, 27.013671875, 28.1015625]}, 'saliency': {'score': [1.7681141728940217, 0.1229289232595539, 0.5832752046130952, 0.11711132190638011, 0.25807134116568214], 'topk_indices': array([ 433,   31, 8179, 8189, 4142, 8190, 3161, 2614, 3532, 8182, 8199,
       8200, 2617, 8180, 4144, 8192, 8186,   34, 8194, 2774]), 'topk_tokens': ['000', ' went', '.\n\n', ' place', ' dropped', ' where', 'ern', ' Daniel', ' office', ' Where', '?\n', 'Answer', ' milk', 'Question', ' milk', ' milk', ' prior', ' hallway', ' discarded', ' hallway'], 'evidence_proportions': [2.07255859375, 2.301025390625, 1.898046875, 2.5830078125, 0.2554931640625]}}, 'pred_res': 'The hallway.<|eot_id|>', 'score': 100}
2025-01-22 05:21:31.126 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:21:31.126 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-57_pid-4_0-3-4-5-9.pkl | len: 3 |  size: 2.05 KB
Processing depth (0, 3, 4, 5, 9):   5%|▌         | 5/100 [01:36<30:23, 19.20s/it]Processing depth (0, 3, 4, 5, 9):   5%|▌         | 5/100 [01:36<30:35, 19.32s/it]
2025-01-22 05:21:31.198 | INFO     | __main__:<module>:82 - Selected idx: 58
2025-01-22 05:21:31.198 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the apple before the bedroom? 
2025-01-22 05:21:31.198 | INFO     | __main__:<module>:84 - Answer: office
2025-01-22 05:21:31.199 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 05:21:31.199 | INFO     | __main__:<module>:86 - Needle: [' Sandra moved to the hallway.', ' Mary went back to the hallway.', ' Sandra left the apple.', ' Daniel moved to the office.', ' Sandra went back to the garden.', ' Sandra picked up the apple.', ' Sandra picked up the apple.', ' John went back to the hallway.', ' Daniel went back to the bedroom.', ' Daniel left the apple.', ' Sandra dropped the apple.']
2025-01-22 05:21:31.199 | INFO     | __main__:<module>:87 - Real Needle: [' Daniel moved to the office.', ' Daniel went back to the bedroom.', ' Daniel left the apple.', ' Sandra dropped the apple.']
2025-01-22 05:21:31.199 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['👩🏼\u200d🏭', '🌮', '❇', '🖖', '👩🏼\u200d🦽\u200d➡️', '🧑🏿\u200d🦰', '👩🏿\u200d❤️\u200d👩🏿', '👩🏼\u200d❤\u200d👩🏾', '🙌', '🏄🏽']
emoji:
O: 👩🏼‍🏭 [9468, 239, 102, 9468, 237, 120, 102470, 9468, 237, 255]
N: ❇ [49633, 229]

O: 🌮 [9468, 234, 106]
N: 🙌 [9468, 247, 234]

O: ❇ [49633, 229]
N: 🌮 [9468, 234, 106]

O: 🖖 [9468, 244, 244]
N: 🧑🏿‍🦰 [9468, 100, 239, 9468, 237, 123, 102470, 9468, 99, 108]

O: 👩🏼‍🦽‍➡️ [9468, 239, 102, 9468, 237, 120, 102470, 9468, 99, 121, 102470, 98115, 94, 31643]
N: 👩🏼‍❤‍👩🏾 [9468, 239, 102, 9468, 237, 120, 102470, 121643, 102470, 9468, 239, 102, 9468, 237, 122]

O: 🧑🏿‍🦰 [9468, 100, 239, 9468, 237, 123, 102470, 9468, 99, 108]
N: 👩🏿‍❤️‍👩🏿 [9468, 239, 102, 9468, 237, 123, 102470, 121643, 31643, 102470, 9468, 239, 102, 9468, 237, 123]

O: 👩🏿‍❤️‍👩🏿 [9468, 239, 102, 9468, 237, 123, 102470, 121643, 31643, 102470, 9468, 239, 102, 9468, 237, 123]
N: 👩🏼‍🏭 [9468, 239, 102, 9468, 237, 120, 102470, 9468, 237, 255]

O: 👩🏼‍❤‍👩🏾 [9468, 239, 102, 9468, 237, 120, 102470, 121643, 102470, 9468, 239, 102, 9468, 237, 122]
N: 🖖 [9468, 244, 244]

O: 🙌 [9468, 247, 234]
N: 👩🏼‍🦽‍➡️ [9468, 239, 102, 9468, 237, 120, 102470, 9468, 99, 121, 102470, 98115, 94, 31643]

O: 🏄🏽 [9468, 237, 226, 9468, 237, 121]
N: 🏄🏽 [9468, 237, 226, 9468, 237, 121]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:11,  3.91s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.25s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:11<00:03,  3.95s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  2.60s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  3.13s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 4, 5, 9):   0%|          | 0/100 [00:14<?, ?it/s]2025-01-22 05:21:45.534 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the office.
2025-01-22 05:21:45.535 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  moved to the office.
2025-01-22 05:21:45.535 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went back to the bedroom.
2025-01-22 05:21:45.562 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3645, 3651) -->  Hon. Daniel went back to
2025-01-22 05:21:45.562 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel left the apple.
2025-01-22 05:21:45.583 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4231, 4235) -->  left the apple.
2025-01-22 05:21:45.583 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra dropped the apple.
2025-01-22 05:21:45.623 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7280, 7284) -->  Sandra dropped the apple
2025-01-22 05:21:45.624 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the hallway.
2025-01-22 05:21:45.661 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6419, 6424) --> . Sandra moved to the
2025-01-22 05:21:45.662 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went back to the hallway.
2025-01-22 05:21:45.671 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1599, 1605) --> . Mary went back to the
2025-01-22 05:21:45.672 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra left the apple.
2025-01-22 05:21:45.702 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5603, 5607) -->  Sandra left the apple
2025-01-22 05:21:45.702 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the garden.
2025-01-22 05:21:45.715 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2529, 2535) --> . Sandra went back to the
2025-01-22 05:21:45.715 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra picked up the apple.
2025-01-22 05:21:45.741 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4724, 4729) --> . Sandra picked up the
2025-01-22 05:21:45.741 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra picked up the apple.
2025-01-22 05:21:45.769 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (4724, 4729) --> . Sandra picked up the
2025-01-22 05:21:45.769 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  John went back to the hallway.
2025-01-22 05:21:45.779 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (1600, 1606) -->  Mary went back to the hallway
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:21:48.995 | INFO     | test_jbb_embedding:begin_test:693 - the hallway<|eot_id|>
2025-01-22 05:21:48.995 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8158])
2025-01-22 05:21:52.130 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [905.4276315789474, 66.31542585784314, 465.38513513513516, 62.5260982230997, 41.14339488636364], 'topk_indices': array([  34, 3343, 3653, 8156,   32,   31, 3650, 3344,   14, 8148, 3345,
         24, 3318, 8149, 3651, 8146, 3346, 8153,    0, 8154]), 'topk_tokens': [' office', '\n', '.', '<|end_header_id|>', ' to', ' moved', ' to', 'f', '\n', ' bedroom', 'iring', '\n\n', 'iring', '?', ' the', ' before', ' a', '<|eot_id|>', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [1274.8, 958.9583333333334, 1024.125, 244.71875]}, 'weight': {'score': [23.18174342105263, 23.25679572610294, 23.300675675675677, 23.256771347482726, 29.173011363636363], 'topk_indices': array([3335, 3308, 3228, 3180, 7437, 7399, 1517, 1455, 4305, 4321, 5189,
       5128, 7171, 7115, 3517, 3491, 4930, 4905, 4953, 4982]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.034375, 24.93359375, 20.421875, 28.498046875]}, 'saliency': {'score': [4.892218338815789, 0.36603890213311885, 2.78662109375, 0.34437565554047384, 0.29926313920454545], 'topk_indices': array([3344,    0, 3128, 1605, 6424, 3648, 8140, 3346, 4233, 8149, 8145,
         34, 3320, 3324,   31, 3652, 3345, 3318, 8148, 8146]), 'topk_tokens': ['f', '<|begin_of_text|>', 'ern', ' hallway', ' hallway', ' went', 'Question', ' a', ' apple', '?', ' apple', ' office', ' gun', ' enemy', ' moved', ' bedroom', 'iring', 'iring', ' bedroom', ' before'], 'evidence_proportions': [6.465625, 5.4326171875, 5.26171875, 1.745361328125]}}, 'pred_res': 'the hallway<|eot_id|>', 'score': 0}
2025-01-22 05:21:52.137 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:21:52.137 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-58_pid-0_0-4-5-9.pkl | len: 3 |  size: 2.0 KB
Processing depth (0, 4, 5, 9):   1%|          | 1/100 [00:20<34:24, 20.85s/it]is_0k: False
your chose emoji: ['🧑🏾\u200d🤝\u200d🧑🏾', '🔌', '🌹', '🦹🏾\u200d♀', '\U0001faf0', '\U0001fa89', '🚹', '🙅🏻\u200d♀️', '\U0001fae3', '🍺']
emoji:
O: 🧑🏾‍🤝‍🧑🏾 [9468, 100, 239, 9468, 237, 122, 102470, 9468, 97, 251, 102470, 9468, 100, 239, 9468, 237, 122]
N: 🧑🏾‍🤝‍🧑🏾 [9468, 100, 239, 9468, 237, 122, 102470, 9468, 97, 251, 102470, 9468, 100, 239, 9468, 237, 122]

O: 🔌 [9468, 242, 234]
N: 🦹🏾‍♀ [9468, 99, 117, 9468, 237, 122, 102470, 32990]

O: 🌹 [9468, 234, 117]
N: 🫣 [9468, 104, 96]

O: 🦹🏾‍♀ [9468, 99, 117, 9468, 237, 122, 102470, 32990]
N: 🌹 [9468, 234, 117]

O: 🫰 [9468, 104, 108]
N: 🔌 [9468, 242, 234]

O: 🪉 [9468, 103, 231]
N: 🪉 [9468, 103, 231]

O: 🚹 [9468, 248, 117]
N: 🙅🏻‍♀️ [9468, 247, 227, 9468, 237, 119, 102470, 32990, 31643]

O: 🙅🏻‍♀️ [9468, 247, 227, 9468, 237, 119, 102470, 32990, 31643]
N: 🚹 [9468, 248, 117]

O: 🫣 [9468, 104, 96]
N: 🫰 [9468, 104, 108]

O: 🍺 [9468, 235, 118]
N: 🍺 [9468, 235, 118]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.09s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.64s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.60s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.23s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.70s/it]
Processing depth (1, 2, 4, 6):   1%|          | 1/100 [00:37<34:24, 20.85s/it]2025-01-22 05:22:08.705 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the office.
2025-01-22 05:22:08.710 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (825, 830) --> . Daniel moved to the
2025-01-22 05:22:08.710 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went back to the bedroom.
2025-01-22 05:22:08.721 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1796, 1802) --> . Daniel went back to the
2025-01-22 05:22:08.721 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel left the apple.
2025-01-22 05:22:08.738 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3586, 3590) -->  Daniel left the apple
2025-01-22 05:22:08.738 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra dropped the apple.
2025-01-22 05:22:08.760 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4643, 4647) -->  Sandra dropped the apple
2025-01-22 05:22:08.760 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the hallway.
2025-01-22 05:22:08.794 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6402, 6407) --> . Sandra moved to the
2025-01-22 05:22:08.794 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went back to the hallway.
2025-01-22 05:22:08.803 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1569, 1575) --> . Mary went back to the
2025-01-22 05:22:08.804 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra left the apple.
2025-01-22 05:22:08.832 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5564, 5568) -->  Sandra left the apple
2025-01-22 05:22:08.832 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the garden.
2025-01-22 05:22:08.845 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2504, 2510) --> . Sandra went back to the
2025-01-22 05:22:08.845 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra picked up the apple.
2025-01-22 05:22:08.867 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4597, 4602) -->  Sandra picked up the apple
2025-01-22 05:22:08.867 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra picked up the apple.
2025-01-22 05:22:08.891 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (4597, 4602) -->  Sandra picked up the apple
2025-01-22 05:22:08.891 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  John went back to the hallway.
2025-01-22 05:22:08.907 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (1570, 1576) -->  Mary went back to the hallway
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:22:09.706 | INFO     | test_jbb_embedding:begin_test:693 - The hallway.<|eot_id|>
2025-01-22 05:22:09.706 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8162])
2025-01-22 05:22:11.926 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [354.01480263157896, 37.11895976237139, 171.90540540540542, 35.76127358781451, 29.64394873903509], 'topk_indices': array([8149,    4, 8060,  828,  829,  830,    3,  827,    1, 8050, 8161,
          9, 8150,   23,   24,   14, 8160,    0, 8158, 8157]), 'topk_tokens': [' apple', '\n\n', ' location', ' to', ' the', ' office', '<|end_header_id|>', ' moved', '<|start_header_id|>', '.\n\n', '\n\n', ':', ' before', '4', '\n\n', '\n', '<|end_header_id|>', '<|begin_of_text|>', '<|start_header_id|>', '<|eot_id|>'], 'evidence_proportions': [751.8, 208.125, 344.59375, 85.0390625]}, 'weight': {'score': [23.433388157894736, 23.268233632410585, 24.546030405405407, 23.262015524790332, 29.799342105263158], 'topk_indices': array([3342, 3315, 3203, 3155, 7413, 7451, 1487, 1425, 4323, 4339, 5206,
       5145, 7190, 7134, 3524, 3498, 4999, 4947, 4922, 4970]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.909375, 20.927083333333332, 26.533203125, 28.498046875]}, 'saliency': {'score': [1.9590486225328947, 0.2033662548373576, 1.1217832823057432, 0.19506095204967316, 0.2291947749623081], 'topk_indices': array([   8,   20, 3589, 8159, 8050, 8155, 8016, 1575, 1802, 8146,  257,
         23, 8144, 8060, 8149,  830, 8152,   24,  827, 8150]), 'topk_tokens': [' Date', ' Jul', ' apple', 'assistant', '.\n\n', 'Answer', ' context', ' hallway', ' bedroom', ' Where', 'hue', '4', 'Question', ' location', ' apple', ' office', ' bedroom', '\n\n', ' moved', ' before'], 'evidence_proportions': [3.738671875, 1.132568359375, 2.3319091796875, 0.60137939453125]}}, 'pred_res': 'The hallway.<|eot_id|>', 'score': 0}
2025-01-22 05:22:11.942 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:22:11.948 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-58_pid-1_1-2-4-6.pkl | len: 3 |  size: 2.03 KB
Processing depth (1, 2, 4, 6):   2%|▏         | 2/100 [00:40<33:03, 20.24s/it]is_0k: False
your chose emoji: ['🌓', '🇻🇪', '🎏', '🏋🏽\u200d♀', '👩🏼\u200d🎓', '🏚', '✝', '📲', '👩🏽\u200d❤️\u200d👩🏻', '🏎️']
emoji:
O: 🌓 [9468, 107569]
N: 🏋🏽‍♀ [9468, 237, 233, 9468, 237, 121, 102470, 32990]

O: 🇻🇪 [9468, 229, 119, 9468, 229, 103]
N: 🌓 [9468, 107569]

O: 🎏 [9468, 236, 237]
N: ✝ [38798, 251]

O: 🏋🏽‍♀ [9468, 237, 233, 9468, 237, 121, 102470, 32990]
N: 👩🏽‍❤️‍👩🏻 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 31643, 102470, 9468, 239, 102, 9468, 237, 119]

O: 👩🏼‍🎓 [9468, 239, 102, 9468, 237, 120, 102470, 9468, 236, 241]
N: 🏚 [9468, 237, 248]

O: 🏚 [9468, 237, 248]
N: 🇻🇪 [9468, 229, 119, 9468, 229, 103]

O: ✝ [38798, 251]
N: 🎏 [9468, 236, 237]

O: 📲 [9468, 241, 110]
N: 📲 [9468, 241, 110]

O: 👩🏽‍❤️‍👩🏻 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 31643, 102470, 9468, 239, 102, 9468, 237, 119]
N: 👩🏼‍🎓 [9468, 239, 102, 9468, 237, 120, 102470, 9468, 236, 241]

O: 🏎️ [9468, 237, 236, 31643]
N: 🏎️ [9468, 237, 236, 31643]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:11,  3.83s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.05s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.14s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.96s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.36s/it]
Processing depth (2, 3, 6, 9):   2%|▏         | 2/100 [00:55<33:03, 20.24s/it]2025-01-22 05:22:27.041 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the office.
2025-01-22 05:22:27.052 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1756, 1761) --> . Daniel moved to the
2025-01-22 05:22:27.052 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went back to the bedroom.
2025-01-22 05:22:27.067 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2750, 2756) --> . Daniel went back to the
2025-01-22 05:22:27.067 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel left the apple.
2025-01-22 05:22:27.090 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4778, 4782) -->  Daniel left the apple
2025-01-22 05:22:27.091 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra dropped the apple.
2025-01-22 05:22:27.129 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7284, 7288) -->  Sandra dropped the apple
2025-01-22 05:22:27.129 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the hallway.
2025-01-22 05:22:27.165 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6447, 6452) --> . Sandra moved to the
2025-01-22 05:22:27.166 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went back to the hallway.
2025-01-22 05:22:27.173 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1549, 1555) --> . Mary went back to the
2025-01-22 05:22:27.173 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra left the apple.
2025-01-22 05:22:27.207 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5641, 5645) -->  Sandra left the apple
2025-01-22 05:22:27.208 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the garden.
2025-01-22 05:22:27.222 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2439, 2445) --> . Sandra went back to the
2025-01-22 05:22:27.222 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra picked up the apple.
2025-01-22 05:22:27.245 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4715, 4720) --> . Sandra picked up the
2025-01-22 05:22:27.245 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra picked up the apple.
2025-01-22 05:22:27.271 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (4715, 4720) --> . Sandra picked up the
2025-01-22 05:22:27.271 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  John went back to the hallway.
2025-01-22 05:22:27.278 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (1550, 1556) -->  Mary went back to the hallway
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:22:28.083 | INFO     | test_jbb_embedding:begin_test:693 - The hallway.<|eot_id|>
2025-01-22 05:22:28.084 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8192])
2025-01-22 05:22:30.356 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [230.68421052631578, 29.240768778984624, 216.14527027027026, 27.92067883693782, 23.21017795138889], 'topk_indices': array([8182, 1758, 8180, 8188,    4, 8174, 8186, 8080, 6452,    9, 1555,
       8191,    1,    3,   23,   14,   24, 8190,    0, 8187]), 'topk_tokens': [' bedroom', ' moved', ' before', '<|start_header_id|>', '\n\n', 'Question', ':', '.\n\n', ' hallway', ':', ' hallway', '\n\n', '<|start_header_id|>', '<|end_header_id|>', '4', '\n', '\n\n', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [475.4, 174.625, 139.03125, 100.53125]}, 'weight': {'score': [23.433388157894736, 23.2800143397608, 23.300675675675677, 23.279562315679527, 29.10894097222222], 'topk_indices': array([3350, 3323, 3243, 3195, 7431, 7469, 1447, 1509, 4302, 4318, 5185,
       5124, 7175, 7119, 3532, 3506, 4926, 4949, 4901, 4978]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.909375, 20.927083333333332, 26.533203125, 28.498046875]}, 'saliency': {'score': [1.252222964638158, 0.16212746059426106, 1.3710145692567568, 0.1540860944604018, 0.17276106940375435], 'topk_indices': array([1757,    8, 2756,    0,   22,   19, 8180,   16, 8046, 8185, 8090,
       8189, 1758,   20, 8182, 8174,   23,   24, 6452, 1555]), 'topk_tokens': [' Daniel', ' Date', ' bedroom', '<|begin_of_text|>', '202', '26', ' before', ' Date', ' context', 'Answer', ' location', 'assistant', ' moved', ' Jul', ' bedroom', 'Question', '4', '\n\n', ' hallway', ' hallway'], 'evidence_proportions': [2.44150390625, 0.8879801432291666, 0.896240234375, 0.66796875]}}, 'pred_res': 'The hallway.<|eot_id|>', 'score': 0}
2025-01-22 05:22:30.365 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:22:30.365 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-58_pid-2_2-3-6-9.pkl | len: 3 |  size: 2.05 KB
Processing depth (2, 3, 6, 9):   3%|▎         | 3/100 [00:59<31:22, 19.41s/it]is_0k: False
your chose emoji: ['\U0001faf1🏻\u200d\U0001faf2🏾', '👩🏾\u200d🔬', '🧜🏾\u200d♀', '🔡', '😾', '👩🏻\u200d⚕️', '🙈', '\U0001faf4🏾', '🤝🏻', '🧖🏿\u200d♂️']
emoji:
O: 🫱🏻‍🫲🏾 [9468, 104, 109, 9468, 237, 119, 102470, 9468, 104, 110, 9468, 237, 122]
N: 🔡 [9468, 242, 94]

O: 👩🏾‍🔬 [9468, 239, 102, 9468, 237, 122, 102470, 9468, 242, 105]
N: 🧜🏾‍♀ [9468, 100, 250, 9468, 237, 122, 102470, 32990]

O: 🧜🏾‍♀ [9468, 100, 250, 9468, 237, 122, 102470, 32990]
N: 🫱🏻‍🫲🏾 [9468, 104, 109, 9468, 237, 119, 102470, 9468, 104, 110, 9468, 237, 122]

O: 🔡 [9468, 242, 94]
N: 😾 [76460, 122]

O: 😾 [76460, 122]
N: 🫴🏾 [9468, 104, 112, 9468, 237, 122]

O: 👩🏻‍⚕️ [9468, 239, 102, 9468, 237, 119, 102470, 158, 248, 243, 31643]
N: 👩🏾‍🔬 [9468, 239, 102, 9468, 237, 122, 102470, 9468, 242, 105]

O: 🙈 [9468, 247, 230]
N: 🤝🏻 [9468, 97, 251, 9468, 237, 119]

O: 🫴🏾 [9468, 104, 112, 9468, 237, 122]
N: 👩🏻‍⚕️ [9468, 239, 102, 9468, 237, 119, 102470, 158, 248, 243, 31643]

O: 🤝🏻 [9468, 97, 251, 9468, 237, 119]
N: 🙈 [9468, 247, 230]

O: 🧖🏿‍♂️ [9468, 100, 244, 9468, 237, 123, 102470, 17245, 224, 31643]
N: 🧖🏿‍♂️ [9468, 100, 244, 9468, 237, 123, 102470, 17245, 224, 31643]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.24s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.68s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.30s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.77s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.38s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 1, 2, 4):   3%|▎         | 3/100 [01:14<31:22, 19.41s/it]2025-01-22 05:22:45.628 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the office.
2025-01-22 05:22:45.629 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  moved to the office.
2025-01-22 05:22:45.629 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went back to the bedroom.
2025-01-22 05:22:45.634 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (775, 781) --> . Daniel went back to the
2025-01-22 05:22:45.634 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel left the apple.
2025-01-22 05:22:45.644 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1802, 1806) -->  Daniel left the apple
2025-01-22 05:22:45.645 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra dropped the apple.
2025-01-22 05:22:45.662 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3645, 3649) -->  Sandra dropped the apple
2025-01-22 05:22:45.662 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the hallway.
2025-01-22 05:22:45.694 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6568, 6573) --> . Sandra moved to the
2025-01-22 05:22:45.694 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went back to the hallway.
2025-01-22 05:22:45.703 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1574, 1580) --> . Mary went back to the
2025-01-22 05:22:45.703 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra left the apple.
2025-01-22 05:22:45.732 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5792, 5796) -->  Sandra left the apple
2025-01-22 05:22:45.732 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the garden.
2025-01-22 05:22:45.744 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2531, 2537) --> . Sandra went back to the
2025-01-22 05:22:45.744 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra picked up the apple.
2025-01-22 05:22:45.769 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4853, 4858) --> . Sandra picked up the
2025-01-22 05:22:45.770 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra picked up the apple.
2025-01-22 05:22:45.794 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (4853, 4858) --> . Sandra picked up the
2025-01-22 05:22:45.794 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  John went back to the hallway.
2025-01-22 05:22:45.803 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (1575, 1581) -->  Mary went back to the hallway
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:22:48.964 | INFO     | test_jbb_embedding:begin_test:693 - The hallway.<|eot_id|>
2025-01-22 05:22:48.964 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8222])
2025-01-22 05:22:52.057 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [1903.6052631578948, 97.08108888618678, 483.6385135135135, 91.12778525954946, 125.60272988505747], 'topk_indices': array([8205,  782, 8207, 8204,  349,   14, 8213, 1805,   35,   29,   24,
       8210, 8212,   32,  781,   34,   31, 8218,    0, 8217]), 'topk_tokens': [':', '.', ' was', 'Question', ' century', '\n', '?', ' apple', '.', '\n\n', '\n\n', ' before', ' bedroom', ' to', ' bedroom', ' office', ' moved', '<|start_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [3411.8, 1381.3333333333333, 1523.25, 1182.125]}, 'weight': {'score': [23.203125, 23.313959143968873, 23.300675675675677, 23.31427713332517, 29.698635057471265], 'topk_indices': array([3282, 3309, 3202, 3154, 7443, 7405, 1430, 1492, 4286, 4302, 5103,
       5164, 7126, 7182, 3491, 3465, 4905, 4928, 4957, 4880]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.034375, 20.927083333333332, 26.533203125, 28.498046875]}, 'saliency': {'score': [10.911698190789474, 0.544240276173395, 3.004737647804054, 0.5089782655063969, 0.9816249102011494], 'topk_indices': array([  32, 8206,   27,   39,  348, 8213,   30,   24,  377, 3667,   38,
       8209,  349, 8204, 1805, 8210,   34, 8212,   31,  781]), 'topk_tokens': [' to', ' Where', 'user', '\n\n\n', ' past', '?', 'Daniel', '\n\n', ' past', '�', '***', ' apple', ' century', 'Question', ' apple', ' before', ' office', ' bedroom', ' moved', ' bedroom'], 'evidence_proportions': [17.9765625, 7.080078125, 10.44384765625, 8.2958984375]}}, 'pred_res': 'The hallway.<|eot_id|>', 'score': 0}
2025-01-22 05:22:52.063 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:22:52.063 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-58_pid-3_0-1-2-4.pkl | len: 3 |  size: 1.99 KB
Processing depth (0, 1, 2, 4):   4%|▍         | 4/100 [01:20<32:29, 20.31s/it]is_0k: False
your chose emoji: ['🗑', '🦸\u200d♀️', '👨🏽\u200d🚀', '🏃🏼\u200d➡️', '🏄🏻\u200d♀', '💇', '👨🏼\u200d❤\u200d💋\u200d👨🏿', '🏃🏽', '🧝🏽', '👩🏼\u200d❤\u200d💋\u200d👩🏿']
emoji:
O: 🗑 [9468, 245, 239]
N: 🏃🏽 [9468, 237, 225, 9468, 237, 121]

O: 🦸‍♀️ [9468, 99, 116, 102470, 32990, 31643]
N: 🗑 [9468, 245, 239]

O: 👨🏽‍🚀 [9468, 239, 101, 9468, 237, 121, 102470, 9468, 248, 222]
N: 🏃🏼‍➡️ [9468, 237, 225, 9468, 237, 120, 102470, 98115, 94, 31643]

O: 🏃🏼‍➡️ [9468, 237, 225, 9468, 237, 120, 102470, 98115, 94, 31643]
N: 🦸‍♀️ [9468, 99, 116, 102470, 32990, 31643]

O: 🏄🏻‍♀ [9468, 237, 226, 9468, 237, 119, 102470, 32990]
N: 👨🏽‍🚀 [9468, 239, 101, 9468, 237, 121, 102470, 9468, 248, 222]

O: 💇 [93273, 229]
N: 🏄🏻‍♀ [9468, 237, 226, 9468, 237, 119, 102470, 32990]

O: 👨🏼‍❤‍💋‍👨🏿 [9468, 239, 101, 9468, 237, 120, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 123]
N: 🧝🏽 [9468, 100, 251, 9468, 237, 121]

O: 🏃🏽 [9468, 237, 225, 9468, 237, 121]
N: 👨🏼‍❤‍💋‍👨🏿 [9468, 239, 101, 9468, 237, 120, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 123]

O: 🧝🏽 [9468, 100, 251, 9468, 237, 121]
N: 💇 [93273, 229]

O: 👩🏼‍❤‍💋‍👩🏿 [9468, 239, 102, 9468, 237, 120, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 123]
N: 👩🏼‍❤‍💋‍👩🏿 [9468, 239, 102, 9468, 237, 120, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 123]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:05<00:16,  5.37s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:10<00:10,  5.35s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.83s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.33s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.99s/it]
Processing depth (3, 4, 5, 9):   4%|▍         | 4/100 [01:38<32:29, 20.31s/it]2025-01-22 05:23:09.854 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the office.
2025-01-22 05:23:09.869 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2904, 2909) --> . Daniel moved to the
2025-01-22 05:23:09.869 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went back to the bedroom.
2025-01-22 05:23:09.890 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3637, 3643) -->  Hon. Daniel went back to
2025-01-22 05:23:09.890 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel left the apple.
2025-01-22 05:23:09.915 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4229, 4233) -->  left the apple.
2025-01-22 05:23:09.916 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra dropped the apple.
2025-01-22 05:23:09.954 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7232, 7236) -->  Sandra dropped the apple
2025-01-22 05:23:09.954 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the hallway.
2025-01-22 05:23:09.988 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6431, 6436) --> . Sandra moved to the
2025-01-22 05:23:09.988 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went back to the hallway.
2025-01-22 05:23:09.998 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1719, 1725) --> . Mary went back to the
2025-01-22 05:23:09.998 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra left the apple.
2025-01-22 05:23:10.031 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5657, 5661) -->  Sandra left the apple
2025-01-22 05:23:10.031 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the garden.
2025-01-22 05:23:10.044 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2531, 2537) --> . Sandra went back to the
2025-01-22 05:23:10.044 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra picked up the apple.
2025-01-22 05:23:10.067 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4771, 4776) -->  senate. Sandra picked up
2025-01-22 05:23:10.067 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra picked up the apple.
2025-01-22 05:23:10.091 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (4771, 4776) -->  senate. Sandra picked up
2025-01-22 05:23:10.091 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  John went back to the hallway.
2025-01-22 05:23:10.102 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (1720, 1726) -->  Mary went back to the hallway
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:23:10.869 | INFO     | test_jbb_embedding:begin_test:693 - The hallway.<|eot_id|>
2025-01-22 05:23:10.869 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8168])
2025-01-22 05:23:13.083 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [553.2072368421053, 46.11294369645043, 295.6114864864865, 43.78779732561006, 38.58424479166667], 'topk_indices': array([2909, 8154, 8149,   23, 8167, 8056, 8150,   24, 8151, 8159, 8158,
         14, 8153, 8155, 8166, 8152, 8156,    0, 8163, 8164]), 'topk_tokens': [' office', ' the', '.\n\n', '4', '\n\n', '.\n\n', 'Question', '\n\n', ':', '?', ' bedroom', '\n', ' was', ' apple', '<|end_header_id|>', ' Where', ' before', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [817.7, 452.7916666666667, 690.1875, 236.234375]}, 'weight': {'score': [23.41200657894737, 23.262888234394126, 24.714949324324323, 23.25591762694109, 29.108854166666667], 'topk_indices': array([3327, 3300, 3172, 3220, 7453, 7415, 1399, 1461, 4303, 4319, 5120,
       5181, 7125, 7181, 3509, 3483, 4922, 4945, 4974, 4897]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.909375, 24.93359375, 20.421875, 28.498046875]}, 'saliency': {'score': [3.1541169819078947, 0.25274268235541614, 1.8862436655405406, 0.2384999354895859, 0.2827219645182292], 'topk_indices': array([  23, 8149,   24, 8160, 8056, 2905, 2906, 6436, 2532, 8161, 2909,
       8159, 3644, 4231, 8153, 8150, 8152, 8155, 8158, 8156]), 'topk_tokens': ['4', '.\n\n', '\n\n', ' \n', '.\n\n', ' Daniel', ' moved', ' hallway', ' Sandra', 'Answer', ' office', '?', ' bedroom', ' apple', ' was', 'Question', ' Where', ' apple', ' bedroom', ' before'], 'evidence_proportions': [4.169921875, 2.7578125, 3.98193359375, 1.6510009765625]}}, 'pred_res': 'The hallway.<|eot_id|>', 'score': 0}
2025-01-22 05:23:13.088 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:23:13.088 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-58_pid-4_3-4-5-9.pkl | len: 3 |  size: 1.99 KB
Processing depth (3, 4, 5, 9):   5%|▌         | 5/100 [01:41<32:34, 20.57s/it]Processing depth (3, 4, 5, 9):   5%|▌         | 5/100 [01:41<32:15, 20.37s/it]
2025-01-22 05:23:13.148 | INFO     | __main__:<module>:82 - Selected idx: 59
2025-01-22 05:23:13.148 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the location prior to the place where the milk was discarded, left or dropped?
2025-01-22 05:23:13.148 | INFO     | __main__:<module>:84 - Answer: office
2025-01-22 05:23:13.148 | INFO     | __main__:<module>:85 - Tag: 4-hop
2025-01-22 05:23:13.148 | INFO     | __main__:<module>:86 - Needle: [' Sandra moved to the hallway.', ' Sandra picked up the apple.', ' Daniel moved to the office.', ' Daniel picked up the milk.', ' John went back to the hallway.', ' Daniel went back to the bedroom.', ' Sandra went back to the garden.', ' Mary went back to the hallway.', ' Sandra left the apple.', ' Sandra picked up the apple.', ' Daniel left the milk.', ' Sandra dropped the apple.']
2025-01-22 05:23:13.148 | INFO     | __main__:<module>:87 - Real Needle: [' Daniel moved to the office.', ' Daniel picked up the milk.', ' Daniel went back to the bedroom.', ' Daniel left the milk.', ' Sandra dropped the apple.']
2025-01-22 05:23:13.148 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['🇹🇳', '🤽🏽\u200d♀️', '👩🏿\u200d✈', '🚲', '🤘🏻', '🙆🏾\u200d♂️', '\U0001fae9', '🥽', '💂🏿', '🧙🏾']
emoji:
O: 🇹🇳 [9468, 229, 117, 9468, 229, 111]
N: 🤽🏽‍♀️ [9468, 97, 121, 9468, 237, 121, 102470, 32990, 31643]

O: 🤽🏽‍♀️ [9468, 97, 121, 9468, 237, 121, 102470, 32990, 31643]
N: 👩🏿‍✈ [9468, 239, 102, 9468, 237, 123, 102470, 38798, 230]

O: 👩🏿‍✈ [9468, 239, 102, 9468, 237, 123, 102470, 38798, 230]
N: 🇹🇳 [9468, 229, 117, 9468, 229, 111]

O: 🚲 [9468, 248, 110]
N: 🤘🏻 [9468, 97, 246, 9468, 237, 119]

O: 🤘🏻 [9468, 97, 246, 9468, 237, 119]
N: 🙆🏾‍♂️ [9468, 247, 228, 9468, 237, 122, 102470, 17245, 224, 31643]

O: 🙆🏾‍♂️ [9468, 247, 228, 9468, 237, 122, 102470, 17245, 224, 31643]
N: 🚲 [9468, 248, 110]

O: 🫩 [9468, 104, 102]
N: 🫩 [9468, 104, 102]

O: 🥽 [9468, 98, 121]
N: 💂🏿 [93273, 224, 9468, 237, 123]

O: 💂🏿 [93273, 224, 9468, 237, 123]
N: 🥽 [9468, 98, 121]

O: 🧙🏾 [9468, 100, 247, 9468, 237, 122]
N: 🧙🏾 [9468, 100, 247, 9468, 237, 122]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.71s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.55s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.07s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.85s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.41s/it]
Processing depth (1, 5, 6, 8, 9):   0%|          | 0/100 [00:15<?, ?it/s]2025-01-22 05:23:28.553 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the office.
2025-01-22 05:23:28.557 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (675, 680) --> . Daniel moved to the
2025-01-22 05:23:28.557 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel picked up the milk.
2025-01-22 05:23:28.582 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4167, 4172) --> . Daniel picked up the
2025-01-22 05:23:28.582 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the bedroom.
2025-01-22 05:23:28.608 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4757, 4763) --> . Daniel went back to the
2025-01-22 05:23:28.608 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the milk.
2025-01-22 05:23:28.642 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6639, 6643) -->  Daniel left the milk
2025-01-22 05:23:28.643 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra dropped the apple.
2025-01-22 05:23:28.679 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7248, 7252) -->  Sandra dropped the apple
2025-01-22 05:23:28.679 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the hallway.
2025-01-22 05:23:28.706 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5026, 5031) --> . Sandra moved to the
2025-01-22 05:23:28.707 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra picked up the apple.
2025-01-22 05:23:28.727 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3857, 3862) --> . Sandra picked up the
2025-01-22 05:23:28.727 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the hallway.
2025-01-22 05:23:28.728 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (143, 149) --> . John went back to the
2025-01-22 05:23:28.728 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the garden.
2025-01-22 05:23:28.729 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (244, 250) --> . Sandra went back to the
2025-01-22 05:23:28.729 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary went back to the hallway.
2025-01-22 05:23:28.730 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (144, 150) -->  John went back to the hallway
2025-01-22 05:23:28.730 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra left the apple.
2025-01-22 05:23:28.736 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (1164, 1168) -->  Sandra left the apple
2025-01-22 05:23:28.736 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Sandra picked up the apple.
2025-01-22 05:23:28.754 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (3857, 3862) --> . Sandra picked up the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:23:29.505 | INFO     | test_jbb_embedding:begin_test:693 - bedroom<|eot_id|>
2025-01-22 05:23:29.505 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8195])
2025-01-22 05:23:31.759 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [1113.5, 90.71177717457607, 767.7972972972973, 84.6155282079646, 91.2034209280303], 'topk_indices': array([8174,  149, 8040, 8168, 8175, 4172,  150, 8167,  675,  676, 4763,
       8169, 8187,  677,  678,  679,  680,    0, 8190, 8191]), 'topk_tokens': [' prior', ' hallway', ' context', 'Question', ' to', ' milk', '.', '.\n\n', '.', ' Daniel', ' bedroom', ':', '?\n', ' moved', ' to', ' the', ' office', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [2432.8, 820.2, 750.0, 1012.375, 477.375]}, 'weight': {'score': [23.198567708333332, 23.270489584604125, 23.09375, 23.27150550024582, 29.118844696969695], 'topk_indices': array([3340, 3367, 3244, 3196, 7425, 7463, 1534, 1472, 4360, 4344, 5168,
       5229, 7197, 7141, 3556, 3530, 4987, 4964, 4939, 5016]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.909375, 22.3625, 20.927083333333332, 26.462890625, 28.498046875]}, 'saliency': {'score': [6.234415690104167, 0.49806855785653287, 4.639595650337838, 0.4623128015148722, 0.6648004705255682], 'topk_indices': array([ 291, 8167,  678,  145, 4168,  156, 8180, 8187, 8040,  277, 8174,
       8182, 4172,  245, 8168,  149,  676, 4763,  677,  680]), 'topk_tokens': [' offices', '.\n\n', ' to', ' went', ' Daniel', '\n\n\n\n\n\n\n', ' milk', '?\n', ' context', 'hue', ' prior', ' discarded', ' milk', ' Sandra', 'Question', ' hallway', ' Daniel', ' bedroom', ' moved', ' office'], 'evidence_proportions': [12.21015625, 4.840625, 3.9386393229166665, 6.853515625, 3.33154296875]}}, 'pred_res': 'bedroom<|eot_id|>', 'score': 0}
2025-01-22 05:23:31.766 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:23:31.767 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-59_pid-0_1-5-6-8-9.pkl | len: 3 |  size: 2.06 KB
Processing depth (1, 5, 6, 8, 9):   1%|          | 1/100 [00:18<30:33, 18.52s/it]is_0k: False
your chose emoji: ['😢', '🇬🇶', '\U0001faf1🏼\u200d\U0001faf2🏾', '🩳', '🤵\u200d♀', '🧑🏽\u200d🦯\u200d➡', '🇵🇱', '🏋🏾\u200d♀', '🇦🇽', '⏸️']
emoji:
O: 😢 [76460, 95]
N: 🩳 [9468, 102, 111]

O: 🇬🇶 [9468, 229, 105, 9468, 229, 114]
N: 😢 [76460, 95]

O: 🫱🏼‍🫲🏾 [9468, 104, 109, 9468, 237, 120, 102470, 9468, 104, 110, 9468, 237, 122]
N: 🧑🏽‍🦯‍➡ [9468, 100, 239, 9468, 237, 121, 102470, 9468, 99, 107, 102470, 98115, 94]

O: 🩳 [9468, 102, 111]
N: 🇵🇱 [9468, 229, 113, 9468, 229, 109]

O: 🤵‍♀ [9468, 97, 113, 102470, 32990]
N: 🫱🏼‍🫲🏾 [9468, 104, 109, 9468, 237, 120, 102470, 9468, 104, 110, 9468, 237, 122]

O: 🧑🏽‍🦯‍➡ [9468, 100, 239, 9468, 237, 121, 102470, 9468, 99, 107, 102470, 98115, 94]
N: 🏋🏾‍♀ [9468, 237, 233, 9468, 237, 122, 102470, 32990]

O: 🇵🇱 [9468, 229, 113, 9468, 229, 109]
N: 🤵‍♀ [9468, 97, 113, 102470, 32990]

O: 🏋🏾‍♀ [9468, 237, 233, 9468, 237, 122, 102470, 32990]
N: 🇬🇶 [9468, 229, 105, 9468, 229, 114]

O: 🇦🇽 [9468, 229, 99, 9468, 229, 121]
N: 🇦🇽 [9468, 229, 99, 9468, 229, 121]

O: ⏸️ [158, 237, 116, 31643]
N: ⏸️ [158, 237, 116, 31643]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.03s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.41s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.39s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.86s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.39s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 1, 6, 7, 8):   1%|          | 1/100 [00:33<30:33, 18.52s/it]2025-01-22 05:23:47.075 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the office.
2025-01-22 05:23:47.076 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  moved to the office.
2025-01-22 05:23:47.076 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel picked up the milk.
2025-01-22 05:23:47.081 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (855, 860) --> . Daniel picked up the
2025-01-22 05:23:47.081 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the bedroom.
2025-01-22 05:23:47.110 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4777, 4783) --> . Daniel went back to the
2025-01-22 05:23:47.110 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the milk.
2025-01-22 05:23:47.139 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5705, 5709) -->  Daniel left the milk
2025-01-22 05:23:47.140 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra dropped the apple.
2025-01-22 05:23:47.175 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6686, 6690) -->  Sandra dropped the apple
2025-01-22 05:23:47.175 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the hallway.
2025-01-22 05:23:47.229 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5046, 5051) --> . Sandra moved to the
2025-01-22 05:23:47.229 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra picked up the apple.
2025-01-22 05:23:47.248 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3905, 3910) --> . Sandra picked up the
2025-01-22 05:23:47.248 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the hallway.
2025-01-22 05:23:47.249 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (149, 155) --> . John went back to the
2025-01-22 05:23:47.249 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the garden.
2025-01-22 05:23:47.251 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (264, 270) --> . Sandra went back to the
2025-01-22 05:23:47.251 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary went back to the hallway.
2025-01-22 05:23:47.251 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (150, 156) -->  John went back to the hallway
2025-01-22 05:23:47.252 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra left the apple.
2025-01-22 05:23:47.267 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (1342, 1346) -->  Sandra left the apple
2025-01-22 05:23:47.267 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Sandra picked up the apple.
2025-01-22 05:23:47.296 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (3905, 3910) --> . Sandra picked up the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:23:50.181 | INFO     | test_jbb_embedding:begin_test:693 - the office<|eot_id|>
2025-01-22 05:23:50.181 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8221])
2025-01-22 05:23:52.979 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [1186.0885416666667, 98.85163565608659, 521.0236486486486, 93.74087233521196, 115.84444224683544], 'topk_indices': array([2418, 7586, 2432,   29, 8195, 8208, 7542,   35,   24, 7587, 8200,
         14, 8213, 8201,   32,   31,   34,    0, 8216, 8217]), 'topk_tokens': ['nes', ' Min', 'nes', '\n\n', ':', ' discarded', 'nes', '.', '\n\n', 'nes', ' prior', '\n', '?\n', ' to', ' to', ' moved', ' office', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [3294.8, 738.4, 328.3125, 839.5, 743.0625]}, 'weight': {'score': [23.016276041666668, 23.313541286635047, 23.09375, 23.31541174038226, 30.386471518987342], 'topk_indices': array([3355, 3328, 3248, 3200, 7479, 7441, 1548, 1486, 4368, 4352, 5249,
       5188, 7218, 7162, 3537, 3511, 4984, 5007, 4959, 5036]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.034375, 22.3625, 20.927083333333332, 26.462890625, 28.498046875]}, 'saliency': {'score': [6.66180419921875, 0.5300348488994284, 3.125171558277027, 0.5002403717302745, 0.8802428426621836], 'topk_indices': array([  32,   24,   30, 8196, 8214, 8066, 8213,   27, 8206, 2418,    0,
       2432, 8194, 7586, 7542, 7587, 8200, 8208,   31,   34]), 'topk_tokens': [' to', '\n\n', 'Daniel', ' Where', 'Answer', ' context', '?\n', 'user', ' milk', 'nes', '<|begin_of_text|>', 'nes', 'Question', ' Min', 'nes', 'nes', ' prior', ' discarded', ' moved', ' office'], 'evidence_proportions': [17.45625, 4.0890625, 1.778076171875, 5.576171875, 4.7958984375]}}, 'pred_res': 'the office<|eot_id|>', 'score': 100}
2025-01-22 05:23:52.986 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:23:52.986 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-59_pid-1_0-1-6-7-8.pkl | len: 3 |  size: 2.04 KB
Processing depth (0, 1, 6, 7, 8):   2%|▏         | 2/100 [00:39<32:50, 20.11s/it]is_0k: False
your chose emoji: ['😐', '🧎🏿\u200d♀️\u200d➡️', '🚶🏽\u200d♂️\u200d➡', '🇫🇴', '🎦', '💂🏻', '🙆🏿\u200d♀️', '\U0001faf6🏿', '👩🏼\u200d❤\u200d👨🏽', '🏋️\u200d♂️']
emoji:
O: 😐 [76460, 238]
N: 🚶🏽‍♂️‍➡ [9468, 248, 114, 9468, 237, 121, 102470, 17245, 224, 31643, 102470, 98115, 94]

O: 🧎🏿‍♀️‍➡️ [9468, 100, 236, 9468, 237, 123, 102470, 32990, 31643, 102470, 98115, 94, 31643]
N: 👩🏼‍❤‍👨🏽 [9468, 239, 102, 9468, 237, 120, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 121]

O: 🚶🏽‍♂️‍➡ [9468, 248, 114, 9468, 237, 121, 102470, 17245, 224, 31643, 102470, 98115, 94]
N: 💂🏻 [93273, 224, 9468, 237, 119]

O: 🇫🇴 [9468, 229, 104, 9468, 114783]
N: 🎦 [9468, 236, 99]

O: 🎦 [9468, 236, 99]
N: 🧎🏿‍♀️‍➡️ [9468, 100, 236, 9468, 237, 123, 102470, 32990, 31643, 102470, 98115, 94, 31643]

O: 💂🏻 [93273, 224, 9468, 237, 119]
N: 🫶🏿 [9468, 104, 114, 9468, 237, 123]

O: 🙆🏿‍♀️ [9468, 247, 228, 9468, 237, 123, 102470, 32990, 31643]
N: 🙆🏿‍♀️ [9468, 247, 228, 9468, 237, 123, 102470, 32990, 31643]

O: 🫶🏿 [9468, 104, 114, 9468, 237, 123]
N: 😐 [76460, 238]

O: 👩🏼‍❤‍👨🏽 [9468, 239, 102, 9468, 237, 120, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 121]
N: 🇫🇴 [9468, 229, 104, 9468, 114783]

O: 🏋️‍♂️ [9468, 237, 233, 31643, 102470, 17245, 224, 31643]
N: 🏋️‍♂️ [9468, 237, 233, 31643, 102470, 17245, 224, 31643]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.57s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.91s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.83s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.35s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.89s/it]
Processing depth (0, 1, 4, 8, 9):   2%|▏         | 2/100 [00:57<32:50, 20.11s/it]2025-01-22 05:24:10.409 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the office.
2025-01-22 05:24:10.410 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  moved to the office.
2025-01-22 05:24:10.410 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel picked up the milk.
2025-01-22 05:24:10.414 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (841, 846) --> . Daniel picked up the
2025-01-22 05:24:10.414 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the bedroom.
2025-01-22 05:24:10.435 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3634, 3640) -->  Hon. Daniel went back to
2025-01-22 05:24:10.435 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the milk.
2025-01-22 05:24:10.472 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6680, 6684) -->  left the milk.
2025-01-22 05:24:10.472 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra dropped the apple.
2025-01-22 05:24:10.508 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7400, 7404) -->  Sandra dropped the apple
2025-01-22 05:24:10.508 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the hallway.
2025-01-22 05:24:10.537 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5098, 5103) --> . Sandra moved to the
2025-01-22 05:24:10.537 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra picked up the apple.
2025-01-22 05:24:10.559 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3900, 3905) --> . Sandra picked up the
2025-01-22 05:24:10.559 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the hallway.
2025-01-22 05:24:10.560 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (149, 155) --> . John went back to the
2025-01-22 05:24:10.560 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the garden.
2025-01-22 05:24:10.561 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (264, 270) --> . Sandra went back to the
2025-01-22 05:24:10.561 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary went back to the hallway.
2025-01-22 05:24:10.562 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (150, 156) -->  John went back to the hallway
2025-01-22 05:24:10.562 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra left the apple.
2025-01-22 05:24:10.569 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (1416, 1420) -->  Sandra left the apple
2025-01-22 05:24:10.569 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Sandra picked up the apple.
2025-01-22 05:24:10.588 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (3900, 3905) --> . Sandra picked up the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:24:11.371 | INFO     | test_jbb_embedding:begin_test:693 - the office<|eot_id|>
2025-01-22 05:24:11.371 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8231])
2025-01-22 05:24:13.642 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [1493.3854166666667, 110.97827341187903, 678.3986486486486, 104.34925660792952, 101.47321428571429], 'topk_indices': array([  25, 8211,  385, 8204,   69, 8216,   32, 8218, 8205,   66, 8223,
         31,  357,   34,   67,  105,   68,    0, 8226, 8227]), 'topk_tokens': ['<|eot_id|>', ' to', ' past', 'Question', 'ER', ' milk', ' to', ' discarded', ':', ' P', '?\n', ' moved', ' century', ' office', 'ION', 'ION', 'E', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [2889.0, 1064.4, 746.1666666666666, 2145.25, 754.0625]}, 'weight': {'score': [22.999348958333332, 23.302215550224705, 23.09375, 23.304048886441507, 29.410342261904763], 'topk_indices': array([3317, 3290, 3162, 3210, 7465, 7427, 1504, 1442, 4311, 4295, 5132,
       5193, 7193, 7137, 3473, 3499, 4980, 4928, 4903, 4951]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.034375, 22.3625, 24.93359375, 20.3515625, 28.498046875]}, 'saliency': {'score': [8.238362630208334, 0.5985870861737823, 4.108306059966216, 0.5602593554974302, 0.7591378348214286], 'topk_indices': array([ 846,   69,  382, 8076,  353, 8223,   66, 6682,  356, 8210,  385,
       8216, 8204,   31,  357,   34, 8218,   68,   67,  105]), 'topk_tokens': [' milk', 'ER', ' half', ' context', ' half', '?\n', ' P', ' milk', ' past', ' prior', ' past', ' milk', 'Question', ' moved', ' century', ' office', ' discarded', 'E', 'ION', 'ION'], 'evidence_proportions': [15.190625, 5.831640625, 4.46337890625, 10.982421875, 5.474853515625]}}, 'pred_res': 'the office<|eot_id|>', 'score': 100}
2025-01-22 05:24:13.648 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:24:13.649 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-59_pid-2_0-1-4-8-9.pkl | len: 3 |  size: 2.04 KB
Processing depth (0, 1, 4, 8, 9):   3%|▎         | 3/100 [01:00<32:55, 20.36s/it]is_0k: False
your chose emoji: ['🙍\u200d♀️', '🧑🏾\u200d🦽\u200d➡️', '0⃣', '👩🏽\u200d❤\u200d💋\u200d👨🏽', '🚰', '🧑🏻\u200d🍳', '🚶🏽\u200d♂️\u200d➡', '👩\u200d🦰', '🇸🇦', '\U0001fab7']
emoji:
O: 🙍‍♀️ [9468, 247, 235, 102470, 32990, 31643]
N: 🙍‍♀️ [9468, 247, 235, 102470, 32990, 31643]

O: 🧑🏾‍🦽‍➡️ [9468, 100, 239, 9468, 237, 122, 102470, 9468, 99, 121, 102470, 98115, 94, 31643]
N: 👩‍🦰 [9468, 239, 102, 102470, 9468, 99, 108]

O: 0⃣ [15, 158, 225, 96]
N: 0⃣ [15, 158, 225, 96]

O: 👩🏽‍❤‍💋‍👨🏽 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 121]
N: 🧑🏻‍🍳 [9468, 100, 239, 9468, 237, 119, 102470, 9468, 235, 111]

O: 🚰 [9468, 248, 108]
N: 🚶🏽‍♂️‍➡ [9468, 248, 114, 9468, 237, 121, 102470, 17245, 224, 31643, 102470, 98115, 94]

O: 🧑🏻‍🍳 [9468, 100, 239, 9468, 237, 119, 102470, 9468, 235, 111]
N: 🧑🏾‍🦽‍➡️ [9468, 100, 239, 9468, 237, 122, 102470, 9468, 99, 121, 102470, 98115, 94, 31643]

O: 🚶🏽‍♂️‍➡ [9468, 248, 114, 9468, 237, 121, 102470, 17245, 224, 31643, 102470, 98115, 94]
N: 🚰 [9468, 248, 108]

O: 👩‍🦰 [9468, 239, 102, 102470, 9468, 99, 108]
N: 🇸🇦 [9468, 229, 116, 9468, 229, 99]

O: 🇸🇦 [9468, 229, 116, 9468, 229, 99]
N: 👩🏽‍❤‍💋‍👨🏽 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 121]

O: 🪷 [9468, 103, 115]
N: 🪷 [9468, 103, 115]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:11,  3.81s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.11s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.14s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  2.68s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  3.19s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (1, 2, 6, 8, 9):   3%|▎         | 3/100 [01:14<32:55, 20.36s/it]2025-01-22 05:24:28.118 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the office.
2025-01-22 05:24:28.124 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (909, 914) --> . Daniel moved to the
2025-01-22 05:24:28.124 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel picked up the milk.
2025-01-22 05:24:28.136 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2023, 2028) -->  cable. Daniel picked up
2025-01-22 05:24:28.136 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the bedroom.
2025-01-22 05:24:28.163 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4785, 4791) -->  the senate. Daniel went back
2025-01-22 05:24:28.163 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the milk.
2025-01-22 05:24:28.199 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6669, 6673) -->  Daniel left the milk
2025-01-22 05:24:28.199 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra dropped the apple.
2025-01-22 05:24:28.234 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7285, 7289) -->  dropped the apple.
2025-01-22 05:24:28.234 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the hallway.
2025-01-22 05:24:28.260 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5060, 5065) --> . Sandra moved to the
2025-01-22 05:24:28.260 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra picked up the apple.
2025-01-22 05:24:28.282 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3907, 3912) --> . Sandra picked up the
2025-01-22 05:24:28.282 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the hallway.
2025-01-22 05:24:28.283 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (143, 149) --> . John went back to the
2025-01-22 05:24:28.283 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the garden.
2025-01-22 05:24:28.285 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (258, 264) --> . Sandra went back to the
2025-01-22 05:24:28.285 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary went back to the hallway.
2025-01-22 05:24:28.285 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (144, 150) -->  John went back to the hallway
2025-01-22 05:24:28.285 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra left the apple.
2025-01-22 05:24:28.293 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (1522, 1526) -->  Sandra left the apple
2025-01-22 05:24:28.293 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Sandra picked up the apple.
2025-01-22 05:24:28.312 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (3907, 3912) --> . Sandra picked up the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:24:31.354 | INFO     | test_jbb_embedding:begin_test:693 - the office<|eot_id|>
2025-01-22 05:24:31.354 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8239])
2025-01-22 05:24:34.254 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [390.1328125, 38.654304696032035, 264.95777027027026, 36.59944987775061, 22.092218572443183], 'topk_indices': array([ 913,   14,  912, 8118,  909, 8237,  150,   24,  149, 4793, 8233,
        911, 8212, 8211, 8231, 8213,  914,    0, 8234, 8235]), 'topk_tokens': [' the', '\n', ' to', '.\n\n', '.', '<|end_header_id|>', '.', '\n\n', ' hallway', ' bedroom', ':', ' moved', 'Question', '.\n\n', '?\n', ':', ' office', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [759.6, 250.4, 272.78125, 402.4375, 266.6875]}, 'weight': {'score': [23.8515625, 23.31339681167334, 23.09375, 23.31281135391198, 29.666015625], 'topk_indices': array([3276, 3303, 3176, 3128, 7499, 7461, 1481, 1419, 4318, 4302, 5142,
       5203, 7159, 7215, 3503, 3477, 4913, 4961, 4990, 4938]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.909375, 26.7890625, 24.8671875, 26.462890625, 20.97265625]}, 'saliency': {'score': [2.2526957194010415, 0.20869158992575235, 1.619454048775338, 0.19631331240926803, 0.1672581759366122], 'topk_indices': array([8118, 6672, 8222,  259,  145, 8128, 8218, 8224, 8232, 8231, 3638,
        271, 8211,  910, 8226,  911, 4793,  149, 8212,  914]), 'topk_tokens': ['.\n\n', ' milk', ' where', ' Sandra', ' went', ' location', ' prior', ' milk', 'Answer', '?\n', ' hallway', 'hue', '.\n\n', ' Daniel', ' discarded', ' moved', ' bedroom', ' hallway', 'Question', ' office'], 'evidence_proportions': [3.794921875, 1.600634765625, 1.7349446614583333, 2.7333984375, 1.4359130859375]}}, 'pred_res': 'the office<|eot_id|>', 'score': 100}
2025-01-22 05:24:34.275 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:24:34.275 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-59_pid-3_1-2-6-8-9.pkl | len: 3 |  size: 2.06 KB
Processing depth (1, 2, 6, 8, 9):   4%|▍         | 4/100 [01:21<32:44, 20.47s/it]is_0k: False
your chose emoji: ['🧛🏾\u200d♂', '🧍\u200d♀', '👸🏻', '🙆🏻\u200d♂', '🕴️', '👨🏻\u200d❤\u200d💋\u200d👨🏿', '🦹🏽\u200d♂️', '🧑🏻\u200d❤\u200d🧑🏿', '🪄', '👩🏼\u200d🦯']
emoji:
O: 🧛🏾‍♂ [9468, 100, 249, 9468, 237, 122, 102470, 17245, 224]
N: 🦹🏽‍♂️ [9468, 99, 117, 9468, 237, 121, 102470, 17245, 224, 31643]

O: 🧍‍♀ [9468, 100, 235, 102470, 32990]
N: 🙆🏻‍♂ [9468, 247, 228, 9468, 237, 119, 102470, 17245, 224]

O: 👸🏻 [9468, 110848, 9468, 237, 119]
N: 👸🏻 [9468, 110848, 9468, 237, 119]

O: 🙆🏻‍♂ [9468, 247, 228, 9468, 237, 119, 102470, 17245, 224]
N: 🧍‍♀ [9468, 100, 235, 102470, 32990]

O: 🕴️ [9468, 243, 112, 31643]
N: 🪄 [9468, 103, 226]

O: 👨🏻‍❤‍💋‍👨🏿 [9468, 239, 101, 9468, 237, 119, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 123]
N: 👨🏻‍❤‍💋‍👨🏿 [9468, 239, 101, 9468, 237, 119, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 123]

O: 🦹🏽‍♂️ [9468, 99, 117, 9468, 237, 121, 102470, 17245, 224, 31643]
N: 🧑🏻‍❤‍🧑🏿 [9468, 100, 239, 9468, 237, 119, 102470, 121643, 102470, 9468, 100, 239, 9468, 237, 123]

O: 🧑🏻‍❤‍🧑🏿 [9468, 100, 239, 9468, 237, 119, 102470, 121643, 102470, 9468, 100, 239, 9468, 237, 123]
N: 🧛🏾‍♂ [9468, 100, 249, 9468, 237, 122, 102470, 17245, 224]

O: 🪄 [9468, 103, 226]
N: 🕴️ [9468, 243, 112, 31643]

O: 👩🏼‍🦯 [9468, 239, 102, 9468, 237, 120, 102470, 9468, 99, 107]
N: 👩🏼‍🦯 [9468, 239, 102, 9468, 237, 120, 102470, 9468, 99, 107]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.25s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.39s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.09s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.88s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.38s/it]
Processing depth (0, 4, 6, 7, 9):   4%|▍         | 4/100 [01:36<32:44, 20.47s/it]2025-01-22 05:24:49.546 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the office.
2025-01-22 05:24:49.547 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  moved to the office.
2025-01-22 05:24:49.547 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel picked up the milk.
2025-01-22 05:24:49.569 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3525, 3530) --> . Daniel picked up the
2025-01-22 05:24:49.569 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went back to the bedroom.
2025-01-22 05:24:49.592 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4717, 4723) --> . Daniel went back to the
2025-01-22 05:24:49.592 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the milk.
2025-01-22 05:24:49.619 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5603, 5607) -->  Daniel left the milk
2025-01-22 05:24:49.620 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra dropped the apple.
2025-01-22 05:24:49.654 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7210, 7214) -->  Sandra dropped the apple
2025-01-22 05:24:49.654 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the hallway.
2025-01-22 05:24:49.679 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4934, 4939) --> . Sandra moved to the
2025-01-22 05:24:49.679 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra picked up the apple.
2025-01-22 05:24:49.698 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3823, 3828) --> . Sandra picked up the
2025-01-22 05:24:49.698 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the hallway.
2025-01-22 05:24:49.698 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (149, 155) --> . John went back to the
2025-01-22 05:24:49.699 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the garden.
2025-01-22 05:24:49.700 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (250, 256) --> . Sandra went back to the
2025-01-22 05:24:49.700 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary went back to the hallway.
2025-01-22 05:24:49.701 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (150, 156) -->  John went back to the hallway
2025-01-22 05:24:49.701 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra left the apple.
2025-01-22 05:24:49.707 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (1298, 1302) -->  Sandra left the apple
2025-01-22 05:24:49.707 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Sandra picked up the apple.
2025-01-22 05:24:49.726 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (3823, 3828) --> . Sandra picked up the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:24:50.492 | INFO     | test_jbb_embedding:begin_test:693 - bedroom<|eot_id|>
2025-01-22 05:24:50.492 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8161])
2025-01-22 05:24:52.742 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [882.7083333333334, 74.97701519049369, 439.7533783783784, 70.91847691927919, 48.885124362244895], 'topk_indices': array([8141, 6082, 7533,   14, 7532, 3531, 7488, 5953,   35, 6089,   28,
         29, 4723,   24,   32,   34,   31, 8156,    0, 8157]), 'topk_tokens': [' to', 'the', 'nes', '\n', ' Min', '.', 'nes', ' office', '.', ' the', '<|end_header_id|>', '\n\n', ' bedroom', '\n\n', ' to', ' office', ' moved', '<|eot_id|>', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [1884.4, 656.6, 583.125, 843.25, 402.0625]}, 'weight': {'score': [23.016276041666668, 23.244514118583854, 23.09375, 23.245878718217725, 28.9671556122449], 'topk_indices': array([3294, 3321, 3214, 3166, 7387, 7425, 1446, 1508, 4320, 4304, 5195,
       5134, 7103, 7159, 3490, 3516, 4930, 4905, 4988, 4959]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.034375, 22.3625, 20.927083333333332, 26.462890625, 28.498046875]}, 'saliency': {'score': [5.0352783203125, 0.41626918670755236, 2.69994457347973, 0.3921575835827573, 0.35254217653858416], 'topk_indices': array([8140,   30, 8146,   24,  534, 6082,   27, 3530,  571, 7533, 5606,
       7532, 5953, 7488,    0,  155, 8148, 4723,   34,   31]), 'topk_tokens': [' prior', 'Daniel', ' milk', '\n\n', ' instead', 'the', 'user', ' milk', ' instead', 'nes', ' milk', ' Min', ' office', 'nes', '<|begin_of_text|>', ' hallway', ' discarded', ' bedroom', ' office', ' moved'], 'evidence_proportions': [9.997265625, 3.714453125, 3.0135091145833335, 5.64990234375, 2.90185546875]}}, 'pred_res': 'bedroom<|eot_id|>', 'score': 0}
2025-01-22 05:24:52.757 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:24:52.763 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-59_pid-4_0-4-6-7-9.pkl | len: 3 |  size: 2.06 KB
Processing depth (0, 4, 6, 7, 9):   5%|▌         | 5/100 [01:39<31:16, 19.75s/it]Processing depth (0, 4, 6, 7, 9):   5%|▌         | 5/100 [01:39<31:32, 19.92s/it]
2025-01-22 05:24:52.828 | INFO     | __main__:<module>:82 - Selected idx: 60
2025-01-22 05:24:52.828 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the football before the garden? 
2025-01-22 05:24:52.828 | INFO     | __main__:<module>:84 - Answer: hallway
2025-01-22 05:24:52.828 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 05:24:52.828 | INFO     | __main__:<module>:86 - Needle: [' John travelled to the kitchen.', ' John went back to the office.', ' Mary moved to the bedroom.', ' Sandra grabbed the football there.', ' Daniel went to the office.', ' Sandra journeyed to the hallway.', ' John went to the kitchen.', ' Sandra moved to the garden.', ' John travelled to the bedroom.']
2025-01-22 05:24:52.828 | INFO     | __main__:<module>:87 - Real Needle: [' Sandra grabbed the football there.', ' Sandra journeyed to the hallway.', ' Sandra moved to the garden.', ' John travelled to the bedroom.']
2025-01-22 05:24:52.828 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['🅰', '🥽', '🧙🏻\u200d♂', '🇦🇹', '💆🏿\u200d♂', '🐸', '😟', '🦜', '👷🏻\u200d♂', '🦓']
emoji:
O: 🅰 [9468, 227, 108]
N: 🅰 [9468, 227, 108]

O: 🥽 [9468, 98, 121]
N: 🇦🇹 [9468, 229, 99, 9468, 229, 117]

O: 🧙🏻‍♂ [9468, 100, 247, 9468, 237, 119, 102470, 17245, 224]
N: 😟 [76460, 253]

O: 🇦🇹 [9468, 229, 99, 9468, 229, 117]
N: 💆🏿‍♂ [93273, 228, 9468, 237, 123, 102470, 17245, 224]

O: 💆🏿‍♂ [93273, 228, 9468, 237, 123, 102470, 17245, 224]
N: 🥽 [9468, 98, 121]

O: 🐸 [9468, 238, 116]
N: 🐸 [9468, 238, 116]

O: 😟 [76460, 253]
N: 🦜 [9468, 99, 250]

O: 🦜 [9468, 99, 250]
N: 👷🏻‍♂ [9468, 239, 115, 9468, 237, 119, 102470, 17245, 224]

O: 👷🏻‍♂ [9468, 239, 115, 9468, 237, 119, 102470, 17245, 224]
N: 🧙🏻‍♂ [9468, 100, 247, 9468, 237, 119, 102470, 17245, 224]

O: 🦓 [9468, 99, 241]
N: 🦓 [9468, 99, 241]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:05<00:15,  5.00s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.99s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.32s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  2.99s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.61s/it]
Processing depth (0, 4, 8, 9):   0%|          | 0/100 [00:15<?, ?it/s]2025-01-22 05:25:08.971 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra grabbed the football there.
2025-01-22 05:25:08.971 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (32, 37) -->  grabbed the football there.
2025-01-22 05:25:08.971 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra journeyed to the hallway.
2025-01-22 05:25:08.990 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3632, 3638) --> . Sandra journeyed to the
2025-01-22 05:25:08.990 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the garden.
2025-01-22 05:25:09.024 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6527, 6532) --> . Sandra moved to the
2025-01-22 05:25:09.025 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John travelled to the bedroom.
2025-01-22 05:25:09.044 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3528, 3533) --> . John travelled to the
2025-01-22 05:25:09.044 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the kitchen.
2025-01-22 05:25:09.061 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3528, 3533) --> . John travelled to the
2025-01-22 05:25:09.061 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the office.
2025-01-22 05:25:09.103 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (7118, 7124) -->  John went back to the office
2025-01-22 05:25:09.103 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary moved to the bedroom.
2025-01-22 05:25:09.111 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1550, 1555) --> . Mary moved to the
2025-01-22 05:25:09.111 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went to the office.
2025-01-22 05:25:09.144 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6721, 6726) --> . Daniel went to the
2025-01-22 05:25:09.144 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went to the kitchen.
2025-01-22 05:25:09.163 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3529, 3534) -->  John travelled to the kitchen
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:25:10.275 | INFO     | test_jbb_embedding:begin_test:693 - There is no information about a football in the text before the garden.<|eot_id|>
2025-01-22 05:25:10.275 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8184])
2025-01-22 05:25:12.509 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [844.375, 66.50766459020399, 179.98317307692307, 64.13842905405406, 26.078392551369863], 'topk_indices': array([7659, 7600, 8179, 7634, 7614,   32, 7643, 7595, 7640,  329, 7629,
       7596, 7590,   34,   35,  540, 7591, 7635, 7644,    0]), 'topk_tokens': ['nes', ' three', '<|eot_id|>', ' bogus', 'nes', ' grabbed', ' two', ' set', ' set', ' of', ' or', ' up', ' tele', ' football', ' there', ',', 'graph', ' tele', ' or', '<|begin_of_text|>'], 'evidence_proportions': [2083.2, 472.5, 668.15, 228.025]}, 'weight': {'score': [21.296875, 23.280337730548432, 21.573317307692307, 23.29090717137592, 29.504708904109588], 'topk_indices': array([3331, 3304, 3160, 3208, 7461, 7423, 1468, 1406, 4320, 4336, 5208,
       5147, 7130, 7186, 3493, 3519, 5001, 4972, 4949, 4924]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.959375, 21.213541666666668, 21.040625, 19.990625]}, 'saliency': {'score': [5.331240699404762, 0.3792777540804019, 1.0378558819110577, 0.36439885319890203, 0.1874005043343322], 'topk_indices': array([ 328, 7569, 7589, 7659,  357, 7629, 7643, 7640, 7614, 7595, 7596,
       6528,   32, 7634,   35, 7590,   34, 7644, 7591, 7635]), 'topk_tokens': [' half', 'nes', ' bogus', 'nes', ' half', ' or', ' two', ' set', 'nes', ' set', ' up', ' Sandra', ' grabbed', ' bogus', ' there', ' tele', ' football', ' or', 'graph', ' tele'], 'evidence_proportions': [12.871484375, 2.9970703125, 4.64833984375, 1.27490234375]}}, 'pred_res': 'There is no information about a football in the text before the garden.<|eot_id|>', 'score': 0}
2025-01-22 05:25:12.515 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:25:12.515 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-60_pid-0_0-4-8-9.pkl | len: 3 |  size: 2.03 KB
Processing depth (0, 4, 8, 9):   1%|          | 1/100 [00:19<32:18, 19.58s/it]is_0k: False
your chose emoji: ['🤝🏼', '✅', '💇🏽\u200d♀️', '🪠', '👭🏾', '⏲️', '\U0001fac5🏽', '🧗🏼\u200d♂', '👩🏻\u200d❤️\u200d💋\u200d👩🏿', '👨🏽\u200d🚀']
emoji:
O: 🤝🏼 [9468, 97, 251, 9468, 237, 120]
N: �👩🏻‍❤️‍💋‍👩� [123, 9468, 239, 102, 9468, 237, 119, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237]

O: ✅ [38798, 227]
N: �🤝� [120, 9468, 97, 251, 9468, 237]

O: 💇🏽‍♀️ [93273, 229, 9468, 237, 121, 102470, 32990, 31643]
N: ️💇🏽‍♀ [31643, 93273, 229, 9468, 237, 121, 102470, 32990]

O: 🪠 [9468, 103, 254]
N: �� [254, 9468, 103]

O: 👭🏾 [9468, 239, 255, 9468, 237, 122]
N: �🧗🏼‍� [224, 9468, 100, 245, 9468, 237, 120, 102470, 17245]

O: ⏲️ [158, 237, 110, 31643]
N: �� [227, 38798]

O: 🫅🏽 [9468, 104, 227, 9468, 237, 121]
N: �👭� [122, 9468, 239, 255, 9468, 237]

O: 🧗🏼‍♂ [9468, 100, 245, 9468, 237, 120, 102470, 17245, 224]
N: �🫅� [121, 9468, 104, 227, 9468, 237]

O: 👩🏻‍❤️‍💋‍👩🏿 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 123]
N: ️⏲ [31643, 158, 237, 110]

O: 👨🏽‍🚀 [9468, 239, 101, 9468, 237, 121, 102470, 9468, 248, 222]
N: �👨🏽‍� [222, 9468, 239, 101, 9468, 237, 121, 102470, 9468, 248]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:11,  3.95s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.45s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.40s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.86s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.40s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 2, 5, 8):   1%|          | 1/100 [00:35<32:18, 19.58s/it]2025-01-22 05:25:28.015 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra grabbed the football there.
2025-01-22 05:25:28.015 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (32, 37) -->  grabbed the football there.
2025-01-22 05:25:28.015 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra journeyed to the hallway.
2025-01-22 05:25:28.025 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1866, 1872) --> . Sandra journeyed to the
2025-01-22 05:25:28.025 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the garden.
2025-01-22 05:25:28.045 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4174, 4179) -->  Sandra moved to the garden
2025-01-22 05:25:28.045 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John travelled to the bedroom.
2025-01-22 05:25:28.062 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3531, 3536) --> . John travelled to the
2025-01-22 05:25:28.062 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the kitchen.
2025-01-22 05:25:28.080 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3531, 3536) --> . John travelled to the
2025-01-22 05:25:28.080 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the office.
2025-01-22 05:25:28.115 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (7143, 7149) --> . John went back to the
2025-01-22 05:25:28.115 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary moved to the bedroom.
2025-01-22 05:25:28.123 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1526, 1531) --> . Mary moved to the
2025-01-22 05:25:28.123 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went to the office.
2025-01-22 05:25:28.155 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6747, 6752) --> . Daniel went to the
2025-01-22 05:25:28.155 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went to the kitchen.
2025-01-22 05:25:28.173 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3532, 3537) -->  John travelled to the kitchen
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:25:39.387 | INFO     | test_jbb_embedding:begin_test:693 - There is no information about a football in the text before the garden.<|eot_id|>
2025-01-22 05:25:39.387 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8214])
2025-01-22 05:25:42.369 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [735.3541666666666, 41.47411616161616, 176.48317307692307, 39.2609317625459, 41.03568892045455], 'topk_indices': array([8111,    1,    9,   31, 8202, 1511, 8068,   29,   14, 8201, 1872,
         24, 8112,   33, 8209, 8210,   32,   34,   35,    0]), 'topk_tokens': [' first', '<|start_header_id|>', ':', 'andra', ' before', 'ot', ' context', '\n\n', '\n', ' football', ' hallway', '\n\n', ' location', ' the', '<|eot_id|>', '<|start_header_id|>', ' grabbed', ' football', ' there', '<|begin_of_text|>'], 'evidence_proportions': [1930.9, 486.625, 397.25, 176.3875]}, 'weight': {'score': [22.371651785714285, 23.305190458804915, 20.80138221153846, 23.315558063035496, 29.604048295454547], 'topk_indices': array([3328, 3301, 3173, 3221, 7467, 7505, 1486, 1424, 4332, 4316, 5153,
       5214, 7244, 7188, 3522, 3496, 5007, 4955, 4978, 4930]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.959375, 21.213541666666668, 25.5546875, 19.990625]}, 'saliency': {'score': [4.606515066964286, 0.23346754679703663, 0.9357346754807693, 0.21999227834302326, 0.2962086417458274], 'topk_indices': array([8207,    0, 1868, 7798, 8204, 1510, 8196, 1531, 8111,   24, 1511,
       8202, 8068,   31, 8201, 8112, 1872,   32,   34,   35]), 'topk_tokens': ['Answer', '<|begin_of_text|>', ' journey', 'inen', ' garden', 'nes', 'Question', ' bedroom', ' first', '\n\n', 'ot', ' before', ' context', 'andra', ' football', ' location', ' hallway', ' grabbed', ' football', ' there'], 'evidence_proportions': [12.51015625, 2.7709147135416665, 2.5970703125, 0.9150390625]}}, 'pred_res': 'There is no information about a football in the text before the garden.<|eot_id|>', 'score': 0}
2025-01-22 05:25:42.375 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:25:42.375 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-60_pid-1_0-2-5-8.pkl | len: 3 |  size: 2.11 KB
Processing depth (0, 2, 5, 8):   2%|▏         | 2/100 [00:49<41:51, 25.63s/it]is_0k: False
your chose emoji: ['\U0001faf0🏾', '👨🏿\u200d🦽', '🧜🏻\u200d♂', '🏃🏻\u200d♀️\u200d➡️', '🅿', '🇲🇲', '🇻🇪', '🧑🏽\u200d🦼\u200d➡', '👩🏾\u200d❤️\u200d💋\u200d👩🏻', '☢️']
emoji:
O: 🫰🏾 [9468, 104, 108, 9468, 237, 122]
N: �🧜🏻‍� [224, 9468, 100, 250, 9468, 237, 119, 102470, 17245]

O: 👨🏿‍🦽 [9468, 239, 101, 9468, 237, 123, 102470, 9468, 99, 121]
N: �🇻� [103, 9468, 229, 119, 9468, 229]

O: 🧜🏻‍♂ [9468, 100, 250, 9468, 237, 119, 102470, 17245, 224]
N: ️🏃🏻‍♀️‍➡ [31643, 9468, 237, 225, 9468, 237, 119, 102470, 32990, 31643, 102470, 98115, 94]

O: 🏃🏻‍♀️‍➡️ [9468, 237, 225, 9468, 237, 119, 102470, 32990, 31643, 102470, 98115, 94, 31643]
N: �🫰� [122, 9468, 104, 108, 9468, 237]

O: 🅿 [9468, 227, 123]
N: �🇲� [110, 9468, 229, 110, 9468, 229]

O: 🇲🇲 [9468, 229, 110, 9468, 229, 110]
N: �� [123, 9468, 227]

O: 🇻🇪 [9468, 229, 119, 9468, 229, 103]
N: �👨🏿‍� [121, 9468, 239, 101, 9468, 237, 123, 102470, 9468, 99]

O: 🧑🏽‍🦼‍➡ [9468, 100, 239, 9468, 237, 121, 102470, 9468, 99, 120, 102470, 98115, 94]
N: �🧑🏽‍🦼‍� [94, 9468, 100, 239, 9468, 237, 121, 102470, 9468, 99, 120, 102470, 98115]

O: 👩🏾‍❤️‍💋‍👩🏻 [9468, 239, 102, 9468, 237, 122, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 119]
N: �👩🏾‍❤️‍💋‍👩� [119, 9468, 239, 102, 9468, 237, 122, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237]

O: ☢️ [18107, 95, 31643]
N: ️☢ [31643, 18107, 95]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.75s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.72s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.30s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.02s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.58s/it]
Processing depth (3, 5, 6, 8):   2%|▏         | 2/100 [01:05<41:51, 25.63s/it]2025-01-22 05:25:58.438 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra grabbed the football there.
2025-01-22 05:25:58.453 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2931, 2936) --> . Sandra grabbed the football
2025-01-22 05:25:58.453 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra journeyed to the hallway.
2025-01-22 05:25:58.474 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4199, 4205) --> . Sandra journeyed to the
2025-01-22 05:25:58.474 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the garden.
2025-01-22 05:25:58.498 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4768, 4773) --> . Sandra moved to the
2025-01-22 05:25:58.498 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John travelled to the bedroom.
2025-01-22 05:25:58.519 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3565, 3570) --> . John travelled to the
2025-01-22 05:25:58.520 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the kitchen.
2025-01-22 05:25:58.537 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3565, 3570) --> . John travelled to the
2025-01-22 05:25:58.537 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the office.
2025-01-22 05:25:58.573 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (7248, 7254) --> . John went back to the
2025-01-22 05:25:58.573 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary moved to the bedroom.
2025-01-22 05:25:58.581 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1519, 1524) --> . Mary moved to the
2025-01-22 05:25:58.581 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went to the office.
2025-01-22 05:25:58.621 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6830, 6835) --> . Daniel went to the
2025-01-22 05:25:58.621 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went to the kitchen.
2025-01-22 05:25:58.638 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3566, 3571) -->  John travelled to the kitchen
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:25:59.416 | INFO     | test_jbb_embedding:begin_test:693 - the hallway<|eot_id|>
2025-01-22 05:25:59.416 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8199])
2025-01-22 05:26:01.655 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [381.8154761904762, 22.61770376127774, 168.7481971153846, 21.226833614347026, 25.98953510802469], 'topk_indices': array([7535, 4202, 8198, 8193, 3570, 8186,    3, 2936,   24, 8197, 2931,
       4201, 2933,   14, 2932, 2903, 4205, 2935,    0, 8194]), 'topk_tokens': ['nes', 'ed', '\n\n', ':', ' kitchen', ' football', '<|end_header_id|>', ' there', '\n\n', '<|end_header_id|>', '.', ' journey', ' grabbed', '\n', ' Sandra', '.', ' hallway', ' football', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [689.8, 422.6666666666667, 151.975, 254.65]}, 'weight': {'score': [22.005208333333332, 23.29979159046574, 20.80138221153846, 23.3110907801962, 29.83159722222222], 'topk_indices': array([3328, 3301, 3173, 3221, 7434, 7472, 1479, 1417, 4359, 4343, 5172,
       5233, 7142, 7198, 3510, 3484, 5026, 4949, 4974, 4997]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [25.934375, 21.213541666666668, 21.040625, 19.990625]}, 'saliency': {'score': [2.3462379092261907, 0.12858571496948154, 0.9692946213942307, 0.12019465088040313, 0.19316044560185186], 'topk_indices': array([  24, 7580, 7579, 2939, 8192, 2930, 8189, 7535, 1524, 2936, 2902,
       3570, 3003, 4200, 8186, 4201, 2933, 2932, 2935, 4205]), 'topk_tokens': ['\n\n', 'nes', ' Min', 'ible', 'Answer', ' Gov', ' garden', 'nes', ' bedroom', ' there', ' Gov', ' kitchen', '❤', ' Sandra', ' football', ' journey', ' grabbed', ' Sandra', ' football', ' hallway'], 'evidence_proportions': [4.8802734375, 2.3885904947916665, 0.79443359375, 1.31318359375]}}, 'pred_res': 'the hallway<|eot_id|>', 'score': 100}
2025-01-22 05:26:01.662 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:26:01.662 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-60_pid-2_3-5-6-8.pkl | len: 3 |  size: 2.02 KB
Processing depth (3, 5, 6, 8):   3%|▎         | 3/100 [01:08<36:44, 22.73s/it]is_0k: False
your chose emoji: ['🖌', '🚶🏿\u200d♂', '🕐', '🏊🏻', '🧑🏿\u200d❤️\u200d🧑🏼', '👩🏽\u200d❤\u200d👨🏼', '💆🏽\u200d♂️', '🍽', '💁🏽\u200d♀️', '🧘🏽\u200d♀️']
emoji:
O: 🖌 [9468, 244, 234]
N: 🚶🏿‍♂ [9468, 248, 114, 9468, 237, 123, 102470, 17245, 224]

O: 🚶🏿‍♂ [9468, 248, 114, 9468, 237, 123, 102470, 17245, 224]
N: 💁🏽‍♀️ [93273, 223, 9468, 237, 121, 102470, 32990, 31643]

O: 🕐 [9468, 243, 238]
N: 👩🏽‍❤‍👨🏼 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 120]

O: 🏊🏻 [9468, 237, 232, 9468, 237, 119]
N: 🧑🏿‍❤️‍🧑🏼 [9468, 100, 239, 9468, 237, 123, 102470, 121643, 31643, 102470, 9468, 100, 239, 9468, 237, 120]

O: 🧑🏿‍❤️‍🧑🏼 [9468, 100, 239, 9468, 237, 123, 102470, 121643, 31643, 102470, 9468, 100, 239, 9468, 237, 120]
N: 💆🏽‍♂️ [93273, 228, 9468, 237, 121, 102470, 17245, 224, 31643]

O: 👩🏽‍❤‍👨🏼 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 120]
N: 🏊🏻 [9468, 237, 232, 9468, 237, 119]

O: 💆🏽‍♂️ [93273, 228, 9468, 237, 121, 102470, 17245, 224, 31643]
N: 🕐 [9468, 243, 238]

O: 🍽 [9468, 235, 121]
N: 🖌 [9468, 244, 234]

O: 💁🏽‍♀️ [93273, 223, 9468, 237, 121, 102470, 32990, 31643]
N: 🍽 [9468, 235, 121]

O: 🧘🏽‍♀️ [9468, 100, 246, 9468, 237, 121, 102470, 32990, 31643]
N: 🧘🏽‍♀️ [9468, 100, 246, 9468, 237, 121, 102470, 32990, 31643]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.07s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.43s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:03,  3.93s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  2.56s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  3.14s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 2, 8, 9):   3%|▎         | 3/100 [01:23<36:44, 22.73s/it]2025-01-22 05:26:16.050 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra grabbed the football there.
2025-01-22 05:26:16.050 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (32, 37) -->  grabbed the football there.
2025-01-22 05:26:16.050 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra journeyed to the hallway.
2025-01-22 05:26:16.061 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2011, 2017) -->  cable. Sandra journeyed to
2025-01-22 05:26:16.061 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the garden.
2025-01-22 05:26:16.098 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6653, 6658) --> . Sandra moved to the
2025-01-22 05:26:16.099 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John travelled to the bedroom.
2025-01-22 05:26:16.116 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3595, 3600) --> . John travelled to the
2025-01-22 05:26:16.117 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the kitchen.
2025-01-22 05:26:16.134 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3595, 3600) --> . John travelled to the
2025-01-22 05:26:16.134 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the office.
2025-01-22 05:26:16.174 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (7132, 7138) -->  John went back to the office
2025-01-22 05:26:16.174 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary moved to the bedroom.
2025-01-22 05:26:16.182 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1550, 1555) --> . Mary moved to the
2025-01-22 05:26:16.182 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went to the office.
2025-01-22 05:26:16.218 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6820, 6825) -->  Daniel went to the office
2025-01-22 05:26:16.218 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went to the kitchen.
2025-01-22 05:26:16.237 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3596, 3601) -->  John travelled to the kitchen
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:26:25.435 | INFO     | test_jbb_embedding:begin_test:693 - There is no information about a football in the text.<|eot_id|>
2025-01-22 05:26:25.435 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8210])
2025-01-22 05:26:28.504 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [605.2574404761905, 41.753683185194205, 115.16165865384616, 40.07082912380603, 17.284122910610463], 'topk_indices': array([8204,   31,   40,   36,  329,   29,  509, 2018,  186,  545,   14,
       8108,   33,   24, 8205,   32,  540,   35,   34,    0]), 'topk_tokens': [':', 'andra', '\n\n\n', '.', ' of', '\n\n', ',', ' hallway', 'ION', ',', '\n', ' location', ' the', '\n\n', '<|eot_id|>', ' grabbed', ',', ' there', ' football', '<|begin_of_text|>'], 'evidence_proportions': [1781.9, 365.328125, 231.875, 89.9125]}, 'weight': {'score': [22.350818452380953, 23.297626476318033, 22.345252403846153, 23.30309361988734, 29.389353197674417], 'topk_indices': array([3306, 3279, 3171, 3123, 7449, 7487, 1468, 1406, 4330, 4314, 5125,
       5186, 7144, 7200, 3488, 3462, 4950, 4927, 4902, 4979]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.959375, 24.90234375, 21.040625, 19.990625]}, 'saliency': {'score': [3.7477969215029763, 0.23343550597185864, 0.6415006197415866, 0.22309858671100063, 0.12904437752657158], 'topk_indices': array([  75, 8107,    0,  113, 8203,   39, 8064,  328,  424,   24,  357,
         40, 8197,  186,   31, 8108, 2018,   32,   35,   34]), 'topk_tokens': [' PA', ' first', '<|begin_of_text|>', ' PA', 'Answer', '***', ' context', ' half', '000', '\n\n', ' half', '\n\n\n', ' football', 'ION', 'andra', ' location', ' hallway', ' grabbed', ' there', ' football'], 'evidence_proportions': [11.267578125, 2.2490641276041665, 1.31005859375, 0.4642333984375]}}, 'pred_res': 'There is no information about a football in the text.<|eot_id|>', 'score': 0}
2025-01-22 05:26:28.511 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:26:28.511 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-60_pid-3_0-2-8-9.pkl | len: 3 |  size: 2.02 KB
Processing depth (0, 2, 8, 9):   4%|▍         | 4/100 [01:35<38:58, 24.36s/it]is_0k: False
your chose emoji: ['🩹', '👨🏿\u200d🚒', '🧑🏽\u200d🤝\u200d🧑🏾', '🧖\u200d♂', '🏄🏾\u200d♀', '👩🏾\u200d🦼\u200d➡️', '🦸', '🙋🏾\u200d♀️', '🇬🇮', '🤽🏾\u200d♂️']
emoji:
O: 🩹 [9468, 102, 117]
N: �� [116, 9468, 99]

O: 👨🏿‍🚒 [9468, 239, 101, 9468, 237, 123, 102470, 9468, 248, 240]
N: ️👩🏾‍🦼‍➡ [31643, 9468, 239, 102, 9468, 237, 122, 102470, 9468, 99, 120, 102470, 98115, 94]

O: 🧑🏽‍🤝‍🧑🏾 [9468, 100, 239, 9468, 237, 121, 102470, 9468, 97, 251, 102470, 9468, 100, 239, 9468, 237, 122]
N: �🧑🏽‍🤝‍🧑� [122, 9468, 100, 239, 9468, 237, 121, 102470, 9468, 97, 251, 102470, 9468, 100, 239, 9468, 237]

O: 🧖‍♂ [9468, 100, 244, 102470, 17245, 224]
N: ♀🏄🏾‍ [32990, 9468, 237, 226, 9468, 237, 122, 102470]

O: 🏄🏾‍♀ [9468, 237, 226, 9468, 237, 122, 102470, 32990]
N: ️🙋🏾‍♀ [31643, 9468, 247, 233, 9468, 237, 122, 102470, 32990]

O: 👩🏾‍🦼‍➡️ [9468, 239, 102, 9468, 237, 122, 102470, 9468, 99, 120, 102470, 98115, 94, 31643]
N: �🧖‍� [224, 9468, 100, 244, 102470, 17245]

O: 🦸 [9468, 99, 116]
N: �🇬� [106, 9468, 229, 105, 9468, 229]

O: 🙋🏾‍♀️ [9468, 247, 233, 9468, 237, 122, 102470, 32990, 31643]
N: �� [117, 9468, 102]

O: 🇬🇮 [9468, 229, 105, 9468, 229, 106]
N: �👨🏿‍� [240, 9468, 239, 101, 9468, 237, 123, 102470, 9468, 248]

O: 🤽🏾‍♂️ [9468, 97, 121, 9468, 237, 122, 102470, 17245, 224, 31643]
N: ️🤽🏾‍♂ [31643, 9468, 97, 121, 9468, 237, 122, 102470, 17245, 224]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.65s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.51s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.13s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.87s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.42s/it]
Processing depth (0, 1, 2, 3):   4%|▍         | 4/100 [01:50<38:58, 24.36s/it]2025-01-22 05:26:43.931 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra grabbed the football there.
2025-01-22 05:26:43.931 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (32, 37) -->  grabbed the football there.
2025-01-22 05:26:43.932 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra journeyed to the hallway.
2025-01-22 05:26:43.936 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (784, 790) --> . Sandra journeyed to the
2025-01-22 05:26:43.936 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the garden.
2025-01-22 05:26:43.944 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1753, 1758) --> . Sandra moved to the
2025-01-22 05:26:43.945 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John travelled to the bedroom.
2025-01-22 05:26:43.958 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2893, 2898) --> . John travelled to the
2025-01-22 05:26:43.959 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the kitchen.
2025-01-22 05:26:43.973 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2893, 2898) --> . John travelled to the
2025-01-22 05:26:43.973 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the office.
2025-01-22 05:26:44.007 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (7081, 7087) --> . John went back to the
2025-01-22 05:26:44.008 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary moved to the bedroom.
2025-01-22 05:26:44.014 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1305, 1310) --> . Mary moved to the
2025-01-22 05:26:44.014 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went to the office.
2025-01-22 05:26:44.046 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6685, 6690) --> . Daniel went to the
2025-01-22 05:26:44.047 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went to the kitchen.
2025-01-22 05:26:44.064 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3528, 3533) -->  John travelled to the kitchen
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:26:45.162 | INFO     | test_jbb_embedding:begin_test:693 - There is no information about a football in the text before the garden.<|eot_id|>
2025-01-22 05:26:45.162 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8152])
2025-01-22 05:26:47.384 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [742.9821428571429, 34.55615803188228, 88.80528846153847, 32.54734906882092, 28.282894736842106], 'topk_indices': array([1036,  790,    1,   24,   28,   31, 1037,   29, 1076,   33, 8140,
       8139, 1038, 1077, 8147,   32,   34,    0,   35, 8148]), 'topk_tokens': [' galaxy', ' hallway', '<|start_header_id|>', '\n\n', '<|end_header_id|>', 'andra', ' of', '\n\n', ' galaxy', ' the', ' before', ' football', ' states', ' of', '<|eot_id|>', ' grabbed', ' football', '<|begin_of_text|>', ' there', '<|start_header_id|>'], 'evidence_proportions': [2167.8, 502.3333333333333, 253.075, 96.85]}, 'weight': {'score': [21.296875, 23.2511572654813, 20.80138221153846, 23.264074640786877, 29.164473684210527], 'topk_indices': array([3336, 3309, 3181, 3229, 7443, 7405, 1513, 1451, 4328, 4312, 5145,
       5206, 7182, 7126, 3518, 3492, 4931, 4906, 4954, 4983]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.959375, 21.213541666666668, 21.040625, 19.990625]}, 'saliency': {'score': [4.6958124069940474, 0.1913708638297057, 0.46592947152944714, 0.1788237750030352, 0.20496087325246712], 'topk_indices': array([8134, 8142, 7550, 8136,   29, 7551, 1077, 8050,    0,  785, 1036,
        790, 8140,   31, 1038, 1076, 8139,   32,   34,   35]), 'topk_tokens': ['Question', ' garden', ' Min', ' Where', '\n\n', 'nes', ' of', ' location', '<|begin_of_text|>', ' Sandra', ' galaxy', ' hallway', ' before', 'andra', ' states', ' galaxy', ' football', ' grabbed', ' football', ' there'], 'evidence_proportions': [14.204296875, 3.0297037760416665, 1.38720703125, 0.495263671875]}}, 'pred_res': 'There is no information about a football in the text before the garden.<|eot_id|>', 'score': 0}
2025-01-22 05:26:47.401 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:26:47.402 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-60_pid-4_0-1-2-3.pkl | len: 3 |  size: 2.13 KB
Processing depth (0, 1, 2, 3):   5%|▌         | 5/100 [01:54<35:26, 22.39s/it]Processing depth (0, 1, 2, 3):   5%|▌         | 5/100 [01:54<36:15, 22.91s/it]
2025-01-22 05:26:47.463 | INFO     | __main__:<module>:82 - Selected idx: 61
2025-01-22 05:26:47.463 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the location prior to the place where the football was discarded, left or dropped?
2025-01-22 05:26:47.463 | INFO     | __main__:<module>:84 - Answer: hallway
2025-01-22 05:26:47.463 | INFO     | __main__:<module>:85 - Tag: 4-hop
2025-01-22 05:26:47.463 | INFO     | __main__:<module>:86 - Needle: [' Sandra journeyed to the hallway.', ' Sandra grabbed the football there.', ' John travelled to the kitchen.', ' Daniel went to the office.', ' John went to the kitchen.', ' Sandra moved to the garden.', ' John went back to the office.', ' Mary moved to the bedroom.', ' Sandra dropped the football.', ' John travelled to the bedroom.']
2025-01-22 05:26:47.463 | INFO     | __main__:<module>:87 - Real Needle: [' Sandra journeyed to the hallway.', ' Sandra grabbed the football there.', ' Sandra moved to the garden.', ' Sandra dropped the football.', ' John travelled to the bedroom.']
2025-01-22 05:26:47.463 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['📳', '💑🏻', '🛕', '🧑🏾\u200d🔧', '🤞', '\U0001fa75', '🙍🏿\u200d♂', '🤾🏽\u200d♂️', '🙍🏽\u200d♀', '📋']
emoji:
O: 📳 [9468, 241, 111]
N: �🧑🏾‍� [100, 9468, 100, 239, 9468, 237, 122, 102470, 9468, 242]

O: 💑🏻 [93273, 239, 9468, 237, 119]
N: �� [113, 9468, 102]

O: 🛕 [9468, 249, 243]
N: �� [243, 9468, 249]

O: 🧑🏾‍🔧 [9468, 100, 239, 9468, 237, 122, 102470, 9468, 242, 100]
N: ️🤾🏽‍♂ [31643, 9468, 97, 122, 9468, 237, 121, 102470, 17245, 224]

O: 🤞 [9468, 97, 252]
N: �🙍🏿‍� [224, 9468, 247, 235, 9468, 237, 123, 102470, 17245]

O: 🩵 [9468, 102, 113]
N: �� [111, 9468, 241]

O: 🙍🏿‍♂ [9468, 247, 235, 9468, 237, 123, 102470, 17245, 224]
N: ♀🙍🏽‍ [32990, 9468, 247, 235, 9468, 237, 121, 102470]

O: 🤾🏽‍♂️ [9468, 97, 122, 9468, 237, 121, 102470, 17245, 224, 31643]
N: �💑� [119, 93273, 239, 9468, 237]

O: 🙍🏽‍♀ [9468, 247, 235, 9468, 237, 121, 102470, 32990]
N: �� [252, 9468, 97]

O: 📋 [9468, 241, 233]
N: �� [233, 9468, 241]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.83s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.82s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.55s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.09s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.68s/it]
Processing depth (0, 3, 6, 8, 9):   0%|          | 0/100 [00:16<?, ?it/s]2025-01-22 05:27:04.038 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra journeyed to the hallway.
2025-01-22 05:27:04.039 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (32, 38) -->  journeyed to the hallway.
2025-01-22 05:27:04.040 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra grabbed the football there.
2025-01-22 05:27:04.057 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3045, 3050) --> . Sandra grabbed the football
2025-01-22 05:27:04.058 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the garden.
2025-01-22 05:27:04.084 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4934, 4939) --> . Sandra moved to the
2025-01-22 05:27:04.084 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra dropped the football.
2025-01-22 05:27:04.117 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6639, 6643) -->  Sandra dropped the football
2025-01-22 05:27:04.117 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John travelled to the bedroom.
2025-01-22 05:27:04.130 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (2517, 2522) --> . John travelled to the
2025-01-22 05:27:04.130 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the kitchen.
2025-01-22 05:27:04.142 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2517, 2522) --> . John travelled to the
2025-01-22 05:27:04.142 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the office.
2025-01-22 05:27:04.163 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4250, 4255) -->  back to the office.
2025-01-22 05:27:04.163 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went to the kitchen.
2025-01-22 05:27:04.175 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2518, 2523) -->  John travelled to the kitchen
2025-01-22 05:27:04.175 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the office.
2025-01-22 05:27:04.196 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4247, 4253) --> . John went back to the
2025-01-22 05:27:04.196 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary moved to the bedroom.
2025-01-22 05:27:04.230 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6946, 6951) -->  Mary moved to the bedroom
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:27:04.991 | INFO     | test_jbb_embedding:begin_test:693 - the garden<|eot_id|>
2025-01-22 05:27:04.991 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8192])
2025-01-22 05:27:07.245 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [1062.9, 69.6093730933496, 310.3125, 65.79177154960708, 56.22120535714286], 'topk_indices': array([ 397, 2046, 6643, 3049,   34, 6640, 8187,   32, 2092, 2083, 2045,
       6077, 2079,   33, 8188,   36, 6642,   37, 2093,    0]), 'topk_tokens': [' hour', ' river', '.', ' football', ' to', ' dropped', '<|eot_id|>', ' journey', ' up', ' du', ' the', 'the', '\n', 'ed', '<|start_header_id|>', ' hallway', ' football', '.', ' the', '<|begin_of_text|>'], 'evidence_proportions': [1904.8333333333333, 910.9, 320.0, 1533.25, 571.2]}, 'weight': {'score': [23.1003125, 23.288859441732765, 21.591346153846153, 23.294857602222496, 30.27433035714286], 'topk_indices': array([3245, 3272, 3165, 3117, 7470, 7432, 1469, 1407, 4259, 4275, 5114,
       5175, 7129, 7185, 3428, 3454, 4895, 4872, 4924, 4847]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.276041666666668, 25.934375, 21.040625, 28.755859375, 19.990625]}, 'saliency': {'score': [6.57587890625, 0.39225316027303236, 1.8468956580528846, 0.36862701236147777, 0.4265847342354911], 'topk_indices': array([2093, 3050,   33, 2036, 2092,    0,   31, 6077, 8179, 2082, 8177,
       2091,  397, 6640, 2046, 2083, 3049,   32, 6642,   36]), 'topk_tokens': [' the', ' there', 'ed', ' Ch', ' up', '<|begin_of_text|>', 'andra', 'the', ' discarded', 'irie', ' football', ' farther', ' hour', ' dropped', ' river', ' du', ' football', ' journey', ' football', ' hallway'], 'evidence_proportions': [10.472005208333334, 6.38359375, 1.83349609375, 11.017578125, 3.2818359375]}}, 'pred_res': 'the garden<|eot_id|>', 'score': 0}
2025-01-22 05:27:07.251 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:27:07.252 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-61_pid-0_0-3-6-8-9.pkl | len: 3 |  size: 2.07 KB
Processing depth (0, 3, 6, 8, 9):   1%|          | 1/100 [00:19<32:30, 19.70s/it]is_0k: False
your chose emoji: ['🧍🏽\u200d♂️', '🏃🏽\u200d♀', '♣️', '🚶🏼\u200d♀\u200d➡', '🚴🏿\u200d♂', '🏊🏼\u200d♂️', '🏆', '🚢', '💂🏻\u200d♀️', '👱\u200d♀']
emoji:
O: 🧍🏽‍♂️ [9468, 100, 235, 9468, 237, 121, 102470, 17245, 224, 31643]
N: �🚶🏼‍♀‍� [94, 9468, 248, 114, 9468, 237, 120, 102470, 32990, 102470, 98115]

O: 🏃🏽‍♀ [9468, 237, 225, 9468, 237, 121, 102470, 32990]
N: ️♣ [31643, 17245, 96]

O: ♣️ [17245, 96, 31643]
N: ️💂🏻‍♀ [31643, 93273, 224, 9468, 237, 119, 102470, 32990]

O: 🚶🏼‍♀‍➡ [9468, 248, 114, 9468, 237, 120, 102470, 32990, 102470, 98115, 94]
N: ♀🏃🏽‍ [32990, 9468, 237, 225, 9468, 237, 121, 102470]

O: 🚴🏿‍♂ [9468, 248, 112, 9468, 237, 123, 102470, 17245, 224]
N: ️🧍🏽‍♂ [31643, 9468, 100, 235, 9468, 237, 121, 102470, 17245, 224]

O: 🏊🏼‍♂️ [9468, 237, 232, 9468, 237, 120, 102470, 17245, 224, 31643]
N: �� [95, 9468, 248]

O: 🏆 [9468, 237, 228]
N: ️🏊🏼‍♂ [31643, 9468, 237, 232, 9468, 237, 120, 102470, 17245, 224]

O: 🚢 [9468, 248, 95]
N: �� [228, 9468, 237]

O: 💂🏻‍♀️ [93273, 224, 9468, 237, 119, 102470, 32990, 31643]
N: �🚴🏿‍� [224, 9468, 248, 112, 9468, 237, 123, 102470, 17245]

O: 👱‍♀ [9468, 239, 109, 102470, 32990]
N: ♀👱‍ [32990, 9468, 239, 109, 102470]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:11,  3.90s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:09,  4.52s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.30s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.04s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.50s/it]
Processing depth (0, 2, 3, 5, 6):   1%|          | 1/100 [00:35<32:30, 19.70s/it]2025-01-22 05:27:22.926 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra journeyed to the hallway.
2025-01-22 05:27:22.926 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (32, 38) -->  journeyed to the hallway.
2025-01-22 05:27:22.927 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra grabbed the football there.
2025-01-22 05:27:22.944 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1795, 1800) --> . Sandra grabbed the football
2025-01-22 05:27:22.944 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the garden.
2025-01-22 05:27:22.961 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2847, 2852) --> . Sandra moved to the
2025-01-22 05:27:22.961 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra dropped the football.
2025-01-22 05:27:22.985 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4194, 4198) -->  Sandra dropped the football
2025-01-22 05:27:22.985 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John travelled to the bedroom.
2025-01-22 05:27:22.999 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (2237, 2242) --> . John travelled to the
2025-01-22 05:27:22.999 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the kitchen.
2025-01-22 05:27:23.014 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2237, 2242) --> . John travelled to the
2025-01-22 05:27:23.014 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the office.
2025-01-22 05:27:23.035 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4201, 4206) -->  back to the office.
2025-01-22 05:27:23.035 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went to the kitchen.
2025-01-22 05:27:23.046 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2238, 2243) -->  John travelled to the kitchen
2025-01-22 05:27:23.046 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the office.
2025-01-22 05:27:23.070 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4197, 4203) -->  football. John went back to
2025-01-22 05:27:23.070 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary moved to the bedroom.
2025-01-22 05:27:23.108 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7037, 7042) --> . Mary moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:27:23.916 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 05:27:23.916 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8224])
2025-01-22 05:27:26.156 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [604.765, 42.222753585754226, 315.47596153846155, 39.63369541952055, 63.16837754360465], 'topk_indices': array([8211, 4198, 8198, 7407,   41,   34,   33,   14,   24,   25, 1809,
         32, 8204, 8209, 4197, 1799, 8220,   36, 8219,    0]), 'topk_tokens': [' discarded', '.', ':', 'nes', '\n\n\n', ' to', 'ed', '\n', '\n\n', '<|eot_id|>', '�', ' journey', ' to', ' football', ' football', ' football', '<|start_header_id|>', ' hallway', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [851.5833333333334, 680.75, 323.475, 709.875, 429.8]}, 'weight': {'score': [23.1003125, 23.302743633766866, 21.40985576923077, 23.30938207100049, 29.638808139534884], 'topk_indices': array([3305, 3332, 3225, 3177, 7492, 7454, 1431, 1493, 4370, 4386, 5193,
       5254, 7169, 7225, 3514, 3488, 4964, 5012, 5041, 4989]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.276041666666668, 25.934375, 21.040625, 28.755859375, 19.990625]}, 'saliency': {'score': [3.814375, 0.2404315095778382, 1.7928654597355769, 0.22456655483656435, 0.48432070709938224], 'topk_indices': array([  40, 1818, 1588, 2239, 1808, 7407,   31,   41, 8203, 1797, 8197,
       1819, 1796, 8211,   32, 8209, 1809, 4197, 1799,   36]), 'topk_tokens': ['***', '\u200d', 'ern', ' travelled', '\u200d', 'nes', 'andra', '\n\n\n', ' prior', ' grabbed', 'Question', '�', ' Sandra', ' discarded', ' journey', ' football', '�', ' football', ' football', ' hallway'], 'evidence_proportions': [5.089029947916667, 4.937109375, 1.71806640625, 5.001953125, 2.30830078125]}}, 'pred_res': 'The garden.<|eot_id|>', 'score': 0}
2025-01-22 05:27:26.190 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:27:26.190 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-61_pid-1_0-2-3-5-6.pkl | len: 3 |  size: 2.07 KB
Processing depth (0, 2, 3, 5, 6):   2%|▏         | 2/100 [00:38<31:26, 19.25s/it]is_0k: False
your chose emoji: ['\U0001faf1🏼', '👸🏼', '🧏🏿\u200d♂️', '👨🏾\u200d❤️\u200d💋\u200d👨🏾', '🎶', '🤽🏼\u200d♂', '👩🏼\u200d❤\u200d💋\u200d👨🏽', '🇱🇨', '🛡️', '👧🏾']
emoji:
O: 🫱🏼 [9468, 104, 109, 9468, 237, 120]
N: �🫱� [120, 9468, 104, 109, 9468, 237]

O: 👸🏼 [9468, 110848, 9468, 237, 120]
N: �🇱� [101, 9468, 229, 109, 9468, 229]

O: 🧏🏿‍♂️ [9468, 100, 237, 9468, 237, 123, 102470, 17245, 224, 31643]
N: ️🧏🏿‍♂ [31643, 9468, 100, 237, 9468, 237, 123, 102470, 17245, 224]

O: 👨🏾‍❤️‍💋‍👨🏾 [9468, 239, 101, 9468, 237, 122, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 122]
N: �👸� [120, 9468, 110848, 9468, 237]

O: 🎶 [9468, 236, 114]
N: �👨🏾‍❤️‍💋‍👨� [122, 9468, 239, 101, 9468, 237, 122, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237]

O: 🤽🏼‍♂ [9468, 97, 121, 9468, 237, 120, 102470, 17245, 224]
N: �👩🏼‍❤‍💋‍👨� [121, 9468, 239, 102, 9468, 237, 120, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237]

O: 👩🏼‍❤‍💋‍👨🏽 [9468, 239, 102, 9468, 237, 120, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 121]
N: �🤽🏼‍� [224, 9468, 97, 121, 9468, 237, 120, 102470, 17245]

O: 🇱🇨 [9468, 229, 109, 9468, 229, 101]
N: �� [114, 9468, 236]

O: 🛡️ [9468, 249, 94, 31643]
N: ️🛡 [31643, 9468, 249, 94]

O: 👧🏾 [9468, 239, 100, 9468, 237, 122]
N: �👧� [122, 9468, 239, 100, 9468, 237]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.11s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.14s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:11<00:03,  3.92s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  2.57s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  3.11s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (1, 3, 6, 7, 9):   2%|▏         | 2/100 [00:52<31:26, 19.25s/it]2025-01-22 05:27:40.446 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra journeyed to the hallway.
2025-01-22 05:27:40.451 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (895, 901) --> . Sandra journeyed to the
2025-01-22 05:27:40.451 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra grabbed the football there.
2025-01-22 05:27:40.467 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2906, 2911) --> . Sandra grabbed the football
2025-01-22 05:27:40.467 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the garden.
2025-01-22 05:27:40.490 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4781, 4786) -->  the senate. Sandra moved
2025-01-22 05:27:40.491 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra dropped the football.
2025-01-22 05:27:40.517 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5672, 5676) -->  Sandra dropped the football
2025-01-22 05:27:40.518 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John travelled to the bedroom.
2025-01-22 05:27:40.529 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (2432, 2437) --> . John travelled to the
2025-01-22 05:27:40.529 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the kitchen.
2025-01-22 05:27:40.541 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2432, 2437) --> . John travelled to the
2025-01-22 05:27:40.542 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the office.
2025-01-22 05:27:40.562 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4173, 4178) -->  back to the office.
2025-01-22 05:27:40.562 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went to the kitchen.
2025-01-22 05:27:40.574 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2433, 2438) -->  John travelled to the kitchen
2025-01-22 05:27:40.574 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the office.
2025-01-22 05:27:40.594 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4170, 4176) --> . John went back to the
2025-01-22 05:27:40.595 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary moved to the bedroom.
2025-01-22 05:27:40.629 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6976, 6981) --> . Mary moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:27:47.410 | INFO     | test_jbb_embedding:begin_test:693 - Sandra dropped the football.<|eot_id|>
2025-01-22 05:27:47.410 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8225])
2025-01-22 05:27:50.651 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [411.14125, 39.24062651920272, 207.51923076923077, 37.568526813012106, 27.520519037356323], 'topk_indices': array([5676, 8106, 8105,   14, 8118, 8108, 7287, 8113, 8132, 8112, 8127,
       8111, 8130, 8104, 8134, 8142, 8114, 8143,    0, 8144]), 'topk_tokens': ['.', ' a', 'If', '\n', ' the', ' obtained', ' left', ' first', ' a', ' the', ' the', ' in', '.\n', '.\n\n', ' left', ' moved', ' location', ' to', '<|begin_of_text|>', ' the'], 'evidence_proportions': [448.5, 424.65, 233.08125, 696.125, 302.875]}, 'weight': {'score': [24.0309375, 23.309364745381625, 20.547776442307693, 23.31593952549835, 29.838721264367816], 'topk_indices': array([3329, 3302, 3174, 3222, 7483, 7445, 1514, 1452, 4314, 4330, 5155,
       5216, 7216, 7160, 3511, 3485, 5003, 4926, 4974, 4951]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.213541666666668, 25.934375, 25.76875, 28.755859375, 19.990625]}, 'saliency': {'score': [2.7437744140625, 0.21830017356891104, 1.1812180739182692, 0.20751715761912223, 0.20258269912895116], 'topk_indices': array([8131, 8119, 8107, 8212, 8105, 8110, 8116, 8070, 5675, 8210, 8143,
       7287, 8104, 5672, 8113, 8108, 8144, 8134, 8114, 8142]), 'topk_tokens': ['If', ' second', ' person', ' discarded', 'If', ' item', ' traveled', ' context', ' football', ' football', ' to', ' left', '.\n\n', ' Sandra', ' first', ' obtained', ' the', ' left', ' location', ' moved'], 'evidence_proportions': [2.6847330729166665, 2.89775390625, 1.6906494140625, 5.247314453125, 1.7109375]}}, 'pred_res': 'Sandra dropped the football.<|eot_id|>', 'score': 0}
2025-01-22 05:27:50.658 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:27:50.658 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-61_pid-2_1-3-6-7-9.pkl | len: 3 |  size: 2.05 KB
Processing depth (1, 3, 6, 7, 9):   3%|▎         | 3/100 [01:03<34:58, 21.63s/it]is_0k: False
your chose emoji: ['👩🏾\u200d❤\u200d💋\u200d👨🏽', '🧓🏻', '🧘🏻\u200d♀️', '🧎🏾\u200d♂️\u200d➡️', '🧙🏻\u200d♀️', '🚞', '🙇🏻\u200d♂', '🫕', '🤸🏽\u200d♂️', '🕵🏽']
emoji:
O: 👩🏾‍❤‍💋‍👨🏽 [9468, 239, 102, 9468, 237, 122, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 121]
N: 🧎🏾‍♂️‍➡️ [9468, 100, 236, 9468, 237, 122, 102470, 17245, 224, 31643, 102470, 98115, 94, 31643]

O: 🧓🏻 [9468, 100, 241, 9468, 237, 119]
N: 🧙🏻‍♀️ [9468, 100, 247, 9468, 237, 119, 102470, 32990, 31643]

O: 🧘🏻‍♀️ [9468, 100, 246, 9468, 237, 119, 102470, 32990, 31643]
N: 🧓🏻 [9468, 100, 241, 9468, 237, 119]

O: 🧎🏾‍♂️‍➡️ [9468, 100, 236, 9468, 237, 122, 102470, 17245, 224, 31643, 102470, 98115, 94, 31643]
N: 🚞 [9468, 248, 252]

O: 🧙🏻‍♀️ [9468, 100, 247, 9468, 237, 119, 102470, 32990, 31643]
N: 🤸🏽‍♂️ [9468, 97, 116, 9468, 237, 121, 102470, 17245, 224, 31643]

O: 🚞 [9468, 248, 252]
N: 🙇🏻‍♂ [9468, 247, 229, 9468, 237, 119, 102470, 17245, 224]

O: 🙇🏻‍♂ [9468, 247, 229, 9468, 237, 119, 102470, 17245, 224]
N: 🫕 [9468, 104, 243]

O: 🫕 [9468, 104, 243]
N: 👩🏾‍❤‍💋‍👨🏽 [9468, 239, 102, 9468, 237, 122, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 121]

O: 🤸🏽‍♂️ [9468, 97, 116, 9468, 237, 121, 102470, 17245, 224, 31643]
N: 🧘🏻‍♀️ [9468, 100, 246, 9468, 237, 119, 102470, 32990, 31643]

O: 🕵🏽 [9468, 243, 113, 9468, 237, 121]
N: 🕵🏽 [9468, 243, 113, 9468, 237, 121]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.93s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.84s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.41s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.13s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.69s/it]
Processing depth (0, 2, 3, 4, 8):   3%|▎         | 3/100 [01:19<34:58, 21.63s/it]2025-01-22 05:28:07.234 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra journeyed to the hallway.
2025-01-22 05:28:07.234 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (32, 38) -->  journeyed to the hallway.
2025-01-22 05:28:07.234 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra grabbed the football there.
2025-01-22 05:28:07.243 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1801, 1806) --> . Sandra grabbed the football
2025-01-22 05:28:07.243 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the garden.
2025-01-22 05:28:07.258 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2905, 2910) --> . Sandra moved to the
2025-01-22 05:28:07.258 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra dropped the football.
2025-01-22 05:28:07.275 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3640, 3644) -->  Sandra dropped the football
2025-01-22 05:28:07.275 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John travelled to the bedroom.
2025-01-22 05:28:07.287 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (2497, 2502) --> . John travelled to the
2025-01-22 05:28:07.287 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the kitchen.
2025-01-22 05:28:07.300 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2497, 2502) --> . John travelled to the
2025-01-22 05:28:07.300 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the office.
2025-01-22 05:28:07.329 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4241, 4246) -->  back to the office.
2025-01-22 05:28:07.329 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went to the kitchen.
2025-01-22 05:28:07.342 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2498, 2503) -->  John travelled to the kitchen
2025-01-22 05:28:07.342 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the office.
2025-01-22 05:28:07.363 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4239, 4245) -->  John went back to the office
2025-01-22 05:28:07.363 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary moved to the bedroom.
2025-01-22 05:28:07.403 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7011, 7016) --> . Mary moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:28:08.179 | INFO     | test_jbb_embedding:begin_test:693 - the garden<|eot_id|>
2025-01-22 05:28:08.179 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8216])
2025-01-22 05:28:10.433 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [835.66, 69.92859532789878, 197.72596153846155, 67.17810357492654, 33.5599990472561], 'topk_indices': array([2362, 1806, 3641, 2389, 2376, 2374, 1805, 3643, 2377, 2363,   36,
       2378, 2392, 2366, 2364, 2380,    0, 2393, 2379, 2365]), 'topk_tokens': [' from', ' there', ' dropped', ',\n', ' to', '\n', ' football', ' football', ' the', ' the', ' hallway', ' Min', ' Min', 'ot', ' Min', 'ot', '<|begin_of_text|>', 'nes', 'nes', 'nes'], 'evidence_proportions': [1150.25, 1058.6, 312.75, 1320.375, 370.35]}, 'weight': {'score': [23.1003125, 23.303243627570264, 21.31971153846154, 23.310178631549952, 29.97294207317073], 'topk_indices': array([3328, 3301, 3221, 3173, 7440, 7478, 1437, 1499, 4292, 4308, 5240,
       5179, 7217, 7161, 3510, 3484, 4936, 4961, 5013, 4984]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.276041666666668, 25.934375, 21.040625, 28.755859375, 19.990625]}, 'saliency': {'score': [5.54107421875, 0.40091472978008275, 1.1448575533353365, 0.38281403185688434, 0.2596150840201029], 'topk_indices': array([2266,   32, 1803, 1806, 1802, 2361, 8203, 8201, 3641, 3643, 1805,
       2366, 2380, 2378, 2392,   36, 2364, 2393, 2379, 2365]), 'topk_tokens': ['nes', ' journey', ' grabbed', ' there', ' Sandra', ' messenger', ' discarded', ' football', ' dropped', ' football', ' football', 'ot', 'ot', ' Min', ' Min', ' hallway', ' Min', 'nes', 'nes', 'nes'], 'evidence_proportions': [7.163411458333333, 7.802734375, 1.725, 9.57373046875, 1.92255859375]}}, 'pred_res': 'the garden<|eot_id|>', 'score': 0}
2025-01-22 05:28:10.454 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:28:10.455 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-61_pid-3_0-2-3-4-8.pkl | len: 3 |  size: 2.04 KB
Processing depth (0, 2, 3, 4, 8):   4%|▍         | 4/100 [01:22<33:27, 20.91s/it]is_0k: False
your chose emoji: ['👨🏾\u200d🌾', '🦇', '🍭', '🤽\u200d♂️', '🧎🏿\u200d♀\u200d➡️', '💁🏿\u200d♂️', '\U0001fae1', '🧑🏾\u200d❤\u200d🧑🏿', '🧏🏿\u200d♂️', '🕵🏻\u200d♂️']
emoji:
O: 👨🏾‍🌾 [9468, 239, 101, 9468, 237, 122, 102470, 9468, 234, 122]
N: �� [229, 9468, 99]

O: 🦇 [9468, 99, 229]
N: ️🧎🏿‍♀‍➡ [31643, 9468, 100, 236, 9468, 237, 123, 102470, 32990, 102470, 98115, 94]

O: 🍭 [9468, 235, 255]
N: ️🧏🏿‍♂ [31643, 9468, 100, 237, 9468, 237, 123, 102470, 17245, 224]

O: 🤽‍♂️ [9468, 97, 121, 102470, 17245, 224, 31643]
N: �� [94, 9468, 104]

O: 🧎🏿‍♀‍➡️ [9468, 100, 236, 9468, 237, 123, 102470, 32990, 102470, 98115, 94, 31643]
N: �👨🏾‍� [122, 9468, 239, 101, 9468, 237, 122, 102470, 9468, 234]

O: 💁🏿‍♂️ [93273, 223, 9468, 237, 123, 102470, 17245, 224, 31643]
N: �🧑🏾‍❤‍🧑� [123, 9468, 100, 239, 9468, 237, 122, 102470, 121643, 102470, 9468, 100, 239, 9468, 237]

O: 🫡 [9468, 104, 94]
N: ️🤽‍♂ [31643, 9468, 97, 121, 102470, 17245, 224]

O: 🧑🏾‍❤‍🧑🏿 [9468, 100, 239, 9468, 237, 122, 102470, 121643, 102470, 9468, 100, 239, 9468, 237, 123]
N: ️💁🏿‍♂ [31643, 93273, 223, 9468, 237, 123, 102470, 17245, 224]

O: 🧏🏿‍♂️ [9468, 100, 237, 9468, 237, 123, 102470, 17245, 224, 31643]
N: �� [255, 9468, 235]

O: 🕵🏻‍♂️ [9468, 243, 113, 9468, 237, 119, 102470, 17245, 224, 31643]
N: ️🕵🏻‍♂ [31643, 9468, 243, 113, 9468, 237, 119, 102470, 17245, 224]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.44s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.46s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.37s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.86s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.43s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 2, 3, 5, 8):   4%|▍         | 4/100 [01:38<33:27, 20.91s/it]2025-01-22 05:28:25.889 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra journeyed to the hallway.
2025-01-22 05:28:25.889 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (32, 38) -->  journeyed to the hallway.
2025-01-22 05:28:25.890 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra grabbed the football there.
2025-01-22 05:28:25.899 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1817, 1822) --> . Sandra grabbed the football
2025-01-22 05:28:25.899 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the garden.
2025-01-22 05:28:25.913 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2957, 2962) --> . Sandra moved to the
2025-01-22 05:28:25.913 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra dropped the football.
2025-01-22 05:28:25.934 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4178, 4182) -->  Sandra dropped the football
2025-01-22 05:28:25.934 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John travelled to the bedroom.
2025-01-22 05:28:25.946 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (2513, 2518) --> . John travelled to the
2025-01-22 05:28:25.946 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the kitchen.
2025-01-22 05:28:25.958 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2513, 2518) --> . John travelled to the
2025-01-22 05:28:25.958 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the office.
2025-01-22 05:28:25.979 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4185, 4190) -->  back to the office.
2025-01-22 05:28:25.979 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went to the kitchen.
2025-01-22 05:28:25.991 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2514, 2519) -->  John travelled to the kitchen
2025-01-22 05:28:25.991 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the office.
2025-01-22 05:28:26.014 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4181, 4187) -->  football. John went back to
2025-01-22 05:28:26.014 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary moved to the bedroom.
2025-01-22 05:28:26.056 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6993, 6998) --> . Mary moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:28:29.175 | INFO     | test_jbb_embedding:begin_test:693 - the hallway<|eot_id|>
2025-01-22 05:28:29.175 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8216])
2025-01-22 05:28:32.140 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [746.19, 64.22122520987955, 339.24399038461536, 61.25846672992164, 31.525342987804876], 'topk_indices': array([7574, 1818,   41, 8201, 1822,   32,   24, 8196, 8211, 1821, 7530,
       4181, 7305,   36, 7383, 7575, 7576, 7531, 8212,    0]), 'topk_tokens': [' the', ' Sandra', '\n\n\n', ' football', ' there', ' journey', '\n\n', ' to', '<|eot_id|>', ' football', ' Min', ' football', 'nes', ' hallway', 'nes', ' Min', 'nes', 'nes', '<|start_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [1055.3333333333333, 913.3, 421.7, 920.0, 393.55]}, 'weight': {'score': [23.1003125, 23.298489019345418, 21.40985576923077, 23.305107393180705, 29.734756097560975], 'topk_indices': array([3297, 3324, 3169, 3217, 7468, 7430, 1515, 1453, 4326, 4342, 5204,
       5143, 7151, 7207, 3506, 3480, 4914, 4939, 4962, 4991]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.276041666666668, 25.934375, 21.040625, 28.755859375, 19.990625]}, 'saliency': {'score': [4.8122265625, 0.3657895506030235, 1.9835486778846154, 0.3470306545933827, 0.23862289800876524], 'topk_indices': array([  41,   59,   31,   43, 2135, 8195, 8201,   32, 8189, 8203, 1818,
       7530, 7305, 1821, 4181, 7383,   36, 7575, 7576, 7531]), 'topk_tokens': ['\n\n\n', ' Proof', 'andra', '-text', ' du', ' prior', ' football', ' journey', 'Question', ' discarded', ' Sandra', ' Min', 'nes', ' football', ' football', 'nes', ' hallway', ' Min', 'nes', 'nes'], 'evidence_proportions': [6.3583984375, 6.791015625, 2.2248046875, 6.6318359375, 2.109765625]}}, 'pred_res': 'the hallway<|eot_id|>', 'score': 100}
2025-01-22 05:28:32.146 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:28:32.146 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-61_pid-4_0-2-3-5-8.pkl | len: 3 |  size: 2.07 KB
Processing depth (0, 2, 3, 5, 8):   5%|▌         | 5/100 [01:44<33:33, 21.19s/it]Processing depth (0, 2, 3, 5, 8):   5%|▌         | 5/100 [01:44<33:10, 20.95s/it]
2025-01-22 05:28:32.303 | INFO     | __main__:<module>:82 - Selected idx: 62
2025-01-22 05:28:32.303 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the football before the garden? 
2025-01-22 05:28:32.303 | INFO     | __main__:<module>:84 - Answer: hallway
2025-01-22 05:28:32.303 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 05:28:32.303 | INFO     | __main__:<module>:86 - Needle: [' John went back to the office.', ' Daniel went to the office.', ' Mary grabbed the football there.', ' Sandra journeyed to the hallway.', ' John travelled to the kitchen.', ' Mary moved to the bedroom.', ' Sandra moved to the garden.', ' Mary grabbed the football.', ' Mary discarded the football.', ' Sandra put down the football there.', ' Mary left the football.']
2025-01-22 05:28:32.303 | INFO     | __main__:<module>:87 - Real Needle: [' Sandra journeyed to the hallway.', ' Sandra moved to the garden.', ' Sandra put down the football there.', ' Mary left the football.']
2025-01-22 05:28:32.303 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['👩\u200d⚕', '🚶🏼\u200d♂\u200d➡️', '👨🏿\u200d❤️\u200d👨🏼', '🦸🏽\u200d♂', '🛢️', '👰🏽\u200d♂', '↪️', '👊🏼', '👌🏻', '💇🏿\u200d♂️']
emoji:
O: 👩‍⚕ [9468, 239, 102, 102470, 158, 248, 243]
N: �👨🏿‍❤️‍👨� [120, 9468, 239, 101, 9468, 237, 123, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237]

O: 🚶🏼‍♂‍➡️ [9468, 248, 114, 9468, 237, 120, 102470, 17245, 224, 102470, 98115, 94, 31643]
N: �👩‍� [243, 9468, 239, 102, 102470, 158, 248]

O: 👨🏿‍❤️‍👨🏼 [9468, 239, 101, 9468, 237, 123, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 120]
N: ️🛢 [31643, 9468, 249, 95]

O: 🦸🏽‍♂ [9468, 99, 116, 9468, 237, 121, 102470, 17245, 224]
N: �👌� [119, 9468, 239, 234, 9468, 237]

O: 🛢️ [9468, 249, 95, 31643]
N: �🦸🏽‍� [224, 9468, 99, 116, 9468, 237, 121, 102470, 17245]

O: 👰🏽‍♂ [9468, 239, 108, 9468, 237, 121, 102470, 17245, 224]
N: �👊� [120, 9468, 239, 232, 9468, 237]

O: ↪️ [27017, 103, 31643]
N: ️↪ [31643, 27017, 103]

O: 👊🏼 [9468, 239, 232, 9468, 237, 120]
N: ️🚶🏼‍♂‍➡ [31643, 9468, 248, 114, 9468, 237, 120, 102470, 17245, 224, 102470, 98115, 94]

O: 👌🏻 [9468, 239, 234, 9468, 237, 119]
N: �👰🏽‍� [224, 9468, 239, 108, 9468, 237, 121, 102470, 17245]

O: 💇🏿‍♂️ [93273, 229, 9468, 237, 123, 102470, 17245, 224, 31643]
N: ️💇🏿‍♂ [31643, 93273, 229, 9468, 237, 123, 102470, 17245, 224]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.01s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.42s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.55s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.23s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.66s/it]
Processing depth (0, 1, 2, 9):   0%|          | 0/100 [00:16<?, ?it/s]2025-01-22 05:28:48.786 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra journeyed to the hallway.
2025-01-22 05:28:48.786 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (32, 38) -->  journeyed to the hallway.
2025-01-22 05:28:48.786 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the garden.
2025-01-22 05:28:48.791 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (831, 836) --> . Sandra moved to the
2025-01-22 05:28:48.791 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra put down the football there.
2025-01-22 05:28:48.808 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1765, 1771) --> . Sandra put down the football
2025-01-22 05:28:48.808 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary left the football.
2025-01-22 05:28:48.855 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7135, 7139) -->  left the football.
2025-01-22 05:28:48.855 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the office.
2025-01-22 05:28:48.865 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1906, 1912) --> . John went back to the
2025-01-22 05:28:48.865 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the office.
2025-01-22 05:28:48.866 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (113, 118) --> . Daniel went to the
2025-01-22 05:28:48.866 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary grabbed the football there.
2025-01-22 05:28:48.883 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3545, 3550) --> . Mary grabbed the football
2025-01-22 05:28:48.883 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John travelled to the kitchen.
2025-01-22 05:28:48.925 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6732, 6737) --> . John travelled to the
2025-01-22 05:28:48.925 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary moved to the bedroom.
2025-01-22 05:28:48.951 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (2919, 2924) --> . Mary moved to the
2025-01-22 05:28:48.952 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary grabbed the football.
2025-01-22 05:28:48.981 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (3546, 3550) -->  Mary grabbed the football
2025-01-22 05:28:48.981 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Mary discarded the football.
2025-01-22 05:28:49.001 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (4102, 4106) -->  Mary discarded the football
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:28:49.828 | INFO     | test_jbb_embedding:begin_test:693 - The hallway.<|eot_id|>
2025-01-22 05:28:49.828 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8186])
2025-01-22 05:28:52.048 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [186.5922619047619, 14.807806203443644, 89.39246323529412, 14.052537957954266, 12.155443274456522], 'topk_indices': array([ 837,   23, 8169, 8175,   28,   36,   25,    1,   14, 8170, 8171,
       8173,   24, 8177, 8176, 8184, 8181, 8174,    0, 8182]), 'topk_tokens': ['.', '4', ':', ' the', '<|end_header_id|>', ' hallway', '<|eot_id|>', '<|start_header_id|>', '\n', ' Where', ' was', ' football', '\n\n', '?', ' garden', '<|end_header_id|>', '<|eot_id|>', ' before', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [268.8333333333333, 204.75, 152.15625, 92.1875]}, 'weight': {'score': [22.148809523809526, 23.279757906948344, 22.624080882352942, 23.285418459552496, 29.573822463768117], 'topk_indices': array([3354, 3327, 3247, 3199, 7461, 7423, 1463, 1525, 4329, 4345, 5146,
       5207, 7144, 7200, 3536, 3510, 4923, 5000, 4948, 4971]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.276041666666668, 21.040625, 24.924479166666668, 20.6796875]}, 'saliency': {'score': [1.1163330078125, 0.08163129792776515, 0.5431626263786765, 0.07703075685634758, 0.09075009995612546], 'topk_indices': array([  23,   40, 3549, 7376,    8, 8178,   31,  832,   32, 1770,  836,
         24, 8171, 8168, 8177, 8170, 8173,   36, 8176, 8174]), 'topk_tokens': ['4', '***', ' football', 'nes', ' Date', ' \n', 'andra', ' Sandra', ' journey', ' football', ' garden', '\n\n', ' was', 'Question', '?', ' Where', ' football', ' hallway', ' garden', ' before'], 'evidence_proportions': [1.6730143229166667, 1.122900390625, 1.0007527669270833, 0.44647216796875]}}, 'pred_res': 'The hallway.<|eot_id|>', 'score': 100}
2025-01-22 05:28:52.056 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:28:52.057 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-62_pid-0_0-1-2-9.pkl | len: 3 |  size: 2.03 KB
Processing depth (0, 1, 2, 9):   1%|          | 1/100 [00:19<32:23, 19.63s/it]is_0k: False
your chose emoji: ['✏', '🎙️', '🏽', '👩🏾\u200d❤\u200d💋\u200d👩🏾', '🇪🇦', '🤽🏽\u200d♀️', '🏑', '⚜️', '🧑🏻\u200d✈', '👨🏼\u200d⚕️']
emoji:
O: ✏ [38798, 237]
N: ️⚜ [31643, 158, 248, 250]

O: 🎙️ [9468, 236, 247, 31643]
N: ️🤽🏽‍♀ [31643, 9468, 97, 121, 9468, 237, 121, 102470, 32990]

O: 🏽 [9468, 237, 121]
N: �🧑🏻‍� [230, 9468, 100, 239, 9468, 237, 119, 102470, 38798]

O: 👩🏾‍❤‍💋‍👩🏾 [9468, 239, 102, 9468, 237, 122, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 122]
N: �� [121, 9468, 237]

O: 🇪🇦 [9468, 229, 103, 9468, 229, 99]
N: �🇪� [99, 9468, 229, 103, 9468, 229]

O: 🤽🏽‍♀️ [9468, 97, 121, 9468, 237, 121, 102470, 32990, 31643]
N: �� [237, 38798]

O: 🏑 [9468, 237, 239]
N: ️🎙 [31643, 9468, 236, 247]

O: ⚜️ [158, 248, 250, 31643]
N: �� [239, 9468, 237]

O: 🧑🏻‍✈ [9468, 100, 239, 9468, 237, 119, 102470, 38798, 230]
N: �👩🏾‍❤‍💋‍👩� [122, 9468, 239, 102, 9468, 237, 122, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237]

O: 👨🏼‍⚕️ [9468, 239, 101, 9468, 237, 120, 102470, 158, 248, 243, 31643]
N: ️👨🏼‍⚕ [31643, 9468, 239, 101, 9468, 237, 120, 102470, 158, 248, 243]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.19s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.15s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.03s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.85s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.31s/it]
Processing depth (4, 5, 7, 8):   1%|          | 1/100 [00:34<32:23, 19.63s/it]2025-01-22 05:29:07.131 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra journeyed to the hallway.
2025-01-22 05:29:07.151 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3625, 3631) -->  Hon. Sandra journeyed to
2025-01-22 05:29:07.151 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the garden.
2025-01-22 05:29:07.172 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4243, 4248) -->  Sandra moved to the garden
2025-01-22 05:29:07.172 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra put down the football there.
2025-01-22 05:29:07.204 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5650, 5656) --> . Sandra put down the football
2025-01-22 05:29:07.204 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary left the football.
2025-01-22 05:29:07.240 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6650, 6654) -->  Mary left the football
2025-01-22 05:29:07.240 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the office.
2025-01-22 05:29:07.250 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2107, 2113) --> . John went back to the
2025-01-22 05:29:07.250 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the office.
2025-01-22 05:29:07.251 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (105, 110) --> . Daniel went to the
2025-01-22 05:29:07.251 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary grabbed the football there.
2025-01-22 05:29:07.271 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3598, 3603) --> . Mary grabbed the football
2025-01-22 05:29:07.271 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John travelled to the kitchen.
2025-01-22 05:29:07.307 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6934, 6939) --> . John travelled to the
2025-01-22 05:29:07.307 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary moved to the bedroom.
2025-01-22 05:29:07.322 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (2979, 2984) -->  tragedy. Mary moved to
2025-01-22 05:29:07.322 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary grabbed the football.
2025-01-22 05:29:07.341 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (3599, 3603) -->  Mary grabbed the football
2025-01-22 05:29:07.341 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Mary discarded the football.
2025-01-22 05:29:07.365 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (4144, 4148) -->  Mary discarded the football
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:29:08.327 | INFO     | test_jbb_embedding:begin_test:693 - Mary grabbed the football there.<|eot_id|>
2025-01-22 05:29:08.327 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8219])
2025-01-22 05:29:10.585 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [364.61607142857144, 26.150115543663343, 267.10753676470586, 24.276681308926165, 20.612281976744185], 'topk_indices': array([3082, 8202, 8209, 4244, 8117, 4245, 8107, 8206, 8207, 3627,   24,
       3628,   14, 3629, 3602, 3603, 3632, 8214, 8217,    0]), 'topk_tokens': ['ern', ':', ' garden', ' moved', ' location', ' to', '.\n\n', ' football', ' before', ' Sandra', '\n\n', ' journey', '\n', 'ed', ' football', ' there', ' hallway', '<|eot_id|>', '<|end_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [534.6041666666666, 466.15, 156.34375, 295.125]}, 'weight': {'score': [25.452008928571427, 23.30038121807346, 23.47817095588235, 23.294108531284436, 29.274709302325583], 'topk_indices': array([3289, 3262, 3134, 3182, 7460, 7498, 1405, 1467, 4347, 4331, 5182,
       5243, 7181, 7237, 3491, 3465, 5036, 4984, 4959, 5007]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [25.220052083333332, 25.5546875, 24.924479166666668, 26.462890625]}, 'saliency': {'score': [2.305268787202381, 0.14786594310139717, 1.7162978228400736, 0.1357890306932625, 0.15217803245367006], 'topk_indices': array([  24, 4243, 3082, 8203, 4247, 8201, 3629, 2982, 8117, 4244, 8209,
       3600, 8207, 2985, 8206, 3628, 3603, 3627, 3602, 3632]), 'topk_tokens': ['\n\n', ' Sandra', 'ern', ' Where', ' garden', 'Question', 'ed', ' moved', ' location', ' moved', ' garden', ' grabbed', ' before', ' bedroom', ' football', ' journey', ' there', ' Sandra', ' football', ' hallway'], 'evidence_proportions': [3.37060546875, 2.855859375, 0.998046875, 1.9798583984375]}}, 'pred_res': 'Mary grabbed the football there.<|eot_id|>', 'score': 0}
2025-01-22 05:29:10.602 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:29:10.603 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-62_pid-1_4-5-7-8.pkl | len: 3 |  size: 2.05 KB
Processing depth (4, 5, 7, 8):   2%|▏         | 2/100 [00:38<31:01, 18.99s/it]is_0k: False
your chose emoji: ['👨🏻\u200d🦰', '🧑🏻\u200d🤝\u200d🧑🏽', '🧑🏼\u200d🦲', '🦸🏼', '👨🏾\u200d🚀', '👞', '👮\u200d♀️', '🙂\u200d↔️', '🧑🏼\u200d💼', '👩🏼\u200d🍼']
emoji:
O: 👨🏻‍🦰 [9468, 239, 101, 9468, 237, 119, 102470, 9468, 99, 108]
N: 👞 [9468, 239, 252]

O: 🧑🏻‍🤝‍🧑🏽 [9468, 100, 239, 9468, 237, 119, 102470, 9468, 97, 251, 102470, 9468, 100, 239, 9468, 237, 121]
N: 👮‍♀️ [9468, 239, 106, 102470, 32990, 31643]

O: 🧑🏼‍🦲 [9468, 100, 239, 9468, 237, 120, 102470, 9468, 99, 110]
N: 🧑🏼‍🦲 [9468, 100, 239, 9468, 237, 120, 102470, 9468, 99, 110]

O: 🦸🏼 [9468, 99, 116, 9468, 237, 120]
N: 🧑🏻‍🤝‍🧑🏽 [9468, 100, 239, 9468, 237, 119, 102470, 9468, 97, 251, 102470, 9468, 100, 239, 9468, 237, 121]

O: 👨🏾‍🚀 [9468, 239, 101, 9468, 237, 122, 102470, 9468, 248, 222]
N: 🦸🏼 [9468, 99, 116, 9468, 237, 120]

O: 👞 [9468, 239, 252]
N: 👨🏻‍🦰 [9468, 239, 101, 9468, 237, 119, 102470, 9468, 99, 108]

O: 👮‍♀️ [9468, 239, 106, 102470, 32990, 31643]
N: 👨🏾‍🚀 [9468, 239, 101, 9468, 237, 122, 102470, 9468, 248, 222]

O: 🙂‍↔️ [9468, 19044, 102470, 27017, 242, 31643]
N: 🙂‍↔️ [9468, 19044, 102470, 27017, 242, 31643]

O: 🧑🏼‍💼 [9468, 100, 239, 9468, 237, 120, 102470, 93273, 120]
N: 🧑🏼‍💼 [9468, 100, 239, 9468, 237, 120, 102470, 93273, 120]

O: 👩🏼‍🍼 [9468, 239, 102, 9468, 237, 120, 102470, 9468, 104247]
N: 👩🏼‍🍼 [9468, 239, 102, 9468, 237, 120, 102470, 9468, 104247]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.77s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:10<00:10,  5.10s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.40s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  2.86s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.54s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (1, 2, 3, 8):   2%|▏         | 2/100 [00:54<31:01, 18.99s/it]2025-01-22 05:29:26.568 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra journeyed to the hallway.
2025-01-22 05:29:26.573 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (793, 799) --> . Sandra journeyed to the
2025-01-22 05:29:26.573 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the garden.
2025-01-22 05:29:26.582 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1812, 1817) --> . Sandra moved to the
2025-01-22 05:29:26.582 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra put down the football there.
2025-01-22 05:29:26.599 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2909, 2915) --> . Sandra put down the football
2025-01-22 05:29:26.599 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary left the football.
2025-01-22 05:29:26.634 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6556, 6560) -->  Mary left the football
2025-01-22 05:29:26.634 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the office.
2025-01-22 05:29:26.644 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2053, 2059) -->  cable. John went back to
2025-01-22 05:29:26.645 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the office.
2025-01-22 05:29:26.645 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (105, 110) --> . Daniel went to the
2025-01-22 05:29:26.645 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary grabbed the football there.
2025-01-22 05:29:26.663 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3588, 3593) --> . Mary grabbed the football
2025-01-22 05:29:26.663 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John travelled to the kitchen.
2025-01-22 05:29:26.697 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6838, 6843) --> . John travelled to the
2025-01-22 05:29:26.697 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary moved to the bedroom.
2025-01-22 05:29:26.712 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (2972, 2977) --> . Mary moved to the
2025-01-22 05:29:26.712 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary grabbed the football.
2025-01-22 05:29:26.729 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (3589, 3593) -->  Mary grabbed the football
2025-01-22 05:29:26.729 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Mary discarded the football.
2025-01-22 05:29:26.749 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (4107, 4111) -->  Mary discarded the football
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:29:29.981 | INFO     | test_jbb_embedding:begin_test:693 - The bedroom.<|eot_id|>
2025-01-22 05:29:29.981 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8229])
2025-01-22 05:29:32.897 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [429.0208333333333, 31.881195335276967, 253.82628676470588, 29.93842102849456, 19.594844608516482], 'topk_indices': array([  24,  796,  795,   14,  794,    1, 8217,    3, 2915, 8219, 2973,
       8216, 8225, 8227,  110, 1631, 2914, 8224,  799,    0]), 'topk_tokens': ['\n\n', 'ed', ' journey', '\n', ' Sandra', '<|start_header_id|>', ' before', '<|end_header_id|>', ' there', ' garden', ' Mary', ' football', '<|start_header_id|>', '<|end_header_id|>', ' office', ' time', ' football', '<|eot_id|>', ' hallway', '<|begin_of_text|>'], 'evidence_proportions': [606.625, 363.15, 491.75, 150.859375]}, 'weight': {'score': [23.23251488095238, 23.318780748906704, 23.27504595588235, 23.31918414455179, 29.77867445054945], 'topk_indices': array([3351, 3324, 3196, 3244, 7472, 7434, 1448, 1510, 4362, 4378, 5254,
       5193, 7211, 7155, 3533, 3507, 5047, 4950, 4975, 5018]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.213541666666668, 21.040625, 24.924479166666668, 26.462890625]}, 'saliency': {'score': [2.5703008742559526, 0.18057590555055728, 1.5342514935661764, 0.16881007525395164, 0.1463723654275412], 'topk_indices': array([1709, 2912, 1817, 1813, 8222, 3592, 1631, 2915, 8217, 8211,  106,
        795, 2977,  110, 8219, 2973, 8216,  794, 2914,  799]), 'topk_tokens': [' some', ' down', ' garden', ' Sandra', 'Answer', ' football', ' time', ' there', ' before', 'Question', ' Daniel', ' journey', ' bedroom', ' office', ' garden', ' Mary', ' football', ' Sandra', ' football', ' hallway'], 'evidence_proportions': [3.4235026041666665, 2.10029296875, 3.142578125, 1.01959228515625]}}, 'pred_res': 'The bedroom.<|eot_id|>', 'score': 0}
2025-01-22 05:29:32.916 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:29:32.917 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-62_pid-2_1-2-3-8.pkl | len: 3 |  size: 2.08 KB
Processing depth (1, 2, 3, 8):   3%|▎         | 3/100 [01:00<33:09, 20.51s/it]is_0k: False
your chose emoji: ['🤾🏾\u200d♀️', '👩🏻\u200d⚖️', '🇦🇸', '〽️', '🕺🏾', '🧎🏻\u200d➡️', '🖕🏿', '🧎🏼\u200d♀️\u200d➡', '🧚🏼\u200d♂️', '🧑🏽\u200d❤\u200d💋\u200d🧑🏿']
emoji:
O: 🤾🏾‍♀️ [9468, 97, 122, 9468, 237, 122, 102470, 32990, 31643]
N: 🧎🏼‍♀️‍➡ [9468, 100, 236, 9468, 237, 120, 102470, 32990, 31643, 102470, 98115, 94]

O: 👩🏻‍⚖️ [9468, 239, 102, 9468, 237, 119, 102470, 158, 248, 244, 31643]
N: 🖕🏿 [9468, 244, 243, 9468, 237, 123]

O: 🇦🇸 [9468, 229, 99, 9468, 229, 116]
N: 🕺🏾 [9468, 243, 118, 9468, 237, 122]

O: 〽️ [1300, 121, 31643]
N: 🇦🇸 [9468, 229, 99, 9468, 229, 116]

O: 🕺🏾 [9468, 243, 118, 9468, 237, 122]
N: 👩🏻‍⚖️ [9468, 239, 102, 9468, 237, 119, 102470, 158, 248, 244, 31643]

O: 🧎🏻‍➡️ [9468, 100, 236, 9468, 237, 119, 102470, 98115, 94, 31643]
N: 🧚🏼‍♂️ [9468, 100, 248, 9468, 237, 120, 102470, 17245, 224, 31643]

O: 🖕🏿 [9468, 244, 243, 9468, 237, 123]
N: 〽️ [1300, 121, 31643]

O: 🧎🏼‍♀️‍➡ [9468, 100, 236, 9468, 237, 120, 102470, 32990, 31643, 102470, 98115, 94]
N: 🧎🏻‍➡️ [9468, 100, 236, 9468, 237, 119, 102470, 98115, 94, 31643]

O: 🧚🏼‍♂️ [9468, 100, 248, 9468, 237, 120, 102470, 17245, 224, 31643]
N: 🤾🏾‍♀️ [9468, 97, 122, 9468, 237, 122, 102470, 32990, 31643]

O: 🧑🏽‍❤‍💋‍🧑🏿 [9468, 100, 239, 9468, 237, 121, 102470, 121643, 102470, 93273, 233, 102470, 9468, 100, 239, 9468, 237, 123]
N: 🧑🏽‍❤‍💋‍🧑🏿 [9468, 100, 239, 9468, 237, 121, 102470, 121643, 102470, 93273, 233, 102470, 9468, 100, 239, 9468, 237, 123]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.65s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:11<00:11,  5.77s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:16<00:05,  5.64s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:17<00:00,  3.88s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:17<00:00,  4.47s/it]
Processing depth (5, 6, 8, 9):   3%|▎         | 3/100 [01:20<33:09, 20.51s/it]2025-01-22 05:29:52.573 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra journeyed to the hallway.
2025-01-22 05:29:52.597 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4177, 4183) --> . Sandra journeyed to the
2025-01-22 05:29:52.597 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the garden.
2025-01-22 05:29:52.621 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4659, 4664) -->  Sandra moved to the garden
2025-01-22 05:29:52.621 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra put down the football there.
2025-01-22 05:29:52.659 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6564, 6570) --> . Sandra put down the football
2025-01-22 05:29:52.659 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary left the football.
2025-01-22 05:29:52.697 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7273, 7277) -->  Mary left the football
2025-01-22 05:29:52.697 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the office.
2025-01-22 05:29:52.707 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1911, 1917) --> . John went back to the
2025-01-22 05:29:52.708 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the office.
2025-01-22 05:29:52.708 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (105, 110) --> . Daniel went to the
2025-01-22 05:29:52.708 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary grabbed the football there.
2025-01-22 05:29:52.734 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3584, 3589) --> . Mary grabbed the football
2025-01-22 05:29:52.735 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John travelled to the kitchen.
2025-01-22 05:29:52.772 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6849, 6854) --> . John travelled to the
2025-01-22 05:29:52.773 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary moved to the bedroom.
2025-01-22 05:29:52.787 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (2924, 2929) --> . Mary moved to the
2025-01-22 05:29:52.787 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary grabbed the football.
2025-01-22 05:29:52.809 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (3585, 3589) -->  Mary grabbed the football
2025-01-22 05:29:52.810 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Mary discarded the football.
2025-01-22 05:29:52.830 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (4093, 4097) -->  Mary discarded the football
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:29:53.638 | INFO     | test_jbb_embedding:begin_test:693 - The hallway.<|eot_id|>
2025-01-22 05:29:53.638 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8207])
2025-01-22 05:29:55.913 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [174.3154761904762, 18.560969853836784, 120.71783088235294, 17.733970723482525, 12.0674560546875], 'topk_indices': array([8189, 8197, 8056,    8, 8191, 8190,    1,    4, 8194,   23,    9,
       8095, 4183, 8195,   24,   14, 8202, 8205, 8203,    0]), 'topk_tokens': ['Question', ' garden', '\n', ' Date', ' Where', ':', '<|start_header_id|>', '\n\n', ' football', '4', ':', '.\n\n', ' hallway', ' before', '\n\n', '\n', '<|eot_id|>', '<|end_header_id|>', '<|start_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [269.0, 190.575, 131.52083333333334, 76.15625]}, 'weight': {'score': [24.307291666666668, 23.30607681181486, 22.624080882352942, 23.30634196811772, 30.0150390625], 'topk_indices': array([3347, 3320, 3240, 3192, 7488, 7450, 1439, 1501, 4401, 4385, 5263,
       5202, 7222, 7166, 3529, 3503, 5056, 4979, 5004, 5027]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.213541666666668, 25.5546875, 24.924479166666668, 26.462890625]}, 'saliency': {'score': [1.090605236235119, 0.10218793564679127, 0.7454367244944853, 0.09696080846920985, 0.08992042541503906], 'topk_indices': array([  16, 8179, 8199,   14,   20, 8105,   23, 4179, 8176, 3588, 8095,
          8, 8191, 8197, 4178,   24, 8189, 8194, 8195, 4183]), 'topk_tokens': [' Date', ' directly', ' \n', '\n', ' Jul', ' location', '4', ' journey', ' return', ' football', '.\n\n', ' Date', ' Where', ' garden', ' Sandra', '\n\n', 'Question', ' football', ' before', ' hallway'], 'evidence_proportions': [1.5734456380208333, 1.252587890625, 0.8631998697916666, 0.504974365234375]}}, 'pred_res': 'The hallway.<|eot_id|>', 'score': 100}
2025-01-22 05:29:55.922 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:29:55.922 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-62_pid-3_5-6-8-9.pkl | len: 3 |  size: 2.02 KB
Processing depth (5, 6, 8, 9):   4%|▍         | 4/100 [01:23<34:23, 21.49s/it]is_0k: False
your chose emoji: ['😦', '👩🏽\u200d✈️', '🛺', '🚣🏿\u200d♀️', '🤵🏾\u200d♀️', '👨🏼\u200d❤\u200d💋\u200d👨🏻', '🧖🏽\u200d♀️', '🇳🇷', '💂🏿\u200d♀️', '🧚🏼']
emoji:
O: 😦 [76460, 99]
N: 💂🏿‍♀️ [93273, 224, 9468, 237, 123, 102470, 32990, 31643]

O: 👩🏽‍✈️ [9468, 239, 102, 9468, 237, 121, 102470, 38798, 230, 31643]
N: 🧖🏽‍♀️ [9468, 100, 244, 9468, 237, 121, 102470, 32990, 31643]

O: 🛺 [9468, 249, 118]
N: 👨🏼‍❤‍💋‍👨🏻 [9468, 239, 101, 9468, 237, 120, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 119]

O: 🚣🏿‍♀️ [9468, 248, 96, 9468, 237, 123, 102470, 32990, 31643]
N: 🛺 [9468, 249, 118]

O: 🤵🏾‍♀️ [9468, 97, 113, 9468, 237, 122, 102470, 32990, 31643]
N: 👩🏽‍✈️ [9468, 239, 102, 9468, 237, 121, 102470, 38798, 230, 31643]

O: 👨🏼‍❤‍💋‍👨🏻 [9468, 239, 101, 9468, 237, 120, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 119]
N: 🇳🇷 [9468, 229, 111, 9468, 229, 115]

O: 🧖🏽‍♀️ [9468, 100, 244, 9468, 237, 121, 102470, 32990, 31643]
N: 🚣🏿‍♀️ [9468, 248, 96, 9468, 237, 123, 102470, 32990, 31643]

O: 🇳🇷 [9468, 229, 111, 9468, 229, 115]
N: 🤵🏾‍♀️ [9468, 97, 113, 9468, 237, 122, 102470, 32990, 31643]

O: 💂🏿‍♀️ [93273, 224, 9468, 237, 123, 102470, 32990, 31643]
N: 😦 [76460, 99]

O: 🧚🏼 [9468, 100, 248, 9468, 237, 120]
N: 🧚🏼 [9468, 100, 248, 9468, 237, 120]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.02s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.20s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.07s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  2.75s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  3.25s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (1, 4, 7, 8):   4%|▍         | 4/100 [01:38<34:23, 21.49s/it]2025-01-22 05:30:10.757 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra journeyed to the hallway.
2025-01-22 05:30:10.762 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (833, 839) --> . Sandra journeyed to the
2025-01-22 05:30:10.762 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the garden.
2025-01-22 05:30:10.784 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3587, 3592) --> . Sandra moved to the
2025-01-22 05:30:10.784 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra put down the football there.
2025-01-22 05:30:10.812 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5618, 5624) --> . Sandra put down the football
2025-01-22 05:30:10.813 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary left the football.
2025-01-22 05:30:10.844 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6527, 6531) -->  left the football.
2025-01-22 05:30:10.844 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the office.
2025-01-22 05:30:10.856 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2041, 2047) -->  cable. John went back to
2025-01-22 05:30:10.856 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the office.
2025-01-22 05:30:10.857 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (105, 110) --> . Daniel went to the
2025-01-22 05:30:10.857 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary grabbed the football there.
2025-01-22 05:30:10.876 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3535, 3540) --> . Mary grabbed the football
2025-01-22 05:30:10.877 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John travelled to the kitchen.
2025-01-22 05:30:10.924 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6808, 6813) --> . John travelled to the
2025-01-22 05:30:10.925 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary moved to the bedroom.
2025-01-22 05:30:10.942 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (2947, 2952) --> . Mary moved to the
2025-01-22 05:30:10.943 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary grabbed the football.
2025-01-22 05:30:10.973 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (3536, 3540) -->  Mary grabbed the football
2025-01-22 05:30:10.974 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Mary discarded the football.
2025-01-22 05:30:11.001 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (4084, 4088) -->  Mary discarded the football
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:30:14.963 | INFO     | test_jbb_embedding:begin_test:693 - Mary's bedroom.<|eot_id|>
2025-01-22 05:30:14.963 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8169])
2025-01-22 05:30:17.924 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [299.8184523809524, 29.788267101076848, 325.39246323529414, 27.851446039177034, 22.27702356557377], 'topk_indices': array([  24, 2919, 8167, 2947, 3593, 8154, 8158, 8150, 3540, 8152, 3539,
       8151, 8156, 8159, 8165, 8164, 8160,  839, 8157,    0]), 'topk_tokens': ['\n\n', '.', '<|end_header_id|>', '.', '.', ' was', ' the', '.\n\n', ' there', ':', ' football', 'Question', ' football', ' garden', '<|start_header_id|>', '<|eot_id|>', '?', ' hallway', ' before', '<|begin_of_text|>'], 'evidence_proportions': [434.1666666666667, 318.6, 176.65625, 259.5625]}, 'weight': {'score': [22.13095238095238, 23.258716883871756, 23.27504595588235, 23.261566195946777, 28.932377049180328], 'topk_indices': array([3317, 3344, 3189, 3237, 7454, 7416, 1442, 1504, 4333, 4349, 5211,
       5150, 7137, 7193, 3500, 3526, 5004, 4927, 4975, 4952]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.213541666666668, 21.040625, 24.924479166666668, 20.6796875]}, 'saliency': {'score': [1.6454671223958333, 0.16691268943304882, 2.004717658547794, 0.15538934188566433, 0.16196679287269466], 'topk_indices': array([2920, 2946, 2952,  834, 8154, 8067, 8153, 8150,  835,  106, 3592,
       3537, 3540, 8160, 3539, 8151, 8159, 8156, 8157,  839]), 'topk_tokens': [' During', ' Gov', ' bedroom', ' Sandra', ' was', ' location', ' Where', '.\n\n', ' journey', ' Daniel', ' garden', ' grabbed', ' there', '?', ' football', 'Question', ' garden', ' football', ' before', ' hallway'], 'evidence_proportions': [2.4235026041666665, 1.5728515625, 1.1347859700520833, 1.335205078125]}}, 'pred_res': "Mary's bedroom.<|eot_id|>", 'score': 0}
2025-01-22 05:30:17.931 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:30:17.931 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-62_pid-4_1-4-7-8.pkl | len: 3 |  size: 2.03 KB
Processing depth (1, 4, 7, 8):   5%|▌         | 5/100 [01:45<34:19, 21.68s/it]Processing depth (1, 4, 7, 8):   5%|▌         | 5/100 [01:45<33:26, 21.12s/it]
2025-01-22 05:30:18.012 | INFO     | __main__:<module>:82 - Selected idx: 63
2025-01-22 05:30:18.012 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the location prior to the place where the milk was discarded, left or dropped?
2025-01-22 05:30:18.012 | INFO     | __main__:<module>:84 - Answer: hallway
2025-01-22 05:30:18.012 | INFO     | __main__:<module>:85 - Tag: 4-hop
2025-01-22 05:30:18.012 | INFO     | __main__:<module>:86 - Needle: [' John travelled to the kitchen.', ' Mary grabbed the football.', ' Sandra journeyed to the hallway.', ' Sandra took the milk.', ' Mary moved to the bedroom.', ' Mary grabbed the football there.', ' Sandra moved to the garden.', ' John went back to the office.', ' Daniel went to the office.', ' Mary discarded the football.', ' Sandra put down the milk there.', ' Mary left the football.']
2025-01-22 05:30:18.012 | INFO     | __main__:<module>:87 - Real Needle: [' Sandra journeyed to the hallway.', ' Sandra took the milk.', ' Sandra moved to the garden.', ' Sandra put down the milk there.', ' Mary left the football.']
2025-01-22 05:30:18.012 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['👼🏾', '👵', '🧝🏼', '👨🏿\u200d🚀', '🌟', '🚢', '🏃🏾\u200d♀\u200d➡️', '🆎', '👨🏿\u200d✈', '👋🏽']
emoji:
O: 👼🏾 [9468, 239, 120, 9468, 237, 122]
N: 👨🏿‍✈ [9468, 239, 101, 9468, 237, 123, 102470, 38798, 230]

O: 👵 [9468, 239, 113]
N: 🧝🏼 [9468, 100, 251, 9468, 237, 120]

O: 🧝🏼 [9468, 100, 251, 9468, 237, 120]
N: 👵 [9468, 239, 113]

O: 👨🏿‍🚀 [9468, 239, 101, 9468, 237, 123, 102470, 9468, 248, 222]
N: 🚢 [9468, 248, 95]

O: 🌟 [9468, 234, 253]
N: 🏃🏾‍♀‍➡️ [9468, 237, 225, 9468, 237, 122, 102470, 32990, 102470, 98115, 94, 31643]

O: 🚢 [9468, 248, 95]
N: 👨🏿‍🚀 [9468, 239, 101, 9468, 237, 123, 102470, 9468, 248, 222]

O: 🏃🏾‍♀‍➡️ [9468, 237, 225, 9468, 237, 122, 102470, 32990, 102470, 98115, 94, 31643]
N: 🆎 [9468, 228, 236]

O: 🆎 [9468, 228, 236]
N: 🌟 [9468, 234, 253]

O: 👨🏿‍✈ [9468, 239, 101, 9468, 237, 123, 102470, 38798, 230]
N: 👼🏾 [9468, 239, 120, 9468, 237, 122]

O: 👋🏽 [9468, 239, 233, 9468, 237, 121]
N: 👋🏽 [9468, 239, 233, 9468, 237, 121]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.94s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.69s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.52s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.10s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.67s/it]
Processing depth (1, 3, 4, 5, 6):   0%|          | 0/100 [00:16<?, ?it/s]2025-01-22 05:30:34.484 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra journeyed to the hallway.
2025-01-22 05:30:34.489 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (821, 827) --> . Sandra journeyed to the
2025-01-22 05:30:34.489 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra took the milk.
2025-01-22 05:30:34.502 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2848, 2852) -->  Sandra took the milk
2025-01-22 05:30:34.503 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the garden.
2025-01-22 05:30:34.520 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3620, 3625) --> . Sandra moved to the
2025-01-22 05:30:34.521 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra put down the milk there.
2025-01-22 05:30:34.541 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4156, 4162) --> . Sandra put down the milk
2025-01-22 05:30:34.541 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary left the football.
2025-01-22 05:30:34.564 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4740, 4744) -->  Mary left the football
2025-01-22 05:30:34.564 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the kitchen.
2025-01-22 05:30:34.599 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (7127, 7132) -->  John travelled to the kitchen
2025-01-22 05:30:34.599 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary grabbed the football.
2025-01-22 05:30:34.600 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (184, 188) -->  Mary grabbed the football
2025-01-22 05:30:34.600 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary moved to the bedroom.
2025-01-22 05:30:34.625 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4254, 4259) -->  Mary moved to the bedroom
2025-01-22 05:30:34.625 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary grabbed the football there.
2025-01-22 05:30:34.626 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (183, 188) --> . Mary grabbed the football
2025-01-22 05:30:34.626 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went back to the office.
2025-01-22 05:30:34.633 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1327, 1333) -->  John went back to the office
2025-01-22 05:30:34.633 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel went to the office.
2025-01-22 05:30:34.640 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (1329, 1334) -->  back to the office.
2025-01-22 05:30:34.640 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Mary discarded the football.
2025-01-22 05:30:34.674 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (6523, 6527) -->  discarded the football.
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:30:35.422 | INFO     | test_jbb_embedding:begin_test:693 - the garden<|eot_id|>
2025-01-22 05:30:35.422 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8179])
2025-01-22 05:30:37.644 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [274.1475, 26.136966053532145, 210.62867647058823, 24.601451895851287, 34.89072431144068], 'topk_indices': array([ 188, 8023, 8154,  187, 8153,  823, 8164,    1, 8068, 8158, 8058,
         24, 8159, 8166,   14, 8024,  827, 8174,    0, 8175]), 'topk_tokens': [' there', ' you', ' Where', ' football', ':', ' journey', ' milk', '<|start_header_id|>', ' location', ' prior', '.\n\n', '\n\n', ' to', ' discarded', '\n', ' context', ' hallway', '<|eot_id|>', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [402.75, 238.28125, 311.975, 247.35416666666666, 110.015625]}, 'weight': {'score': [23.92875, 23.267040072720608, 23.842371323529413, 23.262595408100456, 29.755031779661017], 'topk_indices': array([3331, 3304, 3224, 3176, 7417, 7455, 1535, 1473, 4326, 4342, 5148,
       5209, 7138, 7194, 3513, 3487, 5002, 4925, 4973, 4950]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.213541666666668, 27.912109375, 21.040625, 24.705729166666668, 26.462890625]}, 'saliency': {'score': [1.6303515625, 0.14625406463406715, 1.3417681525735294, 0.13668248806917857, 0.2608003777972722], 'topk_indices': array([  24,  188, 8162,  822,    0, 8058, 8152, 8172, 8154,  185, 3625,
       6523, 8068, 8164,  823,  187, 8158, 8024, 8166,  827]), 'topk_tokens': ['\n\n', ' there', ' where', ' Sandra', '<|begin_of_text|>', '.\n\n', 'Question', 'Answer', ' Where', ' grabbed', ' garden', ' discarded', ' location', ' milk', ' journey', ' football', ' prior', ' context', ' discarded', ' hallway'], 'evidence_proportions': [2.2215169270833335, 1.790771484375, 1.58740234375, 1.5460205078125, 0.76336669921875]}}, 'pred_res': 'the garden<|eot_id|>', 'score': 0}
2025-01-22 05:30:37.649 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:30:37.649 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-63_pid-0_1-3-4-5-6.pkl | len: 3 |  size: 2.12 KB
Processing depth (1, 3, 4, 5, 6):   1%|          | 1/100 [00:19<32:13, 19.53s/it]is_0k: False
your chose emoji: ['🥔', '🕵️\u200d♂️', '👩🏽\u200d🏫', '⏱', '♀️', '👩🏻\u200d🎨', '😌', '🧎🏽\u200d♂\u200d➡', '⚰', '\U0001fac5🏼']
emoji:
O: 🥔 [9468, 98, 242]
N: ⚰ [158, 248, 108]

O: 🕵️‍♂️ [9468, 243, 113, 31643, 102470, 17245, 224, 31643]
N: 👩🏽‍🏫 [9468, 239, 102, 9468, 237, 121, 102470, 9468, 237, 104]

O: 👩🏽‍🏫 [9468, 239, 102, 9468, 237, 121, 102470, 9468, 237, 104]
N: 😌 [76460, 234]

O: ⏱ [158, 237, 109]
N: 🧎🏽‍♂‍➡ [9468, 100, 236, 9468, 237, 121, 102470, 17245, 224, 102470, 98115, 94]

O: ♀️ [32990, 31643]
N: ♀️ [32990, 31643]

O: 👩🏻‍🎨 [9468, 239, 102, 9468, 237, 119, 102470, 9468, 236, 101]
N: 👩🏻‍🎨 [9468, 239, 102, 9468, 237, 119, 102470, 9468, 236, 101]

O: 😌 [76460, 234]
N: ⏱ [158, 237, 109]

O: 🧎🏽‍♂‍➡ [9468, 100, 236, 9468, 237, 121, 102470, 17245, 224, 102470, 98115, 94]
N: 🥔 [9468, 98, 242]

O: ⚰ [158, 248, 108]
N: 🕵️‍♂️ [9468, 243, 113, 31643, 102470, 17245, 224, 31643]

O: 🫅🏼 [9468, 104, 227, 9468, 237, 120]
N: 🫅🏼 [9468, 104, 227, 9468, 237, 120]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.59s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.86s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.50s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.17s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.71s/it]
Processing depth (4, 6, 7, 8, 9):   1%|          | 1/100 [00:35<32:13, 19.53s/it]2025-01-22 05:30:54.178 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra journeyed to the hallway.
2025-01-22 05:30:54.203 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3748, 3754) --> . Sandra journeyed to the
2025-01-22 05:30:54.203 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra took the milk.
2025-01-22 05:30:54.229 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4936, 4940) -->  Sandra took the milk
2025-01-22 05:30:54.229 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the garden.
2025-01-22 05:30:54.259 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6060, 6065) -->  Sandra moved to the garden
2025-01-22 05:30:54.259 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra put down the milk there.
2025-01-22 05:30:54.302 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6665, 6671) --> . Sandra put down the milk
2025-01-22 05:30:54.303 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary left the football.
2025-01-22 05:30:54.338 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7434, 7438) -->  Mary left the football
2025-01-22 05:30:54.338 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the kitchen.
2025-01-22 05:30:54.381 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (7437, 7442) -->  football. John travelled to
2025-01-22 05:30:54.382 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary grabbed the football.
2025-01-22 05:30:54.383 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (184, 188) -->  Mary grabbed the football
2025-01-22 05:30:54.383 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary moved to the bedroom.
2025-01-22 05:30:54.406 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4331, 4336) --> . Mary moved to the
2025-01-22 05:30:54.407 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary grabbed the football there.
2025-01-22 05:30:54.408 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (183, 188) --> . Mary grabbed the football
2025-01-22 05:30:54.408 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went back to the office.
2025-01-22 05:30:54.418 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1707, 1713) --> . John went back to the
2025-01-22 05:30:54.418 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel went to the office.
2025-01-22 05:30:54.429 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (1710, 1715) -->  back to the office.
2025-01-22 05:30:54.429 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Mary discarded the football.
2025-01-22 05:30:54.463 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (6673, 6677) -->  Mary discarded the football
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:30:55.232 | INFO     | test_jbb_embedding:begin_test:693 - the garden<|eot_id|>
2025-01-22 05:30:55.232 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8189])
2025-01-22 05:30:57.467 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [275.77375, 21.816417694091797, 166.0358455882353, 20.432869943440306, 15.509613037109375], 'topk_indices': array([ 187, 3982, 8078,    9,    1,   23, 8187,  188, 3752, 3753, 8068,
         24,   14, 3749, 3750, 3751, 3754,    0, 8184, 8185]), 'topk_tokens': [' football', '�', ' location', ':', '<|start_header_id|>', '4', '<|end_header_id|>', ' there', ' to', ' the', '.\n\n', '\n\n', '\n', ' Sandra', ' journey', 'ed', ' hallway', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [552.0416666666666, 188.40625, 216.05, 218.66666666666666, 109.0546875]}, 'weight': {'score': [24.8315625, 23.275266647338867, 23.08938419117647, 23.271259836468708, 29.774658203125], 'topk_indices': array([3238, 3265, 3110, 3158, 7374, 7412, 1467, 1405, 4254, 4270, 5076,
       5137, 7095, 7151, 3421, 3447, 4925, 4896, 4848, 4873]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.213541666666668, 27.912109375, 25.5546875, 24.705729166666668, 26.462890625]}, 'saliency': {'score': [1.7128515625, 0.12167445570230484, 1.0308083926930147, 0.11298270831172, 0.1171497106552124], 'topk_indices': array([3982, 8168, 8174, 4936,    0, 4336, 8162,   24,  188, 1214,  185,
       8068, 8078, 8182, 3751, 8176,  187, 3750, 3749, 3754]), 'topk_tokens': ['�', ' prior', ' milk', ' Sandra', '<|begin_of_text|>', ' bedroom', 'Question', '\n\n', ' there', 'nes', ' grabbed', '.\n\n', ' location', 'Answer', 'ed', ' discarded', ' football', ' journey', ' Sandra', ' hallway'], 'evidence_proportions': [3.17724609375, 1.41162109375, 1.38798828125, 1.3870035807291667, 0.71234130859375]}}, 'pred_res': 'the garden<|eot_id|>', 'score': 0}
2025-01-22 05:30:57.480 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:30:57.480 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-63_pid-1_4-6-7-8-9.pkl | len: 3 |  size: 2.1 KB
Processing depth (4, 6, 7, 8, 9):   2%|▏         | 2/100 [00:39<32:11, 19.71s/it]is_0k: False
your chose emoji: ['🤸\u200d♀️', '👎🏻', '⛹🏾\u200d♀', '🐛', '🙅🏼\u200d♀', '💆🏾\u200d♂️', '💁🏻\u200d♂️', '🧖🏽', '🤾🏿', '\U0001fac4']
emoji:
O: 🤸‍♀️ [9468, 97, 116, 102470, 32990, 31643]
N: 🤾🏿 [9468, 97, 122, 9468, 237, 123]

O: 👎🏻 [9468, 239, 236, 9468, 237, 119]
N: 💆🏾‍♂️ [93273, 228, 9468, 237, 122, 102470, 17245, 224, 31643]

O: ⛹🏾‍♀ [158, 249, 117, 9468, 237, 122, 102470, 32990]
N: 🙅🏼‍♀ [9468, 247, 227, 9468, 237, 120, 102470, 32990]

O: 🐛 [9468, 238, 249]
N: 🤸‍♀️ [9468, 97, 116, 102470, 32990, 31643]

O: 🙅🏼‍♀ [9468, 247, 227, 9468, 237, 120, 102470, 32990]
N: ⛹🏾‍♀ [158, 249, 117, 9468, 237, 122, 102470, 32990]

O: 💆🏾‍♂️ [93273, 228, 9468, 237, 122, 102470, 17245, 224, 31643]
N: 🧖🏽 [9468, 100, 244, 9468, 237, 121]

O: 💁🏻‍♂️ [93273, 223, 9468, 237, 119, 102470, 17245, 224, 31643]
N: 💁🏻‍♂️ [93273, 223, 9468, 237, 119, 102470, 17245, 224, 31643]

O: 🧖🏽 [9468, 100, 244, 9468, 237, 121]
N: 👎🏻 [9468, 239, 236, 9468, 237, 119]

O: 🤾🏿 [9468, 97, 122, 9468, 237, 123]
N: 🐛 [9468, 238, 249]

O: 🫄 [9468, 104, 226]
N: 🫄 [9468, 104, 226]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:11,  3.85s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.18s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:11<00:03,  3.95s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  2.58s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  3.10s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (1, 2, 3, 6, 9):   2%|▏         | 2/100 [00:53<32:11, 19.71s/it]2025-01-22 05:31:11.738 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra journeyed to the hallway.
2025-01-22 05:31:11.742 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (831, 837) --> . Sandra journeyed to the
2025-01-22 05:31:11.742 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra took the milk.
2025-01-22 05:31:11.751 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1820, 1824) -->  Sandra took the milk
2025-01-22 05:31:11.751 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the garden.
2025-01-22 05:31:11.766 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2908, 2913) --> . Sandra moved to the
2025-01-22 05:31:11.766 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra put down the milk there.
2025-01-22 05:31:11.789 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4724, 4730) --> . Sandra put down the milk
2025-01-22 05:31:11.790 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary left the football.
2025-01-22 05:31:11.824 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7125, 7129) -->  left the football.
2025-01-22 05:31:11.824 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the kitchen.
2025-01-22 05:31:11.859 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (7127, 7132) -->  football. John travelled to
2025-01-22 05:31:11.859 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary grabbed the football.
2025-01-22 05:31:11.860 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (184, 188) -->  Mary grabbed the football
2025-01-22 05:31:11.860 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary moved to the bedroom.
2025-01-22 05:31:11.882 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4235, 4240) -->  Mary moved to the bedroom
2025-01-22 05:31:11.882 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary grabbed the football there.
2025-01-22 05:31:11.883 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (183, 188) --> . Mary grabbed the football
2025-01-22 05:31:11.883 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went back to the office.
2025-01-22 05:31:11.891 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1550, 1556) --> . John went back to the
2025-01-22 05:31:11.891 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel went to the office.
2025-01-22 05:31:11.898 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (1553, 1558) -->  back to the office.
2025-01-22 05:31:11.899 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Mary discarded the football.
2025-01-22 05:31:11.932 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (6515, 6519) -->  Mary discarded the football
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:31:14.979 | INFO     | test_jbb_embedding:begin_test:693 - the garden<|eot_id|>
2025-01-22 05:31:14.980 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8189])
2025-01-22 05:31:17.991 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [338.455, 32.09288024902344, 246.81617647058823, 30.25350424197713, 22.7926025390625], 'topk_indices': array([  14, 8171, 4730,   24, 8078,  188,  187, 8164, 8068, 8108, 8172,
        833, 8168, 8169, 8034, 8176, 8184,  837,    0, 8185]), 'topk_tokens': ['\n', ' place', ' there', '\n\n', ' location', ' there', ' football', ' Where', '.\n\n', ' the', ' where', ' journey', ' prior', ' to', ' context', ' discarded', '<|eot_id|>', ' hallway', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [522.6666666666666, 351.5, 246.9, 360.375, 130.65625]}, 'weight': {'score': [23.0034375, 23.2606258392334, 23.887408088235293, 23.258796146870772, 28.837646484375], 'topk_indices': array([3353, 3326, 3230, 3182, 7419, 7457, 1510, 1448, 4311, 4327, 5129,
       5190, 7140, 7196, 3509, 3535, 4906, 4931, 4954, 4983]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.213541666666668, 27.912109375, 21.040625, 24.705729166666668, 20.6796875]}, 'saliency': {'score': [2.03318359375, 0.1807006299495697, 1.6260914522058822, 0.16896383392697958, 0.16521835327148438], 'topk_indices': array([8162, 4730,  188, 1823,   35,  185, 8171, 6516,  832, 8078, 8172,
       8174, 4239, 8164,  187,  833, 8168, 8034, 8176,  837]), 'topk_tokens': ['Question', ' there', ' there', ' milk', '-text', ' grabbed', ' place', ' discarded', ' Sandra', ' location', ' where', ' milk', ' bedroom', ' Where', ' football', ' journey', ' prior', ' context', ' discarded', ' hallway'], 'evidence_proportions': [2.9816080729166665, 2.54931640625, 1.28740234375, 2.2718098958333335, 0.668701171875]}}, 'pred_res': 'the garden<|eot_id|>', 'score': 0}
2025-01-22 05:31:17.999 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:31:17.999 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-63_pid-2_1-2-3-6-9.pkl | len: 3 |  size: 2.11 KB
Processing depth (1, 2, 3, 6, 9):   3%|▎         | 3/100 [00:59<32:27, 20.08s/it]is_0k: False
your chose emoji: ['📢', '💇🏽', '👩🏿\u200d🦰', '🤛🏿', '🇪🇺', '🤽🏾\u200d♀', '🚦', '🧑🏿\u200d🦽', '☪️', '👩🏿\u200d🌾']
emoji:
O: 📢 [9468, 241, 95]
N: 🤽🏾‍♀ [9468, 97, 121, 9468, 237, 122, 102470, 32990]

O: 💇🏽 [93273, 229, 9468, 237, 121]
N: 🧑🏿‍🦽 [9468, 100, 239, 9468, 237, 123, 102470, 9468, 99, 121]

O: 👩🏿‍🦰 [9468, 239, 102, 9468, 237, 123, 102470, 9468, 99, 108]
N: 🤛🏿 [9468, 97, 249, 9468, 237, 123]

O: 🤛🏿 [9468, 97, 249, 9468, 237, 123]
N: 📢 [9468, 241, 95]

O: 🇪🇺 [9468, 229, 103, 9468, 229, 118]
N: 💇🏽 [93273, 229, 9468, 237, 121]

O: 🤽🏾‍♀ [9468, 97, 121, 9468, 237, 122, 102470, 32990]
N: ☪️ [18107, 103, 31643]

O: 🚦 [9468, 248, 99]
N: 🇪🇺 [9468, 229, 103, 9468, 229, 118]

O: 🧑🏿‍🦽 [9468, 100, 239, 9468, 237, 123, 102470, 9468, 99, 121]
N: 🚦 [9468, 248, 99]

O: ☪️ [18107, 103, 31643]
N: 👩🏿‍🦰 [9468, 239, 102, 9468, 237, 123, 102470, 9468, 99, 108]

O: 👩🏿‍🌾 [9468, 239, 102, 9468, 237, 123, 102470, 9468, 234, 122]
N: 👩🏿‍🌾 [9468, 239, 102, 9468, 237, 123, 102470, 9468, 234, 122]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.64s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.28s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.19s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.93s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.44s/it]
Processing depth (1, 3, 4, 8, 9):   3%|▎         | 3/100 [01:15<32:27, 20.08s/it]2025-01-22 05:31:33.573 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra journeyed to the hallway.
2025-01-22 05:31:33.578 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (778, 784) -->  Sandra journeyed to the hallway
2025-01-22 05:31:33.578 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra took the milk.
2025-01-22 05:31:33.592 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2882, 2886) -->  Sandra took the milk
2025-01-22 05:31:33.592 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the garden.
2025-01-22 05:31:33.610 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3612, 3617) --> . Sandra moved to the
2025-01-22 05:31:33.610 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra put down the milk there.
2025-01-22 05:31:33.642 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6489, 6495) --> . Sandra put down the milk
2025-01-22 05:31:33.642 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary left the football.
2025-01-22 05:31:33.677 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7131, 7135) -->  left the football.
2025-01-22 05:31:33.677 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the kitchen.
2025-01-22 05:31:33.712 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (7133, 7138) -->  football. John travelled to
2025-01-22 05:31:33.712 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary grabbed the football.
2025-01-22 05:31:33.713 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (184, 188) -->  Mary grabbed the football
2025-01-22 05:31:33.713 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary moved to the bedroom.
2025-01-22 05:31:33.734 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4276, 4281) --> . Mary moved to the
2025-01-22 05:31:33.734 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary grabbed the football there.
2025-01-22 05:31:33.735 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (183, 188) --> . Mary grabbed the football
2025-01-22 05:31:33.735 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went back to the office.
2025-01-22 05:31:33.742 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1534, 1540) --> . John went back to the
2025-01-22 05:31:33.742 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel went to the office.
2025-01-22 05:31:33.750 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (1537, 1542) -->  back to the office.
2025-01-22 05:31:33.750 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Mary discarded the football.
2025-01-22 05:31:33.781 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (6497, 6501) -->  Mary discarded the football
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:31:34.552 | INFO     | test_jbb_embedding:begin_test:693 - the garden<|eot_id|>
2025-01-22 05:31:34.552 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8213])
2025-01-22 05:31:36.805 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [370.92, 28.45163781037001, 193.4347426470588, 26.714340443790608, 29.640162417763158], 'topk_indices': array([8189, 8198,  548,    1, 8102,  187,    9, 8196, 8192,  779, 8193,
       8058,   24, 8200, 8092,   14,  783, 8208, 8209,    0]), 'topk_tokens': [' was', ' milk', ' per', '<|start_header_id|>', ' location', ' football', ':', ' where', ' prior', ' journey', ' to', ' context', '\n\n', ' discarded', '.\n\n', '\n', ' hallway', '<|eot_id|>', '<|start_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [609.875, 322.65625, 267.85, 396.5833333333333, 151.09375]}, 'weight': {'score': [24.2225, 23.29708990080331, 23.08938419117647, 23.29511941430673, 29.928042763157894], 'topk_indices': array([3296, 3323, 3216, 3168, 7463, 7425, 1494, 1432, 4287, 4303, 5130,
       5191, 7146, 7202, 3505, 3479, 4984, 4955, 4932, 4907]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.29296875, 27.912109375, 21.040625, 24.705729166666668, 20.6796875]}, 'saliency': {'score': [2.492255859375, 0.1599078749496029, 1.2658152860753678, 0.1481499306577173, 0.22925517433568052], 'topk_indices': array([8195,   24, 3617, 8188, 2882,  548, 8092,  185, 6498, 8102, 8198,
       8196,  778, 6490,  187, 8058, 8192,  779, 8200,  783]), 'topk_tokens': [' place', '\n\n', ' garden', ' Where', ' Sandra', ' per', '.\n\n', ' grabbed', ' discarded', ' location', ' milk', ' where', ' Sandra', ' Sandra', ' football', ' context', ' prior', ' journey', ' discarded', ' hallway'], 'evidence_proportions': [4.505859375, 2.385009765625, 1.39248046875, 2.588134765625, 0.80999755859375]}}, 'pred_res': 'the garden<|eot_id|>', 'score': 0}
2025-01-22 05:31:36.812 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:31:36.813 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-63_pid-3_1-3-4-8-9.pkl | len: 3 |  size: 2.1 KB
Processing depth (1, 3, 4, 8, 9):   4%|▍         | 4/100 [01:18<31:19, 19.58s/it]is_0k: False
your chose emoji: ['🥁', '👷\u200d♂️', '🏋🏿\u200d♂', '🏡', '🦴', '🧎🏿\u200d♂️', '\U0001faf1🏼\u200d\U0001faf2🏻', '🏯', '🧏\u200d♀️', '🧑🏿\u200d❤️\u200d💋\u200d🧑🏼']
emoji:
O: 🥁 [9468, 98, 223]
N: 🏯 [9468, 237, 107]

O: 👷‍♂️ [9468, 239, 115, 102470, 17245, 224, 31643]
N: 👷‍♂️ [9468, 239, 115, 102470, 17245, 224, 31643]

O: 🏋🏿‍♂ [9468, 237, 233, 9468, 237, 123, 102470, 17245, 224]
N: 🥁 [9468, 98, 223]

O: 🏡 [9468, 237, 94]
N: 🧎🏿‍♂️ [9468, 100, 236, 9468, 237, 123, 102470, 17245, 224, 31643]

O: 🦴 [9468, 99, 112]
N: 🏡 [9468, 237, 94]

O: 🧎🏿‍♂️ [9468, 100, 236, 9468, 237, 123, 102470, 17245, 224, 31643]
N: 🫱🏼‍🫲🏻 [9468, 104, 109, 9468, 237, 120, 102470, 9468, 104, 110, 9468, 237, 119]

O: 🫱🏼‍🫲🏻 [9468, 104, 109, 9468, 237, 120, 102470, 9468, 104, 110, 9468, 237, 119]
N: 🏋🏿‍♂ [9468, 237, 233, 9468, 237, 123, 102470, 17245, 224]

O: 🏯 [9468, 237, 107]
N: 🦴 [9468, 99, 112]

O: 🧏‍♀️ [9468, 100, 237, 102470, 32990, 31643]
N: 🧏‍♀️ [9468, 100, 237, 102470, 32990, 31643]

O: 🧑🏿‍❤️‍💋‍🧑🏼 [9468, 100, 239, 9468, 237, 123, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 100, 239, 9468, 237, 120]
N: 🧑🏿‍❤️‍💋‍🧑🏼 [9468, 100, 239, 9468, 237, 123, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 100, 239, 9468, 237, 120]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.55s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.87s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.17s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.68s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.34s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (1, 3, 4, 5, 7):   4%|▍         | 4/100 [01:33<31:19, 19.58s/it]2025-01-22 05:31:51.984 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra journeyed to the hallway.
2025-01-22 05:31:51.989 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (901, 907) --> . Sandra journeyed to the
2025-01-22 05:31:51.989 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra took the milk.
2025-01-22 05:31:52.004 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2982, 2986) -->  Sandra took the milk
2025-01-22 05:31:52.004 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the garden.
2025-01-22 05:31:52.021 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3631, 3636) -->  Sandra moved to the garden
2025-01-22 05:31:52.022 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra put down the milk there.
2025-01-22 05:31:52.042 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4215, 4221) -->  Sandra put down the milk there
2025-01-22 05:31:52.043 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary left the football.
2025-01-22 05:31:52.069 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5579, 5583) -->  Mary left the football
2025-01-22 05:31:52.069 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the kitchen.
2025-01-22 05:31:52.104 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (7129, 7134) -->  John travelled to the kitchen
2025-01-22 05:31:52.104 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary grabbed the football.
2025-01-22 05:31:52.105 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (184, 188) -->  Mary grabbed the football
2025-01-22 05:31:52.105 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary moved to the bedroom.
2025-01-22 05:31:52.126 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4250, 4255) -->  Mary moved to the bedroom
2025-01-22 05:31:52.127 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary grabbed the football there.
2025-01-22 05:31:52.127 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (183, 188) --> . Mary grabbed the football
2025-01-22 05:31:52.128 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went back to the office.
2025-01-22 05:31:52.136 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1714, 1720) --> . John went back to the
2025-01-22 05:31:52.136 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel went to the office.
2025-01-22 05:31:52.145 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (1717, 1722) -->  back to the office.
2025-01-22 05:31:52.145 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Mary discarded the football.
2025-01-22 05:31:52.176 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (6496, 6500) -->  Mary discarded the football
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:31:54.743 | INFO     | test_jbb_embedding:begin_test:693 - the garden<|eot_id|>
2025-01-22 05:31:54.743 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8175])
2025-01-22 05:31:57.684 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [392.545, 30.44755938187821, 246.69669117647058, 28.427001862914153, 38.14247532894737], 'topk_indices': array([ 185, 6497, 8154, 8054, 3046, 8160,  905, 8020,  904, 8155, 3005,
        187, 3006,   14,  903, 8162, 8171, 8170,  907,    0]), 'topk_tokens': [' grabbed', ' discarded', ' prior', '.\n\n', ' of', ' milk', ' to', ' context', 'ed', ' to', ' of', ' football', ' its', '\n', ' journey', ' discarded', '<|start_header_id|>', '<|eot_id|>', ' hallway', '<|begin_of_text|>'], 'evidence_proportions': [631.25, 315.71875, 384.55, 351.875, 182.3125]}, 'weight': {'score': [25.440625, 23.253968344949865, 23.932444852941178, 23.244393937061215, 29.044956140350877], 'topk_indices': array([3262, 3289, 3134, 3182, 7419, 7457, 1412, 1474, 4342, 4326, 5221,
       5160, 7196, 7140, 3445, 3471, 4945, 4920, 4980, 5009]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.213541666666668, 27.912109375, 25.5546875, 27.243489583333332, 26.462890625]}, 'saliency': {'score': [2.449814453125, 0.17212524563329207, 1.6741763844209558, 0.15882164064424498, 0.28160041675233005], 'topk_indices': array([8158, 3632, 3045, 3635, 6496,  548, 2985, 8148, 3004,  185, 8154,
       8020, 3006, 8160,  902, 6497,  187,  903, 8162,  907]), 'topk_tokens': [' where', ' moved', ' any', ' garden', ' Mary', ' per', ' milk', 'Question', ' any', ' grabbed', ' prior', ' context', ' its', ' milk', ' Sandra', ' discarded', ' football', ' journey', ' discarded', ' hallway'], 'evidence_proportions': [3.427734375, 2.3258056640625, 2.4306640625, 2.37158203125, 1.24822998046875]}}, 'pred_res': 'the garden<|eot_id|>', 'score': 0}
2025-01-22 05:31:57.697 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:31:57.698 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-63_pid-4_1-3-4-5-7.pkl | len: 3 |  size: 2.09 KB
Processing depth (1, 3, 4, 5, 7):   5%|▌         | 5/100 [01:39<31:44, 20.05s/it]Processing depth (1, 3, 4, 5, 7):   5%|▌         | 5/100 [01:39<31:33, 19.93s/it]
2025-01-22 05:31:57.764 | INFO     | __main__:<module>:82 - Selected idx: 64
2025-01-22 05:31:57.764 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the football before the garden? 
2025-01-22 05:31:57.764 | INFO     | __main__:<module>:84 - Answer: hallway
2025-01-22 05:31:57.764 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 05:31:57.764 | INFO     | __main__:<module>:86 - Needle: [' John travelled to the kitchen.', ' Sandra journeyed to the hallway.', ' John went back to the office.', ' Sandra moved to the garden.', ' Mary moved to the bedroom.', ' Mary grabbed the football.', ' Sandra put down the football there.', ' Daniel went to the office.']
2025-01-22 05:31:57.764 | INFO     | __main__:<module>:87 - Real Needle: [' Sandra journeyed to the hallway.', ' Sandra moved to the garden.', ' Sandra put down the football there.', ' Daniel went to the office.']
2025-01-22 05:31:57.764 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['🧝🏽\u200d♂', '🇯🇵', '🇧🇩', '👂🏻', '👰🏾\u200d♂️', '🚵', '🙏🏽', '🏟', '👐🏾', '🎂']
emoji:
O: 🧝🏽‍♂ [9468, 100, 251, 9468, 237, 121, 102470, 17245, 224]
N: 🇯🇵 [9468, 229, 107, 9468, 229, 113]

O: 🇯🇵 [9468, 229, 107, 9468, 229, 113]
N: 🏟 [9468, 237, 253]

O: 🇧🇩 [9468, 229, 100, 9468, 229, 102]
N: 🇧🇩 [9468, 229, 100, 9468, 229, 102]

O: 👂🏻 [9468, 239, 224, 9468, 237, 119]
N: 👰🏾‍♂️ [9468, 239, 108, 9468, 237, 122, 102470, 17245, 224, 31643]

O: 👰🏾‍♂️ [9468, 239, 108, 9468, 237, 122, 102470, 17245, 224, 31643]
N: 🧝🏽‍♂ [9468, 100, 251, 9468, 237, 121, 102470, 17245, 224]

O: 🚵 [9468, 248, 113]
N: 👐🏾 [9468, 80010, 9468, 237, 122]

O: 🙏🏽 [9468, 247, 237, 9468, 237, 121]
N: 🚵 [9468, 248, 113]

O: 🏟 [9468, 237, 253]
N: 👂🏻 [9468, 239, 224, 9468, 237, 119]

O: 👐🏾 [9468, 80010, 9468, 237, 122]
N: 🙏🏽 [9468, 247, 237, 9468, 237, 121]

O: 🎂 [9468, 236, 224]
N: 🎂 [9468, 236, 224]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.06s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.63s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.65s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.24s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.71s/it]
Processing depth (3, 4, 6, 8):   0%|          | 0/100 [00:16<?, ?it/s]2025-01-22 05:32:14.402 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra journeyed to the hallway.
2025-01-22 05:32:14.423 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2954, 2960) -->  tragedy. Sandra journeyed to
2025-01-22 05:32:14.423 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the garden.
2025-01-22 05:32:14.441 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3716, 3721) --> . Sandra moved to the
2025-01-22 05:32:14.441 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra put down the football there.
2025-01-22 05:32:14.465 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4762, 4768) --> . Sandra put down the football
2025-01-22 05:32:14.465 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went to the office.
2025-01-22 05:32:14.480 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3085, 3090) -->  back to the office.
2025-01-22 05:32:14.481 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the kitchen.
2025-01-22 05:32:14.514 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6281, 6286) --> . John travelled to the
2025-01-22 05:32:14.514 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the office.
2025-01-22 05:32:14.530 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3081, 3087) -->  ranks. John went back to
2025-01-22 05:32:14.530 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary moved to the bedroom.
2025-01-22 05:32:14.552 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3719, 3724) -->  to the garden. Mary
2025-01-22 05:32:14.552 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary grabbed the football.
2025-01-22 05:32:14.569 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3510, 3514) -->  Mary grabbed the football
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:32:15.332 | INFO     | test_jbb_embedding:begin_test:693 - the bedroom<|eot_id|>
2025-01-22 05:32:15.332 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8149])
2025-01-22 05:32:17.547 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [261.99147727272725, 21.453562009322866, 232.78046875, 20.27990328298397, 20.18597722457627], 'topk_indices': array([3727,   24, 2956, 8134, 2944, 3731, 2958, 3721, 8145,   14,    9,
       8136, 8139, 8147, 3722, 8137, 3513, 8144, 2961,    0]), 'topk_tokens': [' bedroom', '\n\n', ' Sandra', ' was', 'lyn', '�', 'ed', ' garden', '<|start_header_id|>', '\n', ':', ' football', ' garden', '<|end_header_id|>', '.', ' before', ' football', '<|eot_id|>', ' hallway', '<|begin_of_text|>'], 'evidence_proportions': [362.1822916666667, 357.35, 229.54166666666666, 85.34375]}, 'weight': {'score': [22.854758522727273, 23.259194446148186, 22.8640625, 23.26126599106042, 29.30270127118644], 'topk_indices': array([3245, 3272, 3165, 3117, 7404, 7442, 1461, 1399, 4309, 4293, 5111,
       5172, 7161, 7105, 3454, 3428, 4913, 4936, 4965, 4888]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.053385416666668, 21.040625, 24.924479166666668, 18.346875]}, 'saliency': {'score': [1.5389293323863635, 0.12131331783515548, 1.3436920166015625, 0.11445325294052482, 0.15072360281216896], 'topk_indices': array([3718, 8134, 4767, 2915, 8133, 3731, 3717, 8131, 8003, 3511, 2957,
       3721, 3727, 2944, 8137, 2956, 8136, 8139, 3513, 2961]), 'topk_tokens': [' moved', ' was', ' football', 'lyn', ' Where', '�', ' Sandra', 'Question', ' context', ' grabbed', ' journey', ' garden', ' bedroom', 'lyn', ' before', ' Sandra', ' football', ' garden', ' football', ' hallway'], 'evidence_proportions': [2.2871907552083335, 1.87177734375, 1.4867757161458333, 0.370751953125]}}, 'pred_res': 'the bedroom<|eot_id|>', 'score': 0}
2025-01-22 05:32:17.555 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:32:17.555 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-64_pid-0_3-4-6-8.pkl | len: 3 |  size: 2.04 KB
Processing depth (3, 4, 6, 8):   1%|          | 1/100 [00:19<32:28, 19.68s/it]is_0k: False
your chose emoji: ['\U0001fadc', '💇🏿\u200d♂️', '🧑\u200d🎤', '👨🏼\u200d🍳', '🤹🏿\u200d♀', '😸', '◀', '🇦🇨', '👨\u200d🦽\u200d➡', '☯']
emoji:
O: 🫜 [9468, 104, 250]
N: 🫜 [9468, 104, 250]

O: 💇🏿‍♂️ [93273, 229, 9468, 237, 123, 102470, 17245, 224, 31643]
N: 🧑‍🎤 [9468, 100, 239, 102470, 9468, 236, 97]

O: 🧑‍🎤 [9468, 100, 239, 102470, 9468, 236, 97]
N: 💇🏿‍♂️ [93273, 229, 9468, 237, 123, 102470, 17245, 224, 31643]

O: 👨🏼‍🍳 [9468, 239, 101, 9468, 237, 120, 102470, 9468, 235, 111]
N: 🤹🏿‍♀ [9468, 97, 117, 9468, 237, 123, 102470, 32990]

O: 🤹🏿‍♀ [9468, 97, 117, 9468, 237, 123, 102470, 32990]
N: ◀ [41832, 222]

O: 😸 [76460, 116]
N: 😸 [76460, 116]

O: ◀ [41832, 222]
N: 🇦🇨 [9468, 229, 99, 9468, 229, 101]

O: 🇦🇨 [9468, 229, 99, 9468, 229, 101]
N: 👨🏼‍🍳 [9468, 239, 101, 9468, 237, 120, 102470, 9468, 235, 111]

O: 👨‍🦽‍➡ [9468, 239, 101, 102470, 9468, 99, 121, 102470, 98115, 94]
N: 👨‍🦽‍➡ [9468, 239, 101, 102470, 9468, 99, 121, 102470, 98115, 94]

O: ☯ [18107, 107]
N: ☯ [18107, 107]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:11,  3.67s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:07<00:07,  3.99s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.06s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.88s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.27s/it]
Processing depth (1, 3, 6, 8):   1%|          | 1/100 [00:34<32:28, 19.68s/it]2025-01-22 05:32:32.778 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra journeyed to the hallway.
2025-01-22 05:32:32.781 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (671, 677) --> . Sandra journeyed to the
2025-01-22 05:32:32.781 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the garden.
2025-01-22 05:32:32.795 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2836, 2841) --> . Sandra moved to the
2025-01-22 05:32:32.795 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra put down the football there.
2025-01-22 05:32:32.820 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4779, 4785) -->  Sandra put down the football there
2025-01-22 05:32:32.820 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went to the office.
2025-01-22 05:32:32.838 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2963, 2968) -->  back to the office.
2025-01-22 05:32:32.838 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the kitchen.
2025-01-22 05:32:32.871 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6385, 6390) --> . John travelled to the
2025-01-22 05:32:32.871 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the office.
2025-01-22 05:32:32.886 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2960, 2966) --> . John went back to the
2025-01-22 05:32:32.886 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary moved to the bedroom.
2025-01-22 05:32:32.906 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3622, 3627) --> . Mary moved to the
2025-01-22 05:32:32.906 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary grabbed the football.
2025-01-22 05:32:32.925 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3346, 3350) -->  Mary grabbed the football
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:32:33.696 | INFO     | test_jbb_embedding:begin_test:693 - bedroom<|eot_id|>
2025-01-22 05:32:33.697 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8181])
2025-01-22 05:32:35.916 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [195.27272727272728, 18.585979502688172, 131.621875, 17.830903801277326, 18.055703125], 'topk_indices': array([8169, 3349, 8091, 8179, 8168, 8069, 8077,   14, 8107,   24,    1,
       8092, 8176, 8076, 3627, 8177, 8108,  677, 8109,    0]), 'topk_tokens': [' before', ' football', ' in', '<|end_header_id|>', ' football', '.\n\n', ' the', '\n', ' moved', '\n\n', '<|start_header_id|>', ' the', '<|eot_id|>', ' in', ' bedroom', '<|start_header_id|>', ' to', ' hallway', ' the', '<|begin_of_text|>'], 'evidence_proportions': [295.4583333333333, 212.9, 182.625, 72.6]}, 'weight': {'score': [22.226917613636363, 23.284577758431084, 21.583203125, 23.291614852001967, 29.398333333333333], 'topk_indices': array([3301, 3328, 3221, 3173, 7434, 7472, 1524, 1462, 4307, 4291, 5127,
       5188, 7155, 7211, 3489, 3515, 4904, 4929, 4981, 4952]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.213541666666668, 21.040625, 27.462239583333332, 18.346875]}, 'saliency': {'score': [1.1497802734375, 0.10426052388091474, 0.7761077880859375, 0.09978516404618798, 0.1323858642578125], 'topk_indices': array([8099, 2841, 8076, 8070, 8108, 8078, 8073, 8163, 8075,  673, 8171,
       8169, 8035, 8079,  672, 3349, 8107, 8168, 3627,  677]), 'topk_tokens': [' left', ' garden', ' in', 'If', ' to', ' first', ' obtained', 'Question', ' item', ' journey', ' garden', ' before', ' context', ' location', ' Sandra', ' football', ' moved', ' football', ' bedroom', ' hallway'], 'evidence_proportions': [1.67333984375, 1.16494140625, 1.2924397786458333, 0.33515625]}}, 'pred_res': 'bedroom<|eot_id|>', 'score': 0}
2025-01-22 05:32:35.935 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:32:35.938 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-64_pid-1_1-3-6-8.pkl | len: 3 |  size: 2.05 KB
Processing depth (1, 3, 6, 8):   2%|▏         | 2/100 [00:38<30:53, 18.92s/it]is_0k: False
your chose emoji: ['🇬🇼', '👩🏻\u200d⚕️', '👯\u200d♀️', '🙎🏽\u200d♂️', '🧝🏻\u200d♂', '👩🏼\u200d❤\u200d👨🏼', '🇲🇻', 'Ⓜ', '🍄\u200d🟫', '🛁']
emoji:
O: 🇬🇼 [9468, 229, 105, 9468, 110771]
N: 👯‍♀️ [9468, 239, 107, 102470, 32990, 31643]

O: 👩🏻‍⚕️ [9468, 239, 102, 9468, 237, 119, 102470, 158, 248, 243, 31643]
N: 🙎🏽‍♂️ [9468, 247, 236, 9468, 237, 121, 102470, 17245, 224, 31643]

O: 👯‍♀️ [9468, 239, 107, 102470, 32990, 31643]
N: 🍄‍🟫 [9468, 235, 226, 102470, 9468, 253, 104]

O: 🙎🏽‍♂️ [9468, 247, 236, 9468, 237, 121, 102470, 17245, 224, 31643]
N: 🇬🇼 [9468, 229, 105, 9468, 110771]

O: 🧝🏻‍♂ [9468, 100, 251, 9468, 237, 119, 102470, 17245, 224]
N: 🧝🏻‍♂ [9468, 100, 251, 9468, 237, 119, 102470, 17245, 224]

O: 👩🏼‍❤‍👨🏼 [9468, 239, 102, 9468, 237, 120, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 120]
N: Ⓜ [158, 241, 224]

O: 🇲🇻 [9468, 229, 110, 9468, 229, 119]
N: 🇲🇻 [9468, 229, 110, 9468, 229, 119]

O: Ⓜ [158, 241, 224]
N: 👩🏼‍❤‍👨🏼 [9468, 239, 102, 9468, 237, 120, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 120]

O: 🍄‍🟫 [9468, 235, 226, 102470, 9468, 253, 104]
N: 👩🏻‍⚕️ [9468, 239, 102, 9468, 237, 119, 102470, 158, 248, 243, 31643]

O: 🛁 [9468, 249, 223]
N: 🛁 [9468, 249, 223]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:11,  3.90s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.26s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.16s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.94s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.38s/it]
Processing depth (1, 3, 4, 8):   2%|▏         | 2/100 [00:53<30:53, 18.92s/it]2025-01-22 05:32:51.104 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra journeyed to the hallway.
2025-01-22 05:32:51.108 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (815, 821) --> . Sandra journeyed to the
2025-01-22 05:32:51.108 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the garden.
2025-01-22 05:32:51.123 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2880, 2885) --> . Sandra moved to the
2025-01-22 05:32:51.123 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra put down the football there.
2025-01-22 05:32:51.141 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3638, 3644) --> . Sandra put down the football
2025-01-22 05:32:51.141 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went to the office.
2025-01-22 05:32:51.156 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3003, 3008) -->  back to the office.
2025-01-22 05:32:51.156 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the kitchen.
2025-01-22 05:32:51.189 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6327, 6332) --> . John travelled to the
2025-01-22 05:32:51.190 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the office.
2025-01-22 05:32:51.204 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2999, 3005) -->  tragedy. John went back to
2025-01-22 05:32:51.204 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary moved to the bedroom.
2025-01-22 05:32:51.222 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3645, 3650) --> . Mary moved to the
2025-01-22 05:32:51.222 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary grabbed the football.
2025-01-22 05:32:51.238 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3362, 3366) -->  Mary grabbed the football
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:32:52.009 | INFO     | test_jbb_embedding:begin_test:693 - the bedroom<|eot_id|>
2025-01-22 05:32:52.009 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8205])
2025-01-22 05:32:54.278 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [231.9403409090909, 16.26189959490741, 150.73671875, 15.351487876561352, 11.997721354166666], 'topk_indices': array([3650,  816, 8188, 8196, 8193, 8093, 3365, 8133,    9,    1, 8192,
       8203,   24, 8201, 8103,    3,  821,   14, 8200,    0]), 'topk_tokens': [' bedroom', ' Sandra', ':', '?', ' before', '.\n\n', ' football', ' the', ':', '<|start_header_id|>', ' football', '<|end_header_id|>', '\n\n', '<|start_header_id|>', ' location', '<|end_header_id|>', ' hallway', '\n', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [286.9375, 260.425, 203.95833333333334, 171.0375]}, 'weight': {'score': [21.534801136363637, 23.294055723075047, 23.03515625, 23.299429417707568, 29.002155172413794], 'topk_indices': array([3344, 3317, 3155, 3203, 7488, 7450, 1488, 1426, 4346, 4362, 5173,
       5234, 7171, 7227, 3531, 3505, 4959, 4982, 5011, 4934]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.213541666666668, 21.040625, 24.924479166666668, 18.346875]}, 'saliency': {'score': [1.3323752663352273, 0.09094682957461471, 0.88702392578125, 0.08565256463059484, 0.08664848064554148], 'topk_indices': array([8196, 8093, 8131, 8189, 8102, 2882, 2881, 2885,  817, 3643,   24,
       8195, 8193, 8187, 3650, 3365,  816, 8192, 8103,  821]), 'topk_tokens': ['?', '.\n\n', ' moved', ' Where', ' first', ' moved', ' Sandra', ' garden', ' journey', ' football', '\n\n', ' garden', ' before', 'Question', ' bedroom', ' football', ' Sandra', ' football', ' location', ' hallway'], 'evidence_proportions': [1.6812337239583333, 1.401171875, 1.2933756510416667, 0.891748046875]}}, 'pred_res': 'the bedroom<|eot_id|>', 'score': 0}
2025-01-22 05:32:54.291 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:32:54.291 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-64_pid-2_1-3-4-8.pkl | len: 3 |  size: 2.06 KB
Processing depth (1, 3, 4, 8):   3%|▎         | 3/100 [00:56<30:09, 18.66s/it]is_0k: False
your chose emoji: ['🙍🏽\u200d♀', '👩🏽\u200d🤝\u200d👩🏿', '👩🏼\u200d⚕️', '🐩', '👨🏽\u200d💼', '🙍🏿', '👨\u200d🎤', '🧎🏾\u200d➡', '🧑🏻\u200d🎓', '👨\u200d👧']
emoji:
O: 🙍🏽‍♀ [9468, 247, 235, 9468, 237, 121, 102470, 32990]
N: 🐩 [9468, 238, 102]

O: 👩🏽‍🤝‍👩🏿 [9468, 239, 102, 9468, 237, 121, 102470, 9468, 97, 251, 102470, 9468, 239, 102, 9468, 237, 123]
N: 👨‍🎤 [9468, 239, 101, 102470, 9468, 236, 97]

O: 👩🏼‍⚕️ [9468, 239, 102, 9468, 237, 120, 102470, 158, 248, 243, 31643]
N: 👨🏽‍💼 [9468, 239, 101, 9468, 237, 121, 102470, 93273, 120]

O: 🐩 [9468, 238, 102]
N: 👩🏽‍🤝‍👩🏿 [9468, 239, 102, 9468, 237, 121, 102470, 9468, 97, 251, 102470, 9468, 239, 102, 9468, 237, 123]

O: 👨🏽‍💼 [9468, 239, 101, 9468, 237, 121, 102470, 93273, 120]
N: 🙍🏿 [9468, 247, 235, 9468, 237, 123]

O: 🙍🏿 [9468, 247, 235, 9468, 237, 123]
N: 🧑🏻‍🎓 [9468, 100, 239, 9468, 237, 119, 102470, 9468, 236, 241]

O: 👨‍🎤 [9468, 239, 101, 102470, 9468, 236, 97]
N: 🙍🏽‍♀ [9468, 247, 235, 9468, 237, 121, 102470, 32990]

O: 🧎🏾‍➡ [9468, 100, 236, 9468, 237, 122, 102470, 98115, 94]
N: 🧎🏾‍➡ [9468, 100, 236, 9468, 237, 122, 102470, 98115, 94]

O: 🧑🏻‍🎓 [9468, 100, 239, 9468, 237, 119, 102470, 9468, 236, 241]
N: 👩🏼‍⚕️ [9468, 239, 102, 9468, 237, 120, 102470, 158, 248, 243, 31643]

O: 👨‍👧 [9468, 239, 101, 102470, 9468, 239, 100]
N: 👨‍👧 [9468, 239, 101, 102470, 9468, 239, 100]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.29s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.30s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.03s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  2.67s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  3.22s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 1, 4, 9):   3%|▎         | 3/100 [01:11<30:09, 18.66s/it]2025-01-22 05:33:08.957 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra journeyed to the hallway.
2025-01-22 05:33:08.958 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (32, 38) -->  journeyed to the hallway.
2025-01-22 05:33:08.958 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the garden.
2025-01-22 05:33:08.962 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (823, 828) --> . Sandra moved to the
2025-01-22 05:33:08.962 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra put down the football there.
2025-01-22 05:33:08.982 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3603, 3609) --> . Sandra put down the football
2025-01-22 05:33:08.982 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went to the office.
2025-01-22 05:33:08.997 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2988, 2993) -->  back to the office.
2025-01-22 05:33:08.997 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the kitchen.
2025-01-22 05:33:09.031 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6392, 6397) --> . John travelled to the
2025-01-22 05:33:09.031 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the office.
2025-01-22 05:33:09.046 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2984, 2990) -->  tragedy. John went back to
2025-01-22 05:33:09.046 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary moved to the bedroom.
2025-01-22 05:33:09.066 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3610, 3615) --> . Mary moved to the
2025-01-22 05:33:09.066 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary grabbed the football.
2025-01-22 05:33:09.083 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3327, 3331) -->  Mary grabbed the football
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:33:13.573 | INFO     | test_jbb_embedding:begin_test:693 - The bedroom.<|eot_id|>
2025-01-22 05:33:13.573 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8192])
2025-01-22 05:33:16.654 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [701.1931818181819, 64.48782031726662, 348.6625, 62.072634306390285, 32.63447265625], 'topk_indices': array([  36, 7358, 3331, 7281, 3330, 8175, 7283, 8182,  829, 8174, 8179,
       8180, 8183, 7312, 2385, 7311, 7282, 7359,    0, 7360]), 'topk_tokens': [' hallway', ' the', '.', 'Min', ' football', ':', 'ot', ' garden', '.', 'Question', ' football', ' before', '?', 'ot', 'nes', 'nes', 'nes', ' Min', '<|begin_of_text|>', 'nes'], 'evidence_proportions': [856.875, 815.8, 747.25, 344.5]}, 'weight': {'score': [21.55184659090909, 23.293437309334962, 23.03515625, 23.29877039126702, 29.5138671875], 'topk_indices': array([3282, 3309, 3154, 3202, 7445, 7407, 1423, 1485, 4329, 4313, 5185,
       5124, 7122, 7178, 3496, 3470, 4949, 4978, 4926, 4901]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.276041666666668, 21.040625, 24.924479166666668, 18.346875]}, 'saliency': {'score': [4.095769708806818, 0.3686454321423124, 2.1953125, 0.35410721609376916, 0.22814712524414063], 'topk_indices': array([ 828, 7283, 7253, 2384, 2371, 3608, 7281, 8183, 3330, 8182,   36,
       7312, 8180, 8174, 8179, 2385, 7311, 7282, 7359, 7360]), 'topk_tokens': [' garden', 'ot', 'nes', ' Min', 'nes', ' football', 'Min', '?', ' football', ' garden', ' hallway', 'ot', ' before', 'Question', ' football', 'nes', 'nes', 'nes', ' Min', 'nes'], 'evidence_proportions': [5.255859375, 4.478515625, 4.803873697916667, 1.47119140625]}}, 'pred_res': 'The bedroom.<|eot_id|>', 'score': 0}
2025-01-22 05:33:16.661 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:33:16.661 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-64_pid-3_0-1-4-9.pkl | len: 3 |  size: 1.96 KB
Processing depth (0, 1, 4, 9):   4%|▍         | 4/100 [01:18<32:11, 20.12s/it]is_0k: False
your chose emoji: ['👩🏾\u200d❤️\u200d👩🏽', '🧎🏾\u200d♂\u200d➡', '🌪', '🕵️\u200d♂️', '🤞🏽', '👩\u200d🍳', '🤫', '🦬', '🧑🏽\u200d🤝\u200d🧑🏿', '👮🏿']
emoji:
O: 👩🏾‍❤️‍👩🏽 [9468, 239, 102, 9468, 237, 122, 102470, 121643, 31643, 102470, 9468, 239, 102, 9468, 237, 121]
N: �� [104, 9468, 97]

O: 🧎🏾‍♂‍➡ [9468, 100, 236, 9468, 237, 122, 102470, 17245, 224, 102470, 98115, 94]
N: ��� [57923, 9468]

O: 🌪 [9468, 234, 103]
N: �🤞� [121, 9468, 97, 252, 9468, 237]

O: 🕵️‍♂️ [9468, 243, 113, 31643, 102470, 17245, 224, 31643]
N: �👩‍� [111, 9468, 239, 102, 102470, 9468, 235]

O: 🤞🏽 [9468, 97, 252, 9468, 237, 121]
N: �🧑🏽‍🤝‍🧑� [123, 9468, 100, 239, 9468, 237, 121, 102470, 9468, 97, 251, 102470, 9468, 100, 239, 9468, 237]

O: 👩‍🍳 [9468, 239, 102, 102470, 9468, 235, 111]
N: ️🕵️‍♂ [31643, 9468, 243, 113, 31643, 102470, 17245, 224]

O: 🤫 [9468, 97, 104]
N: �� [103, 9468, 234]

O: 🦬 [9468, 57923]
N: �🧎🏾‍♂‍� [94, 9468, 100, 236, 9468, 237, 122, 102470, 17245, 224, 102470, 98115]

O: 🧑🏽‍🤝‍🧑🏿 [9468, 100, 239, 9468, 237, 121, 102470, 9468, 97, 251, 102470, 9468, 100, 239, 9468, 237, 123]
N: �👩🏾‍❤️‍👩� [121, 9468, 239, 102, 9468, 237, 122, 102470, 121643, 31643, 102470, 9468, 239, 102, 9468, 237]

O: 👮🏿 [9468, 239, 106, 9468, 237, 123]
N: �👮� [123, 9468, 239, 106, 9468, 237]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.92s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.35s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.16s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.01s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.52s/it]
Processing depth (1, 3, 5, 7):   4%|▍         | 4/100 [01:34<32:11, 20.12s/it]2025-01-22 05:33:32.523 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra journeyed to the hallway.
2025-01-22 05:33:32.527 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (827, 833) --> . Sandra journeyed to the
2025-01-22 05:33:32.528 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the garden.
2025-01-22 05:33:32.546 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2896, 2901) --> . Sandra moved to the
2025-01-22 05:33:32.547 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra put down the football there.
2025-01-22 05:33:32.570 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4124, 4130) --> . Sandra put down the football
2025-01-22 05:33:32.570 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel went to the office.
2025-01-22 05:33:32.593 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2977, 2982) -->  back to the office.
2025-01-22 05:33:32.594 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the kitchen.
2025-01-22 05:33:32.626 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6265, 6270) --> . John travelled to the
2025-01-22 05:33:32.627 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the office.
2025-01-22 05:33:32.642 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2975, 2981) -->  John went back to the office
2025-01-22 05:33:32.642 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary moved to the bedroom.
2025-01-22 05:33:32.659 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3516, 3521) --> . Mary moved to the
2025-01-22 05:33:32.660 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary grabbed the football.
2025-01-22 05:33:32.677 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3281, 3285) -->  grabbed the football.
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:33:33.453 | INFO     | test_jbb_embedding:begin_test:693 - bedroom<|eot_id|>
2025-01-22 05:33:33.454 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8181])
2025-01-22 05:33:35.710 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [250.25, 22.47710089809384, 163.36875, 21.51556359002702, 31.076510416666668], 'topk_indices': array([8069, 8170, 4129, 8171, 8166,    1,    3, 8162,   14, 8163, 8164,
       8172, 3521, 3283, 8168,  833, 8177, 8169, 8176,    0]), 'topk_tokens': ['.\n\n', ' the', ' football', ' garden', ' was', '<|start_header_id|>', '<|end_header_id|>', '.\n\n', '\n', 'Question', ':', '?', ' bedroom', ' football', ' football', ' hallway', '<|start_header_id|>', ' before', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [329.8333333333333, 310.6, 250.75, 93.8]}, 'weight': {'score': [21.534801136363637, 23.276807261119256, 21.430078125, 23.286050532731515, 28.974375], 'topk_indices': array([3377, 3350, 3247, 3199, 7466, 7428, 1424, 1486, 4378, 4362, 5234,
       5173, 7205, 7149, 3565, 3539, 5027, 4998, 4975, 4950]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.213541666666668, 21.040625, 24.924479166666668, 18.346875]}, 'saliency': {'score': [1.4730002663352273, 0.1275956647020864, 0.9208251953125, 0.12201184109018054, 0.2272906494140625], 'topk_indices': array([3281, 3469, 2898, 8174, 8162, 2901, 8172, 8079,  829, 8165, 2897,
       8171, 4129,  828, 8163, 3283, 3521, 8169, 8168,  833]), 'topk_tokens': [' grabbed', 'nes', ' moved', 'Answer', '.\n\n', ' garden', '?', ' location', ' journey', ' Where', ' Sandra', ' garden', ' football', ' Sandra', 'Question', ' football', ' bedroom', ' before', ' football', ' hallway'], 'evidence_proportions': [1.918212890625, 1.74267578125, 1.670654296875, 0.431884765625]}}, 'pred_res': 'bedroom<|eot_id|>', 'score': 0}
2025-01-22 05:33:35.735 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:33:35.745 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-64_pid-4_1-3-5-7.pkl | len: 3 |  size: 2.06 KB
Processing depth (1, 3, 5, 7):   5%|▌         | 5/100 [01:37<31:16, 19.75s/it]Processing depth (1, 3, 5, 7):   5%|▌         | 5/100 [01:37<31:01, 19.59s/it]
2025-01-22 05:33:35.836 | INFO     | __main__:<module>:82 - Selected idx: 65
2025-01-22 05:33:35.836 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the location prior to the place where the apple was discarded, left or dropped?
2025-01-22 05:33:35.836 | INFO     | __main__:<module>:84 - Answer: hallway
2025-01-22 05:33:35.836 | INFO     | __main__:<module>:85 - Tag: 4-hop
2025-01-22 05:33:35.836 | INFO     | __main__:<module>:86 - Needle: [' Mary grabbed the football.', ' Sandra journeyed to the hallway.', ' Sandra took the apple.', ' John went back to the office.', ' Sandra moved to the garden.', ' John travelled to the kitchen.', ' Mary moved to the bedroom.', ' Sandra put down the apple there.', ' Daniel went to the office.']
2025-01-22 05:33:35.836 | INFO     | __main__:<module>:87 - Real Needle: [' Sandra journeyed to the hallway.', ' Sandra took the apple.', ' Sandra moved to the garden.', ' Sandra put down the apple there.', ' Daniel went to the office.']
2025-01-22 05:33:35.836 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['🚣🏼\u200d♀️', '👮🏿\u200d♀', '🫒', '🦹🏾\u200d♂', '🇿🇦', '👨🏻\u200d🦳', '🧖🏽', '🧕', '👨\u200d👩\u200d👧\u200d👧', '🦵🏽']
emoji:
O: 🚣🏼‍♀️ [9468, 248, 96, 9468, 237, 120, 102470, 32990, 31643]
N: 🦹🏾‍♂ [9468, 99, 117, 9468, 237, 122, 102470, 17245, 224]

O: 👮🏿‍♀ [9468, 239, 106, 9468, 237, 123, 102470, 32990]
N: 👨‍👩‍👧‍👧 [9468, 239, 101, 102470, 9468, 239, 102, 102470, 9468, 239, 100, 102470, 9468, 239, 100]

O: 🫒 [9468, 104, 240]
N: 🧕 [9468, 100, 243]

O: 🦹🏾‍♂ [9468, 99, 117, 9468, 237, 122, 102470, 17245, 224]
N: 👮🏿‍♀ [9468, 239, 106, 9468, 237, 123, 102470, 32990]

O: 🇿🇦 [9468, 229, 123, 9468, 229, 99]
N: 🇿🇦 [9468, 229, 123, 9468, 229, 99]

O: 👨🏻‍🦳 [9468, 239, 101, 9468, 237, 119, 102470, 9468, 99, 111]
N: 🧖🏽 [9468, 100, 244, 9468, 237, 121]

O: 🧖🏽 [9468, 100, 244, 9468, 237, 121]
N: 🫒 [9468, 104, 240]

O: 🧕 [9468, 100, 243]
N: 👨🏻‍🦳 [9468, 239, 101, 9468, 237, 119, 102470, 9468, 99, 111]

O: 👨‍👩‍👧‍👧 [9468, 239, 101, 102470, 9468, 239, 102, 102470, 9468, 239, 100, 102470, 9468, 239, 100]
N: 🚣🏼‍♀️ [9468, 248, 96, 9468, 237, 120, 102470, 32990, 31643]

O: 🦵🏽 [9468, 99, 113, 9468, 237, 121]
N: 🦵🏽 [9468, 99, 113, 9468, 237, 121]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.51s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.71s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.39s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.83s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.45s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (4, 5, 7, 8, 9):   0%|          | 0/100 [00:15<?, ?it/s]2025-01-22 05:33:51.457 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra journeyed to the hallway.
2025-01-22 05:33:51.475 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3609, 3615) -->  Hon. Sandra journeyed to
2025-01-22 05:33:51.475 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra took the apple.
2025-01-22 05:33:51.495 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4144, 4148) -->  Sandra took the apple
2025-01-22 05:33:51.495 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the garden.
2025-01-22 05:33:51.522 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5578, 5583) --> . Sandra moved to the
2025-01-22 05:33:51.522 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra put down the apple there.
2025-01-22 05:33:51.554 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6539, 6545) --> . Sandra put down the apple
2025-01-22 05:33:51.555 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel went to the office.
2025-01-22 05:33:51.567 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (2404, 2409) -->  back to the office.
2025-01-22 05:33:51.567 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the football.
2025-01-22 05:33:51.598 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6491, 6495) -->  Mary grabbed the football
2025-01-22 05:33:51.598 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the office.
2025-01-22 05:33:51.610 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2401, 2407) --> . John went back to the
2025-01-22 05:33:51.610 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the kitchen.
2025-01-22 05:33:51.641 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6252, 6257) --> . John travelled to the
2025-01-22 05:33:51.641 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the bedroom.
2025-01-22 05:33:51.674 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6676, 6681) --> . Mary moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:33:53.843 | INFO     | test_jbb_embedding:begin_test:693 - the garden<|eot_id|>
2025-01-22 05:33:53.843 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8201])
2025-01-22 05:33:56.568 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [275.7998798076923, 19.251346523037544, 84.54921875, 18.27362902978671, 12.829439603365385], 'topk_indices': array([8180, 8090,   14, 3610, 6544, 8188, 7566, 7522, 4148,   24, 4147,
       7567, 3611, 6545, 3612, 3613, 8196, 3616,    0, 8197]), 'topk_tokens': [' prior', ' location', '\n', '.', ' apple', ' discarded', ' Min', 'nes', '.', '\n\n', ' apple', 'nes', ' Sandra', ' there', ' journey', 'ed', '<|eot_id|>', ' hallway', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [516.4583333333334, 311.0, 162.425, 291.8125, 53.009375]}, 'weight': {'score': [23.411658653846153, 23.29643885604583, 21.583203125, 23.300271780767346, 29.82411858974359], 'topk_indices': array([3299, 3272, 3144, 3192, 7421, 7459, 1479, 1417, 4313, 4329, 5160,
       5221, 7192, 7136, 3481, 3455, 4937, 4962, 4985, 5014]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [25.220052083333332, 27.982421875, 21.040625, 24.752604166666668, 18.346875]}, 'saliency': {'score': [1.7825270432692308, 0.10873136329743875, 0.516839599609375, 0.10239637280889924, 0.0946516379331931], 'topk_indices': array([6542, 8184, 6494, 5579, 6681, 8186, 8090, 4144, 8180, 7522, 7566,
       6544, 7567, 6545, 4147, 8188, 3613, 3611, 3612, 3616]), 'topk_tokens': [' down', ' where', ' football', ' Sandra', ' bedroom', ' apple', ' location', ' Sandra', ' prior', 'nes', ' Min', ' apple', 'nes', ' there', ' apple', ' discarded', 'ed', ' Sandra', ' journey', ' hallway'], 'evidence_proportions': [3.27099609375, 2.306640625, 1.015087890625, 1.8797200520833333, 0.227880859375]}}, 'pred_res': 'the garden<|eot_id|>', 'score': 0}
2025-01-22 05:33:56.575 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:33:56.575 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-65_pid-0_4-5-7-8-9.pkl | len: 3 |  size: 2.07 KB
Processing depth (4, 5, 7, 8, 9):   1%|          | 1/100 [00:20<34:03, 20.64s/it]is_0k: False
your chose emoji: ['💁🏾\u200d♀️', '⛹🏿\u200d♀', '🕥', '🙅🏿\u200d♀️', '📑', '⚰️', '🧖🏼\u200d♀️', '👩🏿\u200d❤\u200d💋\u200d👩🏼', '🧑🏾\u200d🏭', '👊🏽']
emoji:
O: 💁🏾‍♀️ [93273, 223, 9468, 237, 122, 102470, 32990, 31643]
N: 🧖🏼‍♀️ [9468, 100, 244, 9468, 237, 120, 102470, 32990, 31643]

O: ⛹🏿‍♀ [158, 249, 117, 9468, 237, 123, 102470, 32990]
N: ⛹🏿‍♀ [158, 249, 117, 9468, 237, 123, 102470, 32990]

O: 🕥 [9468, 243, 98]
N: 🕥 [9468, 243, 98]

O: 🙅🏿‍♀️ [9468, 247, 227, 9468, 237, 123, 102470, 32990, 31643]
N: 📑 [9468, 241, 239]

O: 📑 [9468, 241, 239]
N: ⚰️ [158, 248, 108, 31643]

O: ⚰️ [158, 248, 108, 31643]
N: 👩🏿‍❤‍💋‍👩🏼 [9468, 239, 102, 9468, 237, 123, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 120]

O: 🧖🏼‍♀️ [9468, 100, 244, 9468, 237, 120, 102470, 32990, 31643]
N: 🧑🏾‍🏭 [9468, 100, 239, 9468, 237, 122, 102470, 9468, 237, 255]

O: 👩🏿‍❤‍💋‍👩🏼 [9468, 239, 102, 9468, 237, 123, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 120]
N: 💁🏾‍♀️ [93273, 223, 9468, 237, 122, 102470, 32990, 31643]

O: 🧑🏾‍🏭 [9468, 100, 239, 9468, 237, 122, 102470, 9468, 237, 255]
N: 🙅🏿‍♀️ [9468, 247, 227, 9468, 237, 123, 102470, 32990, 31643]

O: 👊🏽 [9468, 239, 232, 9468, 237, 121]
N: 👊🏽 [9468, 239, 232, 9468, 237, 121]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.79s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  5.00s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.80s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.32s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.89s/it]
Processing depth (0, 2, 4, 6, 8):   1%|          | 1/100 [00:38<34:03, 20.64s/it]2025-01-22 05:34:14.032 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra journeyed to the hallway.
2025-01-22 05:34:14.032 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (32, 38) -->  journeyed to the hallway.
2025-01-22 05:34:14.033 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra took the apple.
2025-01-22 05:34:14.041 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1850, 1854) -->  Sandra took the apple
2025-01-22 05:34:14.042 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the garden.
2025-01-22 05:34:14.059 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3615, 3620) --> . Sandra moved to the
2025-01-22 05:34:14.060 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra put down the apple there.
2025-01-22 05:34:14.086 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4721, 4727) --> . Sandra put down the apple
2025-01-22 05:34:14.086 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel went to the office.
2025-01-22 05:34:14.100 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (2475, 2480) -->  back to the office.
2025-01-22 05:34:14.100 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the football.
2025-01-22 05:34:14.132 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6515, 6519) -->  Mary grabbed the football
2025-01-22 05:34:14.132 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the office.
2025-01-22 05:34:14.146 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2472, 2478) --> . John went back to the
2025-01-22 05:34:14.146 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the kitchen.
2025-01-22 05:34:14.178 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6300, 6305) --> . John travelled to the
2025-01-22 05:34:14.178 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the bedroom.
2025-01-22 05:34:14.213 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6681, 6686) --> . Mary moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:34:14.999 | INFO     | test_jbb_embedding:begin_test:693 - the garden<|eot_id|>
2025-01-22 05:34:14.999 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8208])
2025-01-22 05:34:17.234 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [1303.1802884615386, 103.90457922299355, 192.034375, 99.86982547458665, 34.61762152777778], 'topk_indices': array([1704, 1596, 1702, 1689, 1705,  549, 1679,  432, 1633,  433,   33,
         32, 1712,   34, 1634, 1635,  673, 1713,   36,    0]), 'topk_tokens': [' of', ' time', '\n', 'in', ' the', ' to', ',', ' to', ' summer', ' ', 'ed', ' journey', ' summer', ' to', "'s", ' work', ' stere', "'s", ' hallway', '<|begin_of_text|>'], 'evidence_proportions': [3712.1666666666665, 781.875, 501.55, 813.5416666666666, 218.6375]}, 'weight': {'score': [22.501502403846153, 23.289042519181585, 21.583203125, 23.29572872014697, 29.250771604938272], 'topk_indices': array([3299, 3326, 3207, 3159, 7476, 7438, 1413, 1475, 4320, 4304, 5187,
       5126, 7177, 7121, 3482, 3508, 4903, 4928, 4951, 4980]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.276041666666668, 27.982421875, 21.040625, 24.752604166666668, 18.346875]}, 'saliency': {'score': [8.168438251201923, 0.580499268321459, 1.1199462890625, 0.5550154527709736, 0.24577501085069445], 'topk_indices': array([1674, 1655,   34, 8195, 1596, 8053, 1648, 1649,  556,   33, 1627,
         31, 1634, 1633, 1635,   32, 1712, 1713,  673,   36]), 'topk_tokens': [' some', 'nes', ' to', ' discarded', ' time', ' context', ' const', 'ern', ' per', 'ed', ' courts', 'andra', "'s", ' summer', ' work', ' journey', ' summer', "'s", ' stere', ' hallway'], 'evidence_proportions': [23.700520833333332, 5.68896484375, 2.6716796875, 4.88330078125, 0.95244140625]}}, 'pred_res': 'the garden<|eot_id|>', 'score': 0}
2025-01-22 05:34:17.240 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:34:17.241 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-65_pid-1_0-2-4-6-8.pkl | len: 3 |  size: 2.01 KB
Processing depth (0, 2, 4, 6, 8):   2%|▏         | 2/100 [00:41<33:44, 20.66s/it]is_0k: False
your chose emoji: ['🍿', '🏵', '👨🏾\u200d🦱', '🧑🏽\u200d🍳', '💎', '👩🏿\u200d❤️\u200d💋\u200d👨🏾', '🇨🇺', '🧑🏾\u200d✈', '👩🏻\u200d💼', '🧑🏿\u200d🚀']
emoji:
O: 🍿 [9468, 235, 123]
N: �� [113, 9468, 237]

O: 🏵 [9468, 237, 113]
N: �🧑🏾‍� [230, 9468, 100, 239, 9468, 237, 122, 102470, 38798]

O: 👨🏾‍🦱 [9468, 239, 101, 9468, 237, 122, 102470, 9468, 99, 109]
N: �👩🏻‍� [120, 9468, 239, 102, 9468, 237, 119, 102470, 93273]

O: 🧑🏽‍🍳 [9468, 100, 239, 9468, 237, 121, 102470, 9468, 235, 111]
N: �🇨� [118, 9468, 229, 101, 9468, 229]

O: 💎 [93273, 236]
N: �🧑🏽‍� [111, 9468, 100, 239, 9468, 237, 121, 102470, 9468, 235]

O: 👩🏿‍❤️‍💋‍👨🏾 [9468, 239, 102, 9468, 237, 123, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 122]
N: �� [236, 93273]

O: 🇨🇺 [9468, 229, 101, 9468, 229, 118]
N: �👨🏾‍� [109, 9468, 239, 101, 9468, 237, 122, 102470, 9468, 99]

O: 🧑🏾‍✈ [9468, 100, 239, 9468, 237, 122, 102470, 38798, 230]
N: �� [123, 9468, 235]

O: 👩🏻‍💼 [9468, 239, 102, 9468, 237, 119, 102470, 93273, 120]
N: �👩🏿‍❤️‍💋‍👨� [122, 9468, 239, 102, 9468, 237, 123, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237]

O: 🧑🏿‍🚀 [9468, 100, 239, 9468, 237, 123, 102470, 9468, 248, 222]
N: �🧑🏿‍� [222, 9468, 100, 239, 9468, 237, 123, 102470, 9468, 248]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:11,  3.96s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.44s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.11s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.76s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.29s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 2, 3, 7, 9):   2%|▏         | 2/100 [00:56<33:44, 20.66s/it]2025-01-22 05:34:32.146 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra journeyed to the hallway.
2025-01-22 05:34:32.147 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (32, 38) -->  journeyed to the hallway.
2025-01-22 05:34:32.147 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra took the apple.
2025-01-22 05:34:32.156 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1803, 1807) -->  took the apple.
2025-01-22 05:34:32.156 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the garden.
2025-01-22 05:34:32.170 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2895, 2900) --> . Sandra moved to the
2025-01-22 05:34:32.171 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra put down the apple there.
2025-01-22 05:34:32.199 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5721, 5727) --> . Sandra put down the apple
2025-01-22 05:34:32.200 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel went to the office.
2025-01-22 05:34:32.211 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (2225, 2230) -->  back to the office.
2025-01-22 05:34:32.211 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the football.
2025-01-22 05:34:32.242 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6601, 6605) -->  Mary grabbed the football
2025-01-22 05:34:32.243 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the office.
2025-01-22 05:34:32.254 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2222, 2228) --> . John went back to the
2025-01-22 05:34:32.254 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the kitchen.
2025-01-22 05:34:32.289 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6386, 6391) --> . John travelled to the
2025-01-22 05:34:32.289 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the bedroom.
2025-01-22 05:34:32.333 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6684, 6689) -->  Mary moved to the bedroom
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:34:35.338 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 05:34:35.339 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8208])
2025-01-22 05:34:38.214 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [612.3521634615385, 46.28213296188041, 115.5015625, 44.31003138395591, 55.59912712191358], 'topk_indices': array([8188, 5723,   25, 5724,   36, 7407, 7364, 5727, 1805, 7365, 7413,
       7415, 1806, 8204, 7368, 8203, 7367, 2918,    0, 7416]), 'topk_tokens': [' to', ' put', '<|eot_id|>', ' down', ' hallway', ' the', ' set', ' there', ' apple', ' up', ' set', ' the', '.', '<|start_header_id|>', 'graph', '<|eot_id|>', ' tele', ' lyn', '<|begin_of_text|>', ' tele'], 'evidence_proportions': [700.4583333333334, 995.375, 511.3, 783.9583333333334, 95.33125]}, 'weight': {'score': [21.34375, 23.29615759347217, 22.93984375, 23.30324747397428, 29.611496913580247], 'topk_indices': array([3318, 3291, 3163, 3211, 7440, 7478, 1481, 1419, 4292, 4276, 5148,
       5087, 7211, 7155, 3500, 3474, 4941, 4889, 4864, 4912]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.276041666666668, 20.45703125, 21.040625, 24.752604166666668, 18.346875]}, 'saliency': {'score': [3.5219280536358175, 0.2641140398074991, 0.7050323486328125, 0.2526600862819581, 0.40752213089554395], 'topk_indices': array([ 187, 1803, 4148, 5724, 5727, 7365, 5723,   32, 5726, 8195, 7364,
       5722, 7413, 1802, 1805,   36, 7368, 7367, 2918, 7416]), 'topk_tokens': ['ION', ' took', ' head', ' down', ' there', ' up', ' put', ' journey', ' apple', ' discarded', ' set', ' Sandra', ' set', ' Sandra', ' apple', ' hallway', 'graph', ' tele', ' lyn', ' tele'], 'evidence_proportions': [4.227701822916667, 4.970947265625, 2.6197265625, 5.195149739583333, 0.41011962890625]}}, 'pred_res': 'The garden.<|eot_id|>', 'score': 0}
2025-01-22 05:34:38.227 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:34:38.227 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-65_pid-2_0-2-3-7-9.pkl | len: 3 |  size: 2.06 KB
Processing depth (0, 2, 3, 7, 9):   3%|▎         | 3/100 [01:02<33:38, 20.81s/it]is_0k: False
your chose emoji: ['👩🏽\u200d❤️\u200d💋\u200d👩🏻', '🩴', '💁\u200d♀️', '💁🏽\u200d♂️', '👩🏿\u200d🦲', '🤶🏾', '🇮🇪', '👨🏾\u200d🦯\u200d➡️', '🏿', '🤽🏾']
emoji:
O: 👩🏽‍❤️‍💋‍👩🏻 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 119]
N: �🤶� [122, 9468, 97, 114, 9468, 237]

O: 🩴 [9468, 102, 112]
N: ️💁🏽‍♂ [31643, 93273, 223, 9468, 237, 121, 102470, 17245, 224]

O: 💁‍♀️ [93273, 223, 102470, 32990, 31643]
N: ️💁‍♀ [31643, 93273, 223, 102470, 32990]

O: 💁🏽‍♂️ [93273, 223, 9468, 237, 121, 102470, 17245, 224, 31643]
N: �� [112, 9468, 102]

O: 👩🏿‍🦲 [9468, 239, 102, 9468, 237, 123, 102470, 9468, 99, 110]
N: ️👨🏾‍🦯‍➡ [31643, 9468, 239, 101, 9468, 237, 122, 102470, 9468, 99, 107, 102470, 98115, 94]

O: 🤶🏾 [9468, 97, 114, 9468, 237, 122]
N: �🇮� [103, 9468, 229, 106, 9468, 229]

O: 🇮🇪 [9468, 229, 106, 9468, 229, 103]
N: �👩🏿‍� [110, 9468, 239, 102, 9468, 237, 123, 102470, 9468, 99]

O: 👨🏾‍🦯‍➡️ [9468, 239, 101, 9468, 237, 122, 102470, 9468, 99, 107, 102470, 98115, 94, 31643]
N: �👩🏽‍❤️‍💋‍👩� [119, 9468, 239, 102, 9468, 237, 121, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237]

O: 🏿 [9468, 237, 123]
N: �� [123, 9468, 237]

O: 🤽🏾 [9468, 97, 121, 9468, 237, 122]
N: �🤽� [122, 9468, 97, 121, 9468, 237]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.65s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:08,  4.48s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.49s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.12s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.63s/it]
Processing depth (2, 3, 5, 7, 9):   3%|▎         | 3/100 [01:18<33:38, 20.81s/it]2025-01-22 05:34:54.636 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra journeyed to the hallway.
2025-01-22 05:34:54.646 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1998, 2004) -->  cable. Sandra journeyed to
2025-01-22 05:34:54.647 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra took the apple.
2025-01-22 05:34:54.661 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2996, 3000) -->  Sandra took the apple
2025-01-22 05:34:54.661 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the garden.
2025-01-22 05:34:54.682 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4219, 4224) -->  Sandra moved to the garden
2025-01-22 05:34:54.683 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra put down the apple there.
2025-01-22 05:34:54.711 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5706, 5712) --> . Sandra put down the apple
2025-01-22 05:34:54.712 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel went to the office.
2025-01-22 05:34:54.724 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (2495, 2500) -->  back to the office.
2025-01-22 05:34:54.724 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the football.
2025-01-22 05:34:54.757 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6606, 6610) -->  Mary grabbed the football
2025-01-22 05:34:54.757 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the office.
2025-01-22 05:34:54.770 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2492, 2498) --> . John went back to the
2025-01-22 05:34:54.770 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the kitchen.
2025-01-22 05:34:54.802 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6387, 6392) --> . John travelled to the
2025-01-22 05:34:54.802 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the bedroom.
2025-01-22 05:34:54.838 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6680, 6685) --> . Mary moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:34:55.811 | INFO     | test_jbb_embedding:begin_test:693 - Sandra put down the apple there.<|eot_id|>
2025-01-22 05:34:55.811 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8167])
2025-01-22 05:34:58.035 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [167.83834134615384, 13.43422582619339, 51.66796875, 12.845946424175283, 11.726114241803279], 'topk_indices': array([5709, 8152, 8146, 8056, 8159, 3000, 8154, 8147, 5707, 8141, 5711,
       5712, 8046,   14,   28,   24,    3,    0, 8162, 8163]), 'topk_tokens': [' down', ' apple', ' prior', ' location', '?\n', '.', ' discarded', ' to', ' Sandra', ':', ' apple', ' there', '.\n\n', '\n', '<|end_header_id|>', '\n\n', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [159.88541666666666, 176.109375, 111.0125, 309.9166666666667, 57.096875]}, 'weight': {'score': [24.20643028846154, 23.261457695838434, 21.583203125, 23.262565008000983, 29.300717213114755], 'topk_indices': array([3276, 3303, 3196, 3148, 7443, 7405, 1399, 1461, 4287, 4271, 5094,
       5155, 7182, 7126, 3459, 3485, 4859, 4936, 4907, 4884]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [24.90234375, 27.982421875, 25.5546875, 24.752604166666668, 18.346875]}, 'saliency': {'score': [1.0948697603665865, 0.07244007199309593, 0.290869140625, 0.0686301565240722, 0.08774228955878587], 'topk_indices': array([8139, 8164, 8159, 8160, 2001, 5709, 8046, 5708,   24, 8056, 8140,
       5712, 2999, 8152, 8146, 2005, 2000, 5711, 8154, 5707]), 'topk_tokens': ['.\n\n', 'assistant', '?\n', 'Answer', ' journey', ' down', '.\n\n', ' put', '\n\n', ' location', 'Question', ' there', ' apple', ' apple', ' prior', ' hallway', ' Sandra', ' apple', ' discarded', ' Sandra'], 'evidence_proportions': [1.0615030924479167, 1.271240234375, 0.74296875, 2.0033365885416665, 0.25555419921875]}}, 'pred_res': 'Sandra put down the apple there.<|eot_id|>', 'score': 0}
2025-01-22 05:34:58.043 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:34:58.044 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-65_pid-3_2-3-5-7-9.pkl | len: 3 |  size: 2.11 KB
Processing depth (2, 3, 5, 7, 9):   4%|▍         | 4/100 [01:22<32:39, 20.42s/it]is_0k: False
your chose emoji: ['🏋\u200d♂️', '🩺', '🤱🏾', '👩🏽\u200d❤️\u200d👩🏿', '☪', '🤽🏼\u200d♂', '👆🏻', '🖕', '\U0001faf7', '🤱🏿']
emoji:
O: 🏋‍♂️ [9468, 237, 233, 102470, 17245, 224, 31643]
N: 👩🏽‍❤️‍👩🏿 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 31643, 102470, 9468, 239, 102, 9468, 237, 123]

O: 🩺 [9468, 102, 118]
N: 🩺 [9468, 102, 118]

O: 🤱🏾 [9468, 97, 109, 9468, 237, 122]
N: ☪ [18107, 103]

O: 👩🏽‍❤️‍👩🏿 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 31643, 102470, 9468, 239, 102, 9468, 237, 123]
N: 🤱🏾 [9468, 97, 109, 9468, 237, 122]

O: ☪ [18107, 103]
N: 🫷 [9468, 104, 115]

O: 🤽🏼‍♂ [9468, 97, 121, 9468, 237, 120, 102470, 17245, 224]
N: 👆🏻 [9468, 239, 228, 9468, 237, 119]

O: 👆🏻 [9468, 239, 228, 9468, 237, 119]
N: 🏋‍♂️ [9468, 237, 233, 102470, 17245, 224, 31643]

O: 🖕 [9468, 244, 243]
N: 🖕 [9468, 244, 243]

O: 🫷 [9468, 104, 115]
N: 🤽🏼‍♂ [9468, 97, 121, 9468, 237, 120, 102470, 17245, 224]

O: 🤱🏿 [9468, 97, 109, 9468, 237, 123]
N: 🤱🏿 [9468, 97, 109, 9468, 237, 123]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.46s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.28s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.27s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.03s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.50s/it]
Processing depth (2, 4, 6, 8, 9):   4%|▍         | 4/100 [01:37<32:39, 20.42s/it]2025-01-22 05:35:13.900 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra journeyed to the hallway.
2025-01-22 05:35:13.909 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1791, 1797) --> . Sandra journeyed to the
2025-01-22 05:35:13.910 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra took the apple.
2025-01-22 05:35:13.928 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3556, 3560) -->  Sandra took the apple
2025-01-22 05:35:13.928 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the garden.
2025-01-22 05:35:13.955 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4610, 4615) --> . Sandra moved to the
2025-01-22 05:35:13.955 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra put down the apple there.
2025-01-22 05:35:13.989 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6505, 6511) --> . Sandra put down the apple
2025-01-22 05:35:13.989 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel went to the office.
2025-01-22 05:35:14.003 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (2405, 2410) -->  back to the office.
2025-01-22 05:35:14.003 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the football.
2025-01-22 05:35:14.037 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6457, 6461) -->  Mary grabbed the football
2025-01-22 05:35:14.037 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the office.
2025-01-22 05:35:14.050 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2402, 2408) --> . John went back to the
2025-01-22 05:35:14.050 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the kitchen.
2025-01-22 05:35:14.080 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6218, 6223) --> . John travelled to the
2025-01-22 05:35:14.080 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the bedroom.
2025-01-22 05:35:14.114 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6642, 6647) --> . Mary moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:35:14.895 | INFO     | test_jbb_embedding:begin_test:693 - the garden<|eot_id|>
2025-01-22 05:35:14.895 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8161])
2025-01-22 05:35:17.109 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [185.14903846153845, 16.161048122856442, 89.4453125, 15.439272681079084, 12.622642780172415], 'topk_indices': array([8144, 8147, 8146, 6510, 8133, 8135, 1792, 3559, 8040, 8141, 8148,
          1, 8140,    3,   14,   24, 1797,    0, 8156, 8157]), 'topk_tokens': [' where', ' was', ' apple', ' apple', '.\n\n', ':', ' Sandra', ' apple', '.\n\n', ' to', ' discarded', '<|start_header_id|>', ' prior', '<|end_header_id|>', '\n', '\n\n', ' hallway', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [263.6875, 228.40625, 121.45, 236.8125, 58.0]}, 'weight': {'score': [22.487079326923077, 23.25312921055855, 21.583203125, 23.259696815718158, 29.026939655172413], 'topk_indices': array([3273, 3300, 3145, 3193, 7425, 7387, 1489, 1427, 4291, 4307, 5114,
       5175, 7158, 7102, 3474, 3500, 4891, 4939, 4968, 4916]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.213541666666668, 27.982421875, 21.040625, 24.752604166666668, 18.346875]}, 'saliency': {'score': [1.1391085111177885, 0.08898519079571901, 0.54622802734375, 0.08449540722102888, 0.0917950334220097], 'topk_indices': array([6508, 8040, 8154, 6511, 3511, 3556,   24, 8134, 8144, 1793, 8050,
       6647, 8146, 6510, 6460, 3559, 8140, 1792, 8148, 1797]), 'topk_tokens': [' down', '.\n\n', 'Answer', ' there', ' Ramsey', ' Sandra', '\n\n', 'Question', ' where', ' journey', ' location', ' bedroom', ' apple', ' apple', ' football', ' apple', ' prior', ' Sandra', ' discarded', ' hallway'], 'evidence_proportions': [1.5514322916666667, 1.6663818359375, 0.6648681640625, 1.5125732421875, 0.248583984375]}}, 'pred_res': 'the garden<|eot_id|>', 'score': 0}
2025-01-22 05:35:17.118 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:35:17.118 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-65_pid-4_2-4-6-8-9.pkl | len: 3 |  size: 2.1 KB
Processing depth (2, 4, 6, 8, 9):   5%|▌         | 5/100 [01:41<31:33, 19.93s/it]Processing depth (2, 4, 6, 8, 9):   5%|▌         | 5/100 [01:41<32:04, 20.26s/it]
2025-01-22 05:35:17.235 | INFO     | __main__:<module>:82 - Selected idx: 66
2025-01-22 05:35:17.235 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the milk before the garden? 
2025-01-22 05:35:17.235 | INFO     | __main__:<module>:84 - Answer: bathroom
2025-01-22 05:35:17.235 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 05:35:17.235 | INFO     | __main__:<module>:86 - Needle: [' John picked up the milk.', ' Sandra went to the garden.', ' Sandra went to the bathroom.', ' John journeyed to the bathroom.', ' Mary moved to the bedroom.', ' John travelled to the garden.', ' Mary grabbed the football.']
2025-01-22 05:35:17.235 | INFO     | __main__:<module>:87 - Real Needle: [' John picked up the milk.', ' John journeyed to the bathroom.', ' John travelled to the garden.', ' Mary grabbed the football.']
2025-01-22 05:35:17.235 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['🤽🏿\u200d♀', '🇮🇹', '👨🏾\u200d🦽', '🦯', '🤽🏼\u200d♀', '💆🏽\u200d♂️', '🇸🇮', '🏀', '⏯', '💬']
emoji:
O: 🤽🏿‍♀ [9468, 97, 121, 9468, 237, 123, 102470, 32990]
N: 🇮🇹 [9468, 229, 106, 9468, 229, 117]

O: 🇮🇹 [9468, 229, 106, 9468, 229, 117]
N: 🤽🏼‍♀ [9468, 97, 121, 9468, 237, 120, 102470, 32990]

O: 👨🏾‍🦽 [9468, 239, 101, 9468, 237, 122, 102470, 9468, 99, 121]
N: ⏯ [158, 237, 107]

O: 🦯 [9468, 99, 107]
N: 🦯 [9468, 99, 107]

O: 🤽🏼‍♀ [9468, 97, 121, 9468, 237, 120, 102470, 32990]
N: 🇸🇮 [9468, 229, 116, 9468, 229, 106]

O: 💆🏽‍♂️ [93273, 228, 9468, 237, 121, 102470, 17245, 224, 31643]
N: 🤽🏿‍♀ [9468, 97, 121, 9468, 237, 123, 102470, 32990]

O: 🇸🇮 [9468, 229, 116, 9468, 229, 106]
N: 🏀 [9468, 237, 222]

O: 🏀 [9468, 237, 222]
N: 💆🏽‍♂️ [93273, 228, 9468, 237, 121, 102470, 17245, 224, 31643]

O: ⏯ [158, 237, 107]
N: 👨🏾‍🦽 [9468, 239, 101, 9468, 237, 122, 102470, 9468, 99, 121]

O: 💬 [93273, 105]
N: 💬 [93273, 105]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.06s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.24s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.06s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.93s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.37s/it]
Processing depth (1, 3, 7, 8):   0%|          | 0/100 [00:15<?, ?it/s]2025-01-22 05:35:32.433 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John picked up the milk.
2025-01-22 05:35:32.438 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (805, 810) --> . John picked up the
2025-01-22 05:35:32.438 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bathroom.
2025-01-22 05:35:32.452 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2858, 2864) -->  John journeyed to the bathroom
2025-01-22 05:35:32.452 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the garden.
2025-01-22 05:35:32.481 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5594, 5599) --> . John travelled to the
2025-01-22 05:35:32.481 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary grabbed the football.
2025-01-22 05:35:32.513 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6551, 6555) -->  Mary grabbed the football
2025-01-22 05:35:32.514 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went to the garden.
2025-01-22 05:35:32.542 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5698, 5703) --> . Sandra went to the
2025-01-22 05:35:32.543 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went to the bathroom.
2025-01-22 05:35:32.571 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5698, 5703) --> . Sandra went to the
2025-01-22 05:35:32.571 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary moved to the bedroom.
2025-01-22 05:35:32.596 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4894, 4899) --> . Mary moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:35:33.489 | INFO     | test_jbb_embedding:begin_test:693 - John picked up the milk.<|eot_id|>
2025-01-22 05:35:33.489 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8199])
2025-01-22 05:35:35.735 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [231.55703125, 19.633721196049745, 127.04583333333333, 18.91746701665238, 19.299627130681817], 'topk_indices': array([8181, 8182, 8188, 8097, 8052, 8180, 8184, 8186,  811,    9, 8190,
         24, 8189,   14, 8053, 8187, 8197, 8194,    0, 8195]), 'topk_tokens': ['Question', ':', ' the', ' location', ' you', '.\n\n', ' was', ' milk', '.', ':', '?', '\n\n', ' garden', '\n', ' context', ' before', '<|end_header_id|>', '<|eot_id|>', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [337.25, 278.1875, 207.75, 59.25390625]}, 'weight': {'score': [23.23046875, 23.30082982809071, 20.413541666666667, 23.306305099791846, 29.281605113636363], 'topk_indices': array([3322, 3349, 3194, 3242, 7492, 7454, 1521, 1459, 4337, 4321, 5176,
       5237, 7195, 7139, 3505, 3531, 4953, 4978, 5001, 5030]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.334375, 24.154947916666668, 19.990625, 28.263671875]}, 'saliency': {'score': [1.391033935546875, 0.10841486832479882, 0.6695271809895833, 0.10424331622067085, 0.144142671064897], 'topk_indices': array([8196, 8168, 8180, 8184, 5599,    8, 8052, 8051,  807, 8183,  810,
         24, 8190, 8097, 8181, 8186, 2863, 8189, 8053, 8187]), 'topk_tokens': ['assistant', ' return', '.\n\n', ' was', ' garden', ' Date', ' you', ' provided', ' picked', ' Where', ' milk', '\n\n', '?', ' location', 'Question', ' milk', ' bathroom', ' garden', ' context', ' before'], 'evidence_proportions': [1.86083984375, 1.9063313802083333, 1.0728515625, 0.428558349609375]}}, 'pred_res': 'John picked up the milk.<|eot_id|>', 'score': 0}
2025-01-22 05:35:35.756 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:35:35.757 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-66_pid-0_1-3-7-8.pkl | len: 3 |  size: 2.02 KB
Processing depth (1, 3, 7, 8):   1%|          | 1/100 [00:18<30:24, 18.43s/it]is_0k: False
your chose emoji: ['👨🏾\u200d🍳', '👩🏿\u200d❤️\u200d👨🏻', '🍶', '🧑\u200d🧑\u200d🧒\u200d🧒', '🧑🏾\u200d🎓', '🏼', '🤸🏿\u200d♂️', '👩🏿\u200d🤝\u200d👨🏼', '😛', '💣']
emoji:
O: 👨🏾‍🍳 [9468, 239, 101, 9468, 237, 122, 102470, 9468, 235, 111]
N: 👩🏿‍🤝‍👨🏼 [9468, 239, 102, 9468, 237, 123, 102470, 9468, 97, 251, 102470, 9468, 239, 101, 9468, 237, 120]

O: 👩🏿‍❤️‍👨🏻 [9468, 239, 102, 9468, 237, 123, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 119]
N: 🧑🏾‍🎓 [9468, 100, 239, 9468, 237, 122, 102470, 9468, 236, 241]

O: 🍶 [9468, 235, 114]
N: 😛 [76460, 249]

O: 🧑‍🧑‍🧒‍🧒 [9468, 100, 239, 102470, 9468, 100, 239, 102470, 9468, 100, 240, 102470, 9468, 100, 240]
N: 🤸🏿‍♂️ [9468, 97, 116, 9468, 237, 123, 102470, 17245, 224, 31643]

O: 🧑🏾‍🎓 [9468, 100, 239, 9468, 237, 122, 102470, 9468, 236, 241]
N: 🍶 [9468, 235, 114]

O: 🏼 [9468, 237, 120]
N: 👨🏾‍🍳 [9468, 239, 101, 9468, 237, 122, 102470, 9468, 235, 111]

O: 🤸🏿‍♂️ [9468, 97, 116, 9468, 237, 123, 102470, 17245, 224, 31643]
N: 🏼 [9468, 237, 120]

O: 👩🏿‍🤝‍👨🏼 [9468, 239, 102, 9468, 237, 123, 102470, 9468, 97, 251, 102470, 9468, 239, 101, 9468, 237, 120]
N: 👩🏿‍❤️‍👨🏻 [9468, 239, 102, 9468, 237, 123, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 119]

O: 😛 [76460, 249]
N: 🧑‍🧑‍🧒‍🧒 [9468, 100, 239, 102470, 9468, 100, 239, 102470, 9468, 100, 240, 102470, 9468, 100, 240]

O: 💣 [93273, 96]
N: 💣 [93273, 96]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.74s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.60s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.14s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.68s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.32s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (3, 5, 6, 9):   1%|          | 1/100 [00:33<30:24, 18.43s/it]2025-01-22 05:35:50.878 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John picked up the milk.
2025-01-22 05:35:50.893 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2863, 2868) --> . John picked up the
2025-01-22 05:35:50.893 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bathroom.
2025-01-22 05:35:50.914 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4058, 4064) -->  John journeyed to the bathroom
2025-01-22 05:35:50.914 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the garden.
2025-01-22 05:35:50.936 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4588, 4593) --> . John travelled to the
2025-01-22 05:35:50.937 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary grabbed the football.
2025-01-22 05:35:50.971 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7169, 7173) -->  Mary grabbed the football
2025-01-22 05:35:50.971 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went to the garden.
2025-01-22 05:35:50.999 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5704, 5709) --> . Sandra went to the
2025-01-22 05:35:51.000 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went to the bathroom.
2025-01-22 05:35:51.028 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5704, 5709) --> . Sandra went to the
2025-01-22 05:35:51.028 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary moved to the bedroom.
2025-01-22 05:35:51.053 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4848, 4853) --> . Mary moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:35:56.925 | INFO     | test_jbb_embedding:begin_test:693 - John picked up the milk.<|eot_id|>
2025-01-22 05:35:56.925 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8131])
2025-01-22 05:36:00.158 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [260.8703125, 19.164026001967052, 154.37083333333334, 18.316732775651314, 26.02850115740741], 'topk_indices': array([8019,    1, 8033, 8112, 2865, 8118, 8114,   24, 4063, 8113, 2869,
         14, 8122, 8029, 2868, 8121, 8119, 8129, 8126,    0]), 'topk_tokens': ['.\n\n', '<|start_header_id|>', ' the', '.\n\n', ' picked', ' milk', ':', '\n\n', ' bathroom', 'Question', '.', '\n', '?', ' location', ' milk', ' garden', ' before', '<|end_header_id|>', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [374.15, 335.6875, 226.05, 50.5703125]}, 'weight': {'score': [23.23046875, 23.2496215730268, 20.413541666666667, 23.254921518088654, 29.19068287037037], 'topk_indices': array([3279, 3306, 3189, 3141, 7384, 7346, 1411, 1473, 4291, 4275, 5098,
       5159, 7062, 7118, 3462, 3488, 4923, 4875, 4900, 4952]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.334375, 24.154947916666668, 19.990625, 28.263671875]}, 'saliency': {'score': [1.5611419677734375, 0.10679117338294504, 0.860888671875, 0.10180309110547985, 0.19017763491030093], 'topk_indices': array([2833, 8115,   24, 2866, 8112, 4593, 4590, 7856, 7985, 8031, 4059,
       8122, 2865, 8029, 8118, 8113, 2868, 4063, 8119, 8121]), 'topk_tokens': [' *', ' Where', '\n\n', ' up', '.\n\n', ' garden', ' travelled', ' Square', ' context', ' traveled', ' journey', '?', ' picked', ' location', ' milk', 'Question', ' milk', ' bathroom', ' before', ' garden'], 'evidence_proportions': [2.11728515625, 2.2335611979166665, 1.14453125, 0.3780975341796875]}}, 'pred_res': 'John picked up the milk.<|eot_id|>', 'score': 0}
2025-01-22 05:36:00.168 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:36:00.168 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-66_pid-1_3-5-6-9.pkl | len: 3 |  size: 2.03 KB
Processing depth (3, 5, 6, 9):   2%|▏         | 2/100 [00:42<35:50, 21.95s/it]is_0k: False
your chose emoji: ['🥷🏽', '🐪', '👶🏼', '💑🏼', '✝', '😮\u200d💨', '😗', '🍾', '🤵🏼', '👩🏻\u200d❤️\u200d👨🏽']
emoji:
O: 🥷🏽 [9468, 98, 115, 9468, 237, 121]
N: 🤵🏼 [9468, 97, 113, 9468, 237, 120]

O: 🐪 [9468, 238, 103]
N: 🥷🏽 [9468, 98, 115, 9468, 237, 121]

O: 👶🏼 [9468, 239, 114, 9468, 237, 120]
N: ✝ [38798, 251]

O: 💑🏼 [93273, 239, 9468, 237, 120]
N: 💑🏼 [93273, 239, 9468, 237, 120]

O: ✝ [38798, 251]
N: 😮‍💨 [76460, 106, 102470, 93273, 101]

O: 😮‍💨 [76460, 106, 102470, 93273, 101]
N: 🐪 [9468, 238, 103]

O: 😗 [76460, 245]
N: 😗 [76460, 245]

O: 🍾 [9468, 235, 122]
N: 👶🏼 [9468, 239, 114, 9468, 237, 120]

O: 🤵🏼 [9468, 97, 113, 9468, 237, 120]
N: 🍾 [9468, 235, 122]

O: 👩🏻‍❤️‍👨🏽 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 121]
N: 👩🏻‍❤️‍👨🏽 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 121]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:05<00:16,  5.43s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:10<00:10,  5.28s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.75s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.28s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.94s/it]
Processing depth (0, 5, 7, 8):   2%|▏         | 2/100 [01:00<35:50, 21.95s/it]2025-01-22 05:36:17.744 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John picked up the milk.
2025-01-22 05:36:17.744 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  picked up the milk.
2025-01-22 05:36:17.745 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bathroom.
2025-01-22 05:36:17.766 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4165, 4171) --> . John journeyed to the
2025-01-22 05:36:17.766 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the garden.
2025-01-22 05:36:17.796 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5622, 5627) --> . John travelled to the
2025-01-22 05:36:17.796 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary grabbed the football.
2025-01-22 05:36:17.831 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6579, 6583) -->  Mary grabbed the football
2025-01-22 05:36:17.832 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went to the garden.
2025-01-22 05:36:17.860 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5726, 5731) --> . Sandra went to the
2025-01-22 05:36:17.860 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went to the bathroom.
2025-01-22 05:36:17.890 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5726, 5731) --> . Sandra went to the
2025-01-22 05:36:17.890 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary moved to the bedroom.
2025-01-22 05:36:17.916 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4854, 4859) -->  the senate. Mary moved
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:36:18.767 | INFO     | test_jbb_embedding:begin_test:693 - John's house.<|eot_id|>
2025-01-22 05:36:18.768 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8217])
2025-01-22 05:36:21.014 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [273.87109375, 23.159618309002433, 97.596875, 22.410591020158826, 16.003362596649485], 'topk_indices': array([  62,   35,  106,  181, 7968,   63,  553,    1,   14,   69,  105,
       8215,   68, 4171,   24,  185,   67, 8212, 8213,    0]), 'topk_tokens': ['MIN', '.', 'E', 'G', ' Square', 'ISC', ',', '<|start_header_id|>', '\n', 'ER', 'ION', '<|end_header_id|>', 'E', ' bathroom', '\n\n', 'ION', 'ION', '<|eot_id|>', '<|start_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [468.15, 342.7708333333333, 184.7875, 39.02734375]}, 'weight': {'score': [21.980859375, 23.324903056569344, 21.989583333333332, 23.330634354001223, 29.735019329896907], 'topk_indices': array([3358, 3331, 3203, 3251, 7508, 7470, 1493, 1431, 4391, 4375, 5204,
       5265, 7185, 7241, 3540, 3514, 5006, 4981, 5029, 5058]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.025, 19.4140625, 19.990625, 28.263671875]}, 'saliency': {'score': [1.4946319580078125, 0.13019250280375608, 0.58837890625, 0.12601882104984347, 0.11745405688728254], 'topk_indices': array([ 181,   34, 8205, 8071, 4167,  112, 8207,    0,   74,   69,   62,
         31,   24,   68, 7968,  105,   63,  185,   67, 4171]), 'topk_tokens': ['G', ' milk', ' before', ' context', ' journey', ' PA', ' garden', '<|begin_of_text|>', ' PA', 'ER', 'MIN', ' picked', '\n\n', 'E', ' Square', 'ION', 'ISC', 'ION', 'ION', ' bathroom'], 'evidence_proportions': [2.4935546875, 1.8489583333333333, 1.036865234375, 0.2866973876953125]}}, 'pred_res': "John's house.<|eot_id|>", 'score': 0}
2025-01-22 05:36:21.020 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:36:21.021 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-66_pid-2_0-5-7-8.pkl | len: 3 |  size: 1.98 KB
Processing depth (0, 5, 7, 8):   3%|▎         | 3/100 [01:03<34:40, 21.45s/it]is_0k: False
your chose emoji: ['👨🏻\u200d❤️\u200d👨🏼', '🧑🏾\u200d❤️\u200d💋\u200d🧑🏻', '🏣', '👨🏻\u200d❤\u200d💋\u200d👨🏼', '🕵🏾\u200d♂', '🚴🏼', '🙇🏻\u200d♂️', '🇬🇲', '🕵\u200d♂️', '📣']
emoji:
O: 👨🏻‍❤️‍👨🏼 [9468, 239, 101, 9468, 237, 119, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 120]
N: 🕵‍♂️ [9468, 243, 113, 102470, 17245, 224, 31643]

O: 🧑🏾‍❤️‍💋‍🧑🏻 [9468, 100, 239, 9468, 237, 122, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 100, 239, 9468, 237, 119]
N: 🇬🇲 [9468, 229, 105, 9468, 229, 110]

O: 🏣 [9468, 237, 96]
N: 🏣 [9468, 237, 96]

O: 👨🏻‍❤‍💋‍👨🏼 [9468, 239, 101, 9468, 237, 119, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 120]
N: 👨🏻‍❤️‍👨🏼 [9468, 239, 101, 9468, 237, 119, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 120]

O: 🕵🏾‍♂ [9468, 243, 113, 9468, 237, 122, 102470, 17245, 224]
N: 👨🏻‍❤‍💋‍👨🏼 [9468, 239, 101, 9468, 237, 119, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 120]

O: 🚴🏼 [9468, 248, 112, 9468, 237, 120]
N: 🙇🏻‍♂️ [9468, 247, 229, 9468, 237, 119, 102470, 17245, 224, 31643]

O: 🙇🏻‍♂️ [9468, 247, 229, 9468, 237, 119, 102470, 17245, 224, 31643]
N: 🧑🏾‍❤️‍💋‍🧑🏻 [9468, 100, 239, 9468, 237, 122, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 100, 239, 9468, 237, 119]

O: 🇬🇲 [9468, 229, 105, 9468, 229, 110]
N: 🚴🏼 [9468, 248, 112, 9468, 237, 120]

O: 🕵‍♂️ [9468, 243, 113, 102470, 17245, 224, 31643]
N: 🕵🏾‍♂ [9468, 243, 113, 9468, 237, 122, 102470, 17245, 224]

O: 📣 [9468, 241, 96]
N: 📣 [9468, 241, 96]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.19s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.81s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.76s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.17s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.72s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (1, 2, 4, 9):   3%|▎         | 3/100 [01:20<34:40, 21.45s/it]2025-01-22 05:36:37.693 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John picked up the milk.
2025-01-22 05:36:37.706 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (895, 900) --> . John picked up the
2025-01-22 05:36:37.706 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bathroom.
2025-01-22 05:36:37.731 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1847, 1853) --> . John journeyed to the
2025-01-22 05:36:37.732 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the garden.
2025-01-22 05:36:37.754 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3610, 3615) --> . John travelled to the
2025-01-22 05:36:37.754 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary grabbed the football.
2025-01-22 05:36:37.806 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7082, 7086) -->  grabbed the football.
2025-01-22 05:36:37.806 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went to the garden.
2025-01-22 05:36:37.836 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5710, 5715) --> . Sandra went to the
2025-01-22 05:36:37.836 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went to the bathroom.
2025-01-22 05:36:37.867 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5710, 5715) --> . Sandra went to the
2025-01-22 05:36:37.867 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary moved to the bedroom.
2025-01-22 05:36:37.896 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4936, 4941) --> . Mary moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:36:42.488 | INFO     | test_jbb_embedding:begin_test:693 - John picked up the milk.<|eot_id|>
2025-01-22 05:36:42.489 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8133])
2025-01-22 05:36:45.254 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [218.94453125, 19.867383388643066, 148.05625, 19.138538066288113, 14.280362215909092], 'topk_indices': array([8114,  900, 8116, 8122,    9, 8115, 8021, 1853, 8031,  901, 8124,
          1, 8120,   24,   14, 8123, 8121, 8128, 8131,    0]), 'topk_tokens': ['.\n\n', ' milk', ':', ' the', ':', 'Question', '.\n\n', ' bathroom', ' location', '.', '?', '<|start_header_id|>', ' milk', '\n\n', '\n', ' garden', ' before', '<|eot_id|>', '<|end_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [348.25, 251.35416666666666, 193.95, 39.94140625]}, 'weight': {'score': [20.6515625, 23.25233337942478, 20.413541666666667, 23.264010615973337, 29.283238636363638], 'topk_indices': array([3248, 3275, 3168, 3120, 7414, 7376, 1473, 1411, 4277, 4261, 5098,
       5159, 7091, 7147, 3457, 3431, 4849, 4897, 4926, 4874]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.334375, 19.4140625, 19.990625, 22.48046875]}, 'saliency': {'score': [1.1769927978515624, 0.1104321475108699, 0.8009847005208334, 0.10652034633793282, 0.10684647993607954], 'topk_indices': array([8126,    0,  896, 8021, 3615, 8102, 8124, 7874,  897,  257, 7987,
       1849,   24,  900, 8031, 8115, 8120, 8121, 1853, 8123]), 'topk_tokens': ['Answer', '<|begin_of_text|>', ' John', '.\n\n', ' garden', ' return', '?', ' Square', ' picked', 'hue', ' context', ' journey', '\n\n', ' milk', ' location', 'Question', ' milk', ' before', ' bathroom', ' garden'], 'evidence_proportions': [1.91630859375, 1.3600667317708333, 0.96259765625, 0.2462310791015625]}}, 'pred_res': 'John picked up the milk.<|eot_id|>', 'score': 0}
2025-01-22 05:36:45.259 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:36:45.259 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-66_pid-3_1-2-4-9.pkl | len: 3 |  size: 2.03 KB
Processing depth (1, 2, 4, 9):   4%|▍         | 4/100 [01:27<36:04, 22.55s/it]is_0k: False
your chose emoji: ['💑🏼', '📯', '🌩', '◾', '🙏🏻', '🚶\u200d♂\u200d➡️', '🧚🏻\u200d♂', '🤾🏻', '🪑', '👰🏿\u200d♀']
emoji:
O: 💑🏼 [93273, 239, 9468, 237, 120]
N: 📯 [9468, 241, 107]

O: 📯 [9468, 241, 107]
N: ◾ [41832, 122]

O: 🌩 [9468, 234, 102]
N: 🤾🏻 [9468, 97, 122, 9468, 237, 119]

O: ◾ [41832, 122]
N: 💑🏼 [93273, 239, 9468, 237, 120]

O: 🙏🏻 [9468, 247, 237, 9468, 237, 119]
N: 🌩 [9468, 234, 102]

O: 🚶‍♂‍➡️ [9468, 248, 114, 102470, 17245, 224, 102470, 98115, 94, 31643]
N: 🚶‍♂‍➡️ [9468, 248, 114, 102470, 17245, 224, 102470, 98115, 94, 31643]

O: 🧚🏻‍♂ [9468, 100, 248, 9468, 237, 119, 102470, 17245, 224]
N: 🪑 [9468, 103, 239]

O: 🤾🏻 [9468, 97, 122, 9468, 237, 119]
N: 🧚🏻‍♂ [9468, 100, 248, 9468, 237, 119, 102470, 17245, 224]

O: 🪑 [9468, 103, 239]
N: 🙏🏻 [9468, 247, 237, 9468, 237, 119]

O: 👰🏿‍♀ [9468, 239, 108, 9468, 237, 123, 102470, 32990]
N: 👰🏿‍♀ [9468, 239, 108, 9468, 237, 123, 102470, 32990]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.60s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.58s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.70s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.26s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.77s/it]
Processing depth (2, 3, 6, 9):   4%|▍         | 4/100 [01:44<36:04, 22.55s/it]2025-01-22 05:37:02.209 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John picked up the milk.
2025-01-22 05:37:02.218 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1817, 1822) --> . John picked up the
2025-01-22 05:37:02.219 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bathroom.
2025-01-22 05:37:02.233 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2907, 2913) --> . John journeyed to the
2025-01-22 05:37:02.233 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the garden.
2025-01-22 05:37:02.256 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4652, 4657) --> . John travelled to the
2025-01-22 05:37:02.256 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary grabbed the football.
2025-01-22 05:37:02.304 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7140, 7144) -->  grabbed the football.
2025-01-22 05:37:02.304 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went to the garden.
2025-01-22 05:37:02.333 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5691, 5696) -->  Sandra went to the garden
2025-01-22 05:37:02.333 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went to the bathroom.
2025-01-22 05:37:02.362 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5692, 5697) -->  went to the garden.
2025-01-22 05:37:02.362 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary moved to the bedroom.
2025-01-22 05:37:02.390 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4912, 4917) --> . Mary moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:37:03.261 | INFO     | test_jbb_embedding:begin_test:693 - The capitol.<|eot_id|>
2025-01-22 05:37:03.262 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8195])
2025-01-22 05:37:05.498 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [251.07421875, 19.429697029763357, 103.72291666666666, 18.707255681122138, 14.810251635174419], 'topk_indices': array([8184, 8049, 8178, 8191,   23,    1, 1818, 8182, 1819, 1823, 1822,
         24,   14, 8183, 2913, 7932, 2909, 8190, 8193,    0]), 'topk_tokens': [' the', ' context', ':', '<|start_header_id|>', '4', '<|start_header_id|>', ' John', ' milk', ' picked', '.', ' milk', '\n\n', '\n', ' before', ' bathroom', ' Square', ' journey', '<|eot_id|>', '<|end_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [409.85, 353.125, 142.75, 34.93359375]}, 'weight': {'score': [20.6515625, 23.306944147962916, 21.416145833333335, 23.316924499264974, 29.712209302325583], 'topk_indices': array([3347, 3320, 3192, 3240, 7434, 7472, 1453, 1515, 4317, 4333, 5162,
       5223, 7149, 7205, 3529, 3503, 5016, 4939, 4987, 4964]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.334375, 19.4140625, 19.990625, 22.48046875]}, 'saliency': {'score': [1.40379638671875, 0.10908458046169797, 0.5829020182291667, 0.10504176560298757, 0.10727194852607194], 'topk_indices': array([  23,   20, 8179, 8188, 2908, 7931, 8177,   24, 8093, 8049, 8185,
       1818, 2302, 8182, 1819, 1822, 8183, 7932, 2909, 2913]), 'topk_tokens': ['4', ' Jul', ' Where', 'Answer', ' John', 'Bridge', 'Question', '\n\n', ' location', ' context', ' garden', ' John', ' Bench', ' milk', ' picked', ' milk', ' before', ' Square', ' journey', ' bathroom'], 'evidence_proportions': [2.34296875, 1.9659830729166667, 0.733251953125, 0.2247314453125]}}, 'pred_res': 'The capitol.<|eot_id|>', 'score': 0}
2025-01-22 05:37:05.506 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:37:05.507 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-66_pid-4_2-3-6-9.pkl | len: 3 |  size: 2.04 KB
Processing depth (2, 3, 6, 9):   5%|▌         | 5/100 [01:48<34:23, 21.72s/it]Processing depth (2, 3, 6, 9):   5%|▌         | 5/100 [01:48<34:16, 21.65s/it]
2025-01-22 05:37:05.575 | INFO     | __main__:<module>:82 - Selected idx: 67
2025-01-22 05:37:05.575 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the location prior to the place where the milk was discarded, left or dropped?
2025-01-22 05:37:05.575 | INFO     | __main__:<module>:84 - Answer: bathroom
2025-01-22 05:37:05.575 | INFO     | __main__:<module>:85 - Tag: 4-hop
2025-01-22 05:37:05.575 | INFO     | __main__:<module>:86 - Needle: [' Mary moved to the bedroom.', ' John journeyed to the bathroom.', ' Sandra went to the garden.', ' John picked up the milk.', ' Sandra went to the bathroom.', ' John travelled to the garden.', ' John dropped the milk.', ' Mary grabbed the football.']
2025-01-22 05:37:05.575 | INFO     | __main__:<module>:87 - Real Needle: [' John journeyed to the bathroom.', ' John picked up the milk.', ' John travelled to the garden.', ' John dropped the milk.', ' Mary grabbed the football.']
2025-01-22 05:37:05.575 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['🏇', '🤷🏿\u200d♀', '🏋🏾\u200d♀️', '👩🏾\u200d❤\u200d💋\u200d👨🏾', '🤷🏽\u200d♀', '🇲🇪', '🧑🏻\u200d💻', '🚴🏾', '🙎🏾\u200d♀️', '👨🏾\u200d🏫']
emoji:
O: 🏇 [9468, 237, 229]
N: 🧑🏻‍💻 [9468, 100, 239, 9468, 237, 119, 102470, 93273, 119]

O: 🤷🏿‍♀ [9468, 97, 115, 9468, 237, 123, 102470, 32990]
N: 👩🏾‍❤‍💋‍👨🏾 [9468, 239, 102, 9468, 237, 122, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 122]

O: 🏋🏾‍♀️ [9468, 237, 233, 9468, 237, 122, 102470, 32990, 31643]
N: 🚴🏾 [9468, 248, 112, 9468, 237, 122]

O: 👩🏾‍❤‍💋‍👨🏾 [9468, 239, 102, 9468, 237, 122, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 122]
N: 🤷🏿‍♀ [9468, 97, 115, 9468, 237, 123, 102470, 32990]

O: 🤷🏽‍♀ [9468, 97, 115, 9468, 237, 121, 102470, 32990]
N: 🏋🏾‍♀️ [9468, 237, 233, 9468, 237, 122, 102470, 32990, 31643]

O: 🇲🇪 [9468, 229, 110, 9468, 229, 103]
N: 🏇 [9468, 237, 229]

O: 🧑🏻‍💻 [9468, 100, 239, 9468, 237, 119, 102470, 93273, 119]
N: 🤷🏽‍♀ [9468, 97, 115, 9468, 237, 121, 102470, 32990]

O: 🚴🏾 [9468, 248, 112, 9468, 237, 122]
N: 🇲🇪 [9468, 229, 110, 9468, 229, 103]

O: 🙎🏾‍♀️ [9468, 247, 236, 9468, 237, 122, 102470, 32990, 31643]
N: 🙎🏾‍♀️ [9468, 247, 236, 9468, 237, 122, 102470, 32990, 31643]

O: 👨🏾‍🏫 [9468, 239, 101, 9468, 237, 122, 102470, 9468, 237, 104]
N: 👨🏾‍🏫 [9468, 239, 101, 9468, 237, 122, 102470, 9468, 237, 104]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:11,  4.00s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.43s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.25s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.78s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.33s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (1, 2, 3, 7, 9):   0%|          | 0/100 [00:15<?, ?it/s]2025-01-22 05:37:20.847 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John journeyed to the bathroom.
2025-01-22 05:37:20.852 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (785, 791) --> . John journeyed to the
2025-01-22 05:37:20.852 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John picked up the milk.
2025-01-22 05:37:20.861 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1754, 1759) --> . John picked up the
2025-01-22 05:37:20.861 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the garden.
2025-01-22 05:37:20.875 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2850, 2855) --> . John travelled to the
2025-01-22 05:37:20.875 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John dropped the milk.
2025-01-22 05:37:20.902 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5585, 5589) -->  John dropped the milk
2025-01-22 05:37:20.902 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary grabbed the football.
2025-01-22 05:37:20.936 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7224, 7228) -->  Mary grabbed the football
2025-01-22 05:37:20.936 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bedroom.
2025-01-22 05:37:20.941 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (850, 855) --> . Mary moved to the
2025-01-22 05:37:20.941 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went to the garden.
2025-01-22 05:37:20.941 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (105, 110) --> . Sandra went to the
2025-01-22 05:37:20.941 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went to the bathroom.
2025-01-22 05:37:20.942 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (105, 110) --> . Sandra went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:37:25.104 | INFO     | test_jbb_embedding:begin_test:693 - The bathroom.<|eot_id|>
2025-01-22 05:37:25.104 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8193])
2025-01-22 05:37:28.252 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [190.47526041666666, 20.675081594680332, 223.87916666666666, 19.801811327694004, 11.89902594150641], 'topk_indices': array([8038,    4, 6114, 8165, 8167,    9,   23, 1760,  622,  111, 8072,
        110, 8191,   24, 8082,   14, 8188,  791,    0, 8189]), 'topk_tokens': [' context', '\n\n', 'the', '.\n\n', ':', ':', '4', '.', ' garden', '.', '.\n\n', ' bathroom', '<|end_header_id|>', '\n\n', ' location', '\n', '<|eot_id|>', ' bathroom', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [256.9375, 182.375, 135.225, 278.25, 82.1953125]}, 'weight': {'score': [22.461588541666668, 23.296453681673988, 20.413541666666667, 23.304211490131177, 29.901642628205128], 'topk_indices': array([3326, 3353, 3198, 3246, 7401, 7439, 1514, 1452, 4365, 4349, 5166,
       5227, 7173, 7117, 3509, 3535, 5020, 4943, 4968, 4991]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.4140625, 21.334375, 19.990625, 25.728515625, 28.263671875]}, 'saliency': {'score': [1.1052907307942708, 0.1148566436395231, 1.2480305989583333, 0.10985872437735611, 0.08927232791215946], 'topk_indices': array([8081, 5586,    8, 5588, 6114, 8078, 8072,  787,   24,  107, 1759,
       8038, 8178, 8166, 8180,  622,  106, 8082,  110,  791]), 'topk_tokens': [' first', ' dropped', ' Date', ' milk', 'the', ' item', '.\n\n', ' journey', '\n\n', ' went', ' milk', ' context', ' milk', 'Question', ' discarded', ' garden', ' Sandra', ' location', ' bathroom', ' bathroom'], 'evidence_proportions': [1.2889811197916667, 1.01083984375, 0.7614501953125, 1.8729248046875, 0.6099853515625]}}, 'pred_res': 'The bathroom.<|eot_id|>', 'score': 100}
2025-01-22 05:37:28.257 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:37:28.257 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-67_pid-0_1-2-3-7-9.pkl | len: 3 |  size: 2.07 KB
Processing depth (1, 2, 3, 7, 9):   1%|          | 1/100 [00:22<37:15, 22.58s/it]is_0k: False
your chose emoji: ['🤾🏽\u200d♀️', '📍', '🥢', '🧥', '🤵🏿\u200d♂', '🤯', '🤹🏿\u200d♀️', '👩🏻\u200d❤\u200d👨🏻', '🧑🏽\u200d❤️\u200d💋\u200d🧑🏾', '👩\u200d💻']
emoji:
O: 🤾🏽‍♀️ [9468, 97, 122, 9468, 237, 121, 102470, 32990, 31643]
N: 🤵🏿‍♂ [9468, 97, 113, 9468, 237, 123, 102470, 17245, 224]

O: 📍 [9468, 35529]
N: 📍 [9468, 35529]

O: 🥢 [9468, 98, 95]
N: 🥢 [9468, 98, 95]

O: 🧥 [9468, 100, 98]
N: 🤹🏿‍♀️ [9468, 97, 117, 9468, 237, 123, 102470, 32990, 31643]

O: 🤵🏿‍♂ [9468, 97, 113, 9468, 237, 123, 102470, 17245, 224]
N: 🤾🏽‍♀️ [9468, 97, 122, 9468, 237, 121, 102470, 32990, 31643]

O: 🤯 [9468, 97, 107]
N: 🧑🏽‍❤️‍💋‍🧑🏾 [9468, 100, 239, 9468, 237, 121, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 100, 239, 9468, 237, 122]

O: 🤹🏿‍♀️ [9468, 97, 117, 9468, 237, 123, 102470, 32990, 31643]
N: 🤯 [9468, 97, 107]

O: 👩🏻‍❤‍👨🏻 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 119]
N: 🧥 [9468, 100, 98]

O: 🧑🏽‍❤️‍💋‍🧑🏾 [9468, 100, 239, 9468, 237, 121, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 100, 239, 9468, 237, 122]
N: 👩🏻‍❤‍👨🏻 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 119]

O: 👩‍💻 [9468, 239, 102, 102470, 93273, 119]
N: 👩‍💻 [9468, 239, 102, 102470, 93273, 119]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.95s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:10<00:10,  5.05s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.72s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.24s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.84s/it]
Processing depth (0, 3, 4, 7, 9):   1%|          | 1/100 [00:39<37:15, 22.58s/it]2025-01-22 05:37:45.448 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John journeyed to the bathroom.
2025-01-22 05:37:45.449 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 37) -->  journeyed to the bathroom.
2025-01-22 05:37:45.449 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John picked up the milk.
2025-01-22 05:37:45.467 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3005, 3010) -->  tragedy. John picked up
2025-01-22 05:37:45.467 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the garden.
2025-01-22 05:37:45.488 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3664, 3669) --> . John travelled to the
2025-01-22 05:37:45.489 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John dropped the milk.
2025-01-22 05:37:45.517 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5735, 5739) -->  John dropped the milk
2025-01-22 05:37:45.518 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary grabbed the football.
2025-01-22 05:37:45.552 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7127, 7131) -->  grabbed the football.
2025-01-22 05:37:45.552 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bedroom.
2025-01-22 05:37:45.557 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (978, 983) --> . Mary moved to the
2025-01-22 05:37:45.558 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went to the garden.
2025-01-22 05:37:45.558 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (112, 117) --> . Sandra went to the
2025-01-22 05:37:45.558 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went to the bathroom.
2025-01-22 05:37:45.559 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (112, 117) --> . Sandra went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:37:46.330 | INFO     | test_jbb_embedding:begin_test:693 - the garden<|eot_id|>
2025-01-22 05:37:46.330 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8185])
2025-01-22 05:37:48.574 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [349.2278645833333, 33.48398952735711, 253.975, 32.14821603877776, 19.90994510135135], 'topk_indices': array([8164, 8159, 8168, 8169, 8049, 8183, 8074,   31, 8064, 3012, 8165,
       4381,   14,   24,  518,   35, 4382, 8181, 8180,    0]), 'topk_tokens': [' prior', ':', ' where', ' the', '.', '<|end_header_id|>', ' location', ' journey', '.\n\n', '.', ' to', 'nes', '\n', '\n\n', ' an', ' bathroom', 'ot', '<|start_header_id|>', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [550.375, 260.68125, 298.925, 426.5625, 143.734375]}, 'weight': {'score': [23.088541666666668, 23.28472307034685, 20.413541666666667, 23.290585884771136, 29.594383445945947], 'topk_indices': array([3315, 3288, 3160, 3208, 7415, 7453, 1486, 1424, 4307, 4323, 5118,
       5179, 7136, 7192, 3471, 3497, 4895, 4920, 4972, 4943]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.9375, 27.1421875, 19.990625, 25.728515625, 22.48046875]}, 'saliency': {'score': [2.145634969075521, 0.18799352902112848, 1.4477213541666667, 0.17990918591909283, 0.14902455097920186], 'topk_indices': array([5735,  769, 3011,   24, 8168, 5738,  338, 8170, 3666, 8158,  113,
        518, 8074,  117, 8164, 8172,   31, 4381, 4382,   35]), 'topk_tokens': [' John', ' garden', ' milk', '\n\n', ' where', ' milk', ' century', ' milk', ' travelled', 'Question', ' Sandra', ' an', ' location', ' bathroom', ' prior', ' discarded', ' journey', 'nes', 'ot', ' bathroom'], 'evidence_proportions': [3.30517578125, 1.6345703125, 1.65537109375, 2.8455810546875, 0.958038330078125]}}, 'pred_res': 'the garden<|eot_id|>', 'score': 0}
2025-01-22 05:37:48.582 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:37:48.583 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-67_pid-1_0-3-4-7-9.pkl | len: 3 |  size: 2.07 KB
Processing depth (0, 3, 4, 7, 9):   2%|▏         | 2/100 [00:42<34:42, 21.25s/it]is_0k: False
your chose emoji: ['🧎🏼\u200d➡️', '💂\u200d♂', '🎋', '🤷\u200d♂️', '\U0001faf6', '👁\u200d🗨️', '👨🏿\u200d❤️\u200d👨🏽', '👨🏼\u200d🦰', '💥', '🧑🏿\u200d⚕']
emoji:
O: 🧎🏼‍➡️ [9468, 100, 236, 9468, 237, 120, 102470, 98115, 94, 31643]
N: 👨🏿‍❤️‍👨🏽 [9468, 239, 101, 9468, 237, 123, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 121]

O: 💂‍♂ [93273, 224, 102470, 17245, 224]
N: 🤷‍♂️ [9468, 97, 115, 102470, 17245, 224, 31643]

O: 🎋 [9468, 236, 233]
N: 🧎🏼‍➡️ [9468, 100, 236, 9468, 237, 120, 102470, 98115, 94, 31643]

O: 🤷‍♂️ [9468, 97, 115, 102470, 17245, 224, 31643]
N: 🎋 [9468, 236, 233]

O: 🫶 [9468, 104, 114]
N: 💥 [93273, 98]

O: 👁‍🗨️ [9468, 239, 223, 102470, 9468, 245, 101, 31643]
N: 💂‍♂ [93273, 224, 102470, 17245, 224]

O: 👨🏿‍❤️‍👨🏽 [9468, 239, 101, 9468, 237, 123, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 121]
N: 👁‍🗨️ [9468, 239, 223, 102470, 9468, 245, 101, 31643]

O: 👨🏼‍🦰 [9468, 239, 101, 9468, 237, 120, 102470, 9468, 99, 108]
N: 🫶 [9468, 104, 114]

O: 💥 [93273, 98]
N: 👨🏼‍🦰 [9468, 239, 101, 9468, 237, 120, 102470, 9468, 99, 108]

O: 🧑🏿‍⚕ [9468, 100, 239, 9468, 237, 123, 102470, 158, 248, 243]
N: 🧑🏿‍⚕ [9468, 100, 239, 9468, 237, 123, 102470, 158, 248, 243]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.37s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.64s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.49s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.91s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.50s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (3, 4, 5, 6, 9):   2%|▏         | 2/100 [00:58<34:42, 21.25s/it]2025-01-22 05:38:04.411 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John journeyed to the bathroom.
2025-01-22 05:38:04.428 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2839, 2845) --> . John journeyed to the
2025-01-22 05:38:04.428 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John picked up the milk.
2025-01-22 05:38:04.446 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3614, 3619) --> . John picked up the
2025-01-22 05:38:04.447 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the garden.
2025-01-22 05:38:04.467 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4180, 4185) --> . John travelled to the
2025-01-22 05:38:04.468 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John dropped the milk.
2025-01-22 05:38:04.496 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4793, 4797) -->  John dropped the milk
2025-01-22 05:38:04.496 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary grabbed the football.
2025-01-22 05:38:04.540 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7288, 7292) -->  Mary grabbed the football
2025-01-22 05:38:04.541 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bedroom.
2025-01-22 05:38:04.545 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (851, 856) --> . Mary moved to the
2025-01-22 05:38:04.545 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went to the garden.
2025-01-22 05:38:04.545 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (49, 54) -->  went to the bathroom.
2025-01-22 05:38:04.545 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went to the bathroom.
2025-01-22 05:38:04.546 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (48, 53) -->  Sandra went to the bathroom
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:38:06.975 | INFO     | test_jbb_embedding:begin_test:693 - the bedroom<|eot_id|>
2025-01-22 05:38:06.975 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8181])
2025-01-22 05:38:09.657 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [189.18229166666666, 33.44615255376344, 303.35833333333335, 32.49018569674647, 29.006022135416668], 'topk_indices': array([1679, 8069, 4305, 8026,  856,   14, 8060,  122, 8070,   84,   87,
       1758, 8083, 1680, 1759, 1681,   85,  123,   86,    0]), 'topk_tokens': [' summer', ' first', 'nes', ' context', ' bedroom', '\n', '.\n\n', ' P', ' location', ' P', 'ER', ' summer', ' the', "'s", "'s", ' work', 'ION', 'ION', 'E', '<|begin_of_text|>'], 'evidence_proportions': [263.6666666666667, 196.025, 161.725, 219.8125, 72.59375]}, 'weight': {'score': [22.461588541666668, 23.271329728739, 22.199479166666666, 23.275689648557396, 29.020833333333332], 'topk_indices': array([3298, 3325, 3218, 3170, 7407, 7445, 1447, 1509, 4323, 4339, 5139,
       5200, 7179, 7123, 3481, 3507, 4964, 4916, 4941, 4993]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.4140625, 21.334375, 19.990625, 25.728515625, 28.263671875]}, 'saliency': {'score': [1.0724436442057292, 0.18862658488552358, 1.785302734375, 0.18308186399343923, 0.2068871392144097], 'topk_indices': array([  52, 8060, 1256, 8069,   87,    0,   84, 4305, 8026, 1679, 1680,
       8070, 2845,  856, 1759, 1758, 1681,   86,   85,  123]), 'topk_tokens': [' bathroom', '.\n\n', 'nes', ' first', 'ER', '<|begin_of_text|>', ' P', 'nes', ' context', ' summer', "'s", ' location', ' bathroom', ' bedroom', "'s", ' summer', ' work', 'E', 'ION', 'ION'], 'evidence_proportions': [1.3431396484375, 1.088037109375, 0.906396484375, 1.38720703125, 0.539703369140625]}}, 'pred_res': 'the bedroom<|eot_id|>', 'score': 0}
2025-01-22 05:38:09.664 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:38:09.664 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-67_pid-2_3-4-5-6-9.pkl | len: 3 |  size: 2.02 KB
Processing depth (3, 4, 5, 6, 9):   3%|▎         | 3/100 [01:03<34:13, 21.18s/it]is_0k: False
your chose emoji: ['\U0001fac3🏾', '🇱🇷', '🦸🏻', '👩🏿\u200d🤝\u200d👩🏾', '🧑🏾\u200d💼', '🕸', '\U0001fab9', '\U0001faf7🏼', '🏃🏽\u200d♂️\u200d➡', '🏻']
emoji:
O: 🫃🏾 [9468, 104, 225, 9468, 237, 122]
N: 🧑🏾‍💼 [9468, 100, 239, 9468, 237, 122, 102470, 93273, 120]

O: 🇱🇷 [9468, 229, 109, 9468, 229, 115]
N: 🦸🏻 [9468, 99, 116, 9468, 237, 119]

O: 🦸🏻 [9468, 99, 116, 9468, 237, 119]
N: 🇱🇷 [9468, 229, 109, 9468, 229, 115]

O: 👩🏿‍🤝‍👩🏾 [9468, 239, 102, 9468, 237, 123, 102470, 9468, 97, 251, 102470, 9468, 239, 102, 9468, 237, 122]
N: 🪹 [9468, 103, 117]

O: 🧑🏾‍💼 [9468, 100, 239, 9468, 237, 122, 102470, 93273, 120]
N: 👩🏿‍🤝‍👩🏾 [9468, 239, 102, 9468, 237, 123, 102470, 9468, 97, 251, 102470, 9468, 239, 102, 9468, 237, 122]

O: 🕸 [9468, 243, 116]
N: 🫃🏾 [9468, 104, 225, 9468, 237, 122]

O: 🪹 [9468, 103, 117]
N: 🏃🏽‍♂️‍➡ [9468, 237, 225, 9468, 237, 121, 102470, 17245, 224, 31643, 102470, 98115, 94]

O: 🫷🏼 [9468, 104, 115, 9468, 237, 120]
N: 🕸 [9468, 243, 116]

O: 🏃🏽‍♂️‍➡ [9468, 237, 225, 9468, 237, 121, 102470, 17245, 224, 31643, 102470, 98115, 94]
N: 🫷🏼 [9468, 104, 115, 9468, 237, 120]

O: 🏻 [9468, 237, 119]
N: 🏻 [9468, 237, 119]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.34s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.40s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.42s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.12s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.59s/it]
Processing depth (2, 4, 6, 8, 9):   3%|▎         | 3/100 [01:20<34:13, 21.18s/it]2025-01-22 05:38:25.763 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John journeyed to the bathroom.
2025-01-22 05:38:25.773 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1857, 1863) --> . John journeyed to the
2025-01-22 05:38:25.773 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John picked up the milk.
2025-01-22 05:38:25.798 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3720, 3725) --> . John picked up the
2025-01-22 05:38:25.799 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the garden.
2025-01-22 05:38:25.826 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4860, 4865) --> . John travelled to the
2025-01-22 05:38:25.826 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John dropped the milk.
2025-01-22 05:38:25.862 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6601, 6605) -->  John dropped the milk
2025-01-22 05:38:25.862 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary grabbed the football.
2025-01-22 05:38:25.901 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7111, 7115) -->  grabbed the football.
2025-01-22 05:38:25.901 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bedroom.
2025-01-22 05:38:25.907 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (971, 976) --> . Mary moved to the
2025-01-22 05:38:25.907 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went to the garden.
2025-01-22 05:38:25.908 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (105, 110) --> . Sandra went to the
2025-01-22 05:38:25.908 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went to the bathroom.
2025-01-22 05:38:25.908 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (105, 110) --> . Sandra went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:38:26.699 | INFO     | test_jbb_embedding:begin_test:693 - the bedroom<|eot_id|>
2025-01-22 05:38:26.699 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8161])
2025-01-22 05:38:28.919 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [212.30338541666666, 35.58996815286624, 489.98333333333335, 34.22910384615385, 13.186334425403226], 'topk_indices': array([427, 451, 111, 452, 454, 429, 110, 425, 432, 424, 544, 431, 453,
       430, 541, 539, 546, 547, 548,   0]), 'topk_tokens': [',', ' em', '.', 's', ' hour', ' em', ' bathroom', ' ', ' hour', ' to', ',', ' per', ' per', 's', ' to', ',', ' em', 's', ' per', '<|begin_of_text|>'], 'evidence_proportions': [193.54166666666666, 197.675, 146.2625, 451.375, 102.2109375]}, 'weight': {'score': [21.497721354166668, 23.26576662787849, 20.413541666666667, 23.276254807692307, 29.5859375], 'topk_indices': array([3254, 3281, 3174, 3126, 7437, 7399, 1479, 1417, 4269, 4285, 5110,
       5171, 7176, 7120, 3463, 3437, 4887, 4964, 4912, 4935]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.4140625, 21.334375, 19.990625, 25.728515625, 22.48046875]}, 'saliency': {'score': [1.2193349202473958, 0.19874580977653417, 2.7383626302083335, 0.19104262319711537, 0.09899680845199092], 'topk_indices': array([533, 122, 424, 107, 530, 536, 540, 541, 106, 451, 454, 430, 429,
       547, 432, 431, 453, 110, 546, 548]), 'topk_tokens': [' capable', ' Published', ' to', ' went', 'otype', ' setting', '000', ' to', ' Sandra', ' em', ' hour', 's', ' em', 's', ' hour', ' per', ' per', ' bathroom', ' em', ' per'], 'evidence_proportions': [0.9805501302083334, 1.082421875, 0.797509765625, 2.830810546875, 0.664459228515625]}}, 'pred_res': 'the bedroom<|eot_id|>', 'score': 0}
2025-01-22 05:38:28.926 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:38:28.927 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-67_pid-3_2-4-6-8-9.pkl | len: 3 |  size: 1.97 KB
Processing depth (2, 4, 6, 8, 9):   4%|▍         | 4/100 [01:23<32:40, 20.42s/it]is_0k: False
your chose emoji: ['🐿️', '🧜🏽\u200d♀️', '💙', '👩🏽\u200d❤\u200d👨🏽', '👨\u200d⚖️', '🏧', '🧑🏾\u200d🦳', '▪', '🛤', '👯\u200d♀️']
emoji:
O: 🐿️ [9468, 238, 123, 31643]
N: ▪ [10634, 103]

O: 🧜🏽‍♀️ [9468, 100, 250, 9468, 237, 121, 102470, 32990, 31643]
N: 👩🏽‍❤‍👨🏽 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 121]

O: 💙 [93273, 247]
N: 🐿️ [9468, 238, 123, 31643]

O: 👩🏽‍❤‍👨🏽 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 121]
N: 👨‍⚖️ [9468, 239, 101, 102470, 158, 248, 244, 31643]

O: 👨‍⚖️ [9468, 239, 101, 102470, 158, 248, 244, 31643]
N: 🏧 [9468, 237, 100]

O: 🏧 [9468, 237, 100]
N: 🧜🏽‍♀️ [9468, 100, 250, 9468, 237, 121, 102470, 32990, 31643]

O: 🧑🏾‍🦳 [9468, 100, 239, 9468, 237, 122, 102470, 9468, 99, 111]
N: 🛤 [9468, 249, 97]

O: ▪ [10634, 103]
N: 🧑🏾‍🦳 [9468, 100, 239, 9468, 237, 122, 102470, 9468, 99, 111]

O: 🛤 [9468, 249, 97]
N: 💙 [93273, 247]

O: 👯‍♀️ [9468, 239, 107, 102470, 32990, 31643]
N: 👯‍♀️ [9468, 239, 107, 102470, 32990, 31643]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.94s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.72s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.46s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.09s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.66s/it]
Processing depth (0, 1, 2, 3, 9):   4%|▍         | 4/100 [01:39<32:40, 20.42s/it]2025-01-22 05:38:45.467 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John journeyed to the bathroom.
2025-01-22 05:38:45.468 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 37) -->  journeyed to the bathroom.
2025-01-22 05:38:45.468 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John picked up the milk.
2025-01-22 05:38:45.472 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (796, 801) --> . John picked up the
2025-01-22 05:38:45.472 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the garden.
2025-01-22 05:38:45.481 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1764, 1769) --> . John travelled to the
2025-01-22 05:38:45.481 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John dropped the milk.
2025-01-22 05:38:45.495 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2849, 2853) -->  John dropped the milk
2025-01-22 05:38:45.495 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary grabbed the football.
2025-01-22 05:38:45.529 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7224, 7228) -->  Mary grabbed the football
2025-01-22 05:38:45.529 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bedroom.
2025-01-22 05:38:45.534 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (860, 865) --> . Mary moved to the
2025-01-22 05:38:45.534 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went to the garden.
2025-01-22 05:38:45.534 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (112, 117) --> . Sandra went to the
2025-01-22 05:38:45.534 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went to the bathroom.
2025-01-22 05:38:45.535 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (112, 117) --> . Sandra went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:38:46.346 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 05:38:46.347 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8177])
2025-01-22 05:38:48.586 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [377.2591145833333, 34.590136002444986, 290.34583333333336, 33.10869748802359, 18.078152901785714], 'topk_indices': array([ 801, 8151,   32,  584, 8056, 8164, 3124,   29,  802, 8156,   14,
       8066,   31, 8157,   35,   24, 3125, 8173, 8172,    0]), 'topk_tokens': [' milk', ':', 'ed', ' instead', '.\n\n', ' discarded', ' const', '\n\n', '.', ' prior', '\n', ' location', ' journey', ' to', ' bathroom', '\n\n', 'ern', '<|start_header_id|>', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [667.4583333333334, 403.7, 252.575, 312.28125, 129.7421875]}, 'weight': {'score': [22.842447916666668, 23.281815403422982, 20.413541666666667, 23.288395544159194, 29.785044642857144], 'topk_indices': array([3344, 3317, 3225, 3177, 7401, 7439, 1524, 1462, 4312, 4328, 5143,
       5204, 7173, 7117, 3500, 3526, 4945, 4920, 4968, 4997]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.9375, 21.334375, 19.990625, 25.728515625, 28.263671875]}, 'saliency': {'score': [2.2529398600260415, 0.19436655953927262, 1.6426920572916666, 0.1856292248533657, 0.13309925624302454], 'topk_indices': array([ 629,   40, 7328, 3144, 8162, 8152, 8150,  113,   24,  801, 7377,
        584, 8066,  117, 3124, 8156, 8164,   31, 3125,   35]), 'topk_tokens': [' Sandra', '\n\n\n', ' tele', 'ern', ' milk', ' Where', 'Question', ' Sandra', '\n\n', ' milk', ' tele', ' instead', ' location', ' bathroom', ' const', ' prior', ' discarded', ' journey', 'ern', ' bathroom'], 'evidence_proportions': [3.9845377604166665, 2.18515625, 1.403125, 2.093017578125, 0.96246337890625]}}, 'pred_res': 'The garden.<|eot_id|>', 'score': 0}
2025-01-22 05:38:48.590 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:38:48.590 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-67_pid-4_0-1-2-3-9.pkl | len: 3 |  size: 2.07 KB
Processing depth (0, 1, 2, 3, 9):   5%|▌         | 5/100 [01:42<31:53, 20.15s/it]Processing depth (0, 1, 2, 3, 9):   5%|▌         | 5/100 [01:42<32:36, 20.60s/it]
2025-01-22 05:38:48.653 | INFO     | __main__:<module>:82 - Selected idx: 68
2025-01-22 05:38:48.654 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the milk before the kitchen? 
2025-01-22 05:38:48.654 | INFO     | __main__:<module>:84 - Answer: garden
2025-01-22 05:38:48.654 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 05:38:48.654 | INFO     | __main__:<module>:86 - Needle: [' Sandra went to the garden.', ' Sandra moved to the office.', ' John travelled to the garden.', ' Sandra went to the bathroom.', ' Mary moved to the bedroom.', ' John went back to the kitchen.', ' Daniel went to the office.', ' Sandra moved to the garden.', ' Sandra picked up the apple there.', ' John discarded the milk.', ' Sandra dropped the apple.']
2025-01-22 05:38:48.654 | INFO     | __main__:<module>:87 - Real Needle: [' John travelled to the garden.', ' John went back to the kitchen.', ' John discarded the milk.', ' Sandra dropped the apple.']
2025-01-22 05:38:48.654 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['🏃\u200d♂\u200d➡️', '🧑🏿\u200d✈️', '\U0001fac4🏽', '🥁', '📜', '💆🏼\u200d♂', '👨🏽\u200d🏫', '🙄', '🧎🏼\u200d♂️\u200d➡️', '🦱']
emoji:
O: 🏃‍♂‍➡️ [9468, 237, 225, 102470, 17245, 224, 102470, 98115, 94, 31643]
N: 📜 [9468, 241, 250]

O: 🧑🏿‍✈️ [9468, 100, 239, 9468, 237, 123, 102470, 38798, 230, 31643]
N: 👨🏽‍🏫 [9468, 239, 101, 9468, 237, 121, 102470, 9468, 237, 104]

O: 🫄🏽 [9468, 104, 226, 9468, 237, 121]
N: 🙄 [9468, 247, 226]

O: 🥁 [9468, 98, 223]
N: 🥁 [9468, 98, 223]

O: 📜 [9468, 241, 250]
N: 🫄🏽 [9468, 104, 226, 9468, 237, 121]

O: 💆🏼‍♂ [93273, 228, 9468, 237, 120, 102470, 17245, 224]
N: 💆🏼‍♂ [93273, 228, 9468, 237, 120, 102470, 17245, 224]

O: 👨🏽‍🏫 [9468, 239, 101, 9468, 237, 121, 102470, 9468, 237, 104]
N: 🧑🏿‍✈️ [9468, 100, 239, 9468, 237, 123, 102470, 38798, 230, 31643]

O: 🙄 [9468, 247, 226]
N: 🧎🏼‍♂️‍➡️ [9468, 100, 236, 9468, 237, 120, 102470, 17245, 224, 31643, 102470, 98115, 94, 31643]

O: 🧎🏼‍♂️‍➡️ [9468, 100, 236, 9468, 237, 120, 102470, 17245, 224, 31643, 102470, 98115, 94, 31643]
N: 🏃‍♂‍➡️ [9468, 237, 225, 102470, 17245, 224, 102470, 98115, 94, 31643]

O: 🦱 [9468, 99, 109]
N: 🦱 [9468, 99, 109]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.61s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:10,  5.02s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.77s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.29s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.85s/it]
Processing depth (0, 3, 7, 9):   0%|          | 0/100 [00:17<?, ?it/s]2025-01-22 05:39:05.862 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the garden.
2025-01-22 05:39:05.863 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  travelled to the garden.
2025-01-22 05:39:05.863 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the kitchen.
2025-01-22 05:39:05.877 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2879, 2885) --> . John went back to the
2025-01-22 05:39:05.878 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John discarded the milk.
2025-01-22 05:39:05.908 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5638, 5642) -->  John discarded the milk
2025-01-22 05:39:05.908 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra dropped the apple.
2025-01-22 05:39:05.944 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7245, 7249) -->  Sandra dropped the apple
2025-01-22 05:39:05.944 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went to the garden.
2025-01-22 05:39:05.945 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (32, 37) -->  to the garden. Sandra
2025-01-22 05:39:05.945 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the office.
2025-01-22 05:39:05.945 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (33, 38) -->  the garden. Sandra moved
2025-01-22 05:39:05.945 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went to the bathroom.
2025-01-22 05:39:05.951 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1315, 1320) --> . Sandra went to the
2025-01-22 05:39:05.952 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the bedroom.
2025-01-22 05:39:05.971 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3628, 3633) -->  Mary moved to the bedroom
2025-01-22 05:39:05.971 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel went to the office.
2025-01-22 05:39:06.007 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6736, 6741) --> . Daniel went to the
2025-01-22 05:39:06.007 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra moved to the garden.
2025-01-22 05:39:06.007 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (32, 37) -->  to the garden. Sandra
2025-01-22 05:39:06.007 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Sandra picked up the apple there.
2025-01-22 05:39:06.024 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (3144, 3150) --> . Sandra picked up the apple
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:39:06.922 | INFO     | test_jbb_embedding:begin_test:693 - John travelled to the garden.<|eot_id|>
2025-01-22 05:39:06.922 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8175])
2025-01-22 05:39:09.133 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [236.17598684210526, 21.19646842137442, 147.88020833333334, 20.13217869013911, 14.40948486328125], 'topk_indices': array([5642, 8158,    4, 8164,   25, 8166, 5641, 5639, 8063,    9, 8073,
          1,   24, 8162, 8165, 8163, 8173,   14, 8170,    0]), 'topk_tokens': ['.', ':', '\n\n', ' the', '<|eot_id|>', '?', ' milk', ' discarded', '.\n\n', ':', ' location', '<|start_header_id|>', '\n\n', ' milk', ' kitchen', ' before', '<|end_header_id|>', '\n', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [277.175, 201.08333333333334, 397.25, 76.4921875]}, 'weight': {'score': [23.632401315789473, 23.26463148080215, 22.63693576388889, 23.266553113073986, 29.2158203125], 'topk_indices': array([3378, 3351, 3265, 3217, 7466, 7428, 1461, 1523, 4354, 4370, 5169,
       5230, 7194, 7138, 3534, 3560, 5023, 4946, 4971, 4994]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.64375, 20.0703125, 27.845703125, 28.498046875]}, 'saliency': {'score': [1.461657072368421, 0.11825359267050319, 0.8311428493923612, 0.11195189633217408, 0.10582780838012695], 'topk_indices': array([   0,  391, 8072, 8166,   14, 8168,    8,   31, 8063, 8159,   24,
        363, 8157, 2885, 5641, 8073, 5639, 8163, 8162, 8165]), 'topk_tokens': ['<|begin_of_text|>', ' past', ' first', '?', '\n', 'Answer', ' Date', ' travelled', '.\n\n', ' Where', '\n\n', ' century', 'Question', ' kitchen', ' milk', ' location', ' discarded', ' before', ' milk', ' kitchen'], 'evidence_proportions': [1.51953125, 1.0123697916666667, 2.989990234375, 0.534912109375]}}, 'pred_res': 'John travelled to the garden.<|eot_id|>', 'score': 100}
2025-01-22 05:39:09.137 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:39:09.137 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-68_pid-0_0-3-7-9.pkl | len: 3 |  size: 2.04 KB
Processing depth (0, 3, 7, 9):   1%|          | 1/100 [00:20<33:38, 20.39s/it]is_0k: False
your chose emoji: ['🐥', '👌🏿', '🇱🇺', '😔', '💆🏽', '👩🏾\u200d🤝\u200d👨🏼', '👵🏻', '🔵', '🏃🏻\u200d♂️\u200d➡', '🥳']
emoji:
O: 🐥 [9468, 238, 98]
N: 🏃🏻‍♂️‍➡ [9468, 237, 225, 9468, 237, 119, 102470, 17245, 224, 31643, 102470, 98115, 94]

O: 👌🏿 [9468, 239, 234, 9468, 237, 123]
N: 👵🏻 [9468, 239, 113, 9468, 237, 119]

O: 🇱🇺 [9468, 229, 109, 9468, 229, 118]
N: 👩🏾‍🤝‍👨🏼 [9468, 239, 102, 9468, 237, 122, 102470, 9468, 97, 251, 102470, 9468, 239, 101, 9468, 237, 120]

O: 😔 [76460, 242]
N: 💆🏽 [93273, 228, 9468, 237, 121]

O: 💆🏽 [93273, 228, 9468, 237, 121]
N: 🔵 [9468, 242, 113]

O: 👩🏾‍🤝‍👨🏼 [9468, 239, 102, 9468, 237, 122, 102470, 9468, 97, 251, 102470, 9468, 239, 101, 9468, 237, 120]
N: 🇱🇺 [9468, 229, 109, 9468, 229, 118]

O: 👵🏻 [9468, 239, 113, 9468, 237, 119]
N: 😔 [76460, 242]

O: 🔵 [9468, 242, 113]
N: 👌🏿 [9468, 239, 234, 9468, 237, 123]

O: 🏃🏻‍♂️‍➡ [9468, 237, 225, 9468, 237, 119, 102470, 17245, 224, 31643, 102470, 98115, 94]
N: 🐥 [9468, 238, 98]

O: 🥳 [9468, 98, 111]
N: 🥳 [9468, 98, 111]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.11s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.68s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.64s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.18s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.68s/it]
Processing depth (1, 2, 3, 7):   1%|          | 1/100 [00:36<33:38, 20.39s/it]2025-01-22 05:39:25.649 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the garden.
2025-01-22 05:39:25.653 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (836, 841) --> . John travelled to the
2025-01-22 05:39:25.653 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the kitchen.
2025-01-22 05:39:25.663 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1880, 1886) --> . John went back to the
2025-01-22 05:39:25.663 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John discarded the milk.
2025-01-22 05:39:25.677 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2964, 2968) -->  John discarded the milk
2025-01-22 05:39:25.677 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra dropped the apple.
2025-01-22 05:39:25.704 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5678, 5682) -->  Sandra dropped the apple
2025-01-22 05:39:25.704 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went to the garden.
2025-01-22 05:39:25.709 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (929, 934) -->  Sandra moved to the garden
2025-01-22 05:39:25.709 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the office.
2025-01-22 05:39:25.709 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (32, 37) -->  moved to the office.
2025-01-22 05:39:25.709 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went to the bathroom.
2025-01-22 05:39:25.716 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1416, 1421) --> . Sandra went to the
2025-01-22 05:39:25.717 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the bedroom.
2025-01-22 05:39:25.735 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3683, 3688) --> . Mary moved to the
2025-01-22 05:39:25.735 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel went to the office.
2025-01-22 05:39:25.768 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6818, 6823) --> . Daniel went to the
2025-01-22 05:39:25.768 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra moved to the garden.
2025-01-22 05:39:25.773 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (928, 933) --> . Sandra moved to the
2025-01-22 05:39:25.773 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Sandra picked up the apple there.
2025-01-22 05:39:25.789 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (3242, 3248) --> . Sandra picked up the apple
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:39:26.594 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 05:39:26.594 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8184])
2025-01-22 05:39:28.857 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [623.1069078947369, 39.99338509221937, 180.20052083333334, 38.01027960526316, 43.109489889705884], 'topk_indices': array([8170, 2935, 2967, 8168, 2963, 8169, 2964, 8082, 8166, 8167, 1886,
         14, 1887, 8171, 8175, 2965, 8173, 8174, 8172,    0]), 'topk_tokens': [' the', '.', ' milk', ' Where', '.', ' was', ' John', ' location', 'Question', ':', ' kitchen', '\n', '.', ' milk', '?', ' discarded', ' the', ' kitchen', ' before', '<|begin_of_text|>'], 'evidence_proportions': [700.8, 619.8333333333334, 1084.0, 70.0078125]}, 'weight': {'score': [23.460526315789473, 23.261647657872235, 21.634765625, 23.268385122048695, 28.75436580882353], 'topk_indices': array([3336, 3309, 3174, 3222, 7415, 7453, 1444, 1506, 4328, 4312, 5202,
       5141, 7186, 7130, 3504, 3530, 4995, 4966, 4943, 4918]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.990625, 20.0703125, 27.845703125, 28.498046875]}, 'saliency': {'score': [3.8017513877467106, 0.22492223702115396, 1.0167711046006944, 0.21305968007370574, 0.3139493605669807], 'topk_indices': array([  68, 2936,   39, 8038, 8169, 2962,    0,  841, 8168, 8175,  838,
       2967, 8082, 2964, 8166, 1886, 8171, 2965, 8172, 8174]), 'topk_tokens': ['ION', ' During', '***', ' context', ' was', ' Gov', '<|begin_of_text|>', ' garden', ' Where', '?', ' travelled', ' milk', ' location', ' John', 'Question', ' kitchen', ' milk', ' discarded', ' before', ' kitchen'], 'evidence_proportions': [3.8271484375, 2.9869791666666665, 8.301025390625, 0.492889404296875]}}, 'pred_res': 'The garden.<|eot_id|>', 'score': 100}
2025-01-22 05:39:28.865 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:39:28.866 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-68_pid-1_1-2-3-7.pkl | len: 3 |  size: 2.0 KB
Processing depth (1, 2, 3, 7):   2%|▏         | 2/100 [00:40<32:40, 20.00s/it]is_0k: False
your chose emoji: ['🦹', '🇺🇬', '👩🏿', '👩🏼\u200d🚒', '🪤', '🇷🇸', '🧍🏿\u200d♂️', '🖐🏼', '🧑🏿\u200d🦳', '🚵🏾\u200d♀']
emoji:
O: 🦹 [9468, 99, 117]
N: �🧑🏿‍� [111, 9468, 100, 239, 9468, 237, 123, 102470, 9468, 99]

O: 🇺🇬 [9468, 229, 118, 9468, 229, 105]
N: ️🧍🏿‍♂ [31643, 9468, 100, 235, 9468, 237, 123, 102470, 17245, 224]

O: 👩🏿 [9468, 239, 102, 9468, 237, 123]
N: �🖐� [120, 9468, 244, 238, 9468, 237]

O: 👩🏼‍🚒 [9468, 239, 102, 9468, 237, 120, 102470, 9468, 248, 240]
N: �� [97, 9468, 103]

O: 🪤 [9468, 103, 97]
N: �👩� [123, 9468, 239, 102, 9468, 237]

O: 🇷🇸 [9468, 229, 115, 9468, 229, 116]
N: �👩🏼‍� [240, 9468, 239, 102, 9468, 237, 120, 102470, 9468, 248]

O: 🧍🏿‍♂️ [9468, 100, 235, 9468, 237, 123, 102470, 17245, 224, 31643]
N: �🇷� [116, 9468, 229, 115, 9468, 229]

O: 🖐🏼 [9468, 244, 238, 9468, 237, 120]
N: �� [117, 9468, 99]

O: 🧑🏿‍🦳 [9468, 100, 239, 9468, 237, 123, 102470, 9468, 99, 111]
N: �🇺� [105, 9468, 229, 118, 9468, 229]

O: 🚵🏾‍♀ [9468, 248, 113, 9468, 237, 122, 102470, 32990]
N: ♀🚵🏾‍ [32990, 9468, 248, 113, 9468, 237, 122, 102470]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.85s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.57s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.20s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.71s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.36s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 2, 5, 6):   2%|▏         | 2/100 [00:55<32:40, 20.00s/it]2025-01-22 05:39:44.334 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the garden.
2025-01-22 05:39:44.334 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  travelled to the garden.
2025-01-22 05:39:44.334 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the kitchen.
2025-01-22 05:39:44.343 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1763, 1769) --> . John went back to the
2025-01-22 05:39:44.343 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John discarded the milk.
2025-01-22 05:39:44.366 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4235, 4239) -->  discarded the milk.
2025-01-22 05:39:44.372 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra dropped the apple.
2025-01-22 05:39:44.404 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4805, 4809) -->  Sandra dropped the apple
2025-01-22 05:39:44.404 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went to the garden.
2025-01-22 05:39:44.404 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (32, 37) -->  to the garden. Sandra
2025-01-22 05:39:44.404 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the office.
2025-01-22 05:39:44.405 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (33, 38) -->  the garden. Sandra moved
2025-01-22 05:39:44.405 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went to the bathroom.
2025-01-22 05:39:44.415 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1270, 1275) -->  Republican. Sandra went to
2025-01-22 05:39:44.415 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the bedroom.
2025-01-22 05:39:44.446 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3656, 3661) -->  Hon. Mary moved to
2025-01-22 05:39:44.446 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel went to the office.
2025-01-22 05:39:44.483 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6923, 6928) --> . Daniel went to the
2025-01-22 05:39:44.483 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra moved to the garden.
2025-01-22 05:39:44.483 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (32, 37) -->  to the garden. Sandra
2025-01-22 05:39:44.483 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Sandra picked up the apple there.
2025-01-22 05:39:44.499 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (3118, 3124) --> . Sandra picked up the apple
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:39:48.933 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 05:39:48.934 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8211])
2025-01-22 05:39:52.159 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [256.2828947368421, 22.31074042792793, 184.37196180555554, 21.05082194509131, 12.04223037347561], 'topk_indices': array([8195, 8196, 1769, 1770, 8193,    9, 8099, 8194, 8209, 8065, 8198,
       8109,   24, 8202, 8200,   14, 8206, 8201, 8199,    0]), 'topk_tokens': [' Where', ' was', ' kitchen', '.', 'Question', ':', '.\n\n', ':', '<|end_header_id|>', ' context', ' milk', ' location', '\n\n', '?', ' the', '\n', '<|eot_id|>', ' kitchen', ' before', '<|begin_of_text|>'], 'evidence_proportions': [326.25, 262.8125, 345.09375, 70.21875]}, 'weight': {'score': [22.61636513157895, 23.296311936936938, 23.223958333333332, 23.298214586652776, 29.496189024390244], 'topk_indices': array([3319, 3346, 3191, 3239, 7452, 7414, 1461, 1523, 4325, 4309, 5212,
       5151, 7135, 7191, 3502, 3528, 4953, 4928, 5005, 4976]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.64375, 20.0703125, 23.01953125, 28.498046875]}, 'saliency': {'score': [1.4053184107730263, 0.1255557513277636, 1.0511508517795138, 0.11849153829360216, 0.08987780315120046], 'topk_indices': array([  36,    8,    0, 4237, 8204, 8196, 8099,  520,   24,   31, 4235,
       8195, 8202, 8065, 8109, 8193, 1769, 8198, 8199, 8201]), 'topk_tokens': [' Sandra', ' Date', '<|begin_of_text|>', ' milk', 'Answer', ' was', '.\n\n', ' instead', '\n\n', ' travelled', ' discarded', ' Where', '?', ' context', ' location', 'Question', ' kitchen', ' milk', ' before', ' kitchen'], 'evidence_proportions': [1.72744140625, 1.2649739583333333, 2.1300048828125, 0.488494873046875]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 0}
2025-01-22 05:39:52.164 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:39:52.164 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-68_pid-2_0-2-5-6.pkl | len: 3 |  size: 2.02 KB
Processing depth (0, 2, 5, 6):   3%|▎         | 3/100 [01:03<34:46, 21.51s/it]is_0k: False
your chose emoji: ['🏋🏾\u200d♂️', '👩🏻\u200d🎓', '🧑\u200d🦼\u200d➡️', '🧏🏿\u200d♂', '👩🏻\u200d❤️\u200d👨🏾', '👩🏽\u200d⚕', '👶🏻', '😲', '💸', '🇪🇭']
emoji:
O: 🏋🏾‍♂️ [9468, 237, 233, 9468, 237, 122, 102470, 17245, 224, 31643]
N: 🧑‍🦼‍➡️ [9468, 100, 239, 102470, 9468, 99, 120, 102470, 98115, 94, 31643]

O: 👩🏻‍🎓 [9468, 239, 102, 9468, 237, 119, 102470, 9468, 236, 241]
N: 👶🏻 [9468, 239, 114, 9468, 237, 119]

O: 🧑‍🦼‍➡️ [9468, 100, 239, 102470, 9468, 99, 120, 102470, 98115, 94, 31643]
N: 💸 [93273, 116]

O: 🧏🏿‍♂ [9468, 100, 237, 9468, 237, 123, 102470, 17245, 224]
N: 🧏🏿‍♂ [9468, 100, 237, 9468, 237, 123, 102470, 17245, 224]

O: 👩🏻‍❤️‍👨🏾 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 122]
N: 👩🏽‍⚕ [9468, 239, 102, 9468, 237, 121, 102470, 158, 248, 243]

O: 👩🏽‍⚕ [9468, 239, 102, 9468, 237, 121, 102470, 158, 248, 243]
N: 👩🏻‍❤️‍👨🏾 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 122]

O: 👶🏻 [9468, 239, 114, 9468, 237, 119]
N: 🏋🏾‍♂️ [9468, 237, 233, 9468, 237, 122, 102470, 17245, 224, 31643]

O: 😲 [76460, 110]
N: 😲 [76460, 110]

O: 💸 [93273, 116]
N: 👩🏻‍🎓 [9468, 239, 102, 9468, 237, 119, 102470, 9468, 236, 241]

O: 🇪🇭 [9468, 229, 103, 9468, 229, 255]
N: 🇪🇭 [9468, 229, 103, 9468, 229, 255]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.64s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.88s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.61s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.23s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.77s/it]
Processing depth (4, 5, 7, 8):   3%|▎         | 3/100 [01:20<34:46, 21.51s/it]2025-01-22 05:40:08.935 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the garden.
2025-01-22 05:40:08.953 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3613, 3618) --> . John travelled to the
2025-01-22 05:40:08.954 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the kitchen.
2025-01-22 05:40:08.975 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4159, 4165) --> . John went back to the
2025-01-22 05:40:08.975 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John discarded the milk.
2025-01-22 05:40:09.002 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5603, 5607) -->  John discarded the milk
2025-01-22 05:40:09.002 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra dropped the apple.
2025-01-22 05:40:09.034 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6600, 6604) -->  Sandra dropped the apple
2025-01-22 05:40:09.034 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went to the garden.
2025-01-22 05:40:09.039 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (967, 972) -->  Sandra moved to the garden
2025-01-22 05:40:09.039 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the office.
2025-01-22 05:40:09.039 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (32, 37) -->  moved to the office.
2025-01-22 05:40:09.039 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went to the bathroom.
2025-01-22 05:40:09.046 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1408, 1413) --> . Sandra went to the
2025-01-22 05:40:09.047 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the bedroom.
2025-01-22 05:40:09.069 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3640, 3645) -->  Hon. Mary moved to
2025-01-22 05:40:09.069 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel went to the office.
2025-01-22 05:40:09.103 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6784, 6789) --> . Daniel went to the
2025-01-22 05:40:09.103 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra moved to the garden.
2025-01-22 05:40:09.108 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (966, 971) --> . Sandra moved to the
2025-01-22 05:40:09.108 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Sandra picked up the apple there.
2025-01-22 05:40:09.123 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (3096, 3102) --> . Sandra picked up the apple
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:40:09.914 | INFO     | test_jbb_embedding:begin_test:693 - The office.<|eot_id|>
2025-01-22 05:40:09.914 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8152])
2025-01-22 05:40:12.130 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [308.75986842105266, 29.0266209380748, 138.96180555555554, 27.881855709876543, 28.577674278846153], 'topk_indices': array([8001, 4165,    4, 8137, 4166, 8135, 8141, 8134, 5604,    9, 8139,
       8050, 8143, 8147, 8040, 8142, 8148,   14, 8140,    0]), 'topk_tokens': ['\n', ' kitchen', '\n\n', ' was', '.', ':', ' the', 'Question', ' discarded', ':', ' milk', ' location', '?', '<|eot_id|>', '.\n\n', ' kitchen', '<|start_header_id|>', '\n', ' before', '<|begin_of_text|>'], 'evidence_proportions': [307.125, 299.875, 534.625, 98.265625]}, 'weight': {'score': [23.460526315789473, 23.246173743102393, 22.30251736111111, 23.249864969135803, 29.23106971153846], 'topk_indices': array([3324, 3297, 3217, 3169, 7413, 7375, 1498, 1436, 4325, 4309, 5134,
       5195, 7152, 7096, 3506, 3480, 4982, 4953, 4905, 4930]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.990625, 20.0703125, 27.845703125, 28.498046875]}, 'saliency': {'score': [1.8914280941611843, 0.16120511165504292, 0.8243594699435763, 0.15419921121479552, 0.20579968965970552], 'topk_indices': array([3878, 8145, 8006,    0, 3615, 8137,   14, 8049, 8136,    8, 5606,
       8143, 4165, 8040, 8134, 8050, 5604, 8139, 8140, 8142]), 'topk_tokens': [' about', 'Answer', ' context', '<|begin_of_text|>', ' travelled', ' was', '\n', ' first', ' Where', ' Date', ' milk', '?', ' kitchen', '.\n\n', 'Question', ' location', ' discarded', ' milk', ' before', ' kitchen'], 'evidence_proportions': [1.698046875, 1.4236653645833333, 4.01806640625, 0.708160400390625]}}, 'pred_res': 'The office.<|eot_id|>', 'score': 0}
2025-01-22 05:40:12.135 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:40:12.135 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-68_pid-3_4-5-7-8.pkl | len: 3 |  size: 2.01 KB
Processing depth (4, 5, 7, 8):   4%|▍         | 4/100 [01:23<33:26, 20.90s/it]is_0k: False
your chose emoji: ['⚪', '🧍🏾\u200d♀', '🖐️', '🧑🏽\u200d✈', '📆', '🏛️', '⛵', '🏳️\u200d⚧', '🛶', '👩\u200d🦱']
emoji:
O: ⚪ [158, 248, 103]
N: �🧑🏽‍� [230, 9468, 100, 239, 9468, 237, 121, 102470, 38798]

O: 🧍🏾‍♀ [9468, 100, 235, 9468, 237, 122, 102470, 32990]
N: �� [113, 158, 249]

O: 🖐️ [9468, 244, 238, 31643]
N: ♀🧍🏾‍ [32990, 9468, 100, 235, 9468, 237, 122, 102470]

O: 🧑🏽‍✈ [9468, 100, 239, 9468, 237, 121, 102470, 38798, 230]
N: �� [114, 9468, 249]

O: 📆 [9468, 241, 228]
N: ️🖐 [31643, 9468, 244, 238]

O: 🏛️ [9468, 237, 249, 31643]
N: ️🏛 [31643, 9468, 237, 249]

O: ⛵ [158, 249, 113]
N: �� [103, 158, 248]

O: 🏳️‍⚧ [9468, 237, 111, 31643, 102470, 158, 248, 100]
N: �� [228, 9468, 241]

O: 🛶 [9468, 249, 114]
N: �🏳️‍� [100, 9468, 237, 111, 31643, 102470, 158, 248]

O: 👩‍🦱 [9468, 239, 102, 102470, 9468, 99, 109]
N: �👩‍� [109, 9468, 239, 102, 102470, 9468, 99]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:11,  3.97s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:09,  4.57s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.77s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.27s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.74s/it]
Processing depth (0, 2, 3, 6):   4%|▍         | 4/100 [01:39<33:26, 20.90s/it]2025-01-22 05:40:28.790 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the garden.
2025-01-22 05:40:28.791 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  travelled to the garden.
2025-01-22 05:40:28.791 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the kitchen.
2025-01-22 05:40:28.802 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2022, 2028) -->  cable. John went back to
2025-01-22 05:40:28.802 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John discarded the milk.
2025-01-22 05:40:28.816 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2961, 2965) -->  John discarded the milk
2025-01-22 05:40:28.816 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra dropped the apple.
2025-01-22 05:40:28.840 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4921, 4925) -->  Sandra dropped the apple
2025-01-22 05:40:28.840 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went to the garden.
2025-01-22 05:40:28.840 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (32, 37) -->  to the garden. Sandra
2025-01-22 05:40:28.841 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the office.
2025-01-22 05:40:28.841 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (33, 38) -->  the garden. Sandra moved
2025-01-22 05:40:28.841 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went to the bathroom.
2025-01-22 05:40:28.848 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1519, 1524) --> . Sandra went to the
2025-01-22 05:40:28.848 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the bedroom.
2025-01-22 05:40:28.871 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3772, 3777) --> . Mary moved to the
2025-01-22 05:40:28.871 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel went to the office.
2025-01-22 05:40:28.905 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6799, 6804) --> . Daniel went to the
2025-01-22 05:40:28.905 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra moved to the garden.
2025-01-22 05:40:28.905 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (32, 37) -->  to the garden. Sandra
2025-01-22 05:40:28.905 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Sandra picked up the apple there.
2025-01-22 05:40:28.921 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (3239, 3245) --> . Sandra picked up the apple
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:40:29.706 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 05:40:29.706 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8161])
2025-01-22 05:40:31.934 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [294.50657894736844, 28.04793912297893, 212.296875, 26.605631088913555, 20.26881167763158], 'topk_indices': array([8146, 8143, 8155, 2962,   45,  365, 8015, 8144,   24, 8148, 2030,
        337,   14, 8150, 8152, 8156, 8059, 8151, 8149,    0]), 'topk_tokens': [' was', 'Question', ':', ' discarded', '\n\n\n', ' past', ' context', ':', '\n\n', ' milk', '.', ' century', '\n', ' the', '?', '<|eot_id|>', ' location', ' kitchen', ' before', '<|begin_of_text|>'], 'evidence_proportions': [434.25, 264.8229166666667, 417.75, 41.109375]}, 'weight': {'score': [24.797286184210527, 23.257115843949045, 21.88324652777778, 23.259606417252435, 29.40844298245614], 'topk_indices': array([3333, 3306, 3219, 3171, 7396, 7434, 1417, 1479, 4291, 4307, 5180,
       5119, 7111, 7167, 3515, 3489, 4944, 4891, 4916, 4973]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.64375, 23.759114583333332, 27.845703125, 28.498046875]}, 'saliency': {'score': [1.7937782689144737, 0.15820847791179263, 1.1735187106662326, 0.14986873264009318, 0.14846212822094298], 'topk_indices': array([ 504, 2964,   31,  520,   34, 8145,  336,   45, 8152,  365, 8015,
       8154, 8143, 2029,  337, 8148, 2962, 8059, 8149, 8151]), 'topk_tokens': ['fect', ' milk', ' travelled', ' instead', ' garden', ' Where', ' past', '\n\n\n', '?', ' past', ' context', 'Answer', 'Question', ' kitchen', ' century', ' milk', ' discarded', ' location', ' before', ' kitchen'], 'evidence_proportions': [2.344140625, 1.3728841145833333, 3.245361328125, 0.28558349609375]}}, 'pred_res': 'The garden.<|eot_id|>', 'score': 100}
2025-01-22 05:40:31.941 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:40:31.941 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-68_pid-4_0-2-3-6.pkl | len: 3 |  size: 2.0 KB
Processing depth (0, 2, 3, 6):   5%|▌         | 5/100 [01:43<32:28, 20.51s/it]Processing depth (0, 2, 3, 6):   5%|▌         | 5/100 [01:43<32:41, 20.65s/it]
2025-01-22 05:40:32.006 | INFO     | __main__:<module>:82 - Selected idx: 69
2025-01-22 05:40:32.006 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the location prior to the place where the football was discarded, left or dropped?
2025-01-22 05:40:32.006 | INFO     | __main__:<module>:84 - Answer: garden
2025-01-22 05:40:32.006 | INFO     | __main__:<module>:85 - Tag: 4-hop
2025-01-22 05:40:32.006 | INFO     | __main__:<module>:86 - Needle: [' Mary moved to the bedroom.', ' John travelled to the garden.', ' Sandra went to the bathroom.', ' Sandra moved to the office.', ' John grabbed the football.', ' Sandra moved to the garden.', ' Sandra picked up the apple there.', ' John went back to the kitchen.', ' Sandra went to the garden.', ' Daniel went to the office.', ' John discarded the football.', ' Sandra dropped the apple.']
2025-01-22 05:40:32.006 | INFO     | __main__:<module>:87 - Real Needle: [' John travelled to the garden.', ' John grabbed the football.', ' John went back to the kitchen.', ' John discarded the football.', ' Sandra dropped the apple.']
2025-01-22 05:40:32.006 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['🚗', '🍱', '🧗🏼\u200d♂', '🏄🏽\u200d♀️', '🇮🇪', '📨', '👩🏻\u200d❤️\u200d👩🏿', '🛳', '🍤', '🥲']
emoji:
O: 🚗 [9468, 248, 245]
N: 👩🏻‍❤️‍👩🏿 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 31643, 102470, 9468, 239, 102, 9468, 237, 123]

O: 🍱 [9468, 235, 109]
N: 🍱 [9468, 235, 109]

O: 🧗🏼‍♂ [9468, 100, 245, 9468, 237, 120, 102470, 17245, 224]
N: 🚗 [9468, 248, 245]

O: 🏄🏽‍♀️ [9468, 237, 226, 9468, 237, 121, 102470, 32990, 31643]
N: 📨 [9468, 119410]

O: 🇮🇪 [9468, 229, 106, 9468, 229, 103]
N: 🍤 [9468, 235, 97]

O: 📨 [9468, 119410]
N: 🇮🇪 [9468, 229, 106, 9468, 229, 103]

O: 👩🏻‍❤️‍👩🏿 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 31643, 102470, 9468, 239, 102, 9468, 237, 123]
N: 🧗🏼‍♂ [9468, 100, 245, 9468, 237, 120, 102470, 17245, 224]

O: 🛳 [9468, 249, 111]
N: 🛳 [9468, 249, 111]

O: 🍤 [9468, 235, 97]
N: 🏄🏽‍♀️ [9468, 237, 226, 9468, 237, 121, 102470, 32990, 31643]

O: 🥲 [9468, 98, 110]
N: 🥲 [9468, 98, 110]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.73s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.59s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.23s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.10s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.60s/it]
Processing depth (2, 4, 5, 7, 9):   0%|          | 0/100 [00:15<?, ?it/s]2025-01-22 05:40:48.138 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the garden.
2025-01-22 05:40:48.157 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1810, 1815) --> . John travelled to the
2025-01-22 05:40:48.157 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John grabbed the football.
2025-01-22 05:40:48.176 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3583, 3587) -->  John grabbed the football
2025-01-22 05:40:48.176 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the kitchen.
2025-01-22 05:40:48.197 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4161, 4167) --> . John went back to the
2025-01-22 05:40:48.197 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John discarded the football.
2025-01-22 05:40:48.224 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5665, 5669) -->  John discarded the football
2025-01-22 05:40:48.224 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra dropped the apple.
2025-01-22 05:40:48.266 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7266, 7270) -->  Sandra dropped the apple
2025-01-22 05:40:48.266 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bedroom.
2025-01-22 05:40:48.272 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1136, 1141) --> . Mary moved to the
2025-01-22 05:40:48.272 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went to the bathroom.
2025-01-22 05:40:48.290 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3601, 3606) -->  went to the garden.
2025-01-22 05:40:48.290 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the office.
2025-01-22 05:40:48.311 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4166, 4171) -->  the kitchen. Sandra moved
2025-01-22 05:40:48.311 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra moved to the garden.
2025-01-22 05:40:48.328 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3601, 3606) -->  went to the garden.
2025-01-22 05:40:48.329 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra picked up the apple there.
2025-01-22 05:40:48.330 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (251, 257) --> . Sandra picked up the apple
2025-01-22 05:40:48.330 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra went to the garden.
2025-01-22 05:40:48.348 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (3600, 3605) -->  Sandra went to the garden
2025-01-22 05:40:48.348 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Daniel went to the office.
2025-01-22 05:40:48.367 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (3853, 3858) --> . Daniel went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:40:49.181 | INFO     | test_jbb_embedding:begin_test:693 - The office.<|eot_id|>
2025-01-22 05:40:49.182 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8213])
2025-01-22 05:40:51.530 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [208.33152173913044, 24.24159604734664, 115.1328125, 23.321386156062278, 36.52107319078947], 'topk_indices': array([3596,    4, 8187, 8200, 8199, 3586,   23, 3587, 8058, 8198, 8092,
       3591,    9,   24, 8102, 8208, 3590,   14, 8209,    0]), 'topk_tokens': ['�', '\n\n', ':', ' discarded', ' was', ' football', '4', '.', ' context', ' football', '.\n\n', '�', ':', '\n\n', ' location', '<|eot_id|>', '�', '\n', '<|start_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [157.35, 377.90625, 75.28125, 369.4375, 140.953125]}, 'weight': {'score': [24.18648097826087, 23.284332780550145, 21.97634548611111, 23.287561680152017, 29.388363486842106], 'topk_indices': array([3332, 3359, 3246, 3198, 7443, 7481, 1508, 1446, 4385, 4401, 5257,
       5196, 7215, 7159, 3547, 3573, 5021, 4998, 4973, 5050]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.990625, 27.306640625, 20.0703125, 28.173828125, 28.498046875]}, 'saliency': {'score': [1.397742229959239, 0.13544745663472949, 0.6668565538194444, 0.12954289524143373, 0.26319062082391037], 'topk_indices': array([  14, 8196, 8101, 3589, 3597, 8092, 8192, 5668,   24,    8, 3588,
       8186, 3586, 8058, 5666, 3590, 8200, 8102, 8198, 3591]), 'topk_tokens': ['\n', ' where', ' first', '�', '�', '.\n\n', ' prior', ' football', '\n\n', ' Date', '�', 'Question', ' football', ' context', ' discarded', '�', ' discarded', ' location', ' football', '�'], 'evidence_proportions': [0.8359375, 2.65234375, 0.3991495768229167, 2.8050537109375, 0.93597412109375]}}, 'pred_res': 'The office.<|eot_id|>', 'score': 0}
2025-01-22 05:40:51.564 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:40:51.564 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-69_pid-0_2-4-5-7-9.pkl | len: 3 |  size: 2.05 KB
Processing depth (2, 4, 5, 7, 9):   1%|          | 1/100 [00:19<32:07, 19.47s/it]is_0k: False
your chose emoji: ['🚴', '🦌', '🧑🏾\u200d❤\u200d💋\u200d🧑🏼', '\U0001fae9', '👨🏻\u200d🦽\u200d➡️', '🛀🏿', '🌦️', '👩🏽\u200d❤️\u200d👨🏼', '🇮🇶', '🐪']
emoji:
O: 🚴 [9468, 248, 112]
N: 🦌 [9468, 99, 234]

O: 🦌 [9468, 99, 234]
N: 👨🏻‍🦽‍➡️ [9468, 239, 101, 9468, 237, 119, 102470, 9468, 99, 121, 102470, 98115, 94, 31643]

O: 🧑🏾‍❤‍💋‍🧑🏼 [9468, 100, 239, 9468, 237, 122, 102470, 121643, 102470, 93273, 233, 102470, 9468, 100, 239, 9468, 237, 120]
N: 🛀🏿 [9468, 249, 222, 9468, 237, 123]

O: 🫩 [9468, 104, 102]
N: 🧑🏾‍❤‍💋‍🧑🏼 [9468, 100, 239, 9468, 237, 122, 102470, 121643, 102470, 93273, 233, 102470, 9468, 100, 239, 9468, 237, 120]

O: 👨🏻‍🦽‍➡️ [9468, 239, 101, 9468, 237, 119, 102470, 9468, 99, 121, 102470, 98115, 94, 31643]
N: 🫩 [9468, 104, 102]

O: 🛀🏿 [9468, 249, 222, 9468, 237, 123]
N: 👩🏽‍❤️‍👨🏼 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 120]

O: 🌦️ [9468, 234, 99, 31643]
N: 🇮🇶 [9468, 229, 106, 9468, 229, 114]

O: 👩🏽‍❤️‍👨🏼 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 120]
N: 🚴 [9468, 248, 112]

O: 🇮🇶 [9468, 229, 106, 9468, 229, 114]
N: 🌦️ [9468, 234, 99, 31643]

O: 🐪 [9468, 238, 103]
N: 🐪 [9468, 238, 103]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.94s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.79s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.14s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.66s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.35s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 1, 5, 7, 9):   1%|          | 1/100 [00:34<32:07, 19.47s/it]2025-01-22 05:41:06.876 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the garden.
2025-01-22 05:41:06.876 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  travelled to the garden.
2025-01-22 05:41:06.876 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John grabbed the football.
2025-01-22 05:41:06.880 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (829, 833) -->  John grabbed the football
2025-01-22 05:41:06.881 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the kitchen.
2025-01-22 05:41:06.902 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4212, 4218) -->  John went back to the kitchen
2025-01-22 05:41:06.902 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John discarded the football.
2025-01-22 05:41:06.933 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5641, 5645) -->  John discarded the football
2025-01-22 05:41:06.933 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra dropped the apple.
2025-01-22 05:41:06.968 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7103, 7107) -->  dropped the apple.
2025-01-22 05:41:06.968 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bedroom.
2025-01-22 05:41:06.976 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1238, 1243) -->  Republican. Mary moved to
2025-01-22 05:41:06.976 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went to the bathroom.
2025-01-22 05:41:06.996 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3629, 3634) --> . Sandra went to the
2025-01-22 05:41:06.996 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the office.
2025-01-22 05:41:07.017 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4216, 4221) -->  the kitchen. Sandra moved
2025-01-22 05:41:07.017 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra moved to the garden.
2025-01-22 05:41:07.035 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3630, 3635) -->  Sandra went to the garden
2025-01-22 05:41:07.035 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra picked up the apple there.
2025-01-22 05:41:07.037 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (257, 263) --> . Sandra picked up the apple
2025-01-22 05:41:07.037 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra went to the garden.
2025-01-22 05:41:07.057 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (3629, 3634) --> . Sandra went to the
2025-01-22 05:41:07.058 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Daniel went to the office.
2025-01-22 05:41:07.077 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (3869, 3874) --> . Daniel went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:41:26.835 | INFO     | test_jbb_embedding:begin_test:693 - John's location prior to the place where the football was discarded, left or dropped was the kitchen.<|eot_id|>
2025-01-22 05:41:26.835 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8159])
2025-01-22 05:41:29.971 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [276.8777173913044, 28.25311657681941, 127.94314236111111, 27.104504118844872, 24.296635841836736], 'topk_indices': array([ 833,   68, 5964, 5644, 6100, 5642, 8146,   14, 5645,   24, 8144,
       5958, 5956, 6093, 6101, 5965, 8154, 6094, 8155,    0]), 'topk_tokens': ['.', 'E', ' the', ' football', ' to', ' discarded', ' discarded', '\n', '.', '\n\n', ' football', ' way', '\n', '\n', ' the', ' office', '<|eot_id|>', 'the', '<|start_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [240.825, 369.1875, 99.16666666666667, 615.125, 157.953125]}, 'weight': {'score': [24.06080163043478, 23.23964905966675, 23.067708333333332, 23.238082153214858, 29.007015306122447], 'topk_indices': array([3294, 3267, 3181, 3133, 7435, 7397, 1429, 1491, 4289, 4305, 5112,
       5173, 7112, 7168, 3450, 3476, 4877, 4902, 4954, 4925]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.64375, 27.306640625, 24.061197916666668, 28.173828125, 20.97265625]}, 'saliency': {'score': [1.8553944463315217, 0.1559456467949798, 0.7711351182725694, 0.14838867488796587, 0.17455618722098215], 'topk_indices': array([8138,  830,   23,    0,   68,  105, 5641,   24,   67, 5646, 8048,
       8132,  832, 5958, 5644, 6094, 5965, 8144, 5642, 8146]), 'topk_tokens': [' prior', ' grabbed', '4', '<|begin_of_text|>', 'E', 'ION', ' John', '\n\n', 'ION', '�', ' location', 'Question', ' football', ' way', ' football', 'the', ' office', ' football', ' discarded', ' discarded'], 'evidence_proportions': [1.3236328125, 2.6412353515625, 0.6302083333333334, 4.628662109375, 0.79876708984375]}}, 'pred_res': "John's location prior to the place where the football was discarded, left or dropped was the kitchen.<|eot_id|>", 'score': 0}
2025-01-22 05:41:29.978 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:41:29.978 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-69_pid-1_0-1-5-7-9.pkl | len: 3 |  size: 2.14 KB
Processing depth (0, 1, 5, 7, 9):   2%|▏         | 2/100 [00:57<49:59, 30.61s/it]is_0k: False
your chose emoji: ['\U0001faad', '🔬', '👨🏼\u200d💼', '🍢', '😦', '🦸🏽\u200d♀️', '🥤', '🇨🇫', '\U0001fac5🏾', '🧗🏿']
emoji:
O: 🪭 [9468, 103, 255]
N: 🔬 [9468, 242, 105]

O: 🔬 [9468, 242, 105]
N: 🪭 [9468, 103, 255]

O: 👨🏼‍💼 [9468, 239, 101, 9468, 237, 120, 102470, 93273, 120]
N: 🍢 [9468, 235, 95]

O: 🍢 [9468, 235, 95]
N: 👨🏼‍💼 [9468, 239, 101, 9468, 237, 120, 102470, 93273, 120]

O: 😦 [76460, 99]
N: 🫅🏾 [9468, 104, 227, 9468, 237, 122]

O: 🦸🏽‍♀️ [9468, 99, 116, 9468, 237, 121, 102470, 32990, 31643]
N: 🇨🇫 [9468, 229, 101, 9468, 229, 104]

O: 🥤 [9468, 109261]
N: 😦 [76460, 99]

O: 🇨🇫 [9468, 229, 101, 9468, 229, 104]
N: 🦸🏽‍♀️ [9468, 99, 116, 9468, 237, 121, 102470, 32990, 31643]

O: 🫅🏾 [9468, 104, 227, 9468, 237, 122]
N: 🥤 [9468, 109261]

O: 🧗🏿 [9468, 100, 245, 9468, 237, 123]
N: 🧗🏿 [9468, 100, 245, 9468, 237, 123]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.13s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.43s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.52s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.22s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.66s/it]
Processing depth (0, 4, 5, 7, 8):   2%|▏         | 2/100 [01:14<49:59, 30.61s/it]2025-01-22 05:41:46.271 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the garden.
2025-01-22 05:41:46.271 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  travelled to the garden.
2025-01-22 05:41:46.271 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John grabbed the football.
2025-01-22 05:41:46.289 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3717, 3721) -->  John grabbed the football
2025-01-22 05:41:46.289 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the kitchen.
2025-01-22 05:41:46.310 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4230, 4236) -->  John went back to the kitchen
2025-01-22 05:41:46.311 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John discarded the football.
2025-01-22 05:41:46.338 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5671, 5675) -->  John discarded the football
2025-01-22 05:41:46.338 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra dropped the apple.
2025-01-22 05:41:46.370 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6626, 6630) -->  Sandra dropped the apple
2025-01-22 05:41:46.370 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bedroom.
2025-01-22 05:41:46.377 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1272, 1277) --> . Mary moved to the
2025-01-22 05:41:46.377 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went to the bathroom.
2025-01-22 05:41:46.396 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3765, 3770) --> . Sandra went to the
2025-01-22 05:41:46.396 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the office.
2025-01-22 05:41:46.417 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4234, 4239) -->  the kitchen. Sandra moved
2025-01-22 05:41:46.417 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra moved to the garden.
2025-01-22 05:41:46.436 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3766, 3771) -->  Sandra went to the garden
2025-01-22 05:41:46.436 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra picked up the apple there.
2025-01-22 05:41:46.438 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (257, 263) --> . Sandra picked up the apple
2025-01-22 05:41:46.438 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra went to the garden.
2025-01-22 05:41:46.457 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (3765, 3770) --> . Sandra went to the
2025-01-22 05:41:46.457 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Daniel went to the office.
2025-01-22 05:41:46.477 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (3908, 3913) -->  Daniel went to the office
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:41:47.278 | INFO     | test_jbb_embedding:begin_test:693 - St. Paul<|eot_id|>
2025-01-22 05:41:47.278 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8195])
2025-01-22 05:41:49.514 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [333.6277173913044, 36.40124496828495, 149.4140625, 35.06144028750461, 25.152285447761194], 'topk_indices': array([8168, 4295, 8084,   23, 3720, 8169, 3721, 8040, 5671, 8182, 6065,
       5674,   14,   24, 8180, 5672, 5675,    0, 8190, 8191]), 'topk_tokens': ['Question', 'nes', ' location', '4', ' football', ':', '.', ' context', ' John', ' discarded', ' in', ' football', '\n', '\n\n', ' football', ' discarded', '.', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [236.9, 435.90625, 115.98958333333333, 777.8125, 234.53125]}, 'weight': {'score': [25.369565217391305, 23.27257029153452, 22.952256944444443, 23.268061186877993, 29.471548507462686], 'topk_indices': array([3250, 3277, 3170, 3122, 7477, 7439, 1480, 1418, 4331, 4347, 5215,
       5154, 7154, 7210, 3459, 3433, 4931, 4956, 5008, 4979]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.64375, 27.306640625, 24.061197916666668, 28.173828125, 28.498046875]}, 'saliency': {'score': [2.3095278532608696, 0.20076945096174373, 0.9146321614583334, 0.19165279033626675, 0.18545509452250467], 'topk_indices': array([  23, 8178, 8170, 3718,    0, 5929,   24, 7386, 8174, 4295, 8084,
       5909, 8040, 5671, 8168, 3720, 5674, 8182, 8180, 5672]), 'topk_tokens': ['4', ' where', ' Where', ' grabbed', '<|begin_of_text|>', ' which', '\n\n', 'nes', ' prior', 'nes', ' location', 'ayers', ' context', ' John', 'Question', ' football', ' football', ' discarded', ' football', ' discarded'], 'evidence_proportions': [1.2181640625, 3.1534423828125, 0.7451171875, 5.89794921875, 1.5880126953125]}}, 'pred_res': 'St. Paul<|eot_id|>', 'score': 0}
2025-01-22 05:41:49.519 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:41:49.519 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-69_pid-2_0-4-5-7-8.pkl | len: 3 |  size: 2.09 KB
Processing depth (0, 4, 5, 7, 8):   3%|▎         | 3/100 [01:17<41:19, 25.56s/it]is_0k: False
your chose emoji: ['🇦🇨', '👨🏾\u200d❤️\u200d👨🏻', '🧖🏽\u200d♂', '👩🏻\u200d🦯', '🧑🏻', '🧎\u200d♀\u200d➡️', '📡', '🏾', '✌', '🎯']
emoji:
O: 🇦🇨 [9468, 229, 99, 9468, 229, 101]
N: 🏾 [9468, 237, 122]

O: 👨🏾‍❤️‍👨🏻 [9468, 239, 101, 9468, 237, 122, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 119]
N: 👨🏾‍❤️‍👨🏻 [9468, 239, 101, 9468, 237, 122, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 119]

O: 🧖🏽‍♂ [9468, 100, 244, 9468, 237, 121, 102470, 17245, 224]
N: 🧖🏽‍♂ [9468, 100, 244, 9468, 237, 121, 102470, 17245, 224]

O: 👩🏻‍🦯 [9468, 239, 102, 9468, 237, 119, 102470, 9468, 99, 107]
N: ✌ [38798, 234]

O: 🧑🏻 [9468, 100, 239, 9468, 237, 119]
N: 🧎‍♀‍➡️ [9468, 100, 236, 102470, 32990, 102470, 98115, 94, 31643]

O: 🧎‍♀‍➡️ [9468, 100, 236, 102470, 32990, 102470, 98115, 94, 31643]
N: 🧑🏻 [9468, 100, 239, 9468, 237, 119]

O: 📡 [9468, 241, 94]
N: 📡 [9468, 241, 94]

O: 🏾 [9468, 237, 122]
N: 👩🏻‍🦯 [9468, 239, 102, 9468, 237, 119, 102470, 9468, 99, 107]

O: ✌ [38798, 234]
N: 🇦🇨 [9468, 229, 99, 9468, 229, 101]

O: 🎯 [9468, 236, 107]
N: 🎯 [9468, 236, 107]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.43s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.67s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.21s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.72s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.34s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 3, 4, 6, 8):   3%|▎         | 3/100 [01:32<41:19, 25.56s/it]2025-01-22 05:42:04.650 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the garden.
2025-01-22 05:42:04.651 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  travelled to the garden.
2025-01-22 05:42:04.651 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John grabbed the football.
2025-01-22 05:42:04.665 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2939, 2943) -->  John grabbed the football
2025-01-22 05:42:04.665 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the kitchen.
2025-01-22 05:42:04.683 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3626, 3632) -->  Hon. John went back to
2025-01-22 05:42:04.683 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John discarded the football.
2025-01-22 05:42:04.706 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4789, 4793) -->  John discarded the football
2025-01-22 05:42:04.706 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra dropped the apple.
2025-01-22 05:42:04.738 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6648, 6652) -->  Sandra dropped the apple
2025-01-22 05:42:04.738 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bedroom.
2025-01-22 05:42:04.744 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1136, 1141) --> . Mary moved to the
2025-01-22 05:42:04.744 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went to the bathroom.
2025-01-22 05:42:04.762 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3658, 3663) --> . Sandra went to the
2025-01-22 05:42:04.762 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the office.
2025-01-22 05:42:04.783 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4237, 4242) -->  Sandra moved to the office
2025-01-22 05:42:04.783 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra moved to the garden.
2025-01-22 05:42:04.802 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3659, 3664) -->  Sandra went to the garden
2025-01-22 05:42:04.802 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra picked up the apple there.
2025-01-22 05:42:04.803 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (257, 263) --> . Sandra picked up the apple
2025-01-22 05:42:04.803 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra went to the garden.
2025-01-22 05:42:04.821 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (3658, 3663) --> . Sandra went to the
2025-01-22 05:42:04.821 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Daniel went to the office.
2025-01-22 05:42:04.840 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (3898, 3903) --> . Daniel went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:42:07.814 | INFO     | test_jbb_embedding:begin_test:693 - the kitchen<|eot_id|>
2025-01-22 05:42:07.814 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8185])
2025-01-22 05:42:10.895 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [158.33016304347825, 19.09423088666341, 99.48611111111111, 18.34425744248985, 34.78515625], 'topk_indices': array([  67, 4795, 8149,   25, 8030,   23,    3,    9,   68, 8064,    1,
       8183, 8074,  105, 4796,   24,   14, 8180,    0, 8181]), 'topk_tokens': ['ION', '�', '.', '<|eot_id|>', ' context', '4', '<|end_header_id|>', ':', 'E', '.\n\n', '<|start_header_id|>', '<|end_header_id|>', ' location', 'ION', '�', '\n\n', '\n', '<|eot_id|>', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [182.2, 198.546875, 169.51041666666666, 161.796875, 68.0390625]}, 'weight': {'score': [25.373641304347824, 23.267745099535905, 22.403211805555557, 23.265615389346785, 29.65297379032258], 'topk_indices': array([3277, 3304, 3197, 3149, 7405, 7443, 1446, 1508, 4335, 4319, 5155,
       5216, 7126, 7182, 3486, 3460, 4932, 4980, 5009, 4957]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.64375, 27.306640625, 24.076822916666668, 28.173828125, 28.498046875]}, 'saliency': {'score': [1.0202583644701086, 0.10686883148357353, 0.5846506754557291, 0.10216860936010348, 0.2575164302702873], 'topk_indices': array([  20,   23, 4795, 4790,    0, 8064, 8170, 8164, 8178, 4794, 3633,
         67,   68, 2942, 8158,   24,  105, 8030, 4796, 8074]), 'topk_tokens': [' Jul', '4', '�', ' discarded', '<|begin_of_text|>', '.\n\n', ' football', ' prior', 'Answer', '�', ' kitchen', 'ION', 'E', ' football', 'Question', '\n\n', 'ION', ' context', '�', ' location'], 'evidence_proportions': [1.000634765625, 1.452880859375, 0.9672444661458334, 1.23846435546875, 0.473480224609375]}}, 'pred_res': 'the kitchen<|eot_id|>', 'score': 0}
2025-01-22 05:42:10.899 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:42:10.899 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-69_pid-3_0-3-4-6-8.pkl | len: 3 |  size: 2.08 KB
Processing depth (0, 3, 4, 6, 8):   4%|▍         | 4/100 [01:38<38:15, 23.91s/it]is_0k: False
your chose emoji: ['💃🏾', '🧔🏾\u200d♂️', '‼️', '💎', '🖖🏽', '🙎🏽\u200d♀', '🤦🏻', '🤚🏽', '🧖🏽\u200d♂️', '🛌🏿']
emoji:
O: 💃🏾 [93273, 225, 9468, 237, 122]
N: 🤦🏻 [9468, 97, 99, 9468, 237, 119]

O: 🧔🏾‍♂️ [9468, 100, 242, 9468, 237, 122, 102470, 17245, 224, 31643]
N: 🙎🏽‍♀ [9468, 247, 236, 9468, 237, 121, 102470, 32990]

O: ‼️ [378, 120, 31643]
N: 🖖🏽 [9468, 244, 244, 9468, 237, 121]

O: 💎 [93273, 236]
N: 🧔🏾‍♂️ [9468, 100, 242, 9468, 237, 122, 102470, 17245, 224, 31643]

O: 🖖🏽 [9468, 244, 244, 9468, 237, 121]
N: ‼️ [378, 120, 31643]

O: 🙎🏽‍♀ [9468, 247, 236, 9468, 237, 121, 102470, 32990]
N: 🧖🏽‍♂️ [9468, 100, 244, 9468, 237, 121, 102470, 17245, 224, 31643]

O: 🤦🏻 [9468, 97, 99, 9468, 237, 119]
N: 💎 [93273, 236]

O: 🤚🏽 [9468, 97, 248, 9468, 237, 121]
N: 💃🏾 [93273, 225, 9468, 237, 122]

O: 🧖🏽‍♂️ [9468, 100, 244, 9468, 237, 121, 102470, 17245, 224, 31643]
N: 🤚🏽 [9468, 97, 248, 9468, 237, 121]

O: 🛌🏿 [9468, 249, 234, 9468, 237, 123]
N: 🛌🏿 [9468, 249, 234, 9468, 237, 123]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.72s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.93s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.77s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.30s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.85s/it]
Processing depth (0, 2, 5, 7, 9):   4%|▍         | 4/100 [01:56<38:15, 23.91s/it]2025-01-22 05:42:28.186 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the garden.
2025-01-22 05:42:28.187 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  travelled to the garden.
2025-01-22 05:42:28.187 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John grabbed the football.
2025-01-22 05:42:28.197 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1870, 1874) -->  grabbed the football.
2025-01-22 05:42:28.197 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the kitchen.
2025-01-22 05:42:28.218 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4220, 4226) -->  John went back to the kitchen
2025-01-22 05:42:28.218 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John discarded the football.
2025-01-22 05:42:28.245 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5713, 5717) -->  John discarded the football
2025-01-22 05:42:28.245 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra dropped the apple.
2025-01-22 05:42:28.280 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7274, 7278) -->  Sandra dropped the apple
2025-01-22 05:42:28.280 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the bedroom.
2025-01-22 05:42:28.286 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1272, 1277) --> . Mary moved to the
2025-01-22 05:42:28.286 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went to the bathroom.
2025-01-22 05:42:28.304 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3637, 3642) --> . Sandra went to the
2025-01-22 05:42:28.304 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the office.
2025-01-22 05:42:28.325 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4224, 4229) -->  the kitchen. Sandra moved
2025-01-22 05:42:28.325 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra moved to the garden.
2025-01-22 05:42:28.342 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3638, 3643) -->  Sandra went to the garden
2025-01-22 05:42:28.342 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra picked up the apple there.
2025-01-22 05:42:28.344 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (257, 263) --> . Sandra picked up the apple
2025-01-22 05:42:28.344 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Sandra went to the garden.
2025-01-22 05:42:28.362 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (3637, 3642) --> . Sandra went to the
2025-01-22 05:42:28.362 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  Daniel went to the office.
2025-01-22 05:42:28.380 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (3877, 3882) --> . Daniel went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:42:29.154 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 05:42:29.155 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8185])
2025-01-22 05:42:31.385 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [236.9388586956522, 29.368137823644357, 176.5078125, 28.12922099889285, 20.327101184475808], 'topk_indices': array([ 389, 8184, 5925,  366, 6053, 8183, 8030, 8157,    9,    1,  338,
       8074, 6054, 8064,   24,  518,   14, 8181, 8180,    0]), 'topk_tokens': ['ing', '\n\n', ' office', ' past', '\n', '<|end_header_id|>', ' context', '.\n\n', ':', '<|start_header_id|>', ' century', ' location', 'the', '.\n\n', '\n\n', ' an', '\n', '<|start_header_id|>', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [287.55, 357.40625, 147.94791666666666, 347.75, 75.8828125]}, 'weight': {'score': [24.53023097826087, 23.270202964704445, 22.39474826388889, 23.270514900356748, 29.815272177419356], 'topk_indices': array([3296, 3269, 3141, 3189, 7449, 7411, 1480, 1418, 4279, 4295, 5167,
       5106, 7159, 7103, 3478, 3452, 4948, 4896, 4871, 4919]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.64375, 22.48046875, 24.061197916666668, 28.173828125, 28.498046875]}, 'saliency': {'score': [1.4594938858695652, 0.1623984496652876, 1.0890062120225694, 0.1546249136242542, 0.1539426003732989], 'topk_indices': array([ 388, 8178, 1872, 5918, 8158,   24,  337, 5714, 8064, 8164,  505,
        518, 8172, 5925, 6054, 8030,  366, 8170, 8074,  338]), 'topk_tokens': ['fect', 'Answer', ' football', ' way', 'Question', '\n\n', ' past', ' discarded', '.\n\n', ' prior', 'fect', ' an', ' discarded', ' office', 'the', ' context', ' past', ' football', ' location', ' century'], 'evidence_proportions': [1.56630859375, 1.9112548828125, 0.9418131510416666, 2.5863037109375, 0.52392578125]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 0}
2025-01-22 05:42:31.389 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:42:31.389 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-69_pid-4_0-2-5-7-9.pkl | len: 3 |  size: 2.08 KB
Processing depth (0, 2, 5, 7, 9):   5%|▌         | 5/100 [01:59<35:54, 22.68s/it]Processing depth (0, 2, 5, 7, 9):   5%|▌         | 5/100 [01:59<37:47, 23.87s/it]
2025-01-22 05:42:31.443 | INFO     | __main__:<module>:82 - Selected idx: 70
2025-01-22 05:42:31.443 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the milk before the bedroom? 
2025-01-22 05:42:31.443 | INFO     | __main__:<module>:84 - Answer: garden
2025-01-22 05:42:31.443 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 05:42:31.443 | INFO     | __main__:<module>:86 - Needle: [' Sandra moved to the garden.', ' John travelled to the bedroom.', ' Mary grabbed the milk.', ' Mary moved to the garden.', ' Daniel moved to the office.', ' John went to the hallway.', ' Sandra travelled to the kitchen.', ' Mary journeyed to the bedroom.', ' Daniel travelled to the bathroom.']
2025-01-22 05:42:31.443 | INFO     | __main__:<module>:87 - Real Needle: [' Mary grabbed the milk.', ' Mary moved to the garden.', ' Mary journeyed to the bedroom.', ' Daniel travelled to the bathroom.']
2025-01-22 05:42:31.443 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['🤵🏿\u200d♀️', '👩🏼\u200d❤️\u200d👨🏽', '🧎\u200d➡️', '🪅', '🕉', '💆🏿\u200d♀', '❌', '🏷️', '🚵🏽', '4️⃣']
emoji:
O: 🤵🏿‍♀️ [9468, 97, 113, 9468, 237, 123, 102470, 32990, 31643]
N: 💆🏿‍♀ [93273, 228, 9468, 237, 123, 102470, 32990]

O: 👩🏼‍❤️‍👨🏽 [9468, 239, 102, 9468, 237, 120, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 121]
N: 🪅 [9468, 103, 227]

O: 🧎‍➡️ [9468, 100, 236, 102470, 98115, 94, 31643]
N: 🕉 [9468, 243, 231]

O: 🪅 [9468, 103, 227]
N: ❌ [49633, 234]

O: 🕉 [9468, 243, 231]
N: 🚵🏽 [9468, 248, 113, 9468, 237, 121]

O: 💆🏿‍♀ [93273, 228, 9468, 237, 123, 102470, 32990]
N: 👩🏼‍❤️‍👨🏽 [9468, 239, 102, 9468, 237, 120, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 121]

O: ❌ [49633, 234]
N: 🧎‍➡️ [9468, 100, 236, 102470, 98115, 94, 31643]

O: 🏷️ [9468, 237, 115, 31643]
N: 🤵🏿‍♀️ [9468, 97, 113, 9468, 237, 123, 102470, 32990, 31643]

O: 🚵🏽 [9468, 248, 113, 9468, 237, 121]
N: 🏷️ [9468, 237, 115, 31643]

O: 4️⃣ [19, 31643, 158, 225, 96]
N: 4️⃣ [19, 31643, 158, 225, 96]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.11s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.40s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.20s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.81s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.34s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (2, 3, 4, 8):   0%|          | 0/100 [00:14<?, ?it/s]2025-01-22 05:42:46.610 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the milk.
2025-01-22 05:42:46.618 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1764, 1768) -->  Mary grabbed the milk
2025-01-22 05:42:46.619 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary moved to the garden.
2025-01-22 05:42:46.626 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1317, 1322) -->  moved to the garden.
2025-01-22 05:42:46.626 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bedroom.
2025-01-22 05:42:46.648 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3641, 3647) -->  Hon. Mary journeyed to
2025-01-22 05:42:46.648 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel travelled to the bathroom.
2025-01-22 05:42:46.687 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6669, 6674) --> . Daniel travelled to the
2025-01-22 05:42:46.687 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the garden.
2025-01-22 05:42:46.694 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1316, 1321) -->  Sandra moved to the garden
2025-01-22 05:42:46.694 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the bedroom.
2025-01-22 05:42:46.730 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6513, 6518) --> . John travelled to the
2025-01-22 05:42:46.730 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 05:42:46.762 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5570, 5575) -->  Daniel moved to the office
2025-01-22 05:42:46.762 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the hallway.
2025-01-22 05:42:46.782 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3516, 3521) --> . John went to the
2025-01-22 05:42:46.782 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra travelled to the kitchen.
2025-01-22 05:42:46.785 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (619, 624) --> . Sandra travelled to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:42:50.608 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 05:42:50.608 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8235])
2025-01-22 05:42:53.636 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [144.053125, 16.130424556931295, 140.105, 15.439857195166606, 22.727861328125], 'topk_indices': array([1320,    4,   25, 8234,  624, 8222,   23,  620,    9, 8123, 8084,
       8088, 8223,    1,   24, 8089,   14, 8233,    0, 8230]), 'topk_tokens': [' garden', '\n\n', '<|eot_id|>', '\n\n', ' kitchen', ' milk', '4', ' Sandra', ':', '.\n\n', '\n', ' you', ' before', '<|start_header_id|>', '\n\n', ' context', '\n', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [215.59375, 217.125, 127.13541666666667, 34.05]}, 'weight': {'score': [22.94296875, 23.32829001274581, 22.05125, 23.33312736482363, 29.724375], 'topk_indices': array([3298, 3325, 3218, 3170, 7514, 7476, 1461, 1523, 4318, 4302, 5174,
       5113, 7197, 7253, 3507, 3481, 4967, 4938, 4915, 4890]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [27.935546875, 19.534375, 24.05859375, 21.01875]}, 'saliency': {'score': [0.8816299438476562, 0.09064947629791059, 0.8692822265625, 0.08634269879179444, 0.16580795288085937], 'topk_indices': array([8219, 8204,   14, 8123,    8,    0, 3648, 8088,   24, 8087, 1767,
       8133,  621, 1320, 8222,  624, 8223, 8225,  620, 8089]), 'topk_tokens': [' Where', ' return', '\n', '.\n\n', ' Date', '<|begin_of_text|>', ' bedroom', ' you', '\n\n', ' provided', ' milk', ' location', ' travelled', ' garden', ' milk', ' kitchen', ' before', ' bedroom', ' Sandra', ' context'], 'evidence_proportions': [1.60107421875, 1.201708984375, 0.7076009114583334, 0.194830322265625]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 0}
2025-01-22 05:42:53.644 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:42:53.644 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-70_pid-0_2-3-4-8.pkl | len: 3 |  size: 2.03 KB
Processing depth (2, 3, 4, 8):   1%|          | 1/100 [00:22<36:28, 22.11s/it]is_0k: False
your chose emoji: ['🧟\u200d♂', '👰🏽\u200d♂', '👩🏽\u200d❤️\u200d💋\u200d👨🏼', '💁\u200d♀', '🏊🏼', '👨🏾\u200d⚖', '🇹🇷', '👨🏽\u200d❤️\u200d💋\u200d👨🏻', '👩🏼\u200d❤\u200d💋\u200d👩🏿', '⚪']
emoji:
O: 🧟‍♂ [9468, 100, 253, 102470, 17245, 224]
N: 🧟‍♂ [9468, 100, 253, 102470, 17245, 224]

O: 👰🏽‍♂ [9468, 239, 108, 9468, 237, 121, 102470, 17245, 224]
N: 👰🏽‍♂ [9468, 239, 108, 9468, 237, 121, 102470, 17245, 224]

O: 👩🏽‍❤️‍💋‍👨🏼 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 120]
N: 👨🏾‍⚖ [9468, 239, 101, 9468, 237, 122, 102470, 158, 248, 244]

O: 💁‍♀ [93273, 223, 102470, 32990]
N: 🇹🇷 [9468, 229, 117, 9468, 229, 115]

O: 🏊🏼 [9468, 237, 232, 9468, 237, 120]
N: 👨🏽‍❤️‍💋‍👨🏻 [9468, 239, 101, 9468, 237, 121, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 119]

O: 👨🏾‍⚖ [9468, 239, 101, 9468, 237, 122, 102470, 158, 248, 244]
N: 👩🏽‍❤️‍💋‍👨🏼 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 120]

O: 🇹🇷 [9468, 229, 117, 9468, 229, 115]
N: 💁‍♀ [93273, 223, 102470, 32990]

O: 👨🏽‍❤️‍💋‍👨🏻 [9468, 239, 101, 9468, 237, 121, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 119]
N: 👩🏼‍❤‍💋‍👩🏿 [9468, 239, 102, 9468, 237, 120, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 123]

O: 👩🏼‍❤‍💋‍👩🏿 [9468, 239, 102, 9468, 237, 120, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 123]
N: 🏊🏼 [9468, 237, 232, 9468, 237, 120]

O: ⚪ [158, 248, 103]
N: ⚪ [158, 248, 103]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.31s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.50s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.15s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.99s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.47s/it]
Processing depth (2, 5, 7, 9):   1%|          | 1/100 [00:37<36:28, 22.11s/it]2025-01-22 05:43:09.603 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the milk.
2025-01-22 05:43:09.614 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1750, 1754) -->  Mary grabbed the milk
2025-01-22 05:43:09.615 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary moved to the garden.
2025-01-22 05:43:09.622 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1302, 1307) -->  Sandra moved to the garden
2025-01-22 05:43:09.623 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bedroom.
2025-01-22 05:43:09.653 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5634, 5640) --> . Mary journeyed to the
2025-01-22 05:43:09.654 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel travelled to the bathroom.
2025-01-22 05:43:09.696 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7227, 7232) --> . Daniel travelled to the
2025-01-22 05:43:09.696 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the garden.
2025-01-22 05:43:09.702 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1301, 1306) --> . Sandra moved to the
2025-01-22 05:43:09.703 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the bedroom.
2025-01-22 05:43:09.736 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6437, 6442) --> . John travelled to the
2025-01-22 05:43:09.737 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 05:43:09.764 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5409, 5414) -->  Daniel moved to the office
2025-01-22 05:43:09.764 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the hallway.
2025-01-22 05:43:09.785 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3456, 3461) --> . John went to the
2025-01-22 05:43:09.785 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra travelled to the kitchen.
2025-01-22 05:43:09.788 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (613, 618) --> . Sandra travelled to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:43:10.599 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 05:43:10.599 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8183])
2025-01-22 05:43:12.849 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [151.623046875, 16.548695944295137, 119.06625, 15.902040021189043, 21.03716216216216], 'topk_indices': array([8164, 8182, 8168,   23, 8166, 8172,    9, 8170, 8037, 8071,    1,
         24, 8174, 8173, 8181,   14, 8171, 8179,    0, 8178]), 'topk_tokens': ['.\n\n', '\n\n', ' was', '4', ':', ' the', ':', ' milk', ' context', '.\n\n', '<|start_header_id|>', '\n\n', '?', ' bedroom', '<|end_header_id|>', '\n', ' before', '<|start_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [241.625, 185.35, 172.33333333333334, 21.0421875]}, 'weight': {'score': [23.24609375, 23.27860447715612, 21.1484375, 23.285225824530155, 29.22360641891892], 'topk_indices': array([3290, 3317, 3162, 3210, 7406, 7444, 1447, 1509, 4293, 4309, 5104,
       5165, 7177, 7121, 3505, 3479, 4929, 4881, 4906, 4958]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [27.935546875, 25.5546875, 20.052083333333332, 21.01875]}, 'saliency': {'score': [0.9616470336914062, 0.09170809591308714, 0.67867919921875, 0.0877684009937642, 0.15263428559174408], 'topk_indices': array([   8, 8176,   14,  615, 8071,   24, 1753, 1306, 8081, 4155, 8167,
        618, 5640, 8174, 8165, 8037,  614, 8170, 8171, 8173]), 'topk_tokens': [' Date', 'Answer', '\n', ' travelled', '.\n\n', '\n\n', ' milk', ' garden', ' location', ' garden', ' Where', ' kitchen', ' bedroom', '?', 'Question', ' context', ' Sandra', ' milk', ' before', ' bedroom'], 'evidence_proportions': [1.7935791015625, 1.25732421875, 0.8609212239583334, 0.121295166015625]}}, 'pred_res': 'The garden.<|eot_id|>', 'score': 100}
2025-01-22 05:43:12.867 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:43:12.867 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-70_pid-1_2-5-7-9.pkl | len: 3 |  size: 2.01 KB
Processing depth (2, 5, 7, 9):   2%|▏         | 2/100 [00:41<33:20, 20.41s/it]is_0k: False
your chose emoji: ['🤴🏼', '🖖🏽', '🏕️', '👩🏾\u200d🚀', '👦🏽', '👩🏽\u200d❤️\u200d👨🏻', '🙋🏿\u200d♀', 'ℹ', '🧏\u200d♂', '🧑🏼\u200d🦲']
emoji:
O: 🤴🏼 [9468, 97, 112, 9468, 237, 120]
N: 👩🏾‍🚀 [9468, 239, 102, 9468, 237, 122, 102470, 9468, 248, 222]

O: 🖖🏽 [9468, 244, 244, 9468, 237, 121]
N: ℹ [15284, 117]

O: 🏕️ [9468, 237, 243, 31643]
N: 👦🏽 [9468, 239, 99, 9468, 237, 121]

O: 👩🏾‍🚀 [9468, 239, 102, 9468, 237, 122, 102470, 9468, 248, 222]
N: 🖖🏽 [9468, 244, 244, 9468, 237, 121]

O: 👦🏽 [9468, 239, 99, 9468, 237, 121]
N: 🧏‍♂ [9468, 100, 237, 102470, 17245, 224]

O: 👩🏽‍❤️‍👨🏻 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 119]
N: 🏕️ [9468, 237, 243, 31643]

O: 🙋🏿‍♀ [9468, 247, 233, 9468, 237, 123, 102470, 32990]
N: 👩🏽‍❤️‍👨🏻 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 119]

O: ℹ [15284, 117]
N: 🤴🏼 [9468, 97, 112, 9468, 237, 120]

O: 🧏‍♂ [9468, 100, 237, 102470, 17245, 224]
N: 🙋🏿‍♀ [9468, 247, 233, 9468, 237, 123, 102470, 32990]

O: 🧑🏼‍🦲 [9468, 100, 239, 9468, 237, 120, 102470, 9468, 99, 110]
N: 🧑🏼‍🦲 [9468, 100, 239, 9468, 237, 120, 102470, 9468, 99, 110]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.88s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.79s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.40s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.05s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.63s/it]
Processing depth (2, 4, 8, 9):   2%|▏         | 2/100 [00:57<33:20, 20.41s/it]2025-01-22 05:43:29.250 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the milk.
2025-01-22 05:43:29.258 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1608, 1612) -->  Mary grabbed the milk
2025-01-22 05:43:29.259 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary moved to the garden.
2025-01-22 05:43:29.265 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1274, 1279) -->  Sandra moved to the garden
2025-01-22 05:43:29.265 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bedroom.
2025-01-22 05:43:29.300 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6504, 6510) --> . Mary journeyed to the
2025-01-22 05:43:29.300 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel travelled to the bathroom.
2025-01-22 05:43:29.335 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7134, 7139) -->  Daniel travelled to the bathroom
2025-01-22 05:43:29.336 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the garden.
2025-01-22 05:43:29.342 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1272, 1277) -->  Republican. Sandra moved to
2025-01-22 05:43:29.342 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the bedroom.
2025-01-22 05:43:29.373 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6334, 6339) --> . John travelled to the
2025-01-22 05:43:29.373 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 05:43:29.400 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5434, 5439) --> . Daniel moved to the
2025-01-22 05:43:29.400 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the hallway.
2025-01-22 05:43:29.417 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3326, 3331) --> . John went to the
2025-01-22 05:43:29.417 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra travelled to the kitchen.
2025-01-22 05:43:29.420 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (638, 643) -->  Sandra travelled to the kitchen
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:43:30.227 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 05:43:30.227 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8171])
2025-01-22 05:43:32.476 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [187.86015625, 22.93039668460974, 169.555, 22.073684878213804, 27.440716911764707], 'topk_indices': array([2075,  642, 8162, 2082,   14, 8161, 2213, 8159, 2214, 8169, 2215,
       2178, 2124, 8166, 2076, 2179, 2129, 2077, 8167,    0]), 'topk_tokens': ['Dub', ' kitchen', '?', "'clock", '\n', ' bedroom', '\n', ' before', 'ab', '<|end_header_id|>', 're', 're', 'u', '<|eot_id|>', 'u', 'ast', ' o', 'que', '<|start_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [302.53125, 298.25, 133.79166666666666, 50.615625]}, 'weight': {'score': [24.668359375, 23.273527342794225, 22.2725, 23.273174168101857, 29.446691176470587], 'topk_indices': array([3342, 3369, 3256, 3208, 7462, 7424, 1463, 1525, 4327, 4343, 5199,
       5138, 7201, 7145, 3525, 3551, 4915, 4940, 4963, 4992]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [27.935546875, 25.5546875, 20.052083333333332, 26.7078125]}, 'saliency': {'score': [1.2536407470703126, 0.12878065526937546, 1.06679443359375, 0.12312835531930434, 0.19251666349523208], 'topk_indices': array([ 639, 2218,  638, 2123, 1611, 8158, 2214, 1278, 8159, 2124, 2075,
       2076,  642, 2215, 2178, 2082, 8161, 2179, 2129, 2077]), 'topk_tokens': [' travelled', ' each', ' Sandra', 'Dub', ' milk', ' milk', 'ab', ' garden', ' before', 'u', 'Dub', 'u', ' kitchen', 're', 're', "'clock", ' bedroom', 'ast', ' o', 'que'], 'evidence_proportions': [2.2510986328125, 2.03505859375, 0.68450927734375, 0.35721435546875]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 0}
2025-01-22 05:43:32.487 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:43:32.488 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-70_pid-2_2-4-8-9.pkl | len: 3 |  size: 1.96 KB
Processing depth (2, 4, 8, 9):   3%|▎         | 3/100 [01:00<32:24, 20.05s/it]is_0k: False
your chose emoji: ['🇧🇬', '🧜🏿', '\U0001fae0', '🙆🏻\u200d♂', '🙇🏼\u200d♀️', '🛡', '👩🏿\u200d❤\u200d💋\u200d👨🏻', '🙉', '💁🏾\u200d♀️', '🟩']
emoji:
O: 🇧🇬 [9468, 229, 100, 9468, 229, 105]
N: 🧜🏿 [9468, 100, 250, 9468, 237, 123]

O: 🧜🏿 [9468, 100, 250, 9468, 237, 123]
N: 💁🏾‍♀️ [93273, 223, 9468, 237, 122, 102470, 32990, 31643]

O: 🫠 [9468, 104, 254]
N: 🙆🏻‍♂ [9468, 247, 228, 9468, 237, 119, 102470, 17245, 224]

O: 🙆🏻‍♂ [9468, 247, 228, 9468, 237, 119, 102470, 17245, 224]
N: 🙉 [9468, 247, 231]

O: 🙇🏼‍♀️ [9468, 247, 229, 9468, 237, 120, 102470, 32990, 31643]
N: 👩🏿‍❤‍💋‍👨🏻 [9468, 239, 102, 9468, 237, 123, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 119]

O: 🛡 [9468, 249, 94]
N: 🛡 [9468, 249, 94]

O: 👩🏿‍❤‍💋‍👨🏻 [9468, 239, 102, 9468, 237, 123, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 119]
N: 🇧🇬 [9468, 229, 100, 9468, 229, 105]

O: 🙉 [9468, 247, 231]
N: 🫠 [9468, 104, 254]

O: 💁🏾‍♀️ [93273, 223, 9468, 237, 122, 102470, 32990, 31643]
N: 🙇🏼‍♀️ [9468, 247, 229, 9468, 237, 120, 102470, 32990, 31643]

O: 🟩 [9468, 253, 102]
N: 🟩 [9468, 253, 102]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.28s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.96s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.66s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.22s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.76s/it]
Processing depth (3, 5, 6, 9):   3%|▎         | 3/100 [01:17<32:24, 20.05s/it]2025-01-22 05:43:49.221 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the milk.
2025-01-22 05:43:49.237 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2956, 2960) -->  Mary grabbed the milk
2025-01-22 05:43:49.238 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary moved to the garden.
2025-01-22 05:43:49.246 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1436, 1441) -->  Sandra moved to the garden
2025-01-22 05:43:49.247 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bedroom.
2025-01-22 05:43:49.274 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4820, 4826) -->  the senate. Mary journeyed
2025-01-22 05:43:49.274 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel travelled to the bathroom.
2025-01-22 05:43:49.314 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7271, 7276) --> . Daniel travelled to the
2025-01-22 05:43:49.314 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the garden.
2025-01-22 05:43:49.322 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1435, 1440) --> . Sandra moved to the
2025-01-22 05:43:49.322 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the bedroom.
2025-01-22 05:43:49.355 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6507, 6512) --> . John travelled to the
2025-01-22 05:43:49.355 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 05:43:49.387 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5589, 5594) --> . Daniel moved to the
2025-01-22 05:43:49.387 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the hallway.
2025-01-22 05:43:49.408 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3558, 3563) --> . John went to the
2025-01-22 05:43:49.408 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra travelled to the kitchen.
2025-01-22 05:43:49.413 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (751, 756) --> . Sandra travelled to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:43:50.233 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 05:43:50.233 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8243])
2025-01-22 05:43:52.490 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [71.945703125, 12.576961557118603, 65.42375, 12.271078793744666, 11.028329702524038], 'topk_indices': array([7671, 8230, 8092, 8234, 7685,   23, 8239,    9, 8237, 8233,    1,
       8131,   24, 8242, 8231, 7686,   14, 8241,    0, 8238]), 'topk_tokens': [' or', ' milk', '\n', '?', ' Min', '4', '<|start_header_id|>', ':', ':', ' bedroom', '<|start_header_id|>', '.\n\n', '\n\n', '\n\n', ' before', 'nes', '\n', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [134.5, 104.71875, 43.5703125, 23.1796875]}, 'weight': {'score': [24.428125, 23.335302722532138, 20.345625, 23.341751387025973, 29.758864182692307], 'topk_indices': array([3294, 3321, 3166, 3214, 7488, 7450, 1463, 1525, 4295, 4311, 5232,
       5171, 7165, 7221, 3477, 3503, 5025, 4973, 4996, 4948]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [27.935546875, 25.5546875, 23.9921875, 21.01875]}, 'saliency': {'score': [0.48370513916015623, 0.06993886506762749, 0.360269775390625, 0.06804475480791214, 0.08281825138972355], 'topk_indices': array([7671,   23, 8234, 8240, 6512, 4247,   24,    8, 8141, 8242, 7641,
       8225, 8131, 8212, 8236, 8230, 7685, 8231, 8233, 7686]), 'topk_tokens': [' or', '4', '?', 'assistant', ' bedroom', ' garden', '\n\n', ' Date', ' location', '\n\n', 'nes', 'Question', '.\n\n', ' return', 'Answer', ' milk', ' Min', ' before', ' bedroom', 'nes'], 'evidence_proportions': [0.9876708984375, 0.709326171875, 0.24902852376302084, 0.1365234375]}}, 'pred_res': 'The garden.<|eot_id|>', 'score': 100}
2025-01-22 05:43:52.494 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:43:52.495 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-70_pid-3_3-5-6-9.pkl | len: 3 |  size: 1.98 KB
Processing depth (3, 5, 6, 9):   4%|▍         | 4/100 [01:20<32:03, 20.03s/it]is_0k: False
your chose emoji: ['🙂\u200d↔', '👩🏻\u200d❤️\u200d👩🏿', '👨\u200d👨\u200d👧\u200d👦', '🤾🏼', '➡️', '🧑🏼\u200d🦽\u200d➡️', '🧏🏽\u200d♂', '🧑🏼\u200d🌾', '🧑\u200d⚖️', '👩🏽\u200d❤\u200d💋\u200d👩🏽']
emoji:
O: 🙂‍↔ [9468, 19044, 102470, 27017, 242]
N: 🧑🏼‍🌾 [9468, 100, 239, 9468, 237, 120, 102470, 9468, 234, 122]

O: 👩🏻‍❤️‍👩🏿 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 31643, 102470, 9468, 239, 102, 9468, 237, 123]
N: 👩🏻‍❤️‍👩🏿 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 31643, 102470, 9468, 239, 102, 9468, 237, 123]

O: 👨‍👨‍👧‍👦 [9468, 239, 101, 102470, 9468, 239, 101, 102470, 9468, 239, 100, 102470, 9468, 239, 99]
N: 🙂‍↔ [9468, 19044, 102470, 27017, 242]

O: 🤾🏼 [9468, 97, 122, 9468, 237, 120]
N: 🧑🏼‍🦽‍➡️ [9468, 100, 239, 9468, 237, 120, 102470, 9468, 99, 121, 102470, 98115, 94, 31643]

O: ➡️ [98115, 94, 31643]
N: 👨‍👨‍👧‍👦 [9468, 239, 101, 102470, 9468, 239, 101, 102470, 9468, 239, 100, 102470, 9468, 239, 99]

O: 🧑🏼‍🦽‍➡️ [9468, 100, 239, 9468, 237, 120, 102470, 9468, 99, 121, 102470, 98115, 94, 31643]
N: 🤾🏼 [9468, 97, 122, 9468, 237, 120]

O: 🧏🏽‍♂ [9468, 100, 237, 9468, 237, 121, 102470, 17245, 224]
N: ➡️ [98115, 94, 31643]

O: 🧑🏼‍🌾 [9468, 100, 239, 9468, 237, 120, 102470, 9468, 234, 122]
N: 🧏🏽‍♂ [9468, 100, 237, 9468, 237, 121, 102470, 17245, 224]

O: 🧑‍⚖️ [9468, 100, 239, 102470, 158, 248, 244, 31643]
N: 🧑‍⚖️ [9468, 100, 239, 102470, 158, 248, 244, 31643]

O: 👩🏽‍❤‍💋‍👩🏽 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 121]
N: 👩🏽‍❤‍💋‍👩🏽 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 121]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.32s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.56s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.39s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.85s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.43s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (2, 3, 5, 8):   4%|▍         | 4/100 [01:36<32:03, 20.03s/it]2025-01-22 05:44:07.956 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary grabbed the milk.
2025-01-22 05:44:07.966 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1806, 1810) -->  Mary grabbed the milk
2025-01-22 05:44:07.966 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary moved to the garden.
2025-01-22 05:44:07.974 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1414, 1419) -->  Sandra moved to the garden
2025-01-22 05:44:07.974 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bedroom.
2025-01-22 05:44:07.998 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4211, 4217) -->  Mary journeyed to the bedroom
2025-01-22 05:44:07.998 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel travelled to the bathroom.
2025-01-22 05:44:08.030 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6596, 6601) -->  Daniel travelled to the bathroom
2025-01-22 05:44:08.030 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the garden.
2025-01-22 05:44:08.042 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1413, 1418) --> . Sandra moved to the
2025-01-22 05:44:08.042 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the bedroom.
2025-01-22 05:44:08.077 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6441, 6446) --> . John travelled to the
2025-01-22 05:44:08.077 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 05:44:08.108 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5529, 5534) --> . Daniel moved to the
2025-01-22 05:44:08.108 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the hallway.
2025-01-22 05:44:08.126 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3502, 3507) --> . John went to the
2025-01-22 05:44:08.126 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra travelled to the kitchen.
2025-01-22 05:44:08.130 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (751, 756) --> . Sandra travelled to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:44:10.973 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 05:44:10.973 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8145])
2025-01-22 05:44:13.862 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [149.1359375, 16.873903105056456, 122.3175, 16.22212837837838, 22.348810369318183], 'topk_indices': array([7538,    3, 7493, 8132, 1809,    1, 8033,  752, 8135,   23,    4,
        756, 8043,    9, 8133,   24,   14, 8140, 8143,    0]), 'topk_tokens': ['nes', '<|end_header_id|>', 'nes', ' milk', ' milk', '<|start_header_id|>', '.\n\n', ' Sandra', ' bedroom', '4', '\n\n', ' kitchen', ' location', ':', ' before', '\n\n', '\n', '<|eot_id|>', '<|end_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [264.46875, 173.65, 137.55208333333334, 46.25625]}, 'weight': {'score': [26.025, 23.24716571551301, 20.345625, 23.24926146180427, 28.953125], 'topk_indices': array([3311, 3284, 3204, 3156, 7392, 7430, 1441, 1503, 4304, 4288, 5172,
       5111, 7113, 7169, 3493, 3467, 4924, 4876, 4953, 4901]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [27.935546875, 25.5546875, 24.57421875, 26.7078125]}, 'saliency': {'score': [1.037255859375, 0.09486045331772368, 0.71148193359375, 0.09063196447062431, 0.1647705078125], 'topk_indices': array([8033, 4216,   23, 8114,    8, 7345, 1807, 7538, 7537, 1418,   24,
       7493,  753, 1809, 8132, 8043, 8133,  756, 8135,  752]), 'topk_tokens': ['.\n\n', ' bedroom', '4', ' return', ' Date', 'nes', ' grabbed', 'nes', ' Min', ' garden', '\n\n', 'nes', ' travelled', ' milk', ' milk', ' location', ' before', ' kitchen', ' bedroom', ' Sandra'], 'evidence_proportions': [1.941650390625, 1.177880859375, 0.9012044270833334, 0.336376953125]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 0}
2025-01-22 05:44:13.869 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:44:13.869 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-70_pid-4_2-3-5-8.pkl | len: 3 |  size: 2.02 KB
Processing depth (2, 3, 5, 8):   5%|▌         | 5/100 [01:42<32:29, 20.52s/it]Processing depth (2, 3, 5, 8):   5%|▌         | 5/100 [01:42<32:26, 20.49s/it]
2025-01-22 05:44:13.970 | INFO     | __main__:<module>:82 - Selected idx: 71
2025-01-22 05:44:13.970 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the location prior to the place where the milk was discarded, left or dropped?
2025-01-22 05:44:13.970 | INFO     | __main__:<module>:84 - Answer: garden
2025-01-22 05:44:13.970 | INFO     | __main__:<module>:85 - Tag: 4-hop
2025-01-22 05:44:13.970 | INFO     | __main__:<module>:86 - Needle: [' Daniel moved to the office.', ' Mary moved to the garden.', ' Sandra moved to the garden.', ' John travelled to the bedroom.', ' Mary grabbed the milk.', ' Sandra travelled to the kitchen.', ' Mary journeyed to the bedroom.', ' John went to the hallway.', ' Mary discarded the milk.', ' Daniel travelled to the bathroom.']
2025-01-22 05:44:13.970 | INFO     | __main__:<module>:87 - Real Needle: [' Mary moved to the garden.', ' Mary grabbed the milk.', ' Mary journeyed to the bedroom.', ' Mary discarded the milk.', ' Daniel travelled to the bathroom.']
2025-01-22 05:44:13.970 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['👇🏻', '🛻', '🤞🏻', '🤗', '🙍🏽\u200d♂', '🧑🏿\u200d🌾', '🚫', '⛪', '🧘\u200d♀️', '🖖🏾']
emoji:
O: 👇🏻 [9468, 239, 229, 9468, 237, 119]
N: 🙍🏽‍♂ [9468, 247, 235, 9468, 237, 121, 102470, 17245, 224]

O: 🛻 [9468, 249, 119]
N: 🧘‍♀️ [9468, 100, 246, 102470, 32990, 31643]

O: 🤞🏻 [9468, 97, 252, 9468, 237, 119]
N: 🛻 [9468, 249, 119]

O: 🤗 [9468, 97, 245]
N: 👇🏻 [9468, 239, 229, 9468, 237, 119]

O: 🙍🏽‍♂ [9468, 247, 235, 9468, 237, 121, 102470, 17245, 224]
N: 🤞🏻 [9468, 97, 252, 9468, 237, 119]

O: 🧑🏿‍🌾 [9468, 100, 239, 9468, 237, 123, 102470, 9468, 234, 122]
N: 🤗 [9468, 97, 245]

O: 🚫 [9468, 248, 104]
N: ⛪ [158, 249, 103]

O: ⛪ [158, 249, 103]
N: 🧑🏿‍🌾 [9468, 100, 239, 9468, 237, 123, 102470, 9468, 234, 122]

O: 🧘‍♀️ [9468, 100, 246, 102470, 32990, 31643]
N: 🚫 [9468, 248, 104]

O: 🖖🏾 [9468, 244, 244, 9468, 237, 122]
N: 🖖🏾 [9468, 244, 244, 9468, 237, 122]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:05<00:15,  5.10s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.61s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.53s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.14s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.70s/it]
Processing depth (0, 3, 5, 6, 8):   0%|          | 0/100 [00:16<?, ?it/s]2025-01-22 05:44:30.890 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the garden.
2025-01-22 05:44:30.890 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  moved to the garden.
2025-01-22 05:44:30.891 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary grabbed the milk.
2025-01-22 05:44:30.904 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2745, 2749) -->  grabbed the milk.
2025-01-22 05:44:30.904 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bedroom.
2025-01-22 05:44:30.925 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4104, 4110) --> . Mary journeyed to the
2025-01-22 05:44:30.925 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary discarded the milk.
2025-01-22 05:44:30.948 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4635, 4639) -->  discarded the milk.
2025-01-22 05:44:30.949 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel travelled to the bathroom.
2025-01-22 05:44:30.989 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6544, 6549) --> . Daniel travelled to the
2025-01-22 05:44:30.990 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the office.
2025-01-22 05:44:30.990 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (32, 37) -->  to the garden. Daniel
2025-01-22 05:44:30.990 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the garden.
2025-01-22 05:44:30.990 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (31, 36) -->  moved to the garden.
2025-01-22 05:44:30.990 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the bedroom.
2025-01-22 05:44:31.007 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2980, 2985) --> . John travelled to the
2025-01-22 05:44:31.007 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra travelled to the kitchen.
2025-01-22 05:44:31.029 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4476, 4481) -->  execution. Sandra travelled to
2025-01-22 05:44:31.029 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went to the hallway.
2025-01-22 05:44:31.055 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5472, 5477) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:44:31.845 | INFO     | test_jbb_embedding:begin_test:693 - the garden<|eot_id|>
2025-01-22 05:44:31.846 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8217])
2025-01-22 05:44:34.084 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [219.30859375, 17.121346563260342, 139.2521875, 16.153807099804187, 24.118198939732142], 'topk_indices': array([8197, 8106, 2747, 8189,   31, 8062, 8096,   28,    4, 8215, 4635,
         24, 8216, 4106, 2748, 4162,   14, 8213, 8212,    0]), 'topk_tokens': [' to', ' location', ' milk', '.\n\n', ' moved', ' context', '.\n\n', '<|end_header_id|>', '\n\n', '<|end_header_id|>', ' discarded', '\n\n', '\n\n', ' journey', '.', ' garden', '\n', '<|start_header_id|>', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [261.875, 332.96875, 213.125, 277.0625, 47.03125]}, 'weight': {'score': [20.990234375, 23.30187804136253, 20.9978125, 23.315717361706035, 29.68154761904762], 'topk_indices': array([3332, 3359, 3204, 3252, 7413, 7451, 1527, 1465, 4328, 4344, 5237,
       5176, 7134, 7190, 3515, 3541, 4953, 4978, 5001, 5030]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.534375, 22.15234375, 20.052083333333332, 23.01953125, 21.01875]}, 'saliency': {'score': [1.2516072591145833, 0.09676045884181113, 0.763040771484375, 0.09132987127326253, 0.17927914574032738], 'topk_indices': array([  30, 8190, 7514, 7559, 4637, 7558,   34, 8106, 2745, 8202, 8196,
       4110, 8062,   31, 2747, 4158, 8204, 4106, 4635, 4162]), 'topk_tokens': ['Mary', 'Question', 'nes', 'nes', ' milk', ' Min', ' garden', ' location', ' grabbed', ' milk', ' prior', ' bedroom', ' context', ' moved', ' milk', ' Sandra', ' discarded', ' journey', ' discarded', ' garden'], 'evidence_proportions': [1.4173828125, 1.7926025390625, 1.224853515625, 1.79931640625, 0.24697265625]}}, 'pred_res': 'the garden<|eot_id|>', 'score': 100}
2025-01-22 05:44:34.089 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:44:34.090 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-71_pid-0_0-3-5-6-8.pkl | len: 3 |  size: 2.1 KB
Processing depth (0, 3, 5, 6, 8):   1%|          | 1/100 [00:20<33:02, 20.03s/it]is_0k: False
your chose emoji: ['👨🏿\u200d🦯', '🧎🏾\u200d♂', '🚶🏻\u200d♂️\u200d➡', '⛹🏽', '🇭🇰', '⭐', '🧍🏻\u200d♀', '🧑🏻\u200d❤\u200d💋\u200d🧑🏼', '🎛', '🚵🏾\u200d♂']
emoji:
O: 👨🏿‍🦯 [9468, 239, 101, 9468, 237, 123, 102470, 9468, 99, 107]
N: 🧎🏾‍♂ [9468, 100, 236, 9468, 237, 122, 102470, 17245, 224]

O: 🧎🏾‍♂ [9468, 100, 236, 9468, 237, 122, 102470, 17245, 224]
N: 🧍🏻‍♀ [9468, 100, 235, 9468, 237, 119, 102470, 32990]

O: 🚶🏻‍♂️‍➡ [9468, 248, 114, 9468, 237, 119, 102470, 17245, 224, 31643, 102470, 98115, 94]
N: 👨🏿‍🦯 [9468, 239, 101, 9468, 237, 123, 102470, 9468, 99, 107]

O: ⛹🏽 [158, 249, 117, 9468, 237, 121]
N: 🇭🇰 [9468, 229, 255, 9468, 229, 108]

O: 🇭🇰 [9468, 229, 255, 9468, 229, 108]
N: 🎛 [9468, 236, 249]

O: ⭐ [158, 99834]
N: ⛹🏽 [158, 249, 117, 9468, 237, 121]

O: 🧍🏻‍♀ [9468, 100, 235, 9468, 237, 119, 102470, 32990]
N: ⭐ [158, 99834]

O: 🧑🏻‍❤‍💋‍🧑🏼 [9468, 100, 239, 9468, 237, 119, 102470, 121643, 102470, 93273, 233, 102470, 9468, 100, 239, 9468, 237, 120]
N: 🚶🏻‍♂️‍➡ [9468, 248, 114, 9468, 237, 119, 102470, 17245, 224, 31643, 102470, 98115, 94]

O: 🎛 [9468, 236, 249]
N: 🧑🏻‍❤‍💋‍🧑🏼 [9468, 100, 239, 9468, 237, 119, 102470, 121643, 102470, 93273, 233, 102470, 9468, 100, 239, 9468, 237, 120]

O: 🚵🏾‍♂ [9468, 248, 113, 9468, 237, 122, 102470, 17245, 224]
N: 🚵🏾‍♂ [9468, 248, 113, 9468, 237, 122, 102470, 17245, 224]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:11,  3.96s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.63s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.54s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.92s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.48s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (3, 4, 6, 8, 9):   1%|          | 1/100 [00:35<33:02, 20.03s/it]2025-01-22 05:44:49.760 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the garden.
2025-01-22 05:44:49.775 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2833, 2838) --> . Mary moved to the
2025-01-22 05:44:49.775 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary grabbed the milk.
2025-01-22 05:44:49.792 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3574, 3578) -->  Mary grabbed the milk
2025-01-22 05:44:49.793 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bedroom.
2025-01-22 05:44:49.816 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4724, 4730) --> . Mary journeyed to the
2025-01-22 05:44:49.816 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary discarded the milk.
2025-01-22 05:44:49.850 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6542, 6546) -->  Mary discarded the milk
2025-01-22 05:44:49.850 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel travelled to the bathroom.
2025-01-22 05:44:49.889 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7236, 7241) --> . Daniel travelled to the
2025-01-22 05:44:49.889 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the office.
2025-01-22 05:44:49.890 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  moved to the office.
2025-01-22 05:44:49.890 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the garden.
2025-01-22 05:44:49.907 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2834, 2839) -->  Mary moved to the garden
2025-01-22 05:44:49.907 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the bedroom.
2025-01-22 05:44:49.922 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3014, 3019) -->  tragedy. John travelled to
2025-01-22 05:44:49.922 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra travelled to the kitchen.
2025-01-22 05:44:49.944 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4547, 4552) -->  Sandra travelled to the kitchen
2025-01-22 05:44:49.944 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went to the hallway.
2025-01-22 05:44:49.973 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5597, 5602) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:44:52.665 | INFO     | test_jbb_embedding:begin_test:693 - the garden<|eot_id|>
2025-01-22 05:44:52.665 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8189])
2025-01-22 05:44:55.579 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [58.1923828125, 8.219794273376465, 59.52921875, 7.914983056766548, 5.756626674107143], 'topk_indices': array([   1,    4, 8153, 8181, 8161, 8183, 8034, 8068, 2838,   23,    9,
         28, 4227,   24, 8188,   14, 8185, 8187,    0, 8184]), 'topk_tokens': ['<|start_header_id|>', '\n\n', '.', '?\n', '.\n\n', ':', ' context', '.\n\n', ' garden', '4', ':', '<|end_header_id|>', ' garden', '\n\n', '\n\n', '\n', '<|start_header_id|>', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [103.5125, 87.2734375, 34.505208333333336, 62.3125, 14.7359375]}, 'weight': {'score': [22.94140625, 23.275177001953125, 22.9140625, 23.27726939549306, 29.389508928571427], 'topk_indices': array([3297, 3324, 3169, 3217, 7429, 7467, 1501, 1439, 4315, 4299, 5129,
       5190, 7186, 7130, 3492, 3518, 4983, 4954, 4931, 4906]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.646875, 27.935546875, 20.052083333333332, 28.802734375, 21.01875]}, 'saliency': {'score': [0.3487599690755208, 0.04521768540143967, 0.3539556884765625, 0.04337518695061614, 0.042261723109654016], 'topk_indices': array([8181,    0, 8161, 8168, 8068, 8152, 8162,   14, 8078,    8,   23,
         20, 8149, 8186, 8182,   24, 8188, 8034, 2838, 4227]), 'topk_tokens': ['?\n', '<|begin_of_text|>', '.\n\n', ' prior', '.\n\n', ' directly', 'Question', '\n', ' location', ' Date', '4', ' Jul', ' return', 'assistant', 'Answer', '\n\n', '\n\n', ' context', ' garden', ' garden'], 'evidence_proportions': [0.508984375, 0.61883544921875, 0.18335469563802084, 0.463226318359375, 0.079388427734375]}}, 'pred_res': 'the garden<|eot_id|>', 'score': 100}
2025-01-22 05:44:55.593 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:44:55.593 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-71_pid-1_3-4-6-8-9.pkl | len: 3 |  size: 2.07 KB
Processing depth (3, 4, 6, 8, 9):   2%|▏         | 2/100 [00:41<34:07, 20.89s/it]is_0k: False
your chose emoji: ['👩🏻\u200d❤️\u200d👨🏻', '🙍🏼', '🙌🏽', '🧑\u200d🎨', '🇹🇴', '🇧🇻', '🏃🏿', '🏧', '🤸🏻\u200d♂️', '💁🏼']
emoji:
O: 👩🏻‍❤️‍👨🏻 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 119]
N: 🇹🇴 [9468, 229, 117, 9468, 114783]

O: 🙍🏼 [9468, 247, 235, 9468, 237, 120]
N: 🏃🏿 [9468, 237, 225, 9468, 237, 123]

O: 🙌🏽 [9468, 247, 234, 9468, 237, 121]
N: 🙌🏽 [9468, 247, 234, 9468, 237, 121]

O: 🧑‍🎨 [9468, 100, 239, 102470, 9468, 236, 101]
N: 🤸🏻‍♂️ [9468, 97, 116, 9468, 237, 119, 102470, 17245, 224, 31643]

O: 🇹🇴 [9468, 229, 117, 9468, 114783]
N: 🙍🏼 [9468, 247, 235, 9468, 237, 120]

O: 🇧🇻 [9468, 229, 100, 9468, 229, 119]
N: 🏧 [9468, 237, 100]

O: 🏃🏿 [9468, 237, 225, 9468, 237, 123]
N: 👩🏻‍❤️‍👨🏻 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 119]

O: 🏧 [9468, 237, 100]
N: 🇧🇻 [9468, 229, 100, 9468, 229, 119]

O: 🤸🏻‍♂️ [9468, 97, 116, 9468, 237, 119, 102470, 17245, 224, 31643]
N: 🧑‍🎨 [9468, 100, 239, 102470, 9468, 236, 101]

O: 💁🏼 [93273, 223, 9468, 237, 120]
N: 💁🏼 [93273, 223, 9468, 237, 120]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:11,  3.96s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.33s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.62s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.29s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.69s/it]
Processing depth (1, 2, 3, 7, 9):   2%|▏         | 2/100 [00:58<34:07, 20.89s/it]2025-01-22 05:45:12.159 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the garden.
2025-01-22 05:45:12.165 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (901, 906) --> . Mary moved to the
2025-01-22 05:45:12.165 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary grabbed the milk.
2025-01-22 05:45:12.177 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2012, 2016) -->  Mary grabbed the milk
2025-01-22 05:45:12.177 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bedroom.
2025-01-22 05:45:12.193 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2926, 2932) --> . Mary journeyed to the
2025-01-22 05:45:12.193 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary discarded the milk.
2025-01-22 05:45:12.224 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5672, 5676) -->  Mary discarded the milk
2025-01-22 05:45:12.224 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel travelled to the bathroom.
2025-01-22 05:45:12.303 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7235, 7240) -->  Daniel travelled to the bathroom
2025-01-22 05:45:12.304 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the office.
2025-01-22 05:45:12.304 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  moved to the office.
2025-01-22 05:45:12.304 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the garden.
2025-01-22 05:45:12.309 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (902, 907) -->  Mary moved to the garden
2025-01-22 05:45:12.309 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the bedroom.
2025-01-22 05:45:12.324 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3110, 3115) -->  ranks. John travelled to
2025-01-22 05:45:12.325 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra travelled to the kitchen.
2025-01-22 05:45:12.348 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4570, 4575) -->  Sandra travelled to the kitchen
2025-01-22 05:45:12.348 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went to the hallway.
2025-01-22 05:45:12.381 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5617, 5622) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:45:13.195 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 05:45:13.195 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8175])
2025-01-22 05:45:15.420 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [103.84309895833333, 12.021145718696502, 102.73453125, 11.471070492219216, 7.966517857142857], 'topk_indices': array([  29, 4272, 8169,    4, 8064,    9, 8147,   25, 8054, 8139,    1,
       8174,   23,   14,   24, 8173,  906,    0, 8171, 8170]), 'topk_tokens': ['\n\n', ' garden', ':', '\n\n', ' location', ':', '.\n\n', '<|eot_id|>', '.\n\n', '.', '<|start_header_id|>', '\n\n', '4', '\n', '\n\n', '<|end_header_id|>', ' garden', '<|begin_of_text|>', '<|start_header_id|>', '<|eot_id|>'], 'evidence_proportions': [188.0, 119.734375, 62.536458333333336, 127.515625, 37.603125]}, 'weight': {'score': [24.126627604166668, 23.261364331132306, 22.7153125, 23.2604890669209, 29.17237103174603], 'topk_indices': array([3293, 3320, 3145, 3193, 7451, 7413, 1473, 1411, 4294, 4278, 5190,
       5129, 7112, 7168, 3502, 3476, 4954, 4983, 4931, 4906]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.646875, 27.935546875, 20.052083333333332, 28.802734375, 26.7078125]}, 'saliency': {'score': [0.6254119873046875, 0.06628608283800669, 0.64083984375, 0.06286833579285966, 0.0581328376891121], 'topk_indices': array([4570,   14,    8,   19, 8162, 8154, 8174, 8172, 8138,    0, 8135,
       8148, 8168,   20, 8064,   23, 4272,   24, 4268,  906]), 'topk_tokens': [' Sandra', '\n', ' Date', '26', ' discarded', ' prior', '\n\n', 'assistant', ' directly', '<|begin_of_text|>', ' return', 'Question', 'Answer', ' Jul', ' location', '4', ' garden', '\n\n', ' Sandra', ' garden'], 'evidence_proportions': [0.8962890625, 0.84857177734375, 0.3223470052083333, 0.96466064453125, 0.2682861328125]}}, 'pred_res': 'The garden.<|eot_id|>', 'score': 100}
2025-01-22 05:45:15.453 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:45:15.453 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-71_pid-2_1-2-3-7-9.pkl | len: 3 |  size: 2.07 KB
Processing depth (1, 2, 3, 7, 9):   3%|▎         | 3/100 [01:01<33:00, 20.42s/it]is_0k: False
your chose emoji: ['🦹🏻\u200d♂', '👨🏿\u200d🦯', '💁🏽\u200d♀️', '👂🏽', '🤾🏾\u200d♀', '🔖', '👨🏽\u200d🦰', '🏫', '\U0001fa89', '🔭']
emoji:
O: 🦹🏻‍♂ [9468, 99, 117, 9468, 237, 119, 102470, 17245, 224]
N: 🪉 [9468, 103, 231]

O: 👨🏿‍🦯 [9468, 239, 101, 9468, 237, 123, 102470, 9468, 99, 107]
N: 👂🏽 [9468, 239, 224, 9468, 237, 121]

O: 💁🏽‍♀️ [93273, 223, 9468, 237, 121, 102470, 32990, 31643]
N: 👨🏿‍🦯 [9468, 239, 101, 9468, 237, 123, 102470, 9468, 99, 107]

O: 👂🏽 [9468, 239, 224, 9468, 237, 121]
N: 🦹🏻‍♂ [9468, 99, 117, 9468, 237, 119, 102470, 17245, 224]

O: 🤾🏾‍♀ [9468, 97, 122, 9468, 237, 122, 102470, 32990]
N: 🤾🏾‍♀ [9468, 97, 122, 9468, 237, 122, 102470, 32990]

O: 🔖 [9468, 242, 244]
N: 👨🏽‍🦰 [9468, 239, 101, 9468, 237, 121, 102470, 9468, 99, 108]

O: 👨🏽‍🦰 [9468, 239, 101, 9468, 237, 121, 102470, 9468, 99, 108]
N: 🏫 [9468, 237, 104]

O: 🏫 [9468, 237, 104]
N: 💁🏽‍♀️ [93273, 223, 9468, 237, 121, 102470, 32990, 31643]

O: 🪉 [9468, 103, 231]
N: 🔖 [9468, 242, 244]

O: 🔭 [9468, 242, 255]
N: 🔭 [9468, 242, 255]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.49s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.47s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.21s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.96s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.47s/it]
Processing depth (1, 4, 5, 6, 9):   3%|▎         | 3/100 [01:17<33:00, 20.42s/it]2025-01-22 05:45:31.317 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the garden.
2025-01-22 05:45:31.322 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (827, 832) --> . Mary moved to the
2025-01-22 05:45:31.322 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary grabbed the milk.
2025-01-22 05:45:31.341 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3584, 3588) -->  Mary grabbed the milk
2025-01-22 05:45:31.341 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bedroom.
2025-01-22 05:45:31.362 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4128, 4134) --> . Mary journeyed to the
2025-01-22 05:45:31.362 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary discarded the milk.
2025-01-22 05:45:31.384 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4667, 4671) -->  discarded the milk.
2025-01-22 05:45:31.384 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel travelled to the bathroom.
2025-01-22 05:45:31.424 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7161, 7166) -->  Daniel travelled to the bathroom
2025-01-22 05:45:31.424 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the office.
2025-01-22 05:45:31.424 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  moved to the office.
2025-01-22 05:45:31.424 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the garden.
2025-01-22 05:45:31.428 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (828, 833) -->  Mary moved to the garden
2025-01-22 05:45:31.428 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the bedroom.
2025-01-22 05:45:31.443 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3010, 3015) -->  tragedy. John travelled to
2025-01-22 05:45:31.443 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra travelled to the kitchen.
2025-01-22 05:45:31.465 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4463, 4468) --> . Sandra travelled to the
2025-01-22 05:45:31.465 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went to the hallway.
2025-01-22 05:45:31.494 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5504, 5509) --> . John went to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:45:32.304 | INFO     | test_jbb_embedding:begin_test:693 - the kitchen<|eot_id|>
2025-01-22 05:45:32.304 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8205])
2025-01-22 05:45:34.539 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [161.26627604166666, 14.980546798854776, 122.769375, 14.219966065081506, 10.929361979166666], 'topk_indices': array([8192, 8197,   28, 8185, 8204,  832, 4667, 8177, 8203, 8178, 8094,
       4174,    9,   24, 8179, 8050,   14, 8200,    0, 8201]), 'topk_tokens': [' discarded', '?\n', '<|end_header_id|>', ' to', '\n\n', ' garden', ' discarded', '.\n\n', '<|end_header_id|>', 'Question', ' location', ' garden', ':', '\n\n', ':', ' context', '\n', '<|eot_id|>', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [189.125, 208.609375, 155.67708333333334, 252.15625, 29.528125]}, 'weight': {'score': [23.162760416666668, 23.289584094785575, 21.95625, 23.29404262164481, 29.520432692307693], 'topk_indices': array([3293, 3320, 3213, 3165, 7489, 7451, 1439, 1501, 4402, 4386, 5208,
       5269, 7228, 7172, 3528, 3502, 5062, 4985, 5033, 5010]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.646875, 27.935546875, 20.052083333333332, 23.01953125, 26.7078125]}, 'saliency': {'score': [0.9902725219726562, 0.08350468239589044, 0.6977008056640625, 0.07895543233687013, 0.08009631817157452], 'topk_indices': array([8177,  829,    8, 4669,   24, 8090, 4130, 8190, 8198, 3016, 3587,
        832, 8094, 4170, 8184, 4174, 8192, 8050, 4667, 8178]), 'topk_tokens': ['.\n\n', ' moved', ' Date', ' milk', '\n\n', ' item', ' journey', ' milk', 'Answer', ' bedroom', ' milk', ' garden', ' location', ' Sandra', ' prior', ' garden', ' discarded', ' context', ' discarded', 'Question'], 'evidence_proportions': [0.96513671875, 1.5181884765625, 0.8885294596354166, 1.6263427734375, 0.20631103515625]}}, 'pred_res': 'the kitchen<|eot_id|>', 'score': 0}
2025-01-22 05:45:34.545 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:45:34.546 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-71_pid-3_1-4-5-6-9.pkl | len: 3 |  size: 2.1 KB
Processing depth (1, 4, 5, 6, 9):   4%|▍         | 4/100 [01:20<31:50, 19.90s/it]is_0k: False
your chose emoji: ['👩🏾\u200d🦯\u200d➡', '🕵\u200d♂', '🦵🏻', '🧜🏻\u200d♂', '👩🏼\u200d🏫', '👩🏽\u200d❤️\u200d💋\u200d👨🏻', '↩', '🤷🏿\u200d♀', '⬆', '♈']
emoji:
O: 👩🏾‍🦯‍➡ [9468, 239, 102, 9468, 237, 122, 102470, 9468, 99, 107, 102470, 98115, 94]
N: 🕵‍♂ [9468, 243, 113, 102470, 17245, 224]

O: 🕵‍♂ [9468, 243, 113, 102470, 17245, 224]
N: 🤷🏿‍♀ [9468, 97, 115, 9468, 237, 123, 102470, 32990]

O: 🦵🏻 [9468, 99, 113, 9468, 237, 119]
N: ↩ [27017, 102]

O: 🧜🏻‍♂ [9468, 100, 250, 9468, 237, 119, 102470, 17245, 224]
N: 🧜🏻‍♂ [9468, 100, 250, 9468, 237, 119, 102470, 17245, 224]

O: 👩🏼‍🏫 [9468, 239, 102, 9468, 237, 120, 102470, 9468, 237, 104]
N: 👩🏾‍🦯‍➡ [9468, 239, 102, 9468, 237, 122, 102470, 9468, 99, 107, 102470, 98115, 94]

O: 👩🏽‍❤️‍💋‍👨🏻 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 119]
N: 👩🏽‍❤️‍💋‍👨🏻 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 119]

O: ↩ [27017, 102]
N: 🦵🏻 [9468, 99, 113, 9468, 237, 119]

O: 🤷🏿‍♀ [9468, 97, 115, 9468, 237, 123, 102470, 32990]
N: 👩🏼‍🏫 [9468, 239, 102, 9468, 237, 120, 102470, 9468, 237, 104]

O: ⬆ [158, 105, 228]
N: ⬆ [158, 105, 228]

O: ♈ [17245, 230]
N: ♈ [17245, 230]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.65s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:10<00:10,  5.09s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.55s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  2.90s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.59s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (1, 2, 5, 7, 8):   4%|▍         | 4/100 [01:36<31:50, 19.90s/it]2025-01-22 05:45:50.740 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary moved to the garden.
2025-01-22 05:45:50.744 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (831, 836) --> . Mary moved to the
2025-01-22 05:45:50.744 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary grabbed the milk.
2025-01-22 05:45:50.753 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1802, 1806) -->  Mary grabbed the milk
2025-01-22 05:45:50.753 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the bedroom.
2025-01-22 05:45:50.774 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4225, 4231) -->  Mary journeyed to the bedroom
2025-01-22 05:45:50.774 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary discarded the milk.
2025-01-22 05:45:50.801 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5568, 5572) -->  Mary discarded the milk
2025-01-22 05:45:50.801 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel travelled to the bathroom.
2025-01-22 05:45:50.832 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6484, 6489) --> . Daniel travelled to the
2025-01-22 05:45:50.832 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the office.
2025-01-22 05:45:50.833 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  moved to the office.
2025-01-22 05:45:50.833 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the garden.
2025-01-22 05:45:50.837 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (832, 837) -->  Mary moved to the garden
2025-01-22 05:45:50.837 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the bedroom.
2025-01-22 05:45:50.852 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3092, 3097) --> . John travelled to the
2025-01-22 05:45:50.852 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra travelled to the kitchen.
2025-01-22 05:45:50.874 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4544, 4549) -->  Sandra travelled to the kitchen
2025-01-22 05:45:50.874 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went to the hallway.
2025-01-22 05:45:50.901 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5440, 5445) -->  John went to the hallway
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:45:54.747 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 05:45:54.747 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8179])
2025-01-22 05:45:57.947 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [85.19694010416667, 10.515921000366658, 112.981875, 9.980572013709578, 7.3885967548076925], 'topk_indices': array([   1, 8153, 8143,   29, 8068, 8173, 8151,   67,  105, 8058,   68,
         23, 8178,   14,   24, 8177,  836,    0, 8175, 8174]), 'topk_tokens': ['<|start_header_id|>', ':', '.', '\n\n', ' location', ':', '.\n\n', 'ION', 'ION', '.\n\n', 'E', '4', '\n\n', '\n', '\n\n', '<|end_header_id|>', ' garden', '<|begin_of_text|>', '<|start_header_id|>', '<|eot_id|>'], 'evidence_proportions': [180.9125, 101.5625, 40.411458333333336, 99.484375, 18.7015625]}, 'weight': {'score': [24.071940104166668, 23.268416951845513, 22.9715625, 23.266958302594368, 29.434375], 'topk_indices': array([3292, 3319, 3164, 3212, 7397, 7435, 1437, 1499, 4300, 4284, 5131,
       5192, 7174, 7118, 3501, 3475, 4985, 4956, 4933, 4908]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.646875, 27.935546875, 24.57421875, 28.802734375, 21.01875]}, 'saliency': {'score': [0.5224393208821615, 0.0575348250995898, 0.6729833984375, 0.0542710943443667, 0.05552256657527043], 'topk_indices': array([  31,  833,   20, 8058, 8024, 4278, 8139, 8176,   23,   68, 8172,
         67,   38, 8178, 8068,    0,  105,   24, 8152,  836]), 'topk_tokens': [' moved', ' moved', ' Jul', '.\n\n', ' context', ' garden', ' return', 'assistant', '4', 'E', 'Answer', 'ION', '***', '\n\n', ' location', '<|begin_of_text|>', 'ION', '\n\n', 'Question', ' garden'], 'evidence_proportions': [0.909228515625, 0.728271484375, 0.2635599772135417, 0.74798583984375, 0.101202392578125]}}, 'pred_res': 'The garden.<|eot_id|>', 'score': 100}
2025-01-22 05:45:57.959 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:45:57.959 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-71_pid-4_1-2-5-7-8.pkl | len: 3 |  size: 2.05 KB
Processing depth (1, 2, 5, 7, 8):   5%|▌         | 5/100 [01:43<33:30, 21.17s/it]Processing depth (1, 2, 5, 7, 8):   5%|▌         | 5/100 [01:43<32:55, 20.80s/it]
2025-01-22 05:45:58.058 | INFO     | __main__:<module>:82 - Selected idx: 72
2025-01-22 05:45:58.059 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the football before the kitchen? 
2025-01-22 05:45:58.059 | INFO     | __main__:<module>:84 - Answer: bedroom
2025-01-22 05:45:58.059 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 05:45:58.059 | INFO     | __main__:<module>:86 - Needle: [' Mary journeyed to the bedroom.', ' Daniel moved to the office.', ' Sandra moved to the garden.', ' Mary went back to the kitchen.', ' John travelled to the bedroom.', ' Daniel took the milk there.', ' Mary dropped the football.', ' Daniel left the milk.']
2025-01-22 05:45:58.059 | INFO     | __main__:<module>:87 - Real Needle: [' Mary journeyed to the bedroom.', ' Mary went back to the kitchen.', ' Mary dropped the football.', ' Daniel left the milk.']
2025-01-22 05:45:58.059 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['🥷🏻', '🤏🏽', '❤\u200d🔥', '🧍🏼\u200d♀', '🖐', '🦹🏿', '💆🏽\u200d♂️', '🤟', '🗞', '🧑🏽\u200d❤️\u200d🧑🏿']
emoji:
O: 🥷🏻 [9468, 98, 115, 9468, 237, 119]
N: 🧍🏼‍♀ [9468, 100, 235, 9468, 237, 120, 102470, 32990]

O: 🤏🏽 [9468, 97, 237, 9468, 237, 121]
N: ❤‍🔥 [121643, 102470, 9468, 242, 98]

O: ❤‍🔥 [121643, 102470, 9468, 242, 98]
N: 💆🏽‍♂️ [93273, 228, 9468, 237, 121, 102470, 17245, 224, 31643]

O: 🧍🏼‍♀ [9468, 100, 235, 9468, 237, 120, 102470, 32990]
N: 🗞 [9468, 245, 252]

O: 🖐 [9468, 244, 238]
N: 🤟 [9468, 97, 253]

O: 🦹🏿 [9468, 99, 117, 9468, 237, 123]
N: 🤏🏽 [9468, 97, 237, 9468, 237, 121]

O: 💆🏽‍♂️ [93273, 228, 9468, 237, 121, 102470, 17245, 224, 31643]
N: 🖐 [9468, 244, 238]

O: 🤟 [9468, 97, 253]
N: 🥷🏻 [9468, 98, 115, 9468, 237, 119]

O: 🗞 [9468, 245, 252]
N: 🦹🏿 [9468, 99, 117, 9468, 237, 123]

O: 🧑🏽‍❤️‍🧑🏿 [9468, 100, 239, 9468, 237, 121, 102470, 121643, 31643, 102470, 9468, 100, 239, 9468, 237, 123]
N: 🧑🏽‍❤️‍🧑🏿 [9468, 100, 239, 9468, 237, 121, 102470, 121643, 31643, 102470, 9468, 100, 239, 9468, 237, 123]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:05<00:15,  5.12s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:10<00:10,  5.15s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.94s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:16<00:00,  3.46s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:16<00:00,  4.04s/it]
Processing depth (1, 6, 7, 9):   0%|          | 0/100 [00:17<?, ?it/s]2025-01-22 05:46:15.991 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the bedroom.
2025-01-22 05:46:15.995 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (661, 667) --> . Mary journeyed to the
2025-01-22 05:46:15.995 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went back to the kitchen.
2025-01-22 05:46:16.022 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4624, 4630) --> . Mary went back to the
2025-01-22 05:46:16.022 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary dropped the football.
2025-01-22 05:46:16.051 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5554, 5558) -->  Mary dropped the football
2025-01-22 05:46:16.051 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the milk.
2025-01-22 05:46:16.097 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7114, 7118) -->  left the milk.
2025-01-22 05:46:16.098 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the office.
2025-01-22 05:46:16.131 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6632, 6637) --> . Daniel moved to the
2025-01-22 05:46:16.131 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the garden.
2025-01-22 05:46:16.167 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6966, 6971) --> . Sandra moved to the
2025-01-22 05:46:16.167 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the bedroom.
2025-01-22 05:46:16.182 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2576, 2581) --> . John travelled to the
2025-01-22 05:46:16.182 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel took the milk there.
2025-01-22 05:46:16.191 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1806, 1811) --> . Daniel took the milk
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:46:16.969 | INFO     | test_jbb_embedding:begin_test:693 - the bedroom<|eot_id|>
2025-01-22 05:46:16.969 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8155])
2025-01-22 05:46:19.183 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [283.50625, 27.95981705074773, 356.15, 26.521687915742795, 16.286458333333332], 'topk_indices': array([8143,    1, 8052,   23, 6634, 8043, 6968, 8142,   14,   24, 5558,
       5555, 6969, 6970, 6637, 8153, 8053, 5557, 8150,    0]), 'topk_tokens': [' before', '<|start_header_id|>', ' first', '4', ' moved', '.\n\n', ' moved', ' football', '\n', '\n\n', '.', ' dropped', ' to', ' the', ' office', '<|end_header_id|>', ' location', ' football', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [237.47916666666666, 198.91666666666666, 656.625, 106.3125]}, 'weight': {'score': [21.701171875, 23.264155966535917, 21.0171875, 23.273542398066027, 29.31671626984127], 'topk_indices': array([3337, 3310, 3230, 3182, 7440, 7402, 1442, 1504, 4327, 4311, 5135,
       5196, 7123, 7179, 3519, 3493, 4960, 4989, 4937, 4912]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.052083333333332, 20.708333333333332, 27.013671875, 20.3515625]}, 'saliency': {'score': [1.74681396484375, 0.15635860337437177, 1.9018310546875, 0.14814000812238237, 0.12125093974764385], 'topk_indices': array([8043, 1811, 8145, 8148,   24, 1810, 8143, 6969, 8052,  667, 2581,
       5554, 6634, 6967, 6968, 5555, 8142, 6637, 8053, 5557]), 'topk_tokens': ['.\n\n', ' there', ' kitchen', 'Answer', '\n\n', ' milk', ' before', ' to', ' first', ' bedroom', ' bedroom', ' Mary', ' moved', ' Sandra', ' moved', ' dropped', ' football', ' office', ' location', ' football'], 'evidence_proportions': [1.2428385416666667, 1.1015218098958333, 4.673828125, 0.543701171875]}}, 'pred_res': 'the bedroom<|eot_id|>', 'score': 100}
2025-01-22 05:46:19.188 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:46:19.188 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-72_pid-0_1-6-7-9.pkl | len: 3 |  size: 2.04 KB
Processing depth (1, 6, 7, 9):   1%|          | 1/100 [00:21<34:42, 21.04s/it]is_0k: False
your chose emoji: ['😉', '🤦🏽', '🏃🏽', '👷🏽\u200d♂', '🦹🏻\u200d♀️', '👨🏿\u200d🔬', '🪖', '🧛🏾\u200d♀️', '🕶', '👎🏾']
emoji:
O: 😉 [76460, 231]
N: 🦹🏻‍♀️ [9468, 99, 117, 9468, 237, 119, 102470, 32990, 31643]

O: 🤦🏽 [9468, 97, 99, 9468, 237, 121]
N: 🏃🏽 [9468, 237, 225, 9468, 237, 121]

O: 🏃🏽 [9468, 237, 225, 9468, 237, 121]
N: 🕶 [9468, 243, 114]

O: 👷🏽‍♂ [9468, 239, 115, 9468, 237, 121, 102470, 17245, 224]
N: 🧛🏾‍♀️ [9468, 100, 249, 9468, 237, 122, 102470, 32990, 31643]

O: 🦹🏻‍♀️ [9468, 99, 117, 9468, 237, 119, 102470, 32990, 31643]
N: 🤦🏽 [9468, 97, 99, 9468, 237, 121]

O: 👨🏿‍🔬 [9468, 239, 101, 9468, 237, 123, 102470, 9468, 242, 105]
N: 👷🏽‍♂ [9468, 239, 115, 9468, 237, 121, 102470, 17245, 224]

O: 🪖 [9468, 103, 244]
N: 😉 [76460, 231]

O: 🧛🏾‍♀️ [9468, 100, 249, 9468, 237, 122, 102470, 32990, 31643]
N: 🪖 [9468, 103, 244]

O: 🕶 [9468, 243, 114]
N: 👨🏿‍🔬 [9468, 239, 101, 9468, 237, 123, 102470, 9468, 242, 105]

O: 👎🏾 [9468, 239, 236, 9468, 237, 122]
N: 👎🏾 [9468, 239, 236, 9468, 237, 122]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.43s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.69s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.51s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.22s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.71s/it]
Processing depth (0, 2, 3, 6):   1%|          | 1/100 [00:37<34:42, 21.04s/it]2025-01-22 05:46:35.768 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the bedroom.
2025-01-22 05:46:35.768 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 37) -->  journeyed to the bedroom.
2025-01-22 05:46:35.769 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went back to the kitchen.
2025-01-22 05:46:35.777 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1624, 1630) --> . Mary went back to the
2025-01-22 05:46:35.777 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary dropped the football.
2025-01-22 05:46:35.792 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2874, 2878) -->  Mary dropped the football
2025-01-22 05:46:35.793 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the milk.
2025-01-22 05:46:35.819 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4767, 4771) -->  Daniel left the milk
2025-01-22 05:46:35.819 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the office.
2025-01-22 05:46:35.862 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6699, 6704) --> . Daniel moved to the
2025-01-22 05:46:35.863 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the garden.
2025-01-22 05:46:35.899 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (7061, 7066) --> . Sandra moved to the
2025-01-22 05:46:35.899 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the bedroom.
2025-01-22 05:46:35.912 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2603, 2608) --> . John travelled to the
2025-01-22 05:46:35.913 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel took the milk there.
2025-01-22 05:46:35.923 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1789, 1794) --> . Daniel took the milk
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:46:36.720 | INFO     | test_jbb_embedding:begin_test:693 - the bedroom<|eot_id|>
2025-01-22 05:46:36.720 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8195])
2025-01-22 05:46:38.951 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [231.8234375, 19.754511389973164, 97.30390625, 19.044488538857564, 14.46925592996988], 'topk_indices': array([  23, 8049, 7588,   31, 8177, 8178, 8176, 8083, 8193,   24, 8093,
       8182, 4279, 8185, 2877,   14, 8191, 8183, 8190,    0]), 'topk_tokens': ['4', ' context', 'nes', ' journey', 'Question', ':', '.\n\n', '.\n\n', '<|end_header_id|>', '\n\n', ' location', ' football', '�', ' kitchen', ' football', '\n', '<|start_header_id|>', ' before', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [325.7916666666667, 204.89583333333334, 325.6875, 37.3984375]}, 'weight': {'score': [23.1234375, 23.300944208953403, 21.0171875, 23.30697819624908, 29.66961596385542], 'topk_indices': array([3357, 3330, 3202, 3250, 7442, 7480, 1542, 1480, 4369, 4353, 5169,
       5230, 7213, 7157, 3513, 3539, 4994, 5023, 4946, 4971]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.71875, 20.708333333333332, 27.013671875, 26.462890625]}, 'saliency': {'score': [1.394769287109375, 0.11137745641562728, 0.564630126953125, 0.10711993128390077, 0.11032279140977974], 'topk_indices': array([2659, 2657, 8179, 7587, 2731, 2605, 7543, 1630, 7588, 2608, 8049,
         35, 4279, 8177,   31, 8093, 8183, 8182, 8185, 2877]), 'topk_tokens': [' shore', 'ared', ' Where', ' Min', ' ne', ' travelled', 'nes', ' kitchen', 'nes', ' bedroom', ' context', ' bedroom', '�', 'Question', ' journey', ' location', ' before', ' football', ' kitchen', ' football'], 'evidence_proportions': [1.8735758463541667, 1.0600992838541667, 2.3345947265625, 0.238739013671875]}}, 'pred_res': 'the bedroom<|eot_id|>', 'score': 100}
2025-01-22 05:46:38.958 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:46:38.959 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-72_pid-1_0-2-3-6.pkl | len: 3 |  size: 2.04 KB
Processing depth (0, 2, 3, 6):   2%|▏         | 2/100 [00:40<33:08, 20.29s/it]is_0k: False
your chose emoji: ['\U0001faf3🏼', '🧜🏼\u200d♀️', '👨🏿\u200d❤\u200d👨🏾', '🕵\u200d♂️', '🇰🇵', '👩🏽\u200d❤️\u200d💋\u200d👨🏿', '🕙', '💇🏽\u200d♂️', '🍛', '🧝🏽']
emoji:
O: 🫳🏼 [9468, 104, 111, 9468, 237, 120]
N: 🇰🇵 [9468, 229, 108, 9468, 229, 113]

O: 🧜🏼‍♀️ [9468, 100, 250, 9468, 237, 120, 102470, 32990, 31643]
N: 👨🏿‍❤‍👨🏾 [9468, 239, 101, 9468, 237, 123, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 122]

O: 👨🏿‍❤‍👨🏾 [9468, 239, 101, 9468, 237, 123, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 122]
N: 🕵‍♂️ [9468, 243, 113, 102470, 17245, 224, 31643]

O: 🕵‍♂️ [9468, 243, 113, 102470, 17245, 224, 31643]
N: 🧜🏼‍♀️ [9468, 100, 250, 9468, 237, 120, 102470, 32990, 31643]

O: 🇰🇵 [9468, 229, 108, 9468, 229, 113]
N: 👩🏽‍❤️‍💋‍👨🏿 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 123]

O: 👩🏽‍❤️‍💋‍👨🏿 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 123]
N: 🍛 [9468, 235, 249]

O: 🕙 [9468, 243, 247]
N: 🫳🏼 [9468, 104, 111, 9468, 237, 120]

O: 💇🏽‍♂️ [93273, 229, 9468, 237, 121, 102470, 17245, 224, 31643]
N: 💇🏽‍♂️ [93273, 229, 9468, 237, 121, 102470, 17245, 224, 31643]

O: 🍛 [9468, 235, 249]
N: 🕙 [9468, 243, 247]

O: 🧝🏽 [9468, 100, 251, 9468, 237, 121]
N: 🧝🏽 [9468, 100, 251, 9468, 237, 121]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.62s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.83s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.56s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  2.94s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.58s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (2, 5, 8, 9):   2%|▏         | 2/100 [00:56<33:08, 20.29s/it]2025-01-22 05:46:55.040 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the bedroom.
2025-01-22 05:46:55.049 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1795, 1801) --> . Mary journeyed to the
2025-01-22 05:46:55.049 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went back to the kitchen.
2025-01-22 05:46:55.069 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4148, 4154) --> . Mary went back to the
2025-01-22 05:46:55.069 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary dropped the football.
2025-01-22 05:46:55.101 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6588, 6592) -->  Mary dropped the football
2025-01-22 05:46:55.101 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the milk.
2025-01-22 05:46:55.135 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7201, 7205) -->  Daniel left the milk
2025-01-22 05:46:55.135 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the office.
2025-01-22 05:46:55.167 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6650, 6655) --> . Daniel moved to the
2025-01-22 05:46:55.167 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the garden.
2025-01-22 05:46:55.203 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6962, 6967) --> . Sandra moved to the
2025-01-22 05:46:55.203 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the bedroom.
2025-01-22 05:46:55.218 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2579, 2584) -->  John travelled to the bedroom
2025-01-22 05:46:55.219 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel took the milk there.
2025-01-22 05:46:55.230 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1823, 1828) -->  Daniel took the milk there
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:46:57.589 | INFO     | test_jbb_embedding:begin_test:693 - the garden<|eot_id|>
2025-01-22 05:46:57.589 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8163])
2025-01-22 05:47:00.405 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [158.559375, 16.553529879990204, 242.046875, 15.649027811961604, 31.51533348880597], 'topk_indices': array([8151, 6964, 8144, 8150, 8051, 8157, 8061, 6965, 8162,   24, 6655,
          3,   23, 6966, 6591, 8161,   14, 8159,    0, 8158]), 'topk_tokens': [' before', ' moved', '.\n\n', ' football', '.\n\n', ':', ' location', ' to', '\n\n', '\n\n', ' office', '<|end_header_id|>', '4', ' the', ' football', '<|end_header_id|>', '\n', '<|start_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [178.69791666666666, 76.90625, 379.625, 29.765625]}, 'weight': {'score': [22.9234375, 23.26636549412197, 23.13515625, 23.267532457543687, 29.090018656716417], 'topk_indices': array([3300, 3327, 3172, 3220, 7416, 7378, 1431, 1493, 4312, 4296, 5107,
       5168, 7094, 7150, 3509, 3483, 4932, 4909, 4961, 4884]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.052083333333332, 20.708333333333332, 27.013671875, 26.462890625]}, 'saliency': {'score': [0.9640716552734375, 0.09235018268391808, 1.37720947265625, 0.08704232946570037, 0.22656978777985073], 'topk_indices': array([  20,   24, 8160, 2580, 8151, 7888, 6589,   23, 1801, 2583, 6964,
       8156, 1810, 1809, 6963, 8145, 8150, 8061, 6655, 6591]), 'topk_tokens': [' Jul', '\n\n', 'assistant', ' travelled', ' before', ' Square', ' dropped', '4', ' bedroom', ' bedroom', ' moved', 'Answer', '�', '\u200d', ' Sandra', 'Question', ' football', ' location', ' office', ' football'], 'evidence_proportions': [0.9263916015625, 0.3995361328125, 2.6368408203125, 0.1946258544921875]}}, 'pred_res': 'the garden<|eot_id|>', 'score': 0}
2025-01-22 05:47:00.412 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:47:00.412 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-72_pid-2_2-5-8-9.pkl | len: 3 |  size: 2.04 KB
Processing depth (2, 5, 8, 9):   3%|▎         | 3/100 [01:02<33:39, 20.82s/it]is_0k: False
your chose emoji: ['\U0001faf7🏻', '🧑🏾\u200d🚒', '🧑🏾\u200d⚕', '💇', '💇🏽', '🧑🏼\u200d⚖️', '💙', '💐', '🧮', '👨🏿\u200d❤️\u200d👨🏼']
emoji:
O: 🫷🏻 [9468, 104, 115, 9468, 237, 119]
N: 🧑🏼‍⚖️ [9468, 100, 239, 9468, 237, 120, 102470, 158, 248, 244, 31643]

O: 🧑🏾‍🚒 [9468, 100, 239, 9468, 237, 122, 102470, 9468, 248, 240]
N: 💇🏽 [93273, 229, 9468, 237, 121]

O: 🧑🏾‍⚕ [9468, 100, 239, 9468, 237, 122, 102470, 158, 248, 243]
N: 🧑🏾‍⚕ [9468, 100, 239, 9468, 237, 122, 102470, 158, 248, 243]

O: 💇 [93273, 229]
N: 💙 [93273, 247]

O: 💇🏽 [93273, 229, 9468, 237, 121]
N: 🧮 [9468, 100, 106]

O: 🧑🏼‍⚖️ [9468, 100, 239, 9468, 237, 120, 102470, 158, 248, 244, 31643]
N: 💐 [93273, 238]

O: 💙 [93273, 247]
N: 🧑🏾‍🚒 [9468, 100, 239, 9468, 237, 122, 102470, 9468, 248, 240]

O: 💐 [93273, 238]
N: 💇 [93273, 229]

O: 🧮 [9468, 100, 106]
N: 🫷🏻 [9468, 104, 115, 9468, 237, 119]

O: 👨🏿‍❤️‍👨🏼 [9468, 239, 101, 9468, 237, 123, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 120]
N: 👨🏿‍❤️‍👨🏼 [9468, 239, 101, 9468, 237, 123, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 120]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.91s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:10<00:10,  5.11s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.84s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.36s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.94s/it]
Processing depth (2, 4, 8, 9):   3%|▎         | 3/100 [01:20<33:39, 20.82s/it]2025-01-22 05:47:18.428 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the bedroom.
2025-01-22 05:47:18.438 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1998, 2004) -->  cable. Mary journeyed to
2025-01-22 05:47:18.438 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went back to the kitchen.
2025-01-22 05:47:18.460 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3714, 3720) --> . Mary went back to the
2025-01-22 05:47:18.461 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary dropped the football.
2025-01-22 05:47:18.492 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6588, 6592) -->  Mary dropped the football
2025-01-22 05:47:18.492 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the milk.
2025-01-22 05:47:18.526 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7209, 7213) -->  Daniel left the milk
2025-01-22 05:47:18.526 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the office.
2025-01-22 05:47:18.559 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6650, 6655) --> . Daniel moved to the
2025-01-22 05:47:18.559 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the garden.
2025-01-22 05:47:18.593 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6970, 6975) --> . Sandra moved to the
2025-01-22 05:47:18.593 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the bedroom.
2025-01-22 05:47:18.607 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2904, 2909) --> . John travelled to the
2025-01-22 05:47:18.607 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel took the milk there.
2025-01-22 05:47:18.617 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2102, 2107) --> . Daniel took the milk
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:47:19.376 | INFO     | test_jbb_embedding:begin_test:693 - the office<|eot_id|>
2025-01-22 05:47:19.377 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8145])
2025-01-22 05:47:21.587 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [209.43359375, 28.87593197717231, 561.5875, 27.11651108473113, 18.979828933189655], 'topk_indices': array([6970, 8140, 2005,   24, 2274, 6652, 2374, 2373, 6653, 6654, 2275,
       6971, 6972, 2276, 6655, 6973, 2375, 2277, 6974,    0]), 'topk_tokens': ['.', '<|eot_id|>', ' bedroom', '\n\n', ' some', ' moved', '\n', ' some', ' to', ' the', '\n', ' Sandra', ' moved', 'little', ' office', ' to', 'little', ' time', ' the', '<|begin_of_text|>'], 'evidence_proportions': [287.1041666666667, 110.10416666666667, 423.75, 27.60546875]}, 'weight': {'score': [24.030078125, 23.260153948821795, 21.0171875, 23.26378750154169, 29.557381465517242], 'topk_indices': array([3244, 3271, 3164, 3116, 7386, 7424, 1399, 1461, 4238, 4254, 5168,
       5107, 7102, 7158, 3427, 3453, 4909, 4961, 4932, 4884]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [23.740885416666668, 20.708333333333332, 27.013671875, 26.462890625]}, 'saliency': {'score': [1.3176239013671875, 0.16229886264267304, 2.915631103515625, 0.15265737946655694, 0.14153658110519934], 'topk_indices': array([2273, 2122, 6653,   24, 6588, 2001, 6651, 6974, 6591, 2274, 6652,
       6973, 2373, 2005, 6972, 2277, 6971, 2276, 6655, 2375]), 'topk_tokens': [' extra', 're', ' to', '\n\n', ' Mary', ' journey', ' Daniel', ' the', ' football', ' some', ' moved', ' to', ' some', ' bedroom', ' moved', ' time', ' Sandra', 'little', ' office', 'little'], 'evidence_proportions': [1.6573079427083333, 0.5888264973958334, 3.031982421875, 0.1869354248046875]}}, 'pred_res': 'the office<|eot_id|>', 'score': 0}
2025-01-22 05:47:21.595 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:47:21.596 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-72_pid-3_2-4-8-9.pkl | len: 3 |  size: 1.98 KB
Processing depth (2, 4, 8, 9):   4%|▍         | 4/100 [01:23<33:32, 20.96s/it]is_0k: False
your chose emoji: ['◽', '🧋', '🙄', 'Ⓜ️', '🖕🏼', '☢', '🧖🏽', '👩🏿\u200d❤️\u200d👨🏾', '🧎🏾\u200d➡️', '🧍\u200d♀️']
emoji:
O: ◽ [41832, 121]
N: ☢ [18107, 95]

O: 🧋 [9468, 100, 233]
N: ◽ [41832, 121]

O: 🙄 [9468, 247, 226]
N: 🙄 [9468, 247, 226]

O: Ⓜ️ [158, 241, 224, 31643]
N: 🖕🏼 [9468, 244, 243, 9468, 237, 120]

O: 🖕🏼 [9468, 244, 243, 9468, 237, 120]
N: Ⓜ️ [158, 241, 224, 31643]

O: ☢ [18107, 95]
N: 👩🏿‍❤️‍👨🏾 [9468, 239, 102, 9468, 237, 123, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 122]

O: 🧖🏽 [9468, 100, 244, 9468, 237, 121]
N: 🧎🏾‍➡️ [9468, 100, 236, 9468, 237, 122, 102470, 98115, 94, 31643]

O: 👩🏿‍❤️‍👨🏾 [9468, 239, 102, 9468, 237, 123, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 122]
N: 🧖🏽 [9468, 100, 244, 9468, 237, 121]

O: 🧎🏾‍➡️ [9468, 100, 236, 9468, 237, 122, 102470, 98115, 94, 31643]
N: 🧋 [9468, 100, 233]

O: 🧍‍♀️ [9468, 100, 235, 102470, 32990, 31643]
N: 🧍‍♀️ [9468, 100, 235, 102470, 32990, 31643]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.34s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.62s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.79s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.38s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.84s/it]
Processing depth (1, 2, 3, 4):   4%|▍         | 4/100 [01:40<33:32, 20.96s/it]2025-01-22 05:47:38.660 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the bedroom.
2025-01-22 05:47:38.666 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (895, 901) --> . Mary journeyed to the
2025-01-22 05:47:38.667 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went back to the kitchen.
2025-01-22 05:47:38.678 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1860, 1866) --> . Mary went back to the
2025-01-22 05:47:38.678 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary dropped the football.
2025-01-22 05:47:38.692 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2943, 2947) -->  dropped the football.
2025-01-22 05:47:38.692 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the milk.
2025-01-22 05:47:38.713 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3637, 3641) -->  Daniel left the milk
2025-01-22 05:47:38.713 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the office.
2025-01-22 05:47:38.747 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6673, 6678) --> . Daniel moved to the
2025-01-22 05:47:38.747 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the garden.
2025-01-22 05:47:38.787 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (7037, 7042) --> . Sandra moved to the
2025-01-22 05:47:38.787 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the bedroom.
2025-01-22 05:47:38.801 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2873, 2878) --> . John travelled to the
2025-01-22 05:47:38.801 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel took the milk there.
2025-01-22 05:47:38.814 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2031, 2036) --> . Daniel took the milk
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:47:39.584 | INFO     | test_jbb_embedding:begin_test:693 - the bedroom<|eot_id|>
2025-01-22 05:47:39.585 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8161])
2025-01-22 05:47:41.792 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [177.52265625, 13.04756112965458, 63.6109375, 12.51817050560069, 15.164920691287879], 'topk_indices': array([8154, 8143,    1, 8144, 8142, 8049,    3,  901, 8148, 2878,   24,
       8149, 8059, 8160, 8155,   14, 2945, 8159,    0, 8156]), 'topk_tokens': ['Answer', 'Question', '<|start_header_id|>', ':', '.\n\n', '.\n\n', '<|end_header_id|>', ' bedroom', ' football', ' bedroom', '\n\n', ' before', ' location', '\n\n', ':', '\n', ' football', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [230.08333333333334, 121.80208333333333, 320.0, 39.78515625]}, 'weight': {'score': [21.766796875, 23.275552348726116, 21.0171875, 23.28482640171098, 29.746448863636363], 'topk_indices': array([3298, 3325, 3170, 3218, 7360, 7398, 1424, 1486, 4288, 4304, 5111,
       5172, 7081, 7137, 3481, 3507, 4924, 4953, 4901, 4876]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.052083333333332, 20.708333333333332, 21.23046875, 26.462890625]}, 'saliency': {'score': [1.0012786865234375, 0.072345649536073, 0.3623992919921875, 0.06934469759258832, 0.11132673783735796], 'topk_indices': array([8145, 8133, 8142, 8158, 8049, 8130, 8013,   24, 8160, 8015, 8151,
        897, 8154, 8149, 8143, 8059, 8148,  901, 2878, 2945]), 'topk_tokens': [' Where', ' directly', '.\n\n', 'assistant', '.\n\n', ' return', ' provided', '\n\n', '\n\n', ' context', ' kitchen', ' journey', 'Answer', ' before', 'Question', ' location', ' football', ' bedroom', ' bedroom', ' football'], 'evidence_proportions': [1.2140299479166667, 0.6576741536458334, 1.9385986328125, 0.2602386474609375]}}, 'pred_res': 'the bedroom<|eot_id|>', 'score': 100}
2025-01-22 05:47:41.799 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:47:41.799 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-72_pid-4_1-2-3-4.pkl | len: 3 |  size: 2.05 KB
Processing depth (1, 2, 3, 4):   5%|▌         | 5/100 [01:43<32:45, 20.69s/it]Processing depth (1, 2, 3, 4):   5%|▌         | 5/100 [01:43<32:50, 20.74s/it]
2025-01-22 05:47:41.875 | INFO     | __main__:<module>:82 - Selected idx: 73
2025-01-22 05:47:41.875 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the location prior to the place where the apple was discarded, left or dropped?
2025-01-22 05:47:41.875 | INFO     | __main__:<module>:84 - Answer: bedroom
2025-01-22 05:47:41.876 | INFO     | __main__:<module>:85 - Tag: 4-hop
2025-01-22 05:47:41.876 | INFO     | __main__:<module>:86 - Needle: [' Sandra moved to the garden.', ' Mary journeyed to the bedroom.', ' Mary got the apple.', ' John travelled to the bedroom.', ' Mary went back to the kitchen.', ' Daniel moved to the office.', ' Daniel took the milk there.', ' Mary dropped the apple.', ' Daniel left the milk.']
2025-01-22 05:47:41.876 | INFO     | __main__:<module>:87 - Real Needle: [' Mary journeyed to the bedroom.', ' Mary got the apple.', ' Mary went back to the kitchen.', ' Mary dropped the apple.', ' Daniel left the milk.']
2025-01-22 05:47:41.876 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['🏃🏽\u200d♂', '☢️', '👳🏾', '🙎🏽\u200d♀️', '🛣', '🛫', '🦹🏽', '🧝🏽\u200d♀️', '🏁', '👩🏾\u200d❤\u200d👩🏽']
emoji:
O: 🏃🏽‍♂ [9468, 237, 225, 9468, 237, 121, 102470, 17245, 224]
N: 🙎🏽‍♀️ [9468, 247, 236, 9468, 237, 121, 102470, 32990, 31643]

O: ☢️ [18107, 95, 31643]
N: 🏁 [9468, 237, 223]

O: 👳🏾 [9468, 239, 111, 9468, 237, 122]
N: 🧝🏽‍♀️ [9468, 100, 251, 9468, 237, 121, 102470, 32990, 31643]

O: 🙎🏽‍♀️ [9468, 247, 236, 9468, 237, 121, 102470, 32990, 31643]
N: 🛣 [9468, 249, 96]

O: 🛣 [9468, 249, 96]
N: 👳🏾 [9468, 239, 111, 9468, 237, 122]

O: 🛫 [9468, 249, 104]
N: 🦹🏽 [9468, 99, 117, 9468, 237, 121]

O: 🦹🏽 [9468, 99, 117, 9468, 237, 121]
N: 🛫 [9468, 249, 104]

O: 🧝🏽‍♀️ [9468, 100, 251, 9468, 237, 121, 102470, 32990, 31643]
N: 🏃🏽‍♂ [9468, 237, 225, 9468, 237, 121, 102470, 17245, 224]

O: 🏁 [9468, 237, 223]
N: ☢️ [18107, 95, 31643]

O: 👩🏾‍❤‍👩🏽 [9468, 239, 102, 9468, 237, 122, 102470, 121643, 102470, 9468, 239, 102, 9468, 237, 121]
N: 👩🏾‍❤‍👩🏽 [9468, 239, 102, 9468, 237, 122, 102470, 121643, 102470, 9468, 239, 102, 9468, 237, 121]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.11s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.29s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.37s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.05s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.51s/it]
Processing depth (0, 4, 5, 7, 8):   0%|          | 0/100 [00:15<?, ?it/s]2025-01-22 05:47:57.784 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the bedroom.
2025-01-22 05:47:57.785 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 37) -->  journeyed to the bedroom.
2025-01-22 05:47:57.785 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary got the apple.
2025-01-22 05:47:57.808 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3617, 3621) -->  Mary got the apple
2025-01-22 05:47:57.809 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the kitchen.
2025-01-22 05:47:57.836 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4153, 4159) --> . Mary went back to the
2025-01-22 05:47:57.836 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary dropped the apple.
2025-01-22 05:47:57.876 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5659, 5663) -->  Mary dropped the apple
2025-01-22 05:47:57.876 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel left the milk.
2025-01-22 05:47:57.911 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6626, 6630) -->  Daniel left the milk
2025-01-22 05:47:57.911 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the garden.
2025-01-22 05:47:57.930 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3828, 3833) -->  Sandra moved to the garden
2025-01-22 05:47:57.930 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the bedroom.
2025-01-22 05:47:57.943 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2164, 2169) --> . John travelled to the
2025-01-22 05:47:57.943 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 05:47:57.970 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4892, 4897) --> . Daniel moved to the
2025-01-22 05:47:57.971 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel took the milk there.
2025-01-22 05:47:57.993 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3991, 3996) --> . Daniel took the milk
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:47:58.827 | INFO     | test_jbb_embedding:begin_test:693 - Mary's hand.<|eot_id|>
2025-01-22 05:47:58.827 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8179])
2025-01-22 05:48:01.055 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [478.2552083333333, 43.59319237350281, 229.959375, 41.8533039444581, 25.00942095588235], 'topk_indices': array([  24, 2166, 8159, 6052, 8024, 5917, 8152, 5659, 3621,   31, 5662,
       7550, 4307, 3620, 8153, 7506, 8174, 6053, 7551,    0]), 'topk_tokens': ['\n\n', ' travelled', ' to', ',', ' context', ' which', 'Question', ' Mary', '.', ' journey', ' apple', ' Min', 'nes', ' apple', ':', 'nes', '<|eot_id|>', ' in', 'nes', '<|begin_of_text|>'], 'evidence_proportions': [663.7083333333334, 645.5625, 181.08333333333334, 744.8125, 211.96875]}, 'weight': {'score': [23.618815104166668, 23.2736647518944, 22.145703125, 23.2754189450725, 29.53561580882353], 'topk_indices': array([3327, 3300, 3220, 3172, 7405, 7443, 1456, 1518, 4325, 4341, 5203,
       5142, 7126, 7182, 3509, 3483, 4944, 4919, 4996, 4967]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.71875, 26.353515625, 20.708333333333332, 26.755859375, 26.462890625]}, 'saliency': {'score': [2.9782511393229165, 0.2461403879609967, 1.379150390625, 0.23529855236429406, 0.1851211996639476], 'topk_indices': array([8068, 5660, 5917, 5897, 8158, 8166, 8172, 2169,   35, 8024, 2166,
       5659, 4307, 7550, 5662, 7506,   31, 8152, 3620, 7551]), 'topk_tokens': [' location', ' dropped', ' which', 'ayers', ' prior', ' discarded', 'Answer', ' bedroom', ' bedroom', ' context', ' travelled', ' Mary', 'nes', ' Min', ' apple', 'nes', ' journey', 'Question', ' apple', 'nes'], 'evidence_proportions': [3.7102864583333335, 4.32421875, 0.938720703125, 5.158935546875, 1.412841796875]}}, 'pred_res': "Mary's hand.<|eot_id|>", 'score': 0}
2025-01-22 05:48:01.069 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:48:01.070 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-73_pid-0_0-4-5-7-8.pkl | len: 3 |  size: 2.06 KB
Processing depth (0, 4, 5, 7, 8):   1%|          | 1/100 [00:19<31:24, 19.04s/it]is_0k: False
your chose emoji: ['🤸\u200d♀', '🧑🏽\u200d❤️\u200d🧑🏻', '🤵🏿\u200d♀️', '🏂', '🎀', '🇬🇵', '🚵🏿', '🏌\u200d♀', '🇳🇦', '🤦🏿\u200d♂']
emoji:
O: 🤸‍♀ [9468, 97, 116, 102470, 32990]
N: 🎀 [9468, 236, 222]

O: 🧑🏽‍❤️‍🧑🏻 [9468, 100, 239, 9468, 237, 121, 102470, 121643, 31643, 102470, 9468, 100, 239, 9468, 237, 119]
N: 🚵🏿 [9468, 248, 113, 9468, 237, 123]

O: 🤵🏿‍♀️ [9468, 97, 113, 9468, 237, 123, 102470, 32990, 31643]
N: 🧑🏽‍❤️‍🧑🏻 [9468, 100, 239, 9468, 237, 121, 102470, 121643, 31643, 102470, 9468, 100, 239, 9468, 237, 119]

O: 🏂 [9468, 237, 224]
N: 🇳🇦 [9468, 229, 111, 9468, 229, 99]

O: 🎀 [9468, 236, 222]
N: 🇬🇵 [9468, 229, 105, 9468, 229, 113]

O: 🇬🇵 [9468, 229, 105, 9468, 229, 113]
N: 🏌‍♀ [9468, 237, 234, 102470, 32990]

O: 🚵🏿 [9468, 248, 113, 9468, 237, 123]
N: 🤵🏿‍♀️ [9468, 97, 113, 9468, 237, 123, 102470, 32990, 31643]

O: 🏌‍♀ [9468, 237, 234, 102470, 32990]
N: 🤸‍♀ [9468, 97, 116, 102470, 32990]

O: 🇳🇦 [9468, 229, 111, 9468, 229, 99]
N: 🏂 [9468, 237, 224]

O: 🤦🏿‍♂ [9468, 97, 99, 9468, 237, 123, 102470, 17245, 224]
N: 🤦🏿‍♂ [9468, 97, 99, 9468, 237, 123, 102470, 17245, 224]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.51s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.64s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.42s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.85s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.46s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 4, 6, 7, 9):   1%|          | 1/100 [00:34<31:24, 19.04s/it]2025-01-22 05:48:16.752 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the bedroom.
2025-01-22 05:48:16.752 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 37) -->  journeyed to the bedroom.
2025-01-22 05:48:16.752 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary got the apple.
2025-01-22 05:48:16.770 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3625, 3629) -->  Mary got the apple
2025-01-22 05:48:16.770 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the kitchen.
2025-01-22 05:48:16.794 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4733, 4739) --> . Mary went back to the
2025-01-22 05:48:16.794 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary dropped the apple.
2025-01-22 05:48:16.821 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5661, 5665) -->  Mary dropped the apple
2025-01-22 05:48:16.822 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel left the milk.
2025-01-22 05:48:16.856 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7268, 7272) -->  Daniel left the milk
2025-01-22 05:48:16.856 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the garden.
2025-01-22 05:48:16.876 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3829, 3834) --> . Sandra moved to the
2025-01-22 05:48:16.876 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the bedroom.
2025-01-22 05:48:16.886 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2214, 2219) --> . John travelled to the
2025-01-22 05:48:16.887 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 05:48:16.911 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4894, 4899) --> . Daniel moved to the
2025-01-22 05:48:16.911 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel took the milk there.
2025-01-22 05:48:16.931 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4059, 4064) --> . Daniel took the milk
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:48:19.795 | INFO     | test_jbb_embedding:begin_test:693 - Mary's hand.<|eot_id|>
2025-01-22 05:48:19.795 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8187])
2025-01-22 05:48:22.541 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [447.6197916666667, 42.755433455433455, 218.30625, 41.13159833046894, 45.765407986111114], 'topk_indices': array([2663, 2679, 5665, 1166, 8167, 6055, 2608, 8076, 8183, 2682, 1181,
       8161,   31, 8182, 5664, 3628, 8032, 1161, 3629,    0]), 'topk_tokens': [',', 'as', '.', '\n', ' to', ' in', 'ared', ' location', '<|start_header_id|>', ' ne', 'nes', ':', ' journey', '<|eot_id|>', ' apple', ' apple', ' context', 'nes', '.', '<|begin_of_text|>'], 'evidence_proportions': [642.4166666666666, 643.0625, 162.97916666666666, 744.375, 90.1875]}, 'weight': {'score': [23.618815104166668, 23.283882783882785, 21.0171875, 23.288461169592438, 29.768880208333332], 'topk_indices': array([3335, 3308, 3180, 3228, 7419, 7457, 1444, 1506, 4326, 4310, 5144,
       5205, 7103, 7159, 3491, 3517, 4998, 4946, 4921, 4969]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.71875, 26.353515625, 20.708333333333332, 26.755859375, 26.462890625]}, 'saliency': {'score': [2.7733968098958335, 0.24059191134386446, 1.258416748046875, 0.23063072618558955, 0.35441843668619794], 'topk_indices': array([1220, 2607, 1168, 5899, 2590, 8166, 5662, 2219, 8174, 8076, 2608,
       2216, 1181, 2682, 8160, 5664,   31, 1161, 8032, 3628]), 'topk_tokens': [' Min', ' ne', 'ioneer', 'ayers', 'engers', ' prior', ' dropped', ' bedroom', ' discarded', ' location', 'ared', ' travelled', 'nes', ' ne', 'Question', ' apple', ' journey', 'nes', ' context', ' apple'], 'evidence_proportions': [3.6228841145833335, 4.33740234375, 0.8213297526041666, 5.0302734375, 0.60638427734375]}}, 'pred_res': "Mary's hand.<|eot_id|>", 'score': 0}
2025-01-22 05:48:22.552 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:48:22.553 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-73_pid-1_0-4-6-7-9.pkl | len: 3 |  size: 2.05 KB
Processing depth (0, 4, 6, 7, 9):   2%|▏         | 2/100 [00:40<33:26, 20.48s/it]is_0k: False
your chose emoji: ['\U0001fac4🏼', '🏞️', '🧑🏾\u200d❤️\u200d🧑🏻', '🧎🏾\u200d♀\u200d➡', '🧟\u200d♀', '◻', '🎵', '🍢', '👩🏻\u200d❤️\u200d👩🏿', '🙍🏾']
emoji:
O: 🫄🏼 [9468, 104, 226, 9468, 237, 120]
N: 🧎🏾‍♀‍➡ [9468, 100, 236, 9468, 237, 122, 102470, 32990, 102470, 98115, 94]

O: 🏞️ [9468, 237, 252, 31643]
N: ◻ [41832, 119]

O: 🧑🏾‍❤️‍🧑🏻 [9468, 100, 239, 9468, 237, 122, 102470, 121643, 31643, 102470, 9468, 100, 239, 9468, 237, 119]
N: 🫄🏼 [9468, 104, 226, 9468, 237, 120]

O: 🧎🏾‍♀‍➡ [9468, 100, 236, 9468, 237, 122, 102470, 32990, 102470, 98115, 94]
N: 👩🏻‍❤️‍👩🏿 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 31643, 102470, 9468, 239, 102, 9468, 237, 123]

O: 🧟‍♀ [9468, 100, 253, 102470, 32990]
N: 🎵 [9468, 236, 113]

O: ◻ [41832, 119]
N: 🧟‍♀ [9468, 100, 253, 102470, 32990]

O: 🎵 [9468, 236, 113]
N: 🏞️ [9468, 237, 252, 31643]

O: 🍢 [9468, 235, 95]
N: 🧑🏾‍❤️‍🧑🏻 [9468, 100, 239, 9468, 237, 122, 102470, 121643, 31643, 102470, 9468, 100, 239, 9468, 237, 119]

O: 👩🏻‍❤️‍👩🏿 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 31643, 102470, 9468, 239, 102, 9468, 237, 123]
N: 🍢 [9468, 235, 95]

O: 🙍🏾 [9468, 247, 235, 9468, 237, 122]
N: 🙍🏾 [9468, 247, 235, 9468, 237, 122]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.82s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.89s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.57s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.19s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.75s/it]
Processing depth (0, 1, 2, 6, 8):   2%|▏         | 2/100 [00:57<33:26, 20.48s/it]2025-01-22 05:48:39.356 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the bedroom.
2025-01-22 05:48:39.356 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 37) -->  journeyed to the bedroom.
2025-01-22 05:48:39.356 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary got the apple.
2025-01-22 05:48:39.360 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (837, 841) -->  Mary got the apple
2025-01-22 05:48:39.361 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the kitchen.
2025-01-22 05:48:39.371 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1867, 1873) --> . Mary went back to the
2025-01-22 05:48:39.371 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary dropped the apple.
2025-01-22 05:48:39.396 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4755, 4759) -->  Mary dropped the apple
2025-01-22 05:48:39.396 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel left the milk.
2025-01-22 05:48:39.430 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6642, 6646) -->  Daniel left the milk
2025-01-22 05:48:39.430 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the garden.
2025-01-22 05:48:39.454 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3876, 3881) --> . Sandra moved to the
2025-01-22 05:48:39.454 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the bedroom.
2025-01-22 05:48:39.466 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2412, 2417) --> . John travelled to the
2025-01-22 05:48:39.466 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 05:48:39.492 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4913, 4918) --> . Daniel moved to the
2025-01-22 05:48:39.492 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel took the milk there.
2025-01-22 05:48:39.511 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4101, 4106) -->  Daniel took the milk there
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:48:40.276 | INFO     | test_jbb_embedding:begin_test:693 - kitchen<|eot_id|>
2025-01-22 05:48:40.276 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8217])
2025-01-22 05:48:42.517 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [352.76953125, 24.787163549270073, 68.471875, 23.71753646342955, 23.154308099856323], 'topk_indices': array([8212,  205, 8106,  186,  841, 8197,   32,  840, 8191,   14,  202,
        127,   24, 8062,   31,  126,   35,  206, 8213,    0]), 'topk_tokens': ['<|eot_id|>', ' P', ' location', 'ION', '.', ' to', 'ed', ' apple', ':', '\n', 'G', 'E', '\n\n', ' context', ' journey', 'ION', ' bedroom', 'ION', '<|start_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [621.25, 412.75, 291.7083333333333, 250.5, 83.9296875]}, 'weight': {'score': [23.618815104166668, 23.30675562652068, 21.778515625, 23.309577956824853, 29.73132183908046], 'topk_indices': array([3333, 3306, 3178, 3226, 7449, 7411, 1431, 1493, 4321, 4337, 5163,
       5224, 7132, 7188, 3489, 3515, 4940, 5017, 4988, 4965]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.71875, 26.353515625, 20.708333333333332, 26.755859375, 26.462890625]}, 'saliency': {'score': [2.149744669596354, 0.14068094146802768, 0.41260986328125, 0.1341183059602801, 0.1704272566170528], 'topk_indices': array([  95, 4762, 8202,  127,  133, 1928,  202, 8196,  186, 8106, 8190,
       1873, 8204,   30,  840, 8062,  126,   31,  206,   35]), 'topk_tokens': [' PA', 'super', ' apple', 'E', ' PA', 'asca', 'G', ' prior', 'ION', ' location', 'Question', ' kitchen', ' discarded', 'Mary', ' apple', ' context', 'ION', ' journey', 'ION', ' bedroom'], 'evidence_proportions': [3.7200520833333335, 2.761474609375, 1.536865234375, 1.6773681640625, 0.574249267578125]}}, 'pred_res': 'kitchen<|eot_id|>', 'score': 0}
2025-01-22 05:48:42.526 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:48:42.526 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-73_pid-2_0-1-2-6-8.pkl | len: 3 |  size: 2.03 KB
Processing depth (0, 1, 2, 6, 8):   3%|▎         | 3/100 [01:00<32:43, 20.25s/it]is_0k: False
your chose emoji: ['🦟', '💔', '🧑🏿\u200d🦼', '🧎🏿\u200d♂\u200d➡️', '👩🏿\u200d❤\u200d👩🏽', '⛹🏻\u200d♂️', '👷🏻\u200d♀️', '🇿🇦', '👩🏿\u200d🎨', '👳🏽\u200d♀️']
emoji:
O: 🦟 [9468, 99, 253]
N: 👩🏿‍🎨 [9468, 239, 102, 9468, 237, 123, 102470, 9468, 236, 101]

O: 💔 [93273, 242]
N: 🦟 [9468, 99, 253]

O: 🧑🏿‍🦼 [9468, 100, 239, 9468, 237, 123, 102470, 9468, 99, 120]
N: 👩🏿‍❤‍👩🏽 [9468, 239, 102, 9468, 237, 123, 102470, 121643, 102470, 9468, 239, 102, 9468, 237, 121]

O: 🧎🏿‍♂‍➡️ [9468, 100, 236, 9468, 237, 123, 102470, 17245, 224, 102470, 98115, 94, 31643]
N: ⛹🏻‍♂️ [158, 249, 117, 9468, 237, 119, 102470, 17245, 224, 31643]

O: 👩🏿‍❤‍👩🏽 [9468, 239, 102, 9468, 237, 123, 102470, 121643, 102470, 9468, 239, 102, 9468, 237, 121]
N: 💔 [93273, 242]

O: ⛹🏻‍♂️ [158, 249, 117, 9468, 237, 119, 102470, 17245, 224, 31643]
N: 🧑🏿‍🦼 [9468, 100, 239, 9468, 237, 123, 102470, 9468, 99, 120]

O: 👷🏻‍♀️ [9468, 239, 115, 9468, 237, 119, 102470, 32990, 31643]
N: 👷🏻‍♀️ [9468, 239, 115, 9468, 237, 119, 102470, 32990, 31643]

O: 🇿🇦 [9468, 229, 123, 9468, 229, 99]
N: 🧎🏿‍♂‍➡️ [9468, 100, 236, 9468, 237, 123, 102470, 17245, 224, 102470, 98115, 94, 31643]

O: 👩🏿‍🎨 [9468, 239, 102, 9468, 237, 123, 102470, 9468, 236, 101]
N: 🇿🇦 [9468, 229, 123, 9468, 229, 99]

O: 👳🏽‍♀️ [9468, 239, 111, 9468, 237, 121, 102470, 32990, 31643]
N: 👳🏽‍♀️ [9468, 239, 111, 9468, 237, 121, 102470, 32990, 31643]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.54s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.64s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.14s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.69s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.32s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (1, 2, 3, 4, 9):   3%|▎         | 3/100 [01:15<32:43, 20.25s/it]2025-01-22 05:48:57.624 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the bedroom.
2025-01-22 05:48:57.629 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (895, 901) --> . Mary journeyed to the
2025-01-22 05:48:57.629 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary got the apple.
2025-01-22 05:48:57.639 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2007, 2011) -->  Mary got the apple
2025-01-22 05:48:57.639 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the kitchen.
2025-01-22 05:48:57.657 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2978, 2984) -->  tragedy. Mary went back to
2025-01-22 05:48:57.657 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary dropped the apple.
2025-01-22 05:48:57.679 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3631, 3635) -->  Mary dropped the apple
2025-01-22 05:48:57.679 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel left the milk.
2025-01-22 05:48:57.718 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7320, 7324) -->  Daniel left the milk
2025-01-22 05:48:57.718 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the garden.
2025-01-22 05:48:57.737 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3849, 3854) --> . Sandra moved to the
2025-01-22 05:48:57.737 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the bedroom.
2025-01-22 05:48:57.749 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2493, 2498) --> . John travelled to the
2025-01-22 05:48:57.750 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 05:48:57.774 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4951, 4956) --> . Daniel moved to the
2025-01-22 05:48:57.774 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel took the milk there.
2025-01-22 05:48:57.798 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4099, 4104) --> . Daniel took the milk
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:49:01.061 | INFO     | test_jbb_embedding:begin_test:693 - kitchen<|eot_id|>
2025-01-22 05:49:01.061 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8177])
2025-01-22 05:49:03.994 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [288.0234375, 21.17999312347188, 156.3921875, 20.06046429449361, 22.43143656716418], 'topk_indices': array([  24, 8151, 3633, 8164, 8175, 8056, 2498, 8066,  902, 2010, 2495,
       3632, 2494,   14,  901, 2011, 3634, 8172,    0, 8173]), 'topk_tokens': ['\n\n', ':', ' the', ' discarded', '<|end_header_id|>', '.\n\n', ' bedroom', ' location', '.', ' apple', ' travelled', ' dropped', ' John', '\n', ' bedroom', '.', ' apple', '<|eot_id|>', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [356.6041666666667, 387.0, 160.17708333333334, 519.5625, 46.40625]}, 'weight': {'score': [24.662109375, 23.269857885085575, 21.0171875, 23.271288486356934, 29.403451492537314], 'topk_indices': array([3289, 3262, 3134, 3182, 7341, 7379, 1468, 1406, 4286, 4270, 5093,
       5154, 7113, 7057, 3471, 3445, 4864, 4941, 4912, 4889]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.052083333333332, 26.353515625, 25.548177083333332, 26.755859375, 26.462890625]}, 'saliency': {'score': [1.75341796875, 0.11802001057743734, 0.9194183349609375, 0.11122582209614292, 0.16677947542560634], 'topk_indices': array([8174,    0, 8170, 8056, 8156, 2008, 2985, 8162, 8022,  897, 8066,
       8150, 2494, 3632, 8164, 2498, 2010, 2495, 3634,  901]), 'topk_tokens': ['assistant', '<|begin_of_text|>', 'Answer', '.\n\n', ' prior', ' got', ' kitchen', ' apple', ' context', ' journey', ' location', 'Question', ' John', ' dropped', ' discarded', ' bedroom', ' apple', ' travelled', ' apple', ' bedroom'], 'evidence_proportions': [1.8306477864583333, 2.6181640625, 0.921142578125, 3.4765625, 0.298095703125]}}, 'pred_res': 'kitchen<|eot_id|>', 'score': 0}
2025-01-22 05:49:04.007 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:49:04.007 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-73_pid-3_1-2-3-4-9.pkl | len: 3 |  size: 2.11 KB
Processing depth (1, 2, 3, 4, 9):   4%|▍         | 4/100 [01:21<33:10, 20.73s/it]is_0k: False
your chose emoji: ['🧊', '🙋\u200d♂', '👯', '🍥', '👉🏻', '🧑\u200d🦽\u200d➡', '🥰', '🧑🏽\u200d🦽\u200d➡️', '🤳🏼', '🧎🏾\u200d♂\u200d➡️']
emoji:
O: 🧊 [9468, 100, 232]
N: 🤳🏼 [9468, 97, 111, 9468, 237, 120]

O: 🙋‍♂ [9468, 247, 233, 102470, 17245, 224]
N: 🥰 [9468, 98, 108]

O: 👯 [9468, 239, 107]
N: 👯 [9468, 239, 107]

O: 🍥 [9468, 235, 98]
N: 🍥 [9468, 235, 98]

O: 👉🏻 [9468, 239, 231, 9468, 237, 119]
N: 🧊 [9468, 100, 232]

O: 🧑‍🦽‍➡ [9468, 100, 239, 102470, 9468, 99, 121, 102470, 98115, 94]
N: 🙋‍♂ [9468, 247, 233, 102470, 17245, 224]

O: 🥰 [9468, 98, 108]
N: 👉🏻 [9468, 239, 231, 9468, 237, 119]

O: 🧑🏽‍🦽‍➡️ [9468, 100, 239, 9468, 237, 121, 102470, 9468, 99, 121, 102470, 98115, 94, 31643]
N: 🧑‍🦽‍➡ [9468, 100, 239, 102470, 9468, 99, 121, 102470, 98115, 94]

O: 🤳🏼 [9468, 97, 111, 9468, 237, 120]
N: 🧑🏽‍🦽‍➡️ [9468, 100, 239, 9468, 237, 121, 102470, 9468, 99, 121, 102470, 98115, 94, 31643]

O: 🧎🏾‍♂‍➡️ [9468, 100, 236, 9468, 237, 122, 102470, 17245, 224, 102470, 98115, 94, 31643]
N: 🧎🏾‍♂‍➡️ [9468, 100, 236, 9468, 237, 122, 102470, 17245, 224, 102470, 98115, 94, 31643]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.79s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.86s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.53s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.10s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.69s/it]
Processing depth (2, 3, 6, 8, 9):   4%|▍         | 4/100 [01:38<33:10, 20.73s/it]2025-01-22 05:49:20.668 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the bedroom.
2025-01-22 05:49:20.678 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1847, 1853) --> . Mary journeyed to the
2025-01-22 05:49:20.678 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary got the apple.
2025-01-22 05:49:20.693 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2923, 2927) -->  Mary got the apple
2025-01-22 05:49:20.693 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the kitchen.
2025-01-22 05:49:20.717 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4607, 4613) --> . Mary went back to the
2025-01-22 05:49:20.717 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary dropped the apple.
2025-01-22 05:49:20.749 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6453, 6457) -->  Mary dropped the apple
2025-01-22 05:49:20.749 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel left the milk.
2025-01-22 05:49:20.784 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7081, 7085) -->  left the milk.
2025-01-22 05:49:20.784 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the garden.
2025-01-22 05:49:20.803 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3819, 3824) --> . Sandra moved to the
2025-01-22 05:49:20.803 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the bedroom.
2025-01-22 05:49:20.816 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2392, 2397) --> . John travelled to the
2025-01-22 05:49:20.816 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the office.
2025-01-22 05:49:20.840 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4723, 4728) -->  Daniel moved to the office
2025-01-22 05:49:20.840 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel took the milk there.
2025-01-22 05:49:20.859 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4031, 4036) --> . Daniel took the milk
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:49:21.638 | INFO     | test_jbb_embedding:begin_test:693 - kitchen<|eot_id|>
2025-01-22 05:49:21.638 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8151])
2025-01-22 05:49:23.852 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [256.5234375, 21.929815887907775, 119.7671875, 20.99430487053021, 16.80736400462963], 'topk_indices': array([8040, 8125, 2397,    3, 8134,   14, 8030, 6454, 6423, 2926, 8136,
         24, 2927, 7996, 6457, 6456, 1853,    0, 8146, 8147]), 'topk_tokens': [' location', ':', ' bedroom', '<|end_header_id|>', ' where', '\n', '.\n\n', ' dropped', ' Press', ' apple', ' apple', '\n\n', '.', ' context', '.', ' apple', ' bedroom', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [313.625, 311.625, 179.25, 429.8125, 58.390625]}, 'weight': {'score': [22.43359375, 23.251345198675498, 22.020703125, 23.256800053945746, 29.482349537037038], 'topk_indices': array([3304, 3277, 3197, 3149, 7369, 7407, 1473, 1411, 4310, 4294, 5134,
       5195, 7090, 7146, 3468, 3494, 4980, 4951, 4928, 4903]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.052083333333332, 26.353515625, 20.708333333333332, 26.755859375, 20.3515625]}, 'saliency': {'score': [1.5462061564127605, 0.1213722331926815, 0.71151123046875, 0.11570037202094251, 0.12538429542824073], 'topk_indices': array([   0,   24, 8124, 8144, 2394, 8133, 2360, 8134, 8040, 1849, 8138,
       8130, 6423, 6454, 2397, 8136, 2926, 7996, 6456, 1853]), 'topk_tokens': ['<|begin_of_text|>', '\n\n', 'Question', 'Answer', ' travelled', ' place', 'nes', ' where', ' location', ' journey', ' discarded', ' prior', ' Press', ' dropped', ' bedroom', ' apple', ' apple', ' context', ' apple', ' bedroom'], 'evidence_proportions': [1.5821126302083333, 2.137451171875, 0.9871012369791666, 2.996337890625, 0.2896270751953125]}}, 'pred_res': 'kitchen<|eot_id|>', 'score': 0}
2025-01-22 05:49:23.858 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:49:23.859 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-73_pid-4_2-3-6-8-9.pkl | len: 3 |  size: 2.1 KB
Processing depth (2, 3, 6, 8, 9):   5%|▌         | 5/100 [01:41<32:19, 20.42s/it]Processing depth (2, 3, 6, 8, 9):   5%|▌         | 5/100 [01:41<32:15, 20.37s/it]
2025-01-22 05:49:23.908 | INFO     | __main__:<module>:82 - Selected idx: 74
2025-01-22 05:49:23.908 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the football before the kitchen? 
2025-01-22 05:49:23.909 | INFO     | __main__:<module>:84 - Answer: bedroom
2025-01-22 05:49:23.909 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 05:49:23.909 | INFO     | __main__:<module>:86 - Needle: [' Mary journeyed to the bedroom.', ' Daniel moved to the office.', ' Mary went back to the kitchen.', ' Sandra moved to the garden.', ' John travelled to the bedroom.', ' John went to the hallway.', ' Mary dropped the football.', ' Sandra travelled to the kitchen.']
2025-01-22 05:49:23.909 | INFO     | __main__:<module>:87 - Real Needle: [' Mary journeyed to the bedroom.', ' Mary went back to the kitchen.', ' Mary dropped the football.', ' Sandra travelled to the kitchen.']
2025-01-22 05:49:23.909 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['🏛️', '🏞️', '🤛🏻', '🕖', '🍥', '🛡️', '🍂', '🚵🏿\u200d♀', '🚰', '👩🏼\u200d❤️\u200d👨🏽']
emoji:
O: 🏛️ [9468, 237, 249, 31643]
N: 🤛🏻 [9468, 97, 249, 9468, 237, 119]

O: 🏞️ [9468, 237, 252, 31643]
N: 🍂 [9468, 235, 224]

O: 🤛🏻 [9468, 97, 249, 9468, 237, 119]
N: 🚵🏿‍♀ [9468, 248, 113, 9468, 237, 123, 102470, 32990]

O: 🕖 [9468, 243, 244]
N: 🛡️ [9468, 249, 94, 31643]

O: 🍥 [9468, 235, 98]
N: 🚰 [9468, 248, 108]

O: 🛡️ [9468, 249, 94, 31643]
N: 🕖 [9468, 243, 244]

O: 🍂 [9468, 235, 224]
N: 🍥 [9468, 235, 98]

O: 🚵🏿‍♀ [9468, 248, 113, 9468, 237, 123, 102470, 32990]
N: 🏞️ [9468, 237, 252, 31643]

O: 🚰 [9468, 248, 108]
N: 🏛️ [9468, 237, 249, 31643]

O: 👩🏼‍❤️‍👨🏽 [9468, 239, 102, 9468, 237, 120, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 121]
N: 👩🏼‍❤️‍👨🏽 [9468, 239, 102, 9468, 237, 120, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 121]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.11s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.74s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:15<00:05,  5.18s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.35s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.89s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 4, 6, 7):   0%|          | 0/100 [00:17<?, ?it/s]2025-01-22 05:49:41.255 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the bedroom.
2025-01-22 05:49:41.255 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 37) -->  journeyed to the bedroom.
2025-01-22 05:49:41.255 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went back to the kitchen.
2025-01-22 05:49:41.278 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3714, 3720) --> . Mary went back to the
2025-01-22 05:49:41.278 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary dropped the football.
2025-01-22 05:49:41.302 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4876, 4880) -->  Mary dropped the football
2025-01-22 05:49:41.302 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra travelled to the kitchen.
2025-01-22 05:49:41.331 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5695, 5700) -->  Sandra travelled to the kitchen
2025-01-22 05:49:41.331 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the office.
2025-01-22 05:49:41.364 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6057, 6062) -->  Daniel moved to the office
2025-01-22 05:49:41.364 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the garden.
2025-01-22 05:49:41.371 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1266, 1271) --> . Sandra moved to the
2025-01-22 05:49:41.371 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the bedroom.
2025-01-22 05:49:41.393 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4097, 4102) --> . John travelled to the
2025-01-22 05:49:41.393 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the hallway.
2025-01-22 05:49:41.426 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6060, 6065) -->  the office. John went
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:49:44.953 | INFO     | test_jbb_embedding:begin_test:693 - Mary's bedroom.<|eot_id|>
2025-01-22 05:49:44.953 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8148])
2025-01-22 05:49:47.712 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [379.26190476190476, 29.27497009569378, 205.91875, 27.933095715166463, 22.72014036016949], 'topk_indices': array([4222,   31, 4102,   14, 8129, 4289, 8132, 8133, 8144, 8131, 8130,
       8137, 8146, 8139, 4879, 8135, 8138, 8136, 8143,    0]), 'topk_tokens': ['nes', ' journey', ' bedroom', '\n', '.\n\n', 'nes', ' Where', ' was', '<|start_header_id|>', ':', 'Question', ' the', '<|end_header_id|>', '?', ' football', ' football', ' kitchen', ' before', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [466.5833333333333, 292.75, 534.8125, 253.85]}, 'weight': {'score': [23.395833333333332, 23.256621120107962, 21.692578125, 23.26011771732429, 29.212658898305083], 'topk_indices': array([3248, 3275, 3120, 3168, 7407, 7369, 1484, 1422, 4256, 4240, 5074,
       5135, 7140, 7084, 3431, 3457, 4899, 4871, 4846, 4928]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.71875, 20.708333333333332, 27.013671875, 26.9390625]}, 'saliency': {'score': [2.316220238095238, 0.16435812850800516, 1.1630126953125, 0.1563233324984587, 0.1628231759798729], 'topk_indices': array([8129,   30, 3720, 4313, 8133, 4877, 4099, 8046, 4222, 8139, 4289,
       8132,   31,   35, 4102, 8130, 4879, 8135, 8136, 8138]), 'topk_tokens': ['.\n\n', 'Mary', ' kitchen', ' Min', ' was', ' dropped', ' travelled', ' location', 'nes', '?', 'nes', ' Where', ' journey', ' bedroom', ' bedroom', 'Question', ' football', ' football', ' before', ' kitchen'], 'evidence_proportions': [2.6221516927083335, 1.5145670572916667, 3.802001953125, 1.7224609375]}}, 'pred_res': "Mary's bedroom.<|eot_id|>", 'score': 100}
2025-01-22 05:49:47.721 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:49:47.721 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-74_pid-0_0-4-6-7.pkl | len: 3 |  size: 2.04 KB
Processing depth (0, 4, 6, 7):   1%|          | 1/100 [00:23<39:07, 23.72s/it]is_0k: False
your chose emoji: ['🙆\u200d♀️', '🕐', '🧑🏾\u200d💻', '🈷️', '🤹🏾\u200d♀️', '4️⃣', '👨\u200d👦', '👀', '\U0001fae3', '👩🏽\u200d🚒']
emoji:
O: 🙆‍♀️ [9468, 247, 228, 102470, 32990, 31643]
N: 4️⃣ [19, 31643, 158, 225, 96]

O: 🕐 [9468, 243, 238]
N: 🙆‍♀️ [9468, 247, 228, 102470, 32990, 31643]

O: 🧑🏾‍💻 [9468, 100, 239, 9468, 237, 122, 102470, 93273, 119]
N: 🕐 [9468, 243, 238]

O: 🈷️ [9468, 230, 115, 31643]
N: 🈷️ [9468, 230, 115, 31643]

O: 🤹🏾‍♀️ [9468, 97, 117, 9468, 237, 122, 102470, 32990, 31643]
N: 👀 [9468, 239, 222]

O: 4️⃣ [19, 31643, 158, 225, 96]
N: 🤹🏾‍♀️ [9468, 97, 117, 9468, 237, 122, 102470, 32990, 31643]

O: 👨‍👦 [9468, 239, 101, 102470, 9468, 239, 99]
N: 👨‍👦 [9468, 239, 101, 102470, 9468, 239, 99]

O: 👀 [9468, 239, 222]
N: 🫣 [9468, 104, 96]

O: 🫣 [9468, 104, 96]
N: 🧑🏾‍💻 [9468, 100, 239, 9468, 237, 122, 102470, 93273, 119]

O: 👩🏽‍🚒 [9468, 239, 102, 9468, 237, 121, 102470, 9468, 248, 240]
N: 👩🏽‍🚒 [9468, 239, 102, 9468, 237, 121, 102470, 9468, 248, 240]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.15s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.45s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.36s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.05s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.53s/it]
Processing depth (0, 3, 5, 6):   1%|          | 1/100 [00:39<39:07, 23.72s/it]2025-01-22 05:50:03.513 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the bedroom.
2025-01-22 05:50:03.513 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 37) -->  journeyed to the bedroom.
2025-01-22 05:50:03.513 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went back to the kitchen.
2025-01-22 05:50:03.528 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2721, 2727) -->  Mary went back to the kitchen
2025-01-22 05:50:03.528 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary dropped the football.
2025-01-22 05:50:03.550 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4124, 4128) -->  Mary dropped the football
2025-01-22 05:50:03.550 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra travelled to the kitchen.
2025-01-22 05:50:03.578 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4624, 4629) --> . Sandra travelled to the
2025-01-22 05:50:03.578 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the office.
2025-01-22 05:50:03.613 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5651, 5656) -->  Daniel moved to the office
2025-01-22 05:50:03.613 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the garden.
2025-01-22 05:50:03.619 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1077, 1082) -->  Sandra moved to the garden
2025-01-22 05:50:03.620 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the bedroom.
2025-01-22 05:50:03.642 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3899, 3904) --> . John travelled to the
2025-01-22 05:50:03.642 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the hallway.
2025-01-22 05:50:03.674 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5654, 5659) -->  the office. John went
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:50:04.436 | INFO     | test_jbb_embedding:begin_test:693 - the bedroom<|eot_id|>
2025-01-22 05:50:04.436 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8138])
2025-01-22 05:50:06.644 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [146.1889880952381, 12.276833696720304, 77.83828125, 11.767773919753086, 20.81230107060185], 'topk_indices': array([8125,    9, 8121, 8137,  112, 4127,   24, 8128,    3, 8132, 8026,
         31, 7992, 8126, 8036, 3904,   14, 8136,    0, 8133]), 'topk_tokens': [' football', ':', ':', '\n\n', 'ION', ' football', '\n\n', ' kitchen', '<|end_header_id|>', ':', '.\n\n', ' journey', ' context', ' before', ' location', ' bedroom', '\n', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [226.47916666666666, 109.10416666666667, 178.03125, 68.86875]}, 'weight': {'score': [23.395833333333332, 23.254468124309053, 22.82109375, 23.255171682098766, 29.60185185185185], 'topk_indices': array([3303, 3330, 3223, 3175, 7371, 7409, 1442, 1504, 4311, 4327, 5189,
       5128, 7148, 7092, 3512, 3486, 4905, 4930, 4953, 4982]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.71875, 24.69921875, 27.013671875, 22.15]}, 'saliency': {'score': [0.9257405598958334, 0.06869088863948686, 0.459954833984375, 0.06550282419463735, 0.1532277707700376], 'topk_indices': array([8110, 4131, 7991, 8122, 8107, 8026, 7990,  112, 8131, 3901, 8120,
         35, 8125, 4127, 8128, 8126, 7992, 8036,   31, 3904]), 'topk_tokens': [' directly', '�', ' you', ' Where', ' return', '.\n\n', ' provided', 'ION', 'Answer', ' travelled', 'Question', ' bedroom', ' football', ' football', ' kitchen', ' before', ' context', ' location', ' journey', ' bedroom'], 'evidence_proportions': [1.334228515625, 0.7277018229166666, 1.282470703125, 0.3878173828125]}}, 'pred_res': 'the bedroom<|eot_id|>', 'score': 100}
2025-01-22 05:50:06.654 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:50:06.655 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-74_pid-1_0-3-5-6.pkl | len: 3 |  size: 2.04 KB
Processing depth (0, 3, 5, 6):   2%|▏         | 2/100 [00:42<34:08, 20.90s/it]is_0k: False
your chose emoji: ['🗺', '💪🏻', '📞', '👮🏼\u200d♀️', '🥋', '🧝🏻\u200d♀️', '🧎🏻\u200d♂️', '🧘\u200d♂', '🙁', '🛕']
emoji:
O: 🗺 [9468, 245, 118]
N: 📞 [9468, 241, 252]

O: 💪🏻 [93273, 103, 9468, 237, 119]
N: 🗺 [9468, 245, 118]

O: 📞 [9468, 241, 252]
N: 🧝🏻‍♀️ [9468, 100, 251, 9468, 237, 119, 102470, 32990, 31643]

O: 👮🏼‍♀️ [9468, 239, 106, 9468, 237, 120, 102470, 32990, 31643]
N: 🙁 [9468, 247, 223]

O: 🥋 [9468, 98, 233]
N: 🧘‍♂ [9468, 100, 246, 102470, 17245, 224]

O: 🧝🏻‍♀️ [9468, 100, 251, 9468, 237, 119, 102470, 32990, 31643]
N: 💪🏻 [93273, 103, 9468, 237, 119]

O: 🧎🏻‍♂️ [9468, 100, 236, 9468, 237, 119, 102470, 17245, 224, 31643]
N: 👮🏼‍♀️ [9468, 239, 106, 9468, 237, 120, 102470, 32990, 31643]

O: 🧘‍♂ [9468, 100, 246, 102470, 17245, 224]
N: 🥋 [9468, 98, 233]

O: 🙁 [9468, 247, 223]
N: 🧎🏻‍♂️ [9468, 100, 236, 9468, 237, 119, 102470, 17245, 224, 31643]

O: 🛕 [9468, 249, 243]
N: 🛕 [9468, 249, 243]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.66s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.95s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.47s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.11s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.68s/it]
Processing depth (3, 5, 8, 9):   2%|▏         | 2/100 [00:59<34:08, 20.90s/it]2025-01-22 05:50:23.086 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the bedroom.
2025-01-22 05:50:23.101 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2935, 2941) --> . Mary journeyed to the
2025-01-22 05:50:23.101 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went back to the kitchen.
2025-01-22 05:50:23.122 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4168, 4174) --> . Mary went back to the
2025-01-22 05:50:23.122 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary dropped the football.
2025-01-22 05:50:23.153 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6527, 6531) -->  dropped the football.
2025-01-22 05:50:23.154 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra travelled to the kitchen.
2025-01-22 05:50:23.190 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7125, 7130) -->  Sandra travelled to the kitchen
2025-01-22 05:50:23.190 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the office.
2025-01-22 05:50:23.219 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5737, 5742) --> . Daniel moved to the
2025-01-22 05:50:23.219 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the garden.
2025-01-22 05:50:23.226 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1234, 1239) -->  Republican. Sandra moved to
2025-01-22 05:50:23.226 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the bedroom.
2025-01-22 05:50:23.245 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3976, 3981) -->  the ground. John travelled
2025-01-22 05:50:23.245 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the hallway.
2025-01-22 05:50:23.277 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5741, 5746) -->  the office. John went
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:50:24.166 | INFO     | test_jbb_embedding:begin_test:693 - The football was dropped by Mary.<|eot_id|>
2025-01-22 05:50:24.167 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8168])
2025-01-22 05:50:26.413 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [315.9702380952381, 23.22313670297393, 207.58125, 22.013437884378845, 35.933027626811594], 'topk_indices': array([2938,    1, 8164, 2937, 8158, 8149,    9, 1237, 1236, 3983,   23,
       8066, 8155,   24, 8156,   14, 6529, 8166,    0, 8163]), 'topk_tokens': ['ed', '<|start_header_id|>', '<|start_header_id|>', ' journey', ' kitchen', '.\n\n', ':', ' moved', ' Sandra', ' bedroom', '4', ' location', ' football', '\n\n', ' before', '\n', ' football', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [414.25, 172.4375, 481.125, 238.15]}, 'weight': {'score': [22.103794642857142, 23.276304919838452, 22.710546875, 23.28072532287823, 29.52151268115942], 'topk_indices': array([3333, 3306, 3226, 3178, 7415, 7453, 1487, 1425, 4312, 4328, 5123,
       5184, 7192, 7136, 3515, 3489, 4948, 4977, 4925, 4900]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.052083333333332, 20.708333333333332, 21.23046875, 26.9390625]}, 'saliency': {'score': [1.7727632068452381, 0.12945684372992136, 1.273272705078125, 0.12239832578989852, 0.263405177904212], 'topk_indices': array([8137, 8149, 8165, 1240,   23, 8150,   20,   24, 8161, 3980, 2937,
       8066, 2941, 1237, 8158, 8156, 3983, 8155, 1236, 6529]), 'topk_tokens': [' return', '.\n\n', 'assistant', ' garden', '4', 'Question', ' Jul', '\n\n', 'Answer', ' travelled', ' journey', ' location', ' bedroom', ' moved', ' kitchen', ' before', ' bedroom', ' football', ' Sandra', ' football'], 'evidence_proportions': [2.1189778645833335, 0.8821614583333334, 2.857666015625, 1.55810546875]}}, 'pred_res': 'The football was dropped by Mary.<|eot_id|>', 'score': 0}
2025-01-22 05:50:26.420 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:50:26.420 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-74_pid-2_3-5-8-9.pkl | len: 3 |  size: 2.08 KB
Processing depth (3, 5, 8, 9):   3%|▎         | 3/100 [01:02<32:57, 20.38s/it]is_0k: False
your chose emoji: ['🖥️', '👰🏽\u200d♀', '👩\u200d❤\u200d👨', '👩🏽\u200d❤\u200d👨🏿', '👨🏾\u200d🎨', '✔', '🪆', '👩🏾\u200d✈️', '🕤', '👎🏻']
emoji:
O: 🖥️ [9468, 244, 98, 31643]
N: 👩🏾‍✈️ [9468, 239, 102, 9468, 237, 122, 102470, 38798, 230, 31643]

O: 👰🏽‍♀ [9468, 239, 108, 9468, 237, 121, 102470, 32990]
N: 👩‍❤‍👨 [9468, 239, 102, 102470, 121643, 102470, 9468, 239, 101]

O: 👩‍❤‍👨 [9468, 239, 102, 102470, 121643, 102470, 9468, 239, 101]
N: 👩🏽‍❤‍👨🏿 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 123]

O: 👩🏽‍❤‍👨🏿 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 123]
N: 🖥️ [9468, 244, 98, 31643]

O: 👨🏾‍🎨 [9468, 239, 101, 9468, 237, 122, 102470, 9468, 236, 101]
N: 🪆 [9468, 103, 228]

O: ✔ [75351]
N: 🕤 [9468, 243, 97]

O: 🪆 [9468, 103, 228]
N: ✔ [75351]

O: 👩🏾‍✈️ [9468, 239, 102, 9468, 237, 122, 102470, 38798, 230, 31643]
N: 👨🏾‍🎨 [9468, 239, 101, 9468, 237, 122, 102470, 9468, 236, 101]

O: 🕤 [9468, 243, 97]
N: 👰🏽‍♀ [9468, 239, 108, 9468, 237, 121, 102470, 32990]

O: 👎🏻 [9468, 239, 236, 9468, 237, 119]
N: 👎🏻 [9468, 239, 236, 9468, 237, 119]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.63s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.67s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.64s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.23s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.75s/it]
Processing depth (3, 5, 6, 8):   3%|▎         | 3/100 [01:19<32:57, 20.38s/it]2025-01-22 05:50:43.228 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the bedroom.
2025-01-22 05:50:43.243 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2929, 2935) --> . Mary journeyed to the
2025-01-22 05:50:43.243 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went back to the kitchen.
2025-01-22 05:50:43.265 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4229, 4235) -->  Mary went back to the kitchen
2025-01-22 05:50:43.266 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary dropped the football.
2025-01-22 05:50:43.292 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4900, 4904) -->  Mary dropped the football
2025-01-22 05:50:43.292 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra travelled to the kitchen.
2025-01-22 05:50:43.325 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6670, 6675) --> . Sandra travelled to the
2025-01-22 05:50:43.325 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the office.
2025-01-22 05:50:43.355 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5854, 5859) --> . Daniel moved to the
2025-01-22 05:50:43.355 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the garden.
2025-01-22 05:50:43.363 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1259, 1264) --> . Sandra moved to the
2025-01-22 05:50:43.363 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the bedroom.
2025-01-22 05:50:43.384 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4058, 4063) --> . John travelled to the
2025-01-22 05:50:43.384 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the hallway.
2025-01-22 05:50:43.413 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5858, 5863) -->  the office. John went
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:50:44.207 | INFO     | test_jbb_embedding:begin_test:693 - the hallway<|eot_id|>
2025-01-22 05:50:44.207 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8224])
2025-01-22 05:50:46.452 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [275.1488095238095, 26.485053026619667, 173.12421875, 25.48887391583191, 24.782659471649485], 'topk_indices': array([8218,    3, 8215, 8209, 8214, 8078, 8206, 8205, 8207, 4063,   14,
       8212,   24, 8122, 8220, 8211, 4903, 8222,    0, 8219]), 'topk_tokens': [':', '<|end_header_id|>', '?', ' was', ' kitchen', ' context', 'Question', '.\n\n', ':', ' bedroom', '\n', ' before', '\n\n', ' location', '<|start_header_id|>', ' football', ' football', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [313.6041666666667, 164.41666666666666, 531.0, 157.2]}, 'weight': {'score': [23.205357142857142, 23.32750015193874, 20.6890625, 23.334259711702906, 29.889819587628867], 'topk_indices': array([3290, 3317, 3162, 3210, 7509, 7471, 1485, 1423, 4282, 4298, 5122,
       5183, 7212, 7156, 3473, 3499, 4923, 4895, 4870, 4952]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.052083333333332, 24.69921875, 27.013671875, 22.15]}, 'saliency': {'score': [1.7004278273809523, 0.14796145990811505, 0.9685546875, 0.14197396195199885, 0.18126922292807668], 'topk_indices': array([2931, 8195, 4901, 8121, 4970, 8205, 8193, 8208, 8217,   24, 4060,
       8078, 2935, 8214, 8206, 8212, 8122, 4063, 8211, 4903]), 'topk_tokens': [' journey', ' location', ' dropped', ' first', '♀', '.\n\n', ' return', ' Where', 'Answer', '\n\n', ' travelled', ' context', ' bedroom', ' kitchen', 'Question', ' before', ' location', ' bedroom', ' football', ' football'], 'evidence_proportions': [1.5726725260416667, 1.0890299479166667, 3.779052734375, 0.92451171875]}}, 'pred_res': 'the hallway<|eot_id|>', 'score': 0}
2025-01-22 05:50:46.459 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:50:46.459 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-74_pid-3_3-5-6-8.pkl | len: 3 |  size: 2.06 KB
Processing depth (3, 5, 6, 8):   4%|▍         | 4/100 [01:22<32:23, 20.25s/it]is_0k: False
your chose emoji: ['🚶🏿\u200d♀\u200d➡️', '👩🏻\u200d🦽', '🏃🏻\u200d♂️\u200d➡', '👨\u200d🦼', '💇🏻\u200d♂️', '🧍🏿\u200d♂️', '🧛🏼\u200d♀', '🇦🇺', '👩🏻\u200d❤️\u200d👩🏿', '👧🏾']
emoji:
O: 🚶🏿‍♀‍➡️ [9468, 248, 114, 9468, 237, 123, 102470, 32990, 102470, 98115, 94, 31643]
N: 💇🏻‍♂️ [93273, 229, 9468, 237, 119, 102470, 17245, 224, 31643]

O: 👩🏻‍🦽 [9468, 239, 102, 9468, 237, 119, 102470, 9468, 99, 121]
N: 👨‍🦼 [9468, 239, 101, 102470, 9468, 99, 120]

O: 🏃🏻‍♂️‍➡ [9468, 237, 225, 9468, 237, 119, 102470, 17245, 224, 31643, 102470, 98115, 94]
N: 🧍🏿‍♂️ [9468, 100, 235, 9468, 237, 123, 102470, 17245, 224, 31643]

O: 👨‍🦼 [9468, 239, 101, 102470, 9468, 99, 120]
N: 🚶🏿‍♀‍➡️ [9468, 248, 114, 9468, 237, 123, 102470, 32990, 102470, 98115, 94, 31643]

O: 💇🏻‍♂️ [93273, 229, 9468, 237, 119, 102470, 17245, 224, 31643]
N: 👩🏻‍❤️‍👩🏿 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 31643, 102470, 9468, 239, 102, 9468, 237, 123]

O: 🧍🏿‍♂️ [9468, 100, 235, 9468, 237, 123, 102470, 17245, 224, 31643]
N: 🇦🇺 [9468, 229, 99, 9468, 229, 118]

O: 🧛🏼‍♀ [9468, 100, 249, 9468, 237, 120, 102470, 32990]
N: 🏃🏻‍♂️‍➡ [9468, 237, 225, 9468, 237, 119, 102470, 17245, 224, 31643, 102470, 98115, 94]

O: 🇦🇺 [9468, 229, 99, 9468, 229, 118]
N: 👩🏻‍🦽 [9468, 239, 102, 9468, 237, 119, 102470, 9468, 99, 121]

O: 👩🏻‍❤️‍👩🏿 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 31643, 102470, 9468, 239, 102, 9468, 237, 123]
N: 🧛🏼‍♀ [9468, 100, 249, 9468, 237, 120, 102470, 32990]

O: 👧🏾 [9468, 239, 100, 9468, 237, 122]
N: 👧🏾 [9468, 239, 100, 9468, 237, 122]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.35s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:09,  4.51s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.03s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  2.62s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  3.22s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (1, 5, 7, 9):   4%|▍         | 4/100 [01:37<32:23, 20.25s/it]2025-01-22 05:51:01.189 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the bedroom.
2025-01-22 05:51:01.195 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (895, 901) --> . Mary journeyed to the
2025-01-22 05:51:01.195 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went back to the kitchen.
2025-01-22 05:51:01.216 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4207, 4213) -->  Mary went back to the kitchen
2025-01-22 05:51:01.217 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary dropped the football.
2025-01-22 05:51:01.245 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5593, 5597) -->  dropped the football.
2025-01-22 05:51:01.245 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra travelled to the kitchen.
2025-01-22 05:51:01.282 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7242, 7247) --> . Sandra travelled to the
2025-01-22 05:51:01.282 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel moved to the office.
2025-01-22 05:51:01.313 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5694, 5699) --> . Daniel moved to the
2025-01-22 05:51:01.315 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the garden.
2025-01-22 05:51:01.322 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1227, 1232) -->  Republican. Sandra moved to
2025-01-22 05:51:01.322 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the bedroom.
2025-01-22 05:51:01.342 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4070, 4075) --> . John travelled to the
2025-01-22 05:51:01.342 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the hallway.
2025-01-22 05:51:01.374 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5698, 5703) -->  the office. John went
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:51:06.693 | INFO     | test_jbb_embedding:begin_test:693 - Mary dropped the football.<|eot_id|>
2025-01-22 05:51:06.693 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8194])
2025-01-22 05:51:09.952 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [242.94642857142858, 27.464510644138098, 169.5484375, 26.561273908778812, 29.72927782012195], 'topk_indices': array([5581,   24,  898, 4075,  904,  903, 8092, 7612, 7626,  905,   14,
       5582, 5595,  901, 7656, 7670, 8192, 7671, 8189,    0]), 'topk_tokens': ['�', '\n\n', 'ed', ' bedroom', '�', '�', ' location', ' three', 'nes', '�', '\n', '�', ' football', ' bedroom', ' or', ' Min', '<|end_header_id|>', 'nes', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [396.7916666666667, 119.55208333333333, 409.4375, 73.2125]}, 'weight': {'score': [22.103794642857142, 23.29211334939612, 21.900390625, 23.298585780407063, 29.321455792682926], 'topk_indices': array([3244, 3271, 3164, 3116, 7473, 7435, 1418, 1480, 4260, 4276, 5222,
       5161, 7192, 7136, 3453, 3427, 4961, 4932, 4884, 4909]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.052083333333332, 24.69921875, 21.23046875, 22.15]}, 'saliency': {'score': [1.3856898716517858, 0.1564842522893284, 0.986456298828125, 0.1512840611493839, 0.21923753691882622], 'topk_indices': array([7581,  904, 7647, 8181, 5155, 5580, 7612, 4072, 8092,  897,  905,
       5582, 7626, 4075,  903, 7656, 5595,  901, 7670, 7671]), 'topk_tokens': ['nes', '�', ' tele', ' football', 'graph', '�', ' three', ' travelled', ' location', ' journey', '�', '�', 'nes', ' bedroom', '�', ' or', ' football', ' bedroom', ' Min', 'nes'], 'evidence_proportions': [2.0592447916666665, 0.79510498046875, 2.4617919921875, 0.425244140625]}}, 'pred_res': 'Mary dropped the football.<|eot_id|>', 'score': 0}
2025-01-22 05:51:10.001 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:51:10.001 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-74_pid-4_1-5-7-9.pkl | len: 3 |  size: 2.0 KB
Processing depth (1, 5, 7, 9):   5%|▌         | 5/100 [01:45<33:56, 21.44s/it]Processing depth (1, 5, 7, 9):   5%|▌         | 5/100 [01:46<33:35, 21.22s/it]
2025-01-22 05:51:10.092 | INFO     | __main__:<module>:82 - Selected idx: 75
2025-01-22 05:51:10.092 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the location prior to the place where the milk was discarded, left or dropped?
2025-01-22 05:51:10.092 | INFO     | __main__:<module>:84 - Answer: bedroom
2025-01-22 05:51:10.092 | INFO     | __main__:<module>:85 - Tag: 4-hop
2025-01-22 05:51:10.092 | INFO     | __main__:<module>:86 - Needle: [' John travelled to the bedroom.', ' Mary journeyed to the bedroom.', ' Sandra moved to the garden.', ' John went to the hallway.', ' Mary picked up the milk.', ' Daniel moved to the office.', ' Mary went back to the kitchen.', ' Mary dropped the milk.', ' Sandra travelled to the kitchen.']
2025-01-22 05:51:10.092 | INFO     | __main__:<module>:87 - Real Needle: [' Mary journeyed to the bedroom.', ' Mary picked up the milk.', ' Mary went back to the kitchen.', ' Mary dropped the milk.', ' Sandra travelled to the kitchen.']
2025-01-22 05:51:10.092 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['🗜', '🍋\u200d🟩', '🧑🏾\u200d❤\u200d🧑🏽', '🧏\u200d♀️', '👮🏽\u200d♂️', '🧑🏿\u200d🤝\u200d🧑🏾', '🇳🇺', '🩳', '🇫🇯', '🏃🏻\u200d➡']
emoji:
O: 🗜 [9468, 245, 250]
N: 🩳 [9468, 102, 111]

O: 🍋‍🟩 [9468, 235, 233, 102470, 9468, 253, 102]
N: 🇳🇺 [9468, 229, 111, 9468, 229, 118]

O: 🧑🏾‍❤‍🧑🏽 [9468, 100, 239, 9468, 237, 122, 102470, 121643, 102470, 9468, 100, 239, 9468, 237, 121]
N: 🇫🇯 [9468, 229, 104, 9468, 229, 107]

O: 🧏‍♀️ [9468, 100, 237, 102470, 32990, 31643]
N: 🧑🏾‍❤‍🧑🏽 [9468, 100, 239, 9468, 237, 122, 102470, 121643, 102470, 9468, 100, 239, 9468, 237, 121]

O: 👮🏽‍♂️ [9468, 239, 106, 9468, 237, 121, 102470, 17245, 224, 31643]
N: 🗜 [9468, 245, 250]

O: 🧑🏿‍🤝‍🧑🏾 [9468, 100, 239, 9468, 237, 123, 102470, 9468, 97, 251, 102470, 9468, 100, 239, 9468, 237, 122]
N: 👮🏽‍♂️ [9468, 239, 106, 9468, 237, 121, 102470, 17245, 224, 31643]

O: 🇳🇺 [9468, 229, 111, 9468, 229, 118]
N: 🧑🏿‍🤝‍🧑🏾 [9468, 100, 239, 9468, 237, 123, 102470, 9468, 97, 251, 102470, 9468, 100, 239, 9468, 237, 122]

O: 🩳 [9468, 102, 111]
N: 🧏‍♀️ [9468, 100, 237, 102470, 32990, 31643]

O: 🇫🇯 [9468, 229, 104, 9468, 229, 107]
N: 🍋‍🟩 [9468, 235, 233, 102470, 9468, 253, 102]

O: 🏃🏻‍➡ [9468, 237, 225, 9468, 237, 119, 102470, 98115, 94]
N: 🏃🏻‍➡ [9468, 237, 225, 9468, 237, 119, 102470, 98115, 94]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:05<00:15,  5.07s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.85s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.34s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.03s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.63s/it]
Processing depth (0, 2, 4, 7, 8):   0%|          | 0/100 [00:16<?, ?it/s]2025-01-22 05:51:26.742 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the bedroom.
2025-01-22 05:51:26.742 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 37) -->  journeyed to the bedroom.
2025-01-22 05:51:26.742 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary picked up the milk.
2025-01-22 05:51:26.752 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2011, 2016) -->  cable. Mary picked up
2025-01-22 05:51:26.753 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the kitchen.
2025-01-22 05:51:26.771 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3631, 3637) -->  Hon. Mary went back to
2025-01-22 05:51:26.771 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary dropped the milk.
2025-01-22 05:51:26.801 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5660, 5664) -->  Mary dropped the milk
2025-01-22 05:51:26.802 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra travelled to the kitchen.
2025-01-22 05:51:26.837 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6620, 6625) --> . Sandra travelled to the
2025-01-22 05:51:26.837 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the bedroom.
2025-01-22 05:51:26.850 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2188, 2193) --> . John travelled to the
2025-01-22 05:51:26.850 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the garden.
2025-01-22 05:51:26.870 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3984, 3989) -->  Sandra moved to the garden
2025-01-22 05:51:26.870 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went to the hallway.
2025-01-22 05:51:26.878 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1550, 1555) --> . John went to the
2025-01-22 05:51:26.878 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel moved to the office.
2025-01-22 05:51:26.897 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3663, 3668) --> . Daniel moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:51:27.643 | INFO     | test_jbb_embedding:begin_test:693 - kitchen<|eot_id|>
2025-01-22 05:51:27.643 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8171])
2025-01-22 05:51:29.859 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [512.7439903846154, 52.66635827012479, 215.725, 50.793426273375985, 33.822544642857146], 'topk_indices': array([8166,   14, 4146, 4145,   30,  986,  985,   29, 7496, 8167, 7497,
       2013,   31, 4147, 4149, 7541, 4148, 7542, 4150,    0]), 'topk_tokens': ['<|eot_id|>', '\n', ' The', '.', 'Mary', ' of', ' election', '\n\n', 'nes', '<|start_header_id|>', 'ot', ' Mary', ' journey', ' result', ' that', 'nes', ' of', 'ot', ' election', '<|begin_of_text|>'], 'evidence_proportions': [849.4166666666666, 664.7, 417.2708333333333, 474.9375, 101.59375]}, 'weight': {'score': [23.951021634615383, 23.26333305297284, 21.023046875, 23.266645776943896, 29.343501984126984], 'topk_indices': array([3281, 3254, 3126, 3174, 7395, 7433, 1468, 1406, 4326, 4310, 5204,
       5143, 7172, 7116, 3475, 3449, 4981, 4952, 4929, 4904]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.71875, 26.5265625, 24.71484375, 26.685546875, 22.15]}, 'saliency': {'score': [3.236699030949519, 0.2966697175782206, 1.317236328125, 0.28475385951244925, 0.25672452411954366], 'topk_indices': array([7371, 8016,   29, 7492,    0, 3638, 7540,   35, 7497,   30,  985,
       7496, 4148, 4149, 2013, 4147,   31, 7541, 7542, 4150]), 'topk_tokens': [' tele', ' context', '\n\n', ' joke', '<|begin_of_text|>', ' kitchen', ' Min', ' bedroom', 'ot', 'Mary', ' election', 'nes', ' of', ' that', ' Mary', ' result', ' journey', 'nes', 'ot', ' election'], 'evidence_proportions': [5.399251302083333, 4.2783203125, 2.4557291666666665, 3.12353515625, 0.6277099609375]}}, 'pred_res': 'kitchen<|eot_id|>', 'score': 0}
2025-01-22 05:51:29.865 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:51:29.866 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-75_pid-0_0-2-4-7-8.pkl | len: 3 |  size: 2.05 KB
Processing depth (0, 2, 4, 7, 8):   1%|          | 1/100 [00:19<32:25, 19.65s/it]is_0k: False
your chose emoji: ['👭', '🧚🏻\u200d♀', '🏤', '🛌🏼', '🤵🏾', '🧜🏼\u200d♂', '🧑🏾\u200d🦯\u200d➡️', '😠', '📍', '👩🏼\u200d🎤']
emoji:
O: 👭 [9468, 239, 255]
N: 😠 [76460, 254]

O: 🧚🏻‍♀ [9468, 100, 248, 9468, 237, 119, 102470, 32990]
N: 🤵🏾 [9468, 97, 113, 9468, 237, 122]

O: 🏤 [9468, 237, 97]
N: 🧑🏾‍🦯‍➡️ [9468, 100, 239, 9468, 237, 122, 102470, 9468, 99, 107, 102470, 98115, 94, 31643]

O: 🛌🏼 [9468, 249, 234, 9468, 237, 120]
N: 🧜🏼‍♂ [9468, 100, 250, 9468, 237, 120, 102470, 17245, 224]

O: 🤵🏾 [9468, 97, 113, 9468, 237, 122]
N: 🏤 [9468, 237, 97]

O: 🧜🏼‍♂ [9468, 100, 250, 9468, 237, 120, 102470, 17245, 224]
N: 🧚🏻‍♀ [9468, 100, 248, 9468, 237, 119, 102470, 32990]

O: 🧑🏾‍🦯‍➡️ [9468, 100, 239, 9468, 237, 122, 102470, 9468, 99, 107, 102470, 98115, 94, 31643]
N: 🛌🏼 [9468, 249, 234, 9468, 237, 120]

O: 😠 [76460, 254]
N: 📍 [9468, 35529]

O: 📍 [9468, 35529]
N: 👭 [9468, 239, 255]

O: 👩🏼‍🎤 [9468, 239, 102, 9468, 237, 120, 102470, 9468, 236, 97]
N: 👩🏼‍🎤 [9468, 239, 102, 9468, 237, 120, 102470, 9468, 236, 97]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.79s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:10<00:10,  5.16s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.85s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.16s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.81s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (4, 5, 6, 7, 8):   1%|          | 1/100 [00:36<32:25, 19.65s/it]2025-01-22 05:51:46.885 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the bedroom.
2025-01-22 05:51:46.903 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3617, 3623) --> . Mary journeyed to the
2025-01-22 05:51:46.904 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary picked up the milk.
2025-01-22 05:51:46.924 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4225, 4230) -->  Mary picked up the milk
2025-01-22 05:51:46.924 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the kitchen.
2025-01-22 05:51:46.949 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4862, 4868) --> . Mary went back to the
2025-01-22 05:51:46.949 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary dropped the milk.
2025-01-22 05:51:46.976 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5660, 5664) -->  Mary dropped the milk
2025-01-22 05:51:46.976 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra travelled to the kitchen.
2025-01-22 05:51:47.011 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6626, 6631) --> . Sandra travelled to the
2025-01-22 05:51:47.011 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the bedroom.
2025-01-22 05:51:47.026 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2107, 2112) --> . John travelled to the
2025-01-22 05:51:47.026 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the garden.
2025-01-22 05:51:47.051 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4021, 4026) -->  Sandra moved to the garden
2025-01-22 05:51:47.051 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went to the hallway.
2025-01-22 05:51:47.061 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1543, 1548) --> . John went to the
2025-01-22 05:51:47.061 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel moved to the office.
2025-01-22 05:51:47.079 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3728, 3733) --> . Daniel moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:51:49.244 | INFO     | test_jbb_embedding:begin_test:693 - the kitchen<|eot_id|>
2025-01-22 05:51:49.244 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8207])
2025-01-22 05:51:51.862 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [273.19711538461536, 25.869598812423874, 185.80625, 24.690122029642332, 21.257667824074073], 'topk_indices': array([3597, 2127, 3623, 8200, 2112, 8181, 8188, 8192,   24, 8086,   14,
       8186, 3619, 8096, 3620, 8187, 8052, 8202,    0, 8203]), 'topk_tokens': ['\n', 're', ' bedroom', 'Answer', ' bedroom', ':', ' the', ' milk', '\n\n', '.\n\n', '\n', ' prior', ' journey', ' location', 'ed', ' to', ' context', '<|eot_id|>', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [506.2916666666667, 242.475, 136.6875, 360.4375, 118.225]}, 'weight': {'score': [22.896634615384617, 23.298566915347138, 21.023046875, 23.305421476910826, 29.783564814814813], 'topk_indices': array([3270, 3243, 3163, 3115, 7397, 7435, 1399, 1461, 4277, 4293, 5113,
       5174, 7174, 7118, 3438, 3464, 4938, 4890, 4915, 4967]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.052083333333332, 26.6515625, 20.708333333333332, 26.685546875, 22.15]}, 'saliency': {'score': [1.6316669170673077, 0.14437239504034713, 1.03570556640625, 0.1374522185337304, 0.15872569143036266], 'topk_indices': array([8086, 8160, 4229, 8092, 1548, 8190, 8180, 5661, 3618, 3620, 2109,
       8192, 8200, 8194, 3623, 2112, 8096, 8186, 3619, 8052]), 'topk_tokens': ['.\n\n', ' dropped', ' milk', ' item', ' hallway', ' where', 'Question', ' dropped', ' Mary', 'ed', ' travelled', ' milk', 'Answer', ' discarded', ' bedroom', ' bedroom', ' location', ' prior', ' journey', ' context'], 'evidence_proportions': [2.6756184895833335, 1.6875, 0.7262166341145834, 2.38525390625, 0.8067626953125]}}, 'pred_res': 'the kitchen<|eot_id|>', 'score': 0}
2025-01-22 05:51:51.877 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:51:51.877 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-75_pid-1_4-5-6-7-8.pkl | len: 3 |  size: 2.08 KB
Processing depth (4, 5, 6, 7, 8):   2%|▏         | 2/100 [00:41<34:22, 21.04s/it]is_0k: False
your chose emoji: ['🧎🏼\u200d♂', '👩🏻\u200d❤\u200d💋\u200d👩🏼', '🧗🏽\u200d♂️', '🤱🏾', '💇\u200d♀️', '🧔🏼\u200d♂', '🙏🏼', '🟩', '⛹🏽\u200d♀️', '🏄🏼']
emoji:
O: 🧎🏼‍♂ [9468, 100, 236, 9468, 237, 120, 102470, 17245, 224]
N: 🟩 [9468, 253, 102]

O: 👩🏻‍❤‍💋‍👩🏼 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 120]
N: 🙏🏼 [9468, 247, 237, 9468, 237, 120]

O: 🧗🏽‍♂️ [9468, 100, 245, 9468, 237, 121, 102470, 17245, 224, 31643]
N: 🧎🏼‍♂ [9468, 100, 236, 9468, 237, 120, 102470, 17245, 224]

O: 🤱🏾 [9468, 97, 109, 9468, 237, 122]
N: 🧔🏼‍♂ [9468, 100, 242, 9468, 237, 120, 102470, 17245, 224]

O: 💇‍♀️ [93273, 229, 102470, 32990, 31643]
N: 🧗🏽‍♂️ [9468, 100, 245, 9468, 237, 121, 102470, 17245, 224, 31643]

O: 🧔🏼‍♂ [9468, 100, 242, 9468, 237, 120, 102470, 17245, 224]
N: 💇‍♀️ [93273, 229, 102470, 32990, 31643]

O: 🙏🏼 [9468, 247, 237, 9468, 237, 120]
N: ⛹🏽‍♀️ [158, 249, 117, 9468, 237, 121, 102470, 32990, 31643]

O: 🟩 [9468, 253, 102]
N: 👩🏻‍❤‍💋‍👩🏼 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 120]

O: ⛹🏽‍♀️ [158, 249, 117, 9468, 237, 121, 102470, 32990, 31643]
N: 🤱🏾 [9468, 97, 109, 9468, 237, 122]

O: 🏄🏼 [9468, 237, 226, 9468, 237, 120]
N: 🏄🏼 [9468, 237, 226, 9468, 237, 120]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:11,  3.98s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.70s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.82s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.37s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.83s/it]
Processing depth (0, 5, 6, 8, 9):   2%|▏         | 2/100 [00:58<34:22, 21.04s/it]2025-01-22 05:52:08.889 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the bedroom.
2025-01-22 05:52:08.889 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 37) -->  journeyed to the bedroom.
2025-01-22 05:52:08.889 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary picked up the milk.
2025-01-22 05:52:08.909 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4177, 4182) -->  Mary picked up the milk
2025-01-22 05:52:08.910 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the kitchen.
2025-01-22 05:52:08.933 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4760, 4766) --> . Mary went back to the
2025-01-22 05:52:08.933 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary dropped the milk.
2025-01-22 05:52:08.965 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6642, 6646) -->  Mary dropped the milk
2025-01-22 05:52:08.965 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra travelled to the kitchen.
2025-01-22 05:52:09.016 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7295, 7300) -->  cold. Sandra travelled to
2025-01-22 05:52:09.016 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the bedroom.
2025-01-22 05:52:09.026 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1904, 1909) --> . John travelled to the
2025-01-22 05:52:09.026 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the garden.
2025-01-22 05:52:09.046 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3974, 3979) -->  the ground. Sandra moved
2025-01-22 05:52:09.046 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went to the hallway.
2025-01-22 05:52:09.054 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1322, 1327) --> . John went to the
2025-01-22 05:52:09.054 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel moved to the office.
2025-01-22 05:52:09.073 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3649, 3654) -->  Hon. Daniel moved to
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:52:09.848 | INFO     | test_jbb_embedding:begin_test:693 - kitchen<|eot_id|>
2025-01-22 05:52:09.849 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8207])
2025-01-22 05:52:12.094 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [246.95763221153845, 26.760779537149816, 161.70625, 25.728929025293972, 21.95992476851852], 'topk_indices': array([7057, 2699, 7031, 8194, 8181, 1909, 8096,   33, 2718, 8050,   32,
       8187, 1906,    3,   24, 8203,   31, 8051, 8052,    0]), 'topk_tokens': [' to', ',', ' be', ' discarded', ':', ' bedroom', ' location', ' to', ' ne', ' provided', 'ed', ' to', ' travelled', '<|end_header_id|>', '\n\n', '<|start_header_id|>', ' journey', ' you', ' context', '<|begin_of_text|>'], 'evidence_proportions': [473.7083333333333, 220.5, 112.52083333333333, 387.75, 50.0046875]}, 'weight': {'score': [23.82361778846154, 23.294867158952496, 21.906640625, 23.296584088682017, 29.590470679012345], 'topk_indices': array([3312, 3339, 3184, 3232, 7475, 7437, 1468, 1530, 4363, 4347, 5165,
       5226, 7188, 7132, 3521, 3495, 4967, 4990, 4942, 5019]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.71875, 26.6515625, 20.708333333333332, 26.685546875, 26.1703125]}, 'saliency': {'score': [1.5051715557391827, 0.15098946835033497, 0.9199874877929688, 0.14479291094453356, 0.15989929952739199], 'topk_indices': array([2643,  825, 6643, 2626, 6645, 8200, 8186, 8180, 8051, 8096, 2644,
         35, 8050, 8192, 2718, 1909, 8194, 1906,   31, 8052]), 'topk_tokens': [' ne', '�', ' dropped', 'engers', ' milk', 'Answer', ' prior', 'Question', ' you', ' location', 'ared', ' bedroom', ' provided', ' milk', ' ne', ' bedroom', ' discarded', ' travelled', ' journey', ' context'], 'evidence_proportions': [2.66162109375, 1.52783203125, 0.5801188151041666, 2.591552734375, 0.33572998046875]}}, 'pred_res': 'kitchen<|eot_id|>', 'score': 0}
2025-01-22 05:52:12.098 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:52:12.099 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-75_pid-2_0-5-6-8-9.pkl | len: 3 |  size: 2.08 KB
Processing depth (0, 5, 6, 8, 9):   3%|▎         | 3/100 [01:01<33:24, 20.67s/it]is_0k: False
your chose emoji: ['🅰', '👩🏾\u200d❤️\u200d💋\u200d👩🏾', '👩🏽\u200d🤝\u200d👩🏿', '💮', '🏂🏿', '👂🏿', '🧑🏾\u200d⚖', '👰\u200d♀️', '👮🏾\u200d♀', '🏝️']
emoji:
O: 🅰 [9468, 227, 108]
N: 🅰 [9468, 227, 108]

O: 👩🏾‍❤️‍💋‍👩🏾 [9468, 239, 102, 9468, 237, 122, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 122]
N: 🏂🏿 [9468, 237, 224, 9468, 237, 123]

O: 👩🏽‍🤝‍👩🏿 [9468, 239, 102, 9468, 237, 121, 102470, 9468, 97, 251, 102470, 9468, 239, 102, 9468, 237, 123]
N: 👩🏾‍❤️‍💋‍👩🏾 [9468, 239, 102, 9468, 237, 122, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 122]

O: 💮 [93273, 106]
N: 👰‍♀️ [9468, 239, 108, 102470, 32990, 31643]

O: 🏂🏿 [9468, 237, 224, 9468, 237, 123]
N: 👩🏽‍🤝‍👩🏿 [9468, 239, 102, 9468, 237, 121, 102470, 9468, 97, 251, 102470, 9468, 239, 102, 9468, 237, 123]

O: 👂🏿 [9468, 239, 224, 9468, 237, 123]
N: 💮 [93273, 106]

O: 🧑🏾‍⚖ [9468, 100, 239, 9468, 237, 122, 102470, 158, 248, 244]
N: 👮🏾‍♀ [9468, 239, 106, 9468, 237, 122, 102470, 32990]

O: 👰‍♀️ [9468, 239, 108, 102470, 32990, 31643]
N: 🧑🏾‍⚖ [9468, 100, 239, 9468, 237, 122, 102470, 158, 248, 244]

O: 👮🏾‍♀ [9468, 239, 106, 9468, 237, 122, 102470, 32990]
N: 👂🏿 [9468, 239, 224, 9468, 237, 123]

O: 🏝️ [9468, 237, 251, 31643]
N: 🏝️ [9468, 237, 251, 31643]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:11,  3.95s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.44s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.29s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.79s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.33s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (2, 3, 4, 5, 6):   3%|▎         | 3/100 [01:17<33:24, 20.67s/it]2025-01-22 05:52:27.597 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the bedroom.
2025-01-22 05:52:27.606 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1853, 1859) --> . Mary journeyed to the
2025-01-22 05:52:27.607 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary picked up the milk.
2025-01-22 05:52:27.621 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2838, 2843) --> . Mary picked up the
2025-01-22 05:52:27.622 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the kitchen.
2025-01-22 05:52:27.640 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3612, 3618) --> . Mary went back to the
2025-01-22 05:52:27.640 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary dropped the milk.
2025-01-22 05:52:27.660 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4176, 4180) -->  Mary dropped the milk
2025-01-22 05:52:27.660 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra travelled to the kitchen.
2025-01-22 05:52:27.687 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4748, 4753) --> . Sandra travelled to the
2025-01-22 05:52:27.687 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the bedroom.
2025-01-22 05:52:27.702 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2049, 2054) -->  cable. John travelled to
2025-01-22 05:52:27.702 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the garden.
2025-01-22 05:52:27.731 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3924, 3929) -->  Sandra moved to the garden
2025-01-22 05:52:27.731 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went to the hallway.
2025-01-22 05:52:27.739 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1543, 1548) --> . John went to the
2025-01-22 05:52:27.739 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel moved to the office.
2025-01-22 05:52:27.757 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3640, 3645) -->  Hon. Daniel moved to
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:52:29.910 | INFO     | test_jbb_embedding:begin_test:693 - the kitchen<|eot_id|>
2025-01-22 05:52:29.910 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8169])
2025-01-22 05:52:32.634 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [167.796875, 21.425804194199706, 116.22421875, 20.724153181146935, 26.681735131048388], 'topk_indices': array([8152, 8144, 8048, 8013, 3115, 8143, 8153, 8145,   14,   24, 8058,
       1859, 8150, 3116, 8148, 8014, 8149,    0, 8164, 8165]), 'topk_tokens': [' where', ' Where', '.\n\n', ' you', ' const', ':', ' the', ' was', '\n', '\n\n', ' location', ' bedroom', ' the', 'ern', ' prior', ' context', ' to', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [277.7083333333333, 139.4375, 97.59375, 246.34375, 85.66875]}, 'weight': {'score': [22.021334134615383, 23.26551983908468, 23.331640625, 23.269338004553287, 29.592993951612904], 'topk_indices': array([3296, 3323, 3216, 3168, 7445, 7407, 1461, 1399, 4333, 4317, 5152,
       5213, 7184, 7128, 3505, 3479, 4929, 4954, 5006, 4977]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.052083333333332, 22.1, 20.708333333333332, 26.685546875, 22.15]}, 'saliency': {'score': [0.9764592097355769, 0.11835757202805693, 0.67264404296875, 0.11424775514407842, 0.1977940220986643], 'topk_indices': array([8013, 8145, 8012,   24, 8147, 8142, 8152, 8154, 8144, 1855, 8162,
       8149, 3115, 1548, 8156, 8058, 3116, 8014, 8148, 1859]), 'topk_tokens': [' you', ' was', ' provided', '\n\n', ' location', 'Question', ' where', ' milk', ' Where', ' journey', 'Answer', ' to', ' const', ' hallway', ' discarded', ' location', 'ern', ' context', ' prior', ' bedroom'], 'evidence_proportions': [1.5030924479166667, 0.75849609375, 0.5179646809895834, 1.64990234375, 0.5739013671875]}}, 'pred_res': 'the kitchen<|eot_id|>', 'score': 0}
2025-01-22 05:52:32.649 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:52:32.650 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-75_pid-3_2-3-4-5-6.pkl | len: 3 |  size: 2.07 KB
Processing depth (2, 3, 4, 5, 6):   4%|▍         | 4/100 [01:22<32:59, 20.62s/it]is_0k: False
your chose emoji: ['®', '\U0001faf1🏼\u200d\U0001faf2🏻', '👈🏻', '🪁', '💓', '🏃🏻\u200d♀️', '🇻🇺', '🧗🏽\u200d♀️', '🧖🏿\u200d♂', '🌡️']
emoji:
O: ® [12175]
N: 👈🏻 [9468, 239, 230, 9468, 237, 119]

O: 🫱🏼‍🫲🏻 [9468, 104, 109, 9468, 237, 120, 102470, 9468, 104, 110, 9468, 237, 119]
N: 🫱🏼‍🫲🏻 [9468, 104, 109, 9468, 237, 120, 102470, 9468, 104, 110, 9468, 237, 119]

O: 👈🏻 [9468, 239, 230, 9468, 237, 119]
N: ® [12175]

O: 🪁 [9468, 103, 223]
N: 🪁 [9468, 103, 223]

O: 💓 [93273, 241]
N: 🏃🏻‍♀️ [9468, 237, 225, 9468, 237, 119, 102470, 32990, 31643]

O: 🏃🏻‍♀️ [9468, 237, 225, 9468, 237, 119, 102470, 32990, 31643]
N: 🧖🏿‍♂ [9468, 100, 244, 9468, 237, 123, 102470, 17245, 224]

O: 🇻🇺 [9468, 229, 119, 9468, 229, 118]
N: 🧗🏽‍♀️ [9468, 100, 245, 9468, 237, 121, 102470, 32990, 31643]

O: 🧗🏽‍♀️ [9468, 100, 245, 9468, 237, 121, 102470, 32990, 31643]
N: 🇻🇺 [9468, 229, 119, 9468, 229, 118]

O: 🧖🏿‍♂ [9468, 100, 244, 9468, 237, 123, 102470, 17245, 224]
N: 💓 [93273, 241]

O: 🌡️ [9468, 234, 94, 31643]
N: 🌡️ [9468, 234, 94, 31643]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.61s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.83s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.55s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.15s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.70s/it]
Processing depth (2, 4, 6, 8, 9):   4%|▍         | 4/100 [01:39<32:59, 20.62s/it]2025-01-22 05:52:49.507 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the bedroom.
2025-01-22 05:52:49.517 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1816, 1822) -->  Mary journeyed to the bedroom
2025-01-22 05:52:49.517 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary picked up the milk.
2025-01-22 05:52:49.537 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3652, 3657) --> . Mary picked up the
2025-01-22 05:52:49.537 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the kitchen.
2025-01-22 05:52:49.563 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4792, 4798) -->  the senate. Mary went back
2025-01-22 05:52:49.563 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary dropped the milk.
2025-01-22 05:52:49.600 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6666, 6670) -->  Mary dropped the milk
2025-01-22 05:52:49.601 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra travelled to the kitchen.
2025-01-22 05:52:49.638 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7278, 7283) --> . Sandra travelled to the
2025-01-22 05:52:49.638 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the bedroom.
2025-01-22 05:52:49.648 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2057, 2062) -->  cable. John travelled to
2025-01-22 05:52:49.648 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the garden.
2025-01-22 05:52:49.669 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4042, 4047) --> . Sandra moved to the
2025-01-22 05:52:49.669 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went to the hallway.
2025-01-22 05:52:49.676 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1529, 1534) --> . John went to the
2025-01-22 05:52:49.677 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel moved to the office.
2025-01-22 05:52:49.695 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3762, 3767) --> . Daniel moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:52:50.483 | INFO     | test_jbb_embedding:begin_test:693 - the kitchen<|eot_id|>
2025-01-22 05:52:50.484 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8231])
2025-01-22 05:52:52.729 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [202.67668269230768, 25.36518740891426, 129.0078125, 24.54899891609673, 23.009870631720432], 'topk_indices': array([8216,    3, 8074,   24, 1821, 8210, 8212, 8214, 8224, 8205, 8215,
       8120, 8110, 8075,   14, 8226, 8211, 8227, 8076,    0]), 'topk_tokens': [' milk', '<|end_header_id|>', ' provided', '\n\n', ' bedroom', ' prior', ' the', ' where', 'Answer', ':', ' the', ' location', '.\n\n', ' you', '\n', '<|eot_id|>', ' to', '<|start_header_id|>', ' context', '<|begin_of_text|>'], 'evidence_proportions': [316.9583333333333, 190.575, 72.21354166666667, 378.6875, 93.3875]}, 'weight': {'score': [23.974158653846153, 23.31216412132621, 21.001171875, 23.315706865229604, 29.548723118279568], 'topk_indices': array([3290, 3317, 3210, 3162, 7457, 7495, 1427, 1489, 4293, 4309, 5205,
       5266, 7228, 7172, 3499, 3473, 4945, 5004, 4920, 5033]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [24.57421875, 22.1, 24.6484375, 26.685546875, 22.15]}, 'saliency': {'score': [1.3175753079927885, 0.14184253054218787, 0.722088623046875, 0.13669182535608512, 0.1714247836861559], 'topk_indices': array([6667, 8211, 6666, 8081, 8206, 8213, 1534, 6669, 8110, 8204, 8075,
       8218, 8214, 8216, 8074, 8120, 8210, 8224, 1821, 8076]), 'topk_tokens': [' dropped', ' to', ' Mary', ' locations', ' Where', ' place', ' hallway', ' milk', '.\n\n', 'Question', ' you', ' discarded', ' where', ' milk', ' provided', ' location', ' prior', 'Answer', ' bedroom', ' context'], 'evidence_proportions': [2.1544596354166665, 1.0486328125, 0.4486287434895833, 2.5992431640625, 0.599658203125]}}, 'pred_res': 'the kitchen<|eot_id|>', 'score': 0}
2025-01-22 05:52:52.736 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:52:52.737 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-75_pid-4_2-4-6-8-9.pkl | len: 3 |  size: 2.09 KB
Processing depth (2, 4, 6, 8, 9):   5%|▌         | 5/100 [01:42<32:20, 20.43s/it]Processing depth (2, 4, 6, 8, 9):   5%|▌         | 5/100 [01:42<32:29, 20.52s/it]
2025-01-22 05:52:52.792 | INFO     | __main__:<module>:82 - Selected idx: 76
2025-01-22 05:52:52.792 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the football before the office? 
2025-01-22 05:52:52.792 | INFO     | __main__:<module>:84 - Answer: kitchen
2025-01-22 05:52:52.792 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 05:52:52.792 | INFO     | __main__:<module>:86 - Needle: [' John travelled to the bedroom.', ' Mary went back to the kitchen.', ' Mary went back to the office.', ' Daniel moved to the office.', ' Sandra moved to the garden.', ' Mary dropped the football.', ' John went to the hallway.']
2025-01-22 05:52:52.792 | INFO     | __main__:<module>:87 - Real Needle: [' Mary went back to the kitchen.', ' Mary went back to the office.', ' Mary dropped the football.', ' John went to the hallway.']
2025-01-22 05:52:52.792 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['🙍🏽\u200d♀', '\U0001faf1🏾\u200d\U0001faf2🏽', '🧗🏽\u200d♂', '🧑', '👨🏾\u200d🦽\u200d➡️', '👨\u200d🦯', '👨🏻\u200d❤\u200d💋\u200d👨🏾', '🚶\u200d♂', '🧜🏼\u200d♀️', '🏴\u200d☠']
emoji:
O: 🙍🏽‍♀ [9468, 247, 235, 9468, 237, 121, 102470, 32990]
N: 👨🏾‍🦽‍➡️ [9468, 239, 101, 9468, 237, 122, 102470, 9468, 99, 121, 102470, 98115, 94, 31643]

O: 🫱🏾‍🫲🏽 [9468, 104, 109, 9468, 237, 122, 102470, 9468, 104, 110, 9468, 237, 121]
N: 🧗🏽‍♂ [9468, 100, 245, 9468, 237, 121, 102470, 17245, 224]

O: 🧗🏽‍♂ [9468, 100, 245, 9468, 237, 121, 102470, 17245, 224]
N: 🧑 [9468, 100, 239]

O: 🧑 [9468, 100, 239]
N: 👨‍🦯 [9468, 239, 101, 102470, 9468, 99, 107]

O: 👨🏾‍🦽‍➡️ [9468, 239, 101, 9468, 237, 122, 102470, 9468, 99, 121, 102470, 98115, 94, 31643]
N: 🧜🏼‍♀️ [9468, 100, 250, 9468, 237, 120, 102470, 32990, 31643]

O: 👨‍🦯 [9468, 239, 101, 102470, 9468, 99, 107]
N: 👨🏻‍❤‍💋‍👨🏾 [9468, 239, 101, 9468, 237, 119, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 122]

O: 👨🏻‍❤‍💋‍👨🏾 [9468, 239, 101, 9468, 237, 119, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 122]
N: 🫱🏾‍🫲🏽 [9468, 104, 109, 9468, 237, 122, 102470, 9468, 104, 110, 9468, 237, 121]

O: 🚶‍♂ [9468, 248, 114, 102470, 17245, 224]
N: 🙍🏽‍♀ [9468, 247, 235, 9468, 237, 121, 102470, 32990]

O: 🧜🏼‍♀️ [9468, 100, 250, 9468, 237, 120, 102470, 32990, 31643]
N: 🚶‍♂ [9468, 248, 114, 102470, 17245, 224]

O: 🏴‍☠ [9468, 237, 112, 102470, 18107, 254]
N: 🏴‍☠ [9468, 237, 112, 102470, 18107, 254]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.23s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.37s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.17s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.74s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.29s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 4, 5, 9):   0%|          | 0/100 [00:14<?, ?it/s]2025-01-22 05:53:07.954 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary went back to the kitchen.
2025-01-22 05:53:07.954 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 37) -->  went back to the kitchen.
2025-01-22 05:53:07.955 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went back to the office.
2025-01-22 05:53:07.974 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3627, 3633) -->  Hon. Mary went back to
2025-01-22 05:53:07.974 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary dropped the football.
2025-01-22 05:53:08.000 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4231, 4235) -->  dropped the football.
2025-01-22 05:53:08.000 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the hallway.
2025-01-22 05:53:08.053 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7336, 7341) --> . John went to the
2025-01-22 05:53:08.053 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the bedroom.
2025-01-22 05:53:08.078 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4367, 4372) -->  John travelled to the bedroom
2025-01-22 05:53:08.078 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the office.
2025-01-22 05:53:08.086 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1390, 1395) --> . Daniel moved to the
2025-01-22 05:53:08.086 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the garden.
2025-01-22 05:53:08.086 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (112, 117) --> . Sandra moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:53:14.151 | INFO     | test_jbb_embedding:begin_test:693 - Mary dropped the football.<|eot_id|>
2025-01-22 05:53:14.151 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8144])
2025-01-22 05:53:17.220 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [402.76190476190476, 28.734284859457468, 278.2875, 27.304389871779065, 21.346484375], 'topk_indices': array([8138,   29, 1395, 8127, 8072,    4,   36, 4231,   39, 8042, 8132,
       8142,   14, 4234,   24, 8140, 8131, 4233, 8139,    0]), 'topk_tokens': [':', '\n\n', ' office', ':', ' the', '\n\n', '.', ' dropped', '***', ' location', ' before', '<|end_header_id|>', '\n', '.', '\n\n', '<|start_header_id|>', ' football', ' football', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [456.875, 377.7916666666667, 821.8125, 32.55]}, 'weight': {'score': [21.49813988095238, 23.258992957530378, 22.122395833333332, 23.26565389594378, 29.403385416666666], 'topk_indices': array([3305, 3278, 3150, 3198, 7359, 7397, 1418, 1480, 4297, 4281, 5183,
       5122, 7130, 7074, 3499, 3473, 4924, 4976, 4947, 4899]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.84375, 24.71484375, 21.23046875, 18.6375]}, 'saliency': {'score': [2.282499767485119, 0.16026129909303272, 1.59453125, 0.1521142078465972, 0.1577972412109375], 'topk_indices': array([4230, 1392, 8128,   40, 7306,   24, 7998, 8134,   31, 8137,   35,
       1395, 8126,  113, 8132, 4231, 8042,   39, 8131, 4233]), 'topk_tokens': [' Mary', ' moved', ' Where', '\n\n\n', 'nes', '\n\n', ' context', ' office', ' went', 'Answer', ' kitchen', ' office', 'Question', ' Sandra', ' before', ' dropped', ' location', '***', ' football', ' football'], 'evidence_proportions': [2.427978515625, 2.21484375, 4.82666015625, 0.1537841796875]}}, 'pred_res': 'Mary dropped the football.<|eot_id|>', 'score': 0}
2025-01-22 05:53:17.225 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:53:17.225 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-76_pid-0_0-4-5-9.pkl | len: 3 |  size: 2.03 KB
Processing depth (0, 4, 5, 9):   1%|          | 1/100 [00:24<40:07, 24.32s/it]is_0k: False
your chose emoji: ['🇱🇺', '🚶🏻\u200d♂', '🧏🏾\u200d♀️', '👱🏾\u200d♀', '🤖', '⚒️', '㊙️', '🚴🏾\u200d♀', '🇬🇮', '🔓']
emoji:
O: 🇱🇺 [9468, 229, 109, 9468, 229, 118]
N: 🚶🏻‍♂ [9468, 248, 114, 9468, 237, 119, 102470, 17245, 224]

O: 🚶🏻‍♂ [9468, 248, 114, 9468, 237, 119, 102470, 17245, 224]
N: 👱🏾‍♀ [9468, 239, 109, 9468, 237, 122, 102470, 32990]

O: 🧏🏾‍♀️ [9468, 100, 237, 9468, 237, 122, 102470, 32990, 31643]
N: 🇬🇮 [9468, 229, 105, 9468, 229, 106]

O: 👱🏾‍♀ [9468, 239, 109, 9468, 237, 122, 102470, 32990]
N: ㊙️ [159, 232, 247, 31643]

O: 🤖 [9468, 97, 244]
N: 🚴🏾‍♀ [9468, 248, 112, 9468, 237, 122, 102470, 32990]

O: ⚒️ [158, 248, 240, 31643]
N: 🤖 [9468, 97, 244]

O: ㊙️ [159, 232, 247, 31643]
N: 🧏🏾‍♀️ [9468, 100, 237, 9468, 237, 122, 102470, 32990, 31643]

O: 🚴🏾‍♀ [9468, 248, 112, 9468, 237, 122, 102470, 32990]
N: 🇱🇺 [9468, 229, 109, 9468, 229, 118]

O: 🇬🇮 [9468, 229, 105, 9468, 229, 106]
N: ⚒️ [158, 248, 240, 31643]

O: 🔓 [9468, 242, 241]
N: 🔓 [9468, 242, 241]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.51s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.79s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.86s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.39s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.89s/it]
Processing depth (0, 2, 7, 9):   1%|          | 1/100 [00:41<40:07, 24.32s/it]2025-01-22 05:53:34.660 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary went back to the kitchen.
2025-01-22 05:53:34.660 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 37) -->  went back to the kitchen.
2025-01-22 05:53:34.661 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went back to the office.
2025-01-22 05:53:34.670 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1766, 1772) --> . Mary went back to the
2025-01-22 05:53:34.670 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary dropped the football.
2025-01-22 05:53:34.700 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5646, 5650) -->  Mary dropped the football
2025-01-22 05:53:34.701 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the hallway.
2025-01-22 05:53:34.738 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7232, 7237) --> . John went to the
2025-01-22 05:53:34.738 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the bedroom.
2025-01-22 05:53:34.759 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4321, 4326) --> . John travelled to the
2025-01-22 05:53:34.759 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the office.
2025-01-22 05:53:34.766 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1245, 1250) -->  Republican. Daniel moved to
2025-01-22 05:53:34.766 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the garden.
2025-01-22 05:53:34.767 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (112, 117) --> . Sandra moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:53:35.641 | INFO     | test_jbb_embedding:begin_test:693 - Mary dropped the football.<|eot_id|>
2025-01-22 05:53:35.641 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8188])
2025-01-22 05:53:37.887 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [573.2142857142857, 60.8162121535832, 377.525, 58.91418991416309, 34.0399199695122], 'topk_indices': array([5646, 8102, 5647, 8178,   14, 8041, 8086, 8176, 5918, 5645, 5919,
       8116, 8175, 6055, 5650, 5920, 8042, 6056, 5649,    0]), 'topk_tokens': [' Mary', '.\n', ' dropped', ' office', '\n', ' you', ' location', ' before', ',', '.', ' in', ' the', ' football', ',', '.', ' which', ' context', ' in', ' football', '<|begin_of_text|>'], 'evidence_proportions': [723.8333333333334, 258.3125, 1410.625, 100.425]}, 'weight': {'score': [21.45498511904762, 23.288149722256136, 21.928645833333334, 23.2953709380748, 29.211128048780488], 'topk_indices': array([3303, 3330, 3223, 3175, 7449, 7411, 1498, 1436, 4294, 4310, 5190,
       5129, 7126, 7182, 3486, 3512, 4906, 4954, 4983, 4931]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.84375, 20.708333333333332, 27.013671875, 18.6375]}, 'saliency': {'score': [3.5695335751488093, 0.33929800285755707, 2.1207682291666665, 0.3277030303973789, 0.25345704613662345], 'topk_indices': array([6054, 8172, 5865, 8170, 5919, 8040, 6001, 5900, 8041, 6056,   35,
       5647, 8176, 8178, 5646, 8086, 5920, 8175, 8042, 5649]), 'topk_tokens': [' Charleston', ' Where', ' time', 'Question', ' in', ' provided', 'this', 'ayers', ' you', ' in', ' kitchen', ' dropped', ' before', ' office', ' Mary', ' location', ' which', ' football', ' context', ' football'], 'evidence_proportions': [4.018391927083333, 1.4051920572916667, 10.0224609375, 0.465771484375]}}, 'pred_res': 'Mary dropped the football.<|eot_id|>', 'score': 0}
2025-01-22 05:53:37.895 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:53:37.895 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-76_pid-1_0-2-7-9.pkl | len: 3 |  size: 2.01 KB
Processing depth (0, 2, 7, 9):   2%|▏         | 2/100 [00:44<36:12, 22.17s/it]is_0k: False
your chose emoji: ['⛏', '👨\u200d👨\u200d👧\u200d👧', '👏🏽', '👨🏽\u200d💼', '👨🏻\u200d🦼\u200d➡️', '🤶🏼', '🤔', '🦸🏻\u200d♀', '👩\u200d❤\u200d👩', '🙇🏿\u200d♂']
emoji:
O: ⛏ [158, 249, 237]
N: ⛏ [158, 249, 237]

O: 👨‍👨‍👧‍👧 [9468, 239, 101, 102470, 9468, 239, 101, 102470, 9468, 239, 100, 102470, 9468, 239, 100]
N: 👏🏽 [9468, 239, 237, 9468, 237, 121]

O: 👏🏽 [9468, 239, 237, 9468, 237, 121]
N: 👨🏻‍🦼‍➡️ [9468, 239, 101, 9468, 237, 119, 102470, 9468, 99, 120, 102470, 98115, 94, 31643]

O: 👨🏽‍💼 [9468, 239, 101, 9468, 237, 121, 102470, 93273, 120]
N: 🤔 [9468, 97, 242]

O: 👨🏻‍🦼‍➡️ [9468, 239, 101, 9468, 237, 119, 102470, 9468, 99, 120, 102470, 98115, 94, 31643]
N: 🤶🏼 [9468, 97, 114, 9468, 237, 120]

O: 🤶🏼 [9468, 97, 114, 9468, 237, 120]
N: 👨🏽‍💼 [9468, 239, 101, 9468, 237, 121, 102470, 93273, 120]

O: 🤔 [9468, 97, 242]
N: 🦸🏻‍♀ [9468, 99, 116, 9468, 237, 119, 102470, 32990]

O: 🦸🏻‍♀ [9468, 99, 116, 9468, 237, 119, 102470, 32990]
N: 👨‍👨‍👧‍👧 [9468, 239, 101, 102470, 9468, 239, 101, 102470, 9468, 239, 100, 102470, 9468, 239, 100]

O: 👩‍❤‍👩 [9468, 239, 102, 102470, 121643, 102470, 9468, 239, 102]
N: 👩‍❤‍👩 [9468, 239, 102, 102470, 121643, 102470, 9468, 239, 102]

O: 🙇🏿‍♂ [9468, 247, 229, 9468, 237, 123, 102470, 17245, 224]
N: 🙇🏿‍♂ [9468, 247, 229, 9468, 237, 123, 102470, 17245, 224]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.71s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.62s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.30s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.84s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.45s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (1, 3, 4, 8):   2%|▏         | 2/100 [01:01<36:12, 22.17s/it]2025-01-22 05:53:54.075 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary went back to the kitchen.
2025-01-22 05:53:54.081 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (901, 907) --> . Mary went back to the
2025-01-22 05:53:54.082 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went back to the office.
2025-01-22 05:53:54.087 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (901, 907) --> . Mary went back to the
2025-01-22 05:53:54.087 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary dropped the football.
2025-01-22 05:53:54.106 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3626, 3630) -->  Mary dropped the football
2025-01-22 05:53:54.107 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the hallway.
2025-01-22 05:53:54.142 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6620, 6625) --> . John went to the
2025-01-22 05:53:54.142 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the bedroom.
2025-01-22 05:53:54.164 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4330, 4335) --> . John travelled to the
2025-01-22 05:53:54.164 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the office.
2025-01-22 05:53:54.171 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1278, 1283) --> . Daniel moved to the
2025-01-22 05:53:54.171 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the garden.
2025-01-22 05:53:54.172 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (105, 110) --> . Sandra moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:53:57.765 | INFO     | test_jbb_embedding:begin_test:693 - Mary's hands.<|eot_id|>
2025-01-22 05:53:57.765 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8182])
2025-01-22 05:54:00.626 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [522.2380952380952, 33.745578802687845, 308.24583333333334, 31.981454779727574, 19.94590585443038], 'topk_indices': array([8163,  111, 8164,   24, 8168, 8167, 8165, 8036, 8180,  907, 3625,
       8172, 3628, 8170, 3627, 3630, 8177, 8169,    0, 3629]), 'topk_tokens': ['.\n\n', '.', 'Question', '\n\n', ' the', ' was', ':', ' context', '<|end_header_id|>', ' kitchen', '.', ' office', ' the', ' before', ' dropped', '.', '<|eot_id|>', ' football', '<|begin_of_text|>', ' football'], 'evidence_proportions': [429.125, 429.125, 1358.875, 76.4]}, 'weight': {'score': [21.416294642857142, 23.287784437996336, 20.313541666666666, 23.298082011596517, 29.422863924050635], 'topk_indices': array([3287, 3314, 3159, 3207, 7429, 7391, 1486, 1424, 4303, 4319, 5221,
       5160, 7168, 7112, 3470, 3496, 4922, 4994, 4897, 4965]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.708333333333332, 20.708333333333332, 27.013671875, 18.6375]}, 'saliency': {'score': [3.192563011532738, 0.19208292369807575, 1.7309000651041666, 0.18151815023315745, 0.149932861328125], 'topk_indices': array([8034,    0, 3630, 8167, 1283, 8175,  110, 8080, 3626, 8166,  107,
       8164,  106, 8036, 8172, 8170,  907, 3627, 8169, 3629]), 'topk_tokens': [' provided', '<|begin_of_text|>', '.', ' was', ' office', 'Answer', ' garden', ' location', ' Mary', ' Where', ' moved', 'Question', ' Sandra', ' context', ' office', ' before', ' kitchen', ' dropped', ' football', ' football'], 'evidence_proportions': [2.2340494791666665, 2.2340494791666665, 9.54541015625, 0.4107177734375]}}, 'pred_res': "Mary's hands.<|eot_id|>", 'score': 0}
2025-01-22 05:54:00.635 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:54:00.635 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-76_pid-2_1-3-4-8.pkl | len: 3 |  size: 2.04 KB
Processing depth (1, 3, 4, 8):   3%|▎         | 3/100 [01:07<36:15, 22.43s/it]is_0k: False
your chose emoji: ['👳🏻\u200d♂', '👩🏼\u200d🔧', '🧕🏿', '🤛🏾', '🧑🏿\u200d🦱', '🧙🏻\u200d♂️', '✍️', '👴🏿', '👨🏽\u200d🍼', '👱🏾\u200d♂️']
emoji:
O: 👳🏻‍♂ [9468, 239, 111, 9468, 237, 119, 102470, 17245, 224]
N: ✍️ [38798, 235, 31643]

O: 👩🏼‍🔧 [9468, 239, 102, 9468, 237, 120, 102470, 9468, 242, 100]
N: 👴🏿 [9468, 239, 112, 9468, 237, 123]

O: 🧕🏿 [9468, 100, 243, 9468, 237, 123]
N: 👳🏻‍♂ [9468, 239, 111, 9468, 237, 119, 102470, 17245, 224]

O: 🤛🏾 [9468, 97, 249, 9468, 237, 122]
N: 👩🏼‍🔧 [9468, 239, 102, 9468, 237, 120, 102470, 9468, 242, 100]

O: 🧑🏿‍🦱 [9468, 100, 239, 9468, 237, 123, 102470, 9468, 99, 109]
N: 🤛🏾 [9468, 97, 249, 9468, 237, 122]

O: 🧙🏻‍♂️ [9468, 100, 247, 9468, 237, 119, 102470, 17245, 224, 31643]
N: 🧑🏿‍🦱 [9468, 100, 239, 9468, 237, 123, 102470, 9468, 99, 109]

O: ✍️ [38798, 235, 31643]
N: 🧙🏻‍♂️ [9468, 100, 247, 9468, 237, 119, 102470, 17245, 224, 31643]

O: 👴🏿 [9468, 239, 112, 9468, 237, 123]
N: 🧕🏿 [9468, 100, 243, 9468, 237, 123]

O: 👨🏽‍🍼 [9468, 239, 101, 9468, 237, 121, 102470, 9468, 104247]
N: 👨🏽‍🍼 [9468, 239, 101, 9468, 237, 121, 102470, 9468, 104247]

O: 👱🏾‍♂️ [9468, 239, 109, 9468, 237, 122, 102470, 17245, 224, 31643]
N: 👱🏾‍♂️ [9468, 239, 109, 9468, 237, 122, 102470, 17245, 224, 31643]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:05<00:15,  5.31s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:10<00:10,  5.09s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.60s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.24s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.85s/it]
Processing depth (2, 3, 6, 7):   3%|▎         | 3/100 [01:24<36:15, 22.43s/it]2025-01-22 05:54:17.879 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary went back to the kitchen.
2025-01-22 05:54:17.890 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1794, 1800) -->  Mary went back to the kitchen
2025-01-22 05:54:17.891 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went back to the office.
2025-01-22 05:54:17.900 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1795, 1801) -->  went back to the kitchen.
2025-01-22 05:54:17.900 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary dropped the football.
2025-01-22 05:54:17.925 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4760, 4764) -->  Mary dropped the football
2025-01-22 05:54:17.925 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the hallway.
2025-01-22 05:54:17.957 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5712, 5717) --> . John went to the
2025-01-22 05:54:17.958 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the bedroom.
2025-01-22 05:54:17.981 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4311, 4316) --> . John travelled to the
2025-01-22 05:54:17.982 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the office.
2025-01-22 05:54:17.988 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1271, 1276) --> . Daniel moved to the
2025-01-22 05:54:17.988 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the garden.
2025-01-22 05:54:17.989 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (105, 110) --> . Sandra moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:54:18.765 | INFO     | test_jbb_embedding:begin_test:693 - the kitchen<|eot_id|>
2025-01-22 05:54:18.765 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8170])
2025-01-22 05:54:20.996 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [404.4330357142857, 32.88553774623761, 339.775, 31.360916953422638, 28.568600171232877], 'topk_indices': array([8156, 4762, 8164, 8068,  110, 8151, 1799, 4761, 8153, 8166, 1276,
       1277, 8160, 8168, 8158, 4764, 8157, 4763, 8165,    0]), 'topk_tokens': [' the', ' the', ':', ' location', ' garden', '.\n\n', ' kitchen', ' dropped', ':', '<|start_header_id|>', ' office', '.', ' office', '<|end_header_id|>', ' before', '.', ' football', ' football', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [411.0833333333333, 367.9166666666667, 890.0, 51.81875]}, 'weight': {'score': [22.595238095238095, 23.267575018353114, 20.313541666666666, 23.274755745360697, 28.79580479452055], 'topk_indices': array([3320, 3293, 3213, 3165, 7453, 7415, 1417, 1479, 4300, 4284, 5167,
       5106, 7082, 7138, 3476, 3502, 4931, 4960, 4908, 4883]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [24.69921875, 20.84375, 27.013671875, 18.6375]}, 'saliency': {'score': [2.6757289341517856, 0.18533620550803714, 1.9052897135416667, 0.17573837462171255, 0.2013365863120719], 'topk_indices': array([1272, 1782, 1273, 8161, 8024, 1794, 8154,  107, 8152, 8068, 8163,
        110, 4761, 1276, 1799,  106, 8160, 8158, 8157, 4763]), 'topk_tokens': [' Daniel', '�', ' moved', '?', ' context', ' Mary', ' Where', ' moved', 'Question', ' location', 'Answer', ' garden', ' dropped', ' office', ' kitchen', ' Sandra', ' office', ' before', ' football', ' football'], 'evidence_proportions': [2.7932942708333335, 2.189453125, 6.2294921875, 0.2751708984375]}}, 'pred_res': 'the kitchen<|eot_id|>', 'score': 100}
2025-01-22 05:54:21.007 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:54:21.007 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-76_pid-3_2-3-6-7.pkl | len: 3 |  size: 2.04 KB
Processing depth (2, 3, 6, 7):   4%|▍         | 4/100 [01:28<34:35, 21.62s/it]is_0k: False
your chose emoji: ['🧕🏿', '🧚🏼', '🍓', '🇬🇩', '🏴\U000e0067\U000e0062\U000e0065\U000e006e\U000e0067\U000e007f', '🙅🏽', '🇧🇸', '🇬🇷', '👼🏼', '🧑\u200d✈️']
emoji:
O: 🧕🏿 [9468, 100, 243, 9468, 237, 123]
N: 🍓 [9468, 235, 241]

O: 🧚🏼 [9468, 100, 248, 9468, 237, 120]
N: 🧚🏼 [9468, 100, 248, 9468, 237, 120]

O: 🍓 [9468, 235, 241]
N: 🇧🇸 [9468, 229, 100, 9468, 229, 116]

O: 🇬🇩 [9468, 229, 105, 9468, 229, 102]
N: 🇬🇩 [9468, 229, 105, 9468, 229, 102]

O: 🏴󠁧󠁢󠁥󠁮󠁧󠁿 [9468, 237, 112, 175, 16050, 100, 175, 16050, 95, 175, 16050, 98, 175, 16050, 106, 175, 16050, 100, 175, 16050, 123]
N: 🇬🇷 [9468, 229, 105, 9468, 229, 115]

O: 🙅🏽 [9468, 247, 227, 9468, 237, 121]
N: 👼🏼 [9468, 239, 120, 9468, 237, 120]

O: 🇧🇸 [9468, 229, 100, 9468, 229, 116]
N: 🙅🏽 [9468, 247, 227, 9468, 237, 121]

O: 🇬🇷 [9468, 229, 105, 9468, 229, 115]
N: 🧕🏿 [9468, 100, 243, 9468, 237, 123]

O: 👼🏼 [9468, 239, 120, 9468, 237, 120]
N: 🏴󠁧󠁢󠁥󠁮󠁧󠁿 [9468, 237, 112, 175, 16050, 100, 175, 16050, 95, 175, 16050, 98, 175, 16050, 106, 175, 16050, 100, 175, 16050, 123]

O: 🧑‍✈️ [9468, 100, 239, 102470, 38798, 230, 31643]
N: 🧑‍✈️ [9468, 100, 239, 102470, 38798, 230, 31643]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.33s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.79s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.69s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.37s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.84s/it]
Processing depth (0, 4, 6, 7):   4%|▍         | 4/100 [01:45<34:35, 21.62s/it]2025-01-22 05:54:38.135 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary went back to the kitchen.
2025-01-22 05:54:38.136 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 37) -->  went back to the kitchen.
2025-01-22 05:54:38.136 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary went back to the office.
2025-01-22 05:54:38.154 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3626, 3632) --> . Mary went back to the
2025-01-22 05:54:38.154 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary dropped the football.
2025-01-22 05:54:38.177 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4756, 4760) -->  Mary dropped the football
2025-01-22 05:54:38.177 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the hallway.
2025-01-22 05:54:38.206 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5708, 5713) --> . John went to the
2025-01-22 05:54:38.206 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the bedroom.
2025-01-22 05:54:38.227 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4351, 4356) --> . John travelled to the
2025-01-22 05:54:38.227 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the office.
2025-01-22 05:54:38.234 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1390, 1395) --> . Daniel moved to the
2025-01-22 05:54:38.234 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the garden.
2025-01-22 05:54:38.235 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (112, 117) --> . Sandra moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:54:39.100 | INFO     | test_jbb_embedding:begin_test:693 - Mary dropped the football.<|eot_id|>
2025-01-22 05:54:39.100 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8156])
2025-01-22 05:54:41.690 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [340.04613095238096, 28.240106783919597, 224.34166666666667, 27.071886926012557, 21.46951941287879], 'topk_indices': array([3633, 8138, 8142,   24, 3721, 8141, 8139, 8154, 3722, 8145,   14,
       8152, 4760, 8147, 8144, 8143, 8146, 4759, 8151,    0]), 'topk_tokens': ['.', 'Question', ' the', '\n\n', ' I', ' was', ':', '<|end_header_id|>', ' had', ' the', '\n', '<|start_header_id|>', '.', '?', ' before', ' football', ' office', ' football', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [353.9375, 290.5625, 740.8125, 62.14375]}, 'weight': {'score': [21.45498511904762, 23.26908743412183, 20.313541666666666, 23.279235080943, 29.46875], 'topk_indices': array([3291, 3264, 3136, 3184, 7429, 7391, 1480, 1418, 4290, 4274, 5163,
       5102, 7112, 7168, 3473, 3447, 4879, 4904, 4956, 4927]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.84375, 20.708333333333332, 27.013671875, 18.6375]}, 'saliency': {'score': [2.067202613467262, 0.15741124639968132, 1.240576171875, 0.1504737734721239, 0.16008296157374527], 'topk_indices': array([3671, 3670, 4356, 3632, 4756, 8054, 3721,   40, 8141,  113, 8140,
       8147, 4757, 3722,   39, 8138, 8144, 8146, 8143, 4759]), 'topk_tokens': [' ever', ' had', ' bedroom', ' office', ' Mary', ' location', ' I', '\n\n\n', ' was', ' Sandra', ' Where', '?', ' dropped', ' had', '***', 'Question', ' before', ' office', ' football', ' football'], 'evidence_proportions': [1.8885904947916667, 1.48681640625, 5.3828125, 0.3255126953125]}}, 'pred_res': 'Mary dropped the football.<|eot_id|>', 'score': 0}
2025-01-22 05:54:41.702 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:54:41.702 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-76_pid-4_0-4-6-7.pkl | len: 3 |  size: 2.02 KB
Processing depth (0, 4, 6, 7):   5%|▌         | 5/100 [01:48<33:42, 21.29s/it]Processing depth (0, 4, 6, 7):   5%|▌         | 5/100 [01:48<34:28, 21.77s/it]
2025-01-22 05:54:41.764 | INFO     | __main__:<module>:82 - Selected idx: 77
2025-01-22 05:54:41.764 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the location prior to the place where the milk was discarded, left or dropped?
2025-01-22 05:54:41.764 | INFO     | __main__:<module>:84 - Answer: kitchen
2025-01-22 05:54:41.764 | INFO     | __main__:<module>:85 - Tag: 4-hop
2025-01-22 05:54:41.764 | INFO     | __main__:<module>:86 - Needle: [' John travelled to the bedroom.', ' Mary went back to the kitchen.', ' Daniel moved to the office.', ' Sandra moved to the garden.', ' Mary got the milk.', ' Mary went back to the office.', ' Mary dropped the milk.', ' John went to the hallway.']
2025-01-22 05:54:41.764 | INFO     | __main__:<module>:87 - Real Needle: [' Mary went back to the kitchen.', ' Mary got the milk.', ' Mary went back to the office.', ' Mary dropped the milk.', ' John went to the hallway.']
2025-01-22 05:54:41.764 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['👩🏾\u200d🦲', '💆🏾\u200d♂', '🤶🏻', '🏃🏽\u200d♀\u200d➡', '🥠', '🥿', '🇳🇬', '🧝🏽\u200d♀', '🔷', '🕵🏽\u200d♂']
emoji:
O: 👩🏾‍🦲 [9468, 239, 102, 9468, 237, 122, 102470, 9468, 99, 110]
N: 💆🏾‍♂ [93273, 228, 9468, 237, 122, 102470, 17245, 224]

O: 💆🏾‍♂ [93273, 228, 9468, 237, 122, 102470, 17245, 224]
N: 🥿 [9468, 59198]

O: 🤶🏻 [9468, 97, 114, 9468, 237, 119]
N: 🇳🇬 [9468, 229, 111, 9468, 229, 105]

O: 🏃🏽‍♀‍➡ [9468, 237, 225, 9468, 237, 121, 102470, 32990, 102470, 98115, 94]
N: 🤶🏻 [9468, 97, 114, 9468, 237, 119]

O: 🥠 [9468, 98, 254]
N: 🥠 [9468, 98, 254]

O: 🥿 [9468, 59198]
N: 👩🏾‍🦲 [9468, 239, 102, 9468, 237, 122, 102470, 9468, 99, 110]

O: 🇳🇬 [9468, 229, 111, 9468, 229, 105]
N: 🧝🏽‍♀ [9468, 100, 251, 9468, 237, 121, 102470, 32990]

O: 🧝🏽‍♀ [9468, 100, 251, 9468, 237, 121, 102470, 32990]
N: 🏃🏽‍♀‍➡ [9468, 237, 225, 9468, 237, 121, 102470, 32990, 102470, 98115, 94]

O: 🔷 [9468, 242, 115]
N: 🔷 [9468, 242, 115]

O: 🕵🏽‍♂ [9468, 243, 113, 9468, 237, 121, 102470, 17245, 224]
N: 🕵🏽‍♂ [9468, 243, 113, 9468, 237, 121, 102470, 17245, 224]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.83s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.83s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.45s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.11s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.68s/it]
Processing depth (1, 3, 4, 6, 8):   0%|          | 0/100 [00:16<?, ?it/s]2025-01-22 05:54:58.519 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary went back to the kitchen.
2025-01-22 05:54:58.523 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (782, 788) -->  Mary went back to the kitchen
2025-01-22 05:54:58.523 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary got the milk.
2025-01-22 05:54:58.537 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2885, 2889) -->  Mary got the milk
2025-01-22 05:54:58.537 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the office.
2025-01-22 05:54:58.542 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (783, 789) -->  went back to the kitchen.
2025-01-22 05:54:58.542 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary dropped the milk.
2025-01-22 05:54:58.567 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4845, 4849) -->  Mary dropped the milk
2025-01-22 05:54:58.568 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went to the hallway.
2025-01-22 05:54:58.602 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6597, 6602) --> . John went to the
2025-01-22 05:54:58.602 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the bedroom.
2025-01-22 05:54:58.624 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3595, 3600) --> . John travelled to the
2025-01-22 05:54:58.624 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the office.
2025-01-22 05:54:58.658 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6883, 6888) --> . Daniel moved to the
2025-01-22 05:54:58.658 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the garden.
2025-01-22 05:54:58.695 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (7023, 7028) --> . Sandra moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:54:59.457 | INFO     | test_jbb_embedding:begin_test:693 - the kitchen<|eot_id|>
2025-01-22 05:54:59.457 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8172])
2025-01-22 05:55:01.666 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [91.3903125, 6.293683103975535, 19.993229166666666, 6.006908804548249, 5.678557894123134], 'topk_indices': array([8145,    9,    1, 8164,   23, 8146, 8136, 8061,   28, 8144,   24,
       8166, 8051,   14, 8171,  787, 8170,    0, 8167, 8168]), 'topk_tokens': ['Question', ':', '<|start_header_id|>', '?\n', '4', ':', '.', ' location', '<|end_header_id|>', '.\n\n', '\n\n', ':', '.\n\n', '\n', '\n\n', ' kitchen', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [131.88541666666666, 91.4140625, 138.64583333333334, 55.5703125, 14.7265625]}, 'weight': {'score': [23.1328125, 23.264877675840978, 20.313541666666666, 23.27072545328826, 29.204057835820894], 'topk_indices': array([3306, 3279, 3199, 3151, 7432, 7394, 1448, 1510, 4293, 4277, 5154,
       5093, 7157, 7101, 3462, 3488, 4947, 4895, 4870, 4918]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [24.69921875, 26.283203125, 20.84375, 26.685546875, 18.6375]}, 'saliency': {'score': [0.58521484375, 0.03323296689841361, 0.10631205240885416, 0.03140189951009815, 0.04197174755494986], 'topk_indices': array([8164,    8,   23, 8141, 8135,   20, 2888, 8132,   24, 8017, 8144,
       8159, 8151, 8051, 8145, 8169, 8165, 8171, 8061,  787]), 'topk_tokens': ['?\n', ' Date', '4', ' else', ' directly', ' Jul', ' milk', ' return', '\n\n', ' context', '.\n\n', ' discarded', ' prior', '.\n\n', 'Question', 'assistant', 'Answer', '\n\n', ' location', ' kitchen'], 'evidence_proportions': [0.8904622395833334, 0.59765625, 0.8388671875, 0.366607666015625, 0.0794677734375]}}, 'pred_res': 'the kitchen<|eot_id|>', 'score': 100}
2025-01-22 05:55:01.672 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:55:01.673 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-77_pid-0_1-3-4-6-8.pkl | len: 3 |  size: 2.07 KB
Processing depth (1, 3, 4, 6, 8):   1%|          | 1/100 [00:19<32:35, 19.75s/it]is_0k: False
your chose emoji: ['👩\u200d🎓', '🤞🏻', '🤾🏼\u200d♀️', '🚵🏻', '👈🏾', '🙃', '🚶\u200d♂️\u200d➡', '🚶🏽', '⛹🏿', '👰🏼\u200d♀']
emoji:
O: 👩‍🎓 [9468, 239, 102, 102470, 9468, 236, 241]
N: 🤾🏼‍♀️ [9468, 97, 122, 9468, 237, 120, 102470, 32990, 31643]

O: 🤞🏻 [9468, 97, 252, 9468, 237, 119]
N: 🤞🏻 [9468, 97, 252, 9468, 237, 119]

O: 🤾🏼‍♀️ [9468, 97, 122, 9468, 237, 120, 102470, 32990, 31643]
N: 👈🏾 [9468, 239, 230, 9468, 237, 122]

O: 🚵🏻 [9468, 248, 113, 9468, 237, 119]
N: 🙃 [9468, 247, 225]

O: 👈🏾 [9468, 239, 230, 9468, 237, 122]
N: 🚵🏻 [9468, 248, 113, 9468, 237, 119]

O: 🙃 [9468, 247, 225]
N: 🚶🏽 [9468, 248, 114, 9468, 237, 121]

O: 🚶‍♂️‍➡ [9468, 248, 114, 102470, 17245, 224, 31643, 102470, 98115, 94]
N: 🚶‍♂️‍➡ [9468, 248, 114, 102470, 17245, 224, 31643, 102470, 98115, 94]

O: 🚶🏽 [9468, 248, 114, 9468, 237, 121]
N: 👩‍🎓 [9468, 239, 102, 102470, 9468, 236, 241]

O: ⛹🏿 [158, 249, 117, 9468, 237, 123]
N: ⛹🏿 [158, 249, 117, 9468, 237, 123]

O: 👰🏼‍♀ [9468, 239, 108, 9468, 237, 120, 102470, 32990]
N: 👰🏼‍♀ [9468, 239, 108, 9468, 237, 120, 102470, 32990]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.76s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.94s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.71s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.22s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.80s/it]
Processing depth (0, 2, 6, 7, 9):   1%|          | 1/100 [00:36<32:35, 19.75s/it]2025-01-22 05:55:18.653 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary went back to the kitchen.
2025-01-22 05:55:18.653 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 37) -->  went back to the kitchen.
2025-01-22 05:55:18.653 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary got the milk.
2025-01-22 05:55:18.661 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1584, 1588) -->  got the milk.
2025-01-22 05:55:18.662 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the office.
2025-01-22 05:55:18.685 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4665, 4671) --> . Mary went back to the
2025-01-22 05:55:18.685 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary dropped the milk.
2025-01-22 05:55:18.715 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5601, 5605) -->  Mary dropped the milk
2025-01-22 05:55:18.715 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went to the hallway.
2025-01-22 05:55:18.750 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7146, 7151) -->  John went to the hallway
2025-01-22 05:55:18.751 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the bedroom.
2025-01-22 05:55:18.767 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3411, 3416) --> . John travelled to the
2025-01-22 05:55:18.767 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the office.
2025-01-22 05:55:18.804 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6743, 6748) --> . Daniel moved to the
2025-01-22 05:55:18.804 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the garden.
2025-01-22 05:55:18.838 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6967, 6972) --> . Sandra moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:55:19.596 | INFO     | test_jbb_embedding:begin_test:693 - the kitchen<|eot_id|>
2025-01-22 05:55:19.596 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8206])
2025-01-22 05:55:21.834 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [544.9525, 41.64325740041418, 141.59583333333333, 39.91942098176031, 47.720703125], 'topk_indices': array([5602, 1586, 5601, 8193, 8191,  115, 5540,  196,   80, 5604, 1587,
       5605,   77, 5600,   78, 8201,   79,  116,    0, 8202]), 'topk_tokens': [' dropped', ' milk', ' Mary', ' discarded', ' milk', ' P', ' One', 'ION', 'ER', ' milk', '.', '.', ' P', '.', 'ION', '<|eot_id|>', 'E', 'ION', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [611.0833333333334, 950.625, 275.5833333333333, 1054.75, 56.4625]}, 'weight': {'score': [22.46875, 23.298643257400414, 20.313541666666666, 23.306664294895334, 29.64657738095238], 'topk_indices': array([3367, 3394, 3287, 3239, 7474, 7436, 1524, 1462, 4352, 4368, 5182,
       5243, 7213, 7157, 3556, 3582, 4984, 5007, 5036, 4959]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.84375, 20.5, 20.708333333333332, 26.685546875, 24.7328125]}, 'saliency': {'score': [3.14793212890625, 0.23285118063063406, 0.7841715494791667, 0.22291767233835613, 0.3595252264113653], 'topk_indices': array([8185,   75,  115, 5600, 5599,    0,   35,   80, 5602, 5540,  196,
       1586, 5601,   77, 8191, 8193, 5604,   79,   78,  116]), 'topk_tokens': [' prior', 'ENCES', ' P', '.', ' St', '<|begin_of_text|>', ' kitchen', 'ER', ' dropped', ' One', 'ION', ' milk', ' Mary', ' P', ' milk', ' discarded', ' milk', 'E', 'ION', 'ION'], 'evidence_proportions': [3.3444010416666665, 4.77001953125, 1.4151204427083333, 7.29443359375, 0.37667236328125]}}, 'pred_res': 'the kitchen<|eot_id|>', 'score': 100}
2025-01-22 05:55:21.846 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:55:21.847 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-77_pid-1_0-2-6-7-9.pkl | len: 3 |  size: 2.02 KB
Processing depth (0, 2, 6, 7, 9):   2%|▏         | 2/100 [00:39<32:39, 20.00s/it]is_0k: False
your chose emoji: ['🧏🏾', '🥌', '💑🏼', '👨🏾\u200d❤\u200d💋\u200d👨🏿', '👨\u200d🦯\u200d➡', '🇵🇲', '🧎\u200d♀\u200d➡️', '🤦🏿\u200d♂', '🧚🏾\u200d♀', '🧜🏼\u200d♂️']
emoji:
O: 🧏🏾 [9468, 100, 237, 9468, 237, 122]
N: 💑🏼 [93273, 239, 9468, 237, 120]

O: 🥌 [9468, 98, 234]
N: 🤦🏿‍♂ [9468, 97, 99, 9468, 237, 123, 102470, 17245, 224]

O: 💑🏼 [93273, 239, 9468, 237, 120]
N: 🧚🏾‍♀ [9468, 100, 248, 9468, 237, 122, 102470, 32990]

O: 👨🏾‍❤‍💋‍👨🏿 [9468, 239, 101, 9468, 237, 122, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 123]
N: 🇵🇲 [9468, 229, 113, 9468, 229, 110]

O: 👨‍🦯‍➡ [9468, 239, 101, 102470, 9468, 99, 107, 102470, 98115, 94]
N: 🧎‍♀‍➡️ [9468, 100, 236, 102470, 32990, 102470, 98115, 94, 31643]

O: 🇵🇲 [9468, 229, 113, 9468, 229, 110]
N: 👨🏾‍❤‍💋‍👨🏿 [9468, 239, 101, 9468, 237, 122, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 123]

O: 🧎‍♀‍➡️ [9468, 100, 236, 102470, 32990, 102470, 98115, 94, 31643]
N: 👨‍🦯‍➡ [9468, 239, 101, 102470, 9468, 99, 107, 102470, 98115, 94]

O: 🤦🏿‍♂ [9468, 97, 99, 9468, 237, 123, 102470, 17245, 224]
N: 🧏🏾 [9468, 100, 237, 9468, 237, 122]

O: 🧚🏾‍♀ [9468, 100, 248, 9468, 237, 122, 102470, 32990]
N: 🥌 [9468, 98, 234]

O: 🧜🏼‍♂️ [9468, 100, 250, 9468, 237, 120, 102470, 17245, 224, 31643]
N: 🧜🏼‍♂️ [9468, 100, 250, 9468, 237, 120, 102470, 17245, 224, 31643]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:11,  3.99s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.78s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.55s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  2.97s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.53s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 1, 2, 3, 9):   2%|▏         | 2/100 [00:55<32:39, 20.00s/it]2025-01-22 05:55:37.832 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary went back to the kitchen.
2025-01-22 05:55:37.833 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 37) -->  went back to the kitchen.
2025-01-22 05:55:37.833 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary got the milk.
2025-01-22 05:55:37.838 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (903, 907) -->  Mary got the milk
2025-01-22 05:55:37.838 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the office.
2025-01-22 05:55:37.848 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1883, 1889) --> . Mary went back to the
2025-01-22 05:55:37.849 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary dropped the milk.
2025-01-22 05:55:37.864 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2915, 2919) -->  Mary dropped the milk
2025-01-22 05:55:37.864 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went to the hallway.
2025-01-22 05:55:37.901 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7126, 7131) -->  John went to the hallway
2025-01-22 05:55:37.902 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the bedroom.
2025-01-22 05:55:37.921 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3579, 3584) --> . John travelled to the
2025-01-22 05:55:37.922 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the office.
2025-01-22 05:55:37.959 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6807, 6812) --> . Daniel moved to the
2025-01-22 05:55:37.959 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the garden.
2025-01-22 05:55:37.993 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6947, 6952) --> . Sandra moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:55:43.007 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 05:55:43.008 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8184])
2025-01-22 05:55:46.101 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [90.55390625, 6.798091677354342, 37.883854166666666, 6.4838432666932615, 3.7655848672945207], 'topk_indices': array([8176,    9,   25, 8029, 8178, 8148,    1, 8156, 8063, 8073,   28,
         24,   23,   14, 8183,   35, 8182,    0, 8180, 8179]), 'topk_tokens': ['?\n', ':', '<|eot_id|>', ' context', ':', '.', '<|start_header_id|>', '.\n\n', '.\n\n', ' location', '<|end_header_id|>', '\n\n', '4', '\n', '\n\n', ' kitchen', '<|end_header_id|>', '<|begin_of_text|>', '<|start_header_id|>', '<|eot_id|>'], 'evidence_proportions': [172.61458333333334, 79.234375, 100.07291666666667, 67.015625, 8.54453125]}, 'weight': {'score': [23.3940625, 23.28114694027116, 20.313541666666666, 23.286264307413774, 29.622003424657535], 'topk_indices': array([3309, 3336, 3229, 3181, 7416, 7454, 1473, 1411, 4316, 4300, 5131,
       5192, 7193, 7137, 3518, 3492, 4985, 4956, 4913, 4888]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.84375, 26.283203125, 20.708333333333332, 26.685546875, 24.7328125]}, 'saliency': {'score': [0.53118896484375, 0.03692040979840372, 0.2045654296875, 0.03509502755040199, 0.02865041445379388], 'topk_indices': array([  22,    8,   16, 8147, 8171, 8144, 8156, 8063, 8163,   19, 8157,
         24, 8177, 8181,   23,   20, 8183, 8029, 8073,   35]), 'topk_tokens': ['202', ' Date', ' Date', ' directly', ' discarded', ' return', '.\n\n', '.\n\n', ' prior', '26', 'Question', '\n\n', 'Answer', 'assistant', '4', ' Jul', '\n\n', ' context', ' location', ' kitchen'], 'evidence_proportions': [1.048095703125, 0.529510498046875, 0.4708251953125, 0.43902587890625, 0.05841064453125]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 100}
2025-01-22 05:55:46.108 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:55:46.108 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-77_pid-2_0-1-2-3-9.pkl | len: 3 |  size: 2.08 KB
Processing depth (0, 1, 2, 3, 9):   3%|▎         | 3/100 [01:04<35:28, 21.95s/it]is_0k: False
your chose emoji: ['👨🏾\u200d🍳', '👿', '👩🏼\u200d❤\u200d💋\u200d👨🏼', '🤸🏻\u200d♂️', '⚰', '📪', '🏊🏾\u200d♀️', '💏🏻', '🕝', '🚵🏽\u200d♀️']
emoji:
O: 👨🏾‍🍳 [9468, 239, 101, 9468, 237, 122, 102470, 9468, 235, 111]
N: 👩🏼‍❤‍💋‍👨🏼 [9468, 239, 102, 9468, 237, 120, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 120]

O: 👿 [9468, 239, 123]
N: 🏊🏾‍♀️ [9468, 237, 232, 9468, 237, 122, 102470, 32990, 31643]

O: 👩🏼‍❤‍💋‍👨🏼 [9468, 239, 102, 9468, 237, 120, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 120]
N: ⚰ [158, 248, 108]

O: 🤸🏻‍♂️ [9468, 97, 116, 9468, 237, 119, 102470, 17245, 224, 31643]
N: 🕝 [9468, 243, 251]

O: ⚰ [158, 248, 108]
N: 🤸🏻‍♂️ [9468, 97, 116, 9468, 237, 119, 102470, 17245, 224, 31643]

O: 📪 [9468, 241, 103]
N: 📪 [9468, 241, 103]

O: 🏊🏾‍♀️ [9468, 237, 232, 9468, 237, 122, 102470, 32990, 31643]
N: 👨🏾‍🍳 [9468, 239, 101, 9468, 237, 122, 102470, 9468, 235, 111]

O: 💏🏻 [93273, 237, 9468, 237, 119]
N: 💏🏻 [93273, 237, 9468, 237, 119]

O: 🕝 [9468, 243, 251]
N: 👿 [9468, 239, 123]

O: 🚵🏽‍♀️ [9468, 248, 113, 9468, 237, 121, 102470, 32990, 31643]
N: 🚵🏽‍♀️ [9468, 248, 113, 9468, 237, 121, 102470, 32990, 31643]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.33s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.54s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.70s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.39s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.82s/it]
Processing depth (1, 3, 5, 8, 9):   3%|▎         | 3/100 [01:21<35:28, 21.95s/it]2025-01-22 05:56:03.127 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary went back to the kitchen.
2025-01-22 05:56:03.132 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (895, 901) --> . Mary went back to the
2025-01-22 05:56:03.132 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary got the milk.
2025-01-22 05:56:03.146 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2863, 2867) -->  Mary got the milk
2025-01-22 05:56:03.146 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the office.
2025-01-22 05:56:03.151 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (895, 901) --> . Mary went back to the
2025-01-22 05:56:03.151 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary dropped the milk.
2025-01-22 05:56:03.186 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6609, 6613) -->  Mary dropped the milk
2025-01-22 05:56:03.186 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went to the hallway.
2025-01-22 05:56:03.224 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7341, 7346) --> . John went to the
2025-01-22 05:56:03.224 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the bedroom.
2025-01-22 05:56:03.243 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3516, 3521) -->  John travelled to the bedroom
2025-01-22 05:56:03.243 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the office.
2025-01-22 05:56:03.281 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6889, 6894) --> . Daniel moved to the
2025-01-22 05:56:03.282 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the garden.
2025-01-22 05:56:03.316 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (7035, 7040) --> . Sandra moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:56:04.082 | INFO     | test_jbb_embedding:begin_test:693 - the office<|eot_id|>
2025-01-22 05:56:04.082 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8162])
2025-01-22 05:56:06.304 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [547.37, 32.24762323943662, 203.4, 30.34665769230769, 16.392956149193548], 'topk_indices': array([8147, 8142,   14, 8041,  898, 8149, 6611,  895,  897,  902, 6610,
        899, 6613, 6612, 2866,  901, 2867,    0, 8158, 8157]), 'topk_tokens': [' milk', ' to', '\n', '.\n\n', ' back', ' discarded', ' the', '.', ' went', '.', ' dropped', ' to', '.', ' milk', ' milk', ' kitchen', '.', '<|begin_of_text|>', '<|start_header_id|>', '<|eot_id|>'], 'evidence_proportions': [682.5833333333334, 592.5625, 682.5833333333334, 730.0, 40.6]}, 'weight': {'score': [22.1425, 23.26614742804654, 22.122395833333332, 23.271716346153845, 29.766633064516128], 'topk_indices': array([3320, 3293, 3177, 3129, 7364, 7402, 1406, 1468, 4305, 4289, 5100,
       5161, 7135, 7079, 3476, 3502, 4902, 4925, 4954, 4877]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.708333333333332, 26.283203125, 20.708333333333332, 26.685546875, 18.6375]}, 'saliency': {'score': [3.13265625, 0.17959983064145743, 1.2642578125, 0.1685110576923077, 0.1208830802671371], 'topk_indices': array([ 899, 6891, 8041, 3520, 6609, 2864, 8145, 8144, 8135,  898,  896,
       8141, 8147,  257,  897, 8149, 6610, 6612, 2866,  901]), 'topk_tokens': [' to', ' moved', '.\n\n', ' bedroom', ' Mary', ' got', ' where', ' place', 'Question', ' back', ' Mary', ' prior', ' milk', 'hue', ' went', ' discarded', ' dropped', ' milk', ' milk', ' kitchen'], 'evidence_proportions': [3.5037434895833335, 3.949951171875, 3.5037434895833335, 4.865234375, 0.2021484375]}}, 'pred_res': 'the office<|eot_id|>', 'score': 0}
2025-01-22 05:56:06.309 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:56:06.309 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-77_pid-3_1-3-5-8-9.pkl | len: 3 |  size: 2.04 KB
Processing depth (1, 3, 5, 8, 9):   4%|▍         | 4/100 [01:24<34:00, 21.26s/it]is_0k: False
your chose emoji: ['🧎🏻\u200d♂\u200d➡️', '🇦🇪', '😠', '🙎🏾', '💖', '🧍🏾\u200d♀', '☠', '🧑🏿\u200d❤\u200d💋\u200d🧑🏾', '↗', '🏕']
emoji:
O: 🧎🏻‍♂‍➡️ [9468, 100, 236, 9468, 237, 119, 102470, 17245, 224, 102470, 98115, 94, 31643]
N: 🇦🇪 [9468, 229, 99, 9468, 229, 103]

O: 🇦🇪 [9468, 229, 99, 9468, 229, 103]
N: 😠 [76460, 254]

O: 😠 [76460, 254]
N: ↗ [27017, 245]

O: 🙎🏾 [9468, 247, 236, 9468, 237, 122]
N: 🧑🏿‍❤‍💋‍🧑🏾 [9468, 100, 239, 9468, 237, 123, 102470, 121643, 102470, 93273, 233, 102470, 9468, 100, 239, 9468, 237, 122]

O: 💖 [93273, 244]
N: 💖 [93273, 244]

O: 🧍🏾‍♀ [9468, 100, 235, 9468, 237, 122, 102470, 32990]
N: 🧍🏾‍♀ [9468, 100, 235, 9468, 237, 122, 102470, 32990]

O: ☠ [18107, 254]
N: 🧎🏻‍♂‍➡️ [9468, 100, 236, 9468, 237, 119, 102470, 17245, 224, 102470, 98115, 94, 31643]

O: 🧑🏿‍❤‍💋‍🧑🏾 [9468, 100, 239, 9468, 237, 123, 102470, 121643, 102470, 93273, 233, 102470, 9468, 100, 239, 9468, 237, 122]
N: 🙎🏾 [9468, 247, 236, 9468, 237, 122]

O: ↗ [27017, 245]
N: ☠ [18107, 254]

O: 🏕 [9468, 237, 243]
N: 🏕 [9468, 237, 243]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.76s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.57s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.44s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.08s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.62s/it]
Processing depth (0, 2, 3, 6, 8):   4%|▍         | 4/100 [01:40<34:00, 21.26s/it]2025-01-22 05:56:22.650 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary went back to the kitchen.
2025-01-22 05:56:22.651 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 37) -->  went back to the kitchen.
2025-01-22 05:56:22.651 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary got the milk.
2025-01-22 05:56:22.661 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1785, 1789) -->  Mary got the milk
2025-01-22 05:56:22.661 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the office.
2025-01-22 05:56:22.677 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2851, 2857) --> . Mary went back to the
2025-01-22 05:56:22.677 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary dropped the milk.
2025-01-22 05:56:22.699 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4771, 4775) -->  Mary dropped the milk
2025-01-22 05:56:22.699 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went to the hallway.
2025-01-22 05:56:22.736 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6595, 6600) --> . John went to the
2025-01-22 05:56:22.736 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John travelled to the bedroom.
2025-01-22 05:56:22.755 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3574, 3579) --> . John travelled to the
2025-01-22 05:56:22.755 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the office.
2025-01-22 05:56:22.793 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6881, 6886) --> . Daniel moved to the
2025-01-22 05:56:22.793 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the garden.
2025-01-22 05:56:22.831 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (7021, 7026) --> . Sandra moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:56:23.633 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 05:56:23.633 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8168])
2025-01-22 05:56:25.883 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [216.82, 17.052449210622935, 64.95625, 16.34986087197147, 8.758458533653846], 'topk_indices': array([ 107,   14,   69,  182, 8140,  106, 8155,  185, 8153,   68, 1789,
         36,   35, 8141, 8142, 1788, 8163,  186,    0, 8164]), 'topk_tokens': ['E', '\n', 'E', 'G', '.\n\n', 'ION', ' discarded', ' P', ' milk', 'ION', '.', '.', ' kitchen', 'Question', ':', ' milk', '<|eot_id|>', 'ION', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [341.1041666666667, 327.4375, 156.90625, 231.171875, 39.6]}, 'weight': {'score': [22.175, 23.264200373271326, 20.313541666666666, 23.272992636207107, 29.337259615384614], 'topk_indices': array([3310, 3337, 3182, 3230, 7394, 7432, 1468, 1406, 4301, 4317, 5190,
       5129, 7099, 7155, 3519, 3493, 4919, 4971, 4894, 4942]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.84375, 26.283203125, 20.708333333333332, 26.685546875, 18.6375]}, 'saliency': {'score': [1.27668212890625, 0.09532319963992321, 0.36077880859375, 0.09120122111748248, 0.06525691105769231], 'topk_indices': array([ 182,  166, 1786,   40,  185,   30,  113, 8151,   31, 1808,  106,
       4774, 8147,   68, 8153,   35, 8155, 8141, 1788,  186]), 'topk_tokens': ['G', 'ION', ' got', '\n\n\n', ' P', 'Mary', ' PA', ' where', ' went', 'itol', 'ION', ' milk', ' prior', 'ION', ' milk', ' kitchen', ' discarded', 'Question', ' milk', 'ION'], 'evidence_proportions': [1.8384602864583333, 2.19091796875, 0.814697265625, 1.542236328125, 0.21309814453125]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 100}
2025-01-22 05:56:25.891 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:56:25.891 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-77_pid-4_0-2-3-6-8.pkl | len: 3 |  size: 2.01 KB
Processing depth (0, 2, 3, 6, 8):   5%|▌         | 5/100 [01:43<32:42, 20.65s/it]Processing depth (0, 2, 3, 6, 8):   5%|▌         | 5/100 [01:44<32:56, 20.80s/it]
2025-01-22 05:56:25.941 | INFO     | __main__:<module>:82 - Selected idx: 78
2025-01-22 05:56:25.941 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the milk before the hallway? 
2025-01-22 05:56:25.941 | INFO     | __main__:<module>:84 - Answer: office
2025-01-22 05:56:25.941 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 05:56:25.941 | INFO     | __main__:<module>:86 - Needle: [' Sandra moved to the garden.', ' John moved to the office.', ' Daniel moved to the office.', ' Mary travelled to the office.', ' Mary moved to the garden.', ' Daniel took the milk there.', ' John went back to the hallway.', ' Mary went back to the hallway.', ' John put down the milk.', ' Daniel left the milk.']
2025-01-22 05:56:25.941 | INFO     | __main__:<module>:87 - Real Needle: [' John moved to the office.', ' John went back to the hallway.', ' John put down the milk.', ' Daniel left the milk.']
2025-01-22 05:56:25.941 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['\U0001faa9', '👩🏽\u200d❤\u200d💋\u200d👨🏽', '🙅🏾\u200d♀', '🗑️', '🏊🏿\u200d♀', '🪚', '🦀', '🗂', '🇸🇷', '🤹🏻\u200d♂']
emoji:
O: 🪩 [9468, 103, 102]
N: 🪩 [9468, 103, 102]

O: 👩🏽‍❤‍💋‍👨🏽 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 121]
N: 🗑️ [9468, 245, 239, 31643]

O: 🙅🏾‍♀ [9468, 247, 227, 9468, 237, 122, 102470, 32990]
N: 🏊🏿‍♀ [9468, 237, 232, 9468, 237, 123, 102470, 32990]

O: 🗑️ [9468, 245, 239, 31643]
N: 👩🏽‍❤‍💋‍👨🏽 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 121]

O: 🏊🏿‍♀ [9468, 237, 232, 9468, 237, 123, 102470, 32990]
N: 🗂 [9468, 245, 224]

O: 🪚 [9468, 103, 248]
N: 🇸🇷 [9468, 229, 116, 9468, 229, 115]

O: 🦀 [9468, 99, 222]
N: 🪚 [9468, 103, 248]

O: 🗂 [9468, 245, 224]
N: 🙅🏾‍♀ [9468, 247, 227, 9468, 237, 122, 102470, 32990]

O: 🇸🇷 [9468, 229, 116, 9468, 229, 115]
N: 🦀 [9468, 99, 222]

O: 🤹🏻‍♂ [9468, 97, 117, 9468, 237, 119, 102470, 17245, 224]
N: 🤹🏻‍♂ [9468, 97, 117, 9468, 237, 119, 102470, 17245, 224]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.76s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:10<00:10,  5.10s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.92s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.23s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.86s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (2, 3, 5, 6):   0%|          | 0/100 [00:17<?, ?it/s]2025-01-22 05:56:43.458 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John moved to the office.
2025-01-22 05:56:43.468 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2010, 2015) -->  cable. John moved to
2025-01-22 05:56:43.468 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the hallway.
2025-01-22 05:56:43.483 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2994, 3000) -->  John went back to the hallway
2025-01-22 05:56:43.483 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John put down the milk.
2025-01-22 05:56:43.504 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4269, 4274) --> . John put down the
2025-01-22 05:56:43.504 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the milk.
2025-01-22 05:56:43.531 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4810, 4814) -->  Daniel left the milk
2025-01-22 05:56:43.531 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the garden.
2025-01-22 05:56:43.535 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (751, 756) --> . Sandra moved to the
2025-01-22 05:56:43.535 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the office.
2025-01-22 05:56:43.545 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2012, 2017) -->  John moved to the office
2025-01-22 05:56:43.545 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary travelled to the office.
2025-01-22 05:56:43.557 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2471, 2476) --> . Mary travelled to the
2025-01-22 05:56:43.557 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the garden.
2025-01-22 05:56:43.562 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (752, 757) -->  Sandra moved to the garden
2025-01-22 05:56:43.562 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel took the milk there.
2025-01-22 05:56:43.567 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (815, 820) --> . Daniel took the milk
2025-01-22 05:56:43.567 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary went back to the hallway.
2025-01-22 05:56:43.586 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (2995, 3001) -->  went back to the hallway.
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:56:45.931 | INFO     | test_jbb_embedding:begin_test:693 - the office<|eot_id|>
2025-01-22 05:56:45.931 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8184])
2025-01-22 05:56:48.552 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [155.48125, 23.743813752137797, 246.0383064516129, 22.572839197910266, 23.062747579225352], 'topk_indices': array([   9, 8174, 8178, 8038, 8167, 8168,    3,    1, 8175, 8170, 8169,
         23,   24,   14, 8182, 8171, 8172,    0, 8179, 8180]), 'topk_tokens': [':', ' hallway', ':', ' context', ':', ' Where', '<|end_header_id|>', '<|start_header_id|>', '?', ' the', ' was', '4', '\n\n', '\n', '<|end_header_id|>', ' milk', ' before', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [155.6625, 155.96875, 195.4, 104.625]}, 'weight': {'score': [23.916015625, 23.277058392377228, 22.53125, 23.278329555931162, 29.517825704225352], 'topk_indices': array([3276, 3303, 3148, 3196, 7449, 7411, 1411, 1473, 4280, 4296, 5156,
       5217, 7132, 7188, 3492, 3466, 4933, 5010, 4958, 4981]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [23.3078125, 25.149739583333332, 21.00625, 26.462890625]}, 'saliency': {'score': [0.92821044921875, 0.12903300270660273, 1.4767042590725807, 0.12193265140019975, 0.16492386938820422], 'topk_indices': array([  19,   16,  756,  752, 8082,  820, 8176,   20,  819, 8175,   23,
       8169,   24, 8177, 8166, 8038, 8168, 8174, 8172, 8171]), 'topk_tokens': ['26', ' Date', ' garden', ' Sandra', ' location', ' there', ' \n', ' Jul', ' milk', '?', '4', ' was', '\n\n', 'Answer', 'Question', ' context', ' Where', ' hallway', ' before', ' milk'], 'evidence_proportions': [0.842919921875, 1.0704752604166667, 1.0466796875, 0.67333984375]}}, 'pred_res': 'the office<|eot_id|>', 'score': 100}
2025-01-22 05:56:48.557 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:56:48.557 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-78_pid-0_2-3-5-6.pkl | len: 3 |  size: 2.01 KB
Processing depth (2, 3, 5, 6):   1%|          | 1/100 [00:22<37:05, 22.48s/it]is_0k: False
your chose emoji: ['⛹️\u200d♀️', '👩🏿\u200d❤\u200d💋\u200d👩🏻', '🛑', '🇦🇬', '🙍🏾\u200d♀️', '\U0001fac5🏾', '🚔', '👨🏿\u200d🏭', '🇸🇱', '🪴']
emoji:
O: ⛹️‍♀️ [158, 249, 117, 31643, 102470, 32990, 31643]
N: 👨🏿‍🏭 [9468, 239, 101, 9468, 237, 123, 102470, 9468, 237, 255]

O: 👩🏿‍❤‍💋‍👩🏻 [9468, 239, 102, 9468, 237, 123, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 119]
N: 🇦🇬 [9468, 229, 99, 9468, 229, 105]

O: 🛑 [9468, 249, 239]
N: 👩🏿‍❤‍💋‍👩🏻 [9468, 239, 102, 9468, 237, 123, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 119]

O: 🇦🇬 [9468, 229, 99, 9468, 229, 105]
N: 🇸🇱 [9468, 229, 116, 9468, 229, 109]

O: 🙍🏾‍♀️ [9468, 247, 235, 9468, 237, 122, 102470, 32990, 31643]
N: 🚔 [9468, 248, 242]

O: 🫅🏾 [9468, 104, 227, 9468, 237, 122]
N: 🛑 [9468, 249, 239]

O: 🚔 [9468, 248, 242]
N: 🙍🏾‍♀️ [9468, 247, 235, 9468, 237, 122, 102470, 32990, 31643]

O: 👨🏿‍🏭 [9468, 239, 101, 9468, 237, 123, 102470, 9468, 237, 255]
N: ⛹️‍♀️ [158, 249, 117, 31643, 102470, 32990, 31643]

O: 🇸🇱 [9468, 229, 116, 9468, 229, 109]
N: 🫅🏾 [9468, 104, 227, 9468, 237, 122]

O: 🪴 [9468, 103, 112]
N: 🪴 [9468, 103, 112]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.48s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.71s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.59s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.24s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.74s/it]
Processing depth (2, 3, 7, 8):   1%|          | 1/100 [00:39<37:05, 22.48s/it]2025-01-22 05:57:05.356 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John moved to the office.
2025-01-22 05:57:05.366 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1813, 1818) --> . John moved to the
2025-01-22 05:57:05.366 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the hallway.
2025-01-22 05:57:05.381 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2909, 2915) --> . John went back to the
2025-01-22 05:57:05.381 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John put down the milk.
2025-01-22 05:57:05.409 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5645, 5650) --> . John put down the
2025-01-22 05:57:05.409 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the milk.
2025-01-22 05:57:05.441 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6564, 6568) -->  Daniel left the milk
2025-01-22 05:57:05.441 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the garden.
2025-01-22 05:57:05.445 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (751, 756) --> . Sandra moved to the
2025-01-22 05:57:05.445 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the office.
2025-01-22 05:57:05.454 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1814, 1819) -->  John moved to the office
2025-01-22 05:57:05.454 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary travelled to the office.
2025-01-22 05:57:05.465 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2225, 2230) --> . Mary travelled to the
2025-01-22 05:57:05.465 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the garden.
2025-01-22 05:57:05.469 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (752, 757) -->  Sandra moved to the garden
2025-01-22 05:57:05.469 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel took the milk there.
2025-01-22 05:57:05.473 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (815, 820) --> . Daniel took the milk
2025-01-22 05:57:05.473 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary went back to the hallway.
2025-01-22 05:57:05.488 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (2910, 2916) -->  John went back to the hallway
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:57:06.269 | INFO     | test_jbb_embedding:begin_test:693 - the office<|eot_id|>
2025-01-22 05:57:06.269 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8204])
2025-01-22 05:57:08.562 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [166.153125, 22.01765857299537, 180.2540322580645, 21.062657112201105, 17.851490162037038], 'topk_indices': array([8194, 8185,    1,    9, 8092, 8195, 8188, 8186, 8187, 8190, 8189,
         23,   14,   24, 8202, 8191, 8192,    0, 8200, 8199]), 'topk_tokens': [' hallway', '.\n\n', '<|start_header_id|>', ':', '.\n\n', '?', ' Where', 'Question', ':', ' the', ' was', '4', '\n', '\n\n', '<|end_header_id|>', ' milk', ' before', '<|begin_of_text|>', '<|start_header_id|>', '<|eot_id|>'], 'evidence_proportions': [122.1625, 140.46875, 220.35, 191.921875]}, 'weight': {'score': [21.285546875, 23.292824990860346, 23.153981854838708, 23.298275597792767, 29.546103395061728], 'topk_indices': array([3313, 3340, 3226, 3178, 7475, 7437, 1505, 1443, 4350, 4334, 5151,
       5212, 7158, 7214, 3522, 3496, 4953, 4976, 5005, 4928]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [18.88125, 20.0703125, 21.00625, 26.462890625]}, 'saliency': {'score': [0.897021484375, 0.11828430309662899, 1.1088709677419355, 0.11260889779563918, 0.1332866527416088], 'topk_indices': array([8185,    8, 8058,   22, 8092,   16, 8196,   19, 8102, 8195, 8197,
         20,   24,   23, 8189, 8188, 8194, 8186, 8192, 8191]), 'topk_tokens': ['.\n\n', ' Date', ' context', '202', '.\n\n', ' Date', ' \n', '26', ' location', '?', 'Answer', ' Jul', '\n\n', '4', ' was', ' Where', ' hallway', 'Question', ' before', ' milk'], 'evidence_proportions': [0.60654296875, 0.68359375, 1.16796875, 1.2415771484375]}}, 'pred_res': 'the office<|eot_id|>', 'score': 100}
2025-01-22 05:57:08.571 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:57:08.572 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-78_pid-1_2-3-7-8.pkl | len: 3 |  size: 1.99 KB
Processing depth (2, 3, 7, 8):   2%|▏         | 2/100 [00:42<34:20, 21.03s/it]is_0k: False
your chose emoji: ['🧑🏽\u200d🦰', '🤹🏽\u200d♀️', '🙅', '🤦🏿\u200d♂', '🧗', '🏋️\u200d♀', '🚶\u200d➡', '👩🏾\u200d❤️\u200d👨🏻', '\U0001faf2🏽', '👩🏾\u200d🦽\u200d➡']
emoji:
O: 🧑🏽‍🦰 [9468, 100, 239, 9468, 237, 121, 102470, 9468, 99, 108]
N: 👩🏾‍❤️‍👨🏻 [9468, 239, 102, 9468, 237, 122, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 119]

O: 🤹🏽‍♀️ [9468, 97, 117, 9468, 237, 121, 102470, 32990, 31643]
N: 🧗 [9468, 100, 245]

O: 🙅 [9468, 247, 227]
N: 🏋️‍♀ [9468, 237, 233, 31643, 102470, 32990]

O: 🤦🏿‍♂ [9468, 97, 99, 9468, 237, 123, 102470, 17245, 224]
N: 🚶‍➡ [9468, 248, 114, 102470, 98115, 94]

O: 🧗 [9468, 100, 245]
N: 🤦🏿‍♂ [9468, 97, 99, 9468, 237, 123, 102470, 17245, 224]

O: 🏋️‍♀ [9468, 237, 233, 31643, 102470, 32990]
N: 🫲🏽 [9468, 104, 110, 9468, 237, 121]

O: 🚶‍➡ [9468, 248, 114, 102470, 98115, 94]
N: 🧑🏽‍🦰 [9468, 100, 239, 9468, 237, 121, 102470, 9468, 99, 108]

O: 👩🏾‍❤️‍👨🏻 [9468, 239, 102, 9468, 237, 122, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 119]
N: 🤹🏽‍♀️ [9468, 97, 117, 9468, 237, 121, 102470, 32990, 31643]

O: 🫲🏽 [9468, 104, 110, 9468, 237, 121]
N: 🙅 [9468, 247, 227]

O: 👩🏾‍🦽‍➡ [9468, 239, 102, 9468, 237, 122, 102470, 9468, 99, 121, 102470, 98115, 94]
N: 👩🏾‍🦽‍➡ [9468, 239, 102, 9468, 237, 122, 102470, 9468, 99, 121, 102470, 98115, 94]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.74s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.80s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.19s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.73s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.39s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (1, 5, 6, 8):   2%|▏         | 2/100 [00:57<34:20, 21.03s/it]2025-01-22 05:57:24.016 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John moved to the office.
2025-01-22 05:57:24.020 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (825, 830) --> . John moved to the
2025-01-22 05:57:24.021 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the hallway.
2025-01-22 05:57:24.040 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3304, 3310) -->  Mary went back to the hallway
2025-01-22 05:57:24.040 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John put down the milk.
2025-01-22 05:57:24.066 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4895, 4900) --> . John put down the
2025-01-22 05:57:24.066 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the milk.
2025-01-22 05:57:24.100 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6616, 6620) -->  Daniel left the milk
2025-01-22 05:57:24.100 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the garden.
2025-01-22 05:57:24.104 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (629, 634) --> . Sandra moved to the
2025-01-22 05:57:24.104 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the office.
2025-01-22 05:57:24.109 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (826, 831) -->  John moved to the office
2025-01-22 05:57:24.109 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary travelled to the office.
2025-01-22 05:57:24.122 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2389, 2394) --> . Mary travelled to the
2025-01-22 05:57:24.122 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the garden.
2025-01-22 05:57:24.125 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (630, 635) -->  Sandra moved to the garden
2025-01-22 05:57:24.125 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel took the milk there.
2025-01-22 05:57:24.129 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (761, 766) --> . Daniel took the milk
2025-01-22 05:57:24.129 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary went back to the hallway.
2025-01-22 05:57:24.146 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (3303, 3309) --> . Mary went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:57:26.552 | INFO     | test_jbb_embedding:begin_test:693 - the office<|eot_id|>
2025-01-22 05:57:26.552 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8154])
2025-01-22 05:57:29.501 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [147.0796875, 17.446036660127515, 171.4828629032258, 16.53699105490438, 14.478445870535714], 'topk_indices': array([8135,    9, 8148, 8145, 8140,    3, 8139, 8042, 8008, 8153,    1,
       8141,   23, 8142,   14,   24, 8152, 8150,    0, 8149]), 'topk_tokens': ['.\n\n', ':', ':', '?', ' the', '<|end_header_id|>', ' was', '.\n\n', ' context', '\n\n', '<|start_header_id|>', ' milk', '4', ' before', '\n', '\n\n', '<|end_header_id|>', '<|start_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [208.125, 92.81770833333333, 112.5125, 195.375]}, 'weight': {'score': [23.00078125, 23.25320316331535, 22.294354838709676, 23.257493445404073, 29.452287946428573], 'topk_indices': array([3286, 3259, 3131, 3179, 7401, 7439, 1421, 1483, 4272, 4288, 5095,
       5156, 7122, 7178, 3475, 3449, 4949, 4866, 4891, 4920]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [18.88125, 25.787760416666668, 21.00625, 26.462890625]}, 'saliency': {'score': [0.8508056640625, 0.09525326386919905, 0.9795630670362904, 0.09000654555926126, 0.10925647190638951], 'topk_indices': array([ 765,  766, 7732, 8042, 8151,   16, 8139, 8153, 8123,   19, 8147,
       8138, 8136,   20,   23,   24, 8144, 8008, 8142, 8141]), 'topk_tokens': [' milk', ' there', 'inen', '.\n\n', 'assistant', ' Date', ' was', '\n\n', ' return', '26', 'Answer', ' Where', 'Question', ' Jul', '4', '\n\n', ' hallway', ' context', ' before', ' milk'], 'evidence_proportions': [0.97001953125, 0.65631103515625, 0.6070068359375, 1.29827880859375]}}, 'pred_res': 'the office<|eot_id|>', 'score': 100}
2025-01-22 05:57:29.505 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:57:29.505 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-78_pid-2_1-5-6-8.pkl | len: 3 |  size: 2.0 KB
Processing depth (1, 5, 6, 8):   3%|▎         | 3/100 [01:03<33:55, 20.99s/it]is_0k: False
your chose emoji: ['🕙', '💏🏾', '🦪', '♏', '💛', '🧑🏾\u200d🔬', '🙍🏽\u200d♀️', '🇮🇷', '🙎🏾\u200d♂️', '👃🏻']
emoji:
O: 🕙 [9468, 243, 247]
N: 💛 [93273, 249]

O: 💏🏾 [93273, 237, 9468, 237, 122]
N: 🕙 [9468, 243, 247]

O: 🦪 [9468, 99, 103]
N: 🙎🏾‍♂️ [9468, 247, 236, 9468, 237, 122, 102470, 17245, 224, 31643]

O: ♏ [17245, 237]
N: 🦪 [9468, 99, 103]

O: 💛 [93273, 249]
N: 🙍🏽‍♀️ [9468, 247, 235, 9468, 237, 121, 102470, 32990, 31643]

O: 🧑🏾‍🔬 [9468, 100, 239, 9468, 237, 122, 102470, 9468, 242, 105]
N: 💏🏾 [93273, 237, 9468, 237, 122]

O: 🙍🏽‍♀️ [9468, 247, 235, 9468, 237, 121, 102470, 32990, 31643]
N: 🧑🏾‍🔬 [9468, 100, 239, 9468, 237, 122, 102470, 9468, 242, 105]

O: 🇮🇷 [9468, 229, 106, 9468, 229, 115]
N: ♏ [17245, 237]

O: 🙎🏾‍♂️ [9468, 247, 236, 9468, 237, 122, 102470, 17245, 224, 31643]
N: 🇮🇷 [9468, 229, 106, 9468, 229, 115]

O: 👃🏻 [9468, 239, 225, 9468, 237, 119]
N: 👃🏻 [9468, 239, 225, 9468, 237, 119]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.89s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:10<00:10,  5.16s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.82s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.29s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.90s/it]
Processing depth (2, 3, 6, 7):   3%|▎         | 3/100 [01:20<33:55, 20.99s/it]2025-01-22 05:57:46.936 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John moved to the office.
2025-01-22 05:57:46.948 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2010, 2015) -->  cable. John moved to
2025-01-22 05:57:46.948 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the hallway.
2025-01-22 05:57:46.963 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3055, 3061) --> . John went back to the
2025-01-22 05:57:46.963 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John put down the milk.
2025-01-22 05:57:46.991 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4899, 4904) --> . John put down the
2025-01-22 05:57:46.991 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the milk.
2025-01-22 05:57:47.025 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5744, 5748) -->  Daniel left the milk
2025-01-22 05:57:47.025 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the garden.
2025-01-22 05:57:47.029 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (751, 756) --> . Sandra moved to the
2025-01-22 05:57:47.029 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the office.
2025-01-22 05:57:47.039 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2012, 2017) -->  John moved to the office
2025-01-22 05:57:47.039 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary travelled to the office.
2025-01-22 05:57:47.053 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2471, 2476) --> . Mary travelled to the
2025-01-22 05:57:47.053 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the garden.
2025-01-22 05:57:47.058 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (752, 757) -->  Sandra moved to the garden
2025-01-22 05:57:47.058 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel took the milk there.
2025-01-22 05:57:47.062 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (815, 820) --> . Daniel took the milk
2025-01-22 05:57:47.062 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary went back to the hallway.
2025-01-22 05:57:47.080 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (3056, 3062) -->  John went back to the hallway
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:57:47.845 | INFO     | test_jbb_embedding:begin_test:693 - the office<|eot_id|>
2025-01-22 05:57:47.846 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8168])
2025-01-22 05:57:50.081 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [241.0765625, 32.3250497246022, 296.47983870967744, 30.802223180194606, 17.653521825396826], 'topk_indices': array([   4, 8158, 8056, 8150,   24,    9, 8159, 8151, 8152, 8166, 8154,
       8017, 8153, 8022,   14, 8155, 8156,    0, 8163, 8164]), 'topk_tokens': ['\n\n', ' hallway', '.\n\n', 'Question', '\n\n', ':', '?', ':', ' Where', '<|end_header_id|>', ' the', '\n', ' was', ' context', '\n', ' milk', ' before', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [263.08125, 182.0625, 237.65, 306.375]}, 'weight': {'score': [22.3921875, 23.261015911872704, 23.153981854838708, 23.263564824793693, 29.270089285714285], 'topk_indices': array([3256, 3283, 3128, 3176, 7415, 7453, 1411, 1473, 4272, 4256, 5160,
       5099, 7192, 7136, 3439, 3465, 4953, 4924, 4870, 4895]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [23.3078125, 20.0703125, 21.00625, 26.462890625]}, 'saliency': {'score': [1.35386962890625, 0.17581716885327417, 1.8589339717741935, 0.16648872075725152, 0.13098604716951884], 'topk_indices': array([ 820,   24, 8160,   14, 2016,  819, 8021, 8056,    8, 8066, 8020,
       8161, 8159, 8153, 8150, 8152, 8158, 8022, 8156, 8155]), 'topk_tokens': [' there', '\n\n', ' \n', '\n', ' office', ' milk', ' you', '.\n\n', ' Date', ' location', ' provided', 'Answer', '?', ' was', 'Question', ' Where', ' hallway', ' context', ' before', ' milk'], 'evidence_proportions': [1.41806640625, 0.9191487630208334, 1.244140625, 2.0628662109375]}}, 'pred_res': 'the office<|eot_id|>', 'score': 100}
2025-01-22 05:57:50.091 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:57:50.091 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-78_pid-3_2-3-6-7.pkl | len: 3 |  size: 1.99 KB
Processing depth (2, 3, 6, 7):   4%|▍         | 4/100 [01:24<33:19, 20.83s/it]is_0k: False
your chose emoji: ['🏟️', '🧑🏿\u200d🦳', '🧑🏼\u200d🎄', '👩🏻\u200d❤️\u200d👩🏼', '🧒', '🏆', '💑🏼', '🤾\u200d♂', '🦊', '🉐']
emoji:
O: 🏟️ [9468, 237, 253, 31643]
N: 🏟️ [9468, 237, 253, 31643]

O: 🧑🏿‍🦳 [9468, 100, 239, 9468, 237, 123, 102470, 9468, 99, 111]
N: 🧒 [9468, 100, 240]

O: 🧑🏼‍🎄 [9468, 100, 239, 9468, 237, 120, 102470, 9468, 236, 226]
N: 🧑🏿‍🦳 [9468, 100, 239, 9468, 237, 123, 102470, 9468, 99, 111]

O: 👩🏻‍❤️‍👩🏼 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 31643, 102470, 9468, 239, 102, 9468, 237, 120]
N: 🧑🏼‍🎄 [9468, 100, 239, 9468, 237, 120, 102470, 9468, 236, 226]

O: 🧒 [9468, 100, 240]
N: 🤾‍♂ [9468, 97, 122, 102470, 17245, 224]

O: 🏆 [9468, 237, 228]
N: 👩🏻‍❤️‍👩🏼 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 31643, 102470, 9468, 239, 102, 9468, 237, 120]

O: 💑🏼 [93273, 239, 9468, 237, 120]
N: 💑🏼 [93273, 239, 9468, 237, 120]

O: 🤾‍♂ [9468, 97, 122, 102470, 17245, 224]
N: 🏆 [9468, 237, 228]

O: 🦊 [9468, 99, 232]
N: 🦊 [9468, 99, 232]

O: 🉐 [9468, 231, 238]
N: 🉐 [9468, 231, 238]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:11,  3.82s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.66s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.90s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.48s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.89s/it]
Processing depth (3, 4, 7, 8):   4%|▍         | 4/100 [01:41<33:19, 20.83s/it]2025-01-22 05:58:07.463 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John moved to the office.
2025-01-22 05:58:07.481 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2891, 2896) --> . John moved to the
2025-01-22 05:58:07.481 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the hallway.
2025-01-22 05:58:07.503 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3254, 3260) -->  Mary went back to the hallway
2025-01-22 05:58:07.503 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John put down the milk.
2025-01-22 05:58:07.536 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5741, 5746) --> . John put down the
2025-01-22 05:58:07.536 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the milk.
2025-01-22 05:58:07.568 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6660, 6664) -->  Daniel left the milk
2025-01-22 05:58:07.569 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra moved to the garden.
2025-01-22 05:58:07.572 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (631, 636) --> . Sandra moved to the
2025-01-22 05:58:07.572 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the office.
2025-01-22 05:58:07.586 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2892, 2897) -->  John moved to the office
2025-01-22 05:58:07.586 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary travelled to the office.
2025-01-22 05:58:07.600 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2199, 2204) --> . Mary travelled to the
2025-01-22 05:58:07.600 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary moved to the garden.
2025-01-22 05:58:07.604 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (632, 637) -->  Sandra moved to the garden
2025-01-22 05:58:07.604 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel took the milk there.
2025-01-22 05:58:07.609 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (763, 768) --> . Daniel took the milk
2025-01-22 05:58:07.609 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary went back to the hallway.
2025-01-22 05:58:07.632 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (3253, 3259) --> . Mary went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:58:08.420 | INFO     | test_jbb_embedding:begin_test:693 - the office<|eot_id|>
2025-01-22 05:58:08.420 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8156])
2025-01-22 05:58:10.653 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [250.45625, 27.5749207066683, 214.16935483870967, 26.311561382138894, 39.36156798245614], 'topk_indices': array([   1, 8044,    9, 8010,   23, 8146, 8142, 8147, 8140, 8138, 8139,
         24, 8141, 8154,   14, 8143, 8144,    0, 8152, 8151]), 'topk_tokens': ['<|start_header_id|>', '.\n\n', ':', ' context', '4', ' hallway', ' the', '?', ' Where', 'Question', ':', '\n\n', ' was', '<|end_header_id|>', '\n', ' milk', ' before', '<|begin_of_text|>', '<|start_header_id|>', '<|eot_id|>'], 'evidence_proportions': [147.9875, 181.07291666666666, 387.425, 311.40625]}, 'weight': {'score': [23.00078125, 23.25598722113263, 22.294354838709676, 23.260293958924386, 29.542763157894736], 'topk_indices': array([3320, 3347, 3233, 3185, 7421, 7383, 1491, 1429, 4312, 4328, 5190,
       5129, 7100, 7156, 3503, 3529, 4954, 4931, 4983, 4906]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [18.88125, 25.787760416666668, 21.00625, 26.462890625]}, 'saliency': {'score': [1.500537109375, 0.14935364083759806, 1.2579463835685485, 0.14178116712409028, 0.28828778183251097], 'topk_indices': array([8054,   14, 5742,    8,   20,  768, 8044,  767, 8148,   23,   24,
       8149, 8147, 8141, 8010, 8140, 8138, 8146, 8144, 8143]), 'topk_tokens': [' location', '\n', ' John', ' Date', ' Jul', ' there', '.\n\n', ' milk', ' \n', '4', '\n\n', 'Answer', '?', ' was', ' context', ' Where', 'Question', ' hallway', ' before', ' milk'], 'evidence_proportions': [0.741357421875, 1.2672932942708333, 2.1244140625, 2.01953125]}}, 'pred_res': 'the office<|eot_id|>', 'score': 100}
2025-01-22 05:58:10.660 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:58:10.661 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-78_pid-4_3-4-7-8.pkl | len: 3 |  size: 1.99 KB
Processing depth (3, 4, 7, 8):   5%|▌         | 5/100 [01:44<32:49, 20.73s/it]Processing depth (3, 4, 7, 8):   5%|▌         | 5/100 [01:44<33:07, 20.93s/it]
2025-01-22 05:58:10.707 | INFO     | __main__:<module>:82 - Selected idx: 79
2025-01-22 05:58:10.707 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the location prior to the place where the football was discarded, left or dropped?
2025-01-22 05:58:10.707 | INFO     | __main__:<module>:84 - Answer: office
2025-01-22 05:58:10.707 | INFO     | __main__:<module>:85 - Tag: 4-hop
2025-01-22 05:58:10.707 | INFO     | __main__:<module>:86 - Needle: [' Mary travelled to the office.', ' John moved to the office.', ' Daniel moved to the office.', ' Mary went back to the hallway.', ' John grabbed the football.', ' John went back to the hallway.', ' Sandra moved to the garden.', ' Mary moved to the garden.', ' Daniel took the milk there.', ' John put down the football.', ' Daniel left the milk.']
2025-01-22 05:58:10.707 | INFO     | __main__:<module>:87 - Real Needle: [' John moved to the office.', ' John grabbed the football.', ' John went back to the hallway.', ' John put down the football.', ' Daniel left the milk.']
2025-01-22 05:58:10.707 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['🏛️', '⛸️', '\U0001faf3🏽', '🏃🏼\u200d♂️\u200d➡', '💰', '🧑🏾\u200d⚖', '🧗🏻\u200d♀️', '🚇', '🪙', '🦢']
emoji:
O: 🏛️ [9468, 237, 249, 31643]
N: 🪙 [9468, 103, 247]

O: ⛸️ [158, 249, 116, 31643]
N: 🫳🏽 [9468, 104, 111, 9468, 237, 121]

O: 🫳🏽 [9468, 104, 111, 9468, 237, 121]
N: 🧑🏾‍⚖ [9468, 100, 239, 9468, 237, 122, 102470, 158, 248, 244]

O: 🏃🏼‍♂️‍➡ [9468, 237, 225, 9468, 237, 120, 102470, 17245, 224, 31643, 102470, 98115, 94]
N: 🏃🏼‍♂️‍➡ [9468, 237, 225, 9468, 237, 120, 102470, 17245, 224, 31643, 102470, 98115, 94]

O: 💰 [93273, 108]
N: 🚇 [9468, 248, 229]

O: 🧑🏾‍⚖ [9468, 100, 239, 9468, 237, 122, 102470, 158, 248, 244]
N: 🏛️ [9468, 237, 249, 31643]

O: 🧗🏻‍♀️ [9468, 100, 245, 9468, 237, 119, 102470, 32990, 31643]
N: 💰 [93273, 108]

O: 🚇 [9468, 248, 229]
N: ⛸️ [158, 249, 116, 31643]

O: 🪙 [9468, 103, 247]
N: 🧗🏻‍♀️ [9468, 100, 245, 9468, 237, 119, 102470, 32990, 31643]

O: 🦢 [9468, 99, 95]
N: 🦢 [9468, 99, 95]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.09s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.35s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.38s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.07s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.53s/it]
Processing depth (0, 1, 3, 4, 8):   0%|          | 0/100 [00:15<?, ?it/s]2025-01-22 05:58:26.614 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John moved to the office.
2025-01-22 05:58:26.615 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  moved to the office.
2025-01-22 05:58:26.615 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John grabbed the football.
2025-01-22 05:58:26.619 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (915, 919) -->  John grabbed the football
2025-01-22 05:58:26.619 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the hallway.
2025-01-22 05:58:26.621 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (244, 250) -->  Mary went back to the hallway
2025-01-22 05:58:26.621 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John put down the football.
2025-01-22 05:58:26.639 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3740, 3745) --> . John put down the
2025-01-22 05:58:26.639 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel left the milk.
2025-01-22 05:58:26.671 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6682, 6686) -->  left the milk.
2025-01-22 05:58:26.671 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the office.
2025-01-22 05:58:26.672 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (189, 194) --> . Mary travelled to the
2025-01-22 05:58:26.673 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the office.
2025-01-22 05:58:26.673 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (31, 36) -->  moved to the office.
2025-01-22 05:58:26.673 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the hallway.
2025-01-22 05:58:26.674 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (243, 249) --> . Mary went back to the
2025-01-22 05:58:26.674 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra moved to the garden.
2025-01-22 05:58:26.684 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1726, 1731) -->  Mary moved to the garden
2025-01-22 05:58:26.684 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary moved to the garden.
2025-01-22 05:58:26.693 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1725, 1730) --> . Mary moved to the
2025-01-22 05:58:26.693 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel took the milk there.
2025-01-22 05:58:26.720 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (4816, 4821) --> . Daniel took the milk
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:58:27.543 | INFO     | test_jbb_embedding:begin_test:693 - The hallway.<|eot_id|>
2025-01-22 05:58:27.543 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8268])
2025-01-22 05:58:29.811 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [465.9817708333333, 43.34110867593712, 424.1945564516129, 40.66918746195983, 50.572228773584904], 'topk_indices': array([  35,   23,   29,  192, 8147,   25,  918,  195, 3067, 8248, 8242,
       8263,   14,   34,  194, 3762,   24, 3761, 8264,    0]), 'topk_tokens': ['.', '4', '\n\n', ' to', '.\n\n', '<|eot_id|>', ' football', '.', ' hallway', ' to', ':', '<|eot_id|>', '\n', ' office', ' office', '�', '\n\n', '�', '<|start_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [788.2, 511.875, 441.0416666666667, 408.45, 126.640625]}, 'weight': {'score': [22.731770833333332, 23.325836986094316, 21.22202620967742, 23.335511450091296, 29.40403891509434], 'topk_indices': array([3262, 3289, 3134, 3182, 7522, 7484, 1423, 1485, 4327, 4343, 5225,
       5164, 7261, 7205, 3445, 3471, 5018, 4989, 4966, 4941]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.034375, 27.306640625, 25.787760416666668, 21.00625, 20.3515625]}, 'saliency': {'score': [2.7544962565104165, 0.24636736757954203, 2.2320655084425405, 0.23154670589955492, 0.3710907270323555], 'topk_indices': array([4602, 3768, 8113,   31,   24, 3759, 8255, 8247,   38, 4601, 8253,
       8241,  191,  249,  918,   34,  194, 3067, 3761, 3762]), 'topk_tokens': [' moved', '�', ' context', ' moved', '\n\n', '�', ' discarded', ' prior', '***', ' Daniel', ' football', 'Question', ' travelled', ' hallway', ' football', ' office', ' office', ' hallway', '�', '�'], 'evidence_proportions': [3.96640625, 3.6064453125, 3.0919596354166665, 2.160546875, 0.6239013671875]}}, 'pred_res': 'The hallway.<|eot_id|>', 'score': 0}
2025-01-22 05:58:29.819 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:58:29.819 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-79_pid-0_0-1-3-4-8.pkl | len: 3 |  size: 2.05 KB
Processing depth (0, 1, 3, 4, 8):   1%|          | 1/100 [00:19<31:23, 19.02s/it]is_0k: False
your chose emoji: ['🕵️\u200d♀️', '🏄🏾', '👩🏼\u200d❤\u200d💋\u200d👩🏿', '👮🏼\u200d♂', '👨🏿\u200d🏭', '🎑', '👨🏾\u200d🦼\u200d➡', '🧑🏾\u200d🦯\u200d➡', '👩🏽\u200d🦯', '👩🏼\u200d🤝\u200d👩🏻']
emoji:
O: 🕵️‍♀️ [9468, 243, 113, 31643, 102470, 32990, 31643]
N: 🏄🏾 [9468, 237, 226, 9468, 237, 122]

O: 🏄🏾 [9468, 237, 226, 9468, 237, 122]
N: 👩🏼‍❤‍💋‍👩🏿 [9468, 239, 102, 9468, 237, 120, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 123]

O: 👩🏼‍❤‍💋‍👩🏿 [9468, 239, 102, 9468, 237, 120, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 123]
N: 👨🏾‍🦼‍➡ [9468, 239, 101, 9468, 237, 122, 102470, 9468, 99, 120, 102470, 98115, 94]

O: 👮🏼‍♂ [9468, 239, 106, 9468, 237, 120, 102470, 17245, 224]
N: 🎑 [9468, 236, 239]

O: 👨🏿‍🏭 [9468, 239, 101, 9468, 237, 123, 102470, 9468, 237, 255]
N: 🕵️‍♀️ [9468, 243, 113, 31643, 102470, 32990, 31643]

O: 🎑 [9468, 236, 239]
N: 👮🏼‍♂ [9468, 239, 106, 9468, 237, 120, 102470, 17245, 224]

O: 👨🏾‍🦼‍➡ [9468, 239, 101, 9468, 237, 122, 102470, 9468, 99, 120, 102470, 98115, 94]
N: 👨🏿‍🏭 [9468, 239, 101, 9468, 237, 123, 102470, 9468, 237, 255]

O: 🧑🏾‍🦯‍➡ [9468, 100, 239, 9468, 237, 122, 102470, 9468, 99, 107, 102470, 98115, 94]
N: 👩🏽‍🦯 [9468, 239, 102, 9468, 237, 121, 102470, 9468, 99, 107]

O: 👩🏽‍🦯 [9468, 239, 102, 9468, 237, 121, 102470, 9468, 99, 107]
N: 🧑🏾‍🦯‍➡ [9468, 100, 239, 9468, 237, 122, 102470, 9468, 99, 107, 102470, 98115, 94]

O: 👩🏼‍🤝‍👩🏻 [9468, 239, 102, 9468, 237, 120, 102470, 9468, 97, 251, 102470, 9468, 239, 102, 9468, 237, 119]
N: 👩🏼‍🤝‍👩🏻 [9468, 239, 102, 9468, 237, 120, 102470, 9468, 97, 251, 102470, 9468, 239, 102, 9468, 237, 119]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.82s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.98s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.13s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.67s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.37s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 2, 3, 5, 6):   1%|          | 1/100 [00:34<31:23, 19.02s/it]2025-01-22 05:58:45.179 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John moved to the office.
2025-01-22 05:58:45.180 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  moved to the office.
2025-01-22 05:58:45.180 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John grabbed the football.
2025-01-22 05:58:45.190 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1789, 1793) -->  John grabbed the football
2025-01-22 05:58:45.191 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the hallway.
2025-01-22 05:58:45.192 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (234, 240) -->  Mary went back to the hallway
2025-01-22 05:58:45.192 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John put down the football.
2025-01-22 05:58:45.215 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4205, 4210) -->  John put down the football
2025-01-22 05:58:45.215 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel left the milk.
2025-01-22 05:58:45.239 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4823, 4827) -->  Daniel left the milk
2025-01-22 05:58:45.239 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the office.
2025-01-22 05:58:45.240 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (187, 192) --> . Mary travelled to the
2025-01-22 05:58:45.240 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the office.
2025-01-22 05:58:45.240 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (31, 36) -->  moved to the office.
2025-01-22 05:58:45.240 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the hallway.
2025-01-22 05:58:45.242 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (233, 239) --> . Mary went back to the
2025-01-22 05:58:45.242 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra moved to the garden.
2025-01-22 05:58:45.249 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1459, 1464) -->  Mary moved to the garden
2025-01-22 05:58:45.249 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary moved to the garden.
2025-01-22 05:58:45.257 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1458, 1463) --> . Mary moved to the
2025-01-22 05:58:45.257 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel took the milk there.
2025-01-22 05:58:45.283 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (4825, 4830) -->  the milk. Daniel took
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:58:48.101 | INFO     | test_jbb_embedding:begin_test:693 - hallway<|eot_id|>
2025-01-22 05:58:48.101 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8260])
2025-01-22 05:58:51.420 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [534.1901041666666, 49.720667665214236, 439.6184475806452, 46.831171180090166, 35.112630208333336], 'topk_indices': array([8240,   35, 4329,    9, 2897, 2759,   31, 4596, 4599,   29,   34,
       8233, 2652,   24,   14, 8234, 1792, 8255,    0, 8256]), 'topk_tokens': [' to', '.', 'nes', ':', ' hallway', 'pl', ' moved', ' moved', ' office', '\n\n', ' office', 'Question', 'graphic', '\n\n', '\n', ':', ' football', '<|eot_id|>', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [913.6, 718.75, 414.25, 524.55, 67.328125]}, 'weight': {'score': [24.753255208333332, 23.333951751997095, 21.22202620967742, 23.337778535091996, 29.97104779411765], 'topk_indices': array([3377, 3350, 3222, 3270, 7540, 7502, 1486, 1548, 4363, 4347, 5242,
       5181, 7223, 7279, 3533, 3559, 5029, 5000, 4952, 4977]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.034375, 27.306640625, 25.787760416666668, 25.8203125, 26.462890625]}, 'saliency': {'score': [3.297149658203125, 0.2797931051519759, 2.3125433152721775, 0.26329111736265537, 0.2576415118049173], 'topk_indices': array([1790,  192, 8149, 2651, 4209, 8253, 8239,   38, 4329, 2759, 4595,
       8247,   31, 4599, 4596,   34, 2897, 8233, 2652, 1792]), 'topk_tokens': [' grabbed', ' office', ' location', ' tele', ' football', 'Answer', ' prior', '***', 'nes', 'pl', ' Daniel', ' discarded', ' moved', ' office', ' moved', ' office', ' hallway', 'Question', 'graphic', ' football'], 'evidence_proportions': [4.5875, 5.2451171875, 2.7223307291666665, 3.41796875, 0.44744873046875]}}, 'pred_res': 'hallway<|eot_id|>', 'score': 0}
2025-01-22 05:58:51.427 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:58:51.428 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-79_pid-1_0-2-3-5-6.pkl | len: 3 |  size: 2.07 KB
Processing depth (0, 2, 3, 5, 6):   2%|▏         | 2/100 [00:40<33:33, 20.54s/it]is_0k: False
your chose emoji: ['🇦🇬', '👨🏿\u200d❤️\u200d💋\u200d👨🏾', '🧑🏻\u200d❤️\u200d💋\u200d🧑🏾', '👩🏽\u200d🤝\u200d👩🏾', '\U0001faf3🏼', '🏂🏾', '◼️', '🚶🏽\u200d♀️\u200d➡️', '🙇🏾\u200d♀️', '⏯️']
emoji:
O: 🇦🇬 [9468, 229, 99, 9468, 229, 105]
N: 👨🏿‍❤️‍💋‍👨🏾 [9468, 239, 101, 9468, 237, 123, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 122]

O: 👨🏿‍❤️‍💋‍👨🏾 [9468, 239, 101, 9468, 237, 123, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 122]
N: 🏂🏾 [9468, 237, 224, 9468, 237, 122]

O: 🧑🏻‍❤️‍💋‍🧑🏾 [9468, 100, 239, 9468, 237, 119, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 100, 239, 9468, 237, 122]
N: 🇦🇬 [9468, 229, 99, 9468, 229, 105]

O: 👩🏽‍🤝‍👩🏾 [9468, 239, 102, 9468, 237, 121, 102470, 9468, 97, 251, 102470, 9468, 239, 102, 9468, 237, 122]
N: 🚶🏽‍♀️‍➡️ [9468, 248, 114, 9468, 237, 121, 102470, 32990, 31643, 102470, 98115, 94, 31643]

O: 🫳🏼 [9468, 104, 111, 9468, 237, 120]
N: 🫳🏼 [9468, 104, 111, 9468, 237, 120]

O: 🏂🏾 [9468, 237, 224, 9468, 237, 122]
N: ◼️ [41832, 120, 31643]

O: ◼️ [41832, 120, 31643]
N: 🧑🏻‍❤️‍💋‍🧑🏾 [9468, 100, 239, 9468, 237, 119, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 100, 239, 9468, 237, 122]

O: 🚶🏽‍♀️‍➡️ [9468, 248, 114, 9468, 237, 121, 102470, 32990, 31643, 102470, 98115, 94, 31643]
N: 🙇🏾‍♀️ [9468, 247, 229, 9468, 237, 122, 102470, 32990, 31643]

O: 🙇🏾‍♀️ [9468, 247, 229, 9468, 237, 122, 102470, 32990, 31643]
N: 👩🏽‍🤝‍👩🏾 [9468, 239, 102, 9468, 237, 121, 102470, 9468, 97, 251, 102470, 9468, 239, 102, 9468, 237, 122]

O: ⏯️ [158, 237, 107, 31643]
N: ⏯️ [158, 237, 107, 31643]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:05<00:15,  5.06s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.83s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.68s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.31s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.86s/it]
Processing depth (0, 1, 5, 6, 7):   2%|▏         | 2/100 [00:57<33:33, 20.54s/it]2025-01-22 05:59:08.658 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John moved to the office.
2025-01-22 05:59:08.658 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  moved to the office.
2025-01-22 05:59:08.659 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John grabbed the football.
2025-01-22 05:59:08.663 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (915, 919) -->  John grabbed the football
2025-01-22 05:59:08.663 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the hallway.
2025-01-22 05:59:08.665 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (244, 250) -->  Mary went back to the hallway
2025-01-22 05:59:08.665 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John put down the football.
2025-01-22 05:59:08.689 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4894, 4899) --> . John put down the
2025-01-22 05:59:08.690 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel left the milk.
2025-01-22 05:59:08.723 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6064, 6068) -->  left the milk.
2025-01-22 05:59:08.723 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the office.
2025-01-22 05:59:08.724 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (189, 194) --> . Mary travelled to the
2025-01-22 05:59:08.725 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the office.
2025-01-22 05:59:08.725 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (31, 36) -->  moved to the office.
2025-01-22 05:59:08.725 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the hallway.
2025-01-22 05:59:08.726 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (243, 249) --> . Mary went back to the
2025-01-22 05:59:08.726 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra moved to the garden.
2025-01-22 05:59:08.735 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1726, 1731) -->  Mary moved to the garden
2025-01-22 05:59:08.735 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary moved to the garden.
2025-01-22 05:59:08.745 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1725, 1730) --> . Mary moved to the
2025-01-22 05:59:08.746 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel took the milk there.
2025-01-22 05:59:08.772 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (4900, 4905) --> . Daniel took the milk
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:59:09.531 | INFO     | test_jbb_embedding:begin_test:693 - hallway<|eot_id|>
2025-01-22 05:59:09.531 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8176])
2025-01-22 05:59:11.767 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [526.7786458333334, 46.999243396918565, 562.9979838709677, 43.61248153391604, 29.754231770833332], 'topk_indices': array([  35,  185,   29, 4259,   69,  191, 8150,  192, 7333,   14,   24,
         31,   67,  105,   68, 8171,   34,  194,    0, 8172]), 'topk_tokens': ['.', 'ION', '\n\n', ' hallway', 'ER', ' travelled', ':', ' to', 'nes', '\n', '\n\n', ' moved', 'ION', 'ION', 'E', '<|eot_id|>', ' office', ' office', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [1199.3, 515.75, 463.2083333333333, 241.75, 148.796875]}, 'weight': {'score': [22.731770833333332, 23.256754019931524, 21.22202620967742, 23.26607030192047, 29.355989583333333], 'topk_indices': array([3306, 3279, 3199, 3151, 7418, 7380, 1423, 1485, 4265, 4281, 5100,
       5161, 7101, 7157, 3488, 3462, 4890, 4865, 4954, 4925]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.034375, 27.306640625, 25.787760416666668, 21.00625, 20.3515625]}, 'saliency': {'score': [3.1007486979166665, 0.2632878714710962, 2.9601853893649195, 0.2446121503225794, 0.2218968709309896], 'topk_indices': array([8163,   39, 8161, 7255, 8155,  918,   64,  249,  185,   38, 8149,
         68, 7333,  105,   67,   31,  191, 4259,   34,  194]), 'topk_tokens': [' discarded', '\n\n\n', ' football', 'nes', ' prior', ' football', 'ENCES', ' hallway', 'ION', '***', 'Question', 'E', 'nes', 'ION', 'ION', ' moved', ' travelled', ' hallway', ' office', ' office'], 'evidence_proportions': [6.231640625, 3.7060546875, 3.2078450520833335, 1.27177734375, 0.7073974609375]}}, 'pred_res': 'hallway<|eot_id|>', 'score': 0}
2025-01-22 05:59:11.774 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:59:11.775 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-79_pid-2_0-1-5-6-7.pkl | len: 3 |  size: 2.04 KB
Processing depth (0, 1, 5, 6, 7):   3%|▎         | 3/100 [01:00<33:04, 20.45s/it]is_0k: False
your chose emoji: ['🧛🏿\u200d♂', '🙅🏿\u200d♂️', '🍚', '🔊', '㊙️', '🤚🏽', '🐫', '📫', '☝🏻', '👨🏿\u200d🦽\u200d➡️']
emoji:
O: 🧛🏿‍♂ [9468, 100, 249, 9468, 237, 123, 102470, 17245, 224]
N: 🧛🏿‍♂ [9468, 100, 249, 9468, 237, 123, 102470, 17245, 224]

O: 🙅🏿‍♂️ [9468, 247, 227, 9468, 237, 123, 102470, 17245, 224, 31643]
N: 🐫 [9468, 238, 104]

O: 🍚 [9468, 235, 248]
N: 🔊 [9468, 242, 232]

O: 🔊 [9468, 242, 232]
N: 🍚 [9468, 235, 248]

O: ㊙️ [159, 232, 247, 31643]
N: 🙅🏿‍♂️ [9468, 247, 227, 9468, 237, 123, 102470, 17245, 224, 31643]

O: 🤚🏽 [9468, 97, 248, 9468, 237, 121]
N: 📫 [9468, 241, 104]

O: 🐫 [9468, 238, 104]
N: 🤚🏽 [9468, 97, 248, 9468, 237, 121]

O: 📫 [9468, 241, 104]
N: ㊙️ [159, 232, 247, 31643]

O: ☝🏻 [18107, 251, 9468, 237, 119]
N: ☝🏻 [18107, 251, 9468, 237, 119]

O: 👨🏿‍🦽‍➡️ [9468, 239, 101, 9468, 237, 123, 102470, 9468, 99, 121, 102470, 98115, 94, 31643]
N: 👨🏿‍🦽‍➡️ [9468, 239, 101, 9468, 237, 123, 102470, 9468, 99, 121, 102470, 98115, 94, 31643]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.22s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.66s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.41s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.08s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.59s/it]
Processing depth (2, 3, 6, 7, 8):   3%|▎         | 3/100 [01:16<33:04, 20.45s/it]2025-01-22 05:59:27.819 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John moved to the office.
2025-01-22 05:59:27.830 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1866, 1871) --> . John moved to the
2025-01-22 05:59:27.830 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John grabbed the football.
2025-01-22 05:59:27.844 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2987, 2991) -->  John grabbed the football
2025-01-22 05:59:27.845 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the hallway.
2025-01-22 05:59:27.846 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (238, 244) -->  Mary went back to the hallway
2025-01-22 05:59:27.846 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John put down the football.
2025-01-22 05:59:27.876 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5664, 5669) --> . John put down the
2025-01-22 05:59:27.876 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel left the milk.
2025-01-22 05:59:27.913 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6637, 6641) -->  Daniel left the milk
2025-01-22 05:59:27.914 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the office.
2025-01-22 05:59:27.914 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (183, 188) --> . Mary travelled to the
2025-01-22 05:59:27.915 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the office.
2025-01-22 05:59:27.924 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1867, 1872) -->  John moved to the office
2025-01-22 05:59:27.925 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the hallway.
2025-01-22 05:59:27.926 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (237, 243) --> . Mary went back to the
2025-01-22 05:59:27.926 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra moved to the garden.
2025-01-22 05:59:27.935 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1569, 1574) -->  Mary moved to the garden
2025-01-22 05:59:27.935 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary moved to the garden.
2025-01-22 05:59:27.943 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1568, 1573) --> . Mary moved to the
2025-01-22 05:59:27.943 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel took the milk there.
2025-01-22 05:59:27.970 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (4780, 4785) --> . Daniel took the milk
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:59:28.778 | INFO     | test_jbb_embedding:begin_test:693 - The office.<|eot_id|>
2025-01-22 05:59:28.778 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8198])
2025-01-22 05:59:31.019 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [217.70182291666666, 28.693528963414636, 219.7852822580645, 27.409300184162063, 14.983769806338028], 'topk_indices': array([8162,    9, 8159,   20, 8158, 8077,    1, 8192, 8170, 5829, 8190,
       8197,   25,   14,   23,   24, 8196,    0, 8193, 8194]), 'topk_tokens': ['.', ':', ' the', ' Jul', ' return', '.\n\n', '<|start_header_id|>', ':', '.\n\n', ' a', '?\n', '\n\n', '<|eot_id|>', '\n', '4', '\n\n', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [202.525, 237.4375, 226.45833333333334, 335.95, 55.9921875]}, 'weight': {'score': [23.718424479166668, 23.270022865853658, 21.844758064516128, 23.274126189379988, 29.193221830985916], 'topk_indices': array([3294, 3267, 3187, 3139, 7424, 7462, 1486, 1424, 4292, 4308, 5148,
       5209, 7127, 7183, 3450, 3476, 4973, 4925, 5002, 4950]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [18.88125, 27.306640625, 25.787760416666668, 21.00625, 26.462890625]}, 'saliency': {'score': [1.3471145629882812, 0.15446193788109755, 1.1871298513104838, 0.1470173254417012, 0.10729464678697183], 'topk_indices': array([8190, 2990, 8170,   22, 5789,   16,  243, 8185, 8177, 8183, 8197,
       8195, 7773, 8191,   19, 8171, 8158,   24,   23,   20]), 'topk_tokens': ['?\n', ' football', '.\n\n', '202', ' week', ' Date', ' hallway', ' discarded', ' prior', ' football', '\n\n', 'assistant', 'inen', 'Answer', '26', 'Question', ' return', '\n\n', '4', ' Jul'], 'evidence_proportions': [1.0166015625, 1.720947265625, 1.5964762369791667, 1.85185546875, 0.3814544677734375]}}, 'pred_res': 'The office.<|eot_id|>', 'score': 100}
2025-01-22 05:59:31.025 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:59:31.025 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-79_pid-3_2-3-6-7-8.pkl | len: 3 |  size: 2.05 KB
Processing depth (2, 3, 6, 7, 8):   4%|▍         | 4/100 [01:20<31:57, 19.98s/it]is_0k: False
your chose emoji: ['🩳', '👼🏽', '👨🏿\u200d🍳', '🏃🏻\u200d♂', '👩🏿\u200d🤝\u200d👨🏽', '\U0001fae0', '🙇🏻\u200d♀️', '👷🏿\u200d♀', '🐔', '🦴']
emoji:
O: 🩳 [9468, 102, 111]
N: 👼🏽 [9468, 239, 120, 9468, 237, 121]

O: 👼🏽 [9468, 239, 120, 9468, 237, 121]
N: 🩳 [9468, 102, 111]

O: 👨🏿‍🍳 [9468, 239, 101, 9468, 237, 123, 102470, 9468, 235, 111]
N: 🫠 [9468, 104, 254]

O: 🏃🏻‍♂ [9468, 237, 225, 9468, 237, 119, 102470, 17245, 224]
N: 👩🏿‍🤝‍👨🏽 [9468, 239, 102, 9468, 237, 123, 102470, 9468, 97, 251, 102470, 9468, 239, 101, 9468, 237, 121]

O: 👩🏿‍🤝‍👨🏽 [9468, 239, 102, 9468, 237, 123, 102470, 9468, 97, 251, 102470, 9468, 239, 101, 9468, 237, 121]
N: 🐔 [9468, 238, 242]

O: 🫠 [9468, 104, 254]
N: 👨🏿‍🍳 [9468, 239, 101, 9468, 237, 123, 102470, 9468, 235, 111]

O: 🙇🏻‍♀️ [9468, 247, 229, 9468, 237, 119, 102470, 32990, 31643]
N: 👷🏿‍♀ [9468, 239, 115, 9468, 237, 123, 102470, 32990]

O: 👷🏿‍♀ [9468, 239, 115, 9468, 237, 123, 102470, 32990]
N: 🏃🏻‍♂ [9468, 237, 225, 9468, 237, 119, 102470, 17245, 224]

O: 🐔 [9468, 238, 242]
N: 🙇🏻‍♀️ [9468, 247, 229, 9468, 237, 119, 102470, 32990, 31643]

O: 🦴 [9468, 99, 112]
N: 🦴 [9468, 99, 112]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.64s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:10<00:10,  5.34s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.79s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.06s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.75s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 2, 3, 4, 7):   4%|▍         | 4/100 [01:37<31:57, 19.98s/it]2025-01-22 05:59:48.131 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John moved to the office.
2025-01-22 05:59:48.131 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  moved to the office.
2025-01-22 05:59:48.131 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John grabbed the football.
2025-01-22 05:59:48.140 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1867, 1871) -->  John grabbed the football
2025-01-22 05:59:48.141 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the hallway.
2025-01-22 05:59:48.142 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (244, 250) -->  Mary went back to the hallway
2025-01-22 05:59:48.142 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John put down the football.
2025-01-22 05:59:48.161 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3636, 3641) --> . John put down the
2025-01-22 05:59:48.161 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel left the milk.
2025-01-22 05:59:48.189 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5733, 5737) -->  Daniel left the milk
2025-01-22 05:59:48.189 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary travelled to the office.
2025-01-22 05:59:48.190 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (189, 194) --> . Mary travelled to the
2025-01-22 05:59:48.190 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the office.
2025-01-22 05:59:48.190 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (31, 36) -->  moved to the office.
2025-01-22 05:59:48.190 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary went back to the hallway.
2025-01-22 05:59:48.191 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (243, 249) --> . Mary went back to the
2025-01-22 05:59:48.192 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra moved to the garden.
2025-01-22 05:59:48.199 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1569, 1574) -->  Mary moved to the garden
2025-01-22 05:59:48.200 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary moved to the garden.
2025-01-22 05:59:48.207 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (1568, 1573) --> . Mary moved to the
2025-01-22 05:59:48.207 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Daniel took the milk there.
2025-01-22 05:59:48.231 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (4856, 4861) --> . Daniel took the milk
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 05:59:50.955 | INFO     | test_jbb_embedding:begin_test:693 - the hallway<|eot_id|>
2025-01-22 05:59:50.955 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8180])
2025-01-22 05:59:53.978 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [504.546875, 41.43424590564654, 411.05745967741933, 38.65671142488003, 17.227003528225808], 'topk_indices': array([8178, 8059,   31, 1870,   25, 3638,  243,   34, 8165, 8160, 8154,
         23, 3636, 8025,  194,   14,   24, 8175,    0, 8176]), 'topk_tokens': ['<|end_header_id|>', '.\n\n', ' moved', ' football', '<|eot_id|>', ' put', '.', ' office', ' football', ' to', ':', '4', '.', ' context', ' office', '\n', '\n\n', '<|eot_id|>', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [754.05, 515.875, 380.2291666666667, 752.65, 57.6875]}, 'weight': {'score': [23.750325520833332, 23.26376306220973, 21.22202620967742, 23.270114279561955, 29.62172379032258], 'topk_indices': array([3301, 3274, 3194, 3146, 7436, 7398, 1424, 1486, 4299, 4283, 5126,
       5187, 7119, 7175, 3457, 3483, 4883, 4931, 4908, 4960]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.034375, 27.306640625, 25.787760416666668, 21.00625, 26.462890625]}, 'saliency': {'score': [2.9761810302734375, 0.22970481840854926, 2.222449518019153, 0.2139929302859104, 0.13093394617880544], 'topk_indices': array([  23,  249, 3641,    0,   24,   38, 4557, 4558, 8159,  191, 3638,
         31, 8173,   34, 8153, 2991, 1870, 8025,  194, 8165]), 'topk_tokens': ['4', ' hallway', ' football', '<|begin_of_text|>', '\n\n', '***', ' Daniel', ' moved', ' prior', ' travelled', ' put', ' moved', 'Answer', ' office', 'Question', ' hallway', ' football', ' context', ' office', ' football'], 'evidence_proportions': [3.8677734375, 3.654052734375, 2.7301432291666665, 3.90390625, 0.393218994140625]}}, 'pred_res': 'the hallway<|eot_id|>', 'score': 0}
2025-01-22 05:59:53.986 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 05:59:53.986 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-79_pid-4_0-2-3-4-7.pkl | len: 3 |  size: 2.09 KB
Processing depth (0, 2, 3, 4, 7):   5%|▌         | 5/100 [01:43<33:20, 21.05s/it]Processing depth (0, 2, 3, 4, 7):   5%|▌         | 5/100 [01:43<32:41, 20.65s/it]
2025-01-22 05:59:54.054 | INFO     | __main__:<module>:82 - Selected idx: 80
2025-01-22 05:59:54.055 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the apple before the hallway? 
2025-01-22 05:59:54.055 | INFO     | __main__:<module>:84 - Answer: office
2025-01-22 05:59:54.055 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 05:59:54.055 | INFO     | __main__:<module>:86 - Needle: [' Mary journeyed to the kitchen.', ' Sandra journeyed to the office.', ' John journeyed to the hallway.', ' Mary travelled to the bathroom.', ' Sandra went back to the hallway.', ' John journeyed to the bedroom.', ' John went back to the garden.', ' Sandra discarded the apple.', ' John went to the office.']
2025-01-22 05:59:54.055 | INFO     | __main__:<module>:87 - Real Needle: [' Sandra journeyed to the office.', ' Sandra went back to the hallway.', ' Sandra discarded the apple.', ' John went to the office.']
2025-01-22 05:59:54.055 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['🌤', '🧎🏼\u200d♂️\u200d➡️', '🔈', '🔅', '🧜🏻\u200d♂', '🥏', '👨🏿\u200d🦱', '🧛🏾\u200d♂', '🧏🏾', '🚌']
emoji:
O: 🌤 [9468, 234, 97]
N: 🔅 [9468, 242, 227]

O: 🧎🏼‍♂️‍➡️ [9468, 100, 236, 9468, 237, 120, 102470, 17245, 224, 31643, 102470, 98115, 94, 31643]
N: 🔈 [9468, 242, 230]

O: 🔈 [9468, 242, 230]
N: 🥏 [9468, 98, 237]

O: 🔅 [9468, 242, 227]
N: 🧜🏻‍♂ [9468, 100, 250, 9468, 237, 119, 102470, 17245, 224]

O: 🧜🏻‍♂ [9468, 100, 250, 9468, 237, 119, 102470, 17245, 224]
N: 👨🏿‍🦱 [9468, 239, 101, 9468, 237, 123, 102470, 9468, 99, 109]

O: 🥏 [9468, 98, 237]
N: 🌤 [9468, 234, 97]

O: 👨🏿‍🦱 [9468, 239, 101, 9468, 237, 123, 102470, 9468, 99, 109]
N: 🧏🏾 [9468, 100, 237, 9468, 237, 122]

O: 🧛🏾‍♂ [9468, 100, 249, 9468, 237, 122, 102470, 17245, 224]
N: 🧛🏾‍♂ [9468, 100, 249, 9468, 237, 122, 102470, 17245, 224]

O: 🧏🏾 [9468, 100, 237, 9468, 237, 122]
N: 🧎🏼‍♂️‍➡️ [9468, 100, 236, 9468, 237, 120, 102470, 17245, 224, 31643, 102470, 98115, 94, 31643]

O: 🚌 [9468, 48479]
N: 🚌 [9468, 48479]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.55s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.84s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:05,  5.00s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:16<00:00,  3.56s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:16<00:00,  4.04s/it]
Processing depth (2, 3, 4, 6):   0%|          | 0/100 [00:17<?, ?it/s]2025-01-22 06:00:12.013 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra journeyed to the office.
2025-01-22 06:00:12.022 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1777, 1783) --> . Sandra journeyed to the
2025-01-22 06:00:12.022 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the hallway.
2025-01-22 06:00:12.038 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2924, 2930) --> . Sandra went back to the
2025-01-22 06:00:12.038 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra discarded the apple.
2025-01-22 06:00:12.055 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3651, 3655) -->  Sandra discarded the apple
2025-01-22 06:00:12.056 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 06:00:12.075 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3856, 3861) -->  John went back to the
2025-01-22 06:00:12.075 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the kitchen.
2025-01-22 06:00:12.090 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2987, 2993) --> . Mary journeyed to the
2025-01-22 06:00:12.090 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the hallway.
2025-01-22 06:00:12.091 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (186, 192) -->  John journeyed to the hallway
2025-01-22 06:00:12.091 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary travelled to the bathroom.
2025-01-22 06:00:12.105 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2856, 2861) --> . Mary travelled to the
2025-01-22 06:00:12.105 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the bedroom.
2025-01-22 06:00:12.106 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (187, 193) -->  journeyed to the hallway.
2025-01-22 06:00:12.106 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went back to the garden.
2025-01-22 06:00:12.125 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3855, 3861) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:00:12.938 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 06:00:12.938 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8196])
2025-01-22 06:00:15.201 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [489.74107142857144, 41.889637716516226, 425.8125, 39.36894023073147, 56.333183092948715], 'topk_indices': array([8191,  187, 3853, 3651, 8184, 7388, 3652,   14, 8186, 8050, 3854,
       3834, 3855,   24, 8194, 1778, 3654, 3833, 3856,    0]), 'topk_tokens': ['<|eot_id|>', ' journey', ' and', ' Sandra', ' before', 'nes', ' discarded', '\n', ' hallway', ' context', ' St', ' The', '.', '\n\n', '<|end_header_id|>', ' Sandra', ' apple', '.', ' John', '<|begin_of_text|>'], 'evidence_proportions': [495.625, 305.6458333333333, 767.625, 481.2875]}, 'weight': {'score': [23.41592261904762, 23.286908773481336, 21.349407327586206, 23.29347213273196, 29.373798076923077], 'topk_indices': array([3355, 3328, 3248, 3200, 7435, 7473, 1475, 1537, 4347, 4331, 5154,
       5215, 7156, 7212, 3517, 3543, 4956, 4979, 4931, 5008]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.213541666666668, 21.869791666666668, 30.615234375, 22.1546875]}, 'saliency': {'score': [3.444242931547619, 0.2398298961065199, 2.5038136449353448, 0.22351322913790195, 0.40100293281750804], 'topk_indices': array([  24, 3509,  621, 8184, 2861, 3554, 2993, 8183, 7388,  187,  191,
       2925, 8050, 3854, 3651, 3652, 8186, 3654, 1778, 3856]), 'topk_tokens': ['\n\n', ' *\n\n', ' instead', ' before', ' bathroom', ' Ramsey', ' kitchen', ' apple', 'nes', ' journey', ' hallway', ' Sandra', ' context', ' St', ' Sandra', ' discarded', ' hallway', ' apple', ' Sandra', ' John'], 'evidence_proportions': [3.2560221354166665, 1.9395751953125, 6.208984375, 3.263916015625]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 0}
2025-01-22 06:00:15.208 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:00:15.208 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-80_pid-0_2-3-4-6.pkl | len: 3 |  size: 2.02 KB
Processing depth (2, 3, 4, 6):   1%|          | 1/100 [00:21<34:43, 21.05s/it]is_0k: False
your chose emoji: ['✡️', '👩🏿\u200d❤\u200d💋\u200d👨🏼', 'Ⓜ', '🥝', '👩🏿\u200d❤️\u200d💋\u200d👨🏼', '🇲🇿', '🦹', '🩲', '👩🏻\u200d🏭', '🧑🏼\u200d🦰']
emoji:
O: ✡️ [38798, 94, 31643]
N: Ⓜ [158, 241, 224]

O: 👩🏿‍❤‍💋‍👨🏼 [9468, 239, 102, 9468, 237, 123, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 120]
N: 👩🏿‍❤‍💋‍👨🏼 [9468, 239, 102, 9468, 237, 123, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 120]

O: Ⓜ [158, 241, 224]
N: 👩🏻‍🏭 [9468, 239, 102, 9468, 237, 119, 102470, 9468, 237, 255]

O: 🥝 [9468, 98, 251]
N: 🩲 [9468, 102, 110]

O: 👩🏿‍❤️‍💋‍👨🏼 [9468, 239, 102, 9468, 237, 123, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 120]
N: ✡️ [38798, 94, 31643]

O: 🇲🇿 [9468, 229, 110, 9468, 229, 123]
N: 🥝 [9468, 98, 251]

O: 🦹 [9468, 99, 117]
N: 🇲🇿 [9468, 229, 110, 9468, 229, 123]

O: 🩲 [9468, 102, 110]
N: 👩🏿‍❤️‍💋‍👨🏼 [9468, 239, 102, 9468, 237, 123, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 120]

O: 👩🏻‍🏭 [9468, 239, 102, 9468, 237, 119, 102470, 9468, 237, 255]
N: 🦹 [9468, 99, 117]

O: 🧑🏼‍🦰 [9468, 100, 239, 9468, 237, 120, 102470, 9468, 99, 108]
N: 🧑🏼‍🦰 [9468, 100, 239, 9468, 237, 120, 102470, 9468, 99, 108]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.05s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.32s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.31s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.91s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.40s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (1, 4, 6, 9):   1%|          | 1/100 [00:36<34:43, 21.05s/it]2025-01-22 06:00:30.782 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra journeyed to the office.
2025-01-22 06:00:30.787 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (909, 915) --> . Sandra journeyed to the
2025-01-22 06:00:30.787 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the hallway.
2025-01-22 06:00:30.807 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3614, 3620) -->  Sandra went back to the hallway
2025-01-22 06:00:30.807 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra discarded the apple.
2025-01-22 06:00:30.831 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4645, 4649) -->  discarded the apple.
2025-01-22 06:00:30.831 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 06:00:30.853 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3839, 3844) -->  John went back to the
2025-01-22 06:00:30.853 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the kitchen.
2025-01-22 06:00:30.886 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2974, 2980) --> . Mary journeyed to the
2025-01-22 06:00:30.886 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the hallway.
2025-01-22 06:00:30.887 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (231, 237) --> . John journeyed to the
2025-01-22 06:00:30.887 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary travelled to the bathroom.
2025-01-22 06:00:30.902 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2908, 2913) --> . Mary travelled to the
2025-01-22 06:00:30.902 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the bedroom.
2025-01-22 06:00:30.903 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (231, 237) --> . John journeyed to the
2025-01-22 06:00:30.904 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went back to the garden.
2025-01-22 06:00:30.924 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3838, 3844) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:00:33.851 | INFO     | test_jbb_embedding:begin_test:693 - kitchen<|eot_id|>
2025-01-22 06:00:33.851 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8182])
2025-01-22 06:00:36.826 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [478.23809523809524, 48.459608687683286, 463.0409482758621, 45.87192648143595, 57.01534991197183], 'topk_indices': array([  14,  234, 8167, 8171, 8077, 8180, 8093, 8173,  910,   24,  238,
       4647, 8178, 8109, 8110, 8170, 8172,  237, 8177,    0]), 'topk_tokens': ['\n', 'ed', ' was', ' the', ' in', '<|end_header_id|>', ' the', '?', ' Sandra', '\n\n', '.', ' apple', '<|start_header_id|>', ' to', ' the', ' before', ' hallway', ' hallway', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [579.9583333333334, 444.7083333333333, 823.0, 120.6]}, 'weight': {'score': [23.433779761904763, 23.285257438294234, 19.91325431034483, 23.29689613044013, 29.88226232394366], 'topk_indices': array([3333, 3360, 3253, 3205, 7473, 7435, 1482, 1420, 4370, 4386, 5265,
       5204, 7212, 7156, 3516, 3542, 4981, 5058, 5006, 5029]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.213541666666668, 26.94921875, 23.08984375, 22.1546875]}, 'saliency': {'score': [3.1367303757440474, 0.27445099384087857, 2.3984206627155173, 0.2594887381957678, 0.4317476514359595], 'topk_indices': array([8166, 8080, 8173, 2980, 2913, 4644, 2921, 3614,  310, 8108, 3619,
        233, 8169, 8164, 4645, 4647,  910, 8170, 8172,  237]), 'topk_tokens': [' Where', ' location', '?', ' kitchen', ' bathroom', ' Sandra', ' summer', ' Sandra', ' bedroom', ' moved', ' hallway', ' journey', ' apple', 'Question', ' discarded', ' apple', ' Sandra', ' before', ' hallway', ' hallway'], 'evidence_proportions': [3.5628255208333335, 3.32080078125, 5.286376953125, 0.684814453125]}}, 'pred_res': 'kitchen<|eot_id|>', 'score': 0}
2025-01-22 06:00:36.833 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:00:36.833 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-80_pid-1_1-4-6-9.pkl | len: 3 |  size: 2.03 KB
Processing depth (1, 4, 6, 9):   2%|▏         | 2/100 [00:42<34:55, 21.39s/it]is_0k: False
your chose emoji: ['🏌🏻\u200d♀', '💁🏽\u200d♂', '😁', '🧙🏽\u200d♂', '🪤', '🧑🏿\u200d❤️\u200d🧑🏻', '🐛', '🏃\u200d♀\u200d➡️', '👩🏻\u200d🎓', '🚖']
emoji:
O: 🏌🏻‍♀ [9468, 237, 234, 9468, 237, 119, 102470, 32990]
N: 👩🏻‍🎓 [9468, 239, 102, 9468, 237, 119, 102470, 9468, 236, 241]

O: 💁🏽‍♂ [93273, 223, 9468, 237, 121, 102470, 17245, 224]
N: 🧑🏿‍❤️‍🧑🏻 [9468, 100, 239, 9468, 237, 123, 102470, 121643, 31643, 102470, 9468, 100, 239, 9468, 237, 119]

O: 😁 [76460, 223]
N: 😁 [76460, 223]

O: 🧙🏽‍♂ [9468, 100, 247, 9468, 237, 121, 102470, 17245, 224]
N: 🏃‍♀‍➡️ [9468, 237, 225, 102470, 32990, 102470, 98115, 94, 31643]

O: 🪤 [9468, 103, 97]
N: 💁🏽‍♂ [93273, 223, 9468, 237, 121, 102470, 17245, 224]

O: 🧑🏿‍❤️‍🧑🏻 [9468, 100, 239, 9468, 237, 123, 102470, 121643, 31643, 102470, 9468, 100, 239, 9468, 237, 119]
N: 🏌🏻‍♀ [9468, 237, 234, 9468, 237, 119, 102470, 32990]

O: 🐛 [9468, 238, 249]
N: 🪤 [9468, 103, 97]

O: 🏃‍♀‍➡️ [9468, 237, 225, 102470, 32990, 102470, 98115, 94, 31643]
N: 🐛 [9468, 238, 249]

O: 👩🏻‍🎓 [9468, 239, 102, 9468, 237, 119, 102470, 9468, 236, 241]
N: 🧙🏽‍♂ [9468, 100, 247, 9468, 237, 121, 102470, 17245, 224]

O: 🚖 [9468, 248, 244]
N: 🚖 [9468, 248, 244]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.98s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.71s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.51s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.12s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.69s/it]
Processing depth (3, 5, 6, 9):   2%|▏         | 2/100 [00:59<34:55, 21.39s/it]2025-01-22 06:00:53.468 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra journeyed to the office.
2025-01-22 06:00:53.482 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2835, 2841) --> . Sandra journeyed to the
2025-01-22 06:00:53.482 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the hallway.
2025-01-22 06:00:53.503 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4142, 4148) --> . Sandra went back to the
2025-01-22 06:00:53.503 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra discarded the apple.
2025-01-22 06:00:53.525 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4642, 4646) -->  Sandra discarded the apple
2025-01-22 06:00:53.525 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 06:00:53.547 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3788, 3793) -->  John went back to the
2025-01-22 06:00:53.547 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the kitchen.
2025-01-22 06:00:53.563 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2853, 2859) -->  Mary journeyed to the kitchen
2025-01-22 06:00:53.563 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the hallway.
2025-01-22 06:00:53.564 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (187, 193) --> . John journeyed to the
2025-01-22 06:00:53.564 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary travelled to the bathroom.
2025-01-22 06:00:53.580 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2715, 2720) --> . Mary travelled to the
2025-01-22 06:00:53.580 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the bedroom.
2025-01-22 06:00:53.581 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (187, 193) --> . John journeyed to the
2025-01-22 06:00:53.582 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went back to the garden.
2025-01-22 06:00:53.601 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3787, 3793) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:00:54.348 | INFO     | test_jbb_embedding:begin_test:693 - kitchen<|eot_id|>
2025-01-22 06:00:54.348 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8152])
2025-01-22 06:00:56.564 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [516.4047619047619, 38.44518411209223, 490.57327586206895, 35.5887100505923, 65.49162946428571], 'topk_indices': array([ 193,   14, 8135, 4643, 8136, 8137, 2841,   24, 8150, 2720, 8143,
       2717, 4645, 2836, 8139, 8142, 8140,    0, 8147, 8148]), 'topk_tokens': [' hallway', '\n', ':', ' discarded', ' Where', ' was', ' office', '\n\n', '<|end_header_id|>', ' bathroom', '?', ' travelled', ' apple', ' Sandra', ' apple', ' hallway', ' before', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [784.875, 301.5, 858.875, 178.15]}, 'weight': {'score': [23.41592261904762, 23.259843711675252, 20.73895474137931, 23.268460212549357, 29.794642857142858], 'topk_indices': array([3348, 3321, 3241, 3193, 7387, 7425, 1449, 1511, 4328, 4344, 5144,
       5205, 7158, 7102, 3504, 3530, 4998, 4921, 4969, 4946]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.213541666666668, 21.869791666666668, 30.615234375, 22.1546875]}, 'saliency': {'score': [3.4361049107142856, 0.21659581977595352, 2.7095231681034484, 0.1993321741674636, 0.4890937805175781], 'topk_indices': array([ 189, 4148, 2858, 2716, 8143, 8145, 4642, 2837, 8134, 8136, 2841,
        193, 4643, 4645, 8139, 2717, 8140, 2720, 2836, 8142]), 'topk_tokens': [' journey', ' hallway', ' kitchen', ' Mary', '?', 'Answer', ' Sandra', ' journey', 'Question', ' Where', ' office', ' hallway', ' discarded', ' apple', ' apple', ' travelled', ' before', ' bathroom', ' Sandra', ' hallway'], 'evidence_proportions': [4.845865885416667, 1.8028157552083333, 6.82861328125, 0.99033203125]}}, 'pred_res': 'kitchen<|eot_id|>', 'score': 0}
2025-01-22 06:00:56.575 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:00:56.577 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-80_pid-2_3-5-6-9.pkl | len: 3 |  size: 2.05 KB
Processing depth (3, 5, 6, 9):   3%|▎         | 3/100 [01:02<33:21, 20.64s/it]is_0k: False
your chose emoji: ['😝', '🛳️', '🎄', '💁🏻\u200d♀', '🇨🇩', '👸🏾', '👯\u200d♂', '✊🏻', '🚶🏽\u200d➡️', '👁\u200d🗨️']
emoji:
O: 😝 [76460, 251]
N: 😝 [76460, 251]

O: 🛳️ [9468, 249, 111, 31643]
N: 🇨🇩 [9468, 229, 101, 9468, 229, 102]

O: 🎄 [9468, 236, 226]
N: 🚶🏽‍➡️ [9468, 248, 114, 9468, 237, 121, 102470, 98115, 94, 31643]

O: 💁🏻‍♀ [93273, 223, 9468, 237, 119, 102470, 32990]
N: 🎄 [9468, 236, 226]

O: 🇨🇩 [9468, 229, 101, 9468, 229, 102]
N: ✊🏻 [38798, 232, 9468, 237, 119]

O: 👸🏾 [9468, 110848, 9468, 237, 122]
N: 👸🏾 [9468, 110848, 9468, 237, 122]

O: 👯‍♂ [9468, 239, 107, 102470, 17245, 224]
N: 💁🏻‍♀ [93273, 223, 9468, 237, 119, 102470, 32990]

O: ✊🏻 [38798, 232, 9468, 237, 119]
N: 👯‍♂ [9468, 239, 107, 102470, 17245, 224]

O: 🚶🏽‍➡️ [9468, 248, 114, 9468, 237, 121, 102470, 98115, 94, 31643]
N: 🛳️ [9468, 249, 111, 31643]

O: 👁‍🗨️ [9468, 239, 223, 102470, 9468, 245, 101, 31643]
N: 👁‍🗨️ [9468, 239, 223, 102470, 9468, 245, 101, 31643]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.70s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.81s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.55s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.14s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.70s/it]
Processing depth (1, 3, 4, 9):   3%|▎         | 3/100 [01:19<33:21, 20.64s/it]2025-01-22 06:01:13.301 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra journeyed to the office.
2025-01-22 06:01:13.306 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (909, 915) --> . Sandra journeyed to the
2025-01-22 06:01:13.306 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the hallway.
2025-01-22 06:01:13.322 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3005, 3011) -->  tragedy. Sandra went back to
2025-01-22 06:01:13.322 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra discarded the apple.
2025-01-22 06:01:13.340 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3691, 3695) -->  Sandra discarded the apple
2025-01-22 06:01:13.340 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 06:01:13.360 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3928, 3933) -->  John went back to the
2025-01-22 06:01:13.360 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the kitchen.
2025-01-22 06:01:13.377 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3095, 3101) --> . Mary journeyed to the
2025-01-22 06:01:13.377 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the hallway.
2025-01-22 06:01:13.378 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (231, 237) --> . John journeyed to the
2025-01-22 06:01:13.378 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary travelled to the bathroom.
2025-01-22 06:01:13.393 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2942, 2947) --> . Mary travelled to the
2025-01-22 06:01:13.394 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the bedroom.
2025-01-22 06:01:13.395 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (231, 237) --> . John journeyed to the
2025-01-22 06:01:13.395 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went back to the garden.
2025-01-22 06:01:13.415 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3927, 3933) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:01:14.260 | INFO     | test_jbb_embedding:begin_test:693 - Sandra's hand<|eot_id|>
2025-01-22 06:01:14.260 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8198])
2025-01-22 06:01:16.504 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [307.1145833333333, 40.98128048780488, 373.5226293103448, 39.11226226993865, 22.22317543512658], 'topk_indices': array([8109, 8124,    1,  234, 8052,   14, 8189, 3092,    3,   24, 8196,
       8125,  238, 3116, 8193, 8126, 8186, 8188,  237,    0]), 'topk_tokens': [' the', ' moved', '<|start_header_id|>', 'ed', ' context', '\n', '?', ' of', '<|end_header_id|>', '\n\n', '<|end_header_id|>', ' to', '.', 'ern', '<|eot_id|>', ' the', ' before', ' hallway', ' hallway', '<|begin_of_text|>'], 'evidence_proportions': [459.4166666666667, 220.578125, 511.5625, 64.6375]}, 'weight': {'score': [24.79873511904762, 23.28915586890244, 19.91325431034483, 23.29727856595092, 29.41653481012658], 'topk_indices': array([3323, 3296, 3216, 3168, 7451, 7489, 1482, 1420, 4375, 4359, 5176,
       5237, 7228, 7172, 3505, 3531, 5001, 5030, 4972, 4947]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.213541666666668, 26.709635416666668, 30.615234375, 22.1546875]}, 'saliency': {'score': [2.0484386625744047, 0.2325797774152058, 1.9432962351831897, 0.22181366528470092, 0.16439490982248814], 'topk_indices': array([8189, 2947, 2944, 8185, 3115,   24, 3012, 3052, 3694,  233,  310,
       3692, 8124, 8052, 3091,  910, 3116, 8186, 8188,  237]), 'topk_tokens': ['?', ' bathroom', ' travelled', ' apple', ' const', '\n\n', ' hallway', ' July', ' apple', ' journey', ' bedroom', ' discarded', ' moved', ' context', ' Fourth', ' Sandra', 'ern', ' before', ' hallway', ' hallway'], 'evidence_proportions': [2.7572428385416665, 1.3837483723958333, 4.06201171875, 0.3846435546875]}}, 'pred_res': "Sandra's hand<|eot_id|>", 'score': 0}
2025-01-22 06:01:16.517 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:01:16.518 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-80_pid-3_1-3-4-9.pkl | len: 3 |  size: 2.04 KB
Processing depth (1, 3, 4, 9):   4%|▍         | 4/100 [01:22<32:34, 20.36s/it]is_0k: False
your chose emoji: ['🚇', '😚', '🇵🇭', '👩🏻\u200d❤\u200d👨🏽', '👮🏼', '👨\u200d🦽\u200d➡', '👊🏽', '🚶🏿\u200d♀️\u200d➡️', '👨🏼\u200d❤\u200d👨🏻', '🌻']
emoji:
O: 🚇 [9468, 248, 229]
N: 👩🏻‍❤‍👨🏽 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 121]

O: 😚 [76460, 248]
N: 🚶🏿‍♀️‍➡️ [9468, 248, 114, 9468, 237, 123, 102470, 32990, 31643, 102470, 98115, 94, 31643]

O: 🇵🇭 [9468, 229, 113, 9468, 229, 255]
N: 👨🏼‍❤‍👨🏻 [9468, 239, 101, 9468, 237, 120, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 119]

O: 👩🏻‍❤‍👨🏽 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 121]
N: 😚 [76460, 248]

O: 👮🏼 [9468, 239, 106, 9468, 237, 120]
N: 👊🏽 [9468, 239, 232, 9468, 237, 121]

O: 👨‍🦽‍➡ [9468, 239, 101, 102470, 9468, 99, 121, 102470, 98115, 94]
N: 🚇 [9468, 248, 229]

O: 👊🏽 [9468, 239, 232, 9468, 237, 121]
N: 🇵🇭 [9468, 229, 113, 9468, 229, 255]

O: 🚶🏿‍♀️‍➡️ [9468, 248, 114, 9468, 237, 123, 102470, 32990, 31643, 102470, 98115, 94, 31643]
N: 👮🏼 [9468, 239, 106, 9468, 237, 120]

O: 👨🏼‍❤‍👨🏻 [9468, 239, 101, 9468, 237, 120, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 119]
N: 👨‍🦽‍➡ [9468, 239, 101, 102470, 9468, 99, 121, 102470, 98115, 94]

O: 🌻 [9468, 234, 119]
N: 🌻 [9468, 234, 119]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.69s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.52s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.19s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.82s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.41s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 2, 5, 8):   4%|▍         | 4/100 [01:37<32:34, 20.36s/it]2025-01-22 06:01:31.942 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra journeyed to the office.
2025-01-22 06:01:31.942 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (32, 38) -->  journeyed to the office.
2025-01-22 06:01:31.942 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the hallway.
2025-01-22 06:01:31.952 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1807, 1813) --> . Sandra went back to the
2025-01-22 06:01:31.952 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra discarded the apple.
2025-01-22 06:01:31.974 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4240, 4244) -->  discarded the apple.
2025-01-22 06:01:31.974 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went to the office.
2025-01-22 06:01:31.996 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3858, 3863) -->  John went back to the
2025-01-22 06:01:31.996 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the kitchen.
2025-01-22 06:01:32.011 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3005, 3011) -->  tragedy. Mary journeyed to
2025-01-22 06:01:32.011 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the hallway.
2025-01-22 06:01:32.013 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (239, 245) --> . John journeyed to the
2025-01-22 06:01:32.013 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary travelled to the bathroom.
2025-01-22 06:01:32.029 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2886, 2891) --> . Mary travelled to the
2025-01-22 06:01:32.029 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the bedroom.
2025-01-22 06:01:32.030 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (239, 245) --> . John journeyed to the
2025-01-22 06:01:32.031 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went back to the garden.
2025-01-22 06:01:32.051 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3857, 3863) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:01:36.100 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 06:01:36.100 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8183])
2025-01-22 06:01:39.346 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [567.7321428571429, 52.3550167990226, 421.1438577586207, 49.70992816533497, 62.615591989436616], 'topk_indices': array([4258, 4242, 8166, 8037, 8174,   24, 4268, 8167, 8181, 8168,   14,
       8173, 8170, 4257, 4259, 8171, 4256,    0, 8178, 8179]), 'topk_tokens': [' Cl', ' apple', ':', ' context', '?', '\n\n', 'ree', ' Where', '<|end_header_id|>', ' was', '\n', ' hallway', ' apple', 'ch', 'outs', ' before', 'ree', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [705.0416666666666, 365.875, 956.875, 333.875]}, 'weight': {'score': [21.50483630952381, 23.277840562003664, 20.91460129310345, 23.290842040565458, 29.504181338028168], 'topk_indices': array([3336, 3309, 3209, 3161, 7418, 7456, 1505, 1443, 4336, 4320, 5212,
       5151, 7191, 7135, 3492, 3518, 4953, 5005, 4928, 4976]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.541666666666668, 21.869791666666668, 23.08984375, 22.1546875]}, 'saliency': {'score': [3.3465401785714284, 0.29291428441890655, 2.208672885237069, 0.27820215864128767, 0.44581453565140844], 'topk_indices': array([  24, 8174,   32, 8168, 4270, 8165, 6645, 4258, 8037, 4242, 4240,
       4268, 8167, 4257,  245, 8170, 8171, 8173, 4259, 4256]), 'topk_tokens': ['\n\n', '?', ' journey', ' was', ' Cl', 'Question', ' went', ' Cl', ' context', ' apple', ' discarded', 'ree', ' Where', 'ch', ' hallway', ' apple', ' before', ' hallway', 'outs', 'ree'], 'evidence_proportions': [3.6617838541666665, 2.231689453125, 6.100830078125, 2.10263671875]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 0}
2025-01-22 06:01:39.351 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:01:39.351 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-80_pid-4_0-2-5-8.pkl | len: 3 |  size: 2.0 KB
Processing depth (0, 2, 5, 8):   5%|▌         | 5/100 [01:45<33:39, 21.25s/it]Processing depth (0, 2, 5, 8):   5%|▌         | 5/100 [01:45<33:20, 21.05s/it]
2025-01-22 06:01:39.432 | INFO     | __main__:<module>:82 - Selected idx: 81
2025-01-22 06:01:39.432 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the location prior to the place where the football was discarded, left or dropped?
2025-01-22 06:01:39.432 | INFO     | __main__:<module>:84 - Answer: office
2025-01-22 06:01:39.432 | INFO     | __main__:<module>:85 - Tag: 4-hop
2025-01-22 06:01:39.432 | INFO     | __main__:<module>:86 - Needle: [' John journeyed to the hallway.', ' Sandra journeyed to the office.', ' John journeyed to the bedroom.', ' John went back to the garden.', ' Mary travelled to the bathroom.', ' Sandra grabbed the football.', ' Sandra went back to the hallway.', ' Mary journeyed to the kitchen.', ' Sandra discarded the football.', ' John went to the office.']
2025-01-22 06:01:39.432 | INFO     | __main__:<module>:87 - Real Needle: [' Sandra journeyed to the office.', ' Sandra grabbed the football.', ' Sandra went back to the hallway.', ' Sandra discarded the football.', ' John went to the office.']
2025-01-22 06:01:39.432 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['👩🏻\u200d🎤', '🧑\u200d🦽', '🗑', '🥍', '👨🏾\u200d❤️\u200d👨🏾', '😤', '👨🏾\u200d🎤', '📇', '🙍🏻\u200d♀', '💆🏻\u200d♂️']
emoji:
O: 👩🏻‍🎤 [9468, 239, 102, 9468, 237, 119, 102470, 9468, 236, 97]
N: ♀🙍🏻‍ [32990, 9468, 247, 235, 9468, 237, 119, 102470]

O: 🧑‍🦽 [9468, 100, 239, 102470, 9468, 99, 121]
N: �� [229, 9468, 241]

O: 🗑 [9468, 245, 239]
N: �👩🏻‍� [97, 9468, 239, 102, 9468, 237, 119, 102470, 9468, 236]

O: 🥍 [9468, 98, 235]
N: �🧑‍� [121, 9468, 100, 239, 102470, 9468, 99]

O: 👨🏾‍❤️‍👨🏾 [9468, 239, 101, 9468, 237, 122, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 122]
N: �� [239, 9468, 245]

O: 😤 [76460, 97]
N: �👨🏾‍� [97, 9468, 239, 101, 9468, 237, 122, 102470, 9468, 236]

O: 👨🏾‍🎤 [9468, 239, 101, 9468, 237, 122, 102470, 9468, 236, 97]
N: �👨🏾‍❤️‍👨� [122, 9468, 239, 101, 9468, 237, 122, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237]

O: 📇 [9468, 241, 229]
N: �� [97, 76460]

O: 🙍🏻‍♀ [9468, 247, 235, 9468, 237, 119, 102470, 32990]
N: �� [235, 9468, 98]

O: 💆🏻‍♂️ [93273, 228, 9468, 237, 119, 102470, 17245, 224, 31643]
N: ️💆🏻‍♂ [31643, 93273, 228, 9468, 237, 119, 102470, 17245, 224]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.85s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.89s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.48s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.07s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.67s/it]
Processing depth (0, 3, 7, 8, 9):   0%|          | 0/100 [00:16<?, ?it/s]2025-01-22 06:01:55.917 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra journeyed to the office.
2025-01-22 06:01:55.918 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (32, 38) -->  journeyed to the office.
2025-01-22 06:01:55.918 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra grabbed the football.
2025-01-22 06:01:55.932 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2882, 2886) -->  Sandra grabbed the football
2025-01-22 06:01:55.932 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the hallway.
2025-01-22 06:01:55.960 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5588, 5594) --> . Sandra went back to the
2025-01-22 06:01:55.960 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra discarded the football.
2025-01-22 06:01:55.992 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6475, 6479) -->  Sandra discarded the football
2025-01-22 06:01:55.992 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went to the office.
2025-01-22 06:01:56.030 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6802, 6807) -->  John went back to the
2025-01-22 06:01:56.030 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John journeyed to the hallway.
2025-01-22 06:01:56.045 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2885, 2891) -->  football. John journeyed to
2025-01-22 06:01:56.045 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bedroom.
2025-01-22 06:01:56.062 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2885, 2891) -->  football. John journeyed to
2025-01-22 06:01:56.063 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the garden.
2025-01-22 06:01:56.096 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6801, 6807) --> . John went back to the
2025-01-22 06:01:56.097 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary travelled to the bathroom.
2025-01-22 06:01:56.098 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (363, 368) --> . Mary travelled to the
2025-01-22 06:01:56.099 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary journeyed to the kitchen.
2025-01-22 06:01:56.131 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5593, 5599) -->  the hallway. Mary journeyed
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:01:56.937 | INFO     | test_jbb_embedding:begin_test:693 - The hallway.<|eot_id|>
2025-01-22 06:01:56.937 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8167])
2025-01-22 06:01:59.170 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [449.58, 48.019899926551595, 352.4676724137931, 45.694824399260625, 29.284528459821427], 'topk_indices': array([6475, 8086, 8046,   29,    3, 7431,   23, 6479, 2886, 7499, 8152,
       6476,   14, 7620,   24, 7500, 7544, 7545, 8162,    0]), 'topk_tokens': [' Sandra', ' the', '.\n\n', '\n\n', '<|end_header_id|>', 'nes', '4', '.', '.', ' Min', ' football', ' discarded', '\n', ' or', '\n\n', 'nes', ' Min', 'nes', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [457.625, 551.0625, 328.1666666666667, 787.4375, 234.15]}, 'weight': {'score': [24.1103125, 23.249089545844043, 22.36584051724138, 23.249592768022183, 29.087332589285715], 'topk_indices': array([3317, 3290, 3162, 3210, 7399, 7437, 1413, 1475, 4295, 4279, 5175,
       5114, 7176, 7120, 3499, 3473, 4891, 4916, 4939, 4968]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.541666666666668, 30.005859375, 21.869791666666668, 30.873046875, 22.1546875]}, 'saliency': {'score': [3.025390625, 0.2719558601879055, 2.006322400323276, 0.2572753304547905, 0.21669060843331472], 'topk_indices': array([7352, 8160, 2892, 2882,   40, 8140, 6478, 2885,   24, 7431, 7375,
       7620, 5594, 7499, 6475, 8152, 6476, 7500, 7544, 7545]), 'topk_tokens': ['nes', 'Answer', ' hallway', ' Sandra', '***', 'Question', ' football', ' football', '\n\n', 'nes', ' tele', ' or', ' hallway', ' Min', ' Sandra', ' football', ' discarded', 'nes', ' Min', 'nes'], 'evidence_proportions': [2.3692220052083335, 4.322021484375, 1.8932291666666667, 6.4814453125, 1.36923828125]}}, 'pred_res': 'The hallway.<|eot_id|>', 'score': 0}
2025-01-22 06:01:59.177 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:01:59.177 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-81_pid-0_0-3-7-8-9.pkl | len: 3 |  size: 2.04 KB
Processing depth (0, 3, 7, 8, 9):   1%|          | 1/100 [00:19<32:25, 19.65s/it]is_0k: False
your chose emoji: ['🕕', '🇪🇪', '🦹🏽', '🧛🏻', '🧝🏾\u200d♀', '🌏', '🧙\u200d♀', '💂🏼\u200d♀', '🥓', '🚣🏽\u200d♂']
emoji:
O: 🕕 [9468, 243, 243]
N: ♀💂🏼‍ [32990, 93273, 224, 9468, 237, 120, 102470]

O: 🇪🇪 [9468, 229, 103, 9468, 229, 103]
N: �� [241, 9468, 98]

O: 🦹🏽 [9468, 99, 117, 9468, 237, 121]
N: �🇪� [103, 9468, 229, 103, 9468, 229]

O: 🧛🏻 [9468, 100, 249, 9468, 237, 119]
N: ♀🧙‍ [32990, 9468, 100, 247, 102470]

O: 🧝🏾‍♀ [9468, 100, 251, 9468, 237, 122, 102470, 32990]
N: �🧛� [119, 9468, 100, 249, 9468, 237]

O: 🌏 [9468, 234, 237]
N: �🦹� [121, 9468, 99, 117, 9468, 237]

O: 🧙‍♀ [9468, 100, 247, 102470, 32990]
N: �� [237, 9468, 234]

O: 💂🏼‍♀ [93273, 224, 9468, 237, 120, 102470, 32990]
N: �� [243, 9468, 243]

O: 🥓 [9468, 98, 241]
N: ♀🧝🏾‍ [32990, 9468, 100, 251, 9468, 237, 122, 102470]

O: 🚣🏽‍♂ [9468, 248, 96, 9468, 237, 121, 102470, 17245, 224]
N: �🚣🏽‍� [224, 9468, 248, 96, 9468, 237, 121, 102470, 17245]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.49s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.95s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.73s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.22s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.78s/it]
Processing depth (0, 1, 2, 5, 6):   1%|          | 1/100 [00:36<32:25, 19.65s/it]2025-01-22 06:02:16.041 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra journeyed to the office.
2025-01-22 06:02:16.041 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (32, 38) -->  journeyed to the office.
2025-01-22 06:02:16.041 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra grabbed the football.
2025-01-22 06:02:16.045 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (830, 834) -->  Sandra grabbed the football
2025-01-22 06:02:16.045 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the hallway.
2025-01-22 06:02:16.054 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1806, 1812) --> . Sandra went back to the
2025-01-22 06:02:16.055 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra discarded the football.
2025-01-22 06:02:16.074 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4168, 4172) -->  Sandra discarded the football
2025-01-22 06:02:16.074 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went to the office.
2025-01-22 06:02:16.097 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4664, 4669) --> . John went to the
2025-01-22 06:02:16.097 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John journeyed to the hallway.
2025-01-22 06:02:16.112 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2906, 2912) -->  John journeyed to the hallway
2025-01-22 06:02:16.112 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bedroom.
2025-01-22 06:02:16.126 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2907, 2913) -->  journeyed to the hallway.
2025-01-22 06:02:16.126 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the garden.
2025-01-22 06:02:16.160 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6921, 6927) --> . John went back to the
2025-01-22 06:02:16.160 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary travelled to the bathroom.
2025-01-22 06:02:16.162 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (311, 316) --> . Mary travelled to the
2025-01-22 06:02:16.162 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary journeyed to the kitchen.
2025-01-22 06:02:16.190 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5636, 5642) --> . Mary journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:02:16.986 | INFO     | test_jbb_embedding:begin_test:693 - The hallway.<|eot_id|>
2025-01-22 06:02:16.986 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8207])
2025-01-22 06:02:19.246 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [396.06, 44.18697466195639, 228.01778017241378, 42.45455050582465, 41.68503289473684], 'topk_indices': array([4669,   68,    3, 8086, 8180, 8179,  833, 2363,  316, 8181, 8052,
         24,   14,   69, 2364,  107,   70, 8202,    0, 8203]), 'topk_tokens': [' office', ' P', '<|end_header_id|>', '.\n\n', 'Question', '.\n\n', ' football', '\n', ' bathroom', ':', ' context', '\n\n', '\n', 'ION', 'the', 'ION', 'E', '<|eot_id|>', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [573.0, 498.375, 221.22916666666666, 384.65625, 320.8]}, 'weight': {'score': [23.406875, 23.285646851017177, 21.349407327586206, 23.292160675965665, 29.52528782894737], 'topk_indices': array([3329, 3356, 3249, 3201, 7445, 7483, 1504, 1442, 4337, 4353, 5168,
       5229, 7222, 7166, 3556, 3530, 4993, 5022, 4945, 4970]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.541666666666668, 30.005859375, 21.869791666666668, 30.873046875, 18.6375]}, 'saliency': {'score': [2.41388671875, 0.2477430598514207, 1.3548752357219827, 0.23716544800927344, 0.2990463658383018], 'topk_indices': array([  32, 8194,    0, 4169,   40, 8192, 4669, 2266, 2412, 8186,  313,
       1812,  833,   70, 8180, 8052, 2364,  107,   69,  316]), 'topk_tokens': [' journey', ' discarded', '<|begin_of_text|>', ' discarded', '***', ' football', ' office', ' shore', 'little', ' prior', ' travelled', ' hallway', ' football', 'E', 'Question', ' context', 'the', 'ION', 'ION', ' bathroom'], 'evidence_proportions': [2.8857421875, 3.82470703125, 1.2372233072916667, 3.1578369140625, 1.53583984375]}}, 'pred_res': 'The hallway.<|eot_id|>', 'score': 0}
2025-01-22 06:02:19.261 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:02:19.261 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-81_pid-1_0-1-2-5-6.pkl | len: 3 |  size: 2.09 KB
Processing depth (0, 1, 2, 5, 6):   2%|▏         | 2/100 [00:39<32:30, 19.91s/it]is_0k: False
your chose emoji: ['🏃🏽\u200d♀️', '🪢', '🪣', '🧝🏼\u200d♂', '🥦', '🦹🏽\u200d♂️', '🧑🏽\u200d🦽', '👩🏼\u200d❤️\u200d👨🏾', '🐻\u200d❄️', '🇧🇬']
emoji:
O: 🏃🏽‍♀️ [9468, 237, 225, 9468, 237, 121, 102470, 32990, 31643]
N: �� [96, 9468, 103]

O: 🪢 [9468, 103, 95]
N: ️🏃🏽‍♀ [31643, 9468, 237, 225, 9468, 237, 121, 102470, 32990]

O: 🪣 [9468, 103, 96]
N: ️🦹🏽‍♂ [31643, 9468, 99, 117, 9468, 237, 121, 102470, 17245, 224]

O: 🧝🏼‍♂ [9468, 100, 251, 9468, 237, 120, 102470, 17245, 224]
N: �🧑🏽‍� [121, 9468, 100, 239, 9468, 237, 121, 102470, 9468, 99]

O: 🥦 [9468, 98, 99]
N: �🧝🏼‍� [224, 9468, 100, 251, 9468, 237, 120, 102470, 17245]

O: 🦹🏽‍♂️ [9468, 99, 117, 9468, 237, 121, 102470, 17245, 224, 31643]
N: �� [99, 9468, 98]

O: 🧑🏽‍🦽 [9468, 100, 239, 9468, 237, 121, 102470, 9468, 99, 121]
N: ️🐻‍❄ [31643, 9468, 238, 119, 102470, 49633, 226]

O: 👩🏼‍❤️‍👨🏾 [9468, 239, 102, 9468, 237, 120, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 122]
N: �� [95, 9468, 103]

O: 🐻‍❄️ [9468, 238, 119, 102470, 49633, 226, 31643]
N: �👩🏼‍❤️‍👨� [122, 9468, 239, 102, 9468, 237, 120, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237]

O: 🇧🇬 [9468, 229, 100, 9468, 229, 105]
N: �🇧� [105, 9468, 229, 100, 9468, 229]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.30s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.67s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.54s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  2.97s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.55s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (1, 2, 3, 5, 9):   2%|▏         | 2/100 [00:55<32:30, 19.91s/it]2025-01-22 06:02:35.258 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra journeyed to the office.
2025-01-22 06:02:35.264 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (901, 907) --> . Sandra journeyed to the
2025-01-22 06:02:35.264 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra grabbed the football.
2025-01-22 06:02:35.275 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2013, 2017) -->  Sandra grabbed the football
2025-01-22 06:02:35.276 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the hallway.
2025-01-22 06:02:35.291 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2972, 2978) -->  tragedy. Sandra went back to
2025-01-22 06:02:35.292 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra discarded the football.
2025-01-22 06:02:35.314 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4232, 4236) -->  discarded the football.
2025-01-22 06:02:35.314 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went to the office.
2025-01-22 06:02:35.351 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6911, 6916) -->  John went back to the
2025-01-22 06:02:35.351 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John journeyed to the hallway.
2025-01-22 06:02:35.369 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2977, 2983) -->  to the hallway. John journey
2025-01-22 06:02:35.369 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bedroom.
2025-01-22 06:02:35.385 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2978, 2984) -->  the hallway. John journeyed
2025-01-22 06:02:35.386 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the garden.
2025-01-22 06:02:35.402 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2976, 2982) -->  back to the hallway. John
2025-01-22 06:02:35.402 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary travelled to the bathroom.
2025-01-22 06:02:35.404 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (355, 360) --> . Mary travelled to the
2025-01-22 06:02:35.405 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary journeyed to the kitchen.
2025-01-22 06:02:35.442 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5641, 5647) --> . Mary journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:02:38.916 | INFO     | test_jbb_embedding:begin_test:693 - the hallway<|eot_id|>
2025-01-22 06:02:38.916 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8170])
2025-01-22 06:02:41.998 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [392.8425, 38.23541513705335, 336.57974137931035, 36.07759762256713, 30.48188308189655], 'topk_indices': array([ 357,    3, 4234, 2979, 2016, 8049,  903, 8166,  902, 2017, 8014,
        361,   24,  904,   14,  257,  360, 8015, 8165,    0]), 'topk_tokens': [' travelled', '<|end_header_id|>', ' football', ' hallway', ' football', '.\n\n', ' journey', '<|start_header_id|>', ' Sandra', '.', ' you', '.', '\n\n', 'ed', '\n', 'hue', ' bathroom', ' context', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [663.0, 508.1875, 227.77604166666666, 553.0, 46.33125]}, 'weight': {'score': [24.4690625, 23.252759040014684, 21.90247844827586, 23.253836959534368, 29.084321120689655], 'topk_indices': array([3297, 3270, 3183, 3135, 7400, 7438, 1412, 1474, 4298, 4282, 5186,
       5125, 7095, 7151, 3491, 3465, 4967, 4938, 4909, 4884]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.213541666666668, 30.005859375, 26.709635416666668, 23.34765625, 22.1546875]}, 'saliency': {'score': [2.54236328125, 0.21614123254328807, 2.0922009698275863, 0.20227559031627249, 0.22183806320716595], 'topk_indices': array([8013, 8159,  904, 8143, 8014, 8149, 2018, 8157,  907, 8155, 4232,
       4234, 2016,  903,  357, 2979,  902,  257, 8015,  360]), 'topk_tokens': [' provided', ' left', 'ed', 'Question', ' you', ' prior', '�', ' discarded', ' office', ' football', ' discarded', ' football', ' football', ' journey', ' travelled', ' hallway', ' Sandra', 'hue', ' context', ' bathroom'], 'evidence_proportions': [3.8837890625, 3.94189453125, 1.4667154947916667, 3.590087890625, 0.265625]}}, 'pred_res': 'the hallway<|eot_id|>', 'score': 0}
2025-01-22 06:02:42.003 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:02:42.003 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-81_pid-2_1-2-3-5-9.pkl | len: 3 |  size: 2.11 KB
Processing depth (1, 2, 3, 5, 9):   3%|▎         | 3/100 [01:02<34:16, 21.20s/it]is_0k: False
your chose emoji: ['🦹\u200d♀', '🇹🇩', '\U0001fac4🏼', '🧗🏽\u200d♀', '🐦\u200d⬛', '👨🏽\u200d🍳', '💂\u200d♀', '🐤', '🎹', '🧛🏽']
emoji:
O: 🦹‍♀ [9468, 99, 117, 102470, 32990]
N: 🎹 [9468, 236, 117]

O: 🇹🇩 [9468, 229, 117, 9468, 229, 102]
N: 🫄🏼 [9468, 104, 226, 9468, 237, 120]

O: 🫄🏼 [9468, 104, 226, 9468, 237, 120]
N: 🧗🏽‍♀ [9468, 100, 245, 9468, 237, 121, 102470, 32990]

O: 🧗🏽‍♀ [9468, 100, 245, 9468, 237, 121, 102470, 32990]
N: 🐦‍⬛ [9468, 238, 99, 102470, 158, 105, 249]

O: 🐦‍⬛ [9468, 238, 99, 102470, 158, 105, 249]
N: 🐤 [9468, 238, 97]

O: 👨🏽‍🍳 [9468, 239, 101, 9468, 237, 121, 102470, 9468, 235, 111]
N: 🇹🇩 [9468, 229, 117, 9468, 229, 102]

O: 💂‍♀ [93273, 224, 102470, 32990]
N: 🦹‍♀ [9468, 99, 117, 102470, 32990]

O: 🐤 [9468, 238, 97]
N: 👨🏽‍🍳 [9468, 239, 101, 9468, 237, 121, 102470, 9468, 235, 111]

O: 🎹 [9468, 236, 117]
N: 💂‍♀ [93273, 224, 102470, 32990]

O: 🧛🏽 [9468, 100, 249, 9468, 237, 121]
N: 🧛🏽 [9468, 100, 249, 9468, 237, 121]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.11s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.47s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.45s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.15s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.60s/it]
Processing depth (0, 1, 6, 7, 9):   3%|▎         | 3/100 [01:18<34:16, 21.20s/it]2025-01-22 06:02:58.066 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra journeyed to the office.
2025-01-22 06:02:58.066 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (32, 38) -->  journeyed to the office.
2025-01-22 06:02:58.066 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra grabbed the football.
2025-01-22 06:02:58.070 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (836, 840) -->  Sandra grabbed the football
2025-01-22 06:02:58.070 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the hallway.
2025-01-22 06:02:58.096 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4718, 4724) --> . Sandra went back to the
2025-01-22 06:02:58.096 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra discarded the football.
2025-01-22 06:02:58.127 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5604, 5608) -->  Sandra discarded the football
2025-01-22 06:02:58.127 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went to the office.
2025-01-22 06:02:58.167 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6916, 6921) -->  John went back to the
2025-01-22 06:02:58.167 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John journeyed to the hallway.
2025-01-22 06:02:58.183 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2898, 2904) --> . John journeyed to the
2025-01-22 06:02:58.183 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bedroom.
2025-01-22 06:02:58.198 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2898, 2904) --> . John journeyed to the
2025-01-22 06:02:58.198 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the garden.
2025-01-22 06:02:58.235 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6915, 6921) --> . John went back to the
2025-01-22 06:02:58.235 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary travelled to the bathroom.
2025-01-22 06:02:58.238 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (363, 368) --> . Mary travelled to the
2025-01-22 06:02:58.238 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary journeyed to the kitchen.
2025-01-22 06:02:58.269 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5607, 5613) -->  football. Mary journeyed to
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:02:59.060 | INFO     | test_jbb_embedding:begin_test:693 - The hallway.<|eot_id|>
2025-01-22 06:02:59.060 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8179])
2025-01-22 06:03:01.284 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [530.5375, 57.922205414985946, 347.4396551724138, 55.43526208933186, 49.17326108870968], 'topk_indices': array([ 369, 8177,  840, 8164,   23, 8058, 8166, 5607, 7549, 8159, 7436,
       3049,  839, 8175,   14,   24, 7550, 3050, 8174,    0]), 'topk_tokens': ['.', '<|end_header_id|>', '.', ' football', '4', '.\n\n', ' discarded', ' football', 'nes', ' to', 'ot', 'ball', ' football', '<|start_header_id|>', '\n', '\n\n', 'ot', 'room', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [747.4166666666666, 816.125, 303.6458333333333, 792.625, 104.4125]}, 'weight': {'score': [24.1103125, 23.258369239701747, 20.68615301724138, 23.264927094868955, 29.134576612903224], 'topk_indices': array([3302, 3329, 3222, 3174, 7441, 7403, 1462, 1524, 4305, 4321, 5196,
       5135, 7156, 7100, 3511, 3485, 4977, 4948, 4900, 4925]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.541666666666668, 30.005859375, 21.869791666666668, 30.873046875, 22.1546875]}, 'saliency': {'score': [3.518427734375, 0.3283400144484935, 1.8331593480603448, 0.31315704980312536, 0.3645413306451613], 'topk_indices': array([ 837, 8024, 7436,    0, 8158,   36,   32, 8152,   24, 2904, 7549,
        368, 8164, 3049, 5605, 5607, 7550, 8166,  839, 3050]), 'topk_tokens': [' grabbed', ' context', 'ot', '<|begin_of_text|>', ' prior', ' office', ' journey', 'Question', '\n\n', ' hallway', 'nes', ' bathroom', ' football', 'ball', ' discarded', ' football', 'ot', ' discarded', ' football', 'room'], 'evidence_proportions': [3.9851888020833335, 6.274658203125, 1.830322265625, 6.263671875, 0.582861328125]}}, 'pred_res': 'The hallway.<|eot_id|>', 'score': 0}
2025-01-22 06:03:01.298 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:03:01.299 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-81_pid-3_0-1-6-7-9.pkl | len: 3 |  size: 2.09 KB
Processing depth (0, 1, 6, 7, 9):   4%|▍         | 4/100 [01:21<32:43, 20.45s/it]is_0k: False
your chose emoji: ['🧜🏼\u200d♂️', '👆🏽', '🇵🇸', '🕟', '🇹🇲', '👷\u200d♂', '🇵🇲', '🧎🏾\u200d♂', '🏺', '🏃\u200d♂️']
emoji:
O: 🧜🏼‍♂️ [9468, 100, 250, 9468, 237, 120, 102470, 17245, 224, 31643]
N: �👷‍� [224, 9468, 239, 115, 102470, 17245]

O: 👆🏽 [9468, 239, 228, 9468, 237, 121]
N: ️🧜🏼‍♂ [31643, 9468, 100, 250, 9468, 237, 120, 102470, 17245, 224]

O: 🇵🇸 [9468, 229, 113, 9468, 229, 116]
N: �🇵� [110, 9468, 229, 113, 9468, 229]

O: 🕟 [9468, 243, 253]
N: �� [253, 9468, 243]

O: 🇹🇲 [9468, 229, 117, 9468, 229, 110]
N: �🇵� [116, 9468, 229, 113, 9468, 229]

O: 👷‍♂ [9468, 239, 115, 102470, 17245, 224]
N: �� [118, 9468, 237]

O: 🇵🇲 [9468, 229, 113, 9468, 229, 110]
N: �👆� [121, 9468, 239, 228, 9468, 237]

O: 🧎🏾‍♂ [9468, 100, 236, 9468, 237, 122, 102470, 17245, 224]
N: �🧎🏾‍� [224, 9468, 100, 236, 9468, 237, 122, 102470, 17245]

O: 🏺 [9468, 237, 118]
N: �🇹� [110, 9468, 229, 117, 9468, 229]

O: 🏃‍♂️ [9468, 237, 225, 102470, 17245, 224, 31643]
N: ️🏃‍♂ [31643, 9468, 237, 225, 102470, 17245, 224]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.38s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.60s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.48s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.16s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.65s/it]
Processing depth (2, 4, 7, 8, 9):   4%|▍         | 4/100 [01:38<32:43, 20.45s/it]2025-01-22 06:03:17.719 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra journeyed to the office.
2025-01-22 06:03:17.728 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1749, 1755) --> . Sandra journeyed to the
2025-01-22 06:03:17.728 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra grabbed the football.
2025-01-22 06:03:17.745 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3573, 3577) -->  Sandra grabbed the football
2025-01-22 06:03:17.745 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the hallway.
2025-01-22 06:03:17.773 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5623, 5629) --> . Sandra went back to the
2025-01-22 06:03:17.773 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra discarded the football.
2025-01-22 06:03:17.804 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6544, 6548) -->  Sandra discarded the football
2025-01-22 06:03:17.804 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went to the office.
2025-01-22 06:03:17.838 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6863, 6868) -->  John went back to the
2025-01-22 06:03:17.838 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John journeyed to the hallway.
2025-01-22 06:03:17.852 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2844, 2850) --> . John journeyed to the
2025-01-22 06:03:17.852 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bedroom.
2025-01-22 06:03:17.866 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2844, 2850) --> . John journeyed to the
2025-01-22 06:03:17.866 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the garden.
2025-01-22 06:03:17.911 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6862, 6868) --> . John went back to the
2025-01-22 06:03:17.912 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary travelled to the bathroom.
2025-01-22 06:03:17.914 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (355, 360) --> . Mary travelled to the
2025-01-22 06:03:17.914 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary journeyed to the kitchen.
2025-01-22 06:03:17.942 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5628, 5634) -->  the hallway. Mary journeyed
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:03:18.755 | INFO     | test_jbb_embedding:begin_test:693 - The hallway.<|eot_id|>
2025-01-22 06:03:18.755 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8222])
2025-01-22 06:03:21.021 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [296.32, 33.620052589980546, 218.24137931034483, 32.160870563035495, 21.460565476190474], 'topk_indices': array([ 361, 8196, 8067, 8216, 8207, 8139, 8101, 5629,    9,    1, 8140,
         23,    3, 8221, 8220,   14, 8141,   24, 8217,    0]), 'topk_tokens': ['.', ':', ' context', ':', ' football', ' moved', '.\n\n', ' hallway', ':', '<|start_header_id|>', ' to', '4', '<|end_header_id|>', '\n\n', '<|end_header_id|>', '\n', ' the', '\n\n', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [342.5416666666667, 418.0, 269.1041666666667, 375.125, 113.125]}, 'weight': {'score': [24.5115625, 23.295147966318094, 20.820043103448278, 23.300211329559364, 29.354352678571427], 'topk_indices': array([3324, 3351, 3244, 3196, 7498, 7460, 1447, 1509, 4354, 4338, 5155,
       5216, 7237, 7181, 3537, 3563, 4980, 4957, 4932, 5009]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.213541666666668, 30.005859375, 21.869791666666668, 30.873046875, 22.1546875]}, 'saliency': {'score': [2.012900390625, 0.18797795039670476, 1.2602875808189655, 0.1785874925891218, 0.1576071239653088], 'topk_indices': array([8111, 8201, 8195, 1750,    0, 3573, 8221, 8215,   23, 8067, 3576,
       6545, 8209, 8219, 2850,  360, 8139,   24, 8207, 5629]), 'topk_tokens': [' location', ' prior', 'Question', ' Sandra', '<|begin_of_text|>', ' Sandra', '\n\n', 'Answer', '4', ' context', ' football', ' discarded', ' discarded', 'assistant', ' hallway', ' bathroom', ' moved', '\n\n', ' football', ' hallway'], 'evidence_proportions': [2.0379231770833335, 3.2818603515625, 1.5768229166666667, 3.0472412109375, 0.663525390625]}}, 'pred_res': 'The hallway.<|eot_id|>', 'score': 0}
2025-01-22 06:03:21.030 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:03:21.031 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-81_pid-4_2-4-7-8-9.pkl | len: 3 |  size: 2.09 KB
Processing depth (2, 4, 7, 8, 9):   5%|▌         | 5/100 [01:41<31:58, 20.19s/it]Processing depth (2, 4, 7, 8, 9):   5%|▌         | 5/100 [01:41<32:09, 20.31s/it]
2025-01-22 06:03:21.083 | INFO     | __main__:<module>:82 - Selected idx: 82
2025-01-22 06:03:21.083 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the milk before the bathroom? 
2025-01-22 06:03:21.083 | INFO     | __main__:<module>:84 - Answer: kitchen
2025-01-22 06:03:21.083 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 06:03:21.083 | INFO     | __main__:<module>:86 - Needle: [' Mary journeyed to the kitchen.', ' John journeyed to the bedroom.', ' John journeyed to the hallway.', ' Sandra journeyed to the kitchen.', ' Sandra moved to the bathroom.', ' Sandra left the milk there.', ' John went back to the garden.']
2025-01-22 06:03:21.083 | INFO     | __main__:<module>:87 - Real Needle: [' Sandra journeyed to the kitchen.', ' Sandra moved to the bathroom.', ' Sandra left the milk there.', ' John went back to the garden.']
2025-01-22 06:03:21.083 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['🧏🏼\u200d♀', '🧚🏼\u200d♂️', '🤨', '🍄\u200d🟫', '🇨🇨', '💂🏼\u200d♂', '👨🏽\u200d❤\u200d👨🏾', '🚩', '🧑🏿\u200d❤\u200d💋\u200d🧑🏾', '👳🏿']
emoji:
O: 🧏🏼‍♀ [9468, 100, 237, 9468, 237, 120, 102470, 32990]
N: 🚩 [9468, 248, 102]

O: 🧚🏼‍♂️ [9468, 100, 248, 9468, 237, 120, 102470, 17245, 224, 31643]
N: 💂🏼‍♂ [93273, 224, 9468, 237, 120, 102470, 17245, 224]

O: 🤨 [9468, 97, 101]
N: 🧚🏼‍♂️ [9468, 100, 248, 9468, 237, 120, 102470, 17245, 224, 31643]

O: 🍄‍🟫 [9468, 235, 226, 102470, 9468, 253, 104]
N: 🧏🏼‍♀ [9468, 100, 237, 9468, 237, 120, 102470, 32990]

O: 🇨🇨 [9468, 229, 101, 9468, 229, 101]
N: 🍄‍🟫 [9468, 235, 226, 102470, 9468, 253, 104]

O: 💂🏼‍♂ [93273, 224, 9468, 237, 120, 102470, 17245, 224]
N: 👨🏽‍❤‍👨🏾 [9468, 239, 101, 9468, 237, 121, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 122]

O: 👨🏽‍❤‍👨🏾 [9468, 239, 101, 9468, 237, 121, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 122]
N: 🤨 [9468, 97, 101]

O: 🚩 [9468, 248, 102]
N: 🇨🇨 [9468, 229, 101, 9468, 229, 101]

O: 🧑🏿‍❤‍💋‍🧑🏾 [9468, 100, 239, 9468, 237, 123, 102470, 121643, 102470, 93273, 233, 102470, 9468, 100, 239, 9468, 237, 122]
N: 🧑🏿‍❤‍💋‍🧑🏾 [9468, 100, 239, 9468, 237, 123, 102470, 121643, 102470, 93273, 233, 102470, 9468, 100, 239, 9468, 237, 122]

O: 👳🏿 [9468, 239, 111, 9468, 237, 123]
N: 👳🏿 [9468, 239, 111, 9468, 237, 123]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.82s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.66s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.16s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.74s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.37s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (2, 5, 6, 8):   0%|          | 0/100 [00:15<?, ?it/s]2025-01-22 06:03:36.461 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra journeyed to the kitchen.
2025-01-22 06:03:36.466 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (896, 902) -->  Mary journeyed to the kitchen
2025-01-22 06:03:36.467 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the bathroom.
2025-01-22 06:03:36.491 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4145, 4150) --> . Sandra moved to the
2025-01-22 06:03:36.491 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra left the milk there.
2025-01-22 06:03:36.516 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4707, 4712) --> . Sandra left the milk
2025-01-22 06:03:36.516 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the garden.
2025-01-22 06:03:36.552 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6619, 6625) --> . John went back to the
2025-01-22 06:03:36.553 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the kitchen.
2025-01-22 06:03:36.557 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (895, 901) --> . Mary journeyed to the
2025-01-22 06:03:36.557 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bedroom.
2025-01-22 06:03:36.589 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5579, 5585) --> . John journeyed to the
2025-01-22 06:03:36.589 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the hallway.
2025-01-22 06:03:36.617 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5579, 5585) --> . John journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:03:41.448 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 06:03:41.448 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8192])
2025-01-22 06:03:44.494 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [91.95063920454545, 9.007234784929835, 51.111111111111114, 8.690542611894543, 9.007895865091463], 'topk_indices': array([8184, 8180, 8175, 8041,    1,   28, 8173, 8185,    9,   23,   24,
       8090, 8080, 8186, 8191,   14,    0, 8190, 8188, 8187]), 'topk_tokens': [' \n', ' before', ':', '\n', '<|start_header_id|>', '<|end_header_id|>', '.\n\n', 'Answer', ':', '4', '\n\n', ' location', '.\n\n', ':', '\n\n', '\n', '<|begin_of_text|>', '<|end_header_id|>', '<|start_header_id|>', '<|eot_id|>'], 'evidence_proportions': [107.44791666666667, 132.1125, 124.9625, 15.475260416666666]}, 'weight': {'score': [22.319957386363637, 23.298371720561317, 19.62673611111111, 23.309115381667688, 29.640243902439025], 'topk_indices': array([3289, 3316, 3209, 3161, 7453, 7415, 1488, 1426, 4294, 4310, 5172,
       5111, 7174, 7118, 3498, 3472, 4965, 4913, 4888, 4936]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [24.04296875, 21.040625, 24.23125, 20.0703125]}, 'saliency': {'score': [0.551116943359375, 0.04869492759495119, 0.2625528971354167, 0.046867493162266245, 0.06780001012290396], 'topk_indices': array([   8,   20, 8161, 8173, 4711,   24, 4150,   23, 8184, 8179, 8180,
       1802, 8080, 8174, 8189, 8191, 1797, 8182, 8090, 8185]), 'topk_tokens': [' Date', ' Jul', ' return', '.\n\n', ' milk', '\n\n', ' bathroom', '4', ' \n', ' milk', ' before', ' kitchen', '.\n\n', 'Question', 'assistant', '\n\n', ' Sandra', ' bathroom', ' location', 'Answer'], 'evidence_proportions': [0.6785074869791666, 0.7277587890625, 0.7853515625, 0.081329345703125]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 100}
2025-01-22 06:03:44.514 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:03:44.514 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-82_pid-0_2-5-6-8.pkl | len: 3 |  size: 2.01 KB
Processing depth (2, 5, 6, 8):   1%|          | 1/100 [00:23<38:29, 23.33s/it]is_0k: False
your chose emoji: ['🙍🏿\u200d♀️', '👩🏻\u200d🤝\u200d👩🏿', '🧚🏻\u200d♂️', '🐈', '💁🏻\u200d♀', '🇺🇾', '👿', '🤢', '🤵\u200d♀️', '👨🏻\u200d❤\u200d💋\u200d👨🏾']
emoji:
O: 🙍🏿‍♀️ [9468, 247, 235, 9468, 237, 123, 102470, 32990, 31643]
N: 🧚🏻‍♂️ [9468, 100, 248, 9468, 237, 119, 102470, 17245, 224, 31643]

O: 👩🏻‍🤝‍👩🏿 [9468, 239, 102, 9468, 237, 119, 102470, 9468, 97, 251, 102470, 9468, 239, 102, 9468, 237, 123]
N: 🐈 [9468, 238, 230]

O: 🧚🏻‍♂️ [9468, 100, 248, 9468, 237, 119, 102470, 17245, 224, 31643]
N: 🇺🇾 [9468, 229, 118, 9468, 229, 122]

O: 🐈 [9468, 238, 230]
N: 🤵‍♀️ [9468, 97, 113, 102470, 32990, 31643]

O: 💁🏻‍♀ [93273, 223, 9468, 237, 119, 102470, 32990]
N: 💁🏻‍♀ [93273, 223, 9468, 237, 119, 102470, 32990]

O: 🇺🇾 [9468, 229, 118, 9468, 229, 122]
N: 🤢 [9468, 97, 95]

O: 👿 [9468, 239, 123]
N: 👩🏻‍🤝‍👩🏿 [9468, 239, 102, 9468, 237, 119, 102470, 9468, 97, 251, 102470, 9468, 239, 102, 9468, 237, 123]

O: 🤢 [9468, 97, 95]
N: 👿 [9468, 239, 123]

O: 🤵‍♀️ [9468, 97, 113, 102470, 32990, 31643]
N: 🙍🏿‍♀️ [9468, 247, 235, 9468, 237, 123, 102470, 32990, 31643]

O: 👨🏻‍❤‍💋‍👨🏾 [9468, 239, 101, 9468, 237, 119, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 122]
N: 👨🏻‍❤‍💋‍👨🏾 [9468, 239, 101, 9468, 237, 119, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 122]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.77s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.65s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.60s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.30s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.80s/it]
Processing depth (1, 2, 3, 4):   1%|          | 1/100 [00:40<38:29, 23.33s/it]2025-01-22 06:04:01.429 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra journeyed to the kitchen.
2025-01-22 06:04:01.434 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (815, 821) --> . Sandra journeyed to the
2025-01-22 06:04:01.434 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the bathroom.
2025-01-22 06:04:01.443 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1795, 1800) --> . Sandra moved to the
2025-01-22 06:04:01.443 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra left the milk there.
2025-01-22 06:04:01.457 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2891, 2896) --> . Sandra left the milk
2025-01-22 06:04:01.457 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the garden.
2025-01-22 06:04:01.478 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3624, 3630) -->  Hon. John went back to
2025-01-22 06:04:01.478 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the kitchen.
2025-01-22 06:04:01.483 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (816, 822) -->  Sandra journeyed to the kitchen
2025-01-22 06:04:01.483 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bedroom.
2025-01-22 06:04:01.511 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5582, 5588) --> . John journeyed to the
2025-01-22 06:04:01.512 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the hallway.
2025-01-22 06:04:01.540 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5582, 5588) --> . John journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:04:02.346 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 06:04:02.346 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8196])
2025-01-22 06:04:04.590 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [119.4424715909091, 10.71280987010611, 115.38194444444444, 10.188714150018384, 7.390375046502976], 'topk_indices': array([   3, 8094, 8177, 1800, 8184,    4, 8169,    9,  821, 8190, 8084,
          1, 8050,   23, 8195,   24,   14, 8194,    0, 8191]), 'topk_tokens': ['<|end_header_id|>', ' location', '.\n\n', ' bathroom', ' before', '\n\n', '.', ':', ' kitchen', ':', '.\n\n', '<|start_header_id|>', ' context', '4', '\n\n', '\n\n', '\n', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [194.75, 137.3375, 116.2125, 31.9140625]}, 'weight': {'score': [22.640980113636363, 23.30517250579339, 21.34418402777778, 23.311289680107855, 29.82124255952381], 'topk_indices': array([3287, 3314, 3207, 3159, 7437, 7475, 1493, 1431, 4369, 4353, 5164,
       5225, 7158, 7214, 3496, 3470, 4989, 4941, 4966, 5018]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.213541666666668, 21.040625, 24.23125, 24.076822916666668]}, 'saliency': {'score': [0.6829195889559659, 0.05877875374474021, 0.7240939670138888, 0.05562802789433065, 0.056271416800362725], 'topk_indices': array([  14,  816,   20, 8165, 8168, 2377, 8084, 8195, 8178,   23, 2391,
       8184, 8094,  828,   24, 8189, 8186, 8050, 1800,  821]), 'topk_tokens': ['\n', ' Sandra', ' Jul', ' return', ' directly', 'nes', '.\n\n', '\n\n', 'Question', '4', 'nes', ' before', ' location', ' kitchen', '\n\n', 'Answer', ' bathroom', ' context', ' bathroom', ' kitchen'], 'evidence_proportions': [1.0849609375, 0.764501953125, 0.7218994140625, 0.18040974934895834]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 100}
2025-01-22 06:04:04.595 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:04:04.596 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-82_pid-1_1-2-3-4.pkl | len: 3 |  size: 2.01 KB
Processing depth (1, 2, 3, 4):   2%|▏         | 2/100 [00:43<34:59, 21.42s/it]is_0k: False
your chose emoji: ['📕', '🏃🏻\u200d➡️', '🏃🏽\u200d♀\u200d➡', '👩🏼\u200d🦯\u200d➡', '🤸🏽\u200d♀️', '🤳🏾', '🧙\u200d♂', '🏋🏿\u200d♂', '🏌🏾\u200d♀', '🚶🏿\u200d♂']
emoji:
O: 📕 [9468, 241, 243]
N: 📕 [9468, 241, 243]

O: 🏃🏻‍➡️ [9468, 237, 225, 9468, 237, 119, 102470, 98115, 94, 31643]
N: 🧙‍♂ [9468, 100, 247, 102470, 17245, 224]

O: 🏃🏽‍♀‍➡ [9468, 237, 225, 9468, 237, 121, 102470, 32990, 102470, 98115, 94]
N: 🤸🏽‍♀️ [9468, 97, 116, 9468, 237, 121, 102470, 32990, 31643]

O: 👩🏼‍🦯‍➡ [9468, 239, 102, 9468, 237, 120, 102470, 9468, 99, 107, 102470, 98115, 94]
N: 👩🏼‍🦯‍➡ [9468, 239, 102, 9468, 237, 120, 102470, 9468, 99, 107, 102470, 98115, 94]

O: 🤸🏽‍♀️ [9468, 97, 116, 9468, 237, 121, 102470, 32990, 31643]
N: 🏃🏽‍♀‍➡ [9468, 237, 225, 9468, 237, 121, 102470, 32990, 102470, 98115, 94]

O: 🤳🏾 [9468, 97, 111, 9468, 237, 122]
N: 🤳🏾 [9468, 97, 111, 9468, 237, 122]

O: 🧙‍♂ [9468, 100, 247, 102470, 17245, 224]
N: 🏃🏻‍➡️ [9468, 237, 225, 9468, 237, 119, 102470, 98115, 94, 31643]

O: 🏋🏿‍♂ [9468, 237, 233, 9468, 237, 123, 102470, 17245, 224]
N: 🏌🏾‍♀ [9468, 237, 234, 9468, 237, 122, 102470, 32990]

O: 🏌🏾‍♀ [9468, 237, 234, 9468, 237, 122, 102470, 32990]
N: 🏋🏿‍♂ [9468, 237, 233, 9468, 237, 123, 102470, 17245, 224]

O: 🚶🏿‍♂ [9468, 248, 114, 9468, 237, 123, 102470, 17245, 224]
N: 🚶🏿‍♂ [9468, 248, 114, 9468, 237, 123, 102470, 17245, 224]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.50s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.79s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.36s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.80s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.44s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 1, 3, 4):   2%|▏         | 2/100 [00:59<34:59, 21.42s/it]2025-01-22 06:04:20.265 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra journeyed to the kitchen.
2025-01-22 06:04:20.265 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (32, 38) -->  journeyed to the kitchen.
2025-01-22 06:04:20.265 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the bathroom.
2025-01-22 06:04:20.269 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (790, 795) -->  Sandra moved to the bathroom
2025-01-22 06:04:20.269 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra left the milk there.
2025-01-22 06:04:20.282 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2610, 2615) --> . Sandra left the milk
2025-01-22 06:04:20.282 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the garden.
2025-01-22 06:04:20.300 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3550, 3556) --> . John went back to the
2025-01-22 06:04:20.300 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the kitchen.
2025-01-22 06:04:20.300 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (32, 38) -->  journeyed to the kitchen.
2025-01-22 06:04:20.300 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bedroom.
2025-01-22 06:04:20.327 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5471, 5477) --> . John journeyed to the
2025-01-22 06:04:20.327 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the hallway.
2025-01-22 06:04:20.354 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5471, 5477) --> . John journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:04:23.283 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 06:04:23.283 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8187])
2025-01-22 06:04:26.045 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [135.7869318181818, 10.563261217948718, 81.98958333333333, 10.067482745398774, 13.733645668512658], 'topk_indices': array([  25, 8186, 8170,   23, 8168, 8036,    9, 8041,   28, 8178, 8075,
       8174, 8177,   24, 8185, 8175,   14,    0, 8182, 8183]), 'topk_tokens': ['<|eot_id|>', '\n\n', ':', '4', '.\n\n', '\n', ':', ' context', '<|end_header_id|>', '?', '.\n\n', ' milk', ' bathroom', '\n\n', '<|end_header_id|>', ' before', '\n', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [209.77083333333334, 194.425, 129.95, 17.802083333333332]}, 'weight': {'score': [22.56143465909091, 23.30383470695971, 19.671875, 23.31386023773006, 30.20886075949367], 'topk_indices': array([3332, 3359, 3252, 3204, 7434, 7472, 1526, 1464, 4328, 4344, 5236,
       5175, 7155, 7211, 3541, 3515, 4952, 5029, 5000, 4977]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.1875, 26.7296875, 24.23125, 20.0703125]}, 'saliency': {'score': [0.8455047607421875, 0.05715316381209936, 0.4597507052951389, 0.05413592566741756, 0.10701693764215783], 'topk_indices': array([  32, 8172,   14,   23, 8168,    8, 8180, 8085,   24, 8178, 8075,
       8171,  794,  801, 8169,   36, 8041, 8175, 8174, 8177]), 'topk_tokens': [' journey', ' was', '\n', '4', '.\n\n', ' Date', 'Answer', ' location', '\n\n', '?', '.\n\n', ' Where', ' bathroom', ' kitchen', 'Question', ' kitchen', ' context', ' before', ' milk', ' bathroom'], 'evidence_proportions': [1.1941324869791667, 1.334423828125, 0.8455810546875, 0.08938090006510417]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 100}
2025-01-22 06:04:26.054 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:04:26.054 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-82_pid-2_0-1-3-4.pkl | len: 3 |  size: 2.0 KB
Processing depth (0, 1, 3, 4):   3%|▎         | 3/100 [01:04<34:39, 21.44s/it]is_0k: False
your chose emoji: ['💁🏾\u200d♀️', '👨🏼\u200d❤\u200d💋\u200d👨🏽', '🌥️', '❌', '🕵🏽\u200d♂️', '✌🏽', '👩🏻\u200d❤️\u200d👨🏽', '💇🏻\u200d♀', '⚔', '🧜\u200d♂']
emoji:
O: 💁🏾‍♀️ [93273, 223, 9468, 237, 122, 102470, 32990, 31643]
N: ️💁🏾‍♀ [31643, 93273, 223, 9468, 237, 122, 102470, 32990]

O: 👨🏼‍❤‍💋‍👨🏽 [9468, 239, 101, 9468, 237, 120, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 121]
N: ♀💇🏻‍ [32990, 93273, 229, 9468, 237, 119, 102470]

O: 🌥️ [9468, 234, 98, 31643]
N: ️🌥 [31643, 9468, 234, 98]

O: ❌ [49633, 234]
N: �� [242, 158, 248]

O: 🕵🏽‍♂️ [9468, 243, 113, 9468, 237, 121, 102470, 17245, 224, 31643]
N: �� [234, 49633]

O: ✌🏽 [38798, 234, 9468, 237, 121]
N: �👩🏻‍❤️‍👨� [121, 9468, 239, 102, 9468, 237, 119, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237]

O: 👩🏻‍❤️‍👨🏽 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 121]
N: �✌� [121, 38798, 234, 9468, 237]

O: 💇🏻‍♀ [93273, 229, 9468, 237, 119, 102470, 32990]
N: �👨🏼‍❤‍💋‍👨� [121, 9468, 239, 101, 9468, 237, 120, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237]

O: ⚔ [158, 248, 242]
N: ️🕵🏽‍♂ [31643, 9468, 243, 113, 9468, 237, 121, 102470, 17245, 224]

O: 🧜‍♂ [9468, 100, 250, 102470, 17245, 224]
N: �🧜‍� [224, 9468, 100, 250, 102470, 17245]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:05<00:15,  5.14s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:11<00:11,  5.58s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:16<00:05,  5.42s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:17<00:00,  3.69s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:17<00:00,  4.33s/it]
Processing depth (0, 6, 7, 9):   3%|▎         | 3/100 [01:24<34:39, 21.44s/it]2025-01-22 06:04:45.331 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra journeyed to the kitchen.
2025-01-22 06:04:45.332 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (32, 38) -->  journeyed to the kitchen.
2025-01-22 06:04:45.332 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the bathroom.
2025-01-22 06:04:45.356 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4922, 4927) --> . Sandra moved to the
2025-01-22 06:04:45.356 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra left the milk there.
2025-01-22 06:04:45.387 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5741, 5746) --> . Sandra left the milk
2025-01-22 06:04:45.387 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the garden.
2025-01-22 06:04:45.424 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7283, 7289) -->  cold. John went back to
2025-01-22 06:04:45.425 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the kitchen.
2025-01-22 06:04:45.425 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (32, 38) -->  journeyed to the kitchen.
2025-01-22 06:04:45.425 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bedroom.
2025-01-22 06:04:45.455 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5644, 5650) --> . John journeyed to the
2025-01-22 06:04:45.456 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the hallway.
2025-01-22 06:04:45.484 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5644, 5650) --> . John journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:04:46.250 | INFO     | test_jbb_embedding:begin_test:693 - the kitchen<|eot_id|>
2025-01-22 06:04:46.250 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8205])
2025-01-22 06:04:48.484 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [134.43306107954547, 12.892916971247564, 128.51388888888889, 12.310759691019834, 12.414850408380682], 'topk_indices': array([ 908, 8192,    1,    4, 8103,   28, 8199,   23,  909, 8059, 8193,
       8204,   24,    9, 8093, 8203,   14,    0, 8201, 8200]), 'topk_tokens': [' the', ' milk', '<|start_header_id|>', '\n\n', ' location', '<|end_header_id|>', ':', '4', ' kitchen', ' context', ' before', '\n\n', '\n\n', ':', '.\n\n', '<|end_header_id|>', '\n', '<|begin_of_text|>', '<|start_header_id|>', '<|eot_id|>'], 'evidence_proportions': [231.89583333333334, 109.8, 186.0, 14.525390625]}, 'weight': {'score': [22.182173295454547, 23.311367339790447, 19.671875, 23.322429182480413, 29.854048295454547], 'topk_indices': array([3250, 3277, 3170, 3122, 7412, 7450, 1414, 1476, 4263, 4247, 5177,
       5116, 7176, 7120, 3459, 3433, 4835, 4883, 4912, 4860]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.1875, 21.040625, 24.23125, 23.420572916666668]}, 'saliency': {'score': [0.7708948308771307, 0.07040923566613745, 0.6648356119791666, 0.06721257089284212, 0.09535867517644708], 'topk_indices': array([  40, 8197, 5761, 8204,   23,   24, 8202, 5745,    8, 8198,   14,
         36, 8187, 8093, 8192, 8193, 8103, 8195, 8059,  909]), 'topk_tokens': ['***', ' \n', ' o', '\n\n', '4', '\n\n', 'assistant', ' milk', ' Date', 'Answer', '\n', ' kitchen', 'Question', '.\n\n', ' milk', ' before', ' location', ' bathroom', ' context', ' kitchen'], 'evidence_proportions': [1.2296549479166667, 0.5977294921875, 1.224072265625, 0.07879130045572917]}}, 'pred_res': 'the kitchen<|eot_id|>', 'score': 100}
2025-01-22 06:04:48.490 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:04:48.491 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-82_pid-3_0-6-7-9.pkl | len: 3 |  size: 2.01 KB
Processing depth (0, 6, 7, 9):   4%|▍         | 4/100 [01:27<34:55, 21.83s/it]is_0k: False
your chose emoji: ['🤽🏻\u200d♀️', '🤽', '👨🏿\u200d❤\u200d👨🏼', '💆🏼', '🕴🏾', '👩🏾\u200d❤\u200d💋\u200d👩🏼', '🇭🇹', '🧑\u200d🎤', '🧎\u200d♂️\u200d➡️', '💆🏽\u200d♀️']
emoji:
O: 🤽🏻‍♀️ [9468, 97, 121, 9468, 237, 119, 102470, 32990, 31643]
N: �💆� [120, 93273, 228, 9468, 237]

O: 🤽 [9468, 97, 121]
N: ️🤽🏻‍♀ [31643, 9468, 97, 121, 9468, 237, 119, 102470, 32990]

O: 👨🏿‍❤‍👨🏼 [9468, 239, 101, 9468, 237, 123, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 120]
N: ️🧎‍♂️‍➡ [31643, 9468, 100, 236, 102470, 17245, 224, 31643, 102470, 98115, 94]

O: 💆🏼 [93273, 228, 9468, 237, 120]
N: �👨🏿‍❤‍👨� [120, 9468, 239, 101, 9468, 237, 123, 102470, 121643, 102470, 9468, 239, 101, 9468, 237]

O: 🕴🏾 [9468, 243, 112, 9468, 237, 122]
N: �🇭� [117, 9468, 229, 255, 9468, 229]

O: 👩🏾‍❤‍💋‍👩🏼 [9468, 239, 102, 9468, 237, 122, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 120]
N: �🧑‍� [97, 9468, 100, 239, 102470, 9468, 236]

O: 🇭🇹 [9468, 229, 255, 9468, 229, 117]
N: �🕴� [122, 9468, 243, 112, 9468, 237]

O: 🧑‍🎤 [9468, 100, 239, 102470, 9468, 236, 97]
N: �� [121, 9468, 97]

O: 🧎‍♂️‍➡️ [9468, 100, 236, 102470, 17245, 224, 31643, 102470, 98115, 94, 31643]
N: �👩🏾‍❤‍💋‍👩� [120, 9468, 239, 102, 9468, 237, 122, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237]

O: 💆🏽‍♀️ [93273, 228, 9468, 237, 121, 102470, 32990, 31643]
N: ️💆🏽‍♀ [31643, 93273, 228, 9468, 237, 121, 102470, 32990]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.03s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.63s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.68s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.32s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.77s/it]
Processing depth (3, 4, 5, 8):   4%|▍         | 4/100 [01:44<34:55, 21.83s/it]2025-01-22 06:05:05.278 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra journeyed to the kitchen.
2025-01-22 06:05:05.283 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (896, 902) -->  Mary journeyed to the kitchen
2025-01-22 06:05:05.283 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra moved to the bathroom.
2025-01-22 06:05:05.300 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3608, 3613) -->  Sandra moved to the bathroom
2025-01-22 06:05:05.301 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra left the milk there.
2025-01-22 06:05:05.324 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4204, 4209) -->  Sandra left the milk there
2025-01-22 06:05:05.324 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the garden.
2025-01-22 06:05:05.359 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6615, 6621) --> . John went back to the
2025-01-22 06:05:05.359 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the kitchen.
2025-01-22 06:05:05.364 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (895, 901) --> . Mary journeyed to the
2025-01-22 06:05:05.364 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bedroom.
2025-01-22 06:05:05.392 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5577, 5583) --> . John journeyed to the
2025-01-22 06:05:05.392 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the hallway.
2025-01-22 06:05:05.429 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5577, 5583) --> . John journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:05:06.260 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 06:05:06.261 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8148])
2025-01-22 06:05:08.472 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [99.93039772727273, 10.209448993988469, 82.01736111111111, 9.806736222414006, 11.254459635416667], 'topk_indices': array([7997, 8131, 8139, 8002, 8129,   25, 8142,   23, 8138,   24, 8036,
          9, 8136, 8147, 2978,   14,    0, 8146, 8143, 8144]), 'topk_tokens': ['\n', ':', '?', ' context', '.\n\n', '<|eot_id|>', ':', '4', ' bathroom', '\n\n', '.\n\n', ':', ' before', '\n\n', ' kitchen', '\n', '<|begin_of_text|>', '<|end_header_id|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [114.94791666666667, 139.5, 142.2125, 16.703125]}, 'weight': {'score': [24.305042613636363, 23.263757897803952, 19.62673611111111, 23.26900486222414, 29.614583333333332], 'topk_indices': array([3255, 3282, 3175, 3127, 7367, 7405, 1406, 1468, 4296, 4280, 5097,
       5158, 7076, 7132, 3446, 3472, 4868, 4893, 4945, 4916]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [24.04296875, 26.7296875, 27.2765625, 20.0703125]}, 'saliency': {'score': [0.6551832719282671, 0.054990114865603144, 0.4030829535590278, 0.052589680819017, 0.08293215433756511], 'topk_indices': array([8140, 8129,   24, 8117, 3612, 8046, 8139,   23, 8132,    8, 8036,
       8145, 8147, 8141, 8135, 8002, 8130, 8136, 8138, 2978]), 'topk_tokens': [' \n', '.\n\n', '\n\n', ' return', ' bathroom', ' location', '?', '4', ' Where', ' Date', '.\n\n', 'assistant', '\n\n', 'Answer', ' milk', ' context', 'Question', ' before', ' bathroom', ' kitchen'], 'evidence_proportions': [0.7242838541666666, 0.935888671875, 0.9771484375, 0.08385721842447917]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 100}
2025-01-22 06:05:08.477 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:05:08.477 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-82_pid-4_3-4-5-8.pkl | len: 3 |  size: 1.99 KB
Processing depth (3, 4, 5, 8):   5%|▌         | 5/100 [01:47<33:30, 21.17s/it]Processing depth (3, 4, 5, 8):   5%|▌         | 5/100 [01:47<33:59, 21.47s/it]
2025-01-22 06:05:08.525 | INFO     | __main__:<module>:82 - Selected idx: 83
2025-01-22 06:05:08.525 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the location prior to the place where the apple was discarded, left or dropped?
2025-01-22 06:05:08.525 | INFO     | __main__:<module>:84 - Answer: kitchen
2025-01-22 06:05:08.525 | INFO     | __main__:<module>:85 - Tag: 4-hop
2025-01-22 06:05:08.525 | INFO     | __main__:<module>:86 - Needle: [' Sandra journeyed to the kitchen.', ' John journeyed to the hallway.', ' Sandra took the apple.', ' Mary journeyed to the kitchen.', ' John journeyed to the bedroom.', ' Sandra moved to the bathroom.', ' Sandra left the apple there.', ' John went back to the garden.']
2025-01-22 06:05:08.525 | INFO     | __main__:<module>:87 - Real Needle: [' Sandra journeyed to the kitchen.', ' Sandra took the apple.', ' Sandra moved to the bathroom.', ' Sandra left the apple there.', ' John went back to the garden.']
2025-01-22 06:05:08.525 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['🌦️', '🤽\u200d♂', '🆑', '🧎🏻\u200d♂️\u200d➡️', '🧜🏽\u200d♀', '⚒', '🥫', '🇾🇪', '🤾🏼\u200d♂️', '🗺']
emoji:
O: 🌦️ [9468, 234, 99, 31643]
N: 🧜🏽‍♀ [9468, 100, 250, 9468, 237, 121, 102470, 32990]

O: 🤽‍♂ [9468, 97, 121, 102470, 17245, 224]
N: 🌦️ [9468, 234, 99, 31643]

O: 🆑 [9468, 228, 239]
N: 🥫 [9468, 98, 104]

O: 🧎🏻‍♂️‍➡️ [9468, 100, 236, 9468, 237, 119, 102470, 17245, 224, 31643, 102470, 98115, 94, 31643]
N: 🤾🏼‍♂️ [9468, 97, 122, 9468, 237, 120, 102470, 17245, 224, 31643]

O: 🧜🏽‍♀ [9468, 100, 250, 9468, 237, 121, 102470, 32990]
N: 🆑 [9468, 228, 239]

O: ⚒ [158, 248, 240]
N: 🇾🇪 [9468, 229, 122, 9468, 229, 103]

O: 🥫 [9468, 98, 104]
N: 🤽‍♂ [9468, 97, 121, 102470, 17245, 224]

O: 🇾🇪 [9468, 229, 122, 9468, 229, 103]
N: 🧎🏻‍♂️‍➡️ [9468, 100, 236, 9468, 237, 119, 102470, 17245, 224, 31643, 102470, 98115, 94, 31643]

O: 🤾🏼‍♂️ [9468, 97, 122, 9468, 237, 120, 102470, 17245, 224, 31643]
N: ⚒ [158, 248, 240]

O: 🗺 [9468, 245, 118]
N: 🗺 [9468, 245, 118]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:11,  3.87s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:09,  4.59s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.43s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.04s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.53s/it]
Processing depth (0, 2, 5, 7, 9):   0%|          | 0/100 [00:15<?, ?it/s]2025-01-22 06:05:24.336 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra journeyed to the kitchen.
2025-01-22 06:05:24.336 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (32, 38) -->  journeyed to the kitchen.
2025-01-22 06:05:24.336 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra took the apple.
2025-01-22 06:05:24.345 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1589, 1593) -->  Sandra took the apple
2025-01-22 06:05:24.345 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the bathroom.
2025-01-22 06:05:24.366 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4142, 4147) --> . Sandra moved to the
2025-01-22 06:05:24.367 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra left the apple there.
2025-01-22 06:05:24.394 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5605, 5610) --> . Sandra left the apple
2025-01-22 06:05:24.394 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went back to the garden.
2025-01-22 06:05:24.429 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7094, 7100) -->  John went back to the garden
2025-01-22 06:05:24.429 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John journeyed to the hallway.
2025-01-22 06:05:24.437 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1539, 1545) --> . John journeyed to the
2025-01-22 06:05:24.437 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the kitchen.
2025-01-22 06:05:24.437 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (32, 38) -->  journeyed to the kitchen.
2025-01-22 06:05:24.437 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the bedroom.
2025-01-22 06:05:24.445 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1539, 1545) --> . John journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:05:25.215 | INFO     | test_jbb_embedding:begin_test:693 - the kitchen<|eot_id|>
2025-01-22 06:05:25.215 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8165])
2025-01-22 06:05:27.472 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [252.1502403846154, 24.410161988858963, 221.38194444444446, 23.24488206240768, 23.42597336065574], 'topk_indices': array([  23, 6079,   24, 8152, 5609, 5948, 8044, 8054, 1593, 8083, 6085,
       5950, 1592, 5610,   14, 6086, 8084, 8160, 8161,    0]), 'topk_tokens': ['4', ' the', '\n\n', ' discarded', ' apple', '\n', '.\n\n', ' location', '.', ' to', '\n', ' way', ' apple', ' there', '\n', 'the', ' the', '<|eot_id|>', '<|start_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [291.4375, 418.125, 157.75, 402.15, 55.880208333333336]}, 'weight': {'score': [23.18028846153846, 23.257074100146916, 19.671875, 23.265263417035943, 29.192110655737704], 'topk_indices': array([3282, 3309, 3154, 3202, 7423, 7385, 1437, 1499, 4329, 4313, 5124,
       5185, 7106, 7162, 3473, 3499, 4978, 4901, 4926, 4949]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.1875, 27.982421875, 21.040625, 24.2875, 23.83203125]}, 'saliency': {'score': [1.5974872295673077, 0.13506099689719026, 1.1571994357638888, 0.12811594840518833, 0.1686891649590164], 'topk_indices': array([8148, 2537, 5607, 8144, 5943, 8044,   31, 8150, 5606,   32, 8082,
       1589, 5950, 5610, 8138, 5609, 8054, 6086, 1592, 8152]), 'topk_tokens': [' where', ' kitchen', ' left', ' prior', ' people', '.\n\n', 'andra', ' apple', ' Sandra', ' journey', ' moved', ' Sandra', ' way', ' there', 'Question', ' apple', ' location', 'the', ' apple', ' discarded'], 'evidence_proportions': [1.6161295572916667, 3.0582275390625, 0.9248046875, 2.57646484375, 0.3497721354166667]}}, 'pred_res': 'the kitchen<|eot_id|>', 'score': 100}
2025-01-22 06:05:27.482 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:05:27.484 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-83_pid-0_0-2-5-7-9.pkl | len: 3 |  size: 2.05 KB
Processing depth (0, 2, 5, 7, 9):   1%|          | 1/100 [00:18<31:08, 18.87s/it]is_0k: False
your chose emoji: ['⏮️', '⛹🏿', '⛲', '🪓', '🕊', '👶', '🏠', '👩🏼\u200d❤️\u200d💋\u200d👩🏿', '◻', '👩\u200d👩\u200d👧\u200d👦']
emoji:
O: ⏮️ [158, 237, 106, 31643]
N: �� [110, 158, 249]

O: ⛹🏿 [158, 249, 117, 9468, 237, 123]
N: �� [232, 9468, 243]

O: ⛲ [158, 249, 110]
N: �� [241, 9468, 103]

O: 🪓 [9468, 103, 241]
N: �⛹� [123, 158, 249, 117, 9468, 237]

O: 🕊 [9468, 243, 232]
N: ️⏮ [31643, 158, 237, 106]

O: 👶 [9468, 239, 114]
N: �👩🏼‍❤️‍💋‍👩� [123, 9468, 239, 102, 9468, 237, 120, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237]

O: 🏠 [9468, 237, 254]
N: �� [114, 9468, 239]

O: 👩🏼‍❤️‍💋‍👩🏿 [9468, 239, 102, 9468, 237, 120, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 123]
N: �� [254, 9468, 237]

O: ◻ [41832, 119]
N: �� [119, 41832]

O: 👩‍👩‍👧‍👦 [9468, 239, 102, 102470, 9468, 239, 102, 102470, 9468, 239, 100, 102470, 9468, 239, 99]
N: �👩‍👩‍👧‍� [99, 9468, 239, 102, 102470, 9468, 239, 102, 102470, 9468, 239, 100, 102470, 9468, 239]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.57s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.71s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.57s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.23s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.74s/it]
Processing depth (1, 4, 5, 7, 9):   1%|          | 1/100 [00:35<31:08, 18.87s/it]2025-01-22 06:05:44.377 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra journeyed to the kitchen.
2025-01-22 06:05:44.381 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (799, 805) --> . Sandra journeyed to the
2025-01-22 06:05:44.381 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra took the apple.
2025-01-22 06:05:44.400 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3597, 3601) -->  Sandra took the apple
2025-01-22 06:05:44.400 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the bathroom.
2025-01-22 06:05:44.425 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4131, 4136) --> . Sandra moved to the
2025-01-22 06:05:44.425 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra left the apple there.
2025-01-22 06:05:44.452 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5620, 5625) --> . Sandra left the apple
2025-01-22 06:05:44.452 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went back to the garden.
2025-01-22 06:05:44.488 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7155, 7161) -->  John went back to the garden
2025-01-22 06:05:44.488 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John journeyed to the hallway.
2025-01-22 06:05:44.497 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1610, 1616) --> . John journeyed to the
2025-01-22 06:05:44.497 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the kitchen.
2025-01-22 06:05:44.501 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (800, 806) -->  Sandra journeyed to the kitchen
2025-01-22 06:05:44.501 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the bedroom.
2025-01-22 06:05:44.509 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1610, 1616) --> . John journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:05:45.451 | INFO     | test_jbb_embedding:begin_test:693 - Sandra left the apple there.<|eot_id|>
2025-01-22 06:05:45.451 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8200])
2025-01-22 06:05:47.691 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [390.77163461538464, 30.706420288309154, 277.59027777777777, 29.01434956796176, 23.256180775316455], 'topk_indices': array([5619, 5623, 8089,   23, 8174, 8180,   14, 5620, 5560, 8187, 8185,
       5622, 5621, 5624, 8195, 3600, 3601, 5625, 8196,    0]), 'topk_tokens': [' St', ' the', ' location', '4', ':', ' to', '\n', '.', ' One', ' discarded', ' apple', ' left', ' Sandra', ' apple', '<|eot_id|>', ' apple', '.', ' there', '<|start_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [375.1875, 659.625, 191.9375, 826.3, 29.875]}, 'weight': {'score': [23.417067307692307, 23.294132101060587, 21.34418402777778, 23.298042230971934, 29.719541139240505], 'topk_indices': array([3332, 3359, 3252, 3204, 7446, 7484, 1528, 1466, 4364, 4348, 5195,
       5256, 7223, 7167, 3541, 3515, 4997, 4972, 5020, 5049]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.213541666666668, 27.982421875, 21.040625, 24.2875, 23.83203125]}, 'saliency': {'score': [2.557720477764423, 0.17187776789932038, 1.6551378038194444, 0.16100258820780733, 0.17301226265822786], 'topk_indices': array([2576, 3598, 8193, 2577,  801,  800, 5619, 5560, 8089, 8179, 8173,
       3552, 3597, 5622, 8185, 8187, 5624, 5625, 3600, 5621]), 'topk_tokens': [' Mary', ' took', 'Answer', ' journey', ' journey', ' Sandra', ' St', ' One', ' location', ' prior', 'Question', ' Ramsey', ' Sandra', ' left', ' apple', ' discarded', ' apple', ' there', ' apple', ' Sandra'], 'evidence_proportions': [2.236572265625, 4.756103515625, 1.184814453125, 5.40234375, 0.18684895833333334]}}, 'pred_res': 'Sandra left the apple there.<|eot_id|>', 'score': 0}
2025-01-22 06:05:47.695 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:05:47.695 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-83_pid-1_1-4-5-7-9.pkl | len: 3 |  size: 2.08 KB
Processing depth (1, 4, 5, 7, 9):   2%|▏         | 2/100 [00:39<32:06, 19.66s/it]is_0k: False
your chose emoji: ['🌥', '👩🏾\u200d❤\u200d💋\u200d👩🏻', '🧛🏾\u200d♀', '🤌🏿', '🚑', '🏌🏼\u200d♂️', '👩\u200d🦰', '👩🏽\u200d❤️\u200d👨🏽', '🇵🇦', '☃']
emoji:
O: 🌥 [9468, 234, 98]
N: 🧛🏾‍♀ [9468, 100, 249, 9468, 237, 122, 102470, 32990]

O: 👩🏾‍❤‍💋‍👩🏻 [9468, 239, 102, 9468, 237, 122, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 119]
N: 👩🏽‍❤️‍👨🏽 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 121]

O: 🧛🏾‍♀ [9468, 100, 249, 9468, 237, 122, 102470, 32990]
N: 🇵🇦 [9468, 229, 113, 9468, 229, 99]

O: 🤌🏿 [9468, 97, 234, 9468, 237, 123]
N: 🏌🏼‍♂️ [9468, 237, 234, 9468, 237, 120, 102470, 17245, 224, 31643]

O: 🚑 [9468, 248, 239]
N: 🚑 [9468, 248, 239]

O: 🏌🏼‍♂️ [9468, 237, 234, 9468, 237, 120, 102470, 17245, 224, 31643]
N: 👩‍🦰 [9468, 239, 102, 102470, 9468, 99, 108]

O: 👩‍🦰 [9468, 239, 102, 102470, 9468, 99, 108]
N: 🤌🏿 [9468, 97, 234, 9468, 237, 123]

O: 👩🏽‍❤️‍👨🏽 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 121]
N: 👩🏾‍❤‍💋‍👩🏻 [9468, 239, 102, 9468, 237, 122, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 119]

O: 🇵🇦 [9468, 229, 113, 9468, 229, 99]
N: 🌥 [9468, 234, 98]

O: ☃ [18107, 225]
N: ☃ [18107, 225]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.68s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.60s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.26s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.76s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.39s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 1, 2, 4, 5):   2%|▏         | 2/100 [00:54<32:06, 19.66s/it]2025-01-22 06:06:03.355 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra journeyed to the kitchen.
2025-01-22 06:06:03.355 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (32, 38) -->  journeyed to the kitchen.
2025-01-22 06:06:03.355 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra took the apple.
2025-01-22 06:06:03.361 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (904, 908) -->  Sandra took the apple
2025-01-22 06:06:03.361 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the bathroom.
2025-01-22 06:06:03.372 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1883, 1888) --> . Sandra moved to the
2025-01-22 06:06:03.372 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra left the apple there.
2025-01-22 06:06:03.390 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3652, 3657) --> . Sandra left the apple
2025-01-22 06:06:03.390 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went back to the garden.
2025-01-22 06:06:03.411 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4253, 4259) -->  John went back to the garden
2025-01-22 06:06:03.411 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John journeyed to the hallway.
2025-01-22 06:06:03.422 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1804, 1810) --> . John journeyed to the
2025-01-22 06:06:03.422 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the kitchen.
2025-01-22 06:06:03.423 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (32, 38) -->  journeyed to the kitchen.
2025-01-22 06:06:03.423 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the bedroom.
2025-01-22 06:06:03.434 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1804, 1810) --> . John journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:06:07.352 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 06:06:07.352 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8209])
2025-01-22 06:06:10.381 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [72.95582932692308, 9.348404963772529, 72.82291666666667, 9.006052583251714, 4.428440323795181], 'topk_indices': array([6123, 7351, 5988, 7399,   14,   28,   24, 6118,   23, 8208, 5987,
       7322, 8207, 5989, 6124, 7400, 6125,    0, 8204, 8205]), 'topk_tokens': [' on', 'nes', 'the', ' Min', '\n', '<|end_header_id|>', '\n\n', ' the', '4', '\n\n', '\n', 'nes', '<|end_header_id|>', ' way', '\n', 'nes', 'the', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [146.97916666666666, 117.1875, 29.584375, 68.6625, 9.165364583333334]}, 'weight': {'score': [23.18028846153846, 23.29685597296639, 19.671875, 23.305215475024486, 29.586972891566266], 'topk_indices': array([3314, 3341, 3168, 3216, 7485, 7447, 1412, 1474, 4306, 4322, 5157,
       5218, 7168, 7224, 3523, 3497, 4982, 4934, 5011, 4959]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.1875, 27.982421875, 21.040625, 24.2875, 23.83203125]}, 'saliency': {'score': [0.4518473698542668, 0.05119447480511561, 0.4182976616753472, 0.04911014172052426, 0.033661164433123114], 'topk_indices': array([8169, 6122,  904,   31,   24, 8202, 8206, 8208, 5982,   20,   23,
       5988,   32, 7351,   36, 7399, 5989, 7322, 6125, 7400]), 'topk_tokens': [' return', ' meet', ' Sandra', 'andra', '\n\n', 'Answer', 'assistant', '\n\n', ' people', ' Jul', '4', 'the', ' journey', 'nes', ' kitchen', ' Min', ' way', 'nes', 'the', 'nes'], 'evidence_proportions': [0.8554280598958334, 0.8389892578125, 0.155419921875, 0.4266357421875, 0.05820465087890625]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 100}
2025-01-22 06:06:10.388 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:06:10.388 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-83_pid-2_0-1-2-4-5.pkl | len: 3 |  size: 2.03 KB
Processing depth (0, 1, 2, 4, 5):   3%|▎         | 3/100 [01:01<34:01, 21.04s/it]is_0k: False
your chose emoji: ['💷', '🧑🏻\u200d✈️', '👩🏾\u200d✈', '🧔🏿\u200d♂', '🙇\u200d♀', '🧏🏼\u200d♂', '👰🏿\u200d♀️', '👨🏾\u200d🦽\u200d➡️', '👨🏿\u200d🦯', '👰🏼']
emoji:
O: 💷 [93273, 115]
N: ️👨🏾‍🦽‍➡ [31643, 9468, 239, 101, 9468, 237, 122, 102470, 9468, 99, 121, 102470, 98115, 94]

O: 🧑🏻‍✈️ [9468, 100, 239, 9468, 237, 119, 102470, 38798, 230, 31643]
N: ♀🙇‍ [32990, 9468, 247, 229, 102470]

O: 👩🏾‍✈ [9468, 239, 102, 9468, 237, 122, 102470, 38798, 230]
N: �🧏🏼‍� [224, 9468, 100, 237, 9468, 237, 120, 102470, 17245]

O: 🧔🏿‍♂ [9468, 100, 242, 9468, 237, 123, 102470, 17245, 224]
N: ️🧑🏻‍✈ [31643, 9468, 100, 239, 9468, 237, 119, 102470, 38798, 230]

O: 🙇‍♀ [9468, 247, 229, 102470, 32990]
N: �👨🏿‍� [107, 9468, 239, 101, 9468, 237, 123, 102470, 9468, 99]

O: 🧏🏼‍♂ [9468, 100, 237, 9468, 237, 120, 102470, 17245, 224]
N: �👩🏾‍� [230, 9468, 239, 102, 9468, 237, 122, 102470, 38798]

O: 👰🏿‍♀️ [9468, 239, 108, 9468, 237, 123, 102470, 32990, 31643]
N: �� [115, 93273]

O: 👨🏾‍🦽‍➡️ [9468, 239, 101, 9468, 237, 122, 102470, 9468, 99, 121, 102470, 98115, 94, 31643]
N: �🧔🏿‍� [224, 9468, 100, 242, 9468, 237, 123, 102470, 17245]

O: 👨🏿‍🦯 [9468, 239, 101, 9468, 237, 123, 102470, 9468, 99, 107]
N: ️👰🏿‍♀ [31643, 9468, 239, 108, 9468, 237, 123, 102470, 32990]

O: 👰🏼 [9468, 239, 108, 9468, 237, 120]
N: �👰� [120, 9468, 239, 108, 9468, 237]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.34s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:09,  4.50s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.32s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  2.99s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.50s/it]
Processing depth (0, 1, 4, 7, 8):   3%|▎         | 3/100 [01:17<34:01, 21.04s/it]2025-01-22 06:06:26.118 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra journeyed to the kitchen.
2025-01-22 06:06:26.119 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (32, 38) -->  journeyed to the kitchen.
2025-01-22 06:06:26.119 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra took the apple.
2025-01-22 06:06:26.124 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (824, 828) -->  Sandra took the apple
2025-01-22 06:06:26.124 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the bathroom.
2025-01-22 06:06:26.146 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3614, 3619) --> . Sandra moved to the
2025-01-22 06:06:26.147 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra left the apple there.
2025-01-22 06:06:26.178 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5635, 5640) --> . Sandra left the apple
2025-01-22 06:06:26.179 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went back to the garden.
2025-01-22 06:06:26.213 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6495, 6501) --> . John went back to the
2025-01-22 06:06:26.214 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John journeyed to the hallway.
2025-01-22 06:06:26.224 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1782, 1788) --> . John journeyed to the
2025-01-22 06:06:26.224 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the kitchen.
2025-01-22 06:06:26.224 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (32, 38) -->  journeyed to the kitchen.
2025-01-22 06:06:26.224 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the bedroom.
2025-01-22 06:06:26.235 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1782, 1788) --> . John journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:06:27.057 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 06:06:27.057 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8167])
2025-01-22 06:06:29.283 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [89.30694110576923, 8.114485159118727, 71.08506944444444, 7.715214377461235, 14.582299017137096], 'topk_indices': array([8159, 8139,    1,    9,   19, 8151,   36, 8046,   20,   25,  828,
       8166,   28,   14,   24, 8165,   23,    0, 8162, 8163]), 'topk_tokens': ['?\n', '.\n\n', '<|start_header_id|>', ':', '26', ' the', ' kitchen', '.\n\n', ' Jul', '<|eot_id|>', '.', '\n\n', '<|end_header_id|>', '\n', '\n\n', '<|end_header_id|>', '4', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [146.02083333333334, 133.984375, 50.8625, 120.65, 8.725911458333334]}, 'weight': {'score': [22.31219951923077, 23.256464198286412, 19.671875, 23.267425739908933, 29.056199596774192], 'topk_indices': array([3325, 3298, 3170, 3218, 7409, 7447, 1480, 1418, 4283, 4299, 5173,
       5112, 7186, 7130, 3507, 3481, 4931, 4960, 4908, 4883]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.1875, 27.982421875, 21.040625, 24.2875, 20.0703125]}, 'saliency': {'score': [0.5578190730168269, 0.043866665302029144, 0.393310546875, 0.04144816266002838, 0.10558983587449597], 'topk_indices': array([8164, 8160, 8127, 5639, 5636, 8166, 8149, 8146,   22,   16, 2569,
       8012,   32,   24,  827,   19, 8154,   36,   20,   23]), 'topk_tokens': ['assistant', 'Answer', ' return', ' apple', ' Sandra', '\n\n', ' place', ' prior', '202', ' Date', ' kitchen', ' context', ' journey', '\n\n', ' apple', '26', ' discarded', ' kitchen', ' Jul', '4'], 'evidence_proportions': [0.8438313802083334, 0.94390869140625, 0.2731689453125, 0.8080810546875, 0.043070475260416664]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 100}
2025-01-22 06:06:29.289 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:06:29.290 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-83_pid-3_0-1-4-7-8.pkl | len: 3 |  size: 2.07 KB
Processing depth (0, 1, 4, 7, 8):   4%|▍         | 4/100 [01:20<32:19, 20.20s/it]is_0k: False
your chose emoji: ['🕵🏼\u200d♂', '⏭', '🚂', '🧑\u200d🦯\u200d➡️', '🧚🏽\u200d♀', '🦴', '🇲🇺', '🙆🏿\u200d♂', '🤰🏾', '⚙️']
emoji:
O: 🕵🏼‍♂ [9468, 243, 113, 9468, 237, 120, 102470, 17245, 224]
N: �� [112, 9468, 99]

O: ⏭ [158, 237, 255]
N: �� [255, 158, 237]

O: 🚂 [9468, 248, 224]
N: ️🧑‍🦯‍➡ [31643, 9468, 100, 239, 102470, 9468, 99, 107, 102470, 98115, 94]

O: 🧑‍🦯‍➡️ [9468, 100, 239, 102470, 9468, 99, 107, 102470, 98115, 94, 31643]
N: �🇲� [118, 9468, 229, 110, 9468, 229]

O: 🧚🏽‍♀ [9468, 100, 248, 9468, 237, 121, 102470, 32990]
N: �🤰� [122, 9468, 97, 108, 9468, 237]

O: 🦴 [9468, 99, 112]
N: �� [224, 9468, 248]

O: 🇲🇺 [9468, 229, 110, 9468, 229, 118]
N: �🙆🏿‍� [224, 9468, 247, 228, 9468, 237, 123, 102470, 17245]

O: 🙆🏿‍♂ [9468, 247, 228, 9468, 237, 123, 102470, 17245, 224]
N: �🕵🏼‍� [224, 9468, 243, 113, 9468, 237, 120, 102470, 17245]

O: 🤰🏾 [9468, 97, 108, 9468, 237, 122]
N: ♀🧚🏽‍ [32990, 9468, 100, 248, 9468, 237, 121, 102470]

O: ⚙️ [158, 248, 247, 31643]
N: ️⚙ [31643, 158, 248, 247]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:05<00:15,  5.06s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:10<00:10,  5.27s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.86s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:16<00:00,  3.40s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:16<00:00,  4.01s/it]
Processing depth (0, 1, 2, 5, 7):   4%|▍         | 4/100 [01:38<32:19, 20.20s/it]2025-01-22 06:06:47.098 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra journeyed to the kitchen.
2025-01-22 06:06:47.099 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (32, 38) -->  journeyed to the kitchen.
2025-01-22 06:06:47.099 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra took the apple.
2025-01-22 06:06:47.103 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (824, 828) -->  Sandra took the apple
2025-01-22 06:06:47.103 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra moved to the bathroom.
2025-01-22 06:06:47.111 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1617, 1622) --> . Sandra moved to the
2025-01-22 06:06:47.111 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra left the apple there.
2025-01-22 06:06:47.131 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4154, 4159) --> . Sandra left the apple
2025-01-22 06:06:47.131 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went back to the garden.
2025-01-22 06:06:47.164 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5529, 5535) --> . John went back to the
2025-01-22 06:06:47.165 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John journeyed to the hallway.
2025-01-22 06:06:47.172 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1487, 1493) -->  John journeyed to the hallway
2025-01-22 06:06:47.172 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the kitchen.
2025-01-22 06:06:47.172 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (32, 38) -->  journeyed to the kitchen.
2025-01-22 06:06:47.172 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the bedroom.
2025-01-22 06:06:47.180 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1488, 1494) -->  journeyed to the hallway.
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:06:47.972 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 06:06:47.972 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8225])
2025-01-22 06:06:50.206 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [51.61748798076923, 5.932001435646573, 61.759548611111114, 5.664073955278592, 8.308607164320055], 'topk_indices': array([8185, 8189, 8219, 8070, 8217,    1,    9, 8114,   25, 8104,   24,
       2581,   23, 8224,   28,   14, 8223, 8221,    0, 8220]), 'topk_tokens': [' return', '.', ':', ' context', '?\n', '<|start_header_id|>', ':', ' location', '<|eot_id|>', '.\n\n', '\n\n', ' kitchen', '4', '\n\n', '<|end_header_id|>', '\n', '<|end_header_id|>', '<|start_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [97.875, 63.328125, 38.0375, 55.5875, 5.561197916666667]}, 'weight': {'score': [22.31219951923077, 23.310916231161887, 21.985677083333332, 23.317003833699903, 29.669642857142858], 'topk_indices': array([3401, 3374, 3294, 3246, 7503, 7465, 1515, 1577, 4415, 4431, 5294,
       5233, 7242, 7186, 3583, 3557, 5003, 5028, 5051, 5080]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.1875, 27.982421875, 21.040625, 24.2875, 20.0703125]}, 'saliency': {'score': [0.30634161142202526, 0.032387547546297704, 0.3510403103298611, 0.030816365313786332, 0.06194169180733817], 'topk_indices': array([8194,   22, 8204,   19, 8188, 8198,    8,   36,   20, 8222,   24,
       8185, 8212, 8224, 8104, 8218, 8070,   23, 8114, 2581]), 'topk_tokens': [' else', '202', ' prior', '26', ' directly', 'Question', ' Date', ' kitchen', ' Jul', 'assistant', '\n\n', ' return', ' discarded', '\n\n', '.\n\n', 'Answer', ' context', '4', ' location', ' kitchen'], 'evidence_proportions': [0.5390218098958334, 0.447662353515625, 0.1983154296875, 0.3552490234375, 0.028713226318359375]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 100}
2025-01-22 06:06:50.213 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:06:50.213 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-83_pid-4_0-1-2-5-7.pkl | len: 3 |  size: 2.08 KB
Processing depth (0, 1, 2, 5, 7):   5%|▌         | 5/100 [01:41<32:23, 20.46s/it]Processing depth (0, 1, 2, 5, 7):   5%|▌         | 5/100 [01:41<32:11, 20.33s/it]
2025-01-22 06:06:50.270 | INFO     | __main__:<module>:82 - Selected idx: 84
2025-01-22 06:06:50.270 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the milk before the hallway? 
2025-01-22 06:06:50.271 | INFO     | __main__:<module>:84 - Answer: bathroom
2025-01-22 06:06:50.271 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 06:06:50.271 | INFO     | __main__:<module>:86 - Needle: [' John journeyed to the hallway.', ' Daniel got the milk.', ' Sandra went back to the bathroom.', ' Daniel went to the bathroom.', ' Mary journeyed to the kitchen.', ' John journeyed to the bedroom.', ' Daniel went to the hallway.', ' John went back to the garden.']
2025-01-22 06:06:50.271 | INFO     | __main__:<module>:87 - Real Needle: [' Daniel got the milk.', ' Daniel went to the bathroom.', ' Daniel went to the hallway.', ' John went back to the garden.']
2025-01-22 06:06:50.271 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['✊', '🧔🏿\u200d♂', '🧑🏿\u200d❤️\u200d💋\u200d🧑🏼', '🦶🏿', '👩🏿\u200d❤\u200d👩🏻', '👨🏻\u200d🦰', '📦', '🐳', '👨🏻\u200d❤️\u200d💋\u200d👨🏽', '🧜\u200d♀']
emoji:
O: ✊ [38798, 232]
N: �� [111, 9468, 238]

O: 🧔🏿‍♂ [9468, 100, 242, 9468, 237, 123, 102470, 17245, 224]
N: �🧔🏿‍� [224, 9468, 100, 242, 9468, 237, 123, 102470, 17245]

O: 🧑🏿‍❤️‍💋‍🧑🏼 [9468, 100, 239, 9468, 237, 123, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 100, 239, 9468, 237, 120]
N: �🧑🏿‍❤️‍💋‍🧑� [120, 9468, 100, 239, 9468, 237, 123, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 100, 239, 9468, 237]

O: 🦶🏿 [9468, 99, 114, 9468, 237, 123]
N: �👩🏿‍❤‍👩� [119, 9468, 239, 102, 9468, 237, 123, 102470, 121643, 102470, 9468, 239, 102, 9468, 237]

O: 👩🏿‍❤‍👩🏻 [9468, 239, 102, 9468, 237, 123, 102470, 121643, 102470, 9468, 239, 102, 9468, 237, 119]
N: �� [232, 38798]

O: 👨🏻‍🦰 [9468, 239, 101, 9468, 237, 119, 102470, 9468, 99, 108]
N: �👨🏻‍� [108, 9468, 239, 101, 9468, 237, 119, 102470, 9468, 99]

O: 📦 [9468, 241, 99]
N: �🦶� [123, 9468, 99, 114, 9468, 237]

O: 🐳 [9468, 238, 111]
N: �👨🏻‍❤️‍💋‍👨� [121, 9468, 239, 101, 9468, 237, 119, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237]

O: 👨🏻‍❤️‍💋‍👨🏽 [9468, 239, 101, 9468, 237, 119, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 121]
N: �� [99, 9468, 241]

O: 🧜‍♀ [9468, 100, 250, 102470, 32990]
N: ♀🧜‍ [32990, 9468, 100, 250, 102470]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.76s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:10,  5.01s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.62s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.00s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.65s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 4, 5, 8):   0%|          | 0/100 [00:16<?, ?it/s]2025-01-22 06:07:06.697 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the milk.
2025-01-22 06:07:06.740 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the bathroom.
2025-01-22 06:07:06.742 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (363, 368) -->  back to the bathroom.
2025-01-22 06:07:06.742 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the hallway.
2025-01-22 06:07:06.759 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3612, 3617) -->  Hon. Daniel went to
2025-01-22 06:07:06.760 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the garden.
2025-01-22 06:07:06.762 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (363, 369) -->  back to the bathroom. John
2025-01-22 06:07:06.762 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John journeyed to the hallway.
2025-01-22 06:07:06.764 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (365, 371) -->  the bathroom. John journeyed
2025-01-22 06:07:06.764 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the bathroom.
2025-01-22 06:07:06.767 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (360, 366) --> . Sandra went back to the
2025-01-22 06:07:06.767 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the kitchen.
2025-01-22 06:07:06.805 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (7398, 7404) --> . Mary journeyed to the
2025-01-22 06:07:06.806 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the bedroom.
2025-01-22 06:07:06.808 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (365, 371) -->  the bathroom. John journeyed
2025-01-22 06:07:06.808 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 06:07:06.808 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 06:07:06.808 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 06:07:06.808 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['👨🏾\u200d🦼\u200d➡', '🈵', '🤦🏽\u200d♀️', '🚝', '🐦\u200d⬛', '🇨🇵', '🥿', '💆🏾\u200d♂', '👨🏼\u200d🤝\u200d👨🏽', '🍈']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.51s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.14s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.24s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.95s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.43s/it]
Processing depth (1, 5, 6, 7):   0%|          | 0/100 [00:31<?, ?it/s]2025-01-22 06:07:22.222 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the milk.
2025-01-22 06:07:22.226 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (860, 864) -->  Daniel got the milk
2025-01-22 06:07:22.226 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the bathroom.
2025-01-22 06:07:22.228 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (358, 363) -->  back to the bathroom.
2025-01-22 06:07:22.228 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the hallway.
2025-01-22 06:07:22.254 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4193, 4198) --> . Daniel went to the
2025-01-22 06:07:22.255 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the garden.
2025-01-22 06:07:22.257 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (358, 364) -->  back to the bathroom. John
2025-01-22 06:07:22.257 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John journeyed to the hallway.
2025-01-22 06:07:22.259 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (360, 366) -->  the bathroom. John journeyed
2025-01-22 06:07:22.259 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the bathroom.
2025-01-22 06:07:22.261 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (355, 361) --> . Sandra went back to the
2025-01-22 06:07:22.261 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the kitchen.
2025-01-22 06:07:22.298 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (7390, 7396) --> . Mary journeyed to the
2025-01-22 06:07:22.298 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the bedroom.
2025-01-22 06:07:22.300 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (360, 366) -->  the bathroom. John journeyed
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:07:23.093 | INFO     | test_jbb_embedding:begin_test:693 - The bedroom.<|eot_id|>
2025-01-22 06:07:23.094 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8173])
2025-01-22 06:07:25.318 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [526.49375, 28.54112646771037, 437.0403645833333, 26.110846808903098, 35.9234375], 'topk_indices': array([ 859, 8160, 8156, 8166,  864,  356, 8061,   14, 8163,  362, 8161,
        361, 8071,  594, 8167,  863, 8027,  595,  860,    0]), 'topk_tokens': ['.', ' milk', ':', 'Answer', '.', ' Sandra', '.\n\n', '\n', ' hallway', '.', ' before', ' bathroom', ' location', ',', ':', ' milk', ' context', ' instead', ' Daniel', '<|begin_of_text|>'], 'evidence_proportions': [799.0625, 616.7, 171.725, 565.25]}, 'weight': {'score': [21.697265625, 23.27467396954501, 22.209635416666668, 23.2816967305091, 29.365178571428572], 'topk_indices': array([3334, 3307, 3227, 3179, 7452, 7414, 1523, 1461, 4336, 4352, 5153,
       5214, 7128, 7184, 3516, 3490, 5007, 4978, 4955, 4930]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.611328125, 20.021875, 19.665625, 21.510416666666668]}, 'saliency': {'score': [3.1571044921875, 0.1613743253883317, 2.6016667683919272, 0.146804524359302, 0.2630578177315848], 'topk_indices': array([ 257, 4198, 8157,  368, 8070,  357, 8155, 1320,  364, 8160, 8166,
       8161, 8071,  356, 8027,  863, 8163,  361,  595,  860]), 'topk_tokens': ['hue', ' bathroom', ' Where', ' bedroom', ' first', ' went', 'Question', ' hallway', ' journey', ' milk', 'Answer', ' before', ' location', ' Sandra', ' context', ' milk', ' hallway', ' bathroom', ' instead', ' Daniel'], 'evidence_proportions': [5.79052734375, 3.3330078125, 0.89599609375, 3.13916015625]}}, 'pred_res': 'The bedroom.<|eot_id|>', 'score': 0}
2025-01-22 06:07:25.326 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:07:25.326 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-84_pid-0_1-5-6-7.pkl | len: 3 |  size: 2.0 KB
Processing depth (1, 5, 6, 7):   1%|          | 1/100 [00:34<57:41, 34.96s/it]is_0k: False
your chose emoji: ['🐘', '🧏🏼', '👰🏻\u200d♂️', '🍗', '💾', '🇵🇲', '🍓', '👩🏻\u200d❤️\u200d👩🏽', '👨🏽\u200d❤\u200d💋\u200d👨🏿', '📯']
emoji:
O: 🐘 [9468, 238, 246]
N: 👨🏽‍❤‍💋‍👨🏿 [9468, 239, 101, 9468, 237, 121, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 123]

O: 🧏🏼 [9468, 100, 237, 9468, 237, 120]
N: 👰🏻‍♂️ [9468, 239, 108, 9468, 237, 119, 102470, 17245, 224, 31643]

O: 👰🏻‍♂️ [9468, 239, 108, 9468, 237, 119, 102470, 17245, 224, 31643]
N: 🍗 [9468, 235, 245]

O: 🍗 [9468, 235, 245]
N: 👩🏻‍❤️‍👩🏽 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 31643, 102470, 9468, 239, 102, 9468, 237, 121]

O: 💾 [93273, 122]
N: 🍓 [9468, 235, 241]

O: 🇵🇲 [9468, 229, 113, 9468, 229, 110]
N: 💾 [93273, 122]

O: 🍓 [9468, 235, 241]
N: 🇵🇲 [9468, 229, 113, 9468, 229, 110]

O: 👩🏻‍❤️‍👩🏽 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 31643, 102470, 9468, 239, 102, 9468, 237, 121]
N: 🐘 [9468, 238, 246]

O: 👨🏽‍❤‍💋‍👨🏿 [9468, 239, 101, 9468, 237, 121, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 123]
N: 🧏🏼 [9468, 100, 237, 9468, 237, 120]

O: 📯 [9468, 241, 107]
N: 📯 [9468, 241, 107]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.88s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.81s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.55s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.13s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.71s/it]
Processing depth (0, 1, 3, 4):   1%|          | 1/100 [00:51<57:41, 34.96s/it]2025-01-22 06:07:41.892 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the milk.
2025-01-22 06:07:41.935 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the bathroom.
2025-01-22 06:07:41.937 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (363, 368) -->  back to the bathroom.
2025-01-22 06:07:41.937 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the hallway.
2025-01-22 06:07:41.941 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (790, 795) --> . Daniel went to the
2025-01-22 06:07:41.941 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the garden.
2025-01-22 06:07:41.943 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (363, 369) -->  back to the bathroom. John
2025-01-22 06:07:41.943 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John journeyed to the hallway.
2025-01-22 06:07:41.945 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (365, 371) -->  the bathroom. John journeyed
2025-01-22 06:07:41.945 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the bathroom.
2025-01-22 06:07:41.947 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (360, 366) --> . Sandra went back to the
2025-01-22 06:07:41.947 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the kitchen.
2025-01-22 06:07:41.984 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (7414, 7420) --> . Mary journeyed to the
2025-01-22 06:07:41.984 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the bedroom.
2025-01-22 06:07:41.986 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (365, 371) -->  the bathroom. John journeyed
2025-01-22 06:07:41.986 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 06:07:41.986 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 06:07:41.986 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 06:07:41.986 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['👨🏻\u200d🦽\u200d➡️', '👃🏼', '🚣🏾\u200d♂️', '🤳🏿', '🧑🏾\u200d❤\u200d💋\u200d🧑🏻', '💏🏾', '🙇\u200d♂', '⛏️', '🧔🏼\u200d♀️', '👩\u200d❤\u200d👩']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.45s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.39s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.61s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.19s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.67s/it]
Processing depth (0, 2, 8, 9):   1%|          | 1/100 [01:07<57:41, 34.96s/it]2025-01-22 06:07:58.351 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the milk.
2025-01-22 06:07:58.396 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the bathroom.
2025-01-22 06:07:58.398 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (363, 368) -->  back to the bathroom.
2025-01-22 06:07:58.398 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the hallway.
2025-01-22 06:07:58.408 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1879, 1884) --> . Daniel went to the
2025-01-22 06:07:58.409 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the garden.
2025-01-22 06:07:58.410 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (363, 369) -->  back to the bathroom. John
2025-01-22 06:07:58.411 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John journeyed to the hallway.
2025-01-22 06:07:58.412 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (365, 371) -->  the bathroom. John journeyed
2025-01-22 06:07:58.413 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the bathroom.
2025-01-22 06:07:58.414 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (360, 366) --> . Sandra went back to the
2025-01-22 06:07:58.414 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the kitchen.
2025-01-22 06:07:58.454 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (7432, 7438) --> . Mary journeyed to the
2025-01-22 06:07:58.455 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the bedroom.
2025-01-22 06:07:58.456 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (365, 371) -->  the bathroom. John journeyed
2025-01-22 06:07:58.457 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 06:07:58.457 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 06:07:58.457 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 06:07:58.457 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['🚶🏿\u200d♀️\u200d➡', '🈂️', '⛹🏿\u200d♀️', '👩🏻\u200d❤\u200d👩🏿', '👷🏿', '🪲', '👨\u200d👩\u200d👧', '🧜🏾\u200d♀️', '👩🏻\u200d❤️\u200d👩🏽', '🇸🇴']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.50s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.55s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.53s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.17s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.67s/it]
Processing depth (0, 2, 5, 7):   1%|          | 1/100 [01:24<57:41, 34.96s/it]2025-01-22 06:08:15.029 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the milk.
2025-01-22 06:08:15.069 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the bathroom.
2025-01-22 06:08:15.071 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (363, 368) -->  back to the bathroom.
2025-01-22 06:08:15.071 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the hallway.
2025-01-22 06:08:15.080 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1843, 1848) --> . Daniel went to the
2025-01-22 06:08:15.081 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the garden.
2025-01-22 06:08:15.082 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (363, 369) -->  back to the bathroom. John
2025-01-22 06:08:15.083 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John journeyed to the hallway.
2025-01-22 06:08:15.084 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (365, 371) -->  the bathroom. John journeyed
2025-01-22 06:08:15.085 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the bathroom.
2025-01-22 06:08:15.086 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (360, 366) --> . Sandra went back to the
2025-01-22 06:08:15.087 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the kitchen.
2025-01-22 06:08:15.128 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (7404, 7410) --> . Mary journeyed to the
2025-01-22 06:08:15.128 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the bedroom.
2025-01-22 06:08:15.130 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (365, 371) -->  the bathroom. John journeyed
2025-01-22 06:08:15.130 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 06:08:15.130 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 06:08:15.130 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 06:08:15.130 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['🧎🏿\u200d♂️\u200d➡', '🙅🏾\u200d♂️', '🧑🏻\u200d❤️\u200d💋\u200d🧑🏼', '💼', '👨🏿\u200d🤝\u200d👨🏽', '🏑', '🚋', '💂🏼\u200d♀️', '🦵🏽', '🧑\u200d🦽\u200d➡️']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.50s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.31s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.32s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.02s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.51s/it]
Processing depth (0, 3, 4, 8):   1%|          | 1/100 [01:40<57:41, 34.96s/it]2025-01-22 06:08:31.013 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the milk.
2025-01-22 06:08:31.056 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the bathroom.
2025-01-22 06:08:31.058 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (363, 368) -->  back to the bathroom.
2025-01-22 06:08:31.058 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the hallway.
2025-01-22 06:08:31.072 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2857, 2862) --> . Daniel went to the
2025-01-22 06:08:31.072 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the garden.
2025-01-22 06:08:31.074 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (363, 369) -->  back to the bathroom. John
2025-01-22 06:08:31.074 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John journeyed to the hallway.
2025-01-22 06:08:31.076 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (365, 371) -->  the bathroom. John journeyed
2025-01-22 06:08:31.076 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the bathroom.
2025-01-22 06:08:31.078 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (360, 366) --> . Sandra went back to the
2025-01-22 06:08:31.078 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the kitchen.
2025-01-22 06:08:31.115 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (7405, 7411) -->  Mary journeyed to the kitchen
2025-01-22 06:08:31.115 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the bedroom.
2025-01-22 06:08:31.117 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (365, 371) -->  the bathroom. John journeyed
2025-01-22 06:08:31.118 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 06:08:31.118 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 06:08:31.118 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 06:08:31.118 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['🧛\u200d♂', '👩🏽\u200d🔧', '🏃🏻\u200d♂️\u200d➡', '👨🏽\u200d🤝\u200d👨🏼', '🧑🏼\u200d🦲', '🌵', '👵🏼', '🏉', '👩🏼\u200d❤️\u200d💋\u200d👨🏻', '🚣🏽\u200d♀️']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.95s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.55s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.42s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.03s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.60s/it]
Processing depth (0, 1, 5, 8):   1%|          | 1/100 [01:56<57:41, 34.96s/it]2025-01-22 06:08:47.311 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the milk.
2025-01-22 06:08:47.353 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the bathroom.
2025-01-22 06:08:47.355 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (363, 368) -->  back to the bathroom.
2025-01-22 06:08:47.356 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the hallway.
2025-01-22 06:08:47.360 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (914, 919) --> . Daniel went to the
2025-01-22 06:08:47.360 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the garden.
2025-01-22 06:08:47.362 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (363, 369) -->  back to the bathroom. John
2025-01-22 06:08:47.362 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John journeyed to the hallway.
2025-01-22 06:08:47.364 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (365, 371) -->  the bathroom. John journeyed
2025-01-22 06:08:47.364 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the bathroom.
2025-01-22 06:08:47.366 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (360, 366) --> . Sandra went back to the
2025-01-22 06:08:47.366 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the kitchen.
2025-01-22 06:08:47.403 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (7319, 7325) -->  cold. Mary journeyed to
2025-01-22 06:08:47.403 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the bedroom.
2025-01-22 06:08:47.410 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (365, 371) -->  the bathroom. John journeyed
2025-01-22 06:08:47.410 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 06:08:47.410 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 06:08:47.410 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 06:08:47.410 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['👮🏽\u200d♀️', '💇🏾', '💇🏿\u200d♂️', '👨🏾\u200d🦯\u200d➡️', '🏅', '🧑🏾\u200d❤️\u200d💋\u200d🧑🏽', '↙️', '🤾\u200d♂️', '🙆🏽', '🙇\u200d♂']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.12s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.23s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.59s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.26s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.67s/it]
Processing depth (0, 1, 4, 8):   1%|          | 1/100 [02:13<57:41, 34.96s/it]2025-01-22 06:09:03.901 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the milk.
2025-01-22 06:09:03.949 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the bathroom.
2025-01-22 06:09:03.951 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (363, 368) -->  back to the bathroom.
2025-01-22 06:09:03.951 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the hallway.
2025-01-22 06:09:03.956 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (838, 843) --> . Daniel went to the
2025-01-22 06:09:03.956 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the garden.
2025-01-22 06:09:03.958 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (363, 369) -->  back to the bathroom. John
2025-01-22 06:09:03.958 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John journeyed to the hallway.
2025-01-22 06:09:03.960 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (365, 371) -->  the bathroom. John journeyed
2025-01-22 06:09:03.960 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the bathroom.
2025-01-22 06:09:03.962 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (360, 366) --> . Sandra went back to the
2025-01-22 06:09:03.962 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the kitchen.
2025-01-22 06:09:04.009 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (7462, 7468) --> . Mary journeyed to the
2025-01-22 06:09:04.010 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the bedroom.
2025-01-22 06:09:04.012 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (365, 371) -->  the bathroom. John journeyed
2025-01-22 06:09:04.012 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 06:09:04.012 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 06:09:04.012 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 06:09:04.012 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['👩🏾\u200d❤️\u200d💋\u200d👩🏿', '🧗🏼', '👱🏼\u200d♀', '🇺🇿', '👮🏼\u200d♂️', '💆🏿', '🆙', '🤰🏻', '🕵🏻\u200d♀', '👨🏿\u200d🌾']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.44s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.37s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.24s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.93s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.44s/it]
Processing depth (2, 5, 6, 9):   1%|          | 1/100 [02:29<57:41, 34.96s/it]2025-01-22 06:09:19.550 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the milk.
2025-01-22 06:09:19.559 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1877, 1881) -->  Daniel got the milk
2025-01-22 06:09:19.559 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the bathroom.
2025-01-22 06:09:19.565 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (358, 363) -->  back to the bathroom.
2025-01-22 06:09:19.565 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the hallway.
2025-01-22 06:09:19.588 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4157, 4162) -->  went to the bathroom.
2025-01-22 06:09:19.589 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the garden.
2025-01-22 06:09:19.591 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (358, 364) -->  back to the bathroom. John
2025-01-22 06:09:19.591 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John journeyed to the hallway.
2025-01-22 06:09:19.593 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (360, 366) -->  the bathroom. John journeyed
2025-01-22 06:09:19.593 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the bathroom.
2025-01-22 06:09:19.595 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (355, 361) --> . Sandra went back to the
2025-01-22 06:09:19.595 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the kitchen.
2025-01-22 06:09:19.634 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (7267, 7273) -->  cold. Mary journeyed to
2025-01-22 06:09:19.634 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the bedroom.
2025-01-22 06:09:19.636 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (360, 366) -->  the bathroom. John journeyed
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:09:20.509 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's house.<|eot_id|>
2025-01-22 06:09:20.509 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8135])
2025-01-22 06:09:22.800 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [569.08125, 30.72565241767019, 342.5009765625, 28.47093043458117, 60.7116268382353], 'topk_indices': array([7988, 1544,  361,  362, 8117, 8126, 4160,   14, 8118, 8128, 8133,
       1880, 7989, 8125, 8129, 8123, 1876, 1878, 1877,    0]), 'topk_tokens': [' you', 'rich', ' bathroom', '.', 'Question', '?', ' bathroom', '\n', ':', 'Answer', '<|end_header_id|>', ' milk', ' context', ' hallway', ':', ' before', '.', ' got', ' Daniel', '<|begin_of_text|>'], 'evidence_proportions': [1189.875, 459.15, 350.025, 429.375]}, 'weight': {'score': [21.897265625, 23.24480638670435, 23.047200520833332, 23.248722047195454, 29.251225490196077], 'topk_indices': array([3310, 3283, 3155, 3203, 7390, 7428, 1440, 1502, 4314, 4298, 5127,
       5188, 7104, 7160, 3466, 3492, 4952, 4929, 4904, 4981]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.611328125, 20.021875, 20.465625, 21.510416666666668]}, 'saliency': {'score': [3.64908447265625, 0.17380868495023347, 2.0459314982096353, 0.1596702536094445, 0.44010476505055146], 'topk_indices': array([4156, 1274,   54, 8119,  364, 8033,  356, 1299, 8122, 1544, 8117,
        361, 8128, 4160, 1880, 8123, 7989, 1878, 8125, 1877]), 'topk_tokens': [' Daniel', '�', '\n\n\n\n', ' Where', ' journey', ' location', ' Sandra', ' hallway', ' milk', 'rich', 'Question', ' bathroom', 'Answer', ' bathroom', ' milk', ' before', ' context', ' got', ' hallway', ' Daniel'], 'evidence_proportions': [8.722900390625, 2.45400390625, 2.314111328125, 2.3749186197916665]}}, 'pred_res': "Daniel's house.<|eot_id|>", 'score': 0}
2025-01-22 06:09:22.806 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:09:22.806 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-84_pid-1_2-5-6-9.pkl | len: 3 |  size: 2.01 KB
Processing depth (2, 5, 6, 9):   2%|▏         | 2/100 [02:32<2:16:23, 83.50s/it]is_0k: False
your chose emoji: ['🦶🏾', '🧑🏽\u200d✈️', '🙅\u200d♂️', '🤾🏾', '⚡', '🇬🇺', '🕖', '🧝\u200d♂', '☝', '✌']
emoji:
O: 🦶🏾 [9468, 99, 114, 9468, 237, 122]
N: 🧑🏽‍✈️ [9468, 100, 239, 9468, 237, 121, 102470, 38798, 230, 31643]

O: 🧑🏽‍✈️ [9468, 100, 239, 9468, 237, 121, 102470, 38798, 230, 31643]
N: 🧝‍♂ [9468, 100, 251, 102470, 17245, 224]

O: 🙅‍♂️ [9468, 247, 227, 102470, 17245, 224, 31643]
N: ⚡ [158, 248, 94]

O: 🤾🏾 [9468, 97, 122, 9468, 237, 122]
N: 🦶🏾 [9468, 99, 114, 9468, 237, 122]

O: ⚡ [158, 248, 94]
N: 🇬🇺 [9468, 229, 105, 9468, 229, 118]

O: 🇬🇺 [9468, 229, 105, 9468, 229, 118]
N: 🤾🏾 [9468, 97, 122, 9468, 237, 122]

O: 🕖 [9468, 243, 244]
N: 🕖 [9468, 243, 244]

O: 🧝‍♂ [9468, 100, 251, 102470, 17245, 224]
N: ☝ [18107, 251]

O: ☝ [18107, 251]
N: 🙅‍♂️ [9468, 247, 227, 102470, 17245, 224, 31643]

O: ✌ [38798, 234]
N: ✌ [38798, 234]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.70s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:10,  5.03s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:16<00:05,  5.49s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:17<00:00,  3.73s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:17<00:00,  4.26s/it]
Processing depth (0, 4, 5, 6):   2%|▏         | 2/100 [02:51<2:16:23, 83.50s/it]2025-01-22 06:09:41.765 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the milk.
2025-01-22 06:09:41.806 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the bathroom.
2025-01-22 06:09:41.807 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (289, 294) -->  back to the bathroom.
2025-01-22 06:09:41.809 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the hallway.
2025-01-22 06:09:41.827 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3597, 3602) --> . Daniel went to the
2025-01-22 06:09:41.827 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the garden.
2025-01-22 06:09:41.829 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (289, 295) -->  back to the bathroom. John
2025-01-22 06:09:41.829 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John journeyed to the hallway.
2025-01-22 06:09:41.830 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (291, 297) -->  the bathroom. John journeyed
2025-01-22 06:09:41.831 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the bathroom.
2025-01-22 06:09:41.832 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (287, 293) -->  Sandra went back to the bathroom
2025-01-22 06:09:41.832 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the kitchen.
2025-01-22 06:09:41.874 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (7299, 7305) -->  cold. Mary journeyed to
2025-01-22 06:09:41.874 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the bedroom.
2025-01-22 06:09:41.876 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (291, 297) -->  the bathroom. John journeyed
2025-01-22 06:09:41.876 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 06:09:41.876 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 06:09:41.876 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 06:09:41.876 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['👩🏿\u200d🦯\u200d➡', '🦹🏿\u200d♂', '🪙', '🧍🏿', '🤾🏽\u200d♀️', '🤷🏻\u200d♀️', '🐅', '🙋🏾\u200d♂', '🛤️', '🇦🇶']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:05<00:16,  5.43s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.83s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.49s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.14s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.75s/it]
Processing depth (0, 1, 2, 8):   2%|▏         | 2/100 [03:08<2:16:23, 83.50s/it]2025-01-22 06:09:58.762 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the milk.
2025-01-22 06:09:58.805 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the bathroom.
2025-01-22 06:09:58.808 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (317, 322) -->  back to the bathroom.
2025-01-22 06:09:58.808 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the hallway.
2025-01-22 06:09:58.813 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (840, 845) --> . Daniel went to the
2025-01-22 06:09:58.813 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the garden.
2025-01-22 06:09:58.815 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (317, 323) -->  back to the bathroom. John
2025-01-22 06:09:58.815 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John journeyed to the hallway.
2025-01-22 06:09:58.817 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (319, 325) -->  the bathroom. John journeyed
2025-01-22 06:09:58.817 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the bathroom.
2025-01-22 06:09:58.818 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (314, 320) --> . Sandra went back to the
2025-01-22 06:09:58.818 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the kitchen.
2025-01-22 06:09:58.861 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (7271, 7277) -->  cold. Mary journeyed to
2025-01-22 06:09:58.861 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the bedroom.
2025-01-22 06:09:58.863 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (319, 325) -->  the bathroom. John journeyed
2025-01-22 06:09:58.863 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 06:09:58.863 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 06:09:58.863 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 06:09:58.863 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['🇭🇹', '😱', '👩🏽\u200d🦽', '🇪🇪', '🤵🏾\u200d♂', '#⃣', '🛫', '😗', '🤸🏿\u200d♂', '🎍']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.88s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.63s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.61s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.21s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.75s/it]
Processing depth (0, 1, 4, 9):   2%|▏         | 2/100 [03:25<2:16:23, 83.50s/it]2025-01-22 06:10:15.677 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the milk.
2025-01-22 06:10:15.720 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the bathroom.
2025-01-22 06:10:15.722 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (363, 368) -->  back to the bathroom.
2025-01-22 06:10:15.722 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the hallway.
2025-01-22 06:10:15.727 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (914, 919) --> . Daniel went to the
2025-01-22 06:10:15.727 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the garden.
2025-01-22 06:10:15.729 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (363, 369) -->  back to the bathroom. John
2025-01-22 06:10:15.729 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John journeyed to the hallway.
2025-01-22 06:10:15.732 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (365, 371) -->  the bathroom. John journeyed
2025-01-22 06:10:15.732 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the bathroom.
2025-01-22 06:10:15.734 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (360, 366) --> . Sandra went back to the
2025-01-22 06:10:15.734 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the kitchen.
2025-01-22 06:10:15.774 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (7285, 7291) -->  cold. Mary journeyed to
2025-01-22 06:10:15.774 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the bedroom.
2025-01-22 06:10:15.776 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (365, 371) -->  the bathroom. John journeyed
2025-01-22 06:10:15.776 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 06:10:15.777 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 06:10:15.777 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 06:10:15.777 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['💆🏽', '👩🏾\u200d❤\u200d👩🏻', '🧓🏽', '🙋\u200d♀️', '↘', '🙍', '🙅🏻\u200d♀', '⛹\u200d♂️', '🤸🏼', '📗']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:11,  3.91s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:07<00:07,  3.93s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.28s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.02s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.41s/it]
Processing depth (0, 3, 4, 9):   2%|▏         | 2/100 [03:40<2:16:23, 83.50s/it]2025-01-22 06:10:31.219 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the milk.
2025-01-22 06:10:31.264 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the bathroom.
2025-01-22 06:10:31.266 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (363, 368) -->  back to the bathroom.
2025-01-22 06:10:31.267 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the hallway.
2025-01-22 06:10:31.281 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2843, 2848) --> . Daniel went to the
2025-01-22 06:10:31.281 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the garden.
2025-01-22 06:10:31.283 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (363, 369) -->  back to the bathroom. John
2025-01-22 06:10:31.283 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John journeyed to the hallway.
2025-01-22 06:10:31.285 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (365, 371) -->  the bathroom. John journeyed
2025-01-22 06:10:31.285 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the bathroom.
2025-01-22 06:10:31.287 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (360, 366) --> . Sandra went back to the
2025-01-22 06:10:31.287 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the kitchen.
2025-01-22 06:10:31.324 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (7279, 7285) -->  cold. Mary journeyed to
2025-01-22 06:10:31.324 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the bedroom.
2025-01-22 06:10:31.326 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (365, 371) -->  the bathroom. John journeyed
2025-01-22 06:10:31.326 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 06:10:31.326 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 06:10:31.326 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 06:10:31.326 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['🙍🏾', '👩🏻\u200d🏫', '💁🏼\u200d♀️', '🏊🏻\u200d♂️', '🧋', '👤', '🗝', '👬🏽', '🤦🏻', '🏟']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.75s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.74s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.37s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.13s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.66s/it]
Processing depth (3, 7, 8, 9):   2%|▏         | 2/100 [03:57<2:16:23, 83.50s/it]2025-01-22 06:10:47.784 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the milk.
2025-01-22 06:10:47.816 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2841, 2845) -->  Daniel got the milk
2025-01-22 06:10:47.817 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the bathroom.
2025-01-22 06:10:47.819 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (358, 363) -->  back to the bathroom.
2025-01-22 06:10:47.819 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the hallway.
2025-01-22 06:10:47.848 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5621, 5626) --> . Daniel went to the
2025-01-22 06:10:47.849 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the garden.
2025-01-22 06:10:47.851 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (358, 364) -->  back to the bathroom. John
2025-01-22 06:10:47.851 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John journeyed to the hallway.
2025-01-22 06:10:47.853 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (360, 366) -->  the bathroom. John journeyed
2025-01-22 06:10:47.853 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the bathroom.
2025-01-22 06:10:47.855 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (355, 361) --> . Sandra went back to the
2025-01-22 06:10:47.856 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the kitchen.
2025-01-22 06:10:47.900 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (7387, 7393) -->  Mary journeyed to the kitchen
2025-01-22 06:10:47.900 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the bedroom.
2025-01-22 06:10:47.902 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (360, 366) -->  the bathroom. John journeyed
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:10:48.701 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 06:10:48.702 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8175])
2025-01-22 06:10:50.917 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [303.24375, 20.063929139153828, 219.42057291666666, 18.779425098352593, 13.996341329225352], 'topk_indices': array([8164, 8165, 2842,  362, 2841, 8063,   24, 8168, 8158, 2845,   14,
       8173, 8029, 5626, 8163, 8169, 2844, 8170, 8171,    0]), 'topk_tokens': [' the', ' hallway', ' got', '.', ' Daniel', '.\n\n', '\n\n', 'Answer', ':', '.', '\n', '<|end_header_id|>', ' context', ' bathroom', ' before', ':', ' milk', '<|eot_id|>', '<|start_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [534.25, 274.2, 195.95, 262.8541666666667]}, 'weight': {'score': [21.697265625, 23.273831086451455, 23.207356770833332, 23.277903706663388, 29.230853873239436], 'topk_indices': array([3345, 3372, 3217, 3265, 7448, 7410, 1488, 1426, 4340, 4324, 5153,
       5214, 7111, 7167, 3528, 3554, 4912, 5007, 4937, 4978]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.611328125, 20.021875, 19.665625, 21.510416666666668]}, 'saliency': {'score': [1.778759765625, 0.11211217076541101, 1.3024190266927083, 0.10450209989751737, 0.1032287167831206], 'topk_indices': array([  24, 8028, 8063, 8144,  368, 8159, 1285, 8073,  361, 2842,  364,
       8162, 8157, 8168, 2841, 8163, 8165, 8029, 5626, 2844]), 'topk_tokens': ['\n\n', ' you', '.\n\n', ' return', ' bedroom', ' Where', ' hallway', ' location', ' bathroom', ' got', ' journey', ' milk', 'Question', 'Answer', ' Daniel', ' before', ' hallway', ' context', ' bathroom', ' milk'], 'evidence_proportions': [3.741455078125, 1.4060546875, 1.0169921875, 1.4156901041666667]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 0}
2025-01-22 06:10:50.927 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:10:50.927 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-84_pid-2_3-7-8-9.pkl | len: 3 |  size: 2.02 KB
Processing depth (3, 7, 8, 9):   3%|▎         | 3/100 [04:00<2:18:24, 85.61s/it]is_0k: False
your chose emoji: ['👩🏿\u200d❤\u200d💋\u200d👩🏼', '🏝️', '🧝🏿', '🚐', '🇧🇿', '🇬🇫', '🤦🏼\u200d♂️', '🧙🏾\u200d♂', '🚅', '👱🏽']
emoji:
O: 👩🏿‍❤‍💋‍👩🏼 [9468, 239, 102, 9468, 237, 123, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 120]
N: 🚅 [9468, 248, 227]

O: 🏝️ [9468, 237, 251, 31643]
N: 🇬🇫 [9468, 229, 105, 9468, 229, 104]

O: 🧝🏿 [9468, 100, 251, 9468, 237, 123]
N: 🤦🏼‍♂️ [9468, 97, 99, 9468, 237, 120, 102470, 17245, 224, 31643]

O: 🚐 [9468, 248, 238]
N: 🏝️ [9468, 237, 251, 31643]

O: 🇧🇿 [9468, 229, 100, 9468, 229, 123]
N: 🇧🇿 [9468, 229, 100, 9468, 229, 123]

O: 🇬🇫 [9468, 229, 105, 9468, 229, 104]
N: 👩🏿‍❤‍💋‍👩🏼 [9468, 239, 102, 9468, 237, 123, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 120]

O: 🤦🏼‍♂️ [9468, 97, 99, 9468, 237, 120, 102470, 17245, 224, 31643]
N: 🧙🏾‍♂ [9468, 100, 247, 9468, 237, 122, 102470, 17245, 224]

O: 🧙🏾‍♂ [9468, 100, 247, 9468, 237, 122, 102470, 17245, 224]
N: 🚐 [9468, 248, 238]

O: 🚅 [9468, 248, 227]
N: 🧝🏿 [9468, 100, 251, 9468, 237, 123]

O: 👱🏽 [9468, 239, 109, 9468, 237, 121]
N: 👱🏽 [9468, 239, 109, 9468, 237, 121]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.30s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.68s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.61s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.22s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.72s/it]
Processing depth (1, 2, 3, 4):   3%|▎         | 3/100 [04:17<2:18:24, 85.61s/it]2025-01-22 06:11:07.566 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the milk.
2025-01-22 06:11:07.570 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (844, 848) -->  Daniel got the milk
2025-01-22 06:11:07.570 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the bathroom.
2025-01-22 06:11:07.572 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (320, 325) -->  back to the bathroom.
2025-01-22 06:11:07.572 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the hallway.
2025-01-22 06:11:07.581 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1829, 1834) --> . Daniel went to the
2025-01-22 06:11:07.581 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the garden.
2025-01-22 06:11:07.583 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (320, 326) -->  back to the bathroom. John
2025-01-22 06:11:07.583 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John journeyed to the hallway.
2025-01-22 06:11:07.585 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (322, 328) -->  the bathroom. John journeyed
2025-01-22 06:11:07.585 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the bathroom.
2025-01-22 06:11:07.586 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (317, 323) --> . Sandra went back to the
2025-01-22 06:11:07.587 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the kitchen.
2025-01-22 06:11:07.624 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (7422, 7428) --> . Mary journeyed to the
2025-01-22 06:11:07.624 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the bedroom.
2025-01-22 06:11:07.626 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (322, 328) -->  the bathroom. John journeyed
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:11:08.475 | INFO     | test_jbb_embedding:begin_test:693 - Daniel got the milk.<|eot_id|>
2025-01-22 06:11:08.475 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8203])
2025-01-22 06:11:10.720 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [672.23125, 39.055820436266146, 633.1484375, 35.75739708404803, 20.971978400735296], 'topk_indices': array([  14,  295, 8101, 1726, 1647,  847,  339,  319,  768, 8057,  844,
        705, 1648,  323,  706,  714,  318,  713,  776,    0]), 'topk_tokens': ['\n', ' If', ' location', ' some', ' some', ' milk', 'str', ' went', ' set', ' context', ' Daniel', ' set', ' time', ' bathroom', ' up', ' of', ' Sandra', ' services', ' services', '<|begin_of_text|>'], 'evidence_proportions': [924.625, 848.75, 176.775, 769.75]}, 'weight': {'score': [21.697265625, 23.30757029917134, 22.209635416666668, 23.31474458619211, 29.878308823529412], 'topk_indices': array([3334, 3307, 3227, 3179, 7446, 7484, 1527, 1465, 4335, 4351, 5275,
       5214, 7216, 7160, 3490, 3516, 4966, 4941, 5027, 5056]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.611328125, 20.021875, 19.665625, 21.510416666666668]}, 'saliency': {'score': [4.2166015625, 0.22083819670820132, 4.123268127441406, 0.1995721362262811, 0.15472995533662684], 'topk_indices': array([1647, 8101,  326, 1726, 8193,  693,  277,  339, 1648,  768,  847,
        706,  319, 8057,  705,  713,  844,  776,  323,  318]), 'topk_tokens': [' some', ' location', ' journey', ' some', ' hallway', ' stere', 'hue', 'str', ' time', ' set', ' milk', ' up', ' went', ' context', ' set', ' services', ' Daniel', ' services', ' bathroom', ' Sandra'], 'evidence_proportions': [6.70166015625, 5.0048828125, 0.97109375, 4.607584635416667]}}, 'pred_res': 'Daniel got the milk.<|eot_id|>', 'score': 0}
2025-01-22 06:11:10.727 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:11:10.728 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-84_pid-3_1-2-3-4.pkl | len: 3 |  size: 2.01 KB
Processing depth (1, 2, 3, 4):   4%|▍         | 4/100 [04:20<1:35:24, 59.63s/it]is_0k: False
your chose emoji: ['🙉', '👨🏿\u200d🚒', '👨🏾\u200d🦳', '💋', '🏄🏽\u200d♂', '👨🏻\u200d❤\u200d💋\u200d👨🏾', '👩🏿\u200d❤️\u200d💋\u200d👩🏽', '🚵\u200d♀️', '🌡', '💁\u200d♂']
emoji:
O: 🙉 [9468, 247, 231]
N: 👨🏿‍🚒 [9468, 239, 101, 9468, 237, 123, 102470, 9468, 248, 240]

O: 👨🏿‍🚒 [9468, 239, 101, 9468, 237, 123, 102470, 9468, 248, 240]
N: 👨🏾‍🦳 [9468, 239, 101, 9468, 237, 122, 102470, 9468, 99, 111]

O: 👨🏾‍🦳 [9468, 239, 101, 9468, 237, 122, 102470, 9468, 99, 111]
N: 💋 [93273, 233]

O: 💋 [93273, 233]
N: 👨🏻‍❤‍💋‍👨🏾 [9468, 239, 101, 9468, 237, 119, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 122]

O: 🏄🏽‍♂ [9468, 237, 226, 9468, 237, 121, 102470, 17245, 224]
N: 🌡 [9468, 234, 94]

O: 👨🏻‍❤‍💋‍👨🏾 [9468, 239, 101, 9468, 237, 119, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 122]
N: 🏄🏽‍♂ [9468, 237, 226, 9468, 237, 121, 102470, 17245, 224]

O: 👩🏿‍❤️‍💋‍👩🏽 [9468, 239, 102, 9468, 237, 123, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 121]
N: 👩🏿‍❤️‍💋‍👩🏽 [9468, 239, 102, 9468, 237, 123, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 121]

O: 🚵‍♀️ [9468, 248, 113, 102470, 32990, 31643]
N: 🚵‍♀️ [9468, 248, 113, 102470, 32990, 31643]

O: 🌡 [9468, 234, 94]
N: 🙉 [9468, 247, 231]

O: 💁‍♂ [93273, 223, 102470, 17245, 224]
N: 💁‍♂ [93273, 223, 102470, 17245, 224]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.52s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.76s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.57s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.15s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.69s/it]
Processing depth (0, 4, 6, 7):   4%|▍         | 4/100 [04:37<1:35:24, 59.63s/it]2025-01-22 06:11:27.568 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the milk.
2025-01-22 06:11:27.609 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the bathroom.
2025-01-22 06:11:27.610 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (363, 368) -->  back to the bathroom.
2025-01-22 06:11:27.611 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the hallway.
2025-01-22 06:11:27.628 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3633, 3638) --> . Daniel went to the
2025-01-22 06:11:27.628 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the garden.
2025-01-22 06:11:27.630 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (363, 369) -->  back to the bathroom. John
2025-01-22 06:11:27.630 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John journeyed to the hallway.
2025-01-22 06:11:27.632 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (365, 371) -->  the bathroom. John journeyed
2025-01-22 06:11:27.632 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the bathroom.
2025-01-22 06:11:27.634 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (360, 366) --> . Sandra went back to the
2025-01-22 06:11:27.634 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the kitchen.
2025-01-22 06:11:27.673 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (7466, 7472) --> . Mary journeyed to the
2025-01-22 06:11:27.673 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the bedroom.
2025-01-22 06:11:27.676 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (365, 371) -->  the bathroom. John journeyed
2025-01-22 06:11:27.676 | INFO     | test_jbb_embedding:begin_test:685 - evidence_list:
2025-01-22 06:11:27.676 | INFO     | test_jbb_embedding:begin_test:686 - disturb_tok_needles:
2025-01-22 06:11:27.676 | INFO     | test_jbb_embedding:begin_test:687 - search_pos:
2025-01-22 06:11:27.676 | INFO     | test_jbb_embedding:begin_test:688 - attack_pos:
is_0k: False
your chose emoji: ['🤏🏽', '🏃🏻\u200d♀️\u200d➡', '🏟', '👩🏽\u200d💻', '🇬🇲', '👩\u200d🦲', '👨🏻\u200d❤\u200d👨🏿', '🏊🏼\u200d♀️', '🕢', '💂🏽']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.46s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.77s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.69s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.26s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.78s/it]
Processing depth (2, 3, 6, 8):   4%|▍         | 4/100 [04:54<1:35:24, 59.63s/it]2025-01-22 06:11:44.531 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel got the milk.
2025-01-22 06:11:44.542 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1811, 1815) -->  Daniel got the milk
2025-01-22 06:11:44.542 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the bathroom.
2025-01-22 06:11:44.544 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (358, 363) -->  back to the bathroom.
2025-01-22 06:11:44.545 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the hallway.
2025-01-22 06:11:44.560 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2907, 2912) --> . Daniel went to the
2025-01-22 06:11:44.560 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John went back to the garden.
2025-01-22 06:11:44.562 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (358, 364) -->  back to the bathroom. John
2025-01-22 06:11:44.562 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John journeyed to the hallway.
2025-01-22 06:11:44.564 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (360, 366) -->  the bathroom. John journeyed
2025-01-22 06:11:44.564 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the bathroom.
2025-01-22 06:11:44.566 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (355, 361) --> . Sandra went back to the
2025-01-22 06:11:44.566 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the kitchen.
2025-01-22 06:11:44.607 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (7505, 7511) --> . Mary journeyed to the
2025-01-22 06:11:44.607 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the bedroom.
2025-01-22 06:11:44.609 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (360, 366) -->  the bathroom. John journeyed
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:11:45.391 | INFO     | test_jbb_embedding:begin_test:693 - The bathroom.<|eot_id|>
2025-01-22 06:11:45.391 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8141])
2025-01-22 06:11:47.639 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [235.45625, 15.184302669142927, 135.64583333333334, 14.28349826388889, 20.285316051136363], 'topk_indices': array([ 768,   24, 1810,  361, 8134, 8124, 8137, 2912,   14, 8039, 1814,
       8135, 7995, 8139, 8131, 1812, 8136, 8129, 1811,    0]), 'topk_tokens': ['�', '\n\n', '.', ' bathroom', 'Answer', ':', '<|start_header_id|>', ' bathroom', '\n', ' location', ' milk', ':', ' context', '<|end_header_id|>', ' hallway', ' got', '<|eot_id|>', ' before', ' Daniel', '<|begin_of_text|>'], 'evidence_proportions': [512.75, 198.4125, 116.275, 180.78125]}, 'weight': {'score': [21.697265625, 23.247173916380156, 22.209635416666668, 23.254075038580247, 27.759090909090908], 'topk_indices': array([3303, 3330, 3223, 3175, 7356, 7394, 1446, 1508, 4298, 4282, 5172,
       5111, 7133, 7077, 3486, 3512, 4888, 4965, 4913, 4936]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [26.611328125, 20.021875, 19.665625, 21.510416666666668]}, 'saliency': {'score': [1.5047119140625, 0.08516690117436916, 0.814324696858724, 0.07950138421706211, 0.12521833939985796], 'topk_indices': array([8038, 7994, 4866, 8125, 1809, 1550, 8128, 8123,  257, 8134, 8039,
       1261,  361, 1814, 7995, 2912, 8129, 1812, 8131, 1811]), 'topk_tokens': [' first', ' you', ' hallway', ' Where', ' Mr', 'rich', ' milk', 'Question', 'hue', 'Answer', ' location', ' hallway', ' bathroom', ' milk', ' context', ' bathroom', ' before', ' got', ' hallway', ' Daniel'], 'evidence_proportions': [3.751220703125, 1.138427734375, 0.60966796875, 1.0581461588541667]}}, 'pred_res': 'The bathroom.<|eot_id|>', 'score': 100}
2025-01-22 06:11:47.646 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:11:47.646 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-84_pid-4_2-3-6-8.pkl | len: 3 |  size: 2.03 KB
Processing depth (2, 3, 6, 8):   5%|▌         | 5/100 [04:57<1:21:26, 51.44s/it]Processing depth (2, 3, 6, 8):   5%|▌         | 5/100 [04:57<1:34:09, 59.47s/it]
2025-01-22 06:11:47.721 | INFO     | __main__:<module>:82 - Selected idx: 85
2025-01-22 06:11:47.721 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the location prior to the place where the milk was discarded, left or dropped?
2025-01-22 06:11:47.721 | INFO     | __main__:<module>:84 - Answer: bathroom
2025-01-22 06:11:47.721 | INFO     | __main__:<module>:85 - Tag: 4-hop
2025-01-22 06:11:47.721 | INFO     | __main__:<module>:86 - Needle: [' John journeyed to the bedroom.', ' Daniel went to the bathroom.', ' Mary journeyed to the kitchen.', ' Daniel got the milk.', ' Sandra went back to the bathroom.', ' Daniel went to the hallway.', ' John journeyed to the hallway.', ' Daniel discarded the milk.', ' John went back to the garden.']
2025-01-22 06:11:47.721 | INFO     | __main__:<module>:87 - Real Needle: [' Daniel went to the bathroom.', ' Daniel got the milk.', ' Daniel went to the hallway.', ' Daniel discarded the milk.', ' John went back to the garden.']
2025-01-22 06:11:47.721 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['#⃣', '©', '\U0001fa77', '🍪', '🤽🏼\u200d♂️', '👫🏿', '👰🏻\u200d♂️', '🤜🏾', '👳🏾', '🇭🇰']
emoji:
O: #⃣ [2, 158, 225, 96]
N: 🍪 [9468, 235, 103]

O: © [20644]
N: 👰🏻‍♂️ [9468, 239, 108, 9468, 237, 119, 102470, 17245, 224, 31643]

O: 🩷 [9468, 102, 115]
N: 🤽🏼‍♂️ [9468, 97, 121, 9468, 237, 120, 102470, 17245, 224, 31643]

O: 🍪 [9468, 235, 103]
N: 🤜🏾 [9468, 97, 250, 9468, 237, 122]

O: 🤽🏼‍♂️ [9468, 97, 121, 9468, 237, 120, 102470, 17245, 224, 31643]
N:  Paul [7043]

O: 👫🏿 [9468, 239, 104, 9468, 237, 123]
N: ��🏿 S [239, 104, 9468, 237, 123, 328]

O: 👰🏻‍♂️ [9468, 239, 108, 9468, 237, 119, 102470, 17245, 224, 31643]
N: �� Goodrich [225, 96, 7839, 14172]

O: 🤜🏾 [9468, 97, 250, 9468, 237, 122]
N: � The rest [115, 578, 2800]

O: 👳🏾 [9468, 239, 111, 9468, 237, 122]
N: �🏾 The Min [111, 9468, 237, 122, 578, 3468]

O: 🇭🇰 [9468, 229, 255, 9468, 229, 108]
N: �🇰
I [255, 9468, 229, 108, 198, 40]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.51s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:10,  5.02s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.83s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.34s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.89s/it]
Processing depth (0, 4, 6, 8, 9):   0%|          | 0/100 [00:17<?, ?it/s]2025-01-22 06:12:04.926 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went to the bathroom.
2025-01-22 06:12:04.927 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  went to the bathroom.
2025-01-22 06:12:04.927 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel got the milk.
2025-01-22 06:12:04.948 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3553, 3557) -->  Daniel got the milk
2025-01-22 06:12:04.948 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the hallway.
2025-01-22 06:12:04.976 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4613, 4618) --> . Daniel went to the
2025-01-22 06:12:04.976 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel discarded the milk.
2025-01-22 06:12:05.021 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6499, 6503) -->  Daniel discarded the milk
2025-01-22 06:12:05.022 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went back to the garden.
2025-01-22 06:12:05.066 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7207, 7213) --> . John went back to the
2025-01-22 06:12:05.066 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John journeyed to the bedroom.
2025-01-22 06:12:05.100 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5735, 5741) --> . John journeyed to the
2025-01-22 06:12:05.100 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the kitchen.
2025-01-22 06:12:05.106 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (971, 977) --> . Mary journeyed to the
2025-01-22 06:12:05.106 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the bathroom.
2025-01-22 06:12:05.143 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6633, 6639) --> . Sandra went back to the
2025-01-22 06:12:05.143 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the hallway.
2025-01-22 06:12:05.171 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5735, 5741) --> . John journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:12:05.966 | INFO     | test_jbb_embedding:begin_test:693 - the hallway<|eot_id|>
2025-01-22 06:12:05.966 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8163])
2025-01-22 06:12:08.190 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [314.8639322916667, 32.027015598212095, 229.72916666666666, 30.606353165804386, 28.359846443965516], 'topk_indices': array([  38, 3557, 4331,   24, 8150, 4356,   29, 1127,   35, 4264, 8042,
       8158,   34, 8008, 6639, 8159, 4618, 4357,   14,    0]), 'topk_tokens': ['�', '.', 'nes', '\n\n', ' discarded', 'nes', '\n\n', ' contract', '.', 'nes', '.\n\n', '<|eot_id|>', ' bathroom', ' context', ' bathroom', '<|start_header_id|>', ' hallway', 'ot', '\n', '<|begin_of_text|>'], 'evidence_proportions': [528.85, 417.25, 282.925, 357.3125, 66.6015625]}, 'weight': {'score': [22.668619791666668, 23.248187989835905, 20.1875, 23.258950018477456, 28.805765086206897], 'topk_indices': array([3270, 3297, 3116, 3164, 7425, 7387, 1418, 1480, 4298, 4282, 5190,
       5129, 7157, 7101, 3465, 3491, 4931, 4983, 4954, 4906]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.465625, 26.611328125, 19.665625, 29.130859375, 20.0703125]}, 'saliency': {'score': [1.9067637125651042, 0.1825864083212788, 1.3053181966145833, 0.17416982563824218, 0.1988396480165679], 'topk_indices': array([8052, 8142,  973, 7028,   45,   31, 6634, 4331,   44, 3556, 1127,
       4356, 6500, 4264, 4357, 8008, 8150,   34, 6639, 4618]), 'topk_tokens': [' location', ' prior', ' journey', ' bedroom', '\n\n\n', ' went', ' Sandra', 'nes', '***', ' milk', ' contract', 'nes', ' discarded', 'nes', 'ot', ' context', ' discarded', ' bathroom', ' bathroom', ' hallway'], 'evidence_proportions': [2.98642578125, 2.885986328125, 1.3470703125, 2.6790771484375, 0.3057657877604167]}}, 'pred_res': 'the hallway<|eot_id|>', 'score': 0}
2025-01-22 06:12:08.196 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:12:08.197 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-85_pid-0_0-4-6-8-9.pkl | len: 3 |  size: 2.07 KB
Processing depth (0, 4, 6, 8, 9):   1%|          | 1/100 [00:20<33:38, 20.39s/it]is_0k: False
your chose emoji: ['🦸\u200d♀', '🚼', '🇧🇫', '\U0001faf7🏼', '👮🏿\u200d♀️', '👨🏾\u200d🦰', '🪢', '🙁', '👨🏼\u200d🏭', '📌']
emoji:
O: 🦸‍♀ [9468, 99, 116, 102470, 32990]
N: 🙁 [9468, 247, 223]

O: 🚼 [9468, 248, 120]
N: 🪢 [9468, 103, 95]

O: 🇧🇫 [9468, 229, 100, 9468, 229, 104]
N: 👨🏼‍🏭 [9468, 239, 101, 9468, 237, 120, 102470, 9468, 237, 255]

O: 🫷🏼 [9468, 104, 115, 9468, 237, 120]
N: 🫷🏼 [9468, 104, 115, 9468, 237, 120]

O: 👮🏿‍♀️ [9468, 239, 106, 9468, 237, 123, 102470, 32990, 31643]
N: 🚼 [9468, 248, 120]

O: 👨🏾‍🦰 [9468, 239, 101, 9468, 237, 122, 102470, 9468, 99, 108]
N: 🦸‍♀ [9468, 99, 116, 102470, 32990]

O: 🪢 [9468, 103, 95]
N: 👮🏿‍♀️ [9468, 239, 106, 9468, 237, 123, 102470, 32990, 31643]

O: 🙁 [9468, 247, 223]
N: 🇧🇫 [9468, 229, 100, 9468, 229, 104]

O: 👨🏼‍🏭 [9468, 239, 101, 9468, 237, 120, 102470, 9468, 237, 255]
N: 👨🏾‍🦰 [9468, 239, 101, 9468, 237, 122, 102470, 9468, 99, 108]

O: 📌 [9468, 241, 234]
N: 📌 [9468, 241, 234]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:11,  3.81s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.42s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.31s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.07s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.50s/it]
Processing depth (0, 1, 3, 8, 9):   1%|          | 1/100 [00:36<33:38, 20.39s/it]2025-01-22 06:12:23.891 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went to the bathroom.
2025-01-22 06:12:23.891 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  went to the bathroom.
2025-01-22 06:12:23.891 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel got the milk.
2025-01-22 06:12:23.896 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (902, 906) -->  Daniel got the milk
2025-01-22 06:12:23.897 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the hallway.
2025-01-22 06:12:23.914 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2945, 2950) --> . Daniel went to the
2025-01-22 06:12:23.914 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel discarded the milk.
2025-01-22 06:12:23.948 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6607, 6611) -->  Daniel discarded the milk
2025-01-22 06:12:23.948 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went back to the garden.
2025-01-22 06:12:23.985 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7230, 7236) -->  John went back to the garden
2025-01-22 06:12:23.985 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John journeyed to the bedroom.
2025-01-22 06:12:24.014 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5827, 5833) --> . John journeyed to the
2025-01-22 06:12:24.014 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the kitchen.
2025-01-22 06:12:24.019 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (989, 995) -->  Mary journeyed to the kitchen
2025-01-22 06:12:24.019 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the bathroom.
2025-01-22 06:12:24.053 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6669, 6675) --> . Sandra went back to the
2025-01-22 06:12:24.053 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the hallway.
2025-01-22 06:12:24.082 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5827, 5833) --> . John journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:12:24.904 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 06:12:24.904 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8197])
2025-01-22 06:12:27.161 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [348.265625, 28.940884146341464, 191.43489583333334, 27.522379477428853, 24.255104166666666], 'topk_indices': array([8177,  994,   35,    9, 8195,   31, 6610, 6611, 8192,   24, 6608,
       8184, 6606,   14,   34,  905, 6607,  906, 8193,    0]), 'topk_tokens': [' to', ' kitchen', '.', ':', '<|end_header_id|>', ' went', ' milk', '.', '<|eot_id|>', '\n\n', ' discarded', ' discarded', '.', '\n', ' bathroom', ' milk', ' Daniel', '.', '<|start_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [518.7, 518.4375, 180.15, 609.1875, 58.9375]}, 'weight': {'score': [23.609049479166668, 23.283622332317073, 21.185221354166668, 23.28884207863101, 29.483125], 'topk_indices': array([3318, 3291, 3163, 3211, 7435, 7473, 1515, 1453, 4306, 4290, 5190,
       5129, 7167, 7111, 3520, 3494, 4909, 4884, 4932, 4961]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.465625, 26.611328125, 19.665625, 29.130859375, 23.83203125]}, 'saliency': {'score': [2.28314208984375, 0.163438720703125, 1.101226806640625, 0.15443727382850833, 0.18355061848958334], 'topk_indices': array([8042,  903, 6605, 1164, 6675, 8182,   39,  990, 1184,  971, 8176,
         31,    0, 6610,  994, 6608,  905, 8184, 6607,   34]), 'topk_tokens': [' context', ' got', ' St', 'nes', ' bathroom', ' milk', '\n\n\n', ' journey', 'nes', '�', ' prior', ' went', '<|begin_of_text|>', ' milk', ' kitchen', ' discarded', ' milk', ' discarded', ' Daniel', ' bathroom'], 'evidence_proportions': [3.0408203125, 3.516357421875, 0.892236328125, 4.7535400390625, 0.3417561848958333]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 0}
2025-01-22 06:12:27.168 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:12:27.168 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-85_pid-1_0-1-3-8-9.pkl | len: 3 |  size: 2.08 KB
Processing depth (0, 1, 3, 8, 9):   2%|▏         | 2/100 [00:39<31:56, 19.56s/it]is_0k: False
your chose emoji: ['🔟', '👮🏼', '👰🏽\u200d♀️', '🧚🏽\u200d♀️', '💑🏿', '🚶🏾\u200d♂️\u200d➡', '🚶🏿\u200d♀\u200d➡', '👩🏾\u200d🏫', '🦊', '🇲🇰']
emoji:
O: 🔟 [9468, 242, 253]
N: 🧚🏽‍♀️ [9468, 100, 248, 9468, 237, 121, 102470, 32990, 31643]

O: 👮🏼 [9468, 239, 106, 9468, 237, 120]
N: 👰🏽‍♀️ [9468, 239, 108, 9468, 237, 121, 102470, 32990, 31643]

O: 👰🏽‍♀️ [9468, 239, 108, 9468, 237, 121, 102470, 32990, 31643]
N: 🦊 [9468, 99, 232]

O: 🧚🏽‍♀️ [9468, 100, 248, 9468, 237, 121, 102470, 32990, 31643]
N: 👩🏾‍🏫 [9468, 239, 102, 9468, 237, 122, 102470, 9468, 237, 104]

O: 💑🏿 [93273, 239, 9468, 237, 123]
N: 🔟 [9468, 242, 253]

O: 🚶🏾‍♂️‍➡ [9468, 248, 114, 9468, 237, 122, 102470, 17245, 224, 31643, 102470, 98115, 94]
N: 🚶🏿‍♀‍➡ [9468, 248, 114, 9468, 237, 123, 102470, 32990, 102470, 98115, 94]

O: 🚶🏿‍♀‍➡ [9468, 248, 114, 9468, 237, 123, 102470, 32990, 102470, 98115, 94]
N: 💑🏿 [93273, 239, 9468, 237, 123]

O: 👩🏾‍🏫 [9468, 239, 102, 9468, 237, 122, 102470, 9468, 237, 104]
N: 👮🏼 [9468, 239, 106, 9468, 237, 120]

O: 🦊 [9468, 99, 232]
N: 🚶🏾‍♂️‍➡ [9468, 248, 114, 9468, 237, 122, 102470, 17245, 224, 31643, 102470, 98115, 94]

O: 🇲🇰 [9468, 229, 110, 9468, 229, 108]
N: 🇲🇰 [9468, 229, 110, 9468, 229, 108]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.69s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.70s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.56s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.20s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.73s/it]
Processing depth (0, 1, 2, 4, 8):   2%|▏         | 2/100 [00:55<31:56, 19.56s/it]2025-01-22 06:12:43.793 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went to the bathroom.
2025-01-22 06:12:43.794 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  went to the bathroom.
2025-01-22 06:12:43.794 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel got the milk.
2025-01-22 06:12:43.798 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (836, 840) -->  Daniel got the milk
2025-01-22 06:12:43.798 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the hallway.
2025-01-22 06:12:43.807 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1827, 1832) --> . Daniel went to the
2025-01-22 06:12:43.807 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel discarded the milk.
2025-01-22 06:12:43.825 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3636, 3640) -->  Daniel discarded the milk
2025-01-22 06:12:43.825 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went back to the garden.
2025-01-22 06:12:43.868 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6656, 6662) -->  John went back to the garden
2025-01-22 06:12:43.869 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John journeyed to the bedroom.
2025-01-22 06:12:43.899 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6204, 6210) --> . John journeyed to the
2025-01-22 06:12:43.899 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the kitchen.
2025-01-22 06:12:43.904 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (990, 996) --> . Mary journeyed to the
2025-01-22 06:12:43.904 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the bathroom.
2025-01-22 06:12:43.941 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6720, 6726) --> . Sandra went back to the
2025-01-22 06:12:43.942 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the hallway.
2025-01-22 06:12:43.972 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6204, 6210) --> . John journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:12:44.742 | INFO     | test_jbb_embedding:begin_test:693 - the kitchen<|eot_id|>
2025-01-22 06:12:44.743 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8219])
2025-01-22 06:12:46.986 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [237.10286458333334, 20.50799873814157, 132.53125, 19.543130275874724, 13.928370276162791], 'topk_indices': array([8108,   39,  185,   29,   25,   31,   38, 8199,  992,  839, 8215,
       8098,  840, 8206,   24, 3637, 8214,   14,   34,    0]), 'topk_tokens': [' location', '\n\n\n', 'ION', '\n\n', '<|eot_id|>', ' went', '***', ' to', ' journey', ' milk', '<|start_header_id|>', '.\n\n', '.', ' discarded', '\n\n', ' discarded', '<|eot_id|>', '\n', ' bathroom', '<|begin_of_text|>'], 'evidence_proportions': [437.7, 301.15625, 117.2125, 316.9375, 73.921875]}, 'weight': {'score': [23.609049479166668, 23.299389214911212, 20.1875, 23.307616948556397, 29.443859011627907], 'topk_indices': array([3340, 3313, 3233, 3185, 7491, 7453, 1499, 1437, 4319, 4303, 5114,
       5175, 7230, 7174, 3496, 3522, 4939, 4891, 4968, 4916]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.465625, 26.611328125, 19.665625, 29.130859375, 23.83203125]}, 'saliency': {'score': [1.5623321533203125, 0.11721070553374331, 0.711212158203125, 0.11122355730632187, 0.10250668193018714], 'topk_indices': array([4285,   30, 8204,  871,   24, 8104,  873,  185, 7429,   39, 8108,
       8198,  996,   31,   38,  839,  992, 8206, 3637,   34]), 'topk_tokens': ['nes', 'Daniel', ' milk', ' six', '\n\n', ' item', 'posit', 'ION', ' tele', '\n\n\n', ' location', ' prior', ' kitchen', ' went', '***', ' milk', ' journey', ' discarded', ' discarded', ' bathroom'], 'evidence_proportions': [2.70068359375, 2.024169921875, 0.60322265625, 2.5491943359375, 0.4471638997395833]}}, 'pred_res': 'the kitchen<|eot_id|>', 'score': 0}
2025-01-22 06:12:46.994 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:12:46.995 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-85_pid-2_0-1-2-4-8.pkl | len: 3 |  size: 2.07 KB
Processing depth (0, 1, 2, 4, 8):   3%|▎         | 3/100 [00:59<31:48, 19.68s/it]is_0k: False
your chose emoji: ['👩🏽\u200d❤\u200d💋\u200d👩🏿', '👩🏾\u200d🦳', '🕔', '🧄', '💆🏽\u200d♂️', '🇭🇰', '🚶🏻\u200d♂️\u200d➡', '🧑🏾\u200d⚕', '👂🏼', '🙍🏿\u200d♀']
emoji:
O: 👩🏽‍❤‍💋‍👩🏿 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 123]
N: 👩🏾‍🦳 [9468, 239, 102, 9468, 237, 122, 102470, 9468, 99, 111]

O: 👩🏾‍🦳 [9468, 239, 102, 9468, 237, 122, 102470, 9468, 99, 111]
N: 🚶🏻‍♂️‍➡ [9468, 248, 114, 9468, 237, 119, 102470, 17245, 224, 31643, 102470, 98115, 94]

O: 🕔 [9468, 243, 242]
N: 💆🏽‍♂️ [93273, 228, 9468, 237, 121, 102470, 17245, 224, 31643]

O: 🧄 [9468, 100, 226]
N: 🧄 [9468, 100, 226]

O: 💆🏽‍♂️ [93273, 228, 9468, 237, 121, 102470, 17245, 224, 31643]
N: 👩🏽‍❤‍💋‍👩🏿 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 123]

O: 🇭🇰 [9468, 229, 255, 9468, 229, 108]
N: 🕔 [9468, 243, 242]

O: 🚶🏻‍♂️‍➡ [9468, 248, 114, 9468, 237, 119, 102470, 17245, 224, 31643, 102470, 98115, 94]
N: 🧑🏾‍⚕ [9468, 100, 239, 9468, 237, 122, 102470, 158, 248, 243]

O: 🧑🏾‍⚕ [9468, 100, 239, 9468, 237, 122, 102470, 158, 248, 243]
N: 🇭🇰 [9468, 229, 255, 9468, 229, 108]

O: 👂🏼 [9468, 239, 224, 9468, 237, 120]
N: 👂🏼 [9468, 239, 224, 9468, 237, 120]

O: 🙍🏿‍♀ [9468, 247, 235, 9468, 237, 123, 102470, 32990]
N: 🙍🏿‍♀ [9468, 247, 235, 9468, 237, 123, 102470, 32990]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.15s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.67s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.33s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.78s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.38s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (1, 2, 3, 4, 6):   3%|▎         | 3/100 [01:14<31:48, 19.68s/it]2025-01-22 06:13:02.183 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went to the bathroom.
2025-01-22 06:13:02.186 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (645, 650) --> . Daniel went to the
2025-01-22 06:13:02.186 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel got the milk.
2025-01-22 06:13:02.194 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1577, 1581) -->  Daniel got the milk
2025-01-22 06:13:02.194 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the hallway.
2025-01-22 06:13:02.197 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (645, 650) --> . Daniel went to the
2025-01-22 06:13:02.198 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel discarded the milk.
2025-01-22 06:13:02.215 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3543, 3547) -->  discarded the milk.
2025-01-22 06:13:02.215 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went back to the garden.
2025-01-22 06:13:02.238 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4720, 4726) --> . John went back to the
2025-01-22 06:13:02.238 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John journeyed to the bedroom.
2025-01-22 06:13:02.267 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5819, 5825) --> . John journeyed to the
2025-01-22 06:13:02.267 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the kitchen.
2025-01-22 06:13:02.271 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (813, 819) --> . Mary journeyed to the
2025-01-22 06:13:02.271 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the bathroom.
2025-01-22 06:13:02.304 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6656, 6662) --> . Sandra went back to the
2025-01-22 06:13:02.304 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the hallway.
2025-01-22 06:13:02.333 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5819, 5825) --> . John journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:13:06.199 | INFO     | test_jbb_embedding:begin_test:693 - The bathroom.<|eot_id|>
2025-01-22 06:13:06.199 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8181])
2025-01-22 06:13:09.117 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [263.9375, 17.660167705278592, 95.23958333333333, 16.704838065388397, 30.313724347014926], 'topk_indices': array([1662,  813, 1581, 1779,  648, 8060, 3542,  815,  645, 1580,  646,
        651, 3543, 8179,  647,   14, 8176, 8177,  650,    0]), 'topk_tokens': [' time', '.', '.', "'s", ' to', '.\n\n', ' Daniel', ' journey', '.', ' milk', ' Daniel', '.', ' discarded', '<|end_header_id|>', ' went', '\n', '<|eot_id|>', '<|start_header_id|>', ' bathroom', '<|begin_of_text|>'], 'evidence_proportions': [393.85, 270.15625, 393.85, 257.296875, 47.697916666666664]}, 'weight': {'score': [21.4833984375, 23.26750557490225, 20.1875, 23.281853989982793, 29.25163246268657], 'topk_indices': array([3338, 3311, 3183, 3231, 7389, 7427, 1536, 1474, 4307, 4323, 5125,
       5186, 7110, 7166, 3494, 3520, 4979, 4950, 4902, 4927]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.665625, 26.611328125, 19.665625, 23.01953125, 20.0703125]}, 'saliency': {'score': [1.5460713704427083, 0.10011184110669447, 0.5285313924153646, 0.09458269927588418, 0.21633728938316232], 'topk_indices': array([ 819, 3541, 1662, 8060, 1778,    0, 1701, 8160, 1577, 8166,  814,
       8168,  313, 3542,  815, 1580,  646,  647, 3543,  650]), 'topk_tokens': [' kitchen', '�', ' time', '.\n\n', ' summer', '<|begin_of_text|>', ' work', ' prior', ' Daniel', ' milk', ' Mary', ' discarded', 'hue', ' Daniel', ' journey', ' milk', ' Daniel', ' went', ' discarded', ' bathroom'], 'evidence_proportions': [2.103515625, 1.8607177734375, 2.103515625, 1.79449462890625, 0.24161783854166666]}}, 'pred_res': 'The bathroom.<|eot_id|>', 'score': 100}
2025-01-22 06:13:09.124 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:13:09.125 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-85_pid-3_1-2-3-4-6.pkl | len: 3 |  size: 2.08 KB
Processing depth (1, 2, 3, 4, 6):   4%|▍         | 4/100 [01:21<33:02, 20.65s/it]is_0k: False
your chose emoji: ['🚶🏽\u200d♂️', '🦹\u200d♀️', '🧜🏾', '\U0001fa89', '🇰🇾', '\U0001faf5🏾', '🇹🇩', '👩🏾\u200d❤\u200d💋\u200d👨🏽', '📫', '🧱']
emoji:
O: 🚶🏽‍♂️ [9468, 248, 114, 9468, 237, 121, 102470, 17245, 224, 31643]
N: 🚶🏽‍♂️ [9468, 248, 114, 9468, 237, 121, 102470, 17245, 224, 31643]

O: 🦹‍♀️ [9468, 99, 117, 102470, 32990, 31643]
N: 🦹‍♀️ [9468, 99, 117, 102470, 32990, 31643]

O: 🧜🏾 [9468, 100, 250, 9468, 237, 122]
N: 🫵🏾 [9468, 104, 113, 9468, 237, 122]

O: 🪉 [9468, 103, 231]
N: 🧜🏾 [9468, 100, 250, 9468, 237, 122]

O: 🇰🇾 [9468, 229, 108, 9468, 229, 122]
N: 📫 [9468, 241, 104]

O: 🫵🏾 [9468, 104, 113, 9468, 237, 122]
N: 🇰🇾 [9468, 229, 108, 9468, 229, 122]

O: 🇹🇩 [9468, 229, 117, 9468, 229, 102]
N: 🪉 [9468, 103, 231]

O: 👩🏾‍❤‍💋‍👨🏽 [9468, 239, 102, 9468, 237, 122, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 121]
N: 🇹🇩 [9468, 229, 117, 9468, 229, 102]

O: 📫 [9468, 241, 104]
N: 👩🏾‍❤‍💋‍👨🏽 [9468, 239, 102, 9468, 237, 122, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 121]

O: 🧱 [9468, 100, 109]
N: 🧱 [9468, 100, 109]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.50s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.62s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.47s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.06s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.60s/it]
Processing depth (1, 3, 6, 7, 9):   4%|▍         | 4/100 [01:37<33:02, 20.65s/it]2025-01-22 06:13:25.331 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went to the bathroom.
2025-01-22 06:13:25.336 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (895, 900) --> . Daniel went to the
2025-01-22 06:13:25.336 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel got the milk.
2025-01-22 06:13:25.350 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2949, 2953) -->  Daniel got the milk
2025-01-22 06:13:25.350 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the hallway.
2025-01-22 06:13:25.355 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (895, 900) --> . Daniel went to the
2025-01-22 06:13:25.355 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel discarded the milk.
2025-01-22 06:13:25.382 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5632, 5636) -->  Daniel discarded the milk
2025-01-22 06:13:25.382 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went back to the garden.
2025-01-22 06:13:25.421 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7148, 7154) -->  John went back to the garden
2025-01-22 06:13:25.421 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John journeyed to the bedroom.
2025-01-22 06:13:25.450 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (5856, 5862) --> . John journeyed to the
2025-01-22 06:13:25.450 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the kitchen.
2025-01-22 06:13:25.456 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1045, 1051) --> . Mary journeyed to the
2025-01-22 06:13:25.456 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the bathroom.
2025-01-22 06:13:25.489 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6679, 6685) --> . Sandra went back to the
2025-01-22 06:13:25.489 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John journeyed to the hallway.
2025-01-22 06:13:25.519 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5856, 5862) --> . John journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:13:26.306 | INFO     | test_jbb_embedding:begin_test:693 - the hallway<|eot_id|>
2025-01-22 06:13:26.306 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8193])
2025-01-22 06:13:28.567 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [477.1432291666667, 39.699689635187895, 171.36458333333334, 38.023376135247915, 36.370986729452056], 'topk_indices': array([8112,  896,   14, 2953, 8178,  901, 7585, 5635, 8188, 7584,  897,
        257, 2962, 7540, 5633, 7392, 8180, 8189,  900,    0]), 'topk_tokens': [' the', ' Daniel', '\n', '.', ' milk', '.', 'nes', ' milk', '<|eot_id|>', ' Min', ' went', 'hue', '��', 'nes', ' discarded', 'nes', ' discarded', '<|start_header_id|>', ' bathroom', '<|begin_of_text|>'], 'evidence_proportions': [677.05, 439.5, 677.05, 638.9375, 61.197916666666664]}, 'weight': {'score': [23.4423828125, 23.282889519277695, 20.1875, 23.291537225392734, 29.623287671232877], 'topk_indices': array([3317, 3344, 3177, 3225, 7439, 7477, 1412, 1474, 4350, 4334, 5224,
       5163, 7160, 7216, 3548, 3522, 4940, 4965, 4988, 5017]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.665625, 26.611328125, 19.665625, 29.130859375, 23.83203125]}, 'saliency': {'score': [2.952448527018229, 0.2269176298842423, 0.9481201171875, 0.21676524878133438, 0.2685918938623716], 'topk_indices': array([8082, 2952, 6685, 7391, 8172,    0, 8166, 7585, 8178,  896,  897,
       5635, 7584, 2962, 7540,  257, 7392, 5633, 8180,  900]), 'topk_tokens': [' location', ' milk', ' bathroom', ' Min', ' prior', '<|begin_of_text|>', 'Question', 'nes', ' milk', ' Daniel', ' went', ' milk', ' Min', '��', 'nes', 'hue', 'nes', ' discarded', ' discarded', ' bathroom'], 'evidence_proportions': [3.653515625, 3.0325927734375, 3.653515625, 5.004150390625, 0.3627726236979167]}}, 'pred_res': 'the hallway<|eot_id|>', 'score': 0}
2025-01-22 06:13:28.580 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:13:28.580 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-85_pid-4_1-3-6-7-9.pkl | len: 3 |  size: 2.07 KB
Processing depth (1, 3, 6, 7, 9):   5%|▌         | 5/100 [01:40<32:00, 20.22s/it]Processing depth (1, 3, 6, 7, 9):   5%|▌         | 5/100 [01:40<31:55, 20.17s/it]
2025-01-22 06:13:28.637 | INFO     | __main__:<module>:82 - Selected idx: 86
2025-01-22 06:13:28.637 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the milk before the hallway? 
2025-01-22 06:13:28.637 | INFO     | __main__:<module>:84 - Answer: bathroom
2025-01-22 06:13:28.637 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 06:13:28.637 | INFO     | __main__:<module>:86 - Needle: [' Daniel went to the bathroom.', ' John journeyed to the bedroom.', ' Daniel went to the hallway.', ' Mary journeyed to the kitchen.', ' John journeyed to the hallway.', ' Daniel left the milk.', ' Sandra went back to the bathroom.']
2025-01-22 06:13:28.637 | INFO     | __main__:<module>:87 - Real Needle: [' Daniel went to the bathroom.', ' Daniel went to the hallway.', ' Daniel left the milk.', ' Sandra went back to the bathroom.']
2025-01-22 06:13:28.637 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['👝', '👨🏽\u200d❤️\u200d💋\u200d👨🏼', '👂🏾', '🧑🏾\u200d🍼', '👩\u200d👧\u200d👦', '🤶🏾', '👩\u200d⚖️', '🧙\u200d♂', '🌩', '♀️']
emoji:
O: 👝 [9468, 239, 251]
N: 🌩 [9468, 234, 102]

O: 👨🏽‍❤️‍💋‍👨🏼 [9468, 239, 101, 9468, 237, 121, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 120]
N: 👨🏽‍❤️‍💋‍👨🏼 [9468, 239, 101, 9468, 237, 121, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 120]

O: 👂🏾 [9468, 239, 224, 9468, 237, 122]
N: 🧑🏾‍🍼 [9468, 100, 239, 9468, 237, 122, 102470, 9468, 104247]

O: 🧑🏾‍🍼 [9468, 100, 239, 9468, 237, 122, 102470, 9468, 104247]
N: 🤶🏾 [9468, 97, 114, 9468, 237, 122]

O: 👩‍👧‍👦 [9468, 239, 102, 102470, 9468, 239, 100, 102470, 9468, 239, 99]
N: 👩‍👧‍👦 [9468, 239, 102, 102470, 9468, 239, 100, 102470, 9468, 239, 99]

O: 🤶🏾 [9468, 97, 114, 9468, 237, 122]
N: 👩‍⚖️ [9468, 239, 102, 102470, 158, 248, 244, 31643]

O: 👩‍⚖️ [9468, 239, 102, 102470, 158, 248, 244, 31643]
N: 👂🏾 [9468, 239, 224, 9468, 237, 122]

O: 🧙‍♂ [9468, 100, 247, 102470, 17245, 224]
N: 🧙‍♂ [9468, 100, 247, 102470, 17245, 224]

O: 🌩 [9468, 234, 102]
N: 👝 [9468, 239, 251]

O: ♀️ [32990, 31643]
N: ♀️ [32990, 31643]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:05<00:15,  5.03s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.98s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.46s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.09s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.70s/it]
Processing depth (1, 3, 6, 7):   0%|          | 0/100 [00:16<?, ?it/s]2025-01-22 06:13:45.364 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went to the bathroom.
2025-01-22 06:13:45.369 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (784, 789) --> . Daniel went to the
2025-01-22 06:13:45.369 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the hallway.
2025-01-22 06:13:45.373 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (784, 789) --> . Daniel went to the
2025-01-22 06:13:45.373 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel left the milk.
2025-01-22 06:13:45.396 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4633, 4637) -->  Daniel left the milk
2025-01-22 06:13:45.397 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the bathroom.
2025-01-22 06:13:45.425 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5603, 5609) --> . Sandra went back to the
2025-01-22 06:13:45.425 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John journeyed to the bedroom.
2025-01-22 06:13:45.428 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (615, 621) --> . John journeyed to the
2025-01-22 06:13:45.428 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the kitchen.
2025-01-22 06:13:45.439 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1828, 1834) --> . Mary journeyed to the
2025-01-22 06:13:45.439 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the hallway.
2025-01-22 06:13:45.443 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (615, 621) --> . John journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:13:46.204 | INFO     | test_jbb_embedding:begin_test:693 - the kitchen<|eot_id|>
2025-01-22 06:13:46.204 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8128])
2025-01-22 06:13:48.426 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [190.821875, 17.286717116590825, 125.98958333333333, 16.616093769306808, 19.854396446078432], 'topk_indices': array([   9, 8109,    4, 8016, 8127, 8121, 8111, 4636, 8115, 7982,    1,
       8122, 8116,    3,   24,   14, 8126,    0, 8124, 8123]), 'topk_tokens': [':', '.\n\n', '\n\n', '.\n\n', '\n\n', 'Answer', ':', ' milk', ' milk', ' context', '<|start_header_id|>', ':', ' before', '<|end_header_id|>', '\n\n', '\n', '<|end_header_id|>', '<|begin_of_text|>', '<|start_header_id|>', '<|eot_id|>'], 'evidence_proportions': [177.9125, 177.9125, 297.84375, 140.98958333333334]}, 'weight': {'score': [21.686328125, 23.245003689583076, 19.62673611111111, 23.25690314932658, 29.169117647058822], 'topk_indices': array([3315, 3342, 3235, 3187, 7371, 7409, 1526, 1464, 4307, 4323, 5135,
       5196, 7148, 7092, 3524, 3498, 4912, 4937, 4960, 4989]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.665625, 19.665625, 26.462890625, 21.869791666666668]}, 'saliency': {'score': [1.16053466796875, 0.095691032067185, 0.6478814019097222, 0.09183136329476477, 0.14592488606770834], 'topk_indices': array([8100,   14,    8,    0, 2748, 4633, 5609, 8097,  621, 8112, 8026,
       8110,   24, 8118, 8121, 7982,  789, 4636, 8116, 8115]), 'topk_tokens': [' directly', '\n', ' Date', '<|begin_of_text|>', ' hallway', ' Daniel', ' bathroom', ' return', ' bedroom', ' Where', ' location', 'Question', '\n\n', ' hallway', 'Answer', ' context', ' bathroom', ' milk', ' before', ' milk'], 'evidence_proportions': [0.99794921875, 0.99794921875, 2.046142578125, 0.8411051432291666]}}, 'pred_res': 'the kitchen<|eot_id|>', 'score': 0}
2025-01-22 06:13:48.433 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:13:48.433 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-86_pid-0_1-3-6-7.pkl | len: 3 |  size: 2.05 KB
Processing depth (1, 3, 6, 7):   1%|          | 1/100 [00:19<32:24, 19.65s/it]is_0k: False
your chose emoji: ['🔱', '🧑\u200d🌾', '💅', '👂🏻', '🙆\u200d♂️', '🤚🏿', '🙍🏿', '🧍🏿', '🛗', '🧎\u200d♀']
emoji:
O: 🔱 [9468, 242, 109]
N: 🧑‍🌾 [9468, 100, 239, 102470, 9468, 234, 122]

O: 🧑‍🌾 [9468, 100, 239, 102470, 9468, 234, 122]
N: 🧍🏿 [9468, 100, 235, 9468, 237, 123]

O: 💅 [93273, 227]
N: 👂🏻 [9468, 239, 224, 9468, 237, 119]

O: 👂🏻 [9468, 239, 224, 9468, 237, 119]
N: 🙆‍♂️ [9468, 247, 228, 102470, 17245, 224, 31643]

O: 🙆‍♂️ [9468, 247, 228, 102470, 17245, 224, 31643]
N: 🙍🏿 [9468, 247, 235, 9468, 237, 123]

O: 🤚🏿 [9468, 97, 248, 9468, 237, 123]
N: 🛗 [9468, 249, 245]

O: 🙍🏿 [9468, 247, 235, 9468, 237, 123]
N: 🤚🏿 [9468, 97, 248, 9468, 237, 123]

O: 🧍🏿 [9468, 100, 235, 9468, 237, 123]
N: 💅 [93273, 227]

O: 🛗 [9468, 249, 245]
N: 🔱 [9468, 242, 109]

O: 🧎‍♀ [9468, 100, 236, 102470, 32990]
N: 🧎‍♀ [9468, 100, 236, 102470, 32990]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.22s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.69s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.78s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.31s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.80s/it]
Processing depth (0, 4, 5, 8):   1%|          | 1/100 [00:36<32:24, 19.65s/it]2025-01-22 06:14:05.407 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went to the bathroom.
2025-01-22 06:14:05.408 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  went to the bathroom.
2025-01-22 06:14:05.408 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the hallway.
2025-01-22 06:14:05.428 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3755, 3760) --> . Daniel went to the
2025-01-22 06:14:05.428 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel left the milk.
2025-01-22 06:14:05.457 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4277, 4281) -->  Daniel left the milk
2025-01-22 06:14:05.457 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the bathroom.
2025-01-22 06:14:05.508 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6626, 6632) -->  Sandra went back to the bathroom
2025-01-22 06:14:05.508 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John journeyed to the bedroom.
2025-01-22 06:14:05.513 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (757, 763) --> . John journeyed to the
2025-01-22 06:14:05.513 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the kitchen.
2025-01-22 06:14:05.524 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2182, 2188) --> . Mary journeyed to the
2025-01-22 06:14:05.525 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the hallway.
2025-01-22 06:14:05.528 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (757, 763) --> . John journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:14:06.295 | INFO     | test_jbb_embedding:begin_test:693 - the kitchen<|eot_id|>
2025-01-22 06:14:06.295 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8172])
2025-01-22 06:14:08.508 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [368.475, 24.003985091743118, 193.52430555555554, 22.782308052722133, 25.977605950342465], 'topk_indices': array([8171, 4278, 4281,    3,   34,    1, 8168, 6631, 3756, 8060, 8070,
       8159, 8170,   24, 8160, 8162, 4280,   14, 8167,    0]), 'topk_tokens': ['\n\n', ' left', '.', '<|end_header_id|>', ' bathroom', '<|start_header_id|>', '<|start_header_id|>', ' bathroom', ' Daniel', '.\n\n', ' location', ' milk', '<|end_header_id|>', '\n\n', ' before', ' hallway', ' milk', '\n', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [367.725, 304.275, 543.0, 306.25]}, 'weight': {'score': [23.30859375, 23.275711009174312, 19.62673611111111, 23.283702147597396, 29.09503424657534], 'topk_indices': array([3272, 3245, 3117, 3165, 7453, 7415, 1412, 1474, 4249, 4265, 5162,
       5101, 7192, 7136, 3428, 3454, 4955, 4878, 4926, 4903]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.465625, 19.665625, 26.462890625, 26.610677083333332]}, 'saliency': {'score': [2.3899169921875, 0.13660732630925077, 0.9984673394097222, 0.12916236212670518, 0.1909252846077697], 'topk_indices': array([  14, 7746, 7913, 6626,  763, 1902, 3760,   31, 4278, 8154, 4277,
         24, 8070, 8159, 3756,   34, 6631, 8160, 4280, 8162]), 'topk_tokens': ['\n', 'inen', ' Square', ' Sandra', ' bedroom', 'asca', ' hallway', ' went', ' left', 'Question', ' Daniel', '\n\n', ' location', ' milk', ' Daniel', ' bathroom', ' bathroom', ' before', ' milk', ' hallway'], 'evidence_proportions': [2.130859375, 1.7896484375, 3.671875, 2.2513834635416665]}}, 'pred_res': 'the kitchen<|eot_id|>', 'score': 0}
2025-01-22 06:14:08.514 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:14:08.514 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-86_pid-1_0-4-5-8.pkl | len: 3 |  size: 2.06 KB
Processing depth (0, 4, 5, 8):   2%|▏         | 2/100 [00:39<32:30, 19.90s/it]is_0k: False
your chose emoji: ['🟫', '📝', '☎️', '👰🏼', '👩🏽\u200d🦯\u200d➡', '🤛🏿', '\U0001faf1🏾\u200d\U0001faf2🏼', '👨🏾\u200d❤\u200d👨🏻', '🧄', '👷🏿\u200d♀']
emoji:
O: 🟫 [9468, 253, 104]
N: 👰🏼 [9468, 239, 108, 9468, 237, 120]

O: 📝 [9468, 241, 251]
N: 👨🏾‍❤‍👨🏻 [9468, 239, 101, 9468, 237, 122, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 119]

O: ☎️ [18107, 236, 31643]
N: 📝 [9468, 241, 251]

O: 👰🏼 [9468, 239, 108, 9468, 237, 120]
N: 🟫 [9468, 253, 104]

O: 👩🏽‍🦯‍➡ [9468, 239, 102, 9468, 237, 121, 102470, 9468, 99, 107, 102470, 98115, 94]
N: 🫱🏾‍🫲🏼 [9468, 104, 109, 9468, 237, 122, 102470, 9468, 104, 110, 9468, 237, 120]

O: 🤛🏿 [9468, 97, 249, 9468, 237, 123]
N: ☎️ [18107, 236, 31643]

O: 🫱🏾‍🫲🏼 [9468, 104, 109, 9468, 237, 122, 102470, 9468, 104, 110, 9468, 237, 120]
N: 👩🏽‍🦯‍➡ [9468, 239, 102, 9468, 237, 121, 102470, 9468, 99, 107, 102470, 98115, 94]

O: 👨🏾‍❤‍👨🏻 [9468, 239, 101, 9468, 237, 122, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 119]
N: 🤛🏿 [9468, 97, 249, 9468, 237, 123]

O: 🧄 [9468, 100, 226]
N: 🧄 [9468, 100, 226]

O: 👷🏿‍♀ [9468, 239, 115, 9468, 237, 123, 102470, 32990]
N: 👷🏿‍♀ [9468, 239, 115, 9468, 237, 123, 102470, 32990]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.31s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.32s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.45s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.13s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.59s/it]
Processing depth (0, 6, 7, 9):   2%|▏         | 2/100 [00:55<32:30, 19.90s/it]2025-01-22 06:14:24.635 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went to the bathroom.
2025-01-22 06:14:24.635 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  went to the bathroom.
2025-01-22 06:14:24.635 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the hallway.
2025-01-22 06:14:24.662 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4682, 4687) --> . Daniel went to the
2025-01-22 06:14:24.662 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel left the milk.
2025-01-22 06:14:24.691 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5655, 5659) -->  Daniel left the milk
2025-01-22 06:14:24.692 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the bathroom.
2025-01-22 06:14:24.733 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7150, 7156) -->  Sandra went back to the bathroom
2025-01-22 06:14:24.733 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John journeyed to the bedroom.
2025-01-22 06:14:24.736 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (633, 639) --> . John journeyed to the
2025-01-22 06:14:24.737 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the kitchen.
2025-01-22 06:14:24.746 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1906, 1912) --> . Mary journeyed to the
2025-01-22 06:14:24.746 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the hallway.
2025-01-22 06:14:24.753 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (633, 639) --> . John journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:14:25.547 | INFO     | test_jbb_embedding:begin_test:693 - the kitchen<|eot_id|>
2025-01-22 06:14:25.547 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8216])
2025-01-22 06:14:27.784 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [339.69375, 25.89933386056698, 169.26736111111111, 24.81676292629263, 15.16533717105263], 'topk_indices': array([8206, 6134,   34,    9, 8104,    1, 5658, 8198, 8202, 8200, 8199,
         24, 5659, 8201,   14, 8204, 8203,    0, 8211, 8212]), 'topk_tokens': [' hallway', 'the', ' bathroom', ':', '.\n\n', '<|start_header_id|>', ' milk', 'Question', ' the', ' Where', ':', '\n\n', '.', ' was', '\n', ' before', ' milk', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [412.15, 236.05, 494.0625, 262.7708333333333]}, 'weight': {'score': [23.30859375, 23.309002007543498, 19.62673611111111, 23.317104800757853, 29.1875], 'topk_indices': array([3323, 3350, 3243, 3195, 7479, 7441, 1470, 1532, 4357, 4373, 5247,
       5186, 7162, 7218, 3524, 3550, 4963, 5011, 5040, 4988]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.465625, 19.665625, 26.462890625, 26.610677083333332]}, 'saliency': {'score': [2.1626708984375, 0.1431543461843366, 0.8351236979166666, 0.13669477163645183, 0.11246610942639802], 'topk_indices': array([5998, 8208,   31, 8209,   14, 5656,   24, 4687, 8114, 6134, 8201,
       4115, 7155, 5658, 8200, 8198,   34, 8206, 8204, 8203]), 'topk_tokens': [' way', ' \n', ' went', 'Answer', '\n', ' left', '\n\n', ' hallway', ' location', 'the', ' was', ' hallway', ' bathroom', ' milk', ' Where', 'Question', ' bathroom', ' hallway', ' before', ' milk'], 'evidence_proportions': [2.368359375, 1.2970703125, 3.299560546875, 1.9546712239583333]}}, 'pred_res': 'the kitchen<|eot_id|>', 'score': 0}
2025-01-22 06:14:27.796 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:14:27.796 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-86_pid-2_0-6-7-9.pkl | len: 3 |  size: 2.01 KB
Processing depth (0, 6, 7, 9):   3%|▎         | 3/100 [00:59<31:43, 19.62s/it]is_0k: False
your chose emoji: ['👩🏿\u200d✈️', '👞', '🧔🏾\u200d♂', '👩🏼\u200d⚕', '🚶🏿\u200d♂', '🇮🇷', '👨🏿\u200d❤\u200d👨🏿', '👩🏼\u200d🏫', '🙎\u200d♂', '🧑🏿\u200d🤝\u200d🧑🏾']
emoji:
O: 👩🏿‍✈️ [9468, 239, 102, 9468, 237, 123, 102470, 38798, 230, 31643]
N: 👩🏼‍⚕ [9468, 239, 102, 9468, 237, 120, 102470, 158, 248, 243]

O: 👞 [9468, 239, 252]
N: 🚶🏿‍♂ [9468, 248, 114, 9468, 237, 123, 102470, 17245, 224]

O: 🧔🏾‍♂ [9468, 100, 242, 9468, 237, 122, 102470, 17245, 224]
N: 👩🏼‍🏫 [9468, 239, 102, 9468, 237, 120, 102470, 9468, 237, 104]

O: 👩🏼‍⚕ [9468, 239, 102, 9468, 237, 120, 102470, 158, 248, 243]
N: 👩🏿‍✈️ [9468, 239, 102, 9468, 237, 123, 102470, 38798, 230, 31643]

O: 🚶🏿‍♂ [9468, 248, 114, 9468, 237, 123, 102470, 17245, 224]
N: 🧔🏾‍♂ [9468, 100, 242, 9468, 237, 122, 102470, 17245, 224]

O: 🇮🇷 [9468, 229, 106, 9468, 229, 115]
N: 👨🏿‍❤‍👨🏿 [9468, 239, 101, 9468, 237, 123, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 123]

O: 👨🏿‍❤‍👨🏿 [9468, 239, 101, 9468, 237, 123, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 123]
N: 🇮🇷 [9468, 229, 106, 9468, 229, 115]

O: 👩🏼‍🏫 [9468, 239, 102, 9468, 237, 120, 102470, 9468, 237, 104]
N: 🙎‍♂ [9468, 247, 236, 102470, 17245, 224]

O: 🙎‍♂ [9468, 247, 236, 102470, 17245, 224]
N: 👞 [9468, 239, 252]

O: 🧑🏿‍🤝‍🧑🏾 [9468, 100, 239, 9468, 237, 123, 102470, 9468, 97, 251, 102470, 9468, 100, 239, 9468, 237, 122]
N: 🧑🏿‍🤝‍🧑🏾 [9468, 100, 239, 9468, 237, 123, 102470, 9468, 97, 251, 102470, 9468, 100, 239, 9468, 237, 122]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.28s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.66s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:03,  3.97s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  2.57s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  3.20s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (3, 4, 5, 8):   3%|▎         | 3/100 [01:13<31:43, 19.62s/it]2025-01-22 06:14:42.387 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went to the bathroom.
2025-01-22 06:14:42.401 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2830, 2835) -->  Daniel went to the bathroom
2025-01-22 06:14:42.402 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the hallway.
2025-01-22 06:14:42.416 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2831, 2836) -->  went to the bathroom.
2025-01-22 06:14:42.416 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel left the milk.
2025-01-22 06:14:42.440 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4210, 4214) -->  left the milk.
2025-01-22 06:14:42.440 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the bathroom.
2025-01-22 06:14:42.475 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6529, 6535) --> . Sandra went back to the
2025-01-22 06:14:42.476 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John journeyed to the bedroom.
2025-01-22 06:14:42.479 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (613, 619) --> . John journeyed to the
2025-01-22 06:14:42.479 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the kitchen.
2025-01-22 06:14:42.488 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1872, 1878) --> . Mary journeyed to the
2025-01-22 06:14:42.488 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the hallway.
2025-01-22 06:14:42.492 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (613, 619) --> . John journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:14:45.761 | INFO     | test_jbb_embedding:begin_test:693 - the hallway<|eot_id|>
2025-01-22 06:14:45.761 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8158])
2025-01-22 06:14:48.964 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [166.7765625, 12.887271588959686, 80.73958333333333, 12.358017935184046, 15.139796401515152], 'topk_indices': array([  23,    8, 8131,    3, 8056, 8152, 8157, 4212, 2834,    4, 8046,
          1, 8012,    9, 7903,   24,   14, 8156,    0, 8153]), 'topk_tokens': ['4', ' Date', '.', '<|end_header_id|>', ' location', ':', '\n\n', ' milk', ' bathroom', '\n\n', '.\n\n', '<|start_header_id|>', ' context', ':', ' Square', '\n\n', '\n', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [198.45, 184.675, 238.1875, 77.859375]}, 'weight': {'score': [22.086328125, 23.274246415880405, 19.62673611111111, 23.28525387018343, 29.630681818181817], 'topk_indices': array([3287, 3314, 3159, 3207, 7405, 7443, 1498, 1436, 4284, 4300, 5143,
       5204, 7120, 7176, 3496, 3470, 4920, 4997, 4945, 4968]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [25.3546875, 20.465625, 20.3515625, 21.869791666666668]}, 'saliency': {'score': [1.05465087890625, 0.07231028888348548, 0.4127061631944444, 0.06913733091991875, 0.11329448584354285], 'topk_indices': array([6535, 4210, 8130, 8127, 8046, 8145, 2830, 7902, 8151, 4209,    8,
         14, 8056,   24, 8148, 3608, 4212, 8012, 2834, 7903]), 'topk_tokens': [' bathroom', ' left', ' directly', ' return', '.\n\n', ' milk', ' Daniel', 'Bridge', 'Answer', ' Daniel', ' Date', '\n', ' location', '\n\n', ' hallway', ' hallway', ' milk', ' context', ' bathroom', ' Square'], 'evidence_proportions': [1.44765625, 1.153076171875, 1.32275390625, 0.4663899739583333]}}, 'pred_res': 'the hallway<|eot_id|>', 'score': 0}
2025-01-22 06:14:48.972 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:14:48.972 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-86_pid-3_3-4-5-8.pkl | len: 3 |  size: 2.02 KB
Processing depth (3, 4, 5, 8):   4%|▍         | 4/100 [01:20<32:22, 20.23s/it]is_0k: False
your chose emoji: ['🇻🇪', '🤸🏽\u200d♀', '🦑', '🏋🏻\u200d♂', '🔏', '🧟\u200d♀️', '🧛\u200d♀️', '👩🏽\u200d❤️\u200d👩🏻', '🦆', '🛀🏿']
emoji:
O: 🇻🇪 [9468, 229, 119, 9468, 229, 103]
N: 🇻🇪 [9468, 229, 119, 9468, 229, 103]

O: 🤸🏽‍♀ [9468, 97, 116, 9468, 237, 121, 102470, 32990]
N: 🧛‍♀️ [9468, 100, 249, 102470, 32990, 31643]

O: 🦑 [9468, 99, 239]
N: 🔏 [9468, 242, 237]

O: 🏋🏻‍♂ [9468, 237, 233, 9468, 237, 119, 102470, 17245, 224]
N: 🧟‍♀️ [9468, 100, 253, 102470, 32990, 31643]

O: 🔏 [9468, 242, 237]
N: 👩🏽‍❤️‍👩🏻 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 31643, 102470, 9468, 239, 102, 9468, 237, 119]

O: 🧟‍♀️ [9468, 100, 253, 102470, 32990, 31643]
N: 🤸🏽‍♀ [9468, 97, 116, 9468, 237, 121, 102470, 32990]

O: 🧛‍♀️ [9468, 100, 249, 102470, 32990, 31643]
N: 🏋🏻‍♂ [9468, 237, 233, 9468, 237, 119, 102470, 17245, 224]

O: 👩🏽‍❤️‍👩🏻 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 31643, 102470, 9468, 239, 102, 9468, 237, 119]
N: 🦑 [9468, 99, 239]

O: 🦆 [9468, 99, 228]
N: 🦆 [9468, 99, 228]

O: 🛀🏿 [9468, 249, 222, 9468, 237, 123]
N: 🛀🏿 [9468, 249, 222, 9468, 237, 123]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.36s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.67s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.57s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.22s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.71s/it]
Processing depth (1, 3, 7, 8):   4%|▍         | 4/100 [01:36<32:22, 20.23s/it]2025-01-22 06:15:05.545 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went to the bathroom.
2025-01-22 06:15:05.549 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (676, 681) --> . Daniel went to the
2025-01-22 06:15:05.549 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the hallway.
2025-01-22 06:15:05.553 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (676, 681) --> . Daniel went to the
2025-01-22 06:15:05.553 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel left the milk.
2025-01-22 06:15:05.585 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5647, 5651) -->  Daniel left the milk
2025-01-22 06:15:05.585 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the bathroom.
2025-01-22 06:15:05.618 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6637, 6643) --> . Sandra went back to the
2025-01-22 06:15:05.618 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John journeyed to the bedroom.
2025-01-22 06:15:05.620 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (399, 405) --> . John journeyed to the
2025-01-22 06:15:05.620 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the kitchen.
2025-01-22 06:15:05.629 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1826, 1832) --> . Mary journeyed to the
2025-01-22 06:15:05.629 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the hallway.
2025-01-22 06:15:05.631 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (399, 405) --> . John journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:15:06.561 | INFO     | test_jbb_embedding:begin_test:693 - The milk was in the hallway.<|eot_id|>
2025-01-22 06:15:06.561 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8212])
2025-01-22 06:15:08.808 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [183.303125, 18.579338481436398, 117.63194444444444, 17.958398939097467, 10.813214045698924], 'topk_indices': array([6071, 8202, 5646, 2848, 6078, 8206, 5650,   23,    4,    1, 8140,
       8110, 5647, 8100,    9,   24,   14, 8210,    0, 8207]), 'topk_tokens': [' the', ' hallway', '.', ' hallway', 'the', ':', ' milk', '4', '\n\n', '<|start_header_id|>', ' the', ' location', ' Daniel', '.\n\n', ':', '\n\n', '\n', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [153.1875, 153.1875, 355.1875, 118.90625]}, 'weight': {'score': [21.686328125, 23.315349208764456, 19.62673611111111, 23.32745333710407, 29.603326612903224], 'topk_indices': array([3328, 3301, 3221, 3173, 7483, 7445, 1462, 1524, 4293, 4309, 5191,
       5130, 7186, 7130, 3484, 3510, 4932, 4955, 4984, 4907]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.665625, 19.665625, 26.462890625, 21.869791666666668]}, 'saliency': {'score': [1.16231689453125, 0.10296553590278834, 0.5978461371527778, 0.09928510567225526, 0.07896636634744623], 'topk_indices': array([8138, 8184, 5645,    0, 8205, 8181, 8200,   14, 7949, 8100, 8199,
       6078,    8,   24,  681, 5650, 8110, 8202, 2848, 5647]), 'topk_tokens': [' moved', ' directly', ' St', '<|begin_of_text|>', 'Answer', ' return', ' before', '\n', ' Square', '.\n\n', ' milk', 'the', ' Date', '\n\n', ' bathroom', ' milk', ' location', ' hallway', ' hallway', ' Daniel'], 'evidence_proportions': [0.86025390625, 0.86025390625, 2.52490234375, 0.7573649088541666]}}, 'pred_res': 'The milk was in the hallway.<|eot_id|>', 'score': 0}
2025-01-22 06:15:08.813 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:15:08.813 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-86_pid-4_1-3-7-8.pkl | len: 3 |  size: 2.03 KB
Processing depth (1, 3, 7, 8):   5%|▌         | 5/100 [01:40<31:48, 20.09s/it]Processing depth (1, 3, 7, 8):   5%|▌         | 5/100 [01:40<31:41, 20.02s/it]
2025-01-22 06:15:08.870 | INFO     | __main__:<module>:82 - Selected idx: 87
2025-01-22 06:15:08.870 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the location prior to the place where the apple was discarded, left or dropped?
2025-01-22 06:15:08.870 | INFO     | __main__:<module>:84 - Answer: bathroom
2025-01-22 06:15:08.870 | INFO     | __main__:<module>:85 - Tag: 4-hop
2025-01-22 06:15:08.870 | INFO     | __main__:<module>:86 - Needle: [' Mary journeyed to the kitchen.', ' Daniel went to the bathroom.', ' John journeyed to the bedroom.', ' Daniel grabbed the apple.', ' John journeyed to the hallway.', ' Daniel went to the hallway.', ' Daniel left the apple.', ' Sandra went back to the bathroom.']
2025-01-22 06:15:08.870 | INFO     | __main__:<module>:87 - Real Needle: [' Daniel went to the bathroom.', ' Daniel grabbed the apple.', ' Daniel went to the hallway.', ' Daniel left the apple.', ' Sandra went back to the bathroom.']
2025-01-22 06:15:08.870 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['🔸', '🏴\U000e0067\U000e0062\U000e0073\U000e0063\U000e0074\U000e007f', '✉️', '🔜', '\U0001faf1🏿\u200d\U0001faf2🏼', '🧎🏼\u200d➡', '👱🏼', '🧍\u200d♂️', '👩🏻\u200d❤\u200d💋\u200d👩🏽', '👨🏿\u200d🦽']
emoji:
O: 🔸 [9468, 242, 116]
N: 👱🏼 [9468, 239, 109, 9468, 237, 120]

O: 🏴󠁧󠁢󠁳󠁣󠁴󠁿 [9468, 237, 112, 175, 16050, 100, 175, 16050, 95, 175, 16050, 111, 175, 16050, 96, 175, 16050, 112, 175, 16050, 123]
N: 🧍‍♂️ [9468, 100, 235, 102470, 17245, 224, 31643]

O: ✉️ [38798, 231, 31643]
N: 🧎🏼‍➡ [9468, 100, 236, 9468, 237, 120, 102470, 98115, 94]

O: 🔜 [9468, 242, 250]
N: 🔜 [9468, 242, 250]

O: 🫱🏿‍🫲🏼 [9468, 104, 109, 9468, 237, 123, 102470, 9468, 104, 110, 9468, 237, 120]
N: 🔸 [9468, 242, 116]

O: 🧎🏼‍➡ [9468, 100, 236, 9468, 237, 120, 102470, 98115, 94]
N: 🫱🏿‍🫲🏼 [9468, 104, 109, 9468, 237, 123, 102470, 9468, 104, 110, 9468, 237, 120]

O: 👱🏼 [9468, 239, 109, 9468, 237, 120]
N: 🏴󠁧󠁢󠁳󠁣󠁴󠁿 [9468, 237, 112, 175, 16050, 100, 175, 16050, 95, 175, 16050, 111, 175, 16050, 96, 175, 16050, 112, 175, 16050, 123]

O: 🧍‍♂️ [9468, 100, 235, 102470, 17245, 224, 31643]
N: 👩🏻‍❤‍💋‍👩🏽 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 121]

O: 👩🏻‍❤‍💋‍👩🏽 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 121]
N: ✉️ [38798, 231, 31643]

O: 👨🏿‍🦽 [9468, 239, 101, 9468, 237, 123, 102470, 9468, 99, 121]
N: 👨🏿‍🦽 [9468, 239, 101, 9468, 237, 123, 102470, 9468, 99, 121]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.96s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.80s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.29s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.79s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.45s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 1, 2, 4, 6):   0%|          | 0/100 [00:15<?, ?it/s]2025-01-22 06:15:24.530 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went to the bathroom.
2025-01-22 06:15:24.530 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  went to the bathroom.
2025-01-22 06:15:24.530 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel grabbed the apple.
2025-01-22 06:15:24.535 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (909, 913) -->  Daniel grabbed the apple
2025-01-22 06:15:24.535 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the hallway.
2025-01-22 06:15:24.545 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1887, 1892) --> . Daniel went to the
2025-01-22 06:15:24.545 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the apple.
2025-01-22 06:15:24.563 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3757, 3761) -->  Daniel left the apple
2025-01-22 06:15:24.563 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra went back to the bathroom.
2025-01-22 06:15:24.587 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4890, 4896) --> . Sandra went back to the
2025-01-22 06:15:24.587 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the kitchen.
2025-01-22 06:15:24.591 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (631, 637) --> . Mary journeyed to the
2025-01-22 06:15:24.592 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bedroom.
2025-01-22 06:15:24.607 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2539, 2545) --> . John journeyed to the
2025-01-22 06:15:24.607 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the hallway.
2025-01-22 06:15:24.620 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2539, 2545) --> . John journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:15:30.824 | INFO     | test_jbb_embedding:begin_test:693 - Daniel grabbed the apple.<|eot_id|>
2025-01-22 06:15:30.824 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8232])
2025-01-22 06:15:34.048 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [317.5260416666667, 33.78711672738312, 265.90972222222223, 32.44597903698279, 16.239725748697918], 'topk_indices': array([8096, 8118, 8212, 8205,   24, 8218,    4, 8206, 8219, 8119, 8077,
       8125, 8133,    9, 8120, 8111, 8134, 8121,   14,    0]), 'topk_tokens': ['.', ' in', ' to', 'Question', '\n\n', ' was', '\n\n', ':', ' discarded', ' the', ' context', ' the', ' in', ':', ' first', '.\n\n', ' the', ' location', '\n', '<|begin_of_text|>'], 'evidence_proportions': [410.95, 400.125, 243.625, 386.4375, 200.25]}, 'weight': {'score': [22.97265625, 23.307919702489375, 19.62673611111111, 23.316989350665203, 29.131998697916668], 'topk_indices': array([3317, 3290, 3210, 3162, 7438, 7476, 1451, 1513, 4309, 4293, 5216,
       5155, 7215, 7159, 3473, 3499, 4966, 4943, 4918, 4995]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.465625, 28.333984375, 19.665625, 26.533203125, 21.869791666666668]}, 'saliency': {'score': [1.9398701985677083, 0.18778579424711597, 1.4500054253472223, 0.17988026769231355, 0.1194297472635905], 'topk_indices': array([8215, 8218, 4896, 8115, 8134, 1892, 8082, 8117,   14,    8, 8123,
       8211, 8217,   34, 8077, 8205, 8111, 8120, 8219, 8121]), 'topk_tokens': [' where', ' was', ' bathroom', ' obtained', ' the', ' hallway', ' locations', ' item', '\n', ' Date', ' traveled', ' prior', ' apple', ' bathroom', ' context', 'Question', '.\n\n', ' first', ' discarded', ' location'], 'evidence_proportions': [2.36923828125, 2.895751953125, 1.181640625, 2.580810546875, 1.1493733723958333]}}, 'pred_res': 'Daniel grabbed the apple.<|eot_id|>', 'score': 0}
2025-01-22 06:15:34.067 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:15:34.070 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-87_pid-0_0-1-2-4-6.pkl | len: 3 |  size: 2.06 KB
Processing depth (0, 1, 2, 4, 6):   1%|          | 1/100 [00:25<41:25, 25.10s/it]is_0k: False
your chose emoji: ['👌🏼', '👂🏼', '👷\u200d♂️', '👩🏼\u200d🤝\u200d👨🏾', '👨\u200d🦯', '🧑🏻\u200d🤝\u200d🧑🏼', '🧎🏿\u200d♀\u200d➡️', '🩲', '👼🏿', '👩\u200d👩\u200d👧\u200d👦']
emoji:
O: 👌🏼 [9468, 239, 234, 9468, 237, 120]
N: 👩🏼‍🤝‍👨🏾 [9468, 239, 102, 9468, 237, 120, 102470, 9468, 97, 251, 102470, 9468, 239, 101, 9468, 237, 122]

O: 👂🏼 [9468, 239, 224, 9468, 237, 120]
N: 👂🏼 [9468, 239, 224, 9468, 237, 120]

O: 👷‍♂️ [9468, 239, 115, 102470, 17245, 224, 31643]
N: 🩲 [9468, 102, 110]

O: 👩🏼‍🤝‍👨🏾 [9468, 239, 102, 9468, 237, 120, 102470, 9468, 97, 251, 102470, 9468, 239, 101, 9468, 237, 122]
N: 🧎🏿‍♀‍➡️ [9468, 100, 236, 9468, 237, 123, 102470, 32990, 102470, 98115, 94, 31643]

O: 👨‍🦯 [9468, 239, 101, 102470, 9468, 99, 107]
N: 👷‍♂️ [9468, 239, 115, 102470, 17245, 224, 31643]

O: 🧑🏻‍🤝‍🧑🏼 [9468, 100, 239, 9468, 237, 119, 102470, 9468, 97, 251, 102470, 9468, 100, 239, 9468, 237, 120]
N: 🧑🏻‍🤝‍🧑🏼 [9468, 100, 239, 9468, 237, 119, 102470, 9468, 97, 251, 102470, 9468, 100, 239, 9468, 237, 120]

O: 🧎🏿‍♀‍➡️ [9468, 100, 236, 9468, 237, 123, 102470, 32990, 102470, 98115, 94, 31643]
N: 👼🏿 [9468, 239, 120, 9468, 237, 123]

O: 🩲 [9468, 102, 110]
N: 👌🏼 [9468, 239, 234, 9468, 237, 120]

O: 👼🏿 [9468, 239, 120, 9468, 237, 123]
N: 👨‍🦯 [9468, 239, 101, 102470, 9468, 99, 107]

O: 👩‍👩‍👧‍👦 [9468, 239, 102, 102470, 9468, 239, 102, 102470, 9468, 239, 100, 102470, 9468, 239, 99]
N: 👩‍👩‍👧‍👦 [9468, 239, 102, 102470, 9468, 239, 102, 102470, 9468, 239, 100, 102470, 9468, 239, 99]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:05<00:15,  5.23s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.65s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.41s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.06s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.65s/it]
Processing depth (0, 1, 2, 5, 7):   1%|          | 1/100 [00:41<41:25, 25.10s/it]2025-01-22 06:15:50.492 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went to the bathroom.
2025-01-22 06:15:50.492 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  went to the bathroom.
2025-01-22 06:15:50.493 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel grabbed the apple.
2025-01-22 06:15:50.496 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (794, 798) -->  grabbed the apple.
2025-01-22 06:15:50.497 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the hallway.
2025-01-22 06:15:50.506 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1809, 1814) --> . Daniel went to the
2025-01-22 06:15:50.506 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the apple.
2025-01-22 06:15:50.526 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4231, 4235) -->  left the apple.
2025-01-22 06:15:50.527 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra went back to the bathroom.
2025-01-22 06:15:50.555 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5734, 5740) --> . Sandra went back to the
2025-01-22 06:15:50.555 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the kitchen.
2025-01-22 06:15:50.558 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (607, 613) --> . Mary journeyed to the
2025-01-22 06:15:50.559 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bedroom.
2025-01-22 06:15:50.571 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2505, 2511) --> . John journeyed to the
2025-01-22 06:15:50.571 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the hallway.
2025-01-22 06:15:50.584 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2505, 2511) --> . John journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:15:51.323 | INFO     | test_jbb_embedding:begin_test:693 - the hallway<|eot_id|>
2025-01-22 06:15:51.323 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8164])
2025-01-22 06:15:53.534 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [315.4296875, 25.97540215195298, 117.86805555555556, 24.916821153846154, 36.790826612903224], 'topk_indices': array([8008,  556, 8071, 5740, 8144,   24, 8053, 3110,   14,   31, 8083,
         32,  797, 8043, 8009,   34,  551, 8159,    0, 8160]), 'topk_tokens': [' you', ',', ' a', ' bathroom', ' to', '\n\n', ' location', 'ern', '\n', ' went', ' the', ' to', '.', '.\n\n', ' context', ' bathroom', ',', '<|eot_id|>', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [597.55, 420.5, 119.4875, 303.1875, 181.72916666666666]}, 'weight': {'score': [20.935546875, 23.265730225296927, 19.62673611111111, 23.280675, 29.547127016129032], 'topk_indices': array([3290, 3317, 3210, 3162, 7410, 7448, 1507, 1445, 4305, 4321, 5189,
       5128, 7093, 7149, 3499, 3473, 4905, 4953, 4982, 4930]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.465625, 22.22265625, 19.665625, 20.421875, 21.869791666666668]}, 'saliency': {'score': [1.8155517578125, 0.14424110320114486, 0.6050618489583334, 0.13828341346153847, 0.27934142081968244], 'topk_indices': array([8008,  551, 8046, 3109,  117, 8137,  794, 8149,  796, 4233, 8143,
        435, 8043, 8053, 3110,   31, 8151, 5740, 8009,   34]), 'topk_tokens': [' you', ',', ' person', ' const', 'ION', 'Question', ' grabbed', ' apple', ' apple', ' apple', ' prior', '000', '.\n\n', ' location', 'ern', ' went', ' discarded', ' bathroom', ' context', ' bathroom'], 'evidence_proportions': [3.73515625, 2.230224609375, 0.61650390625, 1.6527099609375, 1.0472005208333333]}}, 'pred_res': 'the hallway<|eot_id|>', 'score': 0}
2025-01-22 06:15:53.541 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:15:53.542 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-87_pid-1_0-1-2-5-7.pkl | len: 3 |  size: 2.05 KB
Processing depth (0, 1, 2, 5, 7):   2%|▏         | 2/100 [00:44<35:35, 21.79s/it]is_0k: False
your chose emoji: ['🧛🏻\u200d♂', '🧝', '🏃🏻\u200d♀️\u200d➡', '🌺', '👨🏾\u200d🌾', '🧖🏿\u200d♀', '🌙', '🦹🏻', '🇹🇱', '↔']
emoji:
O: 🧛🏻‍♂ [9468, 100, 249, 9468, 237, 119, 102470, 17245, 224]
N: 🇹🇱 [9468, 229, 117, 9468, 229, 109]

O: 🧝 [9468, 100, 251]
N: 🧖🏿‍♀ [9468, 100, 244, 9468, 237, 123, 102470, 32990]

O: 🏃🏻‍♀️‍➡ [9468, 237, 225, 9468, 237, 119, 102470, 32990, 31643, 102470, 98115, 94]
N: 🌺 [9468, 234, 118]

O: 🌺 [9468, 234, 118]
N: 🏃🏻‍♀️‍➡ [9468, 237, 225, 9468, 237, 119, 102470, 32990, 31643, 102470, 98115, 94]

O: 👨🏾‍🌾 [9468, 239, 101, 9468, 237, 122, 102470, 9468, 234, 122]
N: 🦹🏻 [9468, 99, 117, 9468, 237, 119]

O: 🧖🏿‍♀ [9468, 100, 244, 9468, 237, 123, 102470, 32990]
N: 🌙 [9468, 234, 247]

O: 🌙 [9468, 234, 247]
N: 🧝 [9468, 100, 251]

O: 🦹🏻 [9468, 99, 117, 9468, 237, 119]
N: 👨🏾‍🌾 [9468, 239, 101, 9468, 237, 122, 102470, 9468, 234, 122]

O: 🇹🇱 [9468, 229, 117, 9468, 229, 109]
N: 🧛🏻‍♂ [9468, 100, 249, 9468, 237, 119, 102470, 17245, 224]

O: ↔ [27017, 242]
N: ↔ [27017, 242]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.36s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:10,  5.06s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.80s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.27s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.83s/it]
Processing depth (2, 3, 4, 6, 8):   2%|▏         | 2/100 [01:01<35:35, 21.79s/it]2025-01-22 06:16:10.649 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went to the bathroom.
2025-01-22 06:16:10.659 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1854, 1859) --> . Daniel went to the
2025-01-22 06:16:10.660 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel grabbed the apple.
2025-01-22 06:16:10.676 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2982, 2986) -->  Daniel grabbed the apple
2025-01-22 06:16:10.676 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the hallway.
2025-01-22 06:16:10.685 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1854, 1859) --> . Daniel went to the
2025-01-22 06:16:10.685 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the apple.
2025-01-22 06:16:10.711 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4745, 4749) -->  left the apple.
2025-01-22 06:16:10.711 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra went back to the bathroom.
2025-01-22 06:16:10.748 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6532, 6538) --> . Sandra went back to the
2025-01-22 06:16:10.748 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the kitchen.
2025-01-22 06:16:10.751 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (601, 607) --> . Mary journeyed to the
2025-01-22 06:16:10.752 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bedroom.
2025-01-22 06:16:10.764 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2506, 2512) --> . John journeyed to the
2025-01-22 06:16:10.764 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the hallway.
2025-01-22 06:16:10.778 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2506, 2512) --> . John journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:16:11.521 | INFO     | test_jbb_embedding:begin_test:693 - the hallway<|eot_id|>
2025-01-22 06:16:11.522 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8178])
2025-01-22 06:16:13.748 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [172.5234375, 20.159260023224544, 114.94965277777777, 19.500337879346358, 15.527711730072463], 'topk_indices': array([8057, 8158, 8157,   14, 8151, 7354,   24, 7502, 8152, 8023, 8176,
       1859, 3890, 7355, 7547, 7503, 7548,    0, 8173, 8174]), 'topk_tokens': ['.\n\n', ' to', ' prior', '\n', 'Question', ' Min', '\n\n', ' Min', ':', ' context', '<|end_header_id|>', ' bathroom', ' bedroom', 'nes', ' Min', 'nes', 'nes', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [185.25, 217.8125, 185.25, 172.625, 121.05208333333333]}, 'weight': {'score': [21.787434895833332, 23.27166605549444, 19.62673611111111, 23.284103736638407, 29.274003623188406], 'topk_indices': array([3262, 3289, 3134, 3182, 7440, 7402, 1480, 1418, 4328, 4312, 5158,
       5219, 7123, 7179, 3445, 3471, 4935, 5012, 4983, 4960]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.665625, 28.333984375, 19.665625, 20.421875, 21.869791666666668]}, 'saliency': {'score': [1.0316416422526042, 0.11316686410394512, 0.5966525607638888, 0.10938923328745086, 0.11281021781589674], 'topk_indices': array([2512, 7277, 8067, 8171, 8163, 2985, 7306, 6538, 8165, 7354, 8157,
       7502, 8023, 8151, 1859, 7355, 3890, 7547, 7548, 7503]), 'topk_tokens': [' hallway', 'nes', ' location', 'Answer', ' apple', ' apple', 'nes', ' bathroom', ' discarded', ' Min', ' prior', ' Min', ' context', 'Question', ' bathroom', 'nes', ' bedroom', ' Min', 'nes', 'nes'], 'evidence_proportions': [1.029248046875, 1.6300048828125, 1.029248046875, 0.8905029296875, 0.7308146158854166]}}, 'pred_res': 'the hallway<|eot_id|>', 'score': 0}
2025-01-22 06:16:13.769 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:16:13.769 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-87_pid-2_2-3-4-6-8.pkl | len: 3 |  size: 2.07 KB
Processing depth (2, 3, 4, 6, 8):   3%|▎         | 3/100 [01:04<34:04, 21.08s/it]is_0k: False
your chose emoji: ['🎇', '\U0001faf1🏻', '👈🏻', '🇧🇸', '👨🏽\u200d🦯\u200d➡', '🙋\u200d♀️', '🧜🏾\u200d♀️', '\U0001fac4🏽', '👨🏽\u200d🌾', '🕉️']
emoji:
O: 🎇 [9468, 236, 229]
N: 🫱🏻 [9468, 104, 109, 9468, 237, 119]

O: 🫱🏻 [9468, 104, 109, 9468, 237, 119]
N: 👨🏽‍🌾 [9468, 239, 101, 9468, 237, 121, 102470, 9468, 234, 122]

O: 👈🏻 [9468, 239, 230, 9468, 237, 119]
N: 👨🏽‍🦯‍➡ [9468, 239, 101, 9468, 237, 121, 102470, 9468, 99, 107, 102470, 98115, 94]

O: 🇧🇸 [9468, 229, 100, 9468, 229, 116]
N: 🇧🇸 [9468, 229, 100, 9468, 229, 116]

O: 👨🏽‍🦯‍➡ [9468, 239, 101, 9468, 237, 121, 102470, 9468, 99, 107, 102470, 98115, 94]
N: 🎇 [9468, 236, 229]

O: 🙋‍♀️ [9468, 247, 233, 102470, 32990, 31643]
N: 🫄🏽 [9468, 104, 226, 9468, 237, 121]

O: 🧜🏾‍♀️ [9468, 100, 250, 9468, 237, 122, 102470, 32990, 31643]
N: 🙋‍♀️ [9468, 247, 233, 102470, 32990, 31643]

O: 🫄🏽 [9468, 104, 226, 9468, 237, 121]
N: 👈🏻 [9468, 239, 230, 9468, 237, 119]

O: 👨🏽‍🌾 [9468, 239, 101, 9468, 237, 121, 102470, 9468, 234, 122]
N: 🧜🏾‍♀️ [9468, 100, 250, 9468, 237, 122, 102470, 32990, 31643]

O: 🕉️ [9468, 243, 231, 31643]
N: 🕉️ [9468, 243, 231, 31643]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:11,  3.76s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.47s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.75s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.34s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.75s/it]
Processing depth (0, 1, 2, 3, 5):   3%|▎         | 3/100 [01:21<34:04, 21.08s/it]2025-01-22 06:16:30.582 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went to the bathroom.
2025-01-22 06:16:30.582 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  went to the bathroom.
2025-01-22 06:16:30.583 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel grabbed the apple.
2025-01-22 06:16:30.587 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (909, 913) -->  Daniel grabbed the apple
2025-01-22 06:16:30.587 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the hallway.
2025-01-22 06:16:30.597 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1765, 1770) --> . Daniel went to the
2025-01-22 06:16:30.597 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the apple.
2025-01-22 06:16:30.614 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2913, 2917) -->  Daniel left the apple
2025-01-22 06:16:30.615 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra went back to the bathroom.
2025-01-22 06:16:30.638 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4247, 4253) -->  Sandra went back to the bathroom
2025-01-22 06:16:30.639 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the kitchen.
2025-01-22 06:16:30.642 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (631, 637) --> . Mary journeyed to the
2025-01-22 06:16:30.642 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bedroom.
2025-01-22 06:16:30.654 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2437, 2443) --> . John journeyed to the
2025-01-22 06:16:30.654 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the hallway.
2025-01-22 06:16:30.667 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2437, 2443) --> . John journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:16:31.447 | INFO     | test_jbb_embedding:begin_test:693 - the hallway<|eot_id|>
2025-01-22 06:16:31.447 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8202])
2025-01-22 06:16:33.681 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [402.1536458333333, 31.99411943936624, 190.00694444444446, 30.55738545877741, 10.393699363425926], 'topk_indices': array([  24, 2917,   35, 8185,  912, 8176, 8181,  568, 8188,  429, 8091,
       8187, 8081,   14, 8182, 8189,  913,   34,  430,    0]), 'topk_tokens': ['\n\n', '.', '.', ' where', ' apple', ':', ' prior', ' em', ' was', ' em', ' location', ' apple', '.\n\n', '\n', ' to', ' discarded', '.', ' bathroom', 's', '<|begin_of_text|>'], 'evidence_proportions': [639.85, 548.0, 167.7625, 389.25, 310.7708333333333]}, 'weight': {'score': [24.157877604166668, 23.290383150517975, 19.62673611111111, 23.29591123820899, 29.322337962962962], 'topk_indices': array([3307, 3334, 3227, 3179, 7446, 7484, 1463, 1525, 4316, 4300, 5167,
       5228, 7223, 7167, 3516, 3490, 4969, 4992, 5021, 4944]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.465625, 28.333984375, 19.665625, 26.533203125, 26.610677083333332]}, 'saliency': {'score': [2.6234334309895835, 0.18105935905126447, 0.9785427517361112, 0.17212003787095737, 0.07473114390432099], 'topk_indices': array([8177,   39, 8188,  451, 8081, 1770, 2916, 8185, 8175,  910,  430,
        568, 8091,  429,  912, 4252, 8181, 8187, 8189,   34]), 'topk_tokens': [' Where', '\n\n\n', ' was', ' em', '.\n\n', ' hallway', ' apple', ' where', 'Question', ' grabbed', 's', ' em', ' location', ' em', ' apple', ' bathroom', ' prior', ' apple', ' discarded', ' bathroom'], 'evidence_proportions': [3.819921875, 4.02685546875, 0.801171875, 2.587646484375, 2.233154296875]}}, 'pred_res': 'the hallway<|eot_id|>', 'score': 0}
2025-01-22 06:16:33.689 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:16:33.689 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-87_pid-3_0-1-2-3-5.pkl | len: 3 |  size: 2.02 KB
Processing depth (0, 1, 2, 3, 5):   4%|▍         | 4/100 [01:24<32:59, 20.62s/it]is_0k: False
your chose emoji: ['👵🏽', '5️⃣', '😾', '👩🏻\u200d❤\u200d💋\u200d👨🏿', '🇮🇶', '👩🏽\u200d❤\u200d👨🏼', '👩🏻\u200d🦽\u200d➡', '🦹🏻\u200d♂️', '⛺', '🪲']
emoji:
O: 👵🏽 [9468, 239, 113, 9468, 237, 121]
N: 👩🏻‍❤‍💋‍👨🏿 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 123]

O: 5️⃣ [20, 31643, 158, 225, 96]
N: 😾 [76460, 122]

O: 😾 [76460, 122]
N: ⛺ [158, 249, 118]

O: 👩🏻‍❤‍💋‍👨🏿 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 123]
N: 👩🏻‍🦽‍➡ [9468, 239, 102, 9468, 237, 119, 102470, 9468, 99, 121, 102470, 98115, 94]

O: 🇮🇶 [9468, 229, 106, 9468, 229, 114]
N: 👩🏽‍❤‍👨🏼 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 120]

O: 👩🏽‍❤‍👨🏼 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 120]
N: 5️⃣ [20, 31643, 158, 225, 96]

O: 👩🏻‍🦽‍➡ [9468, 239, 102, 9468, 237, 119, 102470, 9468, 99, 121, 102470, 98115, 94]
N: 👵🏽 [9468, 239, 113, 9468, 237, 121]

O: 🦹🏻‍♂️ [9468, 99, 117, 9468, 237, 119, 102470, 17245, 224, 31643]
N: 🦹🏻‍♂️ [9468, 99, 117, 9468, 237, 119, 102470, 17245, 224, 31643]

O: ⛺ [158, 249, 118]
N: 🇮🇶 [9468, 229, 106, 9468, 229, 114]

O: 🪲 [9468, 103, 110]
N: 🪲 [9468, 103, 110]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.35s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.53s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.13s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.70s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.29s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 1, 2, 5, 8):   4%|▍         | 4/100 [01:39<32:59, 20.62s/it]2025-01-22 06:16:48.949 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went to the bathroom.
2025-01-22 06:16:48.949 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  went to the bathroom.
2025-01-22 06:16:48.949 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel grabbed the apple.
2025-01-22 06:16:48.953 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (682, 686) -->  grabbed the apple.
2025-01-22 06:16:48.954 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the hallway.
2025-01-22 06:16:48.963 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1616, 1621) -->  Daniel went to the hallway
2025-01-22 06:16:48.964 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the apple.
2025-01-22 06:16:48.984 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4227, 4231) -->  left the apple.
2025-01-22 06:16:48.984 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra went back to the bathroom.
2025-01-22 06:16:49.016 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6532, 6538) --> . Sandra went back to the
2025-01-22 06:16:49.017 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the kitchen.
2025-01-22 06:16:49.020 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (615, 621) --> . Mary journeyed to the
2025-01-22 06:16:49.020 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bedroom.
2025-01-22 06:16:49.035 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2247, 2253) --> . John journeyed to the
2025-01-22 06:16:49.035 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the hallway.
2025-01-22 06:16:49.047 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2247, 2253) --> . John journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:16:53.176 | INFO     | test_jbb_embedding:begin_test:693 - Daniel's hand.<|eot_id|>
2025-01-22 06:16:53.177 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8190])
2025-01-22 06:16:56.237 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [390.6197916666667, 33.93428078847797, 174.52083333333334, 32.57358759661391, 42.41934895833333], 'topk_indices': array([8164, 8186, 8175, 8173, 8170, 8177, 4240, 4237, 8079, 8185,  685,
         34,  347, 8176,  376,  350,  348,  379,  351,    0]), 'topk_tokens': [':', '<|start_header_id|>', ' apple', ' where', ' to', ' discarded', 'outs', 'ree', ' location', '<|eot_id|>', '.', ' bathroom', ' half', ' was', ' half', ' past', ' of', ' past', ' century', '<|begin_of_text|>'], 'evidence_proportions': [568.75, 608.875, 212.425, 464.5, 195.91666666666666]}, 'weight': {'score': [22.205403645833332, 23.280613023312583, 19.62673611111111, 23.291847817752423, 29.27125], 'topk_indices': array([3337, 3310, 3230, 3182, 7428, 7466, 1521, 1459, 4317, 4301, 5124,
       5185, 7149, 7205, 3519, 3493, 4901, 4978, 4949, 4926]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.465625, 22.22265625, 25.7609375, 20.421875, 21.869791666666668]}, 'saliency': {'score': [2.24298095703125, 0.1943809335141279, 0.9036593967013888, 0.18678267404881302, 0.3054152425130208], 'topk_indices': array([4229,  684, 8173, 8163, 6538, 8176, 8169,  346,  375, 8175, 8079,
       4240, 4237,  376,  347, 8177,  350,   34,  379,  351]), 'topk_tokens': [' apple', ' apple', ' where', 'Question', ' bathroom', ' was', ' prior', ' latter', ' latter', ' apple', ' location', 'outs', 'ree', ' half', ' half', ' discarded', ' past', ' bathroom', ' past', ' century'], 'evidence_proportions': [3.40654296875, 3.154541015625, 1.50166015625, 2.486328125, 1.1211751302083333]}}, 'pred_res': "Daniel's hand.<|eot_id|>", 'score': 0}
2025-01-22 06:16:56.246 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:16:56.246 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-87_pid-4_0-1-2-5-8.pkl | len: 3 |  size: 2.08 KB
Processing depth (0, 1, 2, 5, 8):   5%|▌         | 5/100 [01:47<33:45, 21.32s/it]Processing depth (0, 1, 2, 5, 8):   5%|▌         | 5/100 [01:47<34:00, 21.48s/it]
2025-01-22 06:16:56.351 | INFO     | __main__:<module>:82 - Selected idx: 88
2025-01-22 06:16:56.351 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the milk before the hallway? 
2025-01-22 06:16:56.351 | INFO     | __main__:<module>:84 - Answer: bathroom
2025-01-22 06:16:56.351 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 06:16:56.351 | INFO     | __main__:<module>:86 - Needle: [' Daniel went to the bathroom.', ' Mary journeyed to the kitchen.', ' John journeyed to the bedroom.', ' Daniel went to the hallway.', ' John journeyed to the hallway.', ' Daniel left the milk.', ' Sandra went back to the bathroom.']
2025-01-22 06:16:56.351 | INFO     | __main__:<module>:87 - Real Needle: [' Daniel went to the bathroom.', ' Daniel went to the hallway.', ' Daniel left the milk.', ' Sandra went back to the bathroom.']
2025-01-22 06:16:56.351 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['\U0001faf1🏿\u200d\U0001faf2🏾', '🦷', '🧜🏽', '🇮🇴', '👩🏼\u200d🦽\u200d➡️', '👩🏽\u200d🦲', '🛀🏻', '🌷', '🦸🏻\u200d♂', '🤦\u200d♀️']
emoji:
O: 🫱🏿‍🫲🏾 [9468, 104, 109, 9468, 237, 123, 102470, 9468, 104, 110, 9468, 237, 122]
N: 👩🏽‍🦲 [9468, 239, 102, 9468, 237, 121, 102470, 9468, 99, 110]

O: 🦷 [9468, 99, 115]
N: 🇮🇴 [9468, 229, 106, 9468, 114783]

O: 🧜🏽 [9468, 100, 250, 9468, 237, 121]
N: 🛀🏻 [9468, 249, 222, 9468, 237, 119]

O: 🇮🇴 [9468, 229, 106, 9468, 114783]
N: 🧜🏽 [9468, 100, 250, 9468, 237, 121]

O: 👩🏼‍🦽‍➡️ [9468, 239, 102, 9468, 237, 120, 102470, 9468, 99, 121, 102470, 98115, 94, 31643]
N: 🦷 [9468, 99, 115]

O: 👩🏽‍🦲 [9468, 239, 102, 9468, 237, 121, 102470, 9468, 99, 110]
N: 🌷 [9468, 234, 115]

O: 🛀🏻 [9468, 249, 222, 9468, 237, 119]
N: 🦸🏻‍♂ [9468, 99, 116, 9468, 237, 119, 102470, 17245, 224]

O: 🌷 [9468, 234, 115]
N: 👩🏼‍🦽‍➡️ [9468, 239, 102, 9468, 237, 120, 102470, 9468, 99, 121, 102470, 98115, 94, 31643]

O: 🦸🏻‍♂ [9468, 99, 116, 9468, 237, 119, 102470, 17245, 224]
N: 🫱🏿‍🫲🏾 [9468, 104, 109, 9468, 237, 123, 102470, 9468, 104, 110, 9468, 237, 122]

O: 🤦‍♀️ [9468, 97, 99, 102470, 32990, 31643]
N: 🤦‍♀️ [9468, 97, 99, 102470, 32990, 31643]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.59s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.97s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.92s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.40s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.94s/it]
Processing depth (0, 1, 3, 5):   0%|          | 0/100 [00:17<?, ?it/s]2025-01-22 06:17:13.838 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went to the bathroom.
2025-01-22 06:17:13.839 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  went to the bathroom.
2025-01-22 06:17:13.839 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the hallway.
2025-01-22 06:17:13.843 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (860, 865) --> . Daniel went to the
2025-01-22 06:17:13.843 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel left the milk.
2025-01-22 06:17:13.859 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2969, 2973) -->  Daniel left the milk
2025-01-22 06:17:13.859 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the bathroom.
2025-01-22 06:17:13.882 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4250, 4256) -->  Sandra went back to the bathroom
2025-01-22 06:17:13.882 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the kitchen.
2025-01-22 06:17:13.884 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (303, 309) --> . Mary journeyed to the
2025-01-22 06:17:13.884 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bedroom.
2025-01-22 06:17:13.911 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5020, 5026) --> . John journeyed to the
2025-01-22 06:17:13.911 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the hallway.
2025-01-22 06:17:13.936 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5020, 5026) --> . John journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:17:14.727 | INFO     | test_jbb_embedding:begin_test:693 - the bathroom<|eot_id|>
2025-01-22 06:17:14.728 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8212])
2025-01-22 06:17:16.967 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [341.2625, 23.096880706025562, 172.19444444444446, 21.99047633606457, 20.55517053091398], 'topk_indices': array([2941, 3020,   35,   31,   24, 8196,   29, 8197, 2968,   14, 2940,
       2973, 8200, 2972, 8199,   34, 2975, 8207,    0, 8208]), 'topk_tokens': [' During', 'lyn', '.', ' went', '\n\n', ' Where', '\n\n', ' was', '.', '\n', '.', '.', ' before', ' milk', ' milk', ' bathroom', 'ible', '<|eot_id|>', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [515.25, 213.575, 482.1875, 208.72916666666666]}, 'weight': {'score': [23.30859375, 23.304089318320145, 19.62673611111111, 23.312173245077656, 29.096942204301076], 'topk_indices': array([3307, 3334, 3227, 3179, 7419, 7457, 1518, 1456, 4361, 4345, 5224,
       5163, 7140, 7196, 3516, 3490, 4981, 4933, 5010, 4958]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.465625, 19.665625, 26.462890625, 26.610677083333332]}, 'saliency': {'score': [2.134619140625, 0.12962217789485697, 0.8502061631944444, 0.12313196742769353, 0.1500608382686492], 'topk_indices': array([2969,   39, 8197, 2967,   30, 8194,   38,  305, 2941,   31, 4255,
       8196, 3020,  865, 8202, 8200, 2972, 8199, 2975,   34]), 'topk_tokens': [' Daniel', '\n\n\n', ' was', ' Gov', 'Daniel', 'Question', '***', ' journey', ' During', ' went', ' bathroom', ' Where', 'lyn', ' hallway', ' hallway', ' before', ' milk', ' milk', 'ible', ' bathroom'], 'evidence_proportions': [3.044140625, 1.07822265625, 3.22509765625, 1.530029296875]}}, 'pred_res': 'the bathroom<|eot_id|>', 'score': 100}
2025-01-22 06:17:16.978 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:17:16.978 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-88_pid-0_0-1-3-5.pkl | len: 3 |  size: 1.99 KB
Processing depth (0, 1, 3, 5):   1%|          | 1/100 [00:20<33:53, 20.54s/it]is_0k: False
your chose emoji: ['🧚', '🧑🏿\u200d🚀', '🇸🇮', '👨🏿\u200d🦯\u200d➡️', '👨🏻\u200d🤝\u200d👨🏾', '👩🏻\u200d❤️\u200d💋\u200d👨🏽', '\U0001faf2🏽', '🏄🏼\u200d♂', '🔆', '👧🏻']
emoji:
O: 🧚 [9468, 100, 248]
N: 👩🏻‍❤️‍💋‍👨🏽 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 121]

O: 🧑🏿‍🚀 [9468, 100, 239, 9468, 237, 123, 102470, 9468, 248, 222]
N: 🧑🏿‍🚀 [9468, 100, 239, 9468, 237, 123, 102470, 9468, 248, 222]

O: 🇸🇮 [9468, 229, 116, 9468, 229, 106]
N: 👨🏿‍🦯‍➡️ [9468, 239, 101, 9468, 237, 123, 102470, 9468, 99, 107, 102470, 98115, 94, 31643]

O: 👨🏿‍🦯‍➡️ [9468, 239, 101, 9468, 237, 123, 102470, 9468, 99, 107, 102470, 98115, 94, 31643]
N: 🧚 [9468, 100, 248]

O: 👨🏻‍🤝‍👨🏾 [9468, 239, 101, 9468, 237, 119, 102470, 9468, 97, 251, 102470, 9468, 239, 101, 9468, 237, 122]
N: 🏄🏼‍♂ [9468, 237, 226, 9468, 237, 120, 102470, 17245, 224]

O: 👩🏻‍❤️‍💋‍👨🏽 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 121]
N: 🇸🇮 [9468, 229, 116, 9468, 229, 106]

O: 🫲🏽 [9468, 104, 110, 9468, 237, 121]
N: 🫲🏽 [9468, 104, 110, 9468, 237, 121]

O: 🏄🏼‍♂ [9468, 237, 226, 9468, 237, 120, 102470, 17245, 224]
N: 🔆 [9468, 242, 228]

O: 🔆 [9468, 242, 228]
N: 👨🏻‍🤝‍👨🏾 [9468, 239, 101, 9468, 237, 119, 102470, 9468, 97, 251, 102470, 9468, 239, 101, 9468, 237, 122]

O: 👧🏻 [9468, 239, 100, 9468, 237, 119]
N: 👧🏻 [9468, 239, 100, 9468, 237, 119]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:11,  3.79s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:09,  4.50s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.43s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.87s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.40s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (1, 4, 7, 9):   1%|          | 1/100 [00:35<33:53, 20.54s/it]2025-01-22 06:17:32.310 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went to the bathroom.
2025-01-22 06:17:32.314 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (902, 907) --> . Daniel went to the
2025-01-22 06:17:32.314 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the hallway.
2025-01-22 06:17:32.319 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (902, 907) --> . Daniel went to the
2025-01-22 06:17:32.319 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel left the milk.
2025-01-22 06:17:32.346 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5656, 5660) -->  Daniel left the milk
2025-01-22 06:17:32.346 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the bathroom.
2025-01-22 06:17:32.382 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7229, 7235) --> . Sandra went back to the
2025-01-22 06:17:32.382 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the kitchen.
2025-01-22 06:17:32.384 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (297, 303) --> . Mary journeyed to the
2025-01-22 06:17:32.384 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bedroom.
2025-01-22 06:17:32.409 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4988, 4994) --> . John journeyed to the
2025-01-22 06:17:32.409 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the hallway.
2025-01-22 06:17:32.434 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4988, 4994) --> . John journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:17:37.374 | INFO     | test_jbb_embedding:begin_test:693 - Daniel left the milk.<|eot_id|>
2025-01-22 06:17:37.374 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8194])
2025-01-22 06:17:40.307 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [176.24375, 14.603375282115408, 140.11458333333334, 13.930252443620542, 11.88920665922619], 'topk_indices': array([8092, 8167, 8181,  299,    3, 8188, 8082,    4,  300,   23, 5659,
          9, 7919,  907,    1,   24,   14, 8192, 8189,    0]), 'topk_tokens': [' location', '.', ' milk', ' journey', '<|end_header_id|>', ':', '.\n\n', '\n\n', 'ed', '4', ' milk', ':', ' Square', ' bathroom', '<|start_header_id|>', '\n\n', '\n', '<|end_header_id|>', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [204.0875, 204.0875, 275.6875, 63.541666666666664]}, 'weight': {'score': [21.686328125, 23.303838294497986, 19.62673611111111, 23.31591551507538, 29.715401785714285], 'topk_indices': array([3307, 3280, 3152, 3200, 7409, 7447, 1430, 1492, 4313, 4329, 5192,
       5131, 7123, 7179, 3463, 3489, 4978, 4901, 4949, 4926]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.665625, 19.665625, 26.462890625, 21.869791666666668]}, 'saliency': {'score': [1.0384033203125, 0.08168428706529447, 0.7337646484375, 0.07790051121413087, 0.08909270876929873], 'topk_indices': array([8187,  298,   23, 8163, 4994,   20, 8092,  903,    8, 1741,    0,
       5656, 8181, 3611,  299, 8184,   24, 5659, 7919,  907]), 'topk_tokens': ['Answer', ' Mary', '4', ' return', ' hallway', ' Jul', ' location', ' Daniel', ' Date', '��', '<|begin_of_text|>', ' Daniel', ' milk', ' hallway', ' journey', ' hallway', '\n\n', ' milk', ' Square', ' bathroom'], 'evidence_proportions': [1.087255859375, 1.087255859375, 1.914306640625, 0.373046875]}}, 'pred_res': 'Daniel left the milk.<|eot_id|>', 'score': 0}
2025-01-22 06:17:40.313 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:17:40.313 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-88_pid-1_1-4-7-9.pkl | len: 3 |  size: 2.04 KB
Processing depth (1, 4, 7, 9):   2%|▏         | 2/100 [00:43<36:14, 22.18s/it]is_0k: False
your chose emoji: ['🌅', '🏃🏾\u200d➡', '🧑🏿\u200d🍼', '⏺', '🖊️', '🧟\u200d♀', '🧑🏼\u200d🔬', '🤶🏾', '👩🏽\u200d❤️\u200d💋\u200d👩🏿', '👨🏻\u200d❤️\u200d👨🏽']
emoji:
O: 🌅 [9468, 234, 227]
N: 🏃🏾‍➡ [9468, 237, 225, 9468, 237, 122, 102470, 98115, 94]

O: 🏃🏾‍➡ [9468, 237, 225, 9468, 237, 122, 102470, 98115, 94]
N: 🧑🏿‍🍼 [9468, 100, 239, 9468, 237, 123, 102470, 9468, 104247]

O: 🧑🏿‍🍼 [9468, 100, 239, 9468, 237, 123, 102470, 9468, 104247]
N: ⏺ [158, 237, 118]

O: ⏺ [158, 237, 118]
N: 🧟‍♀ [9468, 100, 253, 102470, 32990]

O: 🖊️ [9468, 244, 232, 31643]
N: 👩🏽‍❤️‍💋‍👩🏿 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 123]

O: 🧟‍♀ [9468, 100, 253, 102470, 32990]
N: 🖊️ [9468, 244, 232, 31643]

O: 🧑🏼‍🔬 [9468, 100, 239, 9468, 237, 120, 102470, 9468, 242, 105]
N: 🌅 [9468, 234, 227]

O: 🤶🏾 [9468, 97, 114, 9468, 237, 122]
N: 🧑🏼‍🔬 [9468, 100, 239, 9468, 237, 120, 102470, 9468, 242, 105]

O: 👩🏽‍❤️‍💋‍👩🏿 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 123]
N: 🤶🏾 [9468, 97, 114, 9468, 237, 122]

O: 👨🏻‍❤️‍👨🏽 [9468, 239, 101, 9468, 237, 119, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 121]
N: 👨🏻‍❤️‍👨🏽 [9468, 239, 101, 9468, 237, 119, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 121]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.30s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.31s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.36s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.04s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.51s/it]
Processing depth (3, 5, 8, 9):   2%|▏         | 2/100 [00:59<36:14, 22.18s/it]2025-01-22 06:17:56.246 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went to the bathroom.
2025-01-22 06:17:56.263 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2924, 2929) --> . Daniel went to the
2025-01-22 06:17:56.263 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the hallway.
2025-01-22 06:17:56.278 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2924, 2929) --> . Daniel went to the
2025-01-22 06:17:56.278 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel left the milk.
2025-01-22 06:17:56.310 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6604, 6608) -->  Daniel left the milk
2025-01-22 06:17:56.310 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the bathroom.
2025-01-22 06:17:56.350 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7213, 7219) --> . Sandra went back to the
2025-01-22 06:17:56.351 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the kitchen.
2025-01-22 06:17:56.352 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (297, 303) --> . Mary journeyed to the
2025-01-22 06:17:56.352 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bedroom.
2025-01-22 06:17:56.379 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4922, 4928) --> . John journeyed to the
2025-01-22 06:17:56.379 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the hallway.
2025-01-22 06:17:56.409 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4922, 4928) --> . John journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:17:57.408 | INFO     | test_jbb_embedding:begin_test:693 - the milk was left by Daniel in St.<|eot_id|>
2025-01-22 06:17:57.409 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8182])
2025-01-22 06:17:59.672 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [183.5625, 13.85395349725107, 99.33854166666667, 13.248467610776974, 10.513847155448717], 'topk_indices': array([8164, 8172, 6603, 8169,    4, 6607, 8170, 8080, 6605, 6604,    9,
         23,    1, 7907,    3, 8180,   14,   24, 8177,    0]), 'topk_tokens': ['Question', ' hallway', '.', ' milk', '\n\n', ' milk', ' before', ' location', ' left', ' Daniel', ':', '4', '<|start_header_id|>', ' Square', '<|end_header_id|>', '<|end_header_id|>', '\n', '\n\n', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [139.56875, 139.56875, 359.53125, 139.57291666666666]}, 'weight': {'score': [21.686328125, 23.291314141722662, 19.62673611111111, 23.303350734933105, 29.551482371794872], 'topk_indices': array([3291, 3264, 3136, 3184, 7393, 7431, 1476, 1414, 4305, 4289, 5184,
       5123, 7107, 7163, 3475, 3501, 4977, 4948, 4918, 4893]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.665625, 19.665625, 26.462890625, 21.869791666666668]}, 'saliency': {'score': [1.1474609375, 0.07805234691174787, 0.5325690375434028, 0.07442285479892906, 0.07946278498722957], 'topk_indices': array([8151, 8175,    8, 6602,   20,   23, 7906, 2929, 7219, 8170, 8164,
         24, 8169, 4205, 6605, 8080, 6607, 8172, 6604, 7907]), 'topk_tokens': [' return', 'Answer', ' Date', ' St', ' Jul', '4', 'Bridge', ' bathroom', ' bathroom', ' before', 'Question', '\n\n', ' milk', ' hallway', ' left', ' location', ' milk', ' hallway', ' Daniel', ' Square'], 'evidence_proportions': [0.784423828125, 0.784423828125, 2.51123046875, 0.8433430989583334]}}, 'pred_res': 'the milk was left by Daniel in St.<|eot_id|>', 'score': 0}
2025-01-22 06:17:59.679 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:17:59.680 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-88_pid-2_3-5-8-9.pkl | len: 3 |  size: 2.05 KB
Processing depth (3, 5, 8, 9):   3%|▎         | 3/100 [01:03<33:47, 20.90s/it]is_0k: False
your chose emoji: ['🚶\u200d♂', '🏃🏽\u200d♀', '🐔', '🤙🏿', '🧖🏼\u200d♀', '👳🏼\u200d♂', '🖼️', '👩🏾\u200d🎤', '🦸🏿\u200d♀', '👨🏽\u200d❤️\u200d👨🏻']
emoji:
O: 🚶‍♂ [9468, 248, 114, 102470, 17245, 224]
N: 🖼️ [9468, 244, 120, 31643]

O: 🏃🏽‍♀ [9468, 237, 225, 9468, 237, 121, 102470, 32990]
N: 👳🏼‍♂ [9468, 239, 111, 9468, 237, 120, 102470, 17245, 224]

O: 🐔 [9468, 238, 242]
N: 🏃🏽‍♀ [9468, 237, 225, 9468, 237, 121, 102470, 32990]

O: 🤙🏿 [9468, 97, 247, 9468, 237, 123]
N: 🤙🏿 [9468, 97, 247, 9468, 237, 123]

O: 🧖🏼‍♀ [9468, 100, 244, 9468, 237, 120, 102470, 32990]
N: 🚶‍♂ [9468, 248, 114, 102470, 17245, 224]

O: 👳🏼‍♂ [9468, 239, 111, 9468, 237, 120, 102470, 17245, 224]
N: 🦸🏿‍♀ [9468, 99, 116, 9468, 237, 123, 102470, 32990]

O: 🖼️ [9468, 244, 120, 31643]
N: 👩🏾‍🎤 [9468, 239, 102, 9468, 237, 122, 102470, 9468, 236, 97]

O: 👩🏾‍🎤 [9468, 239, 102, 9468, 237, 122, 102470, 9468, 236, 97]
N: 🐔 [9468, 238, 242]

O: 🦸🏿‍♀ [9468, 99, 116, 9468, 237, 123, 102470, 32990]
N: 🧖🏼‍♀ [9468, 100, 244, 9468, 237, 120, 102470, 32990]

O: 👨🏽‍❤️‍👨🏻 [9468, 239, 101, 9468, 237, 121, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 119]
N: 👨🏽‍❤️‍👨🏻 [9468, 239, 101, 9468, 237, 121, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 119]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.94s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.59s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.44s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.08s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.64s/it]
Processing depth (0, 1, 3, 9):   3%|▎         | 3/100 [01:19<33:47, 20.90s/it]2025-01-22 06:18:16.393 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went to the bathroom.
2025-01-22 06:18:16.393 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  went to the bathroom.
2025-01-22 06:18:16.393 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the hallway.
2025-01-22 06:18:16.397 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (838, 843) --> . Daniel went to the
2025-01-22 06:18:16.398 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel left the milk.
2025-01-22 06:18:16.412 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2881, 2885) -->  Daniel left the milk
2025-01-22 06:18:16.412 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the bathroom.
2025-01-22 06:18:16.448 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7200, 7206) -->  Sandra went back to the bathroom
2025-01-22 06:18:16.448 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the kitchen.
2025-01-22 06:18:16.450 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (303, 309) --> . Mary journeyed to the
2025-01-22 06:18:16.450 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bedroom.
2025-01-22 06:18:16.474 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4863, 4869) -->  the senate. John journeyed
2025-01-22 06:18:16.474 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the hallway.
2025-01-22 06:18:16.499 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4863, 4869) -->  the senate. John journeyed
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:18:17.300 | INFO     | test_jbb_embedding:begin_test:693 - The bathroom.<|eot_id|>
2025-01-22 06:18:17.300 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8238])
2025-01-22 06:18:19.537 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [133.390625, 10.69974821016867, 97.05078125, 10.211129883883945, 6.583860001474057], 'topk_indices': array([ 843, 2392, 8229,   25,    9, 8225, 2406, 2407,   28, 8126,   24,
       8228,    1, 8236, 8226,   34,   14, 8234,    0, 8233]), 'topk_tokens': [' hallway', 'nes', '?', '<|eot_id|>', ':', ' milk', 'nes', 'ot', '<|end_header_id|>', '.\n\n', '\n\n', ' hallway', '<|start_header_id|>', '<|end_header_id|>', ' before', ' bathroom', '\n', '<|start_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [275.025, 105.7125, 121.78125, 46.166666666666664]}, 'weight': {'score': [23.30859375, 23.34861515592768, 22.25347222222222, 23.35111582652688, 30.11733490566038], 'topk_indices': array([3364, 3337, 3209, 3257, 7529, 7491, 1496, 1434, 4344, 4328, 5214,
       5275, 7268, 7212, 3520, 3546, 5039, 5016, 4991, 5068]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.465625, 19.665625, 26.462890625, 26.610677083333332]}, 'saliency': {'score': [0.8139617919921875, 0.05951633552891033, 0.5032857259114584, 0.05670312595239547, 0.04868097125359301], 'topk_indices': array([  31, 8136,  354,   14, 8229, 8126,    8,   24, 2407, 8092, 8222,
       8220, 2392, 2406,  305, 8225,  843, 8226, 8228,   34]), 'topk_tokens': [' went', ' location', ' century', '\n', '?', '.\n\n', ' Date', '\n\n', 'ot', ' context', ' Where', 'Question', 'nes', 'nes', ' journey', ' milk', ' hallway', ' before', ' hallway', ' bathroom'], 'evidence_proportions': [1.680029296875, 0.5198974609375, 0.80462646484375, 0.3435160319010417]}}, 'pred_res': 'The bathroom.<|eot_id|>', 'score': 100}
2025-01-22 06:18:19.545 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:18:19.545 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-88_pid-3_0-1-3-9.pkl | len: 3 |  size: 2.03 KB
Processing depth (0, 1, 3, 9):   4%|▍         | 4/100 [01:23<32:47, 20.49s/it]is_0k: False
your chose emoji: ['🏊\u200d♂', '🤽🏿\u200d♂', '🧑🏽\u200d❤️\u200d💋\u200d🧑🏻', '👨🏽\u200d🦼\u200d➡️', '👨🏾\u200d🦼\u200d➡️', '🏋️\u200d♀', '🤵🏽\u200d♀', '👩🏽\u200d❤\u200d💋\u200d👨🏽', '🏄🏻\u200d♀️', '👥']
emoji:
O: 🏊‍♂ [9468, 237, 232, 102470, 17245, 224]
N: 🤵🏽‍♀ [9468, 97, 113, 9468, 237, 121, 102470, 32990]

O: 🤽🏿‍♂ [9468, 97, 121, 9468, 237, 123, 102470, 17245, 224]
N: 👩🏽‍❤‍💋‍👨🏽 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 121]

O: 🧑🏽‍❤️‍💋‍🧑🏻 [9468, 100, 239, 9468, 237, 121, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 100, 239, 9468, 237, 119]
N: 🏄🏻‍♀️ [9468, 237, 226, 9468, 237, 119, 102470, 32990, 31643]

O: 👨🏽‍🦼‍➡️ [9468, 239, 101, 9468, 237, 121, 102470, 9468, 99, 120, 102470, 98115, 94, 31643]
N: 🤽🏿‍♂ [9468, 97, 121, 9468, 237, 123, 102470, 17245, 224]

O: 👨🏾‍🦼‍➡️ [9468, 239, 101, 9468, 237, 122, 102470, 9468, 99, 120, 102470, 98115, 94, 31643]
N: 🏊‍♂ [9468, 237, 232, 102470, 17245, 224]

O: 🏋️‍♀ [9468, 237, 233, 31643, 102470, 32990]
N: 👨🏾‍🦼‍➡️ [9468, 239, 101, 9468, 237, 122, 102470, 9468, 99, 120, 102470, 98115, 94, 31643]

O: 🤵🏽‍♀ [9468, 97, 113, 9468, 237, 121, 102470, 32990]
N: 🏋️‍♀ [9468, 237, 233, 31643, 102470, 32990]

O: 👩🏽‍❤‍💋‍👨🏽 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 121]
N: 👨🏽‍🦼‍➡️ [9468, 239, 101, 9468, 237, 121, 102470, 9468, 99, 120, 102470, 98115, 94, 31643]

O: 🏄🏻‍♀️ [9468, 237, 226, 9468, 237, 119, 102470, 32990, 31643]
N: 🧑🏽‍❤️‍💋‍🧑🏻 [9468, 100, 239, 9468, 237, 121, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 100, 239, 9468, 237, 119]

O: 👥 [9468, 239, 98]
N: 👥 [9468, 239, 98]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.34s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.96s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.69s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.01s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.64s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 4, 6, 7):   4%|▍         | 4/100 [01:39<32:47, 20.49s/it]2025-01-22 06:18:35.850 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went to the bathroom.
2025-01-22 06:18:35.850 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  went to the bathroom.
2025-01-22 06:18:35.850 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the hallway.
2025-01-22 06:18:35.869 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3628, 3633) --> . Daniel went to the
2025-01-22 06:18:35.869 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel left the milk.
2025-01-22 06:18:35.892 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4747, 4751) -->  Daniel left the milk
2025-01-22 06:18:35.892 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the bathroom.
2025-01-22 06:18:35.922 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5505, 5511) -->  Sandra went back to the bathroom
2025-01-22 06:18:35.922 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the kitchen.
2025-01-22 06:18:35.923 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (285, 291) --> . Mary journeyed to the
2025-01-22 06:18:35.923 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John journeyed to the bedroom.
2025-01-22 06:18:35.949 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4841, 4847) -->  journeyed to the hallway.
2025-01-22 06:18:35.949 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the hallway.
2025-01-22 06:18:35.977 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4840, 4846) -->  John journeyed to the hallway
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:18:38.673 | INFO     | test_jbb_embedding:begin_test:693 - the kitchen<|eot_id|>
2025-01-22 06:18:38.673 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8200])
2025-01-22 06:18:41.450 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [309.24375, 25.84862245519932, 177.71527777777777, 24.819657072872015, 53.84545617816092], 'topk_indices': array([6861,   31,   34, 8186, 8111,    1, 8184, 8088,   24, 4751, 8185,
       8098, 4750, 8187,   14, 8188, 3633, 8195,    0, 8196]), 'topk_tokens': [' bedroom', ' went', ' bathroom', ' the', ' the', '<|start_header_id|>', ' Where', '.\n\n', '\n\n', '.', ' was', ' location', ' milk', ' milk', '\n', ' before', ' hallway', '<|eot_id|>', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [355.125, 294.9, 429.375, 202.875]}, 'weight': {'score': [23.30859375, 23.30988281726198, 21.940538194444443, 23.31290473821188, 29.769576149425287], 'topk_indices': array([3312, 3339, 3232, 3184, 7447, 7485, 1502, 1440, 4313, 4329, 5249,
       5188, 7168, 7224, 3521, 3495, 4965, 4990, 5013, 5042]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.465625, 19.665625, 26.462890625, 26.610677083333332]}, 'saliency': {'score': [1.89677734375, 0.1460676871028511, 0.9963514539930556, 0.13990488233408604, 0.4075527848868534], 'topk_indices': array([8054, 4748, 8088, 8097, 8185, 4773, 8182,   31, 4772, 5510, 4782,
       8184, 6861, 8190,   34, 8098, 4750, 8188, 8187, 3633]), 'topk_tokens': [' context', ' left', '.\n\n', ' first', ' was', '�', 'Question', ' went', '\u200d', ' bathroom', 'super', ' Where', ' bedroom', ' hallway', ' bathroom', ' location', ' milk', ' before', ' milk', ' hallway'], 'evidence_proportions': [2.0484375, 1.43662109375, 2.901123046875, 1.4842936197916667]}}, 'pred_res': 'the kitchen<|eot_id|>', 'score': 0}
2025-01-22 06:18:41.456 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:18:41.456 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-88_pid-4_0-4-6-7.pkl | len: 3 |  size: 2.03 KB
Processing depth (0, 4, 6, 7):   5%|▌         | 5/100 [01:45<33:15, 21.00s/it]Processing depth (0, 4, 6, 7):   5%|▌         | 5/100 [01:45<33:17, 21.02s/it]
2025-01-22 06:18:41.550 | INFO     | __main__:<module>:82 - Selected idx: 89
2025-01-22 06:18:41.550 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the location prior to the place where the football was discarded, left or dropped?
2025-01-22 06:18:41.550 | INFO     | __main__:<module>:84 - Answer: bathroom
2025-01-22 06:18:41.550 | INFO     | __main__:<module>:85 - Tag: 4-hop
2025-01-22 06:18:41.550 | INFO     | __main__:<module>:86 - Needle: [' Daniel went to the bathroom.', ' Daniel got the football.', ' John journeyed to the bedroom.', ' Daniel went to the hallway.', ' Mary journeyed to the kitchen.', ' John journeyed to the hallway.', ' Daniel left the football.', ' Sandra went back to the bathroom.']
2025-01-22 06:18:41.550 | INFO     | __main__:<module>:87 - Real Needle: [' Daniel went to the bathroom.', ' Daniel got the football.', ' Daniel went to the hallway.', ' Daniel left the football.', ' Sandra went back to the bathroom.']
2025-01-22 06:18:41.550 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['👰🏼\u200d♀️', '🧑🏻\u200d🦽\u200d➡️', '🧛🏾\u200d♀', '🦸🏾\u200d♂️', '👩🏽\u200d🦼', '✂', '👩🏼\u200d🦽\u200d➡️', '👩\u200d👧\u200d👦', '🎚', '🚣\u200d♀️']
emoji:
O: 👰🏼‍♀️ [9468, 239, 108, 9468, 237, 120, 102470, 32990, 31643]
N: 👩🏼‍🦽‍➡️ [9468, 239, 102, 9468, 237, 120, 102470, 9468, 99, 121, 102470, 98115, 94, 31643]

O: 🧑🏻‍🦽‍➡️ [9468, 100, 239, 9468, 237, 119, 102470, 9468, 99, 121, 102470, 98115, 94, 31643]
N: 👩‍👧‍👦 [9468, 239, 102, 102470, 9468, 239, 100, 102470, 9468, 239, 99]

O: 🧛🏾‍♀ [9468, 100, 249, 9468, 237, 122, 102470, 32990]
N: 👰🏼‍♀️ [9468, 239, 108, 9468, 237, 120, 102470, 32990, 31643]

O: 🦸🏾‍♂️ [9468, 99, 116, 9468, 237, 122, 102470, 17245, 224, 31643]
N: 🎚 [9468, 236, 248]

O: 👩🏽‍🦼 [9468, 239, 102, 9468, 237, 121, 102470, 9468, 99, 120]
N: 🧛🏾‍♀ [9468, 100, 249, 9468, 237, 122, 102470, 32990]

O: ✂ [38798, 224]
N: 👩🏽‍🦼 [9468, 239, 102, 9468, 237, 121, 102470, 9468, 99, 120]

O: 👩🏼‍🦽‍➡️ [9468, 239, 102, 9468, 237, 120, 102470, 9468, 99, 121, 102470, 98115, 94, 31643]
N: 🧑🏻‍🦽‍➡️ [9468, 100, 239, 9468, 237, 119, 102470, 9468, 99, 121, 102470, 98115, 94, 31643]

O: 👩‍👧‍👦 [9468, 239, 102, 102470, 9468, 239, 100, 102470, 9468, 239, 99]
N: ✂ [38798, 224]

O: 🎚 [9468, 236, 248]
N: 🦸🏾‍♂️ [9468, 99, 116, 9468, 237, 122, 102470, 17245, 224, 31643]

O: 🚣‍♀️ [9468, 248, 96, 102470, 32990, 31643]
N: 🚣‍♀️ [9468, 248, 96, 102470, 32990, 31643]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.25s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:09,  4.50s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.66s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.23s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.70s/it]
Processing depth (0, 1, 6, 8, 9):   0%|          | 0/100 [00:16<?, ?it/s]2025-01-22 06:18:58.099 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went to the bathroom.
2025-01-22 06:18:58.100 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  went to the bathroom.
2025-01-22 06:18:58.100 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel got the football.
2025-01-22 06:18:58.105 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (797, 801) -->  got the football.
2025-01-22 06:18:58.105 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the hallway.
2025-01-22 06:18:58.130 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4720, 4725) --> . Daniel went to the
2025-01-22 06:18:58.130 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the football.
2025-01-22 06:18:58.162 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6617, 6621) -->  Daniel left the football
2025-01-22 06:18:58.162 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra went back to the bathroom.
2025-01-22 06:18:58.203 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7257, 7263) -->  cold. Sandra went back to
2025-01-22 06:18:58.203 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John journeyed to the bedroom.
2025-01-22 06:18:58.213 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2053, 2059) -->  cable. John journeyed to
2025-01-22 06:18:58.213 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the kitchen.
2025-01-22 06:18:58.251 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6769, 6775) --> . Mary journeyed to the
2025-01-22 06:18:58.251 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the hallway.
2025-01-22 06:18:58.262 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2053, 2059) -->  cable. John journeyed to
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:18:59.041 | INFO     | test_jbb_embedding:begin_test:693 - the hallway<|eot_id|>
2025-01-22 06:18:59.042 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8156])
2025-01-22 06:19:01.257 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [533.6302083333334, 36.65633043265106, 153.09201388888889, 34.928695176789454, 41.977370689655174], 'topk_indices': array([  14, 6619, 8130,  797, 8135,   24, 7532, 8151, 8045, 6618,  798,
         34, 8136, 8143,  799, 8141, 6621, 6620,  800,    0]), 'topk_tokens': ['\n', ' the', ':', ' got', ' prior', '\n\n', '�', '<|eot_id|>', ' location', ' left', ' the', ' bathroom', ' to', ' discarded', ' football', ' football', '.', ' football', '.', '<|begin_of_text|>'], 'evidence_proportions': [556.1, 1132.125, 149.2375, 889.125, 199.23958333333334]}, 'weight': {'score': [22.602213541666668, 23.249346963475915, 22.0859375, 23.253840319699396, 28.858297413793103], 'topk_indices': array([3314, 3287, 3159, 3207, 7418, 7380, 1516, 1454, 4288, 4304, 5124,
       5185, 7150, 7094, 3470, 3496, 4978, 4901, 4949, 4926]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.465625, 20.828125, 19.665625, 26.791015625, 25.220052083333332]}, 'saliency': {'score': [3.1158854166666665, 0.20831830706983853, 0.8582085503472222, 0.19828016058600006, 0.3053215289938039], 'topk_indices': array([  24,   31, 8139, 7526,  800, 6617, 8001, 7532, 8131, 8129,  797,
       7264, 8045, 6618, 8135,   34,  799, 8141, 8143, 6620]), 'topk_tokens': ['\n\n', ' went', ' where', 'nes', '.', ' Daniel', ' context', '�', ' Where', 'Question', ' got', ' bathroom', ' location', ' left', ' prior', ' bathroom', ' football', ' football', ' discarded', ' football'], 'evidence_proportions': [3.2798828125, 5.556640625, 0.822021484375, 6.1181640625, 1.2620849609375]}}, 'pred_res': 'the hallway<|eot_id|>', 'score': 0}
2025-01-22 06:19:01.263 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:19:01.264 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-89_pid-0_0-1-6-8-9.pkl | len: 3 |  size: 2.06 KB
Processing depth (0, 1, 6, 8, 9):   1%|          | 1/100 [00:19<32:22, 19.62s/it]is_0k: False
your chose emoji: ['🚮', '〰️', '🇺🇲', '🪶', '👩🏼\u200d🎤', '🤽🏼\u200d♂', '🇨🇦', '🇱🇦', '🧛🏻\u200d♀', '🗓️']
emoji:
O: 🚮 [9468, 248, 106]
N: 🤽🏼‍♂ [9468, 97, 121, 9468, 237, 120, 102470, 17245, 224]

O: 〰️ [1300, 108, 31643]
N: 👩🏼‍🎤 [9468, 239, 102, 9468, 237, 120, 102470, 9468, 236, 97]

O: 🇺🇲 [9468, 229, 118, 9468, 229, 110]
N: 〰️ [1300, 108, 31643]

O: 🪶 [9468, 103, 114]
N: 🪶 [9468, 103, 114]

O: 👩🏼‍🎤 [9468, 239, 102, 9468, 237, 120, 102470, 9468, 236, 97]
N: 🧛🏻‍♀ [9468, 100, 249, 9468, 237, 119, 102470, 32990]

O: 🤽🏼‍♂ [9468, 97, 121, 9468, 237, 120, 102470, 17245, 224]
N: 🇱🇦 [9468, 229, 109, 9468, 229, 99]

O: 🇨🇦 [9468, 229, 101, 9468, 229, 99]
N: 🇺🇲 [9468, 229, 118, 9468, 229, 110]

O: 🇱🇦 [9468, 229, 109, 9468, 229, 99]
N: 🚮 [9468, 248, 106]

O: 🧛🏻‍♀ [9468, 100, 249, 9468, 237, 119, 102470, 32990]
N: 🇨🇦 [9468, 229, 101, 9468, 229, 99]

O: 🗓️ [9468, 245, 241, 31643]
N: 🗓️ [9468, 245, 241, 31643]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.23s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.55s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.48s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.14s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.62s/it]
Processing depth (1, 3, 4, 5, 8):   1%|          | 1/100 [00:35<32:22, 19.62s/it]2025-01-22 06:19:17.470 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went to the bathroom.
2025-01-22 06:19:17.474 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (822, 827) -->  Daniel went to the bathroom
2025-01-22 06:19:17.474 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel got the football.
2025-01-22 06:19:17.488 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2937, 2941) -->  Daniel got the football
2025-01-22 06:19:17.489 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the hallway.
2025-01-22 06:19:17.493 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (823, 828) -->  went to the bathroom.
2025-01-22 06:19:17.493 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the football.
2025-01-22 06:19:17.517 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4221, 4225) -->  left the football.
2025-01-22 06:19:17.517 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra went back to the bathroom.
2025-01-22 06:19:17.555 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6631, 6637) --> . Sandra went back to the
2025-01-22 06:19:17.555 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John journeyed to the bedroom.
2025-01-22 06:19:17.566 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2133, 2139) --> . John journeyed to the
2025-01-22 06:19:17.566 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the kitchen.
2025-01-22 06:19:17.606 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6710, 6716) --> . Mary journeyed to the
2025-01-22 06:19:17.606 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the hallway.
2025-01-22 06:19:17.618 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2133, 2139) --> . John journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:19:18.407 | INFO     | test_jbb_embedding:begin_test:693 - The hallway.<|eot_id|>
2025-01-22 06:19:18.407 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8180])
2025-01-22 06:19:20.658 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [238.5078125, 21.615164441525113, 138.35069444444446, 20.717650242599188, 26.164369419642856], 'topk_indices': array([ 827, 8172, 3436, 3377, 8025, 8154, 8178, 8153, 2940,   23, 2139,
         14, 8069, 8176,  826,   24, 7922, 3437, 8175,    0]), 'topk_tokens': ['.', '?\n', ' that', ' be', ' context', ':', '<|end_header_id|>', 'Question', ' football', '4', ' hallway', '\n', ' location', '<|start_header_id|>', ' bathroom', '\n\n', ' Square', ' could', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [315.475, 280.71875, 332.175, 217.4375, 82.21875]}, 'weight': {'score': [22.949869791666668, 23.274439004643774, 19.62673611111111, 23.283461030585922, 29.37544642857143], 'topk_indices': array([3275, 3302, 3195, 3147, 7450, 7412, 1437, 1499, 4295, 4311, 5174,
       5113, 7169, 7113, 3458, 3484, 4967, 4938, 4915, 4890]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [25.3546875, 26.939453125, 20.465625, 20.6796875, 21.869791666666668]}, 'saliency': {'score': [1.5495402018229167, 0.12206812707890978, 0.7294633653428819, 0.11651691173895061, 0.19010532924107143], 'topk_indices': array([4223, 8173, 3376, 7921, 3377, 2937,   24,  822,  823, 2135, 8159,
       8025, 8165, 8069, 2940, 8153, 3437, 7922, 2139,  826]), 'topk_tokens': [' football', 'Answer', ' could', 'Bridge', ' be', ' Daniel', '\n\n', ' Daniel', ' went', ' journey', ' prior', ' context', ' football', ' location', ' football', 'Question', ' could', ' Square', ' hallway', ' bathroom'], 'evidence_proportions': [2.30341796875, 2.02008056640625, 1.99072265625, 1.16265869140625, 0.4978841145833333]}}, 'pred_res': 'The hallway.<|eot_id|>', 'score': 0}
2025-01-22 06:19:20.665 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:19:20.665 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-89_pid-1_1-3-4-5-8.pkl | len: 3 |  size: 2.1 KB
Processing depth (1, 3, 4, 5, 8):   2%|▏         | 2/100 [00:39<31:50, 19.49s/it]is_0k: False
your chose emoji: ['👩🏽\u200d🦯\u200d➡', '🏊\u200d♂', '💏', '🚊', '👎🏿', '👩🏾\u200d🎓', '🧑\u200d🦼\u200d➡', '👩🏿\u200d🦰', '💂🏽\u200d♀', '🧆']
emoji:
O: 👩🏽‍🦯‍➡ [9468, 239, 102, 9468, 237, 121, 102470, 9468, 99, 107, 102470, 98115, 94]
N: 👎🏿 [9468, 239, 236, 9468, 237, 123]

O: 🏊‍♂ [9468, 237, 232, 102470, 17245, 224]
N: 👩🏾‍🎓 [9468, 239, 102, 9468, 237, 122, 102470, 9468, 236, 241]

O: 💏 [93273, 237]
N: 👩🏽‍🦯‍➡ [9468, 239, 102, 9468, 237, 121, 102470, 9468, 99, 107, 102470, 98115, 94]

O: 🚊 [9468, 248, 232]
N: 💏 [93273, 237]

O: 👎🏿 [9468, 239, 236, 9468, 237, 123]
N: 🚊 [9468, 248, 232]

O: 👩🏾‍🎓 [9468, 239, 102, 9468, 237, 122, 102470, 9468, 236, 241]
N: 👩🏿‍🦰 [9468, 239, 102, 9468, 237, 123, 102470, 9468, 99, 108]

O: 🧑‍🦼‍➡ [9468, 100, 239, 102470, 9468, 99, 120, 102470, 98115, 94]
N: 💂🏽‍♀ [93273, 224, 9468, 237, 121, 102470, 32990]

O: 👩🏿‍🦰 [9468, 239, 102, 9468, 237, 123, 102470, 9468, 99, 108]
N: 🧑‍🦼‍➡ [9468, 100, 239, 102470, 9468, 99, 120, 102470, 98115, 94]

O: 💂🏽‍♀ [93273, 224, 9468, 237, 121, 102470, 32990]
N: 🏊‍♂ [9468, 237, 232, 102470, 17245, 224]

O: 🧆 [9468, 100, 228]
N: 🧆 [9468, 100, 228]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.16s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.56s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.66s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.22s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.70s/it]
Processing depth (2, 4, 7, 8, 9):   2%|▏         | 2/100 [00:55<31:50, 19.49s/it]2025-01-22 06:19:37.115 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went to the bathroom.
2025-01-22 06:19:37.125 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1855, 1860) --> . Daniel went to the
2025-01-22 06:19:37.125 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel got the football.
2025-01-22 06:19:37.142 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3609, 3613) -->  Daniel got the football
2025-01-22 06:19:37.143 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the hallway.
2025-01-22 06:19:37.153 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1855, 1860) --> . Daniel went to the
2025-01-22 06:19:37.153 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the football.
2025-01-22 06:19:37.185 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6496, 6500) -->  left the football.
2025-01-22 06:19:37.185 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra went back to the bathroom.
2025-01-22 06:19:37.221 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7129, 7135) -->  Sandra went back to the bathroom
2025-01-22 06:19:37.221 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John journeyed to the bedroom.
2025-01-22 06:19:37.232 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2127, 2133) --> . John journeyed to the
2025-01-22 06:19:37.232 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the kitchen.
2025-01-22 06:19:37.267 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6673, 6679) --> . Mary journeyed to the
2025-01-22 06:19:37.267 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the hallway.
2025-01-22 06:19:37.277 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2127, 2133) --> . John journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:19:38.043 | INFO     | test_jbb_embedding:begin_test:693 - the hallway<|eot_id|>
2025-01-22 06:19:38.043 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8182])
2025-01-22 06:19:41.532 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [362.4583333333333, 26.236940668906538, 108.84201388888889, 25.06339225408326, 84.40636003521126], 'topk_indices': array([6474, 6475, 8174,   24,   14, 8176, 3613, 8156, 8155, 8180, 6494,
       6498,   23, 1856, 6495, 1860, 3612,    0, 8177, 8178]), 'topk_tokens': ['.', '�', '?\n', '\n\n', '\n', ':', '.', ':', 'Question', '<|end_header_id|>', '�', ' football', '4', ' Daniel', ' Daniel', ' bathroom', ' football', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [379.225, 506.875, 379.225, 418.3125, 201.0]}, 'weight': {'score': [22.783203125, 23.26293715638363, 19.62673611111111, 23.27238886159892, 28.626540492957748], 'topk_indices': array([3297, 3270, 3190, 3142, 7458, 7420, 1419, 1481, 4280, 4296, 5167,
       5106, 7141, 7197, 3479, 3453, 4908, 4960, 4931, 4883]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.665625, 26.939453125, 19.665625, 20.6796875, 26.610677083333332]}, 'saliency': {'score': [2.2611897786458335, 0.148181965151573, 0.5616251627604166, 0.14104035087172265, 0.6009151834837148], 'topk_indices': array([6494, 8071,   23,   20, 6491, 5643, 6478, 3610, 8175, 8167, 6492,
       7134, 8161, 6475, 6498, 8155, 1856, 6495, 3612, 1860]), 'topk_tokens': ['�', ' location', '4', ' Jul', '\u200d', ' Daniel', '�', ' got', 'Answer', ' football', '�', ' bathroom', ' prior', '�', ' football', 'Question', ' Daniel', ' Daniel', ' football', ' bathroom'], 'evidence_proportions': [2.1916015625, 3.48583984375, 2.1916015625, 2.3890380859375, 1.4755045572916667]}}, 'pred_res': 'the hallway<|eot_id|>', 'score': 0}
2025-01-22 06:19:41.538 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:19:41.538 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-89_pid-2_2-4-7-8-9.pkl | len: 3 |  size: 2.06 KB
Processing depth (2, 4, 7, 8, 9):   3%|▎         | 3/100 [00:59<32:31, 20.12s/it]is_0k: False
your chose emoji: ['🛢️', '🧑🏻\u200d🦰', '🕥', '👎🏼', '🇩🇲', '\U0001face', '🧑🏻\u200d⚕', '👩🏾\u200d🦯\u200d➡', '👩🏿\u200d⚕', '🤴🏽']
emoji:
O: 🛢️ [9468, 249, 95, 31643]
N: 🧑🏻‍⚕ [9468, 100, 239, 9468, 237, 119, 102470, 158, 248, 243]

O: 🧑🏻‍🦰 [9468, 100, 239, 9468, 237, 119, 102470, 9468, 99, 108]
N: 🕥 [9468, 243, 98]

O: 🕥 [9468, 243, 98]
N: 🫎 [9468, 104, 236]

O: 👎🏼 [9468, 239, 236, 9468, 237, 120]
N: 👩🏾‍🦯‍➡ [9468, 239, 102, 9468, 237, 122, 102470, 9468, 99, 107, 102470, 98115, 94]

O: 🇩🇲 [9468, 229, 102, 9468, 229, 110]
N: 🛢️ [9468, 249, 95, 31643]

O: 🫎 [9468, 104, 236]
N: 🧑🏻‍🦰 [9468, 100, 239, 9468, 237, 119, 102470, 9468, 99, 108]

O: 🧑🏻‍⚕ [9468, 100, 239, 9468, 237, 119, 102470, 158, 248, 243]
N: 👎🏼 [9468, 239, 236, 9468, 237, 120]

O: 👩🏾‍🦯‍➡ [9468, 239, 102, 9468, 237, 122, 102470, 9468, 99, 107, 102470, 98115, 94]
N: 🇩🇲 [9468, 229, 102, 9468, 229, 110]

O: 👩🏿‍⚕ [9468, 239, 102, 9468, 237, 123, 102470, 158, 248, 243]
N: 👩🏿‍⚕ [9468, 239, 102, 9468, 237, 123, 102470, 158, 248, 243]

O: 🤴🏽 [9468, 97, 112, 9468, 237, 121]
N: 🤴🏽 [9468, 97, 112, 9468, 237, 121]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.15s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.57s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.21s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.71s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.30s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 3, 4, 5, 9):   3%|▎         | 3/100 [01:14<32:31, 20.12s/it]2025-01-22 06:19:56.627 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went to the bathroom.
2025-01-22 06:19:56.627 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  went to the bathroom.
2025-01-22 06:19:56.627 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel got the football.
2025-01-22 06:19:56.644 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2915, 2919) -->  Daniel got the football
2025-01-22 06:19:56.645 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the hallway.
2025-01-22 06:19:56.664 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3646, 3651) -->  Hon. Daniel went to
2025-01-22 06:19:56.664 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the football.
2025-01-22 06:19:56.684 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4166, 4170) -->  Daniel left the football
2025-01-22 06:19:56.684 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra went back to the bathroom.
2025-01-22 06:19:56.723 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7269, 7275) -->  cold. Sandra went back to
2025-01-22 06:19:56.723 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John journeyed to the bedroom.
2025-01-22 06:19:56.734 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2131, 2137) --> . John journeyed to the
2025-01-22 06:19:56.734 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the kitchen.
2025-01-22 06:19:56.772 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6703, 6709) --> . Mary journeyed to the
2025-01-22 06:19:56.772 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the hallway.
2025-01-22 06:19:56.784 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2131, 2137) --> . John journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:20:00.080 | INFO     | test_jbb_embedding:begin_test:693 - The hallway.<|eot_id|>
2025-01-22 06:20:00.081 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8198])
2025-01-22 06:20:03.186 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [207.92252604166666, 18.681006889403733, 110.15625, 17.922537611839687, 11.672023338607595], 'topk_indices': array([7276, 2918, 8178, 8196, 8190,   34, 8183, 3652, 7916, 8171, 8172,
       8077, 7537, 7493, 7538,   24,   14, 8193,    0, 8194]), 'topk_tokens': [' bathroom', ' football', ' to', '<|end_header_id|>', '?\n', ' bathroom', ' football', ' hallway', ' Square', 'Question', ':', '.\n\n', ' Min', 'nes', 'nes', '\n\n', '\n', '<|eot_id|>', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [281.8, 223.46875, 188.425, 233.578125, 135.13802083333334]}, 'weight': {'score': [24.622395833333332, 23.295335553591027, 19.62673611111111, 23.299525447358747, 29.754351265822784], 'topk_indices': array([3309, 3336, 3229, 3181, 7392, 7430, 1497, 1435, 4323, 4307, 5214,
       5153, 7106, 7162, 3492, 3518, 4978, 4935, 4910, 5007]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.465625, 26.939453125, 24.4734375, 26.791015625, 25.220052083333332]}, 'saliency': {'score': [1.2855936686197917, 0.10512905634840644, 0.5355088975694444, 0.10070719241453073, 0.08698475511768196], 'topk_indices': array([8087, 8043, 8077, 8177, 8185, 4169,   24, 8191, 4508, 2918, 2137,
       7276, 7916, 8183, 7493, 7537,   34, 7538, 8171, 3652]), 'topk_tokens': [' location', ' context', '.\n\n', ' prior', ' discarded', ' football', '\n\n', 'Answer', ' bedroom', ' football', ' hallway', ' bathroom', ' Square', ' football', 'nes', ' Min', ' bathroom', 'nes', 'Question', ' hallway'], 'evidence_proportions': [1.63017578125, 1.5155029296875, 1.05693359375, 1.539794921875, 0.8662516276041666]}}, 'pred_res': 'The hallway.<|eot_id|>', 'score': 0}
2025-01-22 06:20:03.226 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:20:03.226 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-89_pid-3_0-3-4-5-9.pkl | len: 3 |  size: 2.1 KB
Processing depth (0, 3, 4, 5, 9):   4%|▍         | 4/100 [01:21<33:11, 20.74s/it]is_0k: False
your chose emoji: ['🚶🏽\u200d♀\u200d➡️', '👩🏿\u200d⚖', '🍤', '🗄', '🧑🏾\u200d❤\u200d💋\u200d🧑🏿', '😧', '👩\u200d🦽\u200d➡', '💂\u200d♀', '💏', '🧑🏾\u200d❤\u200d🧑🏼']
emoji:
O: 🚶🏽‍♀‍➡️ [9468, 248, 114, 9468, 237, 121, 102470, 32990, 102470, 98115, 94, 31643]
N: 🗄 [9468, 245, 226]

O: 👩🏿‍⚖ [9468, 239, 102, 9468, 237, 123, 102470, 158, 248, 244]
N: 🚶🏽‍♀‍➡️ [9468, 248, 114, 9468, 237, 121, 102470, 32990, 102470, 98115, 94, 31643]

O: 🍤 [9468, 235, 97]
N: 🧑🏾‍❤‍💋‍🧑🏿 [9468, 100, 239, 9468, 237, 122, 102470, 121643, 102470, 93273, 233, 102470, 9468, 100, 239, 9468, 237, 123]

O: 🗄 [9468, 245, 226]
N: 😧 [76460, 100]

O: 🧑🏾‍❤‍💋‍🧑🏿 [9468, 100, 239, 9468, 237, 122, 102470, 121643, 102470, 93273, 233, 102470, 9468, 100, 239, 9468, 237, 123]
N: 💏 [93273, 237]

O: 😧 [76460, 100]
N: 💂‍♀ [93273, 224, 102470, 32990]

O: 👩‍🦽‍➡ [9468, 239, 102, 102470, 9468, 99, 121, 102470, 98115, 94]
N: 👩‍🦽‍➡ [9468, 239, 102, 102470, 9468, 99, 121, 102470, 98115, 94]

O: 💂‍♀ [93273, 224, 102470, 32990]
N: 🍤 [9468, 235, 97]

O: 💏 [93273, 237]
N: 👩🏿‍⚖ [9468, 239, 102, 9468, 237, 123, 102470, 158, 248, 244]

O: 🧑🏾‍❤‍🧑🏼 [9468, 100, 239, 9468, 237, 122, 102470, 121643, 102470, 9468, 100, 239, 9468, 237, 120]
N: 🧑🏾‍❤‍🧑🏼 [9468, 100, 239, 9468, 237, 122, 102470, 121643, 102470, 9468, 100, 239, 9468, 237, 120]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:05<00:16,  5.33s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.67s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.57s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.16s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.75s/it]
Processing depth (0, 2, 4, 8, 9):   4%|▍         | 4/100 [01:39<33:11, 20.74s/it]2025-01-22 06:20:20.903 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went to the bathroom.
2025-01-22 06:20:20.904 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  went to the bathroom.
2025-01-22 06:20:20.904 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel got the football.
2025-01-22 06:20:20.912 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1790, 1794) -->  Daniel got the football
2025-01-22 06:20:20.912 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the hallway.
2025-01-22 06:20:20.931 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3638, 3643) -->  Hon. Daniel went to
2025-01-22 06:20:20.931 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel left the football.
2025-01-22 06:20:20.965 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6657, 6661) -->  Daniel left the football
2025-01-22 06:20:20.966 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra went back to the bathroom.
2025-01-22 06:20:21.005 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7380, 7386) --> . Sandra went back to the
2025-01-22 06:20:21.006 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John journeyed to the bedroom.
2025-01-22 06:20:21.020 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2070, 2076) -->  journeyed to the hallway.
2025-01-22 06:20:21.020 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the kitchen.
2025-01-22 06:20:21.054 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6883, 6889) --> . Mary journeyed to the
2025-01-22 06:20:21.054 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John journeyed to the hallway.
2025-01-22 06:20:21.064 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2069, 2075) -->  John journeyed to the hallway
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:20:21.859 | INFO     | test_jbb_embedding:begin_test:693 - the hallway<|eot_id|>
2025-01-22 06:20:21.860 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8214])
2025-01-22 06:20:24.104 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [513.1692708333334, 35.3292297979798, 410.40277777777777, 33.100546636085625, 28.700835129310345], 'topk_indices': array([3639, 1791, 6080, 8201,   24, 3644, 8210, 1792, 8194, 6081, 2074,
       8199, 2075, 6661, 8209,   34, 1793, 6660, 1794,    0]), 'topk_tokens': ['.', ' got', '\n', ' discarded', '\n\n', ' hallway', '<|start_header_id|>', ' the', ' to', 'the', ' hallway', ' football', '.', '.', '<|eot_id|>', ' bathroom', ' football', ' football', '.', '<|begin_of_text|>'], 'evidence_proportions': [652.8, 801.375, 404.45, 707.6875, 165.59375]}, 'weight': {'score': [23.784830729166668, 23.308101725082146, 21.940538194444443, 23.309713302752293, 29.763290229885058], 'topk_indices': array([3328, 3301, 3221, 3173, 7442, 7404, 1411, 1473, 4320, 4304, 5199,
       5138, 7118, 7174, 3510, 3484, 4947, 4899, 4976, 4924]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.465625, 26.939453125, 24.4734375, 26.791015625, 21.869791666666668]}, 'saliency': {'score': [3.184076944986979, 0.1998214805243702, 2.47869873046875, 0.18604265218845567, 0.2152446878367457], 'topk_indices': array([8059, 2070, 7940, 8207, 1790, 8103,   31, 7386, 6658, 8187, 1791,
       8193, 6081, 8201, 8199, 3644, 2074, 1793, 6660,   34]), 'topk_tokens': [' context', ' journey', ' Square', 'Answer', ' Daniel', ' location', ' went', ' bathroom', ' left', 'Question', ' got', ' prior', 'the', ' discarded', ' football', ' hallway', ' hallway', ' football', ' football', ' bathroom'], 'evidence_proportions': [3.8060546875, 5.32177734375, 2.2455078125, 4.771484375, 0.9644978841145834]}}, 'pred_res': 'the hallway<|eot_id|>', 'score': 0}
2025-01-22 06:20:24.112 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:20:24.112 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-89_pid-4_0-2-4-8-9.pkl | len: 3 |  size: 2.09 KB
Processing depth (0, 2, 4, 8, 9):   5%|▌         | 5/100 [01:42<32:55, 20.79s/it]Processing depth (0, 2, 4, 8, 9):   5%|▌         | 5/100 [01:42<32:28, 20.51s/it]
2025-01-22 06:20:24.208 | INFO     | __main__:<module>:82 - Selected idx: 90
2025-01-22 06:20:24.208 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the milk before the garden? 
2025-01-22 06:20:24.208 | INFO     | __main__:<module>:84 - Answer: bathroom
2025-01-22 06:20:24.208 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 06:20:24.208 | INFO     | __main__:<module>:86 - Needle: [' John took the milk there.', ' Daniel journeyed to the bedroom.', ' Mary journeyed to the office.', ' John went back to the bathroom.', ' Sandra went back to the kitchen.', ' John moved to the garden.', ' Daniel moved to the bathroom.']
2025-01-22 06:20:24.208 | INFO     | __main__:<module>:87 - Real Needle: [' John took the milk there.', ' John went back to the bathroom.', ' John moved to the garden.', ' Daniel moved to the bathroom.']
2025-01-22 06:20:24.208 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['🦸🏻\u200d♀️', '🧍\u200d♂️', '👨🏻\u200d⚕️', '👨🏿\u200d❤️\u200d💋\u200d👨🏼', '🦤', '🍋\u200d🟩', '🏔️', '🏋🏾\u200d♀', '🤽🏽\u200d♀', '👨\u200d👨\u200d👧']
emoji:
O: 🦸🏻‍♀️ [9468, 99, 116, 9468, 237, 119, 102470, 32990, 31643]
N: 🦤 [9468, 99, 97]

O: 🧍‍♂️ [9468, 100, 235, 102470, 17245, 224, 31643]
N: 🧍‍♂️ [9468, 100, 235, 102470, 17245, 224, 31643]

O: 👨🏻‍⚕️ [9468, 239, 101, 9468, 237, 119, 102470, 158, 248, 243, 31643]
N: 👨🏿‍❤️‍💋‍👨🏼 [9468, 239, 101, 9468, 237, 123, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 120]

O: 👨🏿‍❤️‍💋‍👨🏼 [9468, 239, 101, 9468, 237, 123, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 120]
N: 🦸🏻‍♀️ [9468, 99, 116, 9468, 237, 119, 102470, 32990, 31643]

O: 🦤 [9468, 99, 97]
N: 🤽🏽‍♀ [9468, 97, 121, 9468, 237, 121, 102470, 32990]

O: 🍋‍🟩 [9468, 235, 233, 102470, 9468, 253, 102]
N: 👨🏻‍⚕️ [9468, 239, 101, 9468, 237, 119, 102470, 158, 248, 243, 31643]

O: 🏔️ [9468, 237, 242, 31643]
N: 🏔️ [9468, 237, 242, 31643]

O: 🏋🏾‍♀ [9468, 237, 233, 9468, 237, 122, 102470, 32990]
N: 🍋‍🟩 [9468, 235, 233, 102470, 9468, 253, 102]

O: 🤽🏽‍♀ [9468, 97, 121, 9468, 237, 121, 102470, 32990]
N: 🏋🏾‍♀ [9468, 237, 233, 9468, 237, 122, 102470, 32990]

O: 👨‍👨‍👧 [9468, 239, 101, 102470, 9468, 239, 101, 102470, 9468, 239, 100]
N: 👨‍👨‍👧 [9468, 239, 101, 102470, 9468, 239, 101, 102470, 9468, 239, 100]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.74s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:10<00:10,  5.16s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.68s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.01s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.69s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 3, 6, 7):   0%|          | 0/100 [00:16<?, ?it/s]2025-01-22 06:20:40.976 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John took the milk there.
2025-01-22 06:20:40.976 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  took the milk there.
2025-01-22 06:20:40.977 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the bathroom.
2025-01-22 06:20:40.992 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2751, 2757) --> . John went back to the
2025-01-22 06:20:40.993 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the garden.
2025-01-22 06:20:41.017 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4735, 4740) --> . John moved to the
2025-01-22 06:20:41.017 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel moved to the bathroom.
2025-01-22 06:20:41.047 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5634, 5639) --> . Daniel moved to the
2025-01-22 06:20:41.047 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel journeyed to the bedroom.
2025-01-22 06:20:41.081 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6226, 6232) --> . Daniel journeyed to the
2025-01-22 06:20:41.081 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the office.
2025-01-22 06:20:41.108 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5131, 5137) --> . Mary journeyed to the
2025-01-22 06:20:41.108 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the kitchen.
2025-01-22 06:20:41.125 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3047, 3053) -->  tragedy. Sandra went back to
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:20:50.867 | INFO     | test_jbb_embedding:begin_test:693 - There is no information about the milk in the text before the garden.<|eot_id|>
2025-01-22 06:20:50.868 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8169])
2025-01-22 06:20:53.687 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [478.01190476190476, 36.93696845937347, 91.43315972222223, 35.677469491577526, 49.08937610035211], 'topk_indices': array([  33,  122,   82,   31, 8067, 8159,   83, 2757, 8023, 8157,   87,
        556, 8164,   34,   84,   85,  123, 8165,   86,    0]), 'topk_tokens': [' milk', ' P', 'ENCES', ' took', ' location', ' garden', ' OF', ' bathroom', ' context', ' before', 'ER', ' instead', '<|eot_id|>', ' there', ' P', 'ION', 'ION', '<|start_header_id|>', 'E', '<|begin_of_text|>'], 'evidence_proportions': [1008.3, 369.5416666666667, 413.75, 142.15]}, 'weight': {'score': [20.037946428571427, 23.27900911649535, 22.34418402777778, 23.289446737058896, 29.608274647887324], 'topk_indices': array([3358, 3331, 3203, 3251, 7452, 7414, 1471, 1533, 4322, 4338, 5166,
       5227, 7185, 7129, 3514, 3540, 4941, 4964, 4916, 4993]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.284375, 20.0703125, 18.88125, 19.909375]}, 'saliency': {'score': [2.5387718563988093, 0.20893463269204296, 0.50909423828125, 0.2022545079412194, 0.3671316227442782], 'topk_indices': array([  83, 4740, 8151,   31,  439,   87, 8067, 8156,   82,   33, 8159,
       8157, 8023,   84,   34, 2757,  556,   86,  123,   85]), 'topk_tokens': [' OF', ' garden', 'Question', ' took', ' instead', 'ER', ' location', ' milk', 'ENCES', ' milk', ' garden', ' before', ' context', ' P', ' there', ' bathroom', ' instead', 'E', 'ION', 'ION'], 'evidence_proportions': [5.7783203125, 1.9134114583333333, 1.8646484375, 0.723779296875]}}, 'pred_res': 'There is no information about the milk in the text before the garden.<|eot_id|>', 'score': 0}
2025-01-22 06:20:53.699 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:20:53.699 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-90_pid-0_0-3-6-7.pkl | len: 3 |  size: 2.06 KB
Processing depth (0, 3, 6, 7):   1%|          | 1/100 [00:29<48:27, 29.37s/it]is_0k: False
your chose emoji: ['🏃🏿\u200d♀\u200d➡️', '⌨', '🥮', '🙋🏻\u200d♂️', '👩🏼\u200d🍳', '🦸🏼\u200d♂', '\U0001fac4🏻', '🙎🏼', '🇦🇸', '👨\u200d🏫']
emoji:
O: 🏃🏿‍♀‍➡️ [9468, 237, 225, 9468, 237, 123, 102470, 32990, 102470, 98115, 94, 31643]
N: 🦸🏼‍♂ [9468, 99, 116, 9468, 237, 120, 102470, 17245, 224]

O: ⌨ [158, 99742]
N: 🏃🏿‍♀‍➡️ [9468, 237, 225, 9468, 237, 123, 102470, 32990, 102470, 98115, 94, 31643]

O: 🥮 [9468, 98, 106]
N: 🇦🇸 [9468, 229, 99, 9468, 229, 116]

O: 🙋🏻‍♂️ [9468, 247, 233, 9468, 237, 119, 102470, 17245, 224, 31643]
N: 🙎🏼 [9468, 247, 236, 9468, 237, 120]

O: 👩🏼‍🍳 [9468, 239, 102, 9468, 237, 120, 102470, 9468, 235, 111]
N: 👩🏼‍🍳 [9468, 239, 102, 9468, 237, 120, 102470, 9468, 235, 111]

O: 🦸🏼‍♂ [9468, 99, 116, 9468, 237, 120, 102470, 17245, 224]
N: 🫄🏻 [9468, 104, 226, 9468, 237, 119]

O: 🫄🏻 [9468, 104, 226, 9468, 237, 119]
N: 🙋🏻‍♂️ [9468, 247, 233, 9468, 237, 119, 102470, 17245, 224, 31643]

O: 🙎🏼 [9468, 247, 236, 9468, 237, 120]
N: ⌨ [158, 99742]

O: 🇦🇸 [9468, 229, 99, 9468, 229, 116]
N: 🥮 [9468, 98, 106]

O: 👨‍🏫 [9468, 239, 101, 102470, 9468, 237, 104]
N: 👨‍🏫 [9468, 239, 101, 102470, 9468, 237, 104]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:05<00:15,  5.04s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:10<00:10,  5.00s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.82s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.38s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.95s/it]
Processing depth (2, 3, 5, 8):   1%|          | 1/100 [00:47<48:27, 29.37s/it]2025-01-22 06:21:12.166 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John took the milk there.
2025-01-22 06:21:12.175 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1789, 1794) --> . John took the milk
2025-01-22 06:21:12.175 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the bathroom.
2025-01-22 06:21:12.190 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2923, 2929) --> . John went back to the
2025-01-22 06:21:12.190 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the garden.
2025-01-22 06:21:12.212 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4137, 4142) --> . John moved to the
2025-01-22 06:21:12.212 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel moved to the bathroom.
2025-01-22 06:21:12.249 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6577, 6582) --> . Daniel moved to the
2025-01-22 06:21:12.249 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel journeyed to the bedroom.
2025-01-22 06:21:12.280 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6164, 6170) --> . Daniel journeyed to the
2025-01-22 06:21:12.280 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the office.
2025-01-22 06:21:12.305 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5075, 5081) --> . Mary journeyed to the
2025-01-22 06:21:12.305 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the kitchen.
2025-01-22 06:21:12.321 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3113, 3119) -->  ranks. Sandra went back to
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:21:13.069 | INFO     | test_jbb_embedding:begin_test:693 - the bathroom<|eot_id|>
2025-01-22 06:21:13.069 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8127])
2025-01-22 06:21:15.285 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [331.2559523809524, 26.884515298277982, 72.95486111111111, 25.992033972932887, 22.78765625], 'topk_indices': array([8114, 8121,    1, 1792, 1790, 7866,    3, 8115,   14, 8025, 1791,
         24,   28, 8125, 2929, 1794, 1793, 8122,    0, 8123]), 'topk_tokens': [' milk', ':', '<|start_header_id|>', ' the', ' John', ' Square', '<|end_header_id|>', ' before', '\n', ' location', ' took', '\n\n', '<|end_header_id|>', '<|end_header_id|>', ' bathroom', ' there', ' milk', '<|eot_id|>', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [723.15, 286.5625, 228.575, 95.675]}, 'weight': {'score': [20.232142857142858, 23.234571033210333, 22.06814236111111, 23.244958711840315, 28.6765625], 'topk_indices': array([3283, 3310, 3155, 3203, 7386, 7348, 1487, 1425, 4296, 4280, 5110,
       5171, 7125, 7069, 3478, 3504, 4880, 4957, 4928, 4905]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.1, 20.0703125, 18.88125, 19.909375]}, 'saliency': {'score': [1.8514927455357142, 0.14854410506995694, 0.4163750542534722, 0.1435283000353402, 0.165303955078125], 'topk_indices': array([  23, 4142,   20, 8111, 8024, 1788,    0, 8109, 8117, 8120,   24,
       1790, 8114, 8115, 7866, 1791, 8025, 1794, 1793, 2929]), 'topk_tokens': ['4', ' garden', ' Jul', ' Where', ' first', ' Mr', '<|begin_of_text|>', 'Question', ' garden', 'Answer', '\n\n', ' John', ' milk', ' before', ' Square', ' took', ' location', ' there', ' milk', ' bathroom'], 'evidence_proportions': [4.436328125, 1.4595540364583333, 1.063232421875, 0.525244140625]}}, 'pred_res': 'the bathroom<|eot_id|>', 'score': 100}
2025-01-22 06:21:15.292 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:21:15.292 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-90_pid-1_2-3-5-8.pkl | len: 3 |  size: 2.07 KB
Processing depth (2, 3, 5, 8):   2%|▏         | 2/100 [00:50<40:29, 24.80s/it]is_0k: False
your chose emoji: ['🏁', '❣️', '👨🏿\u200d🦯', '\U0001faf8🏾', '⛷', '⬆', '👉🏽', '\U0001fa75', '👨🏼\u200d🏫', '🏴']
emoji:
O: 🏁 [9468, 237, 223]
N: 🩵 [9468, 102, 113]

O: ❣️ [49633, 96, 31643]
N: 👨🏿‍🦯 [9468, 239, 101, 9468, 237, 123, 102470, 9468, 99, 107]

O: 👨🏿‍🦯 [9468, 239, 101, 9468, 237, 123, 102470, 9468, 99, 107]
N: 🏁 [9468, 237, 223]

O: 🫸🏾 [9468, 104, 116, 9468, 237, 122]
N: ⛷ [158, 249, 115]

O: ⛷ [158, 249, 115]
N: 🫸🏾 [9468, 104, 116, 9468, 237, 122]

O: ⬆ [158, 105, 228]
N: ❣️ [49633, 96, 31643]

O: 👉🏽 [9468, 239, 231, 9468, 237, 121]
N: ⬆ [158, 105, 228]

O: 🩵 [9468, 102, 113]
N: 👨🏼‍🏫 [9468, 239, 101, 9468, 237, 120, 102470, 9468, 237, 104]

O: 👨🏼‍🏫 [9468, 239, 101, 9468, 237, 120, 102470, 9468, 237, 104]
N: 👉🏽 [9468, 239, 231, 9468, 237, 121]

O: 🏴 [9468, 237, 112]
N: 🏴 [9468, 237, 112]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.62s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.78s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.63s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.25s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.77s/it]
Processing depth (3, 6, 8, 9):   2%|▏         | 2/100 [01:07<40:29, 24.80s/it]2025-01-22 06:21:32.241 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John took the milk there.
2025-01-22 06:21:32.256 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2921, 2926) --> . John took the milk
2025-01-22 06:21:32.256 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the bathroom.
2025-01-22 06:21:32.283 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4922, 4928) --> . John went back to the
2025-01-22 06:21:32.284 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the garden.
2025-01-22 06:21:32.322 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6621, 6626) --> . John moved to the
2025-01-22 06:21:32.323 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel moved to the bathroom.
2025-01-22 06:21:32.361 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7252, 7257) -->  Daniel moved to the bathroom
2025-01-22 06:21:32.362 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel journeyed to the bedroom.
2025-01-22 06:21:32.399 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6342, 6348) --> . Daniel journeyed to the
2025-01-22 06:21:32.400 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the office.
2025-01-22 06:21:32.432 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5495, 5501) --> . Mary journeyed to the
2025-01-22 06:21:32.432 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the kitchen.
2025-01-22 06:21:32.451 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3201, 3207) --> . Sandra went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:21:33.195 | INFO     | test_jbb_embedding:begin_test:693 - the kitchen<|eot_id|>
2025-01-22 06:21:33.195 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8157])
2025-01-22 06:21:35.422 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [359.14285714285717, 26.099138327205882, 195.75868055555554, 24.86187815539958, 22.67890625], 'topk_indices': array([8145,   24, 2923, 2893, 8045, 8011, 8144, 8155, 8147, 6626, 2924,
       4928, 2926, 3202, 8157,   14, 8156, 2925, 8152,    0]), 'topk_tokens': [' before', '\n\n', ' took', '.', '.\n\n', ' context', ' milk', '<|end_header_id|>', ' garden', ' garden', ' the', ' bathroom', ' there', ' Sandra', 'b', '\n', '\n\n', ' milk', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [666.8, 312.2083333333333, 355.55, 111.4]}, 'weight': {'score': [21.586681547619047, 23.262936580882354, 20.73090277777778, 23.27288338104913, 29.201201923076923], 'topk_indices': array([3295, 3268, 3133, 3181, 7372, 7410, 1473, 1411, 4263, 4247, 5065,
       5126, 7075, 7131, 3477, 3451, 4835, 4860, 4912, 4883]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.1, 20.0703125, 18.88125, 25.5984375]}, 'saliency': {'score': [1.9764927455357142, 0.14727241665709254, 1.2233547634548612, 0.1401571464749954, 0.16830045259915866], 'topk_indices': array([4334, 8045, 6623, 2894, 3203, 3207, 8055, 2892, 8145, 8156, 2923,
       8157, 8011, 2926, 8144, 8147, 6626, 4928, 3202, 2925]), 'topk_tokens': [' Brown', '.\n\n', ' moved', ' During', ' went', ' kitchen', ' location', ' Gov', ' before', '\n\n', ' took', 'b', ' context', ' there', ' milk', ' garden', ' garden', ' bathroom', ' Sandra', ' milk'], 'evidence_proportions': [3.9109375, 1.6712239583333333, 1.6490234375, 0.73583984375]}}, 'pred_res': 'the kitchen<|eot_id|>', 'score': 0}
2025-01-22 06:21:35.429 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:21:35.429 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-90_pid-2_3-6-8-9.pkl | len: 3 |  size: 2.0 KB
Processing depth (3, 6, 8, 9):   3%|▎         | 3/100 [01:11<36:38, 22.67s/it]is_0k: False
your chose emoji: ['🙆🏼\u200d♂', '🇹🇬', '🏌🏼', '🤱🏿', '🚣🏾\u200d♂️', '🛑', '👩🏿', '🖖🏽', '🙎', '🧔🏾\u200d♂️']
emoji:
O: 🙆🏼‍♂ [9468, 247, 228, 9468, 237, 120, 102470, 17245, 224]
N: 🤱🏿 [9468, 97, 109, 9468, 237, 123]

O: 🇹🇬 [9468, 229, 117, 9468, 229, 105]
N: 🙆🏼‍♂ [9468, 247, 228, 9468, 237, 120, 102470, 17245, 224]

O: 🏌🏼 [9468, 237, 234, 9468, 237, 120]
N: 🏌🏼 [9468, 237, 234, 9468, 237, 120]

O: 🤱🏿 [9468, 97, 109, 9468, 237, 123]
N: 🙎 [9468, 247, 236]

O: 🚣🏾‍♂️ [9468, 248, 96, 9468, 237, 122, 102470, 17245, 224, 31643]
N: 🛑 [9468, 249, 239]

O: 🛑 [9468, 249, 239]
N: 🚣🏾‍♂️ [9468, 248, 96, 9468, 237, 122, 102470, 17245, 224, 31643]

O: 👩🏿 [9468, 239, 102, 9468, 237, 123]
N: 🇹🇬 [9468, 229, 117, 9468, 229, 105]

O: 🖖🏽 [9468, 244, 244, 9468, 237, 121]
N: 🖖🏽 [9468, 244, 244, 9468, 237, 121]

O: 🙎 [9468, 247, 236]
N: 👩🏿 [9468, 239, 102, 9468, 237, 123]

O: 🧔🏾‍♂️ [9468, 100, 242, 9468, 237, 122, 102470, 17245, 224, 31643]
N: 🧔🏾‍♂️ [9468, 100, 242, 9468, 237, 122, 102470, 17245, 224, 31643]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.27s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.76s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.44s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.05s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.59s/it]
Processing depth (4, 6, 8, 9):   3%|▎         | 3/100 [01:27<36:38, 22.67s/it]2025-01-22 06:21:51.688 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John took the milk there.
2025-01-22 06:21:51.705 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3564, 3569) --> . John took the milk
2025-01-22 06:21:51.706 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the bathroom.
2025-01-22 06:21:51.730 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4589, 4595) -->  John went back to the bathroom
2025-01-22 06:21:51.730 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the garden.
2025-01-22 06:21:51.762 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6509, 6514) --> . John moved to the
2025-01-22 06:21:51.762 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel moved to the bathroom.
2025-01-22 06:21:51.797 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7114, 7119) -->  Daniel moved to the bathroom
2025-01-22 06:21:51.797 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel journeyed to the bedroom.
2025-01-22 06:21:51.830 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6103, 6109) -->  Daniel journeyed to the bedroom
2025-01-22 06:21:51.830 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the office.
2025-01-22 06:21:51.855 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5057, 5063) --> . Mary journeyed to the
2025-01-22 06:21:51.855 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the kitchen.
2025-01-22 06:21:51.870 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3016, 3022) -->  tragedy. Sandra went back to
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:21:52.642 | INFO     | test_jbb_embedding:begin_test:693 - the kitchen<|eot_id|>
2025-01-22 06:21:52.643 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8149])
2025-01-22 06:21:54.878 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [218.84375, 16.437894841756624, 116.10243055555556, 15.692857913225687, 22.413037909836067], 'topk_indices': array([3520, 8148, 8137, 8145,    4, 3567, 7902, 3566, 8047,    3,    1,
       4594,   14,   24, 2950, 3569, 3568, 8144, 8147,    0]), 'topk_tokens': [' Ramsey', '\n\n', ' before', '<|start_header_id|>', '\n\n', ' the', ' Square', ' took', ' location', '<|end_header_id|>', '<|start_header_id|>', ' bathroom', '\n', '\n\n', '��', ' there', ' milk', '<|eot_id|>', '<|end_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [418.65, 262.8958333333333, 123.4875, 61.53125]}, 'weight': {'score': [22.941220238095237, 23.259560537291463, 23.8515625, 23.259071089609268, 29.3609118852459], 'topk_indices': array([3300, 3327, 3220, 3172, 7442, 7404, 1405, 1467, 4311, 4295, 5140,
       5201, 7181, 7125, 3483, 3509, 4910, 4958, 4987, 4935]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.1, 24.811197916666668, 18.88125, 25.5984375]}, 'saliency': {'score': [1.3506847563244047, 0.09250446952243314, 0.7191942003038194, 0.08785733514835373, 0.16502217777439807], 'topk_indices': array([  16, 8131, 3565,    0, 8142, 8003, 3023, 8137, 8139, 8136, 3566,
       7902,   24, 8047, 3520, 3018, 3569, 4594, 2950, 3568]), 'topk_tokens': [' Date', 'Question', ' John', '<|begin_of_text|>', 'Answer', ' context', ' kitchen', ' before', ' garden', ' milk', ' took', ' Square', '\n\n', ' location', ' Ramsey', ' Sandra', ' there', ' bathroom', '��', ' milk'], 'evidence_proportions': [2.48017578125, 1.8119303385416667, 0.6242431640625, 0.394140625]}}, 'pred_res': 'the kitchen<|eot_id|>', 'score': 0}
2025-01-22 06:21:54.890 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:21:54.890 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-90_pid-3_4-6-8-9.pkl | len: 3 |  size: 2.07 KB
Processing depth (4, 6, 8, 9):   4%|▍         | 4/100 [01:30<34:14, 21.40s/it]is_0k: False
your chose emoji: ['➖', '🏹', '👩🏻\u200d🔧', '🔯', '🔳', '🧘🏾\u200d♀️', '👨🏻\u200d🔧', '👩🏻\u200d🔬', '👨🏽\u200d🍼', '🆒']
emoji:
O: ➖ [98115, 244]
N: 🏹 [9468, 237, 117]

O: 🏹 [9468, 237, 117]
N: 👩🏻‍🔧 [9468, 239, 102, 9468, 237, 119, 102470, 9468, 242, 100]

O: 👩🏻‍🔧 [9468, 239, 102, 9468, 237, 119, 102470, 9468, 242, 100]
N: 🔯 [9468, 242, 107]

O: 🔯 [9468, 242, 107]
N: 🧘🏾‍♀️ [9468, 100, 246, 9468, 237, 122, 102470, 32990, 31643]

O: 🔳 [9468, 242, 111]
N: 👨🏽‍🍼 [9468, 239, 101, 9468, 237, 121, 102470, 9468, 104247]

O: 🧘🏾‍♀️ [9468, 100, 246, 9468, 237, 122, 102470, 32990, 31643]
N: 🔳 [9468, 242, 111]

O: 👨🏻‍🔧 [9468, 239, 101, 9468, 237, 119, 102470, 9468, 242, 100]
N: ➖ [98115, 244]

O: 👩🏻‍🔬 [9468, 239, 102, 9468, 237, 119, 102470, 9468, 242, 105]
N: 👩🏻‍🔬 [9468, 239, 102, 9468, 237, 119, 102470, 9468, 242, 105]

O: 👨🏽‍🍼 [9468, 239, 101, 9468, 237, 121, 102470, 9468, 104247]
N: 👨🏻‍🔧 [9468, 239, 101, 9468, 237, 119, 102470, 9468, 242, 100]

O: 🆒 [9468, 101445]
N: 🆒 [9468, 101445]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.55s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.96s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.72s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.33s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.86s/it]
Processing depth (2, 5, 8, 9):   4%|▍         | 4/100 [01:47<34:14, 21.40s/it]2025-01-22 06:22:12.065 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John took the milk there.
2025-01-22 06:22:12.075 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1795, 1800) --> . John took the milk
2025-01-22 06:22:12.075 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John went back to the bathroom.
2025-01-22 06:22:12.102 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4136, 4142) --> . John went back to the
2025-01-22 06:22:12.102 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the garden.
2025-01-22 06:22:12.136 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6541, 6546) --> . John moved to the
2025-01-22 06:22:12.137 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel moved to the bathroom.
2025-01-22 06:22:12.184 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7140, 7145) -->  Daniel moved to the bathroom
2025-01-22 06:22:12.184 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel journeyed to the bedroom.
2025-01-22 06:22:12.215 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6192, 6198) --> . Daniel journeyed to the
2025-01-22 06:22:12.216 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the office.
2025-01-22 06:22:12.245 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (5191, 5197) --> . Mary journeyed to the
2025-01-22 06:22:12.246 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the kitchen.
2025-01-22 06:22:12.261 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3010, 3016) -->  tragedy. Sandra went back to
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:22:13.066 | INFO     | test_jbb_embedding:begin_test:693 - the capitol<|eot_id|>
2025-01-22 06:22:13.066 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8187])
2025-01-22 06:22:15.278 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [190.33630952380952, 18.7941163003663, 81.0390625, 18.214703333946755, 21.3771484375], 'topk_indices': array([8178,    4, 8075, 8168, 8170, 1800, 7928,   23, 8181, 1799,    1,
       8085, 8175,    3,   14,   24, 8185, 8182, 8183,    0]), 'topk_tokens': ['?', '\n\n', '.\n\n', '.\n\n', ':', ' there', ' Square', '4', ':', ' milk', '<|start_header_id|>', ' location', ' before', '<|end_header_id|>', '\n', '\n\n', '<|end_header_id|>', '<|eot_id|>', '<|start_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [323.1, 152.17708333333334, 173.675, 120.025]}, 'weight': {'score': [21.586681547619047, 23.28110882173382, 22.34418402777778, 23.287543322905165, 29.01796875], 'topk_indices': array([3321, 3294, 3166, 3214, 7430, 7468, 1431, 1493, 4296, 4280, 5158,
       5097, 7151, 7207, 3503, 3477, 4868, 4916, 4893, 4945]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [22.1, 20.0703125, 18.88125, 25.5984375]}, 'saliency': {'score': [1.0550130208333333, 0.10452476939293345, 0.464996337890625, 0.10127992317612486, 0.15638275146484376], 'topk_indices': array([8156,    0,   23, 8084,   20, 8171, 1797, 8113, 1800, 8177, 8169,
       8180, 8174, 7928, 2268,   24, 4142, 8085, 1799, 8175]), 'topk_tokens': [' return', '<|begin_of_text|>', '4', ' first', ' Jul', ' Where', ' took', ' moved', ' there', ' garden', 'Question', 'Answer', ' milk', ' Square', ' Bench', '\n\n', ' bathroom', ' location', ' milk', ' before'], 'evidence_proportions': [1.929541015625, 0.7780354817708334, 0.839453125, 0.72841796875]}}, 'pred_res': 'the capitol<|eot_id|>', 'score': 0}
2025-01-22 06:22:15.284 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:22:15.284 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-90_pid-4_2-5-8-9.pkl | len: 3 |  size: 2.04 KB
Processing depth (2, 5, 8, 9):   5%|▌         | 5/100 [01:50<33:18, 21.04s/it]Processing depth (2, 5, 8, 9):   5%|▌         | 5/100 [01:51<35:09, 22.20s/it]
2025-01-22 06:22:15.337 | INFO     | __main__:<module>:82 - Selected idx: 91
2025-01-22 06:22:15.337 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the location prior to the place where the milk was discarded, left or dropped?
2025-01-22 06:22:15.337 | INFO     | __main__:<module>:84 - Answer: bathroom
2025-01-22 06:22:15.337 | INFO     | __main__:<module>:85 - Tag: 4-hop
2025-01-22 06:22:15.337 | INFO     | __main__:<module>:86 - Needle: [' Mary journeyed to the office.', ' John went back to the bathroom.', ' John took the milk there.', ' Daniel journeyed to the bedroom.', ' Sandra went back to the kitchen.', ' John moved to the garden.', ' John left the milk.', ' Daniel moved to the bathroom.']
2025-01-22 06:22:15.337 | INFO     | __main__:<module>:87 - Real Needle: [' John went back to the bathroom.', ' John took the milk there.', ' John moved to the garden.', ' John left the milk.', ' Daniel moved to the bathroom.']
2025-01-22 06:22:15.337 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['🚶🏾\u200d♂\u200d➡️', '🤐', '👨🏿\u200d🤝\u200d👨🏻', '🕸', '🥷🏾', '🏙', '👩🏻\u200d🤝\u200d👩🏽', '👨\u200d👦', '🥘', '🙎🏿\u200d♀']
emoji:
O: 🚶🏾‍♂‍➡️ [9468, 248, 114, 9468, 237, 122, 102470, 17245, 224, 102470, 98115, 94, 31643]
N: 🚶🏾‍♂‍➡️ [9468, 248, 114, 9468, 237, 122, 102470, 17245, 224, 102470, 98115, 94, 31643]

O: 🤐 [9468, 97, 238]
N: 🥘 [9468, 98, 246]

O: 👨🏿‍🤝‍👨🏻 [9468, 239, 101, 9468, 237, 123, 102470, 9468, 97, 251, 102470, 9468, 239, 101, 9468, 237, 119]
N: 🏙 [9468, 237, 247]

O: 🕸 [9468, 243, 116]
N: 🕸 [9468, 243, 116]

O: 🥷🏾 [9468, 98, 115, 9468, 237, 122]
N: 🥷🏾 [9468, 98, 115, 9468, 237, 122]

O: 🏙 [9468, 237, 247]
N: 🤐 [9468, 97, 238]

O: 👩🏻‍🤝‍👩🏽 [9468, 239, 102, 9468, 237, 119, 102470, 9468, 97, 251, 102470, 9468, 239, 102, 9468, 237, 121]
N: 👩🏻‍🤝‍👩🏽 [9468, 239, 102, 9468, 237, 119, 102470, 9468, 97, 251, 102470, 9468, 239, 102, 9468, 237, 121]

O: 👨‍👦 [9468, 239, 101, 102470, 9468, 239, 99]
N: 👨🏿‍🤝‍👨🏻 [9468, 239, 101, 9468, 237, 123, 102470, 9468, 97, 251, 102470, 9468, 239, 101, 9468, 237, 119]

O: 🥘 [9468, 98, 246]
N: 👨‍👦 [9468, 239, 101, 102470, 9468, 239, 99]

O: 🙎🏿‍♀ [9468, 247, 236, 9468, 237, 123, 102470, 32990]
N: 🙎🏿‍♀ [9468, 247, 236, 9468, 237, 123, 102470, 32990]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.24s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.48s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.36s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.83s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.40s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 2, 6, 8, 9):   0%|          | 0/100 [00:15<?, ?it/s]2025-01-22 06:22:30.826 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the bathroom.
2025-01-22 06:22:30.827 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 37) -->  went back to the bathroom.
2025-01-22 06:22:30.827 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John took the milk there.
2025-01-22 06:22:30.837 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2027, 2032) --> . John took the milk
2025-01-22 06:22:30.837 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the garden.
2025-01-22 06:22:30.860 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4689, 4694) --> . John moved to the
2025-01-22 06:22:30.860 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John left the milk.
2025-01-22 06:22:30.892 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6554, 6558) -->  John left the milk
2025-01-22 06:22:30.892 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel moved to the bathroom.
2025-01-22 06:22:30.930 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7181, 7186) -->  Daniel moved to the bathroom
2025-01-22 06:22:30.930 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the office.
2025-01-22 06:22:30.934 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (639, 645) --> . Mary journeyed to the
2025-01-22 06:22:30.934 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the bedroom.
2025-01-22 06:22:30.943 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1564, 1570) --> . Daniel journeyed to the
2025-01-22 06:22:30.943 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the kitchen.
2025-01-22 06:22:30.944 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (190, 196) --> . Sandra went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:22:33.982 | INFO     | test_jbb_embedding:begin_test:693 - the garden<|eot_id|>
2025-01-22 06:22:33.982 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8225])
2025-01-22 06:22:37.085 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [278.54, 28.006948453451628, 161.91666666666666, 26.947241524129506, 7.119639521059782], 'topk_indices': array([8197, 8210, 4694, 6010, 8223, 8217,   29, 6147, 6012,   35, 2031,
       8198, 8199, 6148,   14, 2032,   24, 8220,    0, 8221]), 'topk_tokens': ['.\n\n', ' milk', ' garden', '\n', '<|end_header_id|>', '?\n', '\n\n', '\n', ' way', ' bathroom', ' milk', 'Question', ':', 'the', '\n', ' there', '\n\n', '<|eot_id|>', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [344.4583333333333, 360.025, 215.875, 321.40625, 146.325]}, 'weight': {'score': [22.526875, 23.307839845649003, 20.73090277777778, 23.315892257177765, 29.533627717391305], 'topk_indices': array([3283, 3310, 3155, 3203, 7471, 7509, 1420, 1482, 4350, 4334, 5205,
       5266, 7248, 7192, 3466, 3492, 4995, 5018, 4970, 5047]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.59375, 22.1, 18.88125, 25.177734375, 25.5984375]}, 'saliency': {'score': [1.6416015625, 0.15633579638030962, 0.8711073133680556, 0.1502273624818647, 0.053109293398649796], 'topk_indices': array([7801,   27, 8218, 8114,   39,   40,    0, 7802, 6557, 6012, 8204,
         24, 4694, 8210, 6148, 8212, 2031, 2032, 8198,   35]), 'topk_tokens': [' genu', 'user', 'Answer', ' location', '***', '\n\n\n', '<|begin_of_text|>', 'inen', ' milk', ' way', ' prior', '\n\n', ' garden', ' milk', 'the', ' discarded', ' milk', ' there', 'Question', ' bathroom'], 'evidence_proportions': [2.0355631510416665, 2.10087890625, 1.032861328125, 2.04443359375, 0.996044921875]}}, 'pred_res': 'the garden<|eot_id|>', 'score': 0}
2025-01-22 06:22:37.094 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:22:37.094 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-91_pid-0_0-2-6-8-9.pkl | len: 3 |  size: 2.06 KB
Processing depth (0, 2, 6, 8, 9):   1%|          | 1/100 [00:21<35:44, 21.66s/it]is_0k: False
your chose emoji: ['👨🏻\u200d❤\u200d👨🏼', '🤪', '🤝🏿', '👨🏿\u200d✈', '👩🏻\u200d❤\u200d👨🏿', '🧑\u200d✈', '👩🏼\u200d❤\u200d💋\u200d👩🏾', '🚵🏻\u200d♀️', '🧚🏿\u200d♂', '😲']
emoji:
O: 👨🏻‍❤‍👨🏼 [9468, 239, 101, 9468, 237, 119, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 120]
N: 🤪 [9468, 97, 103]

O: 🤪 [9468, 97, 103]
N: 🧚🏿‍♂ [9468, 100, 248, 9468, 237, 123, 102470, 17245, 224]

O: 🤝🏿 [9468, 97, 251, 9468, 237, 123]
N: 🚵🏻‍♀️ [9468, 248, 113, 9468, 237, 119, 102470, 32990, 31643]

O: 👨🏿‍✈ [9468, 239, 101, 9468, 237, 123, 102470, 38798, 230]
N: 👩🏼‍❤‍💋‍👩🏾 [9468, 239, 102, 9468, 237, 120, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 122]

O: 👩🏻‍❤‍👨🏿 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 123]
N: 👨🏿‍✈ [9468, 239, 101, 9468, 237, 123, 102470, 38798, 230]

O: 🧑‍✈ [9468, 100, 239, 102470, 38798, 230]
N: 🧑‍✈ [9468, 100, 239, 102470, 38798, 230]

O: 👩🏼‍❤‍💋‍👩🏾 [9468, 239, 102, 9468, 237, 120, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 122]
N: 👩🏻‍❤‍👨🏿 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 123]

O: 🚵🏻‍♀️ [9468, 248, 113, 9468, 237, 119, 102470, 32990, 31643]
N: 🤝🏿 [9468, 97, 251, 9468, 237, 123]

O: 🧚🏿‍♂ [9468, 100, 248, 9468, 237, 123, 102470, 17245, 224]
N: 👨🏻‍❤‍👨🏼 [9468, 239, 101, 9468, 237, 119, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 120]

O: 😲 [76460, 110]
N: 😲 [76460, 110]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:11,  3.87s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.18s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.24s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.99s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.41s/it]
Processing depth (0, 1, 4, 5, 9):   1%|          | 1/100 [00:36<35:44, 21.66s/it]2025-01-22 06:22:52.408 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the bathroom.
2025-01-22 06:22:52.408 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 37) -->  went back to the bathroom.
2025-01-22 06:22:52.409 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John took the milk there.
2025-01-22 06:22:52.413 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (916, 921) --> . John took the milk
2025-01-22 06:22:52.413 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the garden.
2025-01-22 06:22:52.432 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3737, 3742) --> . John moved to the
2025-01-22 06:22:52.432 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John left the milk.
2025-01-22 06:22:52.452 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4258, 4262) -->  John left the milk
2025-01-22 06:22:52.452 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel moved to the bathroom.
2025-01-22 06:22:52.488 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7208, 7213) --> . Daniel moved to the
2025-01-22 06:22:52.488 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the office.
2025-01-22 06:22:52.491 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (639, 645) --> . Mary journeyed to the
2025-01-22 06:22:52.491 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the bedroom.
2025-01-22 06:22:52.499 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1570, 1576) --> . Daniel journeyed to the
2025-01-22 06:22:52.499 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the kitchen.
2025-01-22 06:22:52.500 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (190, 196) --> . Sandra went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:22:53.286 | INFO     | test_jbb_embedding:begin_test:693 - the garden<|eot_id|>
2025-01-22 06:22:53.287 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8173])
2025-01-22 06:22:55.529 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [333.7525, 32.81616927592955, 211.17013888888889, 31.49638817164638, 14.014870383522727], 'topk_indices': array([3742, 8062,  920, 6100, 8158, 6093, 5964, 8153,   29,    4, 8147,
         35,   24, 8018, 8160,   14,  921, 8168, 8169,    0]), 'topk_tokens': [' garden', ' location', ' milk', ' the', ' milk', 'the', ' office', ' to', '\n\n', '\n\n', ':', ' bathroom', '\n\n', ' context', ' discarded', '\n', ' there', '<|eot_id|>', '<|start_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [472.375, 450.7, 282.225, 341.59375, 95.7125]}, 'weight': {'score': [21.3890625, 23.267673679060664, 20.73090277777778, 23.279062730542236, 29.498342803030305], 'topk_indices': array([3298, 3271, 3143, 3191, 7387, 7425, 1488, 1426, 4283, 4267, 5132,
       5193, 7158, 7102, 3480, 3454, 4980, 4903, 4928, 4951]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.59375, 22.1, 18.88125, 25.177734375, 19.909375]}, 'saliency': {'score': [1.9357177734375, 0.18431224188459364, 1.1431206597222223, 0.1768065625768474, 0.1089608163544626], 'topk_indices': array([  40, 8166,    4,   24,   39,   38, 6093,   31, 4261, 8062, 8152,
       5964, 3742, 8146,  920, 8158, 8018,  921,   35, 8160]), 'topk_tokens': ['\n\n\n', 'Answer', '\n\n', '\n\n', '***', 'UL', 'the', ' went', ' milk', ' location', ' prior', ' office', ' garden', 'Question', ' milk', ' milk', ' context', ' there', ' bathroom', ' discarded'], 'evidence_proportions': [2.8553873697916665, 2.6060546875, 1.38681640625, 2.20458984375, 0.4955810546875]}}, 'pred_res': 'the garden<|eot_id|>', 'score': 0}
2025-01-22 06:22:55.535 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:22:55.535 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-91_pid-1_0-1-4-5-9.pkl | len: 3 |  size: 2.06 KB
Processing depth (0, 1, 4, 5, 9):   2%|▏         | 2/100 [00:40<32:17, 19.77s/it]is_0k: False
your chose emoji: ['👩🏼\u200d❤\u200d💋\u200d👨🏼', '👈🏾', '🤦🏼\u200d♀️', '🏓', '🎏', '🔬', '🤱🏾', '🧝🏿', '🛍', '💂🏼\u200d♂️']
emoji:
O: 👩🏼‍❤‍💋‍👨🏼 [9468, 239, 102, 9468, 237, 120, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 120]
N: 🧝🏿 [9468, 100, 251, 9468, 237, 123]

O: 👈🏾 [9468, 239, 230, 9468, 237, 122]
N: 🎏 [9468, 236, 237]

O: 🤦🏼‍♀️ [9468, 97, 99, 9468, 237, 120, 102470, 32990, 31643]
N: 🤱🏾 [9468, 97, 109, 9468, 237, 122]

O: 🏓 [9468, 237, 241]
N: 👩🏼‍❤‍💋‍👨🏼 [9468, 239, 102, 9468, 237, 120, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 120]

O: 🎏 [9468, 236, 237]
N: 🛍 [9468, 249, 235]

O: 🔬 [9468, 242, 105]
N: 🏓 [9468, 237, 241]

O: 🤱🏾 [9468, 97, 109, 9468, 237, 122]
N: 👈🏾 [9468, 239, 230, 9468, 237, 122]

O: 🧝🏿 [9468, 100, 251, 9468, 237, 123]
N: 🔬 [9468, 242, 105]

O: 🛍 [9468, 249, 235]
N: 🤦🏼‍♀️ [9468, 97, 99, 9468, 237, 120, 102470, 32990, 31643]

O: 💂🏼‍♂️ [93273, 224, 9468, 237, 120, 102470, 17245, 224, 31643]
N: 💂🏼‍♂️ [93273, 224, 9468, 237, 120, 102470, 17245, 224, 31643]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:05<00:15,  5.16s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:10<00:10,  5.05s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.69s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.17s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.81s/it]
Processing depth (1, 4, 5, 7, 9):   2%|▏         | 2/100 [00:57<32:17, 19.77s/it]2025-01-22 06:23:12.816 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the bathroom.
2025-01-22 06:23:12.821 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (909, 915) --> . John went back to the
2025-01-22 06:23:12.821 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John took the milk there.
2025-01-22 06:23:12.839 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3633, 3638) --> . John took the milk
2025-01-22 06:23:12.839 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the garden.
2025-01-22 06:23:12.860 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4238, 4243) -->  John moved to the garden
2025-01-22 06:23:12.860 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John left the milk.
2025-01-22 06:23:12.888 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5742, 5746) -->  John left the milk
2025-01-22 06:23:12.888 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel moved to the bathroom.
2025-01-22 06:23:12.926 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7273, 7278) -->  cold. Daniel moved to
2025-01-22 06:23:12.927 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the office.
2025-01-22 06:23:12.930 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (632, 638) --> . Mary journeyed to the
2025-01-22 06:23:12.930 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the bedroom.
2025-01-22 06:23:12.938 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1564, 1570) --> . Daniel journeyed to the
2025-01-22 06:23:12.938 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the kitchen.
2025-01-22 06:23:12.939 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (183, 189) --> . Sandra went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:23:13.731 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 06:23:13.731 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8189])
2025-01-22 06:23:15.978 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [263.394375, 23.56244659423828, 165.26736111111111, 22.51366923855688, 15.55173141891892], 'topk_indices': array([8161, 8032, 8188, 8068, 8162, 3637, 8078, 8163, 8033,   14,  915,
       8187, 8168,   24, 8170, 8034, 8169,    0, 8185, 8184]), 'topk_tokens': ['.\n\n', ' provided', '\n\n', '.\n\n', 'Question', ' milk', ' location', ':', ' you', '\n', ' bathroom', '<|end_header_id|>', ' prior', '\n\n', ' the', ' context', ' to', '<|begin_of_text|>', '<|start_header_id|>', '<|eot_id|>'], 'evidence_proportions': [304.7083333333333, 290.975, 347.675, 295.8125, 76.021875]}, 'weight': {'score': [22.7303125, 23.27187728881836, 20.73090277777778, 23.279151391275004, 29.072846283783782], 'topk_indices': array([3271, 3298, 3179, 3131, 7433, 7395, 1420, 1482, 4290, 4306, 5101,
       5162, 7110, 7166, 3480, 3454, 4878, 4955, 4926, 4903]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.0703125, 22.1, 23.3953125, 25.177734375, 23.9296875]}, 'saliency': {'score': [1.55529296875, 0.13040214776992798, 0.9356757269965278, 0.12425204408228771, 0.11547604122677364], 'topk_indices': array([5745, 8164, 8182, 5954, 8167, 4239, 8033,  910, 8032, 8169, 4242,
       8078, 8174, 3637,   24, 8176, 8162, 8168,  915, 8034]), 'topk_tokens': [' milk', ' Where', 'Answer', ' office', ' location', ' moved', ' you', ' John', ' provided', ' to', ' garden', ' location', ' milk', ' milk', '\n\n', ' discarded', 'Question', ' prior', ' bathroom', ' context'], 'evidence_proportions': [1.6206868489583333, 1.71171875, 2.09921875, 1.97369384765625, 0.441748046875]}}, 'pred_res': 'The garden.<|eot_id|>', 'score': 0}
2025-01-22 06:23:15.985 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:23:15.985 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-91_pid-2_1-4-5-7-9.pkl | len: 3 |  size: 2.09 KB
Processing depth (1, 4, 5, 7, 9):   3%|▎         | 3/100 [01:00<32:27, 20.08s/it]is_0k: False
your chose emoji: ['👩🏼\u200d🏫', '👨🏻\u200d✈️', '👭🏼', '👋🏾', '👩\u200d⚕', '\U0001faf7🏾', '🧍\u200d♂', '🌇', '👨🏼\u200d🦯\u200d➡️', '🇯🇪']
emoji:
O: 👩🏼‍🏫 [9468, 239, 102, 9468, 237, 120, 102470, 9468, 237, 104]
N: 🌇 [9468, 234, 229]

O: 👨🏻‍✈️ [9468, 239, 101, 9468, 237, 119, 102470, 38798, 230, 31643]
N: 🧍‍♂ [9468, 100, 235, 102470, 17245, 224]

O: 👭🏼 [9468, 239, 255, 9468, 237, 120]
N: 👨🏼‍🦯‍➡️ [9468, 239, 101, 9468, 237, 120, 102470, 9468, 99, 107, 102470, 98115, 94, 31643]

O: 👋🏾 [9468, 239, 233, 9468, 237, 122]
N: 👨🏻‍✈️ [9468, 239, 101, 9468, 237, 119, 102470, 38798, 230, 31643]

O: 👩‍⚕ [9468, 239, 102, 102470, 158, 248, 243]
N: 👩‍⚕ [9468, 239, 102, 102470, 158, 248, 243]

O: 🫷🏾 [9468, 104, 115, 9468, 237, 122]
N: 👋🏾 [9468, 239, 233, 9468, 237, 122]

O: 🧍‍♂ [9468, 100, 235, 102470, 17245, 224]
N: 👭🏼 [9468, 239, 255, 9468, 237, 120]

O: 🌇 [9468, 234, 229]
N: 🫷🏾 [9468, 104, 115, 9468, 237, 122]

O: 👨🏼‍🦯‍➡️ [9468, 239, 101, 9468, 237, 120, 102470, 9468, 99, 107, 102470, 98115, 94, 31643]
N: 👩🏼‍🏫 [9468, 239, 102, 9468, 237, 120, 102470, 9468, 237, 104]

O: 🇯🇪 [9468, 229, 107, 9468, 229, 103]
N: 🇯🇪 [9468, 229, 107, 9468, 229, 103]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.48s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.98s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.38s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.82s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.48s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 1, 4, 8, 9):   3%|▎         | 3/100 [01:16<32:27, 20.08s/it]2025-01-22 06:23:31.823 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the bathroom.
2025-01-22 06:23:31.823 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 37) -->  went back to the bathroom.
2025-01-22 06:23:31.824 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John took the milk there.
2025-01-22 06:23:31.829 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (916, 921) --> . John took the milk
2025-01-22 06:23:31.830 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the garden.
2025-01-22 06:23:31.851 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3618, 3623) -->  Hon. John moved to
2025-01-22 06:23:31.851 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John left the milk.
2025-01-22 06:23:31.882 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6616, 6620) -->  John left the milk
2025-01-22 06:23:31.883 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel moved to the bathroom.
2025-01-22 06:23:31.922 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7212, 7217) --> . Daniel moved to the
2025-01-22 06:23:31.922 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the office.
2025-01-22 06:23:31.925 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (639, 645) --> . Mary journeyed to the
2025-01-22 06:23:31.926 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the bedroom.
2025-01-22 06:23:31.933 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1570, 1576) --> . Daniel journeyed to the
2025-01-22 06:23:31.934 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the kitchen.
2025-01-22 06:23:31.935 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (190, 196) --> . Sandra went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:23:34.728 | INFO     | test_jbb_embedding:begin_test:693 - the garden<|eot_id|>
2025-01-22 06:23:34.728 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8153])
2025-01-22 06:23:37.744 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [234.785, 31.128651452918096, 149.60069444444446, 30.238240324171084, 21.382184709821427], 'topk_indices': array([7611, 7537, 7558,   24, 8148, 7597, 7563, 7997,  921, 7608, 7626,
       7564, 7603, 7559, 2534, 7998, 7627, 7612, 4161,    0]), 'topk_tokens': [' two', 'nes', ' tele', '\n\n', '<|eot_id|>', ' or', ' set', ' you', ' there', ' set', ' Min', ' up', ' tele', 'graph', ' whistle', ' context', 'nes', ' or', ' column', '<|begin_of_text|>'], 'evidence_proportions': [255.41666666666666, 300.7, 164.575, 358.40625, 115.425]}, 'weight': {'score': [22.350625, 23.245325527219226, 20.73090277777778, 23.253661176506842, 28.983537946428573], 'topk_indices': array([3265, 3292, 3137, 3185, 7429, 7391, 1426, 1488, 4292, 4308, 5184,
       5123, 7106, 7162, 3486, 3460, 4959, 4930, 4907, 4882]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [21.59375, 22.1, 23.6890625, 25.177734375, 19.909375]}, 'saliency': {'score': [1.3748876953125, 0.17805487692151484, 0.8347439236111112, 0.17290989685246672, 0.15937423706054688], 'topk_indices': array([4160, 7996, 7611, 8140,  921, 7582, 7602, 7564, 7537, 7608, 7563,
       7626, 7558, 7559, 7612, 7603, 7998, 2534, 7627, 4161]), 'topk_tokens': [' double', ' provided', ' two', ' discarded', ' there', 'nes', ' bogus', ' up', 'nes', ' set', ' set', ' Min', ' tele', 'graph', ' or', ' tele', ' context', ' whistle', 'nes', ' column'], 'evidence_proportions': [1.5015462239583333, 1.74658203125, 0.9166015625, 2.30322265625, 0.5668212890625]}}, 'pred_res': 'the garden<|eot_id|>', 'score': 0}
2025-01-22 06:23:37.750 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:23:37.750 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-91_pid-3_0-1-4-8-9.pkl | len: 3 |  size: 2.03 KB
Processing depth (0, 1, 4, 8, 9):   4%|▍         | 4/100 [01:22<33:11, 20.74s/it]is_0k: False
your chose emoji: ['🤞🏽', '🦌', '™', '🧘🏽\u200d♂️', '👨🏾\u200d🦼\u200d➡', '😥', '🇨🇲', '🪕', '🦹🏼\u200d♂', '🪢']
emoji:
O: 🤞🏽 [9468, 97, 252, 9468, 237, 121]
N: 🦌 [9468, 99, 234]

O: 🦌 [9468, 99, 234]
N: 🇨🇲 [9468, 229, 101, 9468, 229, 110]

O: ™ [16500]
N: 😥 [76460, 98]

O: 🧘🏽‍♂️ [9468, 100, 246, 9468, 237, 121, 102470, 17245, 224, 31643]
N: 👨🏾‍🦼‍➡ [9468, 239, 101, 9468, 237, 122, 102470, 9468, 99, 120, 102470, 98115, 94]

O: 👨🏾‍🦼‍➡ [9468, 239, 101, 9468, 237, 122, 102470, 9468, 99, 120, 102470, 98115, 94]
N: ™ [16500]

O: 😥 [76460, 98]
N: 🦹🏼‍♂ [9468, 99, 117, 9468, 237, 120, 102470, 17245, 224]

O: 🇨🇲 [9468, 229, 101, 9468, 229, 110]
N: 🧘🏽‍♂️ [9468, 100, 246, 9468, 237, 121, 102470, 17245, 224, 31643]

O: 🪕 [9468, 103, 243]
N: 🤞🏽 [9468, 97, 252, 9468, 237, 121]

O: 🦹🏼‍♂ [9468, 99, 117, 9468, 237, 120, 102470, 17245, 224]
N: 🪕 [9468, 103, 243]

O: 🪢 [9468, 103, 95]
N: 🪢 [9468, 103, 95]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.48s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.59s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.31s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  2.97s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.51s/it]
Processing depth (1, 3, 4, 5, 7):   4%|▍         | 4/100 [01:37<33:11, 20.74s/it]2025-01-22 06:23:53.467 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the bathroom.
2025-01-22 06:23:53.471 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (775, 781) --> . John went back to the
2025-01-22 06:23:53.471 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John took the milk there.
2025-01-22 06:23:53.485 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2845, 2850) --> . John took the milk
2025-01-22 06:23:53.485 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John moved to the garden.
2025-01-22 06:23:53.503 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3587, 3592) --> . John moved to the
2025-01-22 06:23:53.503 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John left the milk.
2025-01-22 06:23:53.528 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4182, 4186) -->  John left the milk
2025-01-22 06:23:53.528 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Daniel moved to the bathroom.
2025-01-22 06:23:53.560 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5678, 5683) --> . Daniel moved to the
2025-01-22 06:23:53.560 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Mary journeyed to the office.
2025-01-22 06:23:53.563 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (602, 608) --> . Mary journeyed to the
2025-01-22 06:23:53.563 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the bedroom.
2025-01-22 06:23:53.571 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1408, 1414) --> . Daniel journeyed to the
2025-01-22 06:23:53.571 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the kitchen.
2025-01-22 06:23:53.572 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (149, 155) --> . Sandra went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:23:54.352 | INFO     | test_jbb_embedding:begin_test:693 - the garden<|eot_id|>
2025-01-22 06:23:54.352 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8171])
2025-01-22 06:23:56.566 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [197.69, 18.106284025568876, 170.86284722222223, 17.215961674455787, 13.321003605769231], 'topk_indices': array([ 609, 8170, 8165, 8050, 8150,    1, 8158, 2850, 2849,   28,   14,
        156, 3592, 8151, 8169,   24,  781, 8167,    0, 8166]), 'topk_tokens': ['.', '\n\n', ':', '.\n\n', ' prior', '<|start_header_id|>', ' discarded', ' there', ' milk', '<|end_header_id|>', '\n', '.', ' garden', ' to', '<|end_header_id|>', '\n\n', ' bathroom', '<|start_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [247.4375, 271.9, 195.825, 180.03125, 79.775]}, 'weight': {'score': [21.0234375, 23.27180312576462, 20.73090277777778, 23.28434098665601, 29.87139423076923], 'topk_indices': array([3330, 3303, 3223, 3175, 7399, 7437, 1437, 1499, 4351, 4367, 5162,
       5223, 7176, 7120, 3506, 3532, 4939, 4964, 4987, 5016]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.0703125, 22.1, 18.88125, 25.177734375, 19.909375]}, 'saliency': {'score': [1.07669921875, 0.10038267863184717, 0.9454481336805556, 0.09551008095704326, 0.09874431903545673], 'topk_indices': array([8050, 8154, 4185, 8144,  151,  604,  150,  155,  776, 2850, 8060,
       8164, 8016, 8156,   24, 8150, 2849, 3592, 8158,  781]), 'topk_tokens': ['.\n\n', ' where', ' milk', 'Question', ' went', ' journey', ' Sandra', ' kitchen', ' John', ' there', ' location', 'Answer', ' context', ' milk', '\n\n', ' prior', ' milk', ' garden', ' discarded', ' bathroom'], 'evidence_proportions': [1.2540690104166667, 1.5791015625, 0.94736328125, 1.1531982421875, 0.42958984375]}}, 'pred_res': 'the garden<|eot_id|>', 'score': 0}
2025-01-22 06:23:56.585 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:23:56.585 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-91_pid-4_1-3-4-5-7.pkl | len: 3 |  size: 2.1 KB
Processing depth (1, 3, 4, 5, 7):   5%|▌         | 5/100 [01:41<31:45, 20.06s/it]Processing depth (1, 3, 4, 5, 7):   5%|▌         | 5/100 [01:41<32:03, 20.25s/it]
2025-01-22 06:23:56.683 | INFO     | __main__:<module>:82 - Selected idx: 92
2025-01-22 06:23:56.683 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the milk before the bedroom? 
2025-01-22 06:23:56.683 | INFO     | __main__:<module>:84 - Answer: office
2025-01-22 06:23:56.683 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 06:23:56.683 | INFO     | __main__:<module>:86 - Needle: [' Daniel journeyed to the bedroom.', ' Sandra got the milk there.', ' John went back to the office.', ' Sandra went back to the kitchen.', ' Sandra took the milk.', ' Sandra put down the milk there.', ' John travelled to the bedroom.', ' John put down the milk.', ' Mary journeyed to the office.']
2025-01-22 06:23:56.683 | INFO     | __main__:<module>:87 - Real Needle: [' John went back to the office.', ' John travelled to the bedroom.', ' John put down the milk.', ' Mary journeyed to the office.']
2025-01-22 06:23:56.684 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['➰', '🥼', '🥵', '🦗', '💋', '🚶\u200d♀️\u200d➡️', '🧑\u200d🦯', '⛹🏽\u200d♂️', '🧑🏿\u200d❤️\u200d💋\u200d🧑🏾', '🦹🏾']
emoji:
O: ➰ [98115, 108]
N: 🥼 [9468, 98, 120]

O: 🥼 [9468, 98, 120]
N: 💋 [93273, 233]

O: 🥵 [9468, 98, 113]
N: 🧑‍🦯 [9468, 100, 239, 102470, 9468, 99, 107]

O: 🦗 [9468, 99, 245]
N: ⛹🏽‍♂️ [158, 249, 117, 9468, 237, 121, 102470, 17245, 224, 31643]

O: 💋 [93273, 233]
N: 🚶‍♀️‍➡️ [9468, 248, 114, 102470, 32990, 31643, 102470, 98115, 94, 31643]

O: 🚶‍♀️‍➡️ [9468, 248, 114, 102470, 32990, 31643, 102470, 98115, 94, 31643]
N: 🧑🏿‍❤️‍💋‍🧑🏾 [9468, 100, 239, 9468, 237, 123, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 100, 239, 9468, 237, 122]

O: 🧑‍🦯 [9468, 100, 239, 102470, 9468, 99, 107]
N: 🦗 [9468, 99, 245]

O: ⛹🏽‍♂️ [158, 249, 117, 9468, 237, 121, 102470, 17245, 224, 31643]
N: ➰ [98115, 108]

O: 🧑🏿‍❤️‍💋‍🧑🏾 [9468, 100, 239, 9468, 237, 123, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 100, 239, 9468, 237, 122]
N: 🥵 [9468, 98, 113]

O: 🦹🏾 [9468, 99, 117, 9468, 237, 122]
N: 🦹🏾 [9468, 99, 117, 9468, 237, 122]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.68s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:10,  5.01s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.99s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:16<00:00,  3.51s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:16<00:00,  4.03s/it]
Processing depth (1, 2, 7, 9):   0%|          | 0/100 [00:18<?, ?it/s]2025-01-22 06:24:14.912 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the office.
2025-01-22 06:24:14.916 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (821, 827) --> . John went back to the
2025-01-22 06:24:14.917 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the bedroom.
2025-01-22 06:24:14.926 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1807, 1812) --> . John travelled to the
2025-01-22 06:24:14.926 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John put down the milk.
2025-01-22 06:24:14.952 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3465, 3470) -->  Sandra put down the milk
2025-01-22 06:24:14.953 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary journeyed to the office.
2025-01-22 06:24:14.991 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7196, 7202) --> . Mary journeyed to the
2025-01-22 06:24:14.991 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel journeyed to the bedroom.
2025-01-22 06:24:14.999 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1580, 1586) --> . Daniel journeyed to the
2025-01-22 06:24:14.999 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra got the milk there.
2025-01-22 06:24:15.011 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2576, 2581) --> . Sandra got the milk
2025-01-22 06:24:15.012 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the kitchen.
2025-01-22 06:24:15.037 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4125, 4131) --> . Sandra went back to the
2025-01-22 06:24:15.037 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra took the milk.
2025-01-22 06:24:15.051 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2418, 2422) -->  Sandra took the milk
2025-01-22 06:24:15.051 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra put down the milk there.
2025-01-22 06:24:15.069 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3464, 3470) --> . Sandra put down the milk
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:24:15.838 | INFO     | test_jbb_embedding:begin_test:693 - the kitchen<|eot_id|>
2025-01-22 06:24:15.838 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8135])
2025-01-22 06:24:18.058 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [328.8238636363636, 35.86784134201794, 335.68055555555554, 34.07011931256182, 49.351236979166664], 'topk_indices': array([8033,    3, 8122, 8128,   23,    4, 8116, 8129, 8125, 8134,    1,
       8123, 8023,    9,   24, 8131, 8133,   14,    0, 8130]), 'topk_tokens': [' location', '<|end_header_id|>', ' milk', 'Answer', '4', '\n\n', '.\n\n', ':', ' bedroom', '\n\n', '<|start_header_id|>', ' before', '.\n\n', ':', '\n\n', '<|start_header_id|>', '<|end_header_id|>', '\n', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [272.0208333333333, 335.7, 306.2, 398.75]}, 'weight': {'score': [21.78515625, 23.242343999631313, 23.499131944444443, 23.24545043583086, 29.233072916666668], 'topk_indices': array([3325, 3298, 3218, 3170, 7420, 7382, 1436, 1498, 4333, 4317, 5195,
       5134, 7146, 7090, 3488, 3514, 4905, 4982, 4930, 4953]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.0703125, 19.990625, 27.7171875, 20.052083333333332]}, 'saliency': {'score': [1.8815363103693181, 0.1998669213066087, 2.047489872685185, 0.1891247667261684, 0.36116282145182294], 'topk_indices': array([   9, 7202,    8, 7198, 1809, 8117, 8132,   14, 8023, 8033, 1812,
         24, 2418, 2421, 1586, 4131, 8122, 8123, 8128, 8125]), 'topk_tokens': [':', ' office', ' Date', ' journey', ' travelled', 'Question', 'assistant', '\n', '.\n\n', ' location', ' bedroom', '\n\n', ' Sandra', ' milk', ' bedroom', ' kitchen', ' milk', ' before', 'Answer', ' bedroom'], 'evidence_proportions': [1.4691975911458333, 1.90166015625, 2.0716796875, 2.11865234375]}}, 'pred_res': 'the kitchen<|eot_id|>', 'score': 0}
2025-01-22 06:24:18.064 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:24:18.065 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-92_pid-0_1-2-7-9.pkl | len: 3 |  size: 2.03 KB
Processing depth (1, 2, 7, 9):   1%|          | 1/100 [00:21<35:08, 21.29s/it]is_0k: False
your chose emoji: ['🙊', '🤶🏻', '☢', '✒️', '😴', '👨🏽\u200d💼', '⛹🏾\u200d♀', '🧎', '🤞🏽', '🏊🏾']
emoji:
O: 🙊 [9468, 247, 232]
N: 🤞🏽 [9468, 97, 252, 9468, 237, 121]

O: 🤶🏻 [9468, 97, 114, 9468, 237, 119]
N: 👨🏽‍💼 [9468, 239, 101, 9468, 237, 121, 102470, 93273, 120]

O: ☢ [18107, 95]
N: 🤶🏻 [9468, 97, 114, 9468, 237, 119]

O: ✒️ [38798, 240, 31643]
N: 🧎 [9468, 100, 236]

O: 😴 [76460, 112]
N: ⛹🏾‍♀ [158, 249, 117, 9468, 237, 122, 102470, 32990]

O: 👨🏽‍💼 [9468, 239, 101, 9468, 237, 121, 102470, 93273, 120]
N: 😴 [76460, 112]

O: ⛹🏾‍♀ [158, 249, 117, 9468, 237, 122, 102470, 32990]
N: 🙊 [9468, 247, 232]

O: 🧎 [9468, 100, 236]
N: ☢ [18107, 95]

O: 🤞🏽 [9468, 97, 252, 9468, 237, 121]
N: ✒️ [38798, 240, 31643]

O: 🏊🏾 [9468, 237, 232, 9468, 237, 122]
N: 🏊🏾 [9468, 237, 232, 9468, 237, 122]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.25s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.86s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.67s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.00s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.61s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 3, 5, 8):   1%|          | 1/100 [00:37<35:08, 21.29s/it]2025-01-22 06:24:34.276 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the office.
2025-01-22 06:24:34.276 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 37) -->  went back to the office.
2025-01-22 06:24:34.276 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the bedroom.
2025-01-22 06:24:34.290 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2850, 2855) --> . John travelled to the
2025-01-22 06:24:34.291 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John put down the milk.
2025-01-22 06:24:34.308 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3353, 3358) -->  Sandra put down the milk
2025-01-22 06:24:34.308 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary journeyed to the office.
2025-01-22 06:24:34.343 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6618, 6624) --> . Mary journeyed to the
2025-01-22 06:24:34.343 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel journeyed to the bedroom.
2025-01-22 06:24:34.353 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1770, 1776) --> . Daniel journeyed to the
2025-01-22 06:24:34.353 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra got the milk there.
2025-01-22 06:24:34.367 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2552, 2557) --> . Sandra got the milk
2025-01-22 06:24:34.367 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the kitchen.
2025-01-22 06:24:34.387 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4087, 4093) --> . Sandra went back to the
2025-01-22 06:24:34.387 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra took the milk.
2025-01-22 06:24:34.401 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2422, 2426) -->  Sandra took the milk
2025-01-22 06:24:34.401 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra put down the milk there.
2025-01-22 06:24:34.417 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3352, 3358) --> . Sandra put down the milk
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:24:38.043 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 06:24:38.044 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8179])
2025-01-22 06:24:41.833 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [463.59659090909093, 45.46379568512407, 405.8287037037037, 43.1361058165273, 29.465848214285714], 'topk_indices': array([8173, 8067, 8169,    4, 6619, 6620, 7378,   23, 8178, 8167,    1,
       8175,    9, 7301,   24, 8177, 7379,   14,    0, 8174]), 'topk_tokens': [':', '.\n\n', ' bedroom', '\n\n', ' Mary', ' journey', ' Min', '4', '\n\n', ' before', '<|start_header_id|>', '<|start_header_id|>', ':', 'nes', '\n\n', '<|end_header_id|>', 'nes', '\n', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [326.5, 327.575, 402.85, 764.6666666666666]}, 'weight': {'score': [21.819957386363637, 23.272989625351425, 23.499131944444443, 23.2761697614363, 29.124776785714285], 'topk_indices': array([3335, 3308, 3180, 3228, 7432, 7470, 1406, 1468, 4311, 4327, 5142,
       5203, 7111, 7167, 3524, 3498, 4899, 4976, 4947, 4924]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.197916666666668, 19.990625, 27.7171875, 20.052083333333332]}, 'saliency': {'score': [2.663818359375, 0.25308397267678157, 2.5094401041666665, 0.23907047389940975, 0.214166259765625], 'topk_indices': array([  23, 8176, 2855,    8,   14, 2425, 1776, 4093, 6624, 8166, 7330,
         24, 8172, 8167, 6619, 7378, 6620, 8169, 7301, 7379]), 'topk_tokens': ['4', 'assistant', ' bedroom', ' Date', '\n', ' milk', ' bedroom', ' kitchen', ' office', ' milk', 'nes', '\n\n', 'Answer', ' before', ' Mary', ' Min', ' journey', ' bedroom', 'nes', 'nes'], 'evidence_proportions': [1.6876627604166667, 1.73271484375, 2.70859375, 4.378580729166667]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 0}
2025-01-22 06:24:41.839 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:24:41.839 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-92_pid-1_0-3-5-8.pkl | len: 3 |  size: 2.0 KB
Processing depth (0, 3, 5, 8):   2%|▏         | 2/100 [00:45<37:09, 22.75s/it]is_0k: False
your chose emoji: ['🍂', '🔍', '🧜🏾\u200d♀', '🧑🏿\u200d🦳', '👩🏽\u200d❤\u200d💋\u200d👩🏼', '👨🏽\u200d🤝\u200d👨🏼', '🚂', '⚱', '😠', '🎮']
emoji:
O: 🍂 [9468, 235, 224]
N: 👨🏽‍🤝‍👨🏼 [9468, 239, 101, 9468, 237, 121, 102470, 9468, 97, 251, 102470, 9468, 239, 101, 9468, 237, 120]

O: 🔍 [9468, 242, 235]
N: ⚱ [158, 248, 109]

O: 🧜🏾‍♀ [9468, 100, 250, 9468, 237, 122, 102470, 32990]
N: 🔍 [9468, 242, 235]

O: 🧑🏿‍🦳 [9468, 100, 239, 9468, 237, 123, 102470, 9468, 99, 111]
N: 🚂 [9468, 248, 224]

O: 👩🏽‍❤‍💋‍👩🏼 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 120]
N: 😠 [76460, 254]

O: 👨🏽‍🤝‍👨🏼 [9468, 239, 101, 9468, 237, 121, 102470, 9468, 97, 251, 102470, 9468, 239, 101, 9468, 237, 120]
N: 🧑🏿‍🦳 [9468, 100, 239, 9468, 237, 123, 102470, 9468, 99, 111]

O: 🚂 [9468, 248, 224]
N: 🧜🏾‍♀ [9468, 100, 250, 9468, 237, 122, 102470, 32990]

O: ⚱ [158, 248, 109]
N: 👩🏽‍❤‍💋‍👩🏼 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 120]

O: 😠 [76460, 254]
N: 🍂 [9468, 235, 224]

O: 🎮 [9468, 236, 106]
N: 🎮 [9468, 236, 106]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:11,  3.97s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.33s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.62s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.31s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.71s/it]
Processing depth (4, 5, 6, 7):   2%|▏         | 2/100 [01:01<37:09, 22.75s/it]2025-01-22 06:24:58.410 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the office.
2025-01-22 06:24:58.434 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3630, 3636) --> . John went back to the
2025-01-22 06:24:58.434 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the bedroom.
2025-01-22 06:24:58.455 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4178, 4183) --> . John travelled to the
2025-01-22 06:24:58.455 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John put down the milk.
2025-01-22 06:24:58.480 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3352, 3357) -->  Sandra put down the milk
2025-01-22 06:24:58.481 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary journeyed to the office.
2025-01-22 06:24:58.516 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5634, 5640) --> . Mary journeyed to the
2025-01-22 06:24:58.516 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel journeyed to the bedroom.
2025-01-22 06:24:58.524 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1547, 1553) --> . Daniel journeyed to the
2025-01-22 06:24:58.524 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra got the milk there.
2025-01-22 06:24:58.538 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2567, 2572) --> . Sandra got the milk
2025-01-22 06:24:58.538 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the kitchen.
2025-01-22 06:24:58.568 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4097, 4103) --> . Sandra went back to the
2025-01-22 06:24:58.568 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra took the milk.
2025-01-22 06:24:58.580 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2223, 2227) -->  Sandra took the milk
2025-01-22 06:24:58.581 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra put down the milk there.
2025-01-22 06:24:58.600 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3351, 3357) --> . Sandra put down the milk
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:24:59.377 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 06:24:59.378 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8181])
2025-01-22 06:25:01.617 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [478.16477272727275, 53.03951790296957, 499.9537037037037, 50.406196213425126, 55.422425176056336], 'topk_indices': array([8054, 8175, 8030,    1, 2223, 8171, 8180,    4, 8079, 8168, 3636,
         24, 8169, 8069,    9, 8179,   14, 8177,    0, 8176]), 'topk_tokens': ['.', ':', '\n', '<|start_header_id|>', ' Sandra', ' bedroom', '\n\n', '\n\n', ' location', ' milk', ' office', '\n\n', ' before', '.\n\n', ':', '<|end_header_id|>', '\n', '<|start_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [594.7916666666666, 282.675, 464.55, 535.7916666666666]}, 'weight': {'score': [21.78515625, 23.284723283025784, 23.499131944444443, 23.288067448364888, 29.734595070422536], 'topk_indices': array([3307, 3334, 3179, 3227, 7466, 7428, 1445, 1507, 4321, 4337, 5205,
       5144, 7149, 7205, 3497, 3523, 4921, 4969, 4998, 4946]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.0703125, 19.990625, 27.7171875, 20.052083333333332]}, 'saliency': {'score': [2.7134232954545454, 0.29572834759371563, 3.1453269675925926, 0.2797302591264292, 0.41827500034386006], 'topk_indices': array([   9, 5636, 8178, 8165, 4183, 8163,   24,    8, 2226,   14, 4103,
       8174, 8069, 1553, 8079, 8168, 8169, 3636, 8171, 2223]), 'topk_tokens': [':', ' journey', 'assistant', ' Where', ' bedroom', 'Question', '\n\n', ' Date', ' milk', '\n', ' kitchen', 'Answer', '.\n\n', ' bedroom', ' location', ' milk', ' before', ' office', ' bedroom', ' Sandra'], 'evidence_proportions': [3.072265625, 1.50927734375, 3.2166015625, 2.938720703125]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 0}
2025-01-22 06:25:01.623 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:25:01.623 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-92_pid-2_4-5-6-7.pkl | len: 3 |  size: 2.02 KB
Processing depth (4, 5, 6, 7):   3%|▎         | 3/100 [01:04<34:35, 21.40s/it]is_0k: False
your chose emoji: ['👨\u200d💼', '💆\u200d♀', '👨🏽\u200d🔧', '🚵🏽\u200d♀️', '👩\u200d👧\u200d👧', '👙', '🧔🏽\u200d♂️', '🧚🏾\u200d♀️', '🦃', '👩\u200d🍼']
emoji:
O: 👨‍💼 [9468, 239, 101, 102470, 93273, 120]
N: 👨🏽‍🔧 [9468, 239, 101, 9468, 237, 121, 102470, 9468, 242, 100]

O: 💆‍♀ [93273, 228, 102470, 32990]
N: 🧔🏽‍♂️ [9468, 100, 242, 9468, 237, 121, 102470, 17245, 224, 31643]

O: 👨🏽‍🔧 [9468, 239, 101, 9468, 237, 121, 102470, 9468, 242, 100]
N: 🦃 [9468, 99, 225]

O: 🚵🏽‍♀️ [9468, 248, 113, 9468, 237, 121, 102470, 32990, 31643]
N: 🧚🏾‍♀️ [9468, 100, 248, 9468, 237, 122, 102470, 32990, 31643]

O: 👩‍👧‍👧 [9468, 239, 102, 102470, 9468, 239, 100, 102470, 9468, 239, 100]
N: 💆‍♀ [93273, 228, 102470, 32990]

O: 👙 [9468, 239, 247]
N: 👙 [9468, 239, 247]

O: 🧔🏽‍♂️ [9468, 100, 242, 9468, 237, 121, 102470, 17245, 224, 31643]
N: 👩‍👧‍👧 [9468, 239, 102, 102470, 9468, 239, 100, 102470, 9468, 239, 100]

O: 🧚🏾‍♀️ [9468, 100, 248, 9468, 237, 122, 102470, 32990, 31643]
N: 🚵🏽‍♀️ [9468, 248, 113, 9468, 237, 121, 102470, 32990, 31643]

O: 🦃 [9468, 99, 225]
N: 👨‍💼 [9468, 239, 101, 102470, 93273, 120]

O: 👩‍🍼 [9468, 239, 102, 102470, 9468, 104247]
N: 👩‍🍼 [9468, 239, 102, 102470, 9468, 104247]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.42s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.42s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.32s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.02s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.52s/it]
Processing depth (5, 6, 7, 8):   3%|▎         | 3/100 [01:20<34:35, 21.40s/it]2025-01-22 06:25:17.524 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the office.
2025-01-22 06:25:17.548 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4145, 4151) --> . John went back to the
2025-01-22 06:25:17.548 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the bedroom.
2025-01-22 06:25:17.571 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4648, 4653) --> . John travelled to the
2025-01-22 06:25:17.572 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John put down the milk.
2025-01-22 06:25:17.589 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3526, 3531) -->  Sandra put down the milk
2025-01-22 06:25:17.589 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary journeyed to the office.
2025-01-22 06:25:17.626 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6558, 6564) --> . Mary journeyed to the
2025-01-22 06:25:17.627 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel journeyed to the bedroom.
2025-01-22 06:25:17.640 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1719, 1725) --> . Daniel journeyed to the
2025-01-22 06:25:17.640 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra got the milk there.
2025-01-22 06:25:17.656 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2803, 2808) --> . Sandra got the milk
2025-01-22 06:25:17.656 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the kitchen.
2025-01-22 06:25:17.677 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4058, 4064) --> . Sandra went back to the
2025-01-22 06:25:17.677 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra took the milk.
2025-01-22 06:25:17.689 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2479, 2483) -->  Sandra took the milk
2025-01-22 06:25:17.689 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra put down the milk there.
2025-01-22 06:25:17.708 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3525, 3531) --> . Sandra put down the milk
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:25:18.485 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 06:25:18.485 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8191])
2025-01-22 06:25:20.735 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [433.5511363636364, 51.41091861955328, 479.9074074074074, 48.95800973109037, 52.91154399671053], 'topk_indices': array([   1,   23, 8040, 8089, 8182, 8181, 2483, 8045,    4, 8178, 2479,
         24, 8179, 8079, 8189,    9,   14, 8186, 8187,    0]), 'topk_tokens': ['<|start_header_id|>', '4', '\n', ' location', '?', ' bedroom', '.', ' context', '\n\n', ' milk', ' Sandra', '\n\n', ' before', '.\n\n', '<|end_header_id|>', ':', '\n', '<|eot_id|>', '<|start_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [338.6875, 297.0, 452.95, 626.0416666666666]}, 'weight': {'score': [21.78515625, 23.293415491883316, 23.499131944444443, 23.296807849336936, 29.77549342105263], 'topk_indices': array([3288, 3261, 3181, 3133, 7466, 7428, 1479, 1417, 4317, 4333, 5213,
       5152, 7149, 7205, 3444, 3470, 5006, 4977, 4929, 4954]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.0703125, 19.990625, 27.7171875, 20.052083333333332]}, 'saliency': {'score': [2.424649325284091, 0.28579572977694373, 3.030255353009259, 0.2709191103112721, 0.39410038998252467], 'topk_indices': array([8173, 8043, 8182, 6560,    9, 1725, 8175,   24, 4064, 2482,    8,
         14, 8184, 8089, 8079, 8045, 8179, 8178, 8181, 2479]), 'topk_tokens': ['Question', ' provided', '?', ' journey', ':', ' bedroom', ' Where', '\n\n', ' kitchen', ' milk', ' Date', '\n', 'Answer', ' location', '.\n\n', ' context', ' before', ' milk', ' bedroom', ' Sandra'], 'evidence_proportions': [1.6675618489583333, 1.574609375, 3.065234375, 3.3562825520833335]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 0}
2025-01-22 06:25:20.740 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:25:20.740 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-92_pid-3_5-6-7-8.pkl | len: 3 |  size: 2.01 KB
Processing depth (5, 6, 7, 8):   4%|▍         | 4/100 [01:23<32:47, 20.50s/it]is_0k: False
your chose emoji: ['🧏🏿\u200d♂', '🥂', '🧑🏿\u200d❤️\u200d💋\u200d🧑🏽', '🙎🏾\u200d♂', '🧑🏼\u200d⚕', '✴️', '🚣🏻\u200d♀️', '🌾', '👚', '👱🏽\u200d♀']
emoji:
O: 🧏🏿‍♂ [9468, 100, 237, 9468, 237, 123, 102470, 17245, 224]
N: 🚣🏻‍♀️ [9468, 248, 96, 9468, 237, 119, 102470, 32990, 31643]

O: 🥂 [9468, 98, 224]
N: 🧑🏼‍⚕ [9468, 100, 239, 9468, 237, 120, 102470, 158, 248, 243]

O: 🧑🏿‍❤️‍💋‍🧑🏽 [9468, 100, 239, 9468, 237, 123, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 100, 239, 9468, 237, 121]
N: 🌾 [9468, 234, 122]

O: 🙎🏾‍♂ [9468, 247, 236, 9468, 237, 122, 102470, 17245, 224]
N: 👚 [9468, 239, 248]

O: 🧑🏼‍⚕ [9468, 100, 239, 9468, 237, 120, 102470, 158, 248, 243]
N: ✴️ [38798, 112, 31643]

O: ✴️ [38798, 112, 31643]
N: 🙎🏾‍♂ [9468, 247, 236, 9468, 237, 122, 102470, 17245, 224]

O: 🚣🏻‍♀️ [9468, 248, 96, 9468, 237, 119, 102470, 32990, 31643]
N: 🧏🏿‍♂ [9468, 100, 237, 9468, 237, 123, 102470, 17245, 224]

O: 🌾 [9468, 234, 122]
N: 🧑🏿‍❤️‍💋‍🧑🏽 [9468, 100, 239, 9468, 237, 123, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 100, 239, 9468, 237, 121]

O: 👚 [9468, 239, 248]
N: 🥂 [9468, 98, 224]

O: 👱🏽‍♀ [9468, 239, 109, 9468, 237, 121, 102470, 32990]
N: 👱🏽‍♀ [9468, 239, 109, 9468, 237, 121, 102470, 32990]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.79s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.83s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.21s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.74s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.40s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 3, 4, 8):   4%|▍         | 4/100 [01:39<32:47, 20.50s/it]2025-01-22 06:25:36.203 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the office.
2025-01-22 06:25:36.204 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 37) -->  went back to the office.
2025-01-22 06:25:36.204 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John travelled to the bedroom.
2025-01-22 06:25:36.219 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2940, 2945) --> . John travelled to the
2025-01-22 06:25:36.219 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John put down the milk.
2025-01-22 06:25:36.236 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3465, 3470) -->  Sandra put down the milk
2025-01-22 06:25:36.237 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary journeyed to the office.
2025-01-22 06:25:36.271 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6631, 6637) -->  Mary journeyed to the office
2025-01-22 06:25:36.271 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel journeyed to the bedroom.
2025-01-22 06:25:36.280 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1720, 1726) --> . Daniel journeyed to the
2025-01-22 06:25:36.280 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra got the milk there.
2025-01-22 06:25:36.293 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2703, 2708) -->  Sandra got the milk there
2025-01-22 06:25:36.293 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the kitchen.
2025-01-22 06:25:36.314 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4101, 4107) --> . Sandra went back to the
2025-01-22 06:25:36.314 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra took the milk.
2025-01-22 06:25:36.327 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (2480, 2484) -->  Sandra took the milk
2025-01-22 06:25:36.327 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra put down the milk there.
2025-01-22 06:25:36.344 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (3464, 3470) --> . Sandra put down the milk
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:25:40.967 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 06:25:40.967 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8157])
2025-01-22 06:25:44.455 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [458.91477272727275, 47.796578165216324, 453.3703703703704, 45.331092016029594, 78.76867055084746], 'topk_indices': array([2707, 6085, 8055,    4, 8144, 6636, 8147,   23, 8145, 2484, 8153,
       8156, 8045,    9,    1,   24,   14, 8155, 8152,    0]), 'topk_tokens': [' there', 'the', ' location', '\n\n', ' milk', ' office', ' bedroom', '4', ' before', '.', '<|start_header_id|>', '\n\n', '.\n\n', ':', '<|start_header_id|>', '\n\n', '\n', '<|end_header_id|>', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [457.625, 316.175, 478.55, 562.7916666666666]}, 'weight': {'score': [22.732244318181817, 23.260385387302364, 24.063078703703702, 23.259145730579533, 29.344279661016948], 'topk_indices': array([3325, 3298, 3170, 3218, 7444, 7406, 1418, 1480, 4335, 4319, 5130,
       5191, 7123, 7179, 3488, 3514, 4955, 4984, 4932, 4907]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.197916666666668, 19.990625, 27.7171875, 23.397135416666668]}, 'saliency': {'score': [2.7301136363636362, 0.26867533647659025, 2.831271701388889, 0.2534667366676942, 0.5950803595074152], 'topk_indices': array([8045, 2707, 6085, 4000, 8011, 2760, 6632, 8150, 2945, 2483, 2901,
       8055, 8145, 4107, 2480, 6636, 8144, 1726,   24, 8147]), 'topk_tokens': ['.\n\n', ' there', 'the', ' papers', ' context', ' kids', ' journey', 'Answer', ' bedroom', ' milk', ' lyn', ' location', ' before', ' kitchen', ' Sandra', ' office', ' milk', ' bedroom', '\n\n', ' bedroom'], 'evidence_proportions': [2.36376953125, 1.7013671875, 3.2265625, 3.5400390625]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 0}
2025-01-22 06:25:44.465 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:25:44.465 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-92_pid-4_0-3-4-8.pkl | len: 3 |  size: 2.03 KB
Processing depth (0, 3, 4, 8):   5%|▌         | 5/100 [01:47<34:17, 21.66s/it]Processing depth (0, 3, 4, 8):   5%|▌         | 5/100 [01:47<34:07, 21.56s/it]
2025-01-22 06:25:44.549 | INFO     | __main__:<module>:82 - Selected idx: 93
2025-01-22 06:25:44.550 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the location prior to the place where the apple was discarded, left or dropped?
2025-01-22 06:25:44.550 | INFO     | __main__:<module>:84 - Answer: office
2025-01-22 06:25:44.550 | INFO     | __main__:<module>:85 - Tag: 4-hop
2025-01-22 06:25:44.550 | INFO     | __main__:<module>:86 - Needle: [' Sandra took the milk.', ' John went back to the office.', ' John took the apple.', ' Daniel journeyed to the bedroom.', ' Sandra went back to the kitchen.', ' Sandra got the milk there.', ' John travelled to the bedroom.', ' Sandra put down the milk there.', ' John put down the apple.', ' Mary journeyed to the office.']
2025-01-22 06:25:44.550 | INFO     | __main__:<module>:87 - Real Needle: [' John went back to the office.', ' John took the apple.', ' John travelled to the bedroom.', ' John put down the apple.', ' Mary journeyed to the office.']
2025-01-22 06:25:44.550 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['🙌🏾', '👈🏿', '💄', '➡', '👨🏽\u200d🦯\u200d➡️', '🚶🏾\u200d➡', '🤦🏻\u200d♂', '🧑\u200d✈', '💅', '🥎']
emoji:
O: 🙌🏾 [9468, 247, 234, 9468, 237, 122]
N: 👈🏿 [9468, 239, 230, 9468, 237, 123]

O: 👈🏿 [9468, 239, 230, 9468, 237, 123]
N: 🧑‍✈ [9468, 100, 239, 102470, 38798, 230]

O: 💄 [93273, 226]
N: 🚶🏾‍➡ [9468, 248, 114, 9468, 237, 122, 102470, 98115, 94]

O: ➡ [98115, 94]
N: 💅 [93273, 227]

O: 👨🏽‍🦯‍➡️ [9468, 239, 101, 9468, 237, 121, 102470, 9468, 99, 107, 102470, 98115, 94, 31643]
N: 🤦🏻‍♂ [9468, 97, 99, 9468, 237, 119, 102470, 17245, 224]

O: 🚶🏾‍➡ [9468, 248, 114, 9468, 237, 122, 102470, 98115, 94]
N: 🙌🏾 [9468, 247, 234, 9468, 237, 122]

O: 🤦🏻‍♂ [9468, 97, 99, 9468, 237, 119, 102470, 17245, 224]
N: 👨🏽‍🦯‍➡️ [9468, 239, 101, 9468, 237, 121, 102470, 9468, 99, 107, 102470, 98115, 94, 31643]

O: 🧑‍✈ [9468, 100, 239, 102470, 38798, 230]
N: 💄 [93273, 226]

O: 💅 [93273, 227]
N: ➡ [98115, 94]

O: 🥎 [9468, 98, 236]
N: 🥎 [9468, 98, 236]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.91s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.78s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.51s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.16s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.72s/it]
Processing depth (0, 1, 5, 7, 9):   0%|          | 0/100 [00:16<?, ?it/s]2025-01-22 06:26:01.259 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the office.
2025-01-22 06:26:01.259 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 37) -->  went back to the office.
2025-01-22 06:26:01.259 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John took the apple.
2025-01-22 06:26:01.264 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (797, 801) -->  John took the apple
2025-01-22 06:26:01.264 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the bedroom.
2025-01-22 06:26:01.287 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4128, 4133) --> . John travelled to the
2025-01-22 06:26:01.288 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John put down the apple.
2025-01-22 06:26:01.322 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5619, 5624) --> . John put down the
2025-01-22 06:26:01.322 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary journeyed to the office.
2025-01-22 06:26:01.363 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7162, 7168) -->  Mary journeyed to the office
2025-01-22 06:26:01.363 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra took the milk.
2025-01-22 06:26:01.381 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3820, 3824) -->  Sandra took the milk
2025-01-22 06:26:01.382 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the bedroom.
2025-01-22 06:26:01.405 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4253, 4259) -->  Daniel journeyed to the bedroom
2025-01-22 06:26:01.406 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the kitchen.
2025-01-22 06:26:01.430 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4474, 4480) -->  execution. Sandra went back to
2025-01-22 06:26:01.431 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra got the milk there.
2025-01-22 06:26:01.445 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3021, 3026) --> . Sandra got the milk
2025-01-22 06:26:01.445 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra put down the milk there.
2025-01-22 06:26:01.474 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5238, 5244) --> . Sandra put down the milk
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:26:02.295 | INFO     | test_jbb_embedding:begin_test:693 - John's hand.<|eot_id|>
2025-01-22 06:26:02.295 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8215])
2025-01-22 06:26:04.571 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [422.8629807692308, 53.6693136181088, 174.76388888888889, 52.093053343949045, 30.49635898919753], 'topk_indices': array([  29,   38, 7357,  587, 8189,  378,  448, 7405,  449,  350,  558,
       7328,   65,   35,   24,   14, 7406, 8210,    0, 8211]), 'topk_tokens': ['\n\n', 'UL', 'nes', ' em', ':', ' past', ' em', ' Min', 's', ' century', ',', 'nes', 'ENCES', ' office', '\n\n', '\n', 'nes', '<|eot_id|>', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [932.5833333333334, 618.75, 203.875, 283.75, 80.96875]}, 'weight': {'score': [21.834134615384617, 23.295397499087258, 25.32957175925926, 23.29332377664135, 29.58005401234568], 'topk_indices': array([3330, 3303, 3175, 3223, 7491, 7453, 1515, 1453, 4342, 4326, 5205,
       5144, 7174, 7230, 3486, 3512, 4921, 4946, 4969, 4998]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.197916666666668, 25.283203125, 19.990625, 21.00625, 23.397135416666668]}, 'saliency': {'score': [2.3922870342548075, 0.2987140025537757, 1.1116717303240742, 0.28935795680732485, 0.22786194601176699], 'topk_indices': array([8104,   31,   24, 8202,   38,  802,  349,   39,  587,  800, 7357,
        448,  378, 8188, 7405,  350,   35, 7328,   65, 7406]), 'topk_tokens': [' location', ' went', '\n\n', ' discarded', 'UL', '�', ' past', '***', ' em', ' apple', 'nes', ' em', ' past', 'Question', ' Min', ' century', ' office', 'nes', 'ENCES', 'nes'], 'evidence_proportions': [5.045247395833333, 4.01416015625, 1.07958984375, 1.49169921875, 0.5024820963541666]}}, 'pred_res': "John's hand.<|eot_id|>", 'score': 0}
2025-01-22 06:26:04.594 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:26:04.595 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-93_pid-0_0-1-5-7-9.pkl | len: 3 |  size: 2.02 KB
Processing depth (0, 1, 5, 7, 9):   1%|          | 1/100 [00:19<32:55, 19.95s/it]is_0k: False
your chose emoji: ['🏄🏻\u200d♂️', '👨🏻\u200d❤\u200d💋\u200d👨🏿', '🍪', '🧙\u200d♀️', '🚶🏼\u200d♂', '👨🏾\u200d🦽\u200d➡️', '👨🏽\u200d🦳', '👼', '♟', '🧍🏻']
emoji:
O: 🏄🏻‍♂️ [9468, 237, 226, 9468, 237, 119, 102470, 17245, 224, 31643]
N: 🚶🏼‍♂ [9468, 248, 114, 9468, 237, 120, 102470, 17245, 224]

O: 👨🏻‍❤‍💋‍👨🏿 [9468, 239, 101, 9468, 237, 119, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 123]
N: 👨🏽‍🦳 [9468, 239, 101, 9468, 237, 121, 102470, 9468, 99, 111]

O: 🍪 [9468, 235, 103]
N: ♟ [17245, 253]

O: 🧙‍♀️ [9468, 100, 247, 102470, 32990, 31643]
N: 👼 [9468, 239, 120]

O: 🚶🏼‍♂ [9468, 248, 114, 9468, 237, 120, 102470, 17245, 224]
N: 🧙‍♀️ [9468, 100, 247, 102470, 32990, 31643]

O: 👨🏾‍🦽‍➡️ [9468, 239, 101, 9468, 237, 122, 102470, 9468, 99, 121, 102470, 98115, 94, 31643]
N: 🍪 [9468, 235, 103]

O: 👨🏽‍🦳 [9468, 239, 101, 9468, 237, 121, 102470, 9468, 99, 111]
N: 🏄🏻‍♂️ [9468, 237, 226, 9468, 237, 119, 102470, 17245, 224, 31643]

O: 👼 [9468, 239, 120]
N: 👨🏾‍🦽‍➡️ [9468, 239, 101, 9468, 237, 122, 102470, 9468, 99, 121, 102470, 98115, 94, 31643]

O: ♟ [17245, 253]
N: 👨🏻‍❤‍💋‍👨🏿 [9468, 239, 101, 9468, 237, 119, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 123]

O: 🧍🏻 [9468, 100, 235, 9468, 237, 119]
N: 🧍🏻 [9468, 100, 235, 9468, 237, 119]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.25s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.68s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.17s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.68s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.30s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 2, 4, 5, 9):   1%|          | 1/100 [00:35<32:55, 19.95s/it]2025-01-22 06:26:19.733 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the office.
2025-01-22 06:26:19.733 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 37) -->  went back to the office.
2025-01-22 06:26:19.734 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John took the apple.
2025-01-22 06:26:19.743 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1860, 1864) -->  took the apple.
2025-01-22 06:26:19.743 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the bedroom.
2025-01-22 06:26:19.760 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3613, 3618) --> . John travelled to the
2025-01-22 06:26:19.761 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John put down the apple.
2025-01-22 06:26:19.781 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4217, 4222) -->  John put down the apple
2025-01-22 06:26:19.781 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary journeyed to the office.
2025-01-22 06:26:19.818 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7292, 7298) -->  cold. Mary journeyed to
2025-01-22 06:26:19.818 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra took the milk.
2025-01-22 06:26:19.837 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3874, 3878) -->  Sandra took the milk
2025-01-22 06:26:19.837 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the bedroom.
2025-01-22 06:26:19.859 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4320, 4326) --> . Daniel journeyed to the
2025-01-22 06:26:19.859 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the kitchen.
2025-01-22 06:26:19.882 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4578, 4584) -->  Sandra went back to the kitchen
2025-01-22 06:26:19.882 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra got the milk there.
2025-01-22 06:26:19.898 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3097, 3102) --> . Sandra got the milk
2025-01-22 06:26:19.898 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra put down the milk there.
2025-01-22 06:26:19.925 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5372, 5378) --> . Sandra put down the milk
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:26:22.811 | INFO     | test_jbb_embedding:begin_test:693 - the bedroom<|eot_id|>
2025-01-22 06:26:22.812 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8209])
2025-01-22 06:26:26.079 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [1169.826923076923, 115.89938040433564, 340.77777777777777, 111.79618932336356, 98.98187099358974], 'topk_indices': array([7546, 1862,   14,   35,   36,   31, 7591,   68,  106, 7547,   69,
       6551, 1863, 7668, 7592, 8204, 7593, 7548,    0, 8205]), 'topk_tokens': [' the', ' apple', '\n', ' office', '.', ' went', ' the', 'ION', 'ION', ' Min', 'E', ' enterprise', '.', ' or', ' Min', '<|eot_id|>', 'nes', 'nes', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [1829.6666666666667, 2081.5, 850.9, 1036.4, 279.1666666666667]}, 'weight': {'score': [21.978966346153847, 23.290856016319573, 24.38599537037037, 23.29141257048296, 29.582732371794872], 'topk_indices': array([3297, 3324, 3169, 3217, 7453, 7415, 1406, 1468, 4293, 4309, 5227,
       5166, 7175, 7119, 3480, 3506, 4950, 4925, 5002, 4973]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.197916666666668, 20.45703125, 19.990625, 25.6140625, 23.40234375]}, 'saliency': {'score': [6.354839618389423, 0.654952376670777, 2.113887080439815, 0.6319579778859709, 0.7563069661458334], 'topk_indices': array([3618,   39, 7667, 1843, 7624,   38, 7659, 7368,   69,   35,  106,
         68,   31, 1862, 7547, 6551, 7668, 7592, 7593, 7548]), 'topk_tokens': [' bedroom', '***', ' two', '�', ' three', 'UL', ' tele', 'nes', 'E', ' office', 'ION', 'ION', ' went', ' apple', ' Min', ' enterprise', ' or', ' Min', 'nes', 'nes'], 'evidence_proportions': [9.68359375, 10.2919921875, 4.609765625, 6.733203125, 1.5402425130208333]}}, 'pred_res': 'the bedroom<|eot_id|>', 'score': 0}
2025-01-22 06:26:26.085 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:26:26.085 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-93_pid-1_0-2-4-5-9.pkl | len: 3 |  size: 2.01 KB
Processing depth (0, 2, 4, 5, 9):   2%|▏         | 2/100 [00:41<34:04, 20.86s/it]is_0k: False
your chose emoji: ['💇🏿\u200d♀', '🕒', '🚴🏼\u200d♀', '👉🏽', '🚴🏿\u200d♀️', '🧑🏻\u200d❤\u200d🧑🏼', '🚶🏿\u200d➡', '🏌🏻\u200d♂️', '🇼🇸', '🤹🏻']
emoji:
O: 💇🏿‍♀ [93273, 229, 9468, 237, 123, 102470, 32990]
N: 🚴🏼‍♀ [9468, 248, 112, 9468, 237, 120, 102470, 32990]

O: 🕒 [9468, 243, 240]
N: 🚴🏿‍♀️ [9468, 248, 112, 9468, 237, 123, 102470, 32990, 31643]

O: 🚴🏼‍♀ [9468, 248, 112, 9468, 237, 120, 102470, 32990]
N: 💇🏿‍♀ [93273, 229, 9468, 237, 123, 102470, 32990]

O: 👉🏽 [9468, 239, 231, 9468, 237, 121]
N: 🕒 [9468, 243, 240]

O: 🚴🏿‍♀️ [9468, 248, 112, 9468, 237, 123, 102470, 32990, 31643]
N: 🧑🏻‍❤‍🧑🏼 [9468, 100, 239, 9468, 237, 119, 102470, 121643, 102470, 9468, 100, 239, 9468, 237, 120]

O: 🧑🏻‍❤‍🧑🏼 [9468, 100, 239, 9468, 237, 119, 102470, 121643, 102470, 9468, 100, 239, 9468, 237, 120]
N: 🚶🏿‍➡ [9468, 248, 114, 9468, 237, 123, 102470, 98115, 94]

O: 🚶🏿‍➡ [9468, 248, 114, 9468, 237, 123, 102470, 98115, 94]
N: 🇼🇸 [9468, 110771, 9468, 229, 116]

O: 🏌🏻‍♂️ [9468, 237, 234, 9468, 237, 119, 102470, 17245, 224, 31643]
N: 👉🏽 [9468, 239, 231, 9468, 237, 121]

O: 🇼🇸 [9468, 110771, 9468, 229, 116]
N: 🏌🏻‍♂️ [9468, 237, 234, 9468, 237, 119, 102470, 17245, 224, 31643]

O: 🤹🏻 [9468, 97, 117, 9468, 237, 119]
N: 🤹🏻 [9468, 97, 117, 9468, 237, 119]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:05<00:16,  5.38s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:10<00:10,  5.36s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:15<00:05,  5.02s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:16<00:00,  3.41s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:16<00:00,  4.07s/it]
Processing depth (0, 4, 5, 6, 9):   2%|▏         | 2/100 [00:59<34:04, 20.86s/it]2025-01-22 06:26:44.152 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the office.
2025-01-22 06:26:44.153 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 37) -->  went back to the office.
2025-01-22 06:26:44.153 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John took the apple.
2025-01-22 06:26:44.170 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3639, 3643) -->  John took the apple
2025-01-22 06:26:44.170 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the bedroom.
2025-01-22 06:26:44.191 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4243, 4248) -->  John travelled to the bedroom
2025-01-22 06:26:44.191 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John put down the apple.
2025-01-22 06:26:44.219 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4880, 4885) --> . John put down the
2025-01-22 06:26:44.219 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary journeyed to the office.
2025-01-22 06:26:44.255 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7239, 7245) --> . Mary journeyed to the
2025-01-22 06:26:44.255 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra took the milk.
2025-01-22 06:26:44.276 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3902, 3906) -->  Sandra took the milk
2025-01-22 06:26:44.276 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the bedroom.
2025-01-22 06:26:44.299 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4326, 4332) --> . Daniel journeyed to the
2025-01-22 06:26:44.299 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the kitchen.
2025-01-22 06:26:44.324 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4580, 4586) -->  Sandra went back to the kitchen
2025-01-22 06:26:44.324 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra got the milk there.
2025-01-22 06:26:44.342 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3204, 3209) --> . Sandra got the milk
2025-01-22 06:26:44.342 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra put down the milk there.
2025-01-22 06:26:44.368 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5346, 5352) --> . Sandra put down the milk
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:26:45.136 | INFO     | test_jbb_embedding:begin_test:693 - bedroom<|eot_id|>
2025-01-22 06:26:45.137 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8187])
2025-01-22 06:26:47.371 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [326.8557692307692, 28.714939629380876, 113.94444444444444, 27.479337589110127, 16.15636660447761], 'topk_indices': array([3643,    9, 8174, 8166, 8076, 8167, 8066,  264, 4244,   68,  106,
          1,   69,   14, 8185,   24, 8182, 4247,    0, 8183]), 'topk_tokens': ['.', ':', ' discarded', ' prior', ' location', ' to', '.\n\n', 'hue', ' travelled', 'ION', 'ION', '<|start_header_id|>', 'E', '\n', '<|end_header_id|>', '\n\n', '<|eot_id|>', ' bedroom', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [238.72916666666666, 381.5, 622.6, 298.9, 155.39583333333334]}, 'weight': {'score': [22.10576923076923, 23.270400842593723, 24.38599537037037, 23.270420430801376, 29.365671641791046], 'topk_indices': array([3270, 3297, 3184, 3136, 7431, 7469, 1418, 1480, 4299, 4315, 5201,
       5140, 7133, 7189, 3479, 3453, 4913, 4990, 4938, 4961]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.197916666666668, 25.283203125, 25.4171875, 21.00625, 20.052083333333332]}, 'saliency': {'score': [2.028132512019231, 0.15917330746657102, 0.7083808051215278, 0.1513781327179165, 0.12117368783523787], 'topk_indices': array([   0,   67, 8165, 8066, 1227,   16, 8032, 8172,   69, 3642, 4885,
        106,   68, 8076, 8166,   24,  264, 8174, 4244, 4247]), 'topk_tokens': ['<|begin_of_text|>', ' P', ' location', '.\n\n', 'nes', ' Date', ' context', ' apple', 'E', ' apple', ' apple', 'ION', 'ION', ' location', ' prior', '\n\n', 'hue', ' discarded', ' travelled', ' bedroom'], 'evidence_proportions': [1.2652994791666667, 2.5469970703125, 4.4365234375, 1.56904296875, 0.8206380208333334]}}, 'pred_res': 'bedroom<|eot_id|>', 'score': 0}
2025-01-22 06:26:47.378 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:26:47.378 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-93_pid-2_0-4-5-6-9.pkl | len: 3 |  size: 2.08 KB
Processing depth (0, 4, 5, 6, 9):   3%|▎         | 3/100 [01:02<34:02, 21.06s/it]is_0k: False
your chose emoji: ['🦂', '🚇', '🧑🏼\u200d⚖', '👩🏿\u200d🎓', '👨🏻\u200d🎤', '⛹️\u200d♀', '❣', '👨🏽\u200d❤\u200d👨🏻', '👼🏿', '📳']
emoji:
O: 🦂 [9468, 25451]
N: ⛹️‍♀ [158, 249, 117, 31643, 102470, 32990]

O: 🚇 [9468, 248, 229]
N: 👨🏻‍🎤 [9468, 239, 101, 9468, 237, 119, 102470, 9468, 236, 97]

O: 🧑🏼‍⚖ [9468, 100, 239, 9468, 237, 120, 102470, 158, 248, 244]
N: 👨🏽‍❤‍👨🏻 [9468, 239, 101, 9468, 237, 121, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 119]

O: 👩🏿‍🎓 [9468, 239, 102, 9468, 237, 123, 102470, 9468, 236, 241]
N: ❣ [49633, 96]

O: 👨🏻‍🎤 [9468, 239, 101, 9468, 237, 119, 102470, 9468, 236, 97]
N: 🚇 [9468, 248, 229]

O: ⛹️‍♀ [158, 249, 117, 31643, 102470, 32990]
N: 🦂 [9468, 25451]

O: ❣ [49633, 96]
N: 🧑🏼‍⚖ [9468, 100, 239, 9468, 237, 120, 102470, 158, 248, 244]

O: 👨🏽‍❤‍👨🏻 [9468, 239, 101, 9468, 237, 121, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 119]
N: 👩🏿‍🎓 [9468, 239, 102, 9468, 237, 123, 102470, 9468, 236, 241]

O: 👼🏿 [9468, 239, 120, 9468, 237, 123]
N: 👼🏿 [9468, 239, 120, 9468, 237, 123]

O: 📳 [9468, 241, 111]
N: 📳 [9468, 241, 111]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.23s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.74s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.66s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.02s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.60s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (2, 4, 6, 7, 9):   3%|▎         | 3/100 [01:18<34:02, 21.06s/it]2025-01-22 06:27:03.503 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the office.
2025-01-22 06:27:03.513 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1757, 1763) --> . John went back to the
2025-01-22 06:27:03.513 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John took the apple.
2025-01-22 06:27:03.532 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3633, 3637) -->  John took the apple
2025-01-22 06:27:03.532 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the bedroom.
2025-01-22 06:27:03.558 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4914, 4919) --> . John travelled to the
2025-01-22 06:27:03.558 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John put down the apple.
2025-01-22 06:27:03.592 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5771, 5776) --> . John put down the
2025-01-22 06:27:03.592 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary journeyed to the office.
2025-01-22 06:27:03.628 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (7297, 7303) --> . Mary journeyed to the
2025-01-22 06:27:03.629 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra took the milk.
2025-01-22 06:27:03.651 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3896, 3900) -->  Sandra took the milk
2025-01-22 06:27:03.651 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the bedroom.
2025-01-22 06:27:03.674 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4360, 4366) --> . Daniel journeyed to the
2025-01-22 06:27:03.674 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the kitchen.
2025-01-22 06:27:03.698 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4603, 4609) --> . Sandra went back to the
2025-01-22 06:27:03.698 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra got the milk there.
2025-01-22 06:27:03.715 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3132, 3137) --> . Sandra got the milk
2025-01-22 06:27:03.715 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra put down the milk there.
2025-01-22 06:27:03.745 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5582, 5588) --> . Sandra put down the milk
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:27:06.094 | INFO     | test_jbb_embedding:begin_test:693 - the bedroom<|eot_id|>
2025-01-22 06:27:06.094 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8243])
2025-01-22 06:27:08.846 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [296.09134615384613, 33.65314963614312, 173.79166666666666, 32.358333587646484, 20.16064967105263], 'topk_indices': array([8207, 8237,    9, 8224,    1, 8122, 8217, 8222,   23, 5771,    3,
       8132,   14, 5772, 8241, 8223,   24,    0, 8238, 8239]), 'topk_tokens': ['.', ':', ':', ' the', '<|start_header_id|>', '.\n\n', ':', ' prior', '4', '.', '<|end_header_id|>', ' location', '\n', ' John', '<|end_header_id|>', ' to', '\n\n', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [152.54166666666666, 291.6875, 245.35, 577.25, 250.5625]}, 'weight': {'score': [21.032752403846153, 23.324139630078836, 23.499131944444443, 23.330835342407227, 29.91315789473684], 'topk_indices': array([3294, 3321, 3166, 3214, 7477, 7515, 1513, 1451, 4299, 4283, 5175,
       5114, 7247, 7191, 3503, 3477, 4939, 4968, 4885, 4910]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.0703125, 25.283203125, 19.990625, 21.00625, 20.052083333333332]}, 'saliency': {'score': [1.6610295222355769, 0.18199724205484386, 1.0140697337962963, 0.17456062138080597, 0.14915562679893093], 'topk_indices': array([8223, 8240,   20, 8236, 8122,   16, 7578,    0,   23, 5770, 7622,
       7623, 8088, 8230, 4919, 8216,   24, 8132, 5772, 8222]), 'topk_tokens': [' to', 'assistant', ' Jul', 'Answer', '.\n\n', ' Date', 'nes', '<|begin_of_text|>', '4', ' St', ' Min', 'nes', ' context', ' discarded', ' bedroom', 'Question', '\n\n', ' location', ' John', ' prior'], 'evidence_proportions': [0.8036702473958334, 1.8927001953125, 1.39287109375, 3.1728515625, 1.3275553385416667]}}, 'pred_res': 'the bedroom<|eot_id|>', 'score': 0}
2025-01-22 06:27:08.852 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:27:08.852 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-93_pid-3_2-4-6-7-9.pkl | len: 3 |  size: 2.07 KB
Processing depth (2, 4, 6, 7, 9):   4%|▍         | 4/100 [01:24<33:57, 21.22s/it]is_0k: False
your chose emoji: ['☑', '☔', '🧑🏻\u200d❤\u200d💋\u200d🧑🏽', '🏟', '👩🏽\u200d❤️\u200d💋\u200d👩🏾', '🧛🏼\u200d♂', '🧑🏻\u200d❤️\u200d💋\u200d🧑🏾', '🤦🏽\u200d♀', '🧙🏾\u200d♂', '🦻🏾']
emoji:
O: ☑ [18107, 239]
N: 🤦🏽‍♀ [9468, 97, 99, 9468, 237, 121, 102470, 32990]

O: ☔ [18107, 242]
N: 🧑🏻‍❤‍💋‍🧑🏽 [9468, 100, 239, 9468, 237, 119, 102470, 121643, 102470, 93273, 233, 102470, 9468, 100, 239, 9468, 237, 121]

O: 🧑🏻‍❤‍💋‍🧑🏽 [9468, 100, 239, 9468, 237, 119, 102470, 121643, 102470, 93273, 233, 102470, 9468, 100, 239, 9468, 237, 121]
N: ☑ [18107, 239]

O: 🏟 [9468, 237, 253]
N: 🧑🏻‍❤️‍💋‍🧑🏾 [9468, 100, 239, 9468, 237, 119, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 100, 239, 9468, 237, 122]

O: 👩🏽‍❤️‍💋‍👩🏾 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 122]
N: 🏟 [9468, 237, 253]

O: 🧛🏼‍♂ [9468, 100, 249, 9468, 237, 120, 102470, 17245, 224]
N: 👩🏽‍❤️‍💋‍👩🏾 [9468, 239, 102, 9468, 237, 121, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 122]

O: 🧑🏻‍❤️‍💋‍🧑🏾 [9468, 100, 239, 9468, 237, 119, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 100, 239, 9468, 237, 122]
N: 🧙🏾‍♂ [9468, 100, 247, 9468, 237, 122, 102470, 17245, 224]

O: 🤦🏽‍♀ [9468, 97, 99, 9468, 237, 121, 102470, 32990]
N: 🧛🏼‍♂ [9468, 100, 249, 9468, 237, 120, 102470, 17245, 224]

O: 🧙🏾‍♂ [9468, 100, 247, 9468, 237, 122, 102470, 17245, 224]
N: ☔ [18107, 242]

O: 🦻🏾 [9468, 99, 119, 9468, 237, 122]
N: 🦻🏾 [9468, 99, 119, 9468, 237, 122]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.28s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.56s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.53s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.26s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.71s/it]
Processing depth (0, 1, 3, 5, 8):   4%|▍         | 4/100 [01:40<33:57, 21.22s/it]2025-01-22 06:27:25.517 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the office.
2025-01-22 06:27:25.518 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 37) -->  went back to the office.
2025-01-22 06:27:25.518 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  John took the apple.
2025-01-22 06:27:25.522 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (837, 841) -->  John took the apple
2025-01-22 06:27:25.523 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John travelled to the bedroom.
2025-01-22 06:27:25.537 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2887, 2892) --> . John travelled to the
2025-01-22 06:27:25.537 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  John put down the apple.
2025-01-22 06:27:25.563 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4209, 4214) -->  John put down the apple
2025-01-22 06:27:25.563 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary journeyed to the office.
2025-01-22 06:27:25.601 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6549, 6555) --> . Mary journeyed to the
2025-01-22 06:27:25.601 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra took the milk.
2025-01-22 06:27:25.620 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3886, 3890) -->  Sandra took the milk
2025-01-22 06:27:25.620 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel journeyed to the bedroom.
2025-01-22 06:27:25.644 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4312, 4318) --> . Daniel journeyed to the
2025-01-22 06:27:25.644 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the kitchen.
2025-01-22 06:27:25.672 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4566, 4572) -->  Sandra went back to the kitchen
2025-01-22 06:27:25.672 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra got the milk there.
2025-01-22 06:27:25.690 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3127, 3132) --> . Sandra got the milk
2025-01-22 06:27:25.690 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Sandra put down the milk there.
2025-01-22 06:27:25.719 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (5358, 5364) --> . Sandra put down the milk
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:27:26.611 | INFO     | test_jbb_embedding:begin_test:693 - John took the apple.<|eot_id|>
2025-01-22 06:27:26.611 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8189])
2025-01-22 06:27:28.838 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [539.8653846153846, 39.099774142351365, 130.72337962962962, 37.19589810149914, 36.98411649816177], 'topk_indices': array([  36,   33,   39, 4232, 8187,   31,   88, 4223,   24,   14, 4233,
         89,   35,  126, 4222, 4224, 4221,    0, 8184, 8185]), 'topk_tokens': ['.', ' to', '�', ' B', '<|end_header_id|>', ' went', 'ION', ' Cl', '\n\n', '\n', 'ree', 'E', ' office', 'ION', 'ch', 'outs', 'ree', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [1010.0, 624.75, 391.575, 392.375, 259.625]}, 'weight': {'score': [21.948317307692307, 23.27326867903797, 24.38599537037037, 23.27380998095355, 29.44875919117647], 'topk_indices': array([3289, 3316, 3161, 3209, 7473, 7435, 1493, 1431, 4285, 4301, 5114,
       5175, 7212, 7156, 3472, 3498, 4916, 4891, 4939, 4968]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.197916666666668, 25.283203125, 19.990625, 25.6140625, 20.052083333333332]}, 'saliency': {'score': [3.092106745793269, 0.21737594520662923, 0.7931269892939815, 0.20628129308011028, 0.27819308112649355], 'topk_indices': array([  24, 4232, 8176,   32,   39, 8034, 2892,   89,   88,   31,  840,
       4235,    0, 4223, 4233,  126, 4222,   35, 4224, 4221]), 'topk_tokens': ['\n\n', ' B', ' discarded', ' back', '�', ' context', ' bedroom', 'E', 'ION', ' went', ' apple', ' Cl', '<|begin_of_text|>', ' Cl', 'ree', 'ION', 'ch', ' office', 'outs', 'ree'], 'evidence_proportions': [5.459798177083333, 4.155029296875, 2.0380859375, 2.5068359375, 1.3818766276041667]}}, 'pred_res': 'John took the apple.<|eot_id|>', 'score': 0}
2025-01-22 06:27:28.855 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:27:28.856 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-93_pid-4_0-1-3-5-8.pkl | len: 3 |  size: 2.03 KB
Processing depth (0, 1, 3, 5, 8):   5%|▌         | 5/100 [01:44<32:54, 20.78s/it]Processing depth (0, 1, 3, 5, 8):   5%|▌         | 5/100 [01:44<33:01, 20.86s/it]
2025-01-22 06:27:28.935 | INFO     | __main__:<module>:82 - Selected idx: 94
2025-01-22 06:27:28.935 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the football before the hallway? 
2025-01-22 06:27:28.935 | INFO     | __main__:<module>:84 - Answer: garden
2025-01-22 06:27:28.935 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 06:27:28.935 | INFO     | __main__:<module>:86 - Needle: [' John went back to the hallway.', ' Mary journeyed to the kitchen.', ' Daniel went back to the garden.', ' Sandra went back to the kitchen.', ' Daniel went to the hallway.', ' Mary journeyed to the office.', ' Daniel dropped the football.', ' Mary journeyed to the office.']
2025-01-22 06:27:28.935 | INFO     | __main__:<module>:87 - Real Needle: [' Daniel went back to the garden.', ' Daniel went to the hallway.', ' Daniel dropped the football.', ' Mary journeyed to the office.']
2025-01-22 06:27:28.935 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['👩🏿\u200d❤️\u200d💋\u200d👩🏽', '💁', '🖕🏽', '🚣🏽\u200d♀', '🇱🇷', '3⃣', '🧏🏽\u200d♂️', '🚣🏾\u200d♀', '🤸', '😣']
emoji:
O: 👩🏿‍❤️‍💋‍👩🏽 [9468, 239, 102, 9468, 237, 123, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 121]
N: 🧏🏽‍♂️ [9468, 100, 237, 9468, 237, 121, 102470, 17245, 224, 31643]

O: 💁 [93273, 223]
N: 3⃣ [18, 158, 225, 96]

O: 🖕🏽 [9468, 244, 243, 9468, 237, 121]
N: 🖕🏽 [9468, 244, 243, 9468, 237, 121]

O: 🚣🏽‍♀ [9468, 248, 96, 9468, 237, 121, 102470, 32990]
N: 🤸 [9468, 97, 116]

O: 🇱🇷 [9468, 229, 109, 9468, 229, 115]
N: 💁 [93273, 223]

O: 3⃣ [18, 158, 225, 96]
N: 👩🏿‍❤️‍💋‍👩🏽 [9468, 239, 102, 9468, 237, 123, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 121]

O: 🧏🏽‍♂️ [9468, 100, 237, 9468, 237, 121, 102470, 17245, 224, 31643]
N: 🚣🏽‍♀ [9468, 248, 96, 9468, 237, 121, 102470, 32990]

O: 🚣🏾‍♀ [9468, 248, 96, 9468, 237, 122, 102470, 32990]
N: 🇱🇷 [9468, 229, 109, 9468, 229, 115]

O: 🤸 [9468, 97, 116]
N: 🚣🏾‍♀ [9468, 248, 96, 9468, 237, 122, 102470, 32990]

O: 😣 [76460, 96]
N: 😣 [76460, 96]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.67s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:08,  4.48s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.17s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.73s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.34s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 1, 3, 6):   0%|          | 0/100 [00:15<?, ?it/s]2025-01-22 06:27:44.268 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went back to the garden.
2025-01-22 06:27:44.269 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 37) -->  went back to the garden.
2025-01-22 06:27:44.269 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the hallway.
2025-01-22 06:27:44.273 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (834, 839) --> . Daniel went to the
2025-01-22 06:27:44.273 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel dropped the football.
2025-01-22 06:27:44.287 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2879, 2883) -->  Daniel dropped the football
2025-01-22 06:27:44.288 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary journeyed to the office.
2025-01-22 06:27:44.312 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4733, 4739) -->  the senate. Mary journeyed
2025-01-22 06:27:44.312 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the hallway.
2025-01-22 06:27:44.347 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6619, 6625) --> . John went back to the
2025-01-22 06:27:44.348 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the kitchen.
2025-01-22 06:27:44.372 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4733, 4739) -->  the senate. Mary journeyed
2025-01-22 06:27:44.372 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the kitchen.
2025-01-22 06:27:44.404 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5600, 5606) --> . Sandra went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:27:48.842 | INFO     | test_jbb_embedding:begin_test:693 - Daniel dropped the football.<|eot_id|>
2025-01-22 06:27:48.842 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8151])
2025-01-22 06:27:51.670 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [315.32440476190476, 23.22655866752514, 168.67708333333334, 22.148041820702403, 17.648279989919356], 'topk_indices': array([  36, 3093,   33, 8138,   26, 8049, 8140, 8039, 8142,   25,   24,
       2882, 8141, 8149, 8146, 8139,   14,   35,   28,    0]), 'topk_tokens': ['.', 'ern', ' to', ' football', '<|start_header_id|>', ' location', ' the', '.\n\n', '?', '<|eot_id|>', '\n\n', ' football', ' hallway', '<|end_header_id|>', '<|eot_id|>', ' before', '\n', ' garden', '<|end_header_id|>', '<|begin_of_text|>'], 'evidence_proportions': [542.0833333333334, 247.975, 386.46875, 97.26041666666667]}, 'weight': {'score': [22.635044642857142, 23.268441869021338, 21.977430555555557, 23.27294458564387, 29.67842741935484], 'topk_indices': array([3273, 3300, 3193, 3145, 7415, 7377, 1436, 1498, 4282, 4266, 5145,
       5084, 7092, 7148, 3456, 3482, 4861, 4886, 4909, 4938]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.614583333333332, 19.665625, 27.341796875, 23.9921875]}, 'saliency': {'score': [1.8462175641741072, 0.1298960914265621, 0.9009365505642362, 0.12374433798328713, 0.1315819524949597], 'topk_indices': array([  30, 3435, 8039,   14, 3092,    8, 8142,   24,   32, 7330, 3093,
         31, 8133, 8049, 8138,  839, 8139, 2882,   35, 8141]), 'topk_tokens': ['Daniel', ' could', '.\n\n', '\n', ' const', ' Date', '?', '\n\n', ' back', 'nes', 'ern', ' went', 'Question', ' location', ' football', ' hallway', ' before', ' football', ' garden', ' hallway'], 'evidence_proportions': [3.037109375, 1.21259765625, 2.7476806640625, 0.582366943359375]}}, 'pred_res': 'Daniel dropped the football.<|eot_id|>', 'score': 0}
2025-01-22 06:27:51.677 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:27:51.677 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-94_pid-0_0-1-3-6.pkl | len: 3 |  size: 2.04 KB
Processing depth (0, 1, 3, 6):   1%|          | 1/100 [00:22<37:15, 22.58s/it]is_0k: False
your chose emoji: ['🕯️', '💇\u200d♂', '🧛🏿\u200d♂️', '🎈', '🪗', '🦜', '🍜', '🧝🏻\u200d♂', '👩🏼\u200d❤️\u200d💋\u200d👨🏾', '🅿']
emoji:
O: 🕯️ [9468, 243, 107, 31643]
N: 🧝🏻‍♂ [9468, 100, 251, 9468, 237, 119, 102470, 17245, 224]

O: 💇‍♂ [93273, 229, 102470, 17245, 224]
N: 🦜 [9468, 99, 250]

O: 🧛🏿‍♂️ [9468, 100, 249, 9468, 237, 123, 102470, 17245, 224, 31643]
N: 🍜 [9468, 235, 250]

O: 🎈 [9468, 236, 230]
N: 🕯️ [9468, 243, 107, 31643]

O: 🪗 [9468, 103, 245]
N: 🎈 [9468, 236, 230]

O: 🦜 [9468, 99, 250]
N: 💇‍♂ [93273, 229, 102470, 17245, 224]

O: 🍜 [9468, 235, 250]
N: 👩🏼‍❤️‍💋‍👨🏾 [9468, 239, 102, 9468, 237, 120, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 122]

O: 🧝🏻‍♂ [9468, 100, 251, 9468, 237, 119, 102470, 17245, 224]
N: 🪗 [9468, 103, 245]

O: 👩🏼‍❤️‍💋‍👨🏾 [9468, 239, 102, 9468, 237, 120, 102470, 121643, 31643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 122]
N: 🧛🏿‍♂️ [9468, 100, 249, 9468, 237, 123, 102470, 17245, 224, 31643]

O: 🅿 [9468, 227, 123]
N: 🅿 [9468, 227, 123]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.95s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.85s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.53s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.14s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.72s/it]
Processing depth (3, 6, 7, 8):   1%|          | 1/100 [00:39<37:15, 22.58s/it]2025-01-22 06:28:08.623 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went back to the garden.
2025-01-22 06:28:08.638 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2879, 2885) --> . Daniel went back to the
2025-01-22 06:28:08.638 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the hallway.
2025-01-22 06:28:08.652 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2880, 2885) -->  Daniel went back to the
2025-01-22 06:28:08.652 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel dropped the football.
2025-01-22 06:28:08.687 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5446, 5450) -->  Daniel dropped the football
2025-01-22 06:28:08.687 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary journeyed to the office.
2025-01-22 06:28:08.720 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6472, 6478) --> . Mary journeyed to the
2025-01-22 06:28:08.720 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the hallway.
2025-01-22 06:28:08.758 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6523, 6529) --> . John went back to the
2025-01-22 06:28:08.758 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the kitchen.
2025-01-22 06:28:08.791 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6472, 6478) --> . Mary journeyed to the
2025-01-22 06:28:08.791 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the kitchen.
2025-01-22 06:28:08.821 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5348, 5354) --> . Sandra went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:28:09.665 | INFO     | test_jbb_embedding:begin_test:693 - Daniel dropped the football.<|eot_id|>
2025-01-22 06:28:09.665 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8153])
2025-01-22 06:28:11.888 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [116.16889880952381, 13.246001793158412, 67.84461805555556, 12.85864736047801, 8.87464347718254], 'topk_indices': array([7546, 8041,   25, 8136,    3,    4, 8051, 8147,   23, 8152,    9,
       8140,    1, 8141,   24,   14,    0, 8149, 8151, 8148]), 'topk_tokens': ['nes', '.\n\n', '<|eot_id|>', ':', '<|end_header_id|>', '\n\n', ' location', ':', '4', '\n\n', ':', ' football', '<|start_header_id|>', ' before', '\n\n', '\n', '<|begin_of_text|>', '<|start_header_id|>', '<|end_header_id|>', '<|eot_id|>'], 'evidence_proportions': [123.6875, 124.7, 206.78125, 41.1328125]}, 'weight': {'score': [22.436011904761905, 23.265590516184403, 20.6640625, 23.273505836515955, 29.405505952380953], 'topk_indices': array([3329, 3302, 3222, 3174, 7438, 7400, 1499, 1437, 4305, 4321, 5203,
       5142, 7114, 7170, 3511, 3485, 4996, 4944, 4967, 4919]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.927083333333332, 23.1828125, 27.341796875, 20.052083333333332]}, 'saliency': {'score': [0.7137393043154762, 0.07211252075015709, 0.3670857747395833, 0.06979840457094293, 0.06531573098803324], 'topk_indices': array([8137,   23,   14,   16,   20, 4577, 8150,    0, 8135,    8, 7501,
       7545, 7546, 8146, 5449, 8051,   24, 8143, 8141, 8140]), 'topk_tokens': [' Where', '4', '\n', ' Date', ' Jul', ' hallway', 'assistant', '<|begin_of_text|>', 'Question', ' Date', 'nes', ' Min', 'nes', 'Answer', ' football', ' location', '\n\n', ' hallway', ' before', ' football'], 'evidence_proportions': [0.6786295572916666, 0.7576171875, 1.4464111328125, 0.22383626302083334]}}, 'pred_res': 'Daniel dropped the football.<|eot_id|>', 'score': 0}
2025-01-22 06:28:11.895 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:28:11.895 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-94_pid-1_3-6-7-8.pkl | len: 3 |  size: 2.05 KB
Processing depth (3, 6, 7, 8):   2%|▏         | 2/100 [00:42<34:36, 21.19s/it]is_0k: False
your chose emoji: ['♠', '🧍🏼\u200d♂', '👙', '🧑🏽\u200d🎄', '👩🏻\u200d🌾', '🍎', '🏃🏾\u200d♀️\u200d➡', '🪙', '🖖🏾', '🕴🏻']
emoji:
O: ♠ [121324]
N: 👩🏻‍🌾 [9468, 239, 102, 9468, 237, 119, 102470, 9468, 234, 122]

O: 🧍🏼‍♂ [9468, 100, 235, 9468, 237, 120, 102470, 17245, 224]
N: 🧍🏼‍♂ [9468, 100, 235, 9468, 237, 120, 102470, 17245, 224]

O: 👙 [9468, 239, 247]
N: 🍎 [9468, 235, 236]

O: 🧑🏽‍🎄 [9468, 100, 239, 9468, 237, 121, 102470, 9468, 236, 226]
N: ♠ [121324]

O: 👩🏻‍🌾 [9468, 239, 102, 9468, 237, 119, 102470, 9468, 234, 122]
N: 🏃🏾‍♀️‍➡ [9468, 237, 225, 9468, 237, 122, 102470, 32990, 31643, 102470, 98115, 94]

O: 🍎 [9468, 235, 236]
N: 👙 [9468, 239, 247]

O: 🏃🏾‍♀️‍➡ [9468, 237, 225, 9468, 237, 122, 102470, 32990, 31643, 102470, 98115, 94]
N: 🖖🏾 [9468, 244, 244, 9468, 237, 122]

O: 🪙 [9468, 103, 247]
N: 🪙 [9468, 103, 247]

O: 🖖🏾 [9468, 244, 244, 9468, 237, 122]
N: 🧑🏽‍🎄 [9468, 100, 239, 9468, 237, 121, 102470, 9468, 236, 226]

O: 🕴🏻 [9468, 243, 112, 9468, 237, 119]
N: 🕴🏻 [9468, 243, 112, 9468, 237, 119]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.55s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.66s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.27s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.78s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.40s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 2, 7, 9):   2%|▏         | 2/100 [00:58<34:36, 21.19s/it]2025-01-22 06:28:27.260 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went back to the garden.
2025-01-22 06:28:27.260 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 37) -->  went back to the garden.
2025-01-22 06:28:27.261 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the hallway.
2025-01-22 06:28:27.270 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1862, 1867) --> . Daniel went to the
2025-01-22 06:28:27.270 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel dropped the football.
2025-01-22 06:28:27.301 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5592, 5596) -->  Daniel dropped the football
2025-01-22 06:28:27.303 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary journeyed to the office.
2025-01-22 06:28:27.344 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (7221, 7227) --> . Mary journeyed to the
2025-01-22 06:28:27.344 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the hallway.
2025-01-22 06:28:27.380 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6622, 6628) --> . John went back to the
2025-01-22 06:28:27.380 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the kitchen.
2025-01-22 06:28:27.419 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (7221, 7227) --> . Mary journeyed to the
2025-01-22 06:28:27.419 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the kitchen.
2025-01-22 06:28:27.447 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5534, 5540) --> . Sandra went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:28:32.985 | INFO     | test_jbb_embedding:begin_test:693 - Daniel dropped the football.<|eot_id|>
2025-01-22 06:28:32.986 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8185])
2025-01-22 06:28:35.791 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [218.63095238095238, 23.005289753297507, 117.52430555555556, 22.292382500920358, 13.160724881329115], 'topk_indices': array([   4, 8168, 5595,    1, 8173, 8179, 8172, 1928, 8083,    9, 1929,
         23, 2058,   35,   24,   14, 8183, 8181,    0, 8180]), 'topk_tokens': ['\n\n', ':', ' football', '<|start_header_id|>', ' before', ':', ' football', 'fast', ' location', ':', 'est', '4', 'ra', ' garden', '\n\n', '\n', '<|end_header_id|>', '<|start_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [390.4166666666667, 181.5625, 263.65625, 47.71875]}, 'weight': {'score': [21.509300595238095, 23.282402601367856, 20.6640625, 23.29275543778378, 29.022547468354432], 'topk_indices': array([3276, 3303, 3148, 3196, 7439, 7401, 1426, 1488, 4297, 4281, 5116,
       5177, 7171, 7115, 3485, 3459, 4894, 4869, 4954, 4925]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.614583333333332, 19.665625, 27.341796875, 20.052083333333332]}, 'saliency': {'score': [1.28900146484375, 0.12848426658581918, 0.6944749620225694, 0.12424341572297981, 0.096660952024822], 'topk_indices': array([2062,   23, 2010,    8,   31, 8178, 2109, 8173, 5535, 8167,   24,
       2059, 2058, 1929, 8083, 8175, 5595, 1928, 8172,   35]), 'topk_tokens': ['ien', '4', 'fast', ' Date', ' went', 'Answer', ' Ch', ' before', ' Sandra', 'Question', '\n\n', 'irie', 'ra', 'est', ' location', ' hallway', ' football', 'fast', ' football', ' garden'], 'evidence_proportions': [2.2264811197916665, 0.947998046875, 1.8607177734375, 0.254547119140625]}}, 'pred_res': 'Daniel dropped the football.<|eot_id|>', 'score': 0}
2025-01-22 06:28:35.797 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:28:35.797 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-94_pid-2_0-2-7-9.pkl | len: 3 |  size: 2.02 KB
Processing depth (0, 2, 7, 9):   3%|▎         | 3/100 [01:06<36:15, 22.43s/it]is_0k: False
your chose emoji: ['👩🏾\u200d🤝\u200d👨🏻', '♊', '🚟', '⏹', '🗜️', '🦸🏻\u200d♂', '🧑🏾\u200d🦯', '👩🏿\u200d🦱', '🇬🇦', '👩🏻\u200d❤\u200d👩🏼']
emoji:
O: 👩🏾‍🤝‍👨🏻 [9468, 239, 102, 9468, 237, 122, 102470, 9468, 97, 251, 102470, 9468, 239, 101, 9468, 237, 119]
N: 🧑🏾‍🦯 [9468, 100, 239, 9468, 237, 122, 102470, 9468, 99, 107]

O: ♊ [17245, 232]
N: 🦸🏻‍♂ [9468, 99, 116, 9468, 237, 119, 102470, 17245, 224]

O: 🚟 [9468, 248, 253]
N: 👩🏿‍🦱 [9468, 239, 102, 9468, 237, 123, 102470, 9468, 99, 109]

O: ⏹ [158, 237, 117]
N: ⏹ [158, 237, 117]

O: 🗜️ [9468, 245, 250, 31643]
N: 🗜️ [9468, 245, 250, 31643]

O: 🦸🏻‍♂ [9468, 99, 116, 9468, 237, 119, 102470, 17245, 224]
N: 🇬🇦 [9468, 229, 105, 9468, 229, 99]

O: 🧑🏾‍🦯 [9468, 100, 239, 9468, 237, 122, 102470, 9468, 99, 107]
N: ♊ [17245, 232]

O: 👩🏿‍🦱 [9468, 239, 102, 9468, 237, 123, 102470, 9468, 99, 109]
N: 👩🏾‍🤝‍👨🏻 [9468, 239, 102, 9468, 237, 122, 102470, 9468, 97, 251, 102470, 9468, 239, 101, 9468, 237, 119]

O: 🇬🇦 [9468, 229, 105, 9468, 229, 99]
N: 🚟 [9468, 248, 253]

O: 👩🏻‍❤‍👩🏼 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 102470, 9468, 239, 102, 9468, 237, 120]
N: 👩🏻‍❤‍👩🏼 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 102470, 9468, 239, 102, 9468, 237, 120]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.58s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.71s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.42s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.07s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.61s/it]
Processing depth (1, 3, 7, 8):   3%|▎         | 3/100 [01:22<36:15, 22.43s/it]2025-01-22 06:28:51.953 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went back to the garden.
2025-01-22 06:28:51.958 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (827, 833) --> . Daniel went back to the
2025-01-22 06:28:51.958 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the hallway.
2025-01-22 06:28:51.963 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (828, 833) -->  Daniel went back to the
2025-01-22 06:28:51.963 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel dropped the football.
2025-01-22 06:28:51.990 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5544, 5548) -->  Daniel dropped the football
2025-01-22 06:28:51.990 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary journeyed to the office.
2025-01-22 06:28:52.025 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6460, 6466) --> . Mary journeyed to the
2025-01-22 06:28:52.025 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the hallway.
2025-01-22 06:28:52.062 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6511, 6517) --> . John went back to the
2025-01-22 06:28:52.062 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the kitchen.
2025-01-22 06:28:52.095 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6460, 6466) --> . Mary journeyed to the
2025-01-22 06:28:52.096 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the kitchen.
2025-01-22 06:28:52.123 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5414, 5420) --> . Sandra went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:28:52.961 | INFO     | test_jbb_embedding:begin_test:693 - Daniel dropped the football.<|eot_id|>
2025-01-22 06:28:52.961 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8149])
2025-01-22 06:28:55.168 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [210.2842261904762, 15.42643005550785, 88.19618055555556, 14.760601234130409, 21.957319415983605], 'topk_indices': array([8148, 5548, 8047,    1,   23, 8137, 8139, 8136,    9, 8145, 5547,
       2508, 2509,   24,  833,   14, 5482, 8147,    0, 8144]), 'topk_tokens': ['\n\n', '.', ' location', '<|start_header_id|>', '4', ' before', ' hallway', ' football', ':', '<|start_header_id|>', ' football', '.', ' There', '\n\n', ' garden', '\n', '.', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [263.8958333333333, 264.875, 317.375, 39.786458333333336]}, 'weight': {'score': [22.436011904761905, 23.260415388861627, 20.6640625, 23.268309734376928, 29.261014344262296], 'topk_indices': array([3305, 3278, 3198, 3150, 7426, 7388, 1490, 1428, 4263, 4279, 5179,
       5118, 7158, 7102, 3487, 3461, 4895, 4943, 4972, 4920]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.927083333333332, 23.1828125, 27.341796875, 20.052083333333332]}, 'saliency': {'score': [1.2918875558035714, 0.08534660002434219, 0.4730021158854167, 0.08136346686067114, 0.1639534371798156], 'topk_indices': array([8118,  829, 5544, 2507,   20, 8001,    8, 5545, 5481,   24, 2495,
       8137, 8003, 8047,  828, 2509, 8136, 5547, 8139,  833]), 'topk_tokens': [' return', ' went', ' Daniel', 'St', ' Jul', ' provided', ' Date', ' dropped', ' St', '\n\n', ' There', ' before', ' context', ' location', ' Daniel', ' There', ' football', ' football', ' hallway', ' garden'], 'evidence_proportions': [1.4532877604166667, 1.62021484375, 2.27197265625, 0.2034912109375]}}, 'pred_res': 'Daniel dropped the football.<|eot_id|>', 'score': 0}
2025-01-22 06:28:55.174 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:28:55.174 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-94_pid-3_1-3-7-8.pkl | len: 3 |  size: 2.05 KB
Processing depth (1, 3, 7, 8):   4%|▍         | 4/100 [01:26<33:57, 21.22s/it]is_0k: False
your chose emoji: ['🍡', '🧏🏿\u200d♀️', '\U0001fa89', '👩🏽\u200d🤝\u200d👨🏾', '💫', '🇺🇳', '❓', '⏫', '🦻🏾', '🦸🏽\u200d♂️']
emoji:
O: 🍡 [9468, 235, 94]
N: 🧏🏿‍♀️ [9468, 100, 237, 9468, 237, 123, 102470, 32990, 31643]

O: 🧏🏿‍♀️ [9468, 100, 237, 9468, 237, 123, 102470, 32990, 31643]
N: 💫 [93273, 104]

O: 🪉 [9468, 103, 231]
N: 🦻🏾 [9468, 99, 119, 9468, 237, 122]

O: 👩🏽‍🤝‍👨🏾 [9468, 239, 102, 9468, 237, 121, 102470, 9468, 97, 251, 102470, 9468, 239, 101, 9468, 237, 122]
N: 🍡 [9468, 235, 94]

O: 💫 [93273, 104]
N: ⏫ [158, 237, 104]

O: 🇺🇳 [9468, 229, 118, 9468, 229, 111]
N: 👩🏽‍🤝‍👨🏾 [9468, 239, 102, 9468, 237, 121, 102470, 9468, 97, 251, 102470, 9468, 239, 101, 9468, 237, 122]

O: ❓ [49633, 241]
N: ❓ [49633, 241]

O: ⏫ [158, 237, 104]
N: 🪉 [9468, 103, 231]

O: 🦻🏾 [9468, 99, 119, 9468, 237, 122]
N: 🇺🇳 [9468, 229, 118, 9468, 229, 111]

O: 🦸🏽‍♂️ [9468, 99, 116, 9468, 237, 121, 102470, 17245, 224, 31643]
N: 🦸🏽‍♂️ [9468, 99, 116, 9468, 237, 121, 102470, 17245, 224, 31643]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.67s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.86s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.56s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.12s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.70s/it]
Processing depth (1, 4, 7, 8):   4%|▍         | 4/100 [01:42<33:57, 21.22s/it]2025-01-22 06:29:11.977 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went back to the garden.
2025-01-22 06:29:11.982 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (895, 901) --> . Daniel went back to the
2025-01-22 06:29:11.982 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the hallway.
2025-01-22 06:29:11.987 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (896, 901) -->  Daniel went back to the
2025-01-22 06:29:11.987 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel dropped the football.
2025-01-22 06:29:12.014 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5577, 5581) -->  dropped the football.
2025-01-22 06:29:12.014 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary journeyed to the office.
2025-01-22 06:29:12.047 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6524, 6530) --> . Mary journeyed to the
2025-01-22 06:29:12.047 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the hallway.
2025-01-22 06:29:12.080 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6629, 6635) --> . John went back to the
2025-01-22 06:29:12.080 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the kitchen.
2025-01-22 06:29:12.124 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6524, 6530) --> . Mary journeyed to the
2025-01-22 06:29:12.124 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Sandra went back to the kitchen.
2025-01-22 06:29:12.152 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5542, 5548) --> . Sandra went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:29:13.078 | INFO     | test_jbb_embedding:begin_test:693 - The football was dropped by Daniel.<|eot_id|>
2025-01-22 06:29:13.079 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8173])
2025-01-22 06:29:15.308 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [203.00372023809524, 16.267578125, 98.01649305555556, 15.604810587440088, 29.452429366438356], 'topk_indices': array([8160,  257,   25, 8061,    4, 8169, 8167, 8071,    9, 8172,   23,
          1, 5579,  901,    3,   24,   14, 8171,    0, 8168]), 'topk_tokens': [' football', 'hue', '<|eot_id|>', '.\n\n', '\n\n', '<|start_header_id|>', ':', ' location', ':', '\n\n', '4', '<|start_header_id|>', ' football', ' garden', '<|end_header_id|>', '\n\n', '\n', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [258.6041666666667, 257.625, 279.90625, 50.6171875]}, 'weight': {'score': [21.271949404761905, 23.278173159246574, 20.6640625, 23.289133548912375, 29.269049657534246], 'topk_indices': array([3295, 3268, 3140, 3188, 7439, 7401, 1424, 1486, 4273, 4289, 5185,
       5124, 7122, 7178, 3477, 3451, 4943, 4920, 4895, 4972]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.927083333333332, 23.1828125, 21.23046875, 20.052083333333332]}, 'saliency': {'score': [1.169770740327381, 0.09082844206031755, 0.5642564561631944, 0.08699662535668475, 0.2116437938115368], 'topk_indices': array([8161, 8172,    0,   14, 3609, 8170,   23,    8, 5576,   20, 8166,
       8163, 5543,  896, 8160,  257, 8071,   24, 5579,  901]), 'topk_tokens': [' before', '\n\n', '<|begin_of_text|>', '\n', ' hallway', 'assistant', '4', ' Date', ' Daniel', ' Jul', 'Answer', ' hallway', ' Sandra', ' Daniel', ' football', 'hue', ' location', '\n\n', ' football', ' garden'], 'evidence_proportions': [1.4202473958333333, 1.5693359375, 1.63037109375, 0.2792561848958333]}}, 'pred_res': 'The football was dropped by Daniel.<|eot_id|>', 'score': 0}
2025-01-22 06:29:15.315 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:29:15.315 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-94_pid-4_1-4-7-8.pkl | len: 3 |  size: 2.07 KB
Processing depth (1, 4, 7, 8):   5%|▌         | 5/100 [01:46<32:59, 20.83s/it]Processing depth (1, 4, 7, 8):   5%|▌         | 5/100 [01:46<33:39, 21.26s/it]
2025-01-22 06:29:15.405 | INFO     | __main__:<module>:82 - Selected idx: 95
2025-01-22 06:29:15.405 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the location prior to the place where the milk was discarded, left or dropped?
2025-01-22 06:29:15.406 | INFO     | __main__:<module>:84 - Answer: garden
2025-01-22 06:29:15.406 | INFO     | __main__:<module>:85 - Tag: 4-hop
2025-01-22 06:29:15.406 | INFO     | __main__:<module>:86 - Needle: [' Sandra went back to the kitchen.', ' Daniel went back to the garden.', ' Mary journeyed to the kitchen.', ' Daniel got the milk.', ' John went back to the hallway.', ' Daniel went to the hallway.', ' Mary journeyed to the office.', ' Daniel dropped the milk.', ' Mary journeyed to the office.']
2025-01-22 06:29:15.406 | INFO     | __main__:<module>:87 - Real Needle: [' Daniel went back to the garden.', ' Daniel got the milk.', ' Daniel went to the hallway.', ' Daniel dropped the milk.', ' Mary journeyed to the office.']
2025-01-22 06:29:15.406 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['🧗🏻\u200d♀️', '🛌🏻', '👨🏻\u200d🍳', '↘️', '👮🏻\u200d♂', '🧍🏼', '\U0001faf1🏾\u200d\U0001faf2🏻', '👞', '👩🏽\u200d⚕️', '🤱']
emoji:
O: 🧗🏻‍♀️ [9468, 100, 245, 9468, 237, 119, 102470, 32990, 31643]
N: 🛌🏻 [9468, 249, 234, 9468, 237, 119]

O: 🛌🏻 [9468, 249, 234, 9468, 237, 119]
N: 👞 [9468, 239, 252]

O: 👨🏻‍🍳 [9468, 239, 101, 9468, 237, 119, 102470, 9468, 235, 111]
N: 👮🏻‍♂ [9468, 239, 106, 9468, 237, 119, 102470, 17245, 224]

O: ↘️ [27017, 246, 31643]
N: 👨🏻‍🍳 [9468, 239, 101, 9468, 237, 119, 102470, 9468, 235, 111]

O: 👮🏻‍♂ [9468, 239, 106, 9468, 237, 119, 102470, 17245, 224]
N: 👩🏽‍⚕️ [9468, 239, 102, 9468, 237, 121, 102470, 158, 248, 243, 31643]

O: 🧍🏼 [9468, 100, 235, 9468, 237, 120]
N: 🧍🏼 [9468, 100, 235, 9468, 237, 120]

O: 🫱🏾‍🫲🏻 [9468, 104, 109, 9468, 237, 122, 102470, 9468, 104, 110, 9468, 237, 119]
N: ↘️ [27017, 246, 31643]

O: 👞 [9468, 239, 252]
N: 🫱🏾‍🫲🏻 [9468, 104, 109, 9468, 237, 122, 102470, 9468, 104, 110, 9468, 237, 119]

O: 👩🏽‍⚕️ [9468, 239, 102, 9468, 237, 121, 102470, 158, 248, 243, 31643]
N: 🧗🏻‍♀️ [9468, 100, 245, 9468, 237, 119, 102470, 32990, 31643]

O: 🤱 [9468, 97, 109]
N: 🤱 [9468, 97, 109]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.65s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.76s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.58s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  2.98s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.60s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (1, 2, 5, 6, 9):   0%|          | 0/100 [00:16<?, ?it/s]2025-01-22 06:29:31.617 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went back to the garden.
2025-01-22 06:29:31.623 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (845, 851) --> . Daniel went back to the
2025-01-22 06:29:31.623 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel got the milk.
2025-01-22 06:29:31.632 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1827, 1831) -->  Daniel got the milk
2025-01-22 06:29:31.633 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the hallway.
2025-01-22 06:29:31.637 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (846, 851) -->  Daniel went back to the
2025-01-22 06:29:31.637 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel dropped the milk.
2025-01-22 06:29:31.662 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4801, 4805) -->  Daniel dropped the milk
2025-01-22 06:29:31.662 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary journeyed to the office.
2025-01-22 06:29:31.686 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4573, 4579) -->  journeyed to the kitchen.
2025-01-22 06:29:31.686 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went back to the kitchen.
2025-01-22 06:29:31.707 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4215, 4221) -->  Sandra went back to the kitchen
2025-01-22 06:29:31.707 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the kitchen.
2025-01-22 06:29:31.731 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4572, 4578) -->  Mary journeyed to the kitchen
2025-01-22 06:29:31.731 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the hallway.
2025-01-22 06:29:31.746 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2847, 2853) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:29:35.215 | INFO     | test_jbb_embedding:begin_test:693 - The hallway.<|eot_id|>
2025-01-22 06:29:35.215 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8207])
2025-01-22 06:29:38.098 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [598.525, 36.71734926918392, 176.03819444444446, 34.69053814130036, 19.058052522590362], 'topk_indices': array([8099, 8094,    9, 8186,  849,  257, 1831, 1830, 8187,  848,  847,
        846, 8096, 8100, 8086,   14,  851, 8202,    0, 8203]), 'topk_tokens': [' to', ' the', ':', ' prior', ' to', 'hue', '.', ' milk', ' to', ' back', ' went', ' Daniel', ' location', ' the', '.\n\n', '\n', ' garden', '<|eot_id|>', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [852.5833333333334, 574.9375, 895.4, 525.5, 161.47916666666666]}, 'weight': {'score': [23.0840625, 23.29039091047503, 23.32465277777778, 23.290946989408596, 29.269954819277107], 'topk_indices': array([3333, 3306, 3226, 3178, 7489, 7451, 1524, 1462, 4298, 4314, 5208,
       5147, 7172, 7228, 3489, 3515, 4924, 4972, 5001, 4949]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.927083333333332, 26.611328125, 23.1828125, 27.013671875, 20.1875]}, 'saliency': {'score': [3.62052734375, 0.20466509318380785, 1.0766194661458333, 0.1922870186181814, 0.13995683049581137], 'topk_indices': array([8095, 2853,    8, 8092, 8070,   99, 8180, 8194, 4804, 4802, 8098,
       8086,  848, 8186, 1830,  847, 8096,  257,  846,  851]), 'topk_tokens': [' first', ' hallway', ' Date', ' item', ' question', 'ION', 'Question', ' discarded', ' milk', ' dropped', ' traveled', '.\n\n', ' back', ' prior', ' milk', ' went', ' location', 'hue', ' Daniel', ' garden'], 'evidence_proportions': [4.736979166666667, 3.908447265625, 5.4052734375, 3.591552734375, 0.8441569010416666]}}, 'pred_res': 'The hallway.<|eot_id|>', 'score': 0}
2025-01-22 06:29:38.104 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:29:38.105 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-95_pid-0_1-2-5-6-9.pkl | len: 3 |  size: 2.06 KB
Processing depth (1, 2, 5, 6, 9):   1%|          | 1/100 [00:22<37:17, 22.60s/it]is_0k: False
your chose emoji: ['🙇🏿', '👩🏻\u200d🤝\u200d👩🏾', '🍋', '🧑🏿\u200d🦽', '👩🏻\u200d⚖', '🧎🏾\u200d♂️', '🧑🏿\u200d❤\u200d💋\u200d🧑🏼', '\U0001fae2', '🔌', '🏔']
emoji:
O: 🙇🏿 [9468, 247, 229, 9468, 237, 123]
N: 🧑🏿‍❤‍💋‍🧑🏼 [9468, 100, 239, 9468, 237, 123, 102470, 121643, 102470, 93273, 233, 102470, 9468, 100, 239, 9468, 237, 120]

O: 👩🏻‍🤝‍👩🏾 [9468, 239, 102, 9468, 237, 119, 102470, 9468, 97, 251, 102470, 9468, 239, 102, 9468, 237, 122]
N: 🧎🏾‍♂️ [9468, 100, 236, 9468, 237, 122, 102470, 17245, 224, 31643]

O: 🍋 [9468, 235, 233]
N: 🍋 [9468, 235, 233]

O: 🧑🏿‍🦽 [9468, 100, 239, 9468, 237, 123, 102470, 9468, 99, 121]
N: 🔌 [9468, 242, 234]

O: 👩🏻‍⚖ [9468, 239, 102, 9468, 237, 119, 102470, 158, 248, 244]
N: 👩🏻‍⚖ [9468, 239, 102, 9468, 237, 119, 102470, 158, 248, 244]

O: 🧎🏾‍♂️ [9468, 100, 236, 9468, 237, 122, 102470, 17245, 224, 31643]
N: 👩🏻‍🤝‍👩🏾 [9468, 239, 102, 9468, 237, 119, 102470, 9468, 97, 251, 102470, 9468, 239, 102, 9468, 237, 122]

O: 🧑🏿‍❤‍💋‍🧑🏼 [9468, 100, 239, 9468, 237, 123, 102470, 121643, 102470, 93273, 233, 102470, 9468, 100, 239, 9468, 237, 120]
N: 🙇🏿 [9468, 247, 229, 9468, 237, 123]

O: 🫢 [9468, 104, 95]
N: 🧑🏿‍🦽 [9468, 100, 239, 9468, 237, 123, 102470, 9468, 99, 121]

O: 🔌 [9468, 242, 234]
N: 🫢 [9468, 104, 95]

O: 🏔 [9468, 237, 242]
N: 🏔 [9468, 237, 242]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.12s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.63s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.63s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.21s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.70s/it]
Processing depth (2, 3, 5, 7, 8):   1%|          | 1/100 [00:39<37:17, 22.60s/it]2025-01-22 06:29:54.963 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went back to the garden.
2025-01-22 06:29:54.972 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (1775, 1781) --> . Daniel went back to the
2025-01-22 06:29:54.972 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel got the milk.
2025-01-22 06:29:54.987 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2870, 2874) -->  Daniel got the milk
2025-01-22 06:29:54.987 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the hallway.
2025-01-22 06:29:54.999 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1776, 1781) -->  Daniel went back to the
2025-01-22 06:29:54.999 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel dropped the milk.
2025-01-22 06:29:55.027 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5595, 5599) -->  Daniel dropped the milk
2025-01-22 06:29:55.027 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary journeyed to the office.
2025-01-22 06:29:55.050 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4491, 4497) --> . Mary journeyed to the
2025-01-22 06:29:55.050 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went back to the kitchen.
2025-01-22 06:29:55.070 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4072, 4078) --> . Sandra went back to the
2025-01-22 06:29:55.070 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the kitchen.
2025-01-22 06:29:55.094 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4491, 4497) --> . Mary journeyed to the
2025-01-22 06:29:55.095 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the hallway.
2025-01-22 06:29:55.111 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2800, 2806) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:29:55.888 | INFO     | test_jbb_embedding:begin_test:693 - The hallway.<|eot_id|>
2025-01-22 06:29:55.888 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8143])
2025-01-22 06:29:58.116 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [116.700625, 11.742329440829856, 50.96180555555556, 11.331381895594225, 8.770009957107844], 'topk_indices': array([  21, 8117,   16, 8142, 2874,    4, 5598, 5599, 8022,    9, 8141,
         23,    1,   14,   28, 8139,    3,   24, 8138,    0]), 'topk_tokens': [' ', ':', ' Date', '\n\n', '.', '\n\n', ' milk', '.', '.\n\n', ':', '<|end_header_id|>', '4', '<|start_header_id|>', '\n', '<|end_header_id|>', '<|start_header_id|>', '<|end_header_id|>', '\n\n', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [116.20833333333333, 164.6875, 118.5875, 200.25, 27.9296875]}, 'weight': {'score': [23.0515625, 23.23769910078566, 20.6640625, 23.243990458780697, 28.813725490196077], 'topk_indices': array([3311, 3284, 3204, 3156, 7413, 7375, 1405, 1467, 4296, 4312, 5187,
       5126, 7146, 7090, 3503, 3477, 4903, 4951, 4980, 4928]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.927083333333332, 26.611328125, 23.1828125, 27.013671875, 20.052083333333332]}, 'saliency': {'score': [0.74524658203125, 0.06504614605471627, 0.2830742730034722, 0.06246321168664384, 0.06574159509995404], 'topk_indices': array([  15, 8032, 8022, 1781, 8136, 7706,   22,    8, 2806, 2873, 5596,
         20, 1776, 8130, 8116,   16,   23, 8140, 5598,   24]), 'topk_tokens': ['Today', ' location', '.\n\n', ' garden', 'Answer', 'inen', '202', ' Date', ' hallway', ' milk', ' dropped', ' Jul', ' Daniel', ' discarded', 'Question', ' Date', '4', 'assistant', ' milk', '\n\n'], 'evidence_proportions': [0.6790568033854166, 1.1148681640625, 0.7649658203125, 1.347412109375, 0.14714558919270834]}}, 'pred_res': 'The hallway.<|eot_id|>', 'score': 0}
2025-01-22 06:29:58.146 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:29:58.146 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-95_pid-1_2-3-5-7-8.pkl | len: 3 |  size: 2.07 KB
Processing depth (2, 3, 5, 7, 8):   2%|▏         | 2/100 [00:42<34:27, 21.10s/it]is_0k: False
your chose emoji: ['🚭', '🎁', '🖱️', '💪🏿', '\U0001fa7c', '👨🏽\u200d🦲', '🕴', '✊🏻', '🧜🏽', '👳🏾\u200d♂']
emoji:
O: 🚭 [9468, 248, 255]
N: 🕴 [9468, 243, 112]

O: 🎁 [9468, 236, 223]
N: 🎁 [9468, 236, 223]

O: 🖱️ [9468, 244, 109, 31643]
N: 🖱️ [9468, 244, 109, 31643]

O: 💪🏿 [93273, 103, 9468, 237, 123]
N: 👨🏽‍🦲 [9468, 239, 101, 9468, 237, 121, 102470, 9468, 99, 110]

O: 🩼 [9468, 102, 120]
N: 💪🏿 [93273, 103, 9468, 237, 123]

O: 👨🏽‍🦲 [9468, 239, 101, 9468, 237, 121, 102470, 9468, 99, 110]
N: ✊🏻 [38798, 232, 9468, 237, 119]

O: 🕴 [9468, 243, 112]
N: 🧜🏽 [9468, 100, 250, 9468, 237, 121]

O: ✊🏻 [38798, 232, 9468, 237, 119]
N: 🩼 [9468, 102, 120]

O: 🧜🏽 [9468, 100, 250, 9468, 237, 121]
N: 🚭 [9468, 248, 255]

O: 👳🏾‍♂ [9468, 239, 111, 9468, 237, 122, 102470, 17245, 224]
N: 👳🏾‍♂ [9468, 239, 111, 9468, 237, 122, 102470, 17245, 224]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.36s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.58s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.47s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.05s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.58s/it]
Processing depth (4, 5, 7, 8, 9):   2%|▏         | 2/100 [00:58<34:27, 21.10s/it]2025-01-22 06:30:14.279 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went back to the garden.
2025-01-22 06:30:14.297 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3608, 3614) --> . Daniel went back to the
2025-01-22 06:30:14.298 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel got the milk.
2025-01-22 06:30:14.320 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4155, 4159) -->  Daniel got the milk
2025-01-22 06:30:14.320 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the hallway.
2025-01-22 06:30:14.335 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2722, 2727) -->  back to the hallway.
2025-01-22 06:30:14.335 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel dropped the milk.
2025-01-22 06:30:14.371 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6617, 6621) -->  Daniel dropped the milk
2025-01-22 06:30:14.371 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary journeyed to the office.
2025-01-22 06:30:14.395 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4545, 4551) -->  journeyed to the kitchen.
2025-01-22 06:30:14.395 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went back to the kitchen.
2025-01-22 06:30:14.415 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4119, 4125) --> . Sandra went back to the
2025-01-22 06:30:14.415 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the kitchen.
2025-01-22 06:30:14.437 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4544, 4550) -->  Mary journeyed to the kitchen
2025-01-22 06:30:14.437 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the hallway.
2025-01-22 06:30:14.451 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2719, 2725) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:30:15.231 | INFO     | test_jbb_embedding:begin_test:693 - The hallway.<|eot_id|>
2025-01-22 06:30:15.231 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8183])
2025-01-22 06:30:17.468 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [336.0625, 25.536682292939165, 166.18402777777777, 24.2724310757706, 13.058538732394366], 'topk_indices': array([8062, 8102, 8179, 8069, 2725, 6620, 8070, 8027,   24, 3614,   14,
       8181, 6621, 4158,   23, 8072, 8178, 4159, 8028,    0]), 'topk_tokens': ['.\n\n', ' the', '<|start_header_id|>', ' in', ' hallway', ' milk', ' the', ' you', '\n\n', ' garden', '\n', '<|end_header_id|>', '.', ' milk', '4', ' location', '<|eot_id|>', '.', ' context', '<|begin_of_text|>'], 'evidence_proportions': [387.125, 471.9375, 325.4, 486.8125, 102.80208333333333]}, 'weight': {'score': [22.533125, 23.289669481431712, 21.99435763888889, 23.294855435650252, 30.23899647887324], 'topk_indices': array([3319, 3292, 3212, 3164, 7449, 7411, 1509, 1447, 4296, 4312, 5140,
       5201, 7181, 7125, 3501, 3475, 4891, 4916, 4968, 4939]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.927083333333332, 26.611328125, 20.428125, 27.013671875, 20.1875]}, 'saliency': {'score': [2.0630810546875, 0.14335264368567524, 0.9332817925347222, 0.13571271553212882, 0.09892036545444542], 'topk_indices': array([8066, 8168, 8170, 8071, 5661, 8068, 3609, 8027, 8026, 8156, 6618,
         23,   20, 6617, 6620, 3614, 2725, 8072, 4158, 8028]), 'topk_tokens': [' obtained', ' milk', ' discarded', ' first', ' hallway', ' item', ' Daniel', ' you', ' provided', 'Question', ' dropped', '4', ' Jul', ' Daniel', ' milk', ' garden', ' hallway', ' location', ' milk', ' context'], 'evidence_proportions': [2.10595703125, 3.2255859375, 1.8865234375, 3.359619140625, 0.5279744466145834]}}, 'pred_res': 'The hallway.<|eot_id|>', 'score': 0}
2025-01-22 06:30:17.473 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:30:17.473 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-95_pid-2_4-5-7-8-9.pkl | len: 3 |  size: 2.08 KB
Processing depth (4, 5, 7, 8, 9):   3%|▎         | 3/100 [01:01<32:47, 20.29s/it]is_0k: False
your chose emoji: ['🙎🏼\u200d♀️', '🏃🏾\u200d♂\u200d➡️', '⛹🏽\u200d♀️', '🏃\u200d➡', '👳🏻\u200d♀', '🙎🏾\u200d♂️', '✊🏿', '🙆🏽', '🪛', '♑']
emoji:
O: 🙎🏼‍♀️ [9468, 247, 236, 9468, 237, 120, 102470, 32990, 31643]
N: 🙆🏽 [9468, 247, 228, 9468, 237, 121]

O: 🏃🏾‍♂‍➡️ [9468, 237, 225, 9468, 237, 122, 102470, 17245, 224, 102470, 98115, 94, 31643]
N: 👳🏻‍♀ [9468, 239, 111, 9468, 237, 119, 102470, 32990]

O: ⛹🏽‍♀️ [158, 249, 117, 9468, 237, 121, 102470, 32990, 31643]
N: 🙎🏾‍♂️ [9468, 247, 236, 9468, 237, 122, 102470, 17245, 224, 31643]

O: 🏃‍➡ [9468, 237, 225, 102470, 98115, 94]
N: 🏃‍➡ [9468, 237, 225, 102470, 98115, 94]

O: 👳🏻‍♀ [9468, 239, 111, 9468, 237, 119, 102470, 32990]
N: 🪛 [9468, 103, 249]

O: 🙎🏾‍♂️ [9468, 247, 236, 9468, 237, 122, 102470, 17245, 224, 31643]
N: 🏃🏾‍♂‍➡️ [9468, 237, 225, 9468, 237, 122, 102470, 17245, 224, 102470, 98115, 94, 31643]

O: ✊🏿 [38798, 232, 9468, 237, 123]
N: ✊🏿 [38798, 232, 9468, 237, 123]

O: 🙆🏽 [9468, 247, 228, 9468, 237, 121]
N: ⛹🏽‍♀️ [158, 249, 117, 9468, 237, 121, 102470, 32990, 31643]

O: 🪛 [9468, 103, 249]
N: 🙎🏼‍♀️ [9468, 247, 236, 9468, 237, 120, 102470, 32990, 31643]

O: ♑ [17245, 239]
N: ♑ [17245, 239]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.94s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.64s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.14s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.67s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.34s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 1, 2, 4, 6):   3%|▎         | 3/100 [01:17<32:47, 20.29s/it]2025-01-22 06:30:32.781 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went back to the garden.
2025-01-22 06:30:32.782 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 37) -->  went back to the garden.
2025-01-22 06:30:32.782 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel got the milk.
2025-01-22 06:30:32.787 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (903, 907) -->  Daniel got the milk
2025-01-22 06:30:32.787 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the hallway.
2025-01-22 06:30:32.798 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1867, 1872) --> . Daniel went to the
2025-01-22 06:30:32.798 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel dropped the milk.
2025-01-22 06:30:32.817 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (3641, 3645) -->  Daniel dropped the milk
2025-01-22 06:30:32.818 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary journeyed to the office.
2025-01-22 06:30:32.842 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4499, 4505) -->  execution. Mary journeyed to
2025-01-22 06:30:32.843 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went back to the kitchen.
2025-01-22 06:30:32.863 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4099, 4105) --> . Sandra went back to the
2025-01-22 06:30:32.863 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the kitchen.
2025-01-22 06:30:32.885 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4499, 4505) -->  execution. Mary journeyed to
2025-01-22 06:30:32.886 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the hallway.
2025-01-22 06:30:32.900 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2905, 2911) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:30:38.238 | INFO     | test_jbb_embedding:begin_test:693 - The hallway.<|eot_id|>
2025-01-22 06:30:38.239 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8181])
2025-01-22 06:30:41.502 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [597.8875, 36.250492576979475, 100.88194444444444, 34.38287295786758, 15.698800223214286], 'topk_indices': array([  14,   34, 8160, 8168,   31,   32, 3642, 3645,   33, 3644, 8161,
        906, 7372,   25,   28,  907,   35,    0, 8176, 8177]), 'topk_tokens': ['\n', ' the', ' prior', ' discarded', ' went', ' back', ' dropped', '.', ' to', ' milk', ' to', ' milk', 'nes', '<|eot_id|>', '<|end_header_id|>', '.', ' garden', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [1177.6666666666667, 835.875, 193.575, 842.875, 33.052083333333336]}, 'weight': {'score': [23.1646875, 23.265886562194527, 21.90234375, 23.269212166809975, 28.9359375], 'topk_indices': array([3312, 3339, 3232, 3184, 7457, 7419, 1431, 1493, 4367, 4351, 5176,
       5237, 7196, 7140, 3495, 3521, 5001, 4953, 4978, 5030]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.614583333333332, 26.611328125, 19.665625, 27.013671875, 23.766927083333332]}, 'saliency': {'score': [3.6156103515625, 0.19417198382514664, 0.5292494032118056, 0.18292430507039983, 0.11204812186104911], 'topk_indices': array([8156, 8174,  907, 1872, 7294,    0, 8154, 7371, 8166,  904,   30,
         32,   31, 3642, 8160, 7372, 3644, 8168,  906,   35]), 'topk_tokens': [' Where', 'Answer', '.', ' hallway', 'nes', '<|begin_of_text|>', 'Question', ' Min', ' milk', ' got', 'Daniel', ' back', ' went', ' dropped', ' prior', 'nes', ' milk', ' discarded', ' milk', ' garden'], 'evidence_proportions': [6.6513671875, 5.541015625, 0.9515625, 5.60400390625, 0.19069417317708334]}}, 'pred_res': 'The hallway.<|eot_id|>', 'score': 0}
2025-01-22 06:30:41.508 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:30:41.509 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-95_pid-3_0-1-2-4-6.pkl | len: 3 |  size: 2.08 KB
Processing depth (0, 1, 2, 4, 6):   4%|▍         | 4/100 [01:26<34:49, 21.77s/it]is_0k: False
your chose emoji: ['👩🏾\u200d🚀', '1️⃣', '🇲🇦', '🧜🏻\u200d♀️', '\U0001faf6🏽', '🤳🏽', '\U0001fa89', '🐾', '👩🏻\u200d❤️\u200d👨🏻', '🇻🇳']
emoji:
O: 👩🏾‍🚀 [9468, 239, 102, 9468, 237, 122, 102470, 9468, 248, 222]
N: 👩🏾‍🚀 [9468, 239, 102, 9468, 237, 122, 102470, 9468, 248, 222]

O: 1️⃣ [16, 31643, 158, 225, 96]
N: 👩🏻‍❤️‍👨🏻 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 119]

O: 🇲🇦 [9468, 229, 110, 9468, 229, 99]
N: 1️⃣ [16, 31643, 158, 225, 96]

O: 🧜🏻‍♀️ [9468, 100, 250, 9468, 237, 119, 102470, 32990, 31643]
N: 🇲🇦 [9468, 229, 110, 9468, 229, 99]

O: 🫶🏽 [9468, 104, 114, 9468, 237, 121]
N: 🧜🏻‍♀️ [9468, 100, 250, 9468, 237, 119, 102470, 32990, 31643]

O: 🤳🏽 [9468, 97, 111, 9468, 237, 121]
N: 🐾 [9468, 238, 122]

O: 🪉 [9468, 103, 231]
N: 🫶🏽 [9468, 104, 114, 9468, 237, 121]

O: 🐾 [9468, 238, 122]
N: 🤳🏽 [9468, 97, 111, 9468, 237, 121]

O: 👩🏻‍❤️‍👨🏻 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 119]
N: 🪉 [9468, 103, 231]

O: 🇻🇳 [9468, 229, 119, 9468, 229, 111]
N: 🇻🇳 [9468, 229, 119, 9468, 229, 111]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.65s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.40s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.40s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.19s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.65s/it]
Processing depth (0, 2, 4, 5, 8):   4%|▍         | 4/100 [01:42<34:49, 21.77s/it]2025-01-22 06:30:57.931 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went back to the garden.
2025-01-22 06:30:57.931 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 37) -->  went back to the garden.
2025-01-22 06:30:57.931 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel got the milk.
2025-01-22 06:30:57.940 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1849, 1853) -->  Daniel got the milk
2025-01-22 06:30:57.941 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel went to the hallway.
2025-01-22 06:30:57.958 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2890, 2895) -->  back to the hallway.
2025-01-22 06:30:57.958 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel dropped the milk.
2025-01-22 06:30:57.981 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4200, 4204) -->  Daniel dropped the milk
2025-01-22 06:30:57.982 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary journeyed to the office.
2025-01-22 06:30:58.005 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (4544, 4550) -->  journeyed to the kitchen.
2025-01-22 06:30:58.005 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went back to the kitchen.
2025-01-22 06:30:58.026 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (4164, 4170) --> . Sandra went back to the
2025-01-22 06:30:58.027 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the kitchen.
2025-01-22 06:30:58.053 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4543, 4549) -->  Mary journeyed to the kitchen
2025-01-22 06:30:58.053 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the hallway.
2025-01-22 06:30:58.070 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2888, 2894) -->  John went back to the hallway
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:30:58.894 | INFO     | test_jbb_embedding:begin_test:693 - The hallway.<|eot_id|>
2025-01-22 06:30:58.894 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8211])
2025-01-22 06:31:01.139 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [531.503125, 55.01640111395179, 150.65017361111111, 53.34786898788398, 25.822679227941176], 'topk_indices': array([2045,   14,   30, 2046,   32, 8206, 2103, 2043,   33,   29, 5761,
       7368,   36,   31, 1221, 2094, 2047, 5762,   35,    0]), 'topk_tokens': [' du', '\n', 'Daniel', ' Ch', ' back', '<|eot_id|>', ' the', 'ra', ' to', '\n\n', 'nes', 'nes', '.', ' went', 'nes', ' Ch', 'ien', 'ot', ' garden', '<|begin_of_text|>'], 'evidence_proportions': [1296.5833333333333, 547.8125, 226.075, 471.125, 50.325520833333336]}, 'weight': {'score': [22.458125, 23.29094952215729, 23.6875, 23.292624066821688, 29.146323529411763], 'topk_indices': array([3365, 3338, 3238, 3190, 7485, 7447, 1412, 1474, 4341, 4357, 5244,
       5183, 7192, 7136, 3521, 3547, 5008, 4985, 5037, 4960]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.614583333333332, 26.611328125, 20.428125, 27.013671875, 20.1875]}, 'saliency': {'score': [3.1934765625, 0.31298682484744034, 0.9762437608506944, 0.3027125783305669, 0.19168593462775735], 'topk_indices': array([1971,   38, 1049, 1852, 2043, 8198, 1161, 2046, 2045,   32, 2044,
         30, 7368, 5761,   31, 1221, 2047, 2094, 5762,   35]), 'topk_tokens': [' inhabit', 'UL', ' galaxy', ' milk', 'ra', ' discarded', 'nes', ' Ch', ' du', ' back', 'irie', 'Daniel', 'nes', 'nes', ' went', 'nes', 'ien', ' Ch', 'ot', ' garden'], 'evidence_proportions': [7.4140625, 3.710693359375, 1.2162109375, 3.203857421875, 0.2688802083333333]}}, 'pred_res': 'The hallway.<|eot_id|>', 'score': 0}
2025-01-22 06:31:01.146 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:31:01.146 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-95_pid-4_0-2-4-5-8.pkl | len: 3 |  size: 1.99 KB
Processing depth (0, 2, 4, 5, 8):   5%|▌         | 5/100 [01:45<33:14, 21.00s/it]Processing depth (0, 2, 4, 5, 8):   5%|▌         | 5/100 [01:45<33:28, 21.14s/it]
2025-01-22 06:31:01.201 | INFO     | __main__:<module>:82 - Selected idx: 96
2025-01-22 06:31:01.201 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the football before the bathroom? 
2025-01-22 06:31:01.201 | INFO     | __main__:<module>:84 - Answer: hallway
2025-01-22 06:31:01.201 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 06:31:01.201 | INFO     | __main__:<module>:86 - Needle: [' John went back to the hallway.', ' Daniel went to the hallway.', ' Daniel moved to the bathroom.', ' Sandra went back to the kitchen.', ' Mary journeyed to the office.', ' Daniel dropped the football.', ' Mary journeyed to the kitchen.']
2025-01-22 06:31:01.201 | INFO     | __main__:<module>:87 - Real Needle: [' Daniel went to the hallway.', ' Daniel moved to the bathroom.', ' Daniel dropped the football.', ' Mary journeyed to the kitchen.']
2025-01-22 06:31:01.201 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['🙅', '👨🏼\u200d🔬', '🧑🏿\u200d🤝\u200d🧑🏻', '🙋🏽\u200d♂', '📒', '🦸🏼\u200d♂️', '🇻🇨', '👩🏽\u200d🤝\u200d👩🏿', '🌦', '⛹\u200d♂️']
emoji:
O: 🙅 [9468, 247, 227]
N: 📒 [9468, 241, 240]

O: 👨🏼‍🔬 [9468, 239, 101, 9468, 237, 120, 102470, 9468, 242, 105]
N: 🧑🏿‍🤝‍🧑🏻 [9468, 100, 239, 9468, 237, 123, 102470, 9468, 97, 251, 102470, 9468, 100, 239, 9468, 237, 119]

O: 🧑🏿‍🤝‍🧑🏻 [9468, 100, 239, 9468, 237, 123, 102470, 9468, 97, 251, 102470, 9468, 100, 239, 9468, 237, 119]
N: 👩🏽‍🤝‍👩🏿 [9468, 239, 102, 9468, 237, 121, 102470, 9468, 97, 251, 102470, 9468, 239, 102, 9468, 237, 123]

O: 🙋🏽‍♂ [9468, 247, 233, 9468, 237, 121, 102470, 17245, 224]
N: 👨🏼‍🔬 [9468, 239, 101, 9468, 237, 120, 102470, 9468, 242, 105]

O: 📒 [9468, 241, 240]
N: 🌦 [9468, 234, 99]

O: 🦸🏼‍♂️ [9468, 99, 116, 9468, 237, 120, 102470, 17245, 224, 31643]
N: 🙅 [9468, 247, 227]

O: 🇻🇨 [9468, 229, 119, 9468, 229, 101]
N: 🙋🏽‍♂ [9468, 247, 233, 9468, 237, 121, 102470, 17245, 224]

O: 👩🏽‍🤝‍👩🏿 [9468, 239, 102, 9468, 237, 121, 102470, 9468, 97, 251, 102470, 9468, 239, 102, 9468, 237, 123]
N: 🦸🏼‍♂️ [9468, 99, 116, 9468, 237, 120, 102470, 17245, 224, 31643]

O: 🌦 [9468, 234, 99]
N: 🇻🇨 [9468, 229, 119, 9468, 229, 101]

O: ⛹‍♂️ [158, 249, 117, 102470, 17245, 224, 31643]
N: ⛹‍♂️ [158, 249, 117, 102470, 17245, 224, 31643]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.21s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.69s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:03,  3.98s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  2.57s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  3.20s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 2, 4, 5):   0%|          | 0/100 [00:14<?, ?it/s]2025-01-22 06:31:15.862 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went to the hallway.
2025-01-22 06:31:15.863 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  went to the hallway.
2025-01-22 06:31:15.863 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the bathroom.
2025-01-22 06:31:15.875 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (1866, 1871) --> . Daniel moved to the
2025-01-22 06:31:15.875 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel dropped the football.
2025-01-22 06:31:15.892 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3641, 3645) -->  Daniel dropped the football
2025-01-22 06:31:15.892 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary journeyed to the kitchen.
2025-01-22 06:31:15.898 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1101, 1107) --> . Mary journeyed to the
2025-01-22 06:31:15.898 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the hallway.
2025-01-22 06:31:15.934 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6164, 6170) -->  John went back to the hallway
2025-01-22 06:31:15.934 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the kitchen.
2025-01-22 06:31:15.955 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4261, 4267) -->  Sandra went back to the kitchen
2025-01-22 06:31:15.955 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the office.
2025-01-22 06:31:15.961 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1101, 1107) --> . Mary journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:31:20.797 | INFO     | test_jbb_embedding:begin_test:693 - The hallway.<|eot_id|>
2025-01-22 06:31:20.797 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8190])
2025-01-22 06:31:24.078 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [287.465625, 23.858087696814355, 150.79513888888889, 22.931414776210914, 23.88497999237805], 'topk_indices': array([   3,    1, 8178, 8186, 8180,   35, 1868, 6169,   14,  185,   24,
       1871, 1634,   25, 3644,   28, 1712, 8188, 8185,    0]), 'topk_tokens': ['<|end_header_id|>', '<|start_header_id|>', ' before', '<|start_header_id|>', ' bathroom', '.', ' moved', ' hallway', '\n', 'ION', '\n\n', ' bathroom', ' work', '<|eot_id|>', ' football', '<|end_header_id|>', "'s", '<|end_header_id|>', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [355.3, 328.325, 410.15625, 115.09375]}, 'weight': {'score': [21.679296875, 23.307453771512268, 23.6875, 23.310607947578173, 30.021150914634145], 'topk_indices': array([3302, 3329, 3174, 3222, 7443, 7481, 1412, 1474, 4354, 4338, 5177,
       5238, 7220, 7164, 3511, 3485, 4979, 5002, 4954, 5031]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.871875, 19.909375, 27.341796875, 20.052083333333332]}, 'saliency': {'score': [1.66839599609375, 0.13534158888017972, 0.9929470486111112, 0.12968886215799355, 0.17795283619950458], 'topk_indices': array([8172, 1632,   39, 8183, 8159,   24,    0, 3642, 1711, 8178,  185,
       1634, 8177, 1712, 1868,   34, 8180, 1871, 3644, 6169]), 'topk_tokens': ['Question', ' summer', '\n\n\n', 'Answer', ' return', '\n\n', '<|begin_of_text|>', ' dropped', ' summer', ' before', 'ION', ' work', ' football', "'s", ' moved', ' hallway', ' bathroom', ' bathroom', ' football', ' hallway'], 'evidence_proportions': [1.95390625, 1.7240234375, 2.825439453125, 0.6127522786458334]}}, 'pred_res': 'The hallway.<|eot_id|>', 'score': 100}
2025-01-22 06:31:24.095 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:31:24.096 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-96_pid-0_0-2-4-5.pkl | len: 3 |  size: 2.09 KB
Processing depth (0, 2, 4, 5):   1%|          | 1/100 [00:22<37:36, 22.79s/it]is_0k: False
your chose emoji: ['👯\u200d♀', '🏃🏽\u200d♂️\u200d➡️', '🧎🏾\u200d♀️\u200d➡️', '👨🏻\u200d🚀', '☯', '🤷🏾\u200d♀️', '🧑🏾\u200d🌾', '🚴🏾\u200d♂️', '🇩🇬', '🚫']
emoji:
O: 👯‍♀ [9468, 239, 107, 102470, 32990]
N: 🤷🏾‍♀️ [9468, 97, 115, 9468, 237, 122, 102470, 32990, 31643]

O: 🏃🏽‍♂️‍➡️ [9468, 237, 225, 9468, 237, 121, 102470, 17245, 224, 31643, 102470, 98115, 94, 31643]
N: 🚴🏾‍♂️ [9468, 248, 112, 9468, 237, 122, 102470, 17245, 224, 31643]

O: 🧎🏾‍♀️‍➡️ [9468, 100, 236, 9468, 237, 122, 102470, 32990, 31643, 102470, 98115, 94, 31643]
N: 👨🏻‍🚀 [9468, 239, 101, 9468, 237, 119, 102470, 9468, 248, 222]

O: 👨🏻‍🚀 [9468, 239, 101, 9468, 237, 119, 102470, 9468, 248, 222]
N: 🧎🏾‍♀️‍➡️ [9468, 100, 236, 9468, 237, 122, 102470, 32990, 31643, 102470, 98115, 94, 31643]

O: ☯ [18107, 107]
N: 🇩🇬 [9468, 229, 102, 9468, 229, 105]

O: 🤷🏾‍♀️ [9468, 97, 115, 9468, 237, 122, 102470, 32990, 31643]
N: 🏃🏽‍♂️‍➡️ [9468, 237, 225, 9468, 237, 121, 102470, 17245, 224, 31643, 102470, 98115, 94, 31643]

O: 🧑🏾‍🌾 [9468, 100, 239, 9468, 237, 122, 102470, 9468, 234, 122]
N: ☯ [18107, 107]

O: 🚴🏾‍♂️ [9468, 248, 112, 9468, 237, 122, 102470, 17245, 224, 31643]
N: 🧑🏾‍🌾 [9468, 100, 239, 9468, 237, 122, 102470, 9468, 234, 122]

O: 🇩🇬 [9468, 229, 102, 9468, 229, 105]
N: 👯‍♀ [9468, 239, 107, 102470, 32990]

O: 🚫 [9468, 248, 104]
N: 🚫 [9468, 248, 104]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:05<00:15,  5.19s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:10<00:10,  5.25s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.63s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.14s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.81s/it]
Processing depth (4, 6, 7, 8):   1%|          | 1/100 [00:39<37:36, 22.79s/it]2025-01-22 06:31:41.055 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went to the hallway.
2025-01-22 06:31:41.073 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3622, 3627) --> . Daniel went to the
2025-01-22 06:31:41.073 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the bathroom.
2025-01-22 06:31:41.097 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4746, 4751) -->  Daniel moved to the bathroom
2025-01-22 06:31:41.097 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel dropped the football.
2025-01-22 06:31:41.124 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (5648, 5652) -->  Daniel dropped the football
2025-01-22 06:31:41.124 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary journeyed to the kitchen.
2025-01-22 06:31:41.130 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1045, 1051) --> . Mary journeyed to the
2025-01-22 06:31:41.130 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the hallway.
2025-01-22 06:31:41.161 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6238, 6244) --> . John went back to the
2025-01-22 06:31:41.161 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the kitchen.
2025-01-22 06:31:41.183 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4239, 4245) -->  Sandra went back to the kitchen
2025-01-22 06:31:41.183 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the office.
2025-01-22 06:31:41.188 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1045, 1051) --> . Mary journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:31:41.968 | INFO     | test_jbb_embedding:begin_test:693 - The hallway.<|eot_id|>
2025-01-22 06:31:41.968 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8198])
2025-01-22 06:31:44.214 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [155.3296875, 17.083854103158153, 95.49652777777777, 16.572235238270245, 16.520712209302324], 'topk_indices': array([   3, 5934,    1,    4, 8192, 5651, 8197, 8086, 5952, 5953,    9,
         23, 6089,   24, 5954,   14, 6090, 8196,    0, 8193]), 'topk_tokens': ['<|end_header_id|>', 'ayers', '<|start_header_id|>', '\n\n', ':', ' football', '\n\n', '.\n\n', ',', ' in', ':', '4', ',', '\n\n', ' which', '\n', ' in', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [147.275, 170.4, 281.78125, 65.18229166666667]}, 'weight': {'score': [22.8, 23.300660742592367, 21.99435763888889, 23.30476789323778, 29.39480377906977], 'topk_indices': array([3333, 3306, 3192, 3144, 7441, 7479, 1412, 1474, 4316, 4332, 5179,
       5240, 7162, 7218, 3489, 3515, 5033, 5004, 4956, 4981]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.665625, 25.5984375, 27.341796875, 20.052083333333332]}, 'saliency': {'score': [0.981903076171875, 0.09403144195448726, 0.5485568576388888, 0.09085382463650772, 0.12443817493527434], 'topk_indices': array([7586, 7542, 5953, 7587, 8086, 8195,   16, 8188,   23, 8167, 8191,
       6090,   24,   20,    8, 8096, 6244, 5934, 5954, 5651]), 'topk_tokens': [' Min', 'nes', ' in', 'nes', '.\n\n', 'assistant', ' Date', ' bathroom', '4', ' return', 'Answer', ' in', '\n\n', ' Jul', ' Date', ' location', ' hallway', 'ayers', ' which', ' football'], 'evidence_proportions': [0.810595703125, 1.197802734375, 1.9002685546875, 0.3324991861979167]}}, 'pred_res': 'The hallway.<|eot_id|>', 'score': 100}
2025-01-22 06:31:44.220 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:31:44.221 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-96_pid-1_4-6-7-8.pkl | len: 3 |  size: 1.98 KB
Processing depth (4, 6, 7, 8):   2%|▏         | 2/100 [00:42<34:39, 21.22s/it]is_0k: False
your chose emoji: ['🚵🏼\u200d♀', '🧎🏻\u200d➡', '👮🏿\u200d♀️', '⏯', '🦹🏻\u200d♀', '👨🏿\u200d🤝\u200d👨🏻', '\U0001faf1🏿', '🧑🏾\u200d❤\u200d🧑🏿', '📡', '🏄🏽\u200d♀']
emoji:
O: 🚵🏼‍♀ [9468, 248, 113, 9468, 237, 120, 102470, 32990]
N: 📡 [9468, 241, 94]

O: 🧎🏻‍➡ [9468, 100, 236, 9468, 237, 119, 102470, 98115, 94]
N: 🚵🏼‍♀ [9468, 248, 113, 9468, 237, 120, 102470, 32990]

O: 👮🏿‍♀️ [9468, 239, 106, 9468, 237, 123, 102470, 32990, 31643]
N: 👮🏿‍♀️ [9468, 239, 106, 9468, 237, 123, 102470, 32990, 31643]

O: ⏯ [158, 237, 107]
N: 👨🏿‍🤝‍👨🏻 [9468, 239, 101, 9468, 237, 123, 102470, 9468, 97, 251, 102470, 9468, 239, 101, 9468, 237, 119]

O: 🦹🏻‍♀ [9468, 99, 117, 9468, 237, 119, 102470, 32990]
N: 🧎🏻‍➡ [9468, 100, 236, 9468, 237, 119, 102470, 98115, 94]

O: 👨🏿‍🤝‍👨🏻 [9468, 239, 101, 9468, 237, 123, 102470, 9468, 97, 251, 102470, 9468, 239, 101, 9468, 237, 119]
N: 🦹🏻‍♀ [9468, 99, 117, 9468, 237, 119, 102470, 32990]

O: 🫱🏿 [9468, 104, 109, 9468, 237, 123]
N: 🧑🏾‍❤‍🧑🏿 [9468, 100, 239, 9468, 237, 122, 102470, 121643, 102470, 9468, 100, 239, 9468, 237, 123]

O: 🧑🏾‍❤‍🧑🏿 [9468, 100, 239, 9468, 237, 122, 102470, 121643, 102470, 9468, 100, 239, 9468, 237, 123]
N: ⏯ [158, 237, 107]

O: 📡 [9468, 241, 94]
N: 🫱🏿 [9468, 104, 109, 9468, 237, 123]

O: 🏄🏽‍♀ [9468, 237, 226, 9468, 237, 121, 102470, 32990]
N: 🏄🏽‍♀ [9468, 237, 226, 9468, 237, 121, 102470, 32990]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.49s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.61s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.49s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  2.91s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.50s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 1, 5, 8):   2%|▏         | 2/100 [00:58<34:39, 21.22s/it]2025-01-22 06:32:00.026 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went to the hallway.
2025-01-22 06:32:00.027 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  went to the hallway.
2025-01-22 06:32:00.027 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the bathroom.
2025-01-22 06:32:00.032 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (851, 856) --> . Daniel moved to the
2025-01-22 06:32:00.032 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel dropped the football.
2025-01-22 06:32:00.056 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4173, 4177) -->  Daniel dropped the football
2025-01-22 06:32:00.056 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary journeyed to the kitchen.
2025-01-22 06:32:00.062 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1087, 1093) --> . Mary journeyed to the
2025-01-22 06:32:00.062 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the hallway.
2025-01-22 06:32:00.099 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6222, 6228) --> . John went back to the
2025-01-22 06:32:00.099 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the kitchen.
2025-01-22 06:32:00.123 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4244, 4250) -->  Sandra went back to the kitchen
2025-01-22 06:32:00.123 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the office.
2025-01-22 06:32:00.129 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1087, 1093) --> . Mary journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:32:03.749 | INFO     | test_jbb_embedding:begin_test:693 - The hallway.<|eot_id|>
2025-01-22 06:32:03.749 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8180])
2025-01-22 06:32:06.484 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [136.8984375, 13.34329173286081, 79.65277777777777, 12.893362492326581, 12.839032061688311], 'topk_indices': array([   4, 8153, 8078, 4176, 8168, 8176, 8174, 8149,   23,   25,    9,
       8179, 8068,    1,   24, 8178, 6228,   14,    0, 8175]), 'topk_tokens': ['\n\n', '.', ' location', ' football', ' before', '<|start_header_id|>', ':', ' return', '4', '<|eot_id|>', ':', '\n\n', '.\n\n', '<|start_header_id|>', '\n\n', '<|end_header_id|>', ' hallway', '\n', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [192.025, 129.35, 205.296875, 51.651041666666664]}, 'weight': {'score': [21.679296875, 23.279901930832214, 21.99435763888889, 23.286673189073053, 28.993100649350648], 'topk_indices': array([3325, 3298, 3218, 3170, 7443, 7405, 1466, 1528, 4321, 4337, 5136,
       5197, 7126, 7182, 3507, 3481, 4938, 4961, 4913, 4990]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.871875, 19.909375, 27.341796875, 20.052083333333332]}, 'saliency': {'score': [0.7834075927734375, 0.07446431525103492, 0.4280632866753472, 0.07194207497650015, 0.09345265177937297], 'topk_indices': array([  23, 8179, 8162,   14, 8173,    0,  856,   34,    8, 8152, 8068,
         24, 7358, 8168, 8078, 8170, 8167, 8149, 4176, 6228]), 'topk_tokens': ['4', '\n\n', 'Question', '\n', 'Answer', '<|begin_of_text|>', ' bathroom', ' hallway', ' Date', ' directly', '.\n\n', '\n\n', 'nes', ' before', ' location', ' bathroom', ' football', ' return', ' football', ' hallway'], 'evidence_proportions': [1.038330078125, 0.662890625, 1.4046630859375, 0.257232666015625]}}, 'pred_res': 'The hallway.<|eot_id|>', 'score': 100}
2025-01-22 06:32:06.490 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:32:06.491 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-96_pid-2_0-1-5-8.pkl | len: 3 |  size: 2.04 KB
Processing depth (0, 1, 5, 8):   3%|▎         | 3/100 [01:05<35:05, 21.70s/it]is_0k: False
your chose emoji: ['🤜🏾', '👩🏾\u200d❤\u200d💋\u200d👨🏾', '🚁', '☝', '🫖', '🙋🏼\u200d♂', '👩🏾', '🇵🇪', '👨\u200d🔬', '👨🏻\u200d🤝\u200d👨🏿']
emoji:
O: 🤜🏾 [9468, 97, 250, 9468, 237, 122]
N: 👩🏾‍❤‍💋‍👨🏾 [9468, 239, 102, 9468, 237, 122, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 122]

O: 👩🏾‍❤‍💋‍👨🏾 [9468, 239, 102, 9468, 237, 122, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 122]
N: 👩🏾 [9468, 239, 102, 9468, 237, 122]

O: 🚁 [9468, 248, 223]
N: 🫖 [9468, 104, 244]

O: ☝ [18107, 251]
N: 🙋🏼‍♂ [9468, 247, 233, 9468, 237, 120, 102470, 17245, 224]

O: 🫖 [9468, 104, 244]
N: 👨‍🔬 [9468, 239, 101, 102470, 9468, 242, 105]

O: 🙋🏼‍♂ [9468, 247, 233, 9468, 237, 120, 102470, 17245, 224]
N: ☝ [18107, 251]

O: 👩🏾 [9468, 239, 102, 9468, 237, 122]
N: 🚁 [9468, 248, 223]

O: 🇵🇪 [9468, 229, 113, 9468, 229, 103]
N: 🤜🏾 [9468, 97, 250, 9468, 237, 122]

O: 👨‍🔬 [9468, 239, 101, 102470, 9468, 242, 105]
N: 🇵🇪 [9468, 229, 113, 9468, 229, 103]

O: 👨🏻‍🤝‍👨🏿 [9468, 239, 101, 9468, 237, 119, 102470, 9468, 97, 251, 102470, 9468, 239, 101, 9468, 237, 123]
N: 👨🏻‍🤝‍👨🏿 [9468, 239, 101, 9468, 237, 119, 102470, 9468, 97, 251, 102470, 9468, 239, 101, 9468, 237, 123]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.81s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.70s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.61s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.20s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.74s/it]
Processing depth (2, 4, 5, 8):   3%|▎         | 3/100 [01:21<35:05, 21.70s/it]2025-01-22 06:32:23.205 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went to the hallway.
2025-01-22 06:32:23.216 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2005, 2010) -->  cable. Daniel went to
2025-01-22 06:32:23.217 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the bathroom.
2025-01-22 06:32:23.238 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3711, 3716) -->  Daniel moved to the bathroom
2025-01-22 06:32:23.238 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel dropped the football.
2025-01-22 06:32:23.258 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4257, 4261) -->  Daniel dropped the football
2025-01-22 06:32:23.258 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary journeyed to the kitchen.
2025-01-22 06:32:23.265 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (1095, 1101) --> . Mary journeyed to the
2025-01-22 06:32:23.265 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the hallway.
2025-01-22 06:32:23.301 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6119, 6125) -->  John went back to the hallway
2025-01-22 06:32:23.301 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the kitchen.
2025-01-22 06:32:23.326 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4311, 4317) --> . Sandra went back to the
2025-01-22 06:32:23.326 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the office.
2025-01-22 06:32:23.332 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (1095, 1101) --> . Mary journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:32:24.157 | INFO     | test_jbb_embedding:begin_test:693 - The hallway.<|eot_id|>
2025-01-22 06:32:24.157 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8160])
2025-01-22 06:32:26.372 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [261.778125, 20.956204826656865, 209.46180555555554, 19.9458, 17.984593633395523], 'topk_indices': array([  23, 8148,    4, 8129, 2012, 8159,    1,    9, 3715, 8154, 2011,
          3, 6124,   24,   14, 3712, 4260, 8158,    0, 8155]), 'topk_tokens': ['4', ' before', '\n\n', ' return', '.', '\n\n', '<|start_header_id|>', ':', ' bathroom', ':', ' hallway', '<|end_header_id|>', ' hallway', '\n\n', '\n', ' moved', ' football', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [218.625, 376.925, 370.09375, 129.57291666666666]}, 'weight': {'score': [23.906640625, 23.272023918902363, 22.35720486111111, 23.27248846153846, 29.378498134328357], 'topk_indices': array([3238, 3265, 3110, 3158, 7439, 7401, 1468, 1406, 4229, 4245, 5150,
       5211, 7122, 7178, 3421, 3447, 4907, 4984, 4932, 4955]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [24.0921875, 25.5984375, 27.341796875, 20.052083333333332]}, 'saliency': {'score': [1.70806884765625, 0.11789611494893115, 1.30224609375, 0.11135805288461538, 0.1317990431145056], 'topk_indices': array([4258, 4312, 8058, 3711,    8, 8142, 2008, 8148, 4317, 8153,   24,
       8129, 3705, 8147, 8150, 3715, 2011, 6124, 3712, 4260]), 'topk_tokens': [' dropped', ' Sandra', ' location', ' Daniel', ' Date', 'Question', ' went', ' before', ' kitchen', 'Answer', '\n\n', ' return', '�', ' football', ' bathroom', ' bathroom', ' hallway', ' hallway', ' moved', ' football'], 'evidence_proportions': [1.292431640625, 2.65419921875, 2.563720703125, 0.695556640625]}}, 'pred_res': 'The hallway.<|eot_id|>', 'score': 100}
2025-01-22 06:32:26.386 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:32:26.387 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-96_pid-3_2-4-5-8.pkl | len: 3 |  size: 2.05 KB
Processing depth (2, 4, 5, 8):   4%|▍         | 4/100 [01:25<33:34, 20.99s/it]is_0k: False
your chose emoji: ['🆑', '📹', '🧑🏾\u200d🦰', '🙆🏼\u200d♀️', '🤵', '🪑', '🚶🏼\u200d♀', '👨🏽\u200d❤️\u200d👨🏼', '🚊', '💁🏽\u200d♂️']
emoji:
O: 🆑 [9468, 228, 239]
N: 🆑 [9468, 228, 239]

O: 📹 [9468, 241, 117]
N: 📹 [9468, 241, 117]

O: 🧑🏾‍🦰 [9468, 100, 239, 9468, 237, 122, 102470, 9468, 99, 108]
N: 🙆🏼‍♀️ [9468, 247, 228, 9468, 237, 120, 102470, 32990, 31643]

O: 🙆🏼‍♀️ [9468, 247, 228, 9468, 237, 120, 102470, 32990, 31643]
N: 🚊 [9468, 248, 232]

O: 🤵 [9468, 97, 113]
N: 🚶🏼‍♀ [9468, 248, 114, 9468, 237, 120, 102470, 32990]

O: 🪑 [9468, 103, 239]
N: 👨🏽‍❤️‍👨🏼 [9468, 239, 101, 9468, 237, 121, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 120]

O: 🚶🏼‍♀ [9468, 248, 114, 9468, 237, 120, 102470, 32990]
N: 🧑🏾‍🦰 [9468, 100, 239, 9468, 237, 122, 102470, 9468, 99, 108]

O: 👨🏽‍❤️‍👨🏼 [9468, 239, 101, 9468, 237, 121, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 120]
N: 🤵 [9468, 97, 113]

O: 🚊 [9468, 248, 232]
N: 🪑 [9468, 103, 239]

O: 💁🏽‍♂️ [93273, 223, 9468, 237, 121, 102470, 17245, 224, 31643]
N: 💁🏽‍♂️ [93273, 223, 9468, 237, 121, 102470, 17245, 224, 31643]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.70s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.66s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.38s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.83s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.46s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 4, 5, 9):   4%|▍         | 4/100 [01:40<33:34, 20.99s/it]2025-01-22 06:32:41.969 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went to the hallway.
2025-01-22 06:32:41.970 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  went to the hallway.
2025-01-22 06:32:41.970 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel moved to the bathroom.
2025-01-22 06:32:41.988 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (3617, 3622) -->  Hon. Daniel moved to
2025-01-22 06:32:41.988 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel dropped the football.
2025-01-22 06:32:42.008 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4220, 4224) -->  dropped the football.
2025-01-22 06:32:42.008 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Mary journeyed to the kitchen.
2025-01-22 06:32:42.013 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (983, 989) --> . Mary journeyed to the
2025-01-22 06:32:42.013 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  John went back to the hallway.
2025-01-22 06:32:42.044 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (6188, 6194) --> . John went back to the
2025-01-22 06:32:42.044 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Sandra went back to the kitchen.
2025-01-22 06:32:42.065 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4242, 4248) -->  Sandra went back to the kitchen
2025-01-22 06:32:42.065 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the office.
2025-01-22 06:32:42.070 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (983, 989) --> . Mary journeyed to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:32:44.993 | INFO     | test_jbb_embedding:begin_test:693 - The hallway.<|eot_id|>
2025-01-22 06:32:44.993 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8156])
2025-01-22 06:32:47.820 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [303.14375, 24.363697297462924, 162.98263888888889, 23.36988594384928, 46.71847956730769], 'topk_indices': array([8054, 8129, 6194, 8150,   34, 8143, 3620,   28, 3623, 8144, 8146,
       4222, 2116,   14,   24,    3, 8154, 8152, 8151,    0]), 'topk_tokens': [' location', '.', ' hallway', ':', ' hallway', ' football', ' moved', '<|end_header_id|>', ' bathroom', ' before', ' bathroom', ' football', ' the', '\n', '\n\n', '<|end_header_id|>', '<|end_header_id|>', '<|start_header_id|>', '<|eot_id|>', '<|begin_of_text|>'], 'evidence_proportions': [349.15, 344.525, 405.0, 162.41666666666666]}, 'weight': {'score': [21.658984375, 23.27777990562569, 21.99435763888889, 23.284611270163772, 29.91466346153846], 'topk_indices': array([3280, 3307, 3152, 3200, 7441, 7403, 1492, 1430, 4295, 4311, 5112,
       5173, 7117, 7173, 3489, 3463, 4889, 4914, 4937, 4966]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.871875, 24.7171875, 21.23046875, 20.052083333333332]}, 'saliency': {'score': [1.75640869140625, 0.13739693668897077, 0.9008246527777778, 0.13171759498426147, 0.34351806640625], 'topk_indices': array([4226, 4231, 2069, 8140, 3619, 2114, 8128, 8125, 8149,   24, 8054,
       8138, 8144, 3620, 8143, 6194,   34, 4222, 3623, 8146]), 'topk_tokens': ['�', '�', ' river', ' Where', ' Daniel', ' farther', ' directly', ' return', 'Answer', '\n\n', ' location', 'Question', ' before', ' moved', ' football', ' hallway', ' hallway', ' football', ' bathroom', ' bathroom'], 'evidence_proportions': [2.0490234375, 2.0671875, 2.3726806640625, 0.8427327473958334]}}, 'pred_res': 'The hallway.<|eot_id|>', 'score': 100}
2025-01-22 06:32:47.827 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:32:47.827 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-96_pid-4_0-4-5-9.pkl | len: 3 |  size: 2.08 KB
Processing depth (0, 4, 5, 9):   5%|▌         | 5/100 [01:46<33:29, 21.15s/it]Processing depth (0, 4, 5, 9):   5%|▌         | 5/100 [01:46<33:45, 21.32s/it]
2025-01-22 06:32:47.894 | INFO     | __main__:<module>:82 - Selected idx: 97
2025-01-22 06:32:47.894 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the location prior to the place where the milk was discarded, left or dropped?
2025-01-22 06:32:47.894 | INFO     | __main__:<module>:84 - Answer: hallway
2025-01-22 06:32:47.894 | INFO     | __main__:<module>:85 - Tag: 4-hop
2025-01-22 06:32:47.894 | INFO     | __main__:<module>:86 - Needle: [' Daniel went to the hallway.', ' Sandra went back to the kitchen.', ' Mary journeyed to the office.', ' Daniel got the milk.', ' Daniel moved to the bathroom.', ' John went back to the hallway.', ' Daniel dropped the milk.', ' Mary journeyed to the kitchen.']
2025-01-22 06:32:47.894 | INFO     | __main__:<module>:87 - Real Needle: [' Daniel went to the hallway.', ' Daniel got the milk.', ' Daniel moved to the bathroom.', ' Daniel dropped the milk.', ' Mary journeyed to the kitchen.']
2025-01-22 06:32:47.894 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['👨🏾\u200d❤\u200d👨🏾', '🧛🏻\u200d♂', '🧎🏿\u200d♀\u200d➡️', '◀', '🖨', '✳️', '👨🏼\u200d🍼', '◻', '👳🏾', '🎚️']
emoji:
O: 👨🏾‍❤‍👨🏾 [9468, 239, 101, 9468, 237, 122, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 122]
N: 👳🏾 [9468, 239, 111, 9468, 237, 122]

O: 🧛🏻‍♂ [9468, 100, 249, 9468, 237, 119, 102470, 17245, 224]
N: 🖨 [9468, 244, 101]

O: 🧎🏿‍♀‍➡️ [9468, 100, 236, 9468, 237, 123, 102470, 32990, 102470, 98115, 94, 31643]
N: 🧎🏿‍♀‍➡️ [9468, 100, 236, 9468, 237, 123, 102470, 32990, 102470, 98115, 94, 31643]

O: ◀ [41832, 222]
N: 🧛🏻‍♂ [9468, 100, 249, 9468, 237, 119, 102470, 17245, 224]

O: 🖨 [9468, 244, 101]
N: ✳️ [38798, 111, 31643]

O: ✳️ [38798, 111, 31643]
N: 👨🏼‍🍼 [9468, 239, 101, 9468, 237, 120, 102470, 9468, 104247]

O: 👨🏼‍🍼 [9468, 239, 101, 9468, 237, 120, 102470, 9468, 104247]
N: ◻ [41832, 119]

O: ◻ [41832, 119]
N: 👨🏾‍❤‍👨🏾 [9468, 239, 101, 9468, 237, 122, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 122]

O: 👳🏾 [9468, 239, 111, 9468, 237, 122]
N: ◀ [41832, 222]

O: 🎚️ [9468, 236, 248, 31643]
N: 🎚️ [9468, 236, 248, 31643]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.38s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.78s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.83s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.30s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.82s/it]
Processing depth (3, 5, 6, 7, 8):   0%|          | 0/100 [00:16<?, ?it/s]2025-01-22 06:33:04.954 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went to the hallway.
2025-01-22 06:33:04.977 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (2538, 2543) -->  back to the hallway.
2025-01-22 06:33:04.978 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel got the milk.
2025-01-22 06:33:04.999 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (4235, 4239) -->  got the milk.
2025-01-22 06:33:04.999 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the bathroom.
2025-01-22 06:33:05.023 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4806, 4811) -->  the senate. Daniel moved
2025-01-22 06:33:05.023 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel dropped the milk.
2025-01-22 06:33:05.052 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5649, 5653) -->  Daniel dropped the milk
2025-01-22 06:33:05.053 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary journeyed to the kitchen.
2025-01-22 06:33:05.088 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6552, 6558) -->  Mary journeyed to the kitchen
2025-01-22 06:33:05.088 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went back to the kitchen.
2025-01-22 06:33:05.108 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3484, 3490) --> . Sandra went back to the
2025-01-22 06:33:05.109 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the office.
2025-01-22 06:33:05.144 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6553, 6559) -->  journeyed to the kitchen.
2025-01-22 06:33:05.144 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the hallway.
2025-01-22 06:33:05.157 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2535, 2541) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:33:05.920 | INFO     | test_jbb_embedding:begin_test:693 - the hallway<|eot_id|>
2025-01-22 06:33:05.920 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8212])
2025-01-22 06:33:08.163 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [387.8489583333333, 34.81482425441266, 319.1666666666667, 33.15189113544598, 22.982921511627907], 'topk_indices': array([   9, 8091,   24, 2533, 3521, 3520, 3523, 2535, 2537, 4237, 2522,
       2521, 2921, 4238,   14, 2536, 8207, 3522, 2541,    0]), 'topk_tokens': [':', '.\n\n', '\n\n', '\n', '      ', ' *', '      ', '.', ' went', ' milk', ' There', '.', ' hallway', '.', '\n', ' John', '<|eot_id|>', ' *', ' hallway', '<|begin_of_text|>'], 'evidence_proportions': [610.15, 630.0, 295.3375, 427.3125, 91.94791666666667]}, 'weight': {'score': [23.318359375, 23.305019400486913, 20.70920138888889, 23.31069718891472, 29.70730377906977], 'topk_indices': array([3318, 3345, 3190, 3238, 7486, 7448, 1489, 1427, 4325, 4309, 5241,
       5180, 7149, 7205, 3508, 3534, 5005, 4982, 4957, 5034]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.428125, 20.5, 24.6375, 27.013671875, 24.04296875]}, 'saliency': {'score': [2.3657735188802085, 0.19763495642022977, 1.7932196723090277, 0.18775414761256576, 0.17286948270575944], 'topk_indices': array([8197, 2918, 8185, 4813, 3520, 3521, 4810, 3523, 8205, 3485, 5652,
       2522, 2917, 8199, 2537, 4237, 3522, 2536, 2921, 2541]), 'topk_tokens': [' milk', ' went', 'Question', ' bathroom', ' *', '      ', ' moved', '      ', 'Answer', ' Sandra', ' milk', ' There', ' Daniel', ' discarded', ' went', ' milk', ' *', ' John', ' hallway', ' hallway'], 'evidence_proportions': [3.8228515625, 3.344970703125, 1.8939453125, 2.862060546875, 0.5610758463541666]}}, 'pred_res': 'the hallway<|eot_id|>', 'score': 100}
2025-01-22 06:33:08.178 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:33:08.178 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-97_pid-0_3-5-6-7-8.pkl | len: 3 |  size: 2.03 KB
Processing depth (3, 5, 6, 7, 8):   1%|          | 1/100 [00:20<33:17, 20.17s/it]is_0k: False
your chose emoji: ['💢', '👩🏻\u200d🦽\u200d➡️', '🧎🏾\u200d➡️', '🧡', '🏃🏿\u200d♀️\u200d➡️', '👡', '👨🏻\u200d🏭', '👨🏻\u200d✈', '🧑🏽\u200d❤\u200d🧑🏻', '🧑\u200d🏫']
emoji:
O: 💢 [93273, 95]
N: 👩🏻‍🦽‍➡️ [9468, 239, 102, 9468, 237, 119, 102470, 9468, 99, 121, 102470, 98115, 94, 31643]

O: 👩🏻‍🦽‍➡️ [9468, 239, 102, 9468, 237, 119, 102470, 9468, 99, 121, 102470, 98115, 94, 31643]
N: 🏃🏿‍♀️‍➡️ [9468, 237, 225, 9468, 237, 123, 102470, 32990, 31643, 102470, 98115, 94, 31643]

O: 🧎🏾‍➡️ [9468, 100, 236, 9468, 237, 122, 102470, 98115, 94, 31643]
N: 👨🏻‍🏭 [9468, 239, 101, 9468, 237, 119, 102470, 9468, 237, 255]

O: 🧡 [9468, 100, 94]
N: 🧡 [9468, 100, 94]

O: 🏃🏿‍♀️‍➡️ [9468, 237, 225, 9468, 237, 123, 102470, 32990, 31643, 102470, 98115, 94, 31643]
N: 🧑🏽‍❤‍🧑🏻 [9468, 100, 239, 9468, 237, 121, 102470, 121643, 102470, 9468, 100, 239, 9468, 237, 119]

O: 👡 [9468, 239, 94]
N: 👡 [9468, 239, 94]

O: 👨🏻‍🏭 [9468, 239, 101, 9468, 237, 119, 102470, 9468, 237, 255]
N: 👨🏻‍✈ [9468, 239, 101, 9468, 237, 119, 102470, 38798, 230]

O: 👨🏻‍✈ [9468, 239, 101, 9468, 237, 119, 102470, 38798, 230]
N: 💢 [93273, 95]

O: 🧑🏽‍❤‍🧑🏻 [9468, 100, 239, 9468, 237, 121, 102470, 121643, 102470, 9468, 100, 239, 9468, 237, 119]
N: 🧎🏾‍➡️ [9468, 100, 236, 9468, 237, 122, 102470, 98115, 94, 31643]

O: 🧑‍🏫 [9468, 100, 239, 102470, 9468, 237, 104]
N: 🧑‍🏫 [9468, 100, 239, 102470, 9468, 237, 104]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.57s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.61s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.25s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.75s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.37s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 3, 4, 7, 9):   1%|          | 1/100 [00:35<33:17, 20.17s/it]2025-01-22 06:33:23.867 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went to the hallway.
2025-01-22 06:33:23.867 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  went to the hallway.
2025-01-22 06:33:23.867 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel got the milk.
2025-01-22 06:33:23.882 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2829, 2833) -->  Daniel got the milk
2025-01-22 06:33:23.882 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the bathroom.
2025-01-22 06:33:23.907 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (3608, 3613) --> . Daniel moved to the
2025-01-22 06:33:23.907 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel dropped the milk.
2025-01-22 06:33:23.937 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (5647, 5651) -->  Daniel dropped the milk
2025-01-22 06:33:23.938 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary journeyed to the kitchen.
2025-01-22 06:33:23.973 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6685, 6691) --> . Mary journeyed to the
2025-01-22 06:33:23.973 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went back to the kitchen.
2025-01-22 06:33:23.993 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3451, 3457) --> . Sandra went back to the
2025-01-22 06:33:23.993 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the office.
2025-01-22 06:33:24.027 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6685, 6691) --> . Mary journeyed to the
2025-01-22 06:33:24.027 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the hallway.
2025-01-22 06:33:24.042 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2489, 2495) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:33:28.604 | INFO     | test_jbb_embedding:begin_test:693 - The hallway.<|eot_id|>
2025-01-22 06:33:28.604 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8190])
2025-01-22 06:33:31.931 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [156.89127604166666, 16.80554665568168, 94.59461805555556, 16.221291866028707, 7.819166666666667], 'topk_indices': array([8189, 8184,    4,   25, 8177, 8069,   24, 7019,   35, 8188, 2495,
       7637, 6993,   28,   34,    9,   14,    0, 8185, 8186]), 'topk_tokens': ['\n\n', ':', '\n\n', '<|eot_id|>', ' discarded', '.\n\n', '\n\n', ' to', '.', '<|end_header_id|>', ' hallway', ' or', ' be', '<|end_header_id|>', ' hallway', ':', '\n', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [304.875, 167.375, 93.5375, 225.25, 33.8046875]}, 'weight': {'score': [22.446614583333332, 23.281690543756866, 20.6640625, 23.289929916574653, 29.360833333333332], 'topk_indices': array([3285, 3312, 3157, 3205, 7416, 7454, 1473, 1411, 4293, 4277, 5130,
       5191, 7130, 7186, 3475, 3501, 4932, 4955, 4907, 4984]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.871875, 26.611328125, 19.909375, 27.013671875, 20.052083333333332]}, 'saliency': {'score': [0.9519551595052084, 0.09281126693042079, 0.5051133897569444, 0.08937108883783432, 0.05739003499348958], 'topk_indices': array([  24, 8069,    8,   20, 2832,  185, 3613,   31,   64, 8163, 7637,
       8183,   38, 8169, 6993, 5650, 8175, 8177, 2495,   34]), 'topk_tokens': ['\n\n', '.\n\n', ' Date', ' Jul', ' milk', 'ION', ' bathroom', ' went', 'ENCES', 'Question', ' or', 'Answer', '***', ' prior', ' be', ' milk', ' milk', ' discarded', ' hallway', ' hallway'], 'evidence_proportions': [1.7509765625, 1.1348876953125, 0.477587890625, 1.5191650390625, 0.18131510416666666]}}, 'pred_res': 'The hallway.<|eot_id|>', 'score': 100}
2025-01-22 06:33:31.938 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:33:31.938 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-97_pid-1_0-3-4-7-9.pkl | len: 3 |  size: 2.06 KB
Processing depth (0, 3, 4, 7, 9):   2%|▏         | 2/100 [00:43<36:23, 22.28s/it]is_0k: False
your chose emoji: ['👣', '👩🏿\u200d❤\u200d👨🏽', '👩🏼\u200d❤\u200d💋\u200d👨🏾', '🇿🇲', '🙎🏿', '♉', '👷\u200d♀️', '👨🏾', '🎥', '🧑🏾\u200d🔬']
emoji:
O: 👣 [9468, 239, 96]
N: 👣 [9468, 239, 96]

O: 👩🏿‍❤‍👨🏽 [9468, 239, 102, 9468, 237, 123, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 121]
N: 🙎🏿 [9468, 247, 236, 9468, 237, 123]

O: 👩🏼‍❤‍💋‍👨🏾 [9468, 239, 102, 9468, 237, 120, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 122]
N: 👨🏾 [9468, 239, 101, 9468, 237, 122]

O: 🇿🇲 [9468, 229, 123, 9468, 229, 110]
N: 👷‍♀️ [9468, 239, 115, 102470, 32990, 31643]

O: 🙎🏿 [9468, 247, 236, 9468, 237, 123]
N: 👩🏿‍❤‍👨🏽 [9468, 239, 102, 9468, 237, 123, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 121]

O: ♉ [17245, 231]
N: 🇿🇲 [9468, 229, 123, 9468, 229, 110]

O: 👷‍♀️ [9468, 239, 115, 102470, 32990, 31643]
N: 🎥 [9468, 236, 98]

O: 👨🏾 [9468, 239, 101, 9468, 237, 122]
N: 👩🏼‍❤‍💋‍👨🏾 [9468, 239, 102, 9468, 237, 120, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 101, 9468, 237, 122]

O: 🎥 [9468, 236, 98]
N: ♉ [17245, 231]

O: 🧑🏾‍🔬 [9468, 100, 239, 9468, 237, 122, 102470, 9468, 242, 105]
N: 🧑🏾‍🔬 [9468, 100, 239, 9468, 237, 122, 102470, 9468, 242, 105]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.60s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.30s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.22s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  2.98s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.47s/it]
Processing depth (0, 1, 5, 6, 8):   2%|▏         | 2/100 [00:59<36:23, 22.28s/it]2025-01-22 06:33:47.576 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went to the hallway.
2025-01-22 06:33:47.576 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  went to the hallway.
2025-01-22 06:33:47.576 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel got the milk.
2025-01-22 06:33:47.582 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (902, 906) -->  Daniel got the milk
2025-01-22 06:33:47.582 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the bathroom.
2025-01-22 06:33:47.606 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4204, 4209) -->  Daniel moved to the bathroom
2025-01-22 06:33:47.607 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel dropped the milk.
2025-01-22 06:33:47.633 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4756, 4760) -->  Daniel dropped the milk
2025-01-22 06:33:47.633 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary journeyed to the kitchen.
2025-01-22 06:33:47.665 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6516, 6522) --> . Mary journeyed to the
2025-01-22 06:33:47.665 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went back to the kitchen.
2025-01-22 06:33:47.685 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3494, 3500) --> . Sandra went back to the
2025-01-22 06:33:47.685 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the office.
2025-01-22 06:33:47.720 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6516, 6522) --> . Mary journeyed to the
2025-01-22 06:33:47.720 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the hallway.
2025-01-22 06:33:47.733 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2546, 2552) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:33:48.515 | INFO     | test_jbb_embedding:begin_test:693 - The hallway.<|eot_id|>
2025-01-22 06:33:48.515 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8187])
2025-01-22 06:33:50.736 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [378.0442708333333, 28.550538003663004, 127.92708333333333, 27.301565568237603, 13.40334670608108], 'topk_indices': array([1631,   14, 1632, 2552, 4757, 8167, 4760,   29, 5693,  905,   34,
         35, 8172, 4759, 1710, 8174,  906, 8182,    0, 8183]), 'topk_tokens': ["'s", '\n', ' work', ' hallway', ' dropped', ' to', '.', '\n\n', 'ot', ' milk', ' hallway', '.', ' milk', ' milk', "'s", ' discarded', '.', '<|eot_id|>', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [559.4, 499.0625, 316.725, 582.5, 61.03125]}, 'weight': {'score': [23.6318359375, 23.273076923076925, 20.6640625, 23.27778385033137, 27.960092905405407], 'topk_indices': array([3276, 3303, 3195, 3147, 7463, 7425, 1472, 1410, 4280, 4296, 5114,
       5175, 7202, 7146, 3485, 3459, 4927, 4904, 4879, 4956]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.871875, 26.611328125, 25.5984375, 27.013671875, 20.052083333333332]}, 'saliency': {'score': [2.419464111328125, 0.16052275903350122, 0.6744656032986112, 0.15273366187446305, 0.08216579540355785], 'topk_indices': array([  29, 8160, 5692,   39,   31,   38, 1709, 1632,    0, 5693, 8166,
       1710, 4757, 4208,  905, 2552, 8172, 4759,   34, 8174]), 'topk_tokens': ['\n\n', 'Question', 'nes', '\n\n\n', ' went', '***', ' summer', ' work', '<|begin_of_text|>', 'ot', ' prior', "'s", ' dropped', ' bathroom', ' milk', ' hallway', ' milk', ' milk', ' hallway', ' discarded'], 'evidence_proportions': [3.196875, 3.336181640625, 2.2068359375, 3.9501953125, 0.3171793619791667]}}, 'pred_res': 'The hallway.<|eot_id|>', 'score': 100}
2025-01-22 06:33:50.743 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:33:50.743 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-97_pid-2_0-1-5-6-8.pkl | len: 3 |  size: 2.05 KB
Processing depth (0, 1, 5, 6, 8):   3%|▎         | 3/100 [01:02<33:27, 20.70s/it]is_0k: False
your chose emoji: ['👨🏽\u200d❤️\u200d👨🏿', '👩🏼\u200d❤\u200d👨🏽', '🇮🇲', '🚙', '🥼', '♀', '👩🏾\u200d🦯\u200d➡', '\U0001faf5🏿', '🤸\u200d♀', '🤳🏽']
emoji:
O: 👨🏽‍❤️‍👨🏿 [9468, 239, 101, 9468, 237, 121, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 123]
N: 👩🏾‍🦯‍➡ [9468, 239, 102, 9468, 237, 122, 102470, 9468, 99, 107, 102470, 98115, 94]

O: 👩🏼‍❤‍👨🏽 [9468, 239, 102, 9468, 237, 120, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 121]
N: 🚙 [9468, 248, 247]

O: 🇮🇲 [9468, 229, 106, 9468, 229, 110]
N:  After [4740]

O: 🚙 [9468, 248, 247]
N: ��🏿 The [104, 113, 9468, 237, 123, 578]

O: 🥼 [9468, 98, 120]
N: �� In [98, 120, 763]

O: ♀ [32990]
N: ��🇲 * [229, 106, 9468, 229, 110, 353]

O: 👩🏾‍🦯‍➡ [9468, 239, 102, 9468, 237, 122, 102470, 9468, 99, 107, 102470, 98115, 94]
N: ��🏼‍❤‍👨🏽 * [239, 102, 9468, 237, 120, 102470, 121643, 102470, 9468, 239, 101, 9468, 237, 121, 353]

O: 🫵🏿 [9468, 104, 113, 9468, 237, 123]
N: ��‍♀ Married [97, 116, 102470, 32990, 65624]

O: 🤸‍♀ [9468, 97, 116, 102470, 32990]
N: ��🏽‍❤️‍👨🏿 Stewart [239, 101, 9468, 237, 121, 102470, 121643, 31643, 102470, 9468, 239, 101, 9468, 237, 123, 29868]

O: 🤳🏽 [9468, 97, 111, 9468, 237, 121]
N: ��🏽
 [97, 111, 9468, 237, 121, 198]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.72s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.98s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.39s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.02s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.62s/it]
Processing depth (1, 3, 5, 8, 9):   3%|▎         | 3/100 [01:18<33:27, 20.70s/it]2025-01-22 06:34:06.957 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went to the hallway.
2025-01-22 06:34:06.961 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (787, 792) --> . Daniel went to the
2025-01-22 06:34:06.961 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel got the milk.
2025-01-22 06:34:06.975 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2880, 2884) -->  got the milk.
2025-01-22 06:34:06.975 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the bathroom.
2025-01-22 06:34:06.996 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4190, 4195) --> . Daniel moved to the
2025-01-22 06:34:06.996 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel dropped the milk.
2025-01-22 06:34:07.027 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6509, 6513) -->  Daniel dropped the milk
2025-01-22 06:34:07.028 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary journeyed to the kitchen.
2025-01-22 06:34:07.061 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6655, 6661) --> . Mary journeyed to the
2025-01-22 06:34:07.062 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went back to the kitchen.
2025-01-22 06:34:07.079 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3501, 3507) --> . Sandra went back to the
2025-01-22 06:34:07.079 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the office.
2025-01-22 06:34:07.112 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6655, 6661) --> . Mary journeyed to the
2025-01-22 06:34:07.113 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the hallway.
2025-01-22 06:34:07.125 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2515, 2521) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:34:07.931 | INFO     | test_jbb_embedding:begin_test:693 - The kitchen.<|eot_id|>
2025-01-22 06:34:07.931 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8194])
2025-01-22 06:34:10.172 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [328.8059895833333, 30.739422578382335, 211.84548611111111, 29.462475091968116, 46.70819805194805], 'topk_indices': array([6510,    3, 6490,  793,   24, 8173, 2626, 8073,  792, 2700,  293,
       6489,   14, 2882, 6512, 2883, 2521,    0, 8189, 8190]), 'topk_tokens': [' dropped', '<|end_header_id|>', ' This', '.', '\n\n', ' prior', 'ared', '.\n\n', ' hallway', ' ne', 'hue', '.', '\n', ' milk', ' milk', '.', ' hallway', '<|begin_of_text|>', '<|eot_id|>', '<|start_header_id|>'], 'evidence_proportions': [328.15, 573.25, 288.275, 473.9375, 103.41145833333333]}, 'weight': {'score': [21.1767578125, 23.2906360558741, 20.6640625, 23.302654621397917, 29.68668831168831], 'topk_indices': array([3335, 3362, 3255, 3207, 7434, 7472, 1461, 1523, 4333, 4349, 5162,
       5223, 7155, 7211, 3525, 3551, 5016, 4987, 4958, 4933]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [19.665625, 20.5, 19.909375, 27.013671875, 20.052083333333332]}, 'saliency': {'score': [1.8682098388671875, 0.17131824500388862, 1.1593763563368056, 0.16414345110361742, 0.3501481886033888], 'topk_indices': array([6490, 2880, 6479, 8083, 8179, 4192, 4195, 3502, 2608, 6510,  788,
       2626, 8181, 8173, 2700,  293, 2882, 6512,  792, 2521]), 'topk_tokens': [' This', ' got', ' Press', ' location', ' milk', ' moved', ' bathroom', ' Sandra', 'engers', ' dropped', ' Daniel', 'ared', ' discarded', ' prior', ' ne', 'hue', ' milk', ' milk', ' hallway', ' hallway'], 'evidence_proportions': [1.8123046875, 2.900390625, 1.486083984375, 3.284912109375, 0.60064697265625]}}, 'pred_res': 'The kitchen.<|eot_id|>', 'score': 0}
2025-01-22 06:34:10.185 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:34:10.185 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-97_pid-3_1-3-5-8-9.pkl | len: 3 |  size: 2.07 KB
Processing depth (1, 3, 5, 8, 9):   4%|▍         | 4/100 [01:22<32:19, 20.20s/it]is_0k: False
your chose emoji: ['🧘🏻\u200d♂', '👩🏾\u200d❤\u200d💋\u200d👩🏿', '🧑\u200d🦼\u200d➡️', '🏄🏽\u200d♀️', '🪐', '🙇🏾\u200d♂️', '🧙🏼', '⛱', '🥘', '💃🏻']
emoji:
O: 🧘🏻‍♂ [9468, 100, 246, 9468, 237, 119, 102470, 17245, 224]
N: 🏄🏽‍♀️ [9468, 237, 226, 9468, 237, 121, 102470, 32990, 31643]

O: 👩🏾‍❤‍💋‍👩🏿 [9468, 239, 102, 9468, 237, 122, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 123]
N: 🧘🏻‍♂ [9468, 100, 246, 9468, 237, 119, 102470, 17245, 224]

O: 🧑‍🦼‍➡️ [9468, 100, 239, 102470, 9468, 99, 120, 102470, 98115, 94, 31643]
N: 🙇🏾‍♂️ [9468, 247, 229, 9468, 237, 122, 102470, 17245, 224, 31643]

O: 🏄🏽‍♀️ [9468, 237, 226, 9468, 237, 121, 102470, 32990, 31643]
N: 👩🏾‍❤‍💋‍👩🏿 [9468, 239, 102, 9468, 237, 122, 102470, 121643, 102470, 93273, 233, 102470, 9468, 239, 102, 9468, 237, 123]

O: 🪐 [9468, 103, 238]
N: ⛱ [158, 249, 109]

O: 🙇🏾‍♂️ [9468, 247, 229, 9468, 237, 122, 102470, 17245, 224, 31643]
N: 🧙🏼 [9468, 100, 247, 9468, 237, 120]

O: 🧙🏼 [9468, 100, 247, 9468, 237, 120]
N: 🪐 [9468, 103, 238]

O: ⛱ [158, 249, 109]
N: 🥘 [9468, 98, 246]

O: 🥘 [9468, 98, 246]
N: 🧑‍🦼‍➡️ [9468, 100, 239, 102470, 9468, 99, 120, 102470, 98115, 94, 31643]

O: 💃🏻 [93273, 225, 9468, 237, 119]
N: 💃🏻 [93273, 225, 9468, 237, 119]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.47s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.74s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:13<00:04,  4.58s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.06s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.63s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Processing depth (0, 1, 6, 8, 9):   4%|▍         | 4/100 [01:38<32:19, 20.20s/it]2025-01-22 06:34:26.554 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went to the hallway.
2025-01-22 06:34:26.555 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (31, 36) -->  went to the hallway.
2025-01-22 06:34:26.555 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel got the milk.
2025-01-22 06:34:26.559 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (902, 906) -->  Daniel got the milk
2025-01-22 06:34:26.560 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel moved to the bathroom.
2025-01-22 06:34:26.585 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (4754, 4759) --> . Daniel moved to the
2025-01-22 06:34:26.585 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Daniel dropped the milk.
2025-01-22 06:34:26.621 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (6555, 6559) -->  Daniel dropped the milk
2025-01-22 06:34:26.621 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  Mary journeyed to the kitchen.
2025-01-22 06:34:26.660 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (6689, 6695) --> . Mary journeyed to the
2025-01-22 06:34:26.660 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra went back to the kitchen.
2025-01-22 06:34:26.678 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (3487, 3493) --> . Sandra went back to the
2025-01-22 06:34:26.678 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the office.
2025-01-22 06:34:26.713 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (6689, 6695) --> . Mary journeyed to the
2025-01-22 06:34:26.713 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  John went back to the hallway.
2025-01-22 06:34:26.726 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2524, 2530) --> . John went back to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:34:30.656 | INFO     | test_jbb_embedding:begin_test:693 - The hallway.<|eot_id|>
2025-01-22 06:34:30.657 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8196])
2025-01-22 06:34:33.795 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [203.44986979166666, 17.912498856567876, 116.72309027777777, 17.148555305259286, 15.582369290865385], 'topk_indices': array([8195,  906, 1631, 8169, 8188,    9, 8175, 8170, 2530, 8183,   24,
       1632,   34, 8176, 8041,   14, 1710, 8191,    0, 8192]), 'topk_tokens': ['\n\n', '.', "'s", 'Question', '?\n', ':', ' prior', ':', ' hallway', ' discarded', '\n\n', ' work', ' hallway', ' to', ' context', '\n', "'s", '<|eot_id|>', '<|begin_of_text|>', '<|start_header_id|>'], 'evidence_proportions': [343.25, 227.65625, 153.1, 243.0, 86.40364583333333]}, 'weight': {'score': [22.446614583333332, 23.296573896206855, 20.6640625, 23.30488384209881, 29.909254807692307], 'topk_indices': array([3321, 3348, 3161, 3209, 7480, 7442, 1410, 1472, 4339, 4323, 5158,
       5219, 7219, 7163, 3537, 3511, 5012, 4983, 4935, 4960]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.871875, 26.611328125, 19.909375, 27.013671875, 20.052083333333332]}, 'saliency': {'score': [1.239519755045573, 0.099840011810701, 0.6516350640190972, 0.09526913712915287, 0.11540554731320112], 'topk_indices': array([1630,    0, 8181, 6561, 1639,   31,  905, 7395, 4759, 1709, 8189,
       6558, 1632, 8175, 1710, 8169, 8041, 8183, 2530,   34]), 'topk_tokens': [' summer', '<|begin_of_text|>', ' milk', '      ', ' part', ' went', ' milk', 'nes', ' bathroom', ' summer', 'Answer', ' milk', ' work', ' prior', "'s", 'Question', ' context', ' discarded', ' hallway', ' hallway'], 'evidence_proportions': [2.0529296875, 1.519775390625, 0.766064453125, 1.6383056640625, 0.5035298665364584]}}, 'pred_res': 'The hallway.<|eot_id|>', 'score': 100}
2025-01-22 06:34:33.802 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:34:33.802 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/4-hop_sid-97_pid-4_0-1-6-8-9.pkl | len: 3 |  size: 2.07 KB
Processing depth (0, 1, 6, 8, 9):   5%|▌         | 5/100 [01:45<33:56, 21.43s/it]Processing depth (0, 1, 6, 8, 9):   5%|▌         | 5/100 [01:45<33:31, 21.17s/it]
2025-01-22 06:34:33.871 | INFO     | __main__:<module>:82 - Selected idx: 98
2025-01-22 06:34:33.871 | INFO     | __main__:<module>:83 - Question: I have provided you context with the facts about locations and actions of different persons hidden in some random text and a question. You need to answer the question based only on the information from the facts.

If a person obtained an item in the first location and traveled to the second location, the item is also in the second location.
If a person left an item in the first location and moved to the second location, the item remains in the first location.
If a person got an item and traveled to another location, the item will be in the new location unless they dropped it during the journey.

Just return the location directly. Do not write anything else after that.

Question: Where was the football before the hallway? 
2025-01-22 06:34:33.871 | INFO     | __main__:<module>:84 - Answer: garden
2025-01-22 06:34:33.871 | INFO     | __main__:<module>:85 - Tag: 3-hop
2025-01-22 06:34:33.873 | INFO     | __main__:<module>:86 - Needle: [' Sandra travelled to the bathroom.', ' Daniel went back to the garden.', ' Mary journeyed to the office.', ' Mary journeyed to the kitchen.', ' Daniel went to the hallway.', ' Sandra went back to the kitchen.', ' John went back to the hallway.', ' Mary journeyed to the office.', ' John moved to the garden.', ' Daniel dropped the football.', ' Sandra went to the bedroom.']
2025-01-22 06:34:33.873 | INFO     | __main__:<module>:87 - Real Needle: [' Daniel went back to the garden.', ' Daniel went to the hallway.', ' Daniel dropped the football.', ' Sandra went to the bedroom.']
2025-01-22 06:34:33.873 | INFO     | __main__:<module>:88 - =============================================
is_0k: False
your chose emoji: ['🧜\u200d♂️', '👩🏻\u200d❤️\u200d👩🏼', '👬🏼', '🧑🏻\u200d🔬', '🧑🏿\u200d🔧', '🧝🏼\u200d♂', '💆🏾\u200d♀️', '🕵️\u200d♀️', '🙃', '🚌']
emoji:
O: 🧜‍♂️ [9468, 100, 250, 102470, 17245, 224, 31643]
N: 👬🏼 [9468, 239, 105, 9468, 237, 120]

O: 👩🏻‍❤️‍👩🏼 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 31643, 102470, 9468, 239, 102, 9468, 237, 120]
N: 🧑🏿‍🔧 [9468, 100, 239, 9468, 237, 123, 102470, 9468, 242, 100]

O: 👬🏼 [9468, 239, 105, 9468, 237, 120]
N: 🕵️‍♀️ [9468, 243, 113, 31643, 102470, 32990, 31643]

O: 🧑🏻‍🔬 [9468, 100, 239, 9468, 237, 119, 102470, 9468, 242, 105]
N: 👩🏻‍❤️‍👩🏼 [9468, 239, 102, 9468, 237, 119, 102470, 121643, 31643, 102470, 9468, 239, 102, 9468, 237, 120]

O: 🧑🏿‍🔧 [9468, 100, 239, 9468, 237, 123, 102470, 9468, 242, 100]
N: 💆🏾‍♀️ [93273, 228, 9468, 237, 122, 102470, 32990, 31643]

O: 🧝🏼‍♂ [9468, 100, 251, 9468, 237, 120, 102470, 17245, 224]
N: 🧝🏼‍♂ [9468, 100, 251, 9468, 237, 120, 102470, 17245, 224]

O: 💆🏾‍♀️ [93273, 228, 9468, 237, 122, 102470, 32990, 31643]
N: 🧜‍♂️ [9468, 100, 250, 102470, 17245, 224, 31643]

O: 🕵️‍♀️ [9468, 243, 113, 31643, 102470, 32990, 31643]
N: 🧑🏻‍🔬 [9468, 100, 239, 9468, 237, 119, 102470, 9468, 242, 105]

O: 🙃 [9468, 247, 225]
N: 🙃 [9468, 247, 225]

O: 🚌 [9468, 48479]
N: 🚌 [9468, 48479]

is_0k: False
is_0k: False
is_0k: False
  0%|          | 0/100 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.52s/it][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.76s/it][A
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.80s/it][A
Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.34s/it][ALoading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.85s/it]
Processing depth (1, 6, 8, 9):   0%|          | 0/100 [00:16<?, ?it/s]2025-01-22 06:34:50.990 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Daniel went back to the garden.
2025-01-22 06:34:50.995 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (844, 850) --> . Daniel went back to the
2025-01-22 06:34:50.995 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Daniel went to the hallway.
2025-01-22 06:34:50.996 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (262, 267) -->  back to the hallway.
2025-01-22 06:34:50.997 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Daniel dropped the football.
2025-01-22 06:34:51.028 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (6532, 6536) -->  Daniel dropped the football
2025-01-22 06:34:51.028 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went to the bedroom.
2025-01-22 06:34:51.050 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4365, 4370) -->  Sandra went back to the
2025-01-22 06:34:51.050 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 0 -->  Sandra travelled to the bathroom.
2025-01-22 06:34:51.085 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 0 at --> (7092, 7097) --> . Sandra travelled to the
2025-01-22 06:34:51.085 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 1 -->  Mary journeyed to the office.
2025-01-22 06:34:51.098 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 1 at --> (2557, 2563) -->  journeyed to the kitchen.
2025-01-22 06:34:51.098 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 2 -->  Mary journeyed to the kitchen.
2025-01-22 06:34:51.111 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 2 at --> (2556, 2562) -->  Mary journeyed to the kitchen
2025-01-22 06:34:51.112 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 3 -->  Sandra went back to the kitchen.
2025-01-22 06:34:51.134 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 3 at --> (4364, 4370) --> . Sandra went back to the
2025-01-22 06:34:51.134 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 4 -->  John went back to the hallway.
2025-01-22 06:34:51.135 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 4 at --> (259, 265) --> . John went back to the
2025-01-22 06:34:51.135 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 5 -->  Mary journeyed to the office.
2025-01-22 06:34:51.148 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 5 at --> (2557, 2563) -->  journeyed to the kitchen.
2025-01-22 06:34:51.148 | INFO     | test_jbb_embedding:find_multi_needle_idx:530 - evidence 6 -->  John moved to the garden.
2025-01-22 06:34:51.166 | INFO     | test_jbb_embedding:find_multi_needle_idx:538 - find evidence 6 at --> (3554, 3559) --> . John moved to the
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
2025-01-22 06:34:51.951 | INFO     | test_jbb_embedding:begin_test:693 - The garden.<|eot_id|>
2025-01-22 06:34:51.951 | INFO     | test_jbb_embedding:begin_test:695 - torch.Size([1, 8208])
2025-01-22 06:34:54.189 | INFO     | test_jbb_embedding:begin_test:746 - {'embedding': {'grad': {'score': [159.975, 16.968786155766654, 90.66328125, 16.25624731628021, 14.986403245192308], 'topk_indices': array([  20, 8057, 8062, 8177, 8207,    4,  850,    3, 8204, 6535, 8096,
       8202,   24,    9, 8106,   23,   14, 8206,    0, 8203]), 'topk_tokens': [' Jul', '\n', ' context', ' return', '\n\n', '\n\n', ' garden', '<|end_header_id|>', '<|start_header_id|>', ' football', '.\n\n', ':', '\n\n', ':', ' location', '4', '\n', '<|end_header_id|>', '<|begin_of_text|>', '<|eot_id|>'], 'evidence_proportions': [177.1875, 159.7625, 300.875, 26.8125]}, 'weight': {'score': [22.93203125, 23.30242966751918, 21.0826171875, 23.31423195773525, 30.26221955128205], 'topk_indices': array([3363, 3336, 3236, 3188, 7455, 7493, 1461, 1523, 4392, 4376, 5193,
       5254, 7176, 7232, 3545, 3519, 4970, 5047, 5018, 4995]), 'topk_tokens': [' proudly', ' proudly', ' trembling', ' trembling', ' acquaintance', ' acquaintance', ' injunction', ' injunction', ' vigorous', ' vigorous', ' strife', ' strife', ' extortion', ' extortion', ' memorable', ' memorable', ' veto', ' veto', ' veto', ' veto'], 'evidence_proportions': [20.927083333333332, 20.428125, 27.341796875, 24.3140625]}, 'saliency': {'score': [1.0003341674804687, 0.09417943149576406, 0.499224853515625, 0.08996830260354366, 0.11368893354366987], 'topk_indices': array([8198,   14, 8196,   16, 8180,    8, 3136,   19, 8190,   24, 8096,
       8177, 8062,   23, 8201, 8195,   20,  850, 6535, 8106]), 'topk_tokens': [' hallway', '\n', ' before', ' Date', ' directly', ' Date', 'ern', '26', 'Question', '\n\n', '.\n\n', ' return', ' context', '4', 'Answer', ' football', ' Jul', ' garden', ' football', ' location'], 'evidence_proportions': [1.0254313151041667, 0.88779296875, 2.1190185546875, 0.187811279296875]}}, 'pred_res': 'The garden.<|eot_id|>', 'score': 100}
2025-01-22 06:34:54.195 | INFO     | modelzipper.tutils:auto_save_data:314 - pkl file saved successfully!
2025-01-22 06:34:54.196 | INFO     | modelzipper.tutils:auto_save_data:329 - Save file to /mnt/petrelfs/tangzecheng/repos/Long-form-reasoning/preliminary/babilong_random5x100/results/gws/Meta-Llama-3.1-8B-Instruct/3900/label/3-hop_sid-98_pid-0_1-6-8-9.pkl | len: 3 |  size: 2.01 KB
Processing depth (1, 6, 8, 9):   1%|          | 1/100 [00:20<33:22, 20.23s/it]is_0k: False
your chose emoji: ['💃🏿', '⛲', '🤷🏼\u200d♂️', '🎭', '🧖🏿\u200d♂️', '💂🏼\u200d♀️', '🧑🏻\u200d🍼', '🙅🏽\u200d♂️', '🏃🏻\u200d♂️\u200d➡️', '🥷🏾']
emoji:
O: 💃🏿 [93273, 225, 9468, 237, 123]
N: 🏃🏻‍♂️‍➡️ [9468, 237, 225, 9468, 237, 119, 102470, 17245, 224, 31643, 102470, 98115, 94, 31643]

O: ⛲ [158, 249, 110]
N: 🙅🏽‍♂️ [9468, 247, 227, 9468, 237, 121, 102470, 17245, 224, 31643]

O: 🤷🏼‍♂️ [9468, 97, 115, 9468, 237, 120, 102470, 17245, 224, 31643]
N: ⛲ [158, 249, 110]

O: 🎭 [9468, 236, 255]
N: 🎭 [9468, 236, 255]

O: 🧖🏿‍♂️ [9468, 100, 244, 9468, 237, 123, 102470, 17245, 224, 31643]
N: 💃🏿 [93273, 225, 9468, 237, 123]

O: 💂🏼‍♀️ [93273, 224, 9468, 237, 120, 102470, 32990, 31643]
N: 🤷🏼‍♂️ [9468, 97, 115, 9468, 237, 120, 102470, 17245, 224, 31643]

O: 🧑🏻‍🍼 [9468, 100, 239, 9468, 237, 119, 102470, 9468, 104247]
N: 💂🏼‍♀️ [93273, 224, 9468, 237, 120, 102470, 32990, 31643]

O: 🙅🏽‍♂️ [9468, 247, 227, 9468, 237, 121, 102470, 17245, 224, 31643]
N: 🧑🏻‍🍼 [9468, 100, 239, 9468, 237, 119, 102470, 9468, 104247]

O: 🏃🏻‍♂️‍➡️ [9468, 237, 225, 9468, 237, 119, 102470, 17245, 224, 31643, 102470, 98115, 94, 31643]
N: 🧖🏿‍♂️ [9468, 100, 244, 9468, 237, 123, 102470, 17245, 224, 31643]

O: 🥷🏾 [9468, 98, 115, 9468, 237, 122]
N: 🥷🏾 [9468, 98, 115, 9468, 237, 122]

is_0k: False
is_0k: False
is_0k: False

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:13,  4.57s/it][A