/mnt/petrelfs/tangzecheng/.bashrc:è¡Œ87: proxy_on: æœªæ‰¾åˆ°å‘½ä»¤
/mnt/petrelfs/tangzecheng/.bashrc:è¡Œ94: svp: æœªæ‰¾åˆ°å‘½ä»¤
/mnt/petrelfs/tangzecheng/.bashrc:è¡Œ98: svp: æœªæ‰¾åˆ°å‘½ä»¤
2025-01-21 01:30:53.796 | INFO     | __main__:__init__:129 - loading from meta-llama/Meta-Llama-3.1-8B-Instruct
2025-01-21 01:30:55.821 | INFO     | __main__:__init__:133 - layer number: 32, head number 32
The model was loaded with use_flash_attention_2=True, which is deprecated and may be removed in a future release. Please use `attn_implementation="flash_attention_2"` instead.
LlamaForCausalLM has generative capabilities, as `prepare_inputs_for_generation` is explicitly overwritten. However, it doesn't directly inherit from `GenerationMixin`. From ðŸ‘‰v4.50ðŸ‘ˆ onwards, `PreTrainedModel` will NOT inherit from `GenerationMixin`, and this model will lose the ability to call `generate` and other related functions.
  - If you're using `trust_remote_code=True`, you can get rid of this warning by loading the model with an auto class. See https://huggingface.co/docs/transformers/en/model_doc/auto#auto-classes
  - If you are the owner of the model architecture code, please modify your model class such that it inherits from `GenerationMixin` (after `PreTrainedModel`, otherwise you'll get an exception).
  - If you are not the owner of the model architecture class, please contact the model code owner to update it.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:10,  3.34s/it]Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:10<00:11,  5.86s/it]Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:15<00:05,  5.36s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  3.50s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:16<00:00,  4.09s/it]
  0%|          | 0/1 [00:00<?, ?it/s]
  0%|          | 0/2 [00:00<?, ?it/s][A2025-01-21 01:31:18.154 | INFO     | __main__:start_test:320 - Selected idx: 0
2025-01-21 01:31:18.156 | INFO     | __main__:start_test:321 - Answer: office
2025-01-21 01:31:18.157 | INFO     | __main__:start_test:322 - Tag: 3-hop
2025-01-21 01:31:18.158 | INFO     | __main__:start_test:323 - Needle: [' John went back to the bedroom.', ' John took the milk.', ' Mary journeyed to the office.', ' Sandra journeyed to the bedroom.', ' John journeyed to the office.', ' Mary journeyed to the bathroom.', ' Mary dropped the football.', ' Daniel went back to the kitchen.']
2025-01-21 01:31:18.159 | INFO     | __main__:start_test:324 - Real Needle: [' Mary journeyed to the office.', ' Mary journeyed to the bathroom.', ' Mary dropped the football.']
2025-01-21 01:31:18.160 | INFO     | __main__:start_test:325 - =============================================
2025-01-21 01:31:18.284 | INFO     | __main__:start_test:348 - [(1, 3, 7), (0, 6, 7), (3, 4, 7), (2, 4, 5), (2, 3, 6), (2, 5, 9), (0, 3, 8), (0, 5, 9), (2, 3, 7), (3, 4, 5)]


  0%|          | 0/10 [00:00<?, ?it/s][A[A

Processing length: 7900 | task: 3-hop | depth (1, 3, 7):   0%|          | 0/10 [00:00<?, ?it/s][A[AThe attention layers in this model are transitioning from computing the RoPE embeddings internally through `position_ids` (2D tensor with the indexes of the tokens), to using externally computed `position_embeddings` (Tuple of tensors, containing cos and sin). In v4.46 `position_ids` will be removed and `position_embeddings` will be mandatory.
2025-01-21 01:31:24.731 | INFO     | __main__:evaluate_and_log:295 - model response: bedroom
2025-01-21 01:31:24.733 | INFO     | __main__:evaluate_and_log:296 - gloden label: office


Processing length: 7900 | task: 3-hop | depth (1, 3, 7):  10%|â–ˆ         | 1/10 [00:06<00:58,  6.45s/it][A[A

Processing length: 7900 | task: 3-hop | depth (0, 6, 7):  10%|â–ˆ         | 1/10 [00:06<00:58,  6.45s/it][A[A2025-01-21 01:31:24.978 | INFO     | __main__:evaluate_and_log:275 - length of search pos and attack pos is not equal to the length of evidence and disturb_tok_needles, skip this case
2025-01-21 01:31:24.979 | INFO     | __main__:evaluate_and_log:276 - search_pos length: 2 | evidence length: 3
2025-01-21 01:31:24.980 | INFO     | __main__:evaluate_and_log:277 - attack_pos length: 5 | attack clues length: 5


Processing length: 7900 | task: 3-hop | depth (0, 6, 7):  20%|â–ˆâ–ˆ        | 2/10 [00:06<00:22,  2.80s/it][A[A

Processing length: 7900 | task: 3-hop | depth (3, 4, 7):  20%|â–ˆâ–ˆ        | 2/10 [00:06<00:22,  2.80s/it][A[A2025-01-21 01:31:36.205 | INFO     | __main__:evaluate_and_log:295 - model response: the office
2025-01-21 01:31:36.210 | INFO     | __main__:evaluate_and_log:296 - gloden label: office


Processing length: 7900 | task: 3-hop | depth (3, 4, 7):  30%|â–ˆâ–ˆâ–ˆ       | 3/10 [00:17<00:46,  6.66s/it][A[A

Processing length: 7900 | task: 3-hop | depth (2, 4, 5):  30%|â–ˆâ–ˆâ–ˆ       | 3/10 [00:18<00:46,  6.66s/it][A[A2025-01-21 01:31:41.828 | INFO     | __main__:evaluate_and_log:295 - model response: bedroom
2025-01-21 01:31:41.830 | INFO     | __main__:evaluate_and_log:296 - gloden label: office


Processing length: 7900 | task: 3-hop | depth (2, 4, 5):  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 4/10 [00:23<00:37,  6.24s/it][A[A

Processing length: 7900 | task: 3-hop | depth (2, 3, 6):  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 4/10 [00:24<00:37,  6.24s/it][A[A2025-01-21 01:31:52.795 | INFO     | __main__:evaluate_and_log:295 - model response: the bedroom
2025-01-21 01:31:52.797 | INFO     | __main__:evaluate_and_log:296 - gloden label: office


Processing length: 7900 | task: 3-hop | depth (2, 3, 6):  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 5/10 [00:34<00:39,  7.95s/it][A[A

Processing length: 7900 | task: 3-hop | depth (2, 5, 9):  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 5/10 [00:34<00:39,  7.95s/it][A[A2025-01-21 01:31:58.106 | INFO     | __main__:evaluate_and_log:295 - model response: the office
2025-01-21 01:31:58.108 | INFO     | __main__:evaluate_and_log:296 - gloden label: office


Processing length: 7900 | task: 3-hop | depth (2, 5, 9):  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 6/10 [00:39<00:28,  7.05s/it][A[A

Processing length: 7900 | task: 3-hop | depth (0, 3, 8):  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 6/10 [00:39<00:28,  7.05s/it][A[A2025-01-21 01:31:58.331 | INFO     | __main__:evaluate_and_log:275 - length of search pos and attack pos is not equal to the length of evidence and disturb_tok_needles, skip this case
2025-01-21 01:31:58.333 | INFO     | __main__:evaluate_and_log:276 - search_pos length: 2 | evidence length: 3
2025-01-21 01:31:58.334 | INFO     | __main__:evaluate_and_log:277 - attack_pos length: 5 | attack clues length: 5


Processing length: 7900 | task: 3-hop | depth (0, 3, 8):  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 7/10 [00:40<00:14,  4.82s/it][A[A

Processing length: 7900 | task: 3-hop | depth (0, 5, 9):  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 7/10 [00:40<00:14,  4.82s/it][A[A2025-01-21 01:31:58.539 | INFO     | __main__:evaluate_and_log:275 - length of search pos and attack pos is not equal to the length of evidence and disturb_tok_needles, skip this case
2025-01-21 01:31:58.540 | INFO     | __main__:evaluate_and_log:276 - search_pos length: 2 | evidence length: 3
2025-01-21 01:31:58.541 | INFO     | __main__:evaluate_and_log:277 - attack_pos length: 5 | attack clues length: 5


Processing length: 7900 | task: 3-hop | depth (0, 5, 9):  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 8/10 [00:40<00:06,  3.35s/it][A[A

Processing length: 7900 | task: 3-hop | depth (2, 3, 7):  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 8/10 [00:40<00:06,  3.35s/it][A[A2025-01-21 01:32:03.865 | INFO     | __main__:evaluate_and_log:295 - model response: bedroom
2025-01-21 01:32:03.867 | INFO     | __main__:evaluate_and_log:296 - gloden label: office


Processing length: 7900 | task: 3-hop | depth (2, 3, 7):  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 9/10 [00:45<00:03,  3.97s/it][A[A

Processing length: 7900 | task: 3-hop | depth (3, 4, 5):  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 9/10 [00:45<00:03,  3.97s/it][A[A2025-01-21 01:32:10.617 | INFO     | __main__:evaluate_and_log:295 - model response: The office.
2025-01-21 01:32:10.619 | INFO     | __main__:evaluate_and_log:296 - gloden label: office


Processing length: 7900 | task: 3-hop | depth (3, 4, 5): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10/10 [00:52<00:00,  4.83s/it][A[AProcessing length: 7900 | task: 3-hop | depth (3, 4, 5): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10/10 [00:52<00:00,  5.23s/it]
2025-01-21 01:32:10.628 | INFO     | __main__:start_test:320 - Selected idx: 2
2025-01-21 01:32:10.629 | INFO     | __main__:start_test:321 - Answer: office
2025-01-21 01:32:10.631 | INFO     | __main__:start_test:322 - Tag: 3-hop
2025-01-21 01:32:10.632 | INFO     | __main__:start_test:323 - Needle: [' Daniel went back to the kitchen.', ' Mary journeyed to the office.', ' Sandra journeyed to the bedroom.', ' John went back to the bedroom.', ' John journeyed to the office.', ' Mary journeyed to the bathroom.', ' John took the milk.', ' John moved to the bedroom.', ' Mary dropped the football.', ' Daniel went back to the hallway.']
2025-01-21 01:32:10.633 | INFO     | __main__:start_test:324 - Real Needle: [' Mary journeyed to the office.', ' Mary journeyed to the bathroom.', ' Mary dropped the football.']
2025-01-21 01:32:10.634 | INFO     | __main__:start_test:325 - =============================================
2025-01-21 01:32:10.668 | INFO     | __main__:start_test:348 - [(5, 6, 9), (1, 2, 9), (3, 5, 9), (2, 4, 7), (2, 7, 9), (2, 6, 7), (1, 4, 9), (3, 5, 7), (0, 1, 8), (0, 1, 4)]


  0%|          | 0/10 [00:00<?, ?it/s][A[A

Processing length: 7900 | task: 3-hop | depth (5, 6, 9):   0%|          | 0/10 [00:00<?, ?it/s][A[A2025-01-21 01:32:17.019 | INFO     | __main__:evaluate_and_log:295 - model response: bedroom
2025-01-21 01:32:17.020 | INFO     | __main__:evaluate_and_log:296 - gloden label: office


Processing length: 7900 | task: 3-hop | depth (5, 6, 9):  10%|â–ˆ         | 1/10 [00:06<00:57,  6.35s/it][A[A

Processing length: 7900 | task: 3-hop | depth (1, 2, 9):  10%|â–ˆ         | 1/10 [00:06<00:57,  6.35s/it][A[A2025-01-21 01:32:23.304 | INFO     | __main__:evaluate_and_log:295 - model response: bedroom
2025-01-21 01:32:23.305 | INFO     | __main__:evaluate_and_log:296 - gloden label: office


Processing length: 7900 | task: 3-hop | depth (1, 2, 9):  20%|â–ˆâ–ˆ        | 2/10 [00:12<00:50,  6.31s/it][A[A

Processing length: 7900 | task: 3-hop | depth (3, 5, 9):  20%|â–ˆâ–ˆ        | 2/10 [00:12<00:50,  6.31s/it][A[A2025-01-21 01:32:29.692 | INFO     | __main__:evaluate_and_log:295 - model response: the bedroom
2025-01-21 01:32:29.694 | INFO     | __main__:evaluate_and_log:296 - gloden label: office


Processing length: 7900 | task: 3-hop | depth (3, 5, 9):  30%|â–ˆâ–ˆâ–ˆ       | 3/10 [00:19<00:44,  6.35s/it][A[A

Processing length: 7900 | task: 3-hop | depth (2, 4, 7):  30%|â–ˆâ–ˆâ–ˆ       | 3/10 [00:19<00:44,  6.35s/it][A[A2025-01-21 01:32:36.055 | INFO     | __main__:evaluate_and_log:295 - model response: the bedroom
2025-01-21 01:32:36.057 | INFO     | __main__:evaluate_and_log:296 - gloden label: office


Processing length: 7900 | task: 3-hop | depth (2, 4, 7):  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 4/10 [00:25<00:38,  6.35s/it][A[A

Processing length: 7900 | task: 3-hop | depth (2, 7, 9):  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 4/10 [00:25<00:38,  6.35s/it][A[A2025-01-21 01:32:42.392 | INFO     | __main__:evaluate_and_log:295 - model response: bedroom
2025-01-21 01:32:42.394 | INFO     | __main__:evaluate_and_log:296 - gloden label: office


Processing length: 7900 | task: 3-hop | depth (2, 7, 9):  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 5/10 [00:31<00:31,  6.35s/it][A[A

Processing length: 7900 | task: 3-hop | depth (2, 6, 7):  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 5/10 [00:31<00:31,  6.35s/it][A[A