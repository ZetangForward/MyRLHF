/public/home/zecheng/anaconda3/envs/zecheng/lib/python3.10/site-packages/transformers/deepspeed.py:24: FutureWarning: transformers.deepspeed module is deprecated and will be removed in a future version. Please import deepspeed modules directly from transformers.integrations
  warnings.warn(
/public/home/zecheng/anaconda3/envs/zecheng/lib/python3.10/site-packages/transformers/deepspeed.py:24: FutureWarning: transformers.deepspeed module is deprecated and will be removed in a future version. Please import deepspeed modules directly from transformers.integrations
  warnings.warn(
/public/home/zecheng/anaconda3/envs/zecheng/lib/python3.10/site-packages/transformers/deepspeed.py:24: FutureWarning: transformers.deepspeed module is deprecated and will be removed in a future version. Please import deepspeed modules directly from transformers.integrations
  warnings.warn(
/public/home/zecheng/anaconda3/envs/zecheng/lib/python3.10/site-packages/transformers/deepspeed.py:24: FutureWarning: transformers.deepspeed module is deprecated and will be removed in a future version. Please import deepspeed modules directly from transformers.integrations
  warnings.warn(
/public/home/zecheng/anaconda3/envs/zecheng/lib/python3.10/site-packages/transformers/deepspeed.py:24: FutureWarning: transformers.deepspeed module is deprecated and will be removed in a future version. Please import deepspeed modules directly from transformers.integrations
  warnings.warn(
/public/home/zecheng/anaconda3/envs/zecheng/lib/python3.10/site-packages/transformers/deepspeed.py:24: FutureWarning: transformers.deepspeed module is deprecated and will be removed in a future version. Please import deepspeed modules directly from transformers.integrations
  warnings.warn(
/public/home/zecheng/anaconda3/envs/zecheng/lib/python3.10/site-packages/transformers/deepspeed.py:24: FutureWarning: transformers.deepspeed module is deprecated and will be removed in a future version. Please import deepspeed modules directly from transformers.integrations
  warnings.warn(
/public/home/zecheng/anaconda3/envs/zecheng/lib/python3.10/site-packages/transformers/deepspeed.py:24: FutureWarning: transformers.deepspeed module is deprecated and will be removed in a future version. Please import deepspeed modules directly from transformers.integrations
  warnings.warn(
[rank3]: Traceback (most recent call last):
[rank3]:   File "/public/home/zecheng/workspace/zecheng/MyRLHF/openrlhf/cli/train_sft_dev.py", line 251, in <module>
[rank3]:     train(args)
[rank3]:   File "/public/home/zecheng/workspace/zecheng/MyRLHF/openrlhf/cli/train_sft_dev.py", line 16, in train
[rank3]:     strategy.setup_distributed()
[rank3]:   File "/public/home/zecheng/workspace/zecheng/MyRLHF/openrlhf/utils/deepspeed.py", line 84, in setup_distributed
[rank3]:     self.setup_ring_attn()
[rank3]:   File "/public/home/zecheng/workspace/zecheng/MyRLHF/openrlhf/utils/deepspeed.py", line 109, in setup_ring_attn
[rank3]:     from ring_flash_attn import substitute_hf_flash_attn
[rank3]: ModuleNotFoundError: No module named 'ring_flash_attn'
[rank5]: Traceback (most recent call last):
[rank5]:   File "/public/home/zecheng/workspace/zecheng/MyRLHF/openrlhf/cli/train_sft_dev.py", line 251, in <module>
[rank5]:     train(args)
[rank5]:   File "/public/home/zecheng/workspace/zecheng/MyRLHF/openrlhf/cli/train_sft_dev.py", line 16, in train
[rank5]:     strategy.setup_distributed()
[rank5]:   File "/public/home/zecheng/workspace/zecheng/MyRLHF/openrlhf/utils/deepspeed.py", line 84, in setup_distributed
[rank5]:     self.setup_ring_attn()
[rank5]:   File "/public/home/zecheng/workspace/zecheng/MyRLHF/openrlhf/utils/deepspeed.py", line 109, in setup_ring_attn
[rank5]:     from ring_flash_attn import substitute_hf_flash_attn
[rank5]: ModuleNotFoundError: No module named 'ring_flash_attn'
[rank4]: Traceback (most recent call last):
[rank4]:   File "/public/home/zecheng/workspace/zecheng/MyRLHF/openrlhf/cli/train_sft_dev.py", line 251, in <module>
[rank4]:     train(args)
[rank4]:   File "/public/home/zecheng/workspace/zecheng/MyRLHF/openrlhf/cli/train_sft_dev.py", line 16, in train
[rank4]:     strategy.setup_distributed()
[rank4]:   File "/public/home/zecheng/workspace/zecheng/MyRLHF/openrlhf/utils/deepspeed.py", line 84, in setup_distributed
[rank4]:     self.setup_ring_attn()
[rank4]:   File "/public/home/zecheng/workspace/zecheng/MyRLHF/openrlhf/utils/deepspeed.py", line 109, in setup_ring_attn
[rank4]:     from ring_flash_attn import substitute_hf_flash_attn
[rank4]: ModuleNotFoundError: No module named 'ring_flash_attn'
[rank0]: Traceback (most recent call last):
[rank0]:   File "/public/home/zecheng/workspace/zecheng/MyRLHF/openrlhf/cli/train_sft_dev.py", line 251, in <module>
[rank0]:     train(args)
[rank0]:   File "/public/home/zecheng/workspace/zecheng/MyRLHF/openrlhf/cli/train_sft_dev.py", line 16, in train
[rank0]:     strategy.setup_distributed()
[rank0]:   File "/public/home/zecheng/workspace/zecheng/MyRLHF/openrlhf/utils/deepspeed.py", line 84, in setup_distributed
[rank0]:     self.setup_ring_attn()
[rank0]:   File "/public/home/zecheng/workspace/zecheng/MyRLHF/openrlhf/utils/deepspeed.py", line 109, in setup_ring_attn
[rank0]:     from ring_flash_attn import substitute_hf_flash_attn
[rank0]: ModuleNotFoundError: No module named 'ring_flash_attn'
[rank1]: Traceback (most recent call last):
[rank1]:   File "/public/home/zecheng/workspace/zecheng/MyRLHF/openrlhf/cli/train_sft_dev.py", line 251, in <module>
[rank1]:     train(args)
[rank1]:   File "/public/home/zecheng/workspace/zecheng/MyRLHF/openrlhf/cli/train_sft_dev.py", line 16, in train
[rank1]:     strategy.setup_distributed()
[rank1]:   File "/public/home/zecheng/workspace/zecheng/MyRLHF/openrlhf/utils/deepspeed.py", line 84, in setup_distributed
[rank1]:     self.setup_ring_attn()
[rank1]:   File "/public/home/zecheng/workspace/zecheng/MyRLHF/openrlhf/utils/deepspeed.py", line 109, in setup_ring_attn
[rank1]:     from ring_flash_attn import substitute_hf_flash_attn
[rank1]: ModuleNotFoundError: No module named 'ring_flash_attn'
[rank2]: Traceback (most recent call last):
[rank2]:   File "/public/home/zecheng/workspace/zecheng/MyRLHF/openrlhf/cli/train_sft_dev.py", line 251, in <module>
[rank2]:     train(args)
[rank2]:   File "/public/home/zecheng/workspace/zecheng/MyRLHF/openrlhf/cli/train_sft_dev.py", line 16, in train
[rank2]:     strategy.setup_distributed()
[rank2]:   File "/public/home/zecheng/workspace/zecheng/MyRLHF/openrlhf/utils/deepspeed.py", line 84, in setup_distributed
[rank2]:     self.setup_ring_attn()
[rank2]:   File "/public/home/zecheng/workspace/zecheng/MyRLHF/openrlhf/utils/deepspeed.py", line 109, in setup_ring_attn
[rank2]:     from ring_flash_attn import substitute_hf_flash_attn
[rank2]: ModuleNotFoundError: No module named 'ring_flash_attn'
[rank6]: Traceback (most recent call last):
[rank6]:   File "/public/home/zecheng/workspace/zecheng/MyRLHF/openrlhf/cli/train_sft_dev.py", line 251, in <module>
[rank6]:     train(args)
[rank6]:   File "/public/home/zecheng/workspace/zecheng/MyRLHF/openrlhf/cli/train_sft_dev.py", line 16, in train
[rank6]:     strategy.setup_distributed()
[rank6]:   File "/public/home/zecheng/workspace/zecheng/MyRLHF/openrlhf/utils/deepspeed.py", line 84, in setup_distributed
[rank6]:     self.setup_ring_attn()
[rank6]:   File "/public/home/zecheng/workspace/zecheng/MyRLHF/openrlhf/utils/deepspeed.py", line 109, in setup_ring_attn
[rank6]:     from ring_flash_attn import substitute_hf_flash_attn
[rank6]: ModuleNotFoundError: No module named 'ring_flash_attn'
[rank7]: Traceback (most recent call last):
[rank7]:   File "/public/home/zecheng/workspace/zecheng/MyRLHF/openrlhf/cli/train_sft_dev.py", line 251, in <module>
[rank7]:     train(args)
[rank7]:   File "/public/home/zecheng/workspace/zecheng/MyRLHF/openrlhf/cli/train_sft_dev.py", line 16, in train
[rank7]:     strategy.setup_distributed()
[rank7]:   File "/public/home/zecheng/workspace/zecheng/MyRLHF/openrlhf/utils/deepspeed.py", line 84, in setup_distributed
[rank7]:     self.setup_ring_attn()
[rank7]:   File "/public/home/zecheng/workspace/zecheng/MyRLHF/openrlhf/utils/deepspeed.py", line 109, in setup_ring_attn
[rank7]:     from ring_flash_attn import substitute_hf_flash_attn
[rank7]: ModuleNotFoundError: No module named 'ring_flash_attn'
